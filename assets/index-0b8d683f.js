var toe=Object.defineProperty;var noe=(n,e,a)=>e in n?toe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var _n=(n,e,a)=>(noe(n,typeof e!="symbol"?e+"":e,a),a);function VH(n,e){for(var a=0;a<e.length;a++){const o=e[a];if(typeof o!="string"&&!Array.isArray(o)){for(const s in o)if(s!=="default"&&!(s in n)){const c=Object.getOwnPropertyDescriptor(o,s);c&&Object.defineProperty(n,s,c.get?c:{enumerable:!0,get:()=>o[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=a(s);fetch(s.href,c)}})();var aoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function uw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function GH(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var a=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};a.prototype=e.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(a,o,s.get?s:{enumerable:!0,get:function(){return n[o]}})}),a}var HH={exports:{}},Ja={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw=Symbol.for("react.element"),ioe=Symbol.for("react.portal"),roe=Symbol.for("react.fragment"),ooe=Symbol.for("react.strict_mode"),soe=Symbol.for("react.profiler"),loe=Symbol.for("react.provider"),coe=Symbol.for("react.context"),uoe=Symbol.for("react.forward_ref"),doe=Symbol.for("react.suspense"),hoe=Symbol.for("react.memo"),foe=Symbol.for("react.lazy"),g9=Symbol.iterator;function poe(n){return n===null||typeof n!="object"?null:(n=g9&&n[g9]||n["@@iterator"],typeof n=="function"?n:null)}var jH={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$H=Object.assign,qH={};function r_(n,e,a){this.props=n,this.context=e,this.refs=qH,this.updater=a||jH}r_.prototype.isReactComponent={};r_.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};r_.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function XH(){}XH.prototype=r_.prototype;function YR(n,e,a){this.props=n,this.context=e,this.refs=qH,this.updater=a||jH}var KR=YR.prototype=new XH;KR.constructor=YR;$H(KR,r_.prototype);KR.isPureReactComponent=!0;var y9=Array.isArray,ZH=Object.prototype.hasOwnProperty,JR={current:null},YH={key:!0,ref:!0,__self:!0,__source:!0};function KH(n,e,a){var o,s={},c=null,d=null;if(e!=null)for(o in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)ZH.call(e,o)&&!YH.hasOwnProperty(o)&&(s[o]=e[o]);var f=arguments.length-2;if(f===1)s.children=a;else if(1<f){for(var m=Array(f),y=0;y<f;y++)m[y]=arguments[y+2];s.children=m}if(n&&n.defaultProps)for(o in f=n.defaultProps,f)s[o]===void 0&&(s[o]=f[o]);return{$$typeof:dw,type:n,key:c,ref:d,props:s,_owner:JR.current}}function moe(n,e){return{$$typeof:dw,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function QR(n){return typeof n=="object"&&n!==null&&n.$$typeof===dw}function goe(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(a){return e[a]})}var v9=/\/+/g;function w5(n,e){return typeof n=="object"&&n!==null&&n.key!=null?goe(""+n.key):e.toString(36)}function vA(n,e,a,o,s){var c=typeof n;(c==="undefined"||c==="boolean")&&(n=null);var d=!1;if(n===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(n.$$typeof){case dw:case ioe:d=!0}}if(d)return d=n,s=s(d),n=o===""?"."+w5(d,0):o,y9(s)?(a="",n!=null&&(a=n.replace(v9,"$&/")+"/"),vA(s,e,a,"",function(y){return y})):s!=null&&(QR(s)&&(s=moe(s,a+(!s.key||d&&d.key===s.key?"":(""+s.key).replace(v9,"$&/")+"/")+n)),e.push(s)),1;if(d=0,o=o===""?".":o+":",y9(n))for(var f=0;f<n.length;f++){c=n[f];var m=o+w5(c,f);d+=vA(c,e,a,m,s)}else if(m=poe(n),typeof m=="function")for(n=m.call(n),f=0;!(c=n.next()).done;)c=c.value,m=o+w5(c,f++),d+=vA(c,e,a,m,s);else if(c==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function F3(n,e,a){if(n==null)return n;var o=[],s=0;return vA(n,o,"","",function(c){return e.call(a,c,s++)}),o}function yoe(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(a){(n._status===0||n._status===-1)&&(n._status=1,n._result=a)},function(a){(n._status===0||n._status===-1)&&(n._status=2,n._result=a)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Gs={current:null},_A={transition:null},voe={ReactCurrentDispatcher:Gs,ReactCurrentBatchConfig:_A,ReactCurrentOwner:JR};Ja.Children={map:F3,forEach:function(n,e,a){F3(n,function(){e.apply(this,arguments)},a)},count:function(n){var e=0;return F3(n,function(){e++}),e},toArray:function(n){return F3(n,function(e){return e})||[]},only:function(n){if(!QR(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Ja.Component=r_;Ja.Fragment=roe;Ja.Profiler=soe;Ja.PureComponent=YR;Ja.StrictMode=ooe;Ja.Suspense=doe;Ja.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=voe;Ja.cloneElement=function(n,e,a){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var o=$H({},n.props),s=n.key,c=n.ref,d=n._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=JR.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var f=n.type.defaultProps;for(m in e)ZH.call(e,m)&&!YH.hasOwnProperty(m)&&(o[m]=e[m]===void 0&&f!==void 0?f[m]:e[m])}var m=arguments.length-2;if(m===1)o.children=a;else if(1<m){f=Array(m);for(var y=0;y<m;y++)f[y]=arguments[y+2];o.children=f}return{$$typeof:dw,type:n.type,key:s,ref:c,props:o,_owner:d}};Ja.createContext=function(n){return n={$$typeof:coe,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:loe,_context:n},n.Consumer=n};Ja.createElement=KH;Ja.createFactory=function(n){var e=KH.bind(null,n);return e.type=n,e};Ja.createRef=function(){return{current:null}};Ja.forwardRef=function(n){return{$$typeof:uoe,render:n}};Ja.isValidElement=QR;Ja.lazy=function(n){return{$$typeof:foe,_payload:{_status:-1,_result:n},_init:yoe}};Ja.memo=function(n,e){return{$$typeof:hoe,type:n,compare:e===void 0?null:e}};Ja.startTransition=function(n){var e=_A.transition;_A.transition={};try{n()}finally{_A.transition=e}};Ja.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ja.useCallback=function(n,e){return Gs.current.useCallback(n,e)};Ja.useContext=function(n){return Gs.current.useContext(n)};Ja.useDebugValue=function(){};Ja.useDeferredValue=function(n){return Gs.current.useDeferredValue(n)};Ja.useEffect=function(n,e){return Gs.current.useEffect(n,e)};Ja.useId=function(){return Gs.current.useId()};Ja.useImperativeHandle=function(n,e,a){return Gs.current.useImperativeHandle(n,e,a)};Ja.useInsertionEffect=function(n,e){return Gs.current.useInsertionEffect(n,e)};Ja.useLayoutEffect=function(n,e){return Gs.current.useLayoutEffect(n,e)};Ja.useMemo=function(n,e){return Gs.current.useMemo(n,e)};Ja.useReducer=function(n,e,a){return Gs.current.useReducer(n,e,a)};Ja.useRef=function(n){return Gs.current.useRef(n)};Ja.useState=function(n){return Gs.current.useState(n)};Ja.useSyncExternalStore=function(n,e,a){return Gs.current.useSyncExternalStore(n,e,a)};Ja.useTransition=function(){return Gs.current.useTransition()};Ja.version="18.2.0";HH.exports=Ja;var re=HH.exports;const Vl=uw(re),eE=VH({__proto__:null,default:Vl},[re]);var SI={},JH={exports:{}},Xl={},QH={exports:{}},ej={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ue,ye){var Ae=ue.length;ue.push(ye);e:for(;0<Ae;){var ne=Ae-1>>>1,Ee=ue[ne];if(0<s(Ee,ye))ue[ne]=ye,ue[Ae]=Ee,Ae=ne;else break e}}function a(ue){return ue.length===0?null:ue[0]}function o(ue){if(ue.length===0)return null;var ye=ue[0],Ae=ue.pop();if(Ae!==ye){ue[0]=Ae;e:for(var ne=0,Ee=ue.length,Ye=Ee>>>1;ne<Ye;){var Xe=2*(ne+1)-1,Ke=ue[Xe],Ue=Xe+1,ht=ue[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ht,Ke)?(ue[ne]=ht,ue[Ue]=Ae,ne=Ue):(ue[ne]=Ke,ue[Xe]=Ae,ne=Xe);else if(Ue<Ee&&0>s(ht,Ae))ue[ne]=ht,ue[Ue]=Ae,ne=Ue;else break e}}return ye}function s(ue,ye){var Ae=ue.sortIndex-ye.sortIndex;return Ae!==0?Ae:ue.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,w=null,A=3,C=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ue){for(var ye=a(y);ye!==null;){if(ye.callback===null)o(y);else if(ye.startTime<=ue)o(y),ye.sortIndex=ye.expirationTime,e(m,ye);else break;ye=a(y)}}function B(ue){if(k=!1,F(ue),!I)if(a(m)!==null)I=!0,Re(G);else{var ye=a(y);ye!==null&&He(B,ye.startTime-ue)}}function G(ue,ye){I=!1,k&&(k=!1,L(ee),ee=-1),C=!0;var Ae=A;try{for(F(ye),w=a(m);w!==null&&(!(w.expirationTime>ye)||ue&&!me());){var ne=w.callback;if(typeof ne=="function"){w.callback=null,A=w.priorityLevel;var Ee=ne(w.expirationTime<=ye);ye=n.unstable_now(),typeof Ee=="function"?w.callback=Ee:w===a(m)&&o(m),F(ye)}else o(m);w=a(m)}if(w!==null)var Ye=!0;else{var Xe=a(y);Xe!==null&&He(B,Xe.startTime-ye),Ye=!1}return Ye}finally{w=null,A=Ae,C=!1}}var q=!1,X=null,ee=-1,V=5,Q=-1;function me(){return!(n.unstable_now()-Q<V)}function pe(){if(X!==null){var ue=n.unstable_now();Q=ue;var ye=!0;try{ye=X(!0,ue)}finally{ye?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=pe,be=function(){Ce.postMessage(null)}}else be=function(){D(pe,0)};function Re(ue){X=ue,q||(q=!0,be())}function He(ue,ye){ee=D(function(){ue(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){I||C||(I=!0,Re(G))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(ue){switch(A){case 1:case 2:case 3:var ye=3;break;default:ye=A}var Ae=A;A=ye;try{return ue()}finally{A=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,ye){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var Ae=A;A=ue;try{return ye()}finally{A=Ae}},n.unstable_scheduleCallback=function(ue,ye,Ae){var ne=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ne+Ae:ne):Ae=ne,ue){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,ue={id:_++,callback:ye,priorityLevel:ue,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ne?(ue.sortIndex=Ae,e(y,ue),a(m)===null&&ue===a(y)&&(k?(L(ee),ee=-1):k=!0,He(B,Ae-ne))):(ue.sortIndex=Ee,e(m,ue),I||C||(I=!0,Re(G))),ue},n.unstable_shouldYield=me,n.unstable_wrapCallback=function(ue){var ye=A;return function(){var Ae=A;A=ye;try{return ue.apply(this,arguments)}finally{A=Ae}}}})(ej);QH.exports=ej;var _oe=QH.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tj=re,ql=_oe;function hn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)e+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nj=new Set,cx={};function Ng(n,e){z0(n,e),z0(n+"Capture",e)}function z0(n,e){for(cx[n]=e,n=0;n<e.length;n++)nj.add(e[n])}var Lh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),AI=Object.prototype.hasOwnProperty,boe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_9={},b9={};function xoe(n){return AI.call(b9,n)?!0:AI.call(_9,n)?!1:boe.test(n)?b9[n]=!0:(_9[n]=!0,!1)}function woe(n,e,a,o){if(a!==null&&a.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Soe(n,e,a,o){if(e===null||typeof e>"u"||woe(n,e,a,o))return!0;if(o)return!1;if(a!==null)switch(a.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hs(n,e,a,o,s,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=s,this.mustUseProperty=a,this.propertyName=n,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var Yo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Yo[n]=new Hs(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Yo[e]=new Hs(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Yo[n]=new Hs(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Yo[n]=new Hs(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Yo[n]=new Hs(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Yo[n]=new Hs(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Yo[n]=new Hs(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Yo[n]=new Hs(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Yo[n]=new Hs(n,5,!1,n.toLowerCase(),null,!1,!1)});var ek=/[\-:]([a-z])/g;function tk(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ek,tk);Yo[e]=new Hs(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ek,tk);Yo[e]=new Hs(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ek,tk);Yo[e]=new Hs(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Yo[n]=new Hs(n,1,!1,n.toLowerCase(),null,!1,!1)});Yo.xlinkHref=new Hs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Yo[n]=new Hs(n,1,!1,n.toLowerCase(),null,!0,!0)});function nk(n,e,a,o){var s=Yo.hasOwnProperty(e)?Yo[e]:null;(s!==null?s.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Soe(e,a,s,o)&&(a=null),o||s===null?xoe(e)&&(a===null?n.removeAttribute(e):n.setAttribute(e,""+a)):s.mustUseProperty?n[s.propertyName]=a===null?s.type===3?!1:"":a:(e=s.attributeName,o=s.attributeNamespace,a===null?n.removeAttribute(e):(s=s.type,a=s===3||s===4&&a===!0?"":""+a,o?n.setAttributeNS(o,e,a):n.setAttribute(e,a))))}var Bh=tj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N3=Symbol.for("react.element"),i0=Symbol.for("react.portal"),r0=Symbol.for("react.fragment"),ak=Symbol.for("react.strict_mode"),EI=Symbol.for("react.profiler"),aj=Symbol.for("react.provider"),ij=Symbol.for("react.context"),ik=Symbol.for("react.forward_ref"),MI=Symbol.for("react.suspense"),TI=Symbol.for("react.suspense_list"),rk=Symbol.for("react.memo"),Uf=Symbol.for("react.lazy"),rj=Symbol.for("react.offscreen"),x9=Symbol.iterator;function L1(n){return n===null||typeof n!="object"?null:(n=x9&&n[x9]||n["@@iterator"],typeof n=="function"?n:null)}var Rr=Object.assign,S5;function yb(n){if(S5===void 0)try{throw Error()}catch(a){var e=a.stack.trim().match(/\n( *(at )?)/);S5=e&&e[1]||""}return`
`+S5+n}var A5=!1;function E5(n,e){if(!n||A5)return"";A5=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var o=y}Reflect.construct(n,[],e)}else{try{e.call()}catch(y){o=y}n.call(e.prototype)}else{try{throw Error()}catch(y){o=y}n()}}catch(y){if(y&&o&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),c=o.stack.split(`
`),d=s.length-1,f=c.length-1;1<=d&&0<=f&&s[d]!==c[f];)f--;for(;1<=d&&0<=f;d--,f--)if(s[d]!==c[f]){if(d!==1||f!==1)do if(d--,f--,0>f||s[d]!==c[f]){var m=`
`+s[d].replace(" at new "," at ");return n.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",n.displayName)),m}while(1<=d&&0<=f);break}}}finally{A5=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?yb(n):""}function Aoe(n){switch(n.tag){case 5:return yb(n.type);case 16:return yb("Lazy");case 13:return yb("Suspense");case 19:return yb("SuspenseList");case 0:case 2:case 15:return n=E5(n.type,!1),n;case 11:return n=E5(n.type.render,!1),n;case 1:return n=E5(n.type,!0),n;default:return""}}function CI(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case r0:return"Fragment";case i0:return"Portal";case EI:return"Profiler";case ak:return"StrictMode";case MI:return"Suspense";case TI:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ij:return(n.displayName||"Context")+".Consumer";case aj:return(n._context.displayName||"Context")+".Provider";case ik:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case rk:return e=n.displayName||null,e!==null?e:CI(n.type)||"Memo";case Uf:e=n._payload,n=n._init;try{return CI(n(e))}catch{}}return null}function Eoe(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return CI(e);case 8:return e===ak?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function oj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Moe(n){var e=oj(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),o=""+n[e];if(!n.hasOwnProperty(e)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var s=a.get,c=a.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(d){o=""+d,c.call(this,d)}}),Object.defineProperty(n,e,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function B3(n){n._valueTracker||(n._valueTracker=Moe(n))}function sj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var a=e.getValue(),o="";return n&&(o=oj(n)?n.checked?"true":"false":n.value),n=o,n!==a?(e.setValue(n),!0):!1}function tE(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function PI(n,e){var a=e.checked;return Rr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function w9(n,e){var a=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;a=fp(e.value!=null?e.value:a),n._wrapperState={initialChecked:o,initialValue:a,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lj(n,e){e=e.checked,e!=null&&nk(n,"checked",e,!1)}function II(n,e){lj(n,e);var a=fp(e.value),o=e.type;if(a!=null)o==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(o==="submit"||o==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?LI(n,e.type,a):e.hasOwnProperty("defaultValue")&&LI(n,e.type,fp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function S9(n,e,a){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,a||e===n.value||(n.value=e),n.defaultValue=e}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function LI(n,e,a){(e!=="number"||tE(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var vb=Array.isArray;function S0(n,e,a,o){if(n=n.options,e){e={};for(var s=0;s<a.length;s++)e["$"+a[s]]=!0;for(a=0;a<n.length;a++)s=e.hasOwnProperty("$"+n[a].value),n[a].selected!==s&&(n[a].selected=s),s&&o&&(n[a].defaultSelected=!0)}else{for(a=""+fp(a),e=null,s=0;s<n.length;s++){if(n[s].value===a){n[s].selected=!0,o&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function RI(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(hn(91));return Rr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function A9(n,e){var a=e.value;if(a==null){if(a=e.children,e=e.defaultValue,a!=null){if(e!=null)throw Error(hn(92));if(vb(a)){if(1<a.length)throw Error(hn(93));a=a[0]}e=a}e==null&&(e=""),a=e}n._wrapperState={initialValue:fp(a)}}function cj(n,e){var a=fp(e.value),o=fp(e.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),e.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),o!=null&&(n.defaultValue=""+o)}function E9(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function uj(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function kI(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?uj(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var U3,dj=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,a,o,s){MSApp.execUnsafeLocalFunction(function(){return n(e,a,o,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(U3=U3||document.createElement("div"),U3.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=U3.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function ux(n,e){if(e){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=e;return}}n.textContent=e}var Lb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Toe=["Webkit","ms","Moz","O"];Object.keys(Lb).forEach(function(n){Toe.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Lb[e]=Lb[n]})});function hj(n,e,a){return e==null||typeof e=="boolean"||e===""?"":a||typeof e!="number"||e===0||Lb.hasOwnProperty(n)&&Lb[n]?(""+e).trim():e+"px"}function fj(n,e){n=n.style;for(var a in e)if(e.hasOwnProperty(a)){var o=a.indexOf("--")===0,s=hj(a,e[a],o);a==="float"&&(a="cssFloat"),o?n.setProperty(a,s):n[a]=s}}var Coe=Rr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function DI(n,e){if(e){if(Coe[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(hn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(hn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(hn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(hn(62))}}function OI(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zI=null;function ok(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var FI=null,A0=null,E0=null;function M9(n){if(n=pw(n)){if(typeof FI!="function")throw Error(hn(280));var e=n.stateNode;e&&(e=hM(e),FI(n.stateNode,n.type,e))}}function pj(n){A0?E0?E0.push(n):E0=[n]:A0=n}function mj(){if(A0){var n=A0,e=E0;if(E0=A0=null,M9(n),e)for(n=0;n<e.length;n++)M9(e[n])}}function gj(n,e){return n(e)}function yj(){}var M5=!1;function vj(n,e,a){if(M5)return n(e,a);M5=!0;try{return gj(n,e,a)}finally{M5=!1,(A0!==null||E0!==null)&&(yj(),mj())}}function dx(n,e){var a=n.stateNode;if(a===null)return null;var o=hM(a);if(o===null)return null;a=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(n=n.type,o=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!o;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(hn(231,e,typeof a));return a}var NI=!1;if(Lh)try{var R1={};Object.defineProperty(R1,"passive",{get:function(){NI=!0}}),window.addEventListener("test",R1,R1),window.removeEventListener("test",R1,R1)}catch{NI=!1}function Poe(n,e,a,o,s,c,d,f,m){var y=Array.prototype.slice.call(arguments,3);try{e.apply(a,y)}catch(_){this.onError(_)}}var Rb=!1,nE=null,aE=!1,BI=null,Ioe={onError:function(n){Rb=!0,nE=n}};function Loe(n,e,a,o,s,c,d,f,m){Rb=!1,nE=null,Poe.apply(Ioe,arguments)}function Roe(n,e,a,o,s,c,d,f,m){if(Loe.apply(this,arguments),Rb){if(Rb){var y=nE;Rb=!1,nE=null}else throw Error(hn(198));aE||(aE=!0,BI=y)}}function Bg(n){var e=n,a=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(a=e.return),n=e.return;while(n)}return e.tag===3?a:null}function _j(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function T9(n){if(Bg(n)!==n)throw Error(hn(188))}function koe(n){var e=n.alternate;if(!e){if(e=Bg(n),e===null)throw Error(hn(188));return e!==n?null:n}for(var a=n,o=e;;){var s=a.return;if(s===null)break;var c=s.alternate;if(c===null){if(o=s.return,o!==null){a=o;continue}break}if(s.child===c.child){for(c=s.child;c;){if(c===a)return T9(s),n;if(c===o)return T9(s),e;c=c.sibling}throw Error(hn(188))}if(a.return!==o.return)a=s,o=c;else{for(var d=!1,f=s.child;f;){if(f===a){d=!0,a=s,o=c;break}if(f===o){d=!0,o=s,a=c;break}f=f.sibling}if(!d){for(f=c.child;f;){if(f===a){d=!0,a=c,o=s;break}if(f===o){d=!0,o=c,a=s;break}f=f.sibling}if(!d)throw Error(hn(189))}}if(a.alternate!==o)throw Error(hn(190))}if(a.tag!==3)throw Error(hn(188));return a.stateNode.current===a?n:e}function bj(n){return n=koe(n),n!==null?xj(n):null}function xj(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=xj(n);if(e!==null)return e;n=n.sibling}return null}var wj=ql.unstable_scheduleCallback,C9=ql.unstable_cancelCallback,Doe=ql.unstable_shouldYield,Ooe=ql.unstable_requestPaint,oo=ql.unstable_now,zoe=ql.unstable_getCurrentPriorityLevel,sk=ql.unstable_ImmediatePriority,Sj=ql.unstable_UserBlockingPriority,iE=ql.unstable_NormalPriority,Foe=ql.unstable_LowPriority,Aj=ql.unstable_IdlePriority,lM=null,ld=null;function Noe(n){if(ld&&typeof ld.onCommitFiberRoot=="function")try{ld.onCommitFiberRoot(lM,n,void 0,(n.current.flags&128)===128)}catch{}}var su=Math.clz32?Math.clz32:Woe,Boe=Math.log,Uoe=Math.LN2;function Woe(n){return n>>>=0,n===0?32:31-(Boe(n)/Uoe|0)|0}var W3=64,V3=4194304;function _b(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function rE(n,e){var a=n.pendingLanes;if(a===0)return 0;var o=0,s=n.suspendedLanes,c=n.pingedLanes,d=a&268435455;if(d!==0){var f=d&~s;f!==0?o=_b(f):(c&=d,c!==0&&(o=_b(c)))}else d=a&~s,d!==0?o=_b(d):c!==0&&(o=_b(c));if(o===0)return 0;if(e!==0&&e!==o&&!(e&s)&&(s=o&-o,c=e&-e,s>=c||s===16&&(c&4194240)!==0))return e;if(o&4&&(o|=a&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=o;0<e;)a=31-su(e),s=1<<a,o|=n[a],e&=~s;return o}function Voe(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Goe(n,e){for(var a=n.suspendedLanes,o=n.pingedLanes,s=n.expirationTimes,c=n.pendingLanes;0<c;){var d=31-su(c),f=1<<d,m=s[d];m===-1?(!(f&a)||f&o)&&(s[d]=Voe(f,e)):m<=e&&(n.expiredLanes|=f),c&=~f}}function UI(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Ej(){var n=W3;return W3<<=1,!(W3&4194240)&&(W3=64),n}function T5(n){for(var e=[],a=0;31>a;a++)e.push(n);return e}function hw(n,e,a){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-su(e),n[e]=a}function Hoe(n,e){var a=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var o=n.eventTimes;for(n=n.expirationTimes;0<a;){var s=31-su(a),c=1<<s;e[s]=0,o[s]=-1,n[s]=-1,a&=~c}}function lk(n,e){var a=n.entangledLanes|=e;for(n=n.entanglements;a;){var o=31-su(a),s=1<<o;s&e|n[o]&e&&(n[o]|=e),a&=~s}}var Fi=0;function Mj(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Tj,ck,Cj,Pj,Ij,WI=!1,G3=[],Qf=null,ep=null,tp=null,hx=new Map,fx=new Map,Vf=[],joe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function P9(n,e){switch(n){case"focusin":case"focusout":Qf=null;break;case"dragenter":case"dragleave":ep=null;break;case"mouseover":case"mouseout":tp=null;break;case"pointerover":case"pointerout":hx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fx.delete(e.pointerId)}}function k1(n,e,a,o,s,c){return n===null||n.nativeEvent!==c?(n={blockedOn:e,domEventName:a,eventSystemFlags:o,nativeEvent:c,targetContainers:[s]},e!==null&&(e=pw(e),e!==null&&ck(e)),n):(n.eventSystemFlags|=o,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function $oe(n,e,a,o,s){switch(e){case"focusin":return Qf=k1(Qf,n,e,a,o,s),!0;case"dragenter":return ep=k1(ep,n,e,a,o,s),!0;case"mouseover":return tp=k1(tp,n,e,a,o,s),!0;case"pointerover":var c=s.pointerId;return hx.set(c,k1(hx.get(c)||null,n,e,a,o,s)),!0;case"gotpointercapture":return c=s.pointerId,fx.set(c,k1(fx.get(c)||null,n,e,a,o,s)),!0}return!1}function Lj(n){var e=ag(n.target);if(e!==null){var a=Bg(e);if(a!==null){if(e=a.tag,e===13){if(e=_j(a),e!==null){n.blockedOn=e,Ij(n.priority,function(){Cj(a)});return}}else if(e===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function bA(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var a=VI(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var o=new a.constructor(a.type,a);zI=o,a.target.dispatchEvent(o),zI=null}else return e=pw(a),e!==null&&ck(e),n.blockedOn=a,!1;e.shift()}return!0}function I9(n,e,a){bA(n)&&a.delete(e)}function qoe(){WI=!1,Qf!==null&&bA(Qf)&&(Qf=null),ep!==null&&bA(ep)&&(ep=null),tp!==null&&bA(tp)&&(tp=null),hx.forEach(I9),fx.forEach(I9)}function D1(n,e){n.blockedOn===e&&(n.blockedOn=null,WI||(WI=!0,ql.unstable_scheduleCallback(ql.unstable_NormalPriority,qoe)))}function px(n){function e(s){return D1(s,n)}if(0<G3.length){D1(G3[0],n);for(var a=1;a<G3.length;a++){var o=G3[a];o.blockedOn===n&&(o.blockedOn=null)}}for(Qf!==null&&D1(Qf,n),ep!==null&&D1(ep,n),tp!==null&&D1(tp,n),hx.forEach(e),fx.forEach(e),a=0;a<Vf.length;a++)o=Vf[a],o.blockedOn===n&&(o.blockedOn=null);for(;0<Vf.length&&(a=Vf[0],a.blockedOn===null);)Lj(a),a.blockedOn===null&&Vf.shift()}var M0=Bh.ReactCurrentBatchConfig,oE=!0;function Xoe(n,e,a,o){var s=Fi,c=M0.transition;M0.transition=null;try{Fi=1,uk(n,e,a,o)}finally{Fi=s,M0.transition=c}}function Zoe(n,e,a,o){var s=Fi,c=M0.transition;M0.transition=null;try{Fi=4,uk(n,e,a,o)}finally{Fi=s,M0.transition=c}}function uk(n,e,a,o){if(oE){var s=VI(n,e,a,o);if(s===null)F5(n,e,o,sE,a),P9(n,o);else if($oe(s,n,e,a,o))o.stopPropagation();else if(P9(n,o),e&4&&-1<joe.indexOf(n)){for(;s!==null;){var c=pw(s);if(c!==null&&Tj(c),c=VI(n,e,a,o),c===null&&F5(n,e,o,sE,a),c===s)break;s=c}s!==null&&o.stopPropagation()}else F5(n,e,o,null,a)}}var sE=null;function VI(n,e,a,o){if(sE=null,n=ok(o),n=ag(n),n!==null)if(e=Bg(n),e===null)n=null;else if(a=e.tag,a===13){if(n=_j(e),n!==null)return n;n=null}else if(a===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return sE=n,null}function Rj(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zoe()){case sk:return 1;case Sj:return 4;case iE:case Foe:return 16;case Aj:return 536870912;default:return 16}default:return 16}}var jf=null,dk=null,xA=null;function kj(){if(xA)return xA;var n,e=dk,a=e.length,o,s="value"in jf?jf.value:jf.textContent,c=s.length;for(n=0;n<a&&e[n]===s[n];n++);var d=a-n;for(o=1;o<=d&&e[a-o]===s[c-o];o++);return xA=s.slice(n,1<o?1-o:void 0)}function wA(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function H3(){return!0}function L9(){return!1}function Zl(n){function e(a,o,s,c,d){this._reactName=a,this._targetInst=s,this.type=o,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var f in n)n.hasOwnProperty(f)&&(a=n[f],this[f]=a?a(c):c[f]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?H3:L9,this.isPropagationStopped=L9,this}return Rr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=H3)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=H3)},persist:function(){},isPersistent:H3}),e}var o_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hk=Zl(o_),fw=Rr({},o_,{view:0,detail:0}),Yoe=Zl(fw),C5,P5,O1,cM=Rr({},fw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fk,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==O1&&(O1&&n.type==="mousemove"?(C5=n.screenX-O1.screenX,P5=n.screenY-O1.screenY):P5=C5=0,O1=n),C5)},movementY:function(n){return"movementY"in n?n.movementY:P5}}),R9=Zl(cM),Koe=Rr({},cM,{dataTransfer:0}),Joe=Zl(Koe),Qoe=Rr({},fw,{relatedTarget:0}),I5=Zl(Qoe),ese=Rr({},o_,{animationName:0,elapsedTime:0,pseudoElement:0}),tse=Zl(ese),nse=Rr({},o_,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ase=Zl(nse),ise=Rr({},o_,{data:0}),k9=Zl(ise),rse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ose={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lse(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=sse[n])?!!e[n]:!1}function fk(){return lse}var cse=Rr({},fw,{key:function(n){if(n.key){var e=rse[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=wA(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ose[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fk,charCode:function(n){return n.type==="keypress"?wA(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?wA(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),use=Zl(cse),dse=Rr({},cM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D9=Zl(dse),hse=Rr({},fw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fk}),fse=Zl(hse),pse=Rr({},o_,{propertyName:0,elapsedTime:0,pseudoElement:0}),mse=Zl(pse),gse=Rr({},cM,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),yse=Zl(gse),vse=[9,13,27,32],pk=Lh&&"CompositionEvent"in window,kb=null;Lh&&"documentMode"in document&&(kb=document.documentMode);var _se=Lh&&"TextEvent"in window&&!kb,Dj=Lh&&(!pk||kb&&8<kb&&11>=kb),O9=String.fromCharCode(32),z9=!1;function Oj(n,e){switch(n){case"keyup":return vse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zj(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var o0=!1;function bse(n,e){switch(n){case"compositionend":return zj(e);case"keypress":return e.which!==32?null:(z9=!0,O9);case"textInput":return n=e.data,n===O9&&z9?null:n;default:return null}}function xse(n,e){if(o0)return n==="compositionend"||!pk&&Oj(n,e)?(n=kj(),xA=dk=jf=null,o0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Dj&&e.locale!=="ko"?null:e.data;default:return null}}var wse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function F9(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!wse[n.type]:e==="textarea"}function Fj(n,e,a,o){pj(o),e=lE(e,"onChange"),0<e.length&&(a=new hk("onChange","change",null,a,o),n.push({event:a,listeners:e}))}var Db=null,mx=null;function Sse(n){Xj(n,0)}function uM(n){var e=c0(n);if(sj(e))return n}function Ase(n,e){if(n==="change")return e}var Nj=!1;if(Lh){var L5;if(Lh){var R5="oninput"in document;if(!R5){var N9=document.createElement("div");N9.setAttribute("oninput","return;"),R5=typeof N9.oninput=="function"}L5=R5}else L5=!1;Nj=L5&&(!document.documentMode||9<document.documentMode)}function B9(){Db&&(Db.detachEvent("onpropertychange",Bj),mx=Db=null)}function Bj(n){if(n.propertyName==="value"&&uM(mx)){var e=[];Fj(e,mx,n,ok(n)),vj(Sse,e)}}function Ese(n,e,a){n==="focusin"?(B9(),Db=e,mx=a,Db.attachEvent("onpropertychange",Bj)):n==="focusout"&&B9()}function Mse(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return uM(mx)}function Tse(n,e){if(n==="click")return uM(e)}function Cse(n,e){if(n==="input"||n==="change")return uM(e)}function Pse(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var du=typeof Object.is=="function"?Object.is:Pse;function gx(n,e){if(du(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var a=Object.keys(n),o=Object.keys(e);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var s=a[o];if(!AI.call(e,s)||!du(n[s],e[s]))return!1}return!0}function U9(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function W9(n,e){var a=U9(n);n=0;for(var o;a;){if(a.nodeType===3){if(o=n+a.textContent.length,n<=e&&o>=e)return{node:a,offset:e-n};n=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=U9(a)}}function Uj(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?Uj(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function Wj(){for(var n=window,e=tE();e instanceof n.HTMLIFrameElement;){try{var a=typeof e.contentWindow.location.href=="string"}catch{a=!1}if(a)n=e.contentWindow;else break;e=tE(n.document)}return e}function mk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Ise(n){var e=Wj(),a=n.focusedElem,o=n.selectionRange;if(e!==a&&a&&a.ownerDocument&&Uj(a.ownerDocument.documentElement,a)){if(o!==null&&mk(a)){if(e=o.start,n=o.end,n===void 0&&(n=e),"selectionStart"in a)a.selectionStart=e,a.selectionEnd=Math.min(n,a.value.length);else if(n=(e=a.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=a.textContent.length,c=Math.min(o.start,s);o=o.end===void 0?c:Math.min(o.end,s),!n.extend&&c>o&&(s=o,o=c,c=s),s=W9(a,c);var d=W9(a,o);s&&d&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==d.node||n.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),c>o?(n.addRange(e),n.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),n.addRange(e)))}}for(e=[],n=a;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<e.length;a++)n=e[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Lse=Lh&&"documentMode"in document&&11>=document.documentMode,s0=null,GI=null,Ob=null,HI=!1;function V9(n,e,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;HI||s0==null||s0!==tE(o)||(o=s0,"selectionStart"in o&&mk(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Ob&&gx(Ob,o)||(Ob=o,o=lE(GI,"onSelect"),0<o.length&&(e=new hk("onSelect","select",null,e,a),n.push({event:e,listeners:o}),e.target=s0)))}function j3(n,e){var a={};return a[n.toLowerCase()]=e.toLowerCase(),a["Webkit"+n]="webkit"+e,a["Moz"+n]="moz"+e,a}var l0={animationend:j3("Animation","AnimationEnd"),animationiteration:j3("Animation","AnimationIteration"),animationstart:j3("Animation","AnimationStart"),transitionend:j3("Transition","TransitionEnd")},k5={},Vj={};Lh&&(Vj=document.createElement("div").style,"AnimationEvent"in window||(delete l0.animationend.animation,delete l0.animationiteration.animation,delete l0.animationstart.animation),"TransitionEvent"in window||delete l0.transitionend.transition);function dM(n){if(k5[n])return k5[n];if(!l0[n])return n;var e=l0[n],a;for(a in e)if(e.hasOwnProperty(a)&&a in Vj)return k5[n]=e[a];return n}var Gj=dM("animationend"),Hj=dM("animationiteration"),jj=dM("animationstart"),$j=dM("transitionend"),qj=new Map,G9="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wp(n,e){qj.set(n,e),Ng(e,[n])}for(var D5=0;D5<G9.length;D5++){var O5=G9[D5],Rse=O5.toLowerCase(),kse=O5[0].toUpperCase()+O5.slice(1);wp(Rse,"on"+kse)}wp(Gj,"onAnimationEnd");wp(Hj,"onAnimationIteration");wp(jj,"onAnimationStart");wp("dblclick","onDoubleClick");wp("focusin","onFocus");wp("focusout","onBlur");wp($j,"onTransitionEnd");z0("onMouseEnter",["mouseout","mouseover"]);z0("onMouseLeave",["mouseout","mouseover"]);z0("onPointerEnter",["pointerout","pointerover"]);z0("onPointerLeave",["pointerout","pointerover"]);Ng("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ng("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ng("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ng("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ng("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ng("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dse=new Set("cancel close invalid load scroll toggle".split(" ").concat(bb));function H9(n,e,a){var o=n.type||"unknown-event";n.currentTarget=a,Roe(o,e,void 0,n),n.currentTarget=null}function Xj(n,e){e=(e&4)!==0;for(var a=0;a<n.length;a++){var o=n[a],s=o.event;o=o.listeners;e:{var c=void 0;if(e)for(var d=o.length-1;0<=d;d--){var f=o[d],m=f.instance,y=f.currentTarget;if(f=f.listener,m!==c&&s.isPropagationStopped())break e;H9(s,f,y),c=m}else for(d=0;d<o.length;d++){if(f=o[d],m=f.instance,y=f.currentTarget,f=f.listener,m!==c&&s.isPropagationStopped())break e;H9(s,f,y),c=m}}}if(aE)throw n=BI,aE=!1,BI=null,n}function ir(n,e){var a=e[ZI];a===void 0&&(a=e[ZI]=new Set);var o=n+"__bubble";a.has(o)||(Zj(e,n,2,!1),a.add(o))}function z5(n,e,a){var o=0;e&&(o|=4),Zj(a,n,o,e)}var $3="_reactListening"+Math.random().toString(36).slice(2);function yx(n){if(!n[$3]){n[$3]=!0,nj.forEach(function(a){a!=="selectionchange"&&(Dse.has(a)||z5(a,!1,n),z5(a,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[$3]||(e[$3]=!0,z5("selectionchange",!1,e))}}function Zj(n,e,a,o){switch(Rj(e)){case 1:var s=Xoe;break;case 4:s=Zoe;break;default:s=uk}a=s.bind(null,e,a,n),s=void 0,!NI||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),o?s!==void 0?n.addEventListener(e,a,{capture:!0,passive:s}):n.addEventListener(e,a,!0):s!==void 0?n.addEventListener(e,a,{passive:s}):n.addEventListener(e,a,!1)}function F5(n,e,a,o,s){var c=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var f=o.stateNode.containerInfo;if(f===s||f.nodeType===8&&f.parentNode===s)break;if(d===4)for(d=o.return;d!==null;){var m=d.tag;if((m===3||m===4)&&(m=d.stateNode.containerInfo,m===s||m.nodeType===8&&m.parentNode===s))return;d=d.return}for(;f!==null;){if(d=ag(f),d===null)return;if(m=d.tag,m===5||m===6){o=c=d;continue e}f=f.parentNode}}o=o.return}vj(function(){var y=c,_=ok(a),w=[];e:{var A=qj.get(n);if(A!==void 0){var C=hk,I=n;switch(n){case"keypress":if(wA(a)===0)break e;case"keydown":case"keyup":C=use;break;case"focusin":I="focus",C=I5;break;case"focusout":I="blur",C=I5;break;case"beforeblur":case"afterblur":C=I5;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=R9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=Joe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=fse;break;case Gj:case Hj:case jj:C=tse;break;case $j:C=mse;break;case"scroll":C=Yoe;break;case"wheel":C=yse;break;case"copy":case"cut":case"paste":C=ase;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=D9}var k=(e&4)!==0,D=!k&&n==="scroll",L=k?A!==null?A+"Capture":null:A;k=[];for(var O=y,F;O!==null;){F=O;var B=F.stateNode;if(F.tag===5&&B!==null&&(F=B,L!==null&&(B=dx(O,L),B!=null&&k.push(vx(O,B,F)))),D)break;O=O.return}0<k.length&&(A=new C(A,I,null,a,_),w.push({event:A,listeners:k}))}}if(!(e&7)){e:{if(A=n==="mouseover"||n==="pointerover",C=n==="mouseout"||n==="pointerout",A&&a!==zI&&(I=a.relatedTarget||a.fromElement)&&(ag(I)||I[Rh]))break e;if((C||A)&&(A=_.window===_?_:(A=_.ownerDocument)?A.defaultView||A.parentWindow:window,C?(I=a.relatedTarget||a.toElement,C=y,I=I?ag(I):null,I!==null&&(D=Bg(I),I!==D||I.tag!==5&&I.tag!==6)&&(I=null)):(C=null,I=y),C!==I)){if(k=R9,B="onMouseLeave",L="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(k=D9,B="onPointerLeave",L="onPointerEnter",O="pointer"),D=C==null?A:c0(C),F=I==null?A:c0(I),A=new k(B,O+"leave",C,a,_),A.target=D,A.relatedTarget=F,B=null,ag(_)===y&&(k=new k(L,O+"enter",I,a,_),k.target=F,k.relatedTarget=D,B=k),D=B,C&&I)t:{for(k=C,L=I,O=0,F=k;F;F=bv(F))O++;for(F=0,B=L;B;B=bv(B))F++;for(;0<O-F;)k=bv(k),O--;for(;0<F-O;)L=bv(L),F--;for(;O--;){if(k===L||L!==null&&k===L.alternate)break t;k=bv(k),L=bv(L)}k=null}else k=null;C!==null&&j9(w,A,C,k,!1),I!==null&&D!==null&&j9(w,D,I,k,!0)}}e:{if(A=y?c0(y):window,C=A.nodeName&&A.nodeName.toLowerCase(),C==="select"||C==="input"&&A.type==="file")var G=Ase;else if(F9(A))if(Nj)G=Cse;else{G=Mse;var q=Ese}else(C=A.nodeName)&&C.toLowerCase()==="input"&&(A.type==="checkbox"||A.type==="radio")&&(G=Tse);if(G&&(G=G(n,y))){Fj(w,G,a,_);break e}q&&q(n,A,y),n==="focusout"&&(q=A._wrapperState)&&q.controlled&&A.type==="number"&&LI(A,"number",A.value)}switch(q=y?c0(y):window,n){case"focusin":(F9(q)||q.contentEditable==="true")&&(s0=q,GI=y,Ob=null);break;case"focusout":Ob=GI=s0=null;break;case"mousedown":HI=!0;break;case"contextmenu":case"mouseup":case"dragend":HI=!1,V9(w,a,_);break;case"selectionchange":if(Lse)break;case"keydown":case"keyup":V9(w,a,_)}var X;if(pk)e:{switch(n){case"compositionstart":var ee="onCompositionStart";break e;case"compositionend":ee="onCompositionEnd";break e;case"compositionupdate":ee="onCompositionUpdate";break e}ee=void 0}else o0?Oj(n,a)&&(ee="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(ee="onCompositionStart");ee&&(Dj&&a.locale!=="ko"&&(o0||ee!=="onCompositionStart"?ee==="onCompositionEnd"&&o0&&(X=kj()):(jf=_,dk="value"in jf?jf.value:jf.textContent,o0=!0)),q=lE(y,ee),0<q.length&&(ee=new k9(ee,n,null,a,_),w.push({event:ee,listeners:q}),X?ee.data=X:(X=zj(a),X!==null&&(ee.data=X)))),(X=_se?bse(n,a):xse(n,a))&&(y=lE(y,"onBeforeInput"),0<y.length&&(_=new k9("onBeforeInput","beforeinput",null,a,_),w.push({event:_,listeners:y}),_.data=X))}Xj(w,e)})}function vx(n,e,a){return{instance:n,listener:e,currentTarget:a}}function lE(n,e){for(var a=e+"Capture",o=[];n!==null;){var s=n,c=s.stateNode;s.tag===5&&c!==null&&(s=c,c=dx(n,a),c!=null&&o.unshift(vx(n,c,s)),c=dx(n,e),c!=null&&o.push(vx(n,c,s))),n=n.return}return o}function bv(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function j9(n,e,a,o,s){for(var c=e._reactName,d=[];a!==null&&a!==o;){var f=a,m=f.alternate,y=f.stateNode;if(m!==null&&m===o)break;f.tag===5&&y!==null&&(f=y,s?(m=dx(a,c),m!=null&&d.unshift(vx(a,m,f))):s||(m=dx(a,c),m!=null&&d.push(vx(a,m,f)))),a=a.return}d.length!==0&&n.push({event:e,listeners:d})}var Ose=/\r\n?/g,zse=/\u0000|\uFFFD/g;function $9(n){return(typeof n=="string"?n:""+n).replace(Ose,`
`).replace(zse,"")}function q3(n,e,a){if(e=$9(e),$9(n)!==e&&a)throw Error(hn(425))}function cE(){}var jI=null,$I=null;function qI(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var XI=typeof setTimeout=="function"?setTimeout:void 0,Fse=typeof clearTimeout=="function"?clearTimeout:void 0,q9=typeof Promise=="function"?Promise:void 0,Nse=typeof queueMicrotask=="function"?queueMicrotask:typeof q9<"u"?function(n){return q9.resolve(null).then(n).catch(Bse)}:XI;function Bse(n){setTimeout(function(){throw n})}function N5(n,e){var a=e,o=0;do{var s=a.nextSibling;if(n.removeChild(a),s&&s.nodeType===8)if(a=s.data,a==="/$"){if(o===0){n.removeChild(s),px(e);return}o--}else a!=="$"&&a!=="$?"&&a!=="$!"||o++;a=s}while(a);px(e)}function np(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function X9(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(e===0)return n;e--}else a==="/$"&&e++}n=n.previousSibling}return null}var s_=Math.random().toString(36).slice(2),ad="__reactFiber$"+s_,_x="__reactProps$"+s_,Rh="__reactContainer$"+s_,ZI="__reactEvents$"+s_,Use="__reactListeners$"+s_,Wse="__reactHandles$"+s_;function ag(n){var e=n[ad];if(e)return e;for(var a=n.parentNode;a;){if(e=a[Rh]||a[ad]){if(a=e.alternate,e.child!==null||a!==null&&a.child!==null)for(n=X9(n);n!==null;){if(a=n[ad])return a;n=X9(n)}return e}n=a,a=n.parentNode}return null}function pw(n){return n=n[ad]||n[Rh],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function c0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(hn(33))}function hM(n){return n[_x]||null}var YI=[],u0=-1;function Sp(n){return{current:n}}function sr(n){0>u0||(n.current=YI[u0],YI[u0]=null,u0--)}function er(n,e){u0++,YI[u0]=n.current,n.current=e}var pp={},bs=Sp(pp),gl=Sp(!1),Ag=pp;function F0(n,e){var a=n.type.contextTypes;if(!a)return pp;var o=n.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var s={},c;for(c in a)s[c]=e[c];return o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function yl(n){return n=n.childContextTypes,n!=null}function uE(){sr(gl),sr(bs)}function Z9(n,e,a){if(bs.current!==pp)throw Error(hn(168));er(bs,e),er(gl,a)}function Yj(n,e,a){var o=n.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return a;o=o.getChildContext();for(var s in o)if(!(s in e))throw Error(hn(108,Eoe(n)||"Unknown",s));return Rr({},a,o)}function dE(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||pp,Ag=bs.current,er(bs,n),er(gl,gl.current),!0}function Y9(n,e,a){var o=n.stateNode;if(!o)throw Error(hn(169));a?(n=Yj(n,e,Ag),o.__reactInternalMemoizedMergedChildContext=n,sr(gl),sr(bs),er(bs,n)):sr(gl),er(gl,a)}var mh=null,fM=!1,B5=!1;function Kj(n){mh===null?mh=[n]:mh.push(n)}function Vse(n){fM=!0,Kj(n)}function Ap(){if(!B5&&mh!==null){B5=!0;var n=0,e=Fi;try{var a=mh;for(Fi=1;n<a.length;n++){var o=a[n];do o=o(!0);while(o!==null)}mh=null,fM=!1}catch(s){throw mh!==null&&(mh=mh.slice(n+1)),wj(sk,Ap),s}finally{Fi=e,B5=!1}}return null}var d0=[],h0=0,hE=null,fE=0,yc=[],vc=0,Eg=null,xh=1,wh="";function jm(n,e){d0[h0++]=fE,d0[h0++]=hE,hE=n,fE=e}function Jj(n,e,a){yc[vc++]=xh,yc[vc++]=wh,yc[vc++]=Eg,Eg=n;var o=xh;n=wh;var s=32-su(o)-1;o&=~(1<<s),a+=1;var c=32-su(e)+s;if(30<c){var d=s-s%5;c=(o&(1<<d)-1).toString(32),o>>=d,s-=d,xh=1<<32-su(e)+s|a<<s|o,wh=c+n}else xh=1<<c|a<<s|o,wh=n}function gk(n){n.return!==null&&(jm(n,1),Jj(n,1,0))}function yk(n){for(;n===hE;)hE=d0[--h0],d0[h0]=null,fE=d0[--h0],d0[h0]=null;for(;n===Eg;)Eg=yc[--vc],yc[vc]=null,wh=yc[--vc],yc[vc]=null,xh=yc[--vc],yc[vc]=null}var Hl=null,Gl=null,yr=!1,nu=null;function Qj(n,e){var a=bc(5,null,null,0);a.elementType="DELETED",a.stateNode=e,a.return=n,e=n.deletions,e===null?(n.deletions=[a],n.flags|=16):e.push(a)}function K9(n,e){switch(n.tag){case 5:var a=n.type;return e=e.nodeType!==1||a.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Hl=n,Gl=np(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Hl=n,Gl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(a=Eg!==null?{id:xh,overflow:wh}:null,n.memoizedState={dehydrated:e,treeContext:a,retryLane:1073741824},a=bc(18,null,null,0),a.stateNode=e,a.return=n,n.child=a,Hl=n,Gl=null,!0):!1;default:return!1}}function KI(n){return(n.mode&1)!==0&&(n.flags&128)===0}function JI(n){if(yr){var e=Gl;if(e){var a=e;if(!K9(n,e)){if(KI(n))throw Error(hn(418));e=np(a.nextSibling);var o=Hl;e&&K9(n,e)?Qj(o,a):(n.flags=n.flags&-4097|2,yr=!1,Hl=n)}}else{if(KI(n))throw Error(hn(418));n.flags=n.flags&-4097|2,yr=!1,Hl=n}}}function J9(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Hl=n}function X3(n){if(n!==Hl)return!1;if(!yr)return J9(n),yr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!qI(n.type,n.memoizedProps)),e&&(e=Gl)){if(KI(n))throw e$(),Error(hn(418));for(;e;)Qj(n,e),e=np(e.nextSibling)}if(J9(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(hn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(e===0){Gl=np(n.nextSibling);break e}e--}else a!=="$"&&a!=="$!"&&a!=="$?"||e++}n=n.nextSibling}Gl=null}}else Gl=Hl?np(n.stateNode.nextSibling):null;return!0}function e$(){for(var n=Gl;n;)n=np(n.nextSibling)}function N0(){Gl=Hl=null,yr=!1}function vk(n){nu===null?nu=[n]:nu.push(n)}var Gse=Bh.ReactCurrentBatchConfig;function Jc(n,e){if(n&&n.defaultProps){e=Rr({},e),n=n.defaultProps;for(var a in n)e[a]===void 0&&(e[a]=n[a]);return e}return e}var pE=Sp(null),mE=null,f0=null,_k=null;function bk(){_k=f0=mE=null}function xk(n){var e=pE.current;sr(pE),n._currentValue=e}function QI(n,e,a){for(;n!==null;){var o=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),n===a)break;n=n.return}}function T0(n,e){mE=n,_k=f0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(ml=!0),n.firstContext=null)}function Sc(n){var e=n._currentValue;if(_k!==n)if(n={context:n,memoizedValue:e,next:null},f0===null){if(mE===null)throw Error(hn(308));f0=n,mE.dependencies={lanes:0,firstContext:n}}else f0=f0.next=n;return e}var ig=null;function wk(n){ig===null?ig=[n]:ig.push(n)}function t$(n,e,a,o){var s=e.interleaved;return s===null?(a.next=a,wk(e)):(a.next=s.next,s.next=a),e.interleaved=a,kh(n,o)}function kh(n,e){n.lanes|=e;var a=n.alternate;for(a!==null&&(a.lanes|=e),a=n,n=n.return;n!==null;)n.childLanes|=e,a=n.alternate,a!==null&&(a.childLanes|=e),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Wf=!1;function Sk(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n$(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ch(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ap(n,e,a){var o=n.updateQueue;if(o===null)return null;if(o=o.shared,si&2){var s=o.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),o.pending=e,kh(n,a)}return s=o.interleaved,s===null?(e.next=e,wk(o)):(e.next=s.next,s.next=e),o.interleaved=e,kh(n,a)}function SA(n,e,a){if(e=e.updateQueue,e!==null&&(e=e.shared,(a&4194240)!==0)){var o=e.lanes;o&=n.pendingLanes,a|=o,e.lanes=a,lk(n,a)}}function Q9(n,e){var a=n.updateQueue,o=n.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var s=null,c=null;if(a=a.firstBaseUpdate,a!==null){do{var d={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};c===null?s=c=d:c=c.next=d,a=a.next}while(a!==null);c===null?s=c=e:c=c.next=e}else s=c=e;a={baseState:o.baseState,firstBaseUpdate:s,lastBaseUpdate:c,shared:o.shared,effects:o.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=e:n.next=e,a.lastBaseUpdate=e}function gE(n,e,a,o){var s=n.updateQueue;Wf=!1;var c=s.firstBaseUpdate,d=s.lastBaseUpdate,f=s.shared.pending;if(f!==null){s.shared.pending=null;var m=f,y=m.next;m.next=null,d===null?c=y:d.next=y,d=m;var _=n.alternate;_!==null&&(_=_.updateQueue,f=_.lastBaseUpdate,f!==d&&(f===null?_.firstBaseUpdate=y:f.next=y,_.lastBaseUpdate=m))}if(c!==null){var w=s.baseState;d=0,_=y=m=null,f=c;do{var A=f.lane,C=f.eventTime;if((o&A)===A){_!==null&&(_=_.next={eventTime:C,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var I=n,k=f;switch(A=e,C=a,k.tag){case 1:if(I=k.payload,typeof I=="function"){w=I.call(C,w,A);break e}w=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=k.payload,A=typeof I=="function"?I.call(C,w,A):I,A==null)break e;w=Rr({},w,A);break e;case 2:Wf=!0}}f.callback!==null&&f.lane!==0&&(n.flags|=64,A=s.effects,A===null?s.effects=[f]:A.push(f))}else C={eventTime:C,lane:A,tag:f.tag,payload:f.payload,callback:f.callback,next:null},_===null?(y=_=C,m=w):_=_.next=C,d|=A;if(f=f.next,f===null){if(f=s.shared.pending,f===null)break;A=f,f=A.next,A.next=null,s.lastBaseUpdate=A,s.shared.pending=null}}while(1);if(_===null&&(m=w),s.baseState=m,s.firstBaseUpdate=y,s.lastBaseUpdate=_,e=s.shared.interleaved,e!==null){s=e;do d|=s.lane,s=s.next;while(s!==e)}else c===null&&(s.shared.lanes=0);Tg|=d,n.lanes=d,n.memoizedState=w}}function eU(n,e,a){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var o=n[e],s=o.callback;if(s!==null){if(o.callback=null,o=a,typeof s!="function")throw Error(hn(191,s));s.call(o)}}}var a$=new tj.Component().refs;function eL(n,e,a,o){e=n.memoizedState,a=a(o,e),a=a==null?e:Rr({},e,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var pM={isMounted:function(n){return(n=n._reactInternals)?Bg(n)===n:!1},enqueueSetState:function(n,e,a){n=n._reactInternals;var o=Us(),s=rp(n),c=Ch(o,s);c.payload=e,a!=null&&(c.callback=a),e=ap(n,c,s),e!==null&&(lu(e,n,s,o),SA(e,n,s))},enqueueReplaceState:function(n,e,a){n=n._reactInternals;var o=Us(),s=rp(n),c=Ch(o,s);c.tag=1,c.payload=e,a!=null&&(c.callback=a),e=ap(n,c,s),e!==null&&(lu(e,n,s,o),SA(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var a=Us(),o=rp(n),s=Ch(a,o);s.tag=2,e!=null&&(s.callback=e),e=ap(n,s,o),e!==null&&(lu(e,n,o,a),SA(e,n,o))}};function tU(n,e,a,o,s,c,d){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(o,c,d):e.prototype&&e.prototype.isPureReactComponent?!gx(a,o)||!gx(s,c):!0}function i$(n,e,a){var o=!1,s=pp,c=e.contextType;return typeof c=="object"&&c!==null?c=Sc(c):(s=yl(e)?Ag:bs.current,o=e.contextTypes,c=(o=o!=null)?F0(n,s):pp),e=new e(a,c),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=pM,n.stateNode=e,e._reactInternals=n,o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=c),e}function nU(n,e,a,o){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(a,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(a,o),e.state!==n&&pM.enqueueReplaceState(e,e.state,null)}function tL(n,e,a,o){var s=n.stateNode;s.props=a,s.state=n.memoizedState,s.refs=a$,Sk(n);var c=e.contextType;typeof c=="object"&&c!==null?s.context=Sc(c):(c=yl(e)?Ag:bs.current,s.context=F0(n,c)),s.state=n.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(eL(n,e,c,a),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&pM.enqueueReplaceState(s,s.state,null),gE(n,a,s,o),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function z1(n,e,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(hn(309));var o=a.stateNode}if(!o)throw Error(hn(147,n));var s=o,c=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var f=s.refs;f===a$&&(f=s.refs={}),d===null?delete f[c]:f[c]=d},e._stringRef=c,e)}if(typeof n!="string")throw Error(hn(284));if(!a._owner)throw Error(hn(290,n))}return n}function Z3(n,e){throw n=Object.prototype.toString.call(e),Error(hn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function aU(n){var e=n._init;return e(n._payload)}function r$(n){function e(L,O){if(n){var F=L.deletions;F===null?(L.deletions=[O],L.flags|=16):F.push(O)}}function a(L,O){if(!n)return null;for(;O!==null;)e(L,O),O=O.sibling;return null}function o(L,O){for(L=new Map;O!==null;)O.key!==null?L.set(O.key,O):L.set(O.index,O),O=O.sibling;return L}function s(L,O){return L=op(L,O),L.index=0,L.sibling=null,L}function c(L,O,F){return L.index=F,n?(F=L.alternate,F!==null?(F=F.index,F<O?(L.flags|=2,O):F):(L.flags|=2,O)):(L.flags|=1048576,O)}function d(L){return n&&L.alternate===null&&(L.flags|=2),L}function f(L,O,F,B){return O===null||O.tag!==6?(O=$5(F,L.mode,B),O.return=L,O):(O=s(O,F),O.return=L,O)}function m(L,O,F,B){var G=F.type;return G===r0?_(L,O,F.props.children,B,F.key):O!==null&&(O.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Uf&&aU(G)===O.type)?(B=s(O,F.props),B.ref=z1(L,O,F),B.return=L,B):(B=PA(F.type,F.key,F.props,null,L.mode,B),B.ref=z1(L,O,F),B.return=L,B)}function y(L,O,F,B){return O===null||O.tag!==4||O.stateNode.containerInfo!==F.containerInfo||O.stateNode.implementation!==F.implementation?(O=q5(F,L.mode,B),O.return=L,O):(O=s(O,F.children||[]),O.return=L,O)}function _(L,O,F,B,G){return O===null||O.tag!==7?(O=gg(F,L.mode,B,G),O.return=L,O):(O=s(O,F),O.return=L,O)}function w(L,O,F){if(typeof O=="string"&&O!==""||typeof O=="number")return O=$5(""+O,L.mode,F),O.return=L,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case N3:return F=PA(O.type,O.key,O.props,null,L.mode,F),F.ref=z1(L,null,O),F.return=L,F;case i0:return O=q5(O,L.mode,F),O.return=L,O;case Uf:var B=O._init;return w(L,B(O._payload),F)}if(vb(O)||L1(O))return O=gg(O,L.mode,F,null),O.return=L,O;Z3(L,O)}return null}function A(L,O,F,B){var G=O!==null?O.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return G!==null?null:f(L,O,""+F,B);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case N3:return F.key===G?m(L,O,F,B):null;case i0:return F.key===G?y(L,O,F,B):null;case Uf:return G=F._init,A(L,O,G(F._payload),B)}if(vb(F)||L1(F))return G!==null?null:_(L,O,F,B,null);Z3(L,F)}return null}function C(L,O,F,B,G){if(typeof B=="string"&&B!==""||typeof B=="number")return L=L.get(F)||null,f(O,L,""+B,G);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case N3:return L=L.get(B.key===null?F:B.key)||null,m(O,L,B,G);case i0:return L=L.get(B.key===null?F:B.key)||null,y(O,L,B,G);case Uf:var q=B._init;return C(L,O,F,q(B._payload),G)}if(vb(B)||L1(B))return L=L.get(F)||null,_(O,L,B,G,null);Z3(O,B)}return null}function I(L,O,F,B){for(var G=null,q=null,X=O,ee=O=0,V=null;X!==null&&ee<F.length;ee++){X.index>ee?(V=X,X=null):V=X.sibling;var Q=A(L,X,F[ee],B);if(Q===null){X===null&&(X=V);break}n&&X&&Q.alternate===null&&e(L,X),O=c(Q,O,ee),q===null?G=Q:q.sibling=Q,q=Q,X=V}if(ee===F.length)return a(L,X),yr&&jm(L,ee),G;if(X===null){for(;ee<F.length;ee++)X=w(L,F[ee],B),X!==null&&(O=c(X,O,ee),q===null?G=X:q.sibling=X,q=X);return yr&&jm(L,ee),G}for(X=o(L,X);ee<F.length;ee++)V=C(X,L,ee,F[ee],B),V!==null&&(n&&V.alternate!==null&&X.delete(V.key===null?ee:V.key),O=c(V,O,ee),q===null?G=V:q.sibling=V,q=V);return n&&X.forEach(function(me){return e(L,me)}),yr&&jm(L,ee),G}function k(L,O,F,B){var G=L1(F);if(typeof G!="function")throw Error(hn(150));if(F=G.call(F),F==null)throw Error(hn(151));for(var q=G=null,X=O,ee=O=0,V=null,Q=F.next();X!==null&&!Q.done;ee++,Q=F.next()){X.index>ee?(V=X,X=null):V=X.sibling;var me=A(L,X,Q.value,B);if(me===null){X===null&&(X=V);break}n&&X&&me.alternate===null&&e(L,X),O=c(me,O,ee),q===null?G=me:q.sibling=me,q=me,X=V}if(Q.done)return a(L,X),yr&&jm(L,ee),G;if(X===null){for(;!Q.done;ee++,Q=F.next())Q=w(L,Q.value,B),Q!==null&&(O=c(Q,O,ee),q===null?G=Q:q.sibling=Q,q=Q);return yr&&jm(L,ee),G}for(X=o(L,X);!Q.done;ee++,Q=F.next())Q=C(X,L,ee,Q.value,B),Q!==null&&(n&&Q.alternate!==null&&X.delete(Q.key===null?ee:Q.key),O=c(Q,O,ee),q===null?G=Q:q.sibling=Q,q=Q);return n&&X.forEach(function(pe){return e(L,pe)}),yr&&jm(L,ee),G}function D(L,O,F,B){if(typeof F=="object"&&F!==null&&F.type===r0&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case N3:e:{for(var G=F.key,q=O;q!==null;){if(q.key===G){if(G=F.type,G===r0){if(q.tag===7){a(L,q.sibling),O=s(q,F.props.children),O.return=L,L=O;break e}}else if(q.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Uf&&aU(G)===q.type){a(L,q.sibling),O=s(q,F.props),O.ref=z1(L,q,F),O.return=L,L=O;break e}a(L,q);break}else e(L,q);q=q.sibling}F.type===r0?(O=gg(F.props.children,L.mode,B,F.key),O.return=L,L=O):(B=PA(F.type,F.key,F.props,null,L.mode,B),B.ref=z1(L,O,F),B.return=L,L=B)}return d(L);case i0:e:{for(q=F.key;O!==null;){if(O.key===q)if(O.tag===4&&O.stateNode.containerInfo===F.containerInfo&&O.stateNode.implementation===F.implementation){a(L,O.sibling),O=s(O,F.children||[]),O.return=L,L=O;break e}else{a(L,O);break}else e(L,O);O=O.sibling}O=q5(F,L.mode,B),O.return=L,L=O}return d(L);case Uf:return q=F._init,D(L,O,q(F._payload),B)}if(vb(F))return I(L,O,F,B);if(L1(F))return k(L,O,F,B);Z3(L,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,O!==null&&O.tag===6?(a(L,O.sibling),O=s(O,F),O.return=L,L=O):(a(L,O),O=$5(F,L.mode,B),O.return=L,L=O),d(L)):a(L,O)}return D}var B0=r$(!0),o$=r$(!1),mw={},cd=Sp(mw),bx=Sp(mw),xx=Sp(mw);function rg(n){if(n===mw)throw Error(hn(174));return n}function Ak(n,e){switch(er(xx,e),er(bx,n),er(cd,mw),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:kI(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=kI(e,n)}sr(cd),er(cd,e)}function U0(){sr(cd),sr(bx),sr(xx)}function s$(n){rg(xx.current);var e=rg(cd.current),a=kI(e,n.type);e!==a&&(er(bx,n),er(cd,a))}function Ek(n){bx.current===n&&(sr(cd),sr(bx))}var Tr=Sp(0);function yE(n){for(var e=n;e!==null;){if(e.tag===13){var a=e.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var U5=[];function Mk(){for(var n=0;n<U5.length;n++)U5[n]._workInProgressVersionPrimary=null;U5.length=0}var AA=Bh.ReactCurrentDispatcher,W5=Bh.ReactCurrentBatchConfig,Mg=0,Ir=null,Mo=null,zo=null,vE=!1,zb=!1,wx=0,Hse=0;function ls(){throw Error(hn(321))}function Tk(n,e){if(e===null)return!1;for(var a=0;a<e.length&&a<n.length;a++)if(!du(n[a],e[a]))return!1;return!0}function Ck(n,e,a,o,s,c){if(Mg=c,Ir=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,AA.current=n===null||n.memoizedState===null?Xse:Zse,n=a(o,s),zb){c=0;do{if(zb=!1,wx=0,25<=c)throw Error(hn(301));c+=1,zo=Mo=null,e.updateQueue=null,AA.current=Yse,n=a(o,s)}while(zb)}if(AA.current=_E,e=Mo!==null&&Mo.next!==null,Mg=0,zo=Mo=Ir=null,vE=!1,e)throw Error(hn(300));return n}function Pk(){var n=wx!==0;return wx=0,n}function Qu(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zo===null?Ir.memoizedState=zo=n:zo=zo.next=n,zo}function Ac(){if(Mo===null){var n=Ir.alternate;n=n!==null?n.memoizedState:null}else n=Mo.next;var e=zo===null?Ir.memoizedState:zo.next;if(e!==null)zo=e,Mo=n;else{if(n===null)throw Error(hn(310));Mo=n,n={memoizedState:Mo.memoizedState,baseState:Mo.baseState,baseQueue:Mo.baseQueue,queue:Mo.queue,next:null},zo===null?Ir.memoizedState=zo=n:zo=zo.next=n}return zo}function Sx(n,e){return typeof e=="function"?e(n):e}function V5(n){var e=Ac(),a=e.queue;if(a===null)throw Error(hn(311));a.lastRenderedReducer=n;var o=Mo,s=o.baseQueue,c=a.pending;if(c!==null){if(s!==null){var d=s.next;s.next=c.next,c.next=d}o.baseQueue=s=c,a.pending=null}if(s!==null){c=s.next,o=o.baseState;var f=d=null,m=null,y=c;do{var _=y.lane;if((Mg&_)===_)m!==null&&(m=m.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),o=y.hasEagerState?y.eagerState:n(o,y.action);else{var w={lane:_,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};m===null?(f=m=w,d=o):m=m.next=w,Ir.lanes|=_,Tg|=_}y=y.next}while(y!==null&&y!==c);m===null?d=o:m.next=f,du(o,e.memoizedState)||(ml=!0),e.memoizedState=o,e.baseState=d,e.baseQueue=m,a.lastRenderedState=o}if(n=a.interleaved,n!==null){s=n;do c=s.lane,Ir.lanes|=c,Tg|=c,s=s.next;while(s!==n)}else s===null&&(a.lanes=0);return[e.memoizedState,a.dispatch]}function G5(n){var e=Ac(),a=e.queue;if(a===null)throw Error(hn(311));a.lastRenderedReducer=n;var o=a.dispatch,s=a.pending,c=e.memoizedState;if(s!==null){a.pending=null;var d=s=s.next;do c=n(c,d.action),d=d.next;while(d!==s);du(c,e.memoizedState)||(ml=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),a.lastRenderedState=c}return[c,o]}function l$(){}function c$(n,e){var a=Ir,o=Ac(),s=e(),c=!du(o.memoizedState,s);if(c&&(o.memoizedState=s,ml=!0),o=o.queue,Ik(h$.bind(null,a,o,n),[n]),o.getSnapshot!==e||c||zo!==null&&zo.memoizedState.tag&1){if(a.flags|=2048,Ax(9,d$.bind(null,a,o,s,e),void 0,null),No===null)throw Error(hn(349));Mg&30||u$(a,e,s)}return s}function u$(n,e,a){n.flags|=16384,n={getSnapshot:e,value:a},e=Ir.updateQueue,e===null?(e={lastEffect:null,stores:null},Ir.updateQueue=e,e.stores=[n]):(a=e.stores,a===null?e.stores=[n]:a.push(n))}function d$(n,e,a,o){e.value=a,e.getSnapshot=o,f$(e)&&p$(n)}function h$(n,e,a){return a(function(){f$(e)&&p$(n)})}function f$(n){var e=n.getSnapshot;n=n.value;try{var a=e();return!du(n,a)}catch{return!0}}function p$(n){var e=kh(n,1);e!==null&&lu(e,n,1,-1)}function iU(n){var e=Qu();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sx,lastRenderedState:n},e.queue=n,n=n.dispatch=qse.bind(null,Ir,n),[e.memoizedState,n]}function Ax(n,e,a,o){return n={tag:n,create:e,destroy:a,deps:o,next:null},e=Ir.updateQueue,e===null?(e={lastEffect:null,stores:null},Ir.updateQueue=e,e.lastEffect=n.next=n):(a=e.lastEffect,a===null?e.lastEffect=n.next=n:(o=a.next,a.next=n,n.next=o,e.lastEffect=n)),n}function m$(){return Ac().memoizedState}function EA(n,e,a,o){var s=Qu();Ir.flags|=n,s.memoizedState=Ax(1|e,a,void 0,o===void 0?null:o)}function mM(n,e,a,o){var s=Ac();o=o===void 0?null:o;var c=void 0;if(Mo!==null){var d=Mo.memoizedState;if(c=d.destroy,o!==null&&Tk(o,d.deps)){s.memoizedState=Ax(e,a,c,o);return}}Ir.flags|=n,s.memoizedState=Ax(1|e,a,c,o)}function rU(n,e){return EA(8390656,8,n,e)}function Ik(n,e){return mM(2048,8,n,e)}function g$(n,e){return mM(4,2,n,e)}function y$(n,e){return mM(4,4,n,e)}function v$(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function _$(n,e,a){return a=a!=null?a.concat([n]):null,mM(4,4,v$.bind(null,e,n),a)}function Lk(){}function b$(n,e){var a=Ac();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Tk(e,o[1])?o[0]:(a.memoizedState=[n,e],n)}function x$(n,e){var a=Ac();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Tk(e,o[1])?o[0]:(n=n(),a.memoizedState=[n,e],n)}function w$(n,e,a){return Mg&21?(du(a,e)||(a=Ej(),Ir.lanes|=a,Tg|=a,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,ml=!0),n.memoizedState=a)}function jse(n,e){var a=Fi;Fi=a!==0&&4>a?a:4,n(!0);var o=W5.transition;W5.transition={};try{n(!1),e()}finally{Fi=a,W5.transition=o}}function S$(){return Ac().memoizedState}function $se(n,e,a){var o=rp(n);if(a={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null},A$(n))E$(e,a);else if(a=t$(n,e,a,o),a!==null){var s=Us();lu(a,n,o,s),M$(a,e,o)}}function qse(n,e,a){var o=rp(n),s={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null};if(A$(n))E$(e,s);else{var c=n.alternate;if(n.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,f=c(d,a);if(s.hasEagerState=!0,s.eagerState=f,du(f,d)){var m=e.interleaved;m===null?(s.next=s,wk(e)):(s.next=m.next,m.next=s),e.interleaved=s;return}}catch{}finally{}a=t$(n,e,s,o),a!==null&&(s=Us(),lu(a,n,o,s),M$(a,e,o))}}function A$(n){var e=n.alternate;return n===Ir||e!==null&&e===Ir}function E$(n,e){zb=vE=!0;var a=n.pending;a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e}function M$(n,e,a){if(a&4194240){var o=e.lanes;o&=n.pendingLanes,a|=o,e.lanes=a,lk(n,a)}}var _E={readContext:Sc,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useInsertionEffect:ls,useLayoutEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useMutableSource:ls,useSyncExternalStore:ls,useId:ls,unstable_isNewReconciler:!1},Xse={readContext:Sc,useCallback:function(n,e){return Qu().memoizedState=[n,e===void 0?null:e],n},useContext:Sc,useEffect:rU,useImperativeHandle:function(n,e,a){return a=a!=null?a.concat([n]):null,EA(4194308,4,v$.bind(null,e,n),a)},useLayoutEffect:function(n,e){return EA(4194308,4,n,e)},useInsertionEffect:function(n,e){return EA(4,2,n,e)},useMemo:function(n,e){var a=Qu();return e=e===void 0?null:e,n=n(),a.memoizedState=[n,e],n},useReducer:function(n,e,a){var o=Qu();return e=a!==void 0?a(e):e,o.memoizedState=o.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},o.queue=n,n=n.dispatch=$se.bind(null,Ir,n),[o.memoizedState,n]},useRef:function(n){var e=Qu();return n={current:n},e.memoizedState=n},useState:iU,useDebugValue:Lk,useDeferredValue:function(n){return Qu().memoizedState=n},useTransition:function(){var n=iU(!1),e=n[0];return n=jse.bind(null,n[1]),Qu().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,a){var o=Ir,s=Qu();if(yr){if(a===void 0)throw Error(hn(407));a=a()}else{if(a=e(),No===null)throw Error(hn(349));Mg&30||u$(o,e,a)}s.memoizedState=a;var c={value:a,getSnapshot:e};return s.queue=c,rU(h$.bind(null,o,c,n),[n]),o.flags|=2048,Ax(9,d$.bind(null,o,c,a,e),void 0,null),a},useId:function(){var n=Qu(),e=No.identifierPrefix;if(yr){var a=wh,o=xh;a=(o&~(1<<32-su(o)-1)).toString(32)+a,e=":"+e+"R"+a,a=wx++,0<a&&(e+="H"+a.toString(32)),e+=":"}else a=Hse++,e=":"+e+"r"+a.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Zse={readContext:Sc,useCallback:b$,useContext:Sc,useEffect:Ik,useImperativeHandle:_$,useInsertionEffect:g$,useLayoutEffect:y$,useMemo:x$,useReducer:V5,useRef:m$,useState:function(){return V5(Sx)},useDebugValue:Lk,useDeferredValue:function(n){var e=Ac();return w$(e,Mo.memoizedState,n)},useTransition:function(){var n=V5(Sx)[0],e=Ac().memoizedState;return[n,e]},useMutableSource:l$,useSyncExternalStore:c$,useId:S$,unstable_isNewReconciler:!1},Yse={readContext:Sc,useCallback:b$,useContext:Sc,useEffect:Ik,useImperativeHandle:_$,useInsertionEffect:g$,useLayoutEffect:y$,useMemo:x$,useReducer:G5,useRef:m$,useState:function(){return G5(Sx)},useDebugValue:Lk,useDeferredValue:function(n){var e=Ac();return Mo===null?e.memoizedState=n:w$(e,Mo.memoizedState,n)},useTransition:function(){var n=G5(Sx)[0],e=Ac().memoizedState;return[n,e]},useMutableSource:l$,useSyncExternalStore:c$,useId:S$,unstable_isNewReconciler:!1};function W0(n,e){try{var a="",o=e;do a+=Aoe(o),o=o.return;while(o);var s=a}catch(c){s=`
Error generating stack: `+c.message+`
`+c.stack}return{value:n,source:e,stack:s,digest:null}}function H5(n,e,a){return{value:n,source:null,stack:a??null,digest:e??null}}function nL(n,e){try{console.error(e.value)}catch(a){setTimeout(function(){throw a})}}var Kse=typeof WeakMap=="function"?WeakMap:Map;function T$(n,e,a){a=Ch(-1,a),a.tag=3,a.payload={element:null};var o=e.value;return a.callback=function(){xE||(xE=!0,hL=o),nL(n,e)},a}function C$(n,e,a){a=Ch(-1,a),a.tag=3;var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var s=e.value;a.payload=function(){return o(s)},a.callback=function(){nL(n,e)}}var c=n.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(a.callback=function(){nL(n,e),typeof o!="function"&&(ip===null?ip=new Set([this]):ip.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),a}function oU(n,e,a){var o=n.pingCache;if(o===null){o=n.pingCache=new Kse;var s=new Set;o.set(e,s)}else s=o.get(e),s===void 0&&(s=new Set,o.set(e,s));s.has(a)||(s.add(a),n=dle.bind(null,n,e,a),e.then(n,n))}function sU(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function lU(n,e,a,o,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(e=Ch(-1,1),e.tag=2,ap(a,e,1))),a.lanes|=1),n)}var Jse=Bh.ReactCurrentOwner,ml=!1;function Bs(n,e,a,o){e.child=n===null?o$(e,null,a,o):B0(e,n.child,a,o)}function cU(n,e,a,o,s){a=a.render;var c=e.ref;return T0(e,s),o=Ck(n,e,a,o,c,s),a=Pk(),n!==null&&!ml?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Dh(n,e,s)):(yr&&a&&gk(e),e.flags|=1,Bs(n,e,o,s),e.child)}function uU(n,e,a,o,s){if(n===null){var c=a.type;return typeof c=="function"&&!Bk(c)&&c.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(e.tag=15,e.type=c,P$(n,e,c,o,s)):(n=PA(a.type,null,o,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(c=n.child,!(n.lanes&s)){var d=c.memoizedProps;if(a=a.compare,a=a!==null?a:gx,a(d,o)&&n.ref===e.ref)return Dh(n,e,s)}return e.flags|=1,n=op(c,o),n.ref=e.ref,n.return=e,e.child=n}function P$(n,e,a,o,s){if(n!==null){var c=n.memoizedProps;if(gx(c,o)&&n.ref===e.ref)if(ml=!1,e.pendingProps=o=c,(n.lanes&s)!==0)n.flags&131072&&(ml=!0);else return e.lanes=n.lanes,Dh(n,e,s)}return aL(n,e,a,o,s)}function I$(n,e,a){var o=e.pendingProps,s=o.children,c=n!==null?n.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},er(m0,Fl),Fl|=a;else{if(!(a&1073741824))return n=c!==null?c.baseLanes|a:a,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,er(m0,Fl),Fl|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:a,er(m0,Fl),Fl|=o}else c!==null?(o=c.baseLanes|a,e.memoizedState=null):o=a,er(m0,Fl),Fl|=o;return Bs(n,e,s,a),e.child}function L$(n,e){var a=e.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(e.flags|=512,e.flags|=2097152)}function aL(n,e,a,o,s){var c=yl(a)?Ag:bs.current;return c=F0(e,c),T0(e,s),a=Ck(n,e,a,o,c,s),o=Pk(),n!==null&&!ml?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Dh(n,e,s)):(yr&&o&&gk(e),e.flags|=1,Bs(n,e,a,s),e.child)}function dU(n,e,a,o,s){if(yl(a)){var c=!0;dE(e)}else c=!1;if(T0(e,s),e.stateNode===null)MA(n,e),i$(e,a,o),tL(e,a,o,s),o=!0;else if(n===null){var d=e.stateNode,f=e.memoizedProps;d.props=f;var m=d.context,y=a.contextType;typeof y=="object"&&y!==null?y=Sc(y):(y=yl(a)?Ag:bs.current,y=F0(e,y));var _=a.getDerivedStateFromProps,w=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";w||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==o||m!==y)&&nU(e,d,o,y),Wf=!1;var A=e.memoizedState;d.state=A,gE(e,o,d,s),m=e.memoizedState,f!==o||A!==m||gl.current||Wf?(typeof _=="function"&&(eL(e,a,_,o),m=e.memoizedState),(f=Wf||tU(e,a,f,o,A,m,y))?(w||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=m),d.props=o,d.state=m,d.context=y,o=f):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{d=e.stateNode,n$(n,e),f=e.memoizedProps,y=e.type===e.elementType?f:Jc(e.type,f),d.props=y,w=e.pendingProps,A=d.context,m=a.contextType,typeof m=="object"&&m!==null?m=Sc(m):(m=yl(a)?Ag:bs.current,m=F0(e,m));var C=a.getDerivedStateFromProps;(_=typeof C=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==w||A!==m)&&nU(e,d,o,m),Wf=!1,A=e.memoizedState,d.state=A,gE(e,o,d,s);var I=e.memoizedState;f!==w||A!==I||gl.current||Wf?(typeof C=="function"&&(eL(e,a,C,o),I=e.memoizedState),(y=Wf||tU(e,a,y,o,A,I,m)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,I,m),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,I,m)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&A===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&A===n.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=I),d.props=o,d.state=I,d.context=m,o=y):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&A===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&A===n.memoizedState||(e.flags|=1024),o=!1)}return iL(n,e,a,o,c,s)}function iL(n,e,a,o,s,c){L$(n,e);var d=(e.flags&128)!==0;if(!o&&!d)return s&&Y9(e,a,!1),Dh(n,e,c);o=e.stateNode,Jse.current=e;var f=d&&typeof a.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,n!==null&&d?(e.child=B0(e,n.child,null,c),e.child=B0(e,null,f,c)):Bs(n,e,f,c),e.memoizedState=o.state,s&&Y9(e,a,!0),e.child}function R$(n){var e=n.stateNode;e.pendingContext?Z9(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Z9(n,e.context,!1),Ak(n,e.containerInfo)}function hU(n,e,a,o,s){return N0(),vk(s),e.flags|=256,Bs(n,e,a,o),e.child}var rL={dehydrated:null,treeContext:null,retryLane:0};function oL(n){return{baseLanes:n,cachePool:null,transitions:null}}function k$(n,e,a){var o=e.pendingProps,s=Tr.current,c=!1,d=(e.flags&128)!==0,f;if((f=d)||(f=n!==null&&n.memoizedState===null?!1:(s&2)!==0),f?(c=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),er(Tr,s&1),n===null)return JI(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=o.children,n=o.fallback,c?(o=e.mode,c=e.child,d={mode:"hidden",children:d},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=vM(d,o,0,null),n=gg(n,o,a,null),c.return=e,n.return=e,c.sibling=n,e.child=c,e.child.memoizedState=oL(a),e.memoizedState=rL,n):Rk(e,d));if(s=n.memoizedState,s!==null&&(f=s.dehydrated,f!==null))return Qse(n,e,d,o,f,s,a);if(c){c=o.fallback,d=e.mode,s=n.child,f=s.sibling;var m={mode:"hidden",children:o.children};return!(d&1)&&e.child!==s?(o=e.child,o.childLanes=0,o.pendingProps=m,e.deletions=null):(o=op(s,m),o.subtreeFlags=s.subtreeFlags&14680064),f!==null?c=op(f,c):(c=gg(c,d,a,null),c.flags|=2),c.return=e,o.return=e,o.sibling=c,e.child=o,o=c,c=e.child,d=n.child.memoizedState,d=d===null?oL(a):{baseLanes:d.baseLanes|a,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=n.childLanes&~a,e.memoizedState=rL,o}return c=n.child,n=c.sibling,o=op(c,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=a),o.return=e,o.sibling=null,n!==null&&(a=e.deletions,a===null?(e.deletions=[n],e.flags|=16):a.push(n)),e.child=o,e.memoizedState=null,o}function Rk(n,e){return e=vM({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Y3(n,e,a,o){return o!==null&&vk(o),B0(e,n.child,null,a),n=Rk(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Qse(n,e,a,o,s,c,d){if(a)return e.flags&256?(e.flags&=-257,o=H5(Error(hn(422))),Y3(n,e,d,o)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(c=o.fallback,s=e.mode,o=vM({mode:"visible",children:o.children},s,0,null),c=gg(c,s,d,null),c.flags|=2,o.return=e,c.return=e,o.sibling=c,e.child=o,e.mode&1&&B0(e,n.child,null,d),e.child.memoizedState=oL(d),e.memoizedState=rL,c);if(!(e.mode&1))return Y3(n,e,d,null);if(s.data==="$!"){if(o=s.nextSibling&&s.nextSibling.dataset,o)var f=o.dgst;return o=f,c=Error(hn(419)),o=H5(c,o,void 0),Y3(n,e,d,o)}if(f=(d&n.childLanes)!==0,ml||f){if(o=No,o!==null){switch(d&-d){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(o.suspendedLanes|d)?0:s,s!==0&&s!==c.retryLane&&(c.retryLane=s,kh(n,s),lu(o,n,s,-1))}return Nk(),o=H5(Error(hn(421))),Y3(n,e,d,o)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=hle.bind(null,n),s._reactRetry=e,null):(n=c.treeContext,Gl=np(s.nextSibling),Hl=e,yr=!0,nu=null,n!==null&&(yc[vc++]=xh,yc[vc++]=wh,yc[vc++]=Eg,xh=n.id,wh=n.overflow,Eg=e),e=Rk(e,o.children),e.flags|=4096,e)}function fU(n,e,a){n.lanes|=e;var o=n.alternate;o!==null&&(o.lanes|=e),QI(n.return,e,a)}function j5(n,e,a,o,s){var c=n.memoizedState;c===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:s}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=a,c.tailMode=s)}function D$(n,e,a){var o=e.pendingProps,s=o.revealOrder,c=o.tail;if(Bs(n,e,o.children,a),o=Tr.current,o&2)o=o&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&fU(n,a,e);else if(n.tag===19)fU(n,a,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}o&=1}if(er(Tr,o),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(a=e.child,s=null;a!==null;)n=a.alternate,n!==null&&yE(n)===null&&(s=a),a=a.sibling;a=s,a===null?(s=e.child,e.child=null):(s=a.sibling,a.sibling=null),j5(e,!1,s,a,c);break;case"backwards":for(a=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&yE(n)===null){e.child=s;break}n=s.sibling,s.sibling=a,a=s,s=n}j5(e,!0,a,null,c);break;case"together":j5(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function MA(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Dh(n,e,a){if(n!==null&&(e.dependencies=n.dependencies),Tg|=e.lanes,!(a&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(hn(153));if(e.child!==null){for(n=e.child,a=op(n,n.pendingProps),e.child=a,a.return=e;n.sibling!==null;)n=n.sibling,a=a.sibling=op(n,n.pendingProps),a.return=e;a.sibling=null}return e.child}function ele(n,e,a){switch(e.tag){case 3:R$(e),N0();break;case 5:s$(e);break;case 1:yl(e.type)&&dE(e);break;case 4:Ak(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,s=e.memoizedProps.value;er(pE,o._currentValue),o._currentValue=s;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(er(Tr,Tr.current&1),e.flags|=128,null):a&e.child.childLanes?k$(n,e,a):(er(Tr,Tr.current&1),n=Dh(n,e,a),n!==null?n.sibling:null);er(Tr,Tr.current&1);break;case 19:if(o=(a&e.childLanes)!==0,n.flags&128){if(o)return D$(n,e,a);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),er(Tr,Tr.current),o)break;return null;case 22:case 23:return e.lanes=0,I$(n,e,a)}return Dh(n,e,a)}var O$,sL,z$,F$;O$=function(n,e){for(var a=e.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};sL=function(){};z$=function(n,e,a,o){var s=n.memoizedProps;if(s!==o){n=e.stateNode,rg(cd.current);var c=null;switch(a){case"input":s=PI(n,s),o=PI(n,o),c=[];break;case"select":s=Rr({},s,{value:void 0}),o=Rr({},o,{value:void 0}),c=[];break;case"textarea":s=RI(n,s),o=RI(n,o),c=[];break;default:typeof s.onClick!="function"&&typeof o.onClick=="function"&&(n.onclick=cE)}DI(a,o);var d;a=null;for(y in s)if(!o.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var f=s[y];for(d in f)f.hasOwnProperty(d)&&(a||(a={}),a[d]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(cx.hasOwnProperty(y)?c||(c=[]):(c=c||[]).push(y,null));for(y in o){var m=o[y];if(f=s!=null?s[y]:void 0,o.hasOwnProperty(y)&&m!==f&&(m!=null||f!=null))if(y==="style")if(f){for(d in f)!f.hasOwnProperty(d)||m&&m.hasOwnProperty(d)||(a||(a={}),a[d]="");for(d in m)m.hasOwnProperty(d)&&f[d]!==m[d]&&(a||(a={}),a[d]=m[d])}else a||(c||(c=[]),c.push(y,a)),a=m;else y==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,f=f?f.__html:void 0,m!=null&&f!==m&&(c=c||[]).push(y,m)):y==="children"?typeof m!="string"&&typeof m!="number"||(c=c||[]).push(y,""+m):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(cx.hasOwnProperty(y)?(m!=null&&y==="onScroll"&&ir("scroll",n),c||f===m||(c=[])):(c=c||[]).push(y,m))}a&&(c=c||[]).push("style",a);var y=c;(e.updateQueue=y)&&(e.flags|=4)}};F$=function(n,e,a,o){a!==o&&(e.flags|=4)};function F1(n,e){if(!yr)switch(n.tailMode){case"hidden":e=n.tail;for(var a=null;e!==null;)e.alternate!==null&&(a=e),e=e.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:o.sibling=null}}function cs(n){var e=n.alternate!==null&&n.alternate.child===n.child,a=0,o=0;if(e)for(var s=n.child;s!==null;)a|=s.lanes|s.childLanes,o|=s.subtreeFlags&14680064,o|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)a|=s.lanes|s.childLanes,o|=s.subtreeFlags,o|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=o,n.childLanes=a,e}function tle(n,e,a){var o=e.pendingProps;switch(yk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cs(e),null;case 1:return yl(e.type)&&uE(),cs(e),null;case 3:return o=e.stateNode,U0(),sr(gl),sr(bs),Mk(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(X3(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,nu!==null&&(mL(nu),nu=null))),sL(n,e),cs(e),null;case 5:Ek(e);var s=rg(xx.current);if(a=e.type,n!==null&&e.stateNode!=null)z$(n,e,a,o,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(hn(166));return cs(e),null}if(n=rg(cd.current),X3(e)){o=e.stateNode,a=e.type;var c=e.memoizedProps;switch(o[ad]=e,o[_x]=c,n=(e.mode&1)!==0,a){case"dialog":ir("cancel",o),ir("close",o);break;case"iframe":case"object":case"embed":ir("load",o);break;case"video":case"audio":for(s=0;s<bb.length;s++)ir(bb[s],o);break;case"source":ir("error",o);break;case"img":case"image":case"link":ir("error",o),ir("load",o);break;case"details":ir("toggle",o);break;case"input":w9(o,c),ir("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},ir("invalid",o);break;case"textarea":A9(o,c),ir("invalid",o)}DI(a,c),s=null;for(var d in c)if(c.hasOwnProperty(d)){var f=c[d];d==="children"?typeof f=="string"?o.textContent!==f&&(c.suppressHydrationWarning!==!0&&q3(o.textContent,f,n),s=["children",f]):typeof f=="number"&&o.textContent!==""+f&&(c.suppressHydrationWarning!==!0&&q3(o.textContent,f,n),s=["children",""+f]):cx.hasOwnProperty(d)&&f!=null&&d==="onScroll"&&ir("scroll",o)}switch(a){case"input":B3(o),S9(o,c,!0);break;case"textarea":B3(o),E9(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=cE)}o=s,e.updateQueue=o,o!==null&&(e.flags|=4)}else{d=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=uj(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof o.is=="string"?n=d.createElement(a,{is:o.is}):(n=d.createElement(a),a==="select"&&(d=n,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):n=d.createElementNS(n,a),n[ad]=e,n[_x]=o,O$(n,e,!1,!1),e.stateNode=n;e:{switch(d=OI(a,o),a){case"dialog":ir("cancel",n),ir("close",n),s=o;break;case"iframe":case"object":case"embed":ir("load",n),s=o;break;case"video":case"audio":for(s=0;s<bb.length;s++)ir(bb[s],n);s=o;break;case"source":ir("error",n),s=o;break;case"img":case"image":case"link":ir("error",n),ir("load",n),s=o;break;case"details":ir("toggle",n),s=o;break;case"input":w9(n,o),s=PI(n,o),ir("invalid",n);break;case"option":s=o;break;case"select":n._wrapperState={wasMultiple:!!o.multiple},s=Rr({},o,{value:void 0}),ir("invalid",n);break;case"textarea":A9(n,o),s=RI(n,o),ir("invalid",n);break;default:s=o}DI(a,s),f=s;for(c in f)if(f.hasOwnProperty(c)){var m=f[c];c==="style"?fj(n,m):c==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&dj(n,m)):c==="children"?typeof m=="string"?(a!=="textarea"||m!=="")&&ux(n,m):typeof m=="number"&&ux(n,""+m):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(cx.hasOwnProperty(c)?m!=null&&c==="onScroll"&&ir("scroll",n):m!=null&&nk(n,c,m,d))}switch(a){case"input":B3(n),S9(n,o,!1);break;case"textarea":B3(n),E9(n);break;case"option":o.value!=null&&n.setAttribute("value",""+fp(o.value));break;case"select":n.multiple=!!o.multiple,c=o.value,c!=null?S0(n,!!o.multiple,c,!1):o.defaultValue!=null&&S0(n,!!o.multiple,o.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=cE)}switch(a){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return cs(e),null;case 6:if(n&&e.stateNode!=null)F$(n,e,n.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(hn(166));if(a=rg(xx.current),rg(cd.current),X3(e)){if(o=e.stateNode,a=e.memoizedProps,o[ad]=e,(c=o.nodeValue!==a)&&(n=Hl,n!==null))switch(n.tag){case 3:q3(o.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&q3(o.nodeValue,a,(n.mode&1)!==0)}c&&(e.flags|=4)}else o=(a.nodeType===9?a:a.ownerDocument).createTextNode(o),o[ad]=e,e.stateNode=o}return cs(e),null;case 13:if(sr(Tr),o=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(yr&&Gl!==null&&e.mode&1&&!(e.flags&128))e$(),N0(),e.flags|=98560,c=!1;else if(c=X3(e),o!==null&&o.dehydrated!==null){if(n===null){if(!c)throw Error(hn(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(hn(317));c[ad]=e}else N0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;cs(e),c=!1}else nu!==null&&(mL(nu),nu=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=a,e):(o=o!==null,o!==(n!==null&&n.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(n===null||Tr.current&1?Co===0&&(Co=3):Nk())),e.updateQueue!==null&&(e.flags|=4),cs(e),null);case 4:return U0(),sL(n,e),n===null&&yx(e.stateNode.containerInfo),cs(e),null;case 10:return xk(e.type._context),cs(e),null;case 17:return yl(e.type)&&uE(),cs(e),null;case 19:if(sr(Tr),c=e.memoizedState,c===null)return cs(e),null;if(o=(e.flags&128)!==0,d=c.rendering,d===null)if(o)F1(c,!1);else{if(Co!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(d=yE(n),d!==null){for(e.flags|=128,F1(c,!1),o=d.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=a,a=e.child;a!==null;)c=a,n=o,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=n,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,n=d.dependencies,c.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return er(Tr,Tr.current&1|2),e.child}n=n.sibling}c.tail!==null&&oo()>V0&&(e.flags|=128,o=!0,F1(c,!1),e.lanes=4194304)}else{if(!o)if(n=yE(d),n!==null){if(e.flags|=128,o=!0,a=n.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),F1(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!yr)return cs(e),null}else 2*oo()-c.renderingStartTime>V0&&a!==1073741824&&(e.flags|=128,o=!0,F1(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(a=c.last,a!==null?a.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=oo(),e.sibling=null,a=Tr.current,er(Tr,o?a&1|2:a&1),e):(cs(e),null);case 22:case 23:return Fk(),o=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?Fl&1073741824&&(cs(e),e.subtreeFlags&6&&(e.flags|=8192)):cs(e),null;case 24:return null;case 25:return null}throw Error(hn(156,e.tag))}function nle(n,e){switch(yk(e),e.tag){case 1:return yl(e.type)&&uE(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return U0(),sr(gl),sr(bs),Mk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ek(e),null;case 13:if(sr(Tr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(hn(340));N0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return sr(Tr),null;case 4:return U0(),null;case 10:return xk(e.type._context),null;case 22:case 23:return Fk(),null;case 24:return null;default:return null}}var K3=!1,ps=!1,ale=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function p0(n,e){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(o){Vr(n,e,o)}else a.current=null}function lL(n,e,a){try{a()}catch(o){Vr(n,e,o)}}var pU=!1;function ile(n,e){if(jI=oE,n=Wj(),mk(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var s=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{a.nodeType,c.nodeType}catch{a=null;break e}var d=0,f=-1,m=-1,y=0,_=0,w=n,A=null;t:for(;;){for(var C;w!==a||s!==0&&w.nodeType!==3||(f=d+s),w!==c||o!==0&&w.nodeType!==3||(m=d+o),w.nodeType===3&&(d+=w.nodeValue.length),(C=w.firstChild)!==null;)A=w,w=C;for(;;){if(w===n)break t;if(A===a&&++y===s&&(f=d),A===c&&++_===o&&(m=d),(C=w.nextSibling)!==null)break;w=A,A=w.parentNode}w=C}a=f===-1||m===-1?null:{start:f,end:m}}else a=null}a=a||{start:0,end:0}}else a=null;for($I={focusedElem:n,selectionRange:a},oE=!1,Fn=e;Fn!==null;)if(e=Fn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Fn=n;else for(;Fn!==null;){e=Fn;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var k=I.memoizedProps,D=I.memoizedState,L=e.stateNode,O=L.getSnapshotBeforeUpdate(e.elementType===e.type?k:Jc(e.type,k),D);L.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(hn(163))}}catch(B){Vr(e,e.return,B)}if(n=e.sibling,n!==null){n.return=e.return,Fn=n;break}Fn=e.return}return I=pU,pU=!1,I}function Fb(n,e,a){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&n)===n){var c=s.destroy;s.destroy=void 0,c!==void 0&&lL(e,a,c)}s=s.next}while(s!==o)}}function gM(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var a=e=e.next;do{if((a.tag&n)===n){var o=a.create;a.destroy=o()}a=a.next}while(a!==e)}}function cL(n){var e=n.ref;if(e!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof e=="function"?e(n):e.current=n}}function N$(n){var e=n.alternate;e!==null&&(n.alternate=null,N$(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ad],delete e[_x],delete e[ZI],delete e[Use],delete e[Wse])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function B$(n){return n.tag===5||n.tag===3||n.tag===4}function mU(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||B$(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function uL(n,e,a){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?a.nodeType===8?a.parentNode.insertBefore(n,e):a.insertBefore(n,e):(a.nodeType===8?(e=a.parentNode,e.insertBefore(n,a)):(e=a,e.appendChild(n)),a=a._reactRootContainer,a!=null||e.onclick!==null||(e.onclick=cE));else if(o!==4&&(n=n.child,n!==null))for(uL(n,e,a),n=n.sibling;n!==null;)uL(n,e,a),n=n.sibling}function dL(n,e,a){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?a.insertBefore(n,e):a.appendChild(n);else if(o!==4&&(n=n.child,n!==null))for(dL(n,e,a),n=n.sibling;n!==null;)dL(n,e,a),n=n.sibling}var qo=null,eu=!1;function If(n,e,a){for(a=a.child;a!==null;)U$(n,e,a),a=a.sibling}function U$(n,e,a){if(ld&&typeof ld.onCommitFiberUnmount=="function")try{ld.onCommitFiberUnmount(lM,a)}catch{}switch(a.tag){case 5:ps||p0(a,e);case 6:var o=qo,s=eu;qo=null,If(n,e,a),qo=o,eu=s,qo!==null&&(eu?(n=qo,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):qo.removeChild(a.stateNode));break;case 18:qo!==null&&(eu?(n=qo,a=a.stateNode,n.nodeType===8?N5(n.parentNode,a):n.nodeType===1&&N5(n,a),px(n)):N5(qo,a.stateNode));break;case 4:o=qo,s=eu,qo=a.stateNode.containerInfo,eu=!0,If(n,e,a),qo=o,eu=s;break;case 0:case 11:case 14:case 15:if(!ps&&(o=a.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){s=o=o.next;do{var c=s,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&lL(a,e,d),s=s.next}while(s!==o)}If(n,e,a);break;case 1:if(!ps&&(p0(a,e),o=a.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(f){Vr(a,e,f)}If(n,e,a);break;case 21:If(n,e,a);break;case 22:a.mode&1?(ps=(o=ps)||a.memoizedState!==null,If(n,e,a),ps=o):If(n,e,a);break;default:If(n,e,a)}}function gU(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new ale),e.forEach(function(o){var s=fle.bind(null,n,o);a.has(o)||(a.add(o),o.then(s,s))})}}function Xc(n,e){var a=e.deletions;if(a!==null)for(var o=0;o<a.length;o++){var s=a[o];try{var c=n,d=e,f=d;e:for(;f!==null;){switch(f.tag){case 5:qo=f.stateNode,eu=!1;break e;case 3:qo=f.stateNode.containerInfo,eu=!0;break e;case 4:qo=f.stateNode.containerInfo,eu=!0;break e}f=f.return}if(qo===null)throw Error(hn(160));U$(c,d,s),qo=null,eu=!1;var m=s.alternate;m!==null&&(m.return=null),s.return=null}catch(y){Vr(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)W$(e,n),e=e.sibling}function W$(n,e){var a=n.alternate,o=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Xc(e,n),Ku(n),o&4){try{Fb(3,n,n.return),gM(3,n)}catch(k){Vr(n,n.return,k)}try{Fb(5,n,n.return)}catch(k){Vr(n,n.return,k)}}break;case 1:Xc(e,n),Ku(n),o&512&&a!==null&&p0(a,a.return);break;case 5:if(Xc(e,n),Ku(n),o&512&&a!==null&&p0(a,a.return),n.flags&32){var s=n.stateNode;try{ux(s,"")}catch(k){Vr(n,n.return,k)}}if(o&4&&(s=n.stateNode,s!=null)){var c=n.memoizedProps,d=a!==null?a.memoizedProps:c,f=n.type,m=n.updateQueue;if(n.updateQueue=null,m!==null)try{f==="input"&&c.type==="radio"&&c.name!=null&&lj(s,c),OI(f,d);var y=OI(f,c);for(d=0;d<m.length;d+=2){var _=m[d],w=m[d+1];_==="style"?fj(s,w):_==="dangerouslySetInnerHTML"?dj(s,w):_==="children"?ux(s,w):nk(s,_,w,y)}switch(f){case"input":II(s,c);break;case"textarea":cj(s,c);break;case"select":var A=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!c.multiple;var C=c.value;C!=null?S0(s,!!c.multiple,C,!1):A!==!!c.multiple&&(c.defaultValue!=null?S0(s,!!c.multiple,c.defaultValue,!0):S0(s,!!c.multiple,c.multiple?[]:"",!1))}s[_x]=c}catch(k){Vr(n,n.return,k)}}break;case 6:if(Xc(e,n),Ku(n),o&4){if(n.stateNode===null)throw Error(hn(162));s=n.stateNode,c=n.memoizedProps;try{s.nodeValue=c}catch(k){Vr(n,n.return,k)}}break;case 3:if(Xc(e,n),Ku(n),o&4&&a!==null&&a.memoizedState.isDehydrated)try{px(e.containerInfo)}catch(k){Vr(n,n.return,k)}break;case 4:Xc(e,n),Ku(n);break;case 13:Xc(e,n),Ku(n),s=n.child,s.flags&8192&&(c=s.memoizedState!==null,s.stateNode.isHidden=c,!c||s.alternate!==null&&s.alternate.memoizedState!==null||(Ok=oo())),o&4&&gU(n);break;case 22:if(_=a!==null&&a.memoizedState!==null,n.mode&1?(ps=(y=ps)||_,Xc(e,n),ps=y):Xc(e,n),Ku(n),o&8192){if(y=n.memoizedState!==null,(n.stateNode.isHidden=y)&&!_&&n.mode&1)for(Fn=n,_=n.child;_!==null;){for(w=Fn=_;Fn!==null;){switch(A=Fn,C=A.child,A.tag){case 0:case 11:case 14:case 15:Fb(4,A,A.return);break;case 1:p0(A,A.return);var I=A.stateNode;if(typeof I.componentWillUnmount=="function"){o=A,a=A.return;try{e=o,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(k){Vr(o,a,k)}}break;case 5:p0(A,A.return);break;case 22:if(A.memoizedState!==null){vU(w);continue}}C!==null?(C.return=A,Fn=C):vU(w)}_=_.sibling}e:for(_=null,w=n;;){if(w.tag===5){if(_===null){_=w;try{s=w.stateNode,y?(c=s.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(f=w.stateNode,m=w.memoizedProps.style,d=m!=null&&m.hasOwnProperty("display")?m.display:null,f.style.display=hj("display",d))}catch(k){Vr(n,n.return,k)}}}else if(w.tag===6){if(_===null)try{w.stateNode.nodeValue=y?"":w.memoizedProps}catch(k){Vr(n,n.return,k)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===n)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===n)break e;for(;w.sibling===null;){if(w.return===null||w.return===n)break e;_===w&&(_=null),w=w.return}_===w&&(_=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:Xc(e,n),Ku(n),o&4&&gU(n);break;case 21:break;default:Xc(e,n),Ku(n)}}function Ku(n){var e=n.flags;if(e&2){try{e:{for(var a=n.return;a!==null;){if(B$(a)){var o=a;break e}a=a.return}throw Error(hn(160))}switch(o.tag){case 5:var s=o.stateNode;o.flags&32&&(ux(s,""),o.flags&=-33);var c=mU(n);dL(n,c,s);break;case 3:case 4:var d=o.stateNode.containerInfo,f=mU(n);uL(n,f,d);break;default:throw Error(hn(161))}}catch(m){Vr(n,n.return,m)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function rle(n,e,a){Fn=n,V$(n)}function V$(n,e,a){for(var o=(n.mode&1)!==0;Fn!==null;){var s=Fn,c=s.child;if(s.tag===22&&o){var d=s.memoizedState!==null||K3;if(!d){var f=s.alternate,m=f!==null&&f.memoizedState!==null||ps;f=K3;var y=ps;if(K3=d,(ps=m)&&!y)for(Fn=s;Fn!==null;)d=Fn,m=d.child,d.tag===22&&d.memoizedState!==null?_U(s):m!==null?(m.return=d,Fn=m):_U(s);for(;c!==null;)Fn=c,V$(c),c=c.sibling;Fn=s,K3=f,ps=y}yU(n)}else s.subtreeFlags&8772&&c!==null?(c.return=s,Fn=c):yU(n)}}function yU(n){for(;Fn!==null;){var e=Fn;if(e.flags&8772){var a=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ps||gM(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!ps)if(a===null)o.componentDidMount();else{var s=e.elementType===e.type?a.memoizedProps:Jc(e.type,a.memoizedProps);o.componentDidUpdate(s,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&eU(e,c,o);break;case 3:var d=e.updateQueue;if(d!==null){if(a=null,e.child!==null)switch(e.child.tag){case 5:a=e.child.stateNode;break;case 1:a=e.child.stateNode}eU(e,d,a)}break;case 5:var f=e.stateNode;if(a===null&&e.flags&4){a=f;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&a.focus();break;case"img":m.src&&(a.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var _=y.memoizedState;if(_!==null){var w=_.dehydrated;w!==null&&px(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(hn(163))}ps||e.flags&512&&cL(e)}catch(A){Vr(e,e.return,A)}}if(e===n){Fn=null;break}if(a=e.sibling,a!==null){a.return=e.return,Fn=a;break}Fn=e.return}}function vU(n){for(;Fn!==null;){var e=Fn;if(e===n){Fn=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Fn=a;break}Fn=e.return}}function _U(n){for(;Fn!==null;){var e=Fn;try{switch(e.tag){case 0:case 11:case 15:var a=e.return;try{gM(4,e)}catch(m){Vr(e,a,m)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var s=e.return;try{o.componentDidMount()}catch(m){Vr(e,s,m)}}var c=e.return;try{cL(e)}catch(m){Vr(e,c,m)}break;case 5:var d=e.return;try{cL(e)}catch(m){Vr(e,d,m)}}}catch(m){Vr(e,e.return,m)}if(e===n){Fn=null;break}var f=e.sibling;if(f!==null){f.return=e.return,Fn=f;break}Fn=e.return}}var ole=Math.ceil,bE=Bh.ReactCurrentDispatcher,kk=Bh.ReactCurrentOwner,xc=Bh.ReactCurrentBatchConfig,si=0,No=null,_o=null,Zo=0,Fl=0,m0=Sp(0),Co=0,Ex=null,Tg=0,yM=0,Dk=0,Nb=null,ul=null,Ok=0,V0=1/0,ph=null,xE=!1,hL=null,ip=null,J3=!1,$f=null,wE=0,Bb=0,fL=null,TA=-1,CA=0;function Us(){return si&6?oo():TA!==-1?TA:TA=oo()}function rp(n){return n.mode&1?si&2&&Zo!==0?Zo&-Zo:Gse.transition!==null?(CA===0&&(CA=Ej()),CA):(n=Fi,n!==0||(n=window.event,n=n===void 0?16:Rj(n.type)),n):1}function lu(n,e,a,o){if(50<Bb)throw Bb=0,fL=null,Error(hn(185));hw(n,a,o),(!(si&2)||n!==No)&&(n===No&&(!(si&2)&&(yM|=a),Co===4&&Gf(n,Zo)),vl(n,o),a===1&&si===0&&!(e.mode&1)&&(V0=oo()+500,fM&&Ap()))}function vl(n,e){var a=n.callbackNode;Goe(n,e);var o=rE(n,n===No?Zo:0);if(o===0)a!==null&&C9(a),n.callbackNode=null,n.callbackPriority=0;else if(e=o&-o,n.callbackPriority!==e){if(a!=null&&C9(a),e===1)n.tag===0?Vse(bU.bind(null,n)):Kj(bU.bind(null,n)),Nse(function(){!(si&6)&&Ap()}),a=null;else{switch(Mj(o)){case 1:a=sk;break;case 4:a=Sj;break;case 16:a=iE;break;case 536870912:a=Aj;break;default:a=iE}a=Y$(a,G$.bind(null,n))}n.callbackPriority=e,n.callbackNode=a}}function G$(n,e){if(TA=-1,CA=0,si&6)throw Error(hn(327));var a=n.callbackNode;if(C0()&&n.callbackNode!==a)return null;var o=rE(n,n===No?Zo:0);if(o===0)return null;if(o&30||o&n.expiredLanes||e)e=SE(n,o);else{e=o;var s=si;si|=2;var c=j$();(No!==n||Zo!==e)&&(ph=null,V0=oo()+500,mg(n,e));do try{cle();break}catch(f){H$(n,f)}while(1);bk(),bE.current=c,si=s,_o!==null?e=0:(No=null,Zo=0,e=Co)}if(e!==0){if(e===2&&(s=UI(n),s!==0&&(o=s,e=pL(n,s))),e===1)throw a=Ex,mg(n,0),Gf(n,o),vl(n,oo()),a;if(e===6)Gf(n,o);else{if(s=n.current.alternate,!(o&30)&&!sle(s)&&(e=SE(n,o),e===2&&(c=UI(n),c!==0&&(o=c,e=pL(n,c))),e===1))throw a=Ex,mg(n,0),Gf(n,o),vl(n,oo()),a;switch(n.finishedWork=s,n.finishedLanes=o,e){case 0:case 1:throw Error(hn(345));case 2:$m(n,ul,ph);break;case 3:if(Gf(n,o),(o&130023424)===o&&(e=Ok+500-oo(),10<e)){if(rE(n,0)!==0)break;if(s=n.suspendedLanes,(s&o)!==o){Us(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=XI($m.bind(null,n,ul,ph),e);break}$m(n,ul,ph);break;case 4:if(Gf(n,o),(o&4194240)===o)break;for(e=n.eventTimes,s=-1;0<o;){var d=31-su(o);c=1<<d,d=e[d],d>s&&(s=d),o&=~c}if(o=s,o=oo()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*ole(o/1960))-o,10<o){n.timeoutHandle=XI($m.bind(null,n,ul,ph),o);break}$m(n,ul,ph);break;case 5:$m(n,ul,ph);break;default:throw Error(hn(329))}}}return vl(n,oo()),n.callbackNode===a?G$.bind(null,n):null}function pL(n,e){var a=Nb;return n.current.memoizedState.isDehydrated&&(mg(n,e).flags|=256),n=SE(n,e),n!==2&&(e=ul,ul=a,e!==null&&mL(e)),n}function mL(n){ul===null?ul=n:ul.push.apply(ul,n)}function sle(n){for(var e=n;;){if(e.flags&16384){var a=e.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var o=0;o<a.length;o++){var s=a[o],c=s.getSnapshot;s=s.value;try{if(!du(c(),s))return!1}catch{return!1}}}if(a=e.child,e.subtreeFlags&16384&&a!==null)a.return=e,e=a;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Gf(n,e){for(e&=~Dk,e&=~yM,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var a=31-su(e),o=1<<a;n[a]=-1,e&=~o}}function bU(n){if(si&6)throw Error(hn(327));C0();var e=rE(n,0);if(!(e&1))return vl(n,oo()),null;var a=SE(n,e);if(n.tag!==0&&a===2){var o=UI(n);o!==0&&(e=o,a=pL(n,o))}if(a===1)throw a=Ex,mg(n,0),Gf(n,e),vl(n,oo()),a;if(a===6)throw Error(hn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,$m(n,ul,ph),vl(n,oo()),null}function zk(n,e){var a=si;si|=1;try{return n(e)}finally{si=a,si===0&&(V0=oo()+500,fM&&Ap())}}function Cg(n){$f!==null&&$f.tag===0&&!(si&6)&&C0();var e=si;si|=1;var a=xc.transition,o=Fi;try{if(xc.transition=null,Fi=1,n)return n()}finally{Fi=o,xc.transition=a,si=e,!(si&6)&&Ap()}}function Fk(){Fl=m0.current,sr(m0)}function mg(n,e){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,Fse(a)),_o!==null)for(a=_o.return;a!==null;){var o=a;switch(yk(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&uE();break;case 3:U0(),sr(gl),sr(bs),Mk();break;case 5:Ek(o);break;case 4:U0();break;case 13:sr(Tr);break;case 19:sr(Tr);break;case 10:xk(o.type._context);break;case 22:case 23:Fk()}a=a.return}if(No=n,_o=n=op(n.current,null),Zo=Fl=e,Co=0,Ex=null,Dk=yM=Tg=0,ul=Nb=null,ig!==null){for(e=0;e<ig.length;e++)if(a=ig[e],o=a.interleaved,o!==null){a.interleaved=null;var s=o.next,c=a.pending;if(c!==null){var d=c.next;c.next=s,o.next=d}a.pending=o}ig=null}return n}function H$(n,e){do{var a=_o;try{if(bk(),AA.current=_E,vE){for(var o=Ir.memoizedState;o!==null;){var s=o.queue;s!==null&&(s.pending=null),o=o.next}vE=!1}if(Mg=0,zo=Mo=Ir=null,zb=!1,wx=0,kk.current=null,a===null||a.return===null){Co=1,Ex=e,_o=null;break}e:{var c=n,d=a.return,f=a,m=e;if(e=Zo,f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var y=m,_=f,w=_.tag;if(!(_.mode&1)&&(w===0||w===11||w===15)){var A=_.alternate;A?(_.updateQueue=A.updateQueue,_.memoizedState=A.memoizedState,_.lanes=A.lanes):(_.updateQueue=null,_.memoizedState=null)}var C=sU(d);if(C!==null){C.flags&=-257,lU(C,d,f,c,e),C.mode&1&&oU(c,y,e),e=C,m=y;var I=e.updateQueue;if(I===null){var k=new Set;k.add(m),e.updateQueue=k}else I.add(m);break e}else{if(!(e&1)){oU(c,y,e),Nk();break e}m=Error(hn(426))}}else if(yr&&f.mode&1){var D=sU(d);if(D!==null){!(D.flags&65536)&&(D.flags|=256),lU(D,d,f,c,e),vk(W0(m,f));break e}}c=m=W0(m,f),Co!==4&&(Co=2),Nb===null?Nb=[c]:Nb.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var L=T$(c,m,e);Q9(c,L);break e;case 1:f=m;var O=c.type,F=c.stateNode;if(!(c.flags&128)&&(typeof O.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(ip===null||!ip.has(F)))){c.flags|=65536,e&=-e,c.lanes|=e;var B=C$(c,f,e);Q9(c,B);break e}}c=c.return}while(c!==null)}q$(a)}catch(G){e=G,_o===a&&a!==null&&(_o=a=a.return);continue}break}while(1)}function j$(){var n=bE.current;return bE.current=_E,n===null?_E:n}function Nk(){(Co===0||Co===3||Co===2)&&(Co=4),No===null||!(Tg&268435455)&&!(yM&268435455)||Gf(No,Zo)}function SE(n,e){var a=si;si|=2;var o=j$();(No!==n||Zo!==e)&&(ph=null,mg(n,e));do try{lle();break}catch(s){H$(n,s)}while(1);if(bk(),si=a,bE.current=o,_o!==null)throw Error(hn(261));return No=null,Zo=0,Co}function lle(){for(;_o!==null;)$$(_o)}function cle(){for(;_o!==null&&!Doe();)$$(_o)}function $$(n){var e=Z$(n.alternate,n,Fl);n.memoizedProps=n.pendingProps,e===null?q$(n):_o=e,kk.current=null}function q$(n){var e=n;do{var a=e.alternate;if(n=e.return,e.flags&32768){if(a=nle(a,e),a!==null){a.flags&=32767,_o=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Co=6,_o=null;return}}else if(a=tle(a,e,Fl),a!==null){_o=a;return}if(e=e.sibling,e!==null){_o=e;return}_o=e=n}while(e!==null);Co===0&&(Co=5)}function $m(n,e,a){var o=Fi,s=xc.transition;try{xc.transition=null,Fi=1,ule(n,e,a,o)}finally{xc.transition=s,Fi=o}return null}function ule(n,e,a,o){do C0();while($f!==null);if(si&6)throw Error(hn(327));a=n.finishedWork;var s=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(hn(177));n.callbackNode=null,n.callbackPriority=0;var c=a.lanes|a.childLanes;if(Hoe(n,c),n===No&&(_o=No=null,Zo=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||J3||(J3=!0,Y$(iE,function(){return C0(),null})),c=(a.flags&15990)!==0,a.subtreeFlags&15990||c){c=xc.transition,xc.transition=null;var d=Fi;Fi=1;var f=si;si|=4,kk.current=null,ile(n,a),W$(a,n),Ise($I),oE=!!jI,$I=jI=null,n.current=a,rle(a),Ooe(),si=f,Fi=d,xc.transition=c}else n.current=a;if(J3&&(J3=!1,$f=n,wE=s),c=n.pendingLanes,c===0&&(ip=null),Noe(a.stateNode),vl(n,oo()),e!==null)for(o=n.onRecoverableError,a=0;a<e.length;a++)s=e[a],o(s.value,{componentStack:s.stack,digest:s.digest});if(xE)throw xE=!1,n=hL,hL=null,n;return wE&1&&n.tag!==0&&C0(),c=n.pendingLanes,c&1?n===fL?Bb++:(Bb=0,fL=n):Bb=0,Ap(),null}function C0(){if($f!==null){var n=Mj(wE),e=xc.transition,a=Fi;try{if(xc.transition=null,Fi=16>n?16:n,$f===null)var o=!1;else{if(n=$f,$f=null,wE=0,si&6)throw Error(hn(331));var s=si;for(si|=4,Fn=n.current;Fn!==null;){var c=Fn,d=c.child;if(Fn.flags&16){var f=c.deletions;if(f!==null){for(var m=0;m<f.length;m++){var y=f[m];for(Fn=y;Fn!==null;){var _=Fn;switch(_.tag){case 0:case 11:case 15:Fb(8,_,c)}var w=_.child;if(w!==null)w.return=_,Fn=w;else for(;Fn!==null;){_=Fn;var A=_.sibling,C=_.return;if(N$(_),_===y){Fn=null;break}if(A!==null){A.return=C,Fn=A;break}Fn=C}}}var I=c.alternate;if(I!==null){var k=I.child;if(k!==null){I.child=null;do{var D=k.sibling;k.sibling=null,k=D}while(k!==null)}}Fn=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,Fn=d;else e:for(;Fn!==null;){if(c=Fn,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Fb(9,c,c.return)}var L=c.sibling;if(L!==null){L.return=c.return,Fn=L;break e}Fn=c.return}}var O=n.current;for(Fn=O;Fn!==null;){d=Fn;var F=d.child;if(d.subtreeFlags&2064&&F!==null)F.return=d,Fn=F;else e:for(d=O;Fn!==null;){if(f=Fn,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:gM(9,f)}}catch(G){Vr(f,f.return,G)}if(f===d){Fn=null;break e}var B=f.sibling;if(B!==null){B.return=f.return,Fn=B;break e}Fn=f.return}}if(si=s,Ap(),ld&&typeof ld.onPostCommitFiberRoot=="function")try{ld.onPostCommitFiberRoot(lM,n)}catch{}o=!0}return o}finally{Fi=a,xc.transition=e}}return!1}function xU(n,e,a){e=W0(a,e),e=T$(n,e,1),n=ap(n,e,1),e=Us(),n!==null&&(hw(n,1,e),vl(n,e))}function Vr(n,e,a){if(n.tag===3)xU(n,n,a);else for(;e!==null;){if(e.tag===3){xU(e,n,a);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(ip===null||!ip.has(o))){n=W0(a,n),n=C$(e,n,1),e=ap(e,n,1),n=Us(),e!==null&&(hw(e,1,n),vl(e,n));break}}e=e.return}}function dle(n,e,a){var o=n.pingCache;o!==null&&o.delete(e),e=Us(),n.pingedLanes|=n.suspendedLanes&a,No===n&&(Zo&a)===a&&(Co===4||Co===3&&(Zo&130023424)===Zo&&500>oo()-Ok?mg(n,0):Dk|=a),vl(n,e)}function X$(n,e){e===0&&(n.mode&1?(e=V3,V3<<=1,!(V3&130023424)&&(V3=4194304)):e=1);var a=Us();n=kh(n,e),n!==null&&(hw(n,e,a),vl(n,a))}function hle(n){var e=n.memoizedState,a=0;e!==null&&(a=e.retryLane),X$(n,a)}function fle(n,e){var a=0;switch(n.tag){case 13:var o=n.stateNode,s=n.memoizedState;s!==null&&(a=s.retryLane);break;case 19:o=n.stateNode;break;default:throw Error(hn(314))}o!==null&&o.delete(e),X$(n,a)}var Z$;Z$=function(n,e,a){if(n!==null)if(n.memoizedProps!==e.pendingProps||gl.current)ml=!0;else{if(!(n.lanes&a)&&!(e.flags&128))return ml=!1,ele(n,e,a);ml=!!(n.flags&131072)}else ml=!1,yr&&e.flags&1048576&&Jj(e,fE,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;MA(n,e),n=e.pendingProps;var s=F0(e,bs.current);T0(e,a),s=Ck(null,e,o,n,s,a);var c=Pk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,yl(o)?(c=!0,dE(e)):c=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Sk(e),s.updater=pM,e.stateNode=s,s._reactInternals=e,tL(e,o,n,a),e=iL(null,e,o,!0,c,a)):(e.tag=0,yr&&c&&gk(e),Bs(null,e,s,a),e=e.child),e;case 16:o=e.elementType;e:{switch(MA(n,e),n=e.pendingProps,s=o._init,o=s(o._payload),e.type=o,s=e.tag=mle(o),n=Jc(o,n),s){case 0:e=aL(null,e,o,n,a);break e;case 1:e=dU(null,e,o,n,a);break e;case 11:e=cU(null,e,o,n,a);break e;case 14:e=uU(null,e,o,Jc(o.type,n),a);break e}throw Error(hn(306,o,""))}return e;case 0:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:Jc(o,s),aL(n,e,o,s,a);case 1:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:Jc(o,s),dU(n,e,o,s,a);case 3:e:{if(R$(e),n===null)throw Error(hn(387));o=e.pendingProps,c=e.memoizedState,s=c.element,n$(n,e),gE(e,o,null,a);var d=e.memoizedState;if(o=d.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){s=W0(Error(hn(423)),e),e=hU(n,e,o,a,s);break e}else if(o!==s){s=W0(Error(hn(424)),e),e=hU(n,e,o,a,s);break e}else for(Gl=np(e.stateNode.containerInfo.firstChild),Hl=e,yr=!0,nu=null,a=o$(e,null,o,a),e.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(N0(),o===s){e=Dh(n,e,a);break e}Bs(n,e,o,a)}e=e.child}return e;case 5:return s$(e),n===null&&JI(e),o=e.type,s=e.pendingProps,c=n!==null?n.memoizedProps:null,d=s.children,qI(o,s)?d=null:c!==null&&qI(o,c)&&(e.flags|=32),L$(n,e),Bs(n,e,d,a),e.child;case 6:return n===null&&JI(e),null;case 13:return k$(n,e,a);case 4:return Ak(e,e.stateNode.containerInfo),o=e.pendingProps,n===null?e.child=B0(e,null,o,a):Bs(n,e,o,a),e.child;case 11:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:Jc(o,s),cU(n,e,o,s,a);case 7:return Bs(n,e,e.pendingProps,a),e.child;case 8:return Bs(n,e,e.pendingProps.children,a),e.child;case 12:return Bs(n,e,e.pendingProps.children,a),e.child;case 10:e:{if(o=e.type._context,s=e.pendingProps,c=e.memoizedProps,d=s.value,er(pE,o._currentValue),o._currentValue=d,c!==null)if(du(c.value,d)){if(c.children===s.children&&!gl.current){e=Dh(n,e,a);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){d=c.child;for(var m=f.firstContext;m!==null;){if(m.context===o){if(c.tag===1){m=Ch(-1,a&-a),m.tag=2;var y=c.updateQueue;if(y!==null){y=y.shared;var _=y.pending;_===null?m.next=m:(m.next=_.next,_.next=m),y.pending=m}}c.lanes|=a,m=c.alternate,m!==null&&(m.lanes|=a),QI(c.return,a,e),f.lanes|=a;break}m=m.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(hn(341));d.lanes|=a,f=d.alternate,f!==null&&(f.lanes|=a),QI(d,a,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Bs(n,e,s.children,a),e=e.child}return e;case 9:return s=e.type,o=e.pendingProps.children,T0(e,a),s=Sc(s),o=o(s),e.flags|=1,Bs(n,e,o,a),e.child;case 14:return o=e.type,s=Jc(o,e.pendingProps),s=Jc(o.type,s),uU(n,e,o,s,a);case 15:return P$(n,e,e.type,e.pendingProps,a);case 17:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:Jc(o,s),MA(n,e),e.tag=1,yl(o)?(n=!0,dE(e)):n=!1,T0(e,a),i$(e,o,s),tL(e,o,s,a),iL(null,e,o,!0,n,a);case 19:return D$(n,e,a);case 22:return I$(n,e,a)}throw Error(hn(156,e.tag))};function Y$(n,e){return wj(n,e)}function ple(n,e,a,o){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(n,e,a,o){return new ple(n,e,a,o)}function Bk(n){return n=n.prototype,!(!n||!n.isReactComponent)}function mle(n){if(typeof n=="function")return Bk(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ik)return 11;if(n===rk)return 14}return 2}function op(n,e){var a=n.alternate;return a===null?(a=bc(n.tag,e,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=e,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,e=n.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function PA(n,e,a,o,s,c){var d=2;if(o=n,typeof n=="function")Bk(n)&&(d=1);else if(typeof n=="string")d=5;else e:switch(n){case r0:return gg(a.children,s,c,e);case ak:d=8,s|=8;break;case EI:return n=bc(12,a,e,s|2),n.elementType=EI,n.lanes=c,n;case MI:return n=bc(13,a,e,s),n.elementType=MI,n.lanes=c,n;case TI:return n=bc(19,a,e,s),n.elementType=TI,n.lanes=c,n;case rj:return vM(a,s,c,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case aj:d=10;break e;case ij:d=9;break e;case ik:d=11;break e;case rk:d=14;break e;case Uf:d=16,o=null;break e}throw Error(hn(130,n==null?n:typeof n,""))}return e=bc(d,a,e,s),e.elementType=n,e.type=o,e.lanes=c,e}function gg(n,e,a,o){return n=bc(7,n,o,e),n.lanes=a,n}function vM(n,e,a,o){return n=bc(22,n,o,e),n.elementType=rj,n.lanes=a,n.stateNode={isHidden:!1},n}function $5(n,e,a){return n=bc(6,n,null,e),n.lanes=a,n}function q5(n,e,a){return e=bc(4,n.children!==null?n.children:[],n.key,e),e.lanes=a,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function gle(n,e,a,o,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=T5(0),this.expirationTimes=T5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=T5(0),this.identifierPrefix=o,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Uk(n,e,a,o,s,c,d,f,m){return n=new gle(n,e,a,f,m),e===1?(e=1,c===!0&&(e|=8)):e=0,c=bc(3,null,null,e),n.current=c,c.stateNode=n,c.memoizedState={element:o,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sk(c),n}function yle(n,e,a){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i0,key:o==null?null:""+o,children:n,containerInfo:e,implementation:a}}function K$(n){if(!n)return pp;n=n._reactInternals;e:{if(Bg(n)!==n||n.tag!==1)throw Error(hn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(yl(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(hn(171))}if(n.tag===1){var a=n.type;if(yl(a))return Yj(n,a,e)}return e}function J$(n,e,a,o,s,c,d,f,m){return n=Uk(a,o,!0,n,s,c,d,f,m),n.context=K$(null),a=n.current,o=Us(),s=rp(a),c=Ch(o,s),c.callback=e??null,ap(a,c,s),n.current.lanes=s,hw(n,s,o),vl(n,o),n}function _M(n,e,a,o){var s=e.current,c=Us(),d=rp(s);return a=K$(a),e.context===null?e.context=a:e.pendingContext=a,e=Ch(c,d),e.payload={element:n},o=o===void 0?null:o,o!==null&&(e.callback=o),n=ap(s,e,d),n!==null&&(lu(n,s,d,c),SA(n,s,d)),d}function AE(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function wU(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<e?a:e}}function Wk(n,e){wU(n,e),(n=n.alternate)&&wU(n,e)}function vle(){return null}var Q$=typeof reportError=="function"?reportError:function(n){console.error(n)};function Vk(n){this._internalRoot=n}bM.prototype.render=Vk.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(hn(409));_M(n,e,null,null)};bM.prototype.unmount=Vk.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Cg(function(){_M(null,n,null,null)}),e[Rh]=null}};function bM(n){this._internalRoot=n}bM.prototype.unstable_scheduleHydration=function(n){if(n){var e=Pj();n={blockedOn:null,target:n,priority:e};for(var a=0;a<Vf.length&&e!==0&&e<Vf[a].priority;a++);Vf.splice(a,0,n),a===0&&Lj(n)}};function Gk(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function xM(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function SU(){}function _le(n,e,a,o,s){if(s){if(typeof o=="function"){var c=o;o=function(){var y=AE(d);c.call(y)}}var d=J$(e,o,n,0,null,!1,!1,"",SU);return n._reactRootContainer=d,n[Rh]=d.current,yx(n.nodeType===8?n.parentNode:n),Cg(),d}for(;s=n.lastChild;)n.removeChild(s);if(typeof o=="function"){var f=o;o=function(){var y=AE(m);f.call(y)}}var m=Uk(n,0,!1,null,null,!1,!1,"",SU);return n._reactRootContainer=m,n[Rh]=m.current,yx(n.nodeType===8?n.parentNode:n),Cg(function(){_M(e,m,a,o)}),m}function wM(n,e,a,o,s){var c=a._reactRootContainer;if(c){var d=c;if(typeof s=="function"){var f=s;s=function(){var m=AE(d);f.call(m)}}_M(e,d,n,s)}else d=_le(a,e,n,s,o);return AE(d)}Tj=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var a=_b(e.pendingLanes);a!==0&&(lk(e,a|1),vl(e,oo()),!(si&6)&&(V0=oo()+500,Ap()))}break;case 13:Cg(function(){var o=kh(n,1);if(o!==null){var s=Us();lu(o,n,1,s)}}),Wk(n,1)}};ck=function(n){if(n.tag===13){var e=kh(n,134217728);if(e!==null){var a=Us();lu(e,n,134217728,a)}Wk(n,134217728)}};Cj=function(n){if(n.tag===13){var e=rp(n),a=kh(n,e);if(a!==null){var o=Us();lu(a,n,e,o)}Wk(n,e)}};Pj=function(){return Fi};Ij=function(n,e){var a=Fi;try{return Fi=n,e()}finally{Fi=a}};FI=function(n,e,a){switch(e){case"input":if(II(n,a),e=a.name,a.type==="radio"&&e!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<a.length;e++){var o=a[e];if(o!==n&&o.form===n.form){var s=hM(o);if(!s)throw Error(hn(90));sj(o),II(o,s)}}}break;case"textarea":cj(n,a);break;case"select":e=a.value,e!=null&&S0(n,!!a.multiple,e,!1)}};gj=zk;yj=Cg;var ble={usingClientEntryPoint:!1,Events:[pw,c0,hM,pj,mj,zk]},N1={findFiberByHostInstance:ag,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},xle={bundleType:N1.bundleType,version:N1.version,rendererPackageName:N1.rendererPackageName,rendererConfig:N1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Bh.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=bj(n),n===null?null:n.stateNode},findFiberByHostInstance:N1.findFiberByHostInstance||vle,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Q3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Q3.isDisabled&&Q3.supportsFiber)try{lM=Q3.inject(xle),ld=Q3}catch{}}Xl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ble;Xl.createPortal=function(n,e){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gk(e))throw Error(hn(200));return yle(n,e,null,a)};Xl.createRoot=function(n,e){if(!Gk(n))throw Error(hn(299));var a=!1,o="",s=Q$;return e!=null&&(e.unstable_strictMode===!0&&(a=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Uk(n,1,!1,null,null,a,!1,o,s),n[Rh]=e.current,yx(n.nodeType===8?n.parentNode:n),new Vk(e)};Xl.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(hn(188)):(n=Object.keys(n).join(","),Error(hn(268,n)));return n=bj(e),n=n===null?null:n.stateNode,n};Xl.flushSync=function(n){return Cg(n)};Xl.hydrate=function(n,e,a){if(!xM(e))throw Error(hn(200));return wM(null,n,e,!0,a)};Xl.hydrateRoot=function(n,e,a){if(!Gk(n))throw Error(hn(405));var o=a!=null&&a.hydratedSources||null,s=!1,c="",d=Q$;if(a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),e=J$(e,null,n,1,a??null,s,!1,c,d),n[Rh]=e.current,yx(n),o)for(n=0;n<o.length;n++)a=o[n],s=a._getVersion,s=s(a._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[a,s]:e.mutableSourceEagerHydrationData.push(a,s);return new bM(e)};Xl.render=function(n,e,a){if(!xM(e))throw Error(hn(200));return wM(null,n,e,!1,a)};Xl.unmountComponentAtNode=function(n){if(!xM(n))throw Error(hn(40));return n._reactRootContainer?(Cg(function(){wM(null,null,n,!1,function(){n._reactRootContainer=null,n[Rh]=null})}),!0):!1};Xl.unstable_batchedUpdates=zk;Xl.unstable_renderSubtreeIntoContainer=function(n,e,a,o){if(!xM(a))throw Error(hn(200));if(n==null||n._reactInternals===void 0)throw Error(hn(38));return wM(n,e,a,!1,o)};Xl.version="18.2.0-next-9e3b772b8-20220608";function eq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eq)}catch(n){console.error(n)}}eq(),JH.exports=Xl;var gw=JH.exports;const xb=uw(gw),wle=VH({__proto__:null,default:xb},[gw]);var AU=gw;SI.createRoot=AU.createRoot,SI.hydrateRoot=AU.hydrateRoot;/**
 * @remix-run/router v1.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gr(){return Gr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},Gr.apply(this,arguments)}var ao;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ao||(ao={}));const EU="popstate";function Sle(n){n===void 0&&(n={});function e(o,s){let{pathname:c,search:d,hash:f}=o.location;return Mx("",{pathname:c,search:d,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){return typeof s=="string"?s:yw(s)}return Ele(e,a,null,n)}function Ya(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Pg(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Ale(){return Math.random().toString(36).substr(2,8)}function MU(n,e){return{usr:n.state,key:n.key,idx:e}}function Mx(n,e,a,o){return a===void 0&&(a=null),Gr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Uh(e):e,{state:a,key:e&&e.key||o||Ale()})}function yw(n){let{pathname:e="/",search:a="",hash:o=""}=n;return a&&a!=="?"&&(e+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function Uh(n){let e={};if(n){let a=n.indexOf("#");a>=0&&(e.hash=n.substr(a),n=n.substr(0,a));let o=n.indexOf("?");o>=0&&(e.search=n.substr(o),n=n.substr(0,o)),n&&(e.pathname=n)}return e}function Ele(n,e,a,o){o===void 0&&(o={});let{window:s=document.defaultView,v5Compat:c=!1}=o,d=s.history,f=ao.Pop,m=null,y=_();y==null&&(y=0,d.replaceState(Gr({},d.state,{idx:y}),""));function _(){return(d.state||{idx:null}).idx}function w(){f=ao.Pop;let D=_(),L=D==null?null:D-y;y=D,m&&m({action:f,location:k.location,delta:L})}function A(D,L){f=ao.Push;let O=Mx(k.location,D,L);a&&a(O,D),y=_()+1;let F=MU(O,y),B=k.createHref(O);try{d.pushState(F,"",B)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;s.location.assign(B)}c&&m&&m({action:f,location:k.location,delta:1})}function C(D,L){f=ao.Replace;let O=Mx(k.location,D,L);a&&a(O,D),y=_();let F=MU(O,y),B=k.createHref(O);d.replaceState(F,"",B),c&&m&&m({action:f,location:k.location,delta:0})}function I(D){let L=s.location.origin!=="null"?s.location.origin:s.location.href,O=typeof D=="string"?D:yw(D);return Ya(L,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,L)}let k={get action(){return f},get location(){return n(s,d)},listen(D){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(EU,w),m=D,()=>{s.removeEventListener(EU,w),m=null}},createHref(D){return e(s,D)},createURL:I,encodeLocation(D){let L=I(D);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:A,replace:C,go(D){return d.go(D)}};return k}var io;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(io||(io={}));const Mle=new Set(["lazy","caseSensitive","path","id","index","children"]);function Tle(n){return n.index===!0}function gL(n,e,a,o){return a===void 0&&(a=[]),o===void 0&&(o={}),n.map((s,c)=>{let d=[...a,c],f=typeof s.id=="string"?s.id:d.join("-");if(Ya(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ya(!o[f],'Found a route id collision on id "'+f+`".  Route id's must be globally unique within Data Router usages`),Tle(s)){let m=Gr({},s,e(s),{id:f});return o[f]=m,m}else{let m=Gr({},s,e(s),{id:f,children:void 0});return o[f]=m,s.children&&(m.children=gL(s.children,e,d,o)),m}})}function g0(n,e,a){a===void 0&&(a="/");let o=typeof e=="string"?Uh(e):e,s=vw(o.pathname||"/",a);if(s==null)return null;let c=tq(n);Ple(c);let d=null;for(let f=0;d==null&&f<c.length;++f)d=Nle(c[f],Wle(s));return d}function Cle(n,e){let{route:a,pathname:o,params:s}=n;return{id:a.id,pathname:o,params:s,data:e[a.id],handle:a.handle}}function tq(n,e,a,o){e===void 0&&(e=[]),a===void 0&&(a=[]),o===void 0&&(o="");let s=(c,d,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};m.relativePath.startsWith("/")&&(Ya(m.relativePath.startsWith(o),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(o.length));let y=sp([o,m.relativePath]),_=a.concat(m);c.children&&c.children.length>0&&(Ya(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),tq(c.children,e,_,y)),!(c.path==null&&!c.index)&&e.push({path:y,score:zle(y,c.index),routesMeta:_})};return n.forEach((c,d)=>{var f;if(c.path===""||!((f=c.path)!=null&&f.includes("?")))s(c,d);else for(let m of nq(c.path))s(c,d,m)}),e}function nq(n){let e=n.split("/");if(e.length===0)return[];let[a,...o]=e,s=a.endsWith("?"),c=a.replace(/\?$/,"");if(o.length===0)return s?[c,""]:[c];let d=nq(o.join("/")),f=[];return f.push(...d.map(m=>m===""?c:[c,m].join("/"))),s&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function Ple(n){n.sort((e,a)=>e.score!==a.score?a.score-e.score:Fle(e.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}const Ile=/^:\w+$/,Lle=3,Rle=2,kle=1,Dle=10,Ole=-2,TU=n=>n==="*";function zle(n,e){let a=n.split("/"),o=a.length;return a.some(TU)&&(o+=Ole),e&&(o+=Rle),a.filter(s=>!TU(s)).reduce((s,c)=>s+(Ile.test(c)?Lle:c===""?kle:Dle),o)}function Fle(n,e){return n.length===e.length&&n.slice(0,-1).every((o,s)=>o===e[s])?n[n.length-1]-e[e.length-1]:0}function Nle(n,e){let{routesMeta:a}=n,o={},s="/",c=[];for(let d=0;d<a.length;++d){let f=a[d],m=d===a.length-1,y=s==="/"?e:e.slice(s.length)||"/",_=Ble({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},y);if(!_)return null;Object.assign(o,_.params);let w=f.route;c.push({params:o,pathname:sp([s,_.pathname]),pathnameBase:jle(sp([s,_.pathnameBase])),route:w}),_.pathnameBase!=="/"&&(s=sp([s,_.pathnameBase]))}return c}function Ble(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[a,o]=Ule(n.path,n.caseSensitive,n.end),s=e.match(a);if(!s)return null;let c=s[0],d=c.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:o.reduce((y,_,w)=>{let{paramName:A,isOptional:C}=_;if(A==="*"){let k=f[w]||"";d=c.slice(0,c.length-k.length).replace(/(.)\/+$/,"$1")}const I=f[w];return C&&!I?y[A]=void 0:y[A]=Vle(I||"",A),y},{}),pathname:c,pathnameBase:d,pattern:n}}function Ule(n,e,a){e===void 0&&(e=!1),a===void 0&&(a=!0),Pg(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let o=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(d,f,m)=>(o.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(o.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),o]}function Wle(n){try{return decodeURI(n)}catch(e){return Pg(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Vle(n,e){try{return decodeURIComponent(n)}catch(a){return Pg(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),n}}function vw(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let a=e.endsWith("/")?e.length-1:e.length,o=n.charAt(a);return o&&o!=="/"?null:n.slice(a)||"/"}function Gle(n,e){e===void 0&&(e="/");let{pathname:a,search:o="",hash:s=""}=typeof n=="string"?Uh(n):n;return{pathname:a?a.startsWith("/")?a:Hle(a,e):e,search:$le(o),hash:qle(s)}}function Hle(n,e){let a=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function X5(n,e,a,o){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Hk(n){return n.filter((e,a)=>a===0||e.route.path&&e.route.path.length>0)}function aq(n,e,a,o){o===void 0&&(o=!1);let s;typeof n=="string"?s=Uh(n):(s=Gr({},n),Ya(!s.pathname||!s.pathname.includes("?"),X5("?","pathname","search",s)),Ya(!s.pathname||!s.pathname.includes("#"),X5("#","pathname","hash",s)),Ya(!s.search||!s.search.includes("#"),X5("#","search","hash",s)));let c=n===""||s.pathname==="",d=c?"/":s.pathname,f;if(d==null)f=a;else if(o){let w=e[e.length-1].replace(/^\//,"").split("/");if(d.startsWith("..")){let A=d.split("/");for(;A[0]==="..";)A.shift(),w.pop();s.pathname=A.join("/")}f="/"+w.join("/")}else{let w=e.length-1;if(d.startsWith("..")){let A=d.split("/");for(;A[0]==="..";)A.shift(),w-=1;s.pathname=A.join("/")}f=w>=0?e[w]:"/"}let m=Gle(s,f),y=d&&d!=="/"&&d.endsWith("/"),_=(c||d===".")&&a.endsWith("/");return!m.pathname.endsWith("/")&&(y||_)&&(m.pathname+="/"),m}const sp=n=>n.join("/").replace(/\/\/+/g,"/"),jle=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),$le=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,qle=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class jk{constructor(e,a,o,s){s===void 0&&(s=!1),this.status=e,this.statusText=a||"",this.internal=s,o instanceof Error?(this.data=o.toString(),this.error=o):this.data=o}}function iq(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const rq=["post","put","patch","delete"],Xle=new Set(rq),Zle=["get",...rq],Yle=new Set(Zle),Kle=new Set([301,302,303,307,308]),Jle=new Set([307,308]),Z5={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Qle={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},B1={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},oq=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ece=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),sq="remix-router-transitions";function tce(n){const e=n.window?n.window:typeof window<"u"?window:void 0,a=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",o=!a;Ya(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(n.mapRouteProperties)s=n.mapRouteProperties;else if(n.detectErrorBoundary){let _e=n.detectErrorBoundary;s=Ze=>({hasErrorBoundary:_e(Ze)})}else s=ece;let c={},d=gL(n.routes,s,void 0,c),f,m=n.basename||"/",y=Gr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),_=null,w=new Set,A=null,C=null,I=null,k=n.hydrationData!=null,D=g0(d,n.history.location,m),L=null;if(D==null){let _e=mc(404,{pathname:n.history.location.pathname}),{matches:Ze,route:Se}=OU(d);D=Ze,L={[Se.id]:_e}}let O=!D.some(_e=>_e.route.lazy)&&(!D.some(_e=>_e.route.loader)||n.hydrationData!=null),F,B={historyAction:n.history.action,location:n.history.location,matches:D,initialized:O,navigation:Z5,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||L,fetchers:new Map,blockers:new Map},G=ao.Pop,q=!1,X,ee=!1,V=new Map,Q=null,me=!1,pe=!1,be=[],fe=[],Ce=new Map,Re=0,He=-1,ue=new Map,ye=new Set,Ae=new Map,ne=new Map,Ee=new Set,Ye=new Map,Xe=new Map,Ke=!1;function Ue(){if(_=n.history.listen(_e=>{let{action:Ze,location:Se,delta:Me}=_e;if(Ke){Ke=!1;return}Pg(Xe.size===0||Me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ze=wt({currentLocation:B.location,nextLocation:Se,historyAction:Ze});if(ze&&Me!=null){Ke=!0,n.history.go(Me*-1),Ft(ze,{state:"blocked",location:Se,proceed(){Ft(ze,{state:"proceeding",proceed:void 0,reset:void 0,location:Se}),n.history.go(Me)},reset(){let Je=new Map(B.blockers);Je.set(ze,B1),Rt({blockers:Je})}});return}return ft(Ze,Se)}),a){hce(e,V);let _e=()=>fce(e,V);e.addEventListener("pagehide",_e),Q=()=>e.removeEventListener("pagehide",_e)}return B.initialized||ft(ao.Pop,B.location),F}function ht(){_&&_(),Q&&Q(),w.clear(),X&&X.abort(),B.fetchers.forEach((_e,Ze)=>Oe(Ze)),B.blockers.forEach((_e,Ze)=>$t(Ze))}function Lt(_e){return w.add(_e),()=>w.delete(_e)}function Rt(_e,Ze){Ze===void 0&&(Ze={}),B=Gr({},B,_e);let Se=[],Me=[];y.v7_fetcherPersist&&B.fetchers.forEach((ze,Je)=>{ze.state==="idle"&&(Ee.has(Je)?Me.push(Je):Se.push(Je))}),[...w].forEach(ze=>ze(B,{deletedFetchers:Me,unstable_viewTransitionOpts:Ze.viewTransitionOpts,unstable_flushSync:Ze.flushSync===!0})),y.v7_fetcherPersist&&(Se.forEach(ze=>B.fetchers.delete(ze)),Me.forEach(ze=>Oe(ze)))}function Jt(_e,Ze,Se){var Me,ze;let{flushSync:Je}=Se===void 0?{}:Se,et=B.actionData!=null&&B.navigation.formMethod!=null&&tu(B.navigation.formMethod)&&B.navigation.state==="loading"&&((Me=_e.state)==null?void 0:Me._isRedirect)!==!0,yt;Ze.actionData?Object.keys(Ze.actionData).length>0?yt=Ze.actionData:yt=null:et?yt=B.actionData:yt=null;let ut=Ze.loaderData?DU(B.loaderData,Ze.loaderData,Ze.matches||[],Ze.errors):B.loaderData,ct=B.blockers;ct.size>0&&(ct=new Map(ct),ct.forEach((Qt,mn)=>ct.set(mn,B1)));let Gt=q===!0||B.navigation.formMethod!=null&&tu(B.navigation.formMethod)&&((ze=_e.state)==null?void 0:ze._isRedirect)!==!0;f&&(d=f,f=void 0),me||G===ao.Pop||(G===ao.Push?n.history.push(_e,_e.state):G===ao.Replace&&n.history.replace(_e,_e.state));let Mt;if(G===ao.Pop){let Qt=V.get(B.location.pathname);Qt&&Qt.has(_e.pathname)?Mt={currentLocation:B.location,nextLocation:_e}:V.has(_e.pathname)&&(Mt={currentLocation:_e,nextLocation:B.location})}else if(ee){let Qt=V.get(B.location.pathname);Qt?Qt.add(_e.pathname):(Qt=new Set([_e.pathname]),V.set(B.location.pathname,Qt)),Mt={currentLocation:B.location,nextLocation:_e}}Rt(Gr({},Ze,{actionData:yt,loaderData:ut,historyAction:G,location:_e,initialized:!0,navigation:Z5,revalidation:"idle",restoreScrollPosition:Dt(_e,Ze.matches||B.matches),preventScrollReset:Gt,blockers:ct}),{viewTransitionOpts:Mt,flushSync:Je===!0}),G=ao.Pop,q=!1,ee=!1,me=!1,pe=!1,be=[],fe=[]}async function Pt(_e,Ze){if(typeof _e=="number"){n.history.go(_e);return}let Se=yL(B.location,B.matches,m,y.v7_prependBasename,_e,Ze==null?void 0:Ze.fromRouteId,Ze==null?void 0:Ze.relative),{path:Me,submission:ze,error:Je}=CU(y.v7_normalizeFormMethod,!1,Se,Ze),et=B.location,yt=Mx(B.location,Me,Ze&&Ze.state);yt=Gr({},yt,n.history.encodeLocation(yt));let ut=Ze&&Ze.replace!=null?Ze.replace:void 0,ct=ao.Push;ut===!0?ct=ao.Replace:ut===!1||ze!=null&&tu(ze.formMethod)&&ze.formAction===B.location.pathname+B.location.search&&(ct=ao.Replace);let Gt=Ze&&"preventScrollReset"in Ze?Ze.preventScrollReset===!0:void 0,Mt=(Ze&&Ze.unstable_flushSync)===!0,Qt=wt({currentLocation:et,nextLocation:yt,historyAction:ct});if(Qt){Ft(Qt,{state:"blocked",location:yt,proceed(){Ft(Qt,{state:"proceeding",proceed:void 0,reset:void 0,location:yt}),Pt(_e,Ze)},reset(){let mn=new Map(B.blockers);mn.set(Qt,B1),Rt({blockers:mn})}});return}return await ft(ct,yt,{submission:ze,pendingError:Je,preventScrollReset:Gt,replace:Ze&&Ze.replace,enableViewTransition:Ze&&Ze.unstable_viewTransition,flushSync:Mt})}function Pe(){if(De(),Rt({revalidation:"loading"}),B.navigation.state!=="submitting"){if(B.navigation.state==="idle"){ft(B.historyAction,B.location,{startUninterruptedRevalidation:!0});return}ft(G||B.historyAction,B.navigation.location,{overrideNavigation:B.navigation})}}async function ft(_e,Ze,Se){X&&X.abort(),X=null,G=_e,me=(Se&&Se.startUninterruptedRevalidation)===!0,qt(B.location,B.matches),q=(Se&&Se.preventScrollReset)===!0,ee=(Se&&Se.enableViewTransition)===!0;let Me=f||d,ze=Se&&Se.overrideNavigation,Je=g0(Me,Ze,m),et=(Se&&Se.flushSync)===!0;if(!Je){let mn=mc(404,{pathname:Ze.pathname}),{matches:nn,route:wn}=OU(Me);Yt(),Jt(Ze,{matches:nn,loaderData:{},errors:{[wn.id]:mn}},{flushSync:et});return}if(B.initialized&&!pe&&oce(B.location,Ze)&&!(Se&&Se.submission&&tu(Se.submission.formMethod))){Jt(Ze,{matches:Je},{flushSync:et});return}X=new AbortController;let yt=W1(n.history,Ze,X.signal,Se&&Se.submission),ut,ct;if(Se&&Se.pendingError)ct={[Ub(Je).route.id]:Se.pendingError};else if(Se&&Se.submission&&tu(Se.submission.formMethod)){let mn=await gt(yt,Ze,Se.submission,Je,{replace:Se.replace,flushSync:et});if(mn.shortCircuited)return;ut=mn.pendingActionData,ct=mn.pendingActionError,ze=Y5(Ze,Se.submission),et=!1,yt=new Request(yt.url,{signal:yt.signal})}let{shortCircuited:Gt,loaderData:Mt,errors:Qt}=await St(yt,Ze,Je,ze,Se&&Se.submission,Se&&Se.fetcherSubmission,Se&&Se.replace,et,ut,ct);Gt||(X=null,Jt(Ze,Gr({matches:Je},ut?{actionData:ut}:{},{loaderData:Mt,errors:Qt})))}async function gt(_e,Ze,Se,Me,ze){ze===void 0&&(ze={}),De();let Je=uce(Ze,Se);Rt({navigation:Je},{flushSync:ze.flushSync===!0});let et,yt=_L(Me,Ze);if(!yt.route.action&&!yt.route.lazy)et={type:io.error,error:mc(405,{method:_e.method,pathname:Ze.pathname,routeId:yt.route.id})};else if(et=await U1("action",_e,yt,Me,c,s,m),_e.signal.aborted)return{shortCircuited:!0};if(P0(et)){let ut;return ze&&ze.replace!=null?ut=ze.replace:ut=et.location===B.location.pathname+B.location.search,await ve(B,et,{submission:Se,replace:ut}),{shortCircuited:!0}}if(Wb(et)){let ut=Ub(Me,yt.route.id);return(ze&&ze.replace)!==!0&&(G=ao.Push),{pendingActionData:{},pendingActionError:{[ut.route.id]:et.error}}}if(og(et))throw mc(400,{type:"defer-action"});return{pendingActionData:{[yt.route.id]:et.data}}}async function St(_e,Ze,Se,Me,ze,Je,et,yt,ut,ct){let Gt=Me||Y5(Ze,ze),Mt=ze||Je||NU(Gt),Qt=f||d,[mn,nn]=PU(n.history,B,Se,Mt,Ze,pe,be,fe,Ae,ye,Qt,m,ut,ct);if(Yt(Tt=>!(Se&&Se.some(Ot=>Ot.route.id===Tt))||mn&&mn.some(Ot=>Ot.route.id===Tt)),He=++Re,mn.length===0&&nn.length===0){let Tt=At();return Jt(Ze,Gr({matches:Se,loaderData:{},errors:ct||null},ut?{actionData:ut}:{},Tt?{fetchers:new Map(B.fetchers)}:{}),{flushSync:yt}),{shortCircuited:!0}}if(!me){nn.forEach(Ot=>{let ln=B.fetchers.get(Ot.key),Tn=V1(void 0,ln?ln.data:void 0);B.fetchers.set(Ot.key,Tn)});let Tt=ut||B.actionData;Rt(Gr({navigation:Gt},Tt?Object.keys(Tt).length===0?{actionData:null}:{actionData:Tt}:{},nn.length>0?{fetchers:new Map(B.fetchers)}:{}),{flushSync:yt})}nn.forEach(Tt=>{Ce.has(Tt.key)&&it(Tt.key),Tt.controller&&Ce.set(Tt.key,Tt.controller)});let wn=()=>nn.forEach(Tt=>it(Tt.key));X&&X.signal.addEventListener("abort",wn);let{results:Hn,loaderResults:fa,fetcherResults:Ca}=await $e(B.matches,Se,mn,nn,_e);if(_e.signal.aborted)return{shortCircuited:!0};X&&X.signal.removeEventListener("abort",wn),nn.forEach(Tt=>Ce.delete(Tt.key));let Ma=zU(Hn);if(Ma){if(Ma.idx>=mn.length){let Tt=nn[Ma.idx-mn.length].key;ye.add(Tt)}return await ve(B,Ma.result,{replace:et}),{shortCircuited:!0}}let{loaderData:Ii,errors:pi}=kU(B,Se,mn,fa,ct,nn,Ca,Ye);Ye.forEach((Tt,Ot)=>{Tt.subscribe(ln=>{(ln||Tt.done)&&Ye.delete(Ot)})});let Le=At(),_t=Ut(He),kt=Le||_t||nn.length>0;return Gr({loaderData:Ii,errors:pi},kt?{fetchers:new Map(B.fetchers)}:{})}function Be(_e,Ze,Se,Me){if(o)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ce.has(_e)&&it(_e);let ze=(Me&&Me.unstable_flushSync)===!0,Je=f||d,et=yL(B.location,B.matches,m,y.v7_prependBasename,Se,Ze,Me==null?void 0:Me.relative),yt=g0(Je,et,m);if(!yt){ce(_e,Ze,mc(404,{pathname:et}),{flushSync:ze});return}let{path:ut,submission:ct,error:Gt}=CU(y.v7_normalizeFormMethod,!0,et,Me);if(Gt){ce(_e,Ze,Gt,{flushSync:ze});return}let Mt=_L(yt,ut);if(q=(Me&&Me.preventScrollReset)===!0,ct&&tu(ct.formMethod)){le(_e,Ze,ut,Mt,yt,ze,ct);return}Ae.set(_e,{routeId:Ze,path:ut}),oe(_e,Ze,ut,Mt,yt,ze,ct)}async function le(_e,Ze,Se,Me,ze,Je,et){if(De(),Ae.delete(_e),!Me.route.action&&!Me.route.lazy){let ln=mc(405,{method:et.formMethod,pathname:Se,routeId:Ze});ce(_e,Ze,ln,{flushSync:Je});return}let yt=B.fetchers.get(_e);ot(_e,dce(et,yt),{flushSync:Je});let ut=new AbortController,ct=W1(n.history,Se,ut.signal,et);Ce.set(_e,ut);let Gt=Re,Mt=await U1("action",ct,Me,ze,c,s,m);if(ct.signal.aborted){Ce.get(_e)===ut&&Ce.delete(_e);return}if(Ee.has(_e)){ot(_e,Bf(void 0));return}if(P0(Mt))if(Ce.delete(_e),He>Gt){ot(_e,Bf(void 0));return}else return ye.add(_e),ot(_e,V1(et)),ve(B,Mt,{fetcherSubmission:et});if(Wb(Mt)){ce(_e,Ze,Mt.error);return}if(og(Mt))throw mc(400,{type:"defer-action"});let Qt=B.navigation.location||B.location,mn=W1(n.history,Qt,ut.signal),nn=f||d,wn=B.navigation.state!=="idle"?g0(nn,B.navigation.location,m):B.matches;Ya(wn,"Didn't find any matches after fetcher action");let Hn=++Re;ue.set(_e,Hn);let fa=V1(et,Mt.data);B.fetchers.set(_e,fa);let[Ca,Ma]=PU(n.history,B,wn,et,Qt,pe,be,fe,Ae,ye,nn,m,{[Me.route.id]:Mt.data},void 0);Ma.filter(ln=>ln.key!==_e).forEach(ln=>{let Tn=ln.key,qn=B.fetchers.get(Tn),an=V1(void 0,qn?qn.data:void 0);B.fetchers.set(Tn,an),Ce.has(Tn)&&it(Tn),ln.controller&&Ce.set(Tn,ln.controller)}),Rt({fetchers:new Map(B.fetchers)});let Ii=()=>Ma.forEach(ln=>it(ln.key));ut.signal.addEventListener("abort",Ii);let{results:pi,loaderResults:Le,fetcherResults:_t}=await $e(B.matches,wn,Ca,Ma,mn);if(ut.signal.aborted)return;ut.signal.removeEventListener("abort",Ii),ue.delete(_e),Ce.delete(_e),Ma.forEach(ln=>Ce.delete(ln.key));let kt=zU(pi);if(kt){if(kt.idx>=Ca.length){let ln=Ma[kt.idx-Ca.length].key;ye.add(ln)}return ve(B,kt.result)}let{loaderData:Tt,errors:Ot}=kU(B,B.matches,Ca,Le,void 0,Ma,_t,Ye);if(B.fetchers.has(_e)){let ln=Bf(Mt.data);B.fetchers.set(_e,ln)}Ut(Hn),B.navigation.state==="loading"&&Hn>He?(Ya(G,"Expected pending action"),X&&X.abort(),Jt(B.navigation.location,{matches:wn,loaderData:Tt,errors:Ot,fetchers:new Map(B.fetchers)})):(Rt({errors:Ot,loaderData:DU(B.loaderData,Tt,wn,Ot),fetchers:new Map(B.fetchers)}),pe=!1)}async function oe(_e,Ze,Se,Me,ze,Je,et){let yt=B.fetchers.get(_e);ot(_e,V1(et,yt?yt.data:void 0),{flushSync:Je});let ut=new AbortController,ct=W1(n.history,Se,ut.signal);Ce.set(_e,ut);let Gt=Re,Mt=await U1("loader",ct,Me,ze,c,s,m);if(og(Mt)&&(Mt=await uq(Mt,ct.signal,!0)||Mt),Ce.get(_e)===ut&&Ce.delete(_e),!ct.signal.aborted){if(Ee.has(_e)){ot(_e,Bf(void 0));return}if(P0(Mt))if(He>Gt){ot(_e,Bf(void 0));return}else{ye.add(_e),await ve(B,Mt);return}if(Wb(Mt)){ce(_e,Ze,Mt.error);return}Ya(!og(Mt),"Unhandled fetcher deferred data"),ot(_e,Bf(Mt.data))}}async function ve(_e,Ze,Se){let{submission:Me,fetcherSubmission:ze,replace:Je}=Se===void 0?{}:Se;Ze.revalidate&&(pe=!0);let et=Mx(_e.location,Ze.location,{_isRedirect:!0});if(Ya(et,"Expected a location on the redirect navigation"),a){let Qt=!1;if(Ze.reloadDocument)Qt=!0;else if(oq.test(Ze.location)){const mn=n.history.createURL(Ze.location);Qt=mn.origin!==e.location.origin||vw(mn.pathname,m)==null}if(Qt){Je?e.location.replace(Ze.location):e.location.assign(Ze.location);return}}X=null;let yt=Je===!0?ao.Replace:ao.Push,{formMethod:ut,formAction:ct,formEncType:Gt}=_e.navigation;!Me&&!ze&&ut&&ct&&Gt&&(Me=NU(_e.navigation));let Mt=Me||ze;if(Jle.has(Ze.status)&&Mt&&tu(Mt.formMethod))await ft(yt,et,{submission:Gr({},Mt,{formAction:Ze.location}),preventScrollReset:q});else{let Qt=Y5(et,Me);await ft(yt,et,{overrideNavigation:Qt,fetcherSubmission:ze,preventScrollReset:q})}}async function $e(_e,Ze,Se,Me,ze){let Je=await Promise.all([...Se.map(ut=>U1("loader",ze,ut,Ze,c,s,m)),...Me.map(ut=>ut.matches&&ut.match&&ut.controller?U1("loader",W1(n.history,ut.path,ut.controller.signal),ut.match,ut.matches,c,s,m):{type:io.error,error:mc(404,{pathname:ut.path})})]),et=Je.slice(0,Se.length),yt=Je.slice(Se.length);return await Promise.all([FU(_e,Se,et,et.map(()=>ze.signal),!1,B.loaderData),FU(_e,Me.map(ut=>ut.match),yt,Me.map(ut=>ut.controller?ut.controller.signal:null),!0)]),{results:Je,loaderResults:et,fetcherResults:yt}}function De(){pe=!0,be.push(...Yt()),Ae.forEach((_e,Ze)=>{Ce.has(Ze)&&(fe.push(Ze),it(Ze))})}function ot(_e,Ze,Se){Se===void 0&&(Se={}),B.fetchers.set(_e,Ze),Rt({fetchers:new Map(B.fetchers)},{flushSync:(Se&&Se.flushSync)===!0})}function ce(_e,Ze,Se,Me){Me===void 0&&(Me={});let ze=Ub(B.matches,Ze);Oe(_e),Rt({errors:{[ze.route.id]:Se},fetchers:new Map(B.fetchers)},{flushSync:(Me&&Me.flushSync)===!0})}function te(_e){return y.v7_fetcherPersist&&(ne.set(_e,(ne.get(_e)||0)+1),Ee.has(_e)&&Ee.delete(_e)),B.fetchers.get(_e)||Qle}function Oe(_e){let Ze=B.fetchers.get(_e);Ce.has(_e)&&!(Ze&&Ze.state==="loading"&&ue.has(_e))&&it(_e),Ae.delete(_e),ue.delete(_e),ye.delete(_e),Ee.delete(_e),B.fetchers.delete(_e)}function pt(_e){if(y.v7_fetcherPersist){let Ze=(ne.get(_e)||0)-1;Ze<=0?(ne.delete(_e),Ee.add(_e)):ne.set(_e,Ze)}else Oe(_e);Rt({fetchers:new Map(B.fetchers)})}function it(_e){let Ze=Ce.get(_e);Ya(Ze,"Expected fetch controller: "+_e),Ze.abort(),Ce.delete(_e)}function st(_e){for(let Ze of _e){let Se=te(Ze),Me=Bf(Se.data);B.fetchers.set(Ze,Me)}}function At(){let _e=[],Ze=!1;for(let Se of ye){let Me=B.fetchers.get(Se);Ya(Me,"Expected fetcher: "+Se),Me.state==="loading"&&(ye.delete(Se),_e.push(Se),Ze=!0)}return st(_e),Ze}function Ut(_e){let Ze=[];for(let[Se,Me]of ue)if(Me<_e){let ze=B.fetchers.get(Se);Ya(ze,"Expected fetcher: "+Se),ze.state==="loading"&&(it(Se),ue.delete(Se),Ze.push(Se))}return st(Ze),Ze.length>0}function Vt(_e,Ze){let Se=B.blockers.get(_e)||B1;return Xe.get(_e)!==Ze&&Xe.set(_e,Ze),Se}function $t(_e){B.blockers.delete(_e),Xe.delete(_e)}function Ft(_e,Ze){let Se=B.blockers.get(_e)||B1;Ya(Se.state==="unblocked"&&Ze.state==="blocked"||Se.state==="blocked"&&Ze.state==="blocked"||Se.state==="blocked"&&Ze.state==="proceeding"||Se.state==="blocked"&&Ze.state==="unblocked"||Se.state==="proceeding"&&Ze.state==="unblocked","Invalid blocker state transition: "+Se.state+" -> "+Ze.state);let Me=new Map(B.blockers);Me.set(_e,Ze),Rt({blockers:Me})}function wt(_e){let{currentLocation:Ze,nextLocation:Se,historyAction:Me}=_e;if(Xe.size===0)return;Xe.size>1&&Pg(!1,"A router only supports one blocker at a time");let ze=Array.from(Xe.entries()),[Je,et]=ze[ze.length-1],yt=B.blockers.get(Je);if(!(yt&&yt.state==="proceeding")&&et({currentLocation:Ze,nextLocation:Se,historyAction:Me}))return Je}function Yt(_e){let Ze=[];return Ye.forEach((Se,Me)=>{(!_e||_e(Me))&&(Se.cancel(),Ze.push(Me),Ye.delete(Me))}),Ze}function Ge(_e,Ze,Se){if(A=_e,I=Ze,C=Se||null,!k&&B.navigation===Z5){k=!0;let Me=Dt(B.location,B.matches);Me!=null&&Rt({restoreScrollPosition:Me})}return()=>{A=null,I=null,C=null}}function It(_e,Ze){return C&&C(_e,Ze.map(Me=>Cle(Me,B.loaderData)))||_e.key}function qt(_e,Ze){if(A&&I){let Se=It(_e,Ze);A[Se]=I()}}function Dt(_e,Ze){if(A){let Se=It(_e,Ze),Me=A[Se];if(typeof Me=="number")return Me}return null}function fn(_e){c={},f=gL(_e,s,void 0,c)}return F={get basename(){return m},get state(){return B},get routes(){return d},get window(){return e},initialize:Ue,subscribe:Lt,enableScrollRestoration:Ge,navigate:Pt,fetch:Be,revalidate:Pe,createHref:_e=>n.history.createHref(_e),encodeLocation:_e=>n.history.encodeLocation(_e),getFetcher:te,deleteFetcher:pt,dispose:ht,getBlocker:Vt,deleteBlocker:$t,_internalFetchControllers:Ce,_internalActiveDeferreds:Ye,_internalSetRoutes:fn},F}function nce(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function yL(n,e,a,o,s,c,d){let f,m;if(c){f=[];for(let _ of e)if(f.push(_),_.route.id===c){m=_;break}}else f=e,m=e[e.length-1];let y=aq(s||".",Hk(f).map(_=>_.pathnameBase),vw(n.pathname,a)||n.pathname,d==="path");return s==null&&(y.search=n.search,y.hash=n.hash),(s==null||s===""||s===".")&&m&&m.route.index&&!$k(y.search)&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),o&&a!=="/"&&(y.pathname=y.pathname==="/"?a:sp([a,y.pathname])),yw(y)}function CU(n,e,a,o){if(!o||!nce(o))return{path:a};if(o.formMethod&&!cce(o.formMethod))return{path:a,error:mc(405,{method:o.formMethod})};let s=()=>({path:a,error:mc(400,{type:"invalid-body"})}),c=o.formMethod||"get",d=n?c.toUpperCase():c.toLowerCase(),f=cq(a);if(o.body!==void 0){if(o.formEncType==="text/plain"){if(!tu(d))return s();let A=typeof o.body=="string"?o.body:o.body instanceof FormData||o.body instanceof URLSearchParams?Array.from(o.body.entries()).reduce((C,I)=>{let[k,D]=I;return""+C+k+"="+D+`
`},""):String(o.body);return{path:a,submission:{formMethod:d,formAction:f,formEncType:o.formEncType,formData:void 0,json:void 0,text:A}}}else if(o.formEncType==="application/json"){if(!tu(d))return s();try{let A=typeof o.body=="string"?JSON.parse(o.body):o.body;return{path:a,submission:{formMethod:d,formAction:f,formEncType:o.formEncType,formData:void 0,json:A,text:void 0}}}catch{return s()}}}Ya(typeof FormData=="function","FormData is not available in this environment");let m,y;if(o.formData)m=vL(o.formData),y=o.formData;else if(o.body instanceof FormData)m=vL(o.body),y=o.body;else if(o.body instanceof URLSearchParams)m=o.body,y=RU(m);else if(o.body==null)m=new URLSearchParams,y=new FormData;else try{m=new URLSearchParams(o.body),y=RU(m)}catch{return s()}let _={formMethod:d,formAction:f,formEncType:o&&o.formEncType||"application/x-www-form-urlencoded",formData:y,json:void 0,text:void 0};if(tu(_.formMethod))return{path:a,submission:_};let w=Uh(a);return e&&w.search&&$k(w.search)&&m.append("index",""),w.search="?"+m,{path:yw(w),submission:_}}function ace(n,e){let a=n;if(e){let o=n.findIndex(s=>s.route.id===e);o>=0&&(a=n.slice(0,o))}return a}function PU(n,e,a,o,s,c,d,f,m,y,_,w,A,C){let I=C?Object.values(C)[0]:A?Object.values(A)[0]:void 0,k=n.createURL(e.location),D=n.createURL(s),L=C?Object.keys(C)[0]:void 0,F=ace(a,L).filter((G,q)=>{if(G.route.lazy)return!0;if(G.route.loader==null)return!1;if(ice(e.loaderData,e.matches[q],G)||d.some(V=>V===G.route.id))return!0;let X=e.matches[q],ee=G;return IU(G,Gr({currentUrl:k,currentParams:X.params,nextUrl:D,nextParams:ee.params},o,{actionResult:I,defaultShouldRevalidate:c||k.pathname+k.search===D.pathname+D.search||k.search!==D.search||lq(X,ee)}))}),B=[];return m.forEach((G,q)=>{if(!a.some(me=>me.route.id===G.routeId))return;let X=g0(_,G.path,w);if(!X){B.push({key:q,routeId:G.routeId,path:G.path,matches:null,match:null,controller:null});return}let ee=e.fetchers.get(q),V=_L(X,G.path),Q=!1;y.has(q)?Q=!1:f.includes(q)?Q=!0:ee&&ee.state!=="idle"&&ee.data===void 0?Q=c:Q=IU(V,Gr({currentUrl:k,currentParams:e.matches[e.matches.length-1].params,nextUrl:D,nextParams:a[a.length-1].params},o,{actionResult:I,defaultShouldRevalidate:c})),Q&&B.push({key:q,routeId:G.routeId,path:G.path,matches:X,match:V,controller:new AbortController})}),[F,B]}function ice(n,e,a){let o=!e||a.route.id!==e.route.id,s=n[a.route.id]===void 0;return o||s}function lq(n,e){let a=n.route.path;return n.pathname!==e.pathname||a!=null&&a.endsWith("*")&&n.params["*"]!==e.params["*"]}function IU(n,e){if(n.route.shouldRevalidate){let a=n.route.shouldRevalidate(e);if(typeof a=="boolean")return a}return e.defaultShouldRevalidate}async function LU(n,e,a){if(!n.lazy)return;let o=await n.lazy();if(!n.lazy)return;let s=a[n.id];Ya(s,"No route found in manifest");let c={};for(let d in o){let m=s[d]!==void 0&&d!=="hasErrorBoundary";Pg(!m,'Route "'+s.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!m&&!Mle.has(d)&&(c[d]=o[d])}Object.assign(s,c),Object.assign(s,Gr({},e(s),{lazy:void 0}))}async function U1(n,e,a,o,s,c,d,f){f===void 0&&(f={});let m,y,_,w=I=>{let k,D=new Promise((L,O)=>k=O);return _=()=>k(),e.signal.addEventListener("abort",_),Promise.race([I({request:e,params:a.params,context:f.requestContext}),D])};try{let I=a.route[n];if(a.route.lazy)if(I){let k,D=await Promise.all([w(I).catch(L=>{k=L}),LU(a.route,c,s)]);if(k)throw k;y=D[0]}else if(await LU(a.route,c,s),I=a.route[n],I)y=await w(I);else if(n==="action"){let k=new URL(e.url),D=k.pathname+k.search;throw mc(405,{method:e.method,pathname:D,routeId:a.route.id})}else return{type:io.data,data:void 0};else if(I)y=await w(I);else{let k=new URL(e.url),D=k.pathname+k.search;throw mc(404,{pathname:D})}Ya(y!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+a.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(I){m=io.error,y=I}finally{_&&e.signal.removeEventListener("abort",_)}if(lce(y)){let I=y.status;if(Kle.has(I)){let L=y.headers.get("Location");if(Ya(L,"Redirects returned/thrown from loaders/actions must have a Location header"),!oq.test(L))L=yL(new URL(e.url),o.slice(0,o.indexOf(a)+1),d,!0,L);else if(!f.isStaticRequest){let O=new URL(e.url),F=L.startsWith("//")?new URL(O.protocol+L):new URL(L),B=vw(F.pathname,d)!=null;F.origin===O.origin&&B&&(L=F.pathname+F.search+F.hash)}if(f.isStaticRequest)throw y.headers.set("Location",L),y;return{type:io.redirect,status:I,location:L,revalidate:y.headers.get("X-Remix-Revalidate")!==null,reloadDocument:y.headers.get("X-Remix-Reload-Document")!==null}}if(f.isRouteRequest)throw{type:m===io.error?io.error:io.data,response:y};let k,D=y.headers.get("Content-Type");return D&&/\bapplication\/json\b/.test(D)?k=await y.json():k=await y.text(),m===io.error?{type:m,error:new jk(I,y.statusText,k),headers:y.headers}:{type:io.data,data:k,statusCode:y.status,headers:y.headers}}if(m===io.error)return{type:m,error:y};if(sce(y)){var A,C;return{type:io.deferred,deferredData:y,statusCode:(A=y.init)==null?void 0:A.status,headers:((C=y.init)==null?void 0:C.headers)&&new Headers(y.init.headers)}}return{type:io.data,data:y}}function W1(n,e,a,o){let s=n.createURL(cq(e)).toString(),c={signal:a};if(o&&tu(o.formMethod)){let{formMethod:d,formEncType:f}=o;c.method=d.toUpperCase(),f==="application/json"?(c.headers=new Headers({"Content-Type":f}),c.body=JSON.stringify(o.json)):f==="text/plain"?c.body=o.text:f==="application/x-www-form-urlencoded"&&o.formData?c.body=vL(o.formData):c.body=o.formData}return new Request(s,c)}function vL(n){let e=new URLSearchParams;for(let[a,o]of n.entries())e.append(a,typeof o=="string"?o:o.name);return e}function RU(n){let e=new FormData;for(let[a,o]of n.entries())e.append(a,o);return e}function rce(n,e,a,o,s){let c={},d=null,f,m=!1,y={};return a.forEach((_,w)=>{let A=e[w].route.id;if(Ya(!P0(_),"Cannot handle redirect results in processLoaderData"),Wb(_)){let C=Ub(n,A),I=_.error;o&&(I=Object.values(o)[0],o=void 0),d=d||{},d[C.route.id]==null&&(d[C.route.id]=I),c[A]=void 0,m||(m=!0,f=iq(_.error)?_.error.status:500),_.headers&&(y[A]=_.headers)}else og(_)?(s.set(A,_.deferredData),c[A]=_.deferredData.data):c[A]=_.data,_.statusCode!=null&&_.statusCode!==200&&!m&&(f=_.statusCode),_.headers&&(y[A]=_.headers)}),o&&(d=o,c[Object.keys(o)[0]]=void 0),{loaderData:c,errors:d,statusCode:f||200,loaderHeaders:y}}function kU(n,e,a,o,s,c,d,f){let{loaderData:m,errors:y}=rce(e,a,o,s,f);for(let _=0;_<c.length;_++){let{key:w,match:A,controller:C}=c[_];Ya(d!==void 0&&d[_]!==void 0,"Did not find corresponding fetcher result");let I=d[_];if(!(C&&C.signal.aborted))if(Wb(I)){let k=Ub(n.matches,A==null?void 0:A.route.id);y&&y[k.route.id]||(y=Gr({},y,{[k.route.id]:I.error})),n.fetchers.delete(w)}else if(P0(I))Ya(!1,"Unhandled fetcher revalidation redirect");else if(og(I))Ya(!1,"Unhandled fetcher deferred data");else{let k=Bf(I.data);n.fetchers.set(w,k)}}return{loaderData:m,errors:y}}function DU(n,e,a,o){let s=Gr({},e);for(let c of a){let d=c.route.id;if(e.hasOwnProperty(d)?e[d]!==void 0&&(s[d]=e[d]):n[d]!==void 0&&c.route.loader&&(s[d]=n[d]),o&&o.hasOwnProperty(d))break}return s}function Ub(n,e){return(e?n.slice(0,n.findIndex(o=>o.route.id===e)+1):[...n]).reverse().find(o=>o.route.hasErrorBoundary===!0)||n[0]}function OU(n){let e=n.length===1?n[0]:n.find(a=>a.index||!a.path||a.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function mc(n,e){let{pathname:a,routeId:o,method:s,type:c}=e===void 0?{}:e,d="Unknown Server Error",f="Unknown @remix-run/router error";return n===400?(d="Bad Request",s&&a&&o?f="You made a "+s+' request to "'+a+'" but '+('did not provide a `loader` for route "'+o+'", ')+"so there is no way to handle the request.":c==="defer-action"?f="defer() is not supported in actions":c==="invalid-body"&&(f="Unable to encode submission body")):n===403?(d="Forbidden",f='Route "'+o+'" does not match URL "'+a+'"'):n===404?(d="Not Found",f='No route matches URL "'+a+'"'):n===405&&(d="Method Not Allowed",s&&a&&o?f="You made a "+s.toUpperCase()+' request to "'+a+'" but '+('did not provide an `action` for route "'+o+'", ')+"so there is no way to handle the request.":s&&(f='Invalid request method "'+s.toUpperCase()+'"')),new jk(n||500,d,new Error(f),!0)}function zU(n){for(let e=n.length-1;e>=0;e--){let a=n[e];if(P0(a))return{result:a,idx:e}}}function cq(n){let e=typeof n=="string"?Uh(n):n;return yw(Gr({},e,{hash:""}))}function oce(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function og(n){return n.type===io.deferred}function Wb(n){return n.type===io.error}function P0(n){return(n&&n.type)===io.redirect}function sce(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function lce(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function cce(n){return Yle.has(n.toLowerCase())}function tu(n){return Xle.has(n.toLowerCase())}async function FU(n,e,a,o,s,c){for(let d=0;d<a.length;d++){let f=a[d],m=e[d];if(!m)continue;let y=n.find(w=>w.route.id===m.route.id),_=y!=null&&!lq(y,m)&&(c&&c[m.route.id])!==void 0;if(og(f)&&(s||_)){let w=o[d];Ya(w,"Expected an AbortSignal for revalidating fetcher deferred result"),await uq(f,w,s).then(A=>{A&&(a[d]=A||a[d])})}}}async function uq(n,e,a){if(a===void 0&&(a=!1),!await n.deferredData.resolveData(e)){if(a)try{return{type:io.data,data:n.deferredData.unwrappedData}}catch(s){return{type:io.error,error:s}}return{type:io.data,data:n.deferredData.data}}}function $k(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function _L(n,e){let a=typeof e=="string"?Uh(e).search:e.search;if(n[n.length-1].route.index&&$k(a||""))return n[n.length-1];let o=Hk(n);return o[o.length-1]}function NU(n){let{formMethod:e,formAction:a,formEncType:o,text:s,formData:c,json:d}=n;if(!(!e||!a||!o)){if(s!=null)return{formMethod:e,formAction:a,formEncType:o,formData:void 0,json:void 0,text:s};if(c!=null)return{formMethod:e,formAction:a,formEncType:o,formData:c,json:void 0,text:void 0};if(d!==void 0)return{formMethod:e,formAction:a,formEncType:o,formData:void 0,json:d,text:void 0}}}function Y5(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function uce(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function V1(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function dce(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function Bf(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function hce(n,e){try{let a=n.sessionStorage.getItem(sq);if(a){let o=JSON.parse(a);for(let[s,c]of Object.entries(o||{}))c&&Array.isArray(c)&&e.set(s,new Set(c||[]))}}catch{}}function fce(n,e){if(e.size>0){let a={};for(let[o,s]of e)a[o]=[...s];try{n.sessionStorage.setItem(sq,JSON.stringify(a))}catch(o){Pg(!1,"Failed to save applied view transitions in sessionStorage ("+o+").")}}}/**
 * React Router v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function EE(){return EE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},EE.apply(this,arguments)}const SM=re.createContext(null),dq=re.createContext(null),AM=re.createContext(null),EM=re.createContext(null),Ug=re.createContext({outlet:null,matches:[],isDataRoute:!1}),hq=re.createContext(null);function MM(){return re.useContext(EM)!=null}function fq(){return MM()||Ya(!1),re.useContext(EM).location}function pq(n){re.useContext(AM).static||re.useLayoutEffect(n)}function qk(){let{isDataRoute:n}=re.useContext(Ug);return n?Mce():pce()}function pce(){MM()||Ya(!1);let n=re.useContext(SM),{basename:e,navigator:a}=re.useContext(AM),{matches:o}=re.useContext(Ug),{pathname:s}=fq(),c=JSON.stringify(Hk(o).map(m=>m.pathnameBase)),d=re.useRef(!1);return pq(()=>{d.current=!0}),re.useCallback(function(m,y){if(y===void 0&&(y={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let _=aq(m,JSON.parse(c),s,y.relative==="path");n==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:sp([e,_.pathname])),(y.replace?a.replace:a.push)(_,y.state,y)},[e,a,c,s,n])}function mce(){let{matches:n}=re.useContext(Ug),e=n[n.length-1];return e?e.params:{}}function gce(n,e,a){MM()||Ya(!1);let{navigator:o}=re.useContext(AM),{matches:s}=re.useContext(Ug),c=s[s.length-1],d=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=fq(),y;if(e){var _;let k=typeof e=="string"?Uh(e):e;f==="/"||(_=k.pathname)!=null&&_.startsWith(f)||Ya(!1),y=k}else y=m;let w=y.pathname||"/",A=f==="/"?w:w.slice(f.length)||"/",C=g0(n,{pathname:A}),I=xce(C&&C.map(k=>Object.assign({},k,{params:Object.assign({},d,k.params),pathname:sp([f,o.encodeLocation?o.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?f:sp([f,o.encodeLocation?o.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),s,a);return e&&I?re.createElement(EM.Provider,{value:{location:EE({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:ao.Pop}},I):I}function yce(){let n=Ece(),e=iq(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),a=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},c=null;return re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},e),a?re.createElement("pre",{style:s},a):null,c)}const vce=re.createElement(yce,null);class _ce extends re.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,a){return a.location!==e.location||a.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||a.error,location:a.location,revalidation:e.revalidation||a.revalidation}}componentDidCatch(e,a){console.error("React Router caught the following error during render",e,a)}render(){return this.state.error?re.createElement(Ug.Provider,{value:this.props.routeContext},re.createElement(hq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bce(n){let{routeContext:e,match:a,children:o}=n,s=re.useContext(SM);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),re.createElement(Ug.Provider,{value:e},o)}function xce(n,e,a){var o;if(e===void 0&&(e=[]),a===void 0&&(a=null),n==null){var s;if((s=a)!=null&&s.errors)n=a.matches;else return null}let c=n,d=(o=a)==null?void 0:o.errors;if(d!=null){let f=c.findIndex(m=>m.route.id&&(d==null?void 0:d[m.route.id]));f>=0||Ya(!1),c=c.slice(0,Math.min(c.length,f+1))}return c.reduceRight((f,m,y)=>{let _=m.route.id?d==null?void 0:d[m.route.id]:null,w=null;a&&(w=m.route.errorElement||vce);let A=e.concat(c.slice(0,y+1)),C=()=>{let I;return _?I=w:m.route.Component?I=re.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=f,re.createElement(bce,{match:m,routeContext:{outlet:f,matches:A,isDataRoute:a!=null},children:I})};return a&&(m.route.ErrorBoundary||m.route.errorElement||y===0)?re.createElement(_ce,{location:a.location,revalidation:a.revalidation,component:w,error:_,children:C(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):C()},null)}var mq=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(mq||{}),ME=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(ME||{});function wce(n){let e=re.useContext(SM);return e||Ya(!1),e}function Sce(n){let e=re.useContext(dq);return e||Ya(!1),e}function Ace(n){let e=re.useContext(Ug);return e||Ya(!1),e}function gq(n){let e=Ace(),a=e.matches[e.matches.length-1];return a.route.id||Ya(!1),a.route.id}function Ece(){var n;let e=re.useContext(hq),a=Sce(ME.UseRouteError),o=gq(ME.UseRouteError);return e||((n=a.errors)==null?void 0:n[o])}function Mce(){let{router:n}=wce(mq.UseNavigateStable),e=gq(ME.UseNavigateStable),a=re.useRef(!1);return pq(()=>{a.current=!0}),re.useCallback(function(s,c){c===void 0&&(c={}),a.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,EE({fromRouteId:e},c)))},[n,e])}function Tce(n){let{basename:e="/",children:a=null,location:o,navigationType:s=ao.Pop,navigator:c,static:d=!1}=n;MM()&&Ya(!1);let f=e.replace(/^\/*/,"/"),m=re.useMemo(()=>({basename:f,navigator:c,static:d}),[f,c,d]);typeof o=="string"&&(o=Uh(o));let{pathname:y="/",search:_="",hash:w="",state:A=null,key:C="default"}=o,I=re.useMemo(()=>{let k=vw(y,f);return k==null?null:{location:{pathname:k,search:_,hash:w,state:A,key:C},navigationType:s}},[f,y,_,w,A,C,s]);return I==null?null:re.createElement(AM.Provider,{value:m},re.createElement(EM.Provider,{children:a,value:I}))}new Promise(()=>{});function Cce(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:re.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:re.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function TE(){return TE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},TE.apply(this,arguments)}function Pce(n,e){return tce({basename:e==null?void 0:e.basename,future:TE({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:Sle({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||Ice(),routes:n,mapRouteProperties:Cce,window:e==null?void 0:e.window}).initialize()}function Ice(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=TE({},e,{errors:Lce(e.errors)})),e}function Lce(n){if(!n)return null;let e=Object.entries(n),a={};for(let[o,s]of e)if(s&&s.__type==="RouteErrorResponse")a[o]=new jk(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let c=window[s.__subType];if(typeof c=="function")try{let d=new c(s.message);d.stack="",a[o]=d}catch{}}if(a[o]==null){let c=new Error(s.message);c.stack="",a[o]=c}}else a[o]=s;return a}const Rce=re.createContext({isTransitioning:!1}),kce=re.createContext(new Map),Dce="startTransition",BU=eE[Dce],Oce="flushSync",UU=wle[Oce];function zce(n){BU?BU(n):n()}function G1(n){UU?UU(n):n()}class Fce{constructor(){this.status="pending",this.promise=new Promise((e,a)=>{this.resolve=o=>{this.status==="pending"&&(this.status="resolved",e(o))},this.reject=o=>{this.status==="pending"&&(this.status="rejected",a(o))}})}}function Nce(n){let{fallbackElement:e,router:a,future:o}=n,[s,c]=re.useState(a.state),[d,f]=re.useState(),[m,y]=re.useState({isTransitioning:!1}),[_,w]=re.useState(),[A,C]=re.useState(),[I,k]=re.useState(),D=re.useRef(new Map),{v7_startTransition:L}=o||{},O=re.useCallback(X=>{L?zce(X):X()},[L]),F=re.useCallback((X,ee)=>{let{deletedFetchers:V,unstable_flushSync:Q,unstable_viewTransitionOpts:me}=ee;V.forEach(be=>D.current.delete(be)),X.fetchers.forEach((be,fe)=>{be.data!==void 0&&D.current.set(fe,be.data)});let pe=a.window==null||typeof a.window.document.startViewTransition!="function";if(!me||pe){Q?G1(()=>c(X)):O(()=>c(X));return}if(Q){G1(()=>{A&&(_&&_.resolve(),A.skipTransition()),y({isTransitioning:!0,flushSync:!0,currentLocation:me.currentLocation,nextLocation:me.nextLocation})});let be=a.window.document.startViewTransition(()=>{G1(()=>c(X))});be.finished.finally(()=>{G1(()=>{w(void 0),C(void 0),f(void 0),y({isTransitioning:!1})})}),G1(()=>C(be));return}A?(_&&_.resolve(),A.skipTransition(),k({state:X,currentLocation:me.currentLocation,nextLocation:me.nextLocation})):(f(X),y({isTransitioning:!0,flushSync:!1,currentLocation:me.currentLocation,nextLocation:me.nextLocation}))},[a.window,A,_,D,O]);re.useLayoutEffect(()=>a.subscribe(F),[a,F]),re.useEffect(()=>{m.isTransitioning&&!m.flushSync&&w(new Fce)},[m]),re.useEffect(()=>{if(_&&d&&a.window){let X=d,ee=_.promise,V=a.window.document.startViewTransition(async()=>{O(()=>c(X)),await ee});V.finished.finally(()=>{w(void 0),C(void 0),f(void 0),y({isTransitioning:!1})}),C(V)}},[O,d,_,a.window]),re.useEffect(()=>{_&&d&&s.location.key===d.location.key&&_.resolve()},[_,A,s.location,d]),re.useEffect(()=>{!m.isTransitioning&&I&&(f(I.state),y({isTransitioning:!0,flushSync:!1,currentLocation:I.currentLocation,nextLocation:I.nextLocation}),k(void 0))},[m.isTransitioning,I]);let B=re.useMemo(()=>({createHref:a.createHref,encodeLocation:a.encodeLocation,go:X=>a.navigate(X),push:(X,ee,V)=>a.navigate(X,{state:ee,preventScrollReset:V==null?void 0:V.preventScrollReset}),replace:(X,ee,V)=>a.navigate(X,{replace:!0,state:ee,preventScrollReset:V==null?void 0:V.preventScrollReset})}),[a]),G=a.basename||"/",q=re.useMemo(()=>({router:a,navigator:B,static:!1,basename:G}),[a,B,G]);return re.createElement(re.Fragment,null,re.createElement(SM.Provider,{value:q},re.createElement(dq.Provider,{value:s},re.createElement(kce.Provider,{value:D.current},re.createElement(Rce.Provider,{value:m},re.createElement(Tce,{basename:G,location:s.location,navigationType:s.historyAction,navigator:B},s.initialized?re.createElement(Bce,{routes:a.routes,state:s}):e))))),null)}function Bce(n){let{routes:e,state:a}=n;return gce(e,void 0,a)}var WU;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(WU||(WU={}));var VU;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(VU||(VU={}));const Uce={black:"#000",white:"#fff"},Tx=Uce,Wce={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},xv=Wce,Vce={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},wv=Vce,Gce={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Sv=Gce,Hce={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Av=Hce,jce={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ev=jce,$ce={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},H1=$ce,qce={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Xce=qce;function rt(){return rt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},rt.apply(this,arguments)}function vh(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function yq(n){if(!vh(n))return n;const e={};return Object.keys(n).forEach(a=>{e[a]=yq(n[a])}),e}function _l(n,e,a={clone:!0}){const o=a.clone?rt({},n):n;return vh(n)&&vh(e)&&Object.keys(e).forEach(s=>{s!=="__proto__"&&(vh(e[s])&&s in n&&vh(n[s])?o[s]=_l(n[s],e[s],a):a.clone?o[s]=vh(e[s])?yq(e[s]):e[s]:o[s]=e[s])}),o}function mp(n){let e="https://mui.com/production-error/?code="+n;for(let a=1;a<arguments.length;a+=1)e+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+n+"; visit "+e+" for the full message."}var Ui={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xk=Symbol.for("react.element"),Zk=Symbol.for("react.portal"),TM=Symbol.for("react.fragment"),CM=Symbol.for("react.strict_mode"),PM=Symbol.for("react.profiler"),IM=Symbol.for("react.provider"),LM=Symbol.for("react.context"),Zce=Symbol.for("react.server_context"),RM=Symbol.for("react.forward_ref"),kM=Symbol.for("react.suspense"),DM=Symbol.for("react.suspense_list"),OM=Symbol.for("react.memo"),zM=Symbol.for("react.lazy"),Yce=Symbol.for("react.offscreen"),vq;vq=Symbol.for("react.module.reference");function Ec(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case Xk:switch(n=n.type,n){case TM:case PM:case CM:case kM:case DM:return n;default:switch(n=n&&n.$$typeof,n){case Zce:case LM:case RM:case zM:case OM:case IM:return n;default:return e}}case Zk:return e}}}Ui.ContextConsumer=LM;Ui.ContextProvider=IM;Ui.Element=Xk;Ui.ForwardRef=RM;Ui.Fragment=TM;Ui.Lazy=zM;Ui.Memo=OM;Ui.Portal=Zk;Ui.Profiler=PM;Ui.StrictMode=CM;Ui.Suspense=kM;Ui.SuspenseList=DM;Ui.isAsyncMode=function(){return!1};Ui.isConcurrentMode=function(){return!1};Ui.isContextConsumer=function(n){return Ec(n)===LM};Ui.isContextProvider=function(n){return Ec(n)===IM};Ui.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===Xk};Ui.isForwardRef=function(n){return Ec(n)===RM};Ui.isFragment=function(n){return Ec(n)===TM};Ui.isLazy=function(n){return Ec(n)===zM};Ui.isMemo=function(n){return Ec(n)===OM};Ui.isPortal=function(n){return Ec(n)===Zk};Ui.isProfiler=function(n){return Ec(n)===PM};Ui.isStrictMode=function(n){return Ec(n)===CM};Ui.isSuspense=function(n){return Ec(n)===kM};Ui.isSuspenseList=function(n){return Ec(n)===DM};Ui.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===TM||n===PM||n===CM||n===kM||n===DM||n===Yce||typeof n=="object"&&n!==null&&(n.$$typeof===zM||n.$$typeof===OM||n.$$typeof===IM||n.$$typeof===LM||n.$$typeof===RM||n.$$typeof===vq||n.getModuleId!==void 0)};Ui.typeOf=Ec;function Pa(n){if(typeof n!="string")throw new Error(mp(7));return n.charAt(0).toUpperCase()+n.slice(1)}function bL(...n){return n.reduce((e,a)=>a==null?e:function(...s){e.apply(this,s),a.apply(this,s)},()=>{})}function Yk(n,e=166){let a;function o(...s){const c=()=>{n.apply(this,s)};clearTimeout(a),a=setTimeout(c,e)}return o.clear=()=>{clearTimeout(a)},o}function Kce(n,e){return()=>null}function IA(n,e){var a,o;return re.isValidElement(n)&&e.indexOf((a=n.type.muiName)!=null?a:(o=n.type)==null||(o=o._payload)==null||(o=o.value)==null?void 0:o.muiName)!==-1}function bl(n){return n&&n.ownerDocument||document}function gp(n){return bl(n).defaultView||window}function Jce(n,e){return()=>null}function CE(n,e){typeof n=="function"?n(e):n&&(n.current=e)}const Qce=typeof window<"u"?re.useLayoutEffect:re.useEffect,Oh=Qce;let GU=0;function eue(n){const[e,a]=re.useState(n),o=n||e;return re.useEffect(()=>{e==null&&(GU+=1,a(`mui-${GU}`))},[e]),o}const HU=eE["useId".toString()];function _q(n){if(HU!==void 0){const e=HU();return n??e}return eue(n)}function tue(n,e,a,o,s){return null}function PE({controlled:n,default:e,name:a,state:o="value"}){const{current:s}=re.useRef(n!==void 0),[c,d]=re.useState(e),f=s?n:c,m=re.useCallback(y=>{s||d(y)},[]);return[f,m]}function sg(n){const e=re.useRef(n);return Oh(()=>{e.current=n}),re.useRef((...a)=>(0,e.current)(...a)).current}function xs(...n){return re.useMemo(()=>n.every(e=>e==null)?null:e=>{n.forEach(a=>{CE(a,e)})},n)}let FM=!0,xL=!1,jU;const nue={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function aue(n){const{type:e,tagName:a}=n;return!!(a==="INPUT"&&nue[e]&&!n.readOnly||a==="TEXTAREA"&&!n.readOnly||n.isContentEditable)}function iue(n){n.metaKey||n.altKey||n.ctrlKey||(FM=!0)}function K5(){FM=!1}function rue(){this.visibilityState==="hidden"&&xL&&(FM=!0)}function oue(n){n.addEventListener("keydown",iue,!0),n.addEventListener("mousedown",K5,!0),n.addEventListener("pointerdown",K5,!0),n.addEventListener("touchstart",K5,!0),n.addEventListener("visibilitychange",rue,!0)}function sue(n){const{target:e}=n;try{return e.matches(":focus-visible")}catch{}return FM||aue(e)}function bq(){const n=re.useCallback(s=>{s!=null&&oue(s.ownerDocument)},[]),e=re.useRef(!1);function a(){return e.current?(xL=!0,window.clearTimeout(jU),jU=window.setTimeout(()=>{xL=!1},100),e.current=!1,!0):!1}function o(s){return sue(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:o,onBlur:a,ref:n}}function xq(n){const e=n.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function Kk(n,e){const a=rt({},e);return Object.keys(n).forEach(o=>{if(o.toString().match(/^(components|slots)$/))a[o]=rt({},n[o],a[o]);else if(o.toString().match(/^(componentsProps|slotProps)$/)){const s=n[o]||{},c=e[o];a[o]={},!c||!Object.keys(c)?a[o]=s:!s||!Object.keys(s)?a[o]=c:(a[o]=rt({},c),Object.keys(s).forEach(d=>{a[o][d]=Kk(s[d],c[d])}))}else a[o]===void 0&&(a[o]=n[o])}),a}function vr(n,e,a=void 0){const o={};return Object.keys(n).forEach(s=>{o[s]=n[s].reduce((c,d)=>{if(d){const f=e(d);f!==""&&c.push(f),a&&a[d]&&c.push(a[d])}return c},[]).join(" ")}),o}const $U=n=>n,lue=()=>{let n=$U;return{configure(e){n=e},generate(e){return n(e)},reset(){n=$U}}},cue=lue(),wq=cue,uue={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function ur(n,e,a="Mui"){const o=uue[e];return o?`${a}-${o}`:`${wq.generate(n)}-${e}`}function Wi(n,e,a="Mui"){const o={};return e.forEach(s=>{o[s]=ur(n,s,a)}),o}const G0="$$material";function ba(n,e){if(n==null)return{};var a={},o=Object.keys(n),s,c;for(c=0;c<o.length;c++)s=o[c],!(e.indexOf(s)>=0)&&(a[s]=n[s]);return a}function Sq(n){var e=Object.create(null);return function(a){return e[a]===void 0&&(e[a]=n(a)),e[a]}}var due=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,hue=Sq(function(n){return due.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91});function fue(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function pue(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var mue=function(){function n(a){var o=this;this._insertTag=function(s){var c;o.tags.length===0?o.insertionPoint?c=o.insertionPoint.nextSibling:o.prepend?c=o.container.firstChild:c=o.before:c=o.tags[o.tags.length-1].nextSibling,o.container.insertBefore(s,c),o.tags.push(s)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(o){o.forEach(this._insertTag)},e.insert=function(o){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(pue(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var c=fue(s);try{c.insertRule(o,c.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(o));this.ctr++},e.flush=function(){this.tags.forEach(function(o){return o.parentNode&&o.parentNode.removeChild(o)}),this.tags=[],this.ctr=0},n}(),hs="-ms-",IE="-moz-",wi="-webkit-",Aq="comm",Jk="rule",Qk="decl",gue="@import",Eq="@keyframes",yue="@layer",vue=Math.abs,NM=String.fromCharCode,_ue=Object.assign;function bue(n,e){return Xo(n,0)^45?(((e<<2^Xo(n,0))<<2^Xo(n,1))<<2^Xo(n,2))<<2^Xo(n,3):0}function Mq(n){return n.trim()}function xue(n,e){return(n=e.exec(n))?n[0]:n}function Si(n,e,a){return n.replace(e,a)}function wL(n,e){return n.indexOf(e)}function Xo(n,e){return n.charCodeAt(e)|0}function Cx(n,e,a){return n.slice(e,a)}function td(n){return n.length}function eD(n){return n.length}function eS(n,e){return e.push(n),n}function wue(n,e){return n.map(e).join("")}var BM=1,H0=1,Tq=0,xl=0,vo=0,l_="";function UM(n,e,a,o,s,c,d){return{value:n,root:e,parent:a,type:o,props:s,children:c,line:BM,column:H0,length:d,return:""}}function j1(n,e){return _ue(UM("",null,null,"",null,null,0),n,{length:-n.length},e)}function Sue(){return vo}function Aue(){return vo=xl>0?Xo(l_,--xl):0,H0--,vo===10&&(H0=1,BM--),vo}function jl(){return vo=xl<Tq?Xo(l_,xl++):0,H0++,vo===10&&(H0=1,BM++),vo}function ud(){return Xo(l_,xl)}function LA(){return xl}function _w(n,e){return Cx(l_,n,e)}function Px(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Cq(n){return BM=H0=1,Tq=td(l_=n),xl=0,[]}function Pq(n){return l_="",n}function RA(n){return Mq(_w(xl-1,SL(n===91?n+2:n===40?n+1:n)))}function Eue(n){for(;(vo=ud())&&vo<33;)jl();return Px(n)>2||Px(vo)>3?"":" "}function Mue(n,e){for(;--e&&jl()&&!(vo<48||vo>102||vo>57&&vo<65||vo>70&&vo<97););return _w(n,LA()+(e<6&&ud()==32&&jl()==32))}function SL(n){for(;jl();)switch(vo){case n:return xl;case 34:case 39:n!==34&&n!==39&&SL(vo);break;case 40:n===41&&SL(n);break;case 92:jl();break}return xl}function Tue(n,e){for(;jl()&&n+vo!==47+10;)if(n+vo===42+42&&ud()===47)break;return"/*"+_w(e,xl-1)+"*"+NM(n===47?n:jl())}function Cue(n){for(;!Px(ud());)jl();return _w(n,xl)}function Pue(n){return Pq(kA("",null,null,null,[""],n=Cq(n),0,[0],n))}function kA(n,e,a,o,s,c,d,f,m){for(var y=0,_=0,w=d,A=0,C=0,I=0,k=1,D=1,L=1,O=0,F="",B=s,G=c,q=o,X=F;D;)switch(I=O,O=jl()){case 40:if(I!=108&&Xo(X,w-1)==58){wL(X+=Si(RA(O),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:X+=RA(O);break;case 9:case 10:case 13:case 32:X+=Eue(I);break;case 92:X+=Mue(LA()-1,7);continue;case 47:switch(ud()){case 42:case 47:eS(Iue(Tue(jl(),LA()),e,a),m);break;default:X+="/"}break;case 123*k:f[y++]=td(X)*L;case 125*k:case 59:case 0:switch(O){case 0:case 125:D=0;case 59+_:L==-1&&(X=Si(X,/\f/g,"")),C>0&&td(X)-w&&eS(C>32?XU(X+";",o,a,w-1):XU(Si(X," ","")+";",o,a,w-2),m);break;case 59:X+=";";default:if(eS(q=qU(X,e,a,y,_,s,f,F,B=[],G=[],w),c),O===123)if(_===0)kA(X,e,q,q,B,c,w,f,G);else switch(A===99&&Xo(X,3)===110?100:A){case 100:case 108:case 109:case 115:kA(n,q,q,o&&eS(qU(n,q,q,0,0,s,f,F,s,B=[],w),G),s,G,w,f,o?B:G);break;default:kA(X,q,q,q,[""],G,0,f,G)}}y=_=C=0,k=L=1,F=X="",w=d;break;case 58:w=1+td(X),C=I;default:if(k<1){if(O==123)--k;else if(O==125&&k++==0&&Aue()==125)continue}switch(X+=NM(O),O*k){case 38:L=_>0?1:(X+="\f",-1);break;case 44:f[y++]=(td(X)-1)*L,L=1;break;case 64:ud()===45&&(X+=RA(jl())),A=ud(),_=w=td(F=X+=Cue(LA())),O++;break;case 45:I===45&&td(X)==2&&(k=0)}}return c}function qU(n,e,a,o,s,c,d,f,m,y,_){for(var w=s-1,A=s===0?c:[""],C=eD(A),I=0,k=0,D=0;I<o;++I)for(var L=0,O=Cx(n,w+1,w=vue(k=d[I])),F=n;L<C;++L)(F=Mq(k>0?A[L]+" "+O:Si(O,/&\f/g,A[L])))&&(m[D++]=F);return UM(n,e,a,s===0?Jk:f,m,y,_)}function Iue(n,e,a){return UM(n,e,a,Aq,NM(Sue()),Cx(n,2,-2),0)}function XU(n,e,a,o){return UM(n,e,a,Qk,Cx(n,0,o),Cx(n,o+1,-1),o)}function I0(n,e){for(var a="",o=eD(n),s=0;s<o;s++)a+=e(n[s],s,n,e)||"";return a}function Lue(n,e,a,o){switch(n.type){case yue:if(n.children.length)break;case gue:case Qk:return n.return=n.return||n.value;case Aq:return"";case Eq:return n.return=n.value+"{"+I0(n.children,o)+"}";case Jk:n.value=n.props.join(",")}return td(a=I0(n.children,o))?n.return=n.value+"{"+a+"}":""}function Rue(n){var e=eD(n);return function(a,o,s,c){for(var d="",f=0;f<e;f++)d+=n[f](a,o,s,c)||"";return d}}function kue(n){return function(e){e.root||(e=e.return)&&n(e)}}var Due=function(e,a,o){for(var s=0,c=0;s=c,c=ud(),s===38&&c===12&&(a[o]=1),!Px(c);)jl();return _w(e,xl)},Oue=function(e,a){var o=-1,s=44;do switch(Px(s)){case 0:s===38&&ud()===12&&(a[o]=1),e[o]+=Due(xl-1,a,o);break;case 2:e[o]+=RA(s);break;case 4:if(s===44){e[++o]=ud()===58?"&\f":"",a[o]=e[o].length;break}default:e[o]+=NM(s)}while(s=jl());return e},zue=function(e,a){return Pq(Oue(Cq(e),a))},ZU=new WeakMap,Fue=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var a=e.value,o=e.parent,s=e.column===o.column&&e.line===o.line;o.type!=="rule";)if(o=o.parent,!o)return;if(!(e.props.length===1&&a.charCodeAt(0)!==58&&!ZU.get(o))&&!s){ZU.set(e,!0);for(var c=[],d=zue(a,c),f=o.props,m=0,y=0;m<d.length;m++)for(var _=0;_<f.length;_++,y++)e.props[y]=c[m]?d[m].replace(/&\f/g,f[_]):f[_]+" "+d[m]}}},Nue=function(e){if(e.type==="decl"){var a=e.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(e.return="",e.value="")}};function Iq(n,e){switch(bue(n,e)){case 5103:return wi+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return wi+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return wi+n+IE+n+hs+n+n;case 6828:case 4268:return wi+n+hs+n+n;case 6165:return wi+n+hs+"flex-"+n+n;case 5187:return wi+n+Si(n,/(\w+).+(:[^]+)/,wi+"box-$1$2"+hs+"flex-$1$2")+n;case 5443:return wi+n+hs+"flex-item-"+Si(n,/flex-|-self/,"")+n;case 4675:return wi+n+hs+"flex-line-pack"+Si(n,/align-content|flex-|-self/,"")+n;case 5548:return wi+n+hs+Si(n,"shrink","negative")+n;case 5292:return wi+n+hs+Si(n,"basis","preferred-size")+n;case 6060:return wi+"box-"+Si(n,"-grow","")+wi+n+hs+Si(n,"grow","positive")+n;case 4554:return wi+Si(n,/([^-])(transform)/g,"$1"+wi+"$2")+n;case 6187:return Si(Si(Si(n,/(zoom-|grab)/,wi+"$1"),/(image-set)/,wi+"$1"),n,"")+n;case 5495:case 3959:return Si(n,/(image-set\([^]*)/,wi+"$1$`$1");case 4968:return Si(Si(n,/(.+:)(flex-)?(.*)/,wi+"box-pack:$3"+hs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+wi+n+n;case 4095:case 3583:case 4068:case 2532:return Si(n,/(.+)-inline(.+)/,wi+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(td(n)-1-e>6)switch(Xo(n,e+1)){case 109:if(Xo(n,e+4)!==45)break;case 102:return Si(n,/(.+:)(.+)-([^]+)/,"$1"+wi+"$2-$3$1"+IE+(Xo(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~wL(n,"stretch")?Iq(Si(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(Xo(n,e+1)!==115)break;case 6444:switch(Xo(n,td(n)-3-(~wL(n,"!important")&&10))){case 107:return Si(n,":",":"+wi)+n;case 101:return Si(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+wi+(Xo(n,14)===45?"inline-":"")+"box$3$1"+wi+"$2$3$1"+hs+"$2box$3")+n}break;case 5936:switch(Xo(n,e+11)){case 114:return wi+n+hs+Si(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return wi+n+hs+Si(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return wi+n+hs+Si(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return wi+n+hs+n+n}return n}var Bue=function(e,a,o,s){if(e.length>-1&&!e.return)switch(e.type){case Qk:e.return=Iq(e.value,e.length);break;case Eq:return I0([j1(e,{value:Si(e.value,"@","@"+wi)})],s);case Jk:if(e.length)return wue(e.props,function(c){switch(xue(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return I0([j1(e,{props:[Si(c,/:(read-\w+)/,":"+IE+"$1")]})],s);case"::placeholder":return I0([j1(e,{props:[Si(c,/:(plac\w+)/,":"+wi+"input-$1")]}),j1(e,{props:[Si(c,/:(plac\w+)/,":"+IE+"$1")]}),j1(e,{props:[Si(c,/:(plac\w+)/,hs+"input-$1")]})],s)}return""})}},Uue=[Bue],Wue=function(e){var a=e.key;if(a==="css"){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,function(k){var D=k.getAttribute("data-emotion");D.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var s=e.stylisPlugins||Uue,c={},d,f=[];d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(k){for(var D=k.getAttribute("data-emotion").split(" "),L=1;L<D.length;L++)c[D[L]]=!0;f.push(k)});var m,y=[Fue,Nue];{var _,w=[Lue,kue(function(k){_.insert(k)})],A=Rue(y.concat(s,w)),C=function(D){return I0(Pue(D),A)};m=function(D,L,O,F){_=O,C(D?D+"{"+L.styles+"}":L.styles),F&&(I.inserted[L.name]=!0)}}var I={key:a,sheet:new mue({key:a,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:c,registered:{},insert:m};return I.sheet.hydrate(f),I},Lq={exports:{}},Ni={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bo=typeof Symbol=="function"&&Symbol.for,tD=Bo?Symbol.for("react.element"):60103,nD=Bo?Symbol.for("react.portal"):60106,WM=Bo?Symbol.for("react.fragment"):60107,VM=Bo?Symbol.for("react.strict_mode"):60108,GM=Bo?Symbol.for("react.profiler"):60114,HM=Bo?Symbol.for("react.provider"):60109,jM=Bo?Symbol.for("react.context"):60110,aD=Bo?Symbol.for("react.async_mode"):60111,$M=Bo?Symbol.for("react.concurrent_mode"):60111,qM=Bo?Symbol.for("react.forward_ref"):60112,XM=Bo?Symbol.for("react.suspense"):60113,Vue=Bo?Symbol.for("react.suspense_list"):60120,ZM=Bo?Symbol.for("react.memo"):60115,YM=Bo?Symbol.for("react.lazy"):60116,Gue=Bo?Symbol.for("react.block"):60121,Hue=Bo?Symbol.for("react.fundamental"):60117,jue=Bo?Symbol.for("react.responder"):60118,$ue=Bo?Symbol.for("react.scope"):60119;function Yl(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case tD:switch(n=n.type,n){case aD:case $M:case WM:case GM:case VM:case XM:return n;default:switch(n=n&&n.$$typeof,n){case jM:case qM:case YM:case ZM:case HM:return n;default:return e}}case nD:return e}}}function Rq(n){return Yl(n)===$M}Ni.AsyncMode=aD;Ni.ConcurrentMode=$M;Ni.ContextConsumer=jM;Ni.ContextProvider=HM;Ni.Element=tD;Ni.ForwardRef=qM;Ni.Fragment=WM;Ni.Lazy=YM;Ni.Memo=ZM;Ni.Portal=nD;Ni.Profiler=GM;Ni.StrictMode=VM;Ni.Suspense=XM;Ni.isAsyncMode=function(n){return Rq(n)||Yl(n)===aD};Ni.isConcurrentMode=Rq;Ni.isContextConsumer=function(n){return Yl(n)===jM};Ni.isContextProvider=function(n){return Yl(n)===HM};Ni.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===tD};Ni.isForwardRef=function(n){return Yl(n)===qM};Ni.isFragment=function(n){return Yl(n)===WM};Ni.isLazy=function(n){return Yl(n)===YM};Ni.isMemo=function(n){return Yl(n)===ZM};Ni.isPortal=function(n){return Yl(n)===nD};Ni.isProfiler=function(n){return Yl(n)===GM};Ni.isStrictMode=function(n){return Yl(n)===VM};Ni.isSuspense=function(n){return Yl(n)===XM};Ni.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===WM||n===$M||n===GM||n===VM||n===XM||n===Vue||typeof n=="object"&&n!==null&&(n.$$typeof===YM||n.$$typeof===ZM||n.$$typeof===HM||n.$$typeof===jM||n.$$typeof===qM||n.$$typeof===Hue||n.$$typeof===jue||n.$$typeof===$ue||n.$$typeof===Gue)};Ni.typeOf=Yl;Lq.exports=Ni;var que=Lq.exports,kq=que,Xue={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Zue={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Dq={};Dq[kq.ForwardRef]=Xue;Dq[kq.Memo]=Zue;var Yue=!0;function Oq(n,e,a){var o="";return a.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):o+=s+" "}),o}var zq=function(e,a,o){var s=e.key+"-"+a.name;(o===!1||Yue===!1)&&e.registered[s]===void 0&&(e.registered[s]=a.styles)},iD=function(e,a,o){zq(e,a,o);var s=e.key+"-"+a.name;if(e.inserted[a.name]===void 0){var c=a;do e.insert(a===c?"."+s:"",c,e.sheet,!0),c=c.next;while(c!==void 0)}};function Kue(n){for(var e=0,a,o=0,s=n.length;s>=4;++o,s-=4)a=n.charCodeAt(o)&255|(n.charCodeAt(++o)&255)<<8|(n.charCodeAt(++o)&255)<<16|(n.charCodeAt(++o)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,e=(a&65535)*1540483477+((a>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(o+2)&255)<<16;case 2:e^=(n.charCodeAt(o+1)&255)<<8;case 1:e^=n.charCodeAt(o)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Jue={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Que=/[A-Z]|^ms/g,ede=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Fq=function(e){return e.charCodeAt(1)===45},YU=function(e){return e!=null&&typeof e!="boolean"},J5=Sq(function(n){return Fq(n)?n:n.replace(Que,"-$&").toLowerCase()}),KU=function(e,a){switch(e){case"animation":case"animationName":if(typeof a=="string")return a.replace(ede,function(o,s,c){return nd={name:s,styles:c,next:nd},s})}return Jue[e]!==1&&!Fq(e)&&typeof a=="number"&&a!==0?a+"px":a};function Ix(n,e,a){if(a==null)return"";if(a.__emotion_styles!==void 0)return a;switch(typeof a){case"boolean":return"";case"object":{if(a.anim===1)return nd={name:a.name,styles:a.styles,next:nd},a.name;if(a.styles!==void 0){var o=a.next;if(o!==void 0)for(;o!==void 0;)nd={name:o.name,styles:o.styles,next:nd},o=o.next;var s=a.styles+";";return s}return tde(n,e,a)}case"function":{if(n!==void 0){var c=nd,d=a(n);return nd=c,Ix(n,e,d)}break}}if(e==null)return a;var f=e[a];return f!==void 0?f:a}function tde(n,e,a){var o="";if(Array.isArray(a))for(var s=0;s<a.length;s++)o+=Ix(n,e,a[s])+";";else for(var c in a){var d=a[c];if(typeof d!="object")e!=null&&e[d]!==void 0?o+=c+"{"+e[d]+"}":YU(d)&&(o+=J5(c)+":"+KU(c,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var f=0;f<d.length;f++)YU(d[f])&&(o+=J5(c)+":"+KU(c,d[f])+";");else{var m=Ix(n,e,d);switch(c){case"animation":case"animationName":{o+=J5(c)+":"+m+";";break}default:o+=c+"{"+m+"}"}}}return o}var JU=/label:\s*([^\s;\n{]+)\s*(;|$)/g,nd,KM=function(e,a,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,c="";nd=void 0;var d=e[0];d==null||d.raw===void 0?(s=!1,c+=Ix(o,a,d)):c+=d[0];for(var f=1;f<e.length;f++)c+=Ix(o,a,e[f]),s&&(c+=d[f]);JU.lastIndex=0;for(var m="",y;(y=JU.exec(c))!==null;)m+="-"+y[1];var _=Kue(c)+m;return{name:_,styles:c,next:nd}},nde=function(e){return e()},Nq=eE["useInsertionEffect"]?eE["useInsertionEffect"]:!1,ade=Nq||nde,QU=Nq||re.useLayoutEffect,rD=re.createContext(typeof HTMLElement<"u"?Wue({key:"css"}):null);rD.Provider;var ide=function(){return re.useContext(rD)},Bq=function(e){return re.forwardRef(function(a,o){var s=re.useContext(rD);return e(a,s,o)})},JM=re.createContext({}),rde=Bq(function(n,e){var a=n.styles,o=KM([a],void 0,re.useContext(JM)),s=re.useRef();return QU(function(){var c=e.key+"-global",d=new e.sheet.constructor({key:c,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),f=!1,m=document.querySelector('style[data-emotion="'+c+" "+o.name+'"]');return e.sheet.tags.length&&(d.before=e.sheet.tags[0]),m!==null&&(f=!0,m.setAttribute("data-emotion",c),d.hydrate([m])),s.current=[d,f],function(){d.flush()}},[e]),QU(function(){var c=s.current,d=c[0],f=c[1];if(f){c[1]=!1;return}if(o.next!==void 0&&iD(e,o.next,!0),d.tags.length){var m=d.tags[d.tags.length-1].nextElementSibling;d.before=m,d.flush()}e.insert("",o,d,!1)},[e,o.name]),null});function ode(){for(var n=arguments.length,e=new Array(n),a=0;a<n;a++)e[a]=arguments[a];return KM(e)}var oD=function(){var e=ode.apply(void 0,arguments),a="animation-"+e.name;return{name:a,styles:"@keyframes "+a+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},sde=hue,lde=function(e){return e!=="theme"},e7=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?sde:lde},t7=function(e,a,o){var s;if(a){var c=a.shouldForwardProp;s=e.__emotion_forwardProp&&c?function(d){return e.__emotion_forwardProp(d)&&c(d)}:c}return typeof s!="function"&&o&&(s=e.__emotion_forwardProp),s},cde=function(e){var a=e.cache,o=e.serialized,s=e.isStringTag;return zq(a,o,s),ade(function(){return iD(a,o,s)}),null},ude=function n(e,a){var o=e.__emotion_real===e,s=o&&e.__emotion_base||e,c,d;a!==void 0&&(c=a.label,d=a.target);var f=t7(e,a,o),m=f||e7(s),y=!m("as");return function(){var _=arguments,w=o&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(c!==void 0&&w.push("label:"+c+";"),_[0]==null||_[0].raw===void 0)w.push.apply(w,_);else{w.push(_[0][0]);for(var A=_.length,C=1;C<A;C++)w.push(_[C],_[0][C])}var I=Bq(function(k,D,L){var O=y&&k.as||s,F="",B=[],G=k;if(k.theme==null){G={};for(var q in k)G[q]=k[q];G.theme=re.useContext(JM)}typeof k.className=="string"?F=Oq(D.registered,B,k.className):k.className!=null&&(F=k.className+" ");var X=KM(w.concat(B),D.registered,G);F+=D.key+"-"+X.name,d!==void 0&&(F+=" "+d);var ee=y&&f===void 0?e7(O):m,V={};for(var Q in k)y&&Q==="as"||ee(Q)&&(V[Q]=k[Q]);return V.className=F,V.ref=L,re.createElement(re.Fragment,null,re.createElement(cde,{cache:D,serialized:X,isStringTag:typeof O=="string"}),re.createElement(O,V))});return I.displayName=c!==void 0?c:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",I.defaultProps=e.defaultProps,I.__emotion_real=I,I.__emotion_base=s,I.__emotion_styles=w,I.__emotion_forwardProp=f,Object.defineProperty(I,"toString",{value:function(){return"."+d}}),I.withComponent=function(k,D){return n(k,rt({},a,D,{shouldForwardProp:t7(I,D,!0)})).apply(void 0,w)},I}},dde=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],AL=ude.bind();dde.forEach(function(n){AL[n]=AL(n)});var Uq={exports:{}},QM={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hde=re,fde=Symbol.for("react.element"),pde=Symbol.for("react.fragment"),mde=Object.prototype.hasOwnProperty,gde=hde.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yde={key:!0,ref:!0,__self:!0,__source:!0};function Wq(n,e,a){var o,s={},c=null,d=null;a!==void 0&&(c=""+a),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)mde.call(e,o)&&!yde.hasOwnProperty(o)&&(s[o]=e[o]);if(n&&n.defaultProps)for(o in e=n.defaultProps,e)s[o]===void 0&&(s[o]=e[o]);return{$$typeof:fde,type:n,key:c,ref:d,props:s,_owner:gde.current}}QM.Fragment=pde;QM.jsx=Wq;QM.jsxs=Wq;Uq.exports=QM;var sD=Uq.exports;const he=sD.jsx,Bt=sD.jsxs,rd=sD.Fragment,vde=Object.freeze(Object.defineProperty({__proto__:null,Fragment:rd,jsx:he,jsxs:Bt},Symbol.toStringTag,{value:"Module"}));function _de(n){return n==null||Object.keys(n).length===0}function bde(n){const{styles:e,defaultTheme:a={}}=n;return he(rde,{styles:typeof e=="function"?s=>e(_de(s)?a:s):e})}/**
 * @mui/styled-engine v5.14.17
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function xde(n,e){return AL(n,e)}const wde=(n,e)=>{Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=e(n.__emotion_styles))},Sde=["values","unit","step"],Ade=n=>{const e=Object.keys(n).map(a=>({key:a,val:n[a]}))||[];return e.sort((a,o)=>a.val-o.val),e.reduce((a,o)=>rt({},a,{[o.key]:o.val}),{})};function Ede(n){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:o=5}=n,s=ba(n,Sde),c=Ade(e),d=Object.keys(c);function f(A){return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${a})`}function m(A){return`@media (max-width:${(typeof e[A]=="number"?e[A]:A)-o/100}${a})`}function y(A,C){const I=d.indexOf(C);return`@media (min-width:${typeof e[A]=="number"?e[A]:A}${a}) and (max-width:${(I!==-1&&typeof e[d[I]]=="number"?e[d[I]]:C)-o/100}${a})`}function _(A){return d.indexOf(A)+1<d.length?y(A,d[d.indexOf(A)+1]):f(A)}function w(A){const C=d.indexOf(A);return C===0?f(d[1]):C===d.length-1?m(d[C]):y(A,d[d.indexOf(A)+1]).replace("@media","@media not all and")}return rt({keys:d,values:c,up:f,down:m,between:y,only:_,not:w,unit:a},s)}const Mde={borderRadius:4},Tde=Mde;function Vb(n,e){return e?_l(n,e,{clone:!1}):n}const lD={xs:0,sm:600,md:900,lg:1200,xl:1536},n7={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${lD[n]}px)`};function zh(n,e,a){const o=n.theme||{};if(Array.isArray(e)){const c=o.breakpoints||n7;return e.reduce((d,f,m)=>(d[c.up(c.keys[m])]=a(e[m]),d),{})}if(typeof e=="object"){const c=o.breakpoints||n7;return Object.keys(e).reduce((d,f)=>{if(Object.keys(c.values||lD).indexOf(f)!==-1){const m=c.up(f);d[m]=a(e[f],f)}else{const m=f;d[m]=e[m]}return d},{})}return a(e)}function Cde(n={}){var e;return((e=n.keys)==null?void 0:e.reduce((o,s)=>{const c=n.up(s);return o[c]={},o},{}))||{}}function Pde(n,e){return n.reduce((a,o)=>{const s=a[o];return(!s||Object.keys(s).length===0)&&delete a[o],a},e)}function eT(n,e,a=!0){if(!e||typeof e!="string")return null;if(n&&n.vars&&a){const o=`vars.${e}`.split(".").reduce((s,c)=>s&&s[c]?s[c]:null,n);if(o!=null)return o}return e.split(".").reduce((o,s)=>o&&o[s]!=null?o[s]:null,n)}function LE(n,e,a,o=a){let s;return typeof n=="function"?s=n(a):Array.isArray(n)?s=n[a]||o:s=eT(n,a)||o,e&&(s=e(s,o,n)),s}function Pi(n){const{prop:e,cssProperty:a=n.prop,themeKey:o,transform:s}=n,c=d=>{if(d[e]==null)return null;const f=d[e],m=d.theme,y=eT(m,o)||{};return zh(d,f,w=>{let A=LE(y,s,w);return w===A&&typeof w=="string"&&(A=LE(y,s,`${e}${w==="default"?"":Pa(w)}`,w)),a===!1?A:{[a]:A}})};return c.propTypes={},c.filterProps=[e],c}function Ide(n){const e={};return a=>(e[a]===void 0&&(e[a]=n(a)),e[a])}const Lde={m:"margin",p:"padding"},Rde={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},a7={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},kde=Ide(n=>{if(n.length>2)if(a7[n])n=a7[n];else return[n];const[e,a]=n.split(""),o=Lde[e],s=Rde[a]||"";return Array.isArray(s)?s.map(c=>o+c):[o+s]}),cD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],uD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...cD,...uD];function bw(n,e,a,o){var s;const c=(s=eT(n,e,!1))!=null?s:a;return typeof c=="number"?d=>typeof d=="string"?d:c*d:Array.isArray(c)?d=>typeof d=="string"?d:c[d]:typeof c=="function"?c:()=>{}}function Vq(n){return bw(n,"spacing",8)}function xw(n,e){if(typeof e=="string"||e==null)return e;const a=Math.abs(e),o=n(a);return e>=0?o:typeof o=="number"?-o:`-${o}`}function Dde(n,e){return a=>n.reduce((o,s)=>(o[s]=xw(e,a),o),{})}function Ode(n,e,a,o){if(e.indexOf(a)===-1)return null;const s=kde(a),c=Dde(s,o),d=n[a];return zh(n,d,c)}function Gq(n,e){const a=Vq(n.theme);return Object.keys(n).map(o=>Ode(n,e,o,a)).reduce(Vb,{})}function Ur(n){return Gq(n,cD)}Ur.propTypes={};Ur.filterProps=cD;function Wr(n){return Gq(n,uD)}Wr.propTypes={};Wr.filterProps=uD;function zde(n=8){if(n.mui)return n;const e=Vq({spacing:n}),a=(...o)=>(o.length===0?[1]:o).map(c=>{const d=e(c);return typeof d=="number"?`${d}px`:d}).join(" ");return a.mui=!0,a}function tT(...n){const e=n.reduce((o,s)=>(s.filterProps.forEach(c=>{o[c]=s}),o),{}),a=o=>Object.keys(o).reduce((s,c)=>e[c]?Vb(s,e[c](o)):s,{});return a.propTypes={},a.filterProps=n.reduce((o,s)=>o.concat(s.filterProps),[]),a}function id(n){return typeof n!="number"?n:`${n}px solid`}const Fde=Pi({prop:"border",themeKey:"borders",transform:id}),Nde=Pi({prop:"borderTop",themeKey:"borders",transform:id}),Bde=Pi({prop:"borderRight",themeKey:"borders",transform:id}),Ude=Pi({prop:"borderBottom",themeKey:"borders",transform:id}),Wde=Pi({prop:"borderLeft",themeKey:"borders",transform:id}),Vde=Pi({prop:"borderColor",themeKey:"palette"}),Gde=Pi({prop:"borderTopColor",themeKey:"palette"}),Hde=Pi({prop:"borderRightColor",themeKey:"palette"}),jde=Pi({prop:"borderBottomColor",themeKey:"palette"}),$de=Pi({prop:"borderLeftColor",themeKey:"palette"}),nT=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const e=bw(n.theme,"shape.borderRadius",4),a=o=>({borderRadius:xw(e,o)});return zh(n,n.borderRadius,a)}return null};nT.propTypes={};nT.filterProps=["borderRadius"];tT(Fde,Nde,Bde,Ude,Wde,Vde,Gde,Hde,jde,$de,nT);const aT=n=>{if(n.gap!==void 0&&n.gap!==null){const e=bw(n.theme,"spacing",8),a=o=>({gap:xw(e,o)});return zh(n,n.gap,a)}return null};aT.propTypes={};aT.filterProps=["gap"];const iT=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const e=bw(n.theme,"spacing",8),a=o=>({columnGap:xw(e,o)});return zh(n,n.columnGap,a)}return null};iT.propTypes={};iT.filterProps=["columnGap"];const rT=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const e=bw(n.theme,"spacing",8),a=o=>({rowGap:xw(e,o)});return zh(n,n.rowGap,a)}return null};rT.propTypes={};rT.filterProps=["rowGap"];const qde=Pi({prop:"gridColumn"}),Xde=Pi({prop:"gridRow"}),Zde=Pi({prop:"gridAutoFlow"}),Yde=Pi({prop:"gridAutoColumns"}),Kde=Pi({prop:"gridAutoRows"}),Jde=Pi({prop:"gridTemplateColumns"}),Qde=Pi({prop:"gridTemplateRows"}),ehe=Pi({prop:"gridTemplateAreas"}),the=Pi({prop:"gridArea"});tT(aT,iT,rT,qde,Xde,Zde,Yde,Kde,Jde,Qde,ehe,the);function L0(n,e){return e==="grey"?e:n}const nhe=Pi({prop:"color",themeKey:"palette",transform:L0}),ahe=Pi({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:L0}),ihe=Pi({prop:"backgroundColor",themeKey:"palette",transform:L0});tT(nhe,ahe,ihe);function Bl(n){return n<=1&&n!==0?`${n*100}%`:n}const rhe=Pi({prop:"width",transform:Bl}),dD=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const e=a=>{var o,s;const c=((o=n.theme)==null||(o=o.breakpoints)==null||(o=o.values)==null?void 0:o[a])||lD[a];return c?((s=n.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${c}${n.theme.breakpoints.unit}`}:{maxWidth:c}:{maxWidth:Bl(a)}};return zh(n,n.maxWidth,e)}return null};dD.filterProps=["maxWidth"];const ohe=Pi({prop:"minWidth",transform:Bl}),she=Pi({prop:"height",transform:Bl}),lhe=Pi({prop:"maxHeight",transform:Bl}),che=Pi({prop:"minHeight",transform:Bl});Pi({prop:"size",cssProperty:"width",transform:Bl});Pi({prop:"size",cssProperty:"height",transform:Bl});const uhe=Pi({prop:"boxSizing"});tT(rhe,dD,ohe,she,lhe,che,uhe);const dhe={border:{themeKey:"borders",transform:id},borderTop:{themeKey:"borders",transform:id},borderRight:{themeKey:"borders",transform:id},borderBottom:{themeKey:"borders",transform:id},borderLeft:{themeKey:"borders",transform:id},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:nT},color:{themeKey:"palette",transform:L0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:L0},backgroundColor:{themeKey:"palette",transform:L0},p:{style:Wr},pt:{style:Wr},pr:{style:Wr},pb:{style:Wr},pl:{style:Wr},px:{style:Wr},py:{style:Wr},padding:{style:Wr},paddingTop:{style:Wr},paddingRight:{style:Wr},paddingBottom:{style:Wr},paddingLeft:{style:Wr},paddingX:{style:Wr},paddingY:{style:Wr},paddingInline:{style:Wr},paddingInlineStart:{style:Wr},paddingInlineEnd:{style:Wr},paddingBlock:{style:Wr},paddingBlockStart:{style:Wr},paddingBlockEnd:{style:Wr},m:{style:Ur},mt:{style:Ur},mr:{style:Ur},mb:{style:Ur},ml:{style:Ur},mx:{style:Ur},my:{style:Ur},margin:{style:Ur},marginTop:{style:Ur},marginRight:{style:Ur},marginBottom:{style:Ur},marginLeft:{style:Ur},marginX:{style:Ur},marginY:{style:Ur},marginInline:{style:Ur},marginInlineStart:{style:Ur},marginInlineEnd:{style:Ur},marginBlock:{style:Ur},marginBlockStart:{style:Ur},marginBlockEnd:{style:Ur},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:aT},rowGap:{style:rT},columnGap:{style:iT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Bl},maxWidth:{style:dD},minWidth:{transform:Bl},height:{transform:Bl},maxHeight:{transform:Bl},minHeight:{transform:Bl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},oT=dhe;function hhe(...n){const e=n.reduce((o,s)=>o.concat(Object.keys(s)),[]),a=new Set(e);return n.every(o=>a.size===Object.keys(o).length)}function fhe(n,e){return typeof n=="function"?n(e):n}function phe(){function n(a,o,s,c){const d={[a]:o,theme:s},f=c[a];if(!f)return{[a]:o};const{cssProperty:m=a,themeKey:y,transform:_,style:w}=f;if(o==null)return null;if(y==="typography"&&o==="inherit")return{[a]:o};const A=eT(s,y)||{};return w?w(d):zh(d,o,I=>{let k=LE(A,_,I);return I===k&&typeof I=="string"&&(k=LE(A,_,`${a}${I==="default"?"":Pa(I)}`,I)),m===!1?k:{[m]:k}})}function e(a){var o;const{sx:s,theme:c={}}=a||{};if(!s)return null;const d=(o=c.unstable_sxConfig)!=null?o:oT;function f(m){let y=m;if(typeof m=="function")y=m(c);else if(typeof m!="object")return m;if(!y)return null;const _=Cde(c.breakpoints),w=Object.keys(_);let A=_;return Object.keys(y).forEach(C=>{const I=fhe(y[C],c);if(I!=null)if(typeof I=="object")if(d[C])A=Vb(A,n(C,I,c,d));else{const k=zh({theme:c},I,D=>({[C]:D}));hhe(k,I)?A[C]=e({sx:I,theme:c}):A=Vb(A,k)}else A=Vb(A,n(C,I,c,d))}),Pde(w,A)}return Array.isArray(s)?s.map(f):f(s)}return e}const Hq=phe();Hq.filterProps=["sx"];const hD=Hq,mhe=["breakpoints","palette","spacing","shape"];function fD(n={},...e){const{breakpoints:a={},palette:o={},spacing:s,shape:c={}}=n,d=ba(n,mhe),f=Ede(a),m=zde(s);let y=_l({breakpoints:f,direction:"ltr",components:{},palette:rt({mode:"light"},o),spacing:m,shape:rt({},Tde,c)},d);return y=e.reduce((_,w)=>_l(_,w),y),y.unstable_sxConfig=rt({},oT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(w){return hD({sx:w,theme:this})},y}function ghe(n){return Object.keys(n).length===0}function jq(n=null){const e=re.useContext(JM);return!e||ghe(e)?n:e}const yhe=fD();function pD(n=yhe){return jq(n)}function vhe({styles:n,themeId:e,defaultTheme:a={}}){const o=pD(a),s=typeof n=="function"?n(e&&o[e]||o):n;return he(bde,{styles:s})}const _he=["sx"],bhe=n=>{var e,a;const o={systemProps:{},otherProps:{}},s=(e=n==null||(a=n.theme)==null?void 0:a.unstable_sxConfig)!=null?e:oT;return Object.keys(n).forEach(c=>{s[c]?o.systemProps[c]=n[c]:o.otherProps[c]=n[c]}),o};function xhe(n){const{sx:e}=n,a=ba(n,_he),{systemProps:o,otherProps:s}=bhe(a);let c;return Array.isArray(e)?c=[o,...e]:typeof e=="function"?c=(...d)=>{const f=e(...d);return vh(f)?rt({},o,f):o}:c=rt({},o,e),rt({},s,{sx:c})}function $q(n){var e,a,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(a=$q(n[e]))&&(o&&(o+=" "),o+=a);else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function Ga(){for(var n,e,a=0,o="";a<arguments.length;)(n=arguments[a++])&&(e=$q(n))&&(o&&(o+=" "),o+=e);return o}const whe=["variant"];function i7(n){return n.length===0}function qq(n){const{variant:e}=n,a=ba(n,whe);let o=e||"";return Object.keys(a).sort().forEach(s=>{s==="color"?o+=i7(o)?n[s]:Pa(n[s]):o+=`${i7(o)?s:Pa(s)}${Pa(n[s].toString())}`}),o}const She=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Ahe(n){return Object.keys(n).length===0}function Ehe(n){return typeof n=="string"&&n.charCodeAt(0)>96}const Mhe=(n,e)=>e.components&&e.components[n]&&e.components[n].styleOverrides?e.components[n].styleOverrides:null,RE=n=>{const e={};return n&&n.forEach(a=>{const o=qq(a.props);e[o]=a.style}),e},The=(n,e)=>{let a=[];return e&&e.components&&e.components[n]&&e.components[n].variants&&(a=e.components[n].variants),RE(a)},kE=(n,e,a)=>{const{ownerState:o={}}=n,s=[];return a&&a.forEach(c=>{let d=!0;Object.keys(c.props).forEach(f=>{o[f]!==c.props[f]&&n[f]!==c.props[f]&&(d=!1)}),d&&s.push(e[qq(c.props)])}),s},Che=(n,e,a,o)=>{var s;const c=a==null||(s=a.components)==null||(s=s[o])==null?void 0:s.variants;return kE(n,e,c)};function Gb(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const Phe=fD(),Ihe=n=>n&&n.charAt(0).toLowerCase()+n.slice(1);function DA({defaultTheme:n,theme:e,themeId:a}){return Ahe(e)?n:e[a]||e}function Lhe(n){return n?(e,a)=>a[n]:null}const r7=({styledArg:n,props:e,defaultTheme:a,themeId:o})=>{const s=n(rt({},e,{theme:DA(rt({},e,{defaultTheme:a,themeId:o}))}));let c;if(s&&s.variants&&(c=s.variants,delete s.variants),c){const d=kE(e,RE(c),c);return[s,...d]}return s};function Rhe(n={}){const{themeId:e,defaultTheme:a=Phe,rootShouldForwardProp:o=Gb,slotShouldForwardProp:s=Gb}=n,c=d=>hD(rt({},d,{theme:DA(rt({},d,{defaultTheme:a,themeId:e}))}));return c.__mui_systemSx=!0,(d,f={})=>{wde(d,B=>B.filter(G=>!(G!=null&&G.__mui_systemSx)));const{name:m,slot:y,skipVariantsResolver:_,skipSx:w,overridesResolver:A=Lhe(Ihe(y))}=f,C=ba(f,She),I=_!==void 0?_:y&&y!=="Root"&&y!=="root"||!1,k=w||!1;let D,L=Gb;y==="Root"||y==="root"?L=o:y?L=s:Ehe(d)&&(L=void 0);const O=xde(d,rt({shouldForwardProp:L,label:D},C)),F=(B,...G)=>{const q=G?G.map(Q=>{if(typeof Q=="function"&&Q.__emotion_real!==Q)return me=>r7({styledArg:Q,props:me,defaultTheme:a,themeId:e});if(vh(Q)){let me=Q,pe;return Q&&Q.variants&&(pe=Q.variants,delete me.variants,me=be=>{let fe=Q;return kE(be,RE(pe),pe).forEach(Re=>{fe=_l(fe,Re)}),fe}),me}return Q}):[];let X=B;if(vh(B)){let Q;B&&B.variants&&(Q=B.variants,delete X.variants,X=me=>{let pe=B;return kE(me,RE(Q),Q).forEach(fe=>{pe=_l(pe,fe)}),pe})}else typeof B=="function"&&B.__emotion_real!==B&&(X=Q=>r7({styledArg:B,props:Q,defaultTheme:a,themeId:e}));m&&A&&q.push(Q=>{const me=DA(rt({},Q,{defaultTheme:a,themeId:e})),pe=Mhe(m,me);if(pe){const be={};return Object.entries(pe).forEach(([fe,Ce])=>{be[fe]=typeof Ce=="function"?Ce(rt({},Q,{theme:me})):Ce}),A(Q,be)}return null}),m&&!I&&q.push(Q=>{const me=DA(rt({},Q,{defaultTheme:a,themeId:e}));return Che(Q,The(m,me),me,m)}),k||q.push(c);const ee=q.length-G.length;if(Array.isArray(B)&&ee>0){const Q=new Array(ee).fill("");X=[...B,...Q],X.raw=[...B.raw,...Q]}const V=O(X,...q);return d.muiName&&(V.muiName=d.muiName),V};return O.withConfig&&(F.withConfig=O.withConfig),F}}function khe(n){const{theme:e,name:a,props:o}=n;return!e||!e.components||!e.components[a]||!e.components[a].defaultProps?o:Kk(e.components[a].defaultProps,o)}function Dhe({props:n,name:e,defaultTheme:a,themeId:o}){let s=pD(a);return o&&(s=s[o]||s),khe({theme:s,name:e,props:n})}function mD(n,e=0,a=1){return Math.min(Math.max(e,n),a)}function Ohe(n){n=n.slice(1);const e=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let a=n.match(e);return a&&a[0].length===1&&(a=a.map(o=>o+o)),a?`rgb${a.length===4?"a":""}(${a.map((o,s)=>s<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function Ig(n){if(n.type)return n;if(n.charAt(0)==="#")return Ig(Ohe(n));const e=n.indexOf("("),a=n.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error(mp(9,n));let o=n.substring(e+1,n.length-1),s;if(a==="color"){if(o=o.split(" "),s=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(mp(10,s))}else o=o.split(",");return o=o.map(c=>parseFloat(c)),{type:a,values:o,colorSpace:s}}function sT(n){const{type:e,colorSpace:a}=n;let{values:o}=n;return e.indexOf("rgb")!==-1?o=o.map((s,c)=>c<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),e.indexOf("color")!==-1?o=`${a} ${o.join(" ")}`:o=`${o.join(", ")}`,`${e}(${o})`}function zhe(n){n=Ig(n);const{values:e}=n,a=e[0],o=e[1]/100,s=e[2]/100,c=o*Math.min(s,1-s),d=(y,_=(y+a/30)%12)=>s-c*Math.max(Math.min(_-3,9-_,1),-1);let f="rgb";const m=[Math.round(d(0)*255),Math.round(d(8)*255),Math.round(d(4)*255)];return n.type==="hsla"&&(f+="a",m.push(e[3])),sT({type:f,values:m})}function o7(n){n=Ig(n);let e=n.type==="hsl"||n.type==="hsla"?Ig(zhe(n)).values:n.values;return e=e.map(a=>(n.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Fhe(n,e){const a=o7(n),o=o7(e);return(Math.max(a,o)+.05)/(Math.min(a,o)+.05)}function gs(n,e){return n=Ig(n),e=mD(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${e}`:n.values[3]=e,sT(n)}function Xq(n,e){if(n=Ig(n),e=mD(e),n.type.indexOf("hsl")!==-1)n.values[2]*=1-e;else if(n.type.indexOf("rgb")!==-1||n.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)n.values[a]*=1-e;return sT(n)}function Zq(n,e){if(n=Ig(n),e=mD(e),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*e;else if(n.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)n.values[a]+=(255-n.values[a])*e;else if(n.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)n.values[a]+=(1-n.values[a])*e;return sT(n)}const Nhe=re.createContext(null),Yq=Nhe;function Kq(){return re.useContext(Yq)}const Bhe=typeof Symbol=="function"&&Symbol.for,Uhe=Bhe?Symbol.for("mui.nested"):"__THEME_NESTED__";function Whe(n,e){return typeof e=="function"?e(n):rt({},n,e)}function Vhe(n){const{children:e,theme:a}=n,o=Kq(),s=re.useMemo(()=>{const c=o===null?a:Whe(o,a);return c!=null&&(c[Uhe]=o!==null),c},[a,o]);return he(Yq.Provider,{value:s,children:e})}const s7={};function l7(n,e,a,o=!1){return re.useMemo(()=>{const s=n&&e[n]||e;if(typeof a=="function"){const c=a(s),d=n?rt({},e,{[n]:c}):c;return o?()=>d:d}return n?rt({},e,{[n]:a}):rt({},e,a)},[n,e,a,o])}function Ghe(n){const{children:e,theme:a,themeId:o}=n,s=jq(s7),c=Kq()||s7,d=l7(o,s,a),f=l7(o,c,a,!0);return he(Vhe,{theme:f,children:he(JM.Provider,{value:d,children:e})})}function Hhe(n,e){return rt({toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}}},e)}const jhe=["mode","contrastThreshold","tonalOffset"],c7={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Tx.white,default:Tx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Q5={text:{primary:Tx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Tx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function u7(n,e,a,o){const s=o.light||o,c=o.dark||o*1.5;n[e]||(n.hasOwnProperty(a)?n[e]=n[a]:e==="light"?n.light=Zq(n.main,s):e==="dark"&&(n.dark=Xq(n.main,c)))}function $he(n="light"){return n==="dark"?{main:Sv[200],light:Sv[50],dark:Sv[400]}:{main:Sv[700],light:Sv[400],dark:Sv[800]}}function qhe(n="light"){return n==="dark"?{main:wv[200],light:wv[50],dark:wv[400]}:{main:wv[500],light:wv[300],dark:wv[700]}}function Xhe(n="light"){return n==="dark"?{main:xv[500],light:xv[300],dark:xv[700]}:{main:xv[700],light:xv[400],dark:xv[800]}}function Zhe(n="light"){return n==="dark"?{main:Av[400],light:Av[300],dark:Av[700]}:{main:Av[700],light:Av[500],dark:Av[900]}}function Yhe(n="light"){return n==="dark"?{main:Ev[400],light:Ev[300],dark:Ev[700]}:{main:Ev[800],light:Ev[500],dark:Ev[900]}}function Khe(n="light"){return n==="dark"?{main:H1[400],light:H1[300],dark:H1[700]}:{main:"#ed6c02",light:H1[500],dark:H1[900]}}function Jhe(n){const{mode:e="light",contrastThreshold:a=3,tonalOffset:o=.2}=n,s=ba(n,jhe),c=n.primary||$he(e),d=n.secondary||qhe(e),f=n.error||Xhe(e),m=n.info||Zhe(e),y=n.success||Yhe(e),_=n.warning||Khe(e);function w(k){return Fhe(k,Q5.text.primary)>=a?Q5.text.primary:c7.text.primary}const A=({color:k,name:D,mainShade:L=500,lightShade:O=300,darkShade:F=700})=>{if(k=rt({},k),!k.main&&k[L]&&(k.main=k[L]),!k.hasOwnProperty("main"))throw new Error(mp(11,D?` (${D})`:"",L));if(typeof k.main!="string")throw new Error(mp(12,D?` (${D})`:"",JSON.stringify(k.main)));return u7(k,"light",O,o),u7(k,"dark",F,o),k.contrastText||(k.contrastText=w(k.main)),k},C={dark:Q5,light:c7};return _l(rt({common:rt({},Tx),mode:e,primary:A({color:c,name:"primary"}),secondary:A({color:d,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:A({color:f,name:"error"}),warning:A({color:_,name:"warning"}),info:A({color:m,name:"info"}),success:A({color:y,name:"success"}),grey:Xce,contrastThreshold:a,getContrastText:w,augmentColor:A,tonalOffset:o},C[e]),s)}const Qhe=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function efe(n){return Math.round(n*1e5)/1e5}const d7={textTransform:"uppercase"},h7='"Roboto", "Helvetica", "Arial", sans-serif';function tfe(n,e){const a=typeof e=="function"?e(n):e,{fontFamily:o=h7,fontSize:s=14,fontWeightLight:c=300,fontWeightRegular:d=400,fontWeightMedium:f=500,fontWeightBold:m=700,htmlFontSize:y=16,allVariants:_,pxToRem:w}=a,A=ba(a,Qhe),C=s/14,I=w||(L=>`${L/y*C}rem`),k=(L,O,F,B,G)=>rt({fontFamily:o,fontWeight:L,fontSize:I(O),lineHeight:F},o===h7?{letterSpacing:`${efe(B/O)}em`}:{},G,_),D={h1:k(c,96,1.167,-1.5),h2:k(c,60,1.2,-.5),h3:k(d,48,1.167,0),h4:k(d,34,1.235,.25),h5:k(d,24,1.334,0),h6:k(f,20,1.6,.15),subtitle1:k(d,16,1.75,.15),subtitle2:k(f,14,1.57,.1),body1:k(d,16,1.5,.15),body2:k(d,14,1.43,.15),button:k(f,14,1.75,.4,d7),caption:k(d,12,1.66,.4),overline:k(d,12,2.66,1,d7),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return _l(rt({htmlFontSize:y,pxToRem:I,fontFamily:o,fontSize:s,fontWeightLight:c,fontWeightRegular:d,fontWeightMedium:f,fontWeightBold:m},D),A,{clone:!1})}const nfe=.2,afe=.14,ife=.12;function gr(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${nfe})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${afe})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${ife})`].join(",")}const rfe=["none",gr(0,2,1,-1,0,1,1,0,0,1,3,0),gr(0,3,1,-2,0,2,2,0,0,1,5,0),gr(0,3,3,-2,0,3,4,0,0,1,8,0),gr(0,2,4,-1,0,4,5,0,0,1,10,0),gr(0,3,5,-1,0,5,8,0,0,1,14,0),gr(0,3,5,-1,0,6,10,0,0,1,18,0),gr(0,4,5,-2,0,7,10,1,0,2,16,1),gr(0,5,5,-3,0,8,10,1,0,3,14,2),gr(0,5,6,-3,0,9,12,1,0,3,16,2),gr(0,6,6,-3,0,10,14,1,0,4,18,3),gr(0,6,7,-4,0,11,15,1,0,4,20,3),gr(0,7,8,-4,0,12,17,2,0,5,22,4),gr(0,7,8,-4,0,13,19,2,0,5,24,4),gr(0,7,9,-4,0,14,21,2,0,5,26,4),gr(0,8,9,-5,0,15,22,2,0,6,28,5),gr(0,8,10,-5,0,16,24,2,0,6,30,5),gr(0,8,11,-5,0,17,26,2,0,6,32,5),gr(0,9,11,-5,0,18,28,2,0,7,34,6),gr(0,9,12,-6,0,19,29,2,0,7,36,6),gr(0,10,13,-6,0,20,31,3,0,8,38,7),gr(0,10,13,-6,0,21,33,3,0,8,40,7),gr(0,10,14,-6,0,22,35,3,0,8,42,7),gr(0,11,14,-7,0,23,36,3,0,9,44,8),gr(0,11,15,-7,0,24,38,3,0,9,46,8)],ofe=rfe,sfe=["duration","easing","delay"],lfe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},cfe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function f7(n){return`${Math.round(n)}ms`}function ufe(n){if(!n)return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function dfe(n){const e=rt({},lfe,n.easing),a=rt({},cfe,n.duration);return rt({getAutoHeightDuration:ufe,create:(s=["all"],c={})=>{const{duration:d=a.standard,easing:f=e.easeInOut,delay:m=0}=c;return ba(c,sfe),(Array.isArray(s)?s:[s]).map(y=>`${y} ${typeof d=="string"?d:f7(d)} ${f} ${typeof m=="string"?m:f7(m)}`).join(",")}},n,{easing:e,duration:a})}const hfe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},ffe=hfe,pfe=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Jq(n={},...e){const{mixins:a={},palette:o={},transitions:s={},typography:c={}}=n,d=ba(n,pfe);if(n.vars)throw new Error(mp(18));const f=Jhe(o),m=fD(n);let y=_l(m,{mixins:Hhe(m.breakpoints,a),palette:f,shadows:ofe.slice(),typography:tfe(f,c),transitions:dfe(s),zIndex:rt({},ffe)});return y=_l(y,d),y=e.reduce((_,w)=>_l(_,w),y),y.unstable_sxConfig=rt({},oT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(w){return hD({sx:w,theme:this})},y}const mfe=Jq(),lT=mfe;function ww(){const n=pD(lT);return n[G0]||n}function kr({props:n,name:e}){return Dhe({props:n,name:e,defaultTheme:lT,themeId:G0})}const Kl=n=>Gb(n)&&n!=="classes",gfe=Gb,yfe=Rhe({themeId:G0,defaultTheme:lT,rootShouldForwardProp:Kl}),ha=yfe,vfe=["theme"];function _fe(n){let{theme:e}=n,a=ba(n,vfe);const o=e[G0];return he(Ghe,rt({},a,{themeId:o?G0:void 0,theme:o||e}))}const bfe=n=>{let e;return n<1?e=5.11916*n**2:e=4.5*Math.log(n+1)+2,(e/100).toFixed(2)},p7=bfe;function xfe(n){return ur("MuiSvgIcon",n)}Wi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const wfe=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Sfe=n=>{const{color:e,fontSize:a,classes:o}=n,s={root:["root",e!=="inherit"&&`color${Pa(e)}`,`fontSize${Pa(a)}`]};return vr(s,xfe,o)},Afe=ha("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.color!=="inherit"&&e[`color${Pa(a.color)}`],e[`fontSize${Pa(a.fontSize)}`]]}})(({theme:n,ownerState:e})=>{var a,o,s,c,d,f,m,y,_,w,A,C,I;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=n.transitions)==null||(o=a.create)==null?void 0:o.call(a,"fill",{duration:(s=n.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((c=n.typography)==null||(d=c.pxToRem)==null?void 0:d.call(c,20))||"1.25rem",medium:((f=n.typography)==null||(m=f.pxToRem)==null?void 0:m.call(f,24))||"1.5rem",large:((y=n.typography)==null||(_=y.pxToRem)==null?void 0:_.call(y,35))||"2.1875rem"}[e.fontSize],color:(w=(A=(n.vars||n).palette)==null||(A=A[e.color])==null?void 0:A.main)!=null?w:{action:(C=(n.vars||n).palette)==null||(C=C.action)==null?void 0:C.active,disabled:(I=(n.vars||n).palette)==null||(I=I.action)==null?void 0:I.disabled,inherit:void 0}[e.color]}}),Qq=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiSvgIcon"}),{children:s,className:c,color:d="inherit",component:f="svg",fontSize:m="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:w,viewBox:A="0 0 24 24"}=o,C=ba(o,wfe),I=re.isValidElement(s)&&s.type==="svg",k=rt({},o,{color:d,component:f,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:A,hasSvgAsChild:I}),D={};_||(D.viewBox=A);const L=Sfe(k);return Bt(Afe,rt({as:f,className:Ga(L.root,c),focusable:"false",color:y,"aria-hidden":w?void 0:!0,role:w?"img":void 0,ref:a},D,C,I&&s.props,{ownerState:k,children:[I?s.props.children:s,w?he("title",{children:w}):null]}))});Qq.muiName="SvgIcon";const m7=Qq;function eX(n,e){function a(o,s){return he(m7,rt({"data-testid":`${e}Icon`,ref:s},o,{children:n}))}return a.muiName=m7.muiName,re.memo(re.forwardRef(a))}const Efe={configure:n=>{wq.configure(n)}},Mfe=Object.freeze(Object.defineProperty({__proto__:null,capitalize:Pa,createChainedFunction:bL,createSvgIcon:eX,debounce:Yk,deprecatedPropType:Kce,isMuiElement:IA,ownerDocument:bl,ownerWindow:gp,requirePropFactory:Jce,setRef:CE,unstable_ClassNameGenerator:Efe,unstable_useEnhancedEffect:Oh,unstable_useId:_q,unsupportedProp:tue,useControlled:PE,useEventCallback:sg,useForkRef:xs,useIsFocusVisible:bq},Symbol.toStringTag,{value:"Module"}));function EL(n,e){return EL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,s){return o.__proto__=s,o},EL(n,e)}function tX(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,EL(n,e)}const g7={disabled:!1},DE=Vl.createContext(null);var Tfe=function(e){return e.scrollTop},wb="unmounted",qm="exited",Xm="entering",e0="entered",ML="exiting",Wh=function(n){tX(e,n);function e(o,s){var c;c=n.call(this,o,s)||this;var d=s,f=d&&!d.isMounting?o.enter:o.appear,m;return c.appearStatus=null,o.in?f?(m=qm,c.appearStatus=Xm):m=e0:o.unmountOnExit||o.mountOnEnter?m=wb:m=qm,c.state={status:m},c.nextCallback=null,c}e.getDerivedStateFromProps=function(s,c){var d=s.in;return d&&c.status===wb?{status:qm}:null};var a=e.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(s){var c=null;if(s!==this.props){var d=this.state.status;this.props.in?d!==Xm&&d!==e0&&(c=Xm):(d===Xm||d===e0)&&(c=ML)}this.updateStatus(!1,c)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var s=this.props.timeout,c,d,f;return c=d=f=s,s!=null&&typeof s!="number"&&(c=s.exit,d=s.enter,f=s.appear!==void 0?s.appear:d),{exit:c,enter:d,appear:f}},a.updateStatus=function(s,c){if(s===void 0&&(s=!1),c!==null)if(this.cancelNextCallback(),c===Xm){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:xb.findDOMNode(this);d&&Tfe(d)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===qm&&this.setState({status:wb})},a.performEnter=function(s){var c=this,d=this.props.enter,f=this.context?this.context.isMounting:s,m=this.props.nodeRef?[f]:[xb.findDOMNode(this),f],y=m[0],_=m[1],w=this.getTimeouts(),A=f?w.appear:w.enter;if(!s&&!d||g7.disabled){this.safeSetState({status:e0},function(){c.props.onEntered(y)});return}this.props.onEnter(y,_),this.safeSetState({status:Xm},function(){c.props.onEntering(y,_),c.onTransitionEnd(A,function(){c.safeSetState({status:e0},function(){c.props.onEntered(y,_)})})})},a.performExit=function(){var s=this,c=this.props.exit,d=this.getTimeouts(),f=this.props.nodeRef?void 0:xb.findDOMNode(this);if(!c||g7.disabled){this.safeSetState({status:qm},function(){s.props.onExited(f)});return}this.props.onExit(f),this.safeSetState({status:ML},function(){s.props.onExiting(f),s.onTransitionEnd(d.exit,function(){s.safeSetState({status:qm},function(){s.props.onExited(f)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(s,c){c=this.setNextCallback(c),this.setState(s,c)},a.setNextCallback=function(s){var c=this,d=!0;return this.nextCallback=function(f){d&&(d=!1,c.nextCallback=null,s(f))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},a.onTransitionEnd=function(s,c){this.setNextCallback(c);var d=this.props.nodeRef?this.props.nodeRef.current:xb.findDOMNode(this),f=s==null&&!this.props.addEndListener;if(!d||f){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],y=m[0],_=m[1];this.props.addEndListener(y,_)}s!=null&&setTimeout(this.nextCallback,s)},a.render=function(){var s=this.state.status;if(s===wb)return null;var c=this.props,d=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var f=ba(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Vl.createElement(DE.Provider,{value:null},typeof d=="function"?d(s,f):Vl.cloneElement(Vl.Children.only(d),f))},e}(Vl.Component);Wh.contextType=DE;Wh.propTypes={};function Mv(){}Wh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Mv,onEntering:Mv,onEntered:Mv,onExit:Mv,onExiting:Mv,onExited:Mv};Wh.UNMOUNTED=wb;Wh.EXITED=qm;Wh.ENTERING=Xm;Wh.ENTERED=e0;Wh.EXITING=ML;const nX=Wh;function Cfe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function gD(n,e){var a=function(c){return e&&re.isValidElement(c)?e(c):c},o=Object.create(null);return n&&re.Children.map(n,function(s){return s}).forEach(function(s){o[s.key]=a(s)}),o}function Pfe(n,e){n=n||{},e=e||{};function a(_){return _ in e?e[_]:n[_]}var o=Object.create(null),s=[];for(var c in n)c in e?s.length&&(o[c]=s,s=[]):s.push(c);var d,f={};for(var m in e){if(o[m])for(d=0;d<o[m].length;d++){var y=o[m][d];f[o[m][d]]=a(y)}f[m]=a(m)}for(d=0;d<s.length;d++)f[s[d]]=a(s[d]);return f}function lg(n,e,a){return a[e]!=null?a[e]:n.props[e]}function Ife(n,e){return gD(n.children,function(a){return re.cloneElement(a,{onExited:e.bind(null,a),in:!0,appear:lg(a,"appear",n),enter:lg(a,"enter",n),exit:lg(a,"exit",n)})})}function Lfe(n,e,a){var o=gD(n.children),s=Pfe(e,o);return Object.keys(s).forEach(function(c){var d=s[c];if(re.isValidElement(d)){var f=c in e,m=c in o,y=e[c],_=re.isValidElement(y)&&!y.props.in;m&&(!f||_)?s[c]=re.cloneElement(d,{onExited:a.bind(null,d),in:!0,exit:lg(d,"exit",n),enter:lg(d,"enter",n)}):!m&&f&&!_?s[c]=re.cloneElement(d,{in:!1}):m&&f&&re.isValidElement(y)&&(s[c]=re.cloneElement(d,{onExited:a.bind(null,d),in:y.props.in,exit:lg(d,"exit",n),enter:lg(d,"enter",n)}))}}),s}var Rfe=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},kfe={component:"div",childFactory:function(e){return e}},yD=function(n){tX(e,n);function e(o,s){var c;c=n.call(this,o,s)||this;var d=c.handleExited.bind(Cfe(c));return c.state={contextValue:{isMounting:!0},handleExited:d,firstRender:!0},c}var a=e.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,c){var d=c.children,f=c.handleExited,m=c.firstRender;return{children:m?Ife(s,f):Lfe(s,d,f),firstRender:!1}},a.handleExited=function(s,c){var d=gD(this.props.children);s.key in d||(s.props.onExited&&s.props.onExited(c),this.mounted&&this.setState(function(f){var m=rt({},f.children);return delete m[s.key],{children:m}}))},a.render=function(){var s=this.props,c=s.component,d=s.childFactory,f=ba(s,["component","childFactory"]),m=this.state.contextValue,y=Rfe(this.state.children).map(d);return delete f.appear,delete f.enter,delete f.exit,c===null?Vl.createElement(DE.Provider,{value:m},y):Vl.createElement(DE.Provider,{value:m},Vl.createElement(c,f,y))},e}(Vl.Component);yD.propTypes={};yD.defaultProps=kfe;const Dfe=yD,aX=n=>n.scrollTop;function OE(n,e){var a,o;const{timeout:s,easing:c,style:d={}}=n;return{duration:(a=d.transitionDuration)!=null?a:typeof s=="number"?s:s[e.mode]||0,easing:(o=d.transitionTimingFunction)!=null?o:typeof c=="object"?c[e.mode]:c,delay:d.transitionDelay}}function Ofe(n){return ur("MuiPaper",n)}Wi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const zfe=["className","component","elevation","square","variant"],Ffe=n=>{const{square:e,elevation:a,variant:o,classes:s}=n,c={root:["root",o,!e&&"rounded",o==="elevation"&&`elevation${a}`]};return vr(c,Ofe,s)},Nfe=ha("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[a.variant],!a.square&&e.rounded,a.variant==="elevation"&&e[`elevation${a.elevation}`]]}})(({theme:n,ownerState:e})=>{var a;return rt({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!e.square&&{borderRadius:n.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.divider}`},e.variant==="elevation"&&rt({boxShadow:(n.vars||n).shadows[e.elevation]},!n.vars&&n.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${gs("#fff",p7(e.elevation))}, ${gs("#fff",p7(e.elevation))})`},n.vars&&{backgroundImage:(a=n.vars.overlays)==null?void 0:a[e.elevation]}))}),Bfe=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiPaper"}),{className:s,component:c="div",elevation:d=1,square:f=!1,variant:m="elevation"}=o,y=ba(o,zfe),_=rt({},o,{component:c,elevation:d,square:f,variant:m}),w=Ffe(_);return he(Nfe,rt({as:c,ownerState:_,className:Ga(w.root,s),ref:a},y))}),Ufe=Bfe;function Wfe(n){const{className:e,classes:a,pulsate:o=!1,rippleX:s,rippleY:c,rippleSize:d,in:f,onExited:m,timeout:y}=n,[_,w]=re.useState(!1),A=Ga(e,a.ripple,a.rippleVisible,o&&a.ripplePulsate),C={width:d,height:d,top:-(d/2)+c,left:-(d/2)+s},I=Ga(a.child,_&&a.childLeaving,o&&a.childPulsate);return!f&&!_&&w(!0),re.useEffect(()=>{if(!f&&m!=null){const k=setTimeout(m,y);return()=>{clearTimeout(k)}}},[m,f,y]),he("span",{className:A,style:C,children:he("span",{className:I})})}const Vfe=Wi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),gc=Vfe,Gfe=["center","classes","className"];let cT=n=>n,y7,v7,_7,b7;const TL=550,Hfe=80,jfe=oD(y7||(y7=cT`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),$fe=oD(v7||(v7=cT`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),qfe=oD(_7||(_7=cT`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Xfe=ha("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Zfe=ha(Wfe,{name:"MuiTouchRipple",slot:"Ripple"})(b7||(b7=cT`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),gc.rippleVisible,jfe,TL,({theme:n})=>n.transitions.easing.easeInOut,gc.ripplePulsate,({theme:n})=>n.transitions.duration.shorter,gc.child,gc.childLeaving,$fe,TL,({theme:n})=>n.transitions.easing.easeInOut,gc.childPulsate,qfe,({theme:n})=>n.transitions.easing.easeInOut),Yfe=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:c={},className:d}=o,f=ba(o,Gfe),[m,y]=re.useState([]),_=re.useRef(0),w=re.useRef(null);re.useEffect(()=>{w.current&&(w.current(),w.current=null)},[m]);const A=re.useRef(!1),C=re.useRef(0),I=re.useRef(null),k=re.useRef(null);re.useEffect(()=>()=>{C.current&&clearTimeout(C.current)},[]);const D=re.useCallback(B=>{const{pulsate:G,rippleX:q,rippleY:X,rippleSize:ee,cb:V}=B;y(Q=>[...Q,he(Zfe,{classes:{ripple:Ga(c.ripple,gc.ripple),rippleVisible:Ga(c.rippleVisible,gc.rippleVisible),ripplePulsate:Ga(c.ripplePulsate,gc.ripplePulsate),child:Ga(c.child,gc.child),childLeaving:Ga(c.childLeaving,gc.childLeaving),childPulsate:Ga(c.childPulsate,gc.childPulsate)},timeout:TL,pulsate:G,rippleX:q,rippleY:X,rippleSize:ee},_.current)]),_.current+=1,w.current=V},[c]),L=re.useCallback((B={},G={},q=()=>{})=>{const{pulsate:X=!1,center:ee=s||G.pulsate,fakeElement:V=!1}=G;if((B==null?void 0:B.type)==="mousedown"&&A.current){A.current=!1;return}(B==null?void 0:B.type)==="touchstart"&&(A.current=!0);const Q=V?null:k.current,me=Q?Q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let pe,be,fe;if(ee||B===void 0||B.clientX===0&&B.clientY===0||!B.clientX&&!B.touches)pe=Math.round(me.width/2),be=Math.round(me.height/2);else{const{clientX:Ce,clientY:Re}=B.touches&&B.touches.length>0?B.touches[0]:B;pe=Math.round(Ce-me.left),be=Math.round(Re-me.top)}if(ee)fe=Math.sqrt((2*me.width**2+me.height**2)/3),fe%2===0&&(fe+=1);else{const Ce=Math.max(Math.abs((Q?Q.clientWidth:0)-pe),pe)*2+2,Re=Math.max(Math.abs((Q?Q.clientHeight:0)-be),be)*2+2;fe=Math.sqrt(Ce**2+Re**2)}B!=null&&B.touches?I.current===null&&(I.current=()=>{D({pulsate:X,rippleX:pe,rippleY:be,rippleSize:fe,cb:q})},C.current=setTimeout(()=>{I.current&&(I.current(),I.current=null)},Hfe)):D({pulsate:X,rippleX:pe,rippleY:be,rippleSize:fe,cb:q})},[s,D]),O=re.useCallback(()=>{L({},{pulsate:!0})},[L]),F=re.useCallback((B,G)=>{if(clearTimeout(C.current),(B==null?void 0:B.type)==="touchend"&&I.current){I.current(),I.current=null,C.current=setTimeout(()=>{F(B,G)});return}I.current=null,y(q=>q.length>0?q.slice(1):q),w.current=G},[]);return re.useImperativeHandle(a,()=>({pulsate:O,start:L,stop:F}),[O,L,F]),he(Xfe,rt({className:Ga(gc.root,c.root,d),ref:k},f,{children:he(Dfe,{component:null,exit:!0,children:m})}))}),Kfe=Yfe;function Jfe(n){return ur("MuiButtonBase",n)}const Qfe=Wi("MuiButtonBase",["root","disabled","focusVisible"]),epe=Qfe,tpe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],npe=n=>{const{disabled:e,focusVisible:a,focusVisibleClassName:o,classes:s}=n,d=vr({root:["root",e&&"disabled",a&&"focusVisible"]},Jfe,s);return a&&o&&(d.root+=` ${o}`),d},ape=ha("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${epe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ipe=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:c=!1,children:d,className:f,component:m="button",disabled:y=!1,disableRipple:_=!1,disableTouchRipple:w=!1,focusRipple:A=!1,LinkComponent:C="a",onBlur:I,onClick:k,onContextMenu:D,onDragLeave:L,onFocus:O,onFocusVisible:F,onKeyDown:B,onKeyUp:G,onMouseDown:q,onMouseLeave:X,onMouseUp:ee,onTouchEnd:V,onTouchMove:Q,onTouchStart:me,tabIndex:pe=0,TouchRippleProps:be,touchRippleRef:fe,type:Ce}=o,Re=ba(o,tpe),He=re.useRef(null),ue=re.useRef(null),ye=xs(ue,fe),{isFocusVisibleRef:Ae,onFocus:ne,onBlur:Ee,ref:Ye}=bq(),[Xe,Ke]=re.useState(!1);y&&Xe&&Ke(!1),re.useImperativeHandle(s,()=>({focusVisible:()=>{Ke(!0),He.current.focus()}}),[]);const[Ue,ht]=re.useState(!1);re.useEffect(()=>{ht(!0)},[]);const Lt=Ue&&!_&&!y;re.useEffect(()=>{Xe&&A&&!_&&Ue&&ue.current.pulsate()},[_,A,Xe,Ue]);function Rt(At,Ut,Vt=w){return sg($t=>(Ut&&Ut($t),!Vt&&ue.current&&ue.current[At]($t),!0))}const Jt=Rt("start",q),Pt=Rt("stop",D),Pe=Rt("stop",L),ft=Rt("stop",ee),gt=Rt("stop",At=>{Xe&&At.preventDefault(),X&&X(At)}),St=Rt("start",me),Be=Rt("stop",V),le=Rt("stop",Q),oe=Rt("stop",At=>{Ee(At),Ae.current===!1&&Ke(!1),I&&I(At)},!1),ve=sg(At=>{He.current||(He.current=At.currentTarget),ne(At),Ae.current===!0&&(Ke(!0),F&&F(At)),O&&O(At)}),$e=()=>{const At=He.current;return m&&m!=="button"&&!(At.tagName==="A"&&At.href)},De=re.useRef(!1),ot=sg(At=>{A&&!De.current&&Xe&&ue.current&&At.key===" "&&(De.current=!0,ue.current.stop(At,()=>{ue.current.start(At)})),At.target===At.currentTarget&&$e()&&At.key===" "&&At.preventDefault(),B&&B(At),At.target===At.currentTarget&&$e()&&At.key==="Enter"&&!y&&(At.preventDefault(),k&&k(At))}),ce=sg(At=>{A&&At.key===" "&&ue.current&&Xe&&!At.defaultPrevented&&(De.current=!1,ue.current.stop(At,()=>{ue.current.pulsate(At)})),G&&G(At),k&&At.target===At.currentTarget&&$e()&&At.key===" "&&!At.defaultPrevented&&k(At)});let te=m;te==="button"&&(Re.href||Re.to)&&(te=C);const Oe={};te==="button"?(Oe.type=Ce===void 0?"button":Ce,Oe.disabled=y):(!Re.href&&!Re.to&&(Oe.role="button"),y&&(Oe["aria-disabled"]=y));const pt=xs(a,Ye,He),it=rt({},o,{centerRipple:c,component:m,disabled:y,disableRipple:_,disableTouchRipple:w,focusRipple:A,tabIndex:pe,focusVisible:Xe}),st=npe(it);return Bt(ape,rt({as:te,className:Ga(st.root,f),ownerState:it,onBlur:oe,onClick:k,onContextMenu:Pt,onFocus:ve,onKeyDown:ot,onKeyUp:ce,onMouseDown:Jt,onMouseLeave:gt,onMouseUp:ft,onDragLeave:Pe,onTouchEnd:Be,onTouchMove:le,onTouchStart:St,ref:pt,tabIndex:y?-1:pe,type:Ce},Oe,Re,{children:[d,Lt?he(Kfe,rt({ref:ye,center:c},be)):null]}))}),uT=ipe;function rpe(n){return ur("MuiTypography",n)}Wi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const ope=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],spe=n=>{const{align:e,gutterBottom:a,noWrap:o,paragraph:s,variant:c,classes:d}=n,f={root:["root",c,n.align!=="inherit"&&`align${Pa(e)}`,a&&"gutterBottom",o&&"noWrap",s&&"paragraph"]};return vr(f,rpe,d)},lpe=ha("span",{name:"MuiTypography",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.variant&&e[a.variant],a.align!=="inherit"&&e[`align${Pa(a.align)}`],a.noWrap&&e.noWrap,a.gutterBottom&&e.gutterBottom,a.paragraph&&e.paragraph]}})(({theme:n,ownerState:e})=>rt({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&n.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),x7={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},cpe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},upe=n=>cpe[n]||n,dpe=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiTypography"}),s=upe(o.color),c=xhe(rt({},o,{color:s})),{align:d="inherit",className:f,component:m,gutterBottom:y=!1,noWrap:_=!1,paragraph:w=!1,variant:A="body1",variantMapping:C=x7}=c,I=ba(c,ope),k=rt({},c,{align:d,color:s,className:f,component:m,gutterBottom:y,noWrap:_,paragraph:w,variant:A,variantMapping:C}),D=m||(w?"p":C[A]||x7[A])||"span",L=spe(k);return he(lpe,rt({as:D,ref:a,ownerState:k,className:Ga(L.root,f)},I))}),Ws=dpe;function zE(n){return typeof n=="string"}function hpe(n,e,a){return n===void 0||zE(n)?e:rt({},e,{ownerState:rt({},e.ownerState,a)})}function iX(n,e=[]){if(n===void 0)return{};const a={};return Object.keys(n).filter(o=>o.match(/^on[A-Z]/)&&typeof n[o]=="function"&&!e.includes(o)).forEach(o=>{a[o]=n[o]}),a}function fpe(n,e,a){return typeof n=="function"?n(e,a):n}function w7(n){if(n===void 0)return{};const e={};return Object.keys(n).filter(a=>!(a.match(/^on[A-Z]/)&&typeof n[a]=="function")).forEach(a=>{e[a]=n[a]}),e}function ppe(n){const{getSlotProps:e,additionalProps:a,externalSlotProps:o,externalForwardedProps:s,className:c}=n;if(!e){const C=Ga(a==null?void 0:a.className,c,s==null?void 0:s.className,o==null?void 0:o.className),I=rt({},a==null?void 0:a.style,s==null?void 0:s.style,o==null?void 0:o.style),k=rt({},a,s,o);return C.length>0&&(k.className=C),Object.keys(I).length>0&&(k.style=I),{props:k,internalRef:void 0}}const d=iX(rt({},s,o)),f=w7(o),m=w7(s),y=e(d),_=Ga(y==null?void 0:y.className,a==null?void 0:a.className,c,s==null?void 0:s.className,o==null?void 0:o.className),w=rt({},y==null?void 0:y.style,a==null?void 0:a.style,s==null?void 0:s.style,o==null?void 0:o.style),A=rt({},y,a,m,f);return _.length>0&&(A.className=_),Object.keys(w).length>0&&(A.style=w),{props:A,internalRef:y.ref}}const mpe=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function j0(n){var e;const{elementType:a,externalSlotProps:o,ownerState:s,skipResolvingSlotProps:c=!1}=n,d=ba(n,mpe),f=c?{}:fpe(o,s),{props:m,internalRef:y}=ppe(rt({},d,{externalSlotProps:f})),_=xs(y,f==null?void 0:f.ref,(e=n.additionalProps)==null?void 0:e.ref);return hpe(a,rt({},m,{ref:_}),s)}const gpe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function ype(n){const e=parseInt(n.getAttribute("tabindex")||"",10);return Number.isNaN(e)?n.contentEditable==="true"||(n.nodeName==="AUDIO"||n.nodeName==="VIDEO"||n.nodeName==="DETAILS")&&n.getAttribute("tabindex")===null?0:n.tabIndex:e}function vpe(n){if(n.tagName!=="INPUT"||n.type!=="radio"||!n.name)return!1;const e=o=>n.ownerDocument.querySelector(`input[type="radio"]${o}`);let a=e(`[name="${n.name}"]:checked`);return a||(a=e(`[name="${n.name}"]`)),a!==n}function _pe(n){return!(n.disabled||n.tagName==="INPUT"&&n.type==="hidden"||vpe(n))}function bpe(n){const e=[],a=[];return Array.from(n.querySelectorAll(gpe)).forEach((o,s)=>{const c=ype(o);c===-1||!_pe(o)||(c===0?e.push(o):a.push({documentOrder:s,tabIndex:c,node:o}))}),a.sort((o,s)=>o.tabIndex===s.tabIndex?o.documentOrder-s.documentOrder:o.tabIndex-s.tabIndex).map(o=>o.node).concat(e)}function xpe(){return!0}function wpe(n){const{children:e,disableAutoFocus:a=!1,disableEnforceFocus:o=!1,disableRestoreFocus:s=!1,getTabbable:c=bpe,isEnabled:d=xpe,open:f}=n,m=re.useRef(!1),y=re.useRef(null),_=re.useRef(null),w=re.useRef(null),A=re.useRef(null),C=re.useRef(!1),I=re.useRef(null),k=xs(e.ref,I),D=re.useRef(null);re.useEffect(()=>{!f||!I.current||(C.current=!a)},[a,f]),re.useEffect(()=>{if(!f||!I.current)return;const F=bl(I.current);return I.current.contains(F.activeElement)||(I.current.hasAttribute("tabIndex")||I.current.setAttribute("tabIndex","-1"),C.current&&I.current.focus()),()=>{s||(w.current&&w.current.focus&&(m.current=!0,w.current.focus()),w.current=null)}},[f]),re.useEffect(()=>{if(!f||!I.current)return;const F=bl(I.current),B=X=>{D.current=X,!(o||!d()||X.key!=="Tab")&&F.activeElement===I.current&&X.shiftKey&&(m.current=!0,_.current&&_.current.focus())},G=()=>{const X=I.current;if(X===null)return;if(!F.hasFocus()||!d()||m.current){m.current=!1;return}if(X.contains(F.activeElement)||o&&F.activeElement!==y.current&&F.activeElement!==_.current)return;if(F.activeElement!==A.current)A.current=null;else if(A.current!==null)return;if(!C.current)return;let ee=[];if((F.activeElement===y.current||F.activeElement===_.current)&&(ee=c(I.current)),ee.length>0){var V,Q;const me=!!((V=D.current)!=null&&V.shiftKey&&((Q=D.current)==null?void 0:Q.key)==="Tab"),pe=ee[0],be=ee[ee.length-1];typeof pe!="string"&&typeof be!="string"&&(me?be.focus():pe.focus())}else X.focus()};F.addEventListener("focusin",G),F.addEventListener("keydown",B,!0);const q=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&G()},50);return()=>{clearInterval(q),F.removeEventListener("focusin",G),F.removeEventListener("keydown",B,!0)}},[a,o,s,d,f,c]);const L=F=>{w.current===null&&(w.current=F.relatedTarget),C.current=!0,A.current=F.target;const B=e.props.onFocus;B&&B(F)},O=F=>{w.current===null&&(w.current=F.relatedTarget),C.current=!0};return Bt(re.Fragment,{children:[he("div",{tabIndex:f?0:-1,onFocus:O,ref:y,"data-testid":"sentinelStart"}),re.cloneElement(e,{ref:k,onFocus:L}),he("div",{tabIndex:f?0:-1,onFocus:O,ref:_,"data-testid":"sentinelEnd"})]})}function Spe(n){return typeof n=="function"?n():n}const Ape=re.forwardRef(function(e,a){const{children:o,container:s,disablePortal:c=!1}=e,[d,f]=re.useState(null),m=xs(re.isValidElement(o)?o.ref:null,a);if(Oh(()=>{c||f(Spe(s)||document.body)},[s,c]),Oh(()=>{if(d&&!c)return CE(a,d),()=>{CE(a,null)}},[a,d,c]),c){if(re.isValidElement(o)){const y={ref:m};return re.cloneElement(o,y)}return he(re.Fragment,{children:o})}return he(re.Fragment,{children:d&&gw.createPortal(o,d)})});function Epe(n){const e=bl(n);return e.body===n?gp(n).innerWidth>e.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function Hb(n,e){e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function S7(n){return parseInt(gp(n).getComputedStyle(n).paddingRight,10)||0}function Mpe(n){const a=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(n.tagName)!==-1,o=n.tagName==="INPUT"&&n.getAttribute("type")==="hidden";return a||o}function A7(n,e,a,o,s){const c=[e,a,...o];[].forEach.call(n.children,d=>{const f=c.indexOf(d)===-1,m=!Mpe(d);f&&m&&Hb(d,s)})}function e4(n,e){let a=-1;return n.some((o,s)=>e(o)?(a=s,!0):!1),a}function Tpe(n,e){const a=[],o=n.container;if(!e.disableScrollLock){if(Epe(o)){const d=xq(bl(o));a.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight=`${S7(o)+d}px`;const f=bl(o).querySelectorAll(".mui-fixed");[].forEach.call(f,m=>{a.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${S7(m)+d}px`})}let c;if(o.parentNode instanceof DocumentFragment)c=bl(o).body;else{const d=o.parentElement,f=gp(o);c=(d==null?void 0:d.nodeName)==="HTML"&&f.getComputedStyle(d).overflowY==="scroll"?d:o}a.push({value:c.style.overflow,property:"overflow",el:c},{value:c.style.overflowX,property:"overflow-x",el:c},{value:c.style.overflowY,property:"overflow-y",el:c}),c.style.overflow="hidden"}return()=>{a.forEach(({value:c,el:d,property:f})=>{c?d.style.setProperty(f,c):d.style.removeProperty(f)})}}function Cpe(n){const e=[];return[].forEach.call(n.children,a=>{a.getAttribute("aria-hidden")==="true"&&e.push(a)}),e}class Ppe{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,a){let o=this.modals.indexOf(e);if(o!==-1)return o;o=this.modals.length,this.modals.push(e),e.modalRef&&Hb(e.modalRef,!1);const s=Cpe(a);A7(a,e.mount,e.modalRef,s,!0);const c=e4(this.containers,d=>d.container===a);return c!==-1?(this.containers[c].modals.push(e),o):(this.containers.push({modals:[e],container:a,restore:null,hiddenSiblings:s}),o)}mount(e,a){const o=e4(this.containers,c=>c.modals.indexOf(e)!==-1),s=this.containers[o];s.restore||(s.restore=Tpe(s,a))}remove(e,a=!0){const o=this.modals.indexOf(e);if(o===-1)return o;const s=e4(this.containers,d=>d.modals.indexOf(e)!==-1),c=this.containers[s];if(c.modals.splice(c.modals.indexOf(e),1),this.modals.splice(o,1),c.modals.length===0)c.restore&&c.restore(),e.modalRef&&Hb(e.modalRef,a),A7(c.container,e.mount,e.modalRef,c.hiddenSiblings,!1),this.containers.splice(s,1);else{const d=c.modals[c.modals.length-1];d.modalRef&&Hb(d.modalRef,!1)}return o}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function Ipe(n){return typeof n=="function"?n():n}function Lpe(n){return n?n.props.hasOwnProperty("in"):!1}const Rpe=new Ppe;function kpe(n){const{container:e,disableEscapeKeyDown:a=!1,disableScrollLock:o=!1,manager:s=Rpe,closeAfterTransition:c=!1,onTransitionEnter:d,onTransitionExited:f,children:m,onClose:y,open:_,rootRef:w}=n,A=re.useRef({}),C=re.useRef(null),I=re.useRef(null),k=xs(I,w),[D,L]=re.useState(!_),O=Lpe(m);let F=!0;(n["aria-hidden"]==="false"||n["aria-hidden"]===!1)&&(F=!1);const B=()=>bl(C.current),G=()=>(A.current.modalRef=I.current,A.current.mount=C.current,A.current),q=()=>{s.mount(G(),{disableScrollLock:o}),I.current&&(I.current.scrollTop=0)},X=sg(()=>{const Re=Ipe(e)||B().body;s.add(G(),Re),I.current&&q()}),ee=re.useCallback(()=>s.isTopModal(G()),[s]),V=sg(Re=>{C.current=Re,Re&&(_&&ee()?q():I.current&&Hb(I.current,F))}),Q=re.useCallback(()=>{s.remove(G(),F)},[F,s]);re.useEffect(()=>()=>{Q()},[Q]),re.useEffect(()=>{_?X():(!O||!c)&&Q()},[_,Q,O,c,X]);const me=Re=>He=>{var ue;(ue=Re.onKeyDown)==null||ue.call(Re,He),!(He.key!=="Escape"||He.which===229||!ee())&&(a||(He.stopPropagation(),y&&y(He,"escapeKeyDown")))},pe=Re=>He=>{var ue;(ue=Re.onClick)==null||ue.call(Re,He),He.target===He.currentTarget&&y&&y(He,"backdropClick")};return{getRootProps:(Re={})=>{const He=iX(n);delete He.onTransitionEnter,delete He.onTransitionExited;const ue=rt({},He,Re);return rt({role:"presentation"},ue,{onKeyDown:me(ue),ref:k})},getBackdropProps:(Re={})=>{const He=Re;return rt({"aria-hidden":!0},He,{onClick:pe(He),open:_})},getTransitionProps:()=>{const Re=()=>{L(!1),d&&d()},He=()=>{L(!0),f&&f(),c&&Q()};return{onEnter:bL(Re,m==null?void 0:m.props.onEnter),onExited:bL(He,m==null?void 0:m.props.onExited)}},rootRef:k,portalRef:V,isTopModal:ee,exited:D,hasTransition:O}}const Dpe=["onChange","maxRows","minRows","style","value"];function tS(n){return parseInt(n,10)||0}const Ope={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function E7(n){return n==null||Object.keys(n).length===0||n.outerHeightStyle===0&&!n.overflow}const zpe=re.forwardRef(function(e,a){const{onChange:o,maxRows:s,minRows:c=1,style:d,value:f}=e,m=ba(e,Dpe),{current:y}=re.useRef(f!=null),_=re.useRef(null),w=xs(a,_),A=re.useRef(null),C=re.useRef(0),[I,k]=re.useState({outerHeightStyle:0}),D=re.useCallback(()=>{const B=_.current,q=gp(B).getComputedStyle(B);if(q.width==="0px")return{outerHeightStyle:0};const X=A.current;X.style.width=q.width,X.value=B.value||e.placeholder||"x",X.value.slice(-1)===`
`&&(X.value+=" ");const ee=q.boxSizing,V=tS(q.paddingBottom)+tS(q.paddingTop),Q=tS(q.borderBottomWidth)+tS(q.borderTopWidth),me=X.scrollHeight;X.value="x";const pe=X.scrollHeight;let be=me;c&&(be=Math.max(Number(c)*pe,be)),s&&(be=Math.min(Number(s)*pe,be)),be=Math.max(be,pe);const fe=be+(ee==="border-box"?V+Q:0),Ce=Math.abs(be-me)<=1;return{outerHeightStyle:fe,overflow:Ce}},[s,c,e.placeholder]),L=(B,G)=>{const{outerHeightStyle:q,overflow:X}=G;return C.current<20&&(q>0&&Math.abs((B.outerHeightStyle||0)-q)>1||B.overflow!==X)?(C.current+=1,{overflow:X,outerHeightStyle:q}):B},O=re.useCallback(()=>{const B=D();E7(B)||k(G=>L(G,B))},[D]);Oh(()=>{const B=()=>{const me=D();E7(me)||gw.flushSync(()=>{k(pe=>L(pe,me))})},G=()=>{C.current=0,B()};let q;const X=Yk(G),ee=_.current,V=gp(ee);V.addEventListener("resize",X);let Q;return typeof ResizeObserver<"u"&&(Q=new ResizeObserver(G),Q.observe(ee)),()=>{X.clear(),cancelAnimationFrame(q),V.removeEventListener("resize",X),Q&&Q.disconnect()}},[D]),Oh(()=>{O()}),re.useEffect(()=>{C.current=0},[f]);const F=B=>{C.current=0,y||O(),o&&o(B)};return Bt(re.Fragment,{children:[he("textarea",rt({value:f,onChange:F,ref:w,rows:c,style:rt({height:I.outerHeightStyle,overflow:I.overflow?"hidden":void 0},d)},m)),he("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:A,tabIndex:-1,style:rt({},Ope.shadow,d,{paddingTop:0,paddingBottom:0})})]})});function Sw({props:n,states:e,muiFormControl:a}){return e.reduce((o,s)=>(o[s]=n[s],a&&typeof n[s]>"u"&&(o[s]=a[s]),o),{})}const Fpe=re.createContext(void 0),vD=Fpe;function c_(){return re.useContext(vD)}function Npe(n){return he(vhe,rt({},n,{defaultTheme:lT,themeId:G0}))}function M7(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function FE(n,e=!1){return n&&(M7(n.value)&&n.value!==""||e&&M7(n.defaultValue)&&n.defaultValue!=="")}function Bpe(n){return n.startAdornment}function Upe(n){return ur("MuiInputBase",n)}const Wpe=Wi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),$0=Wpe,Vpe=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],dT=(n,e)=>{const{ownerState:a}=n;return[e.root,a.formControl&&e.formControl,a.startAdornment&&e.adornedStart,a.endAdornment&&e.adornedEnd,a.error&&e.error,a.size==="small"&&e.sizeSmall,a.multiline&&e.multiline,a.color&&e[`color${Pa(a.color)}`],a.fullWidth&&e.fullWidth,a.hiddenLabel&&e.hiddenLabel]},hT=(n,e)=>{const{ownerState:a}=n;return[e.input,a.size==="small"&&e.inputSizeSmall,a.multiline&&e.inputMultiline,a.type==="search"&&e.inputTypeSearch,a.startAdornment&&e.inputAdornedStart,a.endAdornment&&e.inputAdornedEnd,a.hiddenLabel&&e.inputHiddenLabel]},Gpe=n=>{const{classes:e,color:a,disabled:o,error:s,endAdornment:c,focused:d,formControl:f,fullWidth:m,hiddenLabel:y,multiline:_,readOnly:w,size:A,startAdornment:C,type:I}=n,k={root:["root",`color${Pa(a)}`,o&&"disabled",s&&"error",m&&"fullWidth",d&&"focused",f&&"formControl",A&&A!=="medium"&&`size${Pa(A)}`,_&&"multiline",C&&"adornedStart",c&&"adornedEnd",y&&"hiddenLabel",w&&"readOnly"],input:["input",o&&"disabled",I==="search"&&"inputTypeSearch",_&&"inputMultiline",A==="small"&&"inputSizeSmall",y&&"inputHiddenLabel",C&&"inputAdornedStart",c&&"inputAdornedEnd",w&&"readOnly"]};return vr(k,Upe,e)},fT=ha("div",{name:"MuiInputBase",slot:"Root",overridesResolver:dT})(({theme:n,ownerState:e})=>rt({},n.typography.body1,{color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${$0.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"}},e.multiline&&rt({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),pT=ha("input",{name:"MuiInputBase",slot:"Input",overridesResolver:hT})(({theme:n,ownerState:e})=>{const a=n.palette.mode==="light",o=rt({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),s={opacity:"0 !important"},c=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5};return rt({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${$0.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":c,"&:focus::-moz-placeholder":c,"&:focus:-ms-input-placeholder":c,"&:focus::-ms-input-placeholder":c},[`&.${$0.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),Hpe=he(Npe,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),jpe=re.forwardRef(function(e,a){var o;const s=kr({props:e,name:"MuiInputBase"}),{"aria-describedby":c,autoComplete:d,autoFocus:f,className:m,components:y={},componentsProps:_={},defaultValue:w,disabled:A,disableInjectingGlobalStyles:C,endAdornment:I,fullWidth:k=!1,id:D,inputComponent:L="input",inputProps:O={},inputRef:F,maxRows:B,minRows:G,multiline:q=!1,name:X,onBlur:ee,onChange:V,onClick:Q,onFocus:me,onKeyDown:pe,onKeyUp:be,placeholder:fe,readOnly:Ce,renderSuffix:Re,rows:He,slotProps:ue={},slots:ye={},startAdornment:Ae,type:ne="text",value:Ee}=s,Ye=ba(s,Vpe),Xe=O.value!=null?O.value:Ee,{current:Ke}=re.useRef(Xe!=null),Ue=re.useRef(),ht=re.useCallback(st=>{},[]),Lt=xs(Ue,F,O.ref,ht),[Rt,Jt]=re.useState(!1),Pt=c_(),Pe=Sw({props:s,muiFormControl:Pt,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Pe.focused=Pt?Pt.focused:Rt,re.useEffect(()=>{!Pt&&A&&Rt&&(Jt(!1),ee&&ee())},[Pt,A,Rt,ee]);const ft=Pt&&Pt.onFilled,gt=Pt&&Pt.onEmpty,St=re.useCallback(st=>{FE(st)?ft&&ft():gt&&gt()},[ft,gt]);Oh(()=>{Ke&&St({value:Xe})},[Xe,St,Ke]);const Be=st=>{if(Pe.disabled){st.stopPropagation();return}me&&me(st),O.onFocus&&O.onFocus(st),Pt&&Pt.onFocus?Pt.onFocus(st):Jt(!0)},le=st=>{ee&&ee(st),O.onBlur&&O.onBlur(st),Pt&&Pt.onBlur?Pt.onBlur(st):Jt(!1)},oe=(st,...At)=>{if(!Ke){const Ut=st.target||Ue.current;if(Ut==null)throw new Error(mp(1));St({value:Ut.value})}O.onChange&&O.onChange(st,...At),V&&V(st,...At)};re.useEffect(()=>{St(Ue.current)},[]);const ve=st=>{Ue.current&&st.currentTarget===st.target&&Ue.current.focus(),Q&&Q(st)};let $e=L,De=O;q&&$e==="input"&&(He?De=rt({type:void 0,minRows:He,maxRows:He},De):De=rt({type:void 0,maxRows:B,minRows:G},De),$e=zpe);const ot=st=>{St(st.animationName==="mui-auto-fill-cancel"?Ue.current:{value:"x"})};re.useEffect(()=>{Pt&&Pt.setAdornedStart(!!Ae)},[Pt,Ae]);const ce=rt({},s,{color:Pe.color||"primary",disabled:Pe.disabled,endAdornment:I,error:Pe.error,focused:Pe.focused,formControl:Pt,fullWidth:k,hiddenLabel:Pe.hiddenLabel,multiline:q,size:Pe.size,startAdornment:Ae,type:ne}),te=Gpe(ce),Oe=ye.root||y.Root||fT,pt=ue.root||_.root||{},it=ye.input||y.Input||pT;return De=rt({},De,(o=ue.input)!=null?o:_.input),Bt(re.Fragment,{children:[!C&&Hpe,Bt(Oe,rt({},pt,!zE(Oe)&&{ownerState:rt({},ce,pt.ownerState)},{ref:a,onClick:ve},Ye,{className:Ga(te.root,pt.className,m,Ce&&"MuiInputBase-readOnly"),children:[Ae,he(vD.Provider,{value:null,children:he(it,rt({ownerState:ce,"aria-invalid":Pe.error,"aria-describedby":c,autoComplete:d,autoFocus:f,defaultValue:w,disabled:Pe.disabled,id:D,onAnimationStart:ot,name:X,placeholder:fe,readOnly:Ce,required:Pe.required,rows:He,value:Xe,onKeyDown:pe,onKeyUp:be,type:ne},De,!zE(it)&&{as:$e,ownerState:rt({},ce,De.ownerState)},{ref:Lt,className:Ga(te.input,De.className,Ce&&"MuiInputBase-readOnly"),onBlur:le,onChange:oe,onFocus:Be}))}),I,Re?Re(rt({},Pe,{startAdornment:Ae})):null]}))]})}),_D=jpe;function $pe(n){return ur("MuiInput",n)}const qpe=rt({},$0,Wi("MuiInput",["root","underline","input"])),$1=qpe;function Xpe(n){return ur("MuiOutlinedInput",n)}const Zpe=rt({},$0,Wi("MuiOutlinedInput",["root","notchedOutline","input"])),Lf=Zpe;function Ype(n){return ur("MuiFilledInput",n)}const Kpe=rt({},$0,Wi("MuiFilledInput",["root","underline","input"])),Im=Kpe,Jpe=eX(he("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),Qpe=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],eme={entering:{opacity:1},entered:{opacity:1}},tme=re.forwardRef(function(e,a){const o=ww(),s={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:c,appear:d=!0,children:f,easing:m,in:y,onEnter:_,onEntered:w,onEntering:A,onExit:C,onExited:I,onExiting:k,style:D,timeout:L=s,TransitionComponent:O=nX}=e,F=ba(e,Qpe),B=re.useRef(null),G=xs(B,f.ref,a),q=fe=>Ce=>{if(fe){const Re=B.current;Ce===void 0?fe(Re):fe(Re,Ce)}},X=q(A),ee=q((fe,Ce)=>{aX(fe);const Re=OE({style:D,timeout:L,easing:m},{mode:"enter"});fe.style.webkitTransition=o.transitions.create("opacity",Re),fe.style.transition=o.transitions.create("opacity",Re),_&&_(fe,Ce)}),V=q(w),Q=q(k),me=q(fe=>{const Ce=OE({style:D,timeout:L,easing:m},{mode:"exit"});fe.style.webkitTransition=o.transitions.create("opacity",Ce),fe.style.transition=o.transitions.create("opacity",Ce),C&&C(fe)}),pe=q(I);return he(O,rt({appear:d,in:y,nodeRef:B,onEnter:ee,onEntered:V,onEntering:X,onExit:me,onExited:pe,onExiting:Q,addEndListener:fe=>{c&&c(B.current,fe)},timeout:L},F,{children:(fe,Ce)=>re.cloneElement(f,rt({style:rt({opacity:0,visibility:fe==="exited"&&!y?"hidden":void 0},eme[fe],D,f.props.style),ref:G},Ce))}))}),nme=tme;function ame(n){return ur("MuiBackdrop",n)}Wi("MuiBackdrop",["root","invisible"]);const ime=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],rme=n=>{const{classes:e,invisible:a}=n;return vr({root:["root",a&&"invisible"]},ame,e)},ome=ha("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.invisible&&e.invisible]}})(({ownerState:n})=>rt({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},n.invisible&&{backgroundColor:"transparent"})),sme=re.forwardRef(function(e,a){var o,s,c;const d=kr({props:e,name:"MuiBackdrop"}),{children:f,className:m,component:y="div",components:_={},componentsProps:w={},invisible:A=!1,open:C,slotProps:I={},slots:k={},TransitionComponent:D=nme,transitionDuration:L}=d,O=ba(d,ime),F=rt({},d,{component:y,invisible:A}),B=rme(F),G=(o=I.root)!=null?o:w.root;return he(D,rt({in:C,timeout:L},O,{children:he(ome,rt({"aria-hidden":!0},G,{as:(s=(c=k.root)!=null?c:_.Root)!=null?s:y,className:Ga(B.root,m,G==null?void 0:G.className),ownerState:rt({},F,G==null?void 0:G.ownerState),classes:B,ref:a,children:f}))}))}),lme=sme;function cme(n){return ur("MuiButton",n)}const ume=Wi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),nS=ume,dme=re.createContext({}),hme=dme,fme=re.createContext(void 0),pme=fme,mme=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],gme=n=>{const{color:e,disableElevation:a,fullWidth:o,size:s,variant:c,classes:d}=n,f={root:["root",c,`${c}${Pa(e)}`,`size${Pa(s)}`,`${c}Size${Pa(s)}`,e==="inherit"&&"colorInherit",a&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${Pa(s)}`],endIcon:["endIcon",`iconSize${Pa(s)}`]},m=vr(f,cme,d);return rt({},d,m)},rX=n=>rt({},n.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},n.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},n.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),yme=ha(uT,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[a.variant],e[`${a.variant}${Pa(a.color)}`],e[`size${Pa(a.size)}`],e[`${a.variant}Size${Pa(a.size)}`],a.color==="inherit"&&e.colorInherit,a.disableElevation&&e.disableElevation,a.fullWidth&&e.fullWidth]}})(({theme:n,ownerState:e})=>{var a,o;const s=n.palette.mode==="light"?n.palette.grey[300]:n.palette.grey[800],c=n.palette.mode==="light"?n.palette.grey.A100:n.palette.grey[700];return rt({},n.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":rt({textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(n.vars||n).palette[e.color].main}`,backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:n.vars?n.vars.palette.Button.inheritContainedHoverBg:c,boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2],backgroundColor:(n.vars||n).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(n.vars||n).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[e.color].main}}),"&:active":rt({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[8]}),[`&.${nS.focusVisible}`]:rt({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[6]}),[`&.${nS.disabled}`]:rt({color:(n.vars||n).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main,border:n.vars?`1px solid rgba(${n.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${gs(n.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:n.vars?n.vars.palette.text.primary:(a=(o=n.palette).getContrastText)==null?void 0:a.call(o,n.palette.grey[300]),backgroundColor:n.vars?n.vars.palette.Button.inheritContainedBg:s,boxShadow:(n.vars||n).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].contrastText,backgroundColor:(n.vars||n).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:n.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:n})=>n.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${nS.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${nS.disabled}`]:{boxShadow:"none"}}),vme=ha("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.startIcon,e[`iconSize${Pa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inherit",marginRight:8,marginLeft:-4},n.size==="small"&&{marginLeft:-2},rX(n))),_me=ha("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.endIcon,e[`iconSize${Pa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inherit",marginRight:-4,marginLeft:8},n.size==="small"&&{marginRight:-2},rX(n))),bme=re.forwardRef(function(e,a){const o=re.useContext(hme),s=re.useContext(pme),c=Kk(o,e),d=kr({props:c,name:"MuiButton"}),{children:f,color:m="primary",component:y="button",className:_,disabled:w=!1,disableElevation:A=!1,disableFocusRipple:C=!1,endIcon:I,focusVisibleClassName:k,fullWidth:D=!1,size:L="medium",startIcon:O,type:F,variant:B="text"}=d,G=ba(d,mme),q=rt({},d,{color:m,component:y,disabled:w,disableElevation:A,disableFocusRipple:C,fullWidth:D,size:L,type:F,variant:B}),X=gme(q),ee=O&&he(vme,{className:X.startIcon,ownerState:q,children:O}),V=I&&he(_me,{className:X.endIcon,ownerState:q,children:I}),Q=s||"";return Bt(yme,rt({ownerState:q,className:Ga(o.className,X.root,_,Q),component:y,disabled:w,focusRipple:!C,focusVisibleClassName:Ga(X.focusVisible,k),ref:a,type:F},G,{classes:X,children:[ee,f,V]}))}),Vs=bme;function xme(n){return ur("PrivateSwitchBase",n)}Wi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const wme=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Sme=n=>{const{classes:e,checked:a,disabled:o,edge:s}=n,c={root:["root",a&&"checked",o&&"disabled",s&&`edge${Pa(s)}`],input:["input"]};return vr(c,xme,e)},Ame=ha(uT)(({ownerState:n})=>rt({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),Eme=ha("input",{shouldForwardProp:Kl})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Mme=re.forwardRef(function(e,a){const{autoFocus:o,checked:s,checkedIcon:c,className:d,defaultChecked:f,disabled:m,disableFocusRipple:y=!1,edge:_=!1,icon:w,id:A,inputProps:C,inputRef:I,name:k,onBlur:D,onChange:L,onFocus:O,readOnly:F,required:B=!1,tabIndex:G,type:q,value:X}=e,ee=ba(e,wme),[V,Q]=PE({controlled:s,default:!!f,name:"SwitchBase",state:"checked"}),me=c_(),pe=ye=>{O&&O(ye),me&&me.onFocus&&me.onFocus(ye)},be=ye=>{D&&D(ye),me&&me.onBlur&&me.onBlur(ye)},fe=ye=>{if(ye.nativeEvent.defaultPrevented)return;const Ae=ye.target.checked;Q(Ae),L&&L(ye,Ae)};let Ce=m;me&&typeof Ce>"u"&&(Ce=me.disabled);const Re=q==="checkbox"||q==="radio",He=rt({},e,{checked:V,disabled:Ce,disableFocusRipple:y,edge:_}),ue=Sme(He);return Bt(Ame,rt({component:"span",className:Ga(ue.root,d),centerRipple:!0,focusRipple:!y,disabled:Ce,tabIndex:null,role:void 0,onFocus:pe,onBlur:be,ownerState:He,ref:a},ee,{children:[he(Eme,rt({autoFocus:o,checked:s,defaultChecked:f,className:ue.input,disabled:Ce,id:Re?A:void 0,name:k,onChange:fe,readOnly:F,ref:I,required:B,ownerState:He,tabIndex:G,type:q},q==="checkbox"&&X===void 0?{}:{value:X},C)),V?c:w]}))}),Tme=Mme;function Cme(n){return ur("MuiModal",n)}Wi("MuiModal",["root","hidden","backdrop"]);const Pme=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Ime=n=>{const{open:e,exited:a,classes:o}=n;return vr({root:["root",!e&&a&&"hidden"],backdrop:["backdrop"]},Cme,o)},Lme=ha("div",{name:"MuiModal",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,!a.open&&a.exited&&e.hidden]}})(({theme:n,ownerState:e})=>rt({position:"fixed",zIndex:(n.vars||n).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Rme=ha(lme,{name:"MuiModal",slot:"Backdrop",overridesResolver:(n,e)=>e.backdrop})({zIndex:-1}),kme=re.forwardRef(function(e,a){var o,s,c,d,f,m;const y=kr({name:"MuiModal",props:e}),{BackdropComponent:_=Rme,BackdropProps:w,className:A,closeAfterTransition:C=!1,children:I,container:k,component:D,components:L={},componentsProps:O={},disableAutoFocus:F=!1,disableEnforceFocus:B=!1,disableEscapeKeyDown:G=!1,disablePortal:q=!1,disableRestoreFocus:X=!1,disableScrollLock:ee=!1,hideBackdrop:V=!1,keepMounted:Q=!1,onBackdropClick:me,open:pe,slotProps:be,slots:fe}=y,Ce=ba(y,Pme),Re=rt({},y,{closeAfterTransition:C,disableAutoFocus:F,disableEnforceFocus:B,disableEscapeKeyDown:G,disablePortal:q,disableRestoreFocus:X,disableScrollLock:ee,hideBackdrop:V,keepMounted:Q}),{getRootProps:He,getBackdropProps:ue,getTransitionProps:ye,portalRef:Ae,isTopModal:ne,exited:Ee,hasTransition:Ye}=kpe(rt({},Re,{rootRef:a})),Xe=rt({},Re,{exited:Ee}),Ke=Ime(Xe),Ue={};if(I.props.tabIndex===void 0&&(Ue.tabIndex="-1"),Ye){const{onEnter:ft,onExited:gt}=ye();Ue.onEnter=ft,Ue.onExited=gt}const ht=(o=(s=fe==null?void 0:fe.root)!=null?s:L.Root)!=null?o:Lme,Lt=(c=(d=fe==null?void 0:fe.backdrop)!=null?d:L.Backdrop)!=null?c:_,Rt=(f=be==null?void 0:be.root)!=null?f:O.root,Jt=(m=be==null?void 0:be.backdrop)!=null?m:O.backdrop,Pt=j0({elementType:ht,externalSlotProps:Rt,externalForwardedProps:Ce,getSlotProps:He,additionalProps:{ref:a,as:D},ownerState:Xe,className:Ga(A,Rt==null?void 0:Rt.className,Ke==null?void 0:Ke.root,!Xe.open&&Xe.exited&&(Ke==null?void 0:Ke.hidden))}),Pe=j0({elementType:Lt,externalSlotProps:Jt,additionalProps:w,getSlotProps:ft=>ue(rt({},ft,{onClick:gt=>{me&&me(gt),ft!=null&&ft.onClick&&ft.onClick(gt)}})),className:Ga(Jt==null?void 0:Jt.className,w==null?void 0:w.className,Ke==null?void 0:Ke.backdrop),ownerState:Xe});return!Q&&!pe&&(!Ye||Ee)?null:he(Ape,{ref:Ae,container:k,disablePortal:q,children:Bt(ht,rt({},Pt,{children:[!V&&_?he(Lt,rt({},Pe)):null,he(wpe,{disableEnforceFocus:B,disableAutoFocus:F,disableRestoreFocus:X,isEnabled:ne,open:pe,children:re.cloneElement(I,Ue)})]}))})}),Dme=kme,Ome=Wi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),T7=Ome,zme=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Fme=n=>{const{classes:e,disableUnderline:a}=n,s=vr({root:["root",!a&&"underline"],input:["input"]},Ype,e);return rt({},e,s)},Nme=ha(fT,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[...dT(n,e),!a.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{var a;const o=n.palette.mode==="light",s=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",c=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",d=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",f=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return rt({position:"relative",backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:d,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c}},[`&.${Im.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c},[`&.${Im.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:f}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(a=(n.vars||n).palette[e.color||"primary"])==null?void 0:a.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Im.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Im.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Im.disabled}, .${Im.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${Im.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&rt({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),Bme=ha(pT,{name:"MuiFilledInput",slot:"Input",overridesResolver:hT})(({theme:n,ownerState:e})=>rt({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),oX=re.forwardRef(function(e,a){var o,s,c,d;const f=kr({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:y,fullWidth:_=!1,inputComponent:w="input",multiline:A=!1,slotProps:C,slots:I={},type:k="text"}=f,D=ba(f,zme),L=rt({},f,{fullWidth:_,inputComponent:w,multiline:A,type:k}),O=Fme(f),F={root:{ownerState:L},input:{ownerState:L}},B=C??y?_l(C??y,F):F,G=(o=(s=I.root)!=null?s:m.Root)!=null?o:Nme,q=(c=(d=I.input)!=null?d:m.Input)!=null?c:Bme;return he(_D,rt({slots:{root:G,input:q},componentsProps:B,fullWidth:_,inputComponent:w,multiline:A,ref:a,type:k},D,{classes:O}))});oX.muiName="Input";const Ume=oX;function Wme(n){return ur("MuiFormControl",n)}Wi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Vme=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Gme=n=>{const{classes:e,margin:a,fullWidth:o}=n,s={root:["root",a!=="none"&&`margin${Pa(a)}`,o&&"fullWidth"]};return vr(s,Wme,e)},Hme=ha("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:n},e)=>rt({},e.root,e[`margin${Pa(n.margin)}`],n.fullWidth&&e.fullWidth)})(({ownerState:n})=>rt({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},n.margin==="normal"&&{marginTop:16,marginBottom:8},n.margin==="dense"&&{marginTop:8,marginBottom:4},n.fullWidth&&{width:"100%"})),jme=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiFormControl"}),{children:s,className:c,color:d="primary",component:f="div",disabled:m=!1,error:y=!1,focused:_,fullWidth:w=!1,hiddenLabel:A=!1,margin:C="none",required:I=!1,size:k="medium",variant:D="outlined"}=o,L=ba(o,Vme),O=rt({},o,{color:d,component:f,disabled:m,error:y,fullWidth:w,hiddenLabel:A,margin:C,required:I,size:k,variant:D}),F=Gme(O),[B,G]=re.useState(()=>{let be=!1;return s&&re.Children.forEach(s,fe=>{if(!IA(fe,["Input","Select"]))return;const Ce=IA(fe,["Select"])?fe.props.input:fe;Ce&&Bpe(Ce.props)&&(be=!0)}),be}),[q,X]=re.useState(()=>{let be=!1;return s&&re.Children.forEach(s,fe=>{IA(fe,["Input","Select"])&&(FE(fe.props,!0)||FE(fe.props.inputProps,!0))&&(be=!0)}),be}),[ee,V]=re.useState(!1);m&&ee&&V(!1);const Q=_!==void 0&&!m?_:ee;let me;const pe=re.useMemo(()=>({adornedStart:B,setAdornedStart:G,color:d,disabled:m,error:y,filled:q,focused:Q,fullWidth:w,hiddenLabel:A,size:k,onBlur:()=>{V(!1)},onEmpty:()=>{X(!1)},onFilled:()=>{X(!0)},onFocus:()=>{V(!0)},registerEffect:me,required:I,variant:D}),[B,d,m,y,q,Q,w,A,me,I,k,D]);return he(vD.Provider,{value:pe,children:he(Hme,rt({as:f,ownerState:O,className:Ga(F.root,c),ref:a},L,{children:s}))})}),$me=jme;function qme(n){return ur("MuiFormLabel",n)}const Xme=Wi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),jb=Xme,Zme=["children","className","color","component","disabled","error","filled","focused","required"],Yme=n=>{const{classes:e,color:a,focused:o,disabled:s,error:c,filled:d,required:f}=n,m={root:["root",`color${Pa(a)}`,s&&"disabled",c&&"error",d&&"filled",o&&"focused",f&&"required"],asterisk:["asterisk",c&&"error"]};return vr(m,qme,e)},Kme=ha("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:n},e)=>rt({},e.root,n.color==="secondary"&&e.colorSecondary,n.filled&&e.filled)})(({theme:n,ownerState:e})=>rt({color:(n.vars||n).palette.text.secondary},n.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${jb.focused}`]:{color:(n.vars||n).palette[e.color].main},[`&.${jb.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${jb.error}`]:{color:(n.vars||n).palette.error.main}})),Jme=ha("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(n,e)=>e.asterisk})(({theme:n})=>({[`&.${jb.error}`]:{color:(n.vars||n).palette.error.main}})),Qme=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiFormLabel"}),{children:s,className:c,component:d="label"}=o,f=ba(o,Zme),m=c_(),y=Sw({props:o,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),_=rt({},o,{color:y.color||"primary",component:d,disabled:y.disabled,error:y.error,filled:y.filled,focused:y.focused,required:y.required}),w=Yme(_);return Bt(Kme,rt({as:d,ownerState:_,className:Ga(w.root,c),ref:a},f,{children:[s,y.required&&Bt(Jme,{ownerState:_,"aria-hidden":!0,className:w.asterisk,children:["","*"]})]}))}),ege=Qme,tge=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function CL(n){return`scale(${n}, ${n**2})`}const nge={entering:{opacity:1,transform:CL(1)},entered:{opacity:1,transform:"none"}},t4=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),sX=re.forwardRef(function(e,a){const{addEndListener:o,appear:s=!0,children:c,easing:d,in:f,onEnter:m,onEntered:y,onEntering:_,onExit:w,onExited:A,onExiting:C,style:I,timeout:k="auto",TransitionComponent:D=nX}=e,L=ba(e,tge),O=re.useRef(),F=re.useRef(),B=ww(),G=re.useRef(null),q=xs(G,c.ref,a),X=Ce=>Re=>{if(Ce){const He=G.current;Re===void 0?Ce(He):Ce(He,Re)}},ee=X(_),V=X((Ce,Re)=>{aX(Ce);const{duration:He,delay:ue,easing:ye}=OE({style:I,timeout:k,easing:d},{mode:"enter"});let Ae;k==="auto"?(Ae=B.transitions.getAutoHeightDuration(Ce.clientHeight),F.current=Ae):Ae=He,Ce.style.transition=[B.transitions.create("opacity",{duration:Ae,delay:ue}),B.transitions.create("transform",{duration:t4?Ae:Ae*.666,delay:ue,easing:ye})].join(","),m&&m(Ce,Re)}),Q=X(y),me=X(C),pe=X(Ce=>{const{duration:Re,delay:He,easing:ue}=OE({style:I,timeout:k,easing:d},{mode:"exit"});let ye;k==="auto"?(ye=B.transitions.getAutoHeightDuration(Ce.clientHeight),F.current=ye):ye=Re,Ce.style.transition=[B.transitions.create("opacity",{duration:ye,delay:He}),B.transitions.create("transform",{duration:t4?ye:ye*.666,delay:t4?He:He||ye*.333,easing:ue})].join(","),Ce.style.opacity=0,Ce.style.transform=CL(.75),w&&w(Ce)}),be=X(A),fe=Ce=>{k==="auto"&&(O.current=setTimeout(Ce,F.current||0)),o&&o(G.current,Ce)};return re.useEffect(()=>()=>{clearTimeout(O.current)},[]),he(D,rt({appear:s,in:f,nodeRef:G,onEnter:V,onEntered:Q,onEntering:ee,onExit:pe,onExited:be,onExiting:me,addEndListener:fe,timeout:k==="auto"?null:k},L,{children:(Ce,Re)=>re.cloneElement(c,rt({style:rt({opacity:0,transform:CL(.75),visibility:Ce==="exited"&&!f?"hidden":void 0},nge[Ce],I,c.props.style),ref:q},Re))}))});sX.muiSupportAuto=!0;const age=sX,ige=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],rge=n=>{const{classes:e,disableUnderline:a}=n,s=vr({root:["root",!a&&"underline"],input:["input"]},$pe,e);return rt({},e,s)},oge=ha(fT,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[...dT(n,e),!a.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{let o=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(o=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),rt({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n.vars||n).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${$1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${$1.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${o}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${$1.disabled}, .${$1.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${o}`}},[`&.${$1.disabled}:before`]:{borderBottomStyle:"dotted"}})}),sge=ha(pT,{name:"MuiInput",slot:"Input",overridesResolver:hT})({}),lX=re.forwardRef(function(e,a){var o,s,c,d;const f=kr({props:e,name:"MuiInput"}),{disableUnderline:m,components:y={},componentsProps:_,fullWidth:w=!1,inputComponent:A="input",multiline:C=!1,slotProps:I,slots:k={},type:D="text"}=f,L=ba(f,ige),O=rge(f),B={root:{ownerState:{disableUnderline:m}}},G=I??_?_l(I??_,B):B,q=(o=(s=k.root)!=null?s:y.Root)!=null?o:oge,X=(c=(d=k.input)!=null?d:y.Input)!=null?c:sge;return he(_D,rt({slots:{root:q,input:X},slotProps:G,fullWidth:w,inputComponent:A,multiline:C,ref:a,type:D},L,{classes:O}))});lX.muiName="Input";const lge=lX;function cge(n){return ur("MuiInputLabel",n)}Wi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const uge=["disableAnimation","margin","shrink","variant","className"],dge=n=>{const{classes:e,formControl:a,size:o,shrink:s,disableAnimation:c,variant:d,required:f}=n,m={root:["root",a&&"formControl",!c&&"animated",s&&"shrink",o&&o!=="normal"&&`size${Pa(o)}`,d],asterisk:[f&&"asterisk"]},y=vr(m,cge,e);return rt({},e,y)},hge=ha(ege,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`& .${jb.asterisk}`]:e.asterisk},e.root,a.formControl&&e.formControl,a.size==="small"&&e.sizeSmall,a.shrink&&e.shrink,!a.disableAnimation&&e.animated,a.focused&&e.focused,e[a.variant]]}})(({theme:n,ownerState:e})=>rt({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:n.transitions.create(["color","transform","max-width"],{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut})},e.variant==="filled"&&rt({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&rt({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&rt({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),fge=re.forwardRef(function(e,a){const o=kr({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:c,className:d}=o,f=ba(o,uge),m=c_();let y=c;typeof y>"u"&&m&&(y=m.filled||m.focused||m.adornedStart);const _=Sw({props:o,muiFormControl:m,states:["size","variant","required","focused"]}),w=rt({},o,{disableAnimation:s,formControl:m,shrink:y,size:_.size,variant:_.variant,required:_.required,focused:_.focused}),A=dge(w);return he(hge,rt({"data-shrink":y,ownerState:w,ref:a,className:Ga(A.root,d)},f,{classes:A}))}),pge=fge,mge=re.createContext({}),PL=mge;function gge(n){return ur("MuiList",n)}Wi("MuiList",["root","padding","dense","subheader"]);const yge=["children","className","component","dense","disablePadding","subheader"],vge=n=>{const{classes:e,disablePadding:a,dense:o,subheader:s}=n;return vr({root:["root",!a&&"padding",o&&"dense",s&&"subheader"]},gge,e)},_ge=ha("ul",{name:"MuiList",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,!a.disablePadding&&e.padding,a.dense&&e.dense,a.subheader&&e.subheader]}})(({ownerState:n})=>rt({listStyle:"none",margin:0,padding:0,position:"relative"},!n.disablePadding&&{paddingTop:8,paddingBottom:8},n.subheader&&{paddingTop:0})),bge=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiList"}),{children:s,className:c,component:d="ul",dense:f=!1,disablePadding:m=!1,subheader:y}=o,_=ba(o,yge),w=re.useMemo(()=>({dense:f}),[f]),A=rt({},o,{component:d,dense:f,disablePadding:m}),C=vge(A);return he(PL.Provider,{value:w,children:Bt(_ge,rt({as:d,className:Ga(C.root,c),ref:a,ownerState:A},_,{children:[y,s]}))})}),xge=bge,wge=Wi("MuiListItemIcon",["root","alignItemsFlexStart"]),C7=wge,Sge=Wi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),P7=Sge,Age=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function n4(n,e,a){return n===e?n.firstChild:e&&e.nextElementSibling?e.nextElementSibling:a?null:n.firstChild}function I7(n,e,a){return n===e?a?n.firstChild:n.lastChild:e&&e.previousElementSibling?e.previousElementSibling:a?null:n.lastChild}function cX(n,e){if(e===void 0)return!0;let a=n.innerText;return a===void 0&&(a=n.textContent),a=a.trim().toLowerCase(),a.length===0?!1:e.repeating?a[0]===e.keys[0]:a.indexOf(e.keys.join(""))===0}function q1(n,e,a,o,s,c){let d=!1,f=s(n,e,e?a:!1);for(;f;){if(f===n.firstChild){if(d)return!1;d=!0}const m=o?!1:f.disabled||f.getAttribute("aria-disabled")==="true";if(!f.hasAttribute("tabindex")||!cX(f,c)||m)f=s(n,f,a);else return f.focus(),!0}return!1}const Ege=re.forwardRef(function(e,a){const{actions:o,autoFocus:s=!1,autoFocusItem:c=!1,children:d,className:f,disabledItemsFocusable:m=!1,disableListWrap:y=!1,onKeyDown:_,variant:w="selectedMenu"}=e,A=ba(e,Age),C=re.useRef(null),I=re.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Oh(()=>{s&&C.current.focus()},[s]),re.useImperativeHandle(o,()=>({adjustStyleForScrollbar:(F,B)=>{const G=!C.current.style.width;if(F.clientHeight<C.current.clientHeight&&G){const q=`${xq(bl(F))}px`;C.current.style[B.direction==="rtl"?"paddingLeft":"paddingRight"]=q,C.current.style.width=`calc(100% + ${q})`}return C.current}}),[]);const k=F=>{const B=C.current,G=F.key,q=bl(B).activeElement;if(G==="ArrowDown")F.preventDefault(),q1(B,q,y,m,n4);else if(G==="ArrowUp")F.preventDefault(),q1(B,q,y,m,I7);else if(G==="Home")F.preventDefault(),q1(B,null,y,m,n4);else if(G==="End")F.preventDefault(),q1(B,null,y,m,I7);else if(G.length===1){const X=I.current,ee=G.toLowerCase(),V=performance.now();X.keys.length>0&&(V-X.lastTime>500?(X.keys=[],X.repeating=!0,X.previousKeyMatched=!0):X.repeating&&ee!==X.keys[0]&&(X.repeating=!1)),X.lastTime=V,X.keys.push(ee);const Q=q&&!X.repeating&&cX(q,X);X.previousKeyMatched&&(Q||q1(B,q,!1,m,n4,X))?F.preventDefault():X.previousKeyMatched=!1}_&&_(F)},D=xs(C,a);let L=-1;re.Children.forEach(d,(F,B)=>{if(!re.isValidElement(F)){L===B&&(L+=1,L>=d.length&&(L=-1));return}F.props.disabled||(w==="selectedMenu"&&F.props.selected||L===-1)&&(L=B),L===B&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(L+=1,L>=d.length&&(L=-1))});const O=re.Children.map(d,(F,B)=>{if(B===L){const G={};return c&&(G.autoFocus=!0),F.props.tabIndex===void 0&&w==="selectedMenu"&&(G.tabIndex=0),re.cloneElement(F,G)}return F});return he(xge,rt({role:"menu",ref:D,className:f,onKeyDown:k,tabIndex:s?0:-1},A,{children:O}))}),Mge=Ege;function Tge(n){return ur("MuiPopover",n)}Wi("MuiPopover",["root","paper"]);const Cge=["onEntering"],Pge=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Ige=["slotProps"];function L7(n,e){let a=0;return typeof e=="number"?a=e:e==="center"?a=n.height/2:e==="bottom"&&(a=n.height),a}function R7(n,e){let a=0;return typeof e=="number"?a=e:e==="center"?a=n.width/2:e==="right"&&(a=n.width),a}function k7(n){return[n.horizontal,n.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function a4(n){return typeof n=="function"?n():n}const Lge=n=>{const{classes:e}=n;return vr({root:["root"],paper:["paper"]},Tge,e)},Rge=ha(Dme,{name:"MuiPopover",slot:"Root",overridesResolver:(n,e)=>e.root})({}),uX=ha(Ufe,{name:"MuiPopover",slot:"Paper",overridesResolver:(n,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),kge=re.forwardRef(function(e,a){var o,s,c;const d=kr({props:e,name:"MuiPopover"}),{action:f,anchorEl:m,anchorOrigin:y={vertical:"top",horizontal:"left"},anchorPosition:_,anchorReference:w="anchorEl",children:A,className:C,container:I,elevation:k=8,marginThreshold:D=16,open:L,PaperProps:O={},slots:F,slotProps:B,transformOrigin:G={vertical:"top",horizontal:"left"},TransitionComponent:q=age,transitionDuration:X="auto",TransitionProps:{onEntering:ee}={},disableScrollLock:V=!1}=d,Q=ba(d.TransitionProps,Cge),me=ba(d,Pge),pe=(o=B==null?void 0:B.paper)!=null?o:O,be=re.useRef(),fe=xs(be,pe.ref),Ce=rt({},d,{anchorOrigin:y,anchorReference:w,elevation:k,marginThreshold:D,externalPaperSlotProps:pe,transformOrigin:G,TransitionComponent:q,transitionDuration:X,TransitionProps:Q}),Re=Lge(Ce),He=re.useCallback(()=>{if(w==="anchorPosition")return _;const ft=a4(m),St=(ft&&ft.nodeType===1?ft:bl(be.current).body).getBoundingClientRect();return{top:St.top+L7(St,y.vertical),left:St.left+R7(St,y.horizontal)}},[m,y.horizontal,y.vertical,_,w]),ue=re.useCallback(ft=>({vertical:L7(ft,G.vertical),horizontal:R7(ft,G.horizontal)}),[G.horizontal,G.vertical]),ye=re.useCallback(ft=>{const gt={width:ft.offsetWidth,height:ft.offsetHeight},St=ue(gt);if(w==="none")return{top:null,left:null,transformOrigin:k7(St)};const Be=He();let le=Be.top-St.vertical,oe=Be.left-St.horizontal;const ve=le+gt.height,$e=oe+gt.width,De=gp(a4(m)),ot=De.innerHeight-D,ce=De.innerWidth-D;if(D!==null&&le<D){const te=le-D;le-=te,St.vertical+=te}else if(D!==null&&ve>ot){const te=ve-ot;le-=te,St.vertical+=te}if(D!==null&&oe<D){const te=oe-D;oe-=te,St.horizontal+=te}else if($e>ce){const te=$e-ce;oe-=te,St.horizontal+=te}return{top:`${Math.round(le)}px`,left:`${Math.round(oe)}px`,transformOrigin:k7(St)}},[m,w,He,ue,D]),[Ae,ne]=re.useState(L),Ee=re.useCallback(()=>{const ft=be.current;if(!ft)return;const gt=ye(ft);gt.top!==null&&(ft.style.top=gt.top),gt.left!==null&&(ft.style.left=gt.left),ft.style.transformOrigin=gt.transformOrigin,ne(!0)},[ye]);re.useEffect(()=>(V&&window.addEventListener("scroll",Ee),()=>window.removeEventListener("scroll",Ee)),[m,V,Ee]);const Ye=(ft,gt)=>{ee&&ee(ft,gt),Ee()},Xe=()=>{ne(!1)};re.useEffect(()=>{L&&Ee()}),re.useImperativeHandle(f,()=>L?{updatePosition:()=>{Ee()}}:null,[L,Ee]),re.useEffect(()=>{if(!L)return;const ft=Yk(()=>{Ee()}),gt=gp(m);return gt.addEventListener("resize",ft),()=>{ft.clear(),gt.removeEventListener("resize",ft)}},[m,L,Ee]);let Ke=X;X==="auto"&&!q.muiSupportAuto&&(Ke=void 0);const Ue=I||(m?bl(a4(m)).body:void 0),ht=(s=F==null?void 0:F.root)!=null?s:Rge,Lt=(c=F==null?void 0:F.paper)!=null?c:uX,Rt=j0({elementType:Lt,externalSlotProps:rt({},pe,{style:Ae?pe.style:rt({},pe.style,{opacity:0})}),additionalProps:{elevation:k,ref:fe},ownerState:Ce,className:Ga(Re.paper,pe==null?void 0:pe.className)}),Jt=j0({elementType:ht,externalSlotProps:(B==null?void 0:B.root)||{},externalForwardedProps:me,additionalProps:{ref:a,slotProps:{backdrop:{invisible:!0}},container:Ue,open:L},ownerState:Ce,className:Ga(Re.root,C)}),{slotProps:Pt}=Jt,Pe=ba(Jt,Ige);return he(ht,rt({},Pe,!zE(ht)&&{slotProps:Pt,disableScrollLock:V},{children:he(q,rt({appear:!0,in:L,onEntering:Ye,onExited:Xe,timeout:Ke},Q,{children:he(Lt,rt({},Rt,{children:A}))}))}))}),Dge=kge;function Oge(n){return ur("MuiMenu",n)}Wi("MuiMenu",["root","paper","list"]);const zge=["onEntering"],Fge=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Nge={vertical:"top",horizontal:"right"},Bge={vertical:"top",horizontal:"left"},Uge=n=>{const{classes:e}=n;return vr({root:["root"],paper:["paper"],list:["list"]},Oge,e)},Wge=ha(Dge,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(n,e)=>e.root})({}),Vge=ha(uX,{name:"MuiMenu",slot:"Paper",overridesResolver:(n,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Gge=ha(Mge,{name:"MuiMenu",slot:"List",overridesResolver:(n,e)=>e.list})({outline:0}),Hge=re.forwardRef(function(e,a){var o,s;const c=kr({props:e,name:"MuiMenu"}),{autoFocus:d=!0,children:f,className:m,disableAutoFocusItem:y=!1,MenuListProps:_={},onClose:w,open:A,PaperProps:C={},PopoverClasses:I,transitionDuration:k="auto",TransitionProps:{onEntering:D}={},variant:L="selectedMenu",slots:O={},slotProps:F={}}=c,B=ba(c.TransitionProps,zge),G=ba(c,Fge),q=ww(),X=q.direction==="rtl",ee=rt({},c,{autoFocus:d,disableAutoFocusItem:y,MenuListProps:_,onEntering:D,PaperProps:C,transitionDuration:k,TransitionProps:B,variant:L}),V=Uge(ee),Q=d&&!y&&A,me=re.useRef(null),pe=(ye,Ae)=>{me.current&&me.current.adjustStyleForScrollbar(ye,q),D&&D(ye,Ae)},be=ye=>{ye.key==="Tab"&&(ye.preventDefault(),w&&w(ye,"tabKeyDown"))};let fe=-1;re.Children.map(f,(ye,Ae)=>{re.isValidElement(ye)&&(ye.props.disabled||(L==="selectedMenu"&&ye.props.selected||fe===-1)&&(fe=Ae))});const Ce=(o=O.paper)!=null?o:Vge,Re=(s=F.paper)!=null?s:C,He=j0({elementType:O.root,externalSlotProps:F.root,ownerState:ee,className:[V.root,m]}),ue=j0({elementType:Ce,externalSlotProps:Re,ownerState:ee,className:V.paper});return he(Wge,rt({onClose:w,anchorOrigin:{vertical:"bottom",horizontal:X?"right":"left"},transformOrigin:X?Nge:Bge,slots:{paper:Ce,root:O.root},slotProps:{root:He,paper:ue},open:A,ref:a,transitionDuration:k,TransitionProps:rt({onEntering:pe},B),ownerState:ee},G,{classes:I,children:he(Gge,rt({onKeyDown:be,actions:me,autoFocus:d&&(fe===-1||y),autoFocusItem:Q,variant:L},_,{className:Ga(V.list,_.className),children:f}))}))}),Aw=Hge;function jge(n){return ur("MuiMenuItem",n)}const $ge=Wi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),X1=$ge,qge=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Xge=(n,e)=>{const{ownerState:a}=n;return[e.root,a.dense&&e.dense,a.divider&&e.divider,!a.disableGutters&&e.gutters]},Zge=n=>{const{disabled:e,dense:a,divider:o,disableGutters:s,selected:c,classes:d}=n,m=vr({root:["root",a&&"dense",e&&"disabled",!s&&"gutters",o&&"divider",c&&"selected"]},jge,d);return rt({},d,m)},Yge=ha(uT,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Xge})(({theme:n,ownerState:e})=>rt({},n.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(n.vars||n).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${X1.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:gs(n.palette.primary.main,n.palette.action.selectedOpacity),[`&.${X1.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:gs(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}},[`&.${X1.selected}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:gs(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:gs(n.palette.primary.main,n.palette.action.selectedOpacity)}},[`&.${X1.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${X1.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`& + .${T7.root}`]:{marginTop:n.spacing(1),marginBottom:n.spacing(1)},[`& + .${T7.inset}`]:{marginLeft:52},[`& .${P7.root}`]:{marginTop:0,marginBottom:0},[`& .${P7.inset}`]:{paddingLeft:36},[`& .${C7.root}`]:{minWidth:36}},!e.dense&&{[n.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&rt({minHeight:32,paddingTop:4,paddingBottom:4},n.typography.body2,{[`& .${C7.root} svg`]:{fontSize:"1.25rem"}}))),Kge=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiMenuItem"}),{autoFocus:s=!1,component:c="li",dense:d=!1,divider:f=!1,disableGutters:m=!1,focusVisibleClassName:y,role:_="menuitem",tabIndex:w,className:A}=o,C=ba(o,qge),I=re.useContext(PL),k=re.useMemo(()=>({dense:d||I.dense||!1,disableGutters:m}),[I.dense,d,m]),D=re.useRef(null);Oh(()=>{s&&D.current&&D.current.focus()},[s]);const L=rt({},o,{dense:k.dense,divider:f,disableGutters:m}),O=Zge(o),F=xs(D,a);let B;return o.disabled||(B=w!==void 0?w:-1),he(PL.Provider,{value:k,children:he(Yge,rt({ref:F,role:_,tabIndex:B,component:c,focusVisibleClassName:Ga(O.focusVisible,y),className:Ga(O.root,A)},C,{ownerState:L,classes:O}))})}),q0=Kge;function Jge(n){return ur("MuiNativeSelect",n)}const Qge=Wi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),bD=Qge,eye=["className","disabled","error","IconComponent","inputRef","variant"],tye=n=>{const{classes:e,variant:a,disabled:o,multiple:s,open:c,error:d}=n,f={select:["select",a,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${Pa(a)}`,c&&"iconOpen",o&&"disabled"]};return vr(f,Jge,e)},dX=({ownerState:n,theme:e})=>rt({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":rt({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${bD.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},n.variant==="filled"&&{"&&&":{paddingRight:32}},n.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),nye=ha("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Kl,overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.select,e[a.variant],a.error&&e.error,{[`&.${bD.multiple}`]:e.multiple}]}})(dX),hX=({ownerState:n,theme:e})=>rt({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${bD.disabled}`]:{color:(e.vars||e).palette.action.disabled}},n.open&&{transform:"rotate(180deg)"},n.variant==="filled"&&{right:7},n.variant==="outlined"&&{right:7}),aye=ha("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.icon,a.variant&&e[`icon${Pa(a.variant)}`],a.open&&e.iconOpen]}})(hX),iye=re.forwardRef(function(e,a){const{className:o,disabled:s,error:c,IconComponent:d,inputRef:f,variant:m="standard"}=e,y=ba(e,eye),_=rt({},e,{disabled:s,variant:m,error:c}),w=tye(_);return Bt(re.Fragment,{children:[he(nye,rt({ownerState:_,className:Ga(w.select,o),disabled:s,ref:f||a},y)),e.multiple?null:he(aye,{as:d,ownerState:_,className:w.icon})]})}),rye=iye;var D7;const oye=["children","classes","className","label","notched"],sye=ha("fieldset",{shouldForwardProp:Kl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),lye=ha("legend",{shouldForwardProp:Kl})(({ownerState:n,theme:e})=>rt({float:"unset",width:"auto",overflow:"hidden"},!n.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},n.withLabel&&rt({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},n.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function cye(n){const{className:e,label:a,notched:o}=n,s=ba(n,oye),c=a!=null&&a!=="",d=rt({},n,{notched:o,withLabel:c});return he(sye,rt({"aria-hidden":!0,className:e,ownerState:d},s,{children:he(lye,{ownerState:d,children:c?he("span",{children:a}):D7||(D7=he("span",{className:"notranslate",children:""}))})}))}const uye=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],dye=n=>{const{classes:e}=n,o=vr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},Xpe,e);return rt({},e,o)},hye=ha(fT,{shouldForwardProp:n=>Kl(n)||n==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:dT})(({theme:n,ownerState:e})=>{const a=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return rt({position:"relative",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${Lf.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${Lf.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:a}},[`&.${Lf.focused} .${Lf.notchedOutline}`]:{borderColor:(n.vars||n).palette[e.color].main,borderWidth:2},[`&.${Lf.error} .${Lf.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},[`&.${Lf.disabled} .${Lf.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&rt({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),fye=ha(cye,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(n,e)=>e.notchedOutline})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),pye=ha(pT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:hT})(({theme:n,ownerState:e})=>rt({padding:"16.5px 14px"},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),fX=re.forwardRef(function(e,a){var o,s,c,d,f;const m=kr({props:e,name:"MuiOutlinedInput"}),{components:y={},fullWidth:_=!1,inputComponent:w="input",label:A,multiline:C=!1,notched:I,slots:k={},type:D="text"}=m,L=ba(m,uye),O=dye(m),F=c_(),B=Sw({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),G=rt({},m,{color:B.color||"primary",disabled:B.disabled,error:B.error,focused:B.focused,formControl:F,fullWidth:_,hiddenLabel:B.hiddenLabel,multiline:C,size:B.size,type:D}),q=(o=(s=k.root)!=null?s:y.Root)!=null?o:hye,X=(c=(d=k.input)!=null?d:y.Input)!=null?c:pye;return he(_D,rt({slots:{root:q,input:X},renderSuffix:ee=>he(fye,{ownerState:G,className:O.notchedOutline,label:A!=null&&A!==""&&B.required?f||(f=Bt(re.Fragment,{children:[A,"","*"]})):A,notched:typeof I<"u"?I:!!(ee.startAdornment||ee.filled||ee.focused)}),fullWidth:_,inputComponent:w,multiline:C,ref:a,type:D},L,{classes:rt({},O,{notchedOutline:null})}))});fX.muiName="Input";const mye=fX;function gye(n){return ur("MuiSelect",n)}const yye=Wi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Z1=yye;var O7;const vye=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],_ye=ha("div",{name:"MuiSelect",slot:"Select",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`&.${Z1.select}`]:e.select},{[`&.${Z1.select}`]:e[a.variant]},{[`&.${Z1.error}`]:e.error},{[`&.${Z1.multiple}`]:e.multiple}]}})(dX,{[`&.${Z1.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),bye=ha("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.icon,a.variant&&e[`icon${Pa(a.variant)}`],a.open&&e.iconOpen]}})(hX),xye=ha("input",{shouldForwardProp:n=>gfe(n)&&n!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(n,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function z7(n,e){return typeof e=="object"&&e!==null?n===e:String(n)===String(e)}function wye(n){return n==null||typeof n=="string"&&!n.trim()}const Sye=n=>{const{classes:e,variant:a,disabled:o,multiple:s,open:c,error:d}=n,f={select:["select",a,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${Pa(a)}`,c&&"iconOpen",o&&"disabled"],nativeInput:["nativeInput"]};return vr(f,gye,e)},Aye=re.forwardRef(function(e,a){var o;const{"aria-describedby":s,"aria-label":c,autoFocus:d,autoWidth:f,children:m,className:y,defaultOpen:_,defaultValue:w,disabled:A,displayEmpty:C,error:I=!1,IconComponent:k,inputRef:D,labelId:L,MenuProps:O={},multiple:F,name:B,onBlur:G,onChange:q,onClose:X,onFocus:ee,onOpen:V,open:Q,readOnly:me,renderValue:pe,SelectDisplayProps:be={},tabIndex:fe,value:Ce,variant:Re="standard"}=e,He=ba(e,vye),[ue,ye]=PE({controlled:Ce,default:w,name:"Select"}),[Ae,ne]=PE({controlled:Q,default:_,name:"Select"}),Ee=re.useRef(null),Ye=re.useRef(null),[Xe,Ke]=re.useState(null),{current:Ue}=re.useRef(Q!=null),[ht,Lt]=re.useState(),Rt=xs(a,D),Jt=re.useCallback(Ft=>{Ye.current=Ft,Ft&&Ke(Ft)},[]),Pt=Xe==null?void 0:Xe.parentNode;re.useImperativeHandle(Rt,()=>({focus:()=>{Ye.current.focus()},node:Ee.current,value:ue}),[ue]),re.useEffect(()=>{_&&Ae&&Xe&&!Ue&&(Lt(f?null:Pt.clientWidth),Ye.current.focus())},[Xe,f]),re.useEffect(()=>{d&&Ye.current.focus()},[d]),re.useEffect(()=>{if(!L)return;const Ft=bl(Ye.current).getElementById(L);if(Ft){const wt=()=>{getSelection().isCollapsed&&Ye.current.focus()};return Ft.addEventListener("click",wt),()=>{Ft.removeEventListener("click",wt)}}},[L]);const Pe=(Ft,wt)=>{Ft?V&&V(wt):X&&X(wt),Ue||(Lt(f?null:Pt.clientWidth),ne(Ft))},ft=Ft=>{Ft.button===0&&(Ft.preventDefault(),Ye.current.focus(),Pe(!0,Ft))},gt=Ft=>{Pe(!1,Ft)},St=re.Children.toArray(m),Be=Ft=>{const wt=St.find(Yt=>Yt.props.value===Ft.target.value);wt!==void 0&&(ye(wt.props.value),q&&q(Ft,wt))},le=Ft=>wt=>{let Yt;if(wt.currentTarget.hasAttribute("tabindex")){if(F){Yt=Array.isArray(ue)?ue.slice():[];const Ge=ue.indexOf(Ft.props.value);Ge===-1?Yt.push(Ft.props.value):Yt.splice(Ge,1)}else Yt=Ft.props.value;if(Ft.props.onClick&&Ft.props.onClick(wt),ue!==Yt&&(ye(Yt),q)){const Ge=wt.nativeEvent||wt,It=new Ge.constructor(Ge.type,Ge);Object.defineProperty(It,"target",{writable:!0,value:{value:Yt,name:B}}),q(It,Ft)}F||Pe(!1,wt)}},oe=Ft=>{me||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Ft.key)!==-1&&(Ft.preventDefault(),Pe(!0,Ft))},ve=Xe!==null&&Ae,$e=Ft=>{!ve&&G&&(Object.defineProperty(Ft,"target",{writable:!0,value:{value:ue,name:B}}),G(Ft))};delete He["aria-invalid"];let De,ot;const ce=[];let te=!1;(FE({value:ue})||C)&&(pe?De=pe(ue):te=!0);const Oe=St.map(Ft=>{if(!re.isValidElement(Ft))return null;let wt;if(F){if(!Array.isArray(ue))throw new Error(mp(2));wt=ue.some(Yt=>z7(Yt,Ft.props.value)),wt&&te&&ce.push(Ft.props.children)}else wt=z7(ue,Ft.props.value),wt&&te&&(ot=Ft.props.children);return re.cloneElement(Ft,{"aria-selected":wt?"true":"false",onClick:le(Ft),onKeyUp:Yt=>{Yt.key===" "&&Yt.preventDefault(),Ft.props.onKeyUp&&Ft.props.onKeyUp(Yt)},role:"option",selected:wt,value:void 0,"data-value":Ft.props.value})});te&&(F?ce.length===0?De=null:De=ce.reduce((Ft,wt,Yt)=>(Ft.push(wt),Yt<ce.length-1&&Ft.push(", "),Ft),[]):De=ot);let pt=ht;!f&&Ue&&Xe&&(pt=Pt.clientWidth);let it;typeof fe<"u"?it=fe:it=A?null:0;const st=be.id||(B?`mui-component-select-${B}`:void 0),At=rt({},e,{variant:Re,value:ue,open:ve,error:I}),Ut=Sye(At),Vt=rt({},O.PaperProps,(o=O.slotProps)==null?void 0:o.paper),$t=_q();return Bt(re.Fragment,{children:[he(_ye,rt({ref:Jt,tabIndex:it,role:"combobox","aria-controls":$t,"aria-disabled":A?"true":void 0,"aria-expanded":ve?"true":"false","aria-haspopup":"listbox","aria-label":c,"aria-labelledby":[L,st].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:oe,onMouseDown:A||me?null:ft,onBlur:$e,onFocus:ee},be,{ownerState:At,className:Ga(be.className,Ut.select,y),id:st,children:wye(De)?O7||(O7=he("span",{className:"notranslate",children:""})):De})),he(xye,rt({"aria-invalid":I,value:Array.isArray(ue)?ue.join(","):ue,name:B,ref:Ee,"aria-hidden":!0,onChange:Be,tabIndex:-1,disabled:A,className:Ut.nativeInput,autoFocus:d,ownerState:At},He)),he(bye,{as:k,className:Ut.icon,ownerState:At}),he(Aw,rt({id:`menu-${B||""}`,anchorEl:Pt,open:ve,onClose:gt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},O,{MenuListProps:rt({"aria-labelledby":L,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:$t},O.MenuListProps),slotProps:rt({},O.slotProps,{paper:rt({},Vt,{style:rt({minWidth:pt},Vt!=null?Vt.style:null)})}),children:Oe}))]})}),Eye=Aye,Mye=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],Tye=["root"],Cye=n=>{const{classes:e}=n;return e},xD={name:"MuiSelect",overridesResolver:(n,e)=>e.root,shouldForwardProp:n=>Kl(n)&&n!=="variant",slot:"Root"},Pye=ha(lge,xD)(""),Iye=ha(mye,xD)(""),Lye=ha(Ume,xD)(""),pX=re.forwardRef(function(e,a){const o=kr({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:c,classes:d={},className:f,defaultOpen:m=!1,displayEmpty:y=!1,IconComponent:_=Jpe,id:w,input:A,inputProps:C,label:I,labelId:k,MenuProps:D,multiple:L=!1,native:O=!1,onClose:F,onOpen:B,open:G,renderValue:q,SelectDisplayProps:X,variant:ee="outlined"}=o,V=ba(o,Mye),Q=O?rye:Eye,me=c_(),pe=Sw({props:o,muiFormControl:me,states:["variant","error"]}),be=pe.variant||ee,fe=rt({},o,{variant:be,classes:d}),Ce=Cye(fe),Re=ba(Ce,Tye),He=A||{standard:he(Pye,{ownerState:fe}),outlined:he(Iye,{label:I,ownerState:fe}),filled:he(Lye,{ownerState:fe})}[be],ue=xs(a,He.ref);return he(re.Fragment,{children:re.cloneElement(He,rt({inputComponent:Q,inputProps:rt({children:c,error:pe.error,IconComponent:_,variant:be,type:void 0,multiple:L},O?{id:w}:{autoWidth:s,defaultOpen:m,displayEmpty:y,labelId:k,MenuProps:D,onClose:F,onOpen:B,open:G,renderValue:q,SelectDisplayProps:rt({id:w},X)},C,{classes:C?_l(Re,C.classes):Re},A?A.props.inputProps:{})},L&&O&&be==="outlined"?{notched:!0}:{},{ref:ue,className:Ga(He.props.className,f,Ce.root)},!A&&{variant:be},V))})});pX.muiName="Select";const Rye=pX;function kye(n){return ur("MuiSwitch",n)}const Dye=Wi("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Ns=Dye,Oye=["className","color","edge","size","sx"],zye=n=>{const{classes:e,edge:a,size:o,color:s,checked:c,disabled:d}=n,f={root:["root",a&&`edge${Pa(a)}`,`size${Pa(o)}`],switchBase:["switchBase",`color${Pa(s)}`,c&&"checked",d&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=vr(f,kye,e);return rt({},e,m)},Fye=ha("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.edge&&e[`edge${Pa(a.edge)}`],e[`size${Pa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},n.edge==="start"&&{marginLeft:-8},n.edge==="end"&&{marginRight:-8},n.size==="small"&&{width:40,height:24,padding:7,[`& .${Ns.thumb}`]:{width:16,height:16},[`& .${Ns.switchBase}`]:{padding:4,[`&.${Ns.checked}`]:{transform:"translateX(16px)"}}})),Nye=ha(Tme,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.switchBase,{[`& .${Ns.input}`]:e.input},a.color!=="default"&&e[`color${Pa(a.color)}`]]}})(({theme:n})=>({position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:`${n.palette.mode==="light"?n.palette.common.white:n.palette.grey[300]}`,transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),[`&.${Ns.checked}`]:{transform:"translateX(20px)"},[`&.${Ns.disabled}`]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:`${n.palette.mode==="light"?n.palette.grey[100]:n.palette.grey[600]}`},[`&.${Ns.checked} + .${Ns.track}`]:{opacity:.5},[`&.${Ns.disabled} + .${Ns.track}`]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:`${n.palette.mode==="light"?.12:.2}`},[`& .${Ns.input}`]:{left:"-100%",width:"300%"}}),({theme:n,ownerState:e})=>rt({"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${Ns.checked}`]:{color:(n.vars||n).palette[e.color].main,"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Ns.disabled}`]:{color:n.vars?n.vars.palette.Switch[`${e.color}DisabledColor`]:`${n.palette.mode==="light"?Zq(n.palette[e.color].main,.62):Xq(n.palette[e.color].main,.55)}`}},[`&.${Ns.checked} + .${Ns.track}`]:{backgroundColor:(n.vars||n).palette[e.color].main}})),Bye=ha("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(n,e)=>e.track})(({theme:n})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:`${n.palette.mode==="light"?n.palette.common.black:n.palette.common.white}`,opacity:n.vars?n.vars.opacity.switchTrack:`${n.palette.mode==="light"?.38:.3}`})),Uye=ha("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(n,e)=>e.thumb})(({theme:n})=>({boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),Wye=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiSwitch"}),{className:s,color:c="primary",edge:d=!1,size:f="medium",sx:m}=o,y=ba(o,Oye),_=rt({},o,{color:c,edge:d,size:f}),w=zye(_),A=he(Uye,{className:w.thumb,ownerState:_});return Bt(Fye,{className:Ga(w.root,s),sx:m,ownerState:_,children:[he(Nye,rt({type:"checkbox",icon:A,checkedIcon:A,ref:a,ownerState:_},y,{classes:rt({},w,{root:w.switchBase})})),he(Bye,{className:w.track,ownerState:_})]})}),Vye=Wye;function Gye(n){return ur("MuiToggleButton",n)}const Hye=Wi("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),F7=Hye,jye=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],$ye=n=>{const{classes:e,fullWidth:a,selected:o,disabled:s,size:c,color:d}=n,f={root:["root",o&&"selected",s&&"disabled",a&&"fullWidth",`size${Pa(c)}`,d]};return vr(f,Gye,e)},qye=ha(uT,{name:"MuiToggleButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[`size${Pa(a.size)}`]]}})(({theme:n,ownerState:e})=>{let a=e.color==="standard"?n.palette.text.primary:n.palette[e.color].main,o;return n.vars&&(a=e.color==="standard"?n.vars.palette.text.primary:n.vars.palette[e.color].main,o=e.color==="standard"?n.vars.palette.text.primaryChannel:n.vars.palette[e.color].mainChannel),rt({},n.typography.button,{borderRadius:(n.vars||n).shape.borderRadius,padding:11,border:`1px solid ${(n.vars||n).palette.divider}`,color:(n.vars||n).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${F7.disabled}`]:{color:(n.vars||n).palette.action.disabled,border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:gs(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${F7.selected}`]:{color:a,backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:gs(a,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${o} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:gs(a,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:gs(a,n.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:n.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:n.typography.pxToRem(15)})}),Xye=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiToggleButton"}),{children:s,className:c,color:d="standard",disabled:f=!1,disableFocusRipple:m=!1,fullWidth:y=!1,onChange:_,onClick:w,selected:A,size:C="medium",value:I}=o,k=ba(o,jye),D=rt({},o,{color:d,disabled:f,disableFocusRipple:m,fullWidth:y,size:C}),L=$ye(D),O=F=>{w&&(w(F,I),F.defaultPrevented)||_&&_(F,I)};return he(qye,rt({className:Ga(L.root,c),disabled:f,focusRipple:!m,ref:a,onClick:O,onChange:_,value:I,ownerState:D,"aria-pressed":A},k,{children:s}))}),Zye=Xye;function Yye(n,e){return e===void 0||n===void 0?!1:Array.isArray(e)?e.indexOf(n)>=0:n===e}function Kye(n){return ur("MuiToggleButtonGroup",n)}const Jye=Wi("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),ah=Jye,Qye=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],eve=n=>{const{classes:e,orientation:a,fullWidth:o,disabled:s}=n,c={root:["root",a==="vertical"&&"vertical",o&&"fullWidth"],grouped:["grouped",`grouped${Pa(a)}`,s&&"disabled"]};return vr(c,Kye,e)},tve=ha("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`& .${ah.grouped}`]:e.grouped},{[`& .${ah.grouped}`]:e[`grouped${Pa(a.orientation)}`]},e.root,a.orientation==="vertical"&&e.vertical,a.fullWidth&&e.fullWidth]}})(({ownerState:n,theme:e})=>rt({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},n.orientation==="vertical"&&{flexDirection:"column"},n.fullWidth&&{width:"100%"},{[`& .${ah.grouped}`]:rt({},n.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${ah.selected} + .${ah.grouped}.${ah.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${ah.selected} + .${ah.grouped}.${ah.selected}`]:{borderTop:0,marginTop:0}})})),nve=re.forwardRef(function(e,a){const o=kr({props:e,name:"MuiToggleButtonGroup"}),{children:s,className:c,color:d="standard",disabled:f=!1,exclusive:m=!1,fullWidth:y=!1,onChange:_,orientation:w="horizontal",size:A="medium",value:C}=o,I=ba(o,Qye),k=rt({},o,{disabled:f,fullWidth:y,orientation:w,size:A}),D=eve(k),L=(F,B)=>{if(!_)return;const G=C&&C.indexOf(B);let q;C&&G>=0?(q=C.slice(),q.splice(G,1)):q=C?C.concat(B):[B],_(F,q)},O=(F,B)=>{_&&_(F,C===B?null:B)};return he(tve,rt({role:"group",className:Ga(D.root,c),ref:a,ownerState:k},I,{children:re.Children.map(s,F=>re.isValidElement(F)?re.cloneElement(F,{className:Ga(D.grouped,F.props.className),onChange:m?O:L,selected:F.props.selected===void 0?Yye(F.props.value,C):F.props.selected,size:F.props.size||A,fullWidth:y,color:F.props.color||d,disabled:F.props.disabled||f}):null)}))}),ave=nve,ive=Jq({palette:{primary:{main:"#007378"},secondary:{main:"#959595"}},components:{MuiSwitch:{styleOverrides:{root:{"& .MuiSwitch-switchBase":{"&.Mui-checked":{color:"#fff","& + .MuiSwitch-track":{opacity:1,backgroundColor:"#2D67FF",borderColor:"#007378"}}}}}},MuiDialog:{styleOverrides:{paper:{maxWidth:"none",borderRadius:40,marginTop:96}}},MuiDialogContent:{styleOverrides:{root:{padding:0}}}}}),mX=Object.fromEntries?Object.fromEntries:n=>{if(!n||!n[Symbol.iterator])throw new Error("Object.fromEntries() requires a single iterable argument");const e={};return Object.keys(n).forEach(a=>{const[o,s]=n[a];e[o]=s}),e};function X0(n){return Object.keys(n)}function wD(n,e){if(!n)throw new Error(e)}function SD(n,e){return e}const AD=n=>{const e=n.length;let a=0,o="";for(;a<e;a++){const s=n[a];if(s==null)continue;let c;switch(typeof s){case"boolean":break;case"object":{if(Array.isArray(s))c=AD(s);else{wD(!SD(s,!1)),c="";for(const d in s)s[d]&&d&&(c&&(c+=" "),c+=d)}break}default:c=s}c&&(o&&(o+=" "),o+=c)}return o};function rve(n,e){const a=re.useRef();return(!a.current||e.length!==a.current.prevDeps.length||a.current.prevDeps.map((o,s)=>o===e[s]).indexOf(!1)>=0)&&(a.current={v:n(),prevDeps:[...e]}),a.current.v}function ove(n){return n instanceof Object&&!("styles"in n)&&!("length"in n)&&!("__emotion_styles"in n)}const{createCssAndCx:sve}=(()=>{function n(a,o,s){const c=[],d=Oq(a,c,s);return c.length<2?s:d+o(c)}function e(a){const{cache:o}=a,s=(...d)=>{const f=KM(d,o.registered);iD(o,f,!1);const m=`${o.key}-${f.name}`;e:{const y=d[0];if(!ove(y))break e;N7.saveClassNameCSSObjectMapping(o,m,y)}return m};return{css:s,cx:(...d)=>{const f=AD(d),m=N7.fixClassName(o,f,s);return n(o.registered,s,m)}}}return{createCssAndCx:e}})();function gX(n){const{useCache:e}=n;function a(){const o=e(),{css:s,cx:c}=rve(()=>sve({cache:o}),[o]);return{css:s,cx:c}}return{useCssAndCx:a}}const N7=(()=>{const n=new WeakMap;return{saveClassNameCSSObjectMapping:(e,a,o)=>{let s=n.get(e);s===void 0&&(s=new Map,n.set(e,s)),s.set(a,o)},fixClassName:(()=>{function e(a){let o=!1;return a.map(([s,c])=>{if(c===void 0)return s;let d;if(o)d={"&&":c};else{d=s;for(const f in c)if(f.startsWith("@media")){o=!0;break}}return d})}return(a,o,s)=>{const c=n.get(a);return AD(e(o.split(" ").map(d=>[d,c==null?void 0:c.get(d)])).map(d=>typeof d=="string"?d:s(d)))}})()}})();function Z0(n){if(!(n instanceof Object)||typeof n=="function")return n;const e=[];for(const a in n){const o=n[a],s=typeof o;if(!(s==="string"||s==="number"&&!isNaN(o)||s==="boolean"||o===void 0||o===null))return n;e.push(`${a}:${s}_${o}`)}return"xSqLiJdLMd9s"+e.join("|")}function ED(n,e,a){if(!(e instanceof Object))return n;const o={};return X0(n).forEach(s=>o[s]=a(n[s],e[s])),X0(e).forEach(s=>{if(s in n)return;const c=e[s];typeof c=="string"&&(o[s]=c)}),o}const yX=({classes:n,theme:e,muiStyleOverridesParams:a,css:o,cx:s,name:c})=>{var d,f;e:{if(c==="makeStyle no name"){c=void 0;break e}if(a!==void 0&&c===void 0)throw new Error("To use muiStyleOverridesParams, you must specify a name using .withName('MyComponent')")}let m;try{m=c===void 0?void 0:((f=(d=e.components)===null||d===void 0?void 0:d[c])===null||f===void 0?void 0:f.styleOverrides)||void 0}catch{}const y=re.useMemo(()=>{if(m===void 0)return;const _={};for(const w in m){const A=m[w];A instanceof Object&&(_[w]=o(typeof A=="function"?A(Object.assign({theme:e,ownerState:a==null?void 0:a.ownerState},a==null?void 0:a.props)):A))}return _},[m,Z0(a==null?void 0:a.props),Z0(a==null?void 0:a.ownerState),o]);return n=re.useMemo(()=>ED(n,y,s),[n,y,s]),{classes:n}};let lve=0;function vX(n){const{useTheme:e,cache:a}=n,{useCache:o}=_X({cacheProvidedAtInception:a}),{useCssAndCx:s}=gX({useCache:o});function c(f){const{name:m,uniqId:y=`${lve++}`}=f??{},_=typeof m!="object"?m:Object.keys(m)[0];return function(w){const A=typeof w=="function"?w:()=>w;return function(I,k){const D=e();let{css:L,cx:O}=s();const F=o();let B=re.useMemo(()=>{const G={},q=typeof Proxy<"u"&&new Proxy({},{get:(V,Q)=>(typeof Q=="symbol"&&wD(!1),G[Q]=`${F.key}-${y}${_!==void 0?`-${_}`:""}-${Q}-ref`)}),X=A(D,I,q||{}),ee=mX(X0(X).map(V=>{const Q=X[V];return Q.label||(Q.label=`${_!==void 0?`${_}-`:""}${V}`),[V,`${L(Q)}${SD(V,V in G)?` ${G[V]}`:""}`]}));return X0(G).forEach(V=>{V in ee||(ee[V]=G[V])}),ee},[F,L,O,D,Z0(I)]);{const G=k==null?void 0:k.props.classes;B=re.useMemo(()=>ED(B,G,O),[B,Z0(G),O])}{const G=yX({classes:B,css:L,cx:O,name:_??"makeStyle no name",idOfUseStyles:y,muiStyleOverridesParams:k,theme:D});G.classes!==void 0&&(B=G.classes),G.css!==void 0&&(L=G.css),G.cx!==void 0&&(O=G.cx)}return{classes:B,theme:D,css:L,cx:O}}}}function d(){const f=e(),{css:m,cx:y}=s();return{theme:f,css:m,cx:y}}return{makeStyles:c,useStyles:d}}const cve=re.createContext(void 0),{createUseCache:_X}=(()=>{function n(){return re.useContext(cve)}function e(a){const{cacheProvidedAtInception:o}=a;function s(){var c;const d=ide(),f=n(),m=(c=o??f)!==null&&c!==void 0?c:d;if(m===null)throw new Error(["In order to get SSR working with tss-react you need to explicitly provide an Emotion cache.","MUI users be aware: This is not an error strictly related to tss-react, with or without tss-react,","MUI needs an Emotion cache to be provided for SSR to work.","Here is the MUI documentation related to SSR setup: https://mui.com/material-ui/guides/server-rendering/","TSS provides helper that makes the process of setting up SSR easier: https://docs.tss-react.dev/ssr"].join(`
`));return m}return{useCache:s}}return{createUseCache:e}})();function B7(n){return n.charAt(0).toUpperCase()+n.slice(1)}var U7=globalThis&&globalThis.__rest||function(n,e){var a={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(a[o[s]]=n[o[s]]);return a};function uve(n){const{useTheme:e,cache:a}=n,{makeStyles:o}=vX({useTheme:e,cache:a});function s(c,d,f){const m=typeof c=="string"?(()=>{const C=c,I=function(k){var{children:D}=k,L=U7(k,["children"]);return re.createElement(C,L,D)};return Object.defineProperty(I,"name",{value:B7(C)}),I})():c,y=(()=>{{const{name:C}=f??{};if(C!==void 0)return typeof C!="object"?C:Object.keys(C)[0]}{const C=m.displayName;if(typeof C=="string"&&C!=="")return C}{const{name:C}=m;if(C)return C.replace(/\$/g,"usd")}})(),_=o(Object.assign(Object.assign({},f),{name:y}))(typeof d=="function"?(C,I,k)=>V7(d(C,I,k)):V7(d));function w(C){for(const I in C)if(I!=="root")return!0;return!1}const A=re.forwardRef(function(C,I){const{className:k,classes:D}=C,L=U7(C,["className","classes"]),{classes:O,cx:F}=_(C,{props:C}),B=F(O.root,k);return bX.set(O,Object.assign(Object.assign({},O),{root:B})),he(m,{...Object.assign({ref:I,className:w(O)?k:B},typeof c=="string"?{}:{classes:O},L)})});return y!==void 0&&(A.displayName=`${B7(y)}WithStyles`,Object.defineProperty(A,"name",{value:A.displayName})),A}return s.getClasses=dve,{withStyles:s}}const bX=new WeakMap,W7="getClasses should only be used in conjunction with withStyles";function dve(n){const e=n.classes;if(e===void 0)throw new Error(W7);const a=bX.get(e);if(a===void 0)throw new Error(W7);return a}function V7(n){const e={},a={};return Object.keys(n).forEach(o=>(o.startsWith("@media")?a:e)[o]=n[o]),Object.keys(a).forEach(o=>{const s=a[o];Object.keys(s).forEach(c=>{var d;return e[c]=Object.assign(Object.assign({},(d=e[c])!==null&&d!==void 0?d:{}),{[o]:s[c]})})}),e}const hve=(()=>!(typeof document=="object"&&typeof(document==null?void 0:document.getElementById)=="function")&&!(typeof jest<"u")&&!(typeof mocha<"u")&&!(typeof __vitest_worker__<"u"))();var fve=globalThis&&globalThis.__rest||function(n,e){var a={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(a[o[s]]=n[o[s]]);return a};function xX(n){const{useContext:e,usePlugin:a,cache:o}=n,{useCache:s}=_X({cacheProvidedAtInception:o}),{useCssAndCx:c}=gX({useCache:s});return{tss:OA({useContext:e,useCache:s,useCssAndCx:c,usePlugin:a??(({classes:m,cx:y,css:_})=>({classes:m,cx:y,css:_})),name:void 0,doesUseNestedSelectors:!1})}}let pve=0;const i4=[];function OA(n){const{useContext:e,useCache:a,useCssAndCx:o,usePlugin:s,name:c,doesUseNestedSelectors:d}=n;return{withParams:()=>OA(Object.assign({},n)),withName:f=>OA(Object.assign(Object.assign({},n),{name:typeof f!="object"?f:Object.keys(f)[0]})),withNestedSelectors:()=>OA(Object.assign(Object.assign({},n),{doesUseNestedSelectors:!0})),create:f=>{const m=`x${pve++}`,y=typeof f=="function"?f:()=>f;return function(w){var A,C,I;const k=w??{},{classesOverrides:D}=k,L=fve(k,["classesOverrides"]),O=e(),{css:F,cx:B}=o(),G=a();let q=re.useMemo(()=>{const ee={},V=y(Object.assign(Object.assign(Object.assign({},w),O),d?{classes:typeof Proxy>"u"?{}:new Proxy({},{get:(me,pe)=>{if(typeof pe=="symbol"&&wD(!1),hve){{let be=i4.find(fe=>fe.name===c&&fe.idOfUseStyles===m);be===void 0&&(be={name:c,idOfUseStyles:m,nestedSelectorRuleNames:new Set},i4.push(be)),be.nestedSelectorRuleNames.add(pe)}if(i4.find(be=>be.name===c&&be.idOfUseStyles!==m&&be.nestedSelectorRuleNames.has(pe))!==void 0)throw new Error([`tss-react: Duplicate nested selector "${pe}" detected in ${c===void 0?`useStyles named "${c}"`:"anonymous useStyles function"}.`,"In SSR setups, this may lead to CSS class name collisions, causing nested selectors to target elements outside of the intended scope.",'Solution: Ensure each useStyles using nested selectors has a unique name. Use tss.withName("UniqueName").withNestedSelectors<...>()... to set a name.'].join(`
`))}return ee[pe]=`${G.key}-${m}${c!==void 0?`-${c}`:""}-${pe}-ref`}})}:{})),Q=mX(X0(V).map(me=>{const pe=V[me];return pe.label||(pe.label=`${c!==void 0?`${c}-`:""}${me}`),[me,`${F(pe)}${SD(me,me in ee)?` ${ee[me]}`:""}`]}));return X0(ee).forEach(me=>{me in Q||(Q[me]=ee[me])}),Q},[G,F,B,Z0(w),...Object.values(O)]);q=re.useMemo(()=>ED(q,D,B),[q,Z0(D),B]);const X=s(Object.assign(Object.assign({classes:q,css:F,cx:B,idOfUseStyles:m,name:c},O),L));return Object.assign({classes:(A=X.classes)!==null&&A!==void 0?A:q,css:(C=X.css)!==null&&C!==void 0?C:F,cx:(I=X.cx)!==null&&I!==void 0?I:B},O)}}}}function mve(n){return Object.assign(Object.assign({},vX(n)),uve(n))}const{tss:gve}=xX({useContext:()=>({})});gve.create({});const{makeStyles:Mc,withStyles:L4e}=mve({useTheme:ww}),{tss:yve}=xX({useContext:function(){return{theme:ww()}},usePlugin:yX});yve.create({});const MD=Mc()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{maxWidth:"100%",margin:"0 auto",padding:"0 5%"},gradient:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:1,backgroundImage:"radial-gradient(53.6% 37.94% at 49.21% 62.06%, rgba(33, 63, 178, 0) 0%, #1424A2 100%)"},graph3dWrapper:{backgroundColor:"transparent",zIndex:1,position:"absolute",top:"-30%",left:"8%",width:"100%",height:"130%"}}),mT=Mc()({root:{position:"absolute",marginTop:"1.5vh",zIndex:1},titleWrapper:{display:"flex",flexDirection:"row",gap:"5vh",alignItems:"center",justifyContent:"flex-start"},cityNameAndCountryNameWrapper:{display:"flex",flexDirection:"column"},cityName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"10.8vh",marginLeft:"-1vh"},cityDescription:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.6vh",opacity:"0.5"},countryName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",marginTop:"-0.95vh"},statWrapper:{display:"flex",flexDirection:"row",gap:"3.5vh",alignItems:"center",justifyContent:"flex-start",marginTop:"2vh"},statItem:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},statTitle:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statValue:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.95vh",marginTop:"-0.40vh"},statStatus:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"1.4vh",color:"#2D67FF",border:"1px solid #2D67FF",borderRadius:"50px",padding:"0.6rem .9rem",marginTop:"0vh"},statsContainer:{width:"63.5vh",marginTop:"5.5vh",marginLeft:"-2vh",padding:0,paddingLeft:"2vh",borderLeft:"1px solid #fff"},statStatusBig:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"2vh",borderRadius:"50px",marginTop:"0vh"},statItemBigWrapper:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},smallRowWrapper:{position:"relative",width:"auto"},lowOpacityLabel:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statsBigText:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"2.5vh",width:"22vh"},statsSmallText:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.5vh"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"29vh",pointerEvents:"none",height:"5vh",marginLeft:"0vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),wX=Mc()({root:{zIndex:2,position:"relative",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),TD=Mc()({root:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"90vh"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{position:"absolute",top:"48%",width:"40%",paddingTop:"18px",fontFamily:"SuisseIntl-Thin",lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",pointerEvents:"none"},bigTextBlue:{paddingTop:"18px",fontFamily:"SuisseIntl-Medium",fontWeight:500,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#2D67FF"},textAndToggleWrapper:{zIndex:2,display:"flex",flexDirection:"column",gap:"30px",pointerEvents:"none"},filterButtonAndScaleWrapper:{zIndex:1,minWidth:"100px",display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"space-between"},filterSelect:{zIndex:2,borderRadius:"50px",background:"white",minWidth:"unset",minHeight:"unset",height:"4.6vh",fontSize:"1.8vh",padding:"0px 0px 0px 5px","& .MuiSelect-select":{padding:"0px 0px 0px 15px","&:focus":{backgroundColor:"transparent"}}},filterButton:{minWidth:"unset",minHeight:"unset",height:"4.6vh",fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#000000",textTransform:"none",fontSize:"1.8vh",zIndex:2,backgroundColor:"rgba(255, 255, 255, 1)",borderRadius:"50px",padding:"0.5rem 1rem",opacity:"1","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.85)"}},topLineWrapper:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:"row"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"40px",pointerEvents:"none",height:"10vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"17px",color:"#7386CA",cursor:"pointer"},legendLine:{position:"absolute",height:"51.5vh",top:"50%",right:"5%",transform:"translate(0, -45%)",pointerEvents:"none",zIndex:"1"},filterButtonsWrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"-92vh",alignSelf:"end"},blurAll:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:2,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)"}}),vve=ha(ave)(()=>({"& .MuiToggleButtonGroup-grouped":{borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",textTransform:"none",pointerEvents:"all"}})),G7=ha(Zye)({"&.MuiToggleButton-root":{fontFamily:"SuisseIntl-Regular",fontSize:"4vh",textTransform:"none",borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",backgroundColor:"transparent",padding:"0.2rem 1.5rem","&:hover":{backgroundColor:"#fff",color:"#000"}},"&.Mui-selected":{backgroundColor:"#fff",color:"#000"}}),_ve=({children:n,backgroundColor:e})=>{const{classes:a}=MD(),o="#1433AE";return he("div",{className:a.root,style:{backgroundColor:e||o},children:he("div",{className:a.contentWrapper,children:n})})},bve={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},xve=({isCitySelected:n,setSelectedCity:e})=>{const a=s=>bve[s],{classes:o}=wX();return Bt("div",{className:o.root,children:[Bt("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[n&&Bt("div",{onClick:()=>{e(null)},className:o.menuIconWrapper,children:[he("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),he(Ws,{className:o.whiteText,children:a("back")})]}),Bt("div",{className:o.menuIconWrapper,children:[he("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),he(Ws,{className:o.whiteText,children:a("menu")})]})]}),he("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Bt("div",{className:o.buttonsWrapper,children:[he(Vs,{className:o.whiteText,children:a("login")}),he(Vs,{className:o.signUpButton,style:{backgroundColor:n?"#FFFFFF":"#2D67FF",color:n?"#1433AE":"#FFFFFF"},children:a("signup")})]})]})},wve=({map:n})=>Bt("div",{style:{position:"relative",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[he("div",{onClick:()=>{n&&n.zoomIn()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:he("img",{src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),he("div",{onClick:()=>{n&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:he("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const gT="158",Zm={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ym={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},SX=0,IL=1,AX=2,Sve=3,EX=0,yT=1,$b=2,Qc=3,md=0,vs=1,Ul=2,Ave=2,Ph=0,yg=1,LL=2,RL=3,kL=4,MX=5,Hf=100,TX=101,CX=102,DL=103,OL=104,PX=200,IX=201,LX=202,RX=203,NE=204,BE=205,kX=206,DX=207,OX=208,zX=209,FX=210,NX=211,BX=212,UX=213,WX=214,VX=0,GX=1,HX=2,Lx=3,jX=4,$X=5,qX=6,XX=7,Ew=0,ZX=1,YX=2,dd=0,KX=1,JX=2,QX=3,CD=4,eZ=5,zL="attached",tZ="detached",vT=300,Fh=301,yp=302,Rx=303,kx=304,u_=306,Dx=1e3,ms=1001,Ox=1002,ro=1003,UE=1004,Eve=1004,qb=1005,Mve=1005,Cr=1006,PD=1007,Tve=1007,vp=1008,Cve=1008,hd=1009,nZ=1010,aZ=1011,_T=1012,ID=1013,Sh=1014,od=1015,Y0=1016,LD=1017,RD=1018,lp=1020,iZ=1021,hl=1023,rZ=1024,oZ=1025,cp=1026,Lg=1027,sZ=1028,kD=1029,lZ=1030,DD=1031,OD=1033,zA=33776,FA=33777,NA=33778,BA=33779,FL=35840,NL=35841,BL=35842,UL=35843,cZ=36196,WL=37492,VL=37496,GL=37808,HL=37809,jL=37810,$L=37811,qL=37812,XL=37813,ZL=37814,YL=37815,KL=37816,JL=37817,QL=37818,eR=37819,tR=37820,nR=37821,UA=36492,aR=36494,iR=36495,uZ=36283,rR=36284,oR=36285,sR=36286,dZ=2200,hZ=2201,fZ=2202,zx=2300,Fx=2301,WA=2302,cg=2400,ug=2401,Nx=2402,bT=2500,zD=2501,Pve=0,Ive=1,Lve=2,FD=3e3,up=3001,pZ=3200,ND=3201,Ep=0,mZ=1,Wl="",To="srgb",gd="srgb-linear",xT="display-p3",Mw="display-p3-linear",Bx="linear",Ji="srgb",Ux="rec709",Wx="p3",Rve=0,Km=7680,kve=7681,Dve=7682,Ove=7683,zve=34055,Fve=34056,Nve=5386,Bve=512,Uve=513,Wve=514,Vve=515,Gve=516,Hve=517,jve=518,lR=519,gZ=512,yZ=513,vZ=514,_Z=515,bZ=516,xZ=517,wZ=518,SZ=519,Vx=35044,$ve=35048,qve=35040,Xve=35045,Zve=35049,Yve=35041,Kve=35046,Jve=35050,Qve=35042,e0e="100",cR="300 es",WE=1035,sd=2e3,Gx=2001;class _d{addEventListener(e,a){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(a)===-1&&o[e].push(a)}hasEventListener(e,a){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(a)!==-1}removeEventListener(e,a){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const c=s.indexOf(a);c!==-1&&s.splice(c,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const o=this._listeners[e.type];if(o!==void 0){e.target=this;const s=o.slice(0);for(let c=0,d=s.length;c<d;c++)s[c].call(this,e);e.target=null}}}const us=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let H7=1234567;const vg=Math.PI/180,K0=180/Math.PI;function $l(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(us[n&255]+us[n>>8&255]+us[n>>16&255]+us[n>>24&255]+"-"+us[e&255]+us[e>>8&255]+"-"+us[e>>16&15|64]+us[e>>24&255]+"-"+us[a&63|128]+us[a>>8&255]+"-"+us[a>>16&255]+us[a>>24&255]+us[o&255]+us[o>>8&255]+us[o>>16&255]+us[o>>24&255]).toLowerCase()}function Hr(n,e,a){return Math.max(e,Math.min(a,n))}function BD(n,e){return(n%e+e)%e}function t0e(n,e,a,o,s){return o+(n-e)*(s-o)/(a-e)}function n0e(n,e,a){return n!==e?(a-n)/(e-n):0}function Xb(n,e,a){return(1-a)*n+a*e}function a0e(n,e,a,o){return Xb(n,e,1-Math.exp(-a*o))}function i0e(n,e=1){return e-Math.abs(BD(n,e*2)-e)}function r0e(n,e,a){return n<=e?0:n>=a?1:(n=(n-e)/(a-e),n*n*(3-2*n))}function o0e(n,e,a){return n<=e?0:n>=a?1:(n=(n-e)/(a-e),n*n*n*(n*(n*6-15)+10))}function s0e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function l0e(n,e){return n+Math.random()*(e-n)}function c0e(n){return n*(.5-Math.random())}function u0e(n){n!==void 0&&(H7=n);let e=H7+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function d0e(n){return n*vg}function h0e(n){return n*K0}function uR(n){return(n&n-1)===0&&n!==0}function AZ(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function VE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function f0e(n,e,a,o,s){const c=Math.cos,d=Math.sin,f=c(a/2),m=d(a/2),y=c((e+o)/2),_=d((e+o)/2),w=c((e-o)/2),A=d((e-o)/2),C=c((o-e)/2),I=d((o-e)/2);switch(s){case"XYX":n.set(f*_,m*w,m*A,f*y);break;case"YZY":n.set(m*A,f*_,m*w,f*y);break;case"ZXZ":n.set(m*w,m*A,f*_,f*y);break;case"XZX":n.set(f*_,m*I,m*C,f*y);break;case"YXY":n.set(m*C,f*_,m*I,f*y);break;case"ZYZ":n.set(m*I,m*C,f*_,f*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function fl(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ba(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const p0e={DEG2RAD:vg,RAD2DEG:K0,generateUUID:$l,clamp:Hr,euclideanModulo:BD,mapLinear:t0e,inverseLerp:n0e,lerp:Xb,damp:a0e,pingpong:i0e,smoothstep:r0e,smootherstep:o0e,randInt:s0e,randFloat:l0e,randFloatSpread:c0e,seededRandom:u0e,degToRad:d0e,radToDeg:h0e,isPowerOfTwo:uR,ceilPowerOfTwo:AZ,floorPowerOfTwo:VE,setQuaternionFromProperEuler:f0e,normalize:Ba,denormalize:fl};class Kt{constructor(e=0,a=0){Kt.prototype.isVector2=!0,this.x=e,this.y=a}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,a){return this.x=e,this.y=a,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const a=this.x,o=this.y,s=e.elements;return this.x=s[0]*a+s[3]*o+s[6],this.y=s[1]*a+s[4]*o+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const a=Math.sqrt(this.lengthSq()*e.lengthSq());if(a===0)return Math.PI/2;const o=this.dot(e)/a;return Math.acos(Hr(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const a=this.x-e.x,o=this.y-e.y;return a*a+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this}rotateAround(e,a){const o=Math.cos(a),s=Math.sin(a),c=this.x-e.x,d=this.y-e.y;return this.x=c*o-d*s+e.x,this.y=c*s+d*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Na{constructor(e,a,o,s,c,d,f,m,y){Na.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,a,o,s,c,d,f,m,y)}set(e,a,o,s,c,d,f,m,y){const _=this.elements;return _[0]=e,_[1]=s,_[2]=f,_[3]=a,_[4]=c,_[5]=m,_[6]=o,_[7]=d,_[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const a=this.elements,o=e.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],this}extractBasis(e,a,o){return e.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const a=e.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,a){const o=e.elements,s=a.elements,c=this.elements,d=o[0],f=o[3],m=o[6],y=o[1],_=o[4],w=o[7],A=o[2],C=o[5],I=o[8],k=s[0],D=s[3],L=s[6],O=s[1],F=s[4],B=s[7],G=s[2],q=s[5],X=s[8];return c[0]=d*k+f*O+m*G,c[3]=d*D+f*F+m*q,c[6]=d*L+f*B+m*X,c[1]=y*k+_*O+w*G,c[4]=y*D+_*F+w*q,c[7]=y*L+_*B+w*X,c[2]=A*k+C*O+I*G,c[5]=A*D+C*F+I*q,c[8]=A*L+C*B+I*X,this}multiplyScalar(e){const a=this.elements;return a[0]*=e,a[3]*=e,a[6]*=e,a[1]*=e,a[4]*=e,a[7]*=e,a[2]*=e,a[5]*=e,a[8]*=e,this}determinant(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8];return a*d*_-a*f*y-o*c*_+o*f*m+s*c*y-s*d*m}invert(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8],w=_*d-f*y,A=f*m-_*c,C=y*c-d*m,I=a*w+o*A+s*C;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const k=1/I;return e[0]=w*k,e[1]=(s*y-_*o)*k,e[2]=(f*o-s*d)*k,e[3]=A*k,e[4]=(_*a-s*m)*k,e[5]=(s*c-f*a)*k,e[6]=C*k,e[7]=(o*m-y*a)*k,e[8]=(d*a-o*c)*k,this}transpose(){let e;const a=this.elements;return e=a[1],a[1]=a[3],a[3]=e,e=a[2],a[2]=a[6],a[6]=e,e=a[5],a[5]=a[7],a[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const a=this.elements;return e[0]=a[0],e[1]=a[3],e[2]=a[6],e[3]=a[1],e[4]=a[4],e[5]=a[7],e[6]=a[2],e[7]=a[5],e[8]=a[8],this}setUvTransform(e,a,o,s,c,d,f){const m=Math.cos(c),y=Math.sin(c);return this.set(o*m,o*y,-o*(m*d+y*f)+d+e,-s*y,s*m,-s*(-y*d+m*f)+f+a,0,0,1),this}scale(e,a){return this.premultiply(r4.makeScale(e,a)),this}rotate(e){return this.premultiply(r4.makeRotation(-e)),this}translate(e,a){return this.premultiply(r4.makeTranslation(e,a)),this}makeTranslation(e,a){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,a,0,0,1),this}makeRotation(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,-o,0,o,a,0,0,0,1),this}makeScale(e,a){return this.set(e,0,0,0,a,0,0,0,1),this}equals(e){const a=this.elements,o=e.elements;for(let s=0;s<9;s++)if(a[s]!==o[s])return!1;return!0}fromArray(e,a=0){for(let o=0;o<9;o++)this.elements[o]=e[o+a];return this}toArray(e=[],a=0){const o=this.elements;return e[a]=o[0],e[a+1]=o[1],e[a+2]=o[2],e[a+3]=o[3],e[a+4]=o[4],e[a+5]=o[5],e[a+6]=o[6],e[a+7]=o[7],e[a+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const r4=new Na;function EZ(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const m0e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function y0(n,e){return new m0e[n](e)}function Hx(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function MZ(){const n=Hx("canvas");return n.style.display="block",n}const j7={};function Zb(n){n in j7||(j7[n]=!0,console.warn(n))}const $7=new Na().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),q7=new Na().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),aS={[gd]:{transfer:Bx,primaries:Ux,toReference:n=>n,fromReference:n=>n},[To]:{transfer:Ji,primaries:Ux,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Mw]:{transfer:Bx,primaries:Wx,toReference:n=>n.applyMatrix3(q7),fromReference:n=>n.applyMatrix3($7)},[xT]:{transfer:Ji,primaries:Wx,toReference:n=>n.convertSRGBToLinear().applyMatrix3(q7),fromReference:n=>n.applyMatrix3($7).convertLinearToSRGB()}},g0e=new Set([gd,Mw]),Oi={enabled:!0,_workingColorSpace:gd,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!g0e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,a){if(this.enabled===!1||e===a||!e||!a)return n;const o=aS[e].toReference,s=aS[a].fromReference;return s(o(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return aS[n].primaries},getTransfer:function(n){return n===Wl?Bx:aS[n].transfer}};function R0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function o4(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Tv;class UD{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let a;if(e instanceof HTMLCanvasElement)a=e;else{Tv===void 0&&(Tv=Hx("canvas")),Tv.width=e.width,Tv.height=e.height;const o=Tv.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),a=Tv}return a.width>2048||a.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),a.toDataURL("image/jpeg",.6)):a.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const a=Hx("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const s=o.getImageData(0,0,e.width,e.height),c=s.data;for(let d=0;d<c.length;d++)c[d]=R0(c[d]/255)*255;return o.putImageData(s,0,0),a}else if(e.data){const a=e.data.slice(0);for(let o=0;o<a.length;o++)a instanceof Uint8Array||a instanceof Uint8ClampedArray?a[o]=Math.floor(R0(a[o]/255)*255):a[o]=R0(a[o]);return{data:a,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let y0e=0;class dg{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:y0e++}),this.uuid=$l(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const a=e===void 0||typeof e=="string";if(!a&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const o={uuid:this.uuid,url:""},s=this.data;if(s!==null){let c;if(Array.isArray(s)){c=[];for(let d=0,f=s.length;d<f;d++)s[d].isDataTexture?c.push(s4(s[d].image)):c.push(s4(s[d]))}else c=s4(s);o.url=c}return a||(e.images[this.uuid]=o),o}}function s4(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?UD.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let v0e=0;class Lr extends _d{constructor(e=Lr.DEFAULT_IMAGE,a=Lr.DEFAULT_MAPPING,o=ms,s=ms,c=Cr,d=vp,f=hl,m=hd,y=Lr.DEFAULT_ANISOTROPY,_=Wl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:v0e++}),this.uuid=$l(),this.name="",this.source=new dg(e),this.mipmaps=[],this.mapping=a,this.channel=0,this.wrapS=o,this.wrapT=s,this.magFilter=c,this.minFilter=d,this.anisotropy=y,this.format=f,this.internalFormat=null,this.type=m,this.offset=new Kt(0,0),this.repeat=new Kt(1,1),this.center=new Kt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Na,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof _=="string"?this.colorSpace=_:(Zb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_===up?To:Wl),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const a=e===void 0||typeof e=="string";if(!a&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),a||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==vT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Dx:e.x=e.x-Math.floor(e.x);break;case ms:e.x=e.x<0?0:1;break;case Ox:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Dx:e.y=e.y-Math.floor(e.y);break;case ms:e.y=e.y<0?0:1;break;case Ox:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Zb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===To?up:FD}set encoding(e){Zb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===up?To:Wl}}Lr.DEFAULT_IMAGE=null;Lr.DEFAULT_MAPPING=vT;Lr.DEFAULT_ANISOTROPY=1;class Ai{constructor(e=0,a=0,o=0,s=1){Ai.prototype.isVector4=!0,this.x=e,this.y=a,this.z=o,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,a,o,s){return this.x=e,this.y=a,this.z=o,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this.w=e.w+a.w,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this.w+=e.w*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this.w=e.w-a.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const a=this.x,o=this.y,s=this.z,c=this.w,d=e.elements;return this.x=d[0]*a+d[4]*o+d[8]*s+d[12]*c,this.y=d[1]*a+d[5]*o+d[9]*s+d[13]*c,this.z=d[2]*a+d[6]*o+d[10]*s+d[14]*c,this.w=d[3]*a+d[7]*o+d[11]*s+d[15]*c,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const a=Math.sqrt(1-e.w*e.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/a,this.y=e.y/a,this.z=e.z/a),this}setAxisAngleFromRotationMatrix(e){let a,o,s,c;const m=e.elements,y=m[0],_=m[4],w=m[8],A=m[1],C=m[5],I=m[9],k=m[2],D=m[6],L=m[10];if(Math.abs(_-A)<.01&&Math.abs(w-k)<.01&&Math.abs(I-D)<.01){if(Math.abs(_+A)<.1&&Math.abs(w+k)<.1&&Math.abs(I+D)<.1&&Math.abs(y+C+L-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;const F=(y+1)/2,B=(C+1)/2,G=(L+1)/2,q=(_+A)/4,X=(w+k)/4,ee=(I+D)/4;return F>B&&F>G?F<.01?(o=0,s=.707106781,c=.707106781):(o=Math.sqrt(F),s=q/o,c=X/o):B>G?B<.01?(o=.707106781,s=0,c=.707106781):(s=Math.sqrt(B),o=q/s,c=ee/s):G<.01?(o=.707106781,s=.707106781,c=0):(c=Math.sqrt(G),o=X/c,s=ee/c),this.set(o,s,c,a),this}let O=Math.sqrt((D-I)*(D-I)+(w-k)*(w-k)+(A-_)*(A-_));return Math.abs(O)<.001&&(O=1),this.x=(D-I)/O,this.y=(w-k)/O,this.z=(A-_)/O,this.w=Math.acos((y+C+L-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this.w=Math.max(e.w,Math.min(a.w,this.w)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this.w=Math.max(e,Math.min(a,this.w)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this.w+=(e.w-this.w)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this.z=e.z+(a.z-e.z)*o,this.w=e.w+(a.w-e.w)*o,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this.z=e[a+2],this.w=e[a+3],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e[a+3]=this.w,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this.w=e.getW(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class TZ extends _d{constructor(e=1,a=1,o={}){super(),this.isRenderTarget=!0,this.width=e,this.height=a,this.depth=1,this.scissor=new Ai(0,0,e,a),this.scissorTest=!1,this.viewport=new Ai(0,0,e,a);const s={width:e,height:a,depth:1};o.encoding!==void 0&&(Zb("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),o.colorSpace=o.encoding===up?To:Wl),o=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Cr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},o),this.texture=new Lr(s,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps,this.texture.internalFormat=o.internalFormat,this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this.samples=o.samples}setSize(e,a,o=1){(this.width!==e||this.height!==a||this.depth!==o)&&(this.width=e,this.height=a,this.depth=o,this.texture.image.width=e,this.texture.image.height=a,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const a=Object.assign({},e.texture.image);return this.texture.source=new dg(a),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class hu extends TZ{constructor(e=1,a=1,o={}){super(e,a,o),this.isWebGLRenderTarget=!0}}class wT extends Lr{constructor(e=null,a=1,o=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:a,height:o,depth:s},this.magFilter=ro,this.minFilter=ro,this.wrapR=ms,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class _0e extends hu{constructor(e=1,a=1,o=1){super(e,a),this.isWebGLArrayRenderTarget=!0,this.depth=o,this.texture=new wT(null,e,a,o),this.texture.isRenderTargetTexture=!0}}class WD extends Lr{constructor(e=null,a=1,o=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:a,height:o,depth:s},this.magFilter=ro,this.minFilter=ro,this.wrapR=ms,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class b0e extends hu{constructor(e=1,a=1,o=1){super(e,a),this.isWebGL3DRenderTarget=!0,this.depth=o,this.texture=new WD(null,e,a,o),this.texture.isRenderTargetTexture=!0}}class x0e extends hu{constructor(e=1,a=1,o=1,s={}){super(e,a,s),this.isWebGLMultipleRenderTargets=!0;const c=this.texture;this.texture=[];for(let d=0;d<o;d++)this.texture[d]=c.clone(),this.texture[d].isRenderTargetTexture=!0}setSize(e,a,o=1){if(this.width!==e||this.height!==a||this.depth!==o){this.width=e,this.height=a,this.depth=o;for(let s=0,c=this.texture.length;s<c;s++)this.texture[s].image.width=e,this.texture[s].image.height=a,this.texture[s].image.depth=o;this.dispose()}this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let a=0,o=e.texture.length;a<o;a++)this.texture[a]=e.texture[a].clone(),this.texture[a].isRenderTargetTexture=!0;return this}}class _s{constructor(e=0,a=0,o=0,s=1){this.isQuaternion=!0,this._x=e,this._y=a,this._z=o,this._w=s}static slerpFlat(e,a,o,s,c,d,f){let m=o[s+0],y=o[s+1],_=o[s+2],w=o[s+3];const A=c[d+0],C=c[d+1],I=c[d+2],k=c[d+3];if(f===0){e[a+0]=m,e[a+1]=y,e[a+2]=_,e[a+3]=w;return}if(f===1){e[a+0]=A,e[a+1]=C,e[a+2]=I,e[a+3]=k;return}if(w!==k||m!==A||y!==C||_!==I){let D=1-f;const L=m*A+y*C+_*I+w*k,O=L>=0?1:-1,F=1-L*L;if(F>Number.EPSILON){const G=Math.sqrt(F),q=Math.atan2(G,L*O);D=Math.sin(D*q)/G,f=Math.sin(f*q)/G}const B=f*O;if(m=m*D+A*B,y=y*D+C*B,_=_*D+I*B,w=w*D+k*B,D===1-f){const G=1/Math.sqrt(m*m+y*y+_*_+w*w);m*=G,y*=G,_*=G,w*=G}}e[a]=m,e[a+1]=y,e[a+2]=_,e[a+3]=w}static multiplyQuaternionsFlat(e,a,o,s,c,d){const f=o[s],m=o[s+1],y=o[s+2],_=o[s+3],w=c[d],A=c[d+1],C=c[d+2],I=c[d+3];return e[a]=f*I+_*w+m*C-y*A,e[a+1]=m*I+_*A+y*w-f*C,e[a+2]=y*I+_*C+f*A-m*w,e[a+3]=_*I-f*w-m*A-y*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,a,o,s){return this._x=e,this._y=a,this._z=o,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,a){const o=e._x,s=e._y,c=e._z,d=e._order,f=Math.cos,m=Math.sin,y=f(o/2),_=f(s/2),w=f(c/2),A=m(o/2),C=m(s/2),I=m(c/2);switch(d){case"XYZ":this._x=A*_*w+y*C*I,this._y=y*C*w-A*_*I,this._z=y*_*I+A*C*w,this._w=y*_*w-A*C*I;break;case"YXZ":this._x=A*_*w+y*C*I,this._y=y*C*w-A*_*I,this._z=y*_*I-A*C*w,this._w=y*_*w+A*C*I;break;case"ZXY":this._x=A*_*w-y*C*I,this._y=y*C*w+A*_*I,this._z=y*_*I+A*C*w,this._w=y*_*w-A*C*I;break;case"ZYX":this._x=A*_*w-y*C*I,this._y=y*C*w+A*_*I,this._z=y*_*I-A*C*w,this._w=y*_*w+A*C*I;break;case"YZX":this._x=A*_*w+y*C*I,this._y=y*C*w+A*_*I,this._z=y*_*I-A*C*w,this._w=y*_*w-A*C*I;break;case"XZY":this._x=A*_*w-y*C*I,this._y=y*C*w-A*_*I,this._z=y*_*I+A*C*w,this._w=y*_*w+A*C*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return a!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,a){const o=a/2,s=Math.sin(o);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const a=e.elements,o=a[0],s=a[4],c=a[8],d=a[1],f=a[5],m=a[9],y=a[2],_=a[6],w=a[10],A=o+f+w;if(A>0){const C=.5/Math.sqrt(A+1);this._w=.25/C,this._x=(_-m)*C,this._y=(c-y)*C,this._z=(d-s)*C}else if(o>f&&o>w){const C=2*Math.sqrt(1+o-f-w);this._w=(_-m)/C,this._x=.25*C,this._y=(s+d)/C,this._z=(c+y)/C}else if(f>w){const C=2*Math.sqrt(1+f-o-w);this._w=(c-y)/C,this._x=(s+d)/C,this._y=.25*C,this._z=(m+_)/C}else{const C=2*Math.sqrt(1+w-o-f);this._w=(d-s)/C,this._x=(c+y)/C,this._y=(m+_)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,a){let o=e.dot(a)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*a.z-e.z*a.y,this._y=e.z*a.x-e.x*a.z,this._z=e.x*a.y-e.y*a.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Hr(this.dot(e),-1,1)))}rotateTowards(e,a){const o=this.angleTo(e);if(o===0)return this;const s=Math.min(1,a/o);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,a){const o=e._x,s=e._y,c=e._z,d=e._w,f=a._x,m=a._y,y=a._z,_=a._w;return this._x=o*_+d*f+s*y-c*m,this._y=s*_+d*m+c*f-o*y,this._z=c*_+d*y+o*m-s*f,this._w=d*_-o*f-s*m-c*y,this._onChangeCallback(),this}slerp(e,a){if(a===0)return this;if(a===1)return this.copy(e);const o=this._x,s=this._y,c=this._z,d=this._w;let f=d*e._w+o*e._x+s*e._y+c*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=d,this._x=o,this._y=s,this._z=c,this;const m=1-f*f;if(m<=Number.EPSILON){const C=1-a;return this._w=C*d+a*this._w,this._x=C*o+a*this._x,this._y=C*s+a*this._y,this._z=C*c+a*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(m),_=Math.atan2(y,f),w=Math.sin((1-a)*_)/y,A=Math.sin(a*_)/y;return this._w=d*w+this._w*A,this._x=o*w+this._x*A,this._y=s*w+this._y*A,this._z=c*w+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,a,o){return this.copy(e).slerp(a,o)}random(){const e=Math.random(),a=Math.sqrt(1-e),o=Math.sqrt(e),s=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();return this.set(a*Math.cos(s),o*Math.sin(c),o*Math.cos(c),a*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,a=0){return this._x=e[a],this._y=e[a+1],this._z=e[a+2],this._w=e[a+3],this._onChangeCallback(),this}toArray(e=[],a=0){return e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._w,e}fromBufferAttribute(e,a){return this._x=e.getX(a),this._y=e.getY(a),this._z=e.getZ(a),this._w=e.getW(a),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Fe{constructor(e=0,a=0,o=0){Fe.prototype.isVector3=!0,this.x=e,this.y=a,this.z=o}set(e,a,o){return o===void 0&&(o=this.z),this.x=e,this.y=a,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,a){return this.x=e.x*a.x,this.y=e.y*a.y,this.z=e.z*a.z,this}applyEuler(e){return this.applyQuaternion(X7.setFromEuler(e))}applyAxisAngle(e,a){return this.applyQuaternion(X7.setFromAxisAngle(e,a))}applyMatrix3(e){const a=this.x,o=this.y,s=this.z,c=e.elements;return this.x=c[0]*a+c[3]*o+c[6]*s,this.y=c[1]*a+c[4]*o+c[7]*s,this.z=c[2]*a+c[5]*o+c[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const a=this.x,o=this.y,s=this.z,c=e.elements,d=1/(c[3]*a+c[7]*o+c[11]*s+c[15]);return this.x=(c[0]*a+c[4]*o+c[8]*s+c[12])*d,this.y=(c[1]*a+c[5]*o+c[9]*s+c[13])*d,this.z=(c[2]*a+c[6]*o+c[10]*s+c[14])*d,this}applyQuaternion(e){const a=this.x,o=this.y,s=this.z,c=e.x,d=e.y,f=e.z,m=e.w,y=2*(d*s-f*o),_=2*(f*a-c*s),w=2*(c*o-d*a);return this.x=a+m*y+d*w-f*_,this.y=o+m*_+f*y-c*w,this.z=s+m*w+c*_-d*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const a=this.x,o=this.y,s=this.z,c=e.elements;return this.x=c[0]*a+c[4]*o+c[8]*s,this.y=c[1]*a+c[5]*o+c[9]*s,this.z=c[2]*a+c[6]*o+c[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this.z=e.z+(a.z-e.z)*o,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,a){const o=e.x,s=e.y,c=e.z,d=a.x,f=a.y,m=a.z;return this.x=s*m-c*f,this.y=c*d-o*m,this.z=o*f-s*d,this}projectOnVector(e){const a=e.lengthSq();if(a===0)return this.set(0,0,0);const o=e.dot(this)/a;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return l4.copy(this).projectOnVector(e),this.sub(l4)}reflect(e){return this.sub(l4.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const a=Math.sqrt(this.lengthSq()*e.lengthSq());if(a===0)return Math.PI/2;const o=this.dot(e)/a;return Math.acos(Hr(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const a=this.x-e.x,o=this.y-e.y,s=this.z-e.z;return a*a+o*o+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,a,o){const s=Math.sin(a)*e;return this.x=s*Math.sin(o),this.y=Math.cos(a)*e,this.z=s*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,a,o){return this.x=e*Math.sin(a),this.y=o,this.z=e*Math.cos(a),this}setFromMatrixPosition(e){const a=e.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this}setFromMatrixScale(e){const a=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=a,this.y=o,this.z=s,this}setFromMatrixColumn(e,a){return this.fromArray(e.elements,a*4)}setFromMatrix3Column(e,a){return this.fromArray(e.elements,a*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this.z=e[a+2],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,a=Math.random()*Math.PI*2,o=Math.sqrt(1-e**2);return this.x=o*Math.cos(a),this.y=o*Math.sin(a),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const l4=new Fe,X7=new _s;class pu{constructor(e=new Fe(1/0,1/0,1/0),a=new Fe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=a}set(e,a){return this.min.copy(e),this.max.copy(a),this}setFromArray(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a+=3)this.expandByPoint(Zc.fromArray(e,a));return this}setFromBufferAttribute(e){this.makeEmpty();for(let a=0,o=e.count;a<o;a++)this.expandByPoint(Zc.fromBufferAttribute(e,a));return this}setFromPoints(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a++)this.expandByPoint(e[a]);return this}setFromCenterAndSize(e,a){const o=Zc.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}setFromObject(e,a=!1){return this.makeEmpty(),this.expandByObject(e,a)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,a=!1){e.updateWorldMatrix(!1,!1);const o=e.geometry;if(o!==void 0){const c=o.getAttribute("position");if(a===!0&&c!==void 0&&e.isInstancedMesh!==!0)for(let d=0,f=c.count;d<f;d++)e.isMesh===!0?e.getVertexPosition(d,Zc):Zc.fromBufferAttribute(c,d),Zc.applyMatrix4(e.matrixWorld),this.expandByPoint(Zc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),iS.copy(e.boundingBox)):(o.boundingBox===null&&o.computeBoundingBox(),iS.copy(o.boundingBox)),iS.applyMatrix4(e.matrixWorld),this.union(iS)}const s=e.children;for(let c=0,d=s.length;c<d;c++)this.expandByObject(s[c],a);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,a){return a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Zc),Zc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let a,o;return e.normal.x>0?(a=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(a=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(a+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(a+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(a+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(a+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),a<=-e.constant&&o>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Y1),rS.subVectors(this.max,Y1),Cv.subVectors(e.a,Y1),Pv.subVectors(e.b,Y1),Iv.subVectors(e.c,Y1),Rf.subVectors(Pv,Cv),kf.subVectors(Iv,Pv),Lm.subVectors(Cv,Iv);let a=[0,-Rf.z,Rf.y,0,-kf.z,kf.y,0,-Lm.z,Lm.y,Rf.z,0,-Rf.x,kf.z,0,-kf.x,Lm.z,0,-Lm.x,-Rf.y,Rf.x,0,-kf.y,kf.x,0,-Lm.y,Lm.x,0];return!c4(a,Cv,Pv,Iv,rS)||(a=[1,0,0,0,1,0,0,0,1],!c4(a,Cv,Pv,Iv,rS))?!1:(oS.crossVectors(Rf,kf),a=[oS.x,oS.y,oS.z],c4(a,Cv,Pv,Iv,rS))}clampPoint(e,a){return a.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Zc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Zc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ih[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ih[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ih[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ih[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ih[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ih[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ih[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ih[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ih),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ih=[new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe],Zc=new Fe,iS=new pu,Cv=new Fe,Pv=new Fe,Iv=new Fe,Rf=new Fe,kf=new Fe,Lm=new Fe,Y1=new Fe,rS=new Fe,oS=new Fe,Rm=new Fe;function c4(n,e,a,o,s){for(let c=0,d=n.length-3;c<=d;c+=3){Rm.fromArray(n,c);const f=s.x*Math.abs(Rm.x)+s.y*Math.abs(Rm.y)+s.z*Math.abs(Rm.z),m=e.dot(Rm),y=a.dot(Rm),_=o.dot(Rm);if(Math.max(-Math.max(m,y,_),Math.min(m,y,_))>f)return!1}return!0}const w0e=new pu,K1=new Fe,u4=new Fe;class Tc{constructor(e=new Fe,a=-1){this.center=e,this.radius=a}set(e,a){return this.center.copy(e),this.radius=a,this}setFromPoints(e,a){const o=this.center;a!==void 0?o.copy(a):w0e.setFromPoints(e).getCenter(o);let s=0;for(let c=0,d=e.length;c<d;c++)s=Math.max(s,o.distanceToSquared(e[c]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const a=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=a*a}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,a){const o=this.center.distanceToSquared(e);return a.copy(e),o>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;K1.subVectors(e,this.center);const a=K1.lengthSq();if(a>this.radius*this.radius){const o=Math.sqrt(a),s=(o-this.radius)*.5;this.center.addScaledVector(K1,s/o),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(u4.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(K1.copy(e.center).add(u4)),this.expandByPoint(K1.copy(e.center).sub(u4))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const rh=new Fe,d4=new Fe,sS=new Fe,Df=new Fe,h4=new Fe,lS=new Fe,f4=new Fe;class Wg{constructor(e=new Fe,a=new Fe(0,0,-1)){this.origin=e,this.direction=a}set(e,a){return this.origin.copy(e),this.direction.copy(a),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,a){return a.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rh)),this}closestPointToPoint(e,a){a.subVectors(e,this.origin);const o=a.dot(this.direction);return o<0?a.copy(this.origin):a.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const a=rh.subVectors(e,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(e):(rh.copy(this.origin).addScaledVector(this.direction,a),rh.distanceToSquared(e))}distanceSqToSegment(e,a,o,s){d4.copy(e).add(a).multiplyScalar(.5),sS.copy(a).sub(e).normalize(),Df.copy(this.origin).sub(d4);const c=e.distanceTo(a)*.5,d=-this.direction.dot(sS),f=Df.dot(this.direction),m=-Df.dot(sS),y=Df.lengthSq(),_=Math.abs(1-d*d);let w,A,C,I;if(_>0)if(w=d*m-f,A=d*f-m,I=c*_,w>=0)if(A>=-I)if(A<=I){const k=1/_;w*=k,A*=k,C=w*(w+d*A+2*f)+A*(d*w+A+2*m)+y}else A=c,w=Math.max(0,-(d*A+f)),C=-w*w+A*(A+2*m)+y;else A=-c,w=Math.max(0,-(d*A+f)),C=-w*w+A*(A+2*m)+y;else A<=-I?(w=Math.max(0,-(-d*c+f)),A=w>0?-c:Math.min(Math.max(-c,-m),c),C=-w*w+A*(A+2*m)+y):A<=I?(w=0,A=Math.min(Math.max(-c,-m),c),C=A*(A+2*m)+y):(w=Math.max(0,-(d*c+f)),A=w>0?c:Math.min(Math.max(-c,-m),c),C=-w*w+A*(A+2*m)+y);else A=d>0?-c:c,w=Math.max(0,-(d*A+f)),C=-w*w+A*(A+2*m)+y;return o&&o.copy(this.origin).addScaledVector(this.direction,w),s&&s.copy(d4).addScaledVector(sS,A),C}intersectSphere(e,a){rh.subVectors(e.center,this.origin);const o=rh.dot(this.direction),s=rh.dot(rh)-o*o,c=e.radius*e.radius;if(s>c)return null;const d=Math.sqrt(c-s),f=o-d,m=o+d;return m<0?null:f<0?this.at(m,a):this.at(f,a)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const a=e.normal.dot(this.direction);if(a===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/a;return o>=0?o:null}intersectPlane(e,a){const o=this.distanceToPlane(e);return o===null?null:this.at(o,a)}intersectsPlane(e){const a=e.distanceToPoint(this.origin);return a===0||e.normal.dot(this.direction)*a<0}intersectBox(e,a){let o,s,c,d,f,m;const y=1/this.direction.x,_=1/this.direction.y,w=1/this.direction.z,A=this.origin;return y>=0?(o=(e.min.x-A.x)*y,s=(e.max.x-A.x)*y):(o=(e.max.x-A.x)*y,s=(e.min.x-A.x)*y),_>=0?(c=(e.min.y-A.y)*_,d=(e.max.y-A.y)*_):(c=(e.max.y-A.y)*_,d=(e.min.y-A.y)*_),o>d||c>s||((c>o||isNaN(o))&&(o=c),(d<s||isNaN(s))&&(s=d),w>=0?(f=(e.min.z-A.z)*w,m=(e.max.z-A.z)*w):(f=(e.max.z-A.z)*w,m=(e.min.z-A.z)*w),o>m||f>s)||((f>o||o!==o)&&(o=f),(m<s||s!==s)&&(s=m),s<0)?null:this.at(o>=0?o:s,a)}intersectsBox(e){return this.intersectBox(e,rh)!==null}intersectTriangle(e,a,o,s,c){h4.subVectors(a,e),lS.subVectors(o,e),f4.crossVectors(h4,lS);let d=this.direction.dot(f4),f;if(d>0){if(s)return null;f=1}else if(d<0)f=-1,d=-d;else return null;Df.subVectors(this.origin,e);const m=f*this.direction.dot(lS.crossVectors(Df,lS));if(m<0)return null;const y=f*this.direction.dot(h4.cross(Df));if(y<0||m+y>d)return null;const _=-f*Df.dot(f4);return _<0?null:this.at(_/d,c)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ia{constructor(e,a,o,s,c,d,f,m,y,_,w,A,C,I,k,D){Ia.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,a,o,s,c,d,f,m,y,_,w,A,C,I,k,D)}set(e,a,o,s,c,d,f,m,y,_,w,A,C,I,k,D){const L=this.elements;return L[0]=e,L[4]=a,L[8]=o,L[12]=s,L[1]=c,L[5]=d,L[9]=f,L[13]=m,L[2]=y,L[6]=_,L[10]=w,L[14]=A,L[3]=C,L[7]=I,L[11]=k,L[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ia().fromArray(this.elements)}copy(e){const a=this.elements,o=e.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],this}copyPosition(e){const a=this.elements,o=e.elements;return a[12]=o[12],a[13]=o[13],a[14]=o[14],this}setFromMatrix3(e){const a=e.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this}extractBasis(e,a,o){return e.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,a,o){return this.set(e.x,a.x,o.x,0,e.y,a.y,o.y,0,e.z,a.z,o.z,0,0,0,0,1),this}extractRotation(e){const a=this.elements,o=e.elements,s=1/Lv.setFromMatrixColumn(e,0).length(),c=1/Lv.setFromMatrixColumn(e,1).length(),d=1/Lv.setFromMatrixColumn(e,2).length();return a[0]=o[0]*s,a[1]=o[1]*s,a[2]=o[2]*s,a[3]=0,a[4]=o[4]*c,a[5]=o[5]*c,a[6]=o[6]*c,a[7]=0,a[8]=o[8]*d,a[9]=o[9]*d,a[10]=o[10]*d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromEuler(e){const a=this.elements,o=e.x,s=e.y,c=e.z,d=Math.cos(o),f=Math.sin(o),m=Math.cos(s),y=Math.sin(s),_=Math.cos(c),w=Math.sin(c);if(e.order==="XYZ"){const A=d*_,C=d*w,I=f*_,k=f*w;a[0]=m*_,a[4]=-m*w,a[8]=y,a[1]=C+I*y,a[5]=A-k*y,a[9]=-f*m,a[2]=k-A*y,a[6]=I+C*y,a[10]=d*m}else if(e.order==="YXZ"){const A=m*_,C=m*w,I=y*_,k=y*w;a[0]=A+k*f,a[4]=I*f-C,a[8]=d*y,a[1]=d*w,a[5]=d*_,a[9]=-f,a[2]=C*f-I,a[6]=k+A*f,a[10]=d*m}else if(e.order==="ZXY"){const A=m*_,C=m*w,I=y*_,k=y*w;a[0]=A-k*f,a[4]=-d*w,a[8]=I+C*f,a[1]=C+I*f,a[5]=d*_,a[9]=k-A*f,a[2]=-d*y,a[6]=f,a[10]=d*m}else if(e.order==="ZYX"){const A=d*_,C=d*w,I=f*_,k=f*w;a[0]=m*_,a[4]=I*y-C,a[8]=A*y+k,a[1]=m*w,a[5]=k*y+A,a[9]=C*y-I,a[2]=-y,a[6]=f*m,a[10]=d*m}else if(e.order==="YZX"){const A=d*m,C=d*y,I=f*m,k=f*y;a[0]=m*_,a[4]=k-A*w,a[8]=I*w+C,a[1]=w,a[5]=d*_,a[9]=-f*_,a[2]=-y*_,a[6]=C*w+I,a[10]=A-k*w}else if(e.order==="XZY"){const A=d*m,C=d*y,I=f*m,k=f*y;a[0]=m*_,a[4]=-w,a[8]=y*_,a[1]=A*w+k,a[5]=d*_,a[9]=C*w-I,a[2]=I*w-C,a[6]=f*_,a[10]=k*w+A}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(e){return this.compose(S0e,e,A0e)}lookAt(e,a,o){const s=this.elements;return Dl.subVectors(e,a),Dl.lengthSq()===0&&(Dl.z=1),Dl.normalize(),Of.crossVectors(o,Dl),Of.lengthSq()===0&&(Math.abs(o.z)===1?Dl.x+=1e-4:Dl.z+=1e-4,Dl.normalize(),Of.crossVectors(o,Dl)),Of.normalize(),cS.crossVectors(Dl,Of),s[0]=Of.x,s[4]=cS.x,s[8]=Dl.x,s[1]=Of.y,s[5]=cS.y,s[9]=Dl.y,s[2]=Of.z,s[6]=cS.z,s[10]=Dl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,a){const o=e.elements,s=a.elements,c=this.elements,d=o[0],f=o[4],m=o[8],y=o[12],_=o[1],w=o[5],A=o[9],C=o[13],I=o[2],k=o[6],D=o[10],L=o[14],O=o[3],F=o[7],B=o[11],G=o[15],q=s[0],X=s[4],ee=s[8],V=s[12],Q=s[1],me=s[5],pe=s[9],be=s[13],fe=s[2],Ce=s[6],Re=s[10],He=s[14],ue=s[3],ye=s[7],Ae=s[11],ne=s[15];return c[0]=d*q+f*Q+m*fe+y*ue,c[4]=d*X+f*me+m*Ce+y*ye,c[8]=d*ee+f*pe+m*Re+y*Ae,c[12]=d*V+f*be+m*He+y*ne,c[1]=_*q+w*Q+A*fe+C*ue,c[5]=_*X+w*me+A*Ce+C*ye,c[9]=_*ee+w*pe+A*Re+C*Ae,c[13]=_*V+w*be+A*He+C*ne,c[2]=I*q+k*Q+D*fe+L*ue,c[6]=I*X+k*me+D*Ce+L*ye,c[10]=I*ee+k*pe+D*Re+L*Ae,c[14]=I*V+k*be+D*He+L*ne,c[3]=O*q+F*Q+B*fe+G*ue,c[7]=O*X+F*me+B*Ce+G*ye,c[11]=O*ee+F*pe+B*Re+G*Ae,c[15]=O*V+F*be+B*He+G*ne,this}multiplyScalar(e){const a=this.elements;return a[0]*=e,a[4]*=e,a[8]*=e,a[12]*=e,a[1]*=e,a[5]*=e,a[9]*=e,a[13]*=e,a[2]*=e,a[6]*=e,a[10]*=e,a[14]*=e,a[3]*=e,a[7]*=e,a[11]*=e,a[15]*=e,this}determinant(){const e=this.elements,a=e[0],o=e[4],s=e[8],c=e[12],d=e[1],f=e[5],m=e[9],y=e[13],_=e[2],w=e[6],A=e[10],C=e[14],I=e[3],k=e[7],D=e[11],L=e[15];return I*(+c*m*w-s*y*w-c*f*A+o*y*A+s*f*C-o*m*C)+k*(+a*m*C-a*y*A+c*d*A-s*d*C+s*y*_-c*m*_)+D*(+a*y*w-a*f*C-c*d*w+o*d*C+c*f*_-o*y*_)+L*(-s*f*_-a*m*w+a*f*A+s*d*w-o*d*A+o*m*_)}transpose(){const e=this.elements;let a;return a=e[1],e[1]=e[4],e[4]=a,a=e[2],e[2]=e[8],e[8]=a,a=e[6],e[6]=e[9],e[9]=a,a=e[3],e[3]=e[12],e[12]=a,a=e[7],e[7]=e[13],e[13]=a,a=e[11],e[11]=e[14],e[14]=a,this}setPosition(e,a,o){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=a,s[14]=o),this}invert(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8],w=e[9],A=e[10],C=e[11],I=e[12],k=e[13],D=e[14],L=e[15],O=w*D*y-k*A*y+k*m*C-f*D*C-w*m*L+f*A*L,F=I*A*y-_*D*y-I*m*C+d*D*C+_*m*L-d*A*L,B=_*k*y-I*w*y+I*f*C-d*k*C-_*f*L+d*w*L,G=I*w*m-_*k*m-I*f*A+d*k*A+_*f*D-d*w*D,q=a*O+o*F+s*B+c*G;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const X=1/q;return e[0]=O*X,e[1]=(k*A*c-w*D*c-k*s*C+o*D*C+w*s*L-o*A*L)*X,e[2]=(f*D*c-k*m*c+k*s*y-o*D*y-f*s*L+o*m*L)*X,e[3]=(w*m*c-f*A*c-w*s*y+o*A*y+f*s*C-o*m*C)*X,e[4]=F*X,e[5]=(_*D*c-I*A*c+I*s*C-a*D*C-_*s*L+a*A*L)*X,e[6]=(I*m*c-d*D*c-I*s*y+a*D*y+d*s*L-a*m*L)*X,e[7]=(d*A*c-_*m*c+_*s*y-a*A*y-d*s*C+a*m*C)*X,e[8]=B*X,e[9]=(I*w*c-_*k*c-I*o*C+a*k*C+_*o*L-a*w*L)*X,e[10]=(d*k*c-I*f*c+I*o*y-a*k*y-d*o*L+a*f*L)*X,e[11]=(_*f*c-d*w*c-_*o*y+a*w*y+d*o*C-a*f*C)*X,e[12]=G*X,e[13]=(_*k*s-I*w*s+I*o*A-a*k*A-_*o*D+a*w*D)*X,e[14]=(I*f*s-d*k*s-I*o*m+a*k*m+d*o*D-a*f*D)*X,e[15]=(d*w*s-_*f*s+_*o*m-a*w*m-d*o*A+a*f*A)*X,this}scale(e){const a=this.elements,o=e.x,s=e.y,c=e.z;return a[0]*=o,a[4]*=s,a[8]*=c,a[1]*=o,a[5]*=s,a[9]*=c,a[2]*=o,a[6]*=s,a[10]*=c,a[3]*=o,a[7]*=s,a[11]*=c,this}getMaxScaleOnAxis(){const e=this.elements,a=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(a,o,s))}makeTranslation(e,a,o){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,a,0,0,1,o,0,0,0,1),this}makeRotationX(e){const a=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,a,-o,0,0,o,a,0,0,0,0,1),this}makeRotationY(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,0,o,0,0,1,0,0,-o,0,a,0,0,0,0,1),this}makeRotationZ(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,-o,0,0,o,a,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,a){const o=Math.cos(a),s=Math.sin(a),c=1-o,d=e.x,f=e.y,m=e.z,y=c*d,_=c*f;return this.set(y*d+o,y*f-s*m,y*m+s*f,0,y*f+s*m,_*f+o,_*m-s*d,0,y*m-s*f,_*m+s*d,c*m*m+o,0,0,0,0,1),this}makeScale(e,a,o){return this.set(e,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,a,o,s,c,d){return this.set(1,o,c,0,e,1,d,0,a,s,1,0,0,0,0,1),this}compose(e,a,o){const s=this.elements,c=a._x,d=a._y,f=a._z,m=a._w,y=c+c,_=d+d,w=f+f,A=c*y,C=c*_,I=c*w,k=d*_,D=d*w,L=f*w,O=m*y,F=m*_,B=m*w,G=o.x,q=o.y,X=o.z;return s[0]=(1-(k+L))*G,s[1]=(C+B)*G,s[2]=(I-F)*G,s[3]=0,s[4]=(C-B)*q,s[5]=(1-(A+L))*q,s[6]=(D+O)*q,s[7]=0,s[8]=(I+F)*X,s[9]=(D-O)*X,s[10]=(1-(A+k))*X,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,a,o){const s=this.elements;let c=Lv.set(s[0],s[1],s[2]).length();const d=Lv.set(s[4],s[5],s[6]).length(),f=Lv.set(s[8],s[9],s[10]).length();this.determinant()<0&&(c=-c),e.x=s[12],e.y=s[13],e.z=s[14],Yc.copy(this);const y=1/c,_=1/d,w=1/f;return Yc.elements[0]*=y,Yc.elements[1]*=y,Yc.elements[2]*=y,Yc.elements[4]*=_,Yc.elements[5]*=_,Yc.elements[6]*=_,Yc.elements[8]*=w,Yc.elements[9]*=w,Yc.elements[10]*=w,a.setFromRotationMatrix(Yc),o.x=c,o.y=d,o.z=f,this}makePerspective(e,a,o,s,c,d,f=sd){const m=this.elements,y=2*c/(a-e),_=2*c/(o-s),w=(a+e)/(a-e),A=(o+s)/(o-s);let C,I;if(f===sd)C=-(d+c)/(d-c),I=-2*d*c/(d-c);else if(f===Gx)C=-d/(d-c),I=-d*c/(d-c);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return m[0]=y,m[4]=0,m[8]=w,m[12]=0,m[1]=0,m[5]=_,m[9]=A,m[13]=0,m[2]=0,m[6]=0,m[10]=C,m[14]=I,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,a,o,s,c,d,f=sd){const m=this.elements,y=1/(a-e),_=1/(o-s),w=1/(d-c),A=(a+e)*y,C=(o+s)*_;let I,k;if(f===sd)I=(d+c)*w,k=-2*w;else if(f===Gx)I=c*w,k=-1*w;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-A,m[1]=0,m[5]=2*_,m[9]=0,m[13]=-C,m[2]=0,m[6]=0,m[10]=k,m[14]=-I,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const a=this.elements,o=e.elements;for(let s=0;s<16;s++)if(a[s]!==o[s])return!1;return!0}fromArray(e,a=0){for(let o=0;o<16;o++)this.elements[o]=e[o+a];return this}toArray(e=[],a=0){const o=this.elements;return e[a]=o[0],e[a+1]=o[1],e[a+2]=o[2],e[a+3]=o[3],e[a+4]=o[4],e[a+5]=o[5],e[a+6]=o[6],e[a+7]=o[7],e[a+8]=o[8],e[a+9]=o[9],e[a+10]=o[10],e[a+11]=o[11],e[a+12]=o[12],e[a+13]=o[13],e[a+14]=o[14],e[a+15]=o[15],e}}const Lv=new Fe,Yc=new Ia,S0e=new Fe(0,0,0),A0e=new Fe(1,1,1),Of=new Fe,cS=new Fe,Dl=new Fe,Z7=new Ia,Y7=new _s;class Tw{constructor(e=0,a=0,o=0,s=Tw.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=a,this._z=o,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,a,o,s=this._order){return this._x=e,this._y=a,this._z=o,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,a=this._order,o=!0){const s=e.elements,c=s[0],d=s[4],f=s[8],m=s[1],y=s[5],_=s[9],w=s[2],A=s[6],C=s[10];switch(a){case"XYZ":this._y=Math.asin(Hr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,C),this._z=Math.atan2(-d,c)):(this._x=Math.atan2(A,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Hr(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(f,C),this._z=Math.atan2(m,y)):(this._y=Math.atan2(-w,c),this._z=0);break;case"ZXY":this._x=Math.asin(Hr(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-w,C),this._z=Math.atan2(-d,y)):(this._y=0,this._z=Math.atan2(m,c));break;case"ZYX":this._y=Math.asin(-Hr(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(A,C),this._z=Math.atan2(m,c)):(this._x=0,this._z=Math.atan2(-d,y));break;case"YZX":this._z=Math.asin(Hr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-_,y),this._y=Math.atan2(-w,c)):(this._x=0,this._y=Math.atan2(f,C));break;case"XZY":this._z=Math.asin(-Hr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(A,y),this._y=Math.atan2(f,c)):(this._x=Math.atan2(-_,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,a,o){return Z7.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Z7,a,o)}setFromVector3(e,a=this._order){return this.set(e.x,e.y,e.z,a)}reorder(e){return Y7.setFromEuler(this),this.setFromQuaternion(Y7,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],a=0){return e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Tw.DEFAULT_ORDER="XYZ";class _g{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let E0e=0;const K7=new Fe,Rv=new _s,oh=new Ia,uS=new Fe,J1=new Fe,M0e=new Fe,T0e=new _s,J7=new Fe(1,0,0),Q7=new Fe(0,1,0),eW=new Fe(0,0,1),C0e={type:"added"},P0e={type:"removed"};class fi extends _d{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:E0e++}),this.uuid=$l(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=fi.DEFAULT_UP.clone();const e=new Fe,a=new Tw,o=new _s,s=new Fe(1,1,1);function c(){o.setFromEuler(a,!1)}function d(){a.setFromQuaternion(o,void 0,!1)}a._onChange(c),o._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:a},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ia},normalMatrix:{value:new Na}}),this.matrix=new Ia,this.matrixWorld=new Ia,this.matrixAutoUpdate=fi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new _g,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,a){this.quaternion.setFromAxisAngle(e,a)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,a){return Rv.setFromAxisAngle(e,a),this.quaternion.multiply(Rv),this}rotateOnWorldAxis(e,a){return Rv.setFromAxisAngle(e,a),this.quaternion.premultiply(Rv),this}rotateX(e){return this.rotateOnAxis(J7,e)}rotateY(e){return this.rotateOnAxis(Q7,e)}rotateZ(e){return this.rotateOnAxis(eW,e)}translateOnAxis(e,a){return K7.copy(e).applyQuaternion(this.quaternion),this.position.add(K7.multiplyScalar(a)),this}translateX(e){return this.translateOnAxis(J7,e)}translateY(e){return this.translateOnAxis(Q7,e)}translateZ(e){return this.translateOnAxis(eW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(oh.copy(this.matrixWorld).invert())}lookAt(e,a,o){e.isVector3?uS.copy(e):uS.set(e,a,o);const s=this.parent;this.updateWorldMatrix(!0,!1),J1.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?oh.lookAt(J1,uS,this.up):oh.lookAt(uS,J1,this.up),this.quaternion.setFromRotationMatrix(oh),s&&(oh.extractRotation(s.matrixWorld),Rv.setFromRotationMatrix(oh),this.quaternion.premultiply(Rv.invert()))}add(e){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(C0e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const a=this.children.indexOf(e);return a!==-1&&(e.parent=null,this.children.splice(a,1),e.dispatchEvent(P0e)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),oh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),oh.multiply(e.parent.matrixWorld)),e.applyMatrix4(oh),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,a){if(this[e]===a)return this;for(let o=0,s=this.children.length;o<s;o++){const d=this.children[o].getObjectByProperty(e,a);if(d!==void 0)return d}}getObjectsByProperty(e,a){let o=[];this[e]===a&&o.push(this);for(let s=0,c=this.children.length;s<c;s++){const d=this.children[s].getObjectsByProperty(e,a);d.length>0&&(o=o.concat(d))}return o}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(J1,e,M0e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(J1,T0e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const a=this.matrixWorld.elements;return e.set(a[8],a[9],a[10]).normalize()}raycast(){}traverse(e){e(this);const a=this.children;for(let o=0,s=a.length;o<s;o++)a[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const a=this.children;for(let o=0,s=a.length;o<s;o++)a[o].traverseVisible(e)}traverseAncestors(e){const a=this.parent;a!==null&&(e(a),a.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const a=this.children;for(let o=0,s=a.length;o<s;o++){const c=a[o];(c.matrixWorldAutoUpdate===!0||e===!0)&&c.updateMatrixWorld(e)}}updateWorldMatrix(e,a){const o=this.parent;if(e===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),a===!0){const s=this.children;for(let c=0,d=s.length;c<d;c++){const f=s[c];f.matrixWorldAutoUpdate===!0&&f.updateWorldMatrix(!1,!0)}}}toJSON(e){const a=e===void 0||typeof e=="string",o={};a&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function c(f,m){return f[m.uuid]===void 0&&(f[m.uuid]=m.toJSON(e)),m.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=c(e.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const m=f.shapes;if(Array.isArray(m))for(let y=0,_=m.length;y<_;y++){const w=m[y];c(e.shapes,w)}else c(e.shapes,m)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let m=0,y=this.material.length;m<y;m++)f.push(c(e.materials,this.material[m]));s.material=f}else s.material=c(e.materials,this.material);if(this.children.length>0){s.children=[];for(let f=0;f<this.children.length;f++)s.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let f=0;f<this.animations.length;f++){const m=this.animations[f];s.animations.push(c(e.animations,m))}}if(a){const f=d(e.geometries),m=d(e.materials),y=d(e.textures),_=d(e.images),w=d(e.shapes),A=d(e.skeletons),C=d(e.animations),I=d(e.nodes);f.length>0&&(o.geometries=f),m.length>0&&(o.materials=m),y.length>0&&(o.textures=y),_.length>0&&(o.images=_),w.length>0&&(o.shapes=w),A.length>0&&(o.skeletons=A),C.length>0&&(o.animations=C),I.length>0&&(o.nodes=I)}return o.object=s,o;function d(f){const m=[];for(const y in f){const _=f[y];delete _.metadata,m.push(_)}return m}}clone(e){return new this.constructor().copy(this,e)}copy(e,a=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),a===!0)for(let o=0;o<e.children.length;o++){const s=e.children[o];this.add(s.clone())}return this}}fi.DEFAULT_UP=new Fe(0,1,0);fi.DEFAULT_MATRIX_AUTO_UPDATE=!0;fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Kc=new Fe,sh=new Fe,p4=new Fe,lh=new Fe,kv=new Fe,Dv=new Fe,tW=new Fe,m4=new Fe,g4=new Fe,y4=new Fe;let dS=!1;class dl{constructor(e=new Fe,a=new Fe,o=new Fe){this.a=e,this.b=a,this.c=o}static getNormal(e,a,o,s){s.subVectors(o,a),Kc.subVectors(e,a),s.cross(Kc);const c=s.lengthSq();return c>0?s.multiplyScalar(1/Math.sqrt(c)):s.set(0,0,0)}static getBarycoord(e,a,o,s,c){Kc.subVectors(s,a),sh.subVectors(o,a),p4.subVectors(e,a);const d=Kc.dot(Kc),f=Kc.dot(sh),m=Kc.dot(p4),y=sh.dot(sh),_=sh.dot(p4),w=d*y-f*f;if(w===0)return c.set(-2,-1,-1);const A=1/w,C=(y*m-f*_)*A,I=(d*_-f*m)*A;return c.set(1-C-I,I,C)}static containsPoint(e,a,o,s){return this.getBarycoord(e,a,o,s,lh),lh.x>=0&&lh.y>=0&&lh.x+lh.y<=1}static getUV(e,a,o,s,c,d,f,m){return dS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),dS=!0),this.getInterpolation(e,a,o,s,c,d,f,m)}static getInterpolation(e,a,o,s,c,d,f,m){return this.getBarycoord(e,a,o,s,lh),m.setScalar(0),m.addScaledVector(c,lh.x),m.addScaledVector(d,lh.y),m.addScaledVector(f,lh.z),m}static isFrontFacing(e,a,o,s){return Kc.subVectors(o,a),sh.subVectors(e,a),Kc.cross(sh).dot(s)<0}set(e,a,o){return this.a.copy(e),this.b.copy(a),this.c.copy(o),this}setFromPointsAndIndices(e,a,o,s){return this.a.copy(e[a]),this.b.copy(e[o]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,a,o,s){return this.a.fromBufferAttribute(e,a),this.b.fromBufferAttribute(e,o),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Kc.subVectors(this.c,this.b),sh.subVectors(this.a,this.b),Kc.cross(sh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return dl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,a){return dl.getBarycoord(e,this.a,this.b,this.c,a)}getUV(e,a,o,s,c){return dS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),dS=!0),dl.getInterpolation(e,this.a,this.b,this.c,a,o,s,c)}getInterpolation(e,a,o,s,c){return dl.getInterpolation(e,this.a,this.b,this.c,a,o,s,c)}containsPoint(e){return dl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return dl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,a){const o=this.a,s=this.b,c=this.c;let d,f;kv.subVectors(s,o),Dv.subVectors(c,o),m4.subVectors(e,o);const m=kv.dot(m4),y=Dv.dot(m4);if(m<=0&&y<=0)return a.copy(o);g4.subVectors(e,s);const _=kv.dot(g4),w=Dv.dot(g4);if(_>=0&&w<=_)return a.copy(s);const A=m*w-_*y;if(A<=0&&m>=0&&_<=0)return d=m/(m-_),a.copy(o).addScaledVector(kv,d);y4.subVectors(e,c);const C=kv.dot(y4),I=Dv.dot(y4);if(I>=0&&C<=I)return a.copy(c);const k=C*y-m*I;if(k<=0&&y>=0&&I<=0)return f=y/(y-I),a.copy(o).addScaledVector(Dv,f);const D=_*I-C*w;if(D<=0&&w-_>=0&&C-I>=0)return tW.subVectors(c,s),f=(w-_)/(w-_+(C-I)),a.copy(s).addScaledVector(tW,f);const L=1/(D+k+A);return d=k*L,f=A*L,a.copy(o).addScaledVector(kv,d).addScaledVector(Dv,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const CZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},zf={h:0,s:0,l:0},hS={h:0,s:0,l:0};function v4(n,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?n+(e-n)*6*a:a<1/2?e:a<2/3?n+(e-n)*6*(2/3-a):n}let Pn=class{constructor(e,a,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,a,o)}set(e,a,o){if(a===void 0&&o===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,a,o);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,a=To){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Oi.toWorkingColorSpace(this,a),this}setRGB(e,a,o,s=Oi.workingColorSpace){return this.r=e,this.g=a,this.b=o,Oi.toWorkingColorSpace(this,s),this}setHSL(e,a,o,s=Oi.workingColorSpace){if(e=BD(e,1),a=Hr(a,0,1),o=Hr(o,0,1),a===0)this.r=this.g=this.b=o;else{const c=o<=.5?o*(1+a):o+a-o*a,d=2*o-c;this.r=v4(d,c,e+1/3),this.g=v4(d,c,e),this.b=v4(d,c,e-1/3)}return Oi.toWorkingColorSpace(this,s),this}setStyle(e,a=To){function o(c){c!==void 0&&parseFloat(c)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let c;const d=s[1],f=s[2];switch(d){case"rgb":case"rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setRGB(Math.min(255,parseInt(c[1],10))/255,Math.min(255,parseInt(c[2],10))/255,Math.min(255,parseInt(c[3],10))/255,a);if(c=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setRGB(Math.min(100,parseInt(c[1],10))/100,Math.min(100,parseInt(c[2],10))/100,Math.min(100,parseInt(c[3],10))/100,a);break;case"hsl":case"hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setHSL(parseFloat(c[1])/360,parseFloat(c[2])/100,parseFloat(c[3])/100,a);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const c=s[1],d=c.length;if(d===3)return this.setRGB(parseInt(c.charAt(0),16)/15,parseInt(c.charAt(1),16)/15,parseInt(c.charAt(2),16)/15,a);if(d===6)return this.setHex(parseInt(c,16),a);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,a);return this}setColorName(e,a=To){const o=CZ[e.toLowerCase()];return o!==void 0?this.setHex(o,a):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=R0(e.r),this.g=R0(e.g),this.b=R0(e.b),this}copyLinearToSRGB(e){return this.r=o4(e.r),this.g=o4(e.g),this.b=o4(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=To){return Oi.fromWorkingColorSpace(ds.copy(this),e),Math.round(Hr(ds.r*255,0,255))*65536+Math.round(Hr(ds.g*255,0,255))*256+Math.round(Hr(ds.b*255,0,255))}getHexString(e=To){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,a=Oi.workingColorSpace){Oi.fromWorkingColorSpace(ds.copy(this),a);const o=ds.r,s=ds.g,c=ds.b,d=Math.max(o,s,c),f=Math.min(o,s,c);let m,y;const _=(f+d)/2;if(f===d)m=0,y=0;else{const w=d-f;switch(y=_<=.5?w/(d+f):w/(2-d-f),d){case o:m=(s-c)/w+(s<c?6:0);break;case s:m=(c-o)/w+2;break;case c:m=(o-s)/w+4;break}m/=6}return e.h=m,e.s=y,e.l=_,e}getRGB(e,a=Oi.workingColorSpace){return Oi.fromWorkingColorSpace(ds.copy(this),a),e.r=ds.r,e.g=ds.g,e.b=ds.b,e}getStyle(e=To){Oi.fromWorkingColorSpace(ds.copy(this),e);const a=ds.r,o=ds.g,s=ds.b;return e!==To?`color(${e} ${a.toFixed(3)} ${o.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(a*255)},${Math.round(o*255)},${Math.round(s*255)})`}offsetHSL(e,a,o){return this.getHSL(zf),this.setHSL(zf.h+e,zf.s+a,zf.l+o)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,a){return this.r=e.r+a.r,this.g=e.g+a.g,this.b=e.b+a.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,a){return this.r+=(e.r-this.r)*a,this.g+=(e.g-this.g)*a,this.b+=(e.b-this.b)*a,this}lerpColors(e,a,o){return this.r=e.r+(a.r-e.r)*o,this.g=e.g+(a.g-e.g)*o,this.b=e.b+(a.b-e.b)*o,this}lerpHSL(e,a){this.getHSL(zf),e.getHSL(hS);const o=Xb(zf.h,hS.h,a),s=Xb(zf.s,hS.s,a),c=Xb(zf.l,hS.l,a);return this.setHSL(o,s,c),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const a=this.r,o=this.g,s=this.b,c=e.elements;return this.r=c[0]*a+c[3]*o+c[6]*s,this.g=c[1]*a+c[4]*o+c[7]*s,this.b=c[2]*a+c[5]*o+c[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,a=0){return this.r=e[a],this.g=e[a+1],this.b=e[a+2],this}toArray(e=[],a=0){return e[a]=this.r,e[a+1]=this.g,e[a+2]=this.b,e}fromBufferAttribute(e,a){return this.r=e.getX(a),this.g=e.getY(a),this.b=e.getZ(a),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ds=new Pn;Pn.NAMES=CZ;let I0e=0;class Ko extends _d{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:I0e++}),this.uuid=$l(),this.name="",this.type="Material",this.blending=yg,this.side=md,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=NE,this.blendDst=BE,this.blendEquation=Hf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pn(0,0,0),this.blendAlpha=0,this.depthFunc=Lx,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=lR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Km,this.stencilZFail=Km,this.stencilZPass=Km,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const a in e){const o=e[a];if(o===void 0){console.warn(`THREE.Material: parameter '${a}' has value of undefined.`);continue}const s=this[a];if(s===void 0){console.warn(`THREE.Material: '${a}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(o):s&&s.isVector3&&o&&o.isVector3?s.copy(o):this[a]=o}}toJSON(e){const a=e===void 0||typeof e=="string";a&&(e={textures:{},images:{}});const o={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(o.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(o.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(o.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==yg&&(o.blending=this.blending),this.side!==md&&(o.side=this.side),this.vertexColors===!0&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=!0),this.blendSrc!==NE&&(o.blendSrc=this.blendSrc),this.blendDst!==BE&&(o.blendDst=this.blendDst),this.blendEquation!==Hf&&(o.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(o.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(o.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(o.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(o.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(o.blendAlpha=this.blendAlpha),this.depthFunc!==Lx&&(o.depthFunc=this.depthFunc),this.depthTest===!1&&(o.depthTest=this.depthTest),this.depthWrite===!1&&(o.depthWrite=this.depthWrite),this.colorWrite===!1&&(o.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(o.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==lR&&(o.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(o.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(o.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Km&&(o.stencilFail=this.stencilFail),this.stencilZFail!==Km&&(o.stencilZFail=this.stencilZFail),this.stencilZPass!==Km&&(o.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(o.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaHash===!0&&(o.alphaHash=!0),this.alphaToCoverage===!0&&(o.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=!0),this.forceSinglePass===!0&&(o.forceSinglePass=!0),this.wireframe===!0&&(o.wireframe=!0),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=!0),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function s(c){const d=[];for(const f in c){const m=c[f];delete m.metadata,d.push(m)}return d}if(a){const c=s(e.textures),d=s(e.images);c.length>0&&(o.textures=c),d.length>0&&(o.images=d)}return o}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const a=e.clippingPlanes;let o=null;if(a!==null){const s=a.length;o=new Array(s);for(let c=0;c!==s;++c)o[c]=a[c].clone()}return this.clippingPlanes=o,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Vh extends Ko{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ew,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _h=L0e();function L0e(){const n=new ArrayBuffer(4),e=new Float32Array(n),a=new Uint32Array(n),o=new Uint32Array(512),s=new Uint32Array(512);for(let m=0;m<256;++m){const y=m-127;y<-27?(o[m]=0,o[m|256]=32768,s[m]=24,s[m|256]=24):y<-14?(o[m]=1024>>-y-14,o[m|256]=1024>>-y-14|32768,s[m]=-y-1,s[m|256]=-y-1):y<=15?(o[m]=y+15<<10,o[m|256]=y+15<<10|32768,s[m]=13,s[m|256]=13):y<128?(o[m]=31744,o[m|256]=64512,s[m]=24,s[m|256]=24):(o[m]=31744,o[m|256]=64512,s[m]=13,s[m|256]=13)}const c=new Uint32Array(2048),d=new Uint32Array(64),f=new Uint32Array(64);for(let m=1;m<1024;++m){let y=m<<13,_=0;for(;!(y&8388608);)y<<=1,_-=8388608;y&=-8388609,_+=947912704,c[m]=y|_}for(let m=1024;m<2048;++m)c[m]=939524096+(m-1024<<13);for(let m=1;m<31;++m)d[m]=m<<23;d[31]=1199570944,d[32]=2147483648;for(let m=33;m<63;++m)d[m]=2147483648+(m-32<<23);d[63]=3347054592;for(let m=1;m<64;++m)m!==32&&(f[m]=1024);return{floatView:e,uint32View:a,baseTable:o,shiftTable:s,mantissaTable:c,exponentTable:d,offsetTable:f}}function cl(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Hr(n,-65504,65504),_h.floatView[0]=n;const e=_h.uint32View[0],a=e>>23&511;return _h.baseTable[a]+((e&8388607)>>_h.shiftTable[a])}function Sb(n){const e=n>>10;return _h.uint32View[0]=_h.mantissaTable[_h.offsetTable[e]+(n&1023)]+_h.exponentTable[e],_h.floatView[0]}const R0e={toHalfFloat:cl,fromHalfFloat:Sb},yo=new Fe,fS=new Kt;class qi{constructor(e,a,o=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=a,this.count=e!==void 0?e.length/a:0,this.normalized=o,this.usage=Vx,this.updateRange={offset:0,count:-1},this.gpuType=od,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,a,o){e*=this.itemSize,o*=a.itemSize;for(let s=0,c=this.itemSize;s<c;s++)this.array[e+s]=a.array[o+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let a=0,o=this.count;a<o;a++)fS.fromBufferAttribute(this,a),fS.applyMatrix3(e),this.setXY(a,fS.x,fS.y);else if(this.itemSize===3)for(let a=0,o=this.count;a<o;a++)yo.fromBufferAttribute(this,a),yo.applyMatrix3(e),this.setXYZ(a,yo.x,yo.y,yo.z);return this}applyMatrix4(e){for(let a=0,o=this.count;a<o;a++)yo.fromBufferAttribute(this,a),yo.applyMatrix4(e),this.setXYZ(a,yo.x,yo.y,yo.z);return this}applyNormalMatrix(e){for(let a=0,o=this.count;a<o;a++)yo.fromBufferAttribute(this,a),yo.applyNormalMatrix(e),this.setXYZ(a,yo.x,yo.y,yo.z);return this}transformDirection(e){for(let a=0,o=this.count;a<o;a++)yo.fromBufferAttribute(this,a),yo.transformDirection(e),this.setXYZ(a,yo.x,yo.y,yo.z);return this}set(e,a=0){return this.array.set(e,a),this}getComponent(e,a){let o=this.array[e*this.itemSize+a];return this.normalized&&(o=fl(o,this.array)),o}setComponent(e,a,o){return this.normalized&&(o=Ba(o,this.array)),this.array[e*this.itemSize+a]=o,this}getX(e){let a=this.array[e*this.itemSize];return this.normalized&&(a=fl(a,this.array)),a}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize]=a,this}getY(e){let a=this.array[e*this.itemSize+1];return this.normalized&&(a=fl(a,this.array)),a}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+1]=a,this}getZ(e){let a=this.array[e*this.itemSize+2];return this.normalized&&(a=fl(a,this.array)),a}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+2]=a,this}getW(e){let a=this.array[e*this.itemSize+3];return this.normalized&&(a=fl(a,this.array)),a}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+3]=a,this}setXY(e,a,o){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.array[e+0]=a,this.array[e+1]=o,this}setXYZ(e,a,o,s){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.array[e+0]=a,this.array[e+1]=o,this.array[e+2]=s,this}setXYZW(e,a,o,s,c){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.array[e+0]=a,this.array[e+1]=o,this.array[e+2]=s,this.array[e+3]=c,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Vx&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class k0e extends qi{constructor(e,a,o){super(new Int8Array(e),a,o)}}class D0e extends qi{constructor(e,a,o){super(new Uint8Array(e),a,o)}}class O0e extends qi{constructor(e,a,o){super(new Uint8ClampedArray(e),a,o)}}class z0e extends qi{constructor(e,a,o){super(new Int16Array(e),a,o)}}class VD extends qi{constructor(e,a,o){super(new Uint16Array(e),a,o)}}class F0e extends qi{constructor(e,a,o){super(new Int32Array(e),a,o)}}class GD extends qi{constructor(e,a,o){super(new Uint32Array(e),a,o)}}class N0e extends qi{constructor(e,a,o){super(new Uint16Array(e),a,o),this.isFloat16BufferAttribute=!0}getX(e){let a=Sb(this.array[e*this.itemSize]);return this.normalized&&(a=fl(a,this.array)),a}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize]=cl(a),this}getY(e){let a=Sb(this.array[e*this.itemSize+1]);return this.normalized&&(a=fl(a,this.array)),a}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+1]=cl(a),this}getZ(e){let a=Sb(this.array[e*this.itemSize+2]);return this.normalized&&(a=fl(a,this.array)),a}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+2]=cl(a),this}getW(e){let a=Sb(this.array[e*this.itemSize+3]);return this.normalized&&(a=fl(a,this.array)),a}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+3]=cl(a),this}setXY(e,a,o){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.array[e+0]=cl(a),this.array[e+1]=cl(o),this}setXYZ(e,a,o,s){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.array[e+0]=cl(a),this.array[e+1]=cl(o),this.array[e+2]=cl(s),this}setXYZW(e,a,o,s,c){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.array[e+0]=cl(a),this.array[e+1]=cl(o),this.array[e+2]=cl(s),this.array[e+3]=cl(c),this}}class Wn extends qi{constructor(e,a,o){super(new Float32Array(e),a,o)}}class B0e extends qi{constructor(e,a,o){super(new Float64Array(e),a,o)}}let U0e=0;const fc=new Ia,_4=new fi,Ov=new Fe,Ol=new pu,Q1=new pu,Oo=new Fe;class La extends _d{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:U0e++}),this.uuid=$l(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(EZ(e)?GD:VD)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,a){return this.attributes[e]=a,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,a,o=0){this.groups.push({start:e,count:a,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(e,a){this.drawRange.start=e,this.drawRange.count=a}applyMatrix4(e){const a=this.attributes.position;a!==void 0&&(a.applyMatrix4(e),a.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const c=new Na().getNormalMatrix(e);o.applyNormalMatrix(c),o.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return fc.makeRotationFromQuaternion(e),this.applyMatrix4(fc),this}rotateX(e){return fc.makeRotationX(e),this.applyMatrix4(fc),this}rotateY(e){return fc.makeRotationY(e),this.applyMatrix4(fc),this}rotateZ(e){return fc.makeRotationZ(e),this.applyMatrix4(fc),this}translate(e,a,o){return fc.makeTranslation(e,a,o),this.applyMatrix4(fc),this}scale(e,a,o){return fc.makeScale(e,a,o),this.applyMatrix4(fc),this}lookAt(e){return _4.lookAt(e),_4.updateMatrix(),this.applyMatrix4(_4.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ov).negate(),this.translate(Ov.x,Ov.y,Ov.z),this}setFromPoints(e){const a=[];for(let o=0,s=e.length;o<s;o++){const c=e[o];a.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new Wn(a,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new pu);const e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Fe(-1/0,-1/0,-1/0),new Fe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),a)for(let o=0,s=a.length;o<s;o++){const c=a[o];Ol.setFromBufferAttribute(c),this.morphTargetsRelative?(Oo.addVectors(this.boundingBox.min,Ol.min),this.boundingBox.expandByPoint(Oo),Oo.addVectors(this.boundingBox.max,Ol.max),this.boundingBox.expandByPoint(Oo)):(this.boundingBox.expandByPoint(Ol.min),this.boundingBox.expandByPoint(Ol.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tc);const e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Fe,1/0);return}if(e){const o=this.boundingSphere.center;if(Ol.setFromBufferAttribute(e),a)for(let c=0,d=a.length;c<d;c++){const f=a[c];Q1.setFromBufferAttribute(f),this.morphTargetsRelative?(Oo.addVectors(Ol.min,Q1.min),Ol.expandByPoint(Oo),Oo.addVectors(Ol.max,Q1.max),Ol.expandByPoint(Oo)):(Ol.expandByPoint(Q1.min),Ol.expandByPoint(Q1.max))}Ol.getCenter(o);let s=0;for(let c=0,d=e.count;c<d;c++)Oo.fromBufferAttribute(e,c),s=Math.max(s,o.distanceToSquared(Oo));if(a)for(let c=0,d=a.length;c<d;c++){const f=a[c],m=this.morphTargetsRelative;for(let y=0,_=f.count;y<_;y++)Oo.fromBufferAttribute(f,y),m&&(Ov.fromBufferAttribute(e,y),Oo.add(Ov)),s=Math.max(s,o.distanceToSquared(Oo))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,a=this.attributes;if(e===null||a.position===void 0||a.normal===void 0||a.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=e.array,s=a.position.array,c=a.normal.array,d=a.uv.array,f=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new qi(new Float32Array(4*f),4));const m=this.getAttribute("tangent").array,y=[],_=[];for(let Q=0;Q<f;Q++)y[Q]=new Fe,_[Q]=new Fe;const w=new Fe,A=new Fe,C=new Fe,I=new Kt,k=new Kt,D=new Kt,L=new Fe,O=new Fe;function F(Q,me,pe){w.fromArray(s,Q*3),A.fromArray(s,me*3),C.fromArray(s,pe*3),I.fromArray(d,Q*2),k.fromArray(d,me*2),D.fromArray(d,pe*2),A.sub(w),C.sub(w),k.sub(I),D.sub(I);const be=1/(k.x*D.y-D.x*k.y);isFinite(be)&&(L.copy(A).multiplyScalar(D.y).addScaledVector(C,-k.y).multiplyScalar(be),O.copy(C).multiplyScalar(k.x).addScaledVector(A,-D.x).multiplyScalar(be),y[Q].add(L),y[me].add(L),y[pe].add(L),_[Q].add(O),_[me].add(O),_[pe].add(O))}let B=this.groups;B.length===0&&(B=[{start:0,count:o.length}]);for(let Q=0,me=B.length;Q<me;++Q){const pe=B[Q],be=pe.start,fe=pe.count;for(let Ce=be,Re=be+fe;Ce<Re;Ce+=3)F(o[Ce+0],o[Ce+1],o[Ce+2])}const G=new Fe,q=new Fe,X=new Fe,ee=new Fe;function V(Q){X.fromArray(c,Q*3),ee.copy(X);const me=y[Q];G.copy(me),G.sub(X.multiplyScalar(X.dot(me))).normalize(),q.crossVectors(ee,me);const be=q.dot(_[Q])<0?-1:1;m[Q*4]=G.x,m[Q*4+1]=G.y,m[Q*4+2]=G.z,m[Q*4+3]=be}for(let Q=0,me=B.length;Q<me;++Q){const pe=B[Q],be=pe.start,fe=pe.count;for(let Ce=be,Re=be+fe;Ce<Re;Ce+=3)V(o[Ce+0]),V(o[Ce+1]),V(o[Ce+2])}}computeVertexNormals(){const e=this.index,a=this.getAttribute("position");if(a!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new qi(new Float32Array(a.count*3),3),this.setAttribute("normal",o);else for(let A=0,C=o.count;A<C;A++)o.setXYZ(A,0,0,0);const s=new Fe,c=new Fe,d=new Fe,f=new Fe,m=new Fe,y=new Fe,_=new Fe,w=new Fe;if(e)for(let A=0,C=e.count;A<C;A+=3){const I=e.getX(A+0),k=e.getX(A+1),D=e.getX(A+2);s.fromBufferAttribute(a,I),c.fromBufferAttribute(a,k),d.fromBufferAttribute(a,D),_.subVectors(d,c),w.subVectors(s,c),_.cross(w),f.fromBufferAttribute(o,I),m.fromBufferAttribute(o,k),y.fromBufferAttribute(o,D),f.add(_),m.add(_),y.add(_),o.setXYZ(I,f.x,f.y,f.z),o.setXYZ(k,m.x,m.y,m.z),o.setXYZ(D,y.x,y.y,y.z)}else for(let A=0,C=a.count;A<C;A+=3)s.fromBufferAttribute(a,A+0),c.fromBufferAttribute(a,A+1),d.fromBufferAttribute(a,A+2),_.subVectors(d,c),w.subVectors(s,c),_.cross(w),o.setXYZ(A+0,_.x,_.y,_.z),o.setXYZ(A+1,_.x,_.y,_.z),o.setXYZ(A+2,_.x,_.y,_.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let a=0,o=e.count;a<o;a++)Oo.fromBufferAttribute(e,a),Oo.normalize(),e.setXYZ(a,Oo.x,Oo.y,Oo.z)}toNonIndexed(){function e(f,m){const y=f.array,_=f.itemSize,w=f.normalized,A=new y.constructor(m.length*_);let C=0,I=0;for(let k=0,D=m.length;k<D;k++){f.isInterleavedBufferAttribute?C=m[k]*f.data.stride+f.offset:C=m[k]*_;for(let L=0;L<_;L++)A[I++]=y[C++]}return new qi(A,_,w)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const a=new La,o=this.index.array,s=this.attributes;for(const f in s){const m=s[f],y=e(m,o);a.setAttribute(f,y)}const c=this.morphAttributes;for(const f in c){const m=[],y=c[f];for(let _=0,w=y.length;_<w;_++){const A=y[_],C=e(A,o);m.push(C)}a.morphAttributes[f]=m}a.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let f=0,m=d.length;f<m;f++){const y=d[f];a.addGroup(y.start,y.count,y.materialIndex)}return a}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const m=this.parameters;for(const y in m)m[y]!==void 0&&(e[y]=m[y]);return e}e.data={attributes:{}};const a=this.index;a!==null&&(e.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});const o=this.attributes;for(const m in o){const y=o[m];e.data.attributes[m]=y.toJSON(e.data)}const s={};let c=!1;for(const m in this.morphAttributes){const y=this.morphAttributes[m],_=[];for(let w=0,A=y.length;w<A;w++){const C=y[w];_.push(C.toJSON(e.data))}_.length>0&&(s[m]=_,c=!0)}c&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const f=this.boundingSphere;return f!==null&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const a={};this.name=e.name;const o=e.index;o!==null&&this.setIndex(o.clone(a));const s=e.attributes;for(const y in s){const _=s[y];this.setAttribute(y,_.clone(a))}const c=e.morphAttributes;for(const y in c){const _=[],w=c[y];for(let A=0,C=w.length;A<C;A++)_.push(w[A].clone(a));this.morphAttributes[y]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let y=0,_=d.length;y<_;y++){const w=d[y];this.addGroup(w.start,w.count,w.materialIndex)}const f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());const m=e.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const nW=new Ia,km=new Wg,pS=new Tc,aW=new Fe,zv=new Fe,Fv=new Fe,Nv=new Fe,b4=new Fe,mS=new Fe,gS=new Kt,yS=new Kt,vS=new Kt,iW=new Fe,rW=new Fe,oW=new Fe,_S=new Fe,bS=new Fe;class bo extends fi{constructor(e=new La,a=new Vh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}getVertexPosition(e,a){const o=this.geometry,s=o.attributes.position,c=o.morphAttributes.position,d=o.morphTargetsRelative;a.fromBufferAttribute(s,e);const f=this.morphTargetInfluences;if(c&&f){mS.set(0,0,0);for(let m=0,y=c.length;m<y;m++){const _=f[m],w=c[m];_!==0&&(b4.fromBufferAttribute(w,e),d?mS.addScaledVector(b4,_):mS.addScaledVector(b4.sub(a),_))}a.add(mS)}return a}raycast(e,a){const o=this.geometry,s=this.material,c=this.matrixWorld;s!==void 0&&(o.boundingSphere===null&&o.computeBoundingSphere(),pS.copy(o.boundingSphere),pS.applyMatrix4(c),km.copy(e.ray).recast(e.near),!(pS.containsPoint(km.origin)===!1&&(km.intersectSphere(pS,aW)===null||km.origin.distanceToSquared(aW)>(e.far-e.near)**2))&&(nW.copy(c).invert(),km.copy(e.ray).applyMatrix4(nW),!(o.boundingBox!==null&&km.intersectsBox(o.boundingBox)===!1)&&this._computeIntersections(e,a,km)))}_computeIntersections(e,a,o){let s;const c=this.geometry,d=this.material,f=c.index,m=c.attributes.position,y=c.attributes.uv,_=c.attributes.uv1,w=c.attributes.normal,A=c.groups,C=c.drawRange;if(f!==null)if(Array.isArray(d))for(let I=0,k=A.length;I<k;I++){const D=A[I],L=d[D.materialIndex],O=Math.max(D.start,C.start),F=Math.min(f.count,Math.min(D.start+D.count,C.start+C.count));for(let B=O,G=F;B<G;B+=3){const q=f.getX(B),X=f.getX(B+1),ee=f.getX(B+2);s=xS(this,L,e,o,y,_,w,q,X,ee),s&&(s.faceIndex=Math.floor(B/3),s.face.materialIndex=D.materialIndex,a.push(s))}}else{const I=Math.max(0,C.start),k=Math.min(f.count,C.start+C.count);for(let D=I,L=k;D<L;D+=3){const O=f.getX(D),F=f.getX(D+1),B=f.getX(D+2);s=xS(this,d,e,o,y,_,w,O,F,B),s&&(s.faceIndex=Math.floor(D/3),a.push(s))}}else if(m!==void 0)if(Array.isArray(d))for(let I=0,k=A.length;I<k;I++){const D=A[I],L=d[D.materialIndex],O=Math.max(D.start,C.start),F=Math.min(m.count,Math.min(D.start+D.count,C.start+C.count));for(let B=O,G=F;B<G;B+=3){const q=B,X=B+1,ee=B+2;s=xS(this,L,e,o,y,_,w,q,X,ee),s&&(s.faceIndex=Math.floor(B/3),s.face.materialIndex=D.materialIndex,a.push(s))}}else{const I=Math.max(0,C.start),k=Math.min(m.count,C.start+C.count);for(let D=I,L=k;D<L;D+=3){const O=D,F=D+1,B=D+2;s=xS(this,d,e,o,y,_,w,O,F,B),s&&(s.faceIndex=Math.floor(D/3),a.push(s))}}}}function W0e(n,e,a,o,s,c,d,f){let m;if(e.side===vs?m=o.intersectTriangle(d,c,s,!0,f):m=o.intersectTriangle(s,c,d,e.side===md,f),m===null)return null;bS.copy(f),bS.applyMatrix4(n.matrixWorld);const y=a.ray.origin.distanceTo(bS);return y<a.near||y>a.far?null:{distance:y,point:bS.clone(),object:n}}function xS(n,e,a,o,s,c,d,f,m,y){n.getVertexPosition(f,zv),n.getVertexPosition(m,Fv),n.getVertexPosition(y,Nv);const _=W0e(n,e,a,o,zv,Fv,Nv,_S);if(_){s&&(gS.fromBufferAttribute(s,f),yS.fromBufferAttribute(s,m),vS.fromBufferAttribute(s,y),_.uv=dl.getInterpolation(_S,zv,Fv,Nv,gS,yS,vS,new Kt)),c&&(gS.fromBufferAttribute(c,f),yS.fromBufferAttribute(c,m),vS.fromBufferAttribute(c,y),_.uv1=dl.getInterpolation(_S,zv,Fv,Nv,gS,yS,vS,new Kt),_.uv2=_.uv1),d&&(iW.fromBufferAttribute(d,f),rW.fromBufferAttribute(d,m),oW.fromBufferAttribute(d,y),_.normal=dl.getInterpolation(_S,zv,Fv,Nv,iW,rW,oW,new Fe),_.normal.dot(o.direction)>0&&_.normal.multiplyScalar(-1));const w={a:f,b:m,c:y,normal:new Fe,materialIndex:0};dl.getNormal(zv,Fv,Nv,w.normal),_.face=w}return _}class Vg extends La{constructor(e=1,a=1,o=1,s=1,c=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:a,depth:o,widthSegments:s,heightSegments:c,depthSegments:d};const f=this;s=Math.floor(s),c=Math.floor(c),d=Math.floor(d);const m=[],y=[],_=[],w=[];let A=0,C=0;I("z","y","x",-1,-1,o,a,e,d,c,0),I("z","y","x",1,-1,o,a,-e,d,c,1),I("x","z","y",1,1,e,o,a,s,d,2),I("x","z","y",1,-1,e,o,-a,s,d,3),I("x","y","z",1,-1,e,a,o,s,c,4),I("x","y","z",-1,-1,e,a,-o,s,c,5),this.setIndex(m),this.setAttribute("position",new Wn(y,3)),this.setAttribute("normal",new Wn(_,3)),this.setAttribute("uv",new Wn(w,2));function I(k,D,L,O,F,B,G,q,X,ee,V){const Q=B/X,me=G/ee,pe=B/2,be=G/2,fe=q/2,Ce=X+1,Re=ee+1;let He=0,ue=0;const ye=new Fe;for(let Ae=0;Ae<Re;Ae++){const ne=Ae*me-be;for(let Ee=0;Ee<Ce;Ee++){const Ye=Ee*Q-pe;ye[k]=Ye*O,ye[D]=ne*F,ye[L]=fe,y.push(ye.x,ye.y,ye.z),ye[k]=0,ye[D]=0,ye[L]=q>0?1:-1,_.push(ye.x,ye.y,ye.z),w.push(Ee/X),w.push(1-Ae/ee),He+=1}}for(let Ae=0;Ae<ee;Ae++)for(let ne=0;ne<X;ne++){const Ee=A+ne+Ce*Ae,Ye=A+ne+Ce*(Ae+1),Xe=A+(ne+1)+Ce*(Ae+1),Ke=A+(ne+1)+Ce*Ae;m.push(Ee,Ye,Ke),m.push(Ye,Xe,Ke),ue+=6}f.addGroup(C,ue,V),C+=ue,A+=He}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Vg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function J0(n){const e={};for(const a in n){e[a]={};for(const o in n[a]){const s=n[a][o];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[a][o]=null):e[a][o]=s.clone():Array.isArray(s)?e[a][o]=s.slice():e[a][o]=s}}return e}function Fs(n){const e={};for(let a=0;a<n.length;a++){const o=J0(n[a]);for(const s in o)e[s]=o[s]}return e}function V0e(n){const e=[];for(let a=0;a<n.length;a++)e.push(n[a].clone());return e}function PZ(n){return n.getRenderTarget()===null?n.outputColorSpace:Oi.workingColorSpace}const HD={clone:J0,merge:Fs};var G0e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,H0e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class yd extends Ko{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=G0e,this.fragmentShader=H0e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=J0(e.uniforms),this.uniformsGroups=V0e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const a=super.toJSON(e);a.glslVersion=this.glslVersion,a.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;d&&d.isTexture?a.uniforms[s]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?a.uniforms[s]={type:"c",value:d.getHex()}:d&&d.isVector2?a.uniforms[s]={type:"v2",value:d.toArray()}:d&&d.isVector3?a.uniforms[s]={type:"v3",value:d.toArray()}:d&&d.isVector4?a.uniforms[s]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?a.uniforms[s]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?a.uniforms[s]={type:"m4",value:d.toArray()}:a.uniforms[s]={value:d}}Object.keys(this.defines).length>0&&(a.defines=this.defines),a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader,a.lights=this.lights,a.clipping=this.clipping;const o={};for(const s in this.extensions)this.extensions[s]===!0&&(o[s]=!0);return Object.keys(o).length>0&&(a.extensions=o),a}}class Cw extends fi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ia,this.projectionMatrix=new Ia,this.projectionMatrixInverse=new Ia,this.coordinateSystem=sd}copy(e,a){return super.copy(e,a),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,a){super.updateWorldMatrix(e,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class jr extends Cw{constructor(e=50,a=1,o=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=s,this.focus=10,this.aspect=a,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,a){return super.copy(e,a),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const a=.5*this.getFilmHeight()/e;this.fov=K0*2*Math.atan(a),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(vg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return K0*2*Math.atan(Math.tan(vg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,a,o,s,c,d){this.aspect=e/a,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=o,this.view.offsetY=s,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let a=e*Math.tan(vg*.5*this.fov)/this.zoom,o=2*a,s=this.aspect*o,c=-.5*s;const d=this.view;if(this.view!==null&&this.view.enabled){const m=d.fullWidth,y=d.fullHeight;c+=d.offsetX*s/m,a-=d.offsetY*o/y,s*=d.width/m,o*=d.height/y}const f=this.filmOffset;f!==0&&(c+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+s,a,a-o,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const a=super.toJSON(e);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,this.view!==null&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}}const Bv=-90,Uv=1;class IZ extends fi{constructor(e,a,o){super(),this.type="CubeCamera",this.renderTarget=o,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new jr(Bv,Uv,e,a);s.layers=this.layers,this.add(s);const c=new jr(Bv,Uv,e,a);c.layers=this.layers,this.add(c);const d=new jr(Bv,Uv,e,a);d.layers=this.layers,this.add(d);const f=new jr(Bv,Uv,e,a);f.layers=this.layers,this.add(f);const m=new jr(Bv,Uv,e,a);m.layers=this.layers,this.add(m);const y=new jr(Bv,Uv,e,a);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,a=this.children.concat(),[o,s,c,d,f,m]=a;for(const y of a)this.remove(y);if(e===sd)o.up.set(0,1,0),o.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),c.up.set(0,0,-1),c.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),m.up.set(0,1,0),m.lookAt(0,0,-1);else if(e===Gx)o.up.set(0,-1,0),o.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),c.up.set(0,0,1),c.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),m.up.set(0,-1,0),m.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of a)this.add(y),y.updateMatrixWorld()}update(e,a){this.parent===null&&this.updateMatrixWorld();const{renderTarget:o,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[c,d,f,m,y,_]=this.children,w=e.getRenderTarget(),A=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const k=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,e.setRenderTarget(o,0,s),e.render(a,c),e.setRenderTarget(o,1,s),e.render(a,d),e.setRenderTarget(o,2,s),e.render(a,f),e.setRenderTarget(o,3,s),e.render(a,m),e.setRenderTarget(o,4,s),e.render(a,y),o.texture.generateMipmaps=k,e.setRenderTarget(o,5,s),e.render(a,_),e.setRenderTarget(w,A,C),e.xr.enabled=I,o.texture.needsPMREMUpdate=!0}}class Pw extends Lr{constructor(e,a,o,s,c,d,f,m,y,_){e=e!==void 0?e:[],a=a!==void 0?a:Fh,super(e,a,o,s,c,d,f,m,y,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class LZ extends hu{constructor(e=1,a={}){super(e,e,a),this.isWebGLCubeRenderTarget=!0;const o={width:e,height:e,depth:1},s=[o,o,o,o,o,o];a.encoding!==void 0&&(Zb("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=a.encoding===up?To:Wl),this.texture=new Pw(s,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=a.generateMipmaps!==void 0?a.generateMipmaps:!1,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:Cr}fromEquirectangularTexture(e,a){this.texture.type=a.type,this.texture.colorSpace=a.colorSpace,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Vg(5,5,5),c=new yd({name:"CubemapFromEquirect",uniforms:J0(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:vs,blending:Ph});c.uniforms.tEquirect.value=a;const d=new bo(s,c),f=a.minFilter;return a.minFilter===vp&&(a.minFilter=Cr),new IZ(1,10,this).update(e,d),a.minFilter=f,d.geometry.dispose(),d.material.dispose(),this}clear(e,a,o,s){const c=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(a,o,s);e.setRenderTarget(c)}}const x4=new Fe,j0e=new Fe,$0e=new Na;class gh{constructor(e=new Fe(1,0,0),a=0){this.isPlane=!0,this.normal=e,this.constant=a}set(e,a){return this.normal.copy(e),this.constant=a,this}setComponents(e,a,o,s){return this.normal.set(e,a,o),this.constant=s,this}setFromNormalAndCoplanarPoint(e,a){return this.normal.copy(e),this.constant=-a.dot(this.normal),this}setFromCoplanarPoints(e,a,o){const s=x4.subVectors(o,a).cross(j0e.subVectors(e,a)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,a){return a.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,a){const o=e.delta(x4),s=this.normal.dot(o);if(s===0)return this.distanceToPoint(e.start)===0?a.copy(e.start):null;const c=-(e.start.dot(this.normal)+this.constant)/s;return c<0||c>1?null:a.copy(e.start).addScaledVector(o,c)}intersectsLine(e){const a=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return a<0&&o>0||o<0&&a>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,a){const o=a||$0e.getNormalMatrix(e),s=this.coplanarPoint(x4).applyMatrix4(e),c=this.normal.applyMatrix3(o).normalize();return this.constant=-s.dot(c),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Dm=new Tc,wS=new Fe;class ST{constructor(e=new gh,a=new gh,o=new gh,s=new gh,c=new gh,d=new gh){this.planes=[e,a,o,s,c,d]}set(e,a,o,s,c,d){const f=this.planes;return f[0].copy(e),f[1].copy(a),f[2].copy(o),f[3].copy(s),f[4].copy(c),f[5].copy(d),this}copy(e){const a=this.planes;for(let o=0;o<6;o++)a[o].copy(e.planes[o]);return this}setFromProjectionMatrix(e,a=sd){const o=this.planes,s=e.elements,c=s[0],d=s[1],f=s[2],m=s[3],y=s[4],_=s[5],w=s[6],A=s[7],C=s[8],I=s[9],k=s[10],D=s[11],L=s[12],O=s[13],F=s[14],B=s[15];if(o[0].setComponents(m-c,A-y,D-C,B-L).normalize(),o[1].setComponents(m+c,A+y,D+C,B+L).normalize(),o[2].setComponents(m+d,A+_,D+I,B+O).normalize(),o[3].setComponents(m-d,A-_,D-I,B-O).normalize(),o[4].setComponents(m-f,A-w,D-k,B-F).normalize(),a===sd)o[5].setComponents(m+f,A+w,D+k,B+F).normalize();else if(a===Gx)o[5].setComponents(f,w,k,F).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+a);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Dm.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const a=e.geometry;a.boundingSphere===null&&a.computeBoundingSphere(),Dm.copy(a.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Dm)}intersectsSprite(e){return Dm.center.set(0,0,0),Dm.radius=.7071067811865476,Dm.applyMatrix4(e.matrixWorld),this.intersectsSphere(Dm)}intersectsSphere(e){const a=this.planes,o=e.center,s=-e.radius;for(let c=0;c<6;c++)if(a[c].distanceToPoint(o)<s)return!1;return!0}intersectsBox(e){const a=this.planes;for(let o=0;o<6;o++){const s=a[o];if(wS.x=s.normal.x>0?e.max.x:e.min.x,wS.y=s.normal.y>0?e.max.y:e.min.y,wS.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(wS)<0)return!1}return!0}containsPoint(e){const a=this.planes;for(let o=0;o<6;o++)if(a[o].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function RZ(){let n=null,e=!1,a=null,o=null;function s(c,d){a(c,d),o=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&a!==null&&(o=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(o),e=!1},setAnimationLoop:function(c){a=c},setContext:function(c){n=c}}}function q0e(n,e){const a=e.isWebGL2,o=new WeakMap;function s(y,_){const w=y.array,A=y.usage,C=n.createBuffer();n.bindBuffer(_,C),n.bufferData(_,w,A),y.onUploadCallback();let I;if(w instanceof Float32Array)I=n.FLOAT;else if(w instanceof Uint16Array)if(y.isFloat16BufferAttribute)if(a)I=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else I=n.UNSIGNED_SHORT;else if(w instanceof Int16Array)I=n.SHORT;else if(w instanceof Uint32Array)I=n.UNSIGNED_INT;else if(w instanceof Int32Array)I=n.INT;else if(w instanceof Int8Array)I=n.BYTE;else if(w instanceof Uint8Array)I=n.UNSIGNED_BYTE;else if(w instanceof Uint8ClampedArray)I=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+w);return{buffer:C,type:I,bytesPerElement:w.BYTES_PER_ELEMENT,version:y.version}}function c(y,_,w){const A=_.array,C=_.updateRange;n.bindBuffer(w,y),C.count===-1?n.bufferSubData(w,0,A):(a?n.bufferSubData(w,C.offset*A.BYTES_PER_ELEMENT,A,C.offset,C.count):n.bufferSubData(w,C.offset*A.BYTES_PER_ELEMENT,A.subarray(C.offset,C.offset+C.count)),C.count=-1),_.onUploadCallback()}function d(y){return y.isInterleavedBufferAttribute&&(y=y.data),o.get(y)}function f(y){y.isInterleavedBufferAttribute&&(y=y.data);const _=o.get(y);_&&(n.deleteBuffer(_.buffer),o.delete(y))}function m(y,_){if(y.isGLBufferAttribute){const A=o.get(y);(!A||A.version<y.version)&&o.set(y,{buffer:y.buffer,type:y.type,bytesPerElement:y.elementSize,version:y.version});return}y.isInterleavedBufferAttribute&&(y=y.data);const w=o.get(y);w===void 0?o.set(y,s(y,_)):w.version<y.version&&(c(w.buffer,y,_),w.version=y.version)}return{get:d,remove:f,update:m}}class Mp extends La{constructor(e=1,a=1,o=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:a,widthSegments:o,heightSegments:s};const c=e/2,d=a/2,f=Math.floor(o),m=Math.floor(s),y=f+1,_=m+1,w=e/f,A=a/m,C=[],I=[],k=[],D=[];for(let L=0;L<_;L++){const O=L*A-d;for(let F=0;F<y;F++){const B=F*w-c;I.push(B,-O,0),k.push(0,0,1),D.push(F/f),D.push(1-L/m)}}for(let L=0;L<m;L++)for(let O=0;O<f;O++){const F=O+y*L,B=O+y*(L+1),G=O+1+y*(L+1),q=O+1+y*L;C.push(F,B,q),C.push(B,G,q)}this.setIndex(C),this.setAttribute("position",new Wn(I,3)),this.setAttribute("normal",new Wn(k,3)),this.setAttribute("uv",new Wn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mp(e.width,e.height,e.widthSegments,e.heightSegments)}}var X0e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Z0e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Y0e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,K0e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,J0e=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Q0e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,e_e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,t_e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,n_e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,a_e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,i_e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,r_e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,o_e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,s_e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,l_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,c_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,u_e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,d_e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,h_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,f_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,p_e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,m_e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,g_e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,y_e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,v_e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,__e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,b_e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,x_e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,w_e="gl_FragColor = linearToOutputTexel( gl_FragColor );",S_e=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,A_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,E_e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,M_e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,T_e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,C_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,P_e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,I_e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,L_e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,R_e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,k_e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,D_e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,O_e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,z_e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,F_e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,N_e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,B_e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,U_e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,W_e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,V_e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,G_e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,H_e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,j_e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,$_e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,q_e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,X_e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Z_e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Y_e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,K_e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,J_e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Q_e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,e1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,t1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,n1e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,a1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,i1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,r1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,o1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,s1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,l1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,c1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,u1e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,d1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,h1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,f1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,p1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,m1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,g1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,y1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,v1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,_1e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,b1e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,x1e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,w1e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,S1e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,A1e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,E1e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,M1e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,T1e=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,C1e=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,P1e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,I1e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,L1e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,R1e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,k1e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,D1e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,O1e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,z1e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,F1e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,N1e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,B1e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,U1e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,W1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,V1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,G1e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,H1e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const j1e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,$1e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,q1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,X1e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Z1e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Y1e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,K1e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,J1e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Q1e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ebe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,tbe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,nbe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,abe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ibe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,rbe=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,obe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sbe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,lbe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cbe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ube=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dbe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,hbe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,fbe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pbe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mbe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,gbe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ybe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vbe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_be=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,bbe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xbe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wbe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Sbe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Abe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Oa={alphahash_fragment:X0e,alphahash_pars_fragment:Z0e,alphamap_fragment:Y0e,alphamap_pars_fragment:K0e,alphatest_fragment:J0e,alphatest_pars_fragment:Q0e,aomap_fragment:e_e,aomap_pars_fragment:t_e,begin_vertex:n_e,beginnormal_vertex:a_e,bsdfs:i_e,iridescence_fragment:r_e,bumpmap_pars_fragment:o_e,clipping_planes_fragment:s_e,clipping_planes_pars_fragment:l_e,clipping_planes_pars_vertex:c_e,clipping_planes_vertex:u_e,color_fragment:d_e,color_pars_fragment:h_e,color_pars_vertex:f_e,color_vertex:p_e,common:m_e,cube_uv_reflection_fragment:g_e,defaultnormal_vertex:y_e,displacementmap_pars_vertex:v_e,displacementmap_vertex:__e,emissivemap_fragment:b_e,emissivemap_pars_fragment:x_e,colorspace_fragment:w_e,colorspace_pars_fragment:S_e,envmap_fragment:A_e,envmap_common_pars_fragment:E_e,envmap_pars_fragment:M_e,envmap_pars_vertex:T_e,envmap_physical_pars_fragment:B_e,envmap_vertex:C_e,fog_vertex:P_e,fog_pars_vertex:I_e,fog_fragment:L_e,fog_pars_fragment:R_e,gradientmap_pars_fragment:k_e,lightmap_fragment:D_e,lightmap_pars_fragment:O_e,lights_lambert_fragment:z_e,lights_lambert_pars_fragment:F_e,lights_pars_begin:N_e,lights_toon_fragment:U_e,lights_toon_pars_fragment:W_e,lights_phong_fragment:V_e,lights_phong_pars_fragment:G_e,lights_physical_fragment:H_e,lights_physical_pars_fragment:j_e,lights_fragment_begin:$_e,lights_fragment_maps:q_e,lights_fragment_end:X_e,logdepthbuf_fragment:Z_e,logdepthbuf_pars_fragment:Y_e,logdepthbuf_pars_vertex:K_e,logdepthbuf_vertex:J_e,map_fragment:Q_e,map_pars_fragment:e1e,map_particle_fragment:t1e,map_particle_pars_fragment:n1e,metalnessmap_fragment:a1e,metalnessmap_pars_fragment:i1e,morphcolor_vertex:r1e,morphnormal_vertex:o1e,morphtarget_pars_vertex:s1e,morphtarget_vertex:l1e,normal_fragment_begin:c1e,normal_fragment_maps:u1e,normal_pars_fragment:d1e,normal_pars_vertex:h1e,normal_vertex:f1e,normalmap_pars_fragment:p1e,clearcoat_normal_fragment_begin:m1e,clearcoat_normal_fragment_maps:g1e,clearcoat_pars_fragment:y1e,iridescence_pars_fragment:v1e,opaque_fragment:_1e,packing:b1e,premultiplied_alpha_fragment:x1e,project_vertex:w1e,dithering_fragment:S1e,dithering_pars_fragment:A1e,roughnessmap_fragment:E1e,roughnessmap_pars_fragment:M1e,shadowmap_pars_fragment:T1e,shadowmap_pars_vertex:C1e,shadowmap_vertex:P1e,shadowmask_pars_fragment:I1e,skinbase_vertex:L1e,skinning_pars_vertex:R1e,skinning_vertex:k1e,skinnormal_vertex:D1e,specularmap_fragment:O1e,specularmap_pars_fragment:z1e,tonemapping_fragment:F1e,tonemapping_pars_fragment:N1e,transmission_fragment:B1e,transmission_pars_fragment:U1e,uv_pars_fragment:W1e,uv_pars_vertex:V1e,uv_vertex:G1e,worldpos_vertex:H1e,background_vert:j1e,background_frag:$1e,backgroundCube_vert:q1e,backgroundCube_frag:X1e,cube_vert:Z1e,cube_frag:Y1e,depth_vert:K1e,depth_frag:J1e,distanceRGBA_vert:Q1e,distanceRGBA_frag:ebe,equirect_vert:tbe,equirect_frag:nbe,linedashed_vert:abe,linedashed_frag:ibe,meshbasic_vert:rbe,meshbasic_frag:obe,meshlambert_vert:sbe,meshlambert_frag:lbe,meshmatcap_vert:cbe,meshmatcap_frag:ube,meshnormal_vert:dbe,meshnormal_frag:hbe,meshphong_vert:fbe,meshphong_frag:pbe,meshphysical_vert:mbe,meshphysical_frag:gbe,meshtoon_vert:ybe,meshtoon_frag:vbe,points_vert:_be,points_frag:bbe,shadow_vert:xbe,shadow_frag:wbe,sprite_vert:Sbe,sprite_frag:Abe},bn={common:{diffuse:{value:new Pn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Na},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Na}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Na}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Na}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Na},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Na},normalScale:{value:new Kt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Na},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Na}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Na}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Na}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0},uvTransform:{value:new Na}},sprite:{diffuse:{value:new Pn(16777215)},opacity:{value:1},center:{value:new Kt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Na},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0}}},au={basic:{uniforms:Fs([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.fog]),vertexShader:Oa.meshbasic_vert,fragmentShader:Oa.meshbasic_frag},lambert:{uniforms:Fs([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:Oa.meshlambert_vert,fragmentShader:Oa.meshlambert_frag},phong:{uniforms:Fs([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)},specular:{value:new Pn(1118481)},shininess:{value:30}}]),vertexShader:Oa.meshphong_vert,fragmentShader:Oa.meshphong_frag},standard:{uniforms:Fs([bn.common,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.roughnessmap,bn.metalnessmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag},toon:{uniforms:Fs([bn.common,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.gradientmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:Oa.meshtoon_vert,fragmentShader:Oa.meshtoon_frag},matcap:{uniforms:Fs([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,{matcap:{value:null}}]),vertexShader:Oa.meshmatcap_vert,fragmentShader:Oa.meshmatcap_frag},points:{uniforms:Fs([bn.points,bn.fog]),vertexShader:Oa.points_vert,fragmentShader:Oa.points_frag},dashed:{uniforms:Fs([bn.common,bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Oa.linedashed_vert,fragmentShader:Oa.linedashed_frag},depth:{uniforms:Fs([bn.common,bn.displacementmap]),vertexShader:Oa.depth_vert,fragmentShader:Oa.depth_frag},normal:{uniforms:Fs([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,{opacity:{value:1}}]),vertexShader:Oa.meshnormal_vert,fragmentShader:Oa.meshnormal_frag},sprite:{uniforms:Fs([bn.sprite,bn.fog]),vertexShader:Oa.sprite_vert,fragmentShader:Oa.sprite_frag},background:{uniforms:{uvTransform:{value:new Na},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Oa.background_vert,fragmentShader:Oa.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Oa.backgroundCube_vert,fragmentShader:Oa.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Oa.cube_vert,fragmentShader:Oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oa.equirect_vert,fragmentShader:Oa.equirect_frag},distanceRGBA:{uniforms:Fs([bn.common,bn.displacementmap,{referencePosition:{value:new Fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Oa.distanceRGBA_vert,fragmentShader:Oa.distanceRGBA_frag},shadow:{uniforms:Fs([bn.lights,bn.fog,{color:{value:new Pn(0)},opacity:{value:1}}]),vertexShader:Oa.shadow_vert,fragmentShader:Oa.shadow_frag}};au.physical={uniforms:Fs([au.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Na},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Na},clearcoatNormalScale:{value:new Kt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Na},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Na},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Na},sheen:{value:0},sheenColor:{value:new Pn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Na},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Na},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Na},transmissionSamplerSize:{value:new Kt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Na},attenuationDistance:{value:0},attenuationColor:{value:new Pn(0)},specularColor:{value:new Pn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Na},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Na},anisotropyVector:{value:new Kt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Na}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag};const SS={r:0,b:0,g:0};function Ebe(n,e,a,o,s,c,d){const f=new Pn(0);let m=c===!0?0:1,y,_,w=null,A=0,C=null;function I(D,L){let O=!1,F=L.isScene===!0?L.background:null;F&&F.isTexture&&(F=(L.backgroundBlurriness>0?a:e).get(F)),F===null?k(f,m):F&&F.isColor&&(k(F,1),O=!0);const B=n.xr.getEnvironmentBlendMode();B==="additive"?o.buffers.color.setClear(0,0,0,1,d):B==="alpha-blend"&&o.buffers.color.setClear(0,0,0,0,d),(n.autoClear||O)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),F&&(F.isCubeTexture||F.mapping===u_)?(_===void 0&&(_=new bo(new Vg(1,1,1),new yd({name:"BackgroundCubeMaterial",uniforms:J0(au.backgroundCube.uniforms),vertexShader:au.backgroundCube.vertexShader,fragmentShader:au.backgroundCube.fragmentShader,side:vs,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(G,q,X){this.matrixWorld.copyPosition(X.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(_)),_.material.uniforms.envMap.value=F,_.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,_.material.toneMapped=Oi.getTransfer(F.colorSpace)!==Ji,(w!==F||A!==F.version||C!==n.toneMapping)&&(_.material.needsUpdate=!0,w=F,A=F.version,C=n.toneMapping),_.layers.enableAll(),D.unshift(_,_.geometry,_.material,0,0,null)):F&&F.isTexture&&(y===void 0&&(y=new bo(new Mp(2,2),new yd({name:"BackgroundMaterial",uniforms:J0(au.background.uniforms),vertexShader:au.background.vertexShader,fragmentShader:au.background.fragmentShader,side:md,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(y)),y.material.uniforms.t2D.value=F,y.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,y.material.toneMapped=Oi.getTransfer(F.colorSpace)!==Ji,F.matrixAutoUpdate===!0&&F.updateMatrix(),y.material.uniforms.uvTransform.value.copy(F.matrix),(w!==F||A!==F.version||C!==n.toneMapping)&&(y.material.needsUpdate=!0,w=F,A=F.version,C=n.toneMapping),y.layers.enableAll(),D.unshift(y,y.geometry,y.material,0,0,null))}function k(D,L){D.getRGB(SS,PZ(n)),o.buffers.color.setClear(SS.r,SS.g,SS.b,L,d)}return{getClearColor:function(){return f},setClearColor:function(D,L=1){f.set(D),m=L,k(f,m)},getClearAlpha:function(){return m},setClearAlpha:function(D){m=D,k(f,m)},render:I}}function Mbe(n,e,a,o){const s=n.getParameter(n.MAX_VERTEX_ATTRIBS),c=o.isWebGL2?null:e.get("OES_vertex_array_object"),d=o.isWebGL2||c!==null,f={},m=D(null);let y=m,_=!1;function w(fe,Ce,Re,He,ue){let ye=!1;if(d){const Ae=k(He,Re,Ce);y!==Ae&&(y=Ae,C(y.object)),ye=L(fe,He,Re,ue),ye&&O(fe,He,Re,ue)}else{const Ae=Ce.wireframe===!0;(y.geometry!==He.id||y.program!==Re.id||y.wireframe!==Ae)&&(y.geometry=He.id,y.program=Re.id,y.wireframe=Ae,ye=!0)}ue!==null&&a.update(ue,n.ELEMENT_ARRAY_BUFFER),(ye||_)&&(_=!1,ee(fe,Ce,Re,He),ue!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.get(ue).buffer))}function A(){return o.isWebGL2?n.createVertexArray():c.createVertexArrayOES()}function C(fe){return o.isWebGL2?n.bindVertexArray(fe):c.bindVertexArrayOES(fe)}function I(fe){return o.isWebGL2?n.deleteVertexArray(fe):c.deleteVertexArrayOES(fe)}function k(fe,Ce,Re){const He=Re.wireframe===!0;let ue=f[fe.id];ue===void 0&&(ue={},f[fe.id]=ue);let ye=ue[Ce.id];ye===void 0&&(ye={},ue[Ce.id]=ye);let Ae=ye[He];return Ae===void 0&&(Ae=D(A()),ye[He]=Ae),Ae}function D(fe){const Ce=[],Re=[],He=[];for(let ue=0;ue<s;ue++)Ce[ue]=0,Re[ue]=0,He[ue]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ce,enabledAttributes:Re,attributeDivisors:He,object:fe,attributes:{},index:null}}function L(fe,Ce,Re,He){const ue=y.attributes,ye=Ce.attributes;let Ae=0;const ne=Re.getAttributes();for(const Ee in ne)if(ne[Ee].location>=0){const Xe=ue[Ee];let Ke=ye[Ee];if(Ke===void 0&&(Ee==="instanceMatrix"&&fe.instanceMatrix&&(Ke=fe.instanceMatrix),Ee==="instanceColor"&&fe.instanceColor&&(Ke=fe.instanceColor)),Xe===void 0||Xe.attribute!==Ke||Ke&&Xe.data!==Ke.data)return!0;Ae++}return y.attributesNum!==Ae||y.index!==He}function O(fe,Ce,Re,He){const ue={},ye=Ce.attributes;let Ae=0;const ne=Re.getAttributes();for(const Ee in ne)if(ne[Ee].location>=0){let Xe=ye[Ee];Xe===void 0&&(Ee==="instanceMatrix"&&fe.instanceMatrix&&(Xe=fe.instanceMatrix),Ee==="instanceColor"&&fe.instanceColor&&(Xe=fe.instanceColor));const Ke={};Ke.attribute=Xe,Xe&&Xe.data&&(Ke.data=Xe.data),ue[Ee]=Ke,Ae++}y.attributes=ue,y.attributesNum=Ae,y.index=He}function F(){const fe=y.newAttributes;for(let Ce=0,Re=fe.length;Ce<Re;Ce++)fe[Ce]=0}function B(fe){G(fe,0)}function G(fe,Ce){const Re=y.newAttributes,He=y.enabledAttributes,ue=y.attributeDivisors;Re[fe]=1,He[fe]===0&&(n.enableVertexAttribArray(fe),He[fe]=1),ue[fe]!==Ce&&((o.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](fe,Ce),ue[fe]=Ce)}function q(){const fe=y.newAttributes,Ce=y.enabledAttributes;for(let Re=0,He=Ce.length;Re<He;Re++)Ce[Re]!==fe[Re]&&(n.disableVertexAttribArray(Re),Ce[Re]=0)}function X(fe,Ce,Re,He,ue,ye,Ae){Ae===!0?n.vertexAttribIPointer(fe,Ce,Re,ue,ye):n.vertexAttribPointer(fe,Ce,Re,He,ue,ye)}function ee(fe,Ce,Re,He){if(o.isWebGL2===!1&&(fe.isInstancedMesh||He.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;F();const ue=He.attributes,ye=Re.getAttributes(),Ae=Ce.defaultAttributeValues;for(const ne in ye){const Ee=ye[ne];if(Ee.location>=0){let Ye=ue[ne];if(Ye===void 0&&(ne==="instanceMatrix"&&fe.instanceMatrix&&(Ye=fe.instanceMatrix),ne==="instanceColor"&&fe.instanceColor&&(Ye=fe.instanceColor)),Ye!==void 0){const Xe=Ye.normalized,Ke=Ye.itemSize,Ue=a.get(Ye);if(Ue===void 0)continue;const ht=Ue.buffer,Lt=Ue.type,Rt=Ue.bytesPerElement,Jt=o.isWebGL2===!0&&(Lt===n.INT||Lt===n.UNSIGNED_INT||Ye.gpuType===ID);if(Ye.isInterleavedBufferAttribute){const Pt=Ye.data,Pe=Pt.stride,ft=Ye.offset;if(Pt.isInstancedInterleavedBuffer){for(let gt=0;gt<Ee.locationSize;gt++)G(Ee.location+gt,Pt.meshPerAttribute);fe.isInstancedMesh!==!0&&He._maxInstanceCount===void 0&&(He._maxInstanceCount=Pt.meshPerAttribute*Pt.count)}else for(let gt=0;gt<Ee.locationSize;gt++)B(Ee.location+gt);n.bindBuffer(n.ARRAY_BUFFER,ht);for(let gt=0;gt<Ee.locationSize;gt++)X(Ee.location+gt,Ke/Ee.locationSize,Lt,Xe,Pe*Rt,(ft+Ke/Ee.locationSize*gt)*Rt,Jt)}else{if(Ye.isInstancedBufferAttribute){for(let Pt=0;Pt<Ee.locationSize;Pt++)G(Ee.location+Pt,Ye.meshPerAttribute);fe.isInstancedMesh!==!0&&He._maxInstanceCount===void 0&&(He._maxInstanceCount=Ye.meshPerAttribute*Ye.count)}else for(let Pt=0;Pt<Ee.locationSize;Pt++)B(Ee.location+Pt);n.bindBuffer(n.ARRAY_BUFFER,ht);for(let Pt=0;Pt<Ee.locationSize;Pt++)X(Ee.location+Pt,Ke/Ee.locationSize,Lt,Xe,Ke*Rt,Ke/Ee.locationSize*Pt*Rt,Jt)}}else if(Ae!==void 0){const Xe=Ae[ne];if(Xe!==void 0)switch(Xe.length){case 2:n.vertexAttrib2fv(Ee.location,Xe);break;case 3:n.vertexAttrib3fv(Ee.location,Xe);break;case 4:n.vertexAttrib4fv(Ee.location,Xe);break;default:n.vertexAttrib1fv(Ee.location,Xe)}}}}q()}function V(){pe();for(const fe in f){const Ce=f[fe];for(const Re in Ce){const He=Ce[Re];for(const ue in He)I(He[ue].object),delete He[ue];delete Ce[Re]}delete f[fe]}}function Q(fe){if(f[fe.id]===void 0)return;const Ce=f[fe.id];for(const Re in Ce){const He=Ce[Re];for(const ue in He)I(He[ue].object),delete He[ue];delete Ce[Re]}delete f[fe.id]}function me(fe){for(const Ce in f){const Re=f[Ce];if(Re[fe.id]===void 0)continue;const He=Re[fe.id];for(const ue in He)I(He[ue].object),delete He[ue];delete Re[fe.id]}}function pe(){be(),_=!0,y!==m&&(y=m,C(y.object))}function be(){m.geometry=null,m.program=null,m.wireframe=!1}return{setup:w,reset:pe,resetDefaultState:be,dispose:V,releaseStatesOfGeometry:Q,releaseStatesOfProgram:me,initAttributes:F,enableAttribute:B,disableUnusedAttributes:q}}function Tbe(n,e,a,o){const s=o.isWebGL2;let c;function d(y){c=y}function f(y,_){n.drawArrays(c,y,_),a.update(_,c,1)}function m(y,_,w){if(w===0)return;let A,C;if(s)A=n,C="drawArraysInstanced";else if(A=e.get("ANGLE_instanced_arrays"),C="drawArraysInstancedANGLE",A===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[C](c,y,_,w),a.update(_,c,w)}this.setMode=d,this.render=f,this.renderInstances=m}function Cbe(n,e,a){let o;function s(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const X=e.get("EXT_texture_filter_anisotropic");o=n.getParameter(X.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function c(X){if(X==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";X="mediump"}return X==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let f=a.precision!==void 0?a.precision:"highp";const m=c(f);m!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",m,"instead."),f=m);const y=d||e.has("WEBGL_draw_buffers"),_=a.logarithmicDepthBuffer===!0,w=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=n.getParameter(n.MAX_TEXTURE_SIZE),I=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),k=n.getParameter(n.MAX_VERTEX_ATTRIBS),D=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),O=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),F=A>0,B=d||e.has("OES_texture_float"),G=F&&B,q=d?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:d,drawBuffers:y,getMaxAnisotropy:s,getMaxPrecision:c,precision:f,logarithmicDepthBuffer:_,maxTextures:w,maxVertexTextures:A,maxTextureSize:C,maxCubemapSize:I,maxAttributes:k,maxVertexUniforms:D,maxVaryings:L,maxFragmentUniforms:O,vertexTextures:F,floatFragmentTextures:B,floatVertexTextures:G,maxSamples:q}}function Pbe(n){const e=this;let a=null,o=0,s=!1,c=!1;const d=new gh,f=new Na,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(w,A){const C=w.length!==0||A||o!==0||s;return s=A,o=w.length,C},this.beginShadows=function(){c=!0,_(null)},this.endShadows=function(){c=!1},this.setGlobalState=function(w,A){a=_(w,A,0)},this.setState=function(w,A,C){const I=w.clippingPlanes,k=w.clipIntersection,D=w.clipShadows,L=n.get(w);if(!s||I===null||I.length===0||c&&!D)c?_(null):y();else{const O=c?0:o,F=O*4;let B=L.clippingState||null;m.value=B,B=_(I,A,F,C);for(let G=0;G!==F;++G)B[G]=a[G];L.clippingState=B,this.numIntersection=k?this.numPlanes:0,this.numPlanes+=O}};function y(){m.value!==a&&(m.value=a,m.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function _(w,A,C,I){const k=w!==null?w.length:0;let D=null;if(k!==0){if(D=m.value,I!==!0||D===null){const L=C+k*4,O=A.matrixWorldInverse;f.getNormalMatrix(O),(D===null||D.length<L)&&(D=new Float32Array(L));for(let F=0,B=C;F!==k;++F,B+=4)d.copy(w[F]).applyMatrix4(O,f),d.normal.toArray(D,B),D[B+3]=d.constant}m.value=D,m.needsUpdate=!0}return e.numPlanes=k,e.numIntersection=0,D}}function Ibe(n){let e=new WeakMap;function a(d,f){return f===Rx?d.mapping=Fh:f===kx&&(d.mapping=yp),d}function o(d){if(d&&d.isTexture&&d.isRenderTargetTexture===!1){const f=d.mapping;if(f===Rx||f===kx)if(e.has(d)){const m=e.get(d).texture;return a(m,d.mapping)}else{const m=d.image;if(m&&m.height>0){const y=new LZ(m.height/2);return y.fromEquirectangularTexture(n,d),e.set(d,y),d.addEventListener("dispose",s),a(y.texture,d.mapping)}else return null}}return d}function s(d){const f=d.target;f.removeEventListener("dispose",s);const m=e.get(f);m!==void 0&&(e.delete(f),m.dispose())}function c(){e=new WeakMap}return{get:o,dispose:c}}class Ah extends Cw{constructor(e=-1,a=1,o=1,s=-1,c=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=a,this.top=o,this.bottom=s,this.near=c,this.far=d,this.updateProjectionMatrix()}copy(e,a){return super.copy(e,a),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,a,o,s,c,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=o,this.view.offsetY=s,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let c=o-e,d=o+e,f=s+a,m=s-a;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=y*this.view.offsetX,d=c+y*this.view.width,f-=_*this.view.offsetY,m=f-_*this.view.height}this.projectionMatrix.makeOrthographic(c,d,f,m,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const a=super.toJSON(e);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,this.view!==null&&(a.object.view=Object.assign({},this.view)),a}}const v0=4,sW=[.125,.215,.35,.446,.526,.582],ng=20,w4=new Ah,lW=new Pn;let S4=null,A4=0,E4=0;const Jm=(1+Math.sqrt(5))/2,Wv=1/Jm,cW=[new Fe(1,1,1),new Fe(-1,1,1),new Fe(1,1,-1),new Fe(-1,1,-1),new Fe(0,Jm,Wv),new Fe(0,Jm,-Wv),new Fe(Wv,0,Jm),new Fe(-Wv,0,Jm),new Fe(Jm,Wv,0),new Fe(-Jm,Wv,0)];class dR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,a=0,o=.1,s=100){S4=this._renderer.getRenderTarget(),A4=this._renderer.getActiveCubeFace(),E4=this._renderer.getActiveMipmapLevel(),this._setSize(256);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,o,s,c),a>0&&this._blur(c,0,0,a),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,a=null){return this._fromTexture(e,a)}fromCubemap(e,a=null){return this._fromTexture(e,a)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=hW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=dW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(S4,A4,E4),e.scissorTest=!1,AS(e,0,0,e.width,e.height)}_fromTexture(e,a){e.mapping===Fh||e.mapping===yp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),S4=this._renderer.getRenderTarget(),A4=this._renderer.getActiveCubeFace(),E4=this._renderer.getActiveMipmapLevel();const o=a||this._allocateTargets();return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),a=4*this._cubeSize,o={magFilter:Cr,minFilter:Cr,generateMipmaps:!1,type:Y0,format:hl,colorSpace:gd,depthBuffer:!1},s=uW(e,a,o);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==a){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=uW(e,a,o);const{_lodMax:c}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Lbe(c)),this._blurMaterial=Rbe(c,e,a)}return s}_compileMaterial(e){const a=new bo(this._lodPlanes[0],e);this._renderer.compile(a,w4)}_sceneToCubeUV(e,a,o,s){const f=new jr(90,1,a,o),m=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],_=this._renderer,w=_.autoClear,A=_.toneMapping;_.getClearColor(lW),_.toneMapping=dd,_.autoClear=!1;const C=new Vh({name:"PMREM.Background",side:vs,depthWrite:!1,depthTest:!1}),I=new bo(new Vg,C);let k=!1;const D=e.background;D?D.isColor&&(C.color.copy(D),e.background=null,k=!0):(C.color.copy(lW),k=!0);for(let L=0;L<6;L++){const O=L%3;O===0?(f.up.set(0,m[L],0),f.lookAt(y[L],0,0)):O===1?(f.up.set(0,0,m[L]),f.lookAt(0,y[L],0)):(f.up.set(0,m[L],0),f.lookAt(0,0,y[L]));const F=this._cubeSize;AS(s,O*F,L>2?F:0,F,F),_.setRenderTarget(s),k&&_.render(I,f),_.render(e,f)}I.geometry.dispose(),I.material.dispose(),_.toneMapping=A,_.autoClear=w,e.background=D}_textureToCubeUV(e,a){const o=this._renderer,s=e.mapping===Fh||e.mapping===yp;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=hW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=dW());const c=s?this._cubemapMaterial:this._equirectMaterial,d=new bo(this._lodPlanes[0],c),f=c.uniforms;f.envMap.value=e;const m=this._cubeSize;AS(a,0,0,3*m,2*m),o.setRenderTarget(a),o.render(d,w4)}_applyPMREM(e){const a=this._renderer,o=a.autoClear;a.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const c=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),d=cW[(s-1)%cW.length];this._blur(e,s-1,s,c,d)}a.autoClear=o}_blur(e,a,o,s,c){const d=this._pingPongRenderTarget;this._halfBlur(e,d,a,o,s,"latitudinal",c),this._halfBlur(d,e,o,o,s,"longitudinal",c)}_halfBlur(e,a,o,s,c,d,f){const m=this._renderer,y=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,w=new bo(this._lodPlanes[s],y),A=y.uniforms,C=this._sizeLods[o]-1,I=isFinite(c)?Math.PI/(2*C):2*Math.PI/(2*ng-1),k=c/I,D=isFinite(c)?1+Math.floor(_*k):ng;D>ng&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${D} samples when the maximum is set to ${ng}`);const L=[];let O=0;for(let X=0;X<ng;++X){const ee=X/k,V=Math.exp(-ee*ee/2);L.push(V),X===0?O+=V:X<D&&(O+=2*V)}for(let X=0;X<L.length;X++)L[X]=L[X]/O;A.envMap.value=e.texture,A.samples.value=D,A.weights.value=L,A.latitudinal.value=d==="latitudinal",f&&(A.poleAxis.value=f);const{_lodMax:F}=this;A.dTheta.value=I,A.mipInt.value=F-o;const B=this._sizeLods[s],G=3*B*(s>F-v0?s-F+v0:0),q=4*(this._cubeSize-B);AS(a,G,q,3*B,2*B),m.setRenderTarget(a),m.render(w,w4)}}function Lbe(n){const e=[],a=[],o=[];let s=n;const c=n-v0+1+sW.length;for(let d=0;d<c;d++){const f=Math.pow(2,s);a.push(f);let m=1/f;d>n-v0?m=sW[d-n+v0-1]:d===0&&(m=0),o.push(m);const y=1/(f-2),_=-y,w=1+y,A=[_,_,w,_,w,w,_,_,w,w,_,w],C=6,I=6,k=3,D=2,L=1,O=new Float32Array(k*I*C),F=new Float32Array(D*I*C),B=new Float32Array(L*I*C);for(let q=0;q<C;q++){const X=q%3*2/3-1,ee=q>2?0:-1,V=[X,ee,0,X+2/3,ee,0,X+2/3,ee+1,0,X,ee,0,X+2/3,ee+1,0,X,ee+1,0];O.set(V,k*I*q),F.set(A,D*I*q);const Q=[q,q,q,q,q,q];B.set(Q,L*I*q)}const G=new La;G.setAttribute("position",new qi(O,k)),G.setAttribute("uv",new qi(F,D)),G.setAttribute("faceIndex",new qi(B,L)),e.push(G),s>v0&&s--}return{lodPlanes:e,sizeLods:a,sigmas:o}}function uW(n,e,a){const o=new hu(n,e,a);return o.texture.mapping=u_,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function AS(n,e,a,o,s){n.viewport.set(e,a,o,s),n.scissor.set(e,a,o,s)}function Rbe(n,e,a){const o=new Float32Array(ng),s=new Fe(0,1,0);return new yd({name:"SphericalGaussianBlur",defines:{n:ng,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/a,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:jD(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function dW(){return new yd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:jD(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function hW(){return new yd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:jD(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ph,depthTest:!1,depthWrite:!1})}function jD(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function kbe(n){let e=new WeakMap,a=null;function o(f){if(f&&f.isTexture){const m=f.mapping,y=m===Rx||m===kx,_=m===Fh||m===yp;if(y||_)if(f.isRenderTargetTexture&&f.needsPMREMUpdate===!0){f.needsPMREMUpdate=!1;let w=e.get(f);return a===null&&(a=new dR(n)),w=y?a.fromEquirectangular(f,w):a.fromCubemap(f,w),e.set(f,w),w.texture}else{if(e.has(f))return e.get(f).texture;{const w=f.image;if(y&&w&&w.height>0||_&&w&&s(w)){a===null&&(a=new dR(n));const A=y?a.fromEquirectangular(f):a.fromCubemap(f);return e.set(f,A),f.addEventListener("dispose",c),A.texture}else return null}}}return f}function s(f){let m=0;const y=6;for(let _=0;_<y;_++)f[_]!==void 0&&m++;return m===y}function c(f){const m=f.target;m.removeEventListener("dispose",c);const y=e.get(m);y!==void 0&&(e.delete(m),y.dispose())}function d(){e=new WeakMap,a!==null&&(a.dispose(),a=null)}return{get:o,dispose:d}}function Dbe(n){const e={};function a(o){if(e[o]!==void 0)return e[o];let s;switch(o){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(o)}return e[o]=s,s}return{has:function(o){return a(o)!==null},init:function(o){o.isWebGL2?a("EXT_color_buffer_float"):(a("WEBGL_depth_texture"),a("OES_texture_float"),a("OES_texture_half_float"),a("OES_texture_half_float_linear"),a("OES_standard_derivatives"),a("OES_element_index_uint"),a("OES_vertex_array_object"),a("ANGLE_instanced_arrays")),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float"),a("WEBGL_multisampled_render_to_texture")},get:function(o){const s=a(o);return s===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),s}}}function Obe(n,e,a,o){const s={},c=new WeakMap;function d(w){const A=w.target;A.index!==null&&e.remove(A.index);for(const I in A.attributes)e.remove(A.attributes[I]);for(const I in A.morphAttributes){const k=A.morphAttributes[I];for(let D=0,L=k.length;D<L;D++)e.remove(k[D])}A.removeEventListener("dispose",d),delete s[A.id];const C=c.get(A);C&&(e.remove(C),c.delete(A)),o.releaseStatesOfGeometry(A),A.isInstancedBufferGeometry===!0&&delete A._maxInstanceCount,a.memory.geometries--}function f(w,A){return s[A.id]===!0||(A.addEventListener("dispose",d),s[A.id]=!0,a.memory.geometries++),A}function m(w){const A=w.attributes;for(const I in A)e.update(A[I],n.ARRAY_BUFFER);const C=w.morphAttributes;for(const I in C){const k=C[I];for(let D=0,L=k.length;D<L;D++)e.update(k[D],n.ARRAY_BUFFER)}}function y(w){const A=[],C=w.index,I=w.attributes.position;let k=0;if(C!==null){const O=C.array;k=C.version;for(let F=0,B=O.length;F<B;F+=3){const G=O[F+0],q=O[F+1],X=O[F+2];A.push(G,q,q,X,X,G)}}else if(I!==void 0){const O=I.array;k=I.version;for(let F=0,B=O.length/3-1;F<B;F+=3){const G=F+0,q=F+1,X=F+2;A.push(G,q,q,X,X,G)}}else return;const D=new(EZ(A)?GD:VD)(A,1);D.version=k;const L=c.get(w);L&&e.remove(L),c.set(w,D)}function _(w){const A=c.get(w);if(A){const C=w.index;C!==null&&A.version<C.version&&y(w)}else y(w);return c.get(w)}return{get:f,update:m,getWireframeAttribute:_}}function zbe(n,e,a,o){const s=o.isWebGL2;let c;function d(A){c=A}let f,m;function y(A){f=A.type,m=A.bytesPerElement}function _(A,C){n.drawElements(c,C,f,A*m),a.update(C,c,1)}function w(A,C,I){if(I===0)return;let k,D;if(s)k=n,D="drawElementsInstanced";else if(k=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",k===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[D](c,C,f,A*m,I),a.update(C,c,I)}this.setMode=d,this.setIndex=y,this.render=_,this.renderInstances=w}function Fbe(n){const e={geometries:0,textures:0},a={frame:0,calls:0,triangles:0,points:0,lines:0};function o(c,d,f){switch(a.calls++,d){case n.TRIANGLES:a.triangles+=f*(c/3);break;case n.LINES:a.lines+=f*(c/2);break;case n.LINE_STRIP:a.lines+=f*(c-1);break;case n.LINE_LOOP:a.lines+=f*c;break;case n.POINTS:a.points+=f*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function s(){a.calls=0,a.triangles=0,a.points=0,a.lines=0}return{memory:e,render:a,programs:null,autoReset:!0,reset:s,update:o}}function Nbe(n,e){return n[0]-e[0]}function Bbe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function Ube(n,e,a){const o={},s=new Float32Array(8),c=new WeakMap,d=new Ai,f=[];for(let y=0;y<8;y++)f[y]=[y,0];function m(y,_,w){const A=y.morphTargetInfluences;if(e.isWebGL2===!0){const I=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,k=I!==void 0?I.length:0;let D=c.get(_);if(D===void 0||D.count!==k){let Ce=function(){be.dispose(),c.delete(_),_.removeEventListener("dispose",Ce)};var C=Ce;D!==void 0&&D.texture.dispose();const F=_.morphAttributes.position!==void 0,B=_.morphAttributes.normal!==void 0,G=_.morphAttributes.color!==void 0,q=_.morphAttributes.position||[],X=_.morphAttributes.normal||[],ee=_.morphAttributes.color||[];let V=0;F===!0&&(V=1),B===!0&&(V=2),G===!0&&(V=3);let Q=_.attributes.position.count*V,me=1;Q>e.maxTextureSize&&(me=Math.ceil(Q/e.maxTextureSize),Q=e.maxTextureSize);const pe=new Float32Array(Q*me*4*k),be=new wT(pe,Q,me,k);be.type=od,be.needsUpdate=!0;const fe=V*4;for(let Re=0;Re<k;Re++){const He=q[Re],ue=X[Re],ye=ee[Re],Ae=Q*me*4*Re;for(let ne=0;ne<He.count;ne++){const Ee=ne*fe;F===!0&&(d.fromBufferAttribute(He,ne),pe[Ae+Ee+0]=d.x,pe[Ae+Ee+1]=d.y,pe[Ae+Ee+2]=d.z,pe[Ae+Ee+3]=0),B===!0&&(d.fromBufferAttribute(ue,ne),pe[Ae+Ee+4]=d.x,pe[Ae+Ee+5]=d.y,pe[Ae+Ee+6]=d.z,pe[Ae+Ee+7]=0),G===!0&&(d.fromBufferAttribute(ye,ne),pe[Ae+Ee+8]=d.x,pe[Ae+Ee+9]=d.y,pe[Ae+Ee+10]=d.z,pe[Ae+Ee+11]=ye.itemSize===4?d.w:1)}}D={count:k,texture:be,size:new Kt(Q,me)},c.set(_,D),_.addEventListener("dispose",Ce)}let L=0;for(let F=0;F<A.length;F++)L+=A[F];const O=_.morphTargetsRelative?1:1-L;w.getUniforms().setValue(n,"morphTargetBaseInfluence",O),w.getUniforms().setValue(n,"morphTargetInfluences",A),w.getUniforms().setValue(n,"morphTargetsTexture",D.texture,a),w.getUniforms().setValue(n,"morphTargetsTextureSize",D.size)}else{const I=A===void 0?0:A.length;let k=o[_.id];if(k===void 0||k.length!==I){k=[];for(let B=0;B<I;B++)k[B]=[B,0];o[_.id]=k}for(let B=0;B<I;B++){const G=k[B];G[0]=B,G[1]=A[B]}k.sort(Bbe);for(let B=0;B<8;B++)B<I&&k[B][1]?(f[B][0]=k[B][0],f[B][1]=k[B][1]):(f[B][0]=Number.MAX_SAFE_INTEGER,f[B][1]=0);f.sort(Nbe);const D=_.morphAttributes.position,L=_.morphAttributes.normal;let O=0;for(let B=0;B<8;B++){const G=f[B],q=G[0],X=G[1];q!==Number.MAX_SAFE_INTEGER&&X?(D&&_.getAttribute("morphTarget"+B)!==D[q]&&_.setAttribute("morphTarget"+B,D[q]),L&&_.getAttribute("morphNormal"+B)!==L[q]&&_.setAttribute("morphNormal"+B,L[q]),s[B]=X,O+=X):(D&&_.hasAttribute("morphTarget"+B)===!0&&_.deleteAttribute("morphTarget"+B),L&&_.hasAttribute("morphNormal"+B)===!0&&_.deleteAttribute("morphNormal"+B),s[B]=0)}const F=_.morphTargetsRelative?1:1-O;w.getUniforms().setValue(n,"morphTargetBaseInfluence",F),w.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:m}}function Wbe(n,e,a,o){let s=new WeakMap;function c(m){const y=o.render.frame,_=m.geometry,w=e.get(m,_);if(s.get(w)!==y&&(e.update(w),s.set(w,y)),m.isInstancedMesh&&(m.hasEventListener("dispose",f)===!1&&m.addEventListener("dispose",f),s.get(m)!==y&&(a.update(m.instanceMatrix,n.ARRAY_BUFFER),m.instanceColor!==null&&a.update(m.instanceColor,n.ARRAY_BUFFER),s.set(m,y))),m.isSkinnedMesh){const A=m.skeleton;s.get(A)!==y&&(A.update(),s.set(A,y))}return w}function d(){s=new WeakMap}function f(m){const y=m.target;y.removeEventListener("dispose",f),a.remove(y.instanceMatrix),y.instanceColor!==null&&a.remove(y.instanceColor)}return{update:c,dispose:d}}const kZ=new Lr,DZ=new wT,OZ=new WD,zZ=new Pw,fW=[],pW=[],mW=new Float32Array(16),gW=new Float32Array(9),yW=new Float32Array(4);function d_(n,e,a){const o=n[0];if(o<=0||o>0)return n;const s=e*a;let c=fW[s];if(c===void 0&&(c=new Float32Array(s),fW[s]=c),e!==0){o.toArray(c,0);for(let d=1,f=0;d!==e;++d)f+=a,n[d].toArray(c,f)}return c}function Io(n,e){if(n.length!==e.length)return!1;for(let a=0,o=n.length;a<o;a++)if(n[a]!==e[a])return!1;return!0}function Lo(n,e){for(let a=0,o=e.length;a<o;a++)n[a]=e[a]}function AT(n,e){let a=pW[e];a===void 0&&(a=new Int32Array(e),pW[e]=a);for(let o=0;o!==e;++o)a[o]=n.allocateTextureUnit();return a}function Vbe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1f(this.addr,e),a[0]=e)}function Gbe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(Io(a,e))return;n.uniform2fv(this.addr,e),Lo(a,e)}}function Hbe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else if(e.r!==void 0)(a[0]!==e.r||a[1]!==e.g||a[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),a[0]=e.r,a[1]=e.g,a[2]=e.b);else{if(Io(a,e))return;n.uniform3fv(this.addr,e),Lo(a,e)}}function jbe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(Io(a,e))return;n.uniform4fv(this.addr,e),Lo(a,e)}}function $be(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(Io(a,e))return;n.uniformMatrix2fv(this.addr,!1,e),Lo(a,e)}else{if(Io(a,o))return;yW.set(o),n.uniformMatrix2fv(this.addr,!1,yW),Lo(a,o)}}function qbe(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(Io(a,e))return;n.uniformMatrix3fv(this.addr,!1,e),Lo(a,e)}else{if(Io(a,o))return;gW.set(o),n.uniformMatrix3fv(this.addr,!1,gW),Lo(a,o)}}function Xbe(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(Io(a,e))return;n.uniformMatrix4fv(this.addr,!1,e),Lo(a,e)}else{if(Io(a,o))return;mW.set(o),n.uniformMatrix4fv(this.addr,!1,mW),Lo(a,o)}}function Zbe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1i(this.addr,e),a[0]=e)}function Ybe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(Io(a,e))return;n.uniform2iv(this.addr,e),Lo(a,e)}}function Kbe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else{if(Io(a,e))return;n.uniform3iv(this.addr,e),Lo(a,e)}}function Jbe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(Io(a,e))return;n.uniform4iv(this.addr,e),Lo(a,e)}}function Qbe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1ui(this.addr,e),a[0]=e)}function exe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(Io(a,e))return;n.uniform2uiv(this.addr,e),Lo(a,e)}}function txe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else{if(Io(a,e))return;n.uniform3uiv(this.addr,e),Lo(a,e)}}function nxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(Io(a,e))return;n.uniform4uiv(this.addr,e),Lo(a,e)}}function axe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture2D(e||kZ,s)}function ixe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture3D(e||OZ,s)}function rxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTextureCube(e||zZ,s)}function oxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture2DArray(e||DZ,s)}function sxe(n){switch(n){case 5126:return Vbe;case 35664:return Gbe;case 35665:return Hbe;case 35666:return jbe;case 35674:return $be;case 35675:return qbe;case 35676:return Xbe;case 5124:case 35670:return Zbe;case 35667:case 35671:return Ybe;case 35668:case 35672:return Kbe;case 35669:case 35673:return Jbe;case 5125:return Qbe;case 36294:return exe;case 36295:return txe;case 36296:return nxe;case 35678:case 36198:case 36298:case 36306:case 35682:return axe;case 35679:case 36299:case 36307:return ixe;case 35680:case 36300:case 36308:case 36293:return rxe;case 36289:case 36303:case 36311:case 36292:return oxe}}function lxe(n,e){n.uniform1fv(this.addr,e)}function cxe(n,e){const a=d_(e,this.size,2);n.uniform2fv(this.addr,a)}function uxe(n,e){const a=d_(e,this.size,3);n.uniform3fv(this.addr,a)}function dxe(n,e){const a=d_(e,this.size,4);n.uniform4fv(this.addr,a)}function hxe(n,e){const a=d_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,a)}function fxe(n,e){const a=d_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,a)}function pxe(n,e){const a=d_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,a)}function mxe(n,e){n.uniform1iv(this.addr,e)}function gxe(n,e){n.uniform2iv(this.addr,e)}function yxe(n,e){n.uniform3iv(this.addr,e)}function vxe(n,e){n.uniform4iv(this.addr,e)}function _xe(n,e){n.uniform1uiv(this.addr,e)}function bxe(n,e){n.uniform2uiv(this.addr,e)}function xxe(n,e){n.uniform3uiv(this.addr,e)}function wxe(n,e){n.uniform4uiv(this.addr,e)}function Sxe(n,e,a){const o=this.cache,s=e.length,c=AT(a,s);Io(o,c)||(n.uniform1iv(this.addr,c),Lo(o,c));for(let d=0;d!==s;++d)a.setTexture2D(e[d]||kZ,c[d])}function Axe(n,e,a){const o=this.cache,s=e.length,c=AT(a,s);Io(o,c)||(n.uniform1iv(this.addr,c),Lo(o,c));for(let d=0;d!==s;++d)a.setTexture3D(e[d]||OZ,c[d])}function Exe(n,e,a){const o=this.cache,s=e.length,c=AT(a,s);Io(o,c)||(n.uniform1iv(this.addr,c),Lo(o,c));for(let d=0;d!==s;++d)a.setTextureCube(e[d]||zZ,c[d])}function Mxe(n,e,a){const o=this.cache,s=e.length,c=AT(a,s);Io(o,c)||(n.uniform1iv(this.addr,c),Lo(o,c));for(let d=0;d!==s;++d)a.setTexture2DArray(e[d]||DZ,c[d])}function Txe(n){switch(n){case 5126:return lxe;case 35664:return cxe;case 35665:return uxe;case 35666:return dxe;case 35674:return hxe;case 35675:return fxe;case 35676:return pxe;case 5124:case 35670:return mxe;case 35667:case 35671:return gxe;case 35668:case 35672:return yxe;case 35669:case 35673:return vxe;case 5125:return _xe;case 36294:return bxe;case 36295:return xxe;case 36296:return wxe;case 35678:case 36198:case 36298:case 36306:case 35682:return Sxe;case 35679:case 36299:case 36307:return Axe;case 35680:case 36300:case 36308:case 36293:return Exe;case 36289:case 36303:case 36311:case 36292:return Mxe}}class Cxe{constructor(e,a,o){this.id=e,this.addr=o,this.cache=[],this.setValue=sxe(a.type)}}class Pxe{constructor(e,a,o){this.id=e,this.addr=o,this.cache=[],this.size=a.size,this.setValue=Txe(a.type)}}class Ixe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,a,o){const s=this.seq;for(let c=0,d=s.length;c!==d;++c){const f=s[c];f.setValue(e,a[f.id],o)}}}const M4=/(\w+)(\])?(\[|\.)?/g;function vW(n,e){n.seq.push(e),n.map[e.id]=e}function Lxe(n,e,a){const o=n.name,s=o.length;for(M4.lastIndex=0;;){const c=M4.exec(o),d=M4.lastIndex;let f=c[1];const m=c[2]==="]",y=c[3];if(m&&(f=f|0),y===void 0||y==="["&&d+2===s){vW(a,y===void 0?new Cxe(f,n,e):new Pxe(f,n,e));break}else{let w=a.map[f];w===void 0&&(w=new Ixe(f),vW(a,w)),a=w}}}class VA{constructor(e,a){this.seq=[],this.map={};const o=e.getProgramParameter(a,e.ACTIVE_UNIFORMS);for(let s=0;s<o;++s){const c=e.getActiveUniform(a,s),d=e.getUniformLocation(a,c.name);Lxe(c,d,this)}}setValue(e,a,o,s){const c=this.map[a];c!==void 0&&c.setValue(e,o,s)}setOptional(e,a,o){const s=a[o];s!==void 0&&this.setValue(e,o,s)}static upload(e,a,o,s){for(let c=0,d=a.length;c!==d;++c){const f=a[c],m=o[f.id];m.needsUpdate!==!1&&f.setValue(e,m.value,s)}}static seqWithValue(e,a){const o=[];for(let s=0,c=e.length;s!==c;++s){const d=e[s];d.id in a&&o.push(d)}return o}}function _W(n,e,a){const o=n.createShader(e);return n.shaderSource(o,a),n.compileShader(o),o}const Rxe=37297;let kxe=0;function Dxe(n,e){const a=n.split(`
`),o=[],s=Math.max(e-6,0),c=Math.min(e+6,a.length);for(let d=s;d<c;d++){const f=d+1;o.push(`${f===e?">":" "} ${f}: ${a[d]}`)}return o.join(`
`)}function Oxe(n){const e=Oi.getPrimaries(Oi.workingColorSpace),a=Oi.getPrimaries(n);let o;switch(e===a?o="":e===Wx&&a===Ux?o="LinearDisplayP3ToLinearSRGB":e===Ux&&a===Wx&&(o="LinearSRGBToLinearDisplayP3"),n){case gd:case Mw:return[o,"LinearTransferOETF"];case To:case xT:return[o,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[o,"LinearTransferOETF"]}}function bW(n,e,a){const o=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(o&&s==="")return"";const c=/ERROR: 0:(\d+)/.exec(s);if(c){const d=parseInt(c[1]);return a.toUpperCase()+`

`+s+`

`+Dxe(n.getShaderSource(e),d)}else return s}function zxe(n,e){const a=Oxe(e);return`vec4 ${n}( vec4 value ) { return ${a[0]}( ${a[1]}( value ) ); }`}function Fxe(n,e){let a;switch(e){case KX:a="Linear";break;case JX:a="Reinhard";break;case QX:a="OptimizedCineon";break;case CD:a="ACESFilmic";break;case eZ:a="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),a="Linear"}return"vec3 "+n+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function Nxe(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ab).join(`
`)}function Bxe(n){const e=[];for(const a in n){const o=n[a];o!==!1&&e.push("#define "+a+" "+o)}return e.join(`
`)}function Uxe(n,e){const a={},o=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<o;s++){const c=n.getActiveAttrib(e,s),d=c.name;let f=1;c.type===n.FLOAT_MAT2&&(f=2),c.type===n.FLOAT_MAT3&&(f=3),c.type===n.FLOAT_MAT4&&(f=4),a[d]={type:c.type,location:n.getAttribLocation(e,d),locationSize:f}}return a}function Ab(n){return n!==""}function xW(n,e){const a=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,a).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function wW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Wxe=/^[ \t]*#include +<([\w\d./]+)>/gm;function hR(n){return n.replace(Wxe,Gxe)}const Vxe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Gxe(n,e){let a=Oa[e];if(a===void 0){const o=Vxe.get(e);if(o!==void 0)a=Oa[o],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,o);else throw new Error("Can not resolve #include <"+e+">")}return hR(a)}const Hxe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function SW(n){return n.replace(Hxe,jxe)}function jxe(n,e,a,o){let s="";for(let c=parseInt(e);c<parseInt(a);c++)s+=o.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return s}function AW(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function $xe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===yT?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===$b?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Qc&&(e="SHADOWMAP_TYPE_VSM"),e}function qxe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Fh:case yp:e="ENVMAP_TYPE_CUBE";break;case u_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Xxe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case yp:e="ENVMAP_MODE_REFRACTION";break}return e}function Zxe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Ew:e="ENVMAP_BLENDING_MULTIPLY";break;case ZX:e="ENVMAP_BLENDING_MIX";break;case YX:e="ENVMAP_BLENDING_ADD";break}return e}function Yxe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const a=Math.log2(e)-2,o=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,a),7*16)),texelHeight:o,maxMip:a}}function Kxe(n,e,a,o){const s=n.getContext(),c=a.defines;let d=a.vertexShader,f=a.fragmentShader;const m=$xe(a),y=qxe(a),_=Xxe(a),w=Zxe(a),A=Yxe(a),C=a.isWebGL2?"":Nxe(a),I=Bxe(c),k=s.createProgram();let D,L,O=a.glslVersion?"#version "+a.glslVersion+`
`:"";a.isRawShaderMaterial?(D=["#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I].filter(Ab).join(`
`),D.length>0&&(D+=`
`),L=[C,"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I].filter(Ab).join(`
`),L.length>0&&(L+=`
`)):(D=[AW(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I,a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+_:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.displacementMap?"#define USE_DISPLACEMENTMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.mapUv?"#define MAP_UV "+a.mapUv:"",a.alphaMapUv?"#define ALPHAMAP_UV "+a.alphaMapUv:"",a.lightMapUv?"#define LIGHTMAP_UV "+a.lightMapUv:"",a.aoMapUv?"#define AOMAP_UV "+a.aoMapUv:"",a.emissiveMapUv?"#define EMISSIVEMAP_UV "+a.emissiveMapUv:"",a.bumpMapUv?"#define BUMPMAP_UV "+a.bumpMapUv:"",a.normalMapUv?"#define NORMALMAP_UV "+a.normalMapUv:"",a.displacementMapUv?"#define DISPLACEMENTMAP_UV "+a.displacementMapUv:"",a.metalnessMapUv?"#define METALNESSMAP_UV "+a.metalnessMapUv:"",a.roughnessMapUv?"#define ROUGHNESSMAP_UV "+a.roughnessMapUv:"",a.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+a.anisotropyMapUv:"",a.clearcoatMapUv?"#define CLEARCOATMAP_UV "+a.clearcoatMapUv:"",a.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+a.clearcoatNormalMapUv:"",a.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+a.clearcoatRoughnessMapUv:"",a.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+a.iridescenceMapUv:"",a.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+a.iridescenceThicknessMapUv:"",a.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+a.sheenColorMapUv:"",a.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+a.sheenRoughnessMapUv:"",a.specularMapUv?"#define SPECULARMAP_UV "+a.specularMapUv:"",a.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+a.specularColorMapUv:"",a.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+a.specularIntensityMapUv:"",a.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+a.transmissionMapUv:"",a.thicknessMapUv?"#define THICKNESSMAP_UV "+a.thicknessMapUv:"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&a.flatShading===!1?"#define USE_MORPHNORMALS":"",a.morphColors&&a.isWebGL2?"#define USE_MORPHCOLORS":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+a.morphTextureStride:"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_COUNT "+a.morphTargetsCount:"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ab).join(`
`),L=[C,AW(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+y:"",a.envMap?"#define "+_:"",a.envMap?"#define "+w:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoat?"#define USE_CLEARCOAT":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescence?"#define USE_IRIDESCENCE":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaTest?"#define USE_ALPHATEST":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.sheen?"#define USE_SHEEN":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==dd?"#define TONE_MAPPING":"",a.toneMapping!==dd?Oa.tonemapping_pars_fragment:"",a.toneMapping!==dd?Fxe("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.opaque?"#define OPAQUE":"",Oa.colorspace_pars_fragment,zxe("linearToOutputTexel",a.outputColorSpace),a.useDepthPacking?"#define DEPTH_PACKING "+a.depthPacking:"",`
`].filter(Ab).join(`
`)),d=hR(d),d=xW(d,a),d=wW(d,a),f=hR(f),f=xW(f,a),f=wW(f,a),d=SW(d),f=SW(f),a.isWebGL2&&a.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,L=["precision mediump sampler2DArray;","#define varying in",a.glslVersion===cR?"":"layout(location = 0) out highp vec4 pc_fragColor;",a.glslVersion===cR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+L);const F=O+D+d,B=O+L+f,G=_W(s,s.VERTEX_SHADER,F),q=_W(s,s.FRAGMENT_SHADER,B);s.attachShader(k,G),s.attachShader(k,q),a.index0AttributeName!==void 0?s.bindAttribLocation(k,0,a.index0AttributeName):a.morphTargets===!0&&s.bindAttribLocation(k,0,"position"),s.linkProgram(k);function X(me){if(n.debug.checkShaderErrors){const pe=s.getProgramInfoLog(k).trim(),be=s.getShaderInfoLog(G).trim(),fe=s.getShaderInfoLog(q).trim();let Ce=!0,Re=!0;if(s.getProgramParameter(k,s.LINK_STATUS)===!1)if(Ce=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,k,G,q);else{const He=bW(s,G,"vertex"),ue=bW(s,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(k,s.VALIDATE_STATUS)+`

Program Info Log: `+pe+`
`+He+`
`+ue)}else pe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",pe):(be===""||fe==="")&&(Re=!1);Re&&(me.diagnostics={runnable:Ce,programLog:pe,vertexShader:{log:be,prefix:D},fragmentShader:{log:fe,prefix:L}})}s.deleteShader(G),s.deleteShader(q),ee=new VA(s,k),V=Uxe(s,k)}let ee;this.getUniforms=function(){return ee===void 0&&X(this),ee};let V;this.getAttributes=function(){return V===void 0&&X(this),V};let Q=a.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Q===!1&&(Q=s.getProgramParameter(k,Rxe)),Q},this.destroy=function(){o.releaseStatesOfProgram(this),s.deleteProgram(k),this.program=void 0},this.type=a.shaderType,this.name=a.shaderName,this.id=kxe++,this.cacheKey=e,this.usedTimes=1,this.program=k,this.vertexShader=G,this.fragmentShader=q,this}let Jxe=0;class Qxe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const a=e.vertexShader,o=e.fragmentShader,s=this._getShaderStage(a),c=this._getShaderStage(o),d=this._getShaderCacheForMaterial(e);return d.has(s)===!1&&(d.add(s),s.usedTimes++),d.has(c)===!1&&(d.add(c),c.usedTimes++),this}remove(e){const a=this.materialCache.get(e);for(const o of a)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const a=this.materialCache;let o=a.get(e);return o===void 0&&(o=new Set,a.set(e,o)),o}_getShaderStage(e){const a=this.shaderCache;let o=a.get(e);return o===void 0&&(o=new ewe(e),a.set(e,o)),o}}class ewe{constructor(e){this.id=Jxe++,this.code=e,this.usedTimes=0}}function twe(n,e,a,o,s,c,d){const f=new _g,m=new Qxe,y=[],_=s.isWebGL2,w=s.logarithmicDepthBuffer,A=s.vertexTextures;let C=s.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function k(V){return V===0?"uv":`uv${V}`}function D(V,Q,me,pe,be){const fe=pe.fog,Ce=be.geometry,Re=V.isMeshStandardMaterial?pe.environment:null,He=(V.isMeshStandardMaterial?a:e).get(V.envMap||Re),ue=He&&He.mapping===u_?He.image.height:null,ye=I[V.type];V.precision!==null&&(C=s.getMaxPrecision(V.precision),C!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",C,"instead."));const Ae=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,ne=Ae!==void 0?Ae.length:0;let Ee=0;Ce.morphAttributes.position!==void 0&&(Ee=1),Ce.morphAttributes.normal!==void 0&&(Ee=2),Ce.morphAttributes.color!==void 0&&(Ee=3);let Ye,Xe,Ke,Ue;if(ye){const yt=au[ye];Ye=yt.vertexShader,Xe=yt.fragmentShader}else Ye=V.vertexShader,Xe=V.fragmentShader,m.update(V),Ke=m.getVertexShaderID(V),Ue=m.getFragmentShaderID(V);const ht=n.getRenderTarget(),Lt=be.isInstancedMesh===!0,Rt=!!V.map,Jt=!!V.matcap,Pt=!!He,Pe=!!V.aoMap,ft=!!V.lightMap,gt=!!V.bumpMap,St=!!V.normalMap,Be=!!V.displacementMap,le=!!V.emissiveMap,oe=!!V.metalnessMap,ve=!!V.roughnessMap,$e=V.anisotropy>0,De=V.clearcoat>0,ot=V.iridescence>0,ce=V.sheen>0,te=V.transmission>0,Oe=$e&&!!V.anisotropyMap,pt=De&&!!V.clearcoatMap,it=De&&!!V.clearcoatNormalMap,st=De&&!!V.clearcoatRoughnessMap,At=ot&&!!V.iridescenceMap,Ut=ot&&!!V.iridescenceThicknessMap,Vt=ce&&!!V.sheenColorMap,$t=ce&&!!V.sheenRoughnessMap,Ft=!!V.specularMap,wt=!!V.specularColorMap,Yt=!!V.specularIntensityMap,Ge=te&&!!V.transmissionMap,It=te&&!!V.thicknessMap,qt=!!V.gradientMap,Dt=!!V.alphaMap,fn=V.alphaTest>0,_e=!!V.alphaHash,Ze=!!V.extensions,Se=!!Ce.attributes.uv1,Me=!!Ce.attributes.uv2,ze=!!Ce.attributes.uv3;let Je=dd;return V.toneMapped&&(ht===null||ht.isXRRenderTarget===!0)&&(Je=n.toneMapping),{isWebGL2:_,shaderID:ye,shaderType:V.type,shaderName:V.name,vertexShader:Ye,fragmentShader:Xe,defines:V.defines,customVertexShaderID:Ke,customFragmentShaderID:Ue,isRawShaderMaterial:V.isRawShaderMaterial===!0,glslVersion:V.glslVersion,precision:C,instancing:Lt,instancingColor:Lt&&be.instanceColor!==null,supportsVertexTextures:A,outputColorSpace:ht===null?n.outputColorSpace:ht.isXRRenderTarget===!0?ht.texture.colorSpace:gd,map:Rt,matcap:Jt,envMap:Pt,envMapMode:Pt&&He.mapping,envMapCubeUVHeight:ue,aoMap:Pe,lightMap:ft,bumpMap:gt,normalMap:St,displacementMap:A&&Be,emissiveMap:le,normalMapObjectSpace:St&&V.normalMapType===mZ,normalMapTangentSpace:St&&V.normalMapType===Ep,metalnessMap:oe,roughnessMap:ve,anisotropy:$e,anisotropyMap:Oe,clearcoat:De,clearcoatMap:pt,clearcoatNormalMap:it,clearcoatRoughnessMap:st,iridescence:ot,iridescenceMap:At,iridescenceThicknessMap:Ut,sheen:ce,sheenColorMap:Vt,sheenRoughnessMap:$t,specularMap:Ft,specularColorMap:wt,specularIntensityMap:Yt,transmission:te,transmissionMap:Ge,thicknessMap:It,gradientMap:qt,opaque:V.transparent===!1&&V.blending===yg,alphaMap:Dt,alphaTest:fn,alphaHash:_e,combine:V.combine,mapUv:Rt&&k(V.map.channel),aoMapUv:Pe&&k(V.aoMap.channel),lightMapUv:ft&&k(V.lightMap.channel),bumpMapUv:gt&&k(V.bumpMap.channel),normalMapUv:St&&k(V.normalMap.channel),displacementMapUv:Be&&k(V.displacementMap.channel),emissiveMapUv:le&&k(V.emissiveMap.channel),metalnessMapUv:oe&&k(V.metalnessMap.channel),roughnessMapUv:ve&&k(V.roughnessMap.channel),anisotropyMapUv:Oe&&k(V.anisotropyMap.channel),clearcoatMapUv:pt&&k(V.clearcoatMap.channel),clearcoatNormalMapUv:it&&k(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:st&&k(V.clearcoatRoughnessMap.channel),iridescenceMapUv:At&&k(V.iridescenceMap.channel),iridescenceThicknessMapUv:Ut&&k(V.iridescenceThicknessMap.channel),sheenColorMapUv:Vt&&k(V.sheenColorMap.channel),sheenRoughnessMapUv:$t&&k(V.sheenRoughnessMap.channel),specularMapUv:Ft&&k(V.specularMap.channel),specularColorMapUv:wt&&k(V.specularColorMap.channel),specularIntensityMapUv:Yt&&k(V.specularIntensityMap.channel),transmissionMapUv:Ge&&k(V.transmissionMap.channel),thicknessMapUv:It&&k(V.thicknessMap.channel),alphaMapUv:Dt&&k(V.alphaMap.channel),vertexTangents:!!Ce.attributes.tangent&&(St||$e),vertexColors:V.vertexColors,vertexAlphas:V.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,vertexUv1s:Se,vertexUv2s:Me,vertexUv3s:ze,pointsUvs:be.isPoints===!0&&!!Ce.attributes.uv&&(Rt||Dt),fog:!!fe,useFog:V.fog===!0,fogExp2:fe&&fe.isFogExp2,flatShading:V.flatShading===!0,sizeAttenuation:V.sizeAttenuation===!0,logarithmicDepthBuffer:w,skinning:be.isSkinnedMesh===!0,morphTargets:Ce.morphAttributes.position!==void 0,morphNormals:Ce.morphAttributes.normal!==void 0,morphColors:Ce.morphAttributes.color!==void 0,morphTargetsCount:ne,morphTextureStride:Ee,numDirLights:Q.directional.length,numPointLights:Q.point.length,numSpotLights:Q.spot.length,numSpotLightMaps:Q.spotLightMap.length,numRectAreaLights:Q.rectArea.length,numHemiLights:Q.hemi.length,numDirLightShadows:Q.directionalShadowMap.length,numPointLightShadows:Q.pointShadowMap.length,numSpotLightShadows:Q.spotShadowMap.length,numSpotLightShadowsWithMaps:Q.numSpotLightShadowsWithMaps,numLightProbes:Q.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:V.dithering,shadowMapEnabled:n.shadowMap.enabled&&me.length>0,shadowMapType:n.shadowMap.type,toneMapping:Je,useLegacyLights:n._useLegacyLights,decodeVideoTexture:Rt&&V.map.isVideoTexture===!0&&Oi.getTransfer(V.map.colorSpace)===Ji,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===Ul,flipSided:V.side===vs,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionDerivatives:Ze&&V.extensions.derivatives===!0,extensionFragDepth:Ze&&V.extensions.fragDepth===!0,extensionDrawBuffers:Ze&&V.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ze&&V.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:_||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||o.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:o.has("KHR_parallel_shader_compile"),customProgramCacheKey:V.customProgramCacheKey()}}function L(V){const Q=[];if(V.shaderID?Q.push(V.shaderID):(Q.push(V.customVertexShaderID),Q.push(V.customFragmentShaderID)),V.defines!==void 0)for(const me in V.defines)Q.push(me),Q.push(V.defines[me]);return V.isRawShaderMaterial===!1&&(O(Q,V),F(Q,V),Q.push(n.outputColorSpace)),Q.push(V.customProgramCacheKey),Q.join()}function O(V,Q){V.push(Q.precision),V.push(Q.outputColorSpace),V.push(Q.envMapMode),V.push(Q.envMapCubeUVHeight),V.push(Q.mapUv),V.push(Q.alphaMapUv),V.push(Q.lightMapUv),V.push(Q.aoMapUv),V.push(Q.bumpMapUv),V.push(Q.normalMapUv),V.push(Q.displacementMapUv),V.push(Q.emissiveMapUv),V.push(Q.metalnessMapUv),V.push(Q.roughnessMapUv),V.push(Q.anisotropyMapUv),V.push(Q.clearcoatMapUv),V.push(Q.clearcoatNormalMapUv),V.push(Q.clearcoatRoughnessMapUv),V.push(Q.iridescenceMapUv),V.push(Q.iridescenceThicknessMapUv),V.push(Q.sheenColorMapUv),V.push(Q.sheenRoughnessMapUv),V.push(Q.specularMapUv),V.push(Q.specularColorMapUv),V.push(Q.specularIntensityMapUv),V.push(Q.transmissionMapUv),V.push(Q.thicknessMapUv),V.push(Q.combine),V.push(Q.fogExp2),V.push(Q.sizeAttenuation),V.push(Q.morphTargetsCount),V.push(Q.morphAttributeCount),V.push(Q.numDirLights),V.push(Q.numPointLights),V.push(Q.numSpotLights),V.push(Q.numSpotLightMaps),V.push(Q.numHemiLights),V.push(Q.numRectAreaLights),V.push(Q.numDirLightShadows),V.push(Q.numPointLightShadows),V.push(Q.numSpotLightShadows),V.push(Q.numSpotLightShadowsWithMaps),V.push(Q.numLightProbes),V.push(Q.shadowMapType),V.push(Q.toneMapping),V.push(Q.numClippingPlanes),V.push(Q.numClipIntersection),V.push(Q.depthPacking)}function F(V,Q){f.disableAll(),Q.isWebGL2&&f.enable(0),Q.supportsVertexTextures&&f.enable(1),Q.instancing&&f.enable(2),Q.instancingColor&&f.enable(3),Q.matcap&&f.enable(4),Q.envMap&&f.enable(5),Q.normalMapObjectSpace&&f.enable(6),Q.normalMapTangentSpace&&f.enable(7),Q.clearcoat&&f.enable(8),Q.iridescence&&f.enable(9),Q.alphaTest&&f.enable(10),Q.vertexColors&&f.enable(11),Q.vertexAlphas&&f.enable(12),Q.vertexUv1s&&f.enable(13),Q.vertexUv2s&&f.enable(14),Q.vertexUv3s&&f.enable(15),Q.vertexTangents&&f.enable(16),Q.anisotropy&&f.enable(17),Q.alphaHash&&f.enable(18),V.push(f.mask),f.disableAll(),Q.fog&&f.enable(0),Q.useFog&&f.enable(1),Q.flatShading&&f.enable(2),Q.logarithmicDepthBuffer&&f.enable(3),Q.skinning&&f.enable(4),Q.morphTargets&&f.enable(5),Q.morphNormals&&f.enable(6),Q.morphColors&&f.enable(7),Q.premultipliedAlpha&&f.enable(8),Q.shadowMapEnabled&&f.enable(9),Q.useLegacyLights&&f.enable(10),Q.doubleSided&&f.enable(11),Q.flipSided&&f.enable(12),Q.useDepthPacking&&f.enable(13),Q.dithering&&f.enable(14),Q.transmission&&f.enable(15),Q.sheen&&f.enable(16),Q.opaque&&f.enable(17),Q.pointsUvs&&f.enable(18),Q.decodeVideoTexture&&f.enable(19),V.push(f.mask)}function B(V){const Q=I[V.type];let me;if(Q){const pe=au[Q];me=HD.clone(pe.uniforms)}else me=V.uniforms;return me}function G(V,Q){let me;for(let pe=0,be=y.length;pe<be;pe++){const fe=y[pe];if(fe.cacheKey===Q){me=fe,++me.usedTimes;break}}return me===void 0&&(me=new Kxe(n,Q,V,c),y.push(me)),me}function q(V){if(--V.usedTimes===0){const Q=y.indexOf(V);y[Q]=y[y.length-1],y.pop(),V.destroy()}}function X(V){m.remove(V)}function ee(){m.dispose()}return{getParameters:D,getProgramCacheKey:L,getUniforms:B,acquireProgram:G,releaseProgram:q,releaseShaderCache:X,programs:y,dispose:ee}}function nwe(){let n=new WeakMap;function e(c){let d=n.get(c);return d===void 0&&(d={},n.set(c,d)),d}function a(c){n.delete(c)}function o(c,d,f){n.get(c)[d]=f}function s(){n=new WeakMap}return{get:e,remove:a,update:o,dispose:s}}function awe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function EW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function MW(){const n=[];let e=0;const a=[],o=[],s=[];function c(){e=0,a.length=0,o.length=0,s.length=0}function d(w,A,C,I,k,D){let L=n[e];return L===void 0?(L={id:w.id,object:w,geometry:A,material:C,groupOrder:I,renderOrder:w.renderOrder,z:k,group:D},n[e]=L):(L.id=w.id,L.object=w,L.geometry=A,L.material=C,L.groupOrder=I,L.renderOrder=w.renderOrder,L.z=k,L.group=D),e++,L}function f(w,A,C,I,k,D){const L=d(w,A,C,I,k,D);C.transmission>0?o.push(L):C.transparent===!0?s.push(L):a.push(L)}function m(w,A,C,I,k,D){const L=d(w,A,C,I,k,D);C.transmission>0?o.unshift(L):C.transparent===!0?s.unshift(L):a.unshift(L)}function y(w,A){a.length>1&&a.sort(w||awe),o.length>1&&o.sort(A||EW),s.length>1&&s.sort(A||EW)}function _(){for(let w=e,A=n.length;w<A;w++){const C=n[w];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:a,transmissive:o,transparent:s,init:c,push:f,unshift:m,finish:_,sort:y}}function iwe(){let n=new WeakMap;function e(o,s){const c=n.get(o);let d;return c===void 0?(d=new MW,n.set(o,[d])):s>=c.length?(d=new MW,c.push(d)):d=c[s],d}function a(){n=new WeakMap}return{get:e,dispose:a}}function rwe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let a;switch(e.type){case"DirectionalLight":a={direction:new Fe,color:new Pn};break;case"SpotLight":a={position:new Fe,direction:new Fe,color:new Pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":a={position:new Fe,color:new Pn,distance:0,decay:0};break;case"HemisphereLight":a={direction:new Fe,skyColor:new Pn,groundColor:new Pn};break;case"RectAreaLight":a={color:new Pn,position:new Fe,halfWidth:new Fe,halfHeight:new Fe};break}return n[e.id]=a,a}}}function owe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let a;switch(e.type){case"DirectionalLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt};break;case"SpotLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt};break;case"PointLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=a,a}}}let swe=0;function lwe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function cwe(n,e){const a=new rwe,o=owe(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let _=0;_<9;_++)s.probe.push(new Fe);const c=new Fe,d=new Ia,f=new Ia;function m(_,w){let A=0,C=0,I=0;for(let pe=0;pe<9;pe++)s.probe[pe].set(0,0,0);let k=0,D=0,L=0,O=0,F=0,B=0,G=0,q=0,X=0,ee=0,V=0;_.sort(lwe);const Q=w===!0?Math.PI:1;for(let pe=0,be=_.length;pe<be;pe++){const fe=_[pe],Ce=fe.color,Re=fe.intensity,He=fe.distance,ue=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)A+=Ce.r*Re*Q,C+=Ce.g*Re*Q,I+=Ce.b*Re*Q;else if(fe.isLightProbe){for(let ye=0;ye<9;ye++)s.probe[ye].addScaledVector(fe.sh.coefficients[ye],Re);V++}else if(fe.isDirectionalLight){const ye=a.get(fe);if(ye.color.copy(fe.color).multiplyScalar(fe.intensity*Q),fe.castShadow){const Ae=fe.shadow,ne=o.get(fe);ne.shadowBias=Ae.bias,ne.shadowNormalBias=Ae.normalBias,ne.shadowRadius=Ae.radius,ne.shadowMapSize=Ae.mapSize,s.directionalShadow[k]=ne,s.directionalShadowMap[k]=ue,s.directionalShadowMatrix[k]=fe.shadow.matrix,B++}s.directional[k]=ye,k++}else if(fe.isSpotLight){const ye=a.get(fe);ye.position.setFromMatrixPosition(fe.matrixWorld),ye.color.copy(Ce).multiplyScalar(Re*Q),ye.distance=He,ye.coneCos=Math.cos(fe.angle),ye.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),ye.decay=fe.decay,s.spot[L]=ye;const Ae=fe.shadow;if(fe.map&&(s.spotLightMap[X]=fe.map,X++,Ae.updateMatrices(fe),fe.castShadow&&ee++),s.spotLightMatrix[L]=Ae.matrix,fe.castShadow){const ne=o.get(fe);ne.shadowBias=Ae.bias,ne.shadowNormalBias=Ae.normalBias,ne.shadowRadius=Ae.radius,ne.shadowMapSize=Ae.mapSize,s.spotShadow[L]=ne,s.spotShadowMap[L]=ue,q++}L++}else if(fe.isRectAreaLight){const ye=a.get(fe);ye.color.copy(Ce).multiplyScalar(Re),ye.halfWidth.set(fe.width*.5,0,0),ye.halfHeight.set(0,fe.height*.5,0),s.rectArea[O]=ye,O++}else if(fe.isPointLight){const ye=a.get(fe);if(ye.color.copy(fe.color).multiplyScalar(fe.intensity*Q),ye.distance=fe.distance,ye.decay=fe.decay,fe.castShadow){const Ae=fe.shadow,ne=o.get(fe);ne.shadowBias=Ae.bias,ne.shadowNormalBias=Ae.normalBias,ne.shadowRadius=Ae.radius,ne.shadowMapSize=Ae.mapSize,ne.shadowCameraNear=Ae.camera.near,ne.shadowCameraFar=Ae.camera.far,s.pointShadow[D]=ne,s.pointShadowMap[D]=ue,s.pointShadowMatrix[D]=fe.shadow.matrix,G++}s.point[D]=ye,D++}else if(fe.isHemisphereLight){const ye=a.get(fe);ye.skyColor.copy(fe.color).multiplyScalar(Re*Q),ye.groundColor.copy(fe.groundColor).multiplyScalar(Re*Q),s.hemi[F]=ye,F++}}O>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=bn.LTC_FLOAT_1,s.rectAreaLTC2=bn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=bn.LTC_HALF_1,s.rectAreaLTC2=bn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=A,s.ambient[1]=C,s.ambient[2]=I;const me=s.hash;(me.directionalLength!==k||me.pointLength!==D||me.spotLength!==L||me.rectAreaLength!==O||me.hemiLength!==F||me.numDirectionalShadows!==B||me.numPointShadows!==G||me.numSpotShadows!==q||me.numSpotMaps!==X||me.numLightProbes!==V)&&(s.directional.length=k,s.spot.length=L,s.rectArea.length=O,s.point.length=D,s.hemi.length=F,s.directionalShadow.length=B,s.directionalShadowMap.length=B,s.pointShadow.length=G,s.pointShadowMap.length=G,s.spotShadow.length=q,s.spotShadowMap.length=q,s.directionalShadowMatrix.length=B,s.pointShadowMatrix.length=G,s.spotLightMatrix.length=q+X-ee,s.spotLightMap.length=X,s.numSpotLightShadowsWithMaps=ee,s.numLightProbes=V,me.directionalLength=k,me.pointLength=D,me.spotLength=L,me.rectAreaLength=O,me.hemiLength=F,me.numDirectionalShadows=B,me.numPointShadows=G,me.numSpotShadows=q,me.numSpotMaps=X,me.numLightProbes=V,s.version=swe++)}function y(_,w){let A=0,C=0,I=0,k=0,D=0;const L=w.matrixWorldInverse;for(let O=0,F=_.length;O<F;O++){const B=_[O];if(B.isDirectionalLight){const G=s.directional[A];G.direction.setFromMatrixPosition(B.matrixWorld),c.setFromMatrixPosition(B.target.matrixWorld),G.direction.sub(c),G.direction.transformDirection(L),A++}else if(B.isSpotLight){const G=s.spot[I];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),G.direction.setFromMatrixPosition(B.matrixWorld),c.setFromMatrixPosition(B.target.matrixWorld),G.direction.sub(c),G.direction.transformDirection(L),I++}else if(B.isRectAreaLight){const G=s.rectArea[k];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),f.identity(),d.copy(B.matrixWorld),d.premultiply(L),f.extractRotation(d),G.halfWidth.set(B.width*.5,0,0),G.halfHeight.set(0,B.height*.5,0),G.halfWidth.applyMatrix4(f),G.halfHeight.applyMatrix4(f),k++}else if(B.isPointLight){const G=s.point[C];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),C++}else if(B.isHemisphereLight){const G=s.hemi[D];G.direction.setFromMatrixPosition(B.matrixWorld),G.direction.transformDirection(L),D++}}}return{setup:m,setupView:y,state:s}}function TW(n,e){const a=new cwe(n,e),o=[],s=[];function c(){o.length=0,s.length=0}function d(w){o.push(w)}function f(w){s.push(w)}function m(w){a.setup(o,w)}function y(w){a.setupView(o,w)}return{init:c,state:{lightsArray:o,shadowsArray:s,lights:a},setupLights:m,setupLightsView:y,pushLight:d,pushShadow:f}}function uwe(n,e){let a=new WeakMap;function o(c,d=0){const f=a.get(c);let m;return f===void 0?(m=new TW(n,e),a.set(c,[m])):d>=f.length?(m=new TW(n,e),f.push(m)):m=f[d],m}function s(){a=new WeakMap}return{get:o,dispose:s}}class ET extends Ko{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=pZ,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class MT extends Ko{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const dwe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,hwe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function fwe(n,e,a){let o=new ST;const s=new Kt,c=new Kt,d=new Ai,f=new ET({depthPacking:ND}),m=new MT,y={},_=a.maxTextureSize,w={[md]:vs,[vs]:md,[Ul]:Ul},A=new yd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Kt},radius:{value:4}},vertexShader:dwe,fragmentShader:hwe}),C=A.clone();C.defines.HORIZONTAL_PASS=1;const I=new La;I.setAttribute("position",new qi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const k=new bo(I,A),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=yT;let L=this.type;this.render=function(G,q,X){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||G.length===0)return;const ee=n.getRenderTarget(),V=n.getActiveCubeFace(),Q=n.getActiveMipmapLevel(),me=n.state;me.setBlending(Ph),me.buffers.color.setClear(1,1,1,1),me.buffers.depth.setTest(!0),me.setScissorTest(!1);const pe=L!==Qc&&this.type===Qc,be=L===Qc&&this.type!==Qc;for(let fe=0,Ce=G.length;fe<Ce;fe++){const Re=G[fe],He=Re.shadow;if(He===void 0){console.warn("THREE.WebGLShadowMap:",Re,"has no shadow.");continue}if(He.autoUpdate===!1&&He.needsUpdate===!1)continue;s.copy(He.mapSize);const ue=He.getFrameExtents();if(s.multiply(ue),c.copy(He.mapSize),(s.x>_||s.y>_)&&(s.x>_&&(c.x=Math.floor(_/ue.x),s.x=c.x*ue.x,He.mapSize.x=c.x),s.y>_&&(c.y=Math.floor(_/ue.y),s.y=c.y*ue.y,He.mapSize.y=c.y)),He.map===null||pe===!0||be===!0){const Ae=this.type!==Qc?{minFilter:ro,magFilter:ro}:{};He.map!==null&&He.map.dispose(),He.map=new hu(s.x,s.y,Ae),He.map.texture.name=Re.name+".shadowMap",He.camera.updateProjectionMatrix()}n.setRenderTarget(He.map),n.clear();const ye=He.getViewportCount();for(let Ae=0;Ae<ye;Ae++){const ne=He.getViewport(Ae);d.set(c.x*ne.x,c.y*ne.y,c.x*ne.z,c.y*ne.w),me.viewport(d),He.updateMatrices(Re,Ae),o=He.getFrustum(),B(q,X,He.camera,Re,this.type)}He.isPointLightShadow!==!0&&this.type===Qc&&O(He,X),He.needsUpdate=!1}L=this.type,D.needsUpdate=!1,n.setRenderTarget(ee,V,Q)};function O(G,q){const X=e.update(k);A.defines.VSM_SAMPLES!==G.blurSamples&&(A.defines.VSM_SAMPLES=G.blurSamples,C.defines.VSM_SAMPLES=G.blurSamples,A.needsUpdate=!0,C.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new hu(s.x,s.y)),A.uniforms.shadow_pass.value=G.map.texture,A.uniforms.resolution.value=G.mapSize,A.uniforms.radius.value=G.radius,n.setRenderTarget(G.mapPass),n.clear(),n.renderBufferDirect(q,null,X,A,k,null),C.uniforms.shadow_pass.value=G.mapPass.texture,C.uniforms.resolution.value=G.mapSize,C.uniforms.radius.value=G.radius,n.setRenderTarget(G.map),n.clear(),n.renderBufferDirect(q,null,X,C,k,null)}function F(G,q,X,ee){let V=null;const Q=X.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(Q!==void 0)V=Q;else if(V=X.isPointLight===!0?m:f,n.localClippingEnabled&&q.clipShadows===!0&&Array.isArray(q.clippingPlanes)&&q.clippingPlanes.length!==0||q.displacementMap&&q.displacementScale!==0||q.alphaMap&&q.alphaTest>0||q.map&&q.alphaTest>0){const me=V.uuid,pe=q.uuid;let be=y[me];be===void 0&&(be={},y[me]=be);let fe=be[pe];fe===void 0&&(fe=V.clone(),be[pe]=fe),V=fe}if(V.visible=q.visible,V.wireframe=q.wireframe,ee===Qc?V.side=q.shadowSide!==null?q.shadowSide:q.side:V.side=q.shadowSide!==null?q.shadowSide:w[q.side],V.alphaMap=q.alphaMap,V.alphaTest=q.alphaTest,V.map=q.map,V.clipShadows=q.clipShadows,V.clippingPlanes=q.clippingPlanes,V.clipIntersection=q.clipIntersection,V.displacementMap=q.displacementMap,V.displacementScale=q.displacementScale,V.displacementBias=q.displacementBias,V.wireframeLinewidth=q.wireframeLinewidth,V.linewidth=q.linewidth,X.isPointLight===!0&&V.isMeshDistanceMaterial===!0){const me=n.properties.get(V);me.light=X}return V}function B(G,q,X,ee,V){if(G.visible===!1)return;if(G.layers.test(q.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&V===Qc)&&(!G.frustumCulled||o.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(X.matrixWorldInverse,G.matrixWorld);const pe=e.update(G),be=G.material;if(Array.isArray(be)){const fe=pe.groups;for(let Ce=0,Re=fe.length;Ce<Re;Ce++){const He=fe[Ce],ue=be[He.materialIndex];if(ue&&ue.visible){const ye=F(G,ue,ee,V);n.renderBufferDirect(X,null,pe,ye,G,He)}}}else if(be.visible){const fe=F(G,be,ee,V);n.renderBufferDirect(X,null,pe,fe,G,null)}}const me=G.children;for(let pe=0,be=me.length;pe<be;pe++)B(me[pe],q,X,ee,V)}}function pwe(n,e,a){const o=a.isWebGL2;function s(){let _e=!1;const Ze=new Ai;let Se=null;const Me=new Ai(0,0,0,0);return{setMask:function(ze){Se!==ze&&!_e&&(n.colorMask(ze,ze,ze,ze),Se=ze)},setLocked:function(ze){_e=ze},setClear:function(ze,Je,et,yt,ut){ut===!0&&(ze*=yt,Je*=yt,et*=yt),Ze.set(ze,Je,et,yt),Me.equals(Ze)===!1&&(n.clearColor(ze,Je,et,yt),Me.copy(Ze))},reset:function(){_e=!1,Se=null,Me.set(-1,0,0,0)}}}function c(){let _e=!1,Ze=null,Se=null,Me=null;return{setTest:function(ze){ze?Rt(n.DEPTH_TEST):Jt(n.DEPTH_TEST)},setMask:function(ze){Ze!==ze&&!_e&&(n.depthMask(ze),Ze=ze)},setFunc:function(ze){if(Se!==ze){switch(ze){case VX:n.depthFunc(n.NEVER);break;case GX:n.depthFunc(n.ALWAYS);break;case HX:n.depthFunc(n.LESS);break;case Lx:n.depthFunc(n.LEQUAL);break;case jX:n.depthFunc(n.EQUAL);break;case $X:n.depthFunc(n.GEQUAL);break;case qX:n.depthFunc(n.GREATER);break;case XX:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Se=ze}},setLocked:function(ze){_e=ze},setClear:function(ze){Me!==ze&&(n.clearDepth(ze),Me=ze)},reset:function(){_e=!1,Ze=null,Se=null,Me=null}}}function d(){let _e=!1,Ze=null,Se=null,Me=null,ze=null,Je=null,et=null,yt=null,ut=null;return{setTest:function(ct){_e||(ct?Rt(n.STENCIL_TEST):Jt(n.STENCIL_TEST))},setMask:function(ct){Ze!==ct&&!_e&&(n.stencilMask(ct),Ze=ct)},setFunc:function(ct,Gt,Mt){(Se!==ct||Me!==Gt||ze!==Mt)&&(n.stencilFunc(ct,Gt,Mt),Se=ct,Me=Gt,ze=Mt)},setOp:function(ct,Gt,Mt){(Je!==ct||et!==Gt||yt!==Mt)&&(n.stencilOp(ct,Gt,Mt),Je=ct,et=Gt,yt=Mt)},setLocked:function(ct){_e=ct},setClear:function(ct){ut!==ct&&(n.clearStencil(ct),ut=ct)},reset:function(){_e=!1,Ze=null,Se=null,Me=null,ze=null,Je=null,et=null,yt=null,ut=null}}}const f=new s,m=new c,y=new d,_=new WeakMap,w=new WeakMap;let A={},C={},I=new WeakMap,k=[],D=null,L=!1,O=null,F=null,B=null,G=null,q=null,X=null,ee=null,V=new Pn(0,0,0),Q=0,me=!1,pe=null,be=null,fe=null,Ce=null,Re=null;const He=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let ue=!1,ye=0;const Ae=n.getParameter(n.VERSION);Ae.indexOf("WebGL")!==-1?(ye=parseFloat(/^WebGL (\d)/.exec(Ae)[1]),ue=ye>=1):Ae.indexOf("OpenGL ES")!==-1&&(ye=parseFloat(/^OpenGL ES (\d)/.exec(Ae)[1]),ue=ye>=2);let ne=null,Ee={};const Ye=n.getParameter(n.SCISSOR_BOX),Xe=n.getParameter(n.VIEWPORT),Ke=new Ai().fromArray(Ye),Ue=new Ai().fromArray(Xe);function ht(_e,Ze,Se,Me){const ze=new Uint8Array(4),Je=n.createTexture();n.bindTexture(_e,Je),n.texParameteri(_e,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(_e,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let et=0;et<Se;et++)o&&(_e===n.TEXTURE_3D||_e===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ze,0,n.RGBA,1,1,Me,0,n.RGBA,n.UNSIGNED_BYTE,ze):n.texImage2D(Ze+et,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ze);return Je}const Lt={};Lt[n.TEXTURE_2D]=ht(n.TEXTURE_2D,n.TEXTURE_2D,1),Lt[n.TEXTURE_CUBE_MAP]=ht(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),o&&(Lt[n.TEXTURE_2D_ARRAY]=ht(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Lt[n.TEXTURE_3D]=ht(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),f.setClear(0,0,0,1),m.setClear(1),y.setClear(0),Rt(n.DEPTH_TEST),m.setFunc(Lx),oe(!1),ve(IL),Rt(n.CULL_FACE),Be(Ph);function Rt(_e){A[_e]!==!0&&(n.enable(_e),A[_e]=!0)}function Jt(_e){A[_e]!==!1&&(n.disable(_e),A[_e]=!1)}function Pt(_e,Ze){return C[_e]!==Ze?(n.bindFramebuffer(_e,Ze),C[_e]=Ze,o&&(_e===n.DRAW_FRAMEBUFFER&&(C[n.FRAMEBUFFER]=Ze),_e===n.FRAMEBUFFER&&(C[n.DRAW_FRAMEBUFFER]=Ze)),!0):!1}function Pe(_e,Ze){let Se=k,Me=!1;if(_e)if(Se=I.get(Ze),Se===void 0&&(Se=[],I.set(Ze,Se)),_e.isWebGLMultipleRenderTargets){const ze=_e.texture;if(Se.length!==ze.length||Se[0]!==n.COLOR_ATTACHMENT0){for(let Je=0,et=ze.length;Je<et;Je++)Se[Je]=n.COLOR_ATTACHMENT0+Je;Se.length=ze.length,Me=!0}}else Se[0]!==n.COLOR_ATTACHMENT0&&(Se[0]=n.COLOR_ATTACHMENT0,Me=!0);else Se[0]!==n.BACK&&(Se[0]=n.BACK,Me=!0);Me&&(a.isWebGL2?n.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function ft(_e){return D!==_e?(n.useProgram(_e),D=_e,!0):!1}const gt={[Hf]:n.FUNC_ADD,[TX]:n.FUNC_SUBTRACT,[CX]:n.FUNC_REVERSE_SUBTRACT};if(o)gt[DL]=n.MIN,gt[OL]=n.MAX;else{const _e=e.get("EXT_blend_minmax");_e!==null&&(gt[DL]=_e.MIN_EXT,gt[OL]=_e.MAX_EXT)}const St={[PX]:n.ZERO,[IX]:n.ONE,[LX]:n.SRC_COLOR,[NE]:n.SRC_ALPHA,[FX]:n.SRC_ALPHA_SATURATE,[OX]:n.DST_COLOR,[kX]:n.DST_ALPHA,[RX]:n.ONE_MINUS_SRC_COLOR,[BE]:n.ONE_MINUS_SRC_ALPHA,[zX]:n.ONE_MINUS_DST_COLOR,[DX]:n.ONE_MINUS_DST_ALPHA,[NX]:n.CONSTANT_COLOR,[BX]:n.ONE_MINUS_CONSTANT_COLOR,[UX]:n.CONSTANT_ALPHA,[WX]:n.ONE_MINUS_CONSTANT_ALPHA};function Be(_e,Ze,Se,Me,ze,Je,et,yt,ut,ct){if(_e===Ph){L===!0&&(Jt(n.BLEND),L=!1);return}if(L===!1&&(Rt(n.BLEND),L=!0),_e!==MX){if(_e!==O||ct!==me){if((F!==Hf||q!==Hf)&&(n.blendEquation(n.FUNC_ADD),F=Hf,q=Hf),ct)switch(_e){case yg:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case LL:n.blendFunc(n.ONE,n.ONE);break;case RL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kL:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}else switch(_e){case yg:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case LL:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case RL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kL:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}B=null,G=null,X=null,ee=null,V.set(0,0,0),Q=0,O=_e,me=ct}return}ze=ze||Ze,Je=Je||Se,et=et||Me,(Ze!==F||ze!==q)&&(n.blendEquationSeparate(gt[Ze],gt[ze]),F=Ze,q=ze),(Se!==B||Me!==G||Je!==X||et!==ee)&&(n.blendFuncSeparate(St[Se],St[Me],St[Je],St[et]),B=Se,G=Me,X=Je,ee=et),(yt.equals(V)===!1||ut!==Q)&&(n.blendColor(yt.r,yt.g,yt.b,ut),V.copy(yt),Q=ut),O=_e,me=!1}function le(_e,Ze){_e.side===Ul?Jt(n.CULL_FACE):Rt(n.CULL_FACE);let Se=_e.side===vs;Ze&&(Se=!Se),oe(Se),_e.blending===yg&&_e.transparent===!1?Be(Ph):Be(_e.blending,_e.blendEquation,_e.blendSrc,_e.blendDst,_e.blendEquationAlpha,_e.blendSrcAlpha,_e.blendDstAlpha,_e.blendColor,_e.blendAlpha,_e.premultipliedAlpha),m.setFunc(_e.depthFunc),m.setTest(_e.depthTest),m.setMask(_e.depthWrite),f.setMask(_e.colorWrite);const Me=_e.stencilWrite;y.setTest(Me),Me&&(y.setMask(_e.stencilWriteMask),y.setFunc(_e.stencilFunc,_e.stencilRef,_e.stencilFuncMask),y.setOp(_e.stencilFail,_e.stencilZFail,_e.stencilZPass)),De(_e.polygonOffset,_e.polygonOffsetFactor,_e.polygonOffsetUnits),_e.alphaToCoverage===!0?Rt(n.SAMPLE_ALPHA_TO_COVERAGE):Jt(n.SAMPLE_ALPHA_TO_COVERAGE)}function oe(_e){pe!==_e&&(_e?n.frontFace(n.CW):n.frontFace(n.CCW),pe=_e)}function ve(_e){_e!==SX?(Rt(n.CULL_FACE),_e!==be&&(_e===IL?n.cullFace(n.BACK):_e===AX?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Jt(n.CULL_FACE),be=_e}function $e(_e){_e!==fe&&(ue&&n.lineWidth(_e),fe=_e)}function De(_e,Ze,Se){_e?(Rt(n.POLYGON_OFFSET_FILL),(Ce!==Ze||Re!==Se)&&(n.polygonOffset(Ze,Se),Ce=Ze,Re=Se)):Jt(n.POLYGON_OFFSET_FILL)}function ot(_e){_e?Rt(n.SCISSOR_TEST):Jt(n.SCISSOR_TEST)}function ce(_e){_e===void 0&&(_e=n.TEXTURE0+He-1),ne!==_e&&(n.activeTexture(_e),ne=_e)}function te(_e,Ze,Se){Se===void 0&&(ne===null?Se=n.TEXTURE0+He-1:Se=ne);let Me=Ee[Se];Me===void 0&&(Me={type:void 0,texture:void 0},Ee[Se]=Me),(Me.type!==_e||Me.texture!==Ze)&&(ne!==Se&&(n.activeTexture(Se),ne=Se),n.bindTexture(_e,Ze||Lt[_e]),Me.type=_e,Me.texture=Ze)}function Oe(){const _e=Ee[ne];_e!==void 0&&_e.type!==void 0&&(n.bindTexture(_e.type,null),_e.type=void 0,_e.texture=void 0)}function pt(){try{n.compressedTexImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function it(){try{n.compressedTexImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function st(){try{n.texSubImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function At(){try{n.texSubImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Ut(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Vt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function $t(){try{n.texStorage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Ft(){try{n.texStorage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function wt(){try{n.texImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Yt(){try{n.texImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Ge(_e){Ke.equals(_e)===!1&&(n.scissor(_e.x,_e.y,_e.z,_e.w),Ke.copy(_e))}function It(_e){Ue.equals(_e)===!1&&(n.viewport(_e.x,_e.y,_e.z,_e.w),Ue.copy(_e))}function qt(_e,Ze){let Se=w.get(Ze);Se===void 0&&(Se=new WeakMap,w.set(Ze,Se));let Me=Se.get(_e);Me===void 0&&(Me=n.getUniformBlockIndex(Ze,_e.name),Se.set(_e,Me))}function Dt(_e,Ze){const Me=w.get(Ze).get(_e);_.get(Ze)!==Me&&(n.uniformBlockBinding(Ze,Me,_e.__bindingPointIndex),_.set(Ze,Me))}function fn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),o===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),A={},ne=null,Ee={},C={},I=new WeakMap,k=[],D=null,L=!1,O=null,F=null,B=null,G=null,q=null,X=null,ee=null,V=new Pn(0,0,0),Q=0,me=!1,pe=null,be=null,fe=null,Ce=null,Re=null,Ke.set(0,0,n.canvas.width,n.canvas.height),Ue.set(0,0,n.canvas.width,n.canvas.height),f.reset(),m.reset(),y.reset()}return{buffers:{color:f,depth:m,stencil:y},enable:Rt,disable:Jt,bindFramebuffer:Pt,drawBuffers:Pe,useProgram:ft,setBlending:Be,setMaterial:le,setFlipSided:oe,setCullFace:ve,setLineWidth:$e,setPolygonOffset:De,setScissorTest:ot,activeTexture:ce,bindTexture:te,unbindTexture:Oe,compressedTexImage2D:pt,compressedTexImage3D:it,texImage2D:wt,texImage3D:Yt,updateUBOMapping:qt,uniformBlockBinding:Dt,texStorage2D:$t,texStorage3D:Ft,texSubImage2D:st,texSubImage3D:At,compressedTexSubImage2D:Ut,compressedTexSubImage3D:Vt,scissor:Ge,viewport:It,reset:fn}}function mwe(n,e,a,o,s,c,d){const f=s.isWebGL2,m=s.maxTextures,y=s.maxCubemapSize,_=s.maxTextureSize,w=s.maxSamples,A=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,C=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),I=new WeakMap;let k;const D=new WeakMap;let L=!1;try{L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function O(ce,te){return L?new OffscreenCanvas(ce,te):Hx("canvas")}function F(ce,te,Oe,pt){let it=1;if((ce.width>pt||ce.height>pt)&&(it=pt/Math.max(ce.width,ce.height)),it<1||te===!0)if(typeof HTMLImageElement<"u"&&ce instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ce instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ce instanceof ImageBitmap){const st=te?VE:Math.floor,At=st(it*ce.width),Ut=st(it*ce.height);k===void 0&&(k=O(At,Ut));const Vt=Oe?O(At,Ut):k;return Vt.width=At,Vt.height=Ut,Vt.getContext("2d").drawImage(ce,0,0,At,Ut),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+At+"x"+Ut+")."),Vt}else return"data"in ce&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),ce;return ce}function B(ce){return uR(ce.width)&&uR(ce.height)}function G(ce){return f?!1:ce.wrapS!==ms||ce.wrapT!==ms||ce.minFilter!==ro&&ce.minFilter!==Cr}function q(ce,te){return ce.generateMipmaps&&te&&ce.minFilter!==ro&&ce.minFilter!==Cr}function X(ce){n.generateMipmap(ce)}function ee(ce,te,Oe,pt,it=!1){if(f===!1)return te;if(ce!==null){if(n[ce]!==void 0)return n[ce];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ce+"'")}let st=te;if(te===n.RED&&(Oe===n.FLOAT&&(st=n.R32F),Oe===n.HALF_FLOAT&&(st=n.R16F),Oe===n.UNSIGNED_BYTE&&(st=n.R8)),te===n.RED_INTEGER&&(Oe===n.UNSIGNED_BYTE&&(st=n.R8UI),Oe===n.UNSIGNED_SHORT&&(st=n.R16UI),Oe===n.UNSIGNED_INT&&(st=n.R32UI),Oe===n.BYTE&&(st=n.R8I),Oe===n.SHORT&&(st=n.R16I),Oe===n.INT&&(st=n.R32I)),te===n.RG&&(Oe===n.FLOAT&&(st=n.RG32F),Oe===n.HALF_FLOAT&&(st=n.RG16F),Oe===n.UNSIGNED_BYTE&&(st=n.RG8)),te===n.RGBA){const At=it?Bx:Oi.getTransfer(pt);Oe===n.FLOAT&&(st=n.RGBA32F),Oe===n.HALF_FLOAT&&(st=n.RGBA16F),Oe===n.UNSIGNED_BYTE&&(st=At===Ji?n.SRGB8_ALPHA8:n.RGBA8),Oe===n.UNSIGNED_SHORT_4_4_4_4&&(st=n.RGBA4),Oe===n.UNSIGNED_SHORT_5_5_5_1&&(st=n.RGB5_A1)}return(st===n.R16F||st===n.R32F||st===n.RG16F||st===n.RG32F||st===n.RGBA16F||st===n.RGBA32F)&&e.get("EXT_color_buffer_float"),st}function V(ce,te,Oe){return q(ce,Oe)===!0||ce.isFramebufferTexture&&ce.minFilter!==ro&&ce.minFilter!==Cr?Math.log2(Math.max(te.width,te.height))+1:ce.mipmaps!==void 0&&ce.mipmaps.length>0?ce.mipmaps.length:ce.isCompressedTexture&&Array.isArray(ce.image)?te.mipmaps.length:1}function Q(ce){return ce===ro||ce===UE||ce===qb?n.NEAREST:n.LINEAR}function me(ce){const te=ce.target;te.removeEventListener("dispose",me),be(te),te.isVideoTexture&&I.delete(te)}function pe(ce){const te=ce.target;te.removeEventListener("dispose",pe),Ce(te)}function be(ce){const te=o.get(ce);if(te.__webglInit===void 0)return;const Oe=ce.source,pt=D.get(Oe);if(pt){const it=pt[te.__cacheKey];it.usedTimes--,it.usedTimes===0&&fe(ce),Object.keys(pt).length===0&&D.delete(Oe)}o.remove(ce)}function fe(ce){const te=o.get(ce);n.deleteTexture(te.__webglTexture);const Oe=ce.source,pt=D.get(Oe);delete pt[te.__cacheKey],d.memory.textures--}function Ce(ce){const te=ce.texture,Oe=o.get(ce),pt=o.get(te);if(pt.__webglTexture!==void 0&&(n.deleteTexture(pt.__webglTexture),d.memory.textures--),ce.depthTexture&&ce.depthTexture.dispose(),ce.isWebGLCubeRenderTarget)for(let it=0;it<6;it++){if(Array.isArray(Oe.__webglFramebuffer[it]))for(let st=0;st<Oe.__webglFramebuffer[it].length;st++)n.deleteFramebuffer(Oe.__webglFramebuffer[it][st]);else n.deleteFramebuffer(Oe.__webglFramebuffer[it]);Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer[it])}else{if(Array.isArray(Oe.__webglFramebuffer))for(let it=0;it<Oe.__webglFramebuffer.length;it++)n.deleteFramebuffer(Oe.__webglFramebuffer[it]);else n.deleteFramebuffer(Oe.__webglFramebuffer);if(Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer),Oe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Oe.__webglMultisampledFramebuffer),Oe.__webglColorRenderbuffer)for(let it=0;it<Oe.__webglColorRenderbuffer.length;it++)Oe.__webglColorRenderbuffer[it]&&n.deleteRenderbuffer(Oe.__webglColorRenderbuffer[it]);Oe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Oe.__webglDepthRenderbuffer)}if(ce.isWebGLMultipleRenderTargets)for(let it=0,st=te.length;it<st;it++){const At=o.get(te[it]);At.__webglTexture&&(n.deleteTexture(At.__webglTexture),d.memory.textures--),o.remove(te[it])}o.remove(te),o.remove(ce)}let Re=0;function He(){Re=0}function ue(){const ce=Re;return ce>=m&&console.warn("THREE.WebGLTextures: Trying to use "+ce+" texture units while this GPU supports only "+m),Re+=1,ce}function ye(ce){const te=[];return te.push(ce.wrapS),te.push(ce.wrapT),te.push(ce.wrapR||0),te.push(ce.magFilter),te.push(ce.minFilter),te.push(ce.anisotropy),te.push(ce.internalFormat),te.push(ce.format),te.push(ce.type),te.push(ce.generateMipmaps),te.push(ce.premultiplyAlpha),te.push(ce.flipY),te.push(ce.unpackAlignment),te.push(ce.colorSpace),te.join()}function Ae(ce,te){const Oe=o.get(ce);if(ce.isVideoTexture&&De(ce),ce.isRenderTargetTexture===!1&&ce.version>0&&Oe.__version!==ce.version){const pt=ce.image;if(pt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(pt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Rt(Oe,ce,te);return}}a.bindTexture(n.TEXTURE_2D,Oe.__webglTexture,n.TEXTURE0+te)}function ne(ce,te){const Oe=o.get(ce);if(ce.version>0&&Oe.__version!==ce.version){Rt(Oe,ce,te);return}a.bindTexture(n.TEXTURE_2D_ARRAY,Oe.__webglTexture,n.TEXTURE0+te)}function Ee(ce,te){const Oe=o.get(ce);if(ce.version>0&&Oe.__version!==ce.version){Rt(Oe,ce,te);return}a.bindTexture(n.TEXTURE_3D,Oe.__webglTexture,n.TEXTURE0+te)}function Ye(ce,te){const Oe=o.get(ce);if(ce.version>0&&Oe.__version!==ce.version){Jt(Oe,ce,te);return}a.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture,n.TEXTURE0+te)}const Xe={[Dx]:n.REPEAT,[ms]:n.CLAMP_TO_EDGE,[Ox]:n.MIRRORED_REPEAT},Ke={[ro]:n.NEAREST,[UE]:n.NEAREST_MIPMAP_NEAREST,[qb]:n.NEAREST_MIPMAP_LINEAR,[Cr]:n.LINEAR,[PD]:n.LINEAR_MIPMAP_NEAREST,[vp]:n.LINEAR_MIPMAP_LINEAR},Ue={[gZ]:n.NEVER,[SZ]:n.ALWAYS,[yZ]:n.LESS,[_Z]:n.LEQUAL,[vZ]:n.EQUAL,[wZ]:n.GEQUAL,[bZ]:n.GREATER,[xZ]:n.NOTEQUAL};function ht(ce,te,Oe){if(Oe?(n.texParameteri(ce,n.TEXTURE_WRAP_S,Xe[te.wrapS]),n.texParameteri(ce,n.TEXTURE_WRAP_T,Xe[te.wrapT]),(ce===n.TEXTURE_3D||ce===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ce,n.TEXTURE_WRAP_R,Xe[te.wrapR]),n.texParameteri(ce,n.TEXTURE_MAG_FILTER,Ke[te.magFilter]),n.texParameteri(ce,n.TEXTURE_MIN_FILTER,Ke[te.minFilter])):(n.texParameteri(ce,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(ce,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(ce===n.TEXTURE_3D||ce===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ce,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(te.wrapS!==ms||te.wrapT!==ms)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(ce,n.TEXTURE_MAG_FILTER,Q(te.magFilter)),n.texParameteri(ce,n.TEXTURE_MIN_FILTER,Q(te.minFilter)),te.minFilter!==ro&&te.minFilter!==Cr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),te.compareFunction&&(n.texParameteri(ce,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ce,n.TEXTURE_COMPARE_FUNC,Ue[te.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const pt=e.get("EXT_texture_filter_anisotropic");if(te.magFilter===ro||te.minFilter!==qb&&te.minFilter!==vp||te.type===od&&e.has("OES_texture_float_linear")===!1||f===!1&&te.type===Y0&&e.has("OES_texture_half_float_linear")===!1)return;(te.anisotropy>1||o.get(te).__currentAnisotropy)&&(n.texParameterf(ce,pt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,s.getMaxAnisotropy())),o.get(te).__currentAnisotropy=te.anisotropy)}}function Lt(ce,te){let Oe=!1;ce.__webglInit===void 0&&(ce.__webglInit=!0,te.addEventListener("dispose",me));const pt=te.source;let it=D.get(pt);it===void 0&&(it={},D.set(pt,it));const st=ye(te);if(st!==ce.__cacheKey){it[st]===void 0&&(it[st]={texture:n.createTexture(),usedTimes:0},d.memory.textures++,Oe=!0),it[st].usedTimes++;const At=it[ce.__cacheKey];At!==void 0&&(it[ce.__cacheKey].usedTimes--,At.usedTimes===0&&fe(te)),ce.__cacheKey=st,ce.__webglTexture=it[st].texture}return Oe}function Rt(ce,te,Oe){let pt=n.TEXTURE_2D;(te.isDataArrayTexture||te.isCompressedArrayTexture)&&(pt=n.TEXTURE_2D_ARRAY),te.isData3DTexture&&(pt=n.TEXTURE_3D);const it=Lt(ce,te),st=te.source;a.bindTexture(pt,ce.__webglTexture,n.TEXTURE0+Oe);const At=o.get(st);if(st.version!==At.__version||it===!0){a.activeTexture(n.TEXTURE0+Oe);const Ut=Oi.getPrimaries(Oi.workingColorSpace),Vt=te.colorSpace===Wl?null:Oi.getPrimaries(te.colorSpace),$t=te.colorSpace===Wl||Ut===Vt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,te.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,te.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);const Ft=G(te)&&B(te.image)===!1;let wt=F(te.image,Ft,!1,_);wt=ot(te,wt);const Yt=B(wt)||f,Ge=c.convert(te.format,te.colorSpace);let It=c.convert(te.type),qt=ee(te.internalFormat,Ge,It,te.colorSpace,te.isVideoTexture);ht(pt,te,Yt);let Dt;const fn=te.mipmaps,_e=f&&te.isVideoTexture!==!0,Ze=At.__version===void 0||it===!0,Se=V(te,wt,Yt);if(te.isDepthTexture)qt=n.DEPTH_COMPONENT,f?te.type===od?qt=n.DEPTH_COMPONENT32F:te.type===Sh?qt=n.DEPTH_COMPONENT24:te.type===lp?qt=n.DEPTH24_STENCIL8:qt=n.DEPTH_COMPONENT16:te.type===od&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),te.format===cp&&qt===n.DEPTH_COMPONENT&&te.type!==_T&&te.type!==Sh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),te.type=Sh,It=c.convert(te.type)),te.format===Lg&&qt===n.DEPTH_COMPONENT&&(qt=n.DEPTH_STENCIL,te.type!==lp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),te.type=lp,It=c.convert(te.type))),Ze&&(_e?a.texStorage2D(n.TEXTURE_2D,1,qt,wt.width,wt.height):a.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,Ge,It,null));else if(te.isDataTexture)if(fn.length>0&&Yt){_e&&Ze&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Dt=fn[Me],_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,Dt.width,Dt.height,Ge,It,Dt.data):a.texImage2D(n.TEXTURE_2D,Me,qt,Dt.width,Dt.height,0,Ge,It,Dt.data);te.generateMipmaps=!1}else _e?(Ze&&a.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height),a.texSubImage2D(n.TEXTURE_2D,0,0,0,wt.width,wt.height,Ge,It,wt.data)):a.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,Ge,It,wt.data);else if(te.isCompressedTexture)if(te.isCompressedArrayTexture){_e&&Ze&&a.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,fn[0].width,fn[0].height,wt.depth);for(let Me=0,ze=fn.length;Me<ze;Me++)Dt=fn[Me],te.format!==hl?Ge!==null?_e?a.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,Dt.width,Dt.height,wt.depth,Ge,Dt.data,0,0):a.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Me,qt,Dt.width,Dt.height,wt.depth,0,Dt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_e?a.texSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,Dt.width,Dt.height,wt.depth,Ge,It,Dt.data):a.texImage3D(n.TEXTURE_2D_ARRAY,Me,qt,Dt.width,Dt.height,wt.depth,0,Ge,It,Dt.data)}else{_e&&Ze&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Dt=fn[Me],te.format!==hl?Ge!==null?_e?a.compressedTexSubImage2D(n.TEXTURE_2D,Me,0,0,Dt.width,Dt.height,Ge,Dt.data):a.compressedTexImage2D(n.TEXTURE_2D,Me,qt,Dt.width,Dt.height,0,Dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,Dt.width,Dt.height,Ge,It,Dt.data):a.texImage2D(n.TEXTURE_2D,Me,qt,Dt.width,Dt.height,0,Ge,It,Dt.data)}else if(te.isDataArrayTexture)_e?(Ze&&a.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,wt.width,wt.height,wt.depth),a.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,wt.width,wt.height,wt.depth,Ge,It,wt.data)):a.texImage3D(n.TEXTURE_2D_ARRAY,0,qt,wt.width,wt.height,wt.depth,0,Ge,It,wt.data);else if(te.isData3DTexture)_e?(Ze&&a.texStorage3D(n.TEXTURE_3D,Se,qt,wt.width,wt.height,wt.depth),a.texSubImage3D(n.TEXTURE_3D,0,0,0,0,wt.width,wt.height,wt.depth,Ge,It,wt.data)):a.texImage3D(n.TEXTURE_3D,0,qt,wt.width,wt.height,wt.depth,0,Ge,It,wt.data);else if(te.isFramebufferTexture){if(Ze)if(_e)a.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height);else{let Me=wt.width,ze=wt.height;for(let Je=0;Je<Se;Je++)a.texImage2D(n.TEXTURE_2D,Je,qt,Me,ze,0,Ge,It,null),Me>>=1,ze>>=1}}else if(fn.length>0&&Yt){_e&&Ze&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Dt=fn[Me],_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,Ge,It,Dt):a.texImage2D(n.TEXTURE_2D,Me,qt,Ge,It,Dt);te.generateMipmaps=!1}else _e?(Ze&&a.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height),a.texSubImage2D(n.TEXTURE_2D,0,0,0,Ge,It,wt)):a.texImage2D(n.TEXTURE_2D,0,qt,Ge,It,wt);q(te,Yt)&&X(pt),At.__version=st.version,te.onUpdate&&te.onUpdate(te)}ce.__version=te.version}function Jt(ce,te,Oe){if(te.image.length!==6)return;const pt=Lt(ce,te),it=te.source;a.bindTexture(n.TEXTURE_CUBE_MAP,ce.__webglTexture,n.TEXTURE0+Oe);const st=o.get(it);if(it.version!==st.__version||pt===!0){a.activeTexture(n.TEXTURE0+Oe);const At=Oi.getPrimaries(Oi.workingColorSpace),Ut=te.colorSpace===Wl?null:Oi.getPrimaries(te.colorSpace),Vt=te.colorSpace===Wl||At===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,te.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,te.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Vt);const $t=te.isCompressedTexture||te.image[0].isCompressedTexture,Ft=te.image[0]&&te.image[0].isDataTexture,wt=[];for(let Me=0;Me<6;Me++)!$t&&!Ft?wt[Me]=F(te.image[Me],!1,!0,y):wt[Me]=Ft?te.image[Me].image:te.image[Me],wt[Me]=ot(te,wt[Me]);const Yt=wt[0],Ge=B(Yt)||f,It=c.convert(te.format,te.colorSpace),qt=c.convert(te.type),Dt=ee(te.internalFormat,It,qt,te.colorSpace),fn=f&&te.isVideoTexture!==!0,_e=st.__version===void 0||pt===!0;let Ze=V(te,Yt,Ge);ht(n.TEXTURE_CUBE_MAP,te,Ge);let Se;if($t){fn&&_e&&a.texStorage2D(n.TEXTURE_CUBE_MAP,Ze,Dt,Yt.width,Yt.height);for(let Me=0;Me<6;Me++){Se=wt[Me].mipmaps;for(let ze=0;ze<Se.length;ze++){const Je=Se[ze];te.format!==hl?It!==null?fn?a.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,0,0,Je.width,Je.height,It,Je.data):a.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,Dt,Je.width,Je.height,0,Je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,0,0,Je.width,Je.height,It,qt,Je.data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,Dt,Je.width,Je.height,0,It,qt,Je.data)}}}else{Se=te.mipmaps,fn&&_e&&(Se.length>0&&Ze++,a.texStorage2D(n.TEXTURE_CUBE_MAP,Ze,Dt,wt[0].width,wt[0].height));for(let Me=0;Me<6;Me++)if(Ft){fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,wt[Me].width,wt[Me].height,It,qt,wt[Me].data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Dt,wt[Me].width,wt[Me].height,0,It,qt,wt[Me].data);for(let ze=0;ze<Se.length;ze++){const et=Se[ze].image[Me].image;fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,0,0,et.width,et.height,It,qt,et.data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,Dt,et.width,et.height,0,It,qt,et.data)}}else{fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,It,qt,wt[Me]):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Dt,It,qt,wt[Me]);for(let ze=0;ze<Se.length;ze++){const Je=Se[ze];fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,0,0,It,qt,Je.image[Me]):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,Dt,It,qt,Je.image[Me])}}}q(te,Ge)&&X(n.TEXTURE_CUBE_MAP),st.__version=it.version,te.onUpdate&&te.onUpdate(te)}ce.__version=te.version}function Pt(ce,te,Oe,pt,it,st){const At=c.convert(Oe.format,Oe.colorSpace),Ut=c.convert(Oe.type),Vt=ee(Oe.internalFormat,At,Ut,Oe.colorSpace);if(!o.get(te).__hasExternalTextures){const Ft=Math.max(1,te.width>>st),wt=Math.max(1,te.height>>st);it===n.TEXTURE_3D||it===n.TEXTURE_2D_ARRAY?a.texImage3D(it,st,Vt,Ft,wt,te.depth,0,At,Ut,null):a.texImage2D(it,st,Vt,Ft,wt,0,At,Ut,null)}a.bindFramebuffer(n.FRAMEBUFFER,ce),$e(te)?A.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,pt,it,o.get(Oe).__webglTexture,0,ve(te)):(it===n.TEXTURE_2D||it>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&it<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,pt,it,o.get(Oe).__webglTexture,st),a.bindFramebuffer(n.FRAMEBUFFER,null)}function Pe(ce,te,Oe){if(n.bindRenderbuffer(n.RENDERBUFFER,ce),te.depthBuffer&&!te.stencilBuffer){let pt=f===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Oe||$e(te)){const it=te.depthTexture;it&&it.isDepthTexture&&(it.type===od?pt=n.DEPTH_COMPONENT32F:it.type===Sh&&(pt=n.DEPTH_COMPONENT24));const st=ve(te);$e(te)?A.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,st,pt,te.width,te.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,st,pt,te.width,te.height)}else n.renderbufferStorage(n.RENDERBUFFER,pt,te.width,te.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,ce)}else if(te.depthBuffer&&te.stencilBuffer){const pt=ve(te);Oe&&$e(te)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,pt,n.DEPTH24_STENCIL8,te.width,te.height):$e(te)?A.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,pt,n.DEPTH24_STENCIL8,te.width,te.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,te.width,te.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,ce)}else{const pt=te.isWebGLMultipleRenderTargets===!0?te.texture:[te.texture];for(let it=0;it<pt.length;it++){const st=pt[it],At=c.convert(st.format,st.colorSpace),Ut=c.convert(st.type),Vt=ee(st.internalFormat,At,Ut,st.colorSpace),$t=ve(te);Oe&&$e(te)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,$t,Vt,te.width,te.height):$e(te)?A.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,$t,Vt,te.width,te.height):n.renderbufferStorage(n.RENDERBUFFER,Vt,te.width,te.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ft(ce,te){if(te&&te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(n.FRAMEBUFFER,ce),!(te.depthTexture&&te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(te.depthTexture).__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),Ae(te.depthTexture,0);const pt=o.get(te.depthTexture).__webglTexture,it=ve(te);if(te.depthTexture.format===cp)$e(te)?A.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,pt,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,pt,0);else if(te.depthTexture.format===Lg)$e(te)?A.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,pt,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,pt,0);else throw new Error("Unknown depthTexture format")}function gt(ce){const te=o.get(ce),Oe=ce.isWebGLCubeRenderTarget===!0;if(ce.depthTexture&&!te.__autoAllocateDepthBuffer){if(Oe)throw new Error("target.depthTexture not supported in Cube render targets");ft(te.__webglFramebuffer,ce)}else if(Oe){te.__webglDepthbuffer=[];for(let pt=0;pt<6;pt++)a.bindFramebuffer(n.FRAMEBUFFER,te.__webglFramebuffer[pt]),te.__webglDepthbuffer[pt]=n.createRenderbuffer(),Pe(te.__webglDepthbuffer[pt],ce,!1)}else a.bindFramebuffer(n.FRAMEBUFFER,te.__webglFramebuffer),te.__webglDepthbuffer=n.createRenderbuffer(),Pe(te.__webglDepthbuffer,ce,!1);a.bindFramebuffer(n.FRAMEBUFFER,null)}function St(ce,te,Oe){const pt=o.get(ce);te!==void 0&&Pt(pt.__webglFramebuffer,ce,ce.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Oe!==void 0&&gt(ce)}function Be(ce){const te=ce.texture,Oe=o.get(ce),pt=o.get(te);ce.addEventListener("dispose",pe),ce.isWebGLMultipleRenderTargets!==!0&&(pt.__webglTexture===void 0&&(pt.__webglTexture=n.createTexture()),pt.__version=te.version,d.memory.textures++);const it=ce.isWebGLCubeRenderTarget===!0,st=ce.isWebGLMultipleRenderTargets===!0,At=B(ce)||f;if(it){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<6;Ut++)if(f&&te.mipmaps&&te.mipmaps.length>0){Oe.__webglFramebuffer[Ut]=[];for(let Vt=0;Vt<te.mipmaps.length;Vt++)Oe.__webglFramebuffer[Ut][Vt]=n.createFramebuffer()}else Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else{if(f&&te.mipmaps&&te.mipmaps.length>0){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<te.mipmaps.length;Ut++)Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else Oe.__webglFramebuffer=n.createFramebuffer();if(st)if(s.drawBuffers){const Ut=ce.texture;for(let Vt=0,$t=Ut.length;Vt<$t;Vt++){const Ft=o.get(Ut[Vt]);Ft.__webglTexture===void 0&&(Ft.__webglTexture=n.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(f&&ce.samples>0&&$e(ce)===!1){const Ut=st?te:[te];Oe.__webglMultisampledFramebuffer=n.createFramebuffer(),Oe.__webglColorRenderbuffer=[],a.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer);for(let Vt=0;Vt<Ut.length;Vt++){const $t=Ut[Vt];Oe.__webglColorRenderbuffer[Vt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Vt]);const Ft=c.convert($t.format,$t.colorSpace),wt=c.convert($t.type),Yt=ee($t.internalFormat,Ft,wt,$t.colorSpace,ce.isXRRenderTarget===!0),Ge=ve(ce);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ge,Yt,ce.width,ce.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vt,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Vt])}n.bindRenderbuffer(n.RENDERBUFFER,null),ce.depthBuffer&&(Oe.__webglDepthRenderbuffer=n.createRenderbuffer(),Pe(Oe.__webglDepthRenderbuffer,ce,!0)),a.bindFramebuffer(n.FRAMEBUFFER,null)}}if(it){a.bindTexture(n.TEXTURE_CUBE_MAP,pt.__webglTexture),ht(n.TEXTURE_CUBE_MAP,te,At);for(let Ut=0;Ut<6;Ut++)if(f&&te.mipmaps&&te.mipmaps.length>0)for(let Vt=0;Vt<te.mipmaps.length;Vt++)Pt(Oe.__webglFramebuffer[Ut][Vt],ce,te,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,Vt);else Pt(Oe.__webglFramebuffer[Ut],ce,te,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0);q(te,At)&&X(n.TEXTURE_CUBE_MAP),a.unbindTexture()}else if(st){const Ut=ce.texture;for(let Vt=0,$t=Ut.length;Vt<$t;Vt++){const Ft=Ut[Vt],wt=o.get(Ft);a.bindTexture(n.TEXTURE_2D,wt.__webglTexture),ht(n.TEXTURE_2D,Ft,At),Pt(Oe.__webglFramebuffer,ce,Ft,n.COLOR_ATTACHMENT0+Vt,n.TEXTURE_2D,0),q(Ft,At)&&X(n.TEXTURE_2D)}a.unbindTexture()}else{let Ut=n.TEXTURE_2D;if((ce.isWebGL3DRenderTarget||ce.isWebGLArrayRenderTarget)&&(f?Ut=ce.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),a.bindTexture(Ut,pt.__webglTexture),ht(Ut,te,At),f&&te.mipmaps&&te.mipmaps.length>0)for(let Vt=0;Vt<te.mipmaps.length;Vt++)Pt(Oe.__webglFramebuffer[Vt],ce,te,n.COLOR_ATTACHMENT0,Ut,Vt);else Pt(Oe.__webglFramebuffer,ce,te,n.COLOR_ATTACHMENT0,Ut,0);q(te,At)&&X(Ut),a.unbindTexture()}ce.depthBuffer&&gt(ce)}function le(ce){const te=B(ce)||f,Oe=ce.isWebGLMultipleRenderTargets===!0?ce.texture:[ce.texture];for(let pt=0,it=Oe.length;pt<it;pt++){const st=Oe[pt];if(q(st,te)){const At=ce.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ut=o.get(st).__webglTexture;a.bindTexture(At,Ut),X(At),a.unbindTexture()}}}function oe(ce){if(f&&ce.samples>0&&$e(ce)===!1){const te=ce.isWebGLMultipleRenderTargets?ce.texture:[ce.texture],Oe=ce.width,pt=ce.height;let it=n.COLOR_BUFFER_BIT;const st=[],At=ce.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ut=o.get(ce),Vt=ce.isWebGLMultipleRenderTargets===!0;if(Vt)for(let $t=0;$t<te.length;$t++)a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.RENDERBUFFER,null),a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.TEXTURE_2D,null,0);a.bindFramebuffer(n.READ_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),a.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer);for(let $t=0;$t<te.length;$t++){st.push(n.COLOR_ATTACHMENT0+$t),ce.depthBuffer&&st.push(At);const Ft=Ut.__ignoreDepthValues!==void 0?Ut.__ignoreDepthValues:!1;if(Ft===!1&&(ce.depthBuffer&&(it|=n.DEPTH_BUFFER_BIT),ce.stencilBuffer&&(it|=n.STENCIL_BUFFER_BIT)),Vt&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]),Ft===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[At]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[At])),Vt){const wt=o.get(te[$t]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,wt,0)}n.blitFramebuffer(0,0,Oe,pt,0,0,Oe,pt,it,n.NEAREST),C&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,st)}if(a.bindFramebuffer(n.READ_FRAMEBUFFER,null),a.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Vt)for(let $t=0;$t<te.length;$t++){a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]);const Ft=o.get(te[$t]).__webglTexture;a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.TEXTURE_2D,Ft,0)}a.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer)}}function ve(ce){return Math.min(w,ce.samples)}function $e(ce){const te=o.get(ce);return f&&ce.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&te.__useRenderToTexture!==!1}function De(ce){const te=d.render.frame;I.get(ce)!==te&&(I.set(ce,te),ce.update())}function ot(ce,te){const Oe=ce.colorSpace,pt=ce.format,it=ce.type;return ce.isCompressedTexture===!0||ce.isVideoTexture===!0||ce.format===WE||Oe!==gd&&Oe!==Wl&&(Oi.getTransfer(Oe)===Ji?f===!1?e.has("EXT_sRGB")===!0&&pt===hl?(ce.format=WE,ce.minFilter=Cr,ce.generateMipmaps=!1):te=UD.sRGBToLinear(te):(pt!==hl||it!==hd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Oe)),te}this.allocateTextureUnit=ue,this.resetTextureUnits=He,this.setTexture2D=Ae,this.setTexture2DArray=ne,this.setTexture3D=Ee,this.setTextureCube=Ye,this.rebindTextures=St,this.setupRenderTarget=Be,this.updateRenderTargetMipmap=le,this.updateMultisampleRenderTarget=oe,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=Pt,this.useMultisampledRTT=$e}function FZ(n,e,a){const o=a.isWebGL2;function s(c,d=Wl){let f;const m=Oi.getTransfer(d);if(c===hd)return n.UNSIGNED_BYTE;if(c===LD)return n.UNSIGNED_SHORT_4_4_4_4;if(c===RD)return n.UNSIGNED_SHORT_5_5_5_1;if(c===nZ)return n.BYTE;if(c===aZ)return n.SHORT;if(c===_T)return n.UNSIGNED_SHORT;if(c===ID)return n.INT;if(c===Sh)return n.UNSIGNED_INT;if(c===od)return n.FLOAT;if(c===Y0)return o?n.HALF_FLOAT:(f=e.get("OES_texture_half_float"),f!==null?f.HALF_FLOAT_OES:null);if(c===iZ)return n.ALPHA;if(c===hl)return n.RGBA;if(c===rZ)return n.LUMINANCE;if(c===oZ)return n.LUMINANCE_ALPHA;if(c===cp)return n.DEPTH_COMPONENT;if(c===Lg)return n.DEPTH_STENCIL;if(c===WE)return f=e.get("EXT_sRGB"),f!==null?f.SRGB_ALPHA_EXT:null;if(c===sZ)return n.RED;if(c===kD)return n.RED_INTEGER;if(c===lZ)return n.RG;if(c===DD)return n.RG_INTEGER;if(c===OD)return n.RGBA_INTEGER;if(c===zA||c===FA||c===NA||c===BA)if(m===Ji)if(f=e.get("WEBGL_compressed_texture_s3tc_srgb"),f!==null){if(c===zA)return f.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(c===FA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(c===NA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(c===BA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(f=e.get("WEBGL_compressed_texture_s3tc"),f!==null){if(c===zA)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===FA)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===NA)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===BA)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(c===FL||c===NL||c===BL||c===UL)if(f=e.get("WEBGL_compressed_texture_pvrtc"),f!==null){if(c===FL)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===NL)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===BL)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===UL)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(c===cZ)return f=e.get("WEBGL_compressed_texture_etc1"),f!==null?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(c===WL||c===VL)if(f=e.get("WEBGL_compressed_texture_etc"),f!==null){if(c===WL)return m===Ji?f.COMPRESSED_SRGB8_ETC2:f.COMPRESSED_RGB8_ETC2;if(c===VL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:f.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(c===GL||c===HL||c===jL||c===$L||c===qL||c===XL||c===ZL||c===YL||c===KL||c===JL||c===QL||c===eR||c===tR||c===nR)if(f=e.get("WEBGL_compressed_texture_astc"),f!==null){if(c===GL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:f.COMPRESSED_RGBA_ASTC_4x4_KHR;if(c===HL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:f.COMPRESSED_RGBA_ASTC_5x4_KHR;if(c===jL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:f.COMPRESSED_RGBA_ASTC_5x5_KHR;if(c===$L)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:f.COMPRESSED_RGBA_ASTC_6x5_KHR;if(c===qL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:f.COMPRESSED_RGBA_ASTC_6x6_KHR;if(c===XL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:f.COMPRESSED_RGBA_ASTC_8x5_KHR;if(c===ZL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:f.COMPRESSED_RGBA_ASTC_8x6_KHR;if(c===YL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:f.COMPRESSED_RGBA_ASTC_8x8_KHR;if(c===KL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:f.COMPRESSED_RGBA_ASTC_10x5_KHR;if(c===JL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:f.COMPRESSED_RGBA_ASTC_10x6_KHR;if(c===QL)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:f.COMPRESSED_RGBA_ASTC_10x8_KHR;if(c===eR)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:f.COMPRESSED_RGBA_ASTC_10x10_KHR;if(c===tR)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:f.COMPRESSED_RGBA_ASTC_12x10_KHR;if(c===nR)return m===Ji?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:f.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(c===UA||c===aR||c===iR)if(f=e.get("EXT_texture_compression_bptc"),f!==null){if(c===UA)return m===Ji?f.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:f.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(c===aR)return f.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(c===iR)return f.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(c===uZ||c===rR||c===oR||c===sR)if(f=e.get("EXT_texture_compression_rgtc"),f!==null){if(c===UA)return f.COMPRESSED_RED_RGTC1_EXT;if(c===rR)return f.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(c===oR)return f.COMPRESSED_RED_GREEN_RGTC2_EXT;if(c===sR)return f.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return c===lp?o?n.UNSIGNED_INT_24_8:(f=e.get("WEBGL_depth_texture"),f!==null?f.UNSIGNED_INT_24_8_WEBGL:null):n[c]!==void 0?n[c]:null}return{convert:s}}class NZ extends jr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class _0 extends fi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gwe={type:"move"};class T4{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Fe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Fe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Fe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Fe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const a=this._hand;if(a)for(const o of e.hand.values())this._getHandJoint(a,o)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,a,o){let s=null,c=null,d=null;const f=this._targetRay,m=this._grip,y=this._hand;if(e&&a.session.visibilityState!=="visible-blurred"){if(y&&e.hand){d=!0;for(const k of e.hand.values()){const D=a.getJointPose(k,o),L=this._getHandJoint(y,k);D!==null&&(L.matrix.fromArray(D.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.matrixWorldNeedsUpdate=!0,L.jointRadius=D.radius),L.visible=D!==null}const _=y.joints["index-finger-tip"],w=y.joints["thumb-tip"],A=_.position.distanceTo(w.position),C=.02,I=.005;y.inputState.pinching&&A>C+I?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&A<=C-I&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else m!==null&&e.gripSpace&&(c=a.getPose(e.gripSpace,o),c!==null&&(m.matrix.fromArray(c.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,c.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(c.linearVelocity)):m.hasLinearVelocity=!1,c.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(c.angularVelocity)):m.hasAngularVelocity=!1));f!==null&&(s=a.getPose(e.targetRaySpace,o),s===null&&c!==null&&(s=c),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(gwe)))}return f!==null&&(f.visible=s!==null),m!==null&&(m.visible=c!==null),y!==null&&(y.visible=d!==null),this}_getHandJoint(e,a){if(e.joints[a.jointName]===void 0){const o=new _0;o.matrixAutoUpdate=!1,o.visible=!1,e.joints[a.jointName]=o,e.add(o)}return e.joints[a.jointName]}}class BZ extends Lr{constructor(e,a,o,s,c,d,f,m,y,_){if(_=_!==void 0?_:cp,_!==cp&&_!==Lg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&_===cp&&(o=Sh),o===void 0&&_===Lg&&(o=lp),super(null,s,c,d,f,m,_,o,y),this.isDepthTexture=!0,this.image={width:e,height:a},this.magFilter=f!==void 0?f:ro,this.minFilter=m!==void 0?m:ro,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const a=super.toJSON(e);return this.compareFunction!==null&&(a.compareFunction=this.compareFunction),a}}class ywe extends _d{constructor(e,a){super();const o=this;let s=null,c=1,d=null,f="local-floor",m=1,y=null,_=null,w=null,A=null,C=null,I=null;const k=a.getContextAttributes();let D=null,L=null;const O=[],F=[],B=new jr;B.layers.enable(1),B.viewport=new Ai;const G=new jr;G.layers.enable(2),G.viewport=new Ai;const q=[B,G],X=new NZ;X.layers.enable(1),X.layers.enable(2);let ee=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ne){let Ee=O[ne];return Ee===void 0&&(Ee=new T4,O[ne]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ne){let Ee=O[ne];return Ee===void 0&&(Ee=new T4,O[ne]=Ee),Ee.getGripSpace()},this.getHand=function(ne){let Ee=O[ne];return Ee===void 0&&(Ee=new T4,O[ne]=Ee),Ee.getHandSpace()};function Q(ne){const Ee=F.indexOf(ne.inputSource);if(Ee===-1)return;const Ye=O[Ee];Ye!==void 0&&(Ye.update(ne.inputSource,ne.frame,y||d),Ye.dispatchEvent({type:ne.type,data:ne.inputSource}))}function me(){s.removeEventListener("select",Q),s.removeEventListener("selectstart",Q),s.removeEventListener("selectend",Q),s.removeEventListener("squeeze",Q),s.removeEventListener("squeezestart",Q),s.removeEventListener("squeezeend",Q),s.removeEventListener("end",me),s.removeEventListener("inputsourceschange",pe);for(let ne=0;ne<O.length;ne++){const Ee=F[ne];Ee!==null&&(F[ne]=null,O[ne].disconnect(Ee))}ee=null,V=null,e.setRenderTarget(D),C=null,A=null,w=null,s=null,L=null,Ae.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ne){c=ne,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ne){f=ne,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||d},this.setReferenceSpace=function(ne){y=ne},this.getBaseLayer=function(){return A!==null?A:C},this.getBinding=function(){return w},this.getFrame=function(){return I},this.getSession=function(){return s},this.setSession=async function(ne){if(s=ne,s!==null){if(D=e.getRenderTarget(),s.addEventListener("select",Q),s.addEventListener("selectstart",Q),s.addEventListener("selectend",Q),s.addEventListener("squeeze",Q),s.addEventListener("squeezestart",Q),s.addEventListener("squeezeend",Q),s.addEventListener("end",me),s.addEventListener("inputsourceschange",pe),k.xrCompatible!==!0&&await a.makeXRCompatible(),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ee={antialias:s.renderState.layers===void 0?k.antialias:!0,alpha:!0,depth:k.depth,stencil:k.stencil,framebufferScaleFactor:c};C=new XRWebGLLayer(s,a,Ee),s.updateRenderState({baseLayer:C}),L=new hu(C.framebufferWidth,C.framebufferHeight,{format:hl,type:hd,colorSpace:e.outputColorSpace,stencilBuffer:k.stencil})}else{let Ee=null,Ye=null,Xe=null;k.depth&&(Xe=k.stencil?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT24,Ee=k.stencil?Lg:cp,Ye=k.stencil?lp:Sh);const Ke={colorFormat:a.RGBA8,depthFormat:Xe,scaleFactor:c};w=new XRWebGLBinding(s,a),A=w.createProjectionLayer(Ke),s.updateRenderState({layers:[A]}),L=new hu(A.textureWidth,A.textureHeight,{format:hl,type:hd,depthTexture:new BZ(A.textureWidth,A.textureHeight,Ye,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:k.stencil,colorSpace:e.outputColorSpace,samples:k.antialias?4:0});const Ue=e.properties.get(L);Ue.__ignoreDepthValues=A.ignoreDepthValues}L.isXRRenderTarget=!0,this.setFoveation(m),y=null,d=await s.requestReferenceSpace(f),Ae.setContext(s),Ae.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function pe(ne){for(let Ee=0;Ee<ne.removed.length;Ee++){const Ye=ne.removed[Ee],Xe=F.indexOf(Ye);Xe>=0&&(F[Xe]=null,O[Xe].disconnect(Ye))}for(let Ee=0;Ee<ne.added.length;Ee++){const Ye=ne.added[Ee];let Xe=F.indexOf(Ye);if(Xe===-1){for(let Ue=0;Ue<O.length;Ue++)if(Ue>=F.length){F.push(Ye),Xe=Ue;break}else if(F[Ue]===null){F[Ue]=Ye,Xe=Ue;break}if(Xe===-1)break}const Ke=O[Xe];Ke&&Ke.connect(Ye)}}const be=new Fe,fe=new Fe;function Ce(ne,Ee,Ye){be.setFromMatrixPosition(Ee.matrixWorld),fe.setFromMatrixPosition(Ye.matrixWorld);const Xe=be.distanceTo(fe),Ke=Ee.projectionMatrix.elements,Ue=Ye.projectionMatrix.elements,ht=Ke[14]/(Ke[10]-1),Lt=Ke[14]/(Ke[10]+1),Rt=(Ke[9]+1)/Ke[5],Jt=(Ke[9]-1)/Ke[5],Pt=(Ke[8]-1)/Ke[0],Pe=(Ue[8]+1)/Ue[0],ft=ht*Pt,gt=ht*Pe,St=Xe/(-Pt+Pe),Be=St*-Pt;Ee.matrixWorld.decompose(ne.position,ne.quaternion,ne.scale),ne.translateX(Be),ne.translateZ(St),ne.matrixWorld.compose(ne.position,ne.quaternion,ne.scale),ne.matrixWorldInverse.copy(ne.matrixWorld).invert();const le=ht+St,oe=Lt+St,ve=ft-Be,$e=gt+(Xe-Be),De=Rt*Lt/oe*le,ot=Jt*Lt/oe*le;ne.projectionMatrix.makePerspective(ve,$e,De,ot,le,oe),ne.projectionMatrixInverse.copy(ne.projectionMatrix).invert()}function Re(ne,Ee){Ee===null?ne.matrixWorld.copy(ne.matrix):ne.matrixWorld.multiplyMatrices(Ee.matrixWorld,ne.matrix),ne.matrixWorldInverse.copy(ne.matrixWorld).invert()}this.updateCamera=function(ne){if(s===null)return;X.near=G.near=B.near=ne.near,X.far=G.far=B.far=ne.far,(ee!==X.near||V!==X.far)&&(s.updateRenderState({depthNear:X.near,depthFar:X.far}),ee=X.near,V=X.far);const Ee=ne.parent,Ye=X.cameras;Re(X,Ee);for(let Xe=0;Xe<Ye.length;Xe++)Re(Ye[Xe],Ee);Ye.length===2?Ce(X,B,G):X.projectionMatrix.copy(B.projectionMatrix),He(ne,X,Ee)};function He(ne,Ee,Ye){Ye===null?ne.matrix.copy(Ee.matrixWorld):(ne.matrix.copy(Ye.matrixWorld),ne.matrix.invert(),ne.matrix.multiply(Ee.matrixWorld)),ne.matrix.decompose(ne.position,ne.quaternion,ne.scale),ne.updateMatrixWorld(!0),ne.projectionMatrix.copy(Ee.projectionMatrix),ne.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ne.isPerspectiveCamera&&(ne.fov=K0*2*Math.atan(1/ne.projectionMatrix.elements[5]),ne.zoom=1)}this.getCamera=function(){return X},this.getFoveation=function(){if(!(A===null&&C===null))return m},this.setFoveation=function(ne){m=ne,A!==null&&(A.fixedFoveation=ne),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=ne)};let ue=null;function ye(ne,Ee){if(_=Ee.getViewerPose(y||d),I=Ee,_!==null){const Ye=_.views;C!==null&&(e.setRenderTargetFramebuffer(L,C.framebuffer),e.setRenderTarget(L));let Xe=!1;Ye.length!==X.cameras.length&&(X.cameras.length=0,Xe=!0);for(let Ke=0;Ke<Ye.length;Ke++){const Ue=Ye[Ke];let ht=null;if(C!==null)ht=C.getViewport(Ue);else{const Rt=w.getViewSubImage(A,Ue);ht=Rt.viewport,Ke===0&&(e.setRenderTargetTextures(L,Rt.colorTexture,A.ignoreDepthValues?void 0:Rt.depthStencilTexture),e.setRenderTarget(L))}let Lt=q[Ke];Lt===void 0&&(Lt=new jr,Lt.layers.enable(Ke),Lt.viewport=new Ai,q[Ke]=Lt),Lt.matrix.fromArray(Ue.transform.matrix),Lt.matrix.decompose(Lt.position,Lt.quaternion,Lt.scale),Lt.projectionMatrix.fromArray(Ue.projectionMatrix),Lt.projectionMatrixInverse.copy(Lt.projectionMatrix).invert(),Lt.viewport.set(ht.x,ht.y,ht.width,ht.height),Ke===0&&(X.matrix.copy(Lt.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale)),Xe===!0&&X.cameras.push(Lt)}}for(let Ye=0;Ye<O.length;Ye++){const Xe=F[Ye],Ke=O[Ye];Xe!==null&&Ke!==void 0&&Ke.update(Xe,Ee,y||d)}ue&&ue(ne,Ee),Ee.detectedPlanes&&o.dispatchEvent({type:"planesdetected",data:Ee}),I=null}const Ae=new RZ;Ae.setAnimationLoop(ye),this.setAnimationLoop=function(ne){ue=ne},this.dispose=function(){}}}function vwe(n,e){function a(D,L){D.matrixAutoUpdate===!0&&D.updateMatrix(),L.value.copy(D.matrix)}function o(D,L){L.color.getRGB(D.fogColor.value,PZ(n)),L.isFog?(D.fogNear.value=L.near,D.fogFar.value=L.far):L.isFogExp2&&(D.fogDensity.value=L.density)}function s(D,L,O,F,B){L.isMeshBasicMaterial||L.isMeshLambertMaterial?c(D,L):L.isMeshToonMaterial?(c(D,L),w(D,L)):L.isMeshPhongMaterial?(c(D,L),_(D,L)):L.isMeshStandardMaterial?(c(D,L),A(D,L),L.isMeshPhysicalMaterial&&C(D,L,B)):L.isMeshMatcapMaterial?(c(D,L),I(D,L)):L.isMeshDepthMaterial?c(D,L):L.isMeshDistanceMaterial?(c(D,L),k(D,L)):L.isMeshNormalMaterial?c(D,L):L.isLineBasicMaterial?(d(D,L),L.isLineDashedMaterial&&f(D,L)):L.isPointsMaterial?m(D,L,O,F):L.isSpriteMaterial?y(D,L):L.isShadowMaterial?(D.color.value.copy(L.color),D.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}function c(D,L){D.opacity.value=L.opacity,L.color&&D.diffuse.value.copy(L.color),L.emissive&&D.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(D.map.value=L.map,a(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.bumpMap&&(D.bumpMap.value=L.bumpMap,a(L.bumpMap,D.bumpMapTransform),D.bumpScale.value=L.bumpScale,L.side===vs&&(D.bumpScale.value*=-1)),L.normalMap&&(D.normalMap.value=L.normalMap,a(L.normalMap,D.normalMapTransform),D.normalScale.value.copy(L.normalScale),L.side===vs&&D.normalScale.value.negate()),L.displacementMap&&(D.displacementMap.value=L.displacementMap,a(L.displacementMap,D.displacementMapTransform),D.displacementScale.value=L.displacementScale,D.displacementBias.value=L.displacementBias),L.emissiveMap&&(D.emissiveMap.value=L.emissiveMap,a(L.emissiveMap,D.emissiveMapTransform)),L.specularMap&&(D.specularMap.value=L.specularMap,a(L.specularMap,D.specularMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest);const O=e.get(L).envMap;if(O&&(D.envMap.value=O,D.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,D.reflectivity.value=L.reflectivity,D.ior.value=L.ior,D.refractionRatio.value=L.refractionRatio),L.lightMap){D.lightMap.value=L.lightMap;const F=n._useLegacyLights===!0?Math.PI:1;D.lightMapIntensity.value=L.lightMapIntensity*F,a(L.lightMap,D.lightMapTransform)}L.aoMap&&(D.aoMap.value=L.aoMap,D.aoMapIntensity.value=L.aoMapIntensity,a(L.aoMap,D.aoMapTransform))}function d(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,L.map&&(D.map.value=L.map,a(L.map,D.mapTransform))}function f(D,L){D.dashSize.value=L.dashSize,D.totalSize.value=L.dashSize+L.gapSize,D.scale.value=L.scale}function m(D,L,O,F){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.size.value=L.size*O,D.scale.value=F*.5,L.map&&(D.map.value=L.map,a(L.map,D.uvTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function y(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.rotation.value=L.rotation,L.map&&(D.map.value=L.map,a(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function _(D,L){D.specular.value.copy(L.specular),D.shininess.value=Math.max(L.shininess,1e-4)}function w(D,L){L.gradientMap&&(D.gradientMap.value=L.gradientMap)}function A(D,L){D.metalness.value=L.metalness,L.metalnessMap&&(D.metalnessMap.value=L.metalnessMap,a(L.metalnessMap,D.metalnessMapTransform)),D.roughness.value=L.roughness,L.roughnessMap&&(D.roughnessMap.value=L.roughnessMap,a(L.roughnessMap,D.roughnessMapTransform)),e.get(L).envMap&&(D.envMapIntensity.value=L.envMapIntensity)}function C(D,L,O){D.ior.value=L.ior,L.sheen>0&&(D.sheenColor.value.copy(L.sheenColor).multiplyScalar(L.sheen),D.sheenRoughness.value=L.sheenRoughness,L.sheenColorMap&&(D.sheenColorMap.value=L.sheenColorMap,a(L.sheenColorMap,D.sheenColorMapTransform)),L.sheenRoughnessMap&&(D.sheenRoughnessMap.value=L.sheenRoughnessMap,a(L.sheenRoughnessMap,D.sheenRoughnessMapTransform))),L.clearcoat>0&&(D.clearcoat.value=L.clearcoat,D.clearcoatRoughness.value=L.clearcoatRoughness,L.clearcoatMap&&(D.clearcoatMap.value=L.clearcoatMap,a(L.clearcoatMap,D.clearcoatMapTransform)),L.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap,a(L.clearcoatRoughnessMap,D.clearcoatRoughnessMapTransform)),L.clearcoatNormalMap&&(D.clearcoatNormalMap.value=L.clearcoatNormalMap,a(L.clearcoatNormalMap,D.clearcoatNormalMapTransform),D.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),L.side===vs&&D.clearcoatNormalScale.value.negate())),L.iridescence>0&&(D.iridescence.value=L.iridescence,D.iridescenceIOR.value=L.iridescenceIOR,D.iridescenceThicknessMinimum.value=L.iridescenceThicknessRange[0],D.iridescenceThicknessMaximum.value=L.iridescenceThicknessRange[1],L.iridescenceMap&&(D.iridescenceMap.value=L.iridescenceMap,a(L.iridescenceMap,D.iridescenceMapTransform)),L.iridescenceThicknessMap&&(D.iridescenceThicknessMap.value=L.iridescenceThicknessMap,a(L.iridescenceThicknessMap,D.iridescenceThicknessMapTransform))),L.transmission>0&&(D.transmission.value=L.transmission,D.transmissionSamplerMap.value=O.texture,D.transmissionSamplerSize.value.set(O.width,O.height),L.transmissionMap&&(D.transmissionMap.value=L.transmissionMap,a(L.transmissionMap,D.transmissionMapTransform)),D.thickness.value=L.thickness,L.thicknessMap&&(D.thicknessMap.value=L.thicknessMap,a(L.thicknessMap,D.thicknessMapTransform)),D.attenuationDistance.value=L.attenuationDistance,D.attenuationColor.value.copy(L.attenuationColor)),L.anisotropy>0&&(D.anisotropyVector.value.set(L.anisotropy*Math.cos(L.anisotropyRotation),L.anisotropy*Math.sin(L.anisotropyRotation)),L.anisotropyMap&&(D.anisotropyMap.value=L.anisotropyMap,a(L.anisotropyMap,D.anisotropyMapTransform))),D.specularIntensity.value=L.specularIntensity,D.specularColor.value.copy(L.specularColor),L.specularColorMap&&(D.specularColorMap.value=L.specularColorMap,a(L.specularColorMap,D.specularColorMapTransform)),L.specularIntensityMap&&(D.specularIntensityMap.value=L.specularIntensityMap,a(L.specularIntensityMap,D.specularIntensityMapTransform))}function I(D,L){L.matcap&&(D.matcap.value=L.matcap)}function k(D,L){const O=e.get(L).light;D.referencePosition.value.setFromMatrixPosition(O.matrixWorld),D.nearDistance.value=O.shadow.camera.near,D.farDistance.value=O.shadow.camera.far}return{refreshFogUniforms:o,refreshMaterialUniforms:s}}function _we(n,e,a,o){let s={},c={},d=[];const f=a.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(O,F){const B=F.program;o.uniformBlockBinding(O,B)}function y(O,F){let B=s[O.id];B===void 0&&(I(O),B=_(O),s[O.id]=B,O.addEventListener("dispose",D));const G=F.program;o.updateUBOMapping(O,G);const q=e.render.frame;c[O.id]!==q&&(A(O),c[O.id]=q)}function _(O){const F=w();O.__bindingPointIndex=F;const B=n.createBuffer(),G=O.__size,q=O.usage;return n.bindBuffer(n.UNIFORM_BUFFER,B),n.bufferData(n.UNIFORM_BUFFER,G,q),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,F,B),B}function w(){for(let O=0;O<f;O++)if(d.indexOf(O)===-1)return d.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function A(O){const F=s[O.id],B=O.uniforms,G=O.__cache;n.bindBuffer(n.UNIFORM_BUFFER,F);for(let q=0,X=B.length;q<X;q++){const ee=B[q];if(C(ee,q,G)===!0){const V=ee.__offset,Q=Array.isArray(ee.value)?ee.value:[ee.value];let me=0;for(let pe=0;pe<Q.length;pe++){const be=Q[pe],fe=k(be);typeof be=="number"?(ee.__data[0]=be,n.bufferSubData(n.UNIFORM_BUFFER,V+me,ee.__data)):be.isMatrix3?(ee.__data[0]=be.elements[0],ee.__data[1]=be.elements[1],ee.__data[2]=be.elements[2],ee.__data[3]=be.elements[0],ee.__data[4]=be.elements[3],ee.__data[5]=be.elements[4],ee.__data[6]=be.elements[5],ee.__data[7]=be.elements[0],ee.__data[8]=be.elements[6],ee.__data[9]=be.elements[7],ee.__data[10]=be.elements[8],ee.__data[11]=be.elements[0]):(be.toArray(ee.__data,me),me+=fe.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,V,ee.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function C(O,F,B){const G=O.value;if(B[F]===void 0){if(typeof G=="number")B[F]=G;else{const q=Array.isArray(G)?G:[G],X=[];for(let ee=0;ee<q.length;ee++)X.push(q[ee].clone());B[F]=X}return!0}else if(typeof G=="number"){if(B[F]!==G)return B[F]=G,!0}else{const q=Array.isArray(B[F])?B[F]:[B[F]],X=Array.isArray(G)?G:[G];for(let ee=0;ee<q.length;ee++){const V=q[ee];if(V.equals(X[ee])===!1)return V.copy(X[ee]),!0}}return!1}function I(O){const F=O.uniforms;let B=0;const G=16;let q=0;for(let X=0,ee=F.length;X<ee;X++){const V=F[X],Q={boundary:0,storage:0},me=Array.isArray(V.value)?V.value:[V.value];for(let pe=0,be=me.length;pe<be;pe++){const fe=me[pe],Ce=k(fe);Q.boundary+=Ce.boundary,Q.storage+=Ce.storage}if(V.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=B,X>0){q=B%G;const pe=G-q;q!==0&&pe-Q.boundary<0&&(B+=G-q,V.__offset=B)}B+=Q.storage}return q=B%G,q>0&&(B+=G-q),O.__size=B,O.__cache={},this}function k(O){const F={boundary:0,storage:0};return typeof O=="number"?(F.boundary=4,F.storage=4):O.isVector2?(F.boundary=8,F.storage=8):O.isVector3||O.isColor?(F.boundary=16,F.storage=12):O.isVector4?(F.boundary=16,F.storage=16):O.isMatrix3?(F.boundary=48,F.storage=48):O.isMatrix4?(F.boundary=64,F.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),F}function D(O){const F=O.target;F.removeEventListener("dispose",D);const B=d.indexOf(F.__bindingPointIndex);d.splice(B,1),n.deleteBuffer(s[F.id]),delete s[F.id],delete c[F.id]}function L(){for(const O in s)n.deleteBuffer(s[O]);d=[],s={},c={}}return{bind:m,update:y,dispose:L}}class $D{constructor(e={}){const{canvas:a=MZ(),context:o=null,depth:s=!0,stencil:c=!0,alpha:d=!1,antialias:f=!1,premultipliedAlpha:m=!0,preserveDrawingBuffer:y=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:w=!1}=e;this.isWebGLRenderer=!0;let A;o!==null?A=o.getContextAttributes().alpha:A=d;const C=new Uint32Array(4),I=new Int32Array(4);let k=null,D=null;const L=[],O=[];this.domElement=a,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=To,this._useLegacyLights=!1,this.toneMapping=dd,this.toneMappingExposure=1;const F=this;let B=!1,G=0,q=0,X=null,ee=-1,V=null;const Q=new Ai,me=new Ai;let pe=null;const be=new Pn(0);let fe=0,Ce=a.width,Re=a.height,He=1,ue=null,ye=null;const Ae=new Ai(0,0,Ce,Re),ne=new Ai(0,0,Ce,Re);let Ee=!1;const Ye=new ST;let Xe=!1,Ke=!1,Ue=null;const ht=new Ia,Lt=new Kt,Rt=new Fe,Jt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Pt(){return X===null?He:1}let Pe=o;function ft(Le,_t){for(let kt=0;kt<Le.length;kt++){const Tt=Le[kt],Ot=a.getContext(Tt,_t);if(Ot!==null)return Ot}return null}try{const Le={alpha:!0,depth:s,stencil:c,antialias:f,premultipliedAlpha:m,preserveDrawingBuffer:y,powerPreference:_,failIfMajorPerformanceCaveat:w};if("setAttribute"in a&&a.setAttribute("data-engine",`three.js r${gT}`),a.addEventListener("webglcontextlost",fn,!1),a.addEventListener("webglcontextrestored",_e,!1),a.addEventListener("webglcontextcreationerror",Ze,!1),Pe===null){const _t=["webgl2","webgl","experimental-webgl"];if(F.isWebGL1Renderer===!0&&_t.shift(),Pe=ft(_t,Le),Pe===null)throw ft(_t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Pe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Pe.getShaderPrecisionFormat===void 0&&(Pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Le){throw console.error("THREE.WebGLRenderer: "+Le.message),Le}let gt,St,Be,le,oe,ve,$e,De,ot,ce,te,Oe,pt,it,st,At,Ut,Vt,$t,Ft,wt,Yt,Ge,It;function qt(){gt=new Dbe(Pe),St=new Cbe(Pe,gt,e),gt.init(St),Yt=new FZ(Pe,gt,St),Be=new pwe(Pe,gt,St),le=new Fbe(Pe),oe=new nwe,ve=new mwe(Pe,gt,Be,oe,St,Yt,le),$e=new Ibe(F),De=new kbe(F),ot=new q0e(Pe,St),Ge=new Mbe(Pe,gt,ot,St),ce=new Obe(Pe,ot,le,Ge),te=new Wbe(Pe,ce,ot,le),$t=new Ube(Pe,St,ve),At=new Pbe(oe),Oe=new twe(F,$e,De,gt,St,Ge,At),pt=new vwe(F,oe),it=new iwe,st=new uwe(gt,St),Vt=new Ebe(F,$e,De,Be,te,A,m),Ut=new fwe(F,te,St),It=new _we(Pe,le,St,Be),Ft=new Tbe(Pe,gt,le,St),wt=new zbe(Pe,gt,le,St),le.programs=Oe.programs,F.capabilities=St,F.extensions=gt,F.properties=oe,F.renderLists=it,F.shadowMap=Ut,F.state=Be,F.info=le}qt();const Dt=new ywe(F,Pe);this.xr=Dt,this.getContext=function(){return Pe},this.getContextAttributes=function(){return Pe.getContextAttributes()},this.forceContextLoss=function(){const Le=gt.get("WEBGL_lose_context");Le&&Le.loseContext()},this.forceContextRestore=function(){const Le=gt.get("WEBGL_lose_context");Le&&Le.restoreContext()},this.getPixelRatio=function(){return He},this.setPixelRatio=function(Le){Le!==void 0&&(He=Le,this.setSize(Ce,Re,!1))},this.getSize=function(Le){return Le.set(Ce,Re)},this.setSize=function(Le,_t,kt=!0){if(Dt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ce=Le,Re=_t,a.width=Math.floor(Le*He),a.height=Math.floor(_t*He),kt===!0&&(a.style.width=Le+"px",a.style.height=_t+"px"),this.setViewport(0,0,Le,_t)},this.getDrawingBufferSize=function(Le){return Le.set(Ce*He,Re*He).floor()},this.setDrawingBufferSize=function(Le,_t,kt){Ce=Le,Re=_t,He=kt,a.width=Math.floor(Le*kt),a.height=Math.floor(_t*kt),this.setViewport(0,0,Le,_t)},this.getCurrentViewport=function(Le){return Le.copy(Q)},this.getViewport=function(Le){return Le.copy(Ae)},this.setViewport=function(Le,_t,kt,Tt){Le.isVector4?Ae.set(Le.x,Le.y,Le.z,Le.w):Ae.set(Le,_t,kt,Tt),Be.viewport(Q.copy(Ae).multiplyScalar(He).floor())},this.getScissor=function(Le){return Le.copy(ne)},this.setScissor=function(Le,_t,kt,Tt){Le.isVector4?ne.set(Le.x,Le.y,Le.z,Le.w):ne.set(Le,_t,kt,Tt),Be.scissor(me.copy(ne).multiplyScalar(He).floor())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(Le){Be.setScissorTest(Ee=Le)},this.setOpaqueSort=function(Le){ue=Le},this.setTransparentSort=function(Le){ye=Le},this.getClearColor=function(Le){return Le.copy(Vt.getClearColor())},this.setClearColor=function(){Vt.setClearColor.apply(Vt,arguments)},this.getClearAlpha=function(){return Vt.getClearAlpha()},this.setClearAlpha=function(){Vt.setClearAlpha.apply(Vt,arguments)},this.clear=function(Le=!0,_t=!0,kt=!0){let Tt=0;if(Le){let Ot=!1;if(X!==null){const ln=X.texture.format;Ot=ln===OD||ln===DD||ln===kD}if(Ot){const ln=X.texture.type,Tn=ln===hd||ln===Sh||ln===_T||ln===lp||ln===LD||ln===RD,qn=Vt.getClearColor(),an=Vt.getClearAlpha(),sa=qn.r,pa=qn.g,ia=qn.b;Tn?(C[0]=sa,C[1]=pa,C[2]=ia,C[3]=an,Pe.clearBufferuiv(Pe.COLOR,0,C)):(I[0]=sa,I[1]=pa,I[2]=ia,I[3]=an,Pe.clearBufferiv(Pe.COLOR,0,I))}else Tt|=Pe.COLOR_BUFFER_BIT}_t&&(Tt|=Pe.DEPTH_BUFFER_BIT),kt&&(Tt|=Pe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Pe.clear(Tt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){a.removeEventListener("webglcontextlost",fn,!1),a.removeEventListener("webglcontextrestored",_e,!1),a.removeEventListener("webglcontextcreationerror",Ze,!1),it.dispose(),st.dispose(),oe.dispose(),$e.dispose(),De.dispose(),te.dispose(),Ge.dispose(),It.dispose(),Oe.dispose(),Dt.dispose(),Dt.removeEventListener("sessionstart",ut),Dt.removeEventListener("sessionend",ct),Ue&&(Ue.dispose(),Ue=null),Gt.stop()};function fn(Le){Le.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function _e(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const Le=le.autoReset,_t=Ut.enabled,kt=Ut.autoUpdate,Tt=Ut.needsUpdate,Ot=Ut.type;qt(),le.autoReset=Le,Ut.enabled=_t,Ut.autoUpdate=kt,Ut.needsUpdate=Tt,Ut.type=Ot}function Ze(Le){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Le.statusMessage)}function Se(Le){const _t=Le.target;_t.removeEventListener("dispose",Se),Me(_t)}function Me(Le){ze(Le),oe.remove(Le)}function ze(Le){const _t=oe.get(Le).programs;_t!==void 0&&(_t.forEach(function(kt){Oe.releaseProgram(kt)}),Le.isShaderMaterial&&Oe.releaseShaderCache(Le))}this.renderBufferDirect=function(Le,_t,kt,Tt,Ot,ln){_t===null&&(_t=Jt);const Tn=Ot.isMesh&&Ot.matrixWorld.determinant()<0,qn=Ma(Le,_t,kt,Tt,Ot);Be.setMaterial(Tt,Tn);let an=kt.index,sa=1;if(Tt.wireframe===!0){if(an=ce.getWireframeAttribute(kt),an===void 0)return;sa=2}const pa=kt.drawRange,ia=kt.attributes.position;let ni=pa.start*sa,_r=(pa.start+pa.count)*sa;ln!==null&&(ni=Math.max(ni,ln.start*sa),_r=Math.min(_r,(ln.start+ln.count)*sa)),an!==null?(ni=Math.max(ni,0),_r=Math.min(_r,an.count)):ia!=null&&(ni=Math.max(ni,0),_r=Math.min(_r,ia.count));const ei=_r-ni;if(ei<0||ei===1/0)return;Ge.setup(Ot,Tt,qn,kt,an);let Xi,ta=Ft;if(an!==null&&(Xi=ot.get(an),ta=wt,ta.setIndex(Xi)),Ot.isMesh)Tt.wireframe===!0?(Be.setLineWidth(Tt.wireframeLinewidth*Pt()),ta.setMode(Pe.LINES)):ta.setMode(Pe.TRIANGLES);else if(Ot.isLine){let Rn=Tt.linewidth;Rn===void 0&&(Rn=1),Be.setLineWidth(Rn*Pt()),Ot.isLineSegments?ta.setMode(Pe.LINES):Ot.isLineLoop?ta.setMode(Pe.LINE_LOOP):ta.setMode(Pe.LINE_STRIP)}else Ot.isPoints?ta.setMode(Pe.POINTS):Ot.isSprite&&ta.setMode(Pe.TRIANGLES);if(Ot.isInstancedMesh)ta.renderInstances(ni,ei,Ot.count);else if(kt.isInstancedBufferGeometry){const Rn=kt._maxInstanceCount!==void 0?kt._maxInstanceCount:1/0,lo=Math.min(kt.instanceCount,Rn);ta.renderInstances(ni,ei,lo)}else ta.render(ni,ei)};function Je(Le,_t,kt){Le.transparent===!0&&Le.side===Ul&&Le.forceSinglePass===!1?(Le.side=vs,Le.needsUpdate=!0,Hn(Le,_t,kt),Le.side=md,Le.needsUpdate=!0,Hn(Le,_t,kt),Le.side=Ul):Hn(Le,_t,kt)}this.compile=function(Le,_t,kt=null){kt===null&&(kt=Le),D=st.get(kt),D.init(),O.push(D),kt.traverseVisible(function(Ot){Ot.isLight&&Ot.layers.test(_t.layers)&&(D.pushLight(Ot),Ot.castShadow&&D.pushShadow(Ot))}),Le!==kt&&Le.traverseVisible(function(Ot){Ot.isLight&&Ot.layers.test(_t.layers)&&(D.pushLight(Ot),Ot.castShadow&&D.pushShadow(Ot))}),D.setupLights(F._useLegacyLights);const Tt=new Set;return Le.traverse(function(Ot){const ln=Ot.material;if(ln)if(Array.isArray(ln))for(let Tn=0;Tn<ln.length;Tn++){const qn=ln[Tn];Je(qn,kt,Ot),Tt.add(qn)}else Je(ln,kt,Ot),Tt.add(ln)}),O.pop(),D=null,Tt},this.compileAsync=function(Le,_t,kt=null){const Tt=this.compile(Le,_t,kt);return new Promise(Ot=>{function ln(){if(Tt.forEach(function(Tn){oe.get(Tn).currentProgram.isReady()&&Tt.delete(Tn)}),Tt.size===0){Ot(Le);return}setTimeout(ln,10)}gt.get("KHR_parallel_shader_compile")!==null?ln():setTimeout(ln,10)})};let et=null;function yt(Le){et&&et(Le)}function ut(){Gt.stop()}function ct(){Gt.start()}const Gt=new RZ;Gt.setAnimationLoop(yt),typeof self<"u"&&Gt.setContext(self),this.setAnimationLoop=function(Le){et=Le,Dt.setAnimationLoop(Le),Le===null?Gt.stop():Gt.start()},Dt.addEventListener("sessionstart",ut),Dt.addEventListener("sessionend",ct),this.render=function(Le,_t){if(_t!==void 0&&_t.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;Le.matrixWorldAutoUpdate===!0&&Le.updateMatrixWorld(),_t.parent===null&&_t.matrixWorldAutoUpdate===!0&&_t.updateMatrixWorld(),Dt.enabled===!0&&Dt.isPresenting===!0&&(Dt.cameraAutoUpdate===!0&&Dt.updateCamera(_t),_t=Dt.getCamera()),Le.isScene===!0&&Le.onBeforeRender(F,Le,_t,X),D=st.get(Le,O.length),D.init(),O.push(D),ht.multiplyMatrices(_t.projectionMatrix,_t.matrixWorldInverse),Ye.setFromProjectionMatrix(ht),Ke=this.localClippingEnabled,Xe=At.init(this.clippingPlanes,Ke),k=it.get(Le,L.length),k.init(),L.push(k),Mt(Le,_t,0,F.sortObjects),k.finish(),F.sortObjects===!0&&k.sort(ue,ye),this.info.render.frame++,Xe===!0&&At.beginShadows();const kt=D.state.shadowsArray;if(Ut.render(kt,Le,_t),Xe===!0&&At.endShadows(),this.info.autoReset===!0&&this.info.reset(),Vt.render(k,Le),D.setupLights(F._useLegacyLights),_t.isArrayCamera){const Tt=_t.cameras;for(let Ot=0,ln=Tt.length;Ot<ln;Ot++){const Tn=Tt[Ot];Qt(k,Le,Tn,Tn.viewport)}}else Qt(k,Le,_t);X!==null&&(ve.updateMultisampleRenderTarget(X),ve.updateRenderTargetMipmap(X)),Le.isScene===!0&&Le.onAfterRender(F,Le,_t),Ge.resetDefaultState(),ee=-1,V=null,O.pop(),O.length>0?D=O[O.length-1]:D=null,L.pop(),L.length>0?k=L[L.length-1]:k=null};function Mt(Le,_t,kt,Tt){if(Le.visible===!1)return;if(Le.layers.test(_t.layers)){if(Le.isGroup)kt=Le.renderOrder;else if(Le.isLOD)Le.autoUpdate===!0&&Le.update(_t);else if(Le.isLight)D.pushLight(Le),Le.castShadow&&D.pushShadow(Le);else if(Le.isSprite){if(!Le.frustumCulled||Ye.intersectsSprite(Le)){Tt&&Rt.setFromMatrixPosition(Le.matrixWorld).applyMatrix4(ht);const Tn=te.update(Le),qn=Le.material;qn.visible&&k.push(Le,Tn,qn,kt,Rt.z,null)}}else if((Le.isMesh||Le.isLine||Le.isPoints)&&(!Le.frustumCulled||Ye.intersectsObject(Le))){const Tn=te.update(Le),qn=Le.material;if(Tt&&(Le.boundingSphere!==void 0?(Le.boundingSphere===null&&Le.computeBoundingSphere(),Rt.copy(Le.boundingSphere.center)):(Tn.boundingSphere===null&&Tn.computeBoundingSphere(),Rt.copy(Tn.boundingSphere.center)),Rt.applyMatrix4(Le.matrixWorld).applyMatrix4(ht)),Array.isArray(qn)){const an=Tn.groups;for(let sa=0,pa=an.length;sa<pa;sa++){const ia=an[sa],ni=qn[ia.materialIndex];ni&&ni.visible&&k.push(Le,Tn,ni,kt,Rt.z,ia)}}else qn.visible&&k.push(Le,Tn,qn,kt,Rt.z,null)}}const ln=Le.children;for(let Tn=0,qn=ln.length;Tn<qn;Tn++)Mt(ln[Tn],_t,kt,Tt)}function Qt(Le,_t,kt,Tt){const Ot=Le.opaque,ln=Le.transmissive,Tn=Le.transparent;D.setupLightsView(kt),Xe===!0&&At.setGlobalState(F.clippingPlanes,kt),ln.length>0&&mn(Ot,ln,_t,kt),Tt&&Be.viewport(Q.copy(Tt)),Ot.length>0&&nn(Ot,_t,kt),ln.length>0&&nn(ln,_t,kt),Tn.length>0&&nn(Tn,_t,kt),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1)}function mn(Le,_t,kt,Tt){if((kt.isScene===!0?kt.overrideMaterial:null)!==null)return;const ln=St.isWebGL2;Ue===null&&(Ue=new hu(1,1,{generateMipmaps:!0,type:gt.has("EXT_color_buffer_half_float")?Y0:hd,minFilter:vp,samples:ln?4:0})),F.getDrawingBufferSize(Lt),ln?Ue.setSize(Lt.x,Lt.y):Ue.setSize(VE(Lt.x),VE(Lt.y));const Tn=F.getRenderTarget();F.setRenderTarget(Ue),F.getClearColor(be),fe=F.getClearAlpha(),fe<1&&F.setClearColor(16777215,.5),F.clear();const qn=F.toneMapping;F.toneMapping=dd,nn(Le,kt,Tt),ve.updateMultisampleRenderTarget(Ue),ve.updateRenderTargetMipmap(Ue);let an=!1;for(let sa=0,pa=_t.length;sa<pa;sa++){const ia=_t[sa],ni=ia.object,_r=ia.geometry,ei=ia.material,Xi=ia.group;if(ei.side===Ul&&ni.layers.test(Tt.layers)){const ta=ei.side;ei.side=vs,ei.needsUpdate=!0,wn(ni,kt,Tt,_r,ei,Xi),ei.side=ta,ei.needsUpdate=!0,an=!0}}an===!0&&(ve.updateMultisampleRenderTarget(Ue),ve.updateRenderTargetMipmap(Ue)),F.setRenderTarget(Tn),F.setClearColor(be,fe),F.toneMapping=qn}function nn(Le,_t,kt){const Tt=_t.isScene===!0?_t.overrideMaterial:null;for(let Ot=0,ln=Le.length;Ot<ln;Ot++){const Tn=Le[Ot],qn=Tn.object,an=Tn.geometry,sa=Tt===null?Tn.material:Tt,pa=Tn.group;qn.layers.test(kt.layers)&&wn(qn,_t,kt,an,sa,pa)}}function wn(Le,_t,kt,Tt,Ot,ln){Le.onBeforeRender(F,_t,kt,Tt,Ot,ln),Le.modelViewMatrix.multiplyMatrices(kt.matrixWorldInverse,Le.matrixWorld),Le.normalMatrix.getNormalMatrix(Le.modelViewMatrix),Ot.onBeforeRender(F,_t,kt,Tt,Le,ln),Ot.transparent===!0&&Ot.side===Ul&&Ot.forceSinglePass===!1?(Ot.side=vs,Ot.needsUpdate=!0,F.renderBufferDirect(kt,_t,Tt,Ot,Le,ln),Ot.side=md,Ot.needsUpdate=!0,F.renderBufferDirect(kt,_t,Tt,Ot,Le,ln),Ot.side=Ul):F.renderBufferDirect(kt,_t,Tt,Ot,Le,ln),Le.onAfterRender(F,_t,kt,Tt,Ot,ln)}function Hn(Le,_t,kt){_t.isScene!==!0&&(_t=Jt);const Tt=oe.get(Le),Ot=D.state.lights,ln=D.state.shadowsArray,Tn=Ot.state.version,qn=Oe.getParameters(Le,Ot.state,ln,_t,kt),an=Oe.getProgramCacheKey(qn);let sa=Tt.programs;Tt.environment=Le.isMeshStandardMaterial?_t.environment:null,Tt.fog=_t.fog,Tt.envMap=(Le.isMeshStandardMaterial?De:$e).get(Le.envMap||Tt.environment),sa===void 0&&(Le.addEventListener("dispose",Se),sa=new Map,Tt.programs=sa);let pa=sa.get(an);if(pa!==void 0){if(Tt.currentProgram===pa&&Tt.lightsStateVersion===Tn)return Ca(Le,qn),pa}else qn.uniforms=Oe.getUniforms(Le),Le.onBuild(kt,qn,F),Le.onBeforeCompile(qn,F),pa=Oe.acquireProgram(qn,an),sa.set(an,pa),Tt.uniforms=qn.uniforms;const ia=Tt.uniforms;return(!Le.isShaderMaterial&&!Le.isRawShaderMaterial||Le.clipping===!0)&&(ia.clippingPlanes=At.uniform),Ca(Le,qn),Tt.needsLights=pi(Le),Tt.lightsStateVersion=Tn,Tt.needsLights&&(ia.ambientLightColor.value=Ot.state.ambient,ia.lightProbe.value=Ot.state.probe,ia.directionalLights.value=Ot.state.directional,ia.directionalLightShadows.value=Ot.state.directionalShadow,ia.spotLights.value=Ot.state.spot,ia.spotLightShadows.value=Ot.state.spotShadow,ia.rectAreaLights.value=Ot.state.rectArea,ia.ltc_1.value=Ot.state.rectAreaLTC1,ia.ltc_2.value=Ot.state.rectAreaLTC2,ia.pointLights.value=Ot.state.point,ia.pointLightShadows.value=Ot.state.pointShadow,ia.hemisphereLights.value=Ot.state.hemi,ia.directionalShadowMap.value=Ot.state.directionalShadowMap,ia.directionalShadowMatrix.value=Ot.state.directionalShadowMatrix,ia.spotShadowMap.value=Ot.state.spotShadowMap,ia.spotLightMatrix.value=Ot.state.spotLightMatrix,ia.spotLightMap.value=Ot.state.spotLightMap,ia.pointShadowMap.value=Ot.state.pointShadowMap,ia.pointShadowMatrix.value=Ot.state.pointShadowMatrix),Tt.currentProgram=pa,Tt.uniformsList=null,pa}function fa(Le){if(Le.uniformsList===null){const _t=Le.currentProgram.getUniforms();Le.uniformsList=VA.seqWithValue(_t.seq,Le.uniforms)}return Le.uniformsList}function Ca(Le,_t){const kt=oe.get(Le);kt.outputColorSpace=_t.outputColorSpace,kt.instancing=_t.instancing,kt.instancingColor=_t.instancingColor,kt.skinning=_t.skinning,kt.morphTargets=_t.morphTargets,kt.morphNormals=_t.morphNormals,kt.morphColors=_t.morphColors,kt.morphTargetsCount=_t.morphTargetsCount,kt.numClippingPlanes=_t.numClippingPlanes,kt.numIntersection=_t.numClipIntersection,kt.vertexAlphas=_t.vertexAlphas,kt.vertexTangents=_t.vertexTangents,kt.toneMapping=_t.toneMapping}function Ma(Le,_t,kt,Tt,Ot){_t.isScene!==!0&&(_t=Jt),ve.resetTextureUnits();const ln=_t.fog,Tn=Tt.isMeshStandardMaterial?_t.environment:null,qn=X===null?F.outputColorSpace:X.isXRRenderTarget===!0?X.texture.colorSpace:gd,an=(Tt.isMeshStandardMaterial?De:$e).get(Tt.envMap||Tn),sa=Tt.vertexColors===!0&&!!kt.attributes.color&&kt.attributes.color.itemSize===4,pa=!!kt.attributes.tangent&&(!!Tt.normalMap||Tt.anisotropy>0),ia=!!kt.morphAttributes.position,ni=!!kt.morphAttributes.normal,_r=!!kt.morphAttributes.color;let ei=dd;Tt.toneMapped&&(X===null||X.isXRRenderTarget===!0)&&(ei=F.toneMapping);const Xi=kt.morphAttributes.position||kt.morphAttributes.normal||kt.morphAttributes.color,ta=Xi!==void 0?Xi.length:0,Rn=oe.get(Tt),lo=D.state.lights;if(Xe===!0&&(Ke===!0||Le!==V)){const Yn=Le===V&&Tt.id===ee;At.setState(Tt,Le,Yn)}let Ra=!1;Tt.version===Rn.__version?(Rn.needsLights&&Rn.lightsStateVersion!==lo.state.version||Rn.outputColorSpace!==qn||Ot.isInstancedMesh&&Rn.instancing===!1||!Ot.isInstancedMesh&&Rn.instancing===!0||Ot.isSkinnedMesh&&Rn.skinning===!1||!Ot.isSkinnedMesh&&Rn.skinning===!0||Ot.isInstancedMesh&&Rn.instancingColor===!0&&Ot.instanceColor===null||Ot.isInstancedMesh&&Rn.instancingColor===!1&&Ot.instanceColor!==null||Rn.envMap!==an||Tt.fog===!0&&Rn.fog!==ln||Rn.numClippingPlanes!==void 0&&(Rn.numClippingPlanes!==At.numPlanes||Rn.numIntersection!==At.numIntersection)||Rn.vertexAlphas!==sa||Rn.vertexTangents!==pa||Rn.morphTargets!==ia||Rn.morphNormals!==ni||Rn.morphColors!==_r||Rn.toneMapping!==ei||St.isWebGL2===!0&&Rn.morphTargetsCount!==ta)&&(Ra=!0):(Ra=!0,Rn.__version=Tt.version);let Ei=Rn.currentProgram;Ra===!0&&(Ei=Hn(Tt,_t,Ot));let Uo=!1,br=!1,Zi=!1;const ci=Ei.getUniforms(),Dr=Rn.uniforms;if(Be.useProgram(Ei.program)&&(Uo=!0,br=!0,Zi=!0),Tt.id!==ee&&(ee=Tt.id,br=!0),Uo||V!==Le){ci.setValue(Pe,"projectionMatrix",Le.projectionMatrix),ci.setValue(Pe,"viewMatrix",Le.matrixWorldInverse);const Yn=ci.map.cameraPosition;Yn!==void 0&&Yn.setValue(Pe,Rt.setFromMatrixPosition(Le.matrixWorld)),St.logarithmicDepthBuffer&&ci.setValue(Pe,"logDepthBufFC",2/(Math.log(Le.far+1)/Math.LN2)),(Tt.isMeshPhongMaterial||Tt.isMeshToonMaterial||Tt.isMeshLambertMaterial||Tt.isMeshBasicMaterial||Tt.isMeshStandardMaterial||Tt.isShaderMaterial)&&ci.setValue(Pe,"isOrthographic",Le.isOrthographicCamera===!0),V!==Le&&(V=Le,br=!0,Zi=!0)}if(Ot.isSkinnedMesh){ci.setOptional(Pe,Ot,"bindMatrix"),ci.setOptional(Pe,Ot,"bindMatrixInverse");const Yn=Ot.skeleton;Yn&&(St.floatVertexTextures?(Yn.boneTexture===null&&Yn.computeBoneTexture(),ci.setValue(Pe,"boneTexture",Yn.boneTexture,ve),ci.setValue(Pe,"boneTextureSize",Yn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Cn=kt.morphAttributes;if((Cn.position!==void 0||Cn.normal!==void 0||Cn.color!==void 0&&St.isWebGL2===!0)&&$t.update(Ot,kt,Ei),(br||Rn.receiveShadow!==Ot.receiveShadow)&&(Rn.receiveShadow=Ot.receiveShadow,ci.setValue(Pe,"receiveShadow",Ot.receiveShadow)),Tt.isMeshGouraudMaterial&&Tt.envMap!==null&&(Dr.envMap.value=an,Dr.flipEnvMap.value=an.isCubeTexture&&an.isRenderTargetTexture===!1?-1:1),br&&(ci.setValue(Pe,"toneMappingExposure",F.toneMappingExposure),Rn.needsLights&&Ii(Dr,Zi),ln&&Tt.fog===!0&&pt.refreshFogUniforms(Dr,ln),pt.refreshMaterialUniforms(Dr,Tt,He,Re,Ue),VA.upload(Pe,fa(Rn),Dr,ve)),Tt.isShaderMaterial&&Tt.uniformsNeedUpdate===!0&&(VA.upload(Pe,fa(Rn),Dr,ve),Tt.uniformsNeedUpdate=!1),Tt.isSpriteMaterial&&ci.setValue(Pe,"center",Ot.center),ci.setValue(Pe,"modelViewMatrix",Ot.modelViewMatrix),ci.setValue(Pe,"normalMatrix",Ot.normalMatrix),ci.setValue(Pe,"modelMatrix",Ot.matrixWorld),Tt.isShaderMaterial||Tt.isRawShaderMaterial){const Yn=Tt.uniformsGroups;for(let Vi=0,xr=Yn.length;Vi<xr;Vi++)if(St.isWebGL2){const Ss=Yn[Vi];It.update(Ss,Ei),It.bind(Ss,Ei)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ei}function Ii(Le,_t){Le.ambientLightColor.needsUpdate=_t,Le.lightProbe.needsUpdate=_t,Le.directionalLights.needsUpdate=_t,Le.directionalLightShadows.needsUpdate=_t,Le.pointLights.needsUpdate=_t,Le.pointLightShadows.needsUpdate=_t,Le.spotLights.needsUpdate=_t,Le.spotLightShadows.needsUpdate=_t,Le.rectAreaLights.needsUpdate=_t,Le.hemisphereLights.needsUpdate=_t}function pi(Le){return Le.isMeshLambertMaterial||Le.isMeshToonMaterial||Le.isMeshPhongMaterial||Le.isMeshStandardMaterial||Le.isShadowMaterial||Le.isShaderMaterial&&Le.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(Le,_t,kt){oe.get(Le.texture).__webglTexture=_t,oe.get(Le.depthTexture).__webglTexture=kt;const Tt=oe.get(Le);Tt.__hasExternalTextures=!0,Tt.__hasExternalTextures&&(Tt.__autoAllocateDepthBuffer=kt===void 0,Tt.__autoAllocateDepthBuffer||gt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Tt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Le,_t){const kt=oe.get(Le);kt.__webglFramebuffer=_t,kt.__useDefaultFramebuffer=_t===void 0},this.setRenderTarget=function(Le,_t=0,kt=0){X=Le,G=_t,q=kt;let Tt=!0,Ot=null,ln=!1,Tn=!1;if(Le){const an=oe.get(Le);an.__useDefaultFramebuffer!==void 0?(Be.bindFramebuffer(Pe.FRAMEBUFFER,null),Tt=!1):an.__webglFramebuffer===void 0?ve.setupRenderTarget(Le):an.__hasExternalTextures&&ve.rebindTextures(Le,oe.get(Le.texture).__webglTexture,oe.get(Le.depthTexture).__webglTexture);const sa=Le.texture;(sa.isData3DTexture||sa.isDataArrayTexture||sa.isCompressedArrayTexture)&&(Tn=!0);const pa=oe.get(Le).__webglFramebuffer;Le.isWebGLCubeRenderTarget?(Array.isArray(pa[_t])?Ot=pa[_t][kt]:Ot=pa[_t],ln=!0):St.isWebGL2&&Le.samples>0&&ve.useMultisampledRTT(Le)===!1?Ot=oe.get(Le).__webglMultisampledFramebuffer:Array.isArray(pa)?Ot=pa[kt]:Ot=pa,Q.copy(Le.viewport),me.copy(Le.scissor),pe=Le.scissorTest}else Q.copy(Ae).multiplyScalar(He).floor(),me.copy(ne).multiplyScalar(He).floor(),pe=Ee;if(Be.bindFramebuffer(Pe.FRAMEBUFFER,Ot)&&St.drawBuffers&&Tt&&Be.drawBuffers(Le,Ot),Be.viewport(Q),Be.scissor(me),Be.setScissorTest(pe),ln){const an=oe.get(Le.texture);Pe.framebufferTexture2D(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,Pe.TEXTURE_CUBE_MAP_POSITIVE_X+_t,an.__webglTexture,kt)}else if(Tn){const an=oe.get(Le.texture),sa=_t||0;Pe.framebufferTextureLayer(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,an.__webglTexture,kt||0,sa)}ee=-1},this.readRenderTargetPixels=function(Le,_t,kt,Tt,Ot,ln,Tn){if(!(Le&&Le.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qn=oe.get(Le).__webglFramebuffer;if(Le.isWebGLCubeRenderTarget&&Tn!==void 0&&(qn=qn[Tn]),qn){Be.bindFramebuffer(Pe.FRAMEBUFFER,qn);try{const an=Le.texture,sa=an.format,pa=an.type;if(sa!==hl&&Yt.convert(sa)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ia=pa===Y0&&(gt.has("EXT_color_buffer_half_float")||St.isWebGL2&&gt.has("EXT_color_buffer_float"));if(pa!==hd&&Yt.convert(pa)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_TYPE)&&!(pa===od&&(St.isWebGL2||gt.has("OES_texture_float")||gt.has("WEBGL_color_buffer_float")))&&!ia){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}_t>=0&&_t<=Le.width-Tt&&kt>=0&&kt<=Le.height-Ot&&Pe.readPixels(_t,kt,Tt,Ot,Yt.convert(sa),Yt.convert(pa),ln)}finally{const an=X!==null?oe.get(X).__webglFramebuffer:null;Be.bindFramebuffer(Pe.FRAMEBUFFER,an)}}},this.copyFramebufferToTexture=function(Le,_t,kt=0){const Tt=Math.pow(2,-kt),Ot=Math.floor(_t.image.width*Tt),ln=Math.floor(_t.image.height*Tt);ve.setTexture2D(_t,0),Pe.copyTexSubImage2D(Pe.TEXTURE_2D,kt,0,0,Le.x,Le.y,Ot,ln),Be.unbindTexture()},this.copyTextureToTexture=function(Le,_t,kt,Tt=0){const Ot=_t.image.width,ln=_t.image.height,Tn=Yt.convert(kt.format),qn=Yt.convert(kt.type);ve.setTexture2D(kt,0),Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,kt.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,kt.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,kt.unpackAlignment),_t.isDataTexture?Pe.texSubImage2D(Pe.TEXTURE_2D,Tt,Le.x,Le.y,Ot,ln,Tn,qn,_t.image.data):_t.isCompressedTexture?Pe.compressedTexSubImage2D(Pe.TEXTURE_2D,Tt,Le.x,Le.y,_t.mipmaps[0].width,_t.mipmaps[0].height,Tn,_t.mipmaps[0].data):Pe.texSubImage2D(Pe.TEXTURE_2D,Tt,Le.x,Le.y,Tn,qn,_t.image),Tt===0&&kt.generateMipmaps&&Pe.generateMipmap(Pe.TEXTURE_2D),Be.unbindTexture()},this.copyTextureToTexture3D=function(Le,_t,kt,Tt,Ot=0){if(F.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ln=Le.max.x-Le.min.x+1,Tn=Le.max.y-Le.min.y+1,qn=Le.max.z-Le.min.z+1,an=Yt.convert(Tt.format),sa=Yt.convert(Tt.type);let pa;if(Tt.isData3DTexture)ve.setTexture3D(Tt,0),pa=Pe.TEXTURE_3D;else if(Tt.isDataArrayTexture)ve.setTexture2DArray(Tt,0),pa=Pe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,Tt.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Tt.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,Tt.unpackAlignment);const ia=Pe.getParameter(Pe.UNPACK_ROW_LENGTH),ni=Pe.getParameter(Pe.UNPACK_IMAGE_HEIGHT),_r=Pe.getParameter(Pe.UNPACK_SKIP_PIXELS),ei=Pe.getParameter(Pe.UNPACK_SKIP_ROWS),Xi=Pe.getParameter(Pe.UNPACK_SKIP_IMAGES),ta=kt.isCompressedTexture?kt.mipmaps[0]:kt.image;Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,ta.width),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ta.height),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,Le.min.x),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,Le.min.y),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Le.min.z),kt.isDataTexture||kt.isData3DTexture?Pe.texSubImage3D(pa,Ot,_t.x,_t.y,_t.z,ln,Tn,qn,an,sa,ta.data):kt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Pe.compressedTexSubImage3D(pa,Ot,_t.x,_t.y,_t.z,ln,Tn,qn,an,ta.data)):Pe.texSubImage3D(pa,Ot,_t.x,_t.y,_t.z,ln,Tn,qn,an,sa,ta),Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,ia),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ni),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,_r),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,ei),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Xi),Ot===0&&Tt.generateMipmaps&&Pe.generateMipmap(pa),Be.unbindTexture()},this.initTexture=function(Le){Le.isCubeTexture?ve.setTextureCube(Le,0):Le.isData3DTexture?ve.setTexture3D(Le,0):Le.isDataArrayTexture||Le.isCompressedArrayTexture?ve.setTexture2DArray(Le,0):ve.setTexture2D(Le,0),Be.unbindTexture()},this.resetState=function(){G=0,q=0,X=null,Be.reset(),Ge.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return sd}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const a=this.getContext();a.drawingBufferColorSpace=e===xT?"display-p3":"srgb",a.unpackColorSpace=Oi.workingColorSpace===Mw?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===To?up:FD}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===up?To:gd}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class UZ extends $D{}UZ.prototype.isWebGL1Renderer=!0;class TT{constructor(e,a=25e-5){this.isFogExp2=!0,this.name="",this.color=new Pn(e),this.density=a}clone(){return new TT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class CT{constructor(e,a=1,o=1e3){this.isFog=!0,this.name="",this.color=new Pn(e),this.near=a,this.far=o}clone(){return new CT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class GE extends fi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,a){return super.copy(e,a),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const a=super.toJSON(e);return this.fog!==null&&(a.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(a.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(a.object.backgroundIntensity=this.backgroundIntensity),a}}class PT{constructor(e,a){this.isInterleavedBuffer=!0,this.array=e,this.stride=a,this.count=e!==void 0?e.length/a:0,this.usage=Vx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=$l()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,a,o){e*=this.stride,o*=a.stride;for(let s=0,c=this.stride;s<c;s++)this.array[e+s]=a.array[o+s];return this}set(e,a=0){return this.array.set(e,a),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$l()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const a=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),o=new this.constructor(a,this.stride);return o.setUsage(this.usage),o}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=$l()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Os=new Fe;class Rg{constructor(e,a,o,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=a,this.offset=o,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let a=0,o=this.data.count;a<o;a++)Os.fromBufferAttribute(this,a),Os.applyMatrix4(e),this.setXYZ(a,Os.x,Os.y,Os.z);return this}applyNormalMatrix(e){for(let a=0,o=this.count;a<o;a++)Os.fromBufferAttribute(this,a),Os.applyNormalMatrix(e),this.setXYZ(a,Os.x,Os.y,Os.z);return this}transformDirection(e){for(let a=0,o=this.count;a<o;a++)Os.fromBufferAttribute(this,a),Os.transformDirection(e),this.setXYZ(a,Os.x,Os.y,Os.z);return this}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset]=a,this}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+1]=a,this}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+2]=a,this}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+3]=a,this}getX(e){let a=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(a=fl(a,this.array)),a}getY(e){let a=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(a=fl(a,this.array)),a}getZ(e){let a=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(a=fl(a,this.array)),a}getW(e){let a=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(a=fl(a,this.array)),a}setXY(e,a,o){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this}setXYZ(e,a,o,s){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this.data.array[e+2]=s,this}setXYZW(e,a,o,s,c){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this.data.array[e+2]=s,this.data.array[e+3]=c,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const a=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)a.push(this.data.array[s+c])}return new qi(new this.array.constructor(a),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Rg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const a=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)a.push(this.data.array[s+c])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class qD extends Ko{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Vv;const eb=new Fe,Gv=new Fe,Hv=new Fe,jv=new Kt,tb=new Kt,WZ=new Ia,ES=new Fe,nb=new Fe,MS=new Fe,CW=new Kt,C4=new Kt,PW=new Kt;class VZ extends fi{constructor(e=new qD){if(super(),this.isSprite=!0,this.type="Sprite",Vv===void 0){Vv=new La;const a=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new PT(a,5);Vv.setIndex([0,1,2,0,2,3]),Vv.setAttribute("position",new Rg(o,3,0,!1)),Vv.setAttribute("uv",new Rg(o,2,3,!1))}this.geometry=Vv,this.material=e,this.center=new Kt(.5,.5)}raycast(e,a){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Gv.setFromMatrixScale(this.matrixWorld),WZ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Hv.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Gv.multiplyScalar(-Hv.z);const o=this.material.rotation;let s,c;o!==0&&(c=Math.cos(o),s=Math.sin(o));const d=this.center;TS(ES.set(-.5,-.5,0),Hv,d,Gv,s,c),TS(nb.set(.5,-.5,0),Hv,d,Gv,s,c),TS(MS.set(.5,.5,0),Hv,d,Gv,s,c),CW.set(0,0),C4.set(1,0),PW.set(1,1);let f=e.ray.intersectTriangle(ES,nb,MS,!1,eb);if(f===null&&(TS(nb.set(-.5,.5,0),Hv,d,Gv,s,c),C4.set(0,1),f=e.ray.intersectTriangle(ES,MS,nb,!1,eb),f===null))return;const m=e.ray.origin.distanceTo(eb);m<e.near||m>e.far||a.push({distance:m,point:eb.clone(),uv:dl.getInterpolation(eb,ES,nb,MS,CW,C4,PW,new Kt),face:null,object:this})}copy(e,a){return super.copy(e,a),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function TS(n,e,a,o,s,c){jv.subVectors(n,a).addScalar(.5).multiply(o),s!==void 0?(tb.x=c*jv.x-s*jv.y,tb.y=s*jv.x+c*jv.y):tb.copy(jv),n.copy(e),n.x+=tb.x,n.y+=tb.y,n.applyMatrix4(WZ)}const CS=new Fe,IW=new Fe;class GZ extends fi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const a=e.levels;for(let o=0,s=a.length;o<s;o++){const c=a[o];this.addLevel(c.object.clone(),c.distance,c.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,a=0,o=0){a=Math.abs(a);const s=this.levels;let c;for(c=0;c<s.length&&!(a<s[c].distance);c++);return s.splice(c,0,{distance:a,hysteresis:o,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const a=this.levels;if(a.length>0){let o,s;for(o=1,s=a.length;o<s;o++){let c=a[o].distance;if(a[o].object.visible&&(c-=c*a[o].hysteresis),e<c)break}return a[o-1].object}return null}raycast(e,a){if(this.levels.length>0){CS.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(CS);this.getObjectForDistance(s).raycast(e,a)}}update(e){const a=this.levels;if(a.length>1){CS.setFromMatrixPosition(e.matrixWorld),IW.setFromMatrixPosition(this.matrixWorld);const o=CS.distanceTo(IW)/e.zoom;a[0].object.visible=!0;let s,c;for(s=1,c=a.length;s<c;s++){let d=a[s].distance;if(a[s].object.visible&&(d-=d*a[s].hysteresis),o>=d)a[s-1].object.visible=!1,a[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<c;s++)a[s].object.visible=!1}}toJSON(e){const a=super.toJSON(e);this.autoUpdate===!1&&(a.object.autoUpdate=!1),a.object.levels=[];const o=this.levels;for(let s=0,c=o.length;s<c;s++){const d=o[s];a.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return a}}const LW=new Fe,RW=new Ai,kW=new Ai,bwe=new Fe,DW=new Ia,PS=new Fe,P4=new Tc,OW=new Ia,I4=new Wg;class HZ extends bo{constructor(e,a){super(e,a),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=zL,this.bindMatrix=new Ia,this.bindMatrixInverse=new Ia,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new pu),this.boundingBox.makeEmpty();const a=e.getAttribute("position");for(let o=0;o<a.count;o++)this.getVertexPosition(o,PS),this.boundingBox.expandByPoint(PS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Tc),this.boundingSphere.makeEmpty();const a=e.getAttribute("position");for(let o=0;o<a.count;o++)this.getVertexPosition(o,PS),this.boundingSphere.expandByPoint(PS)}copy(e,a){return super.copy(e,a),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,a){const o=this.material,s=this.matrixWorld;o!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),P4.copy(this.boundingSphere),P4.applyMatrix4(s),e.ray.intersectsSphere(P4)!==!1&&(OW.copy(s).invert(),I4.copy(e.ray).applyMatrix4(OW),!(this.boundingBox!==null&&I4.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,a,I4)))}getVertexPosition(e,a){return super.getVertexPosition(e,a),this.applyBoneTransform(e,a),a}bind(e,a){this.skeleton=e,a===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.copy(a).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ai,a=this.geometry.attributes.skinWeight;for(let o=0,s=a.count;o<s;o++){e.fromBufferAttribute(a,o);const c=1/e.manhattanLength();c!==1/0?e.multiplyScalar(c):e.set(1,0,0,0),a.setXYZW(o,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===zL?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===tZ?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,a){const o=this.skeleton,s=this.geometry;RW.fromBufferAttribute(s.attributes.skinIndex,e),kW.fromBufferAttribute(s.attributes.skinWeight,e),LW.copy(a).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let c=0;c<4;c++){const d=kW.getComponent(c);if(d!==0){const f=RW.getComponent(c);DW.multiplyMatrices(o.bones[f].matrixWorld,o.boneInverses[f]),a.addScaledVector(bwe.copy(LW).applyMatrix4(DW),d)}}return a.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,a){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,a)}}class XD extends fi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class k0 extends Lr{constructor(e=null,a=1,o=1,s,c,d,f,m,y=ro,_=ro,w,A){super(null,d,f,m,y,_,s,c,w,A),this.isDataTexture=!0,this.image={data:e,width:a,height:o},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const zW=new Ia,xwe=new Ia;class IT{constructor(e=[],a=[]){this.uuid=$l(),this.bones=e.slice(0),this.boneInverses=a,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,a=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),a.length===0)this.calculateInverses();else if(e.length!==a.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let o=0,s=this.bones.length;o<s;o++)this.boneInverses.push(new Ia)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,a=this.bones.length;e<a;e++){const o=new Ia;this.bones[e]&&o.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(o)}}pose(){for(let e=0,a=this.bones.length;e<a;e++){const o=this.bones[e];o&&o.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,a=this.bones.length;e<a;e++){const o=this.bones[e];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}update(){const e=this.bones,a=this.boneInverses,o=this.boneMatrices,s=this.boneTexture;for(let c=0,d=e.length;c<d;c++){const f=e[c]?e[c].matrixWorld:xwe;zW.multiplyMatrices(f,a[c]),zW.toArray(o,c*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new IT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=AZ(e),e=Math.max(e,4);const a=new Float32Array(e*e*4);a.set(this.boneMatrices);const o=new k0(a,e,e,hl,od);return o.needsUpdate=!0,this.boneMatrices=a,this.boneTexture=o,this.boneTextureSize=e,this}getBoneByName(e){for(let a=0,o=this.bones.length;a<o;a++){const s=this.bones[a];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,a){this.uuid=e.uuid;for(let o=0,s=e.bones.length;o<s;o++){const c=e.bones[o];let d=a[c];d===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",c),d=new XD),this.bones.push(d),this.boneInverses.push(new Ia().fromArray(e.boneInverses[o]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const a=this.bones,o=this.boneInverses;for(let s=0,c=a.length;s<c;s++){const d=a[s];e.bones.push(d.uuid);const f=o[s];e.boneInverses.push(f.toArray())}return e}}class kg extends qi{constructor(e,a,o,s=1){super(e,a,o),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const $v=new Ia,FW=new Ia,IS=[],NW=new pu,wwe=new Ia,ab=new bo,ib=new Tc;class jZ extends bo{constructor(e,a,o){super(e,a),this.isInstancedMesh=!0,this.instanceMatrix=new kg(new Float32Array(o*16),16),this.instanceColor=null,this.count=o,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<o;s++)this.setMatrixAt(s,wwe)}computeBoundingBox(){const e=this.geometry,a=this.count;this.boundingBox===null&&(this.boundingBox=new pu),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let o=0;o<a;o++)this.getMatrixAt(o,$v),NW.copy(e.boundingBox).applyMatrix4($v),this.boundingBox.union(NW)}computeBoundingSphere(){const e=this.geometry,a=this.count;this.boundingSphere===null&&(this.boundingSphere=new Tc),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let o=0;o<a;o++)this.getMatrixAt(o,$v),ib.copy(e.boundingSphere).applyMatrix4($v),this.boundingSphere.union(ib)}copy(e,a){return super.copy(e,a),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,a){a.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,a){a.fromArray(this.instanceMatrix.array,e*16)}raycast(e,a){const o=this.matrixWorld,s=this.count;if(ab.geometry=this.geometry,ab.material=this.material,ab.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),ib.copy(this.boundingSphere),ib.applyMatrix4(o),e.ray.intersectsSphere(ib)!==!1))for(let c=0;c<s;c++){this.getMatrixAt(c,$v),FW.multiplyMatrices(o,$v),ab.matrixWorld=FW,ab.raycast(e,IS);for(let d=0,f=IS.length;d<f;d++){const m=IS[d];m.instanceId=c,m.object=this,a.push(m)}IS.length=0}}setColorAt(e,a){this.instanceColor===null&&(this.instanceColor=new kg(new Float32Array(this.instanceMatrix.count*3),3)),a.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,a){a.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class js extends Ko{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const BW=new Fe,UW=new Fe,WW=new Ia,L4=new Wg,LS=new Tc;let _p=class extends fi{constructor(e=new La,a=new js){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const a=e.attributes.position,o=[0];for(let s=1,c=a.count;s<c;s++)BW.fromBufferAttribute(a,s-1),UW.fromBufferAttribute(a,s),o[s]=o[s-1],o[s]+=BW.distanceTo(UW);e.setAttribute("lineDistance",new Wn(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,a){const o=this.geometry,s=this.matrixWorld,c=e.params.Line.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),LS.copy(o.boundingSphere),LS.applyMatrix4(s),LS.radius+=c,e.ray.intersectsSphere(LS)===!1)return;WW.copy(s).invert(),L4.copy(e.ray).applyMatrix4(WW);const f=c/((this.scale.x+this.scale.y+this.scale.z)/3),m=f*f,y=new Fe,_=new Fe,w=new Fe,A=new Fe,C=this.isLineSegments?2:1,I=o.index,D=o.attributes.position;if(I!==null){const L=Math.max(0,d.start),O=Math.min(I.count,d.start+d.count);for(let F=L,B=O-1;F<B;F+=C){const G=I.getX(F),q=I.getX(F+1);if(y.fromBufferAttribute(D,G),_.fromBufferAttribute(D,q),L4.distanceSqToSegment(y,_,A,w)>m)continue;A.applyMatrix4(this.matrixWorld);const ee=e.ray.origin.distanceTo(A);ee<e.near||ee>e.far||a.push({distance:ee,point:w.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}else{const L=Math.max(0,d.start),O=Math.min(D.count,d.start+d.count);for(let F=L,B=O-1;F<B;F+=C){if(y.fromBufferAttribute(D,F),_.fromBufferAttribute(D,F+1),L4.distanceSqToSegment(y,_,A,w)>m)continue;A.applyMatrix4(this.matrixWorld);const q=e.ray.origin.distanceTo(A);q<e.near||q>e.far||a.push({distance:q,point:w.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}};const VW=new Fe,GW=new Fe;class bd extends _p{constructor(e,a){super(e,a),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const a=e.attributes.position,o=[];for(let s=0,c=a.count;s<c;s+=2)VW.fromBufferAttribute(a,s),GW.fromBufferAttribute(a,s+1),o[s]=s===0?0:o[s-1],o[s+1]=o[s]+VW.distanceTo(GW);e.setAttribute("lineDistance",new Wn(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class $Z extends _p{constructor(e,a){super(e,a),this.isLineLoop=!0,this.type="LineLoop"}}class ZD extends Ko{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const HW=new Ia,fR=new Wg,RS=new Tc,kS=new Fe;class qZ extends fi{constructor(e=new La,a=new ZD){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,a){const o=this.geometry,s=this.matrixWorld,c=e.params.Points.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),RS.copy(o.boundingSphere),RS.applyMatrix4(s),RS.radius+=c,e.ray.intersectsSphere(RS)===!1)return;HW.copy(s).invert(),fR.copy(e.ray).applyMatrix4(HW);const f=c/((this.scale.x+this.scale.y+this.scale.z)/3),m=f*f,y=o.index,w=o.attributes.position;if(y!==null){const A=Math.max(0,d.start),C=Math.min(y.count,d.start+d.count);for(let I=A,k=C;I<k;I++){const D=y.getX(I);kS.fromBufferAttribute(w,D),jW(kS,D,m,s,e,a,this)}}else{const A=Math.max(0,d.start),C=Math.min(w.count,d.start+d.count);for(let I=A,k=C;I<k;I++)kS.fromBufferAttribute(w,I),jW(kS,I,m,s,e,a,this)}}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}}function jW(n,e,a,o,s,c,d){const f=fR.distanceSqToPoint(n);if(f<a){const m=new Fe;fR.closestPointToPoint(n,m),m.applyMatrix4(o);const y=s.ray.origin.distanceTo(m);if(y<s.near||y>s.far)return;c.push({distance:y,distanceToRay:Math.sqrt(f),point:m,index:e,face:null,object:d})}}class Swe extends Lr{constructor(e,a,o,s,c,d,f,m,y){super(e,a,o,s,c,d,f,m,y),this.isVideoTexture=!0,this.minFilter=d!==void 0?d:Cr,this.magFilter=c!==void 0?c:Cr,this.generateMipmaps=!1;const _=this;function w(){_.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Awe extends Lr{constructor(e,a){super({width:e,height:a}),this.isFramebufferTexture=!0,this.magFilter=ro,this.minFilter=ro,this.generateMipmaps=!1,this.needsUpdate=!0}}class LT extends Lr{constructor(e,a,o,s,c,d,f,m,y,_,w,A){super(null,d,f,m,y,_,s,c,w,A),this.isCompressedTexture=!0,this.image={width:a,height:o},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Ewe extends LT{constructor(e,a,o,s,c,d){super(e,a,o,c,d),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=ms}}class Mwe extends LT{constructor(e,a,o){super(void 0,e[0].width,e[0].height,a,o,Fh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Twe extends Lr{constructor(e,a,o,s,c,d,f,m,y){super(e,a,o,s,c,d,f,m,y),this.isCanvasTexture=!0,this.needsUpdate=!0}}class mu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,a){const o=this.getUtoTmapping(e);return this.getPoint(o,a)}getPoints(e=5){const a=[];for(let o=0;o<=e;o++)a.push(this.getPoint(o/e));return a}getSpacedPoints(e=5){const a=[];for(let o=0;o<=e;o++)a.push(this.getPointAt(o/e));return a}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const a=[];let o,s=this.getPoint(0),c=0;a.push(0);for(let d=1;d<=e;d++)o=this.getPoint(d/e),c+=o.distanceTo(s),a.push(c),s=o;return this.cacheArcLengths=a,a}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,a){const o=this.getLengths();let s=0;const c=o.length;let d;a?d=a:d=e*o[c-1];let f=0,m=c-1,y;for(;f<=m;)if(s=Math.floor(f+(m-f)/2),y=o[s]-d,y<0)f=s+1;else if(y>0)m=s-1;else{m=s;break}if(s=m,o[s]===d)return s/(c-1);const _=o[s],A=o[s+1]-_,C=(d-_)/A;return(s+C)/(c-1)}getTangent(e,a){let s=e-1e-4,c=e+1e-4;s<0&&(s=0),c>1&&(c=1);const d=this.getPoint(s),f=this.getPoint(c),m=a||(d.isVector2?new Kt:new Fe);return m.copy(f).sub(d).normalize(),m}getTangentAt(e,a){const o=this.getUtoTmapping(e);return this.getTangent(o,a)}computeFrenetFrames(e,a){const o=new Fe,s=[],c=[],d=[],f=new Fe,m=new Ia;for(let C=0;C<=e;C++){const I=C/e;s[C]=this.getTangentAt(I,new Fe)}c[0]=new Fe,d[0]=new Fe;let y=Number.MAX_VALUE;const _=Math.abs(s[0].x),w=Math.abs(s[0].y),A=Math.abs(s[0].z);_<=y&&(y=_,o.set(1,0,0)),w<=y&&(y=w,o.set(0,1,0)),A<=y&&o.set(0,0,1),f.crossVectors(s[0],o).normalize(),c[0].crossVectors(s[0],f),d[0].crossVectors(s[0],c[0]);for(let C=1;C<=e;C++){if(c[C]=c[C-1].clone(),d[C]=d[C-1].clone(),f.crossVectors(s[C-1],s[C]),f.length()>Number.EPSILON){f.normalize();const I=Math.acos(Hr(s[C-1].dot(s[C]),-1,1));c[C].applyMatrix4(m.makeRotationAxis(f,I))}d[C].crossVectors(s[C],c[C])}if(a===!0){let C=Math.acos(Hr(c[0].dot(c[e]),-1,1));C/=e,s[0].dot(f.crossVectors(c[0],c[e]))>0&&(C=-C);for(let I=1;I<=e;I++)c[I].applyMatrix4(m.makeRotationAxis(s[I],C*I)),d[I].crossVectors(s[I],c[I])}return{tangents:s,normals:c,binormals:d}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class RT extends mu{constructor(e=0,a=0,o=1,s=1,c=0,d=Math.PI*2,f=!1,m=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=a,this.xRadius=o,this.yRadius=s,this.aStartAngle=c,this.aEndAngle=d,this.aClockwise=f,this.aRotation=m}getPoint(e,a){const o=a||new Kt,s=Math.PI*2;let c=this.aEndAngle-this.aStartAngle;const d=Math.abs(c)<Number.EPSILON;for(;c<0;)c+=s;for(;c>s;)c-=s;c<Number.EPSILON&&(d?c=0:c=s),this.aClockwise===!0&&!d&&(c===s?c=-s:c=c-s);const f=this.aStartAngle+e*c;let m=this.aX+this.xRadius*Math.cos(f),y=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const _=Math.cos(this.aRotation),w=Math.sin(this.aRotation),A=m-this.aX,C=y-this.aY;m=A*_-C*w+this.aX,y=A*w+C*_+this.aY}return o.set(m,y)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class XZ extends RT{constructor(e,a,o,s,c,d){super(e,a,o,o,s,c,d),this.isArcCurve=!0,this.type="ArcCurve"}}function YD(){let n=0,e=0,a=0,o=0;function s(c,d,f,m){n=c,e=f,a=-3*c+3*d-2*f-m,o=2*c-2*d+f+m}return{initCatmullRom:function(c,d,f,m,y){s(d,f,y*(f-c),y*(m-d))},initNonuniformCatmullRom:function(c,d,f,m,y,_,w){let A=(d-c)/y-(f-c)/(y+_)+(f-d)/_,C=(f-d)/_-(m-d)/(_+w)+(m-f)/w;A*=_,C*=_,s(d,f,A,C)},calc:function(c){const d=c*c,f=d*c;return n+e*c+a*d+o*f}}}const DS=new Fe,R4=new YD,k4=new YD,D4=new YD;class ZZ extends mu{constructor(e=[],a=!1,o="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=a,this.curveType=o,this.tension=s}getPoint(e,a=new Fe){const o=a,s=this.points,c=s.length,d=(c-(this.closed?0:1))*e;let f=Math.floor(d),m=d-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/c)+1)*c:m===0&&f===c-1&&(f=c-2,m=1);let y,_;this.closed||f>0?y=s[(f-1)%c]:(DS.subVectors(s[0],s[1]).add(s[0]),y=DS);const w=s[f%c],A=s[(f+1)%c];if(this.closed||f+2<c?_=s[(f+2)%c]:(DS.subVectors(s[c-1],s[c-2]).add(s[c-1]),_=DS),this.curveType==="centripetal"||this.curveType==="chordal"){const C=this.curveType==="chordal"?.5:.25;let I=Math.pow(y.distanceToSquared(w),C),k=Math.pow(w.distanceToSquared(A),C),D=Math.pow(A.distanceToSquared(_),C);k<1e-4&&(k=1),I<1e-4&&(I=k),D<1e-4&&(D=k),R4.initNonuniformCatmullRom(y.x,w.x,A.x,_.x,I,k,D),k4.initNonuniformCatmullRom(y.y,w.y,A.y,_.y,I,k,D),D4.initNonuniformCatmullRom(y.z,w.z,A.z,_.z,I,k,D)}else this.curveType==="catmullrom"&&(R4.initCatmullRom(y.x,w.x,A.x,_.x,this.tension),k4.initCatmullRom(y.y,w.y,A.y,_.y,this.tension),D4.initCatmullRom(y.z,w.z,A.z,_.z,this.tension));return o.set(R4.calc(m),k4.calc(m),D4.calc(m)),o}copy(e){super.copy(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let a=0,o=this.points.length;a<o;a++){const s=this.points[a];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(new Fe().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $W(n,e,a,o,s){const c=(o-e)*.5,d=(s-a)*.5,f=n*n,m=n*f;return(2*a-2*o+c+d)*m+(-3*a+3*o-2*c-d)*f+c*n+a}function Cwe(n,e){const a=1-n;return a*a*e}function Pwe(n,e){return 2*(1-n)*n*e}function Iwe(n,e){return n*n*e}function Yb(n,e,a,o){return Cwe(n,e)+Pwe(n,a)+Iwe(n,o)}function Lwe(n,e){const a=1-n;return a*a*a*e}function Rwe(n,e){const a=1-n;return 3*a*a*n*e}function kwe(n,e){return 3*(1-n)*n*n*e}function Dwe(n,e){return n*n*n*e}function Kb(n,e,a,o,s){return Lwe(n,e)+Rwe(n,a)+kwe(n,o)+Dwe(n,s)}class KD extends mu{constructor(e=new Kt,a=new Kt,o=new Kt,s=new Kt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=a,this.v2=o,this.v3=s}getPoint(e,a=new Kt){const o=a,s=this.v0,c=this.v1,d=this.v2,f=this.v3;return o.set(Kb(e,s.x,c.x,d.x,f.x),Kb(e,s.y,c.y,d.y,f.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class YZ extends mu{constructor(e=new Fe,a=new Fe,o=new Fe,s=new Fe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=a,this.v2=o,this.v3=s}getPoint(e,a=new Fe){const o=a,s=this.v0,c=this.v1,d=this.v2,f=this.v3;return o.set(Kb(e,s.x,c.x,d.x,f.x),Kb(e,s.y,c.y,d.y,f.y),Kb(e,s.z,c.z,d.z,f.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class JD extends mu{constructor(e=new Kt,a=new Kt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=a}getPoint(e,a=new Kt){const o=a;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,a){return this.getPoint(e,a)}getTangent(e,a=new Kt){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,a){return this.getTangent(e,a)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class KZ extends mu{constructor(e=new Fe,a=new Fe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=a}getPoint(e,a=new Fe){const o=a;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,a){return this.getPoint(e,a)}getTangent(e,a=new Fe){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,a){return this.getTangent(e,a)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QD extends mu{constructor(e=new Kt,a=new Kt,o=new Kt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=a,this.v2=o}getPoint(e,a=new Kt){const o=a,s=this.v0,c=this.v1,d=this.v2;return o.set(Yb(e,s.x,c.x,d.x),Yb(e,s.y,c.y,d.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class e6 extends mu{constructor(e=new Fe,a=new Fe,o=new Fe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=a,this.v2=o}getPoint(e,a=new Fe){const o=a,s=this.v0,c=this.v1,d=this.v2;return o.set(Yb(e,s.x,c.x,d.x),Yb(e,s.y,c.y,d.y),Yb(e,s.z,c.z,d.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class t6 extends mu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,a=new Kt){const o=a,s=this.points,c=(s.length-1)*e,d=Math.floor(c),f=c-d,m=s[d===0?d:d-1],y=s[d],_=s[d>s.length-2?s.length-1:d+1],w=s[d>s.length-3?s.length-1:d+2];return o.set($W(f,m.x,y.x,_.x,w.x),$W(f,m.y,y.y,_.y,w.y)),o}copy(e){super.copy(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let a=0,o=this.points.length;a<o;a++){const s=this.points[a];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(new Kt().fromArray(s))}return this}}var HE=Object.freeze({__proto__:null,ArcCurve:XZ,CatmullRomCurve3:ZZ,CubicBezierCurve:KD,CubicBezierCurve3:YZ,EllipseCurve:RT,LineCurve:JD,LineCurve3:KZ,QuadraticBezierCurve:QD,QuadraticBezierCurve3:e6,SplineCurve:t6});class JZ extends mu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(a)){const o=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new HE[o](a,e))}return this}getPoint(e,a){const o=e*this.getLength(),s=this.getCurveLengths();let c=0;for(;c<s.length;){if(s[c]>=o){const d=s[c]-o,f=this.curves[c],m=f.getLength(),y=m===0?0:1-d/m;return f.getPointAt(y,a)}c++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let a=0;for(let o=0,s=this.curves.length;o<s;o++)a+=this.curves[o].getLength(),e.push(a);return this.cacheLengths=e,e}getSpacedPoints(e=40){const a=[];for(let o=0;o<=e;o++)a.push(this.getPoint(o/e));return this.autoClose&&a.push(a[0]),a}getPoints(e=12){const a=[];let o;for(let s=0,c=this.curves;s<c.length;s++){const d=c[s],f=d.isEllipseCurve?e*2:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?e*d.points.length:e,m=d.getPoints(f);for(let y=0;y<m.length;y++){const _=m[y];o&&o.equals(_)||(a.push(_),o=_)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}copy(e){super.copy(e),this.curves=[];for(let a=0,o=e.curves.length;a<o;a++){const s=e.curves[a];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let a=0,o=this.curves.length;a<o;a++){const s=this.curves[a];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let a=0,o=e.curves.length;a<o;a++){const s=e.curves[a];this.curves.push(new HE[s.type]().fromJSON(s))}return this}}class jx extends JZ{constructor(e){super(),this.type="Path",this.currentPoint=new Kt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let a=1,o=e.length;a<o;a++)this.lineTo(e[a].x,e[a].y);return this}moveTo(e,a){return this.currentPoint.set(e,a),this}lineTo(e,a){const o=new JD(this.currentPoint.clone(),new Kt(e,a));return this.curves.push(o),this.currentPoint.set(e,a),this}quadraticCurveTo(e,a,o,s){const c=new QD(this.currentPoint.clone(),new Kt(e,a),new Kt(o,s));return this.curves.push(c),this.currentPoint.set(o,s),this}bezierCurveTo(e,a,o,s,c,d){const f=new KD(this.currentPoint.clone(),new Kt(e,a),new Kt(o,s),new Kt(c,d));return this.curves.push(f),this.currentPoint.set(c,d),this}splineThru(e){const a=[this.currentPoint.clone()].concat(e),o=new t6(a);return this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this}arc(e,a,o,s,c,d){const f=this.currentPoint.x,m=this.currentPoint.y;return this.absarc(e+f,a+m,o,s,c,d),this}absarc(e,a,o,s,c,d){return this.absellipse(e,a,o,o,s,c,d),this}ellipse(e,a,o,s,c,d,f,m){const y=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+y,a+_,o,s,c,d,f,m),this}absellipse(e,a,o,s,c,d,f,m){const y=new RT(e,a,o,s,c,d,f,m);if(this.curves.length>0){const w=y.getPoint(0);w.equals(this.currentPoint)||this.lineTo(w.x,w.y)}this.curves.push(y);const _=y.getPoint(1);return this.currentPoint.copy(_),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Iw extends La{constructor(e=[new Kt(0,-.5),new Kt(.5,0),new Kt(0,.5)],a=12,o=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:a,phiStart:o,phiLength:s},a=Math.floor(a),s=Hr(s,0,Math.PI*2);const c=[],d=[],f=[],m=[],y=[],_=1/a,w=new Fe,A=new Kt,C=new Fe,I=new Fe,k=new Fe;let D=0,L=0;for(let O=0;O<=e.length-1;O++)switch(O){case 0:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,C.x=L*1,C.y=-D,C.z=L*0,k.copy(C),C.normalize(),m.push(C.x,C.y,C.z);break;case e.length-1:m.push(k.x,k.y,k.z);break;default:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,C.x=L*1,C.y=-D,C.z=L*0,I.copy(C),C.x+=k.x,C.y+=k.y,C.z+=k.z,C.normalize(),m.push(C.x,C.y,C.z),k.copy(I)}for(let O=0;O<=a;O++){const F=o+O*_*s,B=Math.sin(F),G=Math.cos(F);for(let q=0;q<=e.length-1;q++){w.x=e[q].x*B,w.y=e[q].y,w.z=e[q].x*G,d.push(w.x,w.y,w.z),A.x=O/a,A.y=q/(e.length-1),f.push(A.x,A.y);const X=m[3*q+0]*B,ee=m[3*q+1],V=m[3*q+0]*G;y.push(X,ee,V)}}for(let O=0;O<a;O++)for(let F=0;F<e.length-1;F++){const B=F+O*e.length,G=B,q=B+e.length,X=B+e.length+1,ee=B+1;c.push(G,q,ee),c.push(X,ee,q)}this.setIndex(c),this.setAttribute("position",new Wn(d,3)),this.setAttribute("uv",new Wn(f,2)),this.setAttribute("normal",new Wn(y,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Iw(e.points,e.segments,e.phiStart,e.phiLength)}}class kT extends Iw{constructor(e=1,a=1,o=4,s=8){const c=new jx;c.absarc(0,-a/2,e,Math.PI*1.5,0),c.absarc(0,a/2,e,0,Math.PI*.5),super(c.getPoints(o),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:a,capSegments:o,radialSegments:s}}static fromJSON(e){return new kT(e.radius,e.length,e.capSegments,e.radialSegments)}}class DT extends La{constructor(e=1,a=32,o=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:a,thetaStart:o,thetaLength:s},a=Math.max(3,a);const c=[],d=[],f=[],m=[],y=new Fe,_=new Kt;d.push(0,0,0),f.push(0,0,1),m.push(.5,.5);for(let w=0,A=3;w<=a;w++,A+=3){const C=o+w/a*s;y.x=e*Math.cos(C),y.y=e*Math.sin(C),d.push(y.x,y.y,y.z),f.push(0,0,1),_.x=(d[A]/e+1)/2,_.y=(d[A+1]/e+1)/2,m.push(_.x,_.y)}for(let w=1;w<=a;w++)c.push(w,w+1,0);this.setIndex(c),this.setAttribute("position",new Wn(d,3)),this.setAttribute("normal",new Wn(f,3)),this.setAttribute("uv",new Wn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class h_ extends La{constructor(e=1,a=1,o=1,s=32,c=1,d=!1,f=0,m=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:a,height:o,radialSegments:s,heightSegments:c,openEnded:d,thetaStart:f,thetaLength:m};const y=this;s=Math.floor(s),c=Math.floor(c);const _=[],w=[],A=[],C=[];let I=0;const k=[],D=o/2;let L=0;O(),d===!1&&(e>0&&F(!0),a>0&&F(!1)),this.setIndex(_),this.setAttribute("position",new Wn(w,3)),this.setAttribute("normal",new Wn(A,3)),this.setAttribute("uv",new Wn(C,2));function O(){const B=new Fe,G=new Fe;let q=0;const X=(a-e)/o;for(let ee=0;ee<=c;ee++){const V=[],Q=ee/c,me=Q*(a-e)+e;for(let pe=0;pe<=s;pe++){const be=pe/s,fe=be*m+f,Ce=Math.sin(fe),Re=Math.cos(fe);G.x=me*Ce,G.y=-Q*o+D,G.z=me*Re,w.push(G.x,G.y,G.z),B.set(Ce,X,Re).normalize(),A.push(B.x,B.y,B.z),C.push(be,1-Q),V.push(I++)}k.push(V)}for(let ee=0;ee<s;ee++)for(let V=0;V<c;V++){const Q=k[V][ee],me=k[V+1][ee],pe=k[V+1][ee+1],be=k[V][ee+1];_.push(Q,me,be),_.push(me,pe,be),q+=6}y.addGroup(L,q,0),L+=q}function F(B){const G=I,q=new Kt,X=new Fe;let ee=0;const V=B===!0?e:a,Q=B===!0?1:-1;for(let pe=1;pe<=s;pe++)w.push(0,D*Q,0),A.push(0,Q,0),C.push(.5,.5),I++;const me=I;for(let pe=0;pe<=s;pe++){const fe=pe/s*m+f,Ce=Math.cos(fe),Re=Math.sin(fe);X.x=V*Re,X.y=D*Q,X.z=V*Ce,w.push(X.x,X.y,X.z),A.push(0,Q,0),q.x=Ce*.5+.5,q.y=Re*.5*Q+.5,C.push(q.x,q.y),I++}for(let pe=0;pe<s;pe++){const be=G+pe,fe=me+pe;B===!0?_.push(fe,fe+1,be):_.push(fe+1,fe,be),ee+=3}y.addGroup(L,ee,B===!0?1:2),L+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new h_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class OT extends h_{constructor(e=1,a=1,o=32,s=1,c=!1,d=0,f=Math.PI*2){super(0,e,a,o,s,c,d,f),this.type="ConeGeometry",this.parameters={radius:e,height:a,radialSegments:o,heightSegments:s,openEnded:c,thetaStart:d,thetaLength:f}}static fromJSON(e){return new OT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Tp extends La{constructor(e=[],a=[],o=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:a,radius:o,detail:s};const c=[],d=[];f(s),y(o),_(),this.setAttribute("position",new Wn(c,3)),this.setAttribute("normal",new Wn(c.slice(),3)),this.setAttribute("uv",new Wn(d,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function f(O){const F=new Fe,B=new Fe,G=new Fe;for(let q=0;q<a.length;q+=3)C(a[q+0],F),C(a[q+1],B),C(a[q+2],G),m(F,B,G,O)}function m(O,F,B,G){const q=G+1,X=[];for(let ee=0;ee<=q;ee++){X[ee]=[];const V=O.clone().lerp(B,ee/q),Q=F.clone().lerp(B,ee/q),me=q-ee;for(let pe=0;pe<=me;pe++)pe===0&&ee===q?X[ee][pe]=V:X[ee][pe]=V.clone().lerp(Q,pe/me)}for(let ee=0;ee<q;ee++)for(let V=0;V<2*(q-ee)-1;V++){const Q=Math.floor(V/2);V%2===0?(A(X[ee][Q+1]),A(X[ee+1][Q]),A(X[ee][Q])):(A(X[ee][Q+1]),A(X[ee+1][Q+1]),A(X[ee+1][Q]))}}function y(O){const F=new Fe;for(let B=0;B<c.length;B+=3)F.x=c[B+0],F.y=c[B+1],F.z=c[B+2],F.normalize().multiplyScalar(O),c[B+0]=F.x,c[B+1]=F.y,c[B+2]=F.z}function _(){const O=new Fe;for(let F=0;F<c.length;F+=3){O.x=c[F+0],O.y=c[F+1],O.z=c[F+2];const B=D(O)/2/Math.PI+.5,G=L(O)/Math.PI+.5;d.push(B,1-G)}I(),w()}function w(){for(let O=0;O<d.length;O+=6){const F=d[O+0],B=d[O+2],G=d[O+4],q=Math.max(F,B,G),X=Math.min(F,B,G);q>.9&&X<.1&&(F<.2&&(d[O+0]+=1),B<.2&&(d[O+2]+=1),G<.2&&(d[O+4]+=1))}}function A(O){c.push(O.x,O.y,O.z)}function C(O,F){const B=O*3;F.x=e[B+0],F.y=e[B+1],F.z=e[B+2]}function I(){const O=new Fe,F=new Fe,B=new Fe,G=new Fe,q=new Kt,X=new Kt,ee=new Kt;for(let V=0,Q=0;V<c.length;V+=9,Q+=6){O.set(c[V+0],c[V+1],c[V+2]),F.set(c[V+3],c[V+4],c[V+5]),B.set(c[V+6],c[V+7],c[V+8]),q.set(d[Q+0],d[Q+1]),X.set(d[Q+2],d[Q+3]),ee.set(d[Q+4],d[Q+5]),G.copy(O).add(F).add(B).divideScalar(3);const me=D(G);k(q,Q+0,O,me),k(X,Q+2,F,me),k(ee,Q+4,B,me)}}function k(O,F,B,G){G<0&&O.x===1&&(d[F]=O.x-1),B.x===0&&B.z===0&&(d[F]=G/2/Math.PI+.5)}function D(O){return Math.atan2(O.z,-O.x)}function L(O){return Math.atan2(-O.y,Math.sqrt(O.x*O.x+O.z*O.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tp(e.vertices,e.indices,e.radius,e.details)}}class zT extends Tp{constructor(e=1,a=0){const o=(1+Math.sqrt(5))/2,s=1/o,c=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-o,0,-s,o,0,s,-o,0,s,o,-s,-o,0,-s,o,0,s,-o,0,s,o,0,-o,0,-s,o,0,-s,-o,0,s,o,0,s],d=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(c,d,e,a),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new zT(e.radius,e.detail)}}const OS=new Fe,zS=new Fe,O4=new Fe,FS=new dl;class QZ extends La{constructor(e=null,a=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:a},e!==null){const s=Math.pow(10,4),c=Math.cos(vg*a),d=e.getIndex(),f=e.getAttribute("position"),m=d?d.count:f.count,y=[0,0,0],_=["a","b","c"],w=new Array(3),A={},C=[];for(let I=0;I<m;I+=3){d?(y[0]=d.getX(I),y[1]=d.getX(I+1),y[2]=d.getX(I+2)):(y[0]=I,y[1]=I+1,y[2]=I+2);const{a:k,b:D,c:L}=FS;if(k.fromBufferAttribute(f,y[0]),D.fromBufferAttribute(f,y[1]),L.fromBufferAttribute(f,y[2]),FS.getNormal(O4),w[0]=`${Math.round(k.x*s)},${Math.round(k.y*s)},${Math.round(k.z*s)}`,w[1]=`${Math.round(D.x*s)},${Math.round(D.y*s)},${Math.round(D.z*s)}`,w[2]=`${Math.round(L.x*s)},${Math.round(L.y*s)},${Math.round(L.z*s)}`,!(w[0]===w[1]||w[1]===w[2]||w[2]===w[0]))for(let O=0;O<3;O++){const F=(O+1)%3,B=w[O],G=w[F],q=FS[_[O]],X=FS[_[F]],ee=`${B}_${G}`,V=`${G}_${B}`;V in A&&A[V]?(O4.dot(A[V].normal)<=c&&(C.push(q.x,q.y,q.z),C.push(X.x,X.y,X.z)),A[V]=null):ee in A||(A[ee]={index0:y[O],index1:y[F],normal:O4.clone()})}}for(const I in A)if(A[I]){const{index0:k,index1:D}=A[I];OS.fromBufferAttribute(f,k),zS.fromBufferAttribute(f,D),C.push(OS.x,OS.y,OS.z),C.push(zS.x,zS.y,zS.z)}this.setAttribute("position",new Wn(C,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class bg extends jx{constructor(e){super(e),this.uuid=$l(),this.type="Shape",this.holes=[]}getPointsHoles(e){const a=[];for(let o=0,s=this.holes.length;o<s;o++)a[o]=this.holes[o].getPoints(e);return a}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let a=0,o=e.holes.length;a<o;a++){const s=e.holes[a];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let a=0,o=this.holes.length;a<o;a++){const s=this.holes[a];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let a=0,o=e.holes.length;a<o;a++){const s=e.holes[a];this.holes.push(new jx().fromJSON(s))}return this}}const Owe={triangulate:function(n,e,a=2){const o=e&&e.length,s=o?e[0]*a:n.length;let c=eY(n,0,s,a,!0);const d=[];if(!c||c.next===c.prev)return d;let f,m,y,_,w,A,C;if(o&&(c=Uwe(n,e,c,a)),n.length>80*a){f=y=n[0],m=_=n[1];for(let I=a;I<s;I+=a)w=n[I],A=n[I+1],w<f&&(f=w),A<m&&(m=A),w>y&&(y=w),A>_&&(_=A);C=Math.max(y-f,_-m),C=C!==0?32767/C:0}return $x(c,d,a,f,m,C,0),d}};function eY(n,e,a,o,s){let c,d;if(s===Kwe(n,e,a,o)>0)for(c=e;c<a;c+=o)d=qW(c,n[c],n[c+1],d);else for(c=a-o;c>=e;c-=o)d=qW(c,n[c],n[c+1],d);return d&&FT(d,d.next)&&(Xx(d),d=d.next),d}function Dg(n,e){if(!n)return n;e||(e=n);let a=n,o;do if(o=!1,!a.steiner&&(FT(a,a.next)||Pr(a.prev,a,a.next)===0)){if(Xx(a),a=e=a.prev,a===a.next)break;o=!0}else a=a.next;while(o||a!==e);return e}function $x(n,e,a,o,s,c,d){if(!n)return;!d&&c&&jwe(n,o,s,c);let f=n,m,y;for(;n.prev!==n.next;){if(m=n.prev,y=n.next,c?Fwe(n,o,s,c):zwe(n)){e.push(m.i/a|0),e.push(n.i/a|0),e.push(y.i/a|0),Xx(n),n=y.next,f=y.next;continue}if(n=y,n===f){d?d===1?(n=Nwe(Dg(n),e,a),$x(n,e,a,o,s,c,2)):d===2&&Bwe(n,e,a,o,s,c):$x(Dg(n),e,a,o,s,c,1);break}}}function zwe(n){const e=n.prev,a=n,o=n.next;if(Pr(e,a,o)>=0)return!1;const s=e.x,c=a.x,d=o.x,f=e.y,m=a.y,y=o.y,_=s<c?s<d?s:d:c<d?c:d,w=f<m?f<y?f:y:m<y?m:y,A=s>c?s>d?s:d:c>d?c:d,C=f>m?f>y?f:y:m>y?m:y;let I=o.next;for(;I!==e;){if(I.x>=_&&I.x<=A&&I.y>=w&&I.y<=C&&b0(s,f,c,m,d,y,I.x,I.y)&&Pr(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function Fwe(n,e,a,o){const s=n.prev,c=n,d=n.next;if(Pr(s,c,d)>=0)return!1;const f=s.x,m=c.x,y=d.x,_=s.y,w=c.y,A=d.y,C=f<m?f<y?f:y:m<y?m:y,I=_<w?_<A?_:A:w<A?w:A,k=f>m?f>y?f:y:m>y?m:y,D=_>w?_>A?_:A:w>A?w:A,L=pR(C,I,e,a,o),O=pR(k,D,e,a,o);let F=n.prevZ,B=n.nextZ;for(;F&&F.z>=L&&B&&B.z<=O;){if(F.x>=C&&F.x<=k&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&b0(f,_,m,w,y,A,F.x,F.y)&&Pr(F.prev,F,F.next)>=0||(F=F.prevZ,B.x>=C&&B.x<=k&&B.y>=I&&B.y<=D&&B!==s&&B!==d&&b0(f,_,m,w,y,A,B.x,B.y)&&Pr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;F&&F.z>=L;){if(F.x>=C&&F.x<=k&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&b0(f,_,m,w,y,A,F.x,F.y)&&Pr(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;B&&B.z<=O;){if(B.x>=C&&B.x<=k&&B.y>=I&&B.y<=D&&B!==s&&B!==d&&b0(f,_,m,w,y,A,B.x,B.y)&&Pr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function Nwe(n,e,a){let o=n;do{const s=o.prev,c=o.next.next;!FT(s,c)&&tY(s,o,o.next,c)&&qx(s,c)&&qx(c,s)&&(e.push(s.i/a|0),e.push(o.i/a|0),e.push(c.i/a|0),Xx(o),Xx(o.next),o=n=c),o=o.next}while(o!==n);return Dg(o)}function Bwe(n,e,a,o,s,c){let d=n;do{let f=d.next.next;for(;f!==d.prev;){if(d.i!==f.i&&Xwe(d,f)){let m=nY(d,f);d=Dg(d,d.next),m=Dg(m,m.next),$x(d,e,a,o,s,c,0),$x(m,e,a,o,s,c,0);return}f=f.next}d=d.next}while(d!==n)}function Uwe(n,e,a,o){const s=[];let c,d,f,m,y;for(c=0,d=e.length;c<d;c++)f=e[c]*o,m=c<d-1?e[c+1]*o:n.length,y=eY(n,f,m,o,!1),y===y.next&&(y.steiner=!0),s.push(qwe(y));for(s.sort(Wwe),c=0;c<s.length;c++)a=Vwe(s[c],a);return a}function Wwe(n,e){return n.x-e.x}function Vwe(n,e){const a=Gwe(n,e);if(!a)return e;const o=nY(a,n);return Dg(o,o.next),Dg(a,a.next)}function Gwe(n,e){let a=e,o=-1/0,s;const c=n.x,d=n.y;do{if(d<=a.y&&d>=a.next.y&&a.next.y!==a.y){const A=a.x+(d-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(A<=c&&A>o&&(o=A,s=a.x<a.next.x?a:a.next,A===c))return s}a=a.next}while(a!==e);if(!s)return null;const f=s,m=s.x,y=s.y;let _=1/0,w;a=s;do c>=a.x&&a.x>=m&&c!==a.x&&b0(d<y?c:o,d,m,y,d<y?o:c,d,a.x,a.y)&&(w=Math.abs(d-a.y)/(c-a.x),qx(a,n)&&(w<_||w===_&&(a.x>s.x||a.x===s.x&&Hwe(s,a)))&&(s=a,_=w)),a=a.next;while(a!==f);return s}function Hwe(n,e){return Pr(n.prev,n,e.prev)<0&&Pr(e.next,n,n.next)<0}function jwe(n,e,a,o){let s=n;do s.z===0&&(s.z=pR(s.x,s.y,e,a,o)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,$we(s)}function $we(n){let e,a,o,s,c,d,f,m,y=1;do{for(a=n,n=null,c=null,d=0;a;){for(d++,o=a,f=0,e=0;e<y&&(f++,o=o.nextZ,!!o);e++);for(m=y;f>0||m>0&&o;)f!==0&&(m===0||!o||a.z<=o.z)?(s=a,a=a.nextZ,f--):(s=o,o=o.nextZ,m--),c?c.nextZ=s:n=s,s.prevZ=c,c=s;a=o}c.nextZ=null,y*=2}while(d>1);return n}function pR(n,e,a,o,s){return n=(n-a)*s|0,e=(e-o)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function qwe(n){let e=n,a=n;do(e.x<a.x||e.x===a.x&&e.y<a.y)&&(a=e),e=e.next;while(e!==n);return a}function b0(n,e,a,o,s,c,d,f){return(s-d)*(e-f)>=(n-d)*(c-f)&&(n-d)*(o-f)>=(a-d)*(e-f)&&(a-d)*(c-f)>=(s-d)*(o-f)}function Xwe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Zwe(n,e)&&(qx(n,e)&&qx(e,n)&&Ywe(n,e)&&(Pr(n.prev,n,e.prev)||Pr(n,e.prev,e))||FT(n,e)&&Pr(n.prev,n,n.next)>0&&Pr(e.prev,e,e.next)>0)}function Pr(n,e,a){return(e.y-n.y)*(a.x-e.x)-(e.x-n.x)*(a.y-e.y)}function FT(n,e){return n.x===e.x&&n.y===e.y}function tY(n,e,a,o){const s=BS(Pr(n,e,a)),c=BS(Pr(n,e,o)),d=BS(Pr(a,o,n)),f=BS(Pr(a,o,e));return!!(s!==c&&d!==f||s===0&&NS(n,a,e)||c===0&&NS(n,o,e)||d===0&&NS(a,n,o)||f===0&&NS(a,e,o))}function NS(n,e,a){return e.x<=Math.max(n.x,a.x)&&e.x>=Math.min(n.x,a.x)&&e.y<=Math.max(n.y,a.y)&&e.y>=Math.min(n.y,a.y)}function BS(n){return n>0?1:n<0?-1:0}function Zwe(n,e){let a=n;do{if(a.i!==n.i&&a.next.i!==n.i&&a.i!==e.i&&a.next.i!==e.i&&tY(a,a.next,n,e))return!0;a=a.next}while(a!==n);return!1}function qx(n,e){return Pr(n.prev,n,n.next)<0?Pr(n,e,n.next)>=0&&Pr(n,n.prev,e)>=0:Pr(n,e,n.prev)<0||Pr(n,n.next,e)<0}function Ywe(n,e){let a=n,o=!1;const s=(n.x+e.x)/2,c=(n.y+e.y)/2;do a.y>c!=a.next.y>c&&a.next.y!==a.y&&s<(a.next.x-a.x)*(c-a.y)/(a.next.y-a.y)+a.x&&(o=!o),a=a.next;while(a!==n);return o}function nY(n,e){const a=new mR(n.i,n.x,n.y),o=new mR(e.i,e.x,e.y),s=n.next,c=e.prev;return n.next=e,e.prev=n,a.next=s,s.prev=a,o.next=a,a.prev=o,c.next=o,o.prev=c,o}function qW(n,e,a,o){const s=new mR(n,e,a);return o?(s.next=o.next,s.prev=o,o.next.prev=s,o.next=s):(s.prev=s,s.next=s),s}function Xx(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function mR(n,e,a){this.i=n,this.x=e,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Kwe(n,e,a,o){let s=0;for(let c=e,d=a-o;c<a;c+=o)s+=(n[d]-n[c])*(n[c+1]+n[d+1]),d=c;return s}class fd{static area(e){const a=e.length;let o=0;for(let s=a-1,c=0;c<a;s=c++)o+=e[s].x*e[c].y-e[c].x*e[s].y;return o*.5}static isClockWise(e){return fd.area(e)<0}static triangulateShape(e,a){const o=[],s=[],c=[];XW(e),ZW(o,e);let d=e.length;a.forEach(XW);for(let m=0;m<a.length;m++)s.push(d),d+=a[m].length,ZW(o,a[m]);const f=Owe.triangulate(o,s);for(let m=0;m<f.length;m+=3)c.push(f.slice(m,m+3));return c}}function XW(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function ZW(n,e){for(let a=0;a<e.length;a++)n.push(e[a].x),n.push(e[a].y)}class NT extends La{constructor(e=new bg([new Kt(.5,.5),new Kt(-.5,.5),new Kt(-.5,-.5),new Kt(.5,-.5)]),a={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:a},e=Array.isArray(e)?e:[e];const o=this,s=[],c=[];for(let f=0,m=e.length;f<m;f++){const y=e[f];d(y)}this.setAttribute("position",new Wn(s,3)),this.setAttribute("uv",new Wn(c,2)),this.computeVertexNormals();function d(f){const m=[],y=a.curveSegments!==void 0?a.curveSegments:12,_=a.steps!==void 0?a.steps:1,w=a.depth!==void 0?a.depth:1;let A=a.bevelEnabled!==void 0?a.bevelEnabled:!0,C=a.bevelThickness!==void 0?a.bevelThickness:.2,I=a.bevelSize!==void 0?a.bevelSize:C-.1,k=a.bevelOffset!==void 0?a.bevelOffset:0,D=a.bevelSegments!==void 0?a.bevelSegments:3;const L=a.extrudePath,O=a.UVGenerator!==void 0?a.UVGenerator:Jwe;let F,B=!1,G,q,X,ee;L&&(F=L.getSpacedPoints(_),B=!0,A=!1,G=L.computeFrenetFrames(_,!1),q=new Fe,X=new Fe,ee=new Fe),A||(D=0,C=0,I=0,k=0);const V=f.extractPoints(y);let Q=V.shape;const me=V.holes;if(!fd.isClockWise(Q)){Q=Q.reverse();for(let Pe=0,ft=me.length;Pe<ft;Pe++){const gt=me[Pe];fd.isClockWise(gt)&&(me[Pe]=gt.reverse())}}const be=fd.triangulateShape(Q,me),fe=Q;for(let Pe=0,ft=me.length;Pe<ft;Pe++){const gt=me[Pe];Q=Q.concat(gt)}function Ce(Pe,ft,gt){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().addScaledVector(ft,gt)}const Re=Q.length,He=be.length;function ue(Pe,ft,gt){let St,Be,le;const oe=Pe.x-ft.x,ve=Pe.y-ft.y,$e=gt.x-Pe.x,De=gt.y-Pe.y,ot=oe*oe+ve*ve,ce=oe*De-ve*$e;if(Math.abs(ce)>Number.EPSILON){const te=Math.sqrt(ot),Oe=Math.sqrt($e*$e+De*De),pt=ft.x-ve/te,it=ft.y+oe/te,st=gt.x-De/Oe,At=gt.y+$e/Oe,Ut=((st-pt)*De-(At-it)*$e)/(oe*De-ve*$e);St=pt+oe*Ut-Pe.x,Be=it+ve*Ut-Pe.y;const Vt=St*St+Be*Be;if(Vt<=2)return new Kt(St,Be);le=Math.sqrt(Vt/2)}else{let te=!1;oe>Number.EPSILON?$e>Number.EPSILON&&(te=!0):oe<-Number.EPSILON?$e<-Number.EPSILON&&(te=!0):Math.sign(ve)===Math.sign(De)&&(te=!0),te?(St=-ve,Be=oe,le=Math.sqrt(ot)):(St=oe,Be=ve,le=Math.sqrt(ot/2))}return new Kt(St/le,Be/le)}const ye=[];for(let Pe=0,ft=fe.length,gt=ft-1,St=Pe+1;Pe<ft;Pe++,gt++,St++)gt===ft&&(gt=0),St===ft&&(St=0),ye[Pe]=ue(fe[Pe],fe[gt],fe[St]);const Ae=[];let ne,Ee=ye.concat();for(let Pe=0,ft=me.length;Pe<ft;Pe++){const gt=me[Pe];ne=[];for(let St=0,Be=gt.length,le=Be-1,oe=St+1;St<Be;St++,le++,oe++)le===Be&&(le=0),oe===Be&&(oe=0),ne[St]=ue(gt[St],gt[le],gt[oe]);Ae.push(ne),Ee=Ee.concat(ne)}for(let Pe=0;Pe<D;Pe++){const ft=Pe/D,gt=C*Math.cos(ft*Math.PI/2),St=I*Math.sin(ft*Math.PI/2)+k;for(let Be=0,le=fe.length;Be<le;Be++){const oe=Ce(fe[Be],ye[Be],St);ht(oe.x,oe.y,-gt)}for(let Be=0,le=me.length;Be<le;Be++){const oe=me[Be];ne=Ae[Be];for(let ve=0,$e=oe.length;ve<$e;ve++){const De=Ce(oe[ve],ne[ve],St);ht(De.x,De.y,-gt)}}}const Ye=I+k;for(let Pe=0;Pe<Re;Pe++){const ft=A?Ce(Q[Pe],Ee[Pe],Ye):Q[Pe];B?(X.copy(G.normals[0]).multiplyScalar(ft.x),q.copy(G.binormals[0]).multiplyScalar(ft.y),ee.copy(F[0]).add(X).add(q),ht(ee.x,ee.y,ee.z)):ht(ft.x,ft.y,0)}for(let Pe=1;Pe<=_;Pe++)for(let ft=0;ft<Re;ft++){const gt=A?Ce(Q[ft],Ee[ft],Ye):Q[ft];B?(X.copy(G.normals[Pe]).multiplyScalar(gt.x),q.copy(G.binormals[Pe]).multiplyScalar(gt.y),ee.copy(F[Pe]).add(X).add(q),ht(ee.x,ee.y,ee.z)):ht(gt.x,gt.y,w/_*Pe)}for(let Pe=D-1;Pe>=0;Pe--){const ft=Pe/D,gt=C*Math.cos(ft*Math.PI/2),St=I*Math.sin(ft*Math.PI/2)+k;for(let Be=0,le=fe.length;Be<le;Be++){const oe=Ce(fe[Be],ye[Be],St);ht(oe.x,oe.y,w+gt)}for(let Be=0,le=me.length;Be<le;Be++){const oe=me[Be];ne=Ae[Be];for(let ve=0,$e=oe.length;ve<$e;ve++){const De=Ce(oe[ve],ne[ve],St);B?ht(De.x,De.y+F[_-1].y,F[_-1].x+gt):ht(De.x,De.y,w+gt)}}}Xe(),Ke();function Xe(){const Pe=s.length/3;if(A){let ft=0,gt=Re*ft;for(let St=0;St<He;St++){const Be=be[St];Lt(Be[2]+gt,Be[1]+gt,Be[0]+gt)}ft=_+D*2,gt=Re*ft;for(let St=0;St<He;St++){const Be=be[St];Lt(Be[0]+gt,Be[1]+gt,Be[2]+gt)}}else{for(let ft=0;ft<He;ft++){const gt=be[ft];Lt(gt[2],gt[1],gt[0])}for(let ft=0;ft<He;ft++){const gt=be[ft];Lt(gt[0]+Re*_,gt[1]+Re*_,gt[2]+Re*_)}}o.addGroup(Pe,s.length/3-Pe,0)}function Ke(){const Pe=s.length/3;let ft=0;Ue(fe,ft),ft+=fe.length;for(let gt=0,St=me.length;gt<St;gt++){const Be=me[gt];Ue(Be,ft),ft+=Be.length}o.addGroup(Pe,s.length/3-Pe,1)}function Ue(Pe,ft){let gt=Pe.length;for(;--gt>=0;){const St=gt;let Be=gt-1;Be<0&&(Be=Pe.length-1);for(let le=0,oe=_+D*2;le<oe;le++){const ve=Re*le,$e=Re*(le+1),De=ft+St+ve,ot=ft+Be+ve,ce=ft+Be+$e,te=ft+St+$e;Rt(De,ot,ce,te)}}}function ht(Pe,ft,gt){m.push(Pe),m.push(ft),m.push(gt)}function Lt(Pe,ft,gt){Jt(Pe),Jt(ft),Jt(gt);const St=s.length/3,Be=O.generateTopUV(o,s,St-3,St-2,St-1);Pt(Be[0]),Pt(Be[1]),Pt(Be[2])}function Rt(Pe,ft,gt,St){Jt(Pe),Jt(ft),Jt(St),Jt(ft),Jt(gt),Jt(St);const Be=s.length/3,le=O.generateSideWallUV(o,s,Be-6,Be-3,Be-2,Be-1);Pt(le[0]),Pt(le[1]),Pt(le[3]),Pt(le[1]),Pt(le[2]),Pt(le[3])}function Jt(Pe){s.push(m[Pe*3+0]),s.push(m[Pe*3+1]),s.push(m[Pe*3+2])}function Pt(Pe){c.push(Pe.x),c.push(Pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),a=this.parameters.shapes,o=this.parameters.options;return Qwe(a,o,e)}static fromJSON(e,a){const o=[];for(let c=0,d=e.shapes.length;c<d;c++){const f=a[e.shapes[c]];o.push(f)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new HE[s.type]().fromJSON(s)),new NT(o,e.options)}}const Jwe={generateTopUV:function(n,e,a,o,s){const c=e[a*3],d=e[a*3+1],f=e[o*3],m=e[o*3+1],y=e[s*3],_=e[s*3+1];return[new Kt(c,d),new Kt(f,m),new Kt(y,_)]},generateSideWallUV:function(n,e,a,o,s,c){const d=e[a*3],f=e[a*3+1],m=e[a*3+2],y=e[o*3],_=e[o*3+1],w=e[o*3+2],A=e[s*3],C=e[s*3+1],I=e[s*3+2],k=e[c*3],D=e[c*3+1],L=e[c*3+2];return Math.abs(f-_)<Math.abs(d-y)?[new Kt(d,1-m),new Kt(y,1-w),new Kt(A,1-I),new Kt(k,1-L)]:[new Kt(f,1-m),new Kt(_,1-w),new Kt(C,1-I),new Kt(D,1-L)]}};function Qwe(n,e,a){if(a.shapes=[],Array.isArray(n))for(let o=0,s=n.length;o<s;o++){const c=n[o];a.shapes.push(c.uuid)}else a.shapes.push(n.uuid);return a.options=Object.assign({},e),e.extrudePath!==void 0&&(a.options.extrudePath=e.extrudePath.toJSON()),a}class BT extends Tp{constructor(e=1,a=0){const o=(1+Math.sqrt(5))/2,s=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,c,e,a),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new BT(e.radius,e.detail)}}class Lw extends Tp{constructor(e=1,a=0){const o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(o,s,e,a),this.type="OctahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new Lw(e.radius,e.detail)}}class UT extends La{constructor(e=.5,a=1,o=32,s=1,c=0,d=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:a,thetaSegments:o,phiSegments:s,thetaStart:c,thetaLength:d},o=Math.max(3,o),s=Math.max(1,s);const f=[],m=[],y=[],_=[];let w=e;const A=(a-e)/s,C=new Fe,I=new Kt;for(let k=0;k<=s;k++){for(let D=0;D<=o;D++){const L=c+D/o*d;C.x=w*Math.cos(L),C.y=w*Math.sin(L),m.push(C.x,C.y,C.z),y.push(0,0,1),I.x=(C.x/a+1)/2,I.y=(C.y/a+1)/2,_.push(I.x,I.y)}w+=A}for(let k=0;k<s;k++){const D=k*(o+1);for(let L=0;L<o;L++){const O=L+D,F=O,B=O+o+1,G=O+o+2,q=O+1;f.push(F,B,q),f.push(B,G,q)}}this.setIndex(f),this.setAttribute("position",new Wn(m,3)),this.setAttribute("normal",new Wn(y,3)),this.setAttribute("uv",new Wn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UT(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class WT extends La{constructor(e=new bg([new Kt(0,.5),new Kt(-.5,-.5),new Kt(.5,-.5)]),a=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:a};const o=[],s=[],c=[],d=[];let f=0,m=0;if(Array.isArray(e)===!1)y(e);else for(let _=0;_<e.length;_++)y(e[_]),this.addGroup(f,m,_),f+=m,m=0;this.setIndex(o),this.setAttribute("position",new Wn(s,3)),this.setAttribute("normal",new Wn(c,3)),this.setAttribute("uv",new Wn(d,2));function y(_){const w=s.length/3,A=_.extractPoints(a);let C=A.shape;const I=A.holes;fd.isClockWise(C)===!1&&(C=C.reverse());for(let D=0,L=I.length;D<L;D++){const O=I[D];fd.isClockWise(O)===!0&&(I[D]=O.reverse())}const k=fd.triangulateShape(C,I);for(let D=0,L=I.length;D<L;D++){const O=I[D];C=C.concat(O)}for(let D=0,L=C.length;D<L;D++){const O=C[D];s.push(O.x,O.y,0),c.push(0,0,1),d.push(O.x,O.y)}for(let D=0,L=k.length;D<L;D++){const O=k[D],F=O[0]+w,B=O[1]+w,G=O[2]+w;o.push(F,B,G),m+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),a=this.parameters.shapes;return e2e(a,e)}static fromJSON(e,a){const o=[];for(let s=0,c=e.shapes.length;s<c;s++){const d=a[e.shapes[s]];o.push(d)}return new WT(o,e.curveSegments)}}function e2e(n,e){if(e.shapes=[],Array.isArray(n))for(let a=0,o=n.length;a<o;a++){const s=n[a];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class Rw extends La{constructor(e=1,a=32,o=16,s=0,c=Math.PI*2,d=0,f=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:a,heightSegments:o,phiStart:s,phiLength:c,thetaStart:d,thetaLength:f},a=Math.max(3,Math.floor(a)),o=Math.max(2,Math.floor(o));const m=Math.min(d+f,Math.PI);let y=0;const _=[],w=new Fe,A=new Fe,C=[],I=[],k=[],D=[];for(let L=0;L<=o;L++){const O=[],F=L/o;let B=0;L===0&&d===0?B=.5/a:L===o&&m===Math.PI&&(B=-.5/a);for(let G=0;G<=a;G++){const q=G/a;w.x=-e*Math.cos(s+q*c)*Math.sin(d+F*f),w.y=e*Math.cos(d+F*f),w.z=e*Math.sin(s+q*c)*Math.sin(d+F*f),I.push(w.x,w.y,w.z),A.copy(w).normalize(),k.push(A.x,A.y,A.z),D.push(q+B,1-F),O.push(y++)}_.push(O)}for(let L=0;L<o;L++)for(let O=0;O<a;O++){const F=_[L][O+1],B=_[L][O],G=_[L+1][O],q=_[L+1][O+1];(L!==0||d>0)&&C.push(F,B,q),(L!==o-1||m<Math.PI)&&C.push(B,G,q)}this.setIndex(C),this.setAttribute("position",new Wn(I,3)),this.setAttribute("normal",new Wn(k,3)),this.setAttribute("uv",new Wn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rw(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class VT extends Tp{constructor(e=1,a=0){const o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(o,s,e,a),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new VT(e.radius,e.detail)}}class GT extends La{constructor(e=1,a=.4,o=12,s=48,c=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:a,radialSegments:o,tubularSegments:s,arc:c},o=Math.floor(o),s=Math.floor(s);const d=[],f=[],m=[],y=[],_=new Fe,w=new Fe,A=new Fe;for(let C=0;C<=o;C++)for(let I=0;I<=s;I++){const k=I/s*c,D=C/o*Math.PI*2;w.x=(e+a*Math.cos(D))*Math.cos(k),w.y=(e+a*Math.cos(D))*Math.sin(k),w.z=a*Math.sin(D),f.push(w.x,w.y,w.z),_.x=e*Math.cos(k),_.y=e*Math.sin(k),A.subVectors(w,_).normalize(),m.push(A.x,A.y,A.z),y.push(I/s),y.push(C/o)}for(let C=1;C<=o;C++)for(let I=1;I<=s;I++){const k=(s+1)*C+I-1,D=(s+1)*(C-1)+I-1,L=(s+1)*(C-1)+I,O=(s+1)*C+I;d.push(k,D,O),d.push(D,L,O)}this.setIndex(d),this.setAttribute("position",new Wn(f,3)),this.setAttribute("normal",new Wn(m,3)),this.setAttribute("uv",new Wn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GT(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class HT extends La{constructor(e=1,a=.4,o=64,s=8,c=2,d=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:a,tubularSegments:o,radialSegments:s,p:c,q:d},o=Math.floor(o),s=Math.floor(s);const f=[],m=[],y=[],_=[],w=new Fe,A=new Fe,C=new Fe,I=new Fe,k=new Fe,D=new Fe,L=new Fe;for(let F=0;F<=o;++F){const B=F/o*c*Math.PI*2;O(B,c,d,e,C),O(B+.01,c,d,e,I),D.subVectors(I,C),L.addVectors(I,C),k.crossVectors(D,L),L.crossVectors(k,D),k.normalize(),L.normalize();for(let G=0;G<=s;++G){const q=G/s*Math.PI*2,X=-a*Math.cos(q),ee=a*Math.sin(q);w.x=C.x+(X*L.x+ee*k.x),w.y=C.y+(X*L.y+ee*k.y),w.z=C.z+(X*L.z+ee*k.z),m.push(w.x,w.y,w.z),A.subVectors(w,C).normalize(),y.push(A.x,A.y,A.z),_.push(F/o),_.push(G/s)}}for(let F=1;F<=o;F++)for(let B=1;B<=s;B++){const G=(s+1)*(F-1)+(B-1),q=(s+1)*F+(B-1),X=(s+1)*F+B,ee=(s+1)*(F-1)+B;f.push(G,q,ee),f.push(q,X,ee)}this.setIndex(f),this.setAttribute("position",new Wn(m,3)),this.setAttribute("normal",new Wn(y,3)),this.setAttribute("uv",new Wn(_,2));function O(F,B,G,q,X){const ee=Math.cos(F),V=Math.sin(F),Q=G/B*F,me=Math.cos(Q);X.x=q*(2+me)*.5*ee,X.y=q*(2+me)*V*.5,X.z=q*Math.sin(Q)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new HT(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class jT extends La{constructor(e=new e6(new Fe(-1,-1,0),new Fe(-1,1,0),new Fe(1,1,0)),a=64,o=1,s=8,c=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:a,radius:o,radialSegments:s,closed:c};const d=e.computeFrenetFrames(a,c);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;const f=new Fe,m=new Fe,y=new Kt;let _=new Fe;const w=[],A=[],C=[],I=[];k(),this.setIndex(I),this.setAttribute("position",new Wn(w,3)),this.setAttribute("normal",new Wn(A,3)),this.setAttribute("uv",new Wn(C,2));function k(){for(let F=0;F<a;F++)D(F);D(c===!1?a:0),O(),L()}function D(F){_=e.getPointAt(F/a,_);const B=d.normals[F],G=d.binormals[F];for(let q=0;q<=s;q++){const X=q/s*Math.PI*2,ee=Math.sin(X),V=-Math.cos(X);m.x=V*B.x+ee*G.x,m.y=V*B.y+ee*G.y,m.z=V*B.z+ee*G.z,m.normalize(),A.push(m.x,m.y,m.z),f.x=_.x+o*m.x,f.y=_.y+o*m.y,f.z=_.z+o*m.z,w.push(f.x,f.y,f.z)}}function L(){for(let F=1;F<=a;F++)for(let B=1;B<=s;B++){const G=(s+1)*(F-1)+(B-1),q=(s+1)*F+(B-1),X=(s+1)*F+B,ee=(s+1)*(F-1)+B;I.push(G,q,ee),I.push(q,X,ee)}}function O(){for(let F=0;F<=a;F++)for(let B=0;B<=s;B++)y.x=F/a,y.y=B/s,C.push(y.x,y.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new jT(new HE[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class aY extends La{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const a=[],o=new Set,s=new Fe,c=new Fe;if(e.index!==null){const d=e.attributes.position,f=e.index;let m=e.groups;m.length===0&&(m=[{start:0,count:f.count,materialIndex:0}]);for(let y=0,_=m.length;y<_;++y){const w=m[y],A=w.start,C=w.count;for(let I=A,k=A+C;I<k;I+=3)for(let D=0;D<3;D++){const L=f.getX(I+D),O=f.getX(I+(D+1)%3);s.fromBufferAttribute(d,L),c.fromBufferAttribute(d,O),YW(s,c,o)===!0&&(a.push(s.x,s.y,s.z),a.push(c.x,c.y,c.z))}}}else{const d=e.attributes.position;for(let f=0,m=d.count/3;f<m;f++)for(let y=0;y<3;y++){const _=3*f+y,w=3*f+(y+1)%3;s.fromBufferAttribute(d,_),c.fromBufferAttribute(d,w),YW(s,c,o)===!0&&(a.push(s.x,s.y,s.z),a.push(c.x,c.y,c.z))}}this.setAttribute("position",new Wn(a,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function YW(n,e,a){const o=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return a.has(o)===!0||a.has(s)===!0?!1:(a.add(o),a.add(s),!0)}var KW=Object.freeze({__proto__:null,BoxGeometry:Vg,CapsuleGeometry:kT,CircleGeometry:DT,ConeGeometry:OT,CylinderGeometry:h_,DodecahedronGeometry:zT,EdgesGeometry:QZ,ExtrudeGeometry:NT,IcosahedronGeometry:BT,LatheGeometry:Iw,OctahedronGeometry:Lw,PlaneGeometry:Mp,PolyhedronGeometry:Tp,RingGeometry:UT,ShapeGeometry:WT,SphereGeometry:Rw,TetrahedronGeometry:VT,TorusGeometry:GT,TorusKnotGeometry:HT,TubeGeometry:jT,WireframeGeometry:aY});class iY extends Ko{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Pn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class rY extends yd{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class n6 extends Ko{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oY extends n6{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Kt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(a){this.ior=(1+.4*a)/(1-.4*a)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class sY extends Ko{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pn(16777215),this.specular=new Pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ew,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class lY extends Ko{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class cY extends Ko{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class uY extends Ko{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ew,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class dY extends Ko{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ep,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hY extends js{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function hg(n,e,a){return!n||!a&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function fY(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function pY(n){function e(s,c){return n[s]-n[c]}const a=n.length,o=new Array(a);for(let s=0;s!==a;++s)o[s]=s;return o.sort(e),o}function gR(n,e,a){const o=n.length,s=new n.constructor(o);for(let c=0,d=0;d!==o;++c){const f=a[c]*e;for(let m=0;m!==e;++m)s[d++]=n[f+m]}return s}function a6(n,e,a,o){let s=1,c=n[0];for(;c!==void 0&&c[o]===void 0;)c=n[s++];if(c===void 0)return;let d=c[o];if(d!==void 0)if(Array.isArray(d))do d=c[o],d!==void 0&&(e.push(c.time),a.push.apply(a,d)),c=n[s++];while(c!==void 0);else if(d.toArray!==void 0)do d=c[o],d!==void 0&&(e.push(c.time),d.toArray(a,a.length)),c=n[s++];while(c!==void 0);else do d=c[o],d!==void 0&&(e.push(c.time),a.push(d)),c=n[s++];while(c!==void 0)}function t2e(n,e,a,o,s=30){const c=n.clone();c.name=e;const d=[];for(let m=0;m<c.tracks.length;++m){const y=c.tracks[m],_=y.getValueSize(),w=[],A=[];for(let C=0;C<y.times.length;++C){const I=y.times[C]*s;if(!(I<a||I>=o)){w.push(y.times[C]);for(let k=0;k<_;++k)A.push(y.values[C*_+k])}}w.length!==0&&(y.times=hg(w,y.times.constructor),y.values=hg(A,y.values.constructor),d.push(y))}c.tracks=d;let f=1/0;for(let m=0;m<c.tracks.length;++m)f>c.tracks[m].times[0]&&(f=c.tracks[m].times[0]);for(let m=0;m<c.tracks.length;++m)c.tracks[m].shift(-1*f);return c.resetDuration(),c}function n2e(n,e=0,a=n,o=30){o<=0&&(o=30);const s=a.tracks.length,c=e/o;for(let d=0;d<s;++d){const f=a.tracks[d],m=f.ValueTypeName;if(m==="bool"||m==="string")continue;const y=n.tracks.find(function(L){return L.name===f.name&&L.ValueTypeName===m});if(y===void 0)continue;let _=0;const w=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=w/3);let A=0;const C=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=C/3);const I=f.times.length-1;let k;if(c<=f.times[0]){const L=_,O=w-_;k=f.values.slice(L,O)}else if(c>=f.times[I]){const L=I*w+_,O=L+w-_;k=f.values.slice(L,O)}else{const L=f.createInterpolant(),O=_,F=w-_;L.evaluate(c),k=L.resultBuffer.slice(O,F)}m==="quaternion"&&new _s().fromArray(k).normalize().conjugate().toArray(k);const D=y.times.length;for(let L=0;L<D;++L){const O=L*C+A;if(m==="quaternion")_s.multiplyQuaternionsFlat(y.values,O,k,0,y.values,O);else{const F=C-A*2;for(let B=0;B<F;++B)y.values[O+B]-=k[B]}}}return n.blendMode=zD,n}const a2e={convertArray:hg,isTypedArray:fY,getKeyframeOrder:pY,sortedArray:gR,flattenJSON:a6,subclip:t2e,makeClipAdditive:n2e};class kw{constructor(e,a,o,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new a.constructor(o),this.sampleValues=a,this.valueSize=o,this.settings=null,this.DefaultSettings_={}}evaluate(e){const a=this.parameterPositions;let o=this._cachedIndex,s=a[o],c=a[o-1];e:{t:{let d;n:{a:if(!(e<s)){for(let f=o+2;;){if(s===void 0){if(e<c)break a;return o=a.length,this._cachedIndex=o,this.copySampleValue_(o-1)}if(o===f)break;if(c=s,s=a[++o],e<s)break t}d=a.length;break n}if(!(e>=c)){const f=a[1];e<f&&(o=2,c=f);for(let m=o-2;;){if(c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===m)break;if(s=c,c=a[--o-1],e>=c)break t}d=o,o=0;break n}break e}for(;o<d;){const f=o+d>>>1;e<a[f]?d=f:o=f+1}if(s=a[o],c=a[o-1],c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return o=a.length,this._cachedIndex=o,this.copySampleValue_(o-1)}this._cachedIndex=o,this.intervalChanged_(o,c,s)}return this.interpolate_(o,c,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,c=e*s;for(let d=0;d!==s;++d)a[d]=o[c+d];return a}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class mY extends kw{constructor(e,a,o,s){super(e,a,o,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:cg,endingEnd:cg}}intervalChanged_(e,a,o){const s=this.parameterPositions;let c=e-2,d=e+1,f=s[c],m=s[d];if(f===void 0)switch(this.getSettings_().endingStart){case ug:c=e,f=2*a-o;break;case Nx:c=s.length-2,f=a+s[c]-s[c+1];break;default:c=e,f=o}if(m===void 0)switch(this.getSettings_().endingEnd){case ug:d=e,m=2*o-a;break;case Nx:d=1,m=o+s[1]-s[0];break;default:d=e-1,m=a}const y=(o-a)*.5,_=this.valueSize;this._weightPrev=y/(a-f),this._weightNext=y/(m-o),this._offsetPrev=c*_,this._offsetNext=d*_}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=e*f,y=m-f,_=this._offsetPrev,w=this._offsetNext,A=this._weightPrev,C=this._weightNext,I=(o-a)/(s-a),k=I*I,D=k*I,L=-A*D+2*A*k-A*I,O=(1+A)*D+(-1.5-2*A)*k+(-.5+A)*I+1,F=(-1-C)*D+(1.5+C)*k+.5*I,B=C*D-C*k;for(let G=0;G!==f;++G)c[G]=L*d[_+G]+O*d[y+G]+F*d[m+G]+B*d[w+G];return c}}class i6 extends kw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=e*f,y=m-f,_=(o-a)/(s-a),w=1-_;for(let A=0;A!==f;++A)c[A]=d[y+A]*w+d[m+A]*_;return c}}class gY extends kw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class gu{constructor(e,a,o,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(a===void 0||a.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=hg(a,this.TimeBufferType),this.values=hg(o,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const a=e.constructor;let o;if(a.toJSON!==this.toJSON)o=a.toJSON(e);else{o={name:e.name,times:hg(e.times,Array),values:hg(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(o.interpolation=s)}return o.type=e.ValueTypeName,o}InterpolantFactoryMethodDiscrete(e){return new gY(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new i6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new mY(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let a;switch(e){case zx:a=this.InterpolantFactoryMethodDiscrete;break;case Fx:a=this.InterpolantFactoryMethodLinear;break;case WA:a=this.InterpolantFactoryMethodSmooth;break}if(a===void 0){const o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=a,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return zx;case this.InterpolantFactoryMethodLinear:return Fx;case this.InterpolantFactoryMethodSmooth:return WA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const a=this.times;for(let o=0,s=a.length;o!==s;++o)a[o]+=e}return this}scale(e){if(e!==1){const a=this.times;for(let o=0,s=a.length;o!==s;++o)a[o]*=e}return this}trim(e,a){const o=this.times,s=o.length;let c=0,d=s-1;for(;c!==s&&o[c]<e;)++c;for(;d!==-1&&o[d]>a;)--d;if(++d,c!==0||d!==s){c>=d&&(d=Math.max(d,1),c=d-1);const f=this.getValueSize();this.times=o.slice(c,d),this.values=this.values.slice(c*f,d*f)}return this}validate(){let e=!0;const a=this.getValueSize();a-Math.floor(a)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const o=this.times,s=this.values,c=o.length;c===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let f=0;f!==c;f++){const m=o[f];if(typeof m=="number"&&isNaN(m)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,m),e=!1;break}if(d!==null&&d>m){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,m,d),e=!1;break}d=m}if(s!==void 0&&fY(s))for(let f=0,m=s.length;f!==m;++f){const y=s[f];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,y),e=!1;break}}return e}optimize(){const e=this.times.slice(),a=this.values.slice(),o=this.getValueSize(),s=this.getInterpolation()===WA,c=e.length-1;let d=1;for(let f=1;f<c;++f){let m=!1;const y=e[f],_=e[f+1];if(y!==_&&(f!==1||y!==e[0]))if(s)m=!0;else{const w=f*o,A=w-o,C=w+o;for(let I=0;I!==o;++I){const k=a[w+I];if(k!==a[A+I]||k!==a[C+I]){m=!0;break}}}if(m){if(f!==d){e[d]=e[f];const w=f*o,A=d*o;for(let C=0;C!==o;++C)a[A+C]=a[w+C]}++d}}if(c>0){e[d]=e[c];for(let f=c*o,m=d*o,y=0;y!==o;++y)a[m+y]=a[f+y];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=a.slice(0,d*o)):(this.times=e,this.values=a),this}clone(){const e=this.times.slice(),a=this.values.slice(),o=this.constructor,s=new o(this.name,e,a);return s.createInterpolant=this.createInterpolant,s}}gu.prototype.TimeBufferType=Float32Array;gu.prototype.ValueBufferType=Float32Array;gu.prototype.DefaultInterpolation=Fx;class Gg extends gu{}Gg.prototype.ValueTypeName="bool";Gg.prototype.ValueBufferType=Array;Gg.prototype.DefaultInterpolation=zx;Gg.prototype.InterpolantFactoryMethodLinear=void 0;Gg.prototype.InterpolantFactoryMethodSmooth=void 0;class r6 extends gu{}r6.prototype.ValueTypeName="color";class Zx extends gu{}Zx.prototype.ValueTypeName="number";class yY extends kw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=(o-a)/(s-a);let y=e*f;for(let _=y+f;y!==_;y+=4)_s.slerpFlat(c,0,d,y-f,d,y,m);return c}}class f_ extends gu{InterpolantFactoryMethodLinear(e){return new yY(this.times,this.values,this.getValueSize(),e)}}f_.prototype.ValueTypeName="quaternion";f_.prototype.DefaultInterpolation=Fx;f_.prototype.InterpolantFactoryMethodSmooth=void 0;class Hg extends gu{}Hg.prototype.ValueTypeName="string";Hg.prototype.ValueBufferType=Array;Hg.prototype.DefaultInterpolation=zx;Hg.prototype.InterpolantFactoryMethodLinear=void 0;Hg.prototype.InterpolantFactoryMethodSmooth=void 0;class Yx extends gu{}Yx.prototype.ValueTypeName="vector";class Kx{constructor(e,a=-1,o,s=bT){this.name=e,this.tracks=o,this.duration=a,this.blendMode=s,this.uuid=$l(),this.duration<0&&this.resetDuration()}static parse(e){const a=[],o=e.tracks,s=1/(e.fps||1);for(let d=0,f=o.length;d!==f;++d)a.push(r2e(o[d]).scale(s));const c=new this(e.name,e.duration,a,e.blendMode);return c.uuid=e.uuid,c}static toJSON(e){const a=[],o=e.tracks,s={name:e.name,duration:e.duration,tracks:a,uuid:e.uuid,blendMode:e.blendMode};for(let c=0,d=o.length;c!==d;++c)a.push(gu.toJSON(o[c]));return s}static CreateFromMorphTargetSequence(e,a,o,s){const c=a.length,d=[];for(let f=0;f<c;f++){let m=[],y=[];m.push((f+c-1)%c,f,(f+1)%c),y.push(0,1,0);const _=pY(m);m=gR(m,1,_),y=gR(y,1,_),!s&&m[0]===0&&(m.push(c),y.push(y[0])),d.push(new Zx(".morphTargetInfluences["+a[f].name+"]",m,y).scale(1/o))}return new this(e,-1,d)}static findByName(e,a){let o=e;if(!Array.isArray(e)){const s=e;o=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<o.length;s++)if(o[s].name===a)return o[s];return null}static CreateClipsFromMorphTargetSequences(e,a,o){const s={},c=/^([\w-]*?)([\d]+)$/;for(let f=0,m=e.length;f<m;f++){const y=e[f],_=y.name.match(c);if(_&&_.length>1){const w=_[1];let A=s[w];A||(s[w]=A=[]),A.push(y)}}const d=[];for(const f in s)d.push(this.CreateFromMorphTargetSequence(f,s[f],a,o));return d}static parseAnimation(e,a){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const o=function(w,A,C,I,k){if(C.length!==0){const D=[],L=[];a6(C,D,L,I),D.length!==0&&k.push(new w(A,D,L))}},s=[],c=e.name||"default",d=e.fps||30,f=e.blendMode;let m=e.length||-1;const y=e.hierarchy||[];for(let w=0;w<y.length;w++){const A=y[w].keys;if(!(!A||A.length===0))if(A[0].morphTargets){const C={};let I;for(I=0;I<A.length;I++)if(A[I].morphTargets)for(let k=0;k<A[I].morphTargets.length;k++)C[A[I].morphTargets[k]]=-1;for(const k in C){const D=[],L=[];for(let O=0;O!==A[I].morphTargets.length;++O){const F=A[I];D.push(F.time),L.push(F.morphTarget===k?1:0)}s.push(new Zx(".morphTargetInfluence["+k+"]",D,L))}m=C.length*d}else{const C=".bones["+a[w].name+"]";o(Yx,C+".position",A,"pos",s),o(f_,C+".quaternion",A,"rot",s),o(Yx,C+".scale",A,"scl",s)}}return s.length===0?null:new this(c,m,s,f)}resetDuration(){const e=this.tracks;let a=0;for(let o=0,s=e.length;o!==s;++o){const c=this.tracks[o];a=Math.max(a,c.times[c.times.length-1])}return this.duration=a,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let a=0;a<this.tracks.length;a++)e=e&&this.tracks[a].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let a=0;a<this.tracks.length;a++)e.push(this.tracks[a].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function i2e(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Zx;case"vector":case"vector2":case"vector3":case"vector4":return Yx;case"color":return r6;case"quaternion":return f_;case"bool":case"boolean":return Gg;case"string":return Hg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function r2e(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=i2e(n.type);if(n.times===void 0){const a=[],o=[];a6(n.keys,a,o,"value"),n.times=a,n.values=o}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Og={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class o6{constructor(e,a,o){const s=this;let c=!1,d=0,f=0,m;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=a,this.onError=o,this.itemStart=function(_){f++,c===!1&&s.onStart!==void 0&&s.onStart(_,d,f),c=!0},this.itemEnd=function(_){d++,s.onProgress!==void 0&&s.onProgress(_,d,f),d===f&&(c=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(_){s.onError!==void 0&&s.onError(_)},this.resolveURL=function(_){return m?m(_):_},this.setURLModifier=function(_){return m=_,this},this.addHandler=function(_,w){return y.push(_,w),this},this.removeHandler=function(_){const w=y.indexOf(_);return w!==-1&&y.splice(w,2),this},this.getHandler=function(_){for(let w=0,A=y.length;w<A;w+=2){const C=y[w],I=y[w+1];if(C.global&&(C.lastIndex=0),C.test(_))return I}return null}}}const vY=new o6;class wl{constructor(e){this.manager=e!==void 0?e:vY,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,a){const o=this;return new Promise(function(s,c){o.load(e,s,a,c)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}wl.DEFAULT_MATERIAL_NAME="__DEFAULT";const ch={};class o2e extends Error{constructor(e,a){super(e),this.response=a}}class Nh extends wl{constructor(e){super(e)}load(e,a,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=Og.get(e);if(c!==void 0)return this.manager.itemStart(e),setTimeout(()=>{a&&a(c),this.manager.itemEnd(e)},0),c;if(ch[e]!==void 0){ch[e].push({onLoad:a,onProgress:o,onError:s});return}ch[e]=[],ch[e].push({onLoad:a,onProgress:o,onError:s});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,m=this.responseType;fetch(d).then(y=>{if(y.status===200||y.status===0){if(y.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||y.body===void 0||y.body.getReader===void 0)return y;const _=ch[e],w=y.body.getReader(),A=y.headers.get("Content-Length")||y.headers.get("X-File-Size"),C=A?parseInt(A):0,I=C!==0;let k=0;const D=new ReadableStream({start(L){O();function O(){w.read().then(({done:F,value:B})=>{if(F)L.close();else{k+=B.byteLength;const G=new ProgressEvent("progress",{lengthComputable:I,loaded:k,total:C});for(let q=0,X=_.length;q<X;q++){const ee=_[q];ee.onProgress&&ee.onProgress(G)}L.enqueue(B),O()}})}}});return new Response(D)}else throw new o2e(`fetch for "${y.url}" responded with ${y.status}: ${y.statusText}`,y)}).then(y=>{switch(m){case"arraybuffer":return y.arrayBuffer();case"blob":return y.blob();case"document":return y.text().then(_=>new DOMParser().parseFromString(_,f));case"json":return y.json();default:if(f===void 0)return y.text();{const w=/charset="?([^;"\s]*)"?/i.exec(f),A=w&&w[1]?w[1].toLowerCase():void 0,C=new TextDecoder(A);return y.arrayBuffer().then(I=>C.decode(I))}}}).then(y=>{Og.add(e,y);const _=ch[e];delete ch[e];for(let w=0,A=_.length;w<A;w++){const C=_[w];C.onLoad&&C.onLoad(y)}}).catch(y=>{const _=ch[e];if(_===void 0)throw this.manager.itemError(e),y;delete ch[e];for(let w=0,A=_.length;w<A;w++){const C=_[w];C.onError&&C.onError(y)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class s2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Nh(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a=[];for(let o=0;o<e.length;o++){const s=Kx.parse(e[o]);a.push(s)}return a}}class l2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=[],f=new LT,m=new Nh(this.manager);m.setPath(this.path),m.setResponseType("arraybuffer"),m.setRequestHeader(this.requestHeader),m.setWithCredentials(c.withCredentials);let y=0;function _(w){m.load(e[w],function(A){const C=c.parse(A,!0);d[w]={width:C.width,height:C.height,format:C.format,mipmaps:C.mipmaps},y+=1,y===6&&(C.mipmapCount===1&&(f.minFilter=Cr),f.image=d,f.format=C.format,f.needsUpdate=!0,a&&a(f))},o,s)}if(Array.isArray(e))for(let w=0,A=e.length;w<A;++w)_(w);else m.load(e,function(w){const A=c.parse(w,!0);if(A.isCubemap){const C=A.mipmaps.length/A.mipmapCount;for(let I=0;I<C;I++){d[I]={mipmaps:[]};for(let k=0;k<A.mipmapCount;k++)d[I].mipmaps.push(A.mipmaps[I*A.mipmapCount+k]),d[I].format=A.format,d[I].width=A.width,d[I].height=A.height}f.image=d}else f.image.width=A.width,f.image.height=A.height,f.mipmaps=A.mipmaps;A.mipmapCount===1&&(f.minFilter=Cr),f.format=A.format,f.needsUpdate=!0,a&&a(f)},o,s);return f}}class Jx extends wl{constructor(e){super(e)}load(e,a,o,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,d=Og.get(e);if(d!==void 0)return c.manager.itemStart(e),setTimeout(function(){a&&a(d),c.manager.itemEnd(e)},0),d;const f=Hx("img");function m(){_(),Og.add(e,this),a&&a(this),c.manager.itemEnd(e)}function y(w){_(),s&&s(w),c.manager.itemError(e),c.manager.itemEnd(e)}function _(){f.removeEventListener("load",m,!1),f.removeEventListener("error",y,!1)}return f.addEventListener("load",m,!1),f.addEventListener("error",y,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),c.manager.itemStart(e),f.src=e,f}}class c2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=new Pw;c.colorSpace=To;const d=new Jx(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);let f=0;function m(y){d.load(e[y],function(_){c.images[y]=_,f++,f===6&&(c.needsUpdate=!0,a&&a(c))},void 0,s)}for(let y=0;y<e.length;++y)m(y);return c}}class u2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new k0,f=new Nh(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(c.withCredentials),f.load(e,function(m){let y;try{y=c.parse(m)}catch(_){if(s!==void 0)s(_);else{console.error(_);return}}y.image!==void 0?d.image=y.image:y.data!==void 0&&(d.image.width=y.width,d.image.height=y.height,d.image.data=y.data),d.wrapS=y.wrapS!==void 0?y.wrapS:ms,d.wrapT=y.wrapT!==void 0?y.wrapT:ms,d.magFilter=y.magFilter!==void 0?y.magFilter:Cr,d.minFilter=y.minFilter!==void 0?y.minFilter:Cr,d.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.colorSpace!==void 0?d.colorSpace=y.colorSpace:y.encoding!==void 0&&(d.encoding=y.encoding),y.flipY!==void 0&&(d.flipY=y.flipY),y.format!==void 0&&(d.format=y.format),y.type!==void 0&&(d.type=y.type),y.mipmaps!==void 0&&(d.mipmaps=y.mipmaps,d.minFilter=vp),y.mipmapCount===1&&(d.minFilter=Cr),y.generateMipmaps!==void 0&&(d.generateMipmaps=y.generateMipmaps),d.needsUpdate=!0,a&&a(d,y)},o,s),d}}class _Y extends wl{constructor(e){super(e)}load(e,a,o,s){const c=new Lr,d=new Jx(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(f){c.image=f,c.needsUpdate=!0,a!==void 0&&a(c)},o,s),c}}class Cp extends fi{constructor(e,a=1){super(),this.isLight=!0,this.type="Light",this.color=new Pn(e),this.intensity=a}dispose(){}copy(e,a){return super.copy(e,a),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const a=super.toJSON(e);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(a.object.distance=this.distance),this.angle!==void 0&&(a.object.angle=this.angle),this.decay!==void 0&&(a.object.decay=this.decay),this.penumbra!==void 0&&(a.object.penumbra=this.penumbra),this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON()),a}}class bY extends Cp{constructor(e,a,o){super(e,o),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pn(a)}copy(e,a){return super.copy(e,a),this.groundColor.copy(e.groundColor),this}}const z4=new Ia,JW=new Fe,QW=new Fe;class s6{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Kt(512,512),this.map=null,this.mapPass=null,this.matrix=new Ia,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ST,this._frameExtents=new Kt(1,1),this._viewportCount=1,this._viewports=[new Ai(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const a=this.camera,o=this.matrix;JW.setFromMatrixPosition(e.matrixWorld),a.position.copy(JW),QW.setFromMatrixPosition(e.target.matrixWorld),a.lookAt(QW),a.updateMatrixWorld(),z4.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(z4),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(z4)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class d2e extends s6{constructor(){super(new jr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const a=this.camera,o=K0*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,c=e.distance||a.far;(o!==a.fov||s!==a.aspect||c!==a.far)&&(a.fov=o,a.aspect=s,a.far=c,a.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class xY extends Cp{constructor(e,a,o=0,s=Math.PI/3,c=0,d=2){super(e,a),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.distance=o,this.angle=s,this.penumbra=c,this.decay=d,this.map=null,this.shadow=new d2e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,a){return super.copy(e,a),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const eV=new Ia,rb=new Fe,F4=new Fe;class h2e extends s6{constructor(){super(new jr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Kt(4,2),this._viewportCount=6,this._viewports=[new Ai(2,1,1,1),new Ai(0,1,1,1),new Ai(3,1,1,1),new Ai(1,1,1,1),new Ai(3,0,1,1),new Ai(1,0,1,1)],this._cubeDirections=[new Fe(1,0,0),new Fe(-1,0,0),new Fe(0,0,1),new Fe(0,0,-1),new Fe(0,1,0),new Fe(0,-1,0)],this._cubeUps=[new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,0,1),new Fe(0,0,-1)]}updateMatrices(e,a=0){const o=this.camera,s=this.matrix,c=e.distance||o.far;c!==o.far&&(o.far=c,o.updateProjectionMatrix()),rb.setFromMatrixPosition(e.matrixWorld),o.position.copy(rb),F4.copy(o.position),F4.add(this._cubeDirections[a]),o.up.copy(this._cubeUps[a]),o.lookAt(F4),o.updateMatrixWorld(),s.makeTranslation(-rb.x,-rb.y,-rb.z),eV.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eV)}}class wY extends Cp{constructor(e,a,o=0,s=2){super(e,a),this.isPointLight=!0,this.type="PointLight",this.distance=o,this.decay=s,this.shadow=new h2e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,a){return super.copy(e,a),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class f2e extends s6{constructor(){super(new Ah(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class SY extends Cp{constructor(e,a){super(e,a),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(fi.DEFAULT_UP),this.updateMatrix(),this.target=new fi,this.shadow=new f2e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class AY extends Cp{constructor(e,a){super(e,a),this.isAmbientLight=!0,this.type="AmbientLight"}}class EY extends Cp{constructor(e,a,o=10,s=10){super(e,a),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=o,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const a=super.toJSON(e);return a.object.width=this.width,a.object.height=this.height,a}}class MY{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Fe)}set(e){for(let a=0;a<9;a++)this.coefficients[a].copy(e[a]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,a){const o=e.x,s=e.y,c=e.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.282095),a.addScaledVector(d[1],.488603*s),a.addScaledVector(d[2],.488603*c),a.addScaledVector(d[3],.488603*o),a.addScaledVector(d[4],1.092548*(o*s)),a.addScaledVector(d[5],1.092548*(s*c)),a.addScaledVector(d[6],.315392*(3*c*c-1)),a.addScaledVector(d[7],1.092548*(o*c)),a.addScaledVector(d[8],.546274*(o*o-s*s)),a}getIrradianceAt(e,a){const o=e.x,s=e.y,c=e.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.886227),a.addScaledVector(d[1],2*.511664*s),a.addScaledVector(d[2],2*.511664*c),a.addScaledVector(d[3],2*.511664*o),a.addScaledVector(d[4],2*.429043*o*s),a.addScaledVector(d[5],2*.429043*s*c),a.addScaledVector(d[6],.743125*c*c-.247708),a.addScaledVector(d[7],2*.429043*o*c),a.addScaledVector(d[8],.429043*(o*o-s*s)),a}add(e){for(let a=0;a<9;a++)this.coefficients[a].add(e.coefficients[a]);return this}addScaledSH(e,a){for(let o=0;o<9;o++)this.coefficients[o].addScaledVector(e.coefficients[o],a);return this}scale(e){for(let a=0;a<9;a++)this.coefficients[a].multiplyScalar(e);return this}lerp(e,a){for(let o=0;o<9;o++)this.coefficients[o].lerp(e.coefficients[o],a);return this}equals(e){for(let a=0;a<9;a++)if(!this.coefficients[a].equals(e.coefficients[a]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,a=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].fromArray(e,a+s*3);return this}toArray(e=[],a=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].toArray(e,a+s*3);return e}static getBasisAt(e,a){const o=e.x,s=e.y,c=e.z;a[0]=.282095,a[1]=.488603*s,a[2]=.488603*c,a[3]=.488603*o,a[4]=1.092548*o*s,a[5]=1.092548*s*c,a[6]=.315392*(3*c*c-1),a[7]=1.092548*o*c,a[8]=.546274*(o*o-s*s)}}class TY extends Cp{constructor(e=new MY,a=1){super(void 0,a),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const a=super.toJSON(e);return a.object.sh=this.sh.toArray(),a}}class $T extends wl{constructor(e){super(e),this.textures={}}load(e,a,o,s){const c=this,d=new Nh(c.manager);d.setPath(c.path),d.setRequestHeader(c.requestHeader),d.setWithCredentials(c.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a=this.textures;function o(c){return a[c]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",c),a[c]}const s=$T.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Pn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const c in e.uniforms){const d=e.uniforms[c];switch(s.uniforms[c]={},d.type){case"t":s.uniforms[c].value=o(d.value);break;case"c":s.uniforms[c].value=new Pn().setHex(d.value);break;case"v2":s.uniforms[c].value=new Kt().fromArray(d.value);break;case"v3":s.uniforms[c].value=new Fe().fromArray(d.value);break;case"v4":s.uniforms[c].value=new Ai().fromArray(d.value);break;case"m3":s.uniforms[c].value=new Na().fromArray(d.value);break;case"m4":s.uniforms[c].value=new Ia().fromArray(d.value);break;default:s.uniforms[c].value=d.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const c in e.extensions)s.extensions[c]=e.extensions[c];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=o(e.map)),e.matcap!==void 0&&(s.matcap=o(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let c=e.normalScale;Array.isArray(c)===!1&&(c=[c,c]),s.normalScale=new Kt().fromArray(c)}return e.displacementMap!==void 0&&(s.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=o(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=o(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=o(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Kt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=o(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=o(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=o(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=o(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=o(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=o(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=o(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const a={ShadowMaterial:iY,SpriteMaterial:qD,RawShaderMaterial:rY,ShaderMaterial:yd,PointsMaterial:ZD,MeshPhysicalMaterial:oY,MeshStandardMaterial:n6,MeshPhongMaterial:sY,MeshToonMaterial:lY,MeshNormalMaterial:cY,MeshLambertMaterial:uY,MeshDepthMaterial:ET,MeshDistanceMaterial:MT,MeshBasicMaterial:Vh,MeshMatcapMaterial:dY,LineDashedMaterial:hY,LineBasicMaterial:js,Material:Ko};return new a[e]}}class yR{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let a="";for(let o=0,s=e.length;o<s;o++)a+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(a))}catch{return a}}static extractUrlBase(e){const a=e.lastIndexOf("/");return a===-1?"./":e.slice(0,a+1)}static resolveURL(e,a){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(a)&&/^\//.test(e)&&(a=a.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:a+e)}}class l6 extends La{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class CY extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Nh(c.manager);d.setPath(c.path),d.setRequestHeader(c.requestHeader),d.setWithCredentials(c.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a={},o={};function s(C,I){if(a[I]!==void 0)return a[I];const D=C.interleavedBuffers[I],L=c(C,D.buffer),O=y0(D.type,L),F=new PT(O,D.stride);return F.uuid=D.uuid,a[I]=F,F}function c(C,I){if(o[I]!==void 0)return o[I];const D=C.arrayBuffers[I],L=new Uint32Array(D).buffer;return o[I]=L,L}const d=e.isInstancedBufferGeometry?new l6:new La,f=e.data.index;if(f!==void 0){const C=y0(f.type,f.array);d.setIndex(new qi(C,1))}const m=e.data.attributes;for(const C in m){const I=m[C];let k;if(I.isInterleavedBufferAttribute){const D=s(e.data,I.data);k=new Rg(D,I.itemSize,I.offset,I.normalized)}else{const D=y0(I.type,I.array),L=I.isInstancedBufferAttribute?kg:qi;k=new L(D,I.itemSize,I.normalized)}I.name!==void 0&&(k.name=I.name),I.usage!==void 0&&k.setUsage(I.usage),I.updateRange!==void 0&&(k.updateRange.offset=I.updateRange.offset,k.updateRange.count=I.updateRange.count),d.setAttribute(C,k)}const y=e.data.morphAttributes;if(y)for(const C in y){const I=y[C],k=[];for(let D=0,L=I.length;D<L;D++){const O=I[D];let F;if(O.isInterleavedBufferAttribute){const B=s(e.data,O.data);F=new Rg(B,O.itemSize,O.offset,O.normalized)}else{const B=y0(O.type,O.array);F=new qi(B,O.itemSize,O.normalized)}O.name!==void 0&&(F.name=O.name),k.push(F)}d.morphAttributes[C]=k}e.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const w=e.data.groups||e.data.drawcalls||e.data.offsets;if(w!==void 0)for(let C=0,I=w.length;C!==I;++C){const k=w[C];d.addGroup(k.start,k.count,k.materialIndex)}const A=e.data.boundingSphere;if(A!==void 0){const C=new Fe;A.center!==void 0&&C.fromArray(A.center),d.boundingSphere=new Tc(C,A.radius)}return e.name&&(d.name=e.name),e.userData&&(d.userData=e.userData),d}}class p2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=this.path===""?yR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const f=new Nh(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(m){let y=null;try{y=JSON.parse(m)}catch(w){s!==void 0&&s(w),console.error("THREE:ObjectLoader: Can't parse "+e+".",w.message);return}const _=y.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}c.parse(y,a)},o,s)}async loadAsync(e,a){const o=this,s=this.path===""?yR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const c=new Nh(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials);const d=await c.loadAsync(e,a),f=JSON.parse(d),m=f.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await o.parseAsync(f)}parse(e,a){const o=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),c=this.parseGeometries(e.geometries,s),d=this.parseImages(e.images,function(){a!==void 0&&a(y)}),f=this.parseTextures(e.textures,d),m=this.parseMaterials(e.materials,f),y=this.parseObject(e.object,c,m,f,o),_=this.parseSkeletons(e.skeletons,y);if(this.bindSkeletons(y,_),a!==void 0){let w=!1;for(const A in d)if(d[A].data instanceof HTMLImageElement){w=!0;break}w===!1&&a(y)}return y}async parseAsync(e){const a=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,o),c=await this.parseImagesAsync(e.images),d=this.parseTextures(e.textures,c),f=this.parseMaterials(e.materials,d),m=this.parseObject(e.object,s,f,d,a),y=this.parseSkeletons(e.skeletons,m);return this.bindSkeletons(m,y),m}parseShapes(e){const a={};if(e!==void 0)for(let o=0,s=e.length;o<s;o++){const c=new bg().fromJSON(e[o]);a[c.uuid]=c}return a}parseSkeletons(e,a){const o={},s={};if(a.traverse(function(c){c.isBone&&(s[c.uuid]=c)}),e!==void 0)for(let c=0,d=e.length;c<d;c++){const f=new IT().fromJSON(e[c],s);o[f.uuid]=f}return o}parseGeometries(e,a){const o={};if(e!==void 0){const s=new CY;for(let c=0,d=e.length;c<d;c++){let f;const m=e[c];switch(m.type){case"BufferGeometry":case"InstancedBufferGeometry":f=s.parse(m);break;default:m.type in KW?f=KW[m.type].fromJSON(m,a):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${m.type}"`)}f.uuid=m.uuid,m.name!==void 0&&(f.name=m.name),m.userData!==void 0&&(f.userData=m.userData),o[m.uuid]=f}}return o}parseMaterials(e,a){const o={},s={};if(e!==void 0){const c=new $T;c.setTextures(a);for(let d=0,f=e.length;d<f;d++){const m=e[d];o[m.uuid]===void 0&&(o[m.uuid]=c.parse(m)),s[m.uuid]=o[m.uuid]}}return s}parseAnimations(e){const a={};if(e!==void 0)for(let o=0;o<e.length;o++){const s=e[o],c=Kx.parse(s);a[c.uuid]=c}return a}parseImages(e,a){const o=this,s={};let c;function d(m){return o.manager.itemStart(m),c.load(m,function(){o.manager.itemEnd(m)},void 0,function(){o.manager.itemError(m),o.manager.itemEnd(m)})}function f(m){if(typeof m=="string"){const y=m,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:o.resourcePath+y;return d(_)}else return m.data?{data:y0(m.type,m.data),width:m.width,height:m.height}:null}if(e!==void 0&&e.length>0){const m=new o6(a);c=new Jx(m),c.setCrossOrigin(this.crossOrigin);for(let y=0,_=e.length;y<_;y++){const w=e[y],A=w.url;if(Array.isArray(A)){const C=[];for(let I=0,k=A.length;I<k;I++){const D=A[I],L=f(D);L!==null&&(L instanceof HTMLImageElement?C.push(L):C.push(new k0(L.data,L.width,L.height)))}s[w.uuid]=new dg(C)}else{const C=f(w.url);s[w.uuid]=new dg(C)}}}return s}async parseImagesAsync(e){const a=this,o={};let s;async function c(d){if(typeof d=="string"){const f=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:a.resourcePath+f;return await s.loadAsync(m)}else return d.data?{data:y0(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){s=new Jx(this.manager),s.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const m=e[d],y=m.url;if(Array.isArray(y)){const _=[];for(let w=0,A=y.length;w<A;w++){const C=y[w],I=await c(C);I!==null&&(I instanceof HTMLImageElement?_.push(I):_.push(new k0(I.data,I.width,I.height)))}o[m.uuid]=new dg(_)}else{const _=await c(m.url);o[m.uuid]=new dg(_)}}}return o}parseTextures(e,a){function o(c,d){return typeof c=="number"?c:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",c),d[c])}const s={};if(e!==void 0)for(let c=0,d=e.length;c<d;c++){const f=e[c];f.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid),a[f.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",f.image);const m=a[f.image],y=m.data;let _;Array.isArray(y)?(_=new Pw,y.length===6&&(_.needsUpdate=!0)):(y&&y.data?_=new k0:_=new Lr,y&&(_.needsUpdate=!0)),_.source=m,_.uuid=f.uuid,f.name!==void 0&&(_.name=f.name),f.mapping!==void 0&&(_.mapping=o(f.mapping,m2e)),f.channel!==void 0&&(_.channel=f.channel),f.offset!==void 0&&_.offset.fromArray(f.offset),f.repeat!==void 0&&_.repeat.fromArray(f.repeat),f.center!==void 0&&_.center.fromArray(f.center),f.rotation!==void 0&&(_.rotation=f.rotation),f.wrap!==void 0&&(_.wrapS=o(f.wrap[0],tV),_.wrapT=o(f.wrap[1],tV)),f.format!==void 0&&(_.format=f.format),f.internalFormat!==void 0&&(_.internalFormat=f.internalFormat),f.type!==void 0&&(_.type=f.type),f.colorSpace!==void 0&&(_.colorSpace=f.colorSpace),f.encoding!==void 0&&(_.encoding=f.encoding),f.minFilter!==void 0&&(_.minFilter=o(f.minFilter,nV)),f.magFilter!==void 0&&(_.magFilter=o(f.magFilter,nV)),f.anisotropy!==void 0&&(_.anisotropy=f.anisotropy),f.flipY!==void 0&&(_.flipY=f.flipY),f.generateMipmaps!==void 0&&(_.generateMipmaps=f.generateMipmaps),f.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(_.unpackAlignment=f.unpackAlignment),f.compareFunction!==void 0&&(_.compareFunction=f.compareFunction),f.userData!==void 0&&(_.userData=f.userData),s[f.uuid]=_}return s}parseObject(e,a,o,s,c){let d;function f(A){return a[A]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",A),a[A]}function m(A){if(A!==void 0){if(Array.isArray(A)){const C=[];for(let I=0,k=A.length;I<k;I++){const D=A[I];o[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),C.push(o[D])}return C}return o[A]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",A),o[A]}}function y(A){return s[A]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",A),s[A]}let _,w;switch(e.type){case"Scene":d=new GE,e.background!==void 0&&(Number.isInteger(e.background)?d.background=new Pn(e.background):d.background=y(e.background)),e.environment!==void 0&&(d.environment=y(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?d.fog=new CT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(d.fog=new TT(e.fog.color,e.fog.density)),e.fog.name!==""&&(d.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(d.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(d.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":d=new jr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(d.focus=e.focus),e.zoom!==void 0&&(d.zoom=e.zoom),e.filmGauge!==void 0&&(d.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(d.filmOffset=e.filmOffset),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"OrthographicCamera":d=new Ah(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(d.zoom=e.zoom),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"AmbientLight":d=new AY(e.color,e.intensity);break;case"DirectionalLight":d=new SY(e.color,e.intensity);break;case"PointLight":d=new wY(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":d=new EY(e.color,e.intensity,e.width,e.height);break;case"SpotLight":d=new xY(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":d=new bY(e.color,e.groundColor,e.intensity);break;case"LightProbe":d=new TY().fromJSON(e);break;case"SkinnedMesh":_=f(e.geometry),w=m(e.material),d=new HZ(_,w),e.bindMode!==void 0&&(d.bindMode=e.bindMode),e.bindMatrix!==void 0&&d.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(d.skeleton=e.skeleton);break;case"Mesh":_=f(e.geometry),w=m(e.material),d=new bo(_,w);break;case"InstancedMesh":_=f(e.geometry),w=m(e.material);const A=e.count,C=e.instanceMatrix,I=e.instanceColor;d=new jZ(_,w,A),d.instanceMatrix=new kg(new Float32Array(C.array),16),I!==void 0&&(d.instanceColor=new kg(new Float32Array(I.array),I.itemSize));break;case"LOD":d=new GZ;break;case"Line":d=new _p(f(e.geometry),m(e.material));break;case"LineLoop":d=new $Z(f(e.geometry),m(e.material));break;case"LineSegments":d=new bd(f(e.geometry),m(e.material));break;case"PointCloud":case"Points":d=new qZ(f(e.geometry),m(e.material));break;case"Sprite":d=new VZ(m(e.material));break;case"Group":d=new _0;break;case"Bone":d=new XD;break;default:d=new fi}if(d.uuid=e.uuid,e.name!==void 0&&(d.name=e.name),e.matrix!==void 0?(d.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(d.matrixAutoUpdate=e.matrixAutoUpdate),d.matrixAutoUpdate&&d.matrix.decompose(d.position,d.quaternion,d.scale)):(e.position!==void 0&&d.position.fromArray(e.position),e.rotation!==void 0&&d.rotation.fromArray(e.rotation),e.quaternion!==void 0&&d.quaternion.fromArray(e.quaternion),e.scale!==void 0&&d.scale.fromArray(e.scale)),e.up!==void 0&&d.up.fromArray(e.up),e.castShadow!==void 0&&(d.castShadow=e.castShadow),e.receiveShadow!==void 0&&(d.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(d.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(d.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(d.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&d.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(d.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(d.visible=e.visible),e.frustumCulled!==void 0&&(d.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(d.renderOrder=e.renderOrder),e.userData!==void 0&&(d.userData=e.userData),e.layers!==void 0&&(d.layers.mask=e.layers),e.children!==void 0){const A=e.children;for(let C=0;C<A.length;C++)d.add(this.parseObject(A[C],a,o,s,c))}if(e.animations!==void 0){const A=e.animations;for(let C=0;C<A.length;C++){const I=A[C];d.animations.push(c[I])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(d.autoUpdate=e.autoUpdate);const A=e.levels;for(let C=0;C<A.length;C++){const I=A[C],k=d.getObjectByProperty("uuid",I.object);k!==void 0&&d.addLevel(k,I.distance,I.hysteresis)}}return d}bindSkeletons(e,a){Object.keys(a).length!==0&&e.traverse(function(o){if(o.isSkinnedMesh===!0&&o.skeleton!==void 0){const s=a[o.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",o.skeleton):o.bind(s,o.bindMatrix)}})}}const m2e={UVMapping:vT,CubeReflectionMapping:Fh,CubeRefractionMapping:yp,EquirectangularReflectionMapping:Rx,EquirectangularRefractionMapping:kx,CubeUVReflectionMapping:u_},tV={RepeatWrapping:Dx,ClampToEdgeWrapping:ms,MirroredRepeatWrapping:Ox},nV={NearestFilter:ro,NearestMipmapNearestFilter:UE,NearestMipmapLinearFilter:qb,LinearFilter:Cr,LinearMipmapNearestFilter:PD,LinearMipmapLinearFilter:vp};class g2e extends wl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,a,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,d=Og.get(e);if(d!==void 0)return c.manager.itemStart(e),setTimeout(function(){a&&a(d),c.manager.itemEnd(e)},0),d;const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader,fetch(e,f).then(function(m){return m.blob()}).then(function(m){return createImageBitmap(m,Object.assign(c.options,{colorSpaceConversion:"none"}))}).then(function(m){Og.add(e,m),a&&a(m),c.manager.itemEnd(e)}).catch(function(m){s&&s(m),c.manager.itemError(e),c.manager.itemEnd(e)}),c.manager.itemStart(e)}}let US;class c6{static getContext(){return US===void 0&&(US=new(window.AudioContext||window.webkitAudioContext)),US}static setContext(e){US=e}}class y2e extends wl{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Nh(this.manager);d.setResponseType("arraybuffer"),d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(m){try{const y=m.slice(0);c6.getContext().decodeAudioData(y,function(w){a(w)},f)}catch(y){f(y)}},o,s);function f(m){s?s(m):console.error(m),c.manager.itemError(e)}}}const aV=new Ia,iV=new Ia,Om=new Ia;class v2e{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new jr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new jr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const a=this._cache;if(a.focus!==e.focus||a.fov!==e.fov||a.aspect!==e.aspect*this.aspect||a.near!==e.near||a.far!==e.far||a.zoom!==e.zoom||a.eyeSep!==this.eyeSep){a.focus=e.focus,a.fov=e.fov,a.aspect=e.aspect*this.aspect,a.near=e.near,a.far=e.far,a.zoom=e.zoom,a.eyeSep=this.eyeSep,Om.copy(e.projectionMatrix);const s=a.eyeSep/2,c=s*a.near/a.focus,d=a.near*Math.tan(vg*a.fov*.5)/a.zoom;let f,m;iV.elements[12]=-s,aV.elements[12]=s,f=-d*a.aspect+c,m=d*a.aspect+c,Om.elements[0]=2*a.near/(m-f),Om.elements[8]=(m+f)/(m-f),this.cameraL.projectionMatrix.copy(Om),f=-d*a.aspect-c,m=d*a.aspect-c,Om.elements[0]=2*a.near/(m-f),Om.elements[8]=(m+f)/(m-f),this.cameraR.projectionMatrix.copy(Om)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(iV),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(aV)}}class u6{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=rV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const a=rV();e=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=e}return e}}function rV(){return(typeof performance>"u"?Date:performance).now()}const zm=new Fe,oV=new _s,_2e=new Fe,Fm=new Fe;class b2e extends fi{constructor(){super(),this.type="AudioListener",this.context=c6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new u6}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const a=this.context.listener,o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(zm,oV,_2e),Fm.set(0,0,-1).applyQuaternion(oV),a.positionX){const s=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(zm.x,s),a.positionY.linearRampToValueAtTime(zm.y,s),a.positionZ.linearRampToValueAtTime(zm.z,s),a.forwardX.linearRampToValueAtTime(Fm.x,s),a.forwardY.linearRampToValueAtTime(Fm.y,s),a.forwardZ.linearRampToValueAtTime(Fm.z,s),a.upX.linearRampToValueAtTime(o.x,s),a.upY.linearRampToValueAtTime(o.y,s),a.upZ.linearRampToValueAtTime(o.z,s)}else a.setPosition(zm.x,zm.y,zm.z),a.setOrientation(Fm.x,Fm.y,Fm.z,o.x,o.y,o.z)}}class PY extends fi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,a=this.filters.length;e<a;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,a=this.filters.length;e<a;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Nm=new Fe,sV=new _s,x2e=new Fe,Bm=new Fe;class w2e extends PY{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,a,o){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=a,this.panner.coneOuterGain=o,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Nm,sV,x2e),Bm.set(0,0,1).applyQuaternion(sV);const a=this.panner;if(a.positionX){const o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Nm.x,o),a.positionY.linearRampToValueAtTime(Nm.y,o),a.positionZ.linearRampToValueAtTime(Nm.z,o),a.orientationX.linearRampToValueAtTime(Bm.x,o),a.orientationY.linearRampToValueAtTime(Bm.y,o),a.orientationZ.linearRampToValueAtTime(Bm.z,o)}else a.setPosition(Nm.x,Nm.y,Nm.z),a.setOrientation(Bm.x,Bm.y,Bm.z)}}class S2e{constructor(e,a=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=a,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const a=this.getFrequencyData();for(let o=0;o<a.length;o++)e+=a[o];return e/a.length}}class IY{constructor(e,a,o){this.binding=e,this.valueSize=o;let s,c,d;switch(a){case"quaternion":s=this._slerp,c=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(o*6),this._workIndex=5;break;case"string":case"bool":s=this._select,c=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(o*5);break;default:s=this._lerp,c=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(o*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=c,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,a){const o=this.buffer,s=this.valueSize,c=e*s+s;let d=this.cumulativeWeight;if(d===0){for(let f=0;f!==s;++f)o[c+f]=o[f];d=a}else{d+=a;const f=a/d;this._mixBufferRegion(o,c,0,f,s)}this.cumulativeWeight=d}accumulateAdditive(e){const a=this.buffer,o=this.valueSize,s=o*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(a,s,0,e,o),this.cumulativeWeightAdditive+=e}apply(e){const a=this.valueSize,o=this.buffer,s=e*a+a,c=this.cumulativeWeight,d=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,c<1){const m=a*this._origIndex;this._mixBufferRegion(o,s,m,1-c,a)}d>0&&this._mixBufferRegionAdditive(o,s,this._addIndex*a,1,a);for(let m=a,y=a+a;m!==y;++m)if(o[m]!==o[m+a]){f.setValue(o,s);break}}saveOriginalState(){const e=this.binding,a=this.buffer,o=this.valueSize,s=o*this._origIndex;e.getValue(a,s);for(let c=o,d=s;c!==d;++c)a[c]=a[s+c%o];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,a=e+this.valueSize;for(let o=e;o<a;o++)this.buffer[o]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,a=this._addIndex*this.valueSize;for(let o=0;o<this.valueSize;o++)this.buffer[a+o]=this.buffer[e+o]}_select(e,a,o,s,c){if(s>=.5)for(let d=0;d!==c;++d)e[a+d]=e[o+d]}_slerp(e,a,o,s){_s.slerpFlat(e,a,e,a,e,o,s)}_slerpAdditive(e,a,o,s,c){const d=this._workIndex*c;_s.multiplyQuaternionsFlat(e,d,e,a,e,o),_s.slerpFlat(e,a,e,a,e,d,s)}_lerp(e,a,o,s,c){const d=1-s;for(let f=0;f!==c;++f){const m=a+f;e[m]=e[m]*d+e[o+f]*s}}_lerpAdditive(e,a,o,s,c){for(let d=0;d!==c;++d){const f=a+d;e[f]=e[f]+e[o+d]*s}}}const d6="\\[\\]\\.:\\/",A2e=new RegExp("["+d6+"]","g"),h6="[^"+d6+"]",E2e="[^"+d6.replace("\\.","")+"]",M2e=/((?:WC+[\/:])*)/.source.replace("WC",h6),T2e=/(WCOD+)?/.source.replace("WCOD",E2e),C2e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",h6),P2e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",h6),I2e=new RegExp("^"+M2e+T2e+C2e+P2e+"$"),L2e=["material","materials","bones","map"];class R2e{constructor(e,a,o){const s=o||oi.parseTrackName(a);this._targetGroup=e,this._bindings=e.subscribe_(a,s)}getValue(e,a){this.bind();const o=this._targetGroup.nCachedObjects_,s=this._bindings[o];s!==void 0&&s.getValue(e,a)}setValue(e,a){const o=this._bindings;for(let s=this._targetGroup.nCachedObjects_,c=o.length;s!==c;++s)o[s].setValue(e,a)}bind(){const e=this._bindings;for(let a=this._targetGroup.nCachedObjects_,o=e.length;a!==o;++a)e[a].bind()}unbind(){const e=this._bindings;for(let a=this._targetGroup.nCachedObjects_,o=e.length;a!==o;++a)e[a].unbind()}}class oi{constructor(e,a,o){this.path=a,this.parsedPath=o||oi.parseTrackName(a),this.node=oi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,a,o){return e&&e.isAnimationObjectGroup?new oi.Composite(e,a,o):new oi(e,a,o)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(A2e,"")}static parseTrackName(e){const a=I2e.exec(e);if(a===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const o={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]},s=o.nodeName&&o.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const c=o.nodeName.substring(s+1);L2e.indexOf(c)!==-1&&(o.nodeName=o.nodeName.substring(0,s),o.objectName=c)}if(o.propertyName===null||o.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o}static findNode(e,a){if(a===void 0||a===""||a==="."||a===-1||a===e.name||a===e.uuid)return e;if(e.skeleton){const o=e.skeleton.getBoneByName(a);if(o!==void 0)return o}if(e.children){const o=function(c){for(let d=0;d<c.length;d++){const f=c[d];if(f.name===a||f.uuid===a)return f;const m=o(f.children);if(m)return m}return null},s=o(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,a){e[a]=this.targetObject[this.propertyName]}_getValue_array(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)e[a++]=o[s]}_getValue_arrayElement(e,a){e[a]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,a){this.resolvedProperty.toArray(e,a)}_setValue_direct(e,a){this.targetObject[this.propertyName]=e[a]}_setValue_direct_setNeedsUpdate(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++]}_setValue_array_setNeedsUpdate(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,a){this.resolvedProperty[this.propertyIndex]=e[a]}_setValue_arrayElement_setNeedsUpdate(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,a){this.resolvedProperty.fromArray(e,a)}_setValue_fromArray_setNeedsUpdate(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,a){this.bind(),this.getValue(e,a)}_setValue_unbound(e,a){this.bind(),this.setValue(e,a)}bind(){let e=this.node;const a=this.parsedPath,o=a.objectName,s=a.propertyName;let c=a.propertyIndex;if(e||(e=oi.findNode(this.rootNode,a.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(o){let y=a.objectIndex;switch(o){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===y){y=_;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[o]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[o]}if(y!==void 0){if(e[y]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[y]}}const d=e[s];if(d===void 0){const y=a.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+s+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(c!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[c]!==void 0&&(c=e.morphTargetDictionary[c])}m=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=c}else d.fromArray!==void 0&&d.toArray!==void 0?(m=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(m=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=s;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}oi.Composite=R2e;oi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};oi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};oi.prototype.GetterByBindingType=[oi.prototype._getValue_direct,oi.prototype._getValue_array,oi.prototype._getValue_arrayElement,oi.prototype._getValue_toArray];oi.prototype.SetterByBindingTypeAndVersioning=[[oi.prototype._setValue_direct,oi.prototype._setValue_direct_setNeedsUpdate,oi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_array,oi.prototype._setValue_array_setNeedsUpdate,oi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_arrayElement,oi.prototype._setValue_arrayElement_setNeedsUpdate,oi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[oi.prototype._setValue_fromArray,oi.prototype._setValue_fromArray_setNeedsUpdate,oi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class k2e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=$l(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let o=0,s=arguments.length;o!==s;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}add(){const e=this._objects,a=this._indicesByUUID,o=this._paths,s=this._parsedPaths,c=this._bindings,d=c.length;let f,m=e.length,y=this.nCachedObjects_;for(let _=0,w=arguments.length;_!==w;++_){const A=arguments[_],C=A.uuid;let I=a[C];if(I===void 0){I=m++,a[C]=I,e.push(A);for(let k=0,D=d;k!==D;++k)c[k].push(new oi(A,o[k],s[k]))}else if(I<y){f=e[I];const k=--y,D=e[k];a[D.uuid]=I,e[I]=D,a[C]=k,e[k]=A;for(let L=0,O=d;L!==O;++L){const F=c[L],B=F[k];let G=F[I];F[I]=B,G===void 0&&(G=new oi(A,o[L],s[L])),F[k]=G}}else e[I]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const e=this._objects,a=this._indicesByUUID,o=this._bindings,s=o.length;let c=this.nCachedObjects_;for(let d=0,f=arguments.length;d!==f;++d){const m=arguments[d],y=m.uuid,_=a[y];if(_!==void 0&&_>=c){const w=c++,A=e[w];a[A.uuid]=_,e[_]=A,a[y]=w,e[w]=m;for(let C=0,I=s;C!==I;++C){const k=o[C],D=k[w],L=k[_];k[_]=D,k[w]=L}}}this.nCachedObjects_=c}uncache(){const e=this._objects,a=this._indicesByUUID,o=this._bindings,s=o.length;let c=this.nCachedObjects_,d=e.length;for(let f=0,m=arguments.length;f!==m;++f){const y=arguments[f],_=y.uuid,w=a[_];if(w!==void 0)if(delete a[_],w<c){const A=--c,C=e[A],I=--d,k=e[I];a[C.uuid]=w,e[w]=C,a[k.uuid]=A,e[A]=k,e.pop();for(let D=0,L=s;D!==L;++D){const O=o[D],F=O[A],B=O[I];O[w]=F,O[A]=B,O.pop()}}else{const A=--d,C=e[A];A>0&&(a[C.uuid]=w),e[w]=C,e.pop();for(let I=0,k=s;I!==k;++I){const D=o[I];D[w]=D[A],D.pop()}}}this.nCachedObjects_=c}subscribe_(e,a){const o=this._bindingsIndicesByPath;let s=o[e];const c=this._bindings;if(s!==void 0)return c[s];const d=this._paths,f=this._parsedPaths,m=this._objects,y=m.length,_=this.nCachedObjects_,w=new Array(y);s=c.length,o[e]=s,d.push(e),f.push(a),c.push(w);for(let A=_,C=m.length;A!==C;++A){const I=m[A];w[A]=new oi(I,e,a)}return w}unsubscribe_(e){const a=this._bindingsIndicesByPath,o=a[e];if(o!==void 0){const s=this._paths,c=this._parsedPaths,d=this._bindings,f=d.length-1,m=d[f],y=e[f];a[y]=o,d[o]=m,d.pop(),c[o]=c[f],c.pop(),s[o]=s[f],s.pop()}}}class LY{constructor(e,a,o=null,s=a.blendMode){this._mixer=e,this._clip=a,this._localRoot=o,this.blendMode=s;const c=a.tracks,d=c.length,f=new Array(d),m={endingStart:cg,endingEnd:cg};for(let y=0;y!==d;++y){const _=c[y].createInterpolant(null);f[y]=_,_.settings=m}this._interpolantSettings=m,this._interpolants=f,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=hZ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,a){return this.loop=e,this.repetitions=a,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,a,o){if(e.fadeOut(a),this.fadeIn(a),o){const s=this._clip.duration,c=e._clip.duration,d=c/s,f=s/c;e.warp(1,d,a),this.warp(f,1,a)}return this}crossFadeTo(e,a,o){return e.crossFadeFrom(this,a,o)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,a,o){const s=this._mixer,c=s.time,d=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=s._lendControlInterpolant(),this._timeScaleInterpolant=f);const m=f.parameterPositions,y=f.sampleValues;return m[0]=c,m[1]=c+o,y[0]=e/d,y[1]=a/d,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,a,o,s){if(!this.enabled){this._updateWeight(e);return}const c=this._startTime;if(c!==null){const m=(e-c)*o;m<0||o===0?a=0:(this._startTime=null,a=o*m)}a*=this._updateTimeScale(e);const d=this._updateTime(a),f=this._updateWeight(e);if(f>0){const m=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case zD:for(let _=0,w=m.length;_!==w;++_)m[_].evaluate(d),y[_].accumulateAdditive(f);break;case bT:default:for(let _=0,w=m.length;_!==w;++_)m[_].evaluate(d),y[_].accumulate(s,f)}}}_updateWeight(e){let a=0;if(this.enabled){a=this.weight;const o=this._weightInterpolant;if(o!==null){const s=o.evaluate(e)[0];a*=s,e>o.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=a,a}_updateTimeScale(e){let a=0;if(!this.paused){a=this.timeScale;const o=this._timeScaleInterpolant;if(o!==null){const s=o.evaluate(e)[0];a*=s,e>o.parameterPositions[1]&&(this.stopWarping(),a===0?this.paused=!0:this.timeScale=a)}}return this._effectiveTimeScale=a,a}_updateTime(e){const a=this._clip.duration,o=this.loop;let s=this.time+e,c=this._loopCount;const d=o===fZ;if(e===0)return c===-1?s:d&&(c&1)===1?a-s:s;if(o===dZ){c===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=a)s=a;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(c===-1&&(e>=0?(c=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),s>=a||s<0){const f=Math.floor(s/a);s-=a*f,c+=Math.abs(f);const m=this.repetitions-c;if(m<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?a:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(m===1){const y=e<0;this._setEndings(y,!y,d)}else this._setEndings(!1,!1,d);this._loopCount=c,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=s;if(d&&(c&1)===1)return a-s}return s}_setEndings(e,a,o){const s=this._interpolantSettings;o?(s.endingStart=ug,s.endingEnd=ug):(e?s.endingStart=this.zeroSlopeAtStart?ug:cg:s.endingStart=Nx,a?s.endingEnd=this.zeroSlopeAtEnd?ug:cg:s.endingEnd=Nx)}_scheduleFading(e,a,o){const s=this._mixer,c=s.time;let d=this._weightInterpolant;d===null&&(d=s._lendControlInterpolant(),this._weightInterpolant=d);const f=d.parameterPositions,m=d.sampleValues;return f[0]=c,m[0]=a,f[1]=c+e,m[1]=o,this}}const D2e=new Float32Array(1);class O2e extends _d{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,a){const o=e._localRoot||this._root,s=e._clip.tracks,c=s.length,d=e._propertyBindings,f=e._interpolants,m=o.uuid,y=this._bindingsByRootAndName;let _=y[m];_===void 0&&(_={},y[m]=_);for(let w=0;w!==c;++w){const A=s[w],C=A.name;let I=_[C];if(I!==void 0)++I.referenceCount,d[w]=I;else{if(I=d[w],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,m,C));continue}const k=a&&a._propertyBindings[w].binding.parsedPath;I=new IY(oi.create(o,C,k),A.ValueTypeName,A.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,m,C),d[w]=I}f[w].resultBuffer=I.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const o=(e._localRoot||this._root).uuid,s=e._clip.uuid,c=this._actionsByClip[s];this._bindAction(e,c&&c.knownActions[0]),this._addInactiveAction(e,s,o)}const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];c.useCount++===0&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];--c.useCount===0&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const a=e._cacheIndex;return a!==null&&a<this._nActiveActions}_addInactiveAction(e,a,o){const s=this._actions,c=this._actionsByClip;let d=c[a];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,c[a]=d;else{const f=d.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=s.length,s.push(e),d.actionByRoot[o]=e}_removeInactiveAction(e){const a=this._actions,o=a[a.length-1],s=e._cacheIndex;o._cacheIndex=s,a[s]=o,a.pop(),e._cacheIndex=null;const c=e._clip.uuid,d=this._actionsByClip,f=d[c],m=f.knownActions,y=m[m.length-1],_=e._byClipCacheIndex;y._byClipCacheIndex=_,m[_]=y,m.pop(),e._byClipCacheIndex=null;const w=f.actionByRoot,A=(e._localRoot||this._root).uuid;delete w[A],m.length===0&&delete d[c],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];--c.referenceCount===0&&this._removeInactiveBinding(c)}}_lendAction(e){const a=this._actions,o=e._cacheIndex,s=this._nActiveActions++,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_takeBackAction(e){const a=this._actions,o=e._cacheIndex,s=--this._nActiveActions,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_addInactiveBinding(e,a,o){const s=this._bindingsByRootAndName,c=this._bindings;let d=s[a];d===void 0&&(d={},s[a]=d),d[o]=e,e._cacheIndex=c.length,c.push(e)}_removeInactiveBinding(e){const a=this._bindings,o=e.binding,s=o.rootNode.uuid,c=o.path,d=this._bindingsByRootAndName,f=d[s],m=a[a.length-1],y=e._cacheIndex;m._cacheIndex=y,a[y]=m,a.pop(),delete f[c],Object.keys(f).length===0&&delete d[s]}_lendBinding(e){const a=this._bindings,o=e._cacheIndex,s=this._nActiveBindings++,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_takeBackBinding(e){const a=this._bindings,o=e._cacheIndex,s=--this._nActiveBindings,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_lendControlInterpolant(){const e=this._controlInterpolants,a=this._nActiveControlInterpolants++;let o=e[a];return o===void 0&&(o=new i6(new Float32Array(2),new Float32Array(2),1,D2e),o.__cacheIndex=a,e[a]=o),o}_takeBackControlInterpolant(e){const a=this._controlInterpolants,o=e.__cacheIndex,s=--this._nActiveControlInterpolants,c=a[s];e.__cacheIndex=s,a[s]=e,c.__cacheIndex=o,a[o]=c}clipAction(e,a,o){const s=a||this._root,c=s.uuid;let d=typeof e=="string"?Kx.findByName(s,e):e;const f=d!==null?d.uuid:e,m=this._actionsByClip[f];let y=null;if(o===void 0&&(d!==null?o=d.blendMode:o=bT),m!==void 0){const w=m.actionByRoot[c];if(w!==void 0&&w.blendMode===o)return w;y=m.knownActions[0],d===null&&(d=y._clip)}if(d===null)return null;const _=new LY(this,d,a,o);return this._bindAction(_,y),this._addInactiveAction(_,f,c),_}existingAction(e,a){const o=a||this._root,s=o.uuid,c=typeof e=="string"?Kx.findByName(o,e):e,d=c?c.uuid:e,f=this._actionsByClip[d];return f!==void 0&&f.actionByRoot[s]||null}stopAllAction(){const e=this._actions,a=this._nActiveActions;for(let o=a-1;o>=0;--o)e[o].stop();return this}update(e){e*=this.timeScale;const a=this._actions,o=this._nActiveActions,s=this.time+=e,c=Math.sign(e),d=this._accuIndex^=1;for(let y=0;y!==o;++y)a[y]._update(s,e,c,d);const f=this._bindings,m=this._nActiveBindings;for(let y=0;y!==m;++y)f[y].apply(d);return this}setTime(e){this.time=0;for(let a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const a=this._actions,o=e.uuid,s=this._actionsByClip,c=s[o];if(c!==void 0){const d=c.knownActions;for(let f=0,m=d.length;f!==m;++f){const y=d[f];this._deactivateAction(y);const _=y._cacheIndex,w=a[a.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,w._cacheIndex=_,a[_]=w,a.pop(),this._removeInactiveBindingsForAction(y)}delete s[o]}}uncacheRoot(e){const a=e.uuid,o=this._actionsByClip;for(const d in o){const f=o[d].actionByRoot,m=f[a];m!==void 0&&(this._deactivateAction(m),this._removeInactiveAction(m))}const s=this._bindingsByRootAndName,c=s[a];if(c!==void 0)for(const d in c){const f=c[d];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(e,a){const o=this.existingAction(e,a);o!==null&&(this._deactivateAction(o),this._removeInactiveAction(o))}}class f6{constructor(e){this.value=e}clone(){return new f6(this.value.clone===void 0?this.value:this.value.clone())}}let z2e=0;class F2e extends _d{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:z2e++}),this.name="",this.usage=Vx,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const a=this.uniforms.indexOf(e);return a!==-1&&this.uniforms.splice(a,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const a=e.uniforms;this.uniforms.length=0;for(let o=0,s=a.length;o<s;o++)this.uniforms.push(a[o].clone());return this}clone(){return new this.constructor().copy(this)}}class N2e extends PT{constructor(e,a,o=1){super(e,a),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const a=super.clone(e);return a.meshPerAttribute=this.meshPerAttribute,a}toJSON(e){const a=super.toJSON(e);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a}}class B2e{constructor(e,a,o,s,c){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=a,this.itemSize=o,this.elementSize=s,this.count=c,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,a){return this.type=e,this.elementSize=a,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class RY{constructor(e,a,o=0,s=1/0){this.ray=new Wg(e,a),this.near=o,this.far=s,this.camera=null,this.layers=new _g,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,a){this.ray.set(e,a)}setFromCamera(e,a){a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type: "+a.type)}intersectObject(e,a=!0,o=[]){return vR(e,this,o,a),o.sort(lV),o}intersectObjects(e,a=!0,o=[]){for(let s=0,c=e.length;s<c;s++)vR(e[s],this,o,a);return o.sort(lV),o}}function lV(n,e){return n.distance-e.distance}function vR(n,e,a,o){if(n.layers.test(e.layers)&&n.raycast(e,a),o===!0){const s=n.children;for(let c=0,d=s.length;c<d;c++)vR(s[c],e,a,!0)}}class _R{constructor(e=1,a=0,o=0){return this.radius=e,this.phi=a,this.theta=o,this}set(e,a,o){return this.radius=e,this.phi=a,this.theta=o,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,a,o){return this.radius=Math.sqrt(e*e+a*a+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,o),this.phi=Math.acos(Hr(a/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class U2e{constructor(e=1,a=0,o=0){return this.radius=e,this.theta=a,this.y=o,this}set(e,a,o){return this.radius=e,this.theta=a,this.y=o,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,a,o){return this.radius=Math.sqrt(e*e+o*o),this.theta=Math.atan2(e,o),this.y=a,this}clone(){return new this.constructor().copy(this)}}const cV=new Kt;class W2e{constructor(e=new Kt(1/0,1/0),a=new Kt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=a}set(e,a){return this.min.copy(e),this.max.copy(a),this}setFromPoints(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a++)this.expandByPoint(e[a]);return this}setFromCenterAndSize(e,a){const o=cV.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,a){return a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,a){return a.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,cV).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const uV=new Fe,WS=new Fe;class V2e{constructor(e=new Fe,a=new Fe){this.start=e,this.end=a}set(e,a){return this.start.copy(e),this.end.copy(a),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,a){return this.delta(a).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,a){uV.subVectors(e,this.start),WS.subVectors(this.end,this.start);const o=WS.dot(WS);let c=WS.dot(uV)/o;return a&&(c=Hr(c,0,1)),c}closestPointToPoint(e,a,o){const s=this.closestPointToPointParameter(e,a);return this.delta(o).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const dV=new Fe;class G2e extends fi{constructor(e,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="SpotLightHelper";const o=new La,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,f=1,m=32;d<m;d++,f++){const y=d/m*Math.PI*2,_=f/m*Math.PI*2;s.push(Math.cos(y),Math.sin(y),1,Math.cos(_),Math.sin(_),1)}o.setAttribute("position",new Wn(s,3));const c=new js({fog:!1,toneMapped:!1});this.cone=new bd(o,c),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,a=e*Math.tan(this.light.angle);this.cone.scale.set(a,a,e),dV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Ff=new Fe,VS=new Ia,N4=new Ia;class H2e extends bd{constructor(e){const a=kY(e),o=new La,s=[],c=[],d=new Pn(0,0,1),f=new Pn(0,1,0);for(let y=0;y<a.length;y++){const _=a[y];_.parent&&_.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),c.push(d.r,d.g,d.b),c.push(f.r,f.g,f.b))}o.setAttribute("position",new Wn(s,3)),o.setAttribute("color",new Wn(c,3));const m=new js({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(o,m),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=a,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const a=this.bones,o=this.geometry,s=o.getAttribute("position");N4.copy(this.root.matrixWorld).invert();for(let c=0,d=0;c<a.length;c++){const f=a[c];f.parent&&f.parent.isBone&&(VS.multiplyMatrices(N4,f.matrixWorld),Ff.setFromMatrixPosition(VS),s.setXYZ(d,Ff.x,Ff.y,Ff.z),VS.multiplyMatrices(N4,f.parent.matrixWorld),Ff.setFromMatrixPosition(VS),s.setXYZ(d+1,Ff.x,Ff.y,Ff.z),d+=2)}o.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function kY(n){const e=[];n.isBone===!0&&e.push(n);for(let a=0;a<n.children.length;a++)e.push.apply(e,kY(n.children[a]));return e}class j2e extends bo{constructor(e,a,o){const s=new Rw(a,4,2),c=new Vh({wireframe:!0,fog:!1,toneMapped:!1});super(s,c),this.light=e,this.color=o,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const $2e=new Fe,hV=new Pn,fV=new Pn;class q2e extends fi{constructor(e,a,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="HemisphereLightHelper";const s=new Lw(a);s.rotateY(Math.PI*.5),this.material=new Vh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const c=s.getAttribute("position"),d=new Float32Array(c.count*3);s.setAttribute("color",new qi(d,3)),this.add(new bo(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const a=e.geometry.getAttribute("color");hV.copy(this.light.color),fV.copy(this.light.groundColor);for(let o=0,s=a.count;o<s;o++){const c=o<s/2?hV:fV;a.setXYZ(o,c.r,c.g,c.b)}a.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt($2e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class X2e extends bd{constructor(e=10,a=10,o=4473924,s=8947848){o=new Pn(o),s=new Pn(s);const c=a/2,d=e/a,f=e/2,m=[],y=[];for(let A=0,C=0,I=-f;A<=a;A++,I+=d){m.push(-f,0,I,f,0,I),m.push(I,0,-f,I,0,f);const k=A===c?o:s;k.toArray(y,C),C+=3,k.toArray(y,C),C+=3,k.toArray(y,C),C+=3,k.toArray(y,C),C+=3}const _=new La;_.setAttribute("position",new Wn(m,3)),_.setAttribute("color",new Wn(y,3));const w=new js({vertexColors:!0,toneMapped:!1});super(_,w),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class Z2e extends bd{constructor(e=10,a=16,o=8,s=64,c=4473924,d=8947848){c=new Pn(c),d=new Pn(d);const f=[],m=[];if(a>1)for(let w=0;w<a;w++){const A=w/a*(Math.PI*2),C=Math.sin(A)*e,I=Math.cos(A)*e;f.push(0,0,0),f.push(C,0,I);const k=w&1?c:d;m.push(k.r,k.g,k.b),m.push(k.r,k.g,k.b)}for(let w=0;w<o;w++){const A=w&1?c:d,C=e-e/o*w;for(let I=0;I<s;I++){let k=I/s*(Math.PI*2),D=Math.sin(k)*C,L=Math.cos(k)*C;f.push(D,0,L),m.push(A.r,A.g,A.b),k=(I+1)/s*(Math.PI*2),D=Math.sin(k)*C,L=Math.cos(k)*C,f.push(D,0,L),m.push(A.r,A.g,A.b)}}const y=new La;y.setAttribute("position",new Wn(f,3)),y.setAttribute("color",new Wn(m,3));const _=new js({vertexColors:!0,toneMapped:!1});super(y,_),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const pV=new Fe,GS=new Fe,mV=new Fe;class Y2e extends fi{constructor(e,a,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="DirectionalLightHelper",a===void 0&&(a=1);let s=new La;s.setAttribute("position",new Wn([-a,a,0,a,a,0,a,-a,0,-a,-a,0,-a,a,0],3));const c=new js({fog:!1,toneMapped:!1});this.lightPlane=new _p(s,c),this.add(this.lightPlane),s=new La,s.setAttribute("position",new Wn([0,0,0,0,0,1],3)),this.targetLine=new _p(s,c),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),pV.setFromMatrixPosition(this.light.matrixWorld),GS.setFromMatrixPosition(this.light.target.matrixWorld),mV.subVectors(GS,pV),this.lightPlane.lookAt(GS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(GS),this.targetLine.scale.z=mV.length()}}const HS=new Fe,Br=new Cw;class K2e extends bd{constructor(e){const a=new La,o=new js({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],c=[],d={};f("n1","n2"),f("n2","n4"),f("n4","n3"),f("n3","n1"),f("f1","f2"),f("f2","f4"),f("f4","f3"),f("f3","f1"),f("n1","f1"),f("n2","f2"),f("n3","f3"),f("n4","f4"),f("p","n1"),f("p","n2"),f("p","n3"),f("p","n4"),f("u1","u2"),f("u2","u3"),f("u3","u1"),f("c","t"),f("p","c"),f("cn1","cn2"),f("cn3","cn4"),f("cf1","cf2"),f("cf3","cf4");function f(I,k){m(I),m(k)}function m(I){s.push(0,0,0),c.push(0,0,0),d[I]===void 0&&(d[I]=[]),d[I].push(s.length/3-1)}a.setAttribute("position",new Wn(s,3)),a.setAttribute("color",new Wn(c,3)),super(a,o),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update();const y=new Pn(16755200),_=new Pn(16711680),w=new Pn(43775),A=new Pn(16777215),C=new Pn(3355443);this.setColors(y,_,w,A,C)}setColors(e,a,o,s,c){const f=this.geometry.getAttribute("color");f.setXYZ(0,e.r,e.g,e.b),f.setXYZ(1,e.r,e.g,e.b),f.setXYZ(2,e.r,e.g,e.b),f.setXYZ(3,e.r,e.g,e.b),f.setXYZ(4,e.r,e.g,e.b),f.setXYZ(5,e.r,e.g,e.b),f.setXYZ(6,e.r,e.g,e.b),f.setXYZ(7,e.r,e.g,e.b),f.setXYZ(8,e.r,e.g,e.b),f.setXYZ(9,e.r,e.g,e.b),f.setXYZ(10,e.r,e.g,e.b),f.setXYZ(11,e.r,e.g,e.b),f.setXYZ(12,e.r,e.g,e.b),f.setXYZ(13,e.r,e.g,e.b),f.setXYZ(14,e.r,e.g,e.b),f.setXYZ(15,e.r,e.g,e.b),f.setXYZ(16,e.r,e.g,e.b),f.setXYZ(17,e.r,e.g,e.b),f.setXYZ(18,e.r,e.g,e.b),f.setXYZ(19,e.r,e.g,e.b),f.setXYZ(20,e.r,e.g,e.b),f.setXYZ(21,e.r,e.g,e.b),f.setXYZ(22,e.r,e.g,e.b),f.setXYZ(23,e.r,e.g,e.b),f.setXYZ(24,a.r,a.g,a.b),f.setXYZ(25,a.r,a.g,a.b),f.setXYZ(26,a.r,a.g,a.b),f.setXYZ(27,a.r,a.g,a.b),f.setXYZ(28,a.r,a.g,a.b),f.setXYZ(29,a.r,a.g,a.b),f.setXYZ(30,a.r,a.g,a.b),f.setXYZ(31,a.r,a.g,a.b),f.setXYZ(32,o.r,o.g,o.b),f.setXYZ(33,o.r,o.g,o.b),f.setXYZ(34,o.r,o.g,o.b),f.setXYZ(35,o.r,o.g,o.b),f.setXYZ(36,o.r,o.g,o.b),f.setXYZ(37,o.r,o.g,o.b),f.setXYZ(38,s.r,s.g,s.b),f.setXYZ(39,s.r,s.g,s.b),f.setXYZ(40,c.r,c.g,c.b),f.setXYZ(41,c.r,c.g,c.b),f.setXYZ(42,c.r,c.g,c.b),f.setXYZ(43,c.r,c.g,c.b),f.setXYZ(44,c.r,c.g,c.b),f.setXYZ(45,c.r,c.g,c.b),f.setXYZ(46,c.r,c.g,c.b),f.setXYZ(47,c.r,c.g,c.b),f.setXYZ(48,c.r,c.g,c.b),f.setXYZ(49,c.r,c.g,c.b),f.needsUpdate=!0}update(){const e=this.geometry,a=this.pointMap,o=1,s=1;Br.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),no("c",a,e,Br,0,0,-1),no("t",a,e,Br,0,0,1),no("n1",a,e,Br,-o,-s,-1),no("n2",a,e,Br,o,-s,-1),no("n3",a,e,Br,-o,s,-1),no("n4",a,e,Br,o,s,-1),no("f1",a,e,Br,-o,-s,1),no("f2",a,e,Br,o,-s,1),no("f3",a,e,Br,-o,s,1),no("f4",a,e,Br,o,s,1),no("u1",a,e,Br,o*.7,s*1.1,-1),no("u2",a,e,Br,-o*.7,s*1.1,-1),no("u3",a,e,Br,0,s*2,-1),no("cf1",a,e,Br,-o,0,1),no("cf2",a,e,Br,o,0,1),no("cf3",a,e,Br,0,-s,1),no("cf4",a,e,Br,0,s,1),no("cn1",a,e,Br,-o,0,-1),no("cn2",a,e,Br,o,0,-1),no("cn3",a,e,Br,0,-s,-1),no("cn4",a,e,Br,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function no(n,e,a,o,s,c,d){HS.set(s,c,d).unproject(o);const f=e[n];if(f!==void 0){const m=a.getAttribute("position");for(let y=0,_=f.length;y<_;y++)m.setXYZ(f[y],HS.x,HS.y,HS.z)}}const jS=new pu;class J2e extends bd{constructor(e,a=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),c=new La;c.setIndex(new qi(o,1)),c.setAttribute("position",new qi(s,3)),super(c,new js({color:a,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&jS.setFromObject(this.object),jS.isEmpty())return;const a=jS.min,o=jS.max,s=this.geometry.attributes.position,c=s.array;c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=a.x,c[4]=o.y,c[5]=o.z,c[6]=a.x,c[7]=a.y,c[8]=o.z,c[9]=o.x,c[10]=a.y,c[11]=o.z,c[12]=o.x,c[13]=o.y,c[14]=a.z,c[15]=a.x,c[16]=o.y,c[17]=a.z,c[18]=a.x,c[19]=a.y,c[20]=a.z,c[21]=o.x,c[22]=a.y,c[23]=a.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,a){return super.copy(e,a),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Q2e extends bd{constructor(e,a=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],c=new La;c.setIndex(new qi(o,1)),c.setAttribute("position",new Wn(s,3)),super(c,new js({color:a,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const a=this.box;a.isEmpty()||(a.getCenter(this.position),a.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class e3e extends _p{constructor(e,a=1,o=16776960){const s=o,c=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],d=new La;d.setAttribute("position",new Wn(c,3)),d.computeBoundingSphere(),super(d,new js({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=a;const f=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],m=new La;m.setAttribute("position",new Wn(f,3)),m.computeBoundingSphere(),this.add(new bo(m,new Vh({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const gV=new Fe;let $S,B4;class t3e extends fi{constructor(e=new Fe(0,0,1),a=new Fe(0,0,0),o=1,s=16776960,c=o*.2,d=c*.2){super(),this.type="ArrowHelper",$S===void 0&&($S=new La,$S.setAttribute("position",new Wn([0,0,0,0,1,0],3)),B4=new h_(0,.5,1,5,1),B4.translate(0,-.5,0)),this.position.copy(a),this.line=new _p($S,new js({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new bo(B4,new Vh({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(o,c,d)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{gV.set(e.z,0,-e.x).normalize();const a=Math.acos(e.y);this.quaternion.setFromAxisAngle(gV,a)}}setLength(e,a=e*.2,o=a*.2){this.line.scale.set(1,Math.max(1e-4,e-a),1),this.line.updateMatrix(),this.cone.scale.set(o,a,o),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class n3e extends bd{constructor(e=1){const a=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new La;s.setAttribute("position",new Wn(a,3)),s.setAttribute("color",new Wn(o,3));const c=new js({vertexColors:!0,toneMapped:!1});super(s,c),this.type="AxesHelper"}setColors(e,a,o){const s=new Pn,c=this.geometry.attributes.color.array;return s.set(e),s.toArray(c,0),s.toArray(c,3),s.set(a),s.toArray(c,6),s.toArray(c,9),s.set(o),s.toArray(c,12),s.toArray(c,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class a3e{constructor(){this.type="ShapePath",this.color=new Pn,this.subPaths=[],this.currentPath=null}moveTo(e,a){return this.currentPath=new jx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,a),this}lineTo(e,a){return this.currentPath.lineTo(e,a),this}quadraticCurveTo(e,a,o,s){return this.currentPath.quadraticCurveTo(e,a,o,s),this}bezierCurveTo(e,a,o,s,c,d){return this.currentPath.bezierCurveTo(e,a,o,s,c,d),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function a(L){const O=[];for(let F=0,B=L.length;F<B;F++){const G=L[F],q=new bg;q.curves=G.curves,O.push(q)}return O}function o(L,O){const F=O.length;let B=!1;for(let G=F-1,q=0;q<F;G=q++){let X=O[G],ee=O[q],V=ee.x-X.x,Q=ee.y-X.y;if(Math.abs(Q)>Number.EPSILON){if(Q<0&&(X=O[q],V=-V,ee=O[G],Q=-Q),L.y<X.y||L.y>ee.y)continue;if(L.y===X.y){if(L.x===X.x)return!0}else{const me=Q*(L.x-X.x)-V*(L.y-X.y);if(me===0)return!0;if(me<0)continue;B=!B}}else{if(L.y!==X.y)continue;if(ee.x<=L.x&&L.x<=X.x||X.x<=L.x&&L.x<=ee.x)return!0}}return B}const s=fd.isClockWise,c=this.subPaths;if(c.length===0)return[];let d,f,m;const y=[];if(c.length===1)return f=c[0],m=new bg,m.curves=f.curves,y.push(m),y;let _=!s(c[0].getPoints());_=e?!_:_;const w=[],A=[];let C=[],I=0,k;A[I]=void 0,C[I]=[];for(let L=0,O=c.length;L<O;L++)f=c[L],k=f.getPoints(),d=s(k),d=e?!d:d,d?(!_&&A[I]&&I++,A[I]={s:new bg,p:k},A[I].s.curves=f.curves,_&&I++,C[I]=[]):C[I].push({h:f,p:k[0]});if(!A[0])return a(c);if(A.length>1){let L=!1,O=0;for(let F=0,B=A.length;F<B;F++)w[F]=[];for(let F=0,B=A.length;F<B;F++){const G=C[F];for(let q=0;q<G.length;q++){const X=G[q];let ee=!0;for(let V=0;V<A.length;V++)o(X.p,A[V].p)&&(F!==V&&O++,ee?(ee=!1,w[V].push(X)):L=!0);ee&&w[F].push(X)}}O>0&&L===!1&&(C=w)}let D;for(let L=0,O=A.length;L<O;L++){m=A[L].s,y.push(m),D=C[L];for(let F=0,B=D.length;F<B;F++)m.holes.push(D[F].h)}return y}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gT}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gT);const DY=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:CD,AddEquation:Hf,AddOperation:YX,AdditiveAnimationBlendMode:zD,AdditiveBlending:LL,AlphaFormat:iZ,AlwaysCompare:SZ,AlwaysDepth:GX,AlwaysStencilFunc:lR,AmbientLight:AY,AnimationAction:LY,AnimationClip:Kx,AnimationLoader:s2e,AnimationMixer:O2e,AnimationObjectGroup:k2e,AnimationUtils:a2e,ArcCurve:XZ,ArrayCamera:NZ,ArrowHelper:t3e,AttachedBindMode:zL,Audio:PY,AudioAnalyser:S2e,AudioContext:c6,AudioListener:b2e,AudioLoader:y2e,AxesHelper:n3e,BackSide:vs,BasicDepthPacking:pZ,BasicShadowMap:EX,Bone:XD,BooleanKeyframeTrack:Gg,Box2:W2e,Box3:pu,Box3Helper:Q2e,BoxGeometry:Vg,BoxHelper:J2e,BufferAttribute:qi,BufferGeometry:La,BufferGeometryLoader:CY,ByteType:nZ,Cache:Og,Camera:Cw,CameraHelper:K2e,CanvasTexture:Twe,CapsuleGeometry:kT,CatmullRomCurve3:ZZ,CineonToneMapping:QX,CircleGeometry:DT,ClampToEdgeWrapping:ms,Clock:u6,Color:Pn,ColorKeyframeTrack:r6,ColorManagement:Oi,CompressedArrayTexture:Ewe,CompressedCubeTexture:Mwe,CompressedTexture:LT,CompressedTextureLoader:l2e,ConeGeometry:OT,ConstantAlphaFactor:UX,ConstantColorFactor:NX,CubeCamera:IZ,CubeReflectionMapping:Fh,CubeRefractionMapping:yp,CubeTexture:Pw,CubeTextureLoader:c2e,CubeUVReflectionMapping:u_,CubicBezierCurve:KD,CubicBezierCurve3:YZ,CubicInterpolant:mY,CullFaceBack:IL,CullFaceFront:AX,CullFaceFrontBack:Sve,CullFaceNone:SX,Curve:mu,CurvePath:JZ,CustomBlending:MX,CustomToneMapping:eZ,CylinderGeometry:h_,Cylindrical:U2e,Data3DTexture:WD,DataArrayTexture:wT,DataTexture:k0,DataTextureLoader:u2e,DataUtils:R0e,DecrementStencilOp:Ove,DecrementWrapStencilOp:Fve,DefaultLoadingManager:vY,DepthFormat:cp,DepthStencilFormat:Lg,DepthTexture:BZ,DetachedBindMode:tZ,DirectionalLight:SY,DirectionalLightHelper:Y2e,DiscreteInterpolant:gY,DisplayP3ColorSpace:xT,DodecahedronGeometry:zT,DoubleSide:Ul,DstAlphaFactor:kX,DstColorFactor:OX,DynamicCopyUsage:Jve,DynamicDrawUsage:$ve,DynamicReadUsage:Zve,EdgesGeometry:QZ,EllipseCurve:RT,EqualCompare:vZ,EqualDepth:jX,EqualStencilFunc:Wve,EquirectangularReflectionMapping:Rx,EquirectangularRefractionMapping:kx,Euler:Tw,EventDispatcher:_d,ExtrudeGeometry:NT,FileLoader:Nh,Float16BufferAttribute:N0e,Float32BufferAttribute:Wn,Float64BufferAttribute:B0e,FloatType:od,Fog:CT,FogExp2:TT,FramebufferTexture:Awe,FrontSide:md,Frustum:ST,GLBufferAttribute:B2e,GLSL1:e0e,GLSL3:cR,GreaterCompare:bZ,GreaterDepth:qX,GreaterEqualCompare:wZ,GreaterEqualDepth:$X,GreaterEqualStencilFunc:jve,GreaterStencilFunc:Gve,GridHelper:X2e,Group:_0,HalfFloatType:Y0,HemisphereLight:bY,HemisphereLightHelper:q2e,IcosahedronGeometry:BT,ImageBitmapLoader:g2e,ImageLoader:Jx,ImageUtils:UD,IncrementStencilOp:Dve,IncrementWrapStencilOp:zve,InstancedBufferAttribute:kg,InstancedBufferGeometry:l6,InstancedInterleavedBuffer:N2e,InstancedMesh:jZ,Int16BufferAttribute:z0e,Int32BufferAttribute:F0e,Int8BufferAttribute:k0e,IntType:ID,InterleavedBuffer:PT,InterleavedBufferAttribute:Rg,Interpolant:kw,InterpolateDiscrete:zx,InterpolateLinear:Fx,InterpolateSmooth:WA,InvertStencilOp:Nve,KeepStencilOp:Km,KeyframeTrack:gu,LOD:GZ,LatheGeometry:Iw,Layers:_g,LessCompare:yZ,LessDepth:HX,LessEqualCompare:_Z,LessEqualDepth:Lx,LessEqualStencilFunc:Vve,LessStencilFunc:Uve,Light:Cp,LightProbe:TY,Line:_p,Line3:V2e,LineBasicMaterial:js,LineCurve:JD,LineCurve3:KZ,LineDashedMaterial:hY,LineLoop:$Z,LineSegments:bd,LinearDisplayP3ColorSpace:Mw,LinearEncoding:FD,LinearFilter:Cr,LinearInterpolant:i6,LinearMipMapLinearFilter:Cve,LinearMipMapNearestFilter:Tve,LinearMipmapLinearFilter:vp,LinearMipmapNearestFilter:PD,LinearSRGBColorSpace:gd,LinearToneMapping:KX,LinearTransfer:Bx,Loader:wl,LoaderUtils:yR,LoadingManager:o6,LoopOnce:dZ,LoopPingPong:fZ,LoopRepeat:hZ,LuminanceAlphaFormat:oZ,LuminanceFormat:rZ,MOUSE:Zm,Material:Ko,MaterialLoader:$T,MathUtils:p0e,Matrix3:Na,Matrix4:Ia,MaxEquation:OL,Mesh:bo,MeshBasicMaterial:Vh,MeshDepthMaterial:ET,MeshDistanceMaterial:MT,MeshLambertMaterial:uY,MeshMatcapMaterial:dY,MeshNormalMaterial:cY,MeshPhongMaterial:sY,MeshPhysicalMaterial:oY,MeshStandardMaterial:n6,MeshToonMaterial:lY,MinEquation:DL,MirroredRepeatWrapping:Ox,MixOperation:ZX,MultiplyBlending:kL,MultiplyOperation:Ew,NearestFilter:ro,NearestMipMapLinearFilter:Mve,NearestMipMapNearestFilter:Eve,NearestMipmapLinearFilter:qb,NearestMipmapNearestFilter:UE,NeverCompare:gZ,NeverDepth:VX,NeverStencilFunc:Bve,NoBlending:Ph,NoColorSpace:Wl,NoToneMapping:dd,NormalAnimationBlendMode:bT,NormalBlending:yg,NotEqualCompare:xZ,NotEqualDepth:XX,NotEqualStencilFunc:Hve,NumberKeyframeTrack:Zx,Object3D:fi,ObjectLoader:p2e,ObjectSpaceNormalMap:mZ,OctahedronGeometry:Lw,OneFactor:IX,OneMinusConstantAlphaFactor:WX,OneMinusConstantColorFactor:BX,OneMinusDstAlphaFactor:DX,OneMinusDstColorFactor:zX,OneMinusSrcAlphaFactor:BE,OneMinusSrcColorFactor:RX,OrthographicCamera:Ah,P3Primaries:Wx,PCFShadowMap:yT,PCFSoftShadowMap:$b,PMREMGenerator:dR,Path:jx,PerspectiveCamera:jr,Plane:gh,PlaneGeometry:Mp,PlaneHelper:e3e,PointLight:wY,PointLightHelper:j2e,Points:qZ,PointsMaterial:ZD,PolarGridHelper:Z2e,PolyhedronGeometry:Tp,PositionalAudio:w2e,PropertyBinding:oi,PropertyMixer:IY,QuadraticBezierCurve:QD,QuadraticBezierCurve3:e6,Quaternion:_s,QuaternionKeyframeTrack:f_,QuaternionLinearInterpolant:yY,RED_GREEN_RGTC2_Format:oR,RED_RGTC1_Format:uZ,REVISION:gT,RGBADepthPacking:ND,RGBAFormat:hl,RGBAIntegerFormat:OD,RGBA_ASTC_10x10_Format:eR,RGBA_ASTC_10x5_Format:KL,RGBA_ASTC_10x6_Format:JL,RGBA_ASTC_10x8_Format:QL,RGBA_ASTC_12x10_Format:tR,RGBA_ASTC_12x12_Format:nR,RGBA_ASTC_4x4_Format:GL,RGBA_ASTC_5x4_Format:HL,RGBA_ASTC_5x5_Format:jL,RGBA_ASTC_6x5_Format:$L,RGBA_ASTC_6x6_Format:qL,RGBA_ASTC_8x5_Format:XL,RGBA_ASTC_8x6_Format:ZL,RGBA_ASTC_8x8_Format:YL,RGBA_BPTC_Format:UA,RGBA_ETC2_EAC_Format:VL,RGBA_PVRTC_2BPPV1_Format:UL,RGBA_PVRTC_4BPPV1_Format:BL,RGBA_S3TC_DXT1_Format:FA,RGBA_S3TC_DXT3_Format:NA,RGBA_S3TC_DXT5_Format:BA,RGB_BPTC_SIGNED_Format:aR,RGB_BPTC_UNSIGNED_Format:iR,RGB_ETC1_Format:cZ,RGB_ETC2_Format:WL,RGB_PVRTC_2BPPV1_Format:NL,RGB_PVRTC_4BPPV1_Format:FL,RGB_S3TC_DXT1_Format:zA,RGFormat:lZ,RGIntegerFormat:DD,RawShaderMaterial:rY,Ray:Wg,Raycaster:RY,Rec709Primaries:Ux,RectAreaLight:EY,RedFormat:sZ,RedIntegerFormat:kD,ReinhardToneMapping:JX,RenderTarget:TZ,RepeatWrapping:Dx,ReplaceStencilOp:kve,ReverseSubtractEquation:CX,RingGeometry:UT,SIGNED_RED_GREEN_RGTC2_Format:sR,SIGNED_RED_RGTC1_Format:rR,SRGBColorSpace:To,SRGBTransfer:Ji,Scene:GE,ShaderChunk:Oa,ShaderLib:au,ShaderMaterial:yd,ShadowMaterial:iY,Shape:bg,ShapeGeometry:WT,ShapePath:a3e,ShapeUtils:fd,ShortType:aZ,Skeleton:IT,SkeletonHelper:H2e,SkinnedMesh:HZ,Source:dg,Sphere:Tc,SphereGeometry:Rw,Spherical:_R,SphericalHarmonics3:MY,SplineCurve:t6,SpotLight:xY,SpotLightHelper:G2e,Sprite:VZ,SpriteMaterial:qD,SrcAlphaFactor:NE,SrcAlphaSaturateFactor:FX,SrcColorFactor:LX,StaticCopyUsage:Kve,StaticDrawUsage:Vx,StaticReadUsage:Xve,StereoCamera:v2e,StreamCopyUsage:Qve,StreamDrawUsage:qve,StreamReadUsage:Yve,StringKeyframeTrack:Hg,SubtractEquation:TX,SubtractiveBlending:RL,TOUCH:Ym,TangentSpaceNormalMap:Ep,TetrahedronGeometry:VT,Texture:Lr,TextureLoader:_Y,TorusGeometry:GT,TorusKnotGeometry:HT,Triangle:dl,TriangleFanDrawMode:Lve,TriangleStripDrawMode:Ive,TrianglesDrawMode:Pve,TubeGeometry:jT,TwoPassDoubleSide:Ave,UVMapping:vT,Uint16BufferAttribute:VD,Uint32BufferAttribute:GD,Uint8BufferAttribute:D0e,Uint8ClampedBufferAttribute:O0e,Uniform:f6,UniformsGroup:F2e,UniformsLib:bn,UniformsUtils:HD,UnsignedByteType:hd,UnsignedInt248Type:lp,UnsignedIntType:Sh,UnsignedShort4444Type:LD,UnsignedShort5551Type:RD,UnsignedShortType:_T,VSMShadowMap:Qc,Vector2:Kt,Vector3:Fe,Vector4:Ai,VectorKeyframeTrack:Yx,VideoTexture:Swe,WebGL1Renderer:UZ,WebGL3DRenderTarget:b0e,WebGLArrayRenderTarget:_0e,WebGLCoordinateSystem:sd,WebGLCubeRenderTarget:LZ,WebGLMultipleRenderTargets:x0e,WebGLRenderTarget:hu,WebGLRenderer:$D,WebGLUtils:FZ,WebGPUCoordinateSystem:Gx,WireframeGeometry:aY,WrapAroundEnding:Nx,ZeroCurvatureEnding:cg,ZeroFactor:PX,ZeroSlopeEnding:ug,ZeroStencilOp:Rve,_SRGBAFormat:WE,createCanvasElement:MZ,sRGBEncoding:up},Symbol.toStringTag,{value:"Module"}));var OY={exports:{}},jg={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */jg.ConcurrentRoot=1;jg.ContinuousEventPriority=4;jg.DefaultEventPriority=16;jg.DiscreteEventPriority=1;jg.IdleEventPriority=536870912;jg.LegacyRoot=0;OY.exports=jg;var x0=OY.exports;function i3e(n){let e;const a=new Set,o=(y,_)=>{const w=typeof y=="function"?y(e):y;if(w!==e){const A=e;e=_?w:Object.assign({},e,w),a.forEach(C=>C(e,A))}},s=()=>e,c=(y,_=s,w=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let A=_(e);function C(){const I=_(e);if(!w(A,I)){const k=A;y(A=I,k)}}return a.add(C),()=>a.delete(C)},m={setState:o,getState:s,subscribe:(y,_,w)=>_||w?c(y,_,w):(a.add(y),()=>a.delete(y)),destroy:()=>a.clear()};return e=n(o,s,m),m}const r3e=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),yV=r3e?re.useEffect:re.useLayoutEffect;function o3e(n){const e=typeof n=="function"?i3e(n):n,a=(o=e.getState,s=Object.is)=>{const[,c]=re.useReducer(D=>D+1,0),d=e.getState(),f=re.useRef(d),m=re.useRef(o),y=re.useRef(s),_=re.useRef(!1),w=re.useRef();w.current===void 0&&(w.current=o(d));let A,C=!1;(f.current!==d||m.current!==o||y.current!==s||_.current)&&(A=o(d),C=!s(w.current,A)),yV(()=>{C&&(w.current=A),f.current=d,m.current=o,y.current=s,_.current=!1});const I=re.useRef(d);yV(()=>{const D=()=>{try{const O=e.getState(),F=m.current(O);y.current(w.current,F)||(f.current=O,w.current=F,c())}catch{_.current=!0,c()}},L=e.subscribe(D);return e.getState()!==I.current&&D(),L},[]);const k=C?A:w.current;return re.useDebugValue(k),k};return Object.assign(a,e),a[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const o=[a,e];return{next(){const s=o.length<=0;return{value:o.shift(),done:s}}}},a}var zY={exports:{}},U4={exports:{}},W4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vV;function s3e(){return vV||(vV=1,function(n){function e(ue,ye){var Ae=ue.length;ue.push(ye);e:for(;0<Ae;){var ne=Ae-1>>>1,Ee=ue[ne];if(0<s(Ee,ye))ue[ne]=ye,ue[Ae]=Ee,Ae=ne;else break e}}function a(ue){return ue.length===0?null:ue[0]}function o(ue){if(ue.length===0)return null;var ye=ue[0],Ae=ue.pop();if(Ae!==ye){ue[0]=Ae;e:for(var ne=0,Ee=ue.length,Ye=Ee>>>1;ne<Ye;){var Xe=2*(ne+1)-1,Ke=ue[Xe],Ue=Xe+1,ht=ue[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ht,Ke)?(ue[ne]=ht,ue[Ue]=Ae,ne=Ue):(ue[ne]=Ke,ue[Xe]=Ae,ne=Xe);else if(Ue<Ee&&0>s(ht,Ae))ue[ne]=ht,ue[Ue]=Ae,ne=Ue;else break e}}return ye}function s(ue,ye){var Ae=ue.sortIndex-ye.sortIndex;return Ae!==0?Ae:ue.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,w=null,A=3,C=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ue){for(var ye=a(y);ye!==null;){if(ye.callback===null)o(y);else if(ye.startTime<=ue)o(y),ye.sortIndex=ye.expirationTime,e(m,ye);else break;ye=a(y)}}function B(ue){if(k=!1,F(ue),!I)if(a(m)!==null)I=!0,Re(G);else{var ye=a(y);ye!==null&&He(B,ye.startTime-ue)}}function G(ue,ye){I=!1,k&&(k=!1,L(ee),ee=-1),C=!0;var Ae=A;try{for(F(ye),w=a(m);w!==null&&(!(w.expirationTime>ye)||ue&&!me());){var ne=w.callback;if(typeof ne=="function"){w.callback=null,A=w.priorityLevel;var Ee=ne(w.expirationTime<=ye);ye=n.unstable_now(),typeof Ee=="function"?w.callback=Ee:w===a(m)&&o(m),F(ye)}else o(m);w=a(m)}if(w!==null)var Ye=!0;else{var Xe=a(y);Xe!==null&&He(B,Xe.startTime-ye),Ye=!1}return Ye}finally{w=null,A=Ae,C=!1}}var q=!1,X=null,ee=-1,V=5,Q=-1;function me(){return!(n.unstable_now()-Q<V)}function pe(){if(X!==null){var ue=n.unstable_now();Q=ue;var ye=!0;try{ye=X(!0,ue)}finally{ye?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=pe,be=function(){Ce.postMessage(null)}}else be=function(){D(pe,0)};function Re(ue){X=ue,q||(q=!0,be())}function He(ue,ye){ee=D(function(){ue(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){I||C||(I=!0,Re(G))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(ue){switch(A){case 1:case 2:case 3:var ye=3;break;default:ye=A}var Ae=A;A=ye;try{return ue()}finally{A=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,ye){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var Ae=A;A=ue;try{return ye()}finally{A=Ae}},n.unstable_scheduleCallback=function(ue,ye,Ae){var ne=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ne+Ae:ne):Ae=ne,ue){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,ue={id:_++,callback:ye,priorityLevel:ue,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ne?(ue.sortIndex=Ae,e(y,ue),a(m)===null&&ue===a(y)&&(k?(L(ee),ee=-1):k=!0,He(B,Ae-ne))):(ue.sortIndex=Ee,e(m,ue),I||C||(I=!0,Re(G))),ue},n.unstable_shouldYield=me,n.unstable_wrapCallback=function(ue){var ye=A;return function(){var Ae=A;A=ye;try{return ue.apply(this,arguments)}finally{A=Ae}}}}(W4)),W4}var _V;function l3e(){return _V||(_V=1,U4.exports=s3e()),U4.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c3e=function(e){var a={},o=re,s=l3e(),c=Object.assign;function d(E){for(var M="https://reactjs.org/docs/error-decoder.html?invariant="+E,N=1;N<arguments.length;N++)M+="&args[]="+encodeURIComponent(arguments[N]);return"Minified React error #"+E+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,m=Symbol.for("react.element"),y=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),G=Symbol.iterator;function q(E){return E===null||typeof E!="object"?null:(E=G&&E[G]||E["@@iterator"],typeof E=="function"?E:null)}function X(E){if(E==null)return null;if(typeof E=="function")return E.displayName||E.name||null;if(typeof E=="string")return E;switch(E){case _:return"Fragment";case y:return"Portal";case A:return"Profiler";case w:return"StrictMode";case D:return"Suspense";case L:return"SuspenseList"}if(typeof E=="object")switch(E.$$typeof){case I:return(E.displayName||"Context")+".Consumer";case C:return(E._context.displayName||"Context")+".Provider";case k:var M=E.render;return E=E.displayName,E||(E=M.displayName||M.name||"",E=E!==""?"ForwardRef("+E+")":"ForwardRef"),E;case O:return M=E.displayName||null,M!==null?M:X(E.type)||"Memo";case F:M=E._payload,E=E._init;try{return X(E(M))}catch{}}return null}function ee(E){var M=E.type;switch(E.tag){case 24:return"Cache";case 9:return(M.displayName||"Context")+".Consumer";case 10:return(M._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return E=M.render,E=E.displayName||E.name||"",M.displayName||(E!==""?"ForwardRef("+E+")":"ForwardRef");case 7:return"Fragment";case 5:return M;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(M);case 8:return M===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof M=="function")return M.displayName||M.name||null;if(typeof M=="string")return M}return null}function V(E){var M=E,N=E;if(E.alternate)for(;M.return;)M=M.return;else{E=M;do M=E,M.flags&4098&&(N=M.return),E=M.return;while(E)}return M.tag===3?N:null}function Q(E){if(V(E)!==E)throw Error(d(188))}function me(E){var M=E.alternate;if(!M){if(M=V(E),M===null)throw Error(d(188));return M!==E?null:E}for(var N=E,H=M;;){var J=N.return;if(J===null)break;var ie=J.alternate;if(ie===null){if(H=J.return,H!==null){N=H;continue}break}if(J.child===ie.child){for(ie=J.child;ie;){if(ie===N)return Q(J),E;if(ie===H)return Q(J),M;ie=ie.sibling}throw Error(d(188))}if(N.return!==H.return)N=J,H=ie;else{for(var je=!1,vt=J.child;vt;){if(vt===N){je=!0,N=J,H=ie;break}if(vt===H){je=!0,H=J,N=ie;break}vt=vt.sibling}if(!je){for(vt=ie.child;vt;){if(vt===N){je=!0,N=ie,H=J;break}if(vt===H){je=!0,H=ie,N=J;break}vt=vt.sibling}if(!je)throw Error(d(189))}}if(N.alternate!==H)throw Error(d(190))}if(N.tag!==3)throw Error(d(188));return N.stateNode.current===N?E:M}function pe(E){return E=me(E),E!==null?be(E):null}function be(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){var M=be(E);if(M!==null)return M;E=E.sibling}return null}function fe(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){if(E.tag!==4){var M=fe(E);if(M!==null)return M}E=E.sibling}return null}var Ce=Array.isArray,Re=e.getPublicInstance,He=e.getRootHostContext,ue=e.getChildHostContext,ye=e.prepareForCommit,Ae=e.resetAfterCommit,ne=e.createInstance,Ee=e.appendInitialChild,Ye=e.finalizeInitialChildren,Xe=e.prepareUpdate,Ke=e.shouldSetTextContent,Ue=e.createTextInstance,ht=e.scheduleTimeout,Lt=e.cancelTimeout,Rt=e.noTimeout,Jt=e.isPrimaryRenderer,Pt=e.supportsMutation,Pe=e.supportsPersistence,ft=e.supportsHydration,gt=e.getInstanceFromNode,St=e.preparePortalMount,Be=e.getCurrentEventPriority,le=e.detachDeletedInstance,oe=e.supportsMicrotasks,ve=e.scheduleMicrotask,$e=e.supportsTestSelectors,De=e.findFiberRoot,ot=e.getBoundingRect,ce=e.getTextContent,te=e.isHiddenSubtree,Oe=e.matchAccessibilityRole,pt=e.setFocusIfFocusable,it=e.setupIntersectionObserver,st=e.appendChild,At=e.appendChildToContainer,Ut=e.commitTextUpdate,Vt=e.commitMount,$t=e.commitUpdate,Ft=e.insertBefore,wt=e.insertInContainerBefore,Yt=e.removeChild,Ge=e.removeChildFromContainer,It=e.resetTextContent,qt=e.hideInstance,Dt=e.hideTextInstance,fn=e.unhideInstance,_e=e.unhideTextInstance,Ze=e.clearContainer,Se=e.cloneInstance,Me=e.createContainerChildSet,ze=e.appendChildToContainerChildSet,Je=e.finalizeContainerChildren,et=e.replaceContainerChildren,yt=e.cloneHiddenInstance,ut=e.cloneHiddenTextInstance,ct=e.canHydrateInstance,Gt=e.canHydrateTextInstance,Mt=e.canHydrateSuspenseInstance,Qt=e.isSuspenseInstancePending,mn=e.isSuspenseInstanceFallback,nn=e.registerSuspenseInstanceRetry,wn=e.getNextHydratableSibling,Hn=e.getFirstHydratableChild,fa=e.getFirstHydratableChildWithinContainer,Ca=e.getFirstHydratableChildWithinSuspenseInstance,Ma=e.hydrateInstance,Ii=e.hydrateTextInstance,pi=e.hydrateSuspenseInstance,Le=e.getNextHydratableInstanceAfterSuspenseInstance,_t=e.commitHydratedContainer,kt=e.commitHydratedSuspenseInstance,Tt=e.clearSuspenseBoundary,Ot=e.clearSuspenseBoundaryFromContainer,ln=e.shouldDeleteUnhydratedTailInstances,Tn=e.didNotMatchHydratedContainerTextInstance,qn=e.didNotMatchHydratedTextInstance,an;function sa(E){if(an===void 0)try{throw Error()}catch(N){var M=N.stack.trim().match(/\n( *(at )?)/);an=M&&M[1]||""}return`
`+an+E}var pa=!1;function ia(E,M){if(!E||pa)return"";pa=!0;var N=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(M)if(M=function(){throw Error()},Object.defineProperty(M.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(M,[])}catch(dn){var H=dn}Reflect.construct(E,[],M)}else{try{M.call()}catch(dn){H=dn}E.call(M.prototype)}else{try{throw Error()}catch(dn){H=dn}E()}}catch(dn){if(dn&&H&&typeof dn.stack=="string"){for(var J=dn.stack.split(`
`),ie=H.stack.split(`
`),je=J.length-1,vt=ie.length-1;1<=je&&0<=vt&&J[je]!==ie[vt];)vt--;for(;1<=je&&0<=vt;je--,vt--)if(J[je]!==ie[vt]){if(je!==1||vt!==1)do if(je--,vt--,0>vt||J[je]!==ie[vt]){var jt=`
`+J[je].replace(" at new "," at ");return E.displayName&&jt.includes("<anonymous>")&&(jt=jt.replace("<anonymous>",E.displayName)),jt}while(1<=je&&0<=vt);break}}}finally{pa=!1,Error.prepareStackTrace=N}return(E=E?E.displayName||E.name:"")?sa(E):""}var ni=Object.prototype.hasOwnProperty,_r=[],ei=-1;function Xi(E){return{current:E}}function ta(E){0>ei||(E.current=_r[ei],_r[ei]=null,ei--)}function Rn(E,M){ei++,_r[ei]=E.current,E.current=M}var lo={},Ra=Xi(lo),Ei=Xi(!1),Uo=lo;function br(E,M){var N=E.type.contextTypes;if(!N)return lo;var H=E.stateNode;if(H&&H.__reactInternalMemoizedUnmaskedChildContext===M)return H.__reactInternalMemoizedMaskedChildContext;var J={},ie;for(ie in N)J[ie]=M[ie];return H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=M,E.__reactInternalMemoizedMaskedChildContext=J),J}function Zi(E){return E=E.childContextTypes,E!=null}function ci(){ta(Ei),ta(Ra)}function Dr(E,M,N){if(Ra.current!==lo)throw Error(d(168));Rn(Ra,M),Rn(Ei,N)}function Cn(E,M,N){var H=E.stateNode;if(M=M.childContextTypes,typeof H.getChildContext!="function")return N;H=H.getChildContext();for(var J in H)if(!(J in M))throw Error(d(108,ee(E)||"Unknown",J));return c({},N,H)}function Yn(E){return E=(E=E.stateNode)&&E.__reactInternalMemoizedMergedChildContext||lo,Uo=Ra.current,Rn(Ra,E),Rn(Ei,Ei.current),!0}function Vi(E,M,N){var H=E.stateNode;if(!H)throw Error(d(169));N?(E=Cn(E,M,Uo),H.__reactInternalMemoizedMergedChildContext=E,ta(Ei),ta(Ra),Rn(Ra,E)):ta(Ei),Rn(Ei,N)}var xr=Math.clz32?Math.clz32:Ip,Ss=Math.log,yu=Math.LN2;function Ip(E){return E>>>=0,E===0?32:31-(Ss(E)/yu|0)|0}var Jl=64,Sl=4194304;function Al(E){switch(E&-E){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return E&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return E&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return E}}function El(E,M){var N=E.pendingLanes;if(N===0)return 0;var H=0,J=E.suspendedLanes,ie=E.pingedLanes,je=N&268435455;if(je!==0){var vt=je&~J;vt!==0?H=Al(vt):(ie&=je,ie!==0&&(H=Al(ie)))}else je=N&~J,je!==0?H=Al(je):ie!==0&&(H=Al(ie));if(H===0)return 0;if(M!==0&&M!==H&&!(M&J)&&(J=H&-H,ie=M&-M,J>=ie||J===16&&(ie&4194240)!==0))return M;if(H&4&&(H|=N&16),M=E.entangledLanes,M!==0)for(E=E.entanglements,M&=H;0<M;)N=31-xr(M),J=1<<N,H|=E[N],M&=~J;return H}function xd(E,M){switch(E){case 1:case 2:case 4:return M+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return M+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gh(E,M){for(var N=E.suspendedLanes,H=E.pingedLanes,J=E.expirationTimes,ie=E.pendingLanes;0<ie;){var je=31-xr(ie),vt=1<<je,jt=J[je];jt===-1?(!(vt&N)||vt&H)&&(J[je]=xd(vt,M)):jt<=M&&(E.expiredLanes|=vt),ie&=~vt}}function Ql(E){return E=E.pendingLanes&-1073741825,E!==0?E:E&1073741824?1073741824:0}function wd(E){for(var M=[],N=0;31>N;N++)M.push(E);return M}function $s(E,M,N){E.pendingLanes|=M,M!==536870912&&(E.suspendedLanes=0,E.pingedLanes=0),E=E.eventTimes,M=31-xr(M),E[M]=N}function Ht(E,M){var N=E.pendingLanes&~M;E.pendingLanes=M,E.suspendedLanes=0,E.pingedLanes=0,E.expiredLanes&=M,E.mutableReadLanes&=M,E.entangledLanes&=M,M=E.entanglements;var H=E.eventTimes;for(E=E.expirationTimes;0<N;){var J=31-xr(N),ie=1<<J;M[J]=0,H[J]=-1,E[J]=-1,N&=~ie}}function vn(E,M){var N=E.entangledLanes|=M;for(E=E.entanglements;N;){var H=31-xr(N),J=1<<H;J&M|E[H]&M&&(E[H]|=M),N&=~J}}var Bn=0;function tt(E){return E&=-E,1<E?4<E?E&268435455?16:536870912:4:1}var sn=s.unstable_scheduleCallback,qs=s.unstable_cancelCallback,As=s.unstable_shouldYield,Bi=s.unstable_requestPaint,ai=s.unstable_now,Sd=s.unstable_ImmediatePriority,Es=s.unstable_UserBlockingPriority,xo=s.unstable_NormalPriority,Lp=s.unstable_IdlePriority,Xs=null,tn=null;function ma(E){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Xs,E,void 0,(E.current.flags&128)===128)}catch{}}function xa(E,M){return E===M&&(E!==0||1/E===1/M)||E!==E&&M!==M}var Yi=typeof Object.is=="function"?Object.is:xa,Or=null,na=!1,Wo=!1;function Cc(E){Or===null?Or=[E]:Or.push(E)}function Pc(E){na=!0,Cc(E)}function Li(){if(!Wo&&Or!==null){Wo=!0;var E=0,M=Bn;try{var N=Or;for(Bn=1;E<N.length;E++){var H=N[E];do H=H(!0);while(H!==null)}Or=null,na=!1}catch(J){throw Or!==null&&(Or=Or.slice(E+1)),sn(Sd,Li),J}finally{Bn=M,Wo=!1}}return null}var ui=f.ReactCurrentBatchConfig;function Ad(E,M){if(Yi(E,M))return!0;if(typeof E!="object"||E===null||typeof M!="object"||M===null)return!1;var N=Object.keys(E),H=Object.keys(M);if(N.length!==H.length)return!1;for(H=0;H<N.length;H++){var J=N[H];if(!ni.call(M,J)||!Yi(E[J],M[J]))return!1}return!0}function Ml(E){switch(E.tag){case 5:return sa(E.type);case 16:return sa("Lazy");case 13:return sa("Suspense");case 19:return sa("SuspenseList");case 0:case 2:case 15:return E=ia(E.type,!1),E;case 11:return E=ia(E.type.render,!1),E;case 1:return E=ia(E.type,!0),E;default:return""}}function wo(E,M){if(E&&E.defaultProps){M=c({},M),E=E.defaultProps;for(var N in E)M[N]===void 0&&(M[N]=E[N]);return M}return M}var dr=Xi(null),vu=null,Zs=null,Tl=null;function _u(){Tl=Zs=vu=null}function Ed(E,M,N){Jt?(Rn(dr,M._currentValue),M._currentValue=N):(Rn(dr,M._currentValue2),M._currentValue2=N)}function zr(E){var M=dr.current;ta(dr),Jt?E._currentValue=M:E._currentValue2=M}function Mi(E,M,N){for(;E!==null;){var H=E.alternate;if((E.childLanes&M)!==M?(E.childLanes|=M,H!==null&&(H.childLanes|=M)):H!==null&&(H.childLanes&M)!==M&&(H.childLanes|=M),E===N)break;E=E.return}}function xn(E,M){vu=E,Tl=Zs=null,E=E.dependencies,E!==null&&E.firstContext!==null&&(E.lanes&M&&(ts=!0),E.firstContext=null)}function tr(E){var M=Jt?E._currentValue:E._currentValue2;if(Tl!==E)if(E={context:E,memoizedValue:M,next:null},Zs===null){if(vu===null)throw Error(d(308));Zs=E,vu.dependencies={lanes:0,firstContext:E}}else Zs=Zs.next=E;return M}var Vo=null,wr=!1;function Jo(E){E.updateQueue={baseState:E.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function p_(E,M){E=E.updateQueue,M.updateQueue===E&&(M.updateQueue={baseState:E.baseState,firstBaseUpdate:E.firstBaseUpdate,lastBaseUpdate:E.lastBaseUpdate,shared:E.shared,effects:E.effects})}function Qo(E,M){return{eventTime:E,lane:M,tag:0,payload:null,callback:null,next:null}}function Ti(E,M){var N=E.updateQueue;N!==null&&(N=N.shared,Gi!==null&&E.mode&1&&!(Da&2)?(E=N.interleaved,E===null?(M.next=M,Vo===null?Vo=[N]:Vo.push(N)):(M.next=E.next,E.next=M),N.interleaved=M):(E=N.pending,E===null?M.next=M:(M.next=E.next,E.next=M),N.pending=M))}function bu(E,M,N){if(M=M.updateQueue,M!==null&&(M=M.shared,(N&4194240)!==0)){var H=M.lanes;H&=E.pendingLanes,N|=H,M.lanes=N,vn(E,N)}}function qg(E,M){var N=E.updateQueue,H=E.alternate;if(H!==null&&(H=H.updateQueue,N===H)){var J=null,ie=null;if(N=N.firstBaseUpdate,N!==null){do{var je={eventTime:N.eventTime,lane:N.lane,tag:N.tag,payload:N.payload,callback:N.callback,next:null};ie===null?J=ie=je:ie=ie.next=je,N=N.next}while(N!==null);ie===null?J=ie=M:ie=ie.next=M}else J=ie=M;N={baseState:H.baseState,firstBaseUpdate:J,lastBaseUpdate:ie,shared:H.shared,effects:H.effects},E.updateQueue=N;return}E=N.lastBaseUpdate,E===null?N.firstBaseUpdate=M:E.next=M,N.lastBaseUpdate=M}function xu(E,M,N,H){var J=E.updateQueue;wr=!1;var ie=J.firstBaseUpdate,je=J.lastBaseUpdate,vt=J.shared.pending;if(vt!==null){J.shared.pending=null;var jt=vt,dn=jt.next;jt.next=null,je===null?ie=dn:je.next=dn,je=jt;var Mn=E.alternate;Mn!==null&&(Mn=Mn.updateQueue,vt=Mn.lastBaseUpdate,vt!==je&&(vt===null?Mn.firstBaseUpdate=dn:vt.next=dn,Mn.lastBaseUpdate=jt))}if(ie!==null){var va=J.baseState;je=0,Mn=dn=jt=null,vt=ie;do{var Jn=vt.lane,yi=vt.eventTime;if((H&Jn)===Jn){Mn!==null&&(Mn=Mn.next={eventTime:yi,lane:0,tag:vt.tag,payload:vt.payload,callback:vt.callback,next:null});e:{var Vn=E,po=vt;switch(Jn=M,yi=N,po.tag){case 1:if(Vn=po.payload,typeof Vn=="function"){va=Vn.call(yi,va,Jn);break e}va=Vn;break e;case 3:Vn.flags=Vn.flags&-65537|128;case 0:if(Vn=po.payload,Jn=typeof Vn=="function"?Vn.call(yi,va,Jn):Vn,Jn==null)break e;va=c({},va,Jn);break e;case 2:wr=!0}}vt.callback!==null&&vt.lane!==0&&(E.flags|=64,Jn=J.effects,Jn===null?J.effects=[vt]:Jn.push(vt))}else yi={eventTime:yi,lane:Jn,tag:vt.tag,payload:vt.payload,callback:vt.callback,next:null},Mn===null?(dn=Mn=yi,jt=va):Mn=Mn.next=yi,je|=Jn;if(vt=vt.next,vt===null){if(vt=J.shared.pending,vt===null)break;Jn=vt,vt=Jn.next,Jn.next=null,J.lastBaseUpdate=Jn,J.shared.pending=null}}while(1);if(Mn===null&&(jt=va),J.baseState=jt,J.firstBaseUpdate=dn,J.lastBaseUpdate=Mn,M=J.shared.interleaved,M!==null){J=M;do je|=J.lane,J=J.next;while(J!==M)}else ie===null&&(J.shared.lanes=0);Ud|=je,E.lanes=je,E.memoizedState=va}}function Sr(E,M,N){if(E=M.effects,M.effects=null,E!==null)for(M=0;M<E.length;M++){var H=E[M],J=H.callback;if(J!==null){if(H.callback=null,H=N,typeof J!="function")throw Error(d(191,J));J.call(H)}}}var Xg=new o.Component().refs;function Rp(E,M,N,H){M=E.memoizedState,N=N(H,M),N=N==null?M:c({},M,N),E.memoizedState=N,E.lanes===0&&(E.updateQueue.baseState=N)}var Ys={isMounted:function(E){return(E=E._reactInternals)?V(E)===E:!1},enqueueSetState:function(E,M,N){E=E._reactInternals;var H=fo(),J=zu(E),ie=Qo(H,J);ie.payload=M,N!=null&&(ie.callback=N),Ti(E,ie),M=Yr(E,J,H),M!==null&&bu(M,E,J)},enqueueReplaceState:function(E,M,N){E=E._reactInternals;var H=fo(),J=zu(E),ie=Qo(H,J);ie.tag=1,ie.payload=M,N!=null&&(ie.callback=N),Ti(E,ie),M=Yr(E,J,H),M!==null&&bu(M,E,J)},enqueueForceUpdate:function(E,M){E=E._reactInternals;var N=fo(),H=zu(E),J=Qo(N,H);J.tag=2,M!=null&&(J.callback=M),Ti(E,J),M=Yr(E,H,N),M!==null&&bu(M,E,H)}};function Hh(E,M,N,H,J,ie,je){return E=E.stateNode,typeof E.shouldComponentUpdate=="function"?E.shouldComponentUpdate(H,ie,je):M.prototype&&M.prototype.isPureReactComponent?!Ad(N,H)||!Ad(J,ie):!0}function jh(E,M,N){var H=!1,J=lo,ie=M.contextType;return typeof ie=="object"&&ie!==null?ie=tr(ie):(J=Zi(M)?Uo:Ra.current,H=M.contextTypes,ie=(H=H!=null)?br(E,J):lo),M=new M(N,ie),E.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Ys,E.stateNode=M,M._reactInternals=E,H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=J,E.__reactInternalMemoizedMaskedChildContext=ie),M}function ka(E,M,N,H){E=M.state,typeof M.componentWillReceiveProps=="function"&&M.componentWillReceiveProps(N,H),typeof M.UNSAFE_componentWillReceiveProps=="function"&&M.UNSAFE_componentWillReceiveProps(N,H),M.state!==E&&Ys.enqueueReplaceState(M,M.state,null)}function m_(E,M,N,H){var J=E.stateNode;J.props=N,J.state=E.memoizedState,J.refs=Xg,Jo(E);var ie=M.contextType;typeof ie=="object"&&ie!==null?J.context=tr(ie):(ie=Zi(M)?Uo:Ra.current,J.context=br(E,ie)),J.state=E.memoizedState,ie=M.getDerivedStateFromProps,typeof ie=="function"&&(Rp(E,M,ie,N),J.state=E.memoizedState),typeof M.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(M=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),M!==J.state&&Ys.enqueueReplaceState(J,J.state,null),xu(E,N,J,H),J.state=E.memoizedState),typeof J.componentDidMount=="function"&&(E.flags|=4194308)}var wu=[],Ks=0,Zg=null,kp=0,So=[],Ar=0,ec=null,tc=1,Ic="";function Md(E,M){wu[Ks++]=kp,wu[Ks++]=Zg,Zg=E,kp=M}function $h(E,M,N){So[Ar++]=tc,So[Ar++]=Ic,So[Ar++]=ec,ec=E;var H=tc;E=Ic;var J=32-xr(H)-1;H&=~(1<<J),N+=1;var ie=32-xr(M)+J;if(30<ie){var je=J-J%5;ie=(H&(1<<je)-1).toString(32),H>>=je,J-=je,tc=1<<32-xr(M)+J|N<<J|H,Ic=ie+E}else tc=1<<ie|N<<J|H,Ic=E}function Td(E){E.return!==null&&(Md(E,1),$h(E,1,0))}function g_(E){for(;E===Zg;)Zg=wu[--Ks],wu[Ks]=null,kp=wu[--Ks],wu[Ks]=null;for(;E===ec;)ec=So[--Ar],So[Ar]=null,Ic=So[--Ar],So[Ar]=null,tc=So[--Ar],So[Ar]=null}var co=null,es=null,Ri=!1,Js=!1,Cl=null;function Hw(E,M){var N=rs(5,null,null,0);N.elementType="DELETED",N.stateNode=M,N.return=E,M=E.deletions,M===null?(E.deletions=[N],E.flags|=16):M.push(N)}function jw(E,M){switch(E.tag){case 5:return M=ct(M,E.type,E.pendingProps),M!==null?(E.stateNode=M,co=E,es=Hn(M),!0):!1;case 6:return M=Gt(M,E.pendingProps),M!==null?(E.stateNode=M,co=E,es=null,!0):!1;case 13:if(M=Mt(M),M!==null){var N=ec!==null?{id:tc,overflow:Ic}:null;return E.memoizedState={dehydrated:M,treeContext:N,retryLane:1073741824},N=rs(18,null,null,0),N.stateNode=M,N.return=E,E.child=N,co=E,es=null,!0}return!1;default:return!1}}function Yg(E){return(E.mode&1)!==0&&(E.flags&128)===0}function y_(E){if(Ri){var M=es;if(M){var N=M;if(!jw(E,M)){if(Yg(E))throw Error(d(418));M=wn(N);var H=co;M&&jw(E,M)?Hw(H,N):(E.flags=E.flags&-4097|2,Ri=!1,co=E)}}else{if(Yg(E))throw Error(d(418));E.flags=E.flags&-4097|2,Ri=!1,co=E}}}function Kg(E){for(E=E.return;E!==null&&E.tag!==5&&E.tag!==3&&E.tag!==13;)E=E.return;co=E}function qh(E){if(!ft||E!==co)return!1;if(!Ri)return Kg(E),Ri=!0,!1;if(E.tag!==3&&(E.tag!==5||ln(E.type)&&!Ke(E.type,E.memoizedProps))){var M=es;if(M){if(Yg(E)){for(E=es;E;)E=wn(E);throw Error(d(418))}for(;M;)Hw(E,M),M=wn(M)}}if(Kg(E),E.tag===13){if(!ft)throw Error(d(316));if(E=E.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));es=Le(E)}else es=co?wn(E.stateNode):null;return!0}function Cd(){ft&&(es=co=null,Js=Ri=!1)}function Jg(E){Cl===null?Cl=[E]:Cl.push(E)}function Xh(E,M,N){if(E=N.ref,E!==null&&typeof E!="function"&&typeof E!="object"){if(N._owner){if(N=N._owner,N){if(N.tag!==1)throw Error(d(309));var H=N.stateNode}if(!H)throw Error(d(147,E));var J=H,ie=""+E;return M!==null&&M.ref!==null&&typeof M.ref=="function"&&M.ref._stringRef===ie?M.ref:(M=function(je){var vt=J.refs;vt===Xg&&(vt=J.refs={}),je===null?delete vt[ie]:vt[ie]=je},M._stringRef=ie,M)}if(typeof E!="string")throw Error(d(284));if(!N._owner)throw Error(d(290,E))}return E}function Su(E,M){throw E=Object.prototype.toString.call(M),Error(d(31,E==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":E))}function Qg(E){var M=E._init;return M(E._payload)}function v_(E){function M(Nt,xt){if(E){var Wt=Nt.deletions;Wt===null?(Nt.deletions=[xt],Nt.flags|=16):Wt.push(xt)}}function N(Nt,xt){if(!E)return null;for(;xt!==null;)M(Nt,xt),xt=xt.sibling;return null}function H(Nt,xt){for(Nt=new Map;xt!==null;)xt.key!==null?Nt.set(xt.key,xt):Nt.set(xt.index,xt),xt=xt.sibling;return Nt}function J(Nt,xt){return Nt=Nc(Nt,xt),Nt.index=0,Nt.sibling=null,Nt}function ie(Nt,xt,Wt){return Nt.index=Wt,E?(Wt=Nt.alternate,Wt!==null?(Wt=Wt.index,Wt<xt?(Nt.flags|=2,xt):Wt):(Nt.flags|=2,xt)):(Nt.flags|=1048576,xt)}function je(Nt){return E&&Nt.alternate===null&&(Nt.flags|=2),Nt}function vt(Nt,xt,Wt,An){return xt===null||xt.tag!==6?(xt=Xt(Wt,Nt.mode,An),xt.return=Nt,xt):(xt=J(xt,Wt),xt.return=Nt,xt)}function jt(Nt,xt,Wt,An){var Dn=Wt.type;return Dn===_?Mn(Nt,xt,Wt.props.children,An,Wt.key):xt!==null&&(xt.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===F&&Qg(Dn)===xt.type)?(An=J(xt,Wt.props),An.ref=Xh(Nt,xt,Wt),An.return=Nt,An):(An=Hy(Wt.type,Wt.key,Wt.props,null,Nt.mode,An),An.ref=Xh(Nt,xt,Wt),An.return=Nt,An)}function dn(Nt,xt,Wt,An){return xt===null||xt.tag!==4||xt.stateNode.containerInfo!==Wt.containerInfo||xt.stateNode.implementation!==Wt.implementation?(xt=yn(Wt,Nt.mode,An),xt.return=Nt,xt):(xt=J(xt,Wt.children||[]),xt.return=Nt,xt)}function Mn(Nt,xt,Wt,An,Dn){return xt===null||xt.tag!==7?(xt=nl(Wt,Nt.mode,An,Dn),xt.return=Nt,xt):(xt=J(xt,Wt),xt.return=Nt,xt)}function va(Nt,xt,Wt){if(typeof xt=="string"&&xt!==""||typeof xt=="number")return xt=Xt(""+xt,Nt.mode,Wt),xt.return=Nt,xt;if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case m:return Wt=Hy(xt.type,xt.key,xt.props,null,Nt.mode,Wt),Wt.ref=Xh(Nt,null,xt),Wt.return=Nt,Wt;case y:return xt=yn(xt,Nt.mode,Wt),xt.return=Nt,xt;case F:var An=xt._init;return va(Nt,An(xt._payload),Wt)}if(Ce(xt)||q(xt))return xt=nl(xt,Nt.mode,Wt,null),xt.return=Nt,xt;Su(Nt,xt)}return null}function Jn(Nt,xt,Wt,An){var Dn=xt!==null?xt.key:null;if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number")return Dn!==null?null:vt(Nt,xt,""+Wt,An);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case m:return Wt.key===Dn?jt(Nt,xt,Wt,An):null;case y:return Wt.key===Dn?dn(Nt,xt,Wt,An):null;case F:return Dn=Wt._init,Jn(Nt,xt,Dn(Wt._payload),An)}if(Ce(Wt)||q(Wt))return Dn!==null?null:Mn(Nt,xt,Wt,An,null);Su(Nt,Wt)}return null}function yi(Nt,xt,Wt,An,Dn){if(typeof An=="string"&&An!==""||typeof An=="number")return Nt=Nt.get(Wt)||null,vt(xt,Nt,""+An,Dn);if(typeof An=="object"&&An!==null){switch(An.$$typeof){case m:return Nt=Nt.get(An.key===null?Wt:An.key)||null,jt(xt,Nt,An,Dn);case y:return Nt=Nt.get(An.key===null?Wt:An.key)||null,dn(xt,Nt,An,Dn);case F:var Nn=An._init;return yi(Nt,xt,Wt,Nn(An._payload),Dn)}if(Ce(An)||q(An))return Nt=Nt.get(Wt)||null,Mn(xt,Nt,An,Dn,null);Su(xt,An)}return null}function Vn(Nt,xt,Wt,An){for(var Dn=null,Nn=null,wa=xt,Za=xt=0,fr=null;wa!==null&&Za<Wt.length;Za++){wa.index>Za?(fr=wa,wa=null):fr=wa.sibling;var Ua=Jn(Nt,wa,Wt[Za],An);if(Ua===null){wa===null&&(wa=fr);break}E&&wa&&Ua.alternate===null&&M(Nt,wa),xt=ie(Ua,xt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua,wa=fr}if(Za===Wt.length)return N(Nt,wa),Ri&&Md(Nt,Za),Dn;if(wa===null){for(;Za<Wt.length;Za++)wa=va(Nt,Wt[Za],An),wa!==null&&(xt=ie(wa,xt,Za),Nn===null?Dn=wa:Nn.sibling=wa,Nn=wa);return Ri&&Md(Nt,Za),Dn}for(wa=H(Nt,wa);Za<Wt.length;Za++)fr=yi(wa,Nt,Za,Wt[Za],An),fr!==null&&(E&&fr.alternate!==null&&wa.delete(fr.key===null?Za:fr.key),xt=ie(fr,xt,Za),Nn===null?Dn=fr:Nn.sibling=fr,Nn=fr);return E&&wa.forEach(function(sc){return M(Nt,sc)}),Ri&&Md(Nt,Za),Dn}function po(Nt,xt,Wt,An){var Dn=q(Wt);if(typeof Dn!="function")throw Error(d(150));if(Wt=Dn.call(Wt),Wt==null)throw Error(d(151));for(var Nn=Dn=null,wa=xt,Za=xt=0,fr=null,Ua=Wt.next();wa!==null&&!Ua.done;Za++,Ua=Wt.next()){wa.index>Za?(fr=wa,wa=null):fr=wa.sibling;var sc=Jn(Nt,wa,Ua.value,An);if(sc===null){wa===null&&(wa=fr);break}E&&wa&&sc.alternate===null&&M(Nt,wa),xt=ie(sc,xt,Za),Nn===null?Dn=sc:Nn.sibling=sc,Nn=sc,wa=fr}if(Ua.done)return N(Nt,wa),Ri&&Md(Nt,Za),Dn;if(wa===null){for(;!Ua.done;Za++,Ua=Wt.next())Ua=va(Nt,Ua.value,An),Ua!==null&&(xt=ie(Ua,xt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua);return Ri&&Md(Nt,Za),Dn}for(wa=H(Nt,wa);!Ua.done;Za++,Ua=Wt.next())Ua=yi(wa,Nt,Za,Ua.value,An),Ua!==null&&(E&&Ua.alternate!==null&&wa.delete(Ua.key===null?Za:Ua.key),xt=ie(Ua,xt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua);return E&&wa.forEach(function(G_){return M(Nt,G_)}),Ri&&Md(Nt,Za),Dn}function Jr(Nt,xt,Wt,An){if(typeof Wt=="object"&&Wt!==null&&Wt.type===_&&Wt.key===null&&(Wt=Wt.props.children),typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case m:e:{for(var Dn=Wt.key,Nn=xt;Nn!==null;){if(Nn.key===Dn){if(Dn=Wt.type,Dn===_){if(Nn.tag===7){N(Nt,Nn.sibling),xt=J(Nn,Wt.props.children),xt.return=Nt,Nt=xt;break e}}else if(Nn.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===F&&Qg(Dn)===Nn.type){N(Nt,Nn.sibling),xt=J(Nn,Wt.props),xt.ref=Xh(Nt,Nn,Wt),xt.return=Nt,Nt=xt;break e}N(Nt,Nn);break}else M(Nt,Nn);Nn=Nn.sibling}Wt.type===_?(xt=nl(Wt.props.children,Nt.mode,An,Wt.key),xt.return=Nt,Nt=xt):(An=Hy(Wt.type,Wt.key,Wt.props,null,Nt.mode,An),An.ref=Xh(Nt,xt,Wt),An.return=Nt,Nt=An)}return je(Nt);case y:e:{for(Nn=Wt.key;xt!==null;){if(xt.key===Nn)if(xt.tag===4&&xt.stateNode.containerInfo===Wt.containerInfo&&xt.stateNode.implementation===Wt.implementation){N(Nt,xt.sibling),xt=J(xt,Wt.children||[]),xt.return=Nt,Nt=xt;break e}else{N(Nt,xt);break}else M(Nt,xt);xt=xt.sibling}xt=yn(Wt,Nt.mode,An),xt.return=Nt,Nt=xt}return je(Nt);case F:return Nn=Wt._init,Jr(Nt,xt,Nn(Wt._payload),An)}if(Ce(Wt))return Vn(Nt,xt,Wt,An);if(q(Wt))return po(Nt,xt,Wt,An);Su(Nt,Wt)}return typeof Wt=="string"&&Wt!==""||typeof Wt=="number"?(Wt=""+Wt,xt!==null&&xt.tag===6?(N(Nt,xt.sibling),xt=J(xt,Wt),xt.return=Nt,Nt=xt):(N(Nt,xt),xt=Xt(Wt,Nt.mode,An),xt.return=Nt,Nt=xt),je(Nt)):N(Nt,xt)}return Jr}var Au=v_(!0),__=v_(!1),Pd={},dt=Xi(Pd),Zh=Xi(Pd),Eu=Xi(Pd);function Qs(E){if(E===Pd)throw Error(d(174));return E}function ey(E,M){Rn(Eu,M),Rn(Zh,E),Rn(dt,Pd),E=He(M),ta(dt),Rn(dt,E)}function Lc(){ta(dt),ta(Zh),ta(Eu)}function nc(E){var M=Qs(Eu.current),N=Qs(dt.current);M=ue(N,E.type,M),N!==M&&(Rn(Zh,E),Rn(dt,M))}function Dp(E){Zh.current===E&&(ta(dt),ta(Zh))}var mi=Xi(0);function Id(E){for(var M=E;M!==null;){if(M.tag===13){var N=M.memoizedState;if(N!==null&&(N=N.dehydrated,N===null||Qt(N)||mn(N)))return M}else if(M.tag===19&&M.memoizedProps.revealOrder!==void 0){if(M.flags&128)return M}else if(M.child!==null){M.child.return=M,M=M.child;continue}if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return null;M=M.return}M.sibling.return=M.return,M=M.sibling}return null}var Mu=[];function Op(){for(var E=0;E<Mu.length;E++){var M=Mu[E];Jt?M._workInProgressVersionPrimary=null:M._workInProgressVersionSecondary=null}Mu.length=0}var ty=f.ReactCurrentDispatcher,Ms=f.ReactCurrentBatchConfig,Ld=0,Ki=null,Ro=null,uo=null,ny=!1,zp=!1,Yh=0,aC=0;function Zr(){throw Error(d(321))}function b_(E,M){if(M===null)return!1;for(var N=0;N<M.length&&N<E.length;N++)if(!Yi(E[N],M[N]))return!1;return!0}function ay(E,M,N,H,J,ie){if(Ld=ie,Ki=M,M.memoizedState=null,M.updateQueue=null,M.lanes=0,ty.current=E===null||E.memoizedState===null?Wp:Vp,E=N(H,J),zp){ie=0;do{if(zp=!1,Yh=0,25<=ie)throw Error(d(301));ie+=1,uo=Ro=null,M.updateQueue=null,ty.current=Xw,E=N(H,J)}while(zp)}if(ty.current=uy,M=Ro!==null&&Ro.next!==null,Ld=0,uo=Ro=Ki=null,ny=!1,M)throw Error(d(300));return E}function Fp(){var E=Yh!==0;return Yh=0,E}function el(){var E={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return uo===null?Ki.memoizedState=uo=E:uo=uo.next=E,uo}function tl(){if(Ro===null){var E=Ki.alternate;E=E!==null?E.memoizedState:null}else E=Ro.next;var M=uo===null?Ki.memoizedState:uo.next;if(M!==null)uo=M,Ro=E;else{if(E===null)throw Error(d(310));Ro=E,E={memoizedState:Ro.memoizedState,baseState:Ro.baseState,baseQueue:Ro.baseQueue,queue:Ro.queue,next:null},uo===null?Ki.memoizedState=uo=E:uo=uo.next=E}return uo}function Pl(E,M){return typeof M=="function"?M(E):M}function Kh(E){var M=tl(),N=M.queue;if(N===null)throw Error(d(311));N.lastRenderedReducer=E;var H=Ro,J=H.baseQueue,ie=N.pending;if(ie!==null){if(J!==null){var je=J.next;J.next=ie.next,ie.next=je}H.baseQueue=J=ie,N.pending=null}if(J!==null){ie=J.next,H=H.baseState;var vt=je=null,jt=null,dn=ie;do{var Mn=dn.lane;if((Ld&Mn)===Mn)jt!==null&&(jt=jt.next={lane:0,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null}),H=dn.hasEagerState?dn.eagerState:E(H,dn.action);else{var va={lane:Mn,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null};jt===null?(vt=jt=va,je=H):jt=jt.next=va,Ki.lanes|=Mn,Ud|=Mn}dn=dn.next}while(dn!==null&&dn!==ie);jt===null?je=H:jt.next=vt,Yi(H,M.memoizedState)||(ts=!0),M.memoizedState=H,M.baseState=je,M.baseQueue=jt,N.lastRenderedState=H}if(E=N.interleaved,E!==null){J=E;do ie=J.lane,Ki.lanes|=ie,Ud|=ie,J=J.next;while(J!==E)}else J===null&&(N.lanes=0);return[M.memoizedState,N.dispatch]}function Tu(E){var M=tl(),N=M.queue;if(N===null)throw Error(d(311));N.lastRenderedReducer=E;var H=N.dispatch,J=N.pending,ie=M.memoizedState;if(J!==null){N.pending=null;var je=J=J.next;do ie=E(ie,je.action),je=je.next;while(je!==J);Yi(ie,M.memoizedState)||(ts=!0),M.memoizedState=ie,M.baseQueue===null&&(M.baseState=ie),N.lastRenderedState=ie}return[ie,H]}function Np(){}function iy(E,M){var N=Ki,H=tl(),J=M(),ie=!Yi(H.memoizedState,J);if(ie&&(H.memoizedState=J,ts=!0),H=H.queue,ef(x_.bind(null,N,H,E),[E]),H.getSnapshot!==M||ie||uo!==null&&uo.memoizedState.tag&1){if(N.flags|=2048,kd(9,ry.bind(null,N,H,J,M),void 0,null),Gi===null)throw Error(d(349));Ld&30||Rd(N,M,J)}return J}function Rd(E,M,N){E.flags|=16384,E={getSnapshot:M,value:N},M=Ki.updateQueue,M===null?(M={lastEffect:null,stores:null},Ki.updateQueue=M,M.stores=[E]):(N=M.stores,N===null?M.stores=[E]:N.push(E))}function ry(E,M,N,H){M.value=N,M.getSnapshot=H,oy(M)&&Yr(E,1,-1)}function x_(E,M,N){return N(function(){oy(M)&&Yr(E,1,-1)})}function oy(E){var M=E.getSnapshot;E=E.value;try{var N=M();return!Yi(E,N)}catch{return!0}}function sy(E){var M=el();return typeof E=="function"&&(E=E()),M.memoizedState=M.baseState=E,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pl,lastRenderedState:E},M.queue=E,E=E.dispatch=T_.bind(null,Ki,E),[M.memoizedState,E]}function kd(E,M,N,H){return E={tag:E,create:M,destroy:N,deps:H,next:null},M=Ki.updateQueue,M===null?(M={lastEffect:null,stores:null},Ki.updateQueue=M,M.lastEffect=E.next=E):(N=M.lastEffect,N===null?M.lastEffect=E.next=E:(H=N.next,N.next=E,E.next=H,M.lastEffect=E)),E}function Bp(){return tl().memoizedState}function Jh(E,M,N,H){var J=el();Ki.flags|=E,J.memoizedState=kd(1|M,N,void 0,H===void 0?null:H)}function Qh(E,M,N,H){var J=tl();H=H===void 0?null:H;var ie=void 0;if(Ro!==null){var je=Ro.memoizedState;if(ie=je.destroy,H!==null&&b_(H,je.deps)){J.memoizedState=kd(M,N,ie,H);return}}Ki.flags|=E,J.memoizedState=kd(1|M,N,ie,H)}function Ln(E,M){return Jh(8390656,8,E,M)}function ef(E,M){return Qh(2048,8,E,M)}function Up(E,M){return Qh(4,2,E,M)}function w_(E,M){return Qh(4,4,E,M)}function S_(E,M){if(typeof M=="function")return E=E(),M(E),function(){M(null)};if(M!=null)return E=E(),M.current=E,function(){M.current=null}}function A_(E,M,N){return N=N!=null?N.concat([E]):null,Qh(4,4,S_.bind(null,M,E),N)}function Cu(){}function E_(E,M){var N=tl();M=M===void 0?null:M;var H=N.memoizedState;return H!==null&&M!==null&&b_(M,H[1])?H[0]:(N.memoizedState=[E,M],E)}function $w(E,M){var N=tl();M=M===void 0?null:M;var H=N.memoizedState;return H!==null&&M!==null&&b_(M,H[1])?H[0]:(E=E(),N.memoizedState=[E,M],E)}function iC(E,M){var N=Bn;Bn=N!==0&&4>N?N:4,E(!0);var H=Ms.transition;Ms.transition={};try{E(!1),M()}finally{Bn=N,Ms.transition=H}}function qw(){return tl().memoizedState}function M_(E,M,N){var H=zu(E);N={lane:H,action:N,hasEagerState:!1,eagerState:null,next:null},ly(E)?cy(M,N):(C_(E,M,N),N=fo(),E=Yr(E,H,N),E!==null&&P_(E,M,H))}function T_(E,M,N){var H=zu(E),J={lane:H,action:N,hasEagerState:!1,eagerState:null,next:null};if(ly(E))cy(M,J);else{C_(E,M,J);var ie=E.alternate;if(E.lanes===0&&(ie===null||ie.lanes===0)&&(ie=M.lastRenderedReducer,ie!==null))try{var je=M.lastRenderedState,vt=ie(je,N);if(J.hasEagerState=!0,J.eagerState=vt,Yi(vt,je))return}catch{}finally{}N=fo(),E=Yr(E,H,N),E!==null&&P_(E,M,H)}}function ly(E){var M=E.alternate;return E===Ki||M!==null&&M===Ki}function cy(E,M){zp=ny=!0;var N=E.pending;N===null?M.next=M:(M.next=N.next,N.next=M),E.pending=M}function C_(E,M,N){Gi!==null&&E.mode&1&&!(Da&2)?(E=M.interleaved,E===null?(N.next=N,Vo===null?Vo=[M]:Vo.push(M)):(N.next=E.next,E.next=N),M.interleaved=N):(E=M.pending,E===null?N.next=N:(N.next=E.next,E.next=N),M.pending=N)}function P_(E,M,N){if(N&4194240){var H=M.lanes;H&=E.pendingLanes,N|=H,M.lanes=N,vn(E,N)}}var uy={readContext:tr,useCallback:Zr,useContext:Zr,useEffect:Zr,useImperativeHandle:Zr,useInsertionEffect:Zr,useLayoutEffect:Zr,useMemo:Zr,useReducer:Zr,useRef:Zr,useState:Zr,useDebugValue:Zr,useDeferredValue:Zr,useTransition:Zr,useMutableSource:Zr,useSyncExternalStore:Zr,useId:Zr,unstable_isNewReconciler:!1},Wp={readContext:tr,useCallback:function(E,M){return el().memoizedState=[E,M===void 0?null:M],E},useContext:tr,useEffect:Ln,useImperativeHandle:function(E,M,N){return N=N!=null?N.concat([E]):null,Jh(4194308,4,S_.bind(null,M,E),N)},useLayoutEffect:function(E,M){return Jh(4194308,4,E,M)},useInsertionEffect:function(E,M){return Jh(4,2,E,M)},useMemo:function(E,M){var N=el();return M=M===void 0?null:M,E=E(),N.memoizedState=[E,M],E},useReducer:function(E,M,N){var H=el();return M=N!==void 0?N(M):M,H.memoizedState=H.baseState=M,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:E,lastRenderedState:M},H.queue=E,E=E.dispatch=M_.bind(null,Ki,E),[H.memoizedState,E]},useRef:function(E){var M=el();return E={current:E},M.memoizedState=E},useState:sy,useDebugValue:Cu,useDeferredValue:function(E){var M=sy(E),N=M[0],H=M[1];return Ln(function(){var J=Ms.transition;Ms.transition={};try{H(E)}finally{Ms.transition=J}},[E]),N},useTransition:function(){var E=sy(!1),M=E[0];return E=iC.bind(null,E[1]),el().memoizedState=E,[M,E]},useMutableSource:function(){},useSyncExternalStore:function(E,M,N){var H=Ki,J=el();if(Ri){if(N===void 0)throw Error(d(407));N=N()}else{if(N=M(),Gi===null)throw Error(d(349));Ld&30||Rd(H,M,N)}J.memoizedState=N;var ie={value:N,getSnapshot:M};return J.queue=ie,Ln(x_.bind(null,H,ie,E),[E]),H.flags|=2048,kd(9,ry.bind(null,H,ie,N,M),void 0,null),N},useId:function(){var E=el(),M=Gi.identifierPrefix;if(Ri){var N=Ic,H=tc;N=(H&~(1<<32-xr(H)-1)).toString(32)+N,M=":"+M+"R"+N,N=Yh++,0<N&&(M+="H"+N.toString(32)),M+=":"}else N=aC++,M=":"+M+"r"+N.toString(32)+":";return E.memoizedState=M},unstable_isNewReconciler:!1},Vp={readContext:tr,useCallback:E_,useContext:tr,useEffect:ef,useImperativeHandle:A_,useInsertionEffect:Up,useLayoutEffect:w_,useMemo:$w,useReducer:Kh,useRef:Bp,useState:function(){return Kh(Pl)},useDebugValue:Cu,useDeferredValue:function(E){var M=Kh(Pl),N=M[0],H=M[1];return ef(function(){var J=Ms.transition;Ms.transition={};try{H(E)}finally{Ms.transition=J}},[E]),N},useTransition:function(){var E=Kh(Pl)[0],M=tl().memoizedState;return[E,M]},useMutableSource:Np,useSyncExternalStore:iy,useId:qw,unstable_isNewReconciler:!1},Xw={readContext:tr,useCallback:E_,useContext:tr,useEffect:ef,useImperativeHandle:A_,useInsertionEffect:Up,useLayoutEffect:w_,useMemo:$w,useReducer:Tu,useRef:Bp,useState:function(){return Tu(Pl)},useDebugValue:Cu,useDeferredValue:function(E){var M=Tu(Pl),N=M[0],H=M[1];return ef(function(){var J=Ms.transition;Ms.transition={};try{H(E)}finally{Ms.transition=J}},[E]),N},useTransition:function(){var E=Tu(Pl)[0],M=tl().memoizedState;return[E,M]},useMutableSource:Np,useSyncExternalStore:iy,useId:qw,unstable_isNewReconciler:!1};function tf(E,M){try{var N="",H=M;do N+=Ml(H),H=H.return;while(H);var J=N}catch(ie){J=`
Error generating stack: `+ie.message+`
`+ie.stack}return{value:E,source:M,stack:J}}function Gp(E,M){try{console.error(M.value)}catch(N){setTimeout(function(){throw N})}}var ac=typeof WeakMap=="function"?WeakMap:Map;function dy(E,M,N){N=Qo(-1,N),N.tag=3,N.payload={element:null};var H=M.value;return N.callback=function(){Dy||(Dy=!0,F_=H),Gp(E,M)},N}function I_(E,M,N){N=Qo(-1,N),N.tag=3;var H=E.type.getDerivedStateFromError;if(typeof H=="function"){var J=M.value;N.payload=function(){return H(J)},N.callback=function(){Gp(E,M)}}var ie=E.stateNode;return ie!==null&&typeof ie.componentDidCatch=="function"&&(N.callback=function(){Gp(E,M),typeof H!="function"&&(Du===null?Du=new Set([this]):Du.add(this));var je=M.stack;this.componentDidCatch(M.value,{componentStack:je!==null?je:""})}),N}function hy(E,M,N){var H=E.pingCache;if(H===null){H=E.pingCache=new ac;var J=new Set;H.set(M,J)}else J=H.get(M),J===void 0&&(J=new Set,H.set(M,J));J.has(N)||(J.add(N),E=U_.bind(null,E,M,N),M.then(E,E))}function L_(E){do{var M;if((M=E.tag===13)&&(M=E.memoizedState,M=M!==null?M.dehydrated!==null:!0),M)return E;E=E.return}while(E!==null);return null}function fy(E,M,N,H,J){return E.mode&1?(E.flags|=65536,E.lanes=J,E):(E===M?E.flags|=65536:(E.flags|=128,N.flags|=131072,N.flags&=-52805,N.tag===1&&(N.alternate===null?N.tag=17:(M=Qo(-1,1),M.tag=2,Ti(N,M))),N.lanes|=1),E)}function ic(E){E.flags|=4}function py(E,M){if(E!==null&&E.child===M.child)return!0;if(M.flags&16)return!1;for(E=M.child;E!==null;){if(E.flags&12854||E.subtreeFlags&12854)return!1;E=E.sibling}return!0}var Hp,Pu,my,nf;if(Pt)Hp=function(E,M){for(var N=M.child;N!==null;){if(N.tag===5||N.tag===6)Ee(E,N.stateNode);else if(N.tag!==4&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===M)break;for(;N.sibling===null;){if(N.return===null||N.return===M)return;N=N.return}N.sibling.return=N.return,N=N.sibling}},Pu=function(){},my=function(E,M,N,H,J){if(E=E.memoizedProps,E!==H){var ie=M.stateNode,je=Qs(dt.current);N=Xe(ie,N,E,H,J,je),(M.updateQueue=N)&&ic(M)}},nf=function(E,M,N,H){N!==H&&ic(M)};else if(Pe){Hp=function(E,M,N,H){for(var J=M.child;J!==null;){if(J.tag===5){var ie=J.stateNode;N&&H&&(ie=yt(ie,J.type,J.memoizedProps,J)),Ee(E,ie)}else if(J.tag===6)ie=J.stateNode,N&&H&&(ie=ut(ie,J.memoizedProps,J)),Ee(E,ie);else if(J.tag!==4){if(J.tag===22&&J.memoizedState!==null)ie=J.child,ie!==null&&(ie.return=J),Hp(E,J,!0,!0);else if(J.child!==null){J.child.return=J,J=J.child;continue}}if(J===M)break;for(;J.sibling===null;){if(J.return===null||J.return===M)return;J=J.return}J.sibling.return=J.return,J=J.sibling}};var Zw=function(E,M,N,H){for(var J=M.child;J!==null;){if(J.tag===5){var ie=J.stateNode;N&&H&&(ie=yt(ie,J.type,J.memoizedProps,J)),ze(E,ie)}else if(J.tag===6)ie=J.stateNode,N&&H&&(ie=ut(ie,J.memoizedProps,J)),ze(E,ie);else if(J.tag!==4){if(J.tag===22&&J.memoizedState!==null)ie=J.child,ie!==null&&(ie.return=J),Zw(E,J,!0,!0);else if(J.child!==null){J.child.return=J,J=J.child;continue}}if(J===M)break;for(;J.sibling===null;){if(J.return===null||J.return===M)return;J=J.return}J.sibling.return=J.return,J=J.sibling}};Pu=function(E,M){var N=M.stateNode;if(!py(E,M)){E=N.containerInfo;var H=Me(E);Zw(H,M,!1,!1),N.pendingChildren=H,ic(M),Je(E,H)}},my=function(E,M,N,H,J){var ie=E.stateNode,je=E.memoizedProps;if((E=py(E,M))&&je===H)M.stateNode=ie;else{var vt=M.stateNode,jt=Qs(dt.current),dn=null;je!==H&&(dn=Xe(vt,N,je,H,J,jt)),E&&dn===null?M.stateNode=ie:(ie=Se(ie,dn,N,je,H,M,E,vt),Ye(ie,N,H,J,jt)&&ic(M),M.stateNode=ie,E?ic(M):Hp(ie,M,!1,!1))}},nf=function(E,M,N,H){N!==H?(E=Qs(Eu.current),N=Qs(dt.current),M.stateNode=Ue(H,E,N,M),ic(M)):M.stateNode=E.stateNode}}else Pu=function(){},my=function(){},nf=function(){};function Dd(E,M){if(!Ri)switch(E.tailMode){case"hidden":M=E.tail;for(var N=null;M!==null;)M.alternate!==null&&(N=M),M=M.sibling;N===null?E.tail=null:N.sibling=null;break;case"collapsed":N=E.tail;for(var H=null;N!==null;)N.alternate!==null&&(H=N),N=N.sibling;H===null?M||E.tail===null?E.tail=null:E.tail.sibling=null:H.sibling=null}}function ko(E){var M=E.alternate!==null&&E.alternate.child===E.child,N=0,H=0;if(M)for(var J=E.child;J!==null;)N|=J.lanes|J.childLanes,H|=J.subtreeFlags&14680064,H|=J.flags&14680064,J.return=E,J=J.sibling;else for(J=E.child;J!==null;)N|=J.lanes|J.childLanes,H|=J.subtreeFlags,H|=J.flags,J.return=E,J=J.sibling;return E.subtreeFlags|=H,E.childLanes=N,M}function gy(E,M,N){var H=M.pendingProps;switch(g_(M),M.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ko(M),null;case 1:return Zi(M.type)&&ci(),ko(M),null;case 3:return H=M.stateNode,Lc(),ta(Ei),ta(Ra),Op(),H.pendingContext&&(H.context=H.pendingContext,H.pendingContext=null),(E===null||E.child===null)&&(qh(M)?ic(M):E===null||E.memoizedState.isDehydrated&&!(M.flags&256)||(M.flags|=1024,Cl!==null&&(Fy(Cl),Cl=null))),Pu(E,M),ko(M),null;case 5:Dp(M),N=Qs(Eu.current);var J=M.type;if(E!==null&&M.stateNode!=null)my(E,M,J,H,N),E.ref!==M.ref&&(M.flags|=512,M.flags|=2097152);else{if(!H){if(M.stateNode===null)throw Error(d(166));return ko(M),null}if(E=Qs(dt.current),qh(M)){if(!ft)throw Error(d(175));E=Ma(M.stateNode,M.type,M.memoizedProps,N,E,M,!Js),M.updateQueue=E,E!==null&&ic(M)}else{var ie=ne(J,H,N,E,M);Hp(ie,M,!1,!1),M.stateNode=ie,Ye(ie,J,H,N,E)&&ic(M)}M.ref!==null&&(M.flags|=512,M.flags|=2097152)}return ko(M),null;case 6:if(E&&M.stateNode!=null)nf(E,M,E.memoizedProps,H);else{if(typeof H!="string"&&M.stateNode===null)throw Error(d(166));if(E=Qs(Eu.current),N=Qs(dt.current),qh(M)){if(!ft)throw Error(d(176));if(E=M.stateNode,H=M.memoizedProps,(N=Ii(E,H,M,!Js))&&(J=co,J!==null))switch(ie=(J.mode&1)!==0,J.tag){case 3:Tn(J.stateNode.containerInfo,E,H,ie);break;case 5:qn(J.type,J.memoizedProps,J.stateNode,E,H,ie)}N&&ic(M)}else M.stateNode=Ue(H,E,N,M)}return ko(M),null;case 13:if(ta(mi),H=M.memoizedState,Ri&&es!==null&&M.mode&1&&!(M.flags&128)){for(E=es;E;)E=wn(E);return Cd(),M.flags|=98560,M}if(H!==null&&H.dehydrated!==null){if(H=qh(M),E===null){if(!H)throw Error(d(318));if(!ft)throw Error(d(344));if(E=M.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));pi(E,M)}else Cd(),!(M.flags&128)&&(M.memoizedState=null),M.flags|=4;return ko(M),null}return Cl!==null&&(Fy(Cl),Cl=null),M.flags&128?(M.lanes=N,M):(H=H!==null,N=!1,E===null?qh(M):N=E.memoizedState!==null,H&&!N&&(M.child.flags|=8192,M.mode&1&&(E===null||mi.current&1?Fr===0&&(Fr=3):By())),M.updateQueue!==null&&(M.flags|=4),ko(M),null);case 4:return Lc(),Pu(E,M),E===null&&St(M.stateNode.containerInfo),ko(M),null;case 10:return zr(M.type._context),ko(M),null;case 17:return Zi(M.type)&&ci(),ko(M),null;case 19:if(ta(mi),J=M.memoizedState,J===null)return ko(M),null;if(H=(M.flags&128)!==0,ie=J.rendering,ie===null)if(H)Dd(J,!1);else{if(Fr!==0||E!==null&&E.flags&128)for(E=M.child;E!==null;){if(ie=Id(E),ie!==null){for(M.flags|=128,Dd(J,!1),E=ie.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),M.subtreeFlags=0,E=N,H=M.child;H!==null;)N=H,J=E,N.flags&=14680066,ie=N.alternate,ie===null?(N.childLanes=0,N.lanes=J,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=ie.childLanes,N.lanes=ie.lanes,N.child=ie.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=ie.memoizedProps,N.memoizedState=ie.memoizedState,N.updateQueue=ie.updateQueue,N.type=ie.type,J=ie.dependencies,N.dependencies=J===null?null:{lanes:J.lanes,firstContext:J.firstContext}),H=H.sibling;return Rn(mi,mi.current&1|2),M.child}E=E.sibling}J.tail!==null&&ai()>ku&&(M.flags|=128,H=!0,Dd(J,!1),M.lanes=4194304)}else{if(!H)if(E=Id(ie),E!==null){if(M.flags|=128,H=!0,E=E.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),Dd(J,!0),J.tail===null&&J.tailMode==="hidden"&&!ie.alternate&&!Ri)return ko(M),null}else 2*ai()-J.renderingStartTime>ku&&N!==1073741824&&(M.flags|=128,H=!0,Dd(J,!1),M.lanes=4194304);J.isBackwards?(ie.sibling=M.child,M.child=ie):(E=J.last,E!==null?E.sibling=ie:M.child=ie,J.last=ie)}return J.tail!==null?(M=J.tail,J.rendering=M,J.tail=M.sibling,J.renderingStartTime=ai(),M.sibling=null,E=mi.current,Rn(mi,H?E&1|2:E&1),M):(ko(M),null);case 22:case 23:return dm(),H=M.memoizedState!==null,E!==null&&E.memoizedState!==null!==H&&(M.flags|=8192),H&&M.mode&1?Ts&1073741824&&(ko(M),Pt&&M.subtreeFlags&6&&(M.flags|=8192)):ko(M),null;case 24:return null;case 25:return null}throw Error(d(156,M.tag))}var rC=f.ReactCurrentOwner,ts=!1;function Do(E,M,N,H){M.child=E===null?__(M,null,N,H):Au(M,E.child,N,H)}function Od(E,M,N,H,J){N=N.render;var ie=M.ref;return xn(M,J),H=ay(E,M,N,H,ie,J),N=Fp(),E!==null&&!ts?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~J,oc(E,M,J)):(Ri&&N&&Td(M),M.flags|=1,Do(E,M,H,J),M.child)}function Yw(E,M,N,H,J){if(E===null){var ie=N.type;return typeof ie=="function"&&!Gd(ie)&&ie.defaultProps===void 0&&N.compare===null&&N.defaultProps===void 0?(M.tag=15,M.type=ie,Kw(E,M,ie,H,J)):(E=Hy(N.type,null,H,M,M.mode,J),E.ref=M.ref,E.return=M,M.child=E)}if(ie=E.child,!(E.lanes&J)){var je=ie.memoizedProps;if(N=N.compare,N=N!==null?N:Ad,N(je,H)&&E.ref===M.ref)return oc(E,M,J)}return M.flags|=1,E=Nc(ie,H),E.ref=M.ref,E.return=M,M.child=E}function Kw(E,M,N,H,J){if(E!==null&&Ad(E.memoizedProps,H)&&E.ref===M.ref)if(ts=!1,(E.lanes&J)!==0)E.flags&131072&&(ts=!0);else return M.lanes=E.lanes,oc(E,M,J);return R_(E,M,N,H,J)}function Jw(E,M,N){var H=M.pendingProps,J=H.children,ie=E!==null?E.memoizedState:null;if(H.mode==="hidden")if(!(M.mode&1))M.memoizedState={baseLanes:0,cachePool:null},Rn(Bd,Ts),Ts|=N;else if(N&1073741824)M.memoizedState={baseLanes:0,cachePool:null},H=ie!==null?ie.baseLanes:N,Rn(Bd,Ts),Ts|=H;else return E=ie!==null?ie.baseLanes|N:N,M.lanes=M.childLanes=1073741824,M.memoizedState={baseLanes:E,cachePool:null},M.updateQueue=null,Rn(Bd,Ts),Ts|=E,null;else ie!==null?(H=ie.baseLanes|N,M.memoizedState=null):H=N,Rn(Bd,Ts),Ts|=H;return Do(E,M,J,N),M.child}function Qw(E,M){var N=M.ref;(E===null&&N!==null||E!==null&&E.ref!==N)&&(M.flags|=512,M.flags|=2097152)}function R_(E,M,N,H,J){var ie=Zi(N)?Uo:Ra.current;return ie=br(M,ie),xn(M,J),N=ay(E,M,N,H,ie,J),H=Fp(),E!==null&&!ts?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~J,oc(E,M,J)):(Ri&&H&&Td(M),M.flags|=1,Do(E,M,N,J),M.child)}function e2(E,M,N,H,J){if(Zi(N)){var ie=!0;Yn(M)}else ie=!1;if(xn(M,J),M.stateNode===null)E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),jh(M,N,H),m_(M,N,H,J),H=!0;else if(E===null){var je=M.stateNode,vt=M.memoizedProps;je.props=vt;var jt=je.context,dn=N.contextType;typeof dn=="object"&&dn!==null?dn=tr(dn):(dn=Zi(N)?Uo:Ra.current,dn=br(M,dn));var Mn=N.getDerivedStateFromProps,va=typeof Mn=="function"||typeof je.getSnapshotBeforeUpdate=="function";va||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(vt!==H||jt!==dn)&&ka(M,je,H,dn),wr=!1;var Jn=M.memoizedState;je.state=Jn,xu(M,H,je,J),jt=M.memoizedState,vt!==H||Jn!==jt||Ei.current||wr?(typeof Mn=="function"&&(Rp(M,N,Mn,H),jt=M.memoizedState),(vt=wr||Hh(M,N,vt,H,Jn,jt,dn))?(va||typeof je.UNSAFE_componentWillMount!="function"&&typeof je.componentWillMount!="function"||(typeof je.componentWillMount=="function"&&je.componentWillMount(),typeof je.UNSAFE_componentWillMount=="function"&&je.UNSAFE_componentWillMount()),typeof je.componentDidMount=="function"&&(M.flags|=4194308)):(typeof je.componentDidMount=="function"&&(M.flags|=4194308),M.memoizedProps=H,M.memoizedState=jt),je.props=H,je.state=jt,je.context=dn,H=vt):(typeof je.componentDidMount=="function"&&(M.flags|=4194308),H=!1)}else{je=M.stateNode,p_(E,M),vt=M.memoizedProps,dn=M.type===M.elementType?vt:wo(M.type,vt),je.props=dn,va=M.pendingProps,Jn=je.context,jt=N.contextType,typeof jt=="object"&&jt!==null?jt=tr(jt):(jt=Zi(N)?Uo:Ra.current,jt=br(M,jt));var yi=N.getDerivedStateFromProps;(Mn=typeof yi=="function"||typeof je.getSnapshotBeforeUpdate=="function")||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(vt!==va||Jn!==jt)&&ka(M,je,H,jt),wr=!1,Jn=M.memoizedState,je.state=Jn,xu(M,H,je,J);var Vn=M.memoizedState;vt!==va||Jn!==Vn||Ei.current||wr?(typeof yi=="function"&&(Rp(M,N,yi,H),Vn=M.memoizedState),(dn=wr||Hh(M,N,dn,H,Jn,Vn,jt)||!1)?(Mn||typeof je.UNSAFE_componentWillUpdate!="function"&&typeof je.componentWillUpdate!="function"||(typeof je.componentWillUpdate=="function"&&je.componentWillUpdate(H,Vn,jt),typeof je.UNSAFE_componentWillUpdate=="function"&&je.UNSAFE_componentWillUpdate(H,Vn,jt)),typeof je.componentDidUpdate=="function"&&(M.flags|=4),typeof je.getSnapshotBeforeUpdate=="function"&&(M.flags|=1024)):(typeof je.componentDidUpdate!="function"||vt===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||vt===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=1024),M.memoizedProps=H,M.memoizedState=Vn),je.props=H,je.state=Vn,je.context=jt,H=dn):(typeof je.componentDidUpdate!="function"||vt===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||vt===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=1024),H=!1)}return jp(E,M,N,H,ie,J)}function jp(E,M,N,H,J,ie){Qw(E,M);var je=(M.flags&128)!==0;if(!H&&!je)return J&&Vi(M,N,!1),oc(E,M,ie);H=M.stateNode,rC.current=M;var vt=je&&typeof N.getDerivedStateFromError!="function"?null:H.render();return M.flags|=1,E!==null&&je?(M.child=Au(M,E.child,null,ie),M.child=Au(M,null,vt,ie)):Do(E,M,vt,ie),M.memoizedState=H.state,J&&Vi(M,N,!0),M.child}function yy(E){var M=E.stateNode;M.pendingContext?Dr(E,M.pendingContext,M.pendingContext!==M.context):M.context&&Dr(E,M.context,!1),ey(E,M.containerInfo)}function vy(E,M,N,H,J){return Cd(),Jg(J),M.flags|=256,Do(E,M,N,H),M.child}var $p={dehydrated:null,treeContext:null,retryLane:0};function qp(E){return{baseLanes:E,cachePool:null}}function k_(E,M,N){var H=M.pendingProps,J=mi.current,ie=!1,je=(M.flags&128)!==0,vt;if((vt=je)||(vt=E!==null&&E.memoizedState===null?!1:(J&2)!==0),vt?(ie=!0,M.flags&=-129):(E===null||E.memoizedState!==null)&&(J|=1),Rn(mi,J&1),E===null)return y_(M),E=M.memoizedState,E!==null&&(E=E.dehydrated,E!==null)?(M.mode&1?mn(E)?M.lanes=8:M.lanes=1073741824:M.lanes=1,null):(J=H.children,E=H.fallback,ie?(H=M.mode,ie=M.child,J={mode:"hidden",children:J},!(H&1)&&ie!==null?(ie.childLanes=0,ie.pendingProps=J):ie=Fu(J,H,0,null),E=nl(E,H,N,null),ie.return=M,E.return=M,ie.sibling=E,M.child=ie,M.child.memoizedState=qp(N),M.memoizedState=$p,E):_y(M,J));if(J=E.memoizedState,J!==null){if(vt=J.dehydrated,vt!==null){if(je)return M.flags&256?(M.flags&=-257,rc(E,M,N,Error(d(422)))):M.memoizedState!==null?(M.child=E.child,M.flags|=128,null):(ie=H.fallback,J=M.mode,H=Fu({mode:"visible",children:H.children},J,0,null),ie=nl(ie,J,N,null),ie.flags|=2,H.return=M,ie.return=M,H.sibling=ie,M.child=H,M.mode&1&&Au(M,E.child,null,N),M.child.memoizedState=qp(N),M.memoizedState=$p,ie);if(!(M.mode&1))M=rc(E,M,N,null);else if(mn(vt))M=rc(E,M,N,Error(d(419)));else if(H=(N&E.childLanes)!==0,ts||H){if(H=Gi,H!==null){switch(N&-N){case 4:ie=2;break;case 16:ie=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ie=32;break;case 536870912:ie=268435456;break;default:ie=0}H=ie&(H.suspendedLanes|N)?0:ie,H!==0&&H!==J.retryLane&&(J.retryLane=H,Yr(E,H,-1))}By(),M=rc(E,M,N,Error(d(421)))}else Qt(vt)?(M.flags|=128,M.child=E.child,M=W_.bind(null,E),nn(vt,M),M=null):(N=J.treeContext,ft&&(es=Ca(vt),co=M,Ri=!0,Cl=null,Js=!1,N!==null&&(So[Ar++]=tc,So[Ar++]=Ic,So[Ar++]=ec,tc=N.id,Ic=N.overflow,ec=M)),M=_y(M,M.pendingProps.children),M.flags|=4096);return M}return ie?(H=D_(E,M,H.children,H.fallback,N),ie=M.child,J=E.child.memoizedState,ie.memoizedState=J===null?qp(N):{baseLanes:J.baseLanes|N,cachePool:null},ie.childLanes=E.childLanes&~N,M.memoizedState=$p,H):(N=by(E,M,H.children,N),M.memoizedState=null,N)}return ie?(H=D_(E,M,H.children,H.fallback,N),ie=M.child,J=E.child.memoizedState,ie.memoizedState=J===null?qp(N):{baseLanes:J.baseLanes|N,cachePool:null},ie.childLanes=E.childLanes&~N,M.memoizedState=$p,H):(N=by(E,M,H.children,N),M.memoizedState=null,N)}function _y(E,M){return M=Fu({mode:"visible",children:M},E.mode,0,null),M.return=E,E.child=M}function by(E,M,N,H){var J=E.child;return E=J.sibling,N=Nc(J,{mode:"visible",children:N}),!(M.mode&1)&&(N.lanes=H),N.return=M,N.sibling=null,E!==null&&(H=M.deletions,H===null?(M.deletions=[E],M.flags|=16):H.push(E)),M.child=N}function D_(E,M,N,H,J){var ie=M.mode;E=E.child;var je=E.sibling,vt={mode:"hidden",children:N};return!(ie&1)&&M.child!==E?(N=M.child,N.childLanes=0,N.pendingProps=vt,M.deletions=null):(N=Nc(E,vt),N.subtreeFlags=E.subtreeFlags&14680064),je!==null?H=Nc(je,H):(H=nl(H,ie,J,null),H.flags|=2),H.return=M,N.return=M,N.sibling=H,M.child=N,H}function rc(E,M,N,H){return H!==null&&Jg(H),Au(M,E.child,null,N),E=_y(M,M.pendingProps.children),E.flags|=2,M.memoizedState=null,E}function af(E,M,N){E.lanes|=M;var H=E.alternate;H!==null&&(H.lanes|=M),Mi(E.return,M,N)}function xy(E,M,N,H,J){var ie=E.memoizedState;ie===null?E.memoizedState={isBackwards:M,rendering:null,renderingStartTime:0,last:H,tail:N,tailMode:J}:(ie.isBackwards=M,ie.rendering=null,ie.renderingStartTime=0,ie.last=H,ie.tail=N,ie.tailMode=J)}function Iu(E,M,N){var H=M.pendingProps,J=H.revealOrder,ie=H.tail;if(Do(E,M,H.children,N),H=mi.current,H&2)H=H&1|2,M.flags|=128;else{if(E!==null&&E.flags&128)e:for(E=M.child;E!==null;){if(E.tag===13)E.memoizedState!==null&&af(E,N,M);else if(E.tag===19)af(E,N,M);else if(E.child!==null){E.child.return=E,E=E.child;continue}if(E===M)break e;for(;E.sibling===null;){if(E.return===null||E.return===M)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}H&=1}if(Rn(mi,H),!(M.mode&1))M.memoizedState=null;else switch(J){case"forwards":for(N=M.child,J=null;N!==null;)E=N.alternate,E!==null&&Id(E)===null&&(J=N),N=N.sibling;N=J,N===null?(J=M.child,M.child=null):(J=N.sibling,N.sibling=null),xy(M,!1,J,N,ie);break;case"backwards":for(N=null,J=M.child,M.child=null;J!==null;){if(E=J.alternate,E!==null&&Id(E)===null){M.child=J;break}E=J.sibling,J.sibling=N,N=J,J=E}xy(M,!0,N,null,ie);break;case"together":xy(M,!1,null,null,void 0);break;default:M.memoizedState=null}return M.child}function oc(E,M,N){if(E!==null&&(M.dependencies=E.dependencies),Ud|=M.lanes,!(N&M.childLanes))return null;if(E!==null&&M.child!==E.child)throw Error(d(153));if(M.child!==null){for(E=M.child,N=Nc(E,E.pendingProps),M.child=N,N.return=M;E.sibling!==null;)E=E.sibling,N=N.sibling=Nc(E,E.pendingProps),N.return=M;N.sibling=null}return M.child}function zd(E,M,N){switch(M.tag){case 3:yy(M),Cd();break;case 5:nc(M);break;case 1:Zi(M.type)&&Yn(M);break;case 4:ey(M,M.stateNode.containerInfo);break;case 10:Ed(M,M.type._context,M.memoizedProps.value);break;case 13:var H=M.memoizedState;if(H!==null)return H.dehydrated!==null?(Rn(mi,mi.current&1),M.flags|=128,null):N&M.child.childLanes?k_(E,M,N):(Rn(mi,mi.current&1),E=oc(E,M,N),E!==null?E.sibling:null);Rn(mi,mi.current&1);break;case 19:if(H=(N&M.childLanes)!==0,E.flags&128){if(H)return Iu(E,M,N);M.flags|=128}var J=M.memoizedState;if(J!==null&&(J.rendering=null,J.tail=null,J.lastEffect=null),Rn(mi,mi.current),H)break;return null;case 22:case 23:return M.lanes=0,Jw(E,M,N)}return oc(E,M,N)}function t2(E,M){switch(g_(M),M.tag){case 1:return Zi(M.type)&&ci(),E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 3:return Lc(),ta(Ei),ta(Ra),Op(),E=M.flags,E&65536&&!(E&128)?(M.flags=E&-65537|128,M):null;case 5:return Dp(M),null;case 13:if(ta(mi),E=M.memoizedState,E!==null&&E.dehydrated!==null){if(M.alternate===null)throw Error(d(340));Cd()}return E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 19:return ta(mi),null;case 4:return Lc(),null;case 10:return zr(M.type._context),null;case 22:case 23:return dm(),null;case 24:return null;default:return null}}var rf=!1,Rc=!1,wy=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function Xp(E,M){var N=E.ref;if(N!==null)if(typeof N=="function")try{N(null)}catch(H){Go(E,M,H)}else N.current=null}function Fd(E,M,N){try{N()}catch(H){Go(E,M,H)}}var n2=!1;function oC(E,M){for(ye(E.containerInfo),Sn=M;Sn!==null;)if(E=Sn,M=E.child,(E.subtreeFlags&1028)!==0&&M!==null)M.return=E,Sn=M;else for(;Sn!==null;){E=Sn;try{var N=E.alternate;if(E.flags&1024)switch(E.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var H=N.memoizedProps,J=N.memoizedState,ie=E.stateNode,je=ie.getSnapshotBeforeUpdate(E.elementType===E.type?H:wo(E.type,H),J);ie.__reactInternalSnapshotBeforeUpdate=je}break;case 3:Pt&&Ze(E.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(d(163))}}catch(vt){Go(E,E.return,vt)}if(M=E.sibling,M!==null){M.return=E.return,Sn=M;break}Sn=E.return}return N=n2,n2=!1,N}function Lu(E,M,N){var H=M.updateQueue;if(H=H!==null?H.lastEffect:null,H!==null){var J=H=H.next;do{if((J.tag&E)===E){var ie=J.destroy;J.destroy=void 0,ie!==void 0&&Fd(M,N,ie)}J=J.next}while(J!==H)}}function Zp(E,M){if(M=M.updateQueue,M=M!==null?M.lastEffect:null,M!==null){var N=M=M.next;do{if((N.tag&E)===E){var H=N.create;N.destroy=H()}N=N.next}while(N!==M)}}function Yp(E){var M=E.ref;if(M!==null){var N=E.stateNode;switch(E.tag){case 5:E=Re(N);break;default:E=N}typeof M=="function"?M(E):M.current=E}}function Kp(E,M,N){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Xs,M)}catch{}switch(M.tag){case 0:case 11:case 14:case 15:if(E=M.updateQueue,E!==null&&(E=E.lastEffect,E!==null)){var H=E=E.next;do{var J=H,ie=J.destroy;J=J.tag,ie!==void 0&&(J&2||J&4)&&Fd(M,N,ie),H=H.next}while(H!==E)}break;case 1:if(Xp(M,N),E=M.stateNode,typeof E.componentWillUnmount=="function")try{E.props=M.memoizedProps,E.state=M.memoizedState,E.componentWillUnmount()}catch(je){Go(M,N,je)}break;case 5:Xp(M,N);break;case 4:Pt?O_(E,M,N):Pe&&Pe&&(M=M.stateNode.containerInfo,N=Me(M),et(M,N))}}function kc(E,M,N){for(var H=M;;)if(Kp(E,H,N),H.child===null||Pt&&H.tag===4){if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return}H.sibling.return=H.return,H=H.sibling}else H.child.return=H,H=H.child}function Sy(E){var M=E.alternate;M!==null&&(E.alternate=null,Sy(M)),E.child=null,E.deletions=null,E.sibling=null,E.tag===5&&(M=E.stateNode,M!==null&&le(M)),E.stateNode=null,E.return=null,E.dependencies=null,E.memoizedProps=null,E.memoizedState=null,E.pendingProps=null,E.stateNode=null,E.updateQueue=null}function Dc(E){return E.tag===5||E.tag===3||E.tag===4}function Ay(E){e:for(;;){for(;E.sibling===null;){if(E.return===null||Dc(E.return))return null;E=E.return}for(E.sibling.return=E.return,E=E.sibling;E.tag!==5&&E.tag!==6&&E.tag!==18;){if(E.flags&2||E.child===null||E.tag===4)continue e;E.child.return=E,E=E.child}if(!(E.flags&2))return E.stateNode}}function Jp(E){if(Pt){e:{for(var M=E.return;M!==null;){if(Dc(M))break e;M=M.return}throw Error(d(160))}var N=M;switch(N.tag){case 5:M=N.stateNode,N.flags&32&&(It(M),N.flags&=-33),N=Ay(E),ns(E,N,M);break;case 3:case 4:M=N.stateNode.containerInfo,N=Ay(E),of(E,N,M);break;default:throw Error(d(161))}}}function of(E,M,N){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?wt(N,E,M):At(N,E);else if(H!==4&&(E=E.child,E!==null))for(of(E,M,N),E=E.sibling;E!==null;)of(E,M,N),E=E.sibling}function ns(E,M,N){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?Ft(N,E,M):st(N,E);else if(H!==4&&(E=E.child,E!==null))for(ns(E,M,N),E=E.sibling;E!==null;)ns(E,M,N),E=E.sibling}function O_(E,M,N){for(var H=M,J=!1,ie,je;;){if(!J){J=H.return;e:for(;;){if(J===null)throw Error(d(160));switch(ie=J.stateNode,J.tag){case 5:je=!1;break e;case 3:ie=ie.containerInfo,je=!0;break e;case 4:ie=ie.containerInfo,je=!0;break e}J=J.return}J=!0}if(H.tag===5||H.tag===6)kc(E,H,N),je?Ge(ie,H.stateNode):Yt(ie,H.stateNode);else if(H.tag===18)je?Ot(ie,H.stateNode):Tt(ie,H.stateNode);else if(H.tag===4){if(H.child!==null){ie=H.stateNode.containerInfo,je=!0,H.child.return=H,H=H.child;continue}}else if(Kp(E,H,N),H.child!==null){H.child.return=H,H=H.child;continue}if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return,H.tag===4&&(J=!1)}H.sibling.return=H.return,H=H.sibling}}function Ey(E,M){if(Pt){switch(M.tag){case 0:case 11:case 14:case 15:Lu(3,M,M.return),Zp(3,M),Lu(5,M,M.return);return;case 1:return;case 5:var N=M.stateNode;if(N!=null){var H=M.memoizedProps;E=E!==null?E.memoizedProps:H;var J=M.type,ie=M.updateQueue;M.updateQueue=null,ie!==null&&$t(N,ie,J,E,H,M)}return;case 6:if(M.stateNode===null)throw Error(d(162));N=M.memoizedProps,Ut(M.stateNode,E!==null?E.memoizedProps:N,N);return;case 3:ft&&E!==null&&E.memoizedState.isDehydrated&&_t(M.stateNode.containerInfo);return;case 12:return;case 13:Qp(M);return;case 19:Qp(M);return;case 17:return}throw Error(d(163))}switch(M.tag){case 0:case 11:case 14:case 15:Lu(3,M,M.return),Zp(3,M),Lu(5,M,M.return);return;case 12:return;case 13:Qp(M);return;case 19:Qp(M);return;case 3:ft&&E!==null&&E.memoizedState.isDehydrated&&_t(M.stateNode.containerInfo);break;case 22:case 23:return}e:if(Pe){switch(M.tag){case 1:case 5:case 6:break e;case 3:case 4:M=M.stateNode,et(M.containerInfo,M.pendingChildren);break e}throw Error(d(163))}}function Qp(E){var M=E.updateQueue;if(M!==null){E.updateQueue=null;var N=E.stateNode;N===null&&(N=E.stateNode=new wy),M.forEach(function(H){var J=s2.bind(null,E,H);N.has(H)||(N.add(H),H.then(J,J))})}}function Nd(E,M){for(Sn=M;Sn!==null;){M=Sn;var N=M.deletions;if(N!==null)for(var H=0;H<N.length;H++){var J=N[H];try{var ie=E;Pt?O_(ie,J,M):kc(ie,J,M);var je=J.alternate;je!==null&&(je.return=null),J.return=null}catch(Dn){Go(J,M,Dn)}}if(N=M.child,M.subtreeFlags&12854&&N!==null)N.return=M,Sn=N;else for(;Sn!==null;){M=Sn;try{var vt=M.flags;if(vt&32&&Pt&&It(M.stateNode),vt&512){var jt=M.alternate;if(jt!==null){var dn=jt.ref;dn!==null&&(typeof dn=="function"?dn(null):dn.current=null)}}if(vt&8192)switch(M.tag){case 13:if(M.memoizedState!==null){var Mn=M.alternate;(Mn===null||Mn.memoizedState===null)&&(ky=ai())}break;case 22:var va=M.memoizedState!==null,Jn=M.alternate,yi=Jn!==null&&Jn.memoizedState!==null;if(N=M,Pt){e:if(H=N,J=va,ie=null,Pt)for(var Vn=H;;){if(Vn.tag===5){if(ie===null){ie=Vn;var po=Vn.stateNode;J?qt(po):fn(Vn.stateNode,Vn.memoizedProps)}}else if(Vn.tag===6){if(ie===null){var Jr=Vn.stateNode;J?Dt(Jr):_e(Jr,Vn.memoizedProps)}}else if((Vn.tag!==22&&Vn.tag!==23||Vn.memoizedState===null||Vn===H)&&Vn.child!==null){Vn.child.return=Vn,Vn=Vn.child;continue}if(Vn===H)break;for(;Vn.sibling===null;){if(Vn.return===null||Vn.return===H)break e;ie===Vn&&(ie=null),Vn=Vn.return}ie===Vn&&(ie=null),Vn.sibling.return=Vn.return,Vn=Vn.sibling}}if(va&&!yi&&N.mode&1){Sn=N;for(var Nt=N.child;Nt!==null;){for(N=Sn=Nt;Sn!==null;){H=Sn;var xt=H.child;switch(H.tag){case 0:case 11:case 14:case 15:Lu(4,H,H.return);break;case 1:Xp(H,H.return);var Wt=H.stateNode;if(typeof Wt.componentWillUnmount=="function"){var An=H.return;try{Wt.props=H.memoizedProps,Wt.state=H.memoizedState,Wt.componentWillUnmount()}catch(Dn){Go(H,An,Dn)}}break;case 5:Xp(H,H.return);break;case 22:if(H.memoizedState!==null){tm(N);continue}}xt!==null?(xt.return=H,Sn=xt):tm(N)}Nt=Nt.sibling}}}switch(vt&4102){case 2:Jp(M),M.flags&=-3;break;case 6:Jp(M),M.flags&=-3,Ey(M.alternate,M);break;case 4096:M.flags&=-4097;break;case 4100:M.flags&=-4097,Ey(M.alternate,M);break;case 4:Ey(M.alternate,M)}}catch(Dn){Go(M,M.return,Dn)}if(N=M.sibling,N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}}function a2(E,M,N){Sn=E,em(E)}function em(E,M,N){for(var H=(E.mode&1)!==0;Sn!==null;){var J=Sn,ie=J.child;if(J.tag===22&&H){var je=J.memoizedState!==null||rf;if(!je){var vt=J.alternate,jt=vt!==null&&vt.memoizedState!==null||Rc;vt=rf;var dn=Rc;if(rf=je,(Rc=jt)&&!dn)for(Sn=J;Sn!==null;)je=Sn,jt=je.child,je.tag===22&&je.memoizedState!==null?z_(J):jt!==null?(jt.return=je,Sn=jt):z_(J);for(;ie!==null;)Sn=ie,em(ie),ie=ie.sibling;Sn=J,rf=vt,Rc=dn}My(E)}else J.subtreeFlags&8772&&ie!==null?(ie.return=J,Sn=ie):My(E)}}function My(E){for(;Sn!==null;){var M=Sn;if(M.flags&8772){var N=M.alternate;try{if(M.flags&8772)switch(M.tag){case 0:case 11:case 15:Rc||Zp(5,M);break;case 1:var H=M.stateNode;if(M.flags&4&&!Rc)if(N===null)H.componentDidMount();else{var J=M.elementType===M.type?N.memoizedProps:wo(M.type,N.memoizedProps);H.componentDidUpdate(J,N.memoizedState,H.__reactInternalSnapshotBeforeUpdate)}var ie=M.updateQueue;ie!==null&&Sr(M,ie,H);break;case 3:var je=M.updateQueue;if(je!==null){if(N=null,M.child!==null)switch(M.child.tag){case 5:N=Re(M.child.stateNode);break;case 1:N=M.child.stateNode}Sr(M,je,N)}break;case 5:var vt=M.stateNode;N===null&&M.flags&4&&Vt(vt,M.type,M.memoizedProps,M);break;case 6:break;case 4:break;case 12:break;case 13:if(ft&&M.memoizedState===null){var jt=M.alternate;if(jt!==null){var dn=jt.memoizedState;if(dn!==null){var Mn=dn.dehydrated;Mn!==null&&kt(Mn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(d(163))}Rc||M.flags&512&&Yp(M)}catch(va){Go(M,M.return,va)}}if(M===E){Sn=null;break}if(N=M.sibling,N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}function tm(E){for(;Sn!==null;){var M=Sn;if(M===E){Sn=null;break}var N=M.sibling;if(N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}function z_(E){for(;Sn!==null;){var M=Sn;try{switch(M.tag){case 0:case 11:case 15:var N=M.return;try{Zp(4,M)}catch(jt){Go(M,N,jt)}break;case 1:var H=M.stateNode;if(typeof H.componentDidMount=="function"){var J=M.return;try{H.componentDidMount()}catch(jt){Go(M,J,jt)}}var ie=M.return;try{Yp(M)}catch(jt){Go(M,ie,jt)}break;case 5:var je=M.return;try{Yp(M)}catch(jt){Go(M,je,jt)}}}catch(jt){Go(M,M.return,jt)}if(M===E){Sn=null;break}var vt=M.sibling;if(vt!==null){vt.return=M.return,Sn=vt;break}Sn=M.return}}var nm=0,Oc=1,Ty=2,Cy=3,am=4;if(typeof Symbol=="function"&&Symbol.for){var Ru=Symbol.for;nm=Ru("selector.component"),Oc=Ru("selector.has_pseudo_class"),Ty=Ru("selector.role"),Cy=Ru("selector.test_id"),am=Ru("selector.text")}function im(E){var M=gt(E);if(M!=null){if(typeof M.memoizedProps["data-testname"]!="string")throw Error(d(364));return M}if(E=De(E),E===null)throw Error(d(362));return E.stateNode.current}function Py(E,M){switch(M.$$typeof){case nm:if(E.type===M.value)return!0;break;case Oc:e:{M=M.value,E=[E,0];for(var N=0;N<E.length;){var H=E[N++],J=E[N++],ie=M[J];if(H.tag!==5||!te(H)){for(;ie!=null&&Py(H,ie);)J++,ie=M[J];if(J===M.length){M=!0;break e}else for(H=H.child;H!==null;)E.push(H,J),H=H.sibling}}M=!1}return M;case Ty:if(E.tag===5&&Oe(E.stateNode,M.value))return!0;break;case am:if((E.tag===5||E.tag===6)&&(E=ce(E),E!==null&&0<=E.indexOf(M.value)))return!0;break;case Cy:if(E.tag===5&&(E=E.memoizedProps["data-testname"],typeof E=="string"&&E.toLowerCase()===M.value.toLowerCase()))return!0;break;default:throw Error(d(365))}return!1}function Iy(E){switch(E.$$typeof){case nm:return"<"+(X(E.value)||"Unknown")+">";case Oc:return":has("+(Iy(E)||"")+")";case Ty:return'[role="'+E.value+'"]';case am:return'"'+E.value+'"';case Cy:return'[data-testname="'+E.value+'"]';default:throw Error(d(365))}}function rm(E,M){var N=[];E=[E,0];for(var H=0;H<E.length;){var J=E[H++],ie=E[H++],je=M[ie];if(J.tag!==5||!te(J)){for(;je!=null&&Py(J,je);)ie++,je=M[ie];if(ie===M.length)N.push(J);else for(J=J.child;J!==null;)E.push(J,ie),J=J.sibling}}return N}function om(E,M){if(!$e)throw Error(d(363));E=im(E),E=rm(E,M),M=[],E=Array.from(E);for(var N=0;N<E.length;){var H=E[N++];if(H.tag===5)te(H)||M.push(H.stateNode);else for(H=H.child;H!==null;)E.push(H),H=H.sibling}return M}var i2=Math.ceil,sm=f.ReactCurrentDispatcher,Ly=f.ReactCurrentOwner,hr=f.ReactCurrentBatchConfig,Da=0,Gi=null,Er=null,ho=0,Ts=0,Bd=Xi(0),Fr=0,sf=null,Ud=0,lm=0,Ry=0,nr=null,as=null,ky=0,ku=1/0;function lf(){ku=ai()+500}var Dy=!1,F_=null,Du=null,Oy=!1,Ou=null,cf=0,cm=0,N_=null,zy=-1,is=0;function fo(){return Da&6?ai():zy!==-1?zy:zy=ai()}function zu(E){return E.mode&1?Da&2&&ho!==0?ho&-ho:ui.transition!==null?(is===0&&(E=Jl,Jl<<=1,!(Jl&4194240)&&(Jl=64),is=E),is):(E=Bn,E!==0?E:Be()):1}function Yr(E,M,N){if(50<cm)throw cm=0,N_=null,Error(d(185));var H=Cs(E,M);return H===null?null:($s(H,M,N),(!(Da&2)||H!==Gi)&&(H===Gi&&(!(Da&2)&&(lm|=M),Fr===4&&Ps(H,ho)),Kr(H,N),M===1&&Da===0&&!(E.mode&1)&&(lf(),na&&Li())),H)}function Cs(E,M){E.lanes|=M;var N=E.alternate;for(N!==null&&(N.lanes|=M),N=E,E=E.return;E!==null;)E.childLanes|=M,N=E.alternate,N!==null&&(N.childLanes|=M),N=E,E=E.return;return N.tag===3?N.stateNode:null}function Kr(E,M){var N=E.callbackNode;Gh(E,M);var H=El(E,E===Gi?ho:0);if(H===0)N!==null&&qs(N),E.callbackNode=null,E.callbackPriority=0;else if(M=H&-H,E.callbackPriority!==M){if(N!=null&&qs(N),M===1)E.tag===0?Pc(Wd.bind(null,E)):Cc(Wd.bind(null,E)),oe?ve(function(){Da===0&&Li()}):sn(Sd,Li),N=null;else{switch(tt(H)){case 1:N=Sd;break;case 4:N=Es;break;case 16:N=xo;break;case 536870912:N=Lp;break;default:N=xo}N=ii(N,um.bind(null,E))}E.callbackPriority=M,E.callbackNode=N}}function um(E,M){if(zy=-1,is=0,Da&6)throw Error(d(327));var N=E.callbackNode;if(Nr()&&E.callbackNode!==N)return null;var H=El(E,E===Gi?ho:0);if(H===0)return null;if(H&30||H&E.expiredLanes||M)M=hm(E,H);else{M=H;var J=Da;Da|=2;var ie=Ny();(Gi!==E||ho!==M)&&(lf(),Vd(E,M));do try{lC();break}catch(vt){o2(E,vt)}while(1);_u(),sm.current=ie,Da=J,Er!==null?M=0:(Gi=null,ho=0,M=Fr)}if(M!==0){if(M===2&&(J=Ql(E),J!==0&&(H=J,M=un(E,J))),M===1)throw N=sf,Vd(E,0),Ps(E,H),Kr(E,ai()),N;if(M===6)Ps(E,H);else{if(J=E.current.alternate,!(H&30)&&!r2(J)&&(M=hm(E,H),M===2&&(ie=Ql(E),ie!==0&&(H=ie,M=un(E,ie))),M===1))throw N=sf,Vd(E,0),Ps(E,H),Kr(E,ai()),N;switch(E.finishedWork=J,E.finishedLanes=H,M){case 0:case 1:throw Error(d(345));case 2:zc(E,as);break;case 3:if(Ps(E,H),(H&130023424)===H&&(M=ky+500-ai(),10<M)){if(El(E,0)!==0)break;if(J=E.suspendedLanes,(J&H)!==H){fo(),E.pingedLanes|=E.suspendedLanes&J;break}E.timeoutHandle=ht(zc.bind(null,E,as),M);break}zc(E,as);break;case 4:if(Ps(E,H),(H&4194240)===H)break;for(M=E.eventTimes,J=-1;0<H;){var je=31-xr(H);ie=1<<je,je=M[je],je>J&&(J=je),H&=~ie}if(H=J,H=ai()-H,H=(120>H?120:480>H?480:1080>H?1080:1920>H?1920:3e3>H?3e3:4320>H?4320:1960*i2(H/1960))-H,10<H){E.timeoutHandle=ht(zc.bind(null,E,as),H);break}zc(E,as);break;case 5:zc(E,as);break;default:throw Error(d(329))}}}return Kr(E,ai()),E.callbackNode===N?um.bind(null,E):null}function un(E,M){var N=nr;return E.current.memoizedState.isDehydrated&&(Vd(E,M).flags|=256),E=hm(E,M),E!==2&&(M=as,as=N,M!==null&&Fy(M)),E}function Fy(E){as===null?as=E:as.push.apply(as,E)}function r2(E){for(var M=E;;){if(M.flags&16384){var N=M.updateQueue;if(N!==null&&(N=N.stores,N!==null))for(var H=0;H<N.length;H++){var J=N[H],ie=J.getSnapshot;J=J.value;try{if(!Yi(ie(),J))return!1}catch{return!1}}}if(N=M.child,M.subtreeFlags&16384&&N!==null)N.return=M,M=N;else{if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return!0;M=M.return}M.sibling.return=M.return,M=M.sibling}}return!0}function Ps(E,M){for(M&=~Ry,M&=~lm,E.suspendedLanes|=M,E.pingedLanes&=~M,E=E.expirationTimes;0<M;){var N=31-xr(M),H=1<<N;E[N]=-1,M&=~H}}function Wd(E){if(Da&6)throw Error(d(327));Nr();var M=El(E,0);if(!(M&1))return Kr(E,ai()),null;var N=hm(E,M);if(E.tag!==0&&N===2){var H=Ql(E);H!==0&&(M=H,N=un(E,H))}if(N===1)throw N=sf,Vd(E,0),Ps(E,M),Kr(E,ai()),N;if(N===6)throw Error(d(345));return E.finishedWork=E.current.alternate,E.finishedLanes=M,zc(E,as),Kr(E,ai()),null}function pn(E){Ou!==null&&Ou.tag===0&&!(Da&6)&&Nr();var M=Da;Da|=1;var N=hr.transition,H=Bn;try{if(hr.transition=null,Bn=1,E)return E()}finally{Bn=H,hr.transition=N,Da=M,!(Da&6)&&Li()}}function dm(){Ts=Bd.current,ta(Bd)}function Vd(E,M){E.finishedWork=null,E.finishedLanes=0;var N=E.timeoutHandle;if(N!==Rt&&(E.timeoutHandle=Rt,Lt(N)),Er!==null)for(N=Er.return;N!==null;){var H=N;switch(g_(H),H.tag){case 1:H=H.type.childContextTypes,H!=null&&ci();break;case 3:Lc(),ta(Ei),ta(Ra),Op();break;case 5:Dp(H);break;case 4:Lc();break;case 13:ta(mi);break;case 19:ta(mi);break;case 10:zr(H.type._context);break;case 22:case 23:dm()}N=N.return}if(Gi=E,Er=E=Nc(E.current,null),ho=Ts=M,Fr=0,sf=null,Ry=lm=Ud=0,as=nr=null,Vo!==null){for(M=0;M<Vo.length;M++)if(N=Vo[M],H=N.interleaved,H!==null){N.interleaved=null;var J=H.next,ie=N.pending;if(ie!==null){var je=ie.next;ie.next=J,H.next=je}N.pending=H}Vo=null}return E}function o2(E,M){do{var N=Er;try{if(_u(),ty.current=uy,ny){for(var H=Ki.memoizedState;H!==null;){var J=H.queue;J!==null&&(J.pending=null),H=H.next}ny=!1}if(Ld=0,uo=Ro=Ki=null,zp=!1,Yh=0,Ly.current=null,N===null||N.return===null){Fr=1,sf=M,Er=null;break}e:{var ie=E,je=N.return,vt=N,jt=M;if(M=ho,vt.flags|=32768,jt!==null&&typeof jt=="object"&&typeof jt.then=="function"){var dn=jt,Mn=vt,va=Mn.tag;if(!(Mn.mode&1)&&(va===0||va===11||va===15)){var Jn=Mn.alternate;Jn?(Mn.updateQueue=Jn.updateQueue,Mn.memoizedState=Jn.memoizedState,Mn.lanes=Jn.lanes):(Mn.updateQueue=null,Mn.memoizedState=null)}var yi=L_(je);if(yi!==null){yi.flags&=-257,fy(yi,je,vt,ie,M),yi.mode&1&&hy(ie,dn,M),M=yi,jt=dn;var Vn=M.updateQueue;if(Vn===null){var po=new Set;po.add(jt),M.updateQueue=po}else Vn.add(jt);break e}else{if(!(M&1)){hy(ie,dn,M),By();break e}jt=Error(d(426))}}else if(Ri&&vt.mode&1){var Jr=L_(je);if(Jr!==null){!(Jr.flags&65536)&&(Jr.flags|=256),fy(Jr,je,vt,ie,M),Jg(jt);break e}}ie=jt,Fr!==4&&(Fr=2),nr===null?nr=[ie]:nr.push(ie),jt=tf(jt,vt),vt=je;do{switch(vt.tag){case 3:vt.flags|=65536,M&=-M,vt.lanes|=M;var Nt=dy(vt,jt,M);qg(vt,Nt);break e;case 1:ie=jt;var xt=vt.type,Wt=vt.stateNode;if(!(vt.flags&128)&&(typeof xt.getDerivedStateFromError=="function"||Wt!==null&&typeof Wt.componentDidCatch=="function"&&(Du===null||!Du.has(Wt)))){vt.flags|=65536,M&=-M,vt.lanes|=M;var An=I_(vt,ie,M);qg(vt,An);break e}}vt=vt.return}while(vt!==null)}Wy(N)}catch(Dn){M=Dn,Er===N&&N!==null&&(Er=N=N.return);continue}break}while(1)}function Ny(){var E=sm.current;return sm.current=uy,E===null?uy:E}function By(){(Fr===0||Fr===3||Fr===2)&&(Fr=4),Gi===null||!(Ud&268435455)&&!(lm&268435455)||Ps(Gi,ho)}function hm(E,M){var N=Da;Da|=2;var H=Ny();Gi===E&&ho===M||Vd(E,M);do try{sC();break}catch(J){o2(E,J)}while(1);if(_u(),Da=N,sm.current=H,Er!==null)throw Error(d(261));return Gi=null,ho=0,Fr}function sC(){for(;Er!==null;)Uy(Er)}function lC(){for(;Er!==null&&!As();)Uy(Er)}function Uy(E){var M=Is(E.alternate,E,Ts);E.memoizedProps=E.pendingProps,M===null?Wy(E):Er=M,Ly.current=null}function Wy(E){var M=E;do{var N=M.alternate;if(E=M.return,M.flags&32768){if(N=t2(N,M),N!==null){N.flags&=32767,Er=N;return}if(E!==null)E.flags|=32768,E.subtreeFlags=0,E.deletions=null;else{Fr=6,Er=null;return}}else if(N=gy(N,M,Ts),N!==null){Er=N;return}if(M=M.sibling,M!==null){Er=M;return}Er=M=E}while(M!==null);Fr===0&&(Fr=5)}function zc(E,M){var N=Bn,H=hr.transition;try{hr.transition=null,Bn=1,B_(E,M,N)}finally{hr.transition=H,Bn=N}return null}function B_(E,M,N){do Nr();while(Ou!==null);if(Da&6)throw Error(d(327));var H=E.finishedWork,J=E.finishedLanes;if(H===null)return null;if(E.finishedWork=null,E.finishedLanes=0,H===E.current)throw Error(d(177));E.callbackNode=null,E.callbackPriority=0;var ie=H.lanes|H.childLanes;if(Ht(E,ie),E===Gi&&(Er=Gi=null,ho=0),!(H.subtreeFlags&2064)&&!(H.flags&2064)||Oy||(Oy=!0,ii(xo,function(){return Nr(),null})),ie=(H.flags&15990)!==0,H.subtreeFlags&15990||ie){ie=hr.transition,hr.transition=null;var je=Bn;Bn=1;var vt=Da;Da|=4,Ly.current=null,oC(E,H),Nd(E,H),Ae(E.containerInfo),E.current=H,a2(H),Bi(),Da=vt,Bn=je,hr.transition=ie}else E.current=H;if(Oy&&(Oy=!1,Ou=E,cf=J),ie=E.pendingLanes,ie===0&&(Du=null),ma(H.stateNode),Kr(E,ai()),M!==null)for(N=E.onRecoverableError,H=0;H<M.length;H++)N(M[H]);if(Dy)throw Dy=!1,E=F_,F_=null,E;return cf&1&&E.tag!==0&&Nr(),ie=E.pendingLanes,ie&1?E===N_?cm++:(cm=0,N_=E):cm=0,Li(),null}function Nr(){if(Ou!==null){var E=tt(cf),M=hr.transition,N=Bn;try{if(hr.transition=null,Bn=16>E?16:E,Ou===null)var H=!1;else{if(E=Ou,Ou=null,cf=0,Da&6)throw Error(d(331));var J=Da;for(Da|=4,Sn=E.current;Sn!==null;){var ie=Sn,je=ie.child;if(Sn.flags&16){var vt=ie.deletions;if(vt!==null){for(var jt=0;jt<vt.length;jt++){var dn=vt[jt];for(Sn=dn;Sn!==null;){var Mn=Sn;switch(Mn.tag){case 0:case 11:case 15:Lu(8,Mn,ie)}var va=Mn.child;if(va!==null)va.return=Mn,Sn=va;else for(;Sn!==null;){Mn=Sn;var Jn=Mn.sibling,yi=Mn.return;if(Sy(Mn),Mn===dn){Sn=null;break}if(Jn!==null){Jn.return=yi,Sn=Jn;break}Sn=yi}}}var Vn=ie.alternate;if(Vn!==null){var po=Vn.child;if(po!==null){Vn.child=null;do{var Jr=po.sibling;po.sibling=null,po=Jr}while(po!==null)}}Sn=ie}}if(ie.subtreeFlags&2064&&je!==null)je.return=ie,Sn=je;else e:for(;Sn!==null;){if(ie=Sn,ie.flags&2048)switch(ie.tag){case 0:case 11:case 15:Lu(9,ie,ie.return)}var Nt=ie.sibling;if(Nt!==null){Nt.return=ie.return,Sn=Nt;break e}Sn=ie.return}}var xt=E.current;for(Sn=xt;Sn!==null;){je=Sn;var Wt=je.child;if(je.subtreeFlags&2064&&Wt!==null)Wt.return=je,Sn=Wt;else e:for(je=xt;Sn!==null;){if(vt=Sn,vt.flags&2048)try{switch(vt.tag){case 0:case 11:case 15:Zp(9,vt)}}catch(Dn){Go(vt,vt.return,Dn)}if(vt===je){Sn=null;break e}var An=vt.sibling;if(An!==null){An.return=vt.return,Sn=An;break e}Sn=vt.return}}if(Da=J,Li(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Xs,E)}catch{}H=!0}return H}finally{Bn=N,hr.transition=M}}return!1}function Fc(E,M,N){M=tf(N,M),M=dy(E,M,1),Ti(E,M),M=fo(),E=Cs(E,1),E!==null&&($s(E,1,M),Kr(E,M))}function Go(E,M,N){if(E.tag===3)Fc(E,E,N);else for(;M!==null;){if(M.tag===3){Fc(M,E,N);break}else if(M.tag===1){var H=M.stateNode;if(typeof M.type.getDerivedStateFromError=="function"||typeof H.componentDidCatch=="function"&&(Du===null||!Du.has(H))){E=tf(N,E),E=I_(M,E,1),Ti(M,E),E=fo(),M=Cs(M,1),M!==null&&($s(M,1,E),Kr(M,E));break}}M=M.return}}function U_(E,M,N){var H=E.pingCache;H!==null&&H.delete(M),M=fo(),E.pingedLanes|=E.suspendedLanes&N,Gi===E&&(ho&N)===N&&(Fr===4||Fr===3&&(ho&130023424)===ho&&500>ai()-ky?Vd(E,0):Ry|=N),Kr(E,M)}function Vy(E,M){M===0&&(E.mode&1?(M=Sl,Sl<<=1,!(Sl&130023424)&&(Sl=4194304)):M=1);var N=fo();E=Cs(E,M),E!==null&&($s(E,M,N),Kr(E,N))}function W_(E){var M=E.memoizedState,N=0;M!==null&&(N=M.retryLane),Vy(E,N)}function s2(E,M){var N=0;switch(E.tag){case 13:var H=E.stateNode,J=E.memoizedState;J!==null&&(N=J.retryLane);break;case 19:H=E.stateNode;break;default:throw Error(d(314))}H!==null&&H.delete(M),Vy(E,N)}var Is;Is=function(E,M,N){if(E!==null)if(E.memoizedProps!==M.pendingProps||Ei.current)ts=!0;else{if(!(E.lanes&N)&&!(M.flags&128))return ts=!1,zd(E,M,N);ts=!!(E.flags&131072)}else ts=!1,Ri&&M.flags&1048576&&$h(M,kp,M.index);switch(M.lanes=0,M.tag){case 2:var H=M.type;E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps;var J=br(M,Ra.current);xn(M,N),J=ay(null,M,H,E,J,N);var ie=Fp();return M.flags|=1,typeof J=="object"&&J!==null&&typeof J.render=="function"&&J.$$typeof===void 0?(M.tag=1,M.memoizedState=null,M.updateQueue=null,Zi(H)?(ie=!0,Yn(M)):ie=!1,M.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,Jo(M),J.updater=Ys,M.stateNode=J,J._reactInternals=M,m_(M,H,E,N),M=jp(null,M,H,!0,ie,N)):(M.tag=0,Ri&&ie&&Td(M),Do(null,M,J,N),M=M.child),M;case 16:H=M.elementType;e:{switch(E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps,J=H._init,H=J(H._payload),M.type=H,J=M.tag=l2(H),E=wo(H,E),J){case 0:M=R_(null,M,H,E,N);break e;case 1:M=e2(null,M,H,E,N);break e;case 11:M=Od(null,M,H,E,N);break e;case 14:M=Yw(null,M,H,wo(H.type,E),N);break e}throw Error(d(306,H,""))}return M;case 0:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:wo(H,J),R_(E,M,H,J,N);case 1:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:wo(H,J),e2(E,M,H,J,N);case 3:e:{if(yy(M),E===null)throw Error(d(387));H=M.pendingProps,ie=M.memoizedState,J=ie.element,p_(E,M),xu(M,H,null,N);var je=M.memoizedState;if(H=je.element,ft&&ie.isDehydrated)if(ie={element:H,isDehydrated:!1,cache:je.cache,transitions:je.transitions},M.updateQueue.baseState=ie,M.memoizedState=ie,M.flags&256){J=Error(d(423)),M=vy(E,M,H,N,J);break e}else if(H!==J){J=Error(d(424)),M=vy(E,M,H,N,J);break e}else for(ft&&(es=fa(M.stateNode.containerInfo),co=M,Ri=!0,Cl=null,Js=!1),N=__(M,null,H,N),M.child=N;N;)N.flags=N.flags&-3|4096,N=N.sibling;else{if(Cd(),H===J){M=oc(E,M,N);break e}Do(E,M,H,N)}M=M.child}return M;case 5:return nc(M),E===null&&y_(M),H=M.type,J=M.pendingProps,ie=E!==null?E.memoizedProps:null,je=J.children,Ke(H,J)?je=null:ie!==null&&Ke(H,ie)&&(M.flags|=32),Qw(E,M),Do(E,M,je,N),M.child;case 6:return E===null&&y_(M),null;case 13:return k_(E,M,N);case 4:return ey(M,M.stateNode.containerInfo),H=M.pendingProps,E===null?M.child=Au(M,null,H,N):Do(E,M,H,N),M.child;case 11:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:wo(H,J),Od(E,M,H,J,N);case 7:return Do(E,M,M.pendingProps,N),M.child;case 8:return Do(E,M,M.pendingProps.children,N),M.child;case 12:return Do(E,M,M.pendingProps.children,N),M.child;case 10:e:{if(H=M.type._context,J=M.pendingProps,ie=M.memoizedProps,je=J.value,Ed(M,H,je),ie!==null)if(Yi(ie.value,je)){if(ie.children===J.children&&!Ei.current){M=oc(E,M,N);break e}}else for(ie=M.child,ie!==null&&(ie.return=M);ie!==null;){var vt=ie.dependencies;if(vt!==null){je=ie.child;for(var jt=vt.firstContext;jt!==null;){if(jt.context===H){if(ie.tag===1){jt=Qo(-1,N&-N),jt.tag=2;var dn=ie.updateQueue;if(dn!==null){dn=dn.shared;var Mn=dn.pending;Mn===null?jt.next=jt:(jt.next=Mn.next,Mn.next=jt),dn.pending=jt}}ie.lanes|=N,jt=ie.alternate,jt!==null&&(jt.lanes|=N),Mi(ie.return,N,M),vt.lanes|=N;break}jt=jt.next}}else if(ie.tag===10)je=ie.type===M.type?null:ie.child;else if(ie.tag===18){if(je=ie.return,je===null)throw Error(d(341));je.lanes|=N,vt=je.alternate,vt!==null&&(vt.lanes|=N),Mi(je,N,M),je=ie.sibling}else je=ie.child;if(je!==null)je.return=ie;else for(je=ie;je!==null;){if(je===M){je=null;break}if(ie=je.sibling,ie!==null){ie.return=je.return,je=ie;break}je=je.return}ie=je}Do(E,M,J.children,N),M=M.child}return M;case 9:return J=M.type,H=M.pendingProps.children,xn(M,N),J=tr(J),H=H(J),M.flags|=1,Do(E,M,H,N),M.child;case 14:return H=M.type,J=wo(H,M.pendingProps),J=wo(H.type,J),Yw(E,M,H,J,N);case 15:return Kw(E,M,M.type,M.pendingProps,N);case 17:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:wo(H,J),E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),M.tag=1,Zi(H)?(E=!0,Yn(M)):E=!1,xn(M,N),jh(M,H,J),m_(M,H,J,N),jp(null,M,H,!0,E,N);case 19:return Iu(E,M,N);case 22:return Jw(E,M,N)}throw Error(d(156,M.tag))};function ii(E,M){return sn(E,M)}function Gy(E,M,N,H){this.tag=E,this.key=N,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=M,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=H,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rs(E,M,N,H){return new Gy(E,M,N,H)}function Gd(E){return E=E.prototype,!(!E||!E.isReactComponent)}function l2(E){if(typeof E=="function")return Gd(E)?1:0;if(E!=null){if(E=E.$$typeof,E===k)return 11;if(E===O)return 14}return 2}function Nc(E,M){var N=E.alternate;return N===null?(N=rs(E.tag,M,E.key,E.mode),N.elementType=E.elementType,N.type=E.type,N.stateNode=E.stateNode,N.alternate=E,E.alternate=N):(N.pendingProps=M,N.type=E.type,N.flags=0,N.subtreeFlags=0,N.deletions=null),N.flags=E.flags&14680064,N.childLanes=E.childLanes,N.lanes=E.lanes,N.child=E.child,N.memoizedProps=E.memoizedProps,N.memoizedState=E.memoizedState,N.updateQueue=E.updateQueue,M=E.dependencies,N.dependencies=M===null?null:{lanes:M.lanes,firstContext:M.firstContext},N.sibling=E.sibling,N.index=E.index,N.ref=E.ref,N}function Hy(E,M,N,H,J,ie){var je=2;if(H=E,typeof E=="function")Gd(E)&&(je=1);else if(typeof E=="string")je=5;else e:switch(E){case _:return nl(N.children,J,ie,M);case w:je=8,J|=8;break;case A:return E=rs(12,N,M,J|2),E.elementType=A,E.lanes=ie,E;case D:return E=rs(13,N,M,J),E.elementType=D,E.lanes=ie,E;case L:return E=rs(19,N,M,J),E.elementType=L,E.lanes=ie,E;case B:return Fu(N,J,ie,M);default:if(typeof E=="object"&&E!==null)switch(E.$$typeof){case C:je=10;break e;case I:je=9;break e;case k:je=11;break e;case O:je=14;break e;case F:je=16,H=null;break e}throw Error(d(130,E==null?E:typeof E,""))}return M=rs(je,N,M,J),M.elementType=E,M.type=H,M.lanes=ie,M}function nl(E,M,N,H){return E=rs(7,E,H,M),E.lanes=N,E}function Fu(E,M,N,H){return E=rs(22,E,H,M),E.elementType=B,E.lanes=N,E.stateNode={},E}function Xt(E,M,N){return E=rs(6,E,null,M),E.lanes=N,E}function yn(E,M,N){return M=rs(4,E.children!==null?E.children:[],E.key,M),M.lanes=N,M.stateNode={containerInfo:E.containerInfo,pendingChildren:null,implementation:E.implementation},M}function fm(E,M,N,H,J){this.tag=M,this.containerInfo=E,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Rt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wd(0),this.expirationTimes=wd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wd(0),this.identifierPrefix=H,this.onRecoverableError=J,ft&&(this.mutableSourceEagerHydrationData=null)}function gi(E,M,N,H,J,ie,je,vt,jt){return E=new fm(E,M,N,vt,jt),M===1?(M=1,ie===!0&&(M|=8)):M=0,ie=rs(3,null,null,M),E.current=ie,ie.stateNode=E,ie.memoizedState={element:H,isDehydrated:N,cache:null,transitions:null},Jo(ie),E}function Ho(E){if(!E)return lo;E=E._reactInternals;e:{if(V(E)!==E||E.tag!==1)throw Error(d(170));var M=E;do{switch(M.tag){case 3:M=M.stateNode.context;break e;case 1:if(Zi(M.type)){M=M.stateNode.__reactInternalMemoizedMergedChildContext;break e}}M=M.return}while(M!==null);throw Error(d(171))}if(E.tag===1){var N=E.type;if(Zi(N))return Cn(E,N,M)}return M}function jy(E){var M=E._reactInternals;if(M===void 0)throw typeof E.render=="function"?Error(d(188)):(E=Object.keys(E).join(","),Error(d(268,E)));return E=pe(M),E===null?null:E.stateNode}function V_(E,M){if(E=E.memoizedState,E!==null&&E.dehydrated!==null){var N=E.retryLane;E.retryLane=N!==0&&N<M?N:M}}function jo(E,M){V_(E,M),(E=E.alternate)&&V_(E,M)}function cC(E){return E=pe(E),E===null?null:E.stateNode}function uC(){return null}return a.attemptContinuousHydration=function(E){if(E.tag===13){var M=fo();Yr(E,134217728,M),jo(E,134217728)}},a.attemptHydrationAtCurrentPriority=function(E){if(E.tag===13){var M=fo(),N=zu(E);Yr(E,N,M),jo(E,N)}},a.attemptSynchronousHydration=function(E){switch(E.tag){case 3:var M=E.stateNode;if(M.current.memoizedState.isDehydrated){var N=Al(M.pendingLanes);N!==0&&(vn(M,N|1),Kr(M,ai()),!(Da&6)&&(lf(),Li()))}break;case 13:var H=fo();pn(function(){return Yr(E,1,H)}),jo(E,1)}},a.batchedUpdates=function(E,M){var N=Da;Da|=1;try{return E(M)}finally{Da=N,Da===0&&(lf(),na&&Li())}},a.createComponentSelector=function(E){return{$$typeof:nm,value:E}},a.createContainer=function(E,M,N,H,J,ie,je){return gi(E,M,!1,null,N,H,J,ie,je)},a.createHasPseudoClassSelector=function(E){return{$$typeof:Oc,value:E}},a.createHydrationContainer=function(E,M,N,H,J,ie,je,vt,jt){return E=gi(N,H,!0,E,J,ie,je,vt,jt),E.context=Ho(null),N=E.current,H=fo(),J=zu(N),ie=Qo(H,J),ie.callback=M??null,Ti(N,ie),E.current.lanes=J,$s(E,J,H),Kr(E,H),E},a.createPortal=function(E,M,N){var H=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:H==null?null:""+H,children:E,containerInfo:M,implementation:N}},a.createRoleSelector=function(E){return{$$typeof:Ty,value:E}},a.createTestNameSelector=function(E){return{$$typeof:Cy,value:E}},a.createTextSelector=function(E){return{$$typeof:am,value:E}},a.deferredUpdates=function(E){var M=Bn,N=hr.transition;try{return hr.transition=null,Bn=16,E()}finally{Bn=M,hr.transition=N}},a.discreteUpdates=function(E,M,N,H,J){var ie=Bn,je=hr.transition;try{return hr.transition=null,Bn=1,E(M,N,H,J)}finally{Bn=ie,hr.transition=je,Da===0&&lf()}},a.findAllNodes=om,a.findBoundingRects=function(E,M){if(!$e)throw Error(d(363));M=om(E,M),E=[];for(var N=0;N<M.length;N++)E.push(ot(M[N]));for(M=E.length-1;0<M;M--){N=E[M];for(var H=N.x,J=H+N.width,ie=N.y,je=ie+N.height,vt=M-1;0<=vt;vt--)if(M!==vt){var jt=E[vt],dn=jt.x,Mn=dn+jt.width,va=jt.y,Jn=va+jt.height;if(H>=dn&&ie>=va&&J<=Mn&&je<=Jn){E.splice(M,1);break}else if(H!==dn||N.width!==jt.width||Jn<ie||va>je){if(!(ie!==va||N.height!==jt.height||Mn<H||dn>J)){dn>H&&(jt.width+=dn-H,jt.x=H),Mn<J&&(jt.width=J-dn),E.splice(M,1);break}}else{va>ie&&(jt.height+=va-ie,jt.y=ie),Jn<je&&(jt.height=je-va),E.splice(M,1);break}}}return E},a.findHostInstance=jy,a.findHostInstanceWithNoPortals=function(E){return E=me(E),E=E!==null?fe(E):null,E===null?null:E.stateNode},a.findHostInstanceWithWarning=function(E){return jy(E)},a.flushControlled=function(E){var M=Da;Da|=1;var N=hr.transition,H=Bn;try{hr.transition=null,Bn=1,E()}finally{Bn=H,hr.transition=N,Da=M,Da===0&&(lf(),Li())}},a.flushPassiveEffects=Nr,a.flushSync=pn,a.focusWithin=function(E,M){if(!$e)throw Error(d(363));for(E=im(E),M=rm(E,M),M=Array.from(M),E=0;E<M.length;){var N=M[E++];if(!te(N)){if(N.tag===5&&pt(N.stateNode))return!0;for(N=N.child;N!==null;)M.push(N),N=N.sibling}}return!1},a.getCurrentUpdatePriority=function(){return Bn},a.getFindAllNodesFailureDescription=function(E,M){if(!$e)throw Error(d(363));var N=0,H=[];E=[im(E),0];for(var J=0;J<E.length;){var ie=E[J++],je=E[J++],vt=M[je];if((ie.tag!==5||!te(ie))&&(Py(ie,vt)&&(H.push(Iy(vt)),je++,je>N&&(N=je)),je<M.length))for(ie=ie.child;ie!==null;)E.push(ie,je),ie=ie.sibling}if(N<M.length){for(E=[];N<M.length;N++)E.push(Iy(M[N]));return`findAllNodes was able to match part of the selector:
  `+(H.join(" > ")+`

No matching component was found for:
  `)+E.join(" > ")}return null},a.getPublicRootInstance=function(E){if(E=E.current,!E.child)return null;switch(E.child.tag){case 5:return Re(E.child.stateNode);default:return E.child.stateNode}},a.injectIntoDevTools=function(E){if(E={bundleType:E.bundleType,version:E.version,rendererPackageName:E.rendererPackageName,rendererConfig:E.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:f.ReactCurrentDispatcher,findHostInstanceByFiber:cC,findFiberByHostInstance:E.findFiberByHostInstance||uC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")E=!1;else{var M=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(M.isDisabled||!M.supportsFiber)E=!0;else{try{Xs=M.inject(E),tn=M}catch{}E=!!M.checkDCE}}return E},a.isAlreadyRendering=function(){return!1},a.observeVisibleRects=function(E,M,N,H){if(!$e)throw Error(d(363));E=om(E,M);var J=it(E,N,H).disconnect;return{disconnect:function(){J()}}},a.registerMutableSourceForHydration=function(E,M){var N=M._getVersion;N=N(M._source),E.mutableSourceEagerHydrationData==null?E.mutableSourceEagerHydrationData=[M,N]:E.mutableSourceEagerHydrationData.push(M,N)},a.runWithPriority=function(E,M){var N=Bn;try{return Bn=E,M()}finally{Bn=N}},a.shouldError=function(){return null},a.shouldSuspend=function(){return!1},a.updateContainer=function(E,M,N,H){var J=M.current,ie=fo(),je=zu(J);return N=Ho(N),M.context===null?M.context=N:M.pendingContext=N,M=Qo(ie,je),M.payload={element:E},H=H===void 0?null:H,H!==null&&(M.callback=H),Ti(J,M),E=Yr(J,je,ie),E!==null&&bu(E,J,je),je},a};zY.exports=c3e;var u3e=zY.exports;const d3e=uw(u3e);var FY={exports:{}},NY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ue,ye){var Ae=ue.length;ue.push(ye);e:for(;0<Ae;){var ne=Ae-1>>>1,Ee=ue[ne];if(0<s(Ee,ye))ue[ne]=ye,ue[Ae]=Ee,Ae=ne;else break e}}function a(ue){return ue.length===0?null:ue[0]}function o(ue){if(ue.length===0)return null;var ye=ue[0],Ae=ue.pop();if(Ae!==ye){ue[0]=Ae;e:for(var ne=0,Ee=ue.length,Ye=Ee>>>1;ne<Ye;){var Xe=2*(ne+1)-1,Ke=ue[Xe],Ue=Xe+1,ht=ue[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ht,Ke)?(ue[ne]=ht,ue[Ue]=Ae,ne=Ue):(ue[ne]=Ke,ue[Xe]=Ae,ne=Xe);else if(Ue<Ee&&0>s(ht,Ae))ue[ne]=ht,ue[Ue]=Ae,ne=Ue;else break e}}return ye}function s(ue,ye){var Ae=ue.sortIndex-ye.sortIndex;return Ae!==0?Ae:ue.id-ye.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,w=null,A=3,C=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(ue){for(var ye=a(y);ye!==null;){if(ye.callback===null)o(y);else if(ye.startTime<=ue)o(y),ye.sortIndex=ye.expirationTime,e(m,ye);else break;ye=a(y)}}function B(ue){if(k=!1,F(ue),!I)if(a(m)!==null)I=!0,Re(G);else{var ye=a(y);ye!==null&&He(B,ye.startTime-ue)}}function G(ue,ye){I=!1,k&&(k=!1,L(ee),ee=-1),C=!0;var Ae=A;try{for(F(ye),w=a(m);w!==null&&(!(w.expirationTime>ye)||ue&&!me());){var ne=w.callback;if(typeof ne=="function"){w.callback=null,A=w.priorityLevel;var Ee=ne(w.expirationTime<=ye);ye=n.unstable_now(),typeof Ee=="function"?w.callback=Ee:w===a(m)&&o(m),F(ye)}else o(m);w=a(m)}if(w!==null)var Ye=!0;else{var Xe=a(y);Xe!==null&&He(B,Xe.startTime-ye),Ye=!1}return Ye}finally{w=null,A=Ae,C=!1}}var q=!1,X=null,ee=-1,V=5,Q=-1;function me(){return!(n.unstable_now()-Q<V)}function pe(){if(X!==null){var ue=n.unstable_now();Q=ue;var ye=!0;try{ye=X(!0,ue)}finally{ye?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=pe,be=function(){Ce.postMessage(null)}}else be=function(){D(pe,0)};function Re(ue){X=ue,q||(q=!0,be())}function He(ue,ye){ee=D(function(){ue(n.unstable_now())},ye)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ue){ue.callback=null},n.unstable_continueExecution=function(){I||C||(I=!0,Re(G))},n.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ue?Math.floor(1e3/ue):5},n.unstable_getCurrentPriorityLevel=function(){return A},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(ue){switch(A){case 1:case 2:case 3:var ye=3;break;default:ye=A}var Ae=A;A=ye;try{return ue()}finally{A=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ue,ye){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var Ae=A;A=ue;try{return ye()}finally{A=Ae}},n.unstable_scheduleCallback=function(ue,ye,Ae){var ne=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ne+Ae:ne):Ae=ne,ue){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,ue={id:_++,callback:ye,priorityLevel:ue,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ne?(ue.sortIndex=Ae,e(y,ue),a(m)===null&&ue===a(y)&&(k?(L(ee),ee=-1):k=!0,He(B,Ae-ne))):(ue.sortIndex=Ee,e(m,ue),I||C||(I=!0,Re(G))),ue},n.unstable_shouldYield=me,n.unstable_wrapCallback=function(ue){var ye=A;return function(){var Ae=A;A=ye;try{return ue.apply(this,arguments)}finally{A=Ae}}}})(NY);FY.exports=NY;var bV=FY.exports;const h3e=n=>typeof n=="object"&&typeof n.then=="function",fg=[];function BY(n,e,a=(o,s)=>o===s){if(n===e)return!0;if(!n||!e)return!1;const o=n.length;if(e.length!==o)return!1;for(let s=0;s<o;s++)if(!a(n[s],e[s]))return!1;return!0}function UY(n,e=null,a=!1,o={}){e===null&&(e=[n]);for(const c of fg)if(BY(e,c.keys,c.equal)){if(a)return;if(Object.prototype.hasOwnProperty.call(c,"error"))throw c.error;if(Object.prototype.hasOwnProperty.call(c,"response"))return o.lifespan&&o.lifespan>0&&(c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(c.remove,o.lifespan)),c.response;if(!a)throw c.promise}const s={keys:e,equal:o.equal,remove:()=>{const c=fg.indexOf(s);c!==-1&&fg.splice(c,1)},promise:(h3e(n)?n:n(...e)).then(c=>{s.response=c,o.lifespan&&o.lifespan>0&&(s.timeout=setTimeout(s.remove,o.lifespan))}).catch(c=>s.error=c)};if(fg.push(s),!a)throw s.promise}const WY=(n,e,a)=>UY(n,e,!1,a),f3e=(n,e,a)=>void UY(n,e,!0,a),p3e=n=>{if(n===void 0||n.length===0)fg.splice(0,fg.length);else{const e=fg.find(a=>BY(n,a.keys,a.equal));e&&e.remove()}},p6={},m3e=n=>void Object.assign(p6,n);function g3e(n,e){function a(_,{args:w=[],attach:A,...C},I){let k=`${_[0].toUpperCase()}${_.slice(1)}`,D;if(_==="primitive"){if(C.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const L=C.object;D=t0(L,{type:_,root:I,attach:A,primitive:!0})}else{const L=p6[k];if(!L)throw new Error(`R3F: ${k} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(w))throw new Error("R3F: The args prop must be an array!");D=t0(new L(...w),{type:_,root:I,attach:A,memoizedProps:{args:w}})}return D.__r3f.attach===void 0&&(D instanceof La?D.__r3f.attach="geometry":D instanceof Ko&&(D.__r3f.attach="material")),k!=="inject"&&H4(D,C),D}function o(_,w){let A=!1;if(w){var C,I;(C=w.__r3f)!=null&&C.attach?G4(_,w,w.__r3f.attach):w.isObject3D&&_.isObject3D&&(_.add(w),A=!0),A||(I=_.__r3f)==null||I.objects.push(w),w.__r3f||t0(w,{}),w.__r3f.parent=_,xR(w),n0(w)}}function s(_,w,A){let C=!1;if(w){var I,k;if((I=w.__r3f)!=null&&I.attach)G4(_,w,w.__r3f.attach);else if(w.isObject3D&&_.isObject3D){w.parent=_,w.dispatchEvent({type:"added"});const D=_.children.filter(O=>O!==w),L=D.indexOf(A);_.children=[...D.slice(0,L),w,...D.slice(L)],C=!0}C||(k=_.__r3f)==null||k.objects.push(w),w.__r3f||t0(w,{}),w.__r3f.parent=_,xR(w),n0(w)}}function c(_,w,A=!1){_&&[..._].forEach(C=>d(w,C,A))}function d(_,w,A){if(w){var C,I,k;if(w.__r3f&&(w.__r3f.parent=null),(C=_.__r3f)!=null&&C.objects&&(_.__r3f.objects=_.__r3f.objects.filter(B=>B!==w)),(I=w.__r3f)!=null&&I.attach)EV(_,w,w.__r3f.attach);else if(w.isObject3D&&_.isObject3D){var D;_.remove(w),(D=w.__r3f)!=null&&D.root&&E3e(w.__r3f.root,w)}const O=(k=w.__r3f)==null?void 0:k.primitive,F=!O&&(A===void 0?w.dispose!==null:A);if(!O){var L;c((L=w.__r3f)==null?void 0:L.objects,w,F),c(w.children,w,F)}delete w.__r3f,F&&w.dispose&&w.type!=="Scene"&&bV.unstable_scheduleCallback(bV.unstable_IdlePriority,()=>{try{w.dispose()}catch{}}),n0(_)}}function f(_,w,A,C){var I;const k=(I=_.__r3f)==null?void 0:I.parent;if(!k)return;const D=a(w,A,_.__r3f.root);if(_.children){for(const L of _.children)L.__r3f&&o(D,L);_.children=_.children.filter(L=>!L.__r3f)}_.__r3f.objects.forEach(L=>o(D,L)),_.__r3f.objects=[],_.__r3f.autoRemovedBeforeAppend||d(k,_),D.parent&&(D.__r3f.autoRemovedBeforeAppend=!0),o(k,D),D.raycast&&D.__r3f.eventCount&&D.__r3f.root.getState().internal.interaction.push(D),[C,C.alternate].forEach(L=>{L!==null&&(L.stateNode=D,L.ref&&(typeof L.ref=="function"?L.ref(D):L.ref.current=D))})}const m=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:d3e({createInstance:a,removeChild:d,appendChild:o,appendInitialChild:o,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(_,w)=>{if(!w)return;const A=_.getState().scene;A.__r3f&&(A.__r3f.root=_,o(A,w))},removeChildFromContainer:(_,w)=>{w&&d(_.getState().scene,w)},insertInContainerBefore:(_,w,A)=>{if(!w||!A)return;const C=_.getState().scene;C.__r3f&&s(C,w,A)},getRootHostContext:()=>null,getChildHostContext:_=>_,finalizeInitialChildren(_){var w;return!!((w=_==null?void 0:_.__r3f)!=null?w:{}).handlers},prepareUpdate(_,w,A,C){var I;if(((I=_==null?void 0:_.__r3f)!=null?I:{}).primitive&&C.object&&C.object!==_)return[!0];{const{args:D=[],children:L,...O}=C,{args:F=[],children:B,...G}=A;if(!Array.isArray(D))throw new Error("R3F: the args prop must be an array!");if(D.some((X,ee)=>X!==F[ee]))return[!0];const q=XY(_,O,G,!0);return q.changes.length?[!1,q]:null}},commitUpdate(_,[w,A],C,I,k,D){w?f(_,C,k,D):H4(_,A)},commitMount(_,w,A,C){var I;const k=(I=_.__r3f)!=null?I:{};_.raycast&&k.handlers&&k.eventCount&&_.__r3f.root.getState().internal.interaction.push(_)},getPublicInstance:_=>_,prepareForCommit:()=>null,preparePortalMount:_=>t0(_.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(_){var w;const{attach:A,parent:C}=(w=_.__r3f)!=null?w:{};A&&C&&EV(C,_,A),_.isObject3D&&(_.visible=!1),n0(_)},unhideInstance(_,w){var A;const{attach:C,parent:I}=(A=_.__r3f)!=null?A:{};C&&I&&G4(I,_,C),(_.isObject3D&&w.visible==null||w.visible)&&(_.visible=!0),n0(_)},createTextInstance:m,hideTextInstance:m,unhideTextInstance:m,getCurrentEventPriority:()=>e?e():x0.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&rr.fun(performance.now)?performance.now:rr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:rr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:rr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:H4}}var xV,wV;const V4=n=>"colorSpace"in n||"outputColorSpace"in n,VY=()=>{var n;return(n=p6.ColorManagement)!=null?n:null},GY=n=>n&&n.isOrthographicCamera,y3e=n=>n&&n.hasOwnProperty("current"),Dw=typeof window<"u"&&((xV=window.document)!=null&&xV.createElement||((wV=window.navigator)==null?void 0:wV.product)==="ReactNative")?re.useLayoutEffect:re.useEffect;function HY(n){const e=re.useRef(n);return Dw(()=>void(e.current=n),[n]),e}function v3e({set:n}){return Dw(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class jY extends re.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}jY.getDerivedStateFromError=()=>({error:!0});const $Y="__default",SV=new Map,_3e=n=>n&&!!n.memoized&&!!n.changes;function qY(n){var e;const a=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],a),n[1]):n}const ob=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},rr={obj:n=>n===Object(n)&&!rr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:a="shallow",objects:o="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(rr.str(n)||rr.num(n))return n===e;const c=rr.obj(n);if(c&&o==="reference")return n===e;const d=rr.arr(n);if(d&&a==="reference")return n===e;if((d||c)&&n===e)return!0;let f;for(f in n)if(!(f in e))return!1;if(c&&a==="shallow"&&o==="shallow"){for(f in s?e:n)if(!rr.equ(n[f],e[f],{strict:s,objects:"reference"}))return!1}else for(f in s?e:n)if(n[f]!==e[f])return!1;if(rr.und(f)){if(d&&n.length===0&&e.length===0||c&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function b3e(n){const e={nodes:{},materials:{}};return n&&n.traverse(a=>{a.name&&(e.nodes[a.name]=a),a.material&&!e.materials[a.material.name]&&(e.materials[a.material.name]=a.material)}),e}function x3e(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function t0(n,e){const a=n;return a.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function bR(n,e){let a=n;if(e.includes("-")){const o=e.split("-"),s=o.pop();return a=o.reduce((c,d)=>c[d],n),{target:a,key:s}}else return{target:a,key:e}}const AV=/-\d+$/;function G4(n,e,a){if(rr.str(a)){if(AV.test(a)){const c=a.replace(AV,""),{target:d,key:f}=bR(n,c);Array.isArray(d[f])||(d[f]=[])}const{target:o,key:s}=bR(n,a);e.__r3f.previousAttach=o[s],o[s]=e}else e.__r3f.previousAttach=a(n,e)}function EV(n,e,a){var o,s;if(rr.str(a)){const{target:c,key:d}=bR(n,a),f=e.__r3f.previousAttach;f===void 0?delete c[d]:c[d]=f}else(o=e.__r3f)==null||o.previousAttach==null||o.previousAttach(n,e);(s=e.__r3f)==null||delete s.previousAttach}function XY(n,{children:e,key:a,ref:o,...s},{children:c,key:d,ref:f,...m}={},y=!1){var _;const w=(_=n==null?void 0:n.__r3f)!=null?_:{},A=Object.entries(s),C=[];if(y){const k=Object.keys(m);for(let D=0;D<k.length;D++)s.hasOwnProperty(k[D])||A.unshift([k[D],$Y+"remove"])}A.forEach(([k,D])=>{var L;if((L=n.__r3f)!=null&&L.primitive&&k==="object"||rr.equ(D,m[k]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(k))return C.push([k,D,!0,[]]);let O=[];k.includes("-")&&(O=k.split("-")),C.push([k,D,!1,O]);for(const F in s){const B=s[F];F.startsWith(`${k}-`)&&C.push([F,B,!1,F.split("-")])}});const I={...s};return w.memoizedProps&&w.memoizedProps.args&&(I.args=w.memoizedProps.args),w.memoizedProps&&w.memoizedProps.attach&&(I.attach=w.memoizedProps.attach),{memoized:I,changes:C}}const w3e=typeof process<"u"&&!1;function H4(n,e){var a,o,s;const c=(a=n.__r3f)!=null?a:{},d=c.root,f=(o=d==null||d.getState==null?void 0:d.getState())!=null?o:{},{memoized:m,changes:y}=_3e(e)?e:XY(n,e),_=c.eventCount;n.__r3f&&(n.__r3f.memoizedProps=m);for(let A=0;A<y.length;A++){let[C,I,k,D]=y[A];if(V4(n)){const B="srgb",G="srgb-linear";C==="encoding"?(C="colorSpace",I=I===3001?B:G):C==="outputEncoding"&&(C="outputColorSpace",I=I===3001?B:G)}let L=n,O=L[C];if(D.length&&(O=D.reduce((F,B)=>F[B],n),!(O&&O.set))){const[F,...B]=D.reverse();L=B.reverse().reduce((G,q)=>G[q],n),C=F}if(I===$Y+"remove")if(L.constructor){let F=SV.get(L.constructor);F||(F=new L.constructor,SV.set(L.constructor,F)),I=F[C]}else I=0;if(k)I?c.handlers[C]=I:delete c.handlers[C],c.eventCount=Object.keys(c.handlers).length;else if(O&&O.set&&(O.copy||O instanceof _g)){if(Array.isArray(I))O.fromArray?O.fromArray(I):O.set(...I);else if(O.copy&&I&&I.constructor&&(w3e?O.constructor.name===I.constructor.name:O.constructor===I.constructor))O.copy(I);else if(I!==void 0){const F=O instanceof Pn;!F&&O.setScalar?O.setScalar(I):O instanceof _g&&I instanceof _g?O.mask=I.mask:O.set(I),!VY()&&!f.linear&&F&&O.convertSRGBToLinear()}}else if(L[C]=I,L[C]instanceof Lr&&L[C].format===hl&&L[C].type===hd){const F=L[C];V4(F)&&V4(f.gl)?F.colorSpace=f.gl.outputColorSpace:F.encoding=f.gl.outputEncoding}n0(n)}if(c.parent&&f.internal&&n.raycast&&_!==c.eventCount){const A=f.internal.interaction.indexOf(n);A>-1&&f.internal.interaction.splice(A,1),c.eventCount&&f.internal.interaction.push(n)}return!(y.length===1&&y[0][0]==="onUpdate")&&y.length&&(s=n.__r3f)!=null&&s.parent&&xR(n),n}function n0(n){var e,a;const o=(e=n.__r3f)==null||(a=e.root)==null||a.getState==null?void 0:a.getState();o&&o.internal.frames===0&&o.invalidate()}function xR(n){n.onUpdate==null||n.onUpdate(n)}function S3e(n,e){n.manual||(GY(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function qS(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function A3e(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return x0.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return x0.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return x0.ContinuousEventPriority;default:return x0.DefaultEventPriority}}function ZY(n,e,a,o){const s=a.get(e);s&&(a.delete(e),a.size===0&&(n.delete(o),s.target.releasePointerCapture(o)))}function E3e(n,e){const{internal:a}=n.getState();a.interaction=a.interaction.filter(o=>o!==e),a.initialHits=a.initialHits.filter(o=>o!==e),a.hovered.forEach((o,s)=>{(o.eventObject===e||o.object===e)&&a.hovered.delete(s)}),a.capturedMap.forEach((o,s)=>{ZY(a.capturedMap,e,o,s)})}function M3e(n){function e(m){const{internal:y}=n.getState(),_=m.offsetX-y.initialClick[0],w=m.offsetY-y.initialClick[1];return Math.round(Math.sqrt(_*_+w*w))}function a(m){return m.filter(y=>["Move","Over","Enter","Out","Leave"].some(_=>{var w;return(w=y.__r3f)==null?void 0:w.handlers["onPointer"+_]}))}function o(m,y){const _=n.getState(),w=new Set,A=[],C=y?y(_.internal.interaction):_.internal.interaction;for(let L=0;L<C.length;L++){const O=ob(C[L]);O&&(O.raycaster.camera=void 0)}_.previousRoot||_.events.compute==null||_.events.compute(m,_);function I(L){const O=ob(L);if(!O||!O.events.enabled||O.raycaster.camera===null)return[];if(O.raycaster.camera===void 0){var F;O.events.compute==null||O.events.compute(m,O,(F=O.previousRoot)==null?void 0:F.getState()),O.raycaster.camera===void 0&&(O.raycaster.camera=null)}return O.raycaster.camera?O.raycaster.intersectObject(L,!0):[]}let k=C.flatMap(I).sort((L,O)=>{const F=ob(L.object),B=ob(O.object);return!F||!B?L.distance-O.distance:B.events.priority-F.events.priority||L.distance-O.distance}).filter(L=>{const O=qS(L);return w.has(O)?!1:(w.add(O),!0)});_.events.filter&&(k=_.events.filter(k,_));for(const L of k){let O=L.object;for(;O;){var D;(D=O.__r3f)!=null&&D.eventCount&&A.push({...L,eventObject:O}),O=O.parent}}if("pointerId"in m&&_.internal.capturedMap.has(m.pointerId))for(let L of _.internal.capturedMap.get(m.pointerId).values())w.has(qS(L.intersection))||A.push(L.intersection);return A}function s(m,y,_,w){const A=n.getState();if(m.length){const C={stopped:!1};for(const I of m){const k=ob(I.object)||A,{raycaster:D,pointer:L,camera:O,internal:F}=k,B=new Fe(L.x,L.y,0).unproject(O),G=Q=>{var me,pe;return(me=(pe=F.capturedMap.get(Q))==null?void 0:pe.has(I.eventObject))!=null?me:!1},q=Q=>{const me={intersection:I,target:y.target};F.capturedMap.has(Q)?F.capturedMap.get(Q).set(I.eventObject,me):F.capturedMap.set(Q,new Map([[I.eventObject,me]])),y.target.setPointerCapture(Q)},X=Q=>{const me=F.capturedMap.get(Q);me&&ZY(F.capturedMap,I.eventObject,me,Q)};let ee={};for(let Q in y){let me=y[Q];typeof me!="function"&&(ee[Q]=me)}let V={...I,...ee,pointer:L,intersections:m,stopped:C.stopped,delta:_,unprojectedPoint:B,ray:D.ray,camera:O,stopPropagation(){const Q="pointerId"in y&&F.capturedMap.get(y.pointerId);if((!Q||Q.has(I.eventObject))&&(V.stopped=C.stopped=!0,F.hovered.size&&Array.from(F.hovered.values()).find(me=>me.eventObject===I.eventObject))){const me=m.slice(0,m.indexOf(I));c([...me,I])}},target:{hasPointerCapture:G,setPointerCapture:q,releasePointerCapture:X},currentTarget:{hasPointerCapture:G,setPointerCapture:q,releasePointerCapture:X},nativeEvent:y};if(w(V),C.stopped===!0)break}}return m}function c(m){const{internal:y}=n.getState();for(const _ of y.hovered.values())if(!m.length||!m.find(w=>w.object===_.object&&w.index===_.index&&w.instanceId===_.instanceId)){const A=_.eventObject.__r3f,C=A==null?void 0:A.handlers;if(y.hovered.delete(qS(_)),A!=null&&A.eventCount){const I={..._,intersections:m};C.onPointerOut==null||C.onPointerOut(I),C.onPointerLeave==null||C.onPointerLeave(I)}}}function d(m,y){for(let _=0;_<y.length;_++){const w=y[_].__r3f;w==null||w.handlers.onPointerMissed==null||w.handlers.onPointerMissed(m)}}function f(m){switch(m){case"onPointerLeave":case"onPointerCancel":return()=>c([]);case"onLostPointerCapture":return y=>{const{internal:_}=n.getState();"pointerId"in y&&_.capturedMap.has(y.pointerId)&&requestAnimationFrame(()=>{_.capturedMap.has(y.pointerId)&&(_.capturedMap.delete(y.pointerId),c([]))})}}return function(_){const{onPointerMissed:w,internal:A}=n.getState();A.lastEvent.current=_;const C=m==="onPointerMove",I=m==="onClick"||m==="onContextMenu"||m==="onDoubleClick",D=o(_,C?a:void 0),L=I?e(_):0;m==="onPointerDown"&&(A.initialClick=[_.offsetX,_.offsetY],A.initialHits=D.map(F=>F.eventObject)),I&&!D.length&&L<=2&&(d(_,A.interaction),w&&w(_)),C&&c(D);function O(F){const B=F.eventObject,G=B.__r3f,q=G==null?void 0:G.handlers;if(G!=null&&G.eventCount)if(C){if(q.onPointerOver||q.onPointerEnter||q.onPointerOut||q.onPointerLeave){const X=qS(F),ee=A.hovered.get(X);ee?ee.stopped&&F.stopPropagation():(A.hovered.set(X,F),q.onPointerOver==null||q.onPointerOver(F),q.onPointerEnter==null||q.onPointerEnter(F))}q.onPointerMove==null||q.onPointerMove(F)}else{const X=q[m];X?(!I||A.initialHits.includes(B))&&(d(_,A.interaction.filter(ee=>!A.initialHits.includes(ee))),X(F)):I&&A.initialHits.includes(B)&&d(_,A.interaction.filter(ee=>!A.initialHits.includes(ee)))}}s(D,_,L,O)}}return{handlePointer:f}}const YY=n=>!!(n!=null&&n.render),KY=re.createContext(null),T3e=(n,e)=>{const a=o3e((f,m)=>{const y=new Fe,_=new Fe,w=new Fe;function A(L=m().camera,O=_,F=m().size){const{width:B,height:G,top:q,left:X}=F,ee=B/G;O instanceof Fe?w.copy(O):w.set(...O);const V=L.getWorldPosition(y).distanceTo(w);if(GY(L))return{width:B/L.zoom,height:G/L.zoom,top:q,left:X,factor:1,distance:V,aspect:ee};{const Q=L.fov*Math.PI/180,me=2*Math.tan(Q/2)*V,pe=me*(B/G);return{width:pe,height:me,top:q,left:X,factor:B/pe,distance:V,aspect:ee}}}let C;const I=L=>f(O=>({performance:{...O.performance,current:L}})),k=new Kt;return{set:f,get:m,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(L=1)=>n(m(),L),advance:(L,O)=>e(L,O,m()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new u6,pointer:k,mouse:k,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const L=m();C&&clearTimeout(C),L.performance.current!==L.performance.min&&I(L.performance.min),C=setTimeout(()=>I(m().performance.max),L.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:A},setEvents:L=>f(O=>({...O,events:{...O.events,...L}})),setSize:(L,O,F,B,G)=>{const q=m().camera,X={width:L,height:O,top:B||0,left:G||0,updateStyle:F};f(ee=>({size:X,viewport:{...ee.viewport,...A(q,_,X)}}))},setDpr:L=>f(O=>{const F=qY(L);return{viewport:{...O.viewport,dpr:F,initialDpr:O.viewport.initialDpr||F}}}),setFrameloop:(L="always")=>{const O=m().clock;O.stop(),O.elapsedTime=0,L!=="never"&&(O.start(),O.elapsedTime=0),f(()=>({frameloop:L}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:re.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(L,O,F)=>{const B=m().internal;return B.priority=B.priority+(O>0?1:0),B.subscribers.push({ref:L,priority:O,store:F}),B.subscribers=B.subscribers.sort((G,q)=>G.priority-q.priority),()=>{const G=m().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(O>0?1:0),G.subscribers=G.subscribers.filter(q=>q.ref!==L))}}}}}),o=a.getState();let s=o.size,c=o.viewport.dpr,d=o.camera;return a.subscribe(()=>{const{camera:f,size:m,viewport:y,gl:_,set:w}=a.getState();if(m.width!==s.width||m.height!==s.height||y.dpr!==c){var A;s=m,c=y.dpr,S3e(f,m),_.setPixelRatio(y.dpr);const C=(A=m.updateStyle)!=null?A:typeof HTMLCanvasElement<"u"&&_.domElement instanceof HTMLCanvasElement;_.setSize(m.width,m.height,C)}f!==d&&(d=f,w(C=>({viewport:{...C.viewport,...C.viewport.getCurrentViewport(f)}})))}),a.subscribe(f=>n(f)),a};function C3e(n,e){const a={callback:n};return e.add(a),()=>void e.delete(a)}let XS,JY=new Set,P3e=new Set,I3e=new Set;const L3e=n=>C3e(n,JY);function j4(n,e){if(n.size)for(const{callback:a}of n.values())a(e)}function sb(n,e){switch(n){case"before":return j4(JY,e);case"after":return j4(P3e,e);case"tail":return j4(I3e,e)}}let $4,q4;function X4(n,e,a){let o=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(o=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),$4=e.internal.subscribers,XS=0;XS<$4.length;XS++)q4=$4[XS],q4.ref.current(q4.store.getState(),o,a);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function R3e(n){let e=!1,a,o,s;function c(m){o=requestAnimationFrame(c),e=!0,a=0,sb("before",m);for(const _ of n.values()){var y;s=_.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((y=s.gl.xr)!=null&&y.isPresenting)&&(a+=X4(m,s))}if(sb("after",m),a===0)return sb("tail",m),e=!1,cancelAnimationFrame(o)}function d(m,y=1){var _;if(!m)return n.forEach(w=>d(w.store.getState()),y);(_=m.gl.xr)!=null&&_.isPresenting||!m.internal.active||m.frameloop==="never"||(m.internal.frames=Math.min(60,m.internal.frames+y),e||(e=!0,requestAnimationFrame(c)))}function f(m,y=!0,_,w){if(y&&sb("before",m),_)X4(m,_,w);else for(const A of n.values())X4(m,A.store.getState());y&&sb("after",m)}return{loop:c,invalidate:d,advance:f}}function QY(){const n=re.useContext(KY);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function dh(n=a=>a,e){return QY()(n,e)}function m6(n,e=0){const a=QY(),o=a.getState().internal.subscribe,s=HY(n);return Dw(()=>o(s,e,a),[e,o,a]),null}const MV=new WeakMap;function eK(n,e){return function(a,...o){let s=MV.get(a);return s||(s=new a,MV.set(a,s)),n&&n(s),Promise.all(o.map(c=>new Promise((d,f)=>s.load(c,m=>{m.scene&&Object.assign(m,b3e(m.scene)),d(m)},e,m=>f(new Error(`Could not load ${c}: ${m==null?void 0:m.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function g6(n,e,a,o){const s=Array.isArray(e)?e:[e],c=WY(eK(a,o),[n,...s],{equal:rr.equ});return Array.isArray(e)?c:c[0]}g6.preload=function(n,e,a){const o=Array.isArray(e)?e:[e];return f3e(eK(a),[n,...o])};g6.clear=function(n,e){const a=Array.isArray(e)?e:[e];return p3e([n,...a])};const Q0=new Map,{invalidate:TV,advance:CV}=R3e(Q0),{reconciler:jE,applyProps:Qm}=g3e(Q0,A3e),qv={objects:"shallow",strict:!1},k3e=(n,e)=>{const a=typeof n=="function"?n(e):n;return YY(a)?a:new $D({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function D3e(n,e){const a=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:o,height:s,top:c,left:d,updateStyle:f=a}=e;return{width:o,height:s,top:c,left:d,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:o,height:s,top:c,left:d}=n.parentElement.getBoundingClientRect();return{width:o,height:s,top:c,left:d,updateStyle:a}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:a};return{width:0,height:0,top:0,left:0}}function O3e(n){const e=Q0.get(n),a=e==null?void 0:e.fiber,o=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,c=o||T3e(TV,CV),d=a||jE.createContainer(c,x0.ConcurrentRoot,null,!1,null,"",s,null);e||Q0.set(n,{fiber:d,store:c});let f,m=!1,y;return{configure(_={}){let{gl:w,size:A,scene:C,events:I,onCreated:k,shadows:D=!1,linear:L=!1,flat:O=!1,legacy:F=!1,orthographic:B=!1,frameloop:G="always",dpr:q=[1,2],performance:X,raycaster:ee,camera:V,onPointerMissed:Q}=_,me=c.getState(),pe=me.gl;me.gl||me.set({gl:pe=k3e(w,n)});let be=me.raycaster;be||me.set({raycaster:be=new RY});const{params:fe,...Ce}=ee||{};if(rr.equ(Ce,be,qv)||Qm(be,{...Ce}),rr.equ(fe,be.params,qv)||Qm(be,{params:{...be.params,...fe}}),!me.camera||me.camera===y&&!rr.equ(y,V,qv)){y=V;const Ee=V instanceof Cw,Ye=Ee?V:B?new Ah(0,0,0,0,.1,1e3):new jr(75,0,.1,1e3);Ee||(Ye.position.z=5,V&&Qm(Ye,V),!me.camera&&!(V!=null&&V.rotation)&&Ye.lookAt(0,0,0)),me.set({camera:Ye}),be.camera=Ye}if(!me.scene){let Ee;C instanceof GE?Ee=C:(Ee=new GE,C&&Qm(Ee,C)),me.set({scene:t0(Ee)})}if(!me.xr){var Re;const Ee=(Ke,Ue)=>{const ht=c.getState();ht.frameloop!=="never"&&CV(Ke,!0,ht,Ue)},Ye=()=>{const Ke=c.getState();Ke.gl.xr.enabled=Ke.gl.xr.isPresenting,Ke.gl.xr.setAnimationLoop(Ke.gl.xr.isPresenting?Ee:null),Ke.gl.xr.isPresenting||TV(Ke)},Xe={connect(){const Ke=c.getState().gl;Ke.xr.addEventListener("sessionstart",Ye),Ke.xr.addEventListener("sessionend",Ye)},disconnect(){const Ke=c.getState().gl;Ke.xr.removeEventListener("sessionstart",Ye),Ke.xr.removeEventListener("sessionend",Ye)}};typeof((Re=pe.xr)==null?void 0:Re.addEventListener)=="function"&&Xe.connect(),me.set({xr:Xe})}if(pe.shadowMap){const Ee=pe.shadowMap.enabled,Ye=pe.shadowMap.type;if(pe.shadowMap.enabled=!!D,rr.boo(D))pe.shadowMap.type=$b;else if(rr.str(D)){var He;const Xe={basic:EX,percentage:yT,soft:$b,variance:Qc};pe.shadowMap.type=(He=Xe[D])!=null?He:$b}else rr.obj(D)&&Object.assign(pe.shadowMap,D);(Ee!==pe.shadowMap.enabled||Ye!==pe.shadowMap.type)&&(pe.shadowMap.needsUpdate=!0)}const ue=VY();ue&&("enabled"in ue?ue.enabled=!F:"legacyMode"in ue&&(ue.legacyMode=F)),Qm(pe,{outputEncoding:L?3e3:3001,toneMapping:O?dd:CD}),me.legacy!==F&&me.set(()=>({legacy:F})),me.linear!==L&&me.set(()=>({linear:L})),me.flat!==O&&me.set(()=>({flat:O})),w&&!rr.fun(w)&&!YY(w)&&!rr.equ(w,pe,qv)&&Qm(pe,w),I&&!me.events.handlers&&me.set({events:I(c)});const ne=D3e(n,A);return rr.equ(ne,me.size,qv)||me.setSize(ne.width,ne.height,ne.updateStyle,ne.top,ne.left),q&&me.viewport.dpr!==qY(q)&&me.setDpr(q),me.frameloop!==G&&me.setFrameloop(G),me.onPointerMissed||me.set({onPointerMissed:Q}),X&&!rr.equ(X,me.performance,qv)&&me.set(Ee=>({performance:{...Ee.performance,...X}})),f=k,m=!0,this},render(_){return m||this.configure(),jE.updateContainer(re.createElement(z3e,{store:c,children:_,onCreated:f,rootElement:n}),d,null,()=>{}),c},unmount(){tK(n)}}}function z3e({store:n,children:e,onCreated:a,rootElement:o}){return Dw(()=>{const s=n.getState();s.set(c=>({internal:{...c.internal,active:!0}})),a&&a(s),n.getState().events.connected||s.events.connect==null||s.events.connect(o)},[]),re.createElement(KY.Provider,{value:n},e)}function tK(n,e){const a=Q0.get(n),o=a==null?void 0:a.fiber;if(o){const s=a==null?void 0:a.store.getState();s&&(s.internal.active=!1),jE.updateContainer(null,o,null,()=>{s&&setTimeout(()=>{try{var c,d,f,m;s.events.disconnect==null||s.events.disconnect(),(c=s.gl)==null||(d=c.renderLists)==null||d.dispose==null||d.dispose(),(f=s.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(m=s.gl)!=null&&m.xr&&s.xr.disconnect(),x3e(s),Q0.delete(n),e&&e(n)}catch{}},500)})}}jE.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:re.version});function wR(n,e,a){var o,s,c,d,f;e==null&&(e=100);function m(){var _=Date.now()-d;_<e&&_>=0?o=setTimeout(m,e-_):(o=null,a||(f=n.apply(c,s),c=s=null))}var y=function(){c=this,s=arguments,d=Date.now();var _=a&&!o;return o||(o=setTimeout(m,e)),_&&(f=n.apply(c,s),c=s=null),f};return y.clear=function(){o&&(clearTimeout(o),o=null)},y.flush=function(){o&&(f=n.apply(c,s),c=s=null,clearTimeout(o),o=null)},y}wR.debounce=wR;var F3e=wR;const PV=uw(F3e);function N3e(n){let{debounce:e,scroll:a,polyfill:o,offsetSize:s}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const c=o||(typeof window>"u"?class{}:window.ResizeObserver);if(!c)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[d,f]=re.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),m=re.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d}),y=e?typeof e=="number"?e:e.scroll:null,_=e?typeof e=="number"?e:e.resize:null,w=re.useRef(!1);re.useEffect(()=>(w.current=!0,()=>void(w.current=!1)));const[A,C,I]=re.useMemo(()=>{const O=()=>{if(!m.current.element)return;const{left:F,top:B,width:G,height:q,bottom:X,right:ee,x:V,y:Q}=m.current.element.getBoundingClientRect(),me={left:F,top:B,width:G,height:q,bottom:X,right:ee,x:V,y:Q};m.current.element instanceof HTMLElement&&s&&(me.height=m.current.element.offsetHeight,me.width=m.current.element.offsetWidth),Object.freeze(me),w.current&&!V3e(m.current.lastBounds,me)&&f(m.current.lastBounds=me)};return[O,_?PV(O,_):O,y?PV(O,y):O]},[f,s,y,_]);function k(){m.current.scrollContainers&&(m.current.scrollContainers.forEach(O=>O.removeEventListener("scroll",I,!0)),m.current.scrollContainers=null),m.current.resizeObserver&&(m.current.resizeObserver.disconnect(),m.current.resizeObserver=null)}function D(){m.current.element&&(m.current.resizeObserver=new c(I),m.current.resizeObserver.observe(m.current.element),a&&m.current.scrollContainers&&m.current.scrollContainers.forEach(O=>O.addEventListener("scroll",I,{capture:!0,passive:!0})))}const L=O=>{!O||O===m.current.element||(k(),m.current.element=O,m.current.scrollContainers=nK(O),D())};return U3e(I,!!a),B3e(C),re.useEffect(()=>{k(),D()},[a,I,C]),re.useEffect(()=>k,[]),[L,d,A]}function B3e(n){re.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function U3e(n,e){re.useEffect(()=>{if(e){const a=n;return window.addEventListener("scroll",a,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",a,!0)}},[n,e])}function nK(n){const e=[];if(!n||n===document.body)return e;const{overflow:a,overflowX:o,overflowY:s}=window.getComputedStyle(n);return[a,o,s].some(c=>c==="auto"||c==="scroll")&&e.push(n),[...e,...nK(n.parentElement)]}const W3e=["x","y","top","bottom","left","right","width","height"],V3e=(n,e)=>W3e.every(a=>n[a]===e[a]);var G3e=Object.defineProperty,H3e=Object.defineProperties,j3e=Object.getOwnPropertyDescriptors,IV=Object.getOwnPropertySymbols,$3e=Object.prototype.hasOwnProperty,q3e=Object.prototype.propertyIsEnumerable,LV=(n,e,a)=>e in n?G3e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,RV=(n,e)=>{for(var a in e||(e={}))$3e.call(e,a)&&LV(n,a,e[a]);if(IV)for(var a of IV(e))q3e.call(e,a)&&LV(n,a,e[a]);return n},X3e=(n,e)=>H3e(n,j3e(e));function aK(n,e,a){if(!n)return;if(a(n)===!0)return n;let o=e?n.return:n.child;for(;o;){const s=aK(o,e,a);if(s)return s;o=e?null:o.sibling}}function iK(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const y6=iK(re.createContext(null));class rK extends re.Component{render(){return re.createElement(y6.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:kV,ReactCurrentDispatcher:DV}=re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Z3e(){const n=re.useContext(y6);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=re.useId();return re.useMemo(()=>{for(const o of[kV==null?void 0:kV.current,n,n==null?void 0:n.alternate]){if(!o)continue;const s=aK(o,!1,c=>{let d=c.memoizedState;for(;d;){if(d.memoizedState===e)return!0;d=d.next}});if(s)return s}},[n,e])}function Y3e(){var n,e;const a=Z3e(),[o]=re.useState(()=>new Map);o.clear();let s=a;for(;s;){const c=(n=s.type)==null?void 0:n._context;c&&c!==y6&&!o.has(c)&&o.set(c,(e=DV==null?void 0:DV.current)==null?void 0:e.readContext(iK(c))),s=s.return}return o}function K3e(){const n=Y3e();return re.useMemo(()=>Array.from(n.keys()).reduce((e,a)=>o=>re.createElement(e,null,re.createElement(a.Provider,X3e(RV({},o),{value:n.get(a)}))),e=>re.createElement(rK,RV({},e))),[n])}const Z4={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function J3e(n){const{handlePointer:e}=M3e(n);return{priority:1,enabled:!0,compute(a,o,s){o.pointer.set(a.offsetX/o.size.width*2-1,-(a.offsetY/o.size.height)*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)},connected:void 0,handlers:Object.keys(Z4).reduce((a,o)=>({...a,[o]:e(o)}),{}),update:()=>{var a;const{events:o,internal:s}=n.getState();(a=s.lastEvent)!=null&&a.current&&o.handlers&&o.handlers.onPointerMove(s.lastEvent.current)},connect:a=>{var o;const{set:s,events:c}=n.getState();c.disconnect==null||c.disconnect(),s(d=>({events:{...d.events,connected:a}})),Object.entries((o=c.handlers)!=null?o:[]).forEach(([d,f])=>{const[m,y]=Z4[d];a.addEventListener(m,f,{passive:y})})},disconnect:()=>{const{set:a,events:o}=n.getState();if(o.connected){var s;Object.entries((s=o.handlers)!=null?s:[]).forEach(([c,d])=>{if(o&&o.connected instanceof HTMLElement){const[f]=Z4[c];o.connected.removeEventListener(f,d)}}),a(c=>({events:{...c.events,connected:void 0}}))}}}}const Q3e=re.forwardRef(function({children:e,fallback:a,resize:o,style:s,gl:c,events:d=J3e,eventSource:f,eventPrefix:m,shadows:y,linear:_,flat:w,legacy:A,orthographic:C,frameloop:I,dpr:k,performance:D,raycaster:L,camera:O,scene:F,onPointerMissed:B,onCreated:G,...q},X){re.useMemo(()=>m3e(DY),[]);const ee=K3e(),[V,Q]=N3e({scroll:!0,debounce:{scroll:50,resize:0},...o}),me=re.useRef(null),pe=re.useRef(null);re.useImperativeHandle(X,()=>me.current);const be=HY(B),[fe,Ce]=re.useState(!1),[Re,He]=re.useState(!1);if(fe)throw fe;if(Re)throw Re;const ue=re.useRef(null);Dw(()=>{const Ae=me.current;Q.width>0&&Q.height>0&&Ae&&(ue.current||(ue.current=O3e(Ae)),ue.current.configure({gl:c,events:d,shadows:y,linear:_,flat:w,legacy:A,orthographic:C,frameloop:I,dpr:k,performance:D,raycaster:L,camera:O,scene:F,size:Q,onPointerMissed:(...ne)=>be.current==null?void 0:be.current(...ne),onCreated:ne=>{ne.events.connect==null||ne.events.connect(f?y3e(f)?f.current:f:pe.current),m&&ne.setEvents({compute:(Ee,Ye)=>{const Xe=Ee[m+"X"],Ke=Ee[m+"Y"];Ye.pointer.set(Xe/Ye.size.width*2-1,-(Ke/Ye.size.height)*2+1),Ye.raycaster.setFromCamera(Ye.pointer,Ye.camera)}}),G==null||G(ne)}}),ue.current.render(re.createElement(ee,null,re.createElement(jY,{set:He},re.createElement(re.Suspense,{fallback:re.createElement(v3e,{set:Ce})},e)))))}),re.useEffect(()=>{const Ae=me.current;if(Ae)return()=>tK(Ae)},[]);const ye=f?"none":"auto";return re.createElement("div",rt({ref:pe,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ye,...s}},q),re.createElement("div",{ref:V,style:{width:"100%",height:"100%"}},re.createElement("canvas",{ref:me,style:{display:"block"}},a)))}),eSe=re.forwardRef(function(e,a){return re.createElement(rK,null,re.createElement(Q3e,rt({},e,{ref:a})))});let v6=zw();const ti=n=>Ow(n,v6);let _6=zw();ti.write=n=>Ow(n,_6);let qT=zw();ti.onStart=n=>Ow(n,qT);let b6=zw();ti.onFrame=n=>Ow(n,b6);let x6=zw();ti.onFinish=n=>Ow(n,x6);let D0=[];ti.setTimeout=(n,e)=>{let a=ti.now()+e,o=()=>{let c=D0.findIndex(d=>d.cancel==o);~c&&D0.splice(c,1),Xf-=~c?1:0},s={time:a,handler:n,cancel:o};return D0.splice(oK(a),0,s),Xf+=1,sK(),s};let oK=n=>~(~D0.findIndex(e=>e.time>n)||~D0.length);ti.cancel=n=>{qT.delete(n),b6.delete(n),x6.delete(n),v6.delete(n),_6.delete(n)};ti.sync=n=>{SR=!0,ti.batchedUpdates(n),SR=!1};ti.throttle=n=>{let e;function a(){try{n(...e)}finally{e=null}}function o(...s){e=s,ti.onStart(a)}return o.handler=n,o.cancel=()=>{qT.delete(a),e=null},o};let w6=typeof window<"u"?window.requestAnimationFrame:()=>{};ti.use=n=>w6=n;ti.now=typeof performance<"u"?()=>performance.now():Date.now;ti.batchedUpdates=n=>n();ti.catch=console.error;ti.frameLoop="always";ti.advance=()=>{ti.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):cK()};let qf=-1,Xf=0,SR=!1;function Ow(n,e){SR?(e.delete(n),n(0)):(e.add(n),sK())}function sK(){qf<0&&(qf=0,ti.frameLoop!=="demand"&&w6(lK))}function tSe(){qf=-1}function lK(){~qf&&(w6(lK),ti.batchedUpdates(cK))}function cK(){let n=qf;qf=ti.now();let e=oK(qf);if(e&&(uK(D0.splice(0,e),a=>a.handler()),Xf-=e),!Xf){tSe();return}qT.flush(),v6.flush(n?Math.min(64,qf-n):16.667),b6.flush(),_6.flush(),x6.flush()}function zw(){let n=new Set,e=n;return{add(a){Xf+=e==n&&!n.has(a)?1:0,n.add(a)},delete(a){return Xf-=e==n&&n.has(a)?1:0,n.delete(a)},flush(a){e.size&&(n=new Set,Xf-=e.size,uK(e,o=>o(a)&&n.add(o)),Xf+=n.size,e=n)}}}function uK(n,e){n.forEach(a=>{try{e(a)}catch(o){ti.catch(o)}})}function nSe(){}const aSe=(n,e,a)=>Object.defineProperty(n,e,{value:a,writable:!0,configurable:!0}),Xr={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function iSe(n,e){if(Xr.arr(n)){if(!Xr.arr(e)||n.length!==e.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==e[a])return!1;return!0}return n===e}const Ih=(n,e)=>n.forEach(e);function AR(n,e,a){if(Xr.arr(n)){for(let o=0;o<n.length;o++)e.call(a,n[o],`${o}`);return}for(const o in n)n.hasOwnProperty(o)&&e.call(a,n[o],o)}const ZS=n=>Xr.und(n)?[]:Xr.arr(n)?n:[n],S6=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let A6,dK,dp=null,hK=!1,E6=nSe;const rSe=n=>{n.to&&(dK=n.to),n.now&&(ti.now=n.now),n.colors!==void 0&&(dp=n.colors),n.skipAnimation!=null&&(hK=n.skipAnimation),n.createStringInterpolator&&(A6=n.createStringInterpolator),n.requestAnimationFrame&&ti.use(n.requestAnimationFrame),n.batchedUpdates&&(ti.batchedUpdates=n.batchedUpdates),n.willAdvance&&(E6=n.willAdvance),n.frameLoop&&(ti.frameLoop=n.frameLoop)};var Qx=Object.freeze({__proto__:null,get createStringInterpolator(){return A6},get to(){return dK},get colors(){return dp},get skipAnimation(){return hK},get willAdvance(){return E6},assign:rSe});const Jb=new Set;let _c=[],Y4=[],$E=0;const M6={get idle(){return!Jb.size&&!_c.length},start(n){$E>n.priority?(Jb.add(n),ti.onStart(oSe)):(fK(n),ti(ER))},advance:ER,sort(n){if($E)ti.onFrame(()=>M6.sort(n));else{const e=_c.indexOf(n);~e&&(_c.splice(e,1),pK(n))}},clear(){_c=[],Jb.clear()}};function oSe(){Jb.forEach(fK),Jb.clear(),ti(ER)}function fK(n){_c.includes(n)||pK(n)}function pK(n){_c.splice(sSe(_c,e=>e.priority>n.priority),0,n)}function ER(n){const e=Y4;for(let a=0;a<_c.length;a++){const o=_c[a];$E=o.priority,o.idle||(E6(o),o.advance(n),o.idle||e.push(o))}return $E=0,Y4=_c,Y4.length=0,_c=e,_c.length>0}function sSe(n,e){const a=n.findIndex(e);return a<0?n.length:a}const lSe=(n,e,a)=>Math.min(Math.max(a,n),e),cSe={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},iu="[-+]?\\d*\\.?\\d+",qE=iu+"%";function XT(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}const uSe=new RegExp("rgb"+XT(iu,iu,iu)),dSe=new RegExp("rgba"+XT(iu,iu,iu,iu)),hSe=new RegExp("hsl"+XT(iu,qE,qE)),fSe=new RegExp("hsla"+XT(iu,qE,qE,iu)),pSe=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,mSe=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,gSe=/^#([0-9a-fA-F]{6})$/,ySe=/^#([0-9a-fA-F]{8})$/;function vSe(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=gSe.exec(n))?parseInt(e[1]+"ff",16)>>>0:dp&&dp[n]!==void 0?dp[n]:(e=uSe.exec(n))?(Xv(e[1])<<24|Xv(e[2])<<16|Xv(e[3])<<8|255)>>>0:(e=dSe.exec(n))?(Xv(e[1])<<24|Xv(e[2])<<16|Xv(e[3])<<8|FV(e[4]))>>>0:(e=pSe.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=ySe.exec(n))?parseInt(e[1],16)>>>0:(e=mSe.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=hSe.exec(n))?(OV(zV(e[1]),YS(e[2]),YS(e[3]))|255)>>>0:(e=fSe.exec(n))?(OV(zV(e[1]),YS(e[2]),YS(e[3]))|FV(e[4]))>>>0:null}function K4(n,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?n+(e-n)*6*a:a<1/2?e:a<2/3?n+(e-n)*(2/3-a)*6:n}function OV(n,e,a){const o=a<.5?a*(1+e):a+e-a*e,s=2*a-o,c=K4(s,o,n+1/3),d=K4(s,o,n),f=K4(s,o,n-1/3);return Math.round(c*255)<<24|Math.round(d*255)<<16|Math.round(f*255)<<8}function Xv(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function zV(n){return(parseFloat(n)%360+360)%360/360}function FV(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function YS(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function NV(n){let e=vSe(n);if(e===null)return n;e=e||0;let a=(e&4278190080)>>>24,o=(e&16711680)>>>16,s=(e&65280)>>>8,c=(e&255)/255;return`rgba(${a}, ${o}, ${s}, ${c})`}const ew=(n,e,a)=>{if(Xr.fun(n))return n;if(Xr.arr(n))return ew({range:n,output:e,extrapolate:a});if(Xr.str(n.output[0]))return A6(n);const o=n,s=o.output,c=o.range||[0,1],d=o.extrapolateLeft||o.extrapolate||"extend",f=o.extrapolateRight||o.extrapolate||"extend",m=o.easing||(y=>y);return y=>{const _=bSe(y,c);return _Se(y,c[_],c[_+1],s[_],s[_+1],m,d,f,o.map)}};function _Se(n,e,a,o,s,c,d,f,m){let y=m?m(n):n;if(y<e){if(d==="identity")return y;d==="clamp"&&(y=e)}if(y>a){if(f==="identity")return y;f==="clamp"&&(y=a)}return o===s?o:e===a?n<=e?o:s:(e===-1/0?y=-y:a===1/0?y=y-e:y=(y-e)/(a-e),y=c(y),o===-1/0?y=-y:s===1/0?y=y+o:y=y*(s-o)+o,y)}function bSe(n,e){for(var a=1;a<e.length-1&&!(e[a]>=n);++a);return a-1}const xSe=(n,e="end")=>a=>{a=e==="end"?Math.min(a,.999):Math.max(a,.001);const o=a*n,s=e==="end"?Math.floor(o):Math.ceil(o);return lSe(0,1,s/n)},XE=1.70158,KS=XE*1.525,BV=XE+1,UV=2*Math.PI/3,WV=2*Math.PI/4.5,JS=n=>n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375,wSe={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>1-(1-n)*(1-n),easeInOutQuad:n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,easeInCubic:n=>n*n*n,easeOutCubic:n=>1-Math.pow(1-n,3),easeInOutCubic:n=>n<.5?4*n*n*n:1-Math.pow(-2*n+2,3)/2,easeInQuart:n=>n*n*n*n,easeOutQuart:n=>1-Math.pow(1-n,4),easeInOutQuart:n=>n<.5?8*n*n*n*n:1-Math.pow(-2*n+2,4)/2,easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>1-Math.pow(1-n,5),easeInOutQuint:n=>n<.5?16*n*n*n*n*n:1-Math.pow(-2*n+2,5)/2,easeInSine:n=>1-Math.cos(n*Math.PI/2),easeOutSine:n=>Math.sin(n*Math.PI/2),easeInOutSine:n=>-(Math.cos(Math.PI*n)-1)/2,easeInExpo:n=>n===0?0:Math.pow(2,10*n-10),easeOutExpo:n=>n===1?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>n===0?0:n===1?1:n<.5?Math.pow(2,20*n-10)/2:(2-Math.pow(2,-20*n+10))/2,easeInCirc:n=>1-Math.sqrt(1-Math.pow(n,2)),easeOutCirc:n=>Math.sqrt(1-Math.pow(n-1,2)),easeInOutCirc:n=>n<.5?(1-Math.sqrt(1-Math.pow(2*n,2)))/2:(Math.sqrt(1-Math.pow(-2*n+2,2))+1)/2,easeInBack:n=>BV*n*n*n-XE*n*n,easeOutBack:n=>1+BV*Math.pow(n-1,3)+XE*Math.pow(n-1,2),easeInOutBack:n=>n<.5?Math.pow(2*n,2)*((KS+1)*2*n-KS)/2:(Math.pow(2*n-2,2)*((KS+1)*(n*2-2)+KS)+2)/2,easeInElastic:n=>n===0?0:n===1?1:-Math.pow(2,10*n-10)*Math.sin((n*10-10.75)*UV),easeOutElastic:n=>n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n*10-.75)*UV)+1,easeInOutElastic:n=>n===0?0:n===1?1:n<.5?-(Math.pow(2,20*n-10)*Math.sin((20*n-11.125)*WV))/2:Math.pow(2,-20*n+10)*Math.sin((20*n-11.125)*WV)/2+1,easeInBounce:n=>1-JS(1-n),easeOutBounce:JS,easeInOutBounce:n=>n<.5?(1-JS(1-2*n))/2:(1+JS(2*n-1))/2,steps:xSe};function MR(){return MR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},MR.apply(this,arguments)}const e_=Symbol.for("FluidValue.get"),t_=Symbol.for("FluidValue.observers"),ZE=n=>!!(n&&n[e_]),YE=n=>n&&n[e_]?n[e_]():n;function SSe(n,e){n.eventObserved?n.eventObserved(e):n(e)}function TR(n,e){let a=n[t_];a&&a.forEach(o=>{SSe(o,e)})}class ASe{constructor(e){if(this[e_]=void 0,this[t_]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");ESe(this,e)}}const ESe=(n,e)=>gK(n,e_,e);function mK(n,e){if(n[e_]){let a=n[t_];a||gK(n,t_,a=new Set),a.has(e)||(a.add(e),n.observerAdded&&n.observerAdded(a.size,e))}return e}function CR(n,e){let a=n[t_];if(a&&a.has(e)){const o=a.size-1;o?a.delete(e):n[t_]=null,n.observerRemoved&&n.observerRemoved(o,e)}}const gK=(n,e,a)=>Object.defineProperty(n,e,{value:a,writable:!0,configurable:!0}),GA=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,MSe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,VV=new RegExp(`(${GA.source})(%|[a-z]+)`,"i"),TSe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,ZT=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,yK=n=>{const[e,a]=CSe(n);if(!e||S6())return n;const o=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(o)return o.trim();if(a&&a.startsWith("--")){const s=window.getComputedStyle(document.documentElement).getPropertyValue(a);return s||n}else{if(a&&ZT.test(a))return yK(a);if(a)return a}return n},CSe=n=>{const e=ZT.exec(n);if(!e)return[,];const[,a,o]=e;return[a,o]};let J4;const PSe=(n,e,a,o,s)=>`rgba(${Math.round(e)}, ${Math.round(a)}, ${Math.round(o)}, ${s})`,vK=n=>{J4||(J4=dp?new RegExp(`(${Object.keys(dp).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(c=>YE(c).replace(ZT,yK).replace(MSe,NV).replace(J4,NV)),a=e.map(c=>c.match(GA).map(Number)),s=a[0].map((c,d)=>a.map(f=>{if(!(d in f))throw Error('The arity of each "output" value must be equal');return f[d]})).map(c=>ew(MR({},n,{output:c})));return c=>{var d;const f=!VV.test(e[0])&&((d=e.find(y=>VV.test(y)))==null?void 0:d.replace(GA,""));let m=0;return e[0].replace(GA,()=>`${s[m++](c)}${f||""}`).replace(TSe,PSe)}},_K="react-spring: ",bK=n=>{const e=n;let a=!1;if(typeof e!="function")throw new TypeError(`${_K}once requires a function parameter`);return(...o)=>{a||(e(...o),a=!0)}},ISe=bK(console.warn);function LSe(){ISe(`${_K}The "interpolate" function is deprecated in v9 (use "to" instead)`)}bK(console.warn);function xK(n){return Xr.str(n)&&(n[0]=="#"||/\d/.test(n)||!S6()&&ZT.test(n)||n in(dp||{}))}const wK=S6()?re.useEffect:re.useLayoutEffect,RSe=()=>{const n=re.useRef(!1);return wK(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function kSe(){const n=re.useState()[1],e=RSe();return()=>{e.current&&n(Math.random())}}function DSe(n,e){const[a]=re.useState(()=>({inputs:e,result:n()})),o=re.useRef(),s=o.current;let c=s;return c?e&&c.inputs&&OSe(e,c.inputs)||(c={inputs:e,result:n()}):c=a,re.useEffect(()=>{o.current=c,s==a&&(a.inputs=a.result=void 0)},[c]),c.result}function OSe(n,e){if(n.length!==e.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==e[a])return!1;return!0}const zSe=n=>re.useEffect(n,FSe),FSe=[],tw=Symbol.for("Animated:node"),NSe=n=>!!n&&n[tw]===n,T6=n=>n&&n[tw],SK=(n,e)=>aSe(n,tw,e),C6=n=>n&&n[tw]&&n[tw].getPayload();class AK{constructor(){this.payload=void 0,SK(this,this)}getPayload(){return this.payload||[]}}class Fw extends AK{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,Xr.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new Fw(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,a){return Xr.num(e)&&(this.lastPosition=e,a&&(e=Math.round(e/a)*a,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Xr.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class YT extends Fw{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=ew({output:[e,e]})}static create(e){return new YT(e)}getValue(){let e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(Xr.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=ew({output:[this.getValue(),e]})),this._value=0,super.reset()}}const KE={dependencies:null};class P6 extends AK{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const a={};return AR(this.source,(o,s)=>{NSe(o)?a[s]=o.getValue(e):ZE(o)?a[s]=YE(o):e||(a[s]=o)}),a}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&Ih(this.payload,e=>e.reset())}_makePayload(e){if(e){const a=new Set;return AR(e,this._addToPayload,a),Array.from(a)}}_addToPayload(e){KE.dependencies&&ZE(e)&&KE.dependencies.add(e);const a=C6(e);a&&Ih(a,o=>this.add(o))}}class I6 extends P6{constructor(e){super(e)}static create(e){return new I6(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const a=this.getPayload();return e.length==a.length?a.map((o,s)=>o.setValue(e[s])).some(Boolean):(super.setValue(e.map(BSe)),!0)}}function BSe(n){return(xK(n)?YT:Fw).create(n)}function USe(n){const e=T6(n);return e?e.constructor:Xr.arr(n)?I6:xK(n)?YT:Fw}function JE(){return JE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},JE.apply(this,arguments)}const GV=(n,e)=>{const a=!Xr.fun(n)||n.prototype&&n.prototype.isReactComponent;return re.forwardRef((o,s)=>{const c=re.useRef(null),d=a&&re.useCallback(I=>{c.current=GSe(s,I)},[s]),[f,m]=VSe(o,e),y=kSe(),_=()=>{const I=c.current;if(a&&!I)return;(I?e.applyAnimatedValues(I,f.getValue(!0)):!1)===!1&&y()},w=new WSe(_,m),A=re.useRef();wK(()=>(A.current=w,Ih(m,I=>mK(I,w)),()=>{A.current&&(Ih(A.current.deps,I=>CR(I,A.current)),ti.cancel(A.current.update))})),re.useEffect(_,[]),zSe(()=>()=>{const I=A.current;Ih(I.deps,k=>CR(k,I))});const C=e.getComponentProps(f.getValue());return re.createElement(n,JE({},C,{ref:d}))})};class WSe{constructor(e,a){this.update=e,this.deps=a}eventObserved(e){e.type=="change"&&ti.write(this.update)}}function VSe(n,e){const a=new Set;return KE.dependencies=a,n.style&&(n=JE({},n,{style:e.createAnimatedStyle(n.style)})),n=new P6(n),KE.dependencies=null,[n,a]}function GSe(n,e){return n&&(Xr.fun(n)?n(e):n.current=e),e}const HV=Symbol.for("AnimatedComponent"),HSe=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:a=s=>new P6(s),getComponentProps:o=s=>s}={})=>{const s={applyAnimatedValues:e,createAnimatedStyle:a,getComponentProps:o},c=d=>{const f=jV(d)||"Anonymous";return Xr.str(d)?d=c[d]||(c[d]=GV(d,s)):d=d[HV]||(d[HV]=GV(d,s)),d.displayName=`Animated(${f})`,d};return AR(n,(d,f)=>{Xr.arr(n)&&(f=jV(d)),c[f]=c(d)}),{animated:c}},jV=n=>Xr.str(n)?n:n&&Xr.str(n.displayName)?n.displayName:Xr.fun(n)&&n.name||null;function PR(){return PR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},PR.apply(this,arguments)}const jSe={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}};PR({},jSe.default,{mass:1,damping:1,easing:wSe.linear,clamp:!1});const $V=n=>n instanceof EK;let $Se=1;class EK extends ASe{constructor(...e){super(...e),this.id=$Se++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=T6(this);return e&&e.getValue()}to(...e){return Qx.to(this,e)}interpolate(...e){return LSe(),Qx.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,a=!1){TR(this,{type:"change",parent:this,value:e,idle:a})}_onPriorityChange(e){this.idle||M6.sort(this),TR(this,{type:"priority",parent:this,priority:e})}}function qSe(n,e){if(n==null)return{};var a={},o=Object.keys(n),s,c;for(c=0;c<o.length;c++)s=o[c],!(e.indexOf(s)>=0)&&(a[s]=n[s]);return a}const XSe=["children"],L6=n=>{let{children:e}=n,a=qSe(n,XSe);const o=re.useContext(QE),s=a.pause||!!o.pause,c=a.immediate||!!o.immediate;a=DSe(()=>({pause:s,immediate:c}),[s,c]);const{Provider:d}=QE;return re.createElement(d,{value:a},e)},QE=ZSe(L6,{});L6.Provider=QE.Provider;L6.Consumer=QE.Consumer;function ZSe(n,e){return Object.assign(n,re.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}let qV;(function(n){n.MOUNT="mount",n.ENTER="enter",n.UPDATE="update",n.LEAVE="leave"})(qV||(qV={}));class YSe extends EK{constructor(e,a){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=ew(...a);const o=this._get(),s=USe(o);SK(this,s.create(o))}advance(e){const a=this._get(),o=this.get();iSe(a,o)||(T6(this).setValue(a),this._onChange(a,this.idle)),!this.idle&&XV(this._active)&&Q4(this)}_get(){const e=Xr.arr(this.source)?this.source.map(YE):ZS(YE(this.source));return this.calc(...e)}_start(){this.idle&&!XV(this._active)&&(this.idle=!1,Ih(C6(this),e=>{e.done=!1}),Qx.skipAnimation?(ti.batchedUpdates(()=>this.advance()),Q4(this)):M6.start(this))}_attach(){let e=1;Ih(ZS(this.source),a=>{ZE(a)&&mK(a,this),$V(a)&&(a.idle||this._active.add(a),e=Math.max(e,a.priority+1))}),this.priority=e,this._start()}_detach(){Ih(ZS(this.source),e=>{ZE(e)&&CR(e,this)}),this._active.clear(),Q4(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=ZS(this.source).reduce((a,o)=>Math.max(a,($V(o)?o.priority:0)+1),0))}}function KSe(n){return n.idle!==!1}function XV(n){return!n.size||Array.from(n).every(KSe)}function Q4(n){n.idle||(n.idle=!0,Ih(C6(n),e=>{e.done=!0}),TR(n,{type:"idle",parent:n}))}Qx.assign({createStringInterpolator:vK,to:(n,e)=>new YSe(n,e)});const JSe=["primitive"].concat(Object.keys(DY).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));Qx.assign({createStringInterpolator:vK,colors:cSe,frameLoop:"demand"});L3e(()=>{ti.advance()});HSe(JSe,{applyAnimatedValues:Qm});var QSe=Object.defineProperty,eAe=(n,e,a)=>e in n?QSe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,Sa=(n,e,a)=>(eAe(n,typeof e!="symbol"?e+"":e,a),a);const QS=new Wg,ZV=new gh,tAe=Math.cos(70*(Math.PI/180)),YV=(n,e)=>(n%e+e)%e;let nAe=class extends _d{constructor(e,a){super(),Sa(this,"object"),Sa(this,"domElement"),Sa(this,"enabled",!0),Sa(this,"target",new Fe),Sa(this,"minDistance",0),Sa(this,"maxDistance",1/0),Sa(this,"minZoom",0),Sa(this,"maxZoom",1/0),Sa(this,"minPolarAngle",0),Sa(this,"maxPolarAngle",Math.PI),Sa(this,"minAzimuthAngle",-1/0),Sa(this,"maxAzimuthAngle",1/0),Sa(this,"enableDamping",!1),Sa(this,"dampingFactor",.05),Sa(this,"enableZoom",!0),Sa(this,"zoomSpeed",1),Sa(this,"enableRotate",!0),Sa(this,"rotateSpeed",1),Sa(this,"enablePan",!0),Sa(this,"panSpeed",1),Sa(this,"screenSpacePanning",!0),Sa(this,"keyPanSpeed",7),Sa(this,"zoomToCursor",!1),Sa(this,"autoRotate",!1),Sa(this,"autoRotateSpeed",2),Sa(this,"reverseOrbit",!1),Sa(this,"reverseHorizontalOrbit",!1),Sa(this,"reverseVerticalOrbit",!1),Sa(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Sa(this,"mouseButtons",{LEFT:Zm.ROTATE,MIDDLE:Zm.DOLLY,RIGHT:Zm.PAN}),Sa(this,"touches",{ONE:Ym.ROTATE,TWO:Ym.DOLLY_PAN}),Sa(this,"target0"),Sa(this,"position0"),Sa(this,"zoom0"),Sa(this,"_domElementKeyEvents",null),Sa(this,"getPolarAngle"),Sa(this,"getAzimuthalAngle"),Sa(this,"setPolarAngle"),Sa(this,"setAzimuthalAngle"),Sa(this,"getDistance"),Sa(this,"listenToKeyEvents"),Sa(this,"stopListenToKeyEvents"),Sa(this,"saveState"),Sa(this,"reset"),Sa(this,"update"),Sa(this,"connect"),Sa(this,"dispose"),this.object=e,this.domElement=a,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=Ge=>{let It=YV(Ge,2*Math.PI),qt=_.phi;qt<0&&(qt+=2*Math.PI),It<0&&(It+=2*Math.PI);let Dt=Math.abs(It-qt);2*Math.PI-Dt<Dt&&(It<qt?It+=2*Math.PI:qt+=2*Math.PI),w.phi=It-qt,o.update()},this.setAzimuthalAngle=Ge=>{let It=YV(Ge,2*Math.PI),qt=_.theta;qt<0&&(qt+=2*Math.PI),It<0&&(It+=2*Math.PI);let Dt=Math.abs(It-qt);2*Math.PI-Dt<Dt&&(It<qt?It+=2*Math.PI:qt+=2*Math.PI),w.theta=It-qt,o.update()},this.getDistance=()=>o.object.position.distanceTo(o.target),this.listenToKeyEvents=Ge=>{Ge.addEventListener("keydown",st),this._domElementKeyEvents=Ge},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",st),this._domElementKeyEvents=null},this.saveState=()=>{o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=()=>{o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(s),o.update(),m=f.NONE},this.update=(()=>{const Ge=new Fe,It=new Fe(0,1,0),qt=new _s().setFromUnitVectors(e.up,It),Dt=qt.clone().invert(),fn=new Fe,_e=new _s,Ze=2*Math.PI;return function(){const Me=o.object.position;qt.setFromUnitVectors(e.up,It),Dt.copy(qt).invert(),Ge.copy(Me).sub(o.target),Ge.applyQuaternion(qt),_.setFromVector3(Ge),o.autoRotate&&m===f.NONE&&fe(pe()),o.enableDamping?(_.theta+=w.theta*o.dampingFactor,_.phi+=w.phi*o.dampingFactor):(_.theta+=w.theta,_.phi+=w.phi);let ze=o.minAzimuthAngle,Je=o.maxAzimuthAngle;isFinite(ze)&&isFinite(Je)&&(ze<-Math.PI?ze+=Ze:ze>Math.PI&&(ze-=Ze),Je<-Math.PI?Je+=Ze:Je>Math.PI&&(Je-=Ze),ze<=Je?_.theta=Math.max(ze,Math.min(Je,_.theta)):_.theta=_.theta>(ze+Je)/2?Math.max(ze,_.theta):Math.min(Je,_.theta)),_.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,_.phi)),_.makeSafe(),o.enableDamping===!0?o.target.addScaledVector(C,o.dampingFactor):o.target.add(C),o.zoomToCursor&&V||o.object.isOrthographicCamera?_.radius=Ee(_.radius):_.radius=Ee(_.radius*A),Ge.setFromSpherical(_),Ge.applyQuaternion(Dt),Me.copy(o.target).add(Ge),o.object.lookAt(o.target),o.enableDamping===!0?(w.theta*=1-o.dampingFactor,w.phi*=1-o.dampingFactor,C.multiplyScalar(1-o.dampingFactor)):(w.set(0,0,0),C.set(0,0,0));let et=!1;if(o.zoomToCursor&&V){let yt=null;if(o.object instanceof jr&&o.object.isPerspectiveCamera){const ut=Ge.length();yt=Ee(ut*A);const ct=ut-yt;o.object.position.addScaledVector(X,ct),o.object.updateMatrixWorld()}else if(o.object.isOrthographicCamera){const ut=new Fe(ee.x,ee.y,0);ut.unproject(o.object),o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/A)),o.object.updateProjectionMatrix(),et=!0;const ct=new Fe(ee.x,ee.y,0);ct.unproject(o.object),o.object.position.sub(ct).add(ut),o.object.updateMatrixWorld(),yt=Ge.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),o.zoomToCursor=!1;yt!==null&&(o.screenSpacePanning?o.target.set(0,0,-1).transformDirection(o.object.matrix).multiplyScalar(yt).add(o.object.position):(QS.origin.copy(o.object.position),QS.direction.set(0,0,-1).transformDirection(o.object.matrix),Math.abs(o.object.up.dot(QS.direction))<tAe?e.lookAt(o.target):(ZV.setFromNormalAndCoplanarPoint(o.object.up,o.target),QS.intersectPlane(ZV,o.target))))}else o.object instanceof Ah&&o.object.isOrthographicCamera&&(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/A)),o.object.updateProjectionMatrix(),et=!0);return A=1,V=!1,et||fn.distanceToSquared(o.object.position)>y||8*(1-_e.dot(o.object.quaternion))>y?(o.dispatchEvent(s),fn.copy(o.object.position),_e.copy(o.object.quaternion),et=!1,!0):!1}})(),this.connect=Ge=>{Ge===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),o.domElement=Ge,o.domElement.style.touchAction="none",o.domElement.addEventListener("contextmenu",Vt),o.domElement.addEventListener("pointerdown",De),o.domElement.addEventListener("pointercancel",te),o.domElement.addEventListener("wheel",it)},this.dispose=()=>{var Ge,It,qt,Dt,fn,_e;(Ge=o.domElement)==null||Ge.removeEventListener("contextmenu",Vt),(It=o.domElement)==null||It.removeEventListener("pointerdown",De),(qt=o.domElement)==null||qt.removeEventListener("pointercancel",te),(Dt=o.domElement)==null||Dt.removeEventListener("wheel",it),(fn=o.domElement)==null||fn.ownerDocument.removeEventListener("pointermove",ot),(_e=o.domElement)==null||_e.ownerDocument.removeEventListener("pointerup",ce),o._domElementKeyEvents!==null&&o._domElementKeyEvents.removeEventListener("keydown",st)};const o=this,s={type:"change"},c={type:"start"},d={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let m=f.NONE;const y=1e-6,_=new _R,w=new _R;let A=1;const C=new Fe,I=new Kt,k=new Kt,D=new Kt,L=new Kt,O=new Kt,F=new Kt,B=new Kt,G=new Kt,q=new Kt,X=new Fe,ee=new Kt;let V=!1;const Q=[],me={};function pe(){return 2*Math.PI/60/60*o.autoRotateSpeed}function be(){return Math.pow(.95,o.zoomSpeed)}function fe(Ge){o.reverseOrbit||o.reverseHorizontalOrbit?w.theta+=Ge:w.theta-=Ge}function Ce(Ge){o.reverseOrbit||o.reverseVerticalOrbit?w.phi+=Ge:w.phi-=Ge}const Re=(()=>{const Ge=new Fe;return function(qt,Dt){Ge.setFromMatrixColumn(Dt,0),Ge.multiplyScalar(-qt),C.add(Ge)}})(),He=(()=>{const Ge=new Fe;return function(qt,Dt){o.screenSpacePanning===!0?Ge.setFromMatrixColumn(Dt,1):(Ge.setFromMatrixColumn(Dt,0),Ge.crossVectors(o.object.up,Ge)),Ge.multiplyScalar(qt),C.add(Ge)}})(),ue=(()=>{const Ge=new Fe;return function(qt,Dt){const fn=o.domElement;if(fn&&o.object instanceof jr&&o.object.isPerspectiveCamera){const _e=o.object.position;Ge.copy(_e).sub(o.target);let Ze=Ge.length();Ze*=Math.tan(o.object.fov/2*Math.PI/180),Re(2*qt*Ze/fn.clientHeight,o.object.matrix),He(2*Dt*Ze/fn.clientHeight,o.object.matrix)}else fn&&o.object instanceof Ah&&o.object.isOrthographicCamera?(Re(qt*(o.object.right-o.object.left)/o.object.zoom/fn.clientWidth,o.object.matrix),He(Dt*(o.object.top-o.object.bottom)/o.object.zoom/fn.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}})();function ye(Ge){o.object instanceof jr&&o.object.isPerspectiveCamera||o.object instanceof Ah&&o.object.isOrthographicCamera?A/=Ge:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function Ae(Ge){o.object instanceof jr&&o.object.isPerspectiveCamera||o.object instanceof Ah&&o.object.isOrthographicCamera?A*=Ge:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function ne(Ge){if(!o.zoomToCursor||!o.domElement)return;V=!0;const It=o.domElement.getBoundingClientRect(),qt=Ge.clientX-It.left,Dt=Ge.clientY-It.top,fn=It.width,_e=It.height;ee.x=qt/fn*2-1,ee.y=-(Dt/_e)*2+1,X.set(ee.x,ee.y,1).unproject(o.object).sub(o.object.position).normalize()}function Ee(Ge){return Math.max(o.minDistance,Math.min(o.maxDistance,Ge))}function Ye(Ge){I.set(Ge.clientX,Ge.clientY)}function Xe(Ge){ne(Ge),B.set(Ge.clientX,Ge.clientY)}function Ke(Ge){L.set(Ge.clientX,Ge.clientY)}function Ue(Ge){k.set(Ge.clientX,Ge.clientY),D.subVectors(k,I).multiplyScalar(o.rotateSpeed);const It=o.domElement;It&&(fe(2*Math.PI*D.x/It.clientHeight),Ce(2*Math.PI*D.y/It.clientHeight)),I.copy(k),o.update()}function ht(Ge){G.set(Ge.clientX,Ge.clientY),q.subVectors(G,B),q.y>0?ye(be()):q.y<0&&Ae(be()),B.copy(G),o.update()}function Lt(Ge){O.set(Ge.clientX,Ge.clientY),F.subVectors(O,L).multiplyScalar(o.panSpeed),ue(F.x,F.y),L.copy(O),o.update()}function Rt(Ge){ne(Ge),Ge.deltaY<0?Ae(be()):Ge.deltaY>0&&ye(be()),o.update()}function Jt(Ge){let It=!1;switch(Ge.code){case o.keys.UP:ue(0,o.keyPanSpeed),It=!0;break;case o.keys.BOTTOM:ue(0,-o.keyPanSpeed),It=!0;break;case o.keys.LEFT:ue(o.keyPanSpeed,0),It=!0;break;case o.keys.RIGHT:ue(-o.keyPanSpeed,0),It=!0;break}It&&(Ge.preventDefault(),o.update())}function Pt(){if(Q.length==1)I.set(Q[0].pageX,Q[0].pageY);else{const Ge=.5*(Q[0].pageX+Q[1].pageX),It=.5*(Q[0].pageY+Q[1].pageY);I.set(Ge,It)}}function Pe(){if(Q.length==1)L.set(Q[0].pageX,Q[0].pageY);else{const Ge=.5*(Q[0].pageX+Q[1].pageX),It=.5*(Q[0].pageY+Q[1].pageY);L.set(Ge,It)}}function ft(){const Ge=Q[0].pageX-Q[1].pageX,It=Q[0].pageY-Q[1].pageY,qt=Math.sqrt(Ge*Ge+It*It);B.set(0,qt)}function gt(){o.enableZoom&&ft(),o.enablePan&&Pe()}function St(){o.enableZoom&&ft(),o.enableRotate&&Pt()}function Be(Ge){if(Q.length==1)k.set(Ge.pageX,Ge.pageY);else{const qt=Yt(Ge),Dt=.5*(Ge.pageX+qt.x),fn=.5*(Ge.pageY+qt.y);k.set(Dt,fn)}D.subVectors(k,I).multiplyScalar(o.rotateSpeed);const It=o.domElement;It&&(fe(2*Math.PI*D.x/It.clientHeight),Ce(2*Math.PI*D.y/It.clientHeight)),I.copy(k)}function le(Ge){if(Q.length==1)O.set(Ge.pageX,Ge.pageY);else{const It=Yt(Ge),qt=.5*(Ge.pageX+It.x),Dt=.5*(Ge.pageY+It.y);O.set(qt,Dt)}F.subVectors(O,L).multiplyScalar(o.panSpeed),ue(F.x,F.y),L.copy(O)}function oe(Ge){const It=Yt(Ge),qt=Ge.pageX-It.x,Dt=Ge.pageY-It.y,fn=Math.sqrt(qt*qt+Dt*Dt);G.set(0,fn),q.set(0,Math.pow(G.y/B.y,o.zoomSpeed)),ye(q.y),B.copy(G)}function ve(Ge){o.enableZoom&&oe(Ge),o.enablePan&&le(Ge)}function $e(Ge){o.enableZoom&&oe(Ge),o.enableRotate&&Be(Ge)}function De(Ge){var It,qt;o.enabled!==!1&&(Q.length===0&&((It=o.domElement)==null||It.ownerDocument.addEventListener("pointermove",ot),(qt=o.domElement)==null||qt.ownerDocument.addEventListener("pointerup",ce)),$t(Ge),Ge.pointerType==="touch"?At(Ge):Oe(Ge))}function ot(Ge){o.enabled!==!1&&(Ge.pointerType==="touch"?Ut(Ge):pt(Ge))}function ce(Ge){var It,qt,Dt;Ft(Ge),Q.length===0&&((It=o.domElement)==null||It.releasePointerCapture(Ge.pointerId),(qt=o.domElement)==null||qt.ownerDocument.removeEventListener("pointermove",ot),(Dt=o.domElement)==null||Dt.ownerDocument.removeEventListener("pointerup",ce)),o.dispatchEvent(d),m=f.NONE}function te(Ge){Ft(Ge)}function Oe(Ge){let It;switch(Ge.button){case 0:It=o.mouseButtons.LEFT;break;case 1:It=o.mouseButtons.MIDDLE;break;case 2:It=o.mouseButtons.RIGHT;break;default:It=-1}switch(It){case Zm.DOLLY:if(o.enableZoom===!1)return;Xe(Ge),m=f.DOLLY;break;case Zm.ROTATE:if(Ge.ctrlKey||Ge.metaKey||Ge.shiftKey){if(o.enablePan===!1)return;Ke(Ge),m=f.PAN}else{if(o.enableRotate===!1)return;Ye(Ge),m=f.ROTATE}break;case Zm.PAN:if(Ge.ctrlKey||Ge.metaKey||Ge.shiftKey){if(o.enableRotate===!1)return;Ye(Ge),m=f.ROTATE}else{if(o.enablePan===!1)return;Ke(Ge),m=f.PAN}break;default:m=f.NONE}m!==f.NONE&&o.dispatchEvent(c)}function pt(Ge){if(o.enabled!==!1)switch(m){case f.ROTATE:if(o.enableRotate===!1)return;Ue(Ge);break;case f.DOLLY:if(o.enableZoom===!1)return;ht(Ge);break;case f.PAN:if(o.enablePan===!1)return;Lt(Ge);break}}function it(Ge){o.enabled===!1||o.enableZoom===!1||m!==f.NONE&&m!==f.ROTATE||(Ge.preventDefault(),o.dispatchEvent(c),Rt(Ge),o.dispatchEvent(d))}function st(Ge){o.enabled===!1||o.enablePan===!1||Jt(Ge)}function At(Ge){switch(wt(Ge),Q.length){case 1:switch(o.touches.ONE){case Ym.ROTATE:if(o.enableRotate===!1)return;Pt(),m=f.TOUCH_ROTATE;break;case Ym.PAN:if(o.enablePan===!1)return;Pe(),m=f.TOUCH_PAN;break;default:m=f.NONE}break;case 2:switch(o.touches.TWO){case Ym.DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;gt(),m=f.TOUCH_DOLLY_PAN;break;case Ym.DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;St(),m=f.TOUCH_DOLLY_ROTATE;break;default:m=f.NONE}break;default:m=f.NONE}m!==f.NONE&&o.dispatchEvent(c)}function Ut(Ge){switch(wt(Ge),m){case f.TOUCH_ROTATE:if(o.enableRotate===!1)return;Be(Ge),o.update();break;case f.TOUCH_PAN:if(o.enablePan===!1)return;le(Ge),o.update();break;case f.TOUCH_DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;ve(Ge),o.update();break;case f.TOUCH_DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;$e(Ge),o.update();break;default:m=f.NONE}}function Vt(Ge){o.enabled!==!1&&Ge.preventDefault()}function $t(Ge){Q.push(Ge)}function Ft(Ge){delete me[Ge.pointerId];for(let It=0;It<Q.length;It++)if(Q[It].pointerId==Ge.pointerId){Q.splice(It,1);return}}function wt(Ge){let It=me[Ge.pointerId];It===void 0&&(It=new Kt,me[Ge.pointerId]=It),It.set(Ge.pageX,Ge.pageY)}function Yt(Ge){const It=Ge.pointerId===Q[0].pointerId?Q[1]:Q[0];return me[It.pointerId]}a!==void 0&&this.connect(a),this.update()}};function aAe(){var n=Object.create(null);function e(s,c){var d=s.id,f=s.name,m=s.dependencies;m===void 0&&(m=[]);var y=s.init;y===void 0&&(y=function(){});var _=s.getTransferables;if(_===void 0&&(_=null),!n[d])try{m=m.map(function(A){return A&&A.isWorkerModule&&(e(A,function(C){if(C instanceof Error)throw C}),A=n[A.id].value),A}),y=o("<"+f+">.init",y),_&&(_=o("<"+f+">.getTransferables",_));var w=null;typeof y=="function"?w=y.apply(void 0,m):console.error("worker module init function failed to rehydrate"),n[d]={id:d,value:w,getTransferables:_},c(w)}catch(A){A&&A.noLog||console.error(A),c(A)}}function a(s,c){var d,f=s.id,m=s.args;(!n[f]||typeof n[f].value!="function")&&c(new Error("Worker module "+f+": not found or its 'init' did not return a function"));try{var y=(d=n[f]).value.apply(d,m);y&&typeof y.then=="function"?y.then(_,function(w){return c(w instanceof Error?w:new Error(""+w))}):_(y)}catch(w){c(w)}function _(w){try{var A=n[f].getTransferables&&n[f].getTransferables(w);(!A||!Array.isArray(A)||!A.length)&&(A=void 0),c(w,A)}catch(C){console.error(C),c(C)}}}function o(s,c){var d=void 0;self.troikaDefine=function(m){return d=m};var f=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+c+`
)`],{type:"application/javascript"}));try{importScripts(f)}catch(m){console.error(m)}return URL.revokeObjectURL(f),delete self.troikaDefine,d}self.addEventListener("message",function(s){var c=s.data,d=c.messageId,f=c.action,m=c.data;try{f==="registerModule"&&e(m,function(y){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:{isCallable:typeof y=="function"}})}),f==="callModule"&&a(m,function(y,_){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:y},_||void 0)})}catch(y){postMessage({messageId:d,success:!1,error:y.stack})}})}function iAe(n){var e=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,a);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var a=n.dependencies,o=n.init;a=Array.isArray(a)?a.map(function(c){return c&&c._getInitResult?c._getInitResult():c}):[];var s=Promise.all(a).then(function(c){return o.apply(null,c)});return e._getInitResult=function(){return s},s},e}var MK=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(a){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+a.message+"]")}return MK=function(){return n},n},rAe=0,oAe=0,eI=!1,Qb=Object.create(null),ex=Object.create(null),IR=Object.create(null);function Nw(n){if((!n||typeof n.init!="function")&&!eI)throw new Error("requires `options.init` function");var e=n.dependencies,a=n.init,o=n.getTransferables,s=n.workerId;if(!MK())return iAe(n);s==null&&(s="#default");var c="workerModule"+ ++rAe,d=n.name||c,f=null;e=e&&e.map(function(y){return typeof y=="function"&&!y.workerModuleData&&(eI=!0,y=Nw({workerId:s,name:"<"+d+"> function dependency: "+y.name,init:`function(){return (
`+HA(y)+`
)}`}),eI=!1),y&&y.workerModuleData&&(y=y.workerModuleData),y});function m(){for(var y=[],_=arguments.length;_--;)y[_]=arguments[_];if(!f){f=KV(s,"registerModule",m.workerModuleData);var w=function(){f=null,ex[s].delete(w)};(ex[s]||(ex[s]=new Set)).add(w)}return f.then(function(A){var C=A.isCallable;if(C)return KV(s,"callModule",{id:c,args:y});throw new Error("Worker module function was called but `init` did not return a callable function")})}return m.workerModuleData={isWorkerModule:!0,id:c,name:d,dependencies:e,init:HA(a),getTransferables:o&&HA(o)},m}function sAe(n){ex[n]&&ex[n].forEach(function(e){e()}),Qb[n]&&(Qb[n].terminate(),delete Qb[n])}function HA(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function lAe(n){var e=Qb[n];if(!e){var a=HA(aAe);e=Qb[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+a+")()"],{type:"application/javascript"}))),e.onmessage=function(o){var s=o.data,c=s.messageId,d=IR[c];if(!d)throw new Error("WorkerModule response with empty or unknown messageId");delete IR[c],d(s)}}return e}function KV(n,e,a){return new Promise(function(o,s){var c=++oAe;IR[c]=function(d){d.success?o(d.result):s(new Error("Error in worker "+e+" call: "+d.error))},lAe(n).postMessage({messageId:c,action:e,data:a})})}function TK(){var n=function(e){function a(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue){var ht=1-Ke;Ue.x=ht*ht*ye+2*ht*Ke*ne+Ke*Ke*Ye,Ue.y=ht*ht*Ae+2*ht*Ke*Ee+Ke*Ke*Xe}function o(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt){var Rt=1-ht;Lt.x=Rt*Rt*Rt*ye+3*Rt*Rt*ht*ne+3*Rt*ht*ht*Ye+ht*ht*ht*Ke,Lt.y=Rt*Rt*Rt*Ae+3*Rt*Rt*ht*Ee+3*Rt*ht*ht*Xe+ht*ht*ht*Ue}function s(ye,Ae){for(var ne=/([MLQCZ])([^MLQCZ]*)/g,Ee,Ye,Xe,Ke,Ue;Ee=ne.exec(ye);){var ht=Ee[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Lt){return parseFloat(Lt)});switch(Ee[1]){case"M":Ke=Ye=ht[0],Ue=Xe=ht[1];break;case"L":(ht[0]!==Ke||ht[1]!==Ue)&&Ae("L",Ke,Ue,Ke=ht[0],Ue=ht[1]);break;case"Q":{Ae("Q",Ke,Ue,Ke=ht[2],Ue=ht[3],ht[0],ht[1]);break}case"C":{Ae("C",Ke,Ue,Ke=ht[4],Ue=ht[5],ht[0],ht[1],ht[2],ht[3]);break}case"Z":(Ke!==Ye||Ue!==Xe)&&Ae("L",Ke,Ue,Ye,Xe);break}}}function c(ye,Ae,ne){ne===void 0&&(ne=16);var Ee={x:0,y:0};s(ye,function(Ye,Xe,Ke,Ue,ht,Lt,Rt,Jt,Pt){switch(Ye){case"L":Ae(Xe,Ke,Ue,ht);break;case"Q":{for(var Pe=Xe,ft=Ke,gt=1;gt<ne;gt++)a(Xe,Ke,Lt,Rt,Ue,ht,gt/(ne-1),Ee),Ae(Pe,ft,Ee.x,Ee.y),Pe=Ee.x,ft=Ee.y;break}case"C":{for(var St=Xe,Be=Ke,le=1;le<ne;le++)o(Xe,Ke,Lt,Rt,Jt,Pt,Ue,ht,le/(ne-1),Ee),Ae(St,Be,Ee.x,Ee.y),St=Ee.x,Be=Ee.y;break}}})}var d="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",f="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",m=new WeakMap,y={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function _(ye,Ae){var ne=ye.getContext?ye.getContext("webgl",y):ye,Ee=m.get(ne);if(!Ee){let St=function(De){var ot=Xe[De];if(!ot&&(ot=Xe[De]=ne.getExtension(De),!ot))throw new Error(De+" not supported");return ot},Be=function(De,ot){var ce=ne.createShader(ot);return ne.shaderSource(ce,De),ne.compileShader(ce),ce},le=function(De,ot,ce,te){if(!Ke[De]){var Oe={},pt={},it=ne.createProgram();ne.attachShader(it,Be(ot,ne.VERTEX_SHADER)),ne.attachShader(it,Be(ce,ne.FRAGMENT_SHADER)),ne.linkProgram(it),Ke[De]={program:it,transaction:function(At){ne.useProgram(it),At({setUniform:function(Vt,$t){for(var Ft=[],wt=arguments.length-2;wt-- >0;)Ft[wt]=arguments[wt+2];var Yt=pt[$t]||(pt[$t]=ne.getUniformLocation(it,$t));ne["uniform"+Vt].apply(ne,[Yt].concat(Ft))},setAttribute:function(Vt,$t,Ft,wt,Yt){var Ge=Oe[Vt];Ge||(Ge=Oe[Vt]={buf:ne.createBuffer(),loc:ne.getAttribLocation(it,Vt),data:null}),ne.bindBuffer(ne.ARRAY_BUFFER,Ge.buf),ne.vertexAttribPointer(Ge.loc,$t,ne.FLOAT,!1,0,0),ne.enableVertexAttribArray(Ge.loc),Ye?ne.vertexAttribDivisor(Ge.loc,wt):St("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Ge.loc,wt),Yt!==Ge.data&&(ne.bufferData(ne.ARRAY_BUFFER,Yt,Ft),Ge.data=Yt)}})}}}Ke[De].transaction(te)},oe=function(De,ot){ht++;try{ne.activeTexture(ne.TEXTURE0+ht);var ce=Ue[De];ce||(ce=Ue[De]=ne.createTexture(),ne.bindTexture(ne.TEXTURE_2D,ce),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.NEAREST),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.NEAREST)),ne.bindTexture(ne.TEXTURE_2D,ce),ot(ce,ht)}finally{ht--}},ve=function(De,ot,ce){var te=ne.createFramebuffer();Lt.push(te),ne.bindFramebuffer(ne.FRAMEBUFFER,te),ne.activeTexture(ne.TEXTURE0+ot),ne.bindTexture(ne.TEXTURE_2D,De),ne.framebufferTexture2D(ne.FRAMEBUFFER,ne.COLOR_ATTACHMENT0,ne.TEXTURE_2D,De,0);try{ce(te)}finally{ne.deleteFramebuffer(te),ne.bindFramebuffer(ne.FRAMEBUFFER,Lt[--Lt.length-1]||null)}},$e=function(){Xe={},Ke={},Ue={},ht=-1,Lt.length=0};var Rt=St,Jt=Be,Pt=le,Pe=oe,ft=ve,gt=$e,Ye=typeof WebGL2RenderingContext<"u"&&ne instanceof WebGL2RenderingContext,Xe={},Ke={},Ue={},ht=-1,Lt=[];ne.canvas.addEventListener("webglcontextlost",function(De){$e(),De.preventDefault()},!1),m.set(ne,Ee={gl:ne,isWebGL2:Ye,getExtension:St,withProgram:le,withTexture:oe,withTextureFramebuffer:ve,handleContextLoss:$e})}Ae(Ee)}function w(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue){Ke===void 0&&(Ke=15),Ue===void 0&&(Ue=null),_(ye,function(ht){var Lt=ht.gl,Rt=ht.withProgram,Jt=ht.withTexture;Jt("copy",function(Pt,Pe){Lt.texImage2D(Lt.TEXTURE_2D,0,Lt.RGBA,Ye,Xe,0,Lt.RGBA,Lt.UNSIGNED_BYTE,Ae),Rt("copy",d,f,function(ft){var gt=ft.setUniform,St=ft.setAttribute;St("aUV",2,Lt.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),gt("1i","image",Pe),Lt.bindFramebuffer(Lt.FRAMEBUFFER,Ue||null),Lt.disable(Lt.BLEND),Lt.colorMask(Ke&8,Ke&4,Ke&2,Ke&1),Lt.viewport(ne,Ee,Ye,Xe),Lt.scissor(ne,Ee,Ye,Xe),Lt.drawArrays(Lt.TRIANGLES,0,3)})})})}function A(ye,Ae,ne){var Ee=ye.width,Ye=ye.height;_(ye,function(Xe){var Ke=Xe.gl,Ue=new Uint8Array(Ee*Ye*4);Ke.readPixels(0,0,Ee,Ye,Ke.RGBA,Ke.UNSIGNED_BYTE,Ue),ye.width=Ae,ye.height=ne,w(Ke,Ue,0,0,Ee,Ye)})}var C=Object.freeze({__proto__:null,withWebGLContext:_,renderImageData:w,resizeWebGLCanvasWithoutClearing:A});function I(ye,Ae,ne,Ee,Ye,Xe){Xe===void 0&&(Xe=1);var Ke=new Uint8Array(ye*Ae),Ue=Ee[2]-Ee[0],ht=Ee[3]-Ee[1],Lt=[];c(ne,function(St,Be,le,oe){Lt.push({x1:St,y1:Be,x2:le,y2:oe,minX:Math.min(St,le),minY:Math.min(Be,oe),maxX:Math.max(St,le),maxY:Math.max(Be,oe)})}),Lt.sort(function(St,Be){return St.maxX-Be.maxX});for(var Rt=0;Rt<ye;Rt++)for(var Jt=0;Jt<Ae;Jt++){var Pt=ft(Ee[0]+Ue*(Rt+.5)/ye,Ee[1]+ht*(Jt+.5)/Ae),Pe=Math.pow(1-Math.abs(Pt)/Ye,Xe)/2;Pt<0&&(Pe=1-Pe),Pe=Math.max(0,Math.min(255,Math.round(Pe*255))),Ke[Jt*ye+Rt]=Pe}return Ke;function ft(St,Be){for(var le=1/0,oe=1/0,ve=Lt.length;ve--;){var $e=Lt[ve];if($e.maxX+oe<=St)break;if(St+oe>$e.minX&&Be-oe<$e.maxY&&Be+oe>$e.minY){var De=L(St,Be,$e.x1,$e.y1,$e.x2,$e.y2);De<le&&(le=De,oe=Math.sqrt(le))}}return gt(St,Be)&&(oe=-oe),oe}function gt(St,Be){for(var le=0,oe=Lt.length;oe--;){var ve=Lt[oe];if(ve.maxX<=St)break;var $e=ve.y1>Be!=ve.y2>Be&&St<(ve.x2-ve.x1)*(Be-ve.y1)/(ve.y2-ve.y1)+ve.x1;$e&&(le+=ve.y1<ve.y2?1:-1)}return le!==0}}function k(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt){Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ht===void 0&&(ht=0),Lt===void 0&&(Lt=0),D(ye,Ae,ne,Ee,Ye,Xe,Ke,null,Ue,ht,Lt)}function D(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt,Rt){Xe===void 0&&(Xe=1),ht===void 0&&(ht=0),Lt===void 0&&(Lt=0),Rt===void 0&&(Rt=0);for(var Jt=I(ye,Ae,ne,Ee,Ye,Xe),Pt=new Uint8Array(Jt.length*4),Pe=0;Pe<Jt.length;Pe++)Pt[Pe*4+Rt]=Jt[Pe];w(Ke,Pt,ht,Lt,ye,Ae,1<<3-Rt,Ue)}function L(ye,Ae,ne,Ee,Ye,Xe){var Ke=Ye-ne,Ue=Xe-Ee,ht=Ke*Ke+Ue*Ue,Lt=ht?Math.max(0,Math.min(1,((ye-ne)*Ke+(Ae-Ee)*Ue)/ht)):0,Rt=ye-(ne+Lt*Ke),Jt=Ae-(Ee+Lt*Ue);return Rt*Rt+Jt*Jt}var O=Object.freeze({__proto__:null,generate:I,generateIntoCanvas:k,generateIntoFramebuffer:D}),F="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",B="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",G="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",q=new Float32Array([0,0,2,0,0,2]),X=null,ee=!1,V={},Q=new WeakMap;function me(ye){if(!ee&&!Ce(ye))throw new Error("WebGL generation not supported")}function pe(ye,Ae,ne,Ee,Ye,Xe,Ke){if(Xe===void 0&&(Xe=1),Ke===void 0&&(Ke=null),!Ke&&(Ke=X,!Ke)){var Ue=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Ue)throw new Error("OffscreenCanvas or DOM canvas not supported");Ke=X=Ue.getContext("webgl",{depth:!1})}me(Ke);var ht=new Uint8Array(ye*Ae*4);_(Ke,function(Pt){var Pe=Pt.gl,ft=Pt.withTexture,gt=Pt.withTextureFramebuffer;ft("readable",function(St,Be){Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,ye,Ae,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),gt(St,Be,function(le){fe(ye,Ae,ne,Ee,Ye,Xe,Pe,le,0,0,0),Pe.readPixels(0,0,ye,Ae,Pe.RGBA,Pe.UNSIGNED_BYTE,ht)})})});for(var Lt=new Uint8Array(ye*Ae),Rt=0,Jt=0;Rt<ht.length;Rt+=4)Lt[Jt++]=ht[Rt];return Lt}function be(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt){Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ht===void 0&&(ht=0),Lt===void 0&&(Lt=0),fe(ye,Ae,ne,Ee,Ye,Xe,Ke,null,Ue,ht,Lt)}function fe(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt,Rt){Xe===void 0&&(Xe=1),ht===void 0&&(ht=0),Lt===void 0&&(Lt=0),Rt===void 0&&(Rt=0),me(Ke);var Jt=[];c(ne,function(Pt,Pe,ft,gt){Jt.push(Pt,Pe,ft,gt)}),Jt=new Float32Array(Jt),_(Ke,function(Pt){var Pe=Pt.gl,ft=Pt.isWebGL2,gt=Pt.getExtension,St=Pt.withProgram,Be=Pt.withTexture,le=Pt.withTextureFramebuffer,oe=Pt.handleContextLoss;if(Be("rawDistances",function(ve,$e){(ye!==ve._lastWidth||Ae!==ve._lastHeight)&&Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,ve._lastWidth=ye,ve._lastHeight=Ae,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),St("main",F,B,function(De){var ot=De.setAttribute,ce=De.setUniform,te=!ft&&gt("ANGLE_instanced_arrays"),Oe=!ft&&gt("EXT_blend_minmax");ot("aUV",2,Pe.STATIC_DRAW,0,q),ot("aLineSegment",4,Pe.DYNAMIC_DRAW,1,Jt),ce.apply(void 0,["4f","uGlyphBounds"].concat(Ee)),ce("1f","uMaxDistance",Ye),ce("1f","uExponent",Xe),le(ve,$e,function(pt){Pe.enable(Pe.BLEND),Pe.colorMask(!0,!0,!0,!0),Pe.viewport(0,0,ye,Ae),Pe.scissor(0,0,ye,Ae),Pe.blendFunc(Pe.ONE,Pe.ONE),Pe.blendEquationSeparate(Pe.FUNC_ADD,ft?Pe.MAX:Oe.MAX_EXT),Pe.clear(Pe.COLOR_BUFFER_BIT),ft?Pe.drawArraysInstanced(Pe.TRIANGLES,0,3,Jt.length/4):te.drawArraysInstancedANGLE(Pe.TRIANGLES,0,3,Jt.length/4)})}),St("post",d,G,function(De){De.setAttribute("aUV",2,Pe.STATIC_DRAW,0,q),De.setUniform("1i","tex",$e),Pe.bindFramebuffer(Pe.FRAMEBUFFER,Ue),Pe.disable(Pe.BLEND),Pe.colorMask(Rt===0,Rt===1,Rt===2,Rt===3),Pe.viewport(ht,Lt,ye,Ae),Pe.scissor(ht,Lt,ye,Ae),Pe.drawArrays(Pe.TRIANGLES,0,3)})}),Pe.isContextLost())throw oe(),new Error("webgl context lost")})}function Ce(ye){var Ae=!ye||ye===X?V:ye.canvas||ye,ne=Q.get(Ae);if(ne===void 0){ee=!0;var Ee=null;try{var Ye=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Xe=pe(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,ye);ne=Xe&&Ye.length===Xe.length&&Xe.every(function(Ke,Ue){return Ke===Ye[Ue]}),ne||(Ee="bad trial run results",console.info(Ye,Xe))}catch(Ke){ne=!1,Ee=Ke.message}Ee&&console.warn("WebGL SDF generation not supported:",Ee),ee=!1,Q.set(Ae,ne)}return ne}var Re=Object.freeze({__proto__:null,generate:pe,generateIntoCanvas:be,generateIntoFramebuffer:fe,isSupported:Ce});function He(ye,Ae,ne,Ee,Ye,Xe){Ye===void 0&&(Ye=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Xe===void 0&&(Xe=1);try{return pe.apply(Re,arguments)}catch(Ke){return console.info("WebGL SDF generation failed, falling back to JS",Ke),I.apply(O,arguments)}}function ue(ye,Ae,ne,Ee,Ye,Xe,Ke,Ue,ht,Lt){Ye===void 0&&(Ye=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ht===void 0&&(ht=0),Lt===void 0&&(Lt=0);try{return be.apply(Re,arguments)}catch(Rt){return console.info("WebGL SDF generation failed, falling back to JS",Rt),k.apply(O,arguments)}}return e.forEachPathCommand=s,e.generate=He,e.generateIntoCanvas=ue,e.javascript=O,e.pathToLineSegments=c,e.webgl=Re,e.webglUtils=C,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function cAe(){var n=function(e){var a={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},o={},s={};o.L=1,s[1]="L",Object.keys(a).forEach(function(oe,ve){o[oe]=1<<ve+1,s[o[oe]]=oe}),Object.freeze(o);var c=o.LRI|o.RLI|o.FSI,d=o.L|o.R|o.AL,f=o.B|o.S|o.WS|o.ON|o.FSI|o.LRI|o.RLI|o.PDI,m=o.BN|o.RLE|o.LRE|o.RLO|o.LRO|o.PDF,y=o.S|o.WS|o.B|c|o.PDI|m,_=null;function w(){if(!_){_=new Map;var oe=function($e){if(a.hasOwnProperty($e)){var De=0;a[$e].split(",").forEach(function(ot){var ce=ot.split("+"),te=ce[0],Oe=ce[1];te=parseInt(te,36),Oe=Oe?parseInt(Oe,36):0,_.set(De+=te,o[$e]);for(var pt=0;pt<Oe;pt++)_.set(++De,o[$e])})}};for(var ve in a)oe(ve)}}function A(oe){return w(),_.get(oe.codePointAt(0))||o.L}function C(oe){return s[A(oe)]}var I={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function k(oe,ve){var $e=36,De=0,ot=new Map,ce=ve&&new Map,te;return oe.split(",").forEach(function Oe(pt){if(pt.indexOf("+")!==-1)for(var it=+pt;it--;)Oe(te);else{te=pt;var st=pt.split(">"),At=st[0],Ut=st[1];At=String.fromCodePoint(De+=parseInt(At,$e)),Ut=String.fromCodePoint(De+=parseInt(Ut,$e)),ot.set(At,Ut),ve&&ce.set(Ut,At)}}),{map:ot,reverseMap:ce}}var D,L,O;function F(){if(!D){var oe=k(I.pairs,!0),ve=oe.map,$e=oe.reverseMap;D=ve,L=$e,O=k(I.canonical,!1).map}}function B(oe){return F(),D.get(oe)||null}function G(oe){return F(),L.get(oe)||null}function q(oe){return F(),O.get(oe)||null}var X=o.L,ee=o.R,V=o.EN,Q=o.ES,me=o.ET,pe=o.AN,be=o.CS,fe=o.B,Ce=o.S,Re=o.ON,He=o.BN,ue=o.NSM,ye=o.AL,Ae=o.LRO,ne=o.RLO,Ee=o.LRE,Ye=o.RLE,Xe=o.PDF,Ke=o.LRI,Ue=o.RLI,ht=o.FSI,Lt=o.PDI;function Rt(oe,ve){for(var $e=125,De=new Uint32Array(oe.length),ot=0;ot<oe.length;ot++)De[ot]=A(oe[ot]);var ce=new Map;function te(zr,Mi){var xn=De[zr];De[zr]=Mi,ce.set(xn,ce.get(xn)-1),xn&f&&ce.set(f,ce.get(f)-1),ce.set(Mi,(ce.get(Mi)||0)+1),Mi&f&&ce.set(f,(ce.get(f)||0)+1)}for(var Oe=new Uint8Array(oe.length),pt=new Map,it=[],st=null,At=0;At<oe.length;At++)st||it.push(st={start:At,end:oe.length-1,level:ve==="rtl"?1:ve==="ltr"?0:_u(At,!1)}),De[At]&fe&&(st.end=At,st=null);for(var Ut=Ye|Ee|ne|Ae|c|Lt|Xe|fe,Vt=function(zr){return zr+(zr&1?1:2)},$t=function(zr){return zr+(zr&1?2:1)},Ft=0;Ft<it.length;Ft++){st=it[Ft];var wt=[{_level:st.level,_override:0,_isolate:0}],Yt=void 0,Ge=0,It=0,qt=0;ce.clear();for(var Dt=st.start;Dt<=st.end;Dt++){var fn=De[Dt];if(Yt=wt[wt.length-1],ce.set(fn,(ce.get(fn)||0)+1),fn&f&&ce.set(f,(ce.get(f)||0)+1),fn&Ut)if(fn&(Ye|Ee)){Oe[Dt]=Yt._level;var _e=(fn===Ye?$t:Vt)(Yt._level);_e<=$e&&!Ge&&!It?wt.push({_level:_e,_override:0,_isolate:0}):Ge||It++}else if(fn&(ne|Ae)){Oe[Dt]=Yt._level;var Ze=(fn===ne?$t:Vt)(Yt._level);Ze<=$e&&!Ge&&!It?wt.push({_level:Ze,_override:fn&ne?ee:X,_isolate:0}):Ge||It++}else if(fn&c){fn&ht&&(fn=_u(Dt+1,!0)===1?Ue:Ke),Oe[Dt]=Yt._level,Yt._override&&te(Dt,Yt._override);var Se=(fn===Ue?$t:Vt)(Yt._level);Se<=$e&&Ge===0&&It===0?(qt++,wt.push({_level:Se,_override:0,_isolate:1,_isolInitIndex:Dt})):Ge++}else if(fn&Lt){if(Ge>0)Ge--;else if(qt>0){for(It=0;!wt[wt.length-1]._isolate;)wt.pop();var Me=wt[wt.length-1]._isolInitIndex;Me!=null&&(pt.set(Me,Dt),pt.set(Dt,Me)),wt.pop(),qt--}Yt=wt[wt.length-1],Oe[Dt]=Yt._level,Yt._override&&te(Dt,Yt._override)}else fn&Xe?(Ge===0&&(It>0?It--:!Yt._isolate&&wt.length>1&&(wt.pop(),Yt=wt[wt.length-1])),Oe[Dt]=Yt._level):fn&fe&&(Oe[Dt]=st.level);else Oe[Dt]=Yt._level,Yt._override&&fn!==He&&te(Dt,Yt._override)}for(var ze=[],Je=null,et=st.start;et<=st.end;et++){var yt=De[et];if(!(yt&m)){var ut=Oe[et],ct=yt&c,Gt=yt===Lt;Je&&ut===Je._level?(Je._end=et,Je._endsWithIsolInit=ct):ze.push(Je={_start:et,_end:et,_level:ut,_startsWithPDI:Gt,_endsWithIsolInit:ct})}}for(var Mt=[],Qt=0;Qt<ze.length;Qt++){var mn=ze[Qt];if(!mn._startsWithPDI||mn._startsWithPDI&&!pt.has(mn._start)){for(var nn=[Je=mn],wn=void 0;Je&&Je._endsWithIsolInit&&(wn=pt.get(Je._end))!=null;)for(var Hn=Qt+1;Hn<ze.length;Hn++)if(ze[Hn]._start===wn){nn.push(Je=ze[Hn]);break}for(var fa=[],Ca=0;Ca<nn.length;Ca++)for(var Ma=nn[Ca],Ii=Ma._start;Ii<=Ma._end;Ii++)fa.push(Ii);for(var pi=Oe[fa[0]],Le=st.level,_t=fa[0]-1;_t>=0;_t--)if(!(De[_t]&m)){Le=Oe[_t];break}var kt=fa[fa.length-1],Tt=Oe[kt],Ot=st.level;if(!(De[kt]&c)){for(var ln=kt+1;ln<=st.end;ln++)if(!(De[ln]&m)){Ot=Oe[ln];break}}Mt.push({_seqIndices:fa,_sosType:Math.max(Le,pi)%2?ee:X,_eosType:Math.max(Ot,Tt)%2?ee:X})}}for(var Tn=0;Tn<Mt.length;Tn++){var qn=Mt[Tn],an=qn._seqIndices,sa=qn._sosType,pa=qn._eosType,ia=Oe[an[0]]&1?ee:X;if(ce.get(ue))for(var ni=0;ni<an.length;ni++){var _r=an[ni];if(De[_r]&ue){for(var ei=sa,Xi=ni-1;Xi>=0;Xi--)if(!(De[an[Xi]]&m)){ei=De[an[Xi]];break}te(_r,ei&(c|Lt)?Re:ei)}}if(ce.get(V))for(var ta=0;ta<an.length;ta++){var Rn=an[ta];if(De[Rn]&V)for(var lo=ta-1;lo>=-1;lo--){var Ra=lo===-1?sa:De[an[lo]];if(Ra&d){Ra===ye&&te(Rn,pe);break}}}if(ce.get(ye))for(var Ei=0;Ei<an.length;Ei++){var Uo=an[Ei];De[Uo]&ye&&te(Uo,ee)}if(ce.get(Q)||ce.get(be))for(var br=1;br<an.length-1;br++){var Zi=an[br];if(De[Zi]&(Q|be)){for(var ci=0,Dr=0,Cn=br-1;Cn>=0&&(ci=De[an[Cn]],!!(ci&m));Cn--);for(var Yn=br+1;Yn<an.length&&(Dr=De[an[Yn]],!!(Dr&m));Yn++);ci===Dr&&(De[Zi]===Q?ci===V:ci&(V|pe))&&te(Zi,ci)}}if(ce.get(V))for(var Vi=0;Vi<an.length;Vi++){var xr=an[Vi];if(De[xr]&V){for(var Ss=Vi-1;Ss>=0&&De[an[Ss]]&(me|m);Ss--)te(an[Ss],V);for(Vi++;Vi<an.length&&De[an[Vi]]&(me|m|V);Vi++)De[an[Vi]]!==V&&te(an[Vi],V)}}if(ce.get(me)||ce.get(Q)||ce.get(be))for(var yu=0;yu<an.length;yu++){var Ip=an[yu];if(De[Ip]&(me|Q|be)){te(Ip,Re);for(var Jl=yu-1;Jl>=0&&De[an[Jl]]&m;Jl--)te(an[Jl],Re);for(var Sl=yu+1;Sl<an.length&&De[an[Sl]]&m;Sl++)te(an[Sl],Re)}}if(ce.get(V))for(var Al=0,El=sa;Al<an.length;Al++){var xd=an[Al],Gh=De[xd];Gh&V?El===X&&te(xd,X):Gh&d&&(El=Gh)}if(ce.get(f)){var Ql=ee|V|pe,wd=Ql|X,$s=[];{for(var Ht=[],vn=0;vn<an.length;vn++)if(De[an[vn]]&f){var Bn=oe[an[vn]],tt=void 0;if(B(Bn)!==null)if(Ht.length<63)Ht.push({char:Bn,seqIndex:vn});else break;else if((tt=G(Bn))!==null)for(var sn=Ht.length-1;sn>=0;sn--){var qs=Ht[sn].char;if(qs===tt||qs===G(q(Bn))||B(q(qs))===Bn){$s.push([Ht[sn].seqIndex,vn]),Ht.length=sn;break}}}$s.sort(function(zr,Mi){return zr[0]-Mi[0]})}for(var As=0;As<$s.length;As++){for(var Bi=$s[As],ai=Bi[0],Sd=Bi[1],Es=!1,xo=0,Lp=ai+1;Lp<Sd;Lp++){var Xs=an[Lp];if(De[Xs]&wd){Es=!0;var tn=De[Xs]&Ql?ee:X;if(tn===ia){xo=tn;break}}}if(Es&&!xo){xo=sa;for(var ma=ai-1;ma>=0;ma--){var xa=an[ma];if(De[xa]&wd){var Yi=De[xa]&Ql?ee:X;Yi!==ia?xo=Yi:xo=ia;break}}}if(xo){if(De[an[ai]]=De[an[Sd]]=xo,xo!==ia){for(var Or=ai+1;Or<an.length;Or++)if(!(De[an[Or]]&m)){A(oe[an[Or]])&ue&&(De[an[Or]]=xo);break}}if(xo!==ia){for(var na=Sd+1;na<an.length;na++)if(!(De[an[na]]&m)){A(oe[an[na]])&ue&&(De[an[na]]=xo);break}}}}for(var Wo=0;Wo<an.length;Wo++)if(De[an[Wo]]&f){for(var Cc=Wo,Pc=Wo,Li=sa,ui=Wo-1;ui>=0;ui--)if(De[an[ui]]&m)Cc=ui;else{Li=De[an[ui]]&Ql?ee:X;break}for(var Ad=pa,Ml=Wo+1;Ml<an.length;Ml++)if(De[an[Ml]]&(f|m))Pc=Ml;else{Ad=De[an[Ml]]&Ql?ee:X;break}for(var wo=Cc;wo<=Pc;wo++)De[an[wo]]=Li===Ad?Li:ia;Wo=Pc}}}for(var dr=st.start;dr<=st.end;dr++){var vu=Oe[dr],Zs=De[dr];if(vu&1?Zs&(X|V|pe)&&Oe[dr]++:Zs&ee?Oe[dr]++:Zs&(pe|V)&&(Oe[dr]+=2),Zs&m&&(Oe[dr]=dr===0?st.level:Oe[dr-1]),dr===st.end||A(oe[dr])&(Ce|fe))for(var Tl=dr;Tl>=0&&A(oe[Tl])&y;Tl--)Oe[Tl]=st.level}}return{levels:Oe,paragraphs:it};function _u(zr,Mi){for(var xn=zr;xn<oe.length;xn++){var tr=De[xn];if(tr&(ee|ye))return 1;if(tr&(fe|X)||Mi&&tr===Lt)return 0;if(tr&c){var Vo=Ed(xn);xn=Vo===-1?oe.length:Vo}}return 0}function Ed(zr){for(var Mi=1,xn=zr+1;xn<oe.length;xn++){var tr=De[xn];if(tr&fe)break;if(tr&Lt){if(--Mi===0)return xn}else tr&c&&Mi++}return-1}}var Jt="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Pt;function Pe(){if(!Pt){var oe=k(Jt,!0),ve=oe.map,$e=oe.reverseMap;$e.forEach(function(De,ot){ve.set(ot,De)}),Pt=ve}}function ft(oe){return Pe(),Pt.get(oe)||null}function gt(oe,ve,$e,De){var ot=oe.length;$e=Math.max(0,$e==null?0:+$e),De=Math.min(ot-1,De==null?ot-1:+De);for(var ce=new Map,te=$e;te<=De;te++)if(ve[te]&1){var Oe=ft(oe[te]);Oe!==null&&ce.set(te,Oe)}return ce}function St(oe,ve,$e,De){var ot=oe.length;$e=Math.max(0,$e==null?0:+$e),De=Math.min(ot-1,De==null?ot-1:+De);var ce=[];return ve.paragraphs.forEach(function(te){var Oe=Math.max($e,te.start),pt=Math.min(De,te.end);if(Oe<pt){for(var it=ve.levels.slice(Oe,pt+1),st=pt;st>=Oe&&A(oe[st])&y;st--)it[st]=te.level;for(var At=te.level,Ut=1/0,Vt=0;Vt<it.length;Vt++){var $t=it[Vt];$t>At&&(At=$t),$t<Ut&&(Ut=$t|1)}for(var Ft=At;Ft>=Ut;Ft--)for(var wt=0;wt<it.length;wt++)if(it[wt]>=Ft){for(var Yt=wt;wt+1<it.length&&it[wt+1]>=Ft;)wt++;wt>Yt&&ce.push([Yt+Oe,wt+Oe])}}}),ce}function Be(oe,ve,$e,De){var ot=le(oe,ve,$e,De),ce=[].concat(oe);return ot.forEach(function(te,Oe){ce[Oe]=(ve.levels[te]&1?ft(oe[te]):null)||oe[te]}),ce.join("")}function le(oe,ve,$e,De){for(var ot=St(oe,ve,$e,De),ce=[],te=0;te<oe.length;te++)ce[te]=te;return ot.forEach(function(Oe){for(var pt=Oe[0],it=Oe[1],st=ce.slice(pt,it+1),At=st.length;At--;)ce[it-At]=st[At]}),ce}return e.closingToOpeningBracket=G,e.getBidiCharType=A,e.getBidiCharTypeName=C,e.getCanonicalBracket=q,e.getEmbeddingLevels=Rt,e.getMirroredCharacter=ft,e.getMirroredCharactersMap=gt,e.getReorderSegments=St,e.getReorderedIndices=le,e.getReorderedString=Be,e.openingToClosingBracket=B,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const CK=/\bvoid\s+main\s*\(\s*\)\s*{/g;function LR(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function a(o,s){let c=Oa[s];return c?LR(c):o}return n.replace(e,a)}const $o=[];for(let n=0;n<256;n++)$o[n]=(n<16?"0":"")+n.toString(16);function uAe(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return($o[n&255]+$o[n>>8&255]+$o[n>>16&255]+$o[n>>24&255]+"-"+$o[e&255]+$o[e>>8&255]+"-"+$o[e>>16&15|64]+$o[e>>24&255]+"-"+$o[a&63|128]+$o[a>>8&255]+"-"+$o[a>>16&255]+$o[a>>24&255]+$o[o&255]+$o[o>>8&255]+$o[o>>16&255]+$o[o>>24&255]).toUpperCase()}const Um=Object.assign||function(){let n=arguments[0];for(let e=1,a=arguments.length;e<a;e++){let o=arguments[e];if(o)for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n},dAe=Date.now(),JV=new WeakMap,QV=new Map;let hAe=1e10;function RR(n,e){const a=gAe(e);let o=JV.get(n);if(o||JV.set(n,o=Object.create(null)),o[a])return new o[a];const s=`_onBeforeCompile${a}`,c=function(y,_){n.onBeforeCompile.call(this,y,_);const w=this.customProgramCacheKey()+"|"+y.vertexShader+"|"+y.fragmentShader;let A=QV[w];if(!A){const C=fAe(this,y,e,a);A=QV[w]=C}y.vertexShader=A.vertexShader,y.fragmentShader=A.fragmentShader,Um(y.uniforms,this.uniforms),e.timeUniform&&(y.uniforms[e.timeUniform]={get value(){return Date.now()-dAe}}),this[s]&&this[s](y)},d=function(){return f(e.chained?n:n.clone())},f=function(y){const _=Object.create(y,m);return Object.defineProperty(_,"baseMaterial",{value:n}),Object.defineProperty(_,"id",{value:hAe++}),_.uuid=uAe(),_.uniforms=Um({},y.uniforms,e.uniforms),_.defines=Um({},y.defines,e.defines),_.defines[`TROIKA_DERIVED_MATERIAL_${a}`]="",_.extensions=Um({},y.extensions,e.extensions),_._listeners=void 0,_},m={constructor:{value:d},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+a}},onBeforeCompile:{get(){return c},set(y){this[s]=y}},copy:{writable:!0,configurable:!0,value:function(y){return n.copy.call(this,y),!n.isShaderMaterial&&!n.isDerivedMaterial&&(Um(this.extensions,y.extensions),Um(this.defines,y.defines),Um(this.uniforms,HD.clone(y.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const y=new n.constructor;return f(y).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let y=this._depthMaterial;return y||(y=this._depthMaterial=RR(n.isDerivedMaterial?n.getDepthMaterial():new ET({depthPacking:ND}),e),y.defines.IS_DEPTH_MATERIAL="",y.uniforms=this.uniforms),y}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let y=this._distanceMaterial;return y||(y=this._distanceMaterial=RR(n.isDerivedMaterial?n.getDistanceMaterial():new MT,e),y.defines.IS_DISTANCE_MATERIAL="",y.uniforms=this.uniforms),y}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:y,_distanceMaterial:_}=this;y&&y.dispose(),_&&_.dispose(),n.dispose.call(this)}}};return o[a]=d,new d}function fAe(n,{vertexShader:e,fragmentShader:a},o,s){let{vertexDefs:c,vertexMainIntro:d,vertexMainOutro:f,vertexTransform:m,fragmentDefs:y,fragmentMainIntro:_,fragmentMainOutro:w,fragmentColorTransform:A,customRewriter:C,timeUniform:I}=o;if(c=c||"",d=d||"",f=f||"",y=y||"",_=_||"",w=w||"",(m||C)&&(e=LR(e)),(A||C)&&(a=a.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),a=LR(a)),C){let k=C({vertexShader:e,fragmentShader:a});e=k.vertexShader,a=k.fragmentShader}if(A){let k=[];a=a.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,D=>(k.push(D),"")),w=`${A}
${k.join(`
`)}
${w}`}if(I){const k=`
uniform float ${I};
`;c=k+c,y=k+y}return m&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,c=`${c}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${m}
}
`,d=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${d}
`,e=e.replace(/\b(position|normal|uv)\b/g,(k,D,L,O)=>/\battribute\s+vec[23]\s+$/.test(O.substr(0,L))?D:`troika_${D}_${s}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=eG(e,s,c,d,f),a=eG(a,s,y,_,w),{vertexShader:e,fragmentShader:a}}function eG(n,e,a,o,s){return(o||s||a)&&(n=n.replace(CK,`
${a}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${o}
  troikaOrigMain${e}();
  ${s}
}`),n}function pAe(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let mAe=0;const tG=new Map;function gAe(n){const e=JSON.stringify(n,pAe);let a=tG.get(e);return a==null&&tG.set(e,a=++mAe),a}function yAe(n,e,a){const{defaultFontURL:o}=a,s=Object.create(null),c=1/0,d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,f="[^\\S\\u00A0]",m=new RegExp(`${f}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function y(O,F){function B(){const G=q=>{console.error(`Failure loading font ${O}${O===o?"":"; trying fallback"}`,q),O!==o&&(O=o,B())};try{const q=new XMLHttpRequest;q.open("get",O,!0),q.responseType="arraybuffer",q.onload=function(){if(q.status>=400)G(new Error(q.statusText));else if(q.status>0)try{const X=n(q.response);F(X)}catch(X){G(X)}},q.onerror=G,q.send()}catch(q){G(q)}}B()}function _(O,F){O||(O=o);let B=s[O];B?B.pending?B.pending.push(F):F(B):(s[O]={pending:[F]},y(O,G=>{let q=s[O].pending;s[O]=G,q.forEach(X=>X(G))}))}function w({text:O="",font:F=o,sdfGlyphSize:B=64,fontSize:G=1,letterSpacing:q=0,lineHeight:X="normal",maxWidth:ee=c,direction:V,textAlign:Q="left",textIndent:me=0,whiteSpace:pe="normal",overflowWrap:be="normal",anchorX:fe=0,anchorY:Ce=0,includeCaretPositions:Re=!1,chunkedBoundsSize:He=8192,colorRanges:ue=null},ye,Ae=!1){const ne=k(),Ee={fontLoad:0,typesetting:0};O.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),O=O.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),G=+G,q=+q,ee=+ee,X=X||"normal",me=+me,_(F,Ye=>{const Xe=isFinite(ee);let Ke=null,Ue=null,ht=null,Lt=null,Rt=null,Jt=null,Pt=null,Pe=0,ft=0,gt=pe!=="nowrap";const{ascender:St,descender:Be,unitsPerEm:le,lineGap:oe,capHeight:ve,xHeight:$e}=Ye;Ee.fontLoad=k()-ne;const De=k(),ot=G/le;X==="normal"&&(X=(St-Be+oe)/le),X=X*G;const ce=(X-(St-Be)*ot)/2,te=-(St*ot+ce),Oe=Math.min(X,(St-Be)*ot),pt=(St+Be)/2*ot-Oe/2;let it=me,st=new D;const At=[st];Ye.forEachGlyph(O,G,q,($t,Ft,wt)=>{const Yt=O.charAt(wt),Ge=$t.advanceWidth*ot,It=st.count;let qt;if("isEmpty"in $t||($t.isWhitespace=!!Yt&&new RegExp(f).test(Yt),$t.canBreakAfter=!!Yt&&m.test(Yt),$t.isEmpty=$t.xMin===$t.xMax||$t.yMin===$t.yMax||d.test(Yt)),!$t.isWhitespace&&!$t.isEmpty&&ft++,gt&&Xe&&!$t.isWhitespace&&Ft+Ge+it>ee&&It){if(st.glyphAt(It-1).glyphObj.canBreakAfter)qt=new D,it=-Ft;else for(let fn=It;fn--;)if(fn===0&&be==="break-word"){qt=new D,it=-Ft;break}else if(st.glyphAt(fn).glyphObj.canBreakAfter){qt=st.splitAt(fn+1);const _e=qt.glyphAt(0).x;it-=_e;for(let Ze=qt.count;Ze--;)qt.glyphAt(Ze).x-=_e;break}qt&&(st.isSoftWrapped=!0,st=qt,At.push(st),Pe=ee)}let Dt=st.glyphAt(st.count);Dt.glyphObj=$t,Dt.x=Ft+it,Dt.width=Ge,Dt.charIndex=wt,Yt===`
`&&(st=new D,At.push(st),it=-(Ft+Ge+q*G)+me)}),At.forEach($t=>{for(let Ft=$t.count;Ft--;){let{glyphObj:wt,x:Yt,width:Ge}=$t.glyphAt(Ft);if(!wt.isWhitespace){$t.width=Yt+Ge,$t.width>Pe&&(Pe=$t.width);return}}});let Ut=0,Vt=0;if(fe&&(typeof fe=="number"?Ut=-fe:typeof fe=="string"&&(Ut=-Pe*(fe==="left"?0:fe==="center"?.5:fe==="right"?1:C(fe)))),Ce){if(typeof Ce=="number")Vt=-Ce;else if(typeof Ce=="string"){let $t=At.length*X;Vt=Ce==="top"?0:Ce==="top-baseline"?-te:Ce==="top-cap"?-te-ve*ot:Ce==="top-ex"?-te-$e*ot:Ce==="middle"?$t/2:Ce==="bottom"?$t:Ce==="bottom-baseline"?$t-ce+Be*ot:C(Ce)*$t}}if(!Ae){const $t=e.getEmbeddingLevels(O,V);Ke=new Uint16Array(ft),Ue=new Float32Array(ft*2),ht={},Jt=[c,c,-c,-c],Pt=[];let Ft=te;Re&&(Rt=new Float32Array(O.length*3)),ue&&(Lt=new Uint8Array(ft*3));let wt=0,Yt=-1,Ge=-1,It,qt;if(At.forEach((Dt,fn)=>{let{count:_e,width:Ze}=Dt;if(_e>0){let Se=0;for(let ut=_e;ut--&&Dt.glyphAt(ut).glyphObj.isWhitespace;)Se++;let Me=0,ze=0;if(Q==="center")Me=(Pe-Ze)/2;else if(Q==="right")Me=Pe-Ze;else if(Q==="justify"&&Dt.isSoftWrapped){let ut=0;for(let ct=_e-Se;ct--;)Dt.glyphAt(ct).glyphObj.isWhitespace&&ut++;ze=(Pe-Ze)/ut}if(ze||Me){let ut=0;for(let ct=0;ct<_e;ct++){let Gt=Dt.glyphAt(ct);const Mt=Gt.glyphObj;Gt.x+=Me+ut,ze!==0&&Mt.isWhitespace&&ct<_e-Se&&(ut+=ze,Gt.width+=ze)}}const Je=e.getReorderSegments(O,$t,Dt.glyphAt(0).charIndex,Dt.glyphAt(Dt.count-1).charIndex);for(let ut=0;ut<Je.length;ut++){const[ct,Gt]=Je[ut];let Mt=1/0,Qt=-1/0;for(let mn=0;mn<_e;mn++)if(Dt.glyphAt(mn).charIndex>=ct){let nn=mn,wn=mn;for(;wn<_e;wn++){let Hn=Dt.glyphAt(wn);if(Hn.charIndex>Gt)break;wn<_e-Se&&(Mt=Math.min(Mt,Hn.x),Qt=Math.max(Qt,Hn.x+Hn.width))}for(let Hn=nn;Hn<wn;Hn++){const fa=Dt.glyphAt(Hn);fa.x=Qt-(fa.x+fa.width-Mt)}break}}let et;const yt=ut=>et=ut;for(let ut=0;ut<_e;ut++){let ct=Dt.glyphAt(ut);et=ct.glyphObj;const Gt=et.index,Mt=$t.levels[ct.charIndex]&1;if(Mt){const Qt=e.getMirroredCharacter(O[ct.charIndex]);Qt&&Ye.forEachGlyph(Qt,0,0,yt)}if(Re){const{charIndex:Qt}=ct,mn=ct.x+Ut,nn=ct.x+ct.width+Ut;Rt[Qt*3]=Mt?nn:mn,Rt[Qt*3+1]=Mt?mn:nn,Rt[Qt*3+2]=Ft+pt+Vt;const wn=Qt-Yt;wn>1&&I(Rt,Yt,wn),Yt=Qt}if(ue){const{charIndex:Qt}=ct;for(;Qt>Ge;)Ge++,ue.hasOwnProperty(Ge)&&(qt=ue[Ge])}if(!et.isWhitespace&&!et.isEmpty){const Qt=wt++;ht[Gt]||(ht[Gt]={path:et.path,pathBounds:[et.xMin,et.yMin,et.xMax,et.yMax]});const mn=ct.x+Ut,nn=Ft+Vt;Ue[Qt*2]=mn,Ue[Qt*2+1]=nn;const wn=mn+et.xMin*ot,Hn=nn+et.yMin*ot,fa=mn+et.xMax*ot,Ca=nn+et.yMax*ot;wn<Jt[0]&&(Jt[0]=wn),Hn<Jt[1]&&(Jt[1]=Hn),fa>Jt[2]&&(Jt[2]=fa),Ca>Jt[3]&&(Jt[3]=Ca),Qt%He===0&&(It={start:Qt,end:Qt,rect:[c,c,-c,-c]},Pt.push(It)),It.end++;const Ma=It.rect;if(wn<Ma[0]&&(Ma[0]=wn),Hn<Ma[1]&&(Ma[1]=Hn),fa>Ma[2]&&(Ma[2]=fa),Ca>Ma[3]&&(Ma[3]=Ca),Ke[Qt]=Gt,ue){const Ii=Qt*3;Lt[Ii]=qt>>16&255,Lt[Ii+1]=qt>>8&255,Lt[Ii+2]=qt&255}}}}Ft-=X}),Rt){const Dt=O.length-Yt;Dt>1&&I(Rt,Yt,Dt)}}Ee.typesetting=k()-De,ye({glyphIds:Ke,glyphPositions:Ue,glyphData:ht,caretPositions:Rt,caretHeight:Oe,glyphColors:Lt,chunkedBounds:Pt,fontSize:G,unitsPerEm:le,ascender:St*ot,descender:Be*ot,capHeight:ve*ot,xHeight:$e*ot,lineHeight:X,topBaseline:te,blockBounds:[Ut,Vt-At.length*X,Ut+Pe,Vt],visibleBounds:Jt,timings:Ee})})}function A(O,F){w(O,B=>{const[G,q,X,ee]=B.blockBounds;F({width:X-G,height:ee-q})},{metricsOnly:!0})}function C(O){let F=O.match(/^([\d.]+)%$/),B=F?parseFloat(F[1]):NaN;return isNaN(B)?0:B/100}function I(O,F,B){const G=O[F*3],q=O[F*3+1],X=O[F*3+2],ee=(q-G)/B;for(let V=0;V<B;V++){const Q=(F+V)*3;O[Q]=G+ee*V,O[Q+1]=G+ee*(V+1),O[Q+2]=X}}function k(){return(self.performance||Date).now()}function D(){this.data=[]}const L=["glyphObj","x","width","charIndex"];return D.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/L.length)},glyphAt(O){let F=D.flyweight;return F.data=this.data,F.index=O,F},splitAt(O){let F=new D;return F.data=this.data.splice(O*L.length),F}},D.flyweight=L.reduce((O,F,B,G)=>(Object.defineProperty(O,F,{get(){return this.data[this.index*L.length+B]},set(q){this.data[this.index*L.length+B]=q}}),O),{data:null,index:0}),{typeset:w,measure:A,loadFont:_}}const xg=()=>(self.performance||Date).now(),KT=TK();let nG;function vAe(n,e,a,o,s,c,d,f,m,y,_=!0){return _?bAe(n,e,a,o,s,c,d,f,m,y).then(null,w=>(nG||(console.warn("WebGL SDF generation failed, falling back to JS",w),nG=!0),iG(n,e,a,o,s,c,d,f,m,y))):iG(n,e,a,o,s,c,d,f,m,y)}const jA=[],_Ae=5;let kR=0;function PK(){const n=xg();for(;jA.length&&xg()-n<_Ae;)jA.shift()();kR=jA.length?setTimeout(PK,0):0}const bAe=(...n)=>new Promise((e,a)=>{jA.push(()=>{const o=xg();try{KT.webgl.generateIntoCanvas(...n),e({timing:xg()-o})}catch(s){a(s)}}),kR||(kR=setTimeout(PK,0))}),xAe=4,wAe=2e3,aG={};let SAe=0;function iG(n,e,a,o,s,c,d,f,m,y){const _="TroikaTextSDFGenerator_JS_"+SAe++%xAe;let w=aG[_];return w||(w=aG[_]={workerModule:Nw({name:_,workerId:_,dependencies:[TK,xg],init(A,C){const I=A().javascript.generate;return function(...k){const D=C();return{textureData:I(...k),timing:C()-D}}},getTransferables(A){return[A.textureData.buffer]}}),requests:0,idleTimer:null}),w.requests++,clearTimeout(w.idleTimer),w.workerModule(n,e,a,o,s,c).then(({textureData:A,timing:C})=>{const I=xg(),k=new Uint8Array(A.length*4);for(let D=0;D<A.length;D++)k[D*4+y]=A[D];return KT.webglUtils.renderImageData(d,k,f,m,n,e,1<<3-y),C+=xg()-I,--w.requests===0&&(w.idleTimer=setTimeout(()=>{sAe(_)},wAe)),{timing:C}})}function AAe(n){n._warm||(KT.webgl.isSupported(n),n._warm=!0)}const EAe=KT.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function MAe(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(s){var c=e._bin,d=new Uint8Array(s);if(c.readASCII(d,0,4)=="ttcf"){var f=4;c.readUshort(d,f),f+=2,c.readUshort(d,f),f+=2;var m=c.readUint(d,f);f+=4;for(var y=[],_=0;_<m;_++){var w=c.readUint(d,f);f+=4,y.push(e._readFont(d,w))}return y}return[e._readFont(d,0)]},_readFont:function(s,c){var d=e._bin,f=c;d.readFixed(s,c),c+=4;var m=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2;for(var y=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],_={_data:s,_offset:f},w={},A=0;A<m;A++){var C=d.readASCII(s,c,4);c+=4,d.readUint(s,c),c+=4;var I=d.readUint(s,c);c+=4;var k=d.readUint(s,c);c+=4,w[C]={offset:I,length:k}}for(A=0;A<y.length;A++){var D=y[A];w[D]&&(_[D.trim()]=e[D.trim()].parse(s,w[D].offset,w[D].length,_))}return _},_tabOffset:function(s,c,d){for(var f=e._bin,m=f.readUshort(s,d+4),y=d+12,_=0;_<m;_++){var w=f.readASCII(s,y,4);y+=4,f.readUint(s,y),y+=4;var A=f.readUint(s,y);if(y+=4,f.readUint(s,y),y+=4,w==c)return A}return 0}};e._bin={readFixed:function(s,c){return(s[c]<<8|s[c+1])+(s[c+2]<<8|s[c+3])/65540},readF2dot14:function(s,c){return e._bin.readShort(s,c)/16384},readInt:function(s,c){return e._bin._view(s).getInt32(c)},readInt8:function(s,c){return e._bin._view(s).getInt8(c)},readShort:function(s,c){return e._bin._view(s).getInt16(c)},readUshort:function(s,c){return e._bin._view(s).getUint16(c)},readUshorts:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(e._bin.readUshort(s,c+2*m));return f},readUint:function(s,c){return e._bin._view(s).getUint32(c)},readUint64:function(s,c){return 4294967296*e._bin.readUint(s,c)+e._bin.readUint(s,c+4)},readASCII:function(s,c,d){for(var f="",m=0;m<d;m++)f+=String.fromCharCode(s[c+m]);return f},readUnicode:function(s,c,d){for(var f="",m=0;m<d;m++){var y=s[c++]<<8|s[c++];f+=String.fromCharCode(y)}return f},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,c,d){var f=e._bin._tdec;return f&&c==0&&d==s.length?f.decode(s):e._bin.readASCII(s,c,d)},readBytes:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(s[c+m]);return f},readASCIIArray:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(String.fromCharCode(s[c+m]));return f},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,c,d,f,m){var y=e._bin,_={},w=c;y.readFixed(s,c),c+=4;var A=y.readUshort(s,c);c+=2;var C=y.readUshort(s,c);c+=2;var I=y.readUshort(s,c);return c+=2,_.scriptList=e._lctf.readScriptList(s,w+A),_.featureList=e._lctf.readFeatureList(s,w+C),_.lookupList=e._lctf.readLookupList(s,w+I,m),_},e._lctf.readLookupList=function(s,c,d){var f=e._bin,m=c,y=[],_=f.readUshort(s,c);c+=2;for(var w=0;w<_;w++){var A=f.readUshort(s,c);c+=2;var C=e._lctf.readLookupTable(s,m+A,d);y.push(C)}return y},e._lctf.readLookupTable=function(s,c,d){var f=e._bin,m=c,y={tabs:[]};y.ltype=f.readUshort(s,c),c+=2,y.flag=f.readUshort(s,c),c+=2;var _=f.readUshort(s,c);c+=2;for(var w=y.ltype,A=0;A<_;A++){var C=f.readUshort(s,c);c+=2;var I=d(s,w,m+C,y);y.tabs.push(I)}return y},e._lctf.numOfOnes=function(s){for(var c=0,d=0;d<32;d++)s>>>d&1&&c++;return c},e._lctf.readClassDef=function(s,c){var d=e._bin,f=[],m=d.readUshort(s,c);if(c+=2,m==1){var y=d.readUshort(s,c);c+=2;var _=d.readUshort(s,c);c+=2;for(var w=0;w<_;w++)f.push(y+w),f.push(y+w),f.push(d.readUshort(s,c)),c+=2}if(m==2){var A=d.readUshort(s,c);for(c+=2,w=0;w<A;w++)f.push(d.readUshort(s,c)),c+=2,f.push(d.readUshort(s,c)),c+=2,f.push(d.readUshort(s,c)),c+=2}return f},e._lctf.getInterval=function(s,c){for(var d=0;d<s.length;d+=3){var f=s[d],m=s[d+1];if(s[d+2],f<=c&&c<=m)return d}return-1},e._lctf.readCoverage=function(s,c){var d=e._bin,f={};f.fmt=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);return c+=2,f.fmt==1&&(f.tab=d.readUshorts(s,c,m)),f.fmt==2&&(f.tab=d.readUshorts(s,c,3*m)),f},e._lctf.coverageIndex=function(s,c){var d=s.tab;if(s.fmt==1)return d.indexOf(c);if(s.fmt==2){var f=e._lctf.getInterval(d,c);if(f!=-1)return d[f+2]+(c-d[f])}return-1},e._lctf.readFeatureList=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var w=d.readASCII(s,c,4);c+=4;var A=d.readUshort(s,c);c+=2;var C=e._lctf.readFeatureTable(s,f+A);C.tag=w.trim(),m.push(C)}return m},e._lctf.readFeatureTable=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2,y>0&&(m.featureParams=f+y);var _=d.readUshort(s,c);c+=2,m.tab=[];for(var w=0;w<_;w++)m.tab.push(d.readUshort(s,c+2*w));return m},e._lctf.readScriptList=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var w=d.readASCII(s,c,4);c+=4;var A=d.readUshort(s,c);c+=2,m[w.trim()]=e._lctf.readScriptTable(s,f+A)}return m},e._lctf.readScriptTable=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2,m.default=e._lctf.readLangSysTable(s,f+y);var _=d.readUshort(s,c);c+=2;for(var w=0;w<_;w++){var A=d.readASCII(s,c,4);c+=4;var C=d.readUshort(s,c);c+=2,m[A.trim()]=e._lctf.readLangSysTable(s,f+C)}return m},e._lctf.readLangSysTable=function(s,c){var d=e._bin,f={};d.readUshort(s,c),c+=2,f.reqFeature=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);return c+=2,f.features=d.readUshorts(s,c,m),f},e.CFF={},e.CFF.parse=function(s,c,d){var f=e._bin;(s=new Uint8Array(s.buffer,c,d))[c=0],s[++c],s[++c],s[++c],c++;var m=[];c=e.CFF.readIndex(s,c,m);for(var y=[],_=0;_<m.length-1;_++)y.push(f.readASCII(s,c+m[_],m[_+1]-m[_]));c+=m[m.length-1];var w=[];c=e.CFF.readIndex(s,c,w);var A=[];for(_=0;_<w.length-1;_++)A.push(e.CFF.readDict(s,c+w[_],c+w[_+1]));c+=w[w.length-1];var C=A[0],I=[];c=e.CFF.readIndex(s,c,I);var k=[];for(_=0;_<I.length-1;_++)k.push(f.readASCII(s,c+I[_],I[_+1]-I[_]));if(c+=I[I.length-1],e.CFF.readSubrs(s,c,C),C.CharStrings){c=C.CharStrings,I=[],c=e.CFF.readIndex(s,c,I);var D=[];for(_=0;_<I.length-1;_++)D.push(f.readBytes(s,c+I[_],I[_+1]-I[_]));C.CharStrings=D}if(C.ROS){c=C.FDArray;var L=[];for(c=e.CFF.readIndex(s,c,L),C.FDArray=[],_=0;_<L.length-1;_++){var O=e.CFF.readDict(s,c+L[_],c+L[_+1]);e.CFF._readFDict(s,O,k),C.FDArray.push(O)}c+=L[L.length-1],c=C.FDSelect,C.FDSelect=[];var F=s[c];if(c++,F!=3)throw F;var B=f.readUshort(s,c);for(c+=2,_=0;_<B+1;_++)C.FDSelect.push(f.readUshort(s,c),s[c+2]),c+=3}return C.Encoding&&(C.Encoding=e.CFF.readEncoding(s,C.Encoding,C.CharStrings.length)),C.charset&&(C.charset=e.CFF.readCharset(s,C.charset,C.CharStrings.length)),e.CFF._readFDict(s,C,k),C},e.CFF._readFDict=function(s,c,d){var f;for(var m in c.Private&&(f=c.Private[1],c.Private=e.CFF.readDict(s,f,f+c.Private[0]),c.Private.Subrs&&e.CFF.readSubrs(s,f+c.Private.Subrs,c.Private)),c)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(m)!=-1&&(c[m]=d[c[m]-426+35])},e.CFF.readSubrs=function(s,c,d){var f=e._bin,m=[];c=e.CFF.readIndex(s,c,m);var y,_=m.length;y=_<1240?107:_<33900?1131:32768,d.Bias=y,d.Subrs=[];for(var w=0;w<m.length-1;w++)d.Subrs.push(f.readBytes(s,c+m[w],m[w+1]-m[w]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,c){for(var d=0;d<s.charset.length;d++)if(s.charset[d]==c)return d;return-1},e.CFF.glyphBySE=function(s,c){return c<0||c>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[c])},e.CFF.readEncoding=function(s,c,d){e._bin;var f=[".notdef"],m=s[c];if(c++,m!=0)throw"error: unknown encoding format: "+m;var y=s[c];c++;for(var _=0;_<y;_++)f.push(s[c+_]);return f},e.CFF.readCharset=function(s,c,d){var f=e._bin,m=[".notdef"],y=s[c];if(c++,y==0)for(var _=0;_<d;_++){var w=f.readUshort(s,c);c+=2,m.push(w)}else{if(y!=1&&y!=2)throw"error: format: "+y;for(;m.length<d;){w=f.readUshort(s,c),c+=2;var A=0;for(y==1?(A=s[c],c++):(A=f.readUshort(s,c),c+=2),_=0;_<=A;_++)m.push(w),w++}}return m},e.CFF.readIndex=function(s,c,d){var f=e._bin,m=f.readUshort(s,c)+1,y=s[c+=2];if(c++,y==1)for(var _=0;_<m;_++)d.push(s[c+_]);else if(y==2)for(_=0;_<m;_++)d.push(f.readUshort(s,c+2*_));else if(y==3)for(_=0;_<m;_++)d.push(16777215&f.readUint(s,c+3*_-1));else if(m!=1)throw"unsupported offset size: "+y+", count: "+m;return(c+=m*y)-1},e.CFF.getCharString=function(s,c,d){var f=e._bin,m=s[c],y=s[c+1];s[c+2],s[c+3],s[c+4];var _=1,w=null,A=null;m<=20&&(w=m,_=1),m==12&&(w=100*m+y,_=2),21<=m&&m<=27&&(w=m,_=1),m==28&&(A=f.readShort(s,c+1),_=3),29<=m&&m<=31&&(w=m,_=1),32<=m&&m<=246&&(A=m-139,_=1),247<=m&&m<=250&&(A=256*(m-247)+y+108,_=2),251<=m&&m<=254&&(A=256*-(m-251)-y-108,_=2),m==255&&(A=f.readInt(s,c+1)/65535,_=5),d.val=A??"o"+w,d.size=_},e.CFF.readCharString=function(s,c,d){for(var f=c+d,m=e._bin,y=[];c<f;){var _=s[c],w=s[c+1];s[c+2],s[c+3],s[c+4];var A=1,C=null,I=null;_<=20&&(C=_,A=1),_==12&&(C=100*_+w,A=2),_!=19&&_!=20||(C=_,A=2),21<=_&&_<=27&&(C=_,A=1),_==28&&(I=m.readShort(s,c+1),A=3),29<=_&&_<=31&&(C=_,A=1),32<=_&&_<=246&&(I=_-139,A=1),247<=_&&_<=250&&(I=256*(_-247)+w+108,A=2),251<=_&&_<=254&&(I=256*-(_-251)-w-108,A=2),_==255&&(I=m.readInt(s,c+1)/65535,A=5),y.push(I??"o"+C),c+=A}return y},e.CFF.readDict=function(s,c,d){for(var f=e._bin,m={},y=[];c<d;){var _=s[c],w=s[c+1];s[c+2],s[c+3],s[c+4];var A=1,C=null,I=null;if(_==28&&(I=f.readShort(s,c+1),A=3),_==29&&(I=f.readInt(s,c+1),A=5),32<=_&&_<=246&&(I=_-139,A=1),247<=_&&_<=250&&(I=256*(_-247)+w+108,A=2),251<=_&&_<=254&&(I=256*-(_-251)-w-108,A=2),_==255)throw I=f.readInt(s,c+1)/65535,A=5,"unknown number";if(_==30){var k=[];for(A=1;;){var D=s[c+A];A++;var L=D>>4,O=15&D;if(L!=15&&k.push(L),O!=15&&k.push(O),O==15)break}for(var F="",B=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],G=0;G<k.length;G++)F+=B[k[G]];I=parseFloat(F)}_<=21&&(C=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][_],A=1,_==12&&(C=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][w],A=2)),C!=null?(m[C]=y.length==1?y[0]:y,y=[]):y.push(I),c+=A}return m},e.cmap={},e.cmap.parse=function(s,c,d){s=new Uint8Array(s.buffer,c,d),c=0;var f=e._bin,m={};f.readUshort(s,c),c+=2;var y=f.readUshort(s,c);c+=2;var _=[];m.tables=[];for(var w=0;w<y;w++){var A=f.readUshort(s,c);c+=2;var C=f.readUshort(s,c);c+=2;var I=f.readUint(s,c);c+=4;var k="p"+A+"e"+C,D=_.indexOf(I);if(D==-1){var L;D=m.tables.length,_.push(I);var O=f.readUshort(s,I);O==0?L=e.cmap.parse0(s,I):O==4?L=e.cmap.parse4(s,I):O==6?L=e.cmap.parse6(s,I):O==12?L=e.cmap.parse12(s,I):console.debug("unknown format: "+O,A,C,I),m.tables.push(L)}if(m[k]!=null)throw"multiple tables for one platform+encoding";m[k]=D}return m},e.cmap.parse0=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2,f.map=[];for(var y=0;y<m-6;y++)f.map.push(s[c+y]);return f},e.cmap.parse4=function(s,c){var d=e._bin,f=c,m={};m.format=d.readUshort(s,c),c+=2;var y=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2;var _=d.readUshort(s,c);c+=2;var w=_/2;m.searchRange=d.readUshort(s,c),c+=2,m.entrySelector=d.readUshort(s,c),c+=2,m.rangeShift=d.readUshort(s,c),c+=2,m.endCount=d.readUshorts(s,c,w),c+=2*w,c+=2,m.startCount=d.readUshorts(s,c,w),c+=2*w,m.idDelta=[];for(var A=0;A<w;A++)m.idDelta.push(d.readShort(s,c)),c+=2;for(m.idRangeOffset=d.readUshorts(s,c,w),c+=2*w,m.glyphIdArray=[];c<f+y;)m.glyphIdArray.push(d.readUshort(s,c)),c+=2;return m},e.cmap.parse6=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,f.firstCode=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2,f.glyphIdArray=[];for(var y=0;y<m;y++)f.glyphIdArray.push(d.readUshort(s,c)),c+=2;return f},e.cmap.parse12=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2,c+=2,d.readUint(s,c),c+=4,d.readUint(s,c),c+=4;var m=d.readUint(s,c);c+=4,f.groups=[];for(var y=0;y<m;y++){var _=c+12*y,w=d.readUint(s,_+0),A=d.readUint(s,_+4),C=d.readUint(s,_+8);f.groups.push([w,A,C])}return f},e.glyf={},e.glyf.parse=function(s,c,d,f){for(var m=[],y=0;y<f.maxp.numGlyphs;y++)m.push(null);return m},e.glyf._parseGlyf=function(s,c){var d=e._bin,f=s._data,m=e._tabOffset(f,"glyf",s._offset)+s.loca[c];if(s.loca[c]==s.loca[c+1])return null;var y={};if(y.noc=d.readShort(f,m),m+=2,y.xMin=d.readShort(f,m),m+=2,y.yMin=d.readShort(f,m),m+=2,y.xMax=d.readShort(f,m),m+=2,y.yMax=d.readShort(f,m),m+=2,y.xMin>=y.xMax||y.yMin>=y.yMax)return null;if(y.noc>0){y.endPts=[];for(var _=0;_<y.noc;_++)y.endPts.push(d.readUshort(f,m)),m+=2;var w=d.readUshort(f,m);if(m+=2,f.length-m<w)return null;y.instructions=d.readBytes(f,m,w),m+=w;var A=y.endPts[y.noc-1]+1;for(y.flags=[],_=0;_<A;_++){var C=f[m];if(m++,y.flags.push(C),(8&C)!=0){var I=f[m];m++;for(var k=0;k<I;k++)y.flags.push(C),_++}}for(y.xs=[],_=0;_<A;_++){var D=(2&y.flags[_])!=0,L=(16&y.flags[_])!=0;D?(y.xs.push(L?f[m]:-f[m]),m++):L?y.xs.push(0):(y.xs.push(d.readShort(f,m)),m+=2)}for(y.ys=[],_=0;_<A;_++)D=(4&y.flags[_])!=0,L=(32&y.flags[_])!=0,D?(y.ys.push(L?f[m]:-f[m]),m++):L?y.ys.push(0):(y.ys.push(d.readShort(f,m)),m+=2);var O=0,F=0;for(_=0;_<A;_++)O+=y.xs[_],F+=y.ys[_],y.xs[_]=O,y.ys[_]=F}else{var B;y.parts=[];do{B=d.readUshort(f,m),m+=2;var G={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(y.parts.push(G),G.glyphIndex=d.readUshort(f,m),m+=2,1&B){var q=d.readShort(f,m);m+=2;var X=d.readShort(f,m);m+=2}else q=d.readInt8(f,m),m++,X=d.readInt8(f,m),m++;2&B?(G.m.tx=q,G.m.ty=X):(G.p1=q,G.p2=X),8&B?(G.m.a=G.m.d=d.readF2dot14(f,m),m+=2):64&B?(G.m.a=d.readF2dot14(f,m),m+=2,G.m.d=d.readF2dot14(f,m),m+=2):128&B&&(G.m.a=d.readF2dot14(f,m),m+=2,G.m.b=d.readF2dot14(f,m),m+=2,G.m.c=d.readF2dot14(f,m),m+=2,G.m.d=d.readF2dot14(f,m),m+=2)}while(32&B);if(256&B){var ee=d.readUshort(f,m);for(m+=2,y.instr=[],_=0;_<ee;_++)y.instr.push(f[m]),m++}}return y},e.GPOS={},e.GPOS.parse=function(s,c,d,f){return e._lctf.parse(s,c,d,f,e.GPOS.subt)},e.GPOS.subt=function(s,c,d,f){var m=e._bin,y=d,_={};if(_.fmt=m.readUshort(s,d),d+=2,c==1||c==2||c==3||c==7||c==8&&_.fmt<=2){var w=m.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,w+y)}if(c==1&&_.fmt==1){var A=m.readUshort(s,d);d+=2;var C=e._lctf.numOfOnes(A);A!=0&&(_.pos=e.GPOS.readValueRecord(s,d,A))}else if(c==2&&_.fmt>=1&&_.fmt<=2){A=m.readUshort(s,d),d+=2;var I=m.readUshort(s,d);d+=2,C=e._lctf.numOfOnes(A);var k=e._lctf.numOfOnes(I);if(_.fmt==1){_.pairsets=[];var D=m.readUshort(s,d);d+=2;for(var L=0;L<D;L++){var O=y+m.readUshort(s,d);d+=2;var F=m.readUshort(s,O);O+=2;for(var B=[],G=0;G<F;G++){var q=m.readUshort(s,O);O+=2,A!=0&&(pe=e.GPOS.readValueRecord(s,O,A),O+=2*C),I!=0&&(be=e.GPOS.readValueRecord(s,O,I),O+=2*k),B.push({gid2:q,val1:pe,val2:be})}_.pairsets.push(B)}}if(_.fmt==2){var X=m.readUshort(s,d);d+=2;var ee=m.readUshort(s,d);d+=2;var V=m.readUshort(s,d);d+=2;var Q=m.readUshort(s,d);for(d+=2,_.classDef1=e._lctf.readClassDef(s,y+X),_.classDef2=e._lctf.readClassDef(s,y+ee),_.matrix=[],L=0;L<V;L++){var me=[];for(G=0;G<Q;G++){var pe=null,be=null;A!=0&&(pe=e.GPOS.readValueRecord(s,d,A),d+=2*C),I!=0&&(be=e.GPOS.readValueRecord(s,d,I),d+=2*k),me.push({val1:pe,val2:be})}_.matrix.push(me)}}}else{if(c==9&&_.fmt==1){var fe=m.readUshort(s,d);d+=2;var Ce=m.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=fe;else if(f.ltype!=fe)throw"invalid extension substitution";return e.GPOS.subt(s,f.ltype,y+Ce)}console.debug("unsupported GPOS table LookupType",c,"format",_.fmt)}return _},e.GPOS.readValueRecord=function(s,c,d){var f=e._bin,m=[];return m.push(1&d?f.readShort(s,c):0),c+=1&d?2:0,m.push(2&d?f.readShort(s,c):0),c+=2&d?2:0,m.push(4&d?f.readShort(s,c):0),c+=4&d?2:0,m.push(8&d?f.readShort(s,c):0),c+=8&d?2:0,m},e.GSUB={},e.GSUB.parse=function(s,c,d,f){return e._lctf.parse(s,c,d,f,e.GSUB.subt)},e.GSUB.subt=function(s,c,d,f){var m=e._bin,y=d,_={};if(_.fmt=m.readUshort(s,d),d+=2,c!=1&&c!=4&&c!=5&&c!=6)return null;if(c==1||c==4||c==5&&_.fmt<=2||c==6&&_.fmt<=2){var w=m.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,y+w)}if(c==1&&_.fmt>=1&&_.fmt<=2){if(_.fmt==1)_.delta=m.readShort(s,d),d+=2;else if(_.fmt==2){var A=m.readUshort(s,d);d+=2,_.newg=m.readUshorts(s,d,A),d+=2*_.newg.length}}else if(c==4){_.vals=[],A=m.readUshort(s,d),d+=2;for(var C=0;C<A;C++){var I=m.readUshort(s,d);d+=2,_.vals.push(e.GSUB.readLigatureSet(s,y+I))}}else if(c==5&&_.fmt==2){if(_.fmt==2){var k=m.readUshort(s,d);d+=2,_.cDef=e._lctf.readClassDef(s,y+k),_.scset=[];var D=m.readUshort(s,d);for(d+=2,C=0;C<D;C++){var L=m.readUshort(s,d);d+=2,_.scset.push(L==0?null:e.GSUB.readSubClassSet(s,y+L))}}}else if(c==6&&_.fmt==3){if(_.fmt==3){for(C=0;C<3;C++){A=m.readUshort(s,d),d+=2;for(var O=[],F=0;F<A;F++)O.push(e._lctf.readCoverage(s,y+m.readUshort(s,d+2*F)));d+=2*A,C==0&&(_.backCvg=O),C==1&&(_.inptCvg=O),C==2&&(_.ahedCvg=O)}A=m.readUshort(s,d),d+=2,_.lookupRec=e.GSUB.readSubstLookupRecords(s,d,A)}}else{if(c==7&&_.fmt==1){var B=m.readUshort(s,d);d+=2;var G=m.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=B;else if(f.ltype!=B)throw"invalid extension substitution";return e.GSUB.subt(s,f.ltype,y+G)}console.debug("unsupported GSUB table LookupType",c,"format",_.fmt)}return _},e.GSUB.readSubClassSet=function(s,c){var d=e._bin.readUshort,f=c,m=[],y=d(s,c);c+=2;for(var _=0;_<y;_++){var w=d(s,c);c+=2,m.push(e.GSUB.readSubClassRule(s,f+w))}return m},e.GSUB.readSubClassRule=function(s,c){var d=e._bin.readUshort,f={},m=d(s,c),y=d(s,c+=2);c+=2,f.input=[];for(var _=0;_<m-1;_++)f.input.push(d(s,c)),c+=2;return f.substLookupRecords=e.GSUB.readSubstLookupRecords(s,c,y),f},e.GSUB.readSubstLookupRecords=function(s,c,d){for(var f=e._bin.readUshort,m=[],y=0;y<d;y++)m.push(f(s,c),f(s,c+2)),c+=4;return m},e.GSUB.readChainSubClassSet=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var w=d.readUshort(s,c);c+=2,m.push(e.GSUB.readChainSubClassRule(s,f+w))}return m},e.GSUB.readChainSubClassRule=function(s,c){for(var d=e._bin,f={},m=["backtrack","input","lookahead"],y=0;y<m.length;y++){var _=d.readUshort(s,c);c+=2,y==1&&_--,f[m[y]]=d.readUshorts(s,c,_),c+=2*f[m[y]].length}return _=d.readUshort(s,c),c+=2,f.subst=d.readUshorts(s,c,2*_),c+=2*f.subst.length,f},e.GSUB.readLigatureSet=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var w=d.readUshort(s,c);c+=2,m.push(e.GSUB.readLigature(s,f+w))}return m},e.GSUB.readLigature=function(s,c){var d=e._bin,f={chain:[]};f.nglyph=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2;for(var y=0;y<m-1;y++)f.chain.push(d.readUshort(s,c)),c+=2;return f},e.head={},e.head.parse=function(s,c,d){var f=e._bin,m={};return f.readFixed(s,c),c+=4,m.fontRevision=f.readFixed(s,c),c+=4,f.readUint(s,c),c+=4,f.readUint(s,c),c+=4,m.flags=f.readUshort(s,c),c+=2,m.unitsPerEm=f.readUshort(s,c),c+=2,m.created=f.readUint64(s,c),c+=8,m.modified=f.readUint64(s,c),c+=8,m.xMin=f.readShort(s,c),c+=2,m.yMin=f.readShort(s,c),c+=2,m.xMax=f.readShort(s,c),c+=2,m.yMax=f.readShort(s,c),c+=2,m.macStyle=f.readUshort(s,c),c+=2,m.lowestRecPPEM=f.readUshort(s,c),c+=2,m.fontDirectionHint=f.readShort(s,c),c+=2,m.indexToLocFormat=f.readShort(s,c),c+=2,m.glyphDataFormat=f.readShort(s,c),c+=2,m},e.hhea={},e.hhea.parse=function(s,c,d){var f=e._bin,m={};return f.readFixed(s,c),c+=4,m.ascender=f.readShort(s,c),c+=2,m.descender=f.readShort(s,c),c+=2,m.lineGap=f.readShort(s,c),c+=2,m.advanceWidthMax=f.readUshort(s,c),c+=2,m.minLeftSideBearing=f.readShort(s,c),c+=2,m.minRightSideBearing=f.readShort(s,c),c+=2,m.xMaxExtent=f.readShort(s,c),c+=2,m.caretSlopeRise=f.readShort(s,c),c+=2,m.caretSlopeRun=f.readShort(s,c),c+=2,m.caretOffset=f.readShort(s,c),c+=2,c+=8,m.metricDataFormat=f.readShort(s,c),c+=2,m.numberOfHMetrics=f.readUshort(s,c),c+=2,m},e.hmtx={},e.hmtx.parse=function(s,c,d,f){for(var m=e._bin,y={aWidth:[],lsBearing:[]},_=0,w=0,A=0;A<f.maxp.numGlyphs;A++)A<f.hhea.numberOfHMetrics&&(_=m.readUshort(s,c),c+=2,w=m.readShort(s,c),c+=2),y.aWidth.push(_),y.lsBearing.push(w);return y},e.kern={},e.kern.parse=function(s,c,d,f){var m=e._bin,y=m.readUshort(s,c);if(c+=2,y==1)return e.kern.parseV1(s,c-2,d,f);var _=m.readUshort(s,c);c+=2;for(var w={glyph1:[],rval:[]},A=0;A<_;A++){c+=2,d=m.readUshort(s,c),c+=2;var C=m.readUshort(s,c);c+=2;var I=C>>>8;if((I&=15)!=0)throw"unknown kern table format: "+I;c=e.kern.readFormat0(s,c,w)}return w},e.kern.parseV1=function(s,c,d,f){var m=e._bin;m.readFixed(s,c),c+=4;var y=m.readUint(s,c);c+=4;for(var _={glyph1:[],rval:[]},w=0;w<y;w++){m.readUint(s,c),c+=4;var A=m.readUshort(s,c);c+=2,m.readUshort(s,c),c+=2;var C=A>>>8;if((C&=15)!=0)throw"unknown kern table format: "+C;c=e.kern.readFormat0(s,c,_)}return _},e.kern.readFormat0=function(s,c,d){var f=e._bin,m=-1,y=f.readUshort(s,c);c+=2,f.readUshort(s,c),c+=2,f.readUshort(s,c),c+=2,f.readUshort(s,c),c+=2;for(var _=0;_<y;_++){var w=f.readUshort(s,c);c+=2;var A=f.readUshort(s,c);c+=2;var C=f.readShort(s,c);c+=2,w!=m&&(d.glyph1.push(w),d.rval.push({glyph2:[],vals:[]}));var I=d.rval[d.rval.length-1];I.glyph2.push(A),I.vals.push(C),m=w}return c},e.loca={},e.loca.parse=function(s,c,d,f){var m=e._bin,y=[],_=f.head.indexToLocFormat,w=f.maxp.numGlyphs+1;if(_==0)for(var A=0;A<w;A++)y.push(m.readUshort(s,c+(A<<1))<<1);if(_==1)for(A=0;A<w;A++)y.push(m.readUint(s,c+(A<<2)));return y},e.maxp={},e.maxp.parse=function(s,c,d){var f=e._bin,m={},y=f.readUint(s,c);return c+=4,m.numGlyphs=f.readUshort(s,c),c+=2,y==65536&&(m.maxPoints=f.readUshort(s,c),c+=2,m.maxContours=f.readUshort(s,c),c+=2,m.maxCompositePoints=f.readUshort(s,c),c+=2,m.maxCompositeContours=f.readUshort(s,c),c+=2,m.maxZones=f.readUshort(s,c),c+=2,m.maxTwilightPoints=f.readUshort(s,c),c+=2,m.maxStorage=f.readUshort(s,c),c+=2,m.maxFunctionDefs=f.readUshort(s,c),c+=2,m.maxInstructionDefs=f.readUshort(s,c),c+=2,m.maxStackElements=f.readUshort(s,c),c+=2,m.maxSizeOfInstructions=f.readUshort(s,c),c+=2,m.maxComponentElements=f.readUshort(s,c),c+=2,m.maxComponentDepth=f.readUshort(s,c),c+=2),m},e.name={},e.name.parse=function(s,c,d){var f=e._bin,m={};f.readUshort(s,c),c+=2;var y=f.readUshort(s,c);c+=2,f.readUshort(s,c);for(var _,w=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],A=c+=2,C=0;C<y;C++){var I=f.readUshort(s,c);c+=2;var k=f.readUshort(s,c);c+=2;var D=f.readUshort(s,c);c+=2;var L=f.readUshort(s,c);c+=2;var O=f.readUshort(s,c);c+=2;var F=f.readUshort(s,c);c+=2;var B,G=w[L],q=A+12*y+F;if(I==0)B=f.readUnicode(s,q,O/2);else if(I==3&&k==0)B=f.readUnicode(s,q,O/2);else if(k==0)B=f.readASCII(s,q,O);else if(k==1)B=f.readUnicode(s,q,O/2);else if(k==3)B=f.readUnicode(s,q,O/2);else{if(I!=1)throw"unknown encoding "+k+", platformID: "+I;B=f.readASCII(s,q,O),console.debug("reading unknown MAC encoding "+k+" as ASCII")}var X="p"+I+","+D.toString(16);m[X]==null&&(m[X]={}),m[X][G!==void 0?G:L]=B,m[X]._lang=D}for(var ee in m)if(m[ee].postScriptName!=null&&m[ee]._lang==1033)return m[ee];for(var ee in m)if(m[ee].postScriptName!=null&&m[ee]._lang==0)return m[ee];for(var ee in m)if(m[ee].postScriptName!=null&&m[ee]._lang==3084)return m[ee];for(var ee in m)if(m[ee].postScriptName!=null)return m[ee];for(var ee in m){_=ee;break}return console.debug("returning name table with languageID "+m[_]._lang),m[_]},e["OS/2"]={},e["OS/2"].parse=function(s,c,d){var f=e._bin.readUshort(s,c);c+=2;var m={};if(f==0)e["OS/2"].version0(s,c,m);else if(f==1)e["OS/2"].version1(s,c,m);else if(f==2||f==3||f==4)e["OS/2"].version2(s,c,m);else{if(f!=5)throw"unknown OS/2 table version: "+f;e["OS/2"].version5(s,c,m)}return m},e["OS/2"].version0=function(s,c,d){var f=e._bin;return d.xAvgCharWidth=f.readShort(s,c),c+=2,d.usWeightClass=f.readUshort(s,c),c+=2,d.usWidthClass=f.readUshort(s,c),c+=2,d.fsType=f.readUshort(s,c),c+=2,d.ySubscriptXSize=f.readShort(s,c),c+=2,d.ySubscriptYSize=f.readShort(s,c),c+=2,d.ySubscriptXOffset=f.readShort(s,c),c+=2,d.ySubscriptYOffset=f.readShort(s,c),c+=2,d.ySuperscriptXSize=f.readShort(s,c),c+=2,d.ySuperscriptYSize=f.readShort(s,c),c+=2,d.ySuperscriptXOffset=f.readShort(s,c),c+=2,d.ySuperscriptYOffset=f.readShort(s,c),c+=2,d.yStrikeoutSize=f.readShort(s,c),c+=2,d.yStrikeoutPosition=f.readShort(s,c),c+=2,d.sFamilyClass=f.readShort(s,c),c+=2,d.panose=f.readBytes(s,c,10),c+=10,d.ulUnicodeRange1=f.readUint(s,c),c+=4,d.ulUnicodeRange2=f.readUint(s,c),c+=4,d.ulUnicodeRange3=f.readUint(s,c),c+=4,d.ulUnicodeRange4=f.readUint(s,c),c+=4,d.achVendID=[f.readInt8(s,c),f.readInt8(s,c+1),f.readInt8(s,c+2),f.readInt8(s,c+3)],c+=4,d.fsSelection=f.readUshort(s,c),c+=2,d.usFirstCharIndex=f.readUshort(s,c),c+=2,d.usLastCharIndex=f.readUshort(s,c),c+=2,d.sTypoAscender=f.readShort(s,c),c+=2,d.sTypoDescender=f.readShort(s,c),c+=2,d.sTypoLineGap=f.readShort(s,c),c+=2,d.usWinAscent=f.readUshort(s,c),c+=2,d.usWinDescent=f.readUshort(s,c),c+=2},e["OS/2"].version1=function(s,c,d){var f=e._bin;return c=e["OS/2"].version0(s,c,d),d.ulCodePageRange1=f.readUint(s,c),c+=4,d.ulCodePageRange2=f.readUint(s,c),c+=4},e["OS/2"].version2=function(s,c,d){var f=e._bin;return c=e["OS/2"].version1(s,c,d),d.sxHeight=f.readShort(s,c),c+=2,d.sCapHeight=f.readShort(s,c),c+=2,d.usDefault=f.readUshort(s,c),c+=2,d.usBreak=f.readUshort(s,c),c+=2,d.usMaxContext=f.readUshort(s,c),c+=2},e["OS/2"].version5=function(s,c,d){var f=e._bin;return c=e["OS/2"].version2(s,c,d),d.usLowerOpticalPointSize=f.readUshort(s,c),c+=2,d.usUpperOpticalPointSize=f.readUshort(s,c),c+=2},e.post={},e.post.parse=function(s,c,d){var f=e._bin,m={};return m.version=f.readFixed(s,c),c+=4,m.italicAngle=f.readFixed(s,c),c+=4,m.underlinePosition=f.readShort(s,c),c+=2,m.underlineThickness=f.readShort(s,c),c+=2,m},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,c){var d=s.cmap,f=-1;if(d.p0e4!=null?f=d.p0e4:d.p3e1!=null?f=d.p3e1:d.p1e0!=null?f=d.p1e0:d.p0e3!=null&&(f=d.p0e3),f==-1)throw"no familiar platform and encoding!";var m=d.tables[f];if(m.format==0)return c>=m.map.length?0:m.map[c];if(m.format==4){for(var y=-1,_=0;_<m.endCount.length;_++)if(c<=m.endCount[_]){y=_;break}return y==-1||m.startCount[y]>c?0:65535&(m.idRangeOffset[y]!=0?m.glyphIdArray[c-m.startCount[y]+(m.idRangeOffset[y]>>1)-(m.idRangeOffset.length-y)]:c+m.idDelta[y])}if(m.format==12){if(c>m.groups[m.groups.length-1][1])return 0;for(_=0;_<m.groups.length;_++){var w=m.groups[_];if(w[0]<=c&&c<=w[1])return w[2]+(c-w[0])}return 0}throw"unknown cmap table format "+m.format},e.U.glyphToPath=function(s,c){var d={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[c]){var f=s.SVG.entries[c];return f==null?d:(typeof f=="string"&&(f=e.SVG.toPath(f),s.SVG.entries[c]=f),f)}if(s.CFF){var m={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},y=s.CFF,_=s.CFF.Private;if(y.ROS){for(var w=0;y.FDSelect[w+2]<=c;)w+=2;_=y.FDArray[y.FDSelect[w+1]].Private}e.U._drawCFF(s.CFF.CharStrings[c],m,y,_,d)}else s.glyf&&e.U._drawGlyf(c,s,d);return d},e.U._drawGlyf=function(s,c,d){var f=c.glyf[s];f==null&&(f=c.glyf[s]=e.glyf._parseGlyf(c,s)),f!=null&&(f.noc>-1?e.U._simpleGlyph(f,d):e.U._compoGlyph(f,c,d))},e.U._simpleGlyph=function(s,c){for(var d=0;d<s.noc;d++){for(var f=d==0?0:s.endPts[d-1]+1,m=s.endPts[d],y=f;y<=m;y++){var _=y==f?m:y-1,w=y==m?f:y+1,A=1&s.flags[y],C=1&s.flags[_],I=1&s.flags[w],k=s.xs[y],D=s.ys[y];if(y==f)if(A){if(!C){e.U.P.moveTo(c,k,D);continue}e.U.P.moveTo(c,s.xs[_],s.ys[_])}else C?e.U.P.moveTo(c,s.xs[_],s.ys[_]):e.U.P.moveTo(c,(s.xs[_]+k)/2,(s.ys[_]+D)/2);A?C&&e.U.P.lineTo(c,k,D):I?e.U.P.qcurveTo(c,k,D,s.xs[w],s.ys[w]):e.U.P.qcurveTo(c,k,D,(k+s.xs[w])/2,(D+s.ys[w])/2)}e.U.P.closePath(c)}},e.U._compoGlyph=function(s,c,d){for(var f=0;f<s.parts.length;f++){var m={cmds:[],crds:[]},y=s.parts[f];e.U._drawGlyf(y.glyphIndex,c,m);for(var _=y.m,w=0;w<m.crds.length;w+=2){var A=m.crds[w],C=m.crds[w+1];d.crds.push(A*_.a+C*_.b+_.tx),d.crds.push(A*_.c+C*_.d+_.ty)}for(w=0;w<m.cmds.length;w++)d.cmds.push(m.cmds[w])}},e.U._getGlyphClass=function(s,c){var d=e._lctf.getInterval(c,s);return d==-1?0:c[d+2]},e.U.getPairAdjustment=function(s,c,d){var f=!1;if(s.GPOS)for(var m=s.GPOS,y=m.lookupList,_=m.featureList,w=[],A=0;A<_.length;A++){var C=_[A];if(C.tag=="kern"){f=!0;for(var I=0;I<C.tab.length;I++)if(!w[C.tab[I]]){w[C.tab[I]]=!0;for(var k=y[C.tab[I]],D=0;D<k.tabs.length;D++)if(k.tabs[D]!=null){var L,O=k.tabs[D];if((!O.coverage||(L=e._lctf.coverageIndex(O.coverage,c))!=-1)&&k.ltype!=1){if(k.ltype==2){var F=null;if(O.fmt==1){var B=O.pairsets[L];for(A=0;A<B.length;A++)B[A].gid2==d&&(F=B[A])}else if(O.fmt==2){var G=e.U._getGlyphClass(c,O.classDef1),q=e.U._getGlyphClass(d,O.classDef2);F=O.matrix[G][q]}if(F){var X=0;return F.val1&&F.val1[2]&&(X+=F.val1[2]),F.val2&&F.val2[0]&&(X+=F.val2[0]),X}}}}}}}if(s.kern&&!f){var ee=s.kern.glyph1.indexOf(c);if(ee!=-1){var V=s.kern.rval[ee].glyph2.indexOf(d);if(V!=-1)return s.kern.rval[ee].vals[V]}}return 0},e.U._applySubs=function(s,c,d,f){for(var m=s.length-c-1,y=0;y<d.tabs.length;y++)if(d.tabs[y]!=null){var _,w=d.tabs[y];if(!w.coverage||(_=e._lctf.coverageIndex(w.coverage,s[c]))!=-1){if(d.ltype==1)s[c],w.fmt==1?s[c]=s[c]+w.delta:s[c]=w.newg[_];else if(d.ltype==4)for(var A=w.vals[_],C=0;C<A.length;C++){var I=A[C],k=I.chain.length;if(!(k>m)){for(var D=!0,L=0,O=0;O<k;O++){for(;s[c+L+(1+O)]==-1;)L++;I.chain[O]!=s[c+L+(1+O)]&&(D=!1)}if(D){for(s[c]=I.nglyph,O=0;O<k+L;O++)s[c+O+1]=-1;break}}}else if(d.ltype==5&&w.fmt==2)for(var F=e._lctf.getInterval(w.cDef,s[c]),B=w.cDef[F+2],G=w.scset[B],q=0;q<G.length;q++){var X=G[q],ee=X.input;if(!(ee.length>m)){for(D=!0,O=0;O<ee.length;O++){var V=e._lctf.getInterval(w.cDef,s[c+1+O]);if(F==-1&&w.cDef[V+2]!=ee[O]){D=!1;break}}if(D){var Q=X.substLookupRecords;for(C=0;C<Q.length;C+=2)Q[C],Q[C+1]}}}else if(d.ltype==6&&w.fmt==3){if(!e.U._glsCovered(s,w.backCvg,c-w.backCvg.length)||!e.U._glsCovered(s,w.inptCvg,c)||!e.U._glsCovered(s,w.ahedCvg,c+w.inptCvg.length))continue;var me=w.lookupRec;for(q=0;q<me.length;q+=2){F=me[q];var pe=f[me[q+1]];e.U._applySubs(s,c+F,pe,f)}}}}},e.U._glsCovered=function(s,c,d){for(var f=0;f<c.length;f++)if(e._lctf.coverageIndex(c[f],s[d+f])==-1)return!1;return!0},e.U.glyphsToPath=function(s,c,d){for(var f={cmds:[],crds:[]},m=0,y=0;y<c.length;y++){var _=c[y];if(_!=-1){for(var w=y<c.length-1&&c[y+1]!=-1?c[y+1]:0,A=e.U.glyphToPath(s,_),C=0;C<A.crds.length;C+=2)f.crds.push(A.crds[C]+m),f.crds.push(A.crds[C+1]);for(d&&f.cmds.push(d),C=0;C<A.cmds.length;C++)f.cmds.push(A.cmds[C]);d&&f.cmds.push("X"),m+=s.hmtx.aWidth[_],y<c.length-1&&(m+=e.U.getPairAdjustment(s,_,w))}}return f},e.U.P={},e.U.P.moveTo=function(s,c,d){s.cmds.push("M"),s.crds.push(c,d)},e.U.P.lineTo=function(s,c,d){s.cmds.push("L"),s.crds.push(c,d)},e.U.P.curveTo=function(s,c,d,f,m,y,_){s.cmds.push("C"),s.crds.push(c,d,f,m,y,_)},e.U.P.qcurveTo=function(s,c,d,f,m){s.cmds.push("Q"),s.crds.push(c,d,f,m)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,c,d,f,m){for(var y=c.stack,_=c.nStems,w=c.haveWidth,A=c.width,C=c.open,I=0,k=c.x,D=c.y,L=0,O=0,F=0,B=0,G=0,q=0,X=0,ee=0,V=0,Q=0,me={val:0,size:0};I<s.length;){e.CFF.getCharString(s,I,me);var pe=me.val;if(I+=me.size,pe=="o1"||pe=="o18")y.length%2!=0&&!w&&(A=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,w=!0;else if(pe=="o3"||pe=="o23")y.length%2!=0&&!w&&(A=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,w=!0;else if(pe=="o4")y.length>1&&!w&&(A=y.shift()+f.nominalWidthX,w=!0),C&&e.U.P.closePath(m),D+=y.pop(),e.U.P.moveTo(m,k,D),C=!0;else if(pe=="o5")for(;y.length>0;)k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D);else if(pe=="o6"||pe=="o7")for(var be=y.length,fe=pe=="o6",Ce=0;Ce<be;Ce++){var Re=y.shift();fe?k+=Re:D+=Re,fe=!fe,e.U.P.lineTo(m,k,D)}else if(pe=="o8"||pe=="o24"){be=y.length;for(var He=0;He+6<=be;)L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D),He+=6;pe=="o24"&&(k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D))}else{if(pe=="o11")break;if(pe=="o1234"||pe=="o1235"||pe=="o1236"||pe=="o1237")pe=="o1234"&&(O=D,F=(L=k+y.shift())+y.shift(),Q=B=O+y.shift(),q=B,ee=D,k=(X=(G=(V=F+y.shift())+y.shift())+y.shift())+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,ee,k,D)),pe=="o1235"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),V=F+y.shift(),Q=B+y.shift(),G=V+y.shift(),q=Q+y.shift(),X=G+y.shift(),ee=q+y.shift(),k=X+y.shift(),D=ee+y.shift(),y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,ee,k,D)),pe=="o1236"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),Q=B=O+y.shift(),q=B,X=(G=(V=F+y.shift())+y.shift())+y.shift(),ee=q+y.shift(),k=X+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,ee,k,D)),pe=="o1237"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),V=F+y.shift(),Q=B+y.shift(),G=V+y.shift(),q=Q+y.shift(),X=G+y.shift(),ee=q+y.shift(),Math.abs(X-k)>Math.abs(ee-D)?k=X+y.shift():D=ee+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,ee,k,D));else if(pe=="o14"){if(y.length>0&&!w&&(A=y.shift()+d.nominalWidthX,w=!0),y.length==4){var ue=y.shift(),ye=y.shift(),Ae=y.shift(),ne=y.shift(),Ee=e.CFF.glyphBySE(d,Ae),Ye=e.CFF.glyphBySE(d,ne);e.U._drawCFF(d.CharStrings[Ee],c,d,f,m),c.x=ue,c.y=ye,e.U._drawCFF(d.CharStrings[Ye],c,d,f,m)}C&&(e.U.P.closePath(m),C=!1)}else if(pe=="o19"||pe=="o20")y.length%2!=0&&!w&&(A=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,w=!0,I+=_+7>>3;else if(pe=="o21")y.length>2&&!w&&(A=y.shift()+f.nominalWidthX,w=!0),D+=y.pop(),k+=y.pop(),C&&e.U.P.closePath(m),e.U.P.moveTo(m,k,D),C=!0;else if(pe=="o22")y.length>1&&!w&&(A=y.shift()+f.nominalWidthX,w=!0),k+=y.pop(),C&&e.U.P.closePath(m),e.U.P.moveTo(m,k,D),C=!0;else if(pe=="o25"){for(;y.length>6;)k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D);L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D)}else if(pe=="o26")for(y.length%2&&(k+=y.shift());y.length>0;)L=k,O=D+y.shift(),k=F=L+y.shift(),D=(B=O+y.shift())+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D);else if(pe=="o27")for(y.length%2&&(D+=y.shift());y.length>0;)O=D,F=(L=k+y.shift())+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B,e.U.P.curveTo(m,L,O,F,B,k,D);else if(pe=="o10"||pe=="o29"){var Xe=pe=="o10"?f:d;if(y.length==0)console.debug("error: empty stack");else{var Ke=y.pop(),Ue=Xe.Subrs[Ke+Xe.Bias];c.x=k,c.y=D,c.nStems=_,c.haveWidth=w,c.width=A,c.open=C,e.U._drawCFF(Ue,c,d,f,m),k=c.x,D=c.y,_=c.nStems,w=c.haveWidth,A=c.width,C=c.open}}else if(pe=="o30"||pe=="o31"){var ht=y.length,Lt=(He=0,pe=="o31");for(He+=ht-(be=-3&ht);He<be;)Lt?(O=D,F=(L=k+y.shift())+y.shift(),D=(B=O+y.shift())+y.shift(),be-He==5?(k=F+y.shift(),He++):k=F,Lt=!1):(L=k,O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),be-He==5?(D=B+y.shift(),He++):D=B,Lt=!0),e.U.P.curveTo(m,L,O,F,B,k,D),He+=4}else{if((pe+"").charAt(0)=="o")throw console.debug("Unknown operation: "+pe,s),pe;y.push(pe)}}}c.x=k,c.y=D,c.nStems=_,c.haveWidth=w,c.width=A,c.open=C};var a=e,o={Typr:a};return n.Typr=a,n.default=o,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function TAe(){return function(n){var e=Uint8Array,a=Uint16Array,o=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=function(pe,be){for(var fe=new a(31),Ce=0;Ce<31;++Ce)fe[Ce]=be+=1<<pe[Ce-1];var Re=new o(fe[30]);for(Ce=1;Ce<30;++Ce)for(var He=fe[Ce];He<fe[Ce+1];++He)Re[He]=He-fe[Ce]<<5|Ce;return[fe,Re]},m=f(s,2),y=m[0],_=m[1];y[28]=258,_[258]=28;for(var w=f(c,0)[0],A=new a(32768),C=0;C<32768;++C){var I=(43690&C)>>>1|(21845&C)<<1;I=(61680&(I=(52428&I)>>>2|(13107&I)<<2))>>>4|(3855&I)<<4,A[C]=((65280&I)>>>8|(255&I)<<8)>>>1}var k=function(pe,be,fe){for(var Ce=pe.length,Re=0,He=new a(be);Re<Ce;++Re)++He[pe[Re]-1];var ue,ye=new a(be);for(Re=0;Re<be;++Re)ye[Re]=ye[Re-1]+He[Re-1]<<1;if(fe){ue=new a(1<<be);var Ae=15-be;for(Re=0;Re<Ce;++Re)if(pe[Re])for(var ne=Re<<4|pe[Re],Ee=be-pe[Re],Ye=ye[pe[Re]-1]++<<Ee,Xe=Ye|(1<<Ee)-1;Ye<=Xe;++Ye)ue[A[Ye]>>>Ae]=ne}else for(ue=new a(Ce),Re=0;Re<Ce;++Re)pe[Re]&&(ue[Re]=A[ye[pe[Re]-1]++]>>>15-pe[Re]);return ue},D=new e(288);for(C=0;C<144;++C)D[C]=8;for(C=144;C<256;++C)D[C]=9;for(C=256;C<280;++C)D[C]=7;for(C=280;C<288;++C)D[C]=8;var L=new e(32);for(C=0;C<32;++C)L[C]=5;var O=k(D,9,1),F=k(L,5,1),B=function(pe){for(var be=pe[0],fe=1;fe<pe.length;++fe)pe[fe]>be&&(be=pe[fe]);return be},G=function(pe,be,fe){var Ce=be/8|0;return(pe[Ce]|pe[Ce+1]<<8)>>(7&be)&fe},q=function(pe,be){var fe=be/8|0;return(pe[fe]|pe[fe+1]<<8|pe[fe+2]<<16)>>(7&be)},X=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ee=function(pe,be,fe){var Ce=new Error(be||X[pe]);if(Ce.code=pe,Error.captureStackTrace&&Error.captureStackTrace(Ce,ee),!fe)throw Ce;return Ce},V=function(pe,be,fe){var Ce=pe.length;if(!Ce||fe&&!fe.l&&Ce<5)return be||new e(0);var Re=!be||fe,He=!fe||fe.i;fe||(fe={}),be||(be=new e(3*Ce));var ue,ye=function(Yt){var Ge=be.length;if(Yt>Ge){var It=new e(Math.max(2*Ge,Yt));It.set(be),be=It}},Ae=fe.f||0,ne=fe.p||0,Ee=fe.b||0,Ye=fe.l,Xe=fe.d,Ke=fe.m,Ue=fe.n,ht=8*Ce;do{if(!Ye){fe.f=Ae=G(pe,ne,1);var Lt=G(pe,ne+1,3);if(ne+=3,!Lt){var Rt=pe[($e=((ue=ne)/8|0)+(7&ue&&1)+4)-4]|pe[$e-3]<<8,Jt=$e+Rt;if(Jt>Ce){He&&ee(0);break}Re&&ye(Ee+Rt),be.set(pe.subarray($e,Jt),Ee),fe.b=Ee+=Rt,fe.p=ne=8*Jt;continue}if(Lt==1)Ye=O,Xe=F,Ke=9,Ue=5;else if(Lt==2){var Pt=G(pe,ne,31)+257,Pe=G(pe,ne+10,15)+4,ft=Pt+G(pe,ne+5,31)+1;ne+=14;for(var gt=new e(ft),St=new e(19),Be=0;Be<Pe;++Be)St[d[Be]]=G(pe,ne+3*Be,7);ne+=3*Pe;var le=B(St),oe=(1<<le)-1,ve=k(St,le,1);for(Be=0;Be<ft;){var $e,De=ve[G(pe,ne,oe)];if(ne+=15&De,($e=De>>>4)<16)gt[Be++]=$e;else{var ot=0,ce=0;for($e==16?(ce=3+G(pe,ne,3),ne+=2,ot=gt[Be-1]):$e==17?(ce=3+G(pe,ne,7),ne+=3):$e==18&&(ce=11+G(pe,ne,127),ne+=7);ce--;)gt[Be++]=ot}}var te=gt.subarray(0,Pt),Oe=gt.subarray(Pt);Ke=B(te),Ue=B(Oe),Ye=k(te,Ke,1),Xe=k(Oe,Ue,1)}else ee(1);if(ne>ht){He&&ee(0);break}}Re&&ye(Ee+131072);for(var pt=(1<<Ke)-1,it=(1<<Ue)-1,st=ne;;st=ne){var At=(ot=Ye[q(pe,ne)&pt])>>>4;if((ne+=15&ot)>ht){He&&ee(0);break}if(ot||ee(2),At<256)be[Ee++]=At;else{if(At==256){st=ne,Ye=null;break}var Ut=At-254;if(At>264){var Vt=s[Be=At-257];Ut=G(pe,ne,(1<<Vt)-1)+y[Be],ne+=Vt}var $t=Xe[q(pe,ne)&it],Ft=$t>>>4;if($t||ee(3),ne+=15&$t,Oe=w[Ft],Ft>3&&(Vt=c[Ft],Oe+=q(pe,ne)&(1<<Vt)-1,ne+=Vt),ne>ht){He&&ee(0);break}Re&&ye(Ee+131072);for(var wt=Ee+Ut;Ee<wt;Ee+=4)be[Ee]=be[Ee-Oe],be[Ee+1]=be[Ee+1-Oe],be[Ee+2]=be[Ee+2-Oe],be[Ee+3]=be[Ee+3-Oe];Ee=wt}}fe.l=Ye,fe.p=st,fe.b=Ee,Ye&&(Ae=1,fe.m=Ke,fe.d=Xe,fe.n=Ue)}while(!Ae);return Ee==be.length?be:function(Yt,Ge,It){(Ge==null||Ge<0)&&(Ge=0),(It==null||It>Yt.length)&&(It=Yt.length);var qt=new(Yt instanceof a?a:Yt instanceof o?o:e)(It-Ge);return qt.set(Yt.subarray(Ge,It)),qt}(be,0,Ee)},Q=new e(0),me=typeof TextDecoder<"u"&&new TextDecoder;try{me.decode(Q,{stream:!0})}catch{}return n.convert_streams=function(pe){var be=new DataView(pe),fe=0;function Ce(){var Pt=be.getUint16(fe);return fe+=2,Pt}function Re(){var Pt=be.getUint32(fe);return fe+=4,Pt}function He(Pt){Rt.setUint16(Jt,Pt),Jt+=2}function ue(Pt){Rt.setUint32(Jt,Pt),Jt+=4}for(var ye={signature:Re(),flavor:Re(),length:Re(),numTables:Ce(),reserved:Ce(),totalSfntSize:Re(),majorVersion:Ce(),minorVersion:Ce(),metaOffset:Re(),metaLength:Re(),metaOrigLength:Re(),privOffset:Re(),privLength:Re()},Ae=0;Math.pow(2,Ae)<=ye.numTables;)Ae++;Ae--;for(var ne=16*Math.pow(2,Ae),Ee=16*ye.numTables-ne,Ye=12,Xe=[],Ke=0;Ke<ye.numTables;Ke++)Xe.push({tag:Re(),offset:Re(),compLength:Re(),origLength:Re(),origChecksum:Re()}),Ye+=16;var Ue,ht=new Uint8Array(12+16*Xe.length+Xe.reduce(function(Pt,Pe){return Pt+Pe.origLength+4},0)),Lt=ht.buffer,Rt=new DataView(Lt),Jt=0;return ue(ye.flavor),He(ye.numTables),He(ne),He(Ae),He(Ee),Xe.forEach(function(Pt){ue(Pt.tag),ue(Pt.origChecksum),ue(Ye),ue(Pt.origLength),Pt.outOffset=Ye,(Ye+=Pt.origLength)%4!=0&&(Ye+=4-Ye%4)}),Xe.forEach(function(Pt){var Pe,ft=pe.slice(Pt.offset,Pt.offset+Pt.compLength);if(Pt.compLength!=Pt.origLength){var gt=new Uint8Array(Pt.origLength);Pe=new Uint8Array(ft,2),V(Pe,gt)}else gt=new Uint8Array(ft);ht.set(gt,Pt.outOffset);var St=0;(Ye=Pt.outOffset+Pt.origLength)%4!=0&&(St=4-Ye%4),ht.set(new Uint8Array(St).buffer,Pt.outOffset+Pt.origLength),Ue=Ye+St}),Lt.slice(0,Ue)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function CAe(n,e){const a={M:2,L:2,Q:4,C:6,Z:0},o={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,c=2,d=4,f=8,m=16,y=32;let _;function w(G){if(!_){const q={R:c,L:s,D:d,C:m,U:y,T:f};_=new Map;for(let X in o){let ee=0;o[X].split(",").forEach(V=>{let[Q,me]=V.split("+");Q=parseInt(Q,36),me=me?parseInt(me,36):0,_.set(ee+=Q,q[X]);for(let pe=me;pe--;)_.set(++ee,q[X])})}}return _.get(G)||y}const A=1,C=2,I=3,k=4,D=[null,"isol","init","fina","medi"];function L(G){const q=new Uint8Array(G.length);let X=y,ee=A,V=-1;for(let Q=0;Q<G.length;Q++){const me=G.codePointAt(Q);let pe=w(me)|0,be=A;pe&f||(X&(s|d|m)?pe&(c|d|m)?(be=I,(ee===A||ee===I)&&q[V]++):pe&(s|y)&&(ee===C||ee===k)&&q[V]--:X&(c|y)&&(ee===C||ee===k)&&q[V]--,ee=q[Q]=be,X=pe,V=Q,me>65535&&Q++)}return q}function O(G,q){const X=[];for(let V=0;V<q.length;V++){const Q=q.codePointAt(V);Q>65535&&V++,X.push(n.U.codeToGlyph(G,Q))}const ee=G.GSUB;if(ee){const{lookupList:V,featureList:Q}=ee;let me;const pe=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,be=[];Q.forEach(fe=>{if(pe.test(fe.tag))for(let Ce=0;Ce<fe.tab.length;Ce++){if(be[fe.tab[Ce]])continue;be[fe.tab[Ce]]=!0;const Re=V[fe.tab[Ce]],He=/^(isol|init|fina|medi)$/.test(fe.tag);He&&!me&&(me=L(q));for(let ue=0;ue<X.length;ue++)(!me||!He||D[me[ue]]===fe.tag)&&n.U._applySubs(X,ue,Re,V)}})}return X}function F(...G){for(let q=0;q<G.length;q++)if(typeof G[q]=="number")return G[q]}function B(G){const q=Object.create(null),X=G["OS/2"],ee=G.hhea,V=G.head.unitsPerEm,Q=F(X&&X.sTypoAscender,ee&&ee.ascender,V),me={unitsPerEm:V,ascender:Q,descender:F(X&&X.sTypoDescender,ee&&ee.descender,0),capHeight:F(X&&X.sCapHeight,Q),xHeight:F(X&&X.sxHeight,Q),lineGap:F(X&&X.sTypoLineGap,ee&&ee.lineGap),forEachGlyph(pe,be,fe,Ce){let Re=0;const He=1/me.unitsPerEm*be,ue=O(G,pe);let ye=0,Ae=-1;return ue.forEach((ne,Ee)=>{if(ne!==-1){let Ye=q[ne];if(!Ye){const{cmds:Xe,crds:Ke}=n.U.glyphToPath(G,ne);let Ue="",ht=0;for(let Pe=0,ft=Xe.length;Pe<ft;Pe++){const gt=a[Xe[Pe]];Ue+=Xe[Pe];for(let St=1;St<=gt;St++)Ue+=(St>1?",":"")+Ke[ht++]}let Lt,Rt,Jt,Pt;if(Ke.length){Lt=Rt=1/0,Jt=Pt=-1/0;for(let Pe=0,ft=Ke.length;Pe<ft;Pe+=2){let gt=Ke[Pe],St=Ke[Pe+1];gt<Lt&&(Lt=gt),St<Rt&&(Rt=St),gt>Jt&&(Jt=gt),St>Pt&&(Pt=St)}}else Lt=Jt=Rt=Pt=0;Ye=q[ne]={index:ne,advanceWidth:G.hmtx.aWidth[ne],xMin:Lt,yMin:Rt,xMax:Jt,yMax:Pt,path:Ue,pathCommandCount:Xe.length}}Ae!==-1&&(Re+=n.U.getPairAdjustment(G,Ae,ne)*He),Ce.call(null,Ye,Re,ye),Ye.advanceWidth&&(Re+=Ye.advanceWidth*He),fe&&(Re+=fe*be),Ae=ne}ye+=pe.codePointAt(ye)>65535?2:1}),Re}};return me}return function(q){const X=new Uint8Array(q,0,4),ee=n._bin.readASCII(X,0,4);if(ee==="wOFF")q=e(q);else if(ee==="wOF2")throw new Error("woff2 fonts not supported");return B(n.parse(q)[0])}}const PAe=Nw({name:"Typr Font Parser",dependencies:[MAe,TAe,CAe],init(n,e,a){const o=n(),s=e();return a(o,s)}}),w0={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},IAe=new Pn;function Zv(){return(self.performance||Date).now()}const rG=Object.create(null);function IK(n,e){n=kAe({},n);const a=Zv();if(n.font=DAe(n.font||w0.defaultFontURL),n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||w0.sdfGlyphSize,n.colorRanges!=null){let w={};for(let A in n.colorRanges)if(n.colorRanges.hasOwnProperty(A)){let C=n.colorRanges[A];typeof C!="number"&&(C=IAe.set(C).getHex()),w[A]=C}n.colorRanges=w}Object.freeze(n);const{textureWidth:o,sdfExponent:s}=w0,{sdfGlyphSize:c}=n,d=o/c*4;let f=rG[c];if(!f){const w=document.createElement("canvas");w.width=o,w.height=c*256/d,f=rG[c]={glyphCount:0,sdfGlyphSize:c,sdfCanvas:w,sdfTexture:new Lr(w,void 0,void 0,void 0,Cr,Cr),contextLost:!1,glyphsByFont:new Map},f.sdfTexture.generateMipmaps=!1,LAe(f)}const{sdfTexture:m,sdfCanvas:y}=f;let _=f.glyphsByFont.get(n.font);_||f.glyphsByFont.set(n.font,_=new Map),zAe(n).then(w=>{const{glyphIds:A,glyphPositions:C,fontSize:I,unitsPerEm:k,timings:D}=w,L=[],O=new Float32Array(A.length*4),F=I/k;let B=0,G=0;const q=Zv();A.forEach((me,pe)=>{let be=_.get(me);if(!be){const{path:He,pathBounds:ue}=w.glyphData[me],ye=Math.max(ue[2]-ue[0],ue[3]-ue[1])/c*(w0.sdfMargin*c+.5),Ae=f.glyphCount++,ne=[ue[0]-ye,ue[1]-ye,ue[2]+ye,ue[3]+ye];_.set(me,be={path:He,atlasIndex:Ae,sdfViewBox:ne}),L.push(be)}const{sdfViewBox:fe}=be,Ce=C[G++],Re=C[G++];O[B++]=Ce+fe[0]*F,O[B++]=Re+fe[1]*F,O[B++]=Ce+fe[2]*F,O[B++]=Re+fe[3]*F,A[pe]=be.atlasIndex}),D.quads=(D.quads||0)+(Zv()-q);const X=Zv();D.sdf={};const ee=y.height,V=Math.ceil(f.glyphCount/d),Q=Math.pow(2,Math.ceil(Math.log2(V*c)));Q>ee&&(console.info(`Increasing SDF texture size ${ee}->${Q}`),EAe(y,o,Q),m.dispose()),Promise.all(L.map(me=>LK(me,f,n.gpuAccelerateSDF).then(({timing:pe})=>{D.sdf[me.atlasIndex]=pe}))).then(()=>{L.length&&!f.contextLost&&(RK(f),m.needsUpdate=!0),D.sdfTotal=Zv()-X,D.total=Zv()-a,e(Object.freeze({parameters:n,sdfTexture:m,sdfGlyphSize:c,sdfExponent:s,glyphBounds:O,glyphAtlasIndices:A,glyphColors:w.glyphColors,caretPositions:w.caretPositions,caretHeight:w.caretHeight,chunkedBounds:w.chunkedBounds,ascender:w.ascender,descender:w.descender,lineHeight:w.lineHeight,capHeight:w.capHeight,xHeight:w.xHeight,topBaseline:w.topBaseline,blockBounds:w.blockBounds,visibleBounds:w.visibleBounds,timings:w.timings}))})}),Promise.resolve().then(()=>{f.contextLost||AAe(y)})}function LK({path:n,atlasIndex:e,sdfViewBox:a},{sdfGlyphSize:o,sdfCanvas:s,contextLost:c},d){if(c)return Promise.resolve({timing:-1});const{textureWidth:f,sdfExponent:m}=w0,y=Math.max(a[2]-a[0],a[3]-a[1]),_=Math.floor(e/4),w=_%(f/o)*o,A=Math.floor(_/(f/o))*o,C=e%4;return vAe(o,o,n,a,y,m,s,w,A,C,d)}function LAe(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",a=>{console.log("Context Lost",a),a.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",a=>{console.log("Context Restored",a),n.contextLost=!1;const o=[];n.glyphsByFont.forEach(s=>{s.forEach(c=>{o.push(LK(c,n,!0))})}),Promise.all(o).then(()=>{RK(n),n.sdfTexture.needsUpdate=!0})})}function RAe({font:n,characters:e,sdfGlyphSize:a},o){let s=Array.isArray(e)?e.join(`
`):""+e;IK({font:n,sdfGlyphSize:a,text:s},o)}function kAe(n,e){for(let a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);return n}let eA;function DAe(n){return eA||(eA=typeof document>"u"?{}:document.createElement("a")),eA.href=n,eA.href}function RK(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:a}=n,{width:o,height:s}=e,c=n.sdfCanvas.getContext("webgl");let d=a.image.data;(!d||d.length!==o*s*4)&&(d=new Uint8Array(o*s*4),a.image={width:o,height:s,data:d},a.flipY=!1,a.isDataTexture=!0),c.readPixels(0,0,o,s,c.RGBA,c.UNSIGNED_BYTE,d)}}const OAe=Nw({name:"Typesetter",dependencies:[w0,PAe,yAe,cAe],init(n,e,a,o){const{defaultFontURL:s}=n;return a(e,o(),{defaultFontURL:s})}}),zAe=Nw({name:"Typesetter",dependencies:[OAe],init(n){return function(e){return new Promise(a=>{n.typeset(e,a)})}},getTransferables(n){const e=[n.glyphPositions.buffer,n.glyphIds.buffer];return n.caretPositions&&e.push(n.caretPositions.buffer),n.glyphColors&&e.push(n.glyphColors.buffer),e}}),oG={};function FAe(n){let e=oG[n];if(!e){const a=new Mp(1,1,n,n),o=a.clone(),s=a.attributes,c=o.attributes,d=new La,f=s.uv.count;for(let m=0;m<f;m++)c.position.array[m*3]*=-1,c.normal.array[m*3+2]*=-1;["position","normal","uv"].forEach(m=>{d.setAttribute(m,new Wn([...s[m].array,...c[m].array],s[m].itemSize))}),d.setIndex([...a.index.array,...o.index.array.map(m=>m+f)]),d.translate(.5,.5,0),e=oG[n]=d}return e}const NAe="aTroikaGlyphBounds",sG="aTroikaGlyphIndex",BAe="aTroikaGlyphColor";class UAe extends l6{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Tc,this.boundingBox=new pu}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const a=this.getIndex().count;this.setDrawRange(e===vs?a/2:0,e===Ul?a:a/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let a=FAe(e);["position","normal","uv"].forEach(o=>{this.attributes[o]=a.attributes[o].clone()}),this.setIndex(a.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,a,o,s,c){tI(this,NAe,e,4),tI(this,sG,a,1),tI(this,BAe,c,3),this._blockBounds=o,this._chunkedBounds=s,this.instanceCount=a.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:a,boundingBox:o}=this;if(a){const{PI:s,floor:c,min:d,max:f,sin:m,cos:y}=Math,_=s/2,w=s*2,A=Math.abs(a),C=e[0]/A,I=e[2]/A,k=c((C+_)/w)!==c((I+_)/w)?-A:d(m(C)*A,m(I)*A),D=c((C-_)/w)!==c((I-_)/w)?A:f(m(C)*A,m(I)*A),L=c((C+s)/w)!==c((I+s)/w)?A*2:f(A-y(C)*A,A-y(I)*A);o.min.set(k,e[1],a<0?-L:0),o.max.set(D,e[3],a<0?0:L)}else o.min.set(e[0],e[1],0),o.max.set(e[2],e[3],0);o.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let a=this.getAttribute(sG).count,o=this._chunkedBounds;if(o)for(let s=o.length;s--;){a=o[s].end;let c=o[s].rect;if(c[1]<e.w&&c[3]>e.y&&c[0]<e.z&&c[2]>e.x)break}this.instanceCount=a}}function tI(n,e,a,o){const s=n.getAttribute(e);a?s&&s.array.length===a.length?(s.array.set(a),s.needsUpdate=!0):(n.setAttribute(e,new kg(a,o)),delete n._maxInstanceCount,n.dispose()):s&&n.deleteAttribute(e)}const WAe=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,VAe=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,GAe=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,HAe=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function jAe(n){const e=RR(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Kt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ai(0,0,0,0)},uTroikaClipRect:{value:new Ai(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Kt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Pn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Na},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:WAe,vertexTransform:VAe,fragmentDefs:GAe,fragmentColorTransform:HAe,customRewriter({vertexShader:a,fragmentShader:o}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(o)&&(o=o.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(a)||(a=a.replace(CK,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:a,fragmentShader:o}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const R6=new Vh({color:16777215,side:Ul,transparent:!0}),lG=8421504,cG=new Ia,tA=new Fe,nI=new Fe,lb=[],$Ae=new Fe,aI="+x+y";function uG(n){return Array.isArray(n)?n[0]:n}let kK=()=>{const n=new bo(new Mp(1,1),R6);return kK=()=>n,n},DK=()=>{const n=new bo(new Mp(1,1,32,1),R6);return DK=()=>n,n};const qAe={type:"syncstart"},XAe={type:"synccomplete"},OK=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],ZAe=OK.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let zK=class extends bo{constructor(){const e=new UAe;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=lG,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=aI,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(qAe),IK({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},a=>{this._isSyncing=!1,this._textRenderInfo=a,this.geometry.updateGlyphs(a.glyphBounds,a.glyphAtlasIndices,a.blockBounds,a.chunkedBounds,a.glyphColors);const o=this._queuedSyncs;o&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{o.forEach(s=>s&&s())})),this.dispatchEvent(XAe),e&&e()})))}onBeforeRender(e,a,o,s,c,d){this.sync(),c.isTroikaTextMaterial&&this._prepareForRender(c),c._hadOwnSide=c.hasOwnProperty("side"),this.geometry.setSide(c._actualSide=c.side),c.side=md}onAfterRender(e,a,o,s,c,d){c._hadOwnSide?c.side=c._actualSide:delete c.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const a=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=R6.clone());if((!e||e.baseMaterial!==a)&&(e=this._derivedMaterial=jAe(a),a.addEventListener("dispose",function o(){a.removeEventListener("dispose",o),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let o=e._outlineMtl;return o||(o=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),o.isTextOutlineMaterial=!0,o.depthWrite=!1,o.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),o.dispose()})),[o,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return uG(this.material).getDepthMaterial()}get customDistanceMaterial(){return uG(this.material).getDistanceMaterial()}_prepareForRender(e){const a=e.isTextOutlineMaterial,o=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:f,blockBounds:m}=s;o.uTroikaSDFTexture.value=f,o.uTroikaSDFTextureSize.value.set(f.image.width,f.image.height),o.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,o.uTroikaSDFExponent.value=s.sdfExponent,o.uTroikaTotalBounds.value.fromArray(m),o.uTroikaUseGlyphColors.value=!a&&!!s.glyphColors;let y=0,_=0,w=0,A,C,I,k=0,D=0;if(a){let{outlineWidth:O,outlineOffsetX:F,outlineOffsetY:B,outlineBlur:G,outlineOpacity:q}=this;y=this._parsePercent(O)||0,_=Math.max(0,this._parsePercent(G)||0),A=q,k=this._parsePercent(F)||0,D=this._parsePercent(B)||0}else w=Math.max(0,this._parsePercent(this.strokeWidth)||0),w&&(I=this.strokeColor,o.uTroikaStrokeColor.value.set(I??lG),C=this.strokeOpacity,C==null&&(C=1)),A=this.fillOpacity;o.uTroikaDistanceOffset.value=y,o.uTroikaPositionOffset.value.set(k,D),o.uTroikaBlurRadius.value=_,o.uTroikaStrokeWidth.value=w,o.uTroikaStrokeOpacity.value=C,o.uTroikaFillOpacity.value=A??1,o.uTroikaCurveRadius.value=this.curveRadius||0;let L=this.clipRect;if(L&&Array.isArray(L)&&L.length===4)o.uTroikaClipRect.value.fromArray(L);else{const O=(this.fontSize||.1)*100;o.uTroikaClipRect.value.set(m[0]-O,m[1]-O,m[2]+O,m[3]+O)}this.geometry.applyClipRect(o.uTroikaClipRect.value)}o.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const c=a?this.outlineColor||0:this.color;if(c==null)delete e.color;else{const f=e.hasOwnProperty("color")?e.color:e.color=new Pn;(c!==f._input||typeof c=="object")&&f.set(f._input=c)}let d=this.orientation||aI;if(d!==e._orientation){let f=o.uTroikaOrient.value;d=d.replace(/[^-+xyz]/g,"");let m=d!==aI&&d.match(/^([-+])([xyz])([-+])([xyz])$/);if(m){let[,y,_,w,A]=m;tA.set(0,0,0)[_]=y==="-"?1:-1,nI.set(0,0,0)[A]=w==="-"?-1:1,cG.lookAt($Ae,tA.cross(nI),nI),f.setFromMatrix4(cG)}else f.identity();e._orientation=d}}_parsePercent(e){if(typeof e=="string"){let a=e.match(/^(-?[\d.]+)%$/),o=a?parseFloat(a[1]):NaN;e=(isNaN(o)?0:o/100)*this.fontSize}return e}localPositionToTextCoords(e,a=new Kt){a.copy(e);const o=this.curveRadius;return o&&(a.x=Math.atan2(e.x,Math.abs(o)-Math.abs(e.z))*Math.abs(o)),a}worldPositionToTextCoords(e,a=new Kt){return tA.copy(e),this.localPositionToTextCoords(this.worldToLocal(tA),a)}raycast(e,a){const{textRenderInfo:o,curveRadius:s}=this;if(o){const c=o.blockBounds,d=s?DK():kK(),f=d.geometry,{position:m,uv:y}=f.attributes;for(let _=0;_<y.count;_++){let w=c[0]+y.getX(_)*(c[2]-c[0]);const A=c[1]+y.getY(_)*(c[3]-c[1]);let C=0;s&&(C=s-Math.cos(w/s)*s,w=Math.sin(w/s)*s),m.setXYZ(_,w,A,C)}f.boundingSphere=this.geometry.boundingSphere,f.boundingBox=this.geometry.boundingBox,d.matrixWorld=this.matrixWorld,d.material.side=this.material.side,lb.length=0,d.raycast(e,lb);for(let _=0;_<lb.length;_++)lb[_].object=this,a.push(lb[_])}}copy(e){const a=this.geometry;return super.copy(e),this.geometry=a,ZAe.forEach(o=>{this[o]=e[o]}),this}clone(){return new this.constructor().copy(this)}};OK.forEach(n=>{const e="_private_"+n;Object.defineProperty(zK.prototype,n,{get(){return this[e]},set(a){a!==this[e]&&(this[e]=a,this._needsSync=!0)}})});const tx=re.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:a="middle",font:o,fontSize:s=1,children:c,characters:d,onSync:f,...m},y)=>{const _=dh(({invalidate:I})=>I),[w]=re.useState(()=>new zK),[A,C]=re.useMemo(()=>{const I=[];let k="";return re.Children.forEach(c,D=>{typeof D=="string"||typeof D=="number"?k+=D:I.push(D)}),[I,k]},[c]);return WY(()=>new Promise(I=>RAe({font:o,characters:d},I)),["troika-text",o,d]),re.useLayoutEffect(()=>void w.sync(()=>{_(),f&&f(w)})),re.useEffect(()=>()=>w.dispose(),[w]),re.createElement("primitive",rt({object:w,ref:y,font:o,text:C,anchorX:e,anchorY:a,fontSize:s,sdfGlyphSize:n},m),A)}),YAe=re.forwardRef(({makeDefault:n,camera:e,regress:a,domElement:o,enableDamping:s=!0,keyEvents:c=!1,onChange:d,onStart:f,onEnd:m,...y},_)=>{const w=dh(q=>q.invalidate),A=dh(q=>q.camera),C=dh(q=>q.gl),I=dh(q=>q.events),k=dh(q=>q.setEvents),D=dh(q=>q.set),L=dh(q=>q.get),O=dh(q=>q.performance),F=e||A,B=o||I.connected||C.domElement,G=re.useMemo(()=>new nAe(F),[F]);return m6(()=>{G.enabled&&G.update()},-1),re.useEffect(()=>(c&&G.connect(c===!0?B:c),G.connect(B),()=>void G.dispose()),[c,B,a,G,w]),re.useEffect(()=>{const q=V=>{w(),a&&O.regress(),d&&d(V)},X=V=>{f&&f(V)},ee=V=>{m&&m(V)};return G.addEventListener("change",q),G.addEventListener("start",X),G.addEventListener("end",ee),()=>{G.removeEventListener("start",X),G.removeEventListener("end",ee),G.removeEventListener("change",q)}},[d,f,m,G,w,k]),re.useEffect(()=>{if(n){const q=L().controls;return D({controls:G}),()=>D({controls:q})}},[n,G]),re.createElement("primitive",rt({ref:_,object:G,enableDamping:s},y))}),Yv=({value:n,label:e,options:a,onChange:o})=>{const{classes:s}=TD(),[c,d]=re.useState(!1),f=()=>{d(!1)};return Bt($me,{children:[he(pge,{children:e}),Bt(Rye,{className:s.filterSelect,open:c,value:n,onOpen:f,onChange:o,variant:"outlined",label:e,sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},"&.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:0}},renderValue:m=>m.length===0?he("em",{children:e}):m,children:[he(q0,{disabled:!0,value:"",children:he("em",{children:e})}),a.map(m=>he(q0,{value:m,children:m},m))]})]})},KAe=()=>{const{classes:n}=TD(),[e,a]=re.useState(!1),[o,s]=re.useState("Country"),[c,d]=re.useState("Climate"),[f,m]=re.useState("Risk exposure"),[y,_]=re.useState("Income group"),[w,A]=re.useState("Population group"),[C,I]=re.useState("Rating"),k=re.useCallback(G=>{s(G.target.value)},[]),D=re.useCallback(G=>{d(G.target.value)},[]),L=re.useCallback(G=>{m(G.target.value)},[]),O=re.useCallback(G=>{_(G.target.value)},[]),F=re.useCallback(G=>{A(G.target.value)},[]),B=re.useCallback(G=>{I(G.target.value)},[]);return he("div",{className:n.filterButtonsWrapper,children:e?Bt("div",{children:[he("div",{onClick:()=>a(!1),className:n.blurAll}),he(Yv,{value:o,label:"Country",options:["Country","Canada"],onChange:k}),he(Yv,{value:c,label:"Climate",options:["Climate","Tropical"],onChange:D}),he(Yv,{value:f,label:"Risk exposure",options:["Risk exposure","Low"],onChange:L}),he(Yv,{value:y,label:"Income group",options:["Income group","High"],onChange:O}),he(Yv,{value:w,label:"Population group",options:["Population group","High"],onChange:F}),he(Yv,{value:C,label:"Rating",options:["Rating","High"],onChange:B}),Bt(Vs,{style:{color:"white",background:"#2D67FF",gap:"10px"},className:n.filterButton,variant:"outlined",onClick:()=>a(!1),children:["Close",he("img",{style:{height:"1.1vh"},src:"assets/closeIcon.svg",alt:"close"})]})]}):he(Vs,{className:n.filterButton,variant:"outlined",onClick:()=>{a(!0)},children:"Filter by"})})},JAe={firstRow:"Choose a city and ",secondRow:"view its ",score:"score",howRatingWorks:"How rating works",map:"Map",graph:"Graph",filterBy:"Filter by",smallTextGraph1:"Urban Resilience Index (URI) is a tool to measure environmental (E), social (S), and governmental (G) performance of urban areas as well as their ability & willingness to achieve better practices.",smallTextGraph2:"URI shows whether the basic needs of residents are satisfied, how vulnerable the place is to crises and how it impacts the world around.",smallTextGraph3:"At the graph color represents the cities' overall ratings (see right scale) while position against E, S and G axes reflects respective component scoring."},QAe=({map:n,currentView:e,setCurrentView:a,isZoomButtonsVisible:o})=>{const s=m=>JAe[m],{classes:c}=TD(),d=re.useCallback(()=>{a("map")},[]),f=re.useCallback(()=>{a("graph")},[]);return Bt("div",{className:c.root,children:[he("div",{className:c.topLineWrapper,children:Bt("div",{className:c.textAndToggleWrapper,children:[Bt(Ws,{className:c.bigText,children:[s("firstRow")," ",he("br",{}),s("secondRow"),he("span",{className:c.bigTextBlue,children:s("score")})]}),Bt(vve,{children:[he(G7,{value:"map",selected:e==="map",onClick:d,children:s("map")}),he(G7,{value:"graph",selected:e==="graph",onClick:f,children:s("graph")})]}),!o&&Bt(Ws,{className:c.bigTextSubtitle,children:[s("smallTextGraph1")," ",he("br",{}),he("br",{}),s("smallTextGraph2")," ",he("br",{}),he("br",{}),s("smallTextGraph3")]})]})}),he(KAe,{}),he("img",{className:c.legendLine,src:"/assets/legendLine.svg",alt:"legend"}),Bt("div",{className:c.bottomWrapper,children:[Bt("div",{className:c.smallTextWrapper,children:[he(Ws,{className:c.smallText,children:s("howRatingWorks")}),he("img",{src:"/assets/hintQuestionIcon.svg",alt:"hint"})]}),o&&he(wve,{map:n})]})]})},eEe=()=>{const n=[new Fe(0,0,0),new Fe(6,0,0)],e=[new Fe(0,0,0),new Fe(0,6,0)],a=[new Fe(0,0,0),new Fe(0,0,6)],o=new La().setFromPoints(n),s=new La().setFromPoints(e),c=new La().setFromPoints(a),d=g6(_Y,"/textures/texture_cage_radial_fade_2.svg");return Bt("group",{children:[he("mesh",{position:[4.5,.5,0],children:he(tx,{fontSize:.5,color:"white",children:"Environmental"})}),he("mesh",{position:[.5,5,0],rotation:[0,0,Math.PI/2],children:he(tx,{fontSize:.5,color:"white",children:"Social"})}),he("mesh",{position:[0,.5,4.5],rotation:[0,-Math.PI/2,0],children:he(tx,{fontSize:.5,color:"white",children:"Governmental"})}),Bt("group",{children:[he("line",{geometry:o,children:he("lineBasicMaterial",{color:"white"})}),Bt("mesh",{position:[6,0,0],rotation:[0,0,-Math.PI/2],children:[he("coneGeometry",{args:[.1,.3,10]}),he("meshBasicMaterial",{color:"white"})]})]}),Bt("group",{children:[he("line",{geometry:s,children:he("lineBasicMaterial",{color:"white"})}),Bt("mesh",{position:[0,6,0],rotation:[0,0,0],children:[he("coneGeometry",{args:[.1,.3,10]}),he("meshBasicMaterial",{color:"white"})]})]}),Bt("group",{children:[he("line",{geometry:c,children:he("lineBasicMaterial",{color:"white"})}),Bt("mesh",{position:[0,0,6],rotation:[Math.PI/2,0,0],children:[he("coneGeometry",{args:[.1,.3,10]}),he("meshBasicMaterial",{color:"white"})]})]}),Bt("mesh",{position:[0,-.02,0],rotation:[-Math.PI/2,0,0],children:[he("planeGeometry",{args:[16,16]}),he("meshStandardMaterial",{map:d,transparent:!0,opacity:.5,side:Ul})]})]})},tEe=([n,e,a])=>{const o=[],s=[],c=[],d=[];for(let m=0;m<=e;m+=.5)o.push({x:n,y:m,z:a});for(let m=0;m<=n;m+=.5)s.push({x:m,y:0,z:a});for(let m=0;m<=a;m+=.5)c.push({x:n,y:0,z:m});for(let m=0;m<=e;m+=.5)d.push({x:n-n/e*m,y:e,z:a-a/e*m});return Bt(rd,{children:[o.map(m=>Bt("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[he("boxGeometry",{args:[.02,.2,.02]}),he("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.y)),s.map(m=>Bt("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[he("boxGeometry",{args:[.2,.02,.02]}),he("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.x)),c.map(m=>Bt("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[he("boxGeometry",{args:[.02,.02,.2]}),he("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.z)),d.map(m=>Bt("mesh",{rotation:[0,Math.atan2(m.x-n,m.z-a),0],position:[m.x-n,m.y-e,m.z-a],children:[he("boxGeometry",{args:[.02,.02,.2]}),he("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.z))]})},nEe=({item:n,color:e,setSelectedCity:a})=>{const o=re.useRef(),s=re.useRef(),c=re.useRef(),[d,f]=re.useState(!1),[m,y]=re.useState(!1);return m6(_=>{s.current.lookAt(_.camera.position),c.current.lookAt(_.camera.position)}),Bt("group",{ref:o,position:n.position,children:[Bt("mesh",{ref:c,children:[he("torusGeometry",{args:m?[.32,.015,100,100]:[.35,.015,100,100]}),he("meshStandardMaterial",{color:e,transparent:!0,opacity:1})]}),Bt("mesh",{onClick:()=>{f(!0),a(n.label)},onPointerMissed:()=>{f(!1)},onPointerOver:()=>{y(!0)},onPointerOut:()=>{y(!1)},children:[he("sphereGeometry",{args:[.2,100,100]}),he("meshStandardMaterial",{color:e})]}),Bt("mesh",{ref:s,position:[0,1.5,0],children:[he(tx,{fontSize:.45,color:"white",anchorX:"center",anchorY:"middle",children:m&&n.label}),he(tx,{fontSize:.45,color:e,anchorX:"center",anchorY:"middle",position:[0,-.5,0],children:m&&n.status}),he("meshStandardMaterial",{color:"black"})]}),m&&tEe(n.position)]},n.label)},aEe=({data:n,color:e,setSelectedCity:a})=>{const o=re.useRef();return m6(({camera:s})=>{s.lookAt(2,-6,0)}),Bt("group",{ref:o,position:[2,-10,1],rotation:[0,1,0],children:[he(eEe,{}),n.map(s=>he(nEe,{item:s,color:s.color,setSelectedCity:a},s.label))]})},iEe=[{position:[3,5,5],label:"Dubai",color:"#B7DE86",status:"A-3"},{position:[4,5,5],label:"Expo City Dubai",color:"#75D652",status:"A-2"},{position:[2,2,1],label:"Valparaiso",color:"#FF9B3F",status:"C-1"},{position:[1,1,1],label:"Dar es Salaam",color:"#FF632F",status:"C-2"},{position:[4,1,4],label:"Adoni",color:"#FF632F",status:"C-2"},{position:[4,3,3],label:"Natal",color:"#FFD748",status:"B-2"},{position:[3,1,3],label:"Brazzaville",color:"#FF9B3F",status:"C-1"},{position:[3,2,2],label:"Almaty",color:"#D6E15A",status:"B-1"},{position:[3,3,4],label:"Cape Town",color:"#FFD748",status:"B-2"},{position:[2,2,2],label:"Mexico City",color:"#FF632F",status:"C-2"},{position:[2,3,3],label:"Jakarta",color:"#FFD748",status:"B-3"},{position:[3,4,3],label:"Panama City",color:"#ECE38E",status:"B-1"},{position:[2,4,4],label:"Amman",color:"#ECE38E",status:"B-1"},{position:[2,3,2],label:"Bangkok",color:"#FFD748",status:"B-3"},{position:[3,3,3],label:"Colombo",color:"#FFD748",status:"B-2"}],rEe=({setSelectedCity:n})=>{const{classes:e}=MD();return he("div",{className:e.graph3dWrapper,children:he(re.Suspense,{fallback:null,children:Bt(eSe,{style:{background:"transparent "},camera:{position:[11,11,11],fov:50},children:[he("ambientLight",{intensity:1,castShadow:!0}),he("directionalLight",{intensity:1,position:[10,10,0],castShadow:!0}),he(aEe,{data:iEe,setSelectedCity:n}),he(YAe,{enableZoom:!1,makeDefault:!0,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI/2,minAzimuthAngle:Math.PI/4,maxAzimuthAngle:Math.PI/2})]})})})};var FK={exports:{}};(function(n,e){(function(a,o){n.exports=o()})(aoe,function(){var a,o,s;function c(f,m){if(!a)a=m;else if(!o)o=m;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",_={};a(_),s=m(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}c(["exports"],function(f){var m=typeof self<"u"?self:{},y="3.0.0-rc.2";let _;const w={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{_=i}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!w.API_URL)return null;try{const i=new URL(w.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},A={supported:!1,testSupport:function(i){!k&&I&&(D?L(i):C=i)}};let C,I,k=!1,D=!1;function L(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,I),i.isContextLost())return;A.supported=!0}catch{}i.deleteTexture(t),k=!0}m.document&&(I=m.document.createElement("img"),I.onload=function(){C&&L(C),C=null,D=!0},I.onerror=function(){k=!0,C=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function F(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var B=G;function G(i,t,r,l){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=r,this.p2y=l}G.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,l=0;l<8;l++){var u=this.sampleCurveX(r)-i;if(Math.abs(u)<t)return r;var h=this.sampleCurveDerivativeX(r);if(Math.abs(h)<1e-6)break;r-=u/h}var p=0,g=1;for(r=i,l=0;l<20&&(u=this.sampleCurveX(r),!(Math.abs(u-i)<t));l++)i>u?p=r:g=r,r=.5*(g-p)+p;return r},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var q=F(B),X=ee;function ee(i,t){this.x=i,this.y=t}ee.prototype={clone:function(){return new ee(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,r=i.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),r=Math.sin(i),l=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=l,this},_rotateAround:function(i,t){var r=Math.cos(i),l=Math.sin(i),u=t.y+l*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-l*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ee.convert=function(i){return i instanceof ee?i:Array.isArray(i)?new ee(i[0],i[1]):i};var V=F(X);function Q(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(!Q(i[r],t[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const r in i)if(!Q(i[r],t[r]))return!1;return!0}return i===t}const me=Math.PI/180,pe=180/Math.PI;function be(i){return i*me}function fe(i){return i*pe}const Ce=[[0,0],[1,0],[1,1],[0,1]];function Re(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,r=t*i;return 4*(i<.5?r:3*(i-t)+r-.75)}function He(i){let t=1/0,r=1/0,l=-1/0,u=-1/0;for(const h of i)t=Math.min(t,h.x),r=Math.min(r,h.y),l=Math.max(l,h.x),u=Math.max(u,h.y);return{min:new V(t,r),max:new V(l,u)}}function ue(i,t,r=0,l=!0){const u=new V(r,r),h=i.sub(u),p=t.add(u),g=[h,new V(p.x,h.y),p,new V(h.x,p.y)];return l&&g.push(h.clone()),g}function ye(i,t,r,l){const u=new q(i,t,r,l);return function(h){return u.solve(h)}}const Ae=ye(.25,.1,.25,1);function ne(i,t,r){return Math.min(r,Math.max(t,i))}function Ee(i,t,r){return(r=ne((r-i)/(t-i),0,1))*r*(3-2*r)}function Ye(i,t,r){const l=r-t,u=((i-t)%l+l)%l+t;return u===t?r:u}function Xe(i,t,r){if(!i.length)return r(null,[]);let l=i.length;const u=new Array(i.length);let h=null;i.forEach((p,g)=>{t(p,(v,b)=>{v&&(h=v),u[g]=b,--l==0&&r(h,u)})})}function Ke(i){const t=[];for(const r in i)t.push(i[r]);return t}function Ue(i,...t){for(const r of t)for(const l in r)i[l]=r[l];return i}function ht(i,t){const r={};for(let l=0;l<t.length;l++){const u=t[l];u in i&&(r[u]=i[u])}return r}let Lt=1;function Rt(){return Lt++}function Jt(){return function i(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function Pt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Pe(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function ft(i,t){i.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function gt(i,t){return i.indexOf(t,i.length-t.length)!==-1}function St(i,t,r){const l={};for(const u in i)l[u]=t.call(r||this,i[u],u,i);return l}function Be(i,t,r){const l={};for(const u in i)t.call(r||this,i[u],u,i)&&(l[u]=i[u]);return l}function le(i){return Array.isArray(i)?i.map(le):typeof i=="object"&&i?St(i,le):i}const oe={};function ve(i){oe[i]||(typeof console<"u"&&console.warn(i),oe[i]=!0)}function $e(i,t,r){return(r.y-i.y)*(t.x-i.x)>(t.y-i.y)*(r.x-i.x)}function De(i){let t=0;for(let r,l,u=0,h=i.length,p=h-1;u<h;p=u++)r=i[u],l=i[p],t+=(l.x-r.x)*(r.y+l.y);return t}function ot([i,t,r]){const l=be(t+90),u=be(r);return{x:i*Math.cos(l)*Math.sin(u),y:i*Math.sin(l)*Math.sin(u),z:i*Math.cos(u),azimuthal:t,polar:r}}function ce(i,t,r){const l=Math.sqrt(i*i+t*t+r*r),u=l>0?Math.acos(r/l)*pe:0;let h=i!==0||t!==0?Math.atan2(-t,-i)*pe+90:0;return h<0&&(h+=360),[l,h,u]}function te(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Oe(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,l,u,h)=>{const p=u||h;return t[l]=!p||p.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}let pt=null;function it(){return!!m.document.fullscreenElement||!!m.document.webkitFullscreenElement}function st(i){try{const t=m[i];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function At(i,t){return[i[4*t],i[4*t+1],i[4*t+2],i[4*t+3]]}function Ut(i,t,r){i[4*t+0]=r[0],i[4*t+1]=r[1],i[4*t+2]=r[2],i[4*t+3]=r[3]}function Vt(i,t){return[Math.pow(i[0],2.2)*t,Math.pow(i[1],2.2)*t,Math.pow(i[2],2.2)*t]}function $t(i){return[Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)]}const Ft="mapbox-tiles";let wt=500,Yt=50,Ge,It;function qt(){try{return m.caches}catch{}}function Dt(){qt()&&!Ge&&(Ge=m.caches.open(Ft))}function fn(i){const t=i.indexOf("?");if(t<0)return i;const r=function(u){const h=u.indexOf("?");return h>0?u.slice(h+1).split("&"):[]}(i),l=r.filter(u=>{const h=u.split("=");return h[0]==="language"||h[0]==="worldview"});return l.length?`${i.slice(0,t)}?${l.join("&")}`:i.slice(0,t)}let _e=1/0;function Ze(i){_e++,_e>Yt&&(i.getActor().send("enforceCacheSizeLimit",wt),_e=0)}const Se={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Se);class Me extends Error{constructor(t,r,l){r===401&&Hn(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=r,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ze=te()?()=>self.worker&&self.worker.referrer:()=>(m.location.protocol==="blob:"?m.parent:m).location.href,Je=function(i,t){if(!(/^file:/.test(r=i.url)||/^file:/.test(ze())&&!/^\w+:/.test(r))){if(m.fetch&&m.Request&&m.AbortController&&m.Request.prototype.hasOwnProperty("signal"))return function(l,u){const h=new m.AbortController,p=new m.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ze(),referrerPolicy:l.referrerPolicy,signal:h.signal});let g=!1,v=!1;const b=(x=p.url).indexOf("sku=")>0&&Hn(x);var x;l.type==="json"&&p.headers.set("Accept","application/json");const S=(P,R,z)=>{if(v)return;if(P&&P.message!=="SecurityError"&&ve(P.toString()),R&&z)return T(R);const U=Date.now();m.fetch(p).then(W=>{if(W.ok){const j=b?W.clone():null;return T(W,j,U)}return u(new Me(W.statusText,W.status,l.url))}).catch(W=>{W.name!=="AbortError"&&u(new Error(`${W.message} ${l.url}`))})},T=(P,R,z)=>{(l.type==="arrayBuffer"?P.arrayBuffer():l.type==="json"?P.json():P.text()).then(U=>{v||(R&&z&&function(W,j,Z){if(Dt(),!Ge)return;const Y={status:j.status,statusText:j.statusText,headers:new m.Headers};j.headers.forEach((ae,se)=>Y.headers.set(se,ae));const $=Oe(j.headers.get("Cache-Control")||"");if($["no-store"])return;$["max-age"]&&Y.headers.set("Expires",new Date(Z+1e3*$["max-age"]).toUTCString());const K=Y.headers.get("Expires");K&&(new Date(K).getTime()-Z<42e4||function(ae,se){if(It===void 0)try{new Response(new ReadableStream),It=!0}catch{It=!1}It?se(ae.body):ae.blob().then(se)}(j,ae=>{const se=new m.Response(ae,Y);Dt(),Ge&&Ge.then(de=>de.put(fn(W.url),se)).catch(de=>ve(de.message))}))}(p,R,z),g=!0,u(null,U,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(U=>{v||u(new Error(U.message))})};return b?function(P,R){if(Dt(),!Ge)return R(null);const z=fn(P.url);Ge.then(U=>{U.match(z).then(W=>{const j=function(Z){if(!Z)return!1;const Y=new Date(Z.headers.get("Expires")||0),$=Oe(Z.headers.get("Cache-Control")||"");return Y>Date.now()&&!$["no-cache"]}(W);U.delete(z),j&&U.put(z,W.clone()),R(null,W,j)}).catch(R)}).catch(R)}(p,S):S(null,null),{cancel:()=>{v=!0,g||h.abort()}}}(i,t);if(te()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var r;return function(l,u){const h=new m.XMLHttpRequest;h.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const p in l.headers)h.setRequestHeader(p,l.headers[p]);return l.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=l.credentials==="include",h.onerror=()=>{u(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let p=h.response;if(l.type==="json")try{p=JSON.parse(h.response)}catch(g){return u(g)}u(null,p,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else u(new Me(h.statusText,h.status,l.url))},h.send(l.body),{cancel:()=>h.abort()}}(i,t)},et=function(i,t){return Je(Ue(i,{type:"json"}),t)},yt=function(i,t){return Je(Ue(i,{type:"arrayBuffer"}),t)};function ut(i){const t=m.document.createElement("a");return t.href=i,t.protocol===m.document.location.protocol&&t.host===m.document.location.host}const ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Gt,Mt;Gt=[],Mt=0;const Qt=function(i,t){if(A.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Mt>=w.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Gt.push(h),h}Mt++;let r=!1;const l=()=>{if(!r)for(r=!0,Mt--;Gt.length&&Mt<w.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Gt.shift(),{requestParameters:p,callback:g,cancelled:v}=h;v||(h.cancel=Qt(p,g).cancel)}},u=yt(i,(h,p,g,v)=>{l(),h?t(h):p&&(m.createImageBitmap?function(b,x){const S=new m.Blob([new Uint8Array(b)],{type:"image/png"});m.createImageBitmap(S).then(T=>{x(null,T)}).catch(T=>{x(new Error(`Could not load image because of ${T.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(b,x)=>t(b,x,g,v)):function(b,x){const S=new m.Image,T=m.URL;S.onload=()=>{x(null,S),T.revokeObjectURL(S.src),S.onload=null,m.requestAnimationFrame(()=>{S.src=ct})},S.onerror=()=>x(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new m.Blob([new Uint8Array(b)],{type:"image/png"});S.src=b.byteLength?T.createObjectURL(P):ct}(p,(b,x)=>t(b,x,g,v)))});return{cancel:()=>{u.cancel(),l()}}},mn="NO_ACCESS_TOKEN";class nn{constructor(t,r,l){this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const t=function(){let r="";for(let l=0;l<10;l++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}normalizeStyleURL(t,r){if(!wn(t))return t;const l=pi(t);return l.params.push(`sdk=js-${y}`),l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeGlyphsURL(t,r){if(!wn(t))return t;const l=pi(t);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeModelURL(t,r){if(!wn(t))return t;const l=pi(t);return l.path=`/models/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeSourceURL(t,r,l,u){if(!wn(t))return t;const h=pi(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),l&&h.params.push(`language=${l}`),u&&h.params.push(`worldview=${u}`),this._makeAPIURL(h,this._customAccessToken||r)}normalizeSpriteURL(t,r,l,u){const h=pi(t);return wn(t)?(h.path=`/styles/v1${h.path}/sprite${r}${l}`,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=`${r}${l}`,Le(h))}normalizeTileURL(t,r,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!wn(t))return t;const u=pi(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||l&&u.authority!=="raster"&&l===512?"@2x":""}${A.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${w.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${w.TILE_URL_VERSION}${u.path}`);const h=this._customAccessToken||function(p){for(const g of p){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(u.params)||w.ACCESS_TOKEN;return w.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,h)}canonicalizeTileURL(t,r){const l=pi(t);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return t;let u="mapbox://";l.path.match(/^\/raster\/v1\//)?u+=`raster/${l.path.replace(`/${w.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${l.path.replace(`/${w.TILE_URL_VERSION}/`,"")}`;let h=l.params;return r&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(u+=`?${h.join("&")}`),u}canonicalizeTileset(t,r){const l=!!r&&wn(r),u=[];for(const h of t.tiles||[])Hn(h)?u.push(this.canonicalizeTileURL(h,l)):u.push(h);return u}_makeAPIURL(t,r){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=pi(w.API_URL);if(t.protocol=u.protocol,t.authority=u.authority,t.protocol==="http"){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(u.path!=="/"&&(t.path=`${u.path}${t.path}`),!w.REQUIRE_ACCESS_TOKEN)return Le(t);if(r=r||w.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${r||""}`),Le(t)}}function wn(i){return i.indexOf("mapbox:")===0}function Hn(i){return w.API_URL_REGEX.test(i)}function fa(i){return w.API_CDN_URL_REGEX.test(i)}function Ca(i){return w.API_STYLE_REGEX.test(i)&&!Ma(i)}function Ma(i){return w.API_SPRITE_REGEX.test(i)}const Ii=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function pi(i){const t=i.match(Ii);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Le(i){const t=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${t}`}const _t="mapbox.eventData";function kt(i){if(!i)return null;const t=i.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(m.atob(t[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Tt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const r=kt(w.ACCESS_TOKEN);let l="";return l=r&&r.u?m.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,h)=>String.fromCharCode(+("0x"+h)))):w.ACCESS_TOKEN||"",t?`${_t}.${t}:${l}`:`${_t}:${l}`}fetchEventData(){const t=st("localStorage"),r=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const u=m.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const h=m.localStorage.getItem(l);h&&(this.anonId=h)}catch{ve("Unable to read from LocalStorage")}}saveEventData(){const t=st("localStorage"),r=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{m.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&m.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{ve("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,r,l,u){if(!w.EVENTS_URL)return;const h=pi(w.EVENTS_URL);h.params.push(`access_token=${u||w.ACCESS_TOKEN||""}`);const p={event:this.type,created:new Date(t).toISOString()},g=r?Ue(p,r):p,v={url:Le(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(b,x){return Je(Ue(b,{method:"POST"}),x)}(v,b=>{this.pendingRequest=null,l(b),this.saveEventData(),this.processRequests(u)})}queueRequest(t,r){this.queue.push(t),this.processRequests(r)}}const Ot=new class extends Tt{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,t){w.EVENTS_URL&&w.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>wn(r)||Hn(r))&&this.queueRequest(Date.now(),t)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=kt(w.ACCESS_TOKEN),r=t?t.u:w.ACCESS_TOKEN;let l=r!==this.eventData.tokenU;Pe(this.anonId)||(this.anonId=Jt(),l=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const h=new Date(this.eventData.lastSuccess),p=new Date(u),g=(u-this.eventData.lastSuccess)/864e5;l=l||g>=1||g<-1||h.getDate()!==p.getDate()}else l=!0;l?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,"enabled.telemetry":!1,userId:this.anonId},h=>{h||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},i):this.processRequests()}},ln=Ot.postTurnstileEvent.bind(Ot),Tn=new class extends Tt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,t,r,l){this.skuToken=t,this.errorCb=l,w.EVENTS_URL&&(r||w.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(mn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Pe(this.anonId)||(this.anonId=Jt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},i))}},qn=Tn.postMapLoadEvent.bind(Tn),an=new class extends Tt{constructor(){super("gljs.performance")}postPerformanceEvent(i,t){w.EVENTS_URL&&(i||w.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:r}=this.queue.shift(),l=function(u){const h=m.performance.getEntriesByType("resource"),p=m.performance.getEntriesByType("mark"),g=function(T){const P={};if(T){for(const R in T)if(R!=="other")for(const z of T[R]){const U=`${R}ResolveRangeMin`,W=`${R}ResolveRangeMax`,j=`${R}RequestCount`,Z=`${R}RequestCachedCount`;P[U]=Math.min(P[U]||1/0,z.startTime),P[W]=Math.max(P[W]||-1/0,z.responseEnd);const Y=$=>{P[$]===void 0&&(P[$]=0),++P[$]};z.transferSize!==void 0&&z.transferSize===0&&Y(Z),Y(j)}}return P}(function(T,P){const R={};if(T)for(const z of T){const U=P(z);R[U]===void 0&&(R[U]=[]),R[U].push(z)}return R}(h,ta)),v=m.devicePixelRatio,b=m.navigator.connection||m.navigator.mozConnection||m.navigator.webkitConnection,x={counters:[],metadata:[],attributes:[]},S=(T,P,R)=>{R!=null&&T.push({name:P,value:R.toString()})};for(const T in g)S(x.counters,T,g[T]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(S(x.counters,"interactionRangeMin",u.interactionRange[0]),S(x.counters,"interactionRangeMax",u.interactionRange[1])),p)for(const T of Object.keys(ei)){const P=ei[T],R=p.find(z=>z.name===P);R&&S(x.counters,P,R.startTime)}return S(x.counters,"visibilityHidden",u.visibilityHidden),S(x.attributes,"style",function(T){if(T)for(const P of T){const R=P.name.split("?")[0];if(Ca(R)){const z=R.split("/").slice(-2);if(z.length===2)return`mapbox://styles/${z[0]}/${z[1]}`}}}(h)),S(x.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),S(x.attributes,"fogEnabled",u.fogEnabled?"true":"false"),S(x.attributes,"projection",u.projection),S(x.attributes,"zoom",u.zoom),S(x.metadata,"devicePixelRatio",v),S(x.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),S(x.metadata,"navigatorUserAgent",m.navigator.userAgent),S(x.metadata,"screenWidth",m.screen.width),S(x.metadata,"screenHeight",m.screen.height),S(x.metadata,"windowWidth",m.innerWidth),S(x.metadata,"windowHeight",m.innerHeight),S(x.metadata,"mapWidth",u.width/v),S(x.metadata,"mapHeight",u.height/v),S(x.metadata,"webglRenderer",u.renderer),S(x.metadata,"webglVendor",u.vendor),S(x.metadata,"sdkVersion",y),S(x.metadata,"sdkIdentifier","mapbox-gl-js"),x}(r);for(const u of l.metadata);for(const u of l.counters);for(const u of l.attributes);this.postEvent(t,l,()=>{},i)}},sa=an.postPerformanceEvent.bind(an),pa=new class extends Tt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,t,r,l){if(!w.API_URL||!w.SESSION_PATH)return;const u=pi(w.API_URL+w.SESSION_PATH);u.params.push(`sku=${t||""}`),u.params.push(`access_token=${l||w.ACCESS_TOKEN||""}`);const h={url:Le(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(p,g){return Je(Ue(p,{method:"GET"}),g)}(h,p=>{this.pendingRequest=null,r(p),this.saveEventData(),this.processRequests(l)})}getSessionAPI(i,t,r,l){this.skuToken=t,this.errorCb=l,w.SESSION_PATH&&w.API_URL&&(r||w.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(mn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},i)}},ia=pa.getSessionAPI.bind(pa),ni=new Set;function _r(i,t){t?ni.add(i):ni.delete(i)}const ei={create:"create",load:"load",fullLoad:"fullLoad"},Xi={mark(i){m.performance.mark(i)},measure(i,t,r){m.performance.measure(i,t,r)}};function ta(i){const t=i.name.split("?")[0];return fa(t)&&t.includes("mapbox-gl.js")?"javascript":fa(t)&&t.includes("mapbox-gl.css")?"css":function(r){return w.API_FONTS_REGEX.test(r)}(t)?"fontRange":Ma(t)?"sprite":Ca(t)?"style":function(r){return w.API_TILEJSON_REGEX.test(r)}(t)?"tilejson":"other"}const Rn=m.performance;function lo(i){const t=i?i.url.toString():void 0;return Rn.getEntriesByName(t)}var Ra=Ei;function Ei(i){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,u,h=new Blob([""],{type:"text/javascript"}),p=URL.createObjectURL(h);try{u=new Worker(p),l=!0}catch{l=!1}return u&&u.terminate(),URL.revokeObjectURL(p),l}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var l=document.createElement("canvas");l.width=l.height=1;var u=l.getContext("2d");if(!u)return!1;var h=u.getImageData(0,0,1,1);return h&&h.width===l.width}()?(Uo[r=t&&t.failIfMajorPerformanceCaveat]===void 0&&(Uo[r]=function(l){var u,h=function(p){var g=document.createElement("canvas"),v=Object.create(Ei.webGLContextAttributes);return v.failIfMajorPerformanceCaveat=p,g.getContext("webgl",v)||g.getContext("experimental-webgl",v)}(l);if(!h)return!1;try{u=h.createShader(h.VERTEX_SHADER)}catch{return!1}return!(!u||h.isContextLost())&&(h.shaderSource(u,"void main() {}"),h.compileShader(u),h.getShaderParameter(u,h.COMPILE_STATUS)===!0)}(r)),Uo[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}(i)}var Uo={};let br,Zi,ci,Dr;Ei.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Cn={now:()=>ci!==void 0?ci:m.performance.now(),setNow(i){ci=i},restoreNow(){ci=void 0},frame(i){const t=m.requestAnimationFrame(i);return{cancel:()=>m.cancelAnimationFrame(t)}},getImageData(i,t=0){const{width:r,height:l}=i;Dr||(Dr=m.document.createElement("canvas"));const u=Dr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>Dr.width||l>Dr.height)&&(Dr.width=r,Dr.height=l),u.clearRect(-t,-t,r+2*t,l+2*t),u.drawImage(i,0,0,r,l),u.getImageData(-t,-t,r+2*t,l+2*t)},resolveURL:i=>(br||(br=m.document.createElement("a")),br.href=i,br.href),get devicePixelRatio(){return m.devicePixelRatio},get prefersReducedMotion(){return!!m.matchMedia&&(Zi==null&&(Zi=m.matchMedia("(prefers-reduced-motion: reduce)")),Zi.matches)}};function Yn(i,t,r){const l=m.document.createElement(i);return t!==void 0&&(l.className=t),r&&r.appendChild(l),l}function Vi(i,t,r){const l=m.document.createElementNS("http://www.w3.org/2000/svg",i);for(const u of Object.keys(t))l.setAttributeNS(null,u,t[u]);return r&&r.appendChild(l),l}const xr=m.document&&m.document.documentElement.style,Ss=xr&&xr.userSelect!==void 0?"userSelect":"WebkitUserSelect";let yu;function Ip(){xr&&Ss&&(yu=xr[Ss],xr[Ss]="none")}function Jl(){xr&&Ss&&(xr[Ss]=yu)}function Sl(i){i.preventDefault(),i.stopPropagation(),m.removeEventListener("click",Sl,!0)}function Al(){m.addEventListener("click",Sl,!0),m.setTimeout(()=>{m.removeEventListener("click",Sl,!0)},0)}function El(i,t){const r=i.getBoundingClientRect();return Ql(i,r,t)}function xd(i,t){const r=i.getBoundingClientRect(),l=[];for(let u=0;u<t.length;u++)l.push(Ql(i,r,t[u]));return l}function Gh(i){return m.InstallTrigger!==void 0&&i.button===2&&i.ctrlKey&&m.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:i.button}function Ql(i,t,r){const l=i.offsetWidth===t.width?1:i.offsetWidth/t.width;return new V((r.clientX-t.left)*l,(r.clientY-t.top)*l)}function wd(i,t,r){r[i]&&r[i].indexOf(t)!==-1||(r[i]=r[i]||[],r[i].push(t))}function $s(i,t,r){if(r&&r[i]){const l=r[i].indexOf(t);l!==-1&&r[i].splice(l,1)}}class Ht{constructor(t,r={}){Ue(this,r),this.type=t}}class vn extends Ht{constructor(t,r={}){super("error",Ue({error:t},r))}}class Bn{on(t,r){return this._listeners=this._listeners||{},wd(t,r,this._listeners),this}off(t,r){return $s(t,r,this._listeners),$s(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},wd(t,r,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,r){typeof t=="string"&&(t=new Ht(t,r||{}));const l=t.type;if(this.listens(l)){t.target=this;const u=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const g of u)g.call(this,t);const h=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const g of h)$s(l,g,this._oneTimeListeners),g.call(this,t);const p=this._eventedParent;p&&(Ue(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(t))}else t instanceof vn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var tt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class sn{constructor(t,r,l,u){this.message=(t?`${t}: `:"")+l,u&&(this.identifier=u),r!=null&&r.__line__&&(this.line=r.__line__)}}class qs extends sn{}function As(i,...t){for(const r of t)for(const l in r)i[l]=r[l];return i}function Bi(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function ai(i){if(Array.isArray(i))return i.map(ai);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const r in i)t[r]=ai(i[r]);return t}return Bi(i)}class Sd extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}var Es=Sd;class xo{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[l,u]of r)this.bindings[l]=u}concat(t){return new xo(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Lp=xo;const Xs={kind:"null"},tn={kind:"number"},ma={kind:"string"},xa={kind:"boolean"},Yi={kind:"color"},Or={kind:"object"},na={kind:"value"},Wo={kind:"collator"},Cc={kind:"formatted"},Pc={kind:"resolvedImage"};function Li(i,t){return{kind:"array",itemType:i,N:t}}function ui(i){if(i.kind==="array"){const t=ui(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Ad=[Xs,tn,ma,xa,Yi,Cc,Or,Li(na),Pc];function Ml(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ml(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const r of Ad)if(!Ml(r,t))return null}}return`Expected ${ui(i)} but found ${ui(t)} instead.`}function wo(i,t){return t.some(r=>r.kind===i.kind)}function dr(i,t){return t.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}var vu,Zs={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Tl(i){return(i=Math.round(i))<0?0:i>255?255:i}function _u(i){return Tl(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Ed(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function zr(i,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?i+(t-i)*r*6:2*r<1?t:3*r<2?i+(t-i)*(2/3-r)*6:i}try{vu={}.parseCSSColor=function(i){var t,r=i.replace(/ /g,"").toLowerCase();if(r in Zs)return Zs[r].slice();if(r[0]==="#")return r.length===4?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:r.length===7&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=r.indexOf("("),u=r.indexOf(")");if(l!==-1&&u+1===r.length){var h=r.substr(0,l),p=r.substr(l+1,u-(l+1)).split(","),g=1;switch(h){case"rgba":if(p.length!==4)return null;g=Ed(p.pop());case"rgb":return p.length!==3?null:[_u(p[0]),_u(p[1]),_u(p[2]),g];case"hsla":if(p.length!==4)return null;g=Ed(p.pop());case"hsl":if(p.length!==3)return null;var v=(parseFloat(p[0])%360+360)%360/360,b=Ed(p[1]),x=Ed(p[2]),S=x<=.5?x*(b+1):x+b-x*b,T=2*x-S;return[Tl(255*zr(T,S,v+1/3)),Tl(255*zr(T,S,v)),Tl(255*zr(T,S,v-1/3)),g];default:return null}}return null}}catch{}class Mi{constructor(t,r,l,u=1){this.r=t,this.g=r,this.b=l,this.a=u}static parse(t){if(!t)return;if(t instanceof Mi)return t;if(typeof t!="string")return;const r=vu(t);return r?new Mi(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,r,l,u]=this.toArray();return`rgba(${Math.round(t)},${Math.round(r)},${Math.round(l)},${u})`}toArray(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[255*t/u,255*r/u,255*l/u,u]}toArray01(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[t/u,r/u,l/u,u]}toArray01Scaled(t){const{r,g:l,b:u,a:h}=this;return h===0?[0,0,0]:[r/h*t,l/h*t,u/h*t]}toArray01PremultipliedAlpha(){const{r:t,g:r,b:l,a:u}=this;return[t,r,l,u]}toArray01Linear(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(t/u,2.2),Math.pow(r/u,2.2),Math.pow(l/u,2.2),u]}}Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0),Mi.red=new Mi(1,0,0,1),Mi.blue=new Mi(0,0,1,1);var xn=Mi;class tr{constructor(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vo{constructor(t,r,l,u,h){this.text=t.normalize?t.normalize():t,this.image=r,this.scale=l,this.fontStack=u,this.textColor=h}}class wr{constructor(t){this.sections=t}static fromString(t){return new wr([new Vo(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof wr?t:wr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const r of this.sections){if(r.image){t.push(["image",r.image.namePrimary]);continue}t.push(r.text);const l={};r.fontStack&&(l["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(l["font-scale"]=r.scale),r.textColor&&(l["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(l)}return t}}class Jo{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,r){return t?new Jo({namePrimary:t,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function p_(i,t,r,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,r,l]:[i,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qo(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof xn||i instanceof tr||i instanceof wr||i instanceof Jo)return!0;if(Array.isArray(i)){for(const t of i)if(!Qo(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Qo(i[t]))return!1;return!0}return!1}function Ti(i){if(i===null)return Xs;if(typeof i=="string")return ma;if(typeof i=="boolean")return xa;if(typeof i=="number")return tn;if(i instanceof xn)return Yi;if(i instanceof tr)return Wo;if(i instanceof wr)return Cc;if(i instanceof Jo)return Pc;if(Array.isArray(i)){const t=i.length;let r;for(const l of i){const u=Ti(l);if(r){if(r===u)continue;r=na;break}r=u}return Li(r||na,t)}return Or}function bu(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof xn||i instanceof wr||i instanceof Jo?i.toString():JSON.stringify(i)}class qg{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Qo(t[1]))return r.error("invalid value");const l=t[1];let u=Ti(l);const h=r.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new qg(u,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xn?["rgba"].concat(this.value.toArray()):this.value instanceof wr?this.value.serialize():this.value}}var xu=qg,Sr=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Xg={string:ma,number:tn,boolean:xa,object:Or};class Rp{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let l,u=1;const h=t[0];if(h==="array"){let g,v;if(t.length>2){const b=t[1];if(typeof b!="string"||!(b in Xg)||b==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);g=Xg[b],u++}else g=na;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);v=t[2],u++}l=Li(g,v)}else l=Xg[h];const p=[];for(;u<t.length;u++){const g=r.parse(t[u],u,na);if(!g)return null;p.push(g)}return new Rp(l,p)}evaluate(t){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(t);if(!Ml(this.type,Ti(l)))return l;if(r===this.args.length-1)throw new Sr(`Expected value to be of type ${ui(this.type)}, but found ${ui(Ti(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,r=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){r.push(l.kind);const u=t.N;(typeof u=="number"||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(l=>l.serialize()))}}var Ys=Rp;class Hh{constructor(t){this.type=Cc,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const u=[];let h=!1;for(let p=1;p<=t.length-1;++p){const g=t[p];if(h&&typeof g=="object"&&!Array.isArray(g)){h=!1;let v=null;if(g["font-scale"]&&(v=r.parse(g["font-scale"],1,tn),!v))return null;let b=null;if(g["text-font"]&&(b=r.parse(g["text-font"],1,Li(ma)),!b))return null;let x=null;if(g["text-color"]&&(x=r.parse(g["text-color"],1,Yi),!x))return null;const S=u[u.length-1];S.scale=v,S.font=b,S.textColor=x}else{const v=r.parse(t[p],1,na);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new Hh(u)}evaluate(t){return new wr(this.sections.map(r=>{const l=r.content.evaluate(t);return Ti(l)===Pc?new Vo("",l,null,null,null):new Vo(bu(l),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const r of this.sections){t.push(r.content.serialize());const l={};r.scale&&(l["font-scale"]=r.scale.serialize()),r.font&&(l["text-font"]=r.font.serialize()),r.textColor&&(l["text-color"]=r.textColor.serialize()),t.push(l)}return t}}class jh{constructor(t,r){this.type=Pc,this.inputPrimary=t,this.inputSecondary=r}static parse(t,r){if(t.length<2)return r.error("Expected two or more arguments.");const l=r.parse(t[1],1,ma);if(!l)return r.error("No image name provided.");if(t.length===2)return new jh(l);const u=r.parse(t[2],1,ma);return u?new jh(l,u):r.error("Secondary image variant is not a string.")}evaluate(t){const r=Jo.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&t.availableImages&&(r.available=t.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ka(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}const m_={"to-boolean":xa,"to-color":Yi,"to-number":tn,"to-string":ma};class wu{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[0],u=[];let h=Xs;if(l==="to-array"){if(!Array.isArray(t[1]))return null;const p=t[1].length;if(r.expectedType){if(r.expectedType.kind!=="array")return r.error(`Expected ${r.expectedType.kind} but found array.`);h=Li(r.expectedType.itemType,p)}else{if(!(p>0&&Qo(t[1][0])))return null;h=Li(Ti(t[1][0]),p)}for(let g=0;g<p;g++){const v=t[1][g];let b;if(ka(v)==="array")b=r.parse(v,void 0,h.itemType);else{const x=ka(v);if(x!==h.itemType.kind)return r.error(`Expected ${h.itemType.kind} but found ${x}.`);b=r.registry.literal.parse(["literal",v===void 0?null:v],r)}if(!b)return null;u.push(b)}}else{if((l==="to-boolean"||l==="to-string")&&t.length!==2)return r.error("Expected one argument.");h=m_[l];for(let p=1;p<t.length;p++){const g=r.parse(t[p],p,na);if(!g)return null;u.push(g)}}return new wu(h,u)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let r,l;for(const u of this.args){if(r=u.evaluate(t),l=null,r instanceof xn)return r;if(typeof r=="string"){const h=t.parseColor(r);if(h)return h}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:p_(r[0],r[1],r[2],r[3]),!l))return new xn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Sr(l||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const l of this.args){if(r=l.evaluate(t),r===null)return 0;const u=Number(r);if(!isNaN(u))return u}throw new Sr(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?wr.fromString(bu(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Jo.fromString(bu(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(r=>r.evaluate(t)):bu(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Hh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new jh(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Ks=wu;const Zg=["Unknown","Point","LineString","Polygon"];var kp=class{constructor(i){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=i}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Zg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-i[0])+this.featureDistanceData.bearing[1]*(l*t-i[1])}return 0}parseColor(i){let t=this._parseColorCache[i];return t||(t=this._parseColorCache[i]=xn.parse(i)),t}getConfig(i){return this.options?this.options.get(i):null}};class So{constructor(t,r,l,u){this.name=t,this.type=r,this._evaluate=l,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,r){const l=t[0],u=So.definitions[l];if(!u)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(u)?u[0]:u.type,p=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=p.filter(([b])=>!Array.isArray(b)||b.length===t.length-1);let v=null;for(const[b,x]of g){v=new sy(r.registry,r.path,null,r.scope,void 0,r.options);const S=[];let T=!1;for(let P=1;P<t.length;P++){const R=t[P],z=Array.isArray(b)?b[P-1]:b.type,U=v.parse(R,1+S.length,z);if(!U){T=!0;break}S.push(U)}if(!T)if(Array.isArray(b)&&b.length!==S.length)v.error(`Expected ${b.length} arguments, but found ${S.length} instead.`);else{for(let P=0;P<S.length;P++){const R=Array.isArray(b)?b[P]:b.type,z=S[P];v.concat(P+1).checkSubtype(R,z.type)}if(v.errors.length===0)return new So(l,h,x,S)}}if(g.length===1)r.errors.push(...v.errors);else{const b=(g.length?g:p).map(([S])=>{return T=S,Array.isArray(T)?`(${T.map(ui).join(", ")})`:`(${ui(T.type)}...)`;var T}).join(" | "),x=[];for(let S=1;S<t.length;S++){const T=r.parse(t[S],1+x.length);if(!T)return null;x.push(ui(T.type))}r.error(`Expected arguments of type ${b}, but found (${x.join(", ")}) instead.`)}return null}static register(t,r){So.definitions=r;for(const l in r)t[l]=So}}var Ar=So;class ec{constructor(t,r,l){this.type=Wo,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const u=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,xa);if(!u)return null;const h=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,xa);if(!h)return null;let p=null;return l.locale&&(p=r.parse(l.locale,1,ma),!p)?null:new ec(u,h,p)}evaluate(t){return new tr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var tc={exports:{}};tc.exports=function(){function i(l,u,h,p,g){for(;p>h;){if(p-h>600){var v=p-h+1,b=u-h+1,x=Math.log(v),S=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*S*(v-S)/v)*(b-v/2<0?-1:1);i(l,u,Math.max(h,Math.floor(u-b*S/v+T)),Math.min(p,Math.floor(u+(v-b)*S/v+T)),g)}var P=l[u],R=h,z=p;for(t(l,h,u),g(l[p],P)>0&&t(l,h,p);R<z;){for(t(l,R,z),R++,z--;g(l[R],P)<0;)R++;for(;g(l[z],P)>0;)z--}g(l[h],P)===0?t(l,h,z):t(l,++z,p),z<=u&&(h=z+1),u<=z&&(p=z-1)}}function t(l,u,h){var p=l[u];l[u]=l[h],l[h]=p}function r(l,u){return l<u?-1:l>u?1:0}return function(l,u,h,p,g){i(l,u,h||0,p||l.length-1,g||r)}}();var Ic=F(tc.exports);function Md(i){let t=0;for(let r,l,u=0,h=i.length,p=h-1;u<h;p=u++)r=i[u],l=i[p],t+=(l.x-r.x)*(r.y+l.y);return t}function $h(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Td(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function g_(i,t,r){const l=i[0]-t[0],u=i[1]-t[1],h=i[0]-r[0],p=i[1]-r[1];return l*p-h*u==0&&l*h<=0&&u*p<=0}function co(i,t,r=!1){let l=!1;for(let g=0,v=t.length;g<v;g++){const b=t[g];for(let x=0,S=b.length,T=S-1;x<S;T=x++){const P=b[T],R=b[x];if(g_(i,P,R))return r;(h=P)[1]>(u=i)[1]!=(p=R)[1]>u[1]&&u[0]<(p[0]-h[0])*(u[1]-h[1])/(p[1]-h[1])+h[0]&&(l=!l)}}var u,h,p;return l}function es(i,t,r,l){const u=l[0]-r[0],h=l[1]-r[1],p=(i[0]-r[0])*h-u*(i[1]-r[1]),g=(t[0]-r[0])*h-u*(t[1]-r[1]);return p>0&&g<0||p<0&&g>0}function Ri(i,t,r,l){return(u=[l[0]-r[0],l[1]-r[1]])[0]*(h=[t[0]-i[0],t[1]-i[1]])[1]-u[1]*h[0]!=0&&!(!es(i,t,r,l)||!es(r,l,i,t));var u,h}const Js=8192;function Cl(i,t){const r=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(r*u*Js),Math.round(l*u*Js)]}function Hw(i,t){for(let r=0;r<t.length;r++)if(co(i,t[r]))return!0;return!1}function jw(i,t,r){for(const l of r)for(let u=0,h=l.length,p=h-1;u<h;p=u++)if(Ri(i,t,l[p],l[u]))return!0;return!1}function Yg(i,t){for(let r=0;r<i.length;++r)if(!co(i[r],t))return!1;for(let r=0;r<i.length-1;++r)if(jw(i[r],i[r+1],t))return!1;return!0}function y_(i,t){for(let r=0;r<t.length;r++)if(Yg(i,t[r]))return!0;return!1}function Kg(i,t,r){const l=[];for(let u=0;u<i.length;u++){const h=[];for(let p=0;p<i[u].length;p++){const g=Cl(i[u][p],r);$h(t,g),h.push(g)}l.push(h)}return l}function qh(i,t,r){const l=[];for(let u=0;u<i.length;u++){const h=Kg(i[u],t,r);l.push(h)}return l}function Cd(i,t,r,l){if(i[0]<r[0]||i[0]>r[2]){const u=.5*l;let h=i[0]-r[0]>u?-l:r[0]-i[0]>u?l:0;h===0&&(h=i[0]-r[2]>u?-l:r[2]-i[0]>u?l:0),i[0]+=h}$h(t,i)}function Jg(i,t,r,l){const u=Math.pow(2,l.z)*Js,h=[l.x*Js,l.y*Js],p=[];if(!i)return p;for(const g of i)for(const v of g){const b=[v.x+h[0],v.y+h[1]];Cd(b,t,r,u),p.push(b)}return p}function Xh(i,t,r,l){const u=Math.pow(2,l.z)*Js,h=[l.x*Js,l.y*Js],p=[];if(!i)return p;for(const v of i){const b=[];for(const x of v){const S=[x.x+h[0],x.y+h[1]];$h(t,S),b.push(S)}p.push(b)}if(t[2]-t[0]<=u/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of p)for(const b of v)Cd(b,t,r,u)}var g;return p}class Su{constructor(t,r){this.type=xa,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qo(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let u=0;u<l.features.length;++u){const h=l.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Su(l,l.features[u].geometry)}else if(l.type==="Feature"){const u=l.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Su(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Su(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,l){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(l.type==="Polygon"){const g=Kg(l.coordinates,h,p),v=Jg(r.geometry(),u,h,p);if(!Td(u,h))return!1;for(const b of v)if(!co(b,g))return!1}if(l.type==="MultiPolygon"){const g=qh(l.coordinates,h,p),v=Jg(r.geometry(),u,h,p);if(!Td(u,h))return!1;for(const b of v)if(!Hw(b,g))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,l){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(l.type==="Polygon"){const g=Kg(l.coordinates,h,p),v=Xh(r.geometry(),u,h,p);if(!Td(u,h))return!1;for(const b of v)if(!Yg(b,g))return!1}if(l.type==="MultiPolygon"){const g=qh(l.coordinates,h,p),v=Xh(r.geometry(),u,h,p);if(!Td(u,h))return!1;for(const b of v)if(!y_(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Qg=Su,v_={exports:{}};v_.exports=function(){var i={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,r=t*(2-t),l=Math.PI/180,u=function(b,x){if(b===void 0)throw new Error("No latitude given.");if(x&&!i[x])throw new Error("Unknown unit "+x+". Use one of: "+Object.keys(i).join(", "));var S=6378.137*l*(x?i[x]:1),T=Math.cos(b*l),P=1/(1-r*(1-T*T)),R=Math.sqrt(P);this.kx=S*R*T,this.ky=S*R*P*(1-r)},h={units:{configurable:!0}};function p(b,x){return b[0]===x[0]&&b[1]===x[1]}function g(b,x,S){var T=v(x[0]-b[0]);return[b[0]+T*S,b[1]+(x[1]-b[1])*S]}function v(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return u.fromTile=function(b,x,S){var T=Math.PI*(1-2*(b+.5)/Math.pow(2,x)),P=Math.atan(.5*(Math.exp(T)-Math.exp(-T)))/l;return new u(P,S)},h.units.get=function(){return i},u.prototype.distance=function(b,x){var S=v(b[0]-x[0])*this.kx,T=(b[1]-x[1])*this.ky;return Math.sqrt(S*S+T*T)},u.prototype.bearing=function(b,x){var S=v(x[0]-b[0])*this.kx;return Math.atan2(S,(x[1]-b[1])*this.ky)/l},u.prototype.destination=function(b,x,S){var T=S*l;return this.offset(b,Math.sin(T)*x,Math.cos(T)*x)},u.prototype.offset=function(b,x,S){return[b[0]+x/this.kx,b[1]+S/this.ky]},u.prototype.lineDistance=function(b){for(var x=0,S=0;S<b.length-1;S++)x+=this.distance(b[S],b[S+1]);return x},u.prototype.area=function(b){for(var x=0,S=0;S<b.length;S++)for(var T=b[S],P=0,R=T.length,z=R-1;P<R;z=P++)x+=v(T[P][0]-T[z][0])*(T[P][1]+T[z][1])*(S?-1:1);return Math.abs(x)/2*this.kx*this.ky},u.prototype.along=function(b,x){var S=0;if(x<=0)return b[0];for(var T=0;T<b.length-1;T++){var P=b[T],R=b[T+1],z=this.distance(P,R);if((S+=z)>x)return g(P,R,(x-(S-z))/z)}return b[b.length-1]},u.prototype.pointToSegmentDistance=function(b,x,S){var T=x[0],P=x[1],R=v(S[0]-T)*this.kx,z=(S[1]-P)*this.ky,U=0;return R===0&&z===0||((U=(v(b[0]-T)*this.kx*R+(b[1]-P)*this.ky*z)/(R*R+z*z))>1?(T=S[0],P=S[1]):U>0&&(T+=R/this.kx*U,P+=z/this.ky*U)),R=v(b[0]-T)*this.kx,z=(b[1]-P)*this.ky,Math.sqrt(R*R+z*z)},u.prototype.pointOnLine=function(b,x){for(var S,T,P,R,z=1/0,U=0;U<b.length-1;U++){var W=b[U][0],j=b[U][1],Z=v(b[U+1][0]-W)*this.kx,Y=(b[U+1][1]-j)*this.ky,$=0;Z===0&&Y===0||(($=(v(x[0]-W)*this.kx*Z+(x[1]-j)*this.ky*Y)/(Z*Z+Y*Y))>1?(W=b[U+1][0],j=b[U+1][1]):$>0&&(W+=Z/this.kx*$,j+=Y/this.ky*$));var K=(Z=v(x[0]-W)*this.kx)*Z+(Y=(x[1]-j)*this.ky)*Y;K<z&&(z=K,S=W,T=j,P=U,R=$)}return{point:[S,T],index:P,t:Math.max(0,Math.min(1,R))}},u.prototype.lineSlice=function(b,x,S){var T=this.pointOnLine(S,b),P=this.pointOnLine(S,x);if(T.index>P.index||T.index===P.index&&T.t>P.t){var R=T;T=P,P=R}var z=[T.point],U=T.index+1,W=P.index;!p(S[U],z[0])&&U<=W&&z.push(S[U]);for(var j=U+1;j<=W;j++)z.push(S[j]);return p(S[W],P.point)||z.push(P.point),z},u.prototype.lineSliceAlong=function(b,x,S){for(var T=0,P=[],R=0;R<S.length-1;R++){var z=S[R],U=S[R+1],W=this.distance(z,U);if((T+=W)>b&&P.length===0&&P.push(g(z,U,(b-(T-W))/W)),T>=x)return P.push(g(z,U,(x-(T-W))/W)),P;T>b&&P.push(U)}return P},u.prototype.bufferPoint=function(b,x){var S=x/this.ky,T=x/this.kx;return[b[0]-T,b[1]-S,b[0]+T,b[1]+S]},u.prototype.bufferBBox=function(b,x){var S=x/this.ky,T=x/this.kx;return[b[0]-T,b[1]-S,b[2]+T,b[3]+S]},u.prototype.insideBBox=function(b,x){return v(b[0]-x[0])>=0&&v(b[0]-x[2])<=0&&b[1]>=x[1]&&b[1]<=x[3]},Object.defineProperties(u,h),u}();var Au=F(v_.exports),__={exports:{}};__.exports=function(){var i=function(r,l){if(r===void 0&&(r=[]),l===void 0&&(l=t),this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function t(r,l){return r<l?-1:r>l?1:0}return i.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var r=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),r}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(r){for(var l=this.data,u=this.compare,h=l[r];r>0;){var p=r-1>>1,g=l[p];if(u(h,g)>=0)break;l[r]=g,r=p}l[r]=h},i.prototype._down=function(r){for(var l=this.data,u=this.compare,h=this.length>>1,p=l[r];r<h;){var g=1+(r<<1),v=l[g],b=g+1;if(b<this.length&&u(l[b],v)<0&&(g=b,v=l[b]),u(v,p)>=0)break;l[r]=v,r=g}l[r]=p},i}();var Pd=F(__.exports),dt=8192;function Zh(i,t){return t.dist-i.dist}const Eu=100,Qs=50;function ey(i){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==i[r])return!1;return!0}function Lc(i){return i[1]-i[0]+1}function nc(i,t){const r=i[1]>=i[0]&&i[1]<t;return r||console.warn("Distance Expression: Index is out of range"),r}function Dp(i,t){if(i[0]>i[1])return[null,null];const r=Lc(i);if(t){if(r===2)return[i,null];const l=Math.floor(r/2);return[[i[0],i[0]+l],[i[0]+l,i[1]]]}{if(r===1)return[i,null];const l=Math.floor(r/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}}function mi(i,t){const r=[1/0,1/0,-1/0,-1/0];if(!nc(t,i.length))return r;for(let l=t[0];l<=t[1];++l)$h(r,i[l]);return r}function Id(i){const t=[1/0,1/0,-1/0,-1/0];for(let r=0;r<i.length;++r)for(let l=0;l<i[r].length;++l)$h(t,i[r][l]);return t}function Mu(i,t,r){if(ey(i)||ey(t))return NaN;let l=0,u=0;return i[2]<t[0]&&(l=t[0]-i[2]),i[0]>t[2]&&(l=i[0]-t[2]),i[1]>t[3]&&(u=i[1]-t[3]),i[3]<t[1]&&(u=t[1]-i[3]),r.distance([0,0],[l,u])}function Op(i,t){const r=Math.pow(2,t.z);return[(u=(i.x/dt+t.x)/r,360*u-180),(l=(i.y/dt+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,u}function ty(i,t){const r=[];for(let l=0;l<i.length;++l)r.push(Op(i[l],t));return r}function Ms(i,t,r){const l=r.pointOnLine(t,i).point;return r.distance(i,l)}function Ld(i,t,r,l,u){const h=r.slice(l[0],l[1]+1);let p=1/0;for(let g=t[0];g<=t[1];++g)if((p=Math.min(p,Ms(i[g],h,u)))===0)return 0;return p}function Ki(i,t,r,l,u){const h=Math.min(u.pointToSegmentDistance(i,r,l),u.pointToSegmentDistance(t,r,l)),p=Math.min(u.pointToSegmentDistance(r,i,t),u.pointToSegmentDistance(l,i,t));return Math.min(h,p)}function Ro(i,t,r,l,u){if(!nc(t,i.length)||!nc(l,r.length))return NaN;let h=1/0;for(let p=t[0];p<t[1];++p)for(let g=l[0];g<l[1];++g){if(Ri(i[p],i[p+1],r[g],r[g+1]))return 0;h=Math.min(h,Ki(i[p],i[p+1],r[g],r[g+1],u))}return h}function uo(i,t,r,l,u){if(!nc(t,i.length)||!nc(l,r.length))return NaN;let h=1/0;for(let p=t[0];p<=t[1];++p)for(let g=l[0];g<=l[1];++g)if((h=Math.min(h,u.distance(i[p],r[g])))===0)return h;return h}function ny(i,t,r){if(co(i,t,!0))return 0;let l=1/0;for(const u of t){const h=u.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[h-1]&&(l=Math.min(l,r.pointToSegmentDistance(i,u[h-1],u[0])))===0||(l=Math.min(l,Ms(i,u,r)))===0)return l}return l}function zp(i,t,r,l){if(!nc(t,i.length))return NaN;for(let h=t[0];h<=t[1];++h)if(co(i[h],r,!0))return 0;let u=1/0;for(let h=t[0];h<t[1];++h)for(const p of r)for(let g=0,v=p.length,b=v-1;g<v;b=g++){if(Ri(i[h],i[h+1],p[b],p[g]))return 0;u=Math.min(u,Ki(i[h],i[h+1],p[b],p[g],l))}return u}function Yh(i,t){for(const r of i)for(let l=0;l<=r.length-1;++l)if(co(r[l],t,!0))return!0;return!1}function aC(i,t,r,l=1/0){const u=Id(i),h=Id(t);if(l!==1/0&&Mu(u,h,r)>=l)return l;if(Td(u,h)){if(Yh(i,t))return 0}else if(Yh(t,i))return 0;let p=l;for(const g of i)for(let v=0,b=g.length,x=b-1;v<b;x=v++)for(const S of t)for(let T=0,P=S.length,R=P-1;T<P;R=T++){if(Ri(g[x],g[v],S[R],S[T]))return 0;p=Math.min(p,Ki(g[x],g[v],S[R],S[T],r))}return p}function Zr(i,t,r,l,u,h,p){if(h===null||p===null)return;const g=Mu(mi(l,h),mi(u,p),r);g<t&&i.push({dist:g,range1:h,range2:p})}function b_(i,t,r,l,u=1/0){let h=Math.min(l.distance(i[0],r[0][0]),u);if(h===0)return h;const p=new Pd([{dist:0,range1:[0,i.length-1],range2:[0,0]}],Zh),g=t?Qs:Eu,v=Id(r);for(;p.length;){const b=p.pop();if(b.dist>=h)continue;const x=b.range1;if(Lc(x)<=g){if(!nc(x,i.length))return NaN;if(t){const S=zp(i,x,r,l);if((h=Math.min(h,S))===0)return h}else for(let S=x[0];S<=x[1];++S){const T=ny(i[S],r,l);if((h=Math.min(h,T))===0)return h}}else{const S=Dp(x,t);if(S[0]!==null){const T=Mu(mi(i,S[0]),v,l);T<h&&p.push({dist:T,range1:S[0],range2:[0,0]})}if(S[1]!==null){const T=Mu(mi(i,S[1]),v,l);T<h&&p.push({dist:T,range1:S[1],range2:[0,0]})}}}return h}function ay(i,t,r,l,u,h=1/0){let p=Math.min(h,u.distance(i[0],r[0]));if(p===0)return p;const g=new Pd([{dist:0,range1:[0,i.length-1],range2:[0,r.length-1]}],Zh),v=t?Qs:Eu,b=l?Qs:Eu;for(;g.length;){const x=g.pop();if(x.dist>=p)continue;const S=x.range1,T=x.range2;if(Lc(S)<=v&&Lc(T)<=b){if(!nc(S,i.length)||!nc(T,r.length))return NaN;if(t&&l?p=Math.min(p,Ro(i,S,r,T,u)):t||l?t&&!l?p=Math.min(p,Ld(r,T,i,S,u)):!t&&l&&(p=Math.min(p,Ld(i,S,r,T,u))):p=Math.min(p,uo(i,S,r,T,u)),p===0)return p}else{const P=Dp(S,t),R=Dp(T,l);Zr(g,p,u,i,r,P[0],R[0]),Zr(g,p,u,i,r,P[0],R[1]),Zr(g,p,u,i,r,P[1],R[0]),Zr(g,p,u,i,r,P[1],R[1])}}return p}function Fp(i,t,r,l,u=1/0){let h=u;const p=mi(i,[0,i.length-1]);for(const g of r)if(!(h!==1/0&&Mu(p,mi(g,[0,g.length-1]),l)>=h)&&(h=Math.min(h,ay(i,t,g,!0,l,h)),h===0))return h;return h}function el(i,t,r,l,u=1/0){let h=u;const p=mi(i,[0,i.length-1]);for(const g of r){if(h!==1/0&&Mu(p,Id(g),l)>=h)continue;const v=b_(i,t,g,l,h);if(isNaN(v))return v;if((h=Math.min(h,v))===0)return h}return h}function tl(i){return i==="Point"||i==="MultiPoint"||i==="LineString"||i==="MultiLineString"||i==="Polygon"||i==="MultiPolygon"}class Pl{constructor(t,r){this.type=tn,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Qo(t[1])){const l=t[1];if(l.type==="FeatureCollection"){for(let u=0;u<l.features.length;++u)if(tl(l.features[u].geometry.type))return new Pl(l,l.features[u].geometry)}else if(l.type==="Feature"){if(tl(l.geometry.type))return new Pl(l,l.geometry)}else if(tl(l.type))return new Pl(l,l)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const r=t.geometry(),l=t.canonicalID();if(r!=null&&l!=null){if(t.geometryType()==="Point")return function(u,h,p){const g=[];for(const b of u)for(const x of b)g.push(Op(x,h));const v=new Au(g[0][1],"meters");return p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString"?ay(g,!1,p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",v):p.type==="MultiLineString"?Fp(g,!1,p.coordinates,v):p.type==="Polygon"||p.type==="MultiPolygon"?el(g,!1,p.type==="Polygon"?[p.coordinates]:p.coordinates,v):null}(r,l,this.geometries);if(t.geometryType()==="LineString")return function(u,h,p){const g=[];for(const b of u){const x=[];for(const S of b)x.push(Op(S,h));g.push(x)}const v=new Au(g[0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return Fp(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",g,v);if(p.type==="MultiLineString"){let b=1/0;for(let x=0;x<p.coordinates.length;x++){const S=Fp(p.coordinates[x],!0,g,v,b);if(isNaN(S))return S;if((b=Math.min(b,S))===0)return b}return b}if(p.type==="Polygon"||p.type==="MultiPolygon"){let b=1/0;for(let x=0;x<g.length;x++){const S=el(g[x],!0,p.type==="Polygon"?[p.coordinates]:p.coordinates,v,b);if(isNaN(S))return S;if((b=Math.min(b,S))===0)return b}return b}return null}(r,l,this.geometries);if(t.geometryType()==="Polygon")return function(u,h,p){const g=[];for(const b of function(x,S){const T=x.length;if(T<=1)return[x];const P=[];let R,z;for(let U=0;U<T;U++){const W=Md(x[U]);W!==0&&(x[U].area=Math.abs(W),z===void 0&&(z=W<0),z===W<0?(R&&P.push(R),R=[x[U]]):R.push(x[U]))}return R&&P.push(R),P}(u)){const x=[];for(let S=0;S<b.length;++S)x.push(ty(b[S],h));g.push(x)}const v=new Au(g[0][0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return el(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",g,v);if(p.type==="MultiLineString"){let b=1/0;for(let x=0;x<p.coordinates.length;x++){const S=el(p.coordinates[x],!0,g,v,b);if(isNaN(S))return S;if((b=Math.min(b,S))===0)return b}return b}return p.type==="Polygon"||p.type==="MultiPolygon"?function(b,x,S){let T=1/0;for(const P of b)for(const R of x){const z=aC(P,R,S,T);if(isNaN(z))return z;if((T=Math.min(T,z))===0)return T}return T}(p.type==="Polygon"?[p.coordinates]:p.coordinates,g,v):null}(r,l,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Kh=Pl;function Tu(i){if(i instanceof Ar&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Qg||i instanceof Kh)return!1;let t=!0;return i.eachChild(r=>{t&&!Tu(r)&&(t=!1)}),t}function Np(i){if(i instanceof Ar&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(r=>{t&&!Np(r)&&(t=!1)}),t}function iy(i){if(i instanceof Ar&&i.name==="config")return!1;let t=!0;return i.eachChild(r=>{t&&!iy(r)&&(t=!1)}),t}function Rd(i,t){if(i instanceof Ar&&t.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(l=>{r&&!Rd(l,t)&&(r=!1)}),r}class ry{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=t[1];return r.scope.has(l)?new ry(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var x_=ry;class oy{constructor(t,r=[],l,u=new Lp,h=[],p){this.registry=t,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=h,this.expectedType=l,this.options=p}parse(t,r,l,u,h={}){return r||l?this.concat(r,l,u)._parse(t,h):this._parse(t,h)}_parse(t,r){function l(u,h,p){return p==="assert"?new Ys(h,[u]):p==="coerce"?new Ks(h,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(u){let h=u.parse(t,this);if(!h)return null;if(this.expectedType){const p=this.expectedType,g=h.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||g.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(p,g))return null}else h=l(h,p,r.typeAnnotation||"coerce");else h=l(h,p,r.typeAnnotation||"assert")}if(!(h instanceof xu)&&h.type.kind!=="resolvedImage"&&kd(h)){const p=new kp(this.options);try{h=new xu(h.type,h.evaluate(p))}catch(g){return this.error(g.message),null}}return h}return Ks.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,l){const u=typeof t=="number"?this.path.concat(t):this.path,h=l?this.scope.concat(l):this.scope;return new oy(this.registry,u,r||null,h,this.errors,this.options)}error(t,...r){const l=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Es(l,t))}checkSubtype(t,r){const l=Ml(t,r);return l&&this.error(l),l}}var sy=oy;function kd(i){if(i instanceof x_)return kd(i.boundExpression);if(i instanceof Ar&&i.name==="error"||i instanceof Ar&&i.name==="config"||i instanceof ec||i instanceof Qg||i instanceof Kh)return!1;const t=i instanceof Ks||i instanceof Ys;let r=!0;return i.eachChild(l=>{r=t?r&&kd(l):r&&l instanceof xu}),!!r&&Tu(i)&&Rd(i,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Bp(i,t){const r=i.length-1;let l,u,h=0,p=r,g=0;for(;h<=p;)if(g=Math.floor((h+p)/2),l=i[g],u=i[g+1],l<=t){if(g===r||t<u)return g;h=g+1}else{if(!(l>t))throw new Sr("Input is not a number.");p=g-1}return 0}class Jh{constructor(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[u,h]of l)this.labels.push(u),this.outputs.push(h)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(t[1],1,tn);if(!l)return null;const u=[];let h=null;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);for(let p=1;p<t.length;p+=2){const g=p===1?-1/0:t[p],v=t[p+1],b=p,x=p+1;if(typeof g!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(u.length&&u[u.length-1][0]>=g)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const S=r.parse(v,x,h);if(!S)return null;h=h||S.type,u.push([g,S])}return new Jh(h,l,u)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return l[0].evaluate(t);const h=r.length;return u>=r[h-1]?l[h-1].evaluate(t):l[Bp(r,u)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t}}var Qh=Jh;function Ln(i,t,r){return i*(1-r)+t*r}function ef(i,t,r){return i.map((l,u)=>Ln(l,t[u],r))}var Up=Object.freeze({__proto__:null,array:ef,color:function(i,t,r){return new xn(Ln(i.r,t.r,r),Ln(i.g,t.g,r),Ln(i.b,t.b,r),Ln(i.a,t.a,r))},number:Ln});const w_=.95047,S_=1.08883,A_=4/29,Cu=6/29,E_=3*Cu*Cu,$w=Cu*Cu*Cu,iC=Math.PI/180,qw=180/Math.PI;function M_(i){return i>$w?Math.pow(i,1/3):i/E_+A_}function T_(i){return i>Cu?i*i*i:E_*(i-A_)}function ly(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function cy(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function C_(i){const t=cy(i.r),r=cy(i.g),l=cy(i.b),u=M_((.4124564*t+.3575761*r+.1804375*l)/w_),h=M_((.2126729*t+.7151522*r+.072175*l)/1);return{l:116*h-16,a:500*(u-h),b:200*(h-M_((.0193339*t+.119192*r+.9503041*l)/S_)),alpha:i.a}}function P_(i){let t=(i.l+16)/116,r=isNaN(i.a)?t:t+i.a/500,l=isNaN(i.b)?t:t-i.b/200;return t=1*T_(t),r=w_*T_(r),l=S_*T_(l),new xn(ly(3.2404542*r-1.5371385*t-.4985314*l),ly(-.969266*r+1.8760108*t+.041556*l),ly(.0556434*r-.2040259*t+1.0572252*l),i.alpha)}function uy(i,t,r){const l=t-i;return i+r*(l>180||l<-180?l-360*Math.round(l/360):l)}const Wp={forward:C_,reverse:P_,interpolate:function(i,t,r){return{l:Ln(i.l,t.l,r),a:Ln(i.a,t.a,r),b:Ln(i.b,t.b,r),alpha:Ln(i.alpha,t.alpha,r)}}},Vp={forward:function(i){const{l:t,a:r,b:l}=C_(i),u=Math.atan2(l,r)*qw;return{h:u<0?u+360:u,c:Math.sqrt(r*r+l*l),l:t,alpha:i.a}},reverse:function(i){const t=i.h*iC,r=i.c;return P_({l:i.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:i.alpha})},interpolate:function(i,t,r){return{h:uy(i.h,t.h,r),c:Ln(i.c,t.c,r),l:Ln(i.l,t.l,r),alpha:Ln(i.alpha,t.alpha,r)}}};var Xw=Object.freeze({__proto__:null,hcl:Vp,lab:Wp});class tf{constructor(t,r,l,u,h){this.type=t,this.operator=r,this.interpolation=l,this.input=u,this.labels=[],this.outputs=[];for(const[p,g]of h)this.labels.push(p),this.outputs.push(g)}static interpolationFactor(t,r,l,u){let h=0;if(t.name==="exponential")h=Gp(r,t.base,l,u);else if(t.name==="linear")h=Gp(r,1,l,u);else if(t.name==="cubic-bezier"){const p=t.controlPoints;h=new q(p[0],p[1],p[2],p[3]).solve(Gp(r,1,l,u))}return h}static parse(t,r){let[l,u,h,...p]=t;if(!Array.isArray(u)||u.length===0)return r.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const b=u[1];if(typeof b!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:b}}else{if(u[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const b=u.slice(1);if(b.length!==4||b.some(x=>typeof x!="number"||x<0||x>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(h=r.parse(h,2,tn),!h)return null;const g=[];let v=null;l==="interpolate-hcl"||l==="interpolate-lab"?v=Yi:r.expectedType&&r.expectedType.kind!=="value"&&(v=r.expectedType);for(let b=0;b<p.length;b+=2){const x=p[b],S=p[b+1],T=b+3,P=b+4;if(typeof x!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(g.length&&g[g.length-1][0]>=x)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',T);const R=r.parse(S,P,v);if(!R)return null;v=v||R.type,g.push([x,R])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new tf(v,l,u,h,g):r.error(`Type ${ui(v)} is not interpolatable.`)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return l[0].evaluate(t);const h=r.length;if(u>=r[h-1])return l[h-1].evaluate(t);const p=Bp(r,u),g=tf.interpolationFactor(this.interpolation,u,r[p],r[p+1]),v=l[p].evaluate(t),b=l[p+1].evaluate(t);return this.operator==="interpolate"?Up[this.type.kind.toLowerCase()](v,b,g):this.operator==="interpolate-hcl"?Vp.reverse(Vp.interpolate(Vp.forward(v),Vp.forward(b),g)):Wp.reverse(Wp.interpolate(Wp.forward(v),Wp.forward(b),g))}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)r.push(this.labels[l],this.outputs[l].serialize());return r}}function Gp(i,t,r,l){const u=l-r,h=i-r;return u===0?0:t===1?h/u:(Math.pow(t,h)-1)/(Math.pow(t,u)-1)}var ac=tf;class dy{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let l=null;const u=r.expectedType;u&&u.kind!=="value"&&(l=u);const h=[];for(const g of t.slice(1)){const v=r.parse(g,1+h.length,l,void 0,{typeAnnotation:"omit"});if(!v)return null;l=l||v.type,h.push(v)}const p=u&&h.some(g=>Ml(u,g.type));return new dy(p?na:l,h)}evaluate(t){let r,l=null,u=0;for(const h of this.args){if(u++,l=h.evaluate(t),l&&l instanceof Jo&&!l.available&&(r||(r=l),l=null,u===this.args.length))return r;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var I_=dy;class hy{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let h=1;h<t.length-1;h+=2){const p=t[h];if(typeof p!="string")return r.error(`Expected string, but found ${typeof p} instead.`,h);if(/[^a-zA-Z0-9_]/.test(p))return r.error("Variable names must contain only alphanumeric characters or '_'.",h);const g=r.parse(t[h+1],h+1);if(!g)return null;l.push([p,g])}const u=r.parse(t[t.length-1],t.length-1,r.expectedType,l);return u?new hy(l,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[r,l]of this.bindings)t.push(r,l.serialize());return t.push(this.result.serialize()),t}}var L_=hy;class fy{constructor(t,r,l){this.type=t,this.index=r,this.input=l}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,tn),u=r.parse(t[2],2,Li(r.expectedType||na));return l&&u?new fy(u.type.itemType,l,u):null}evaluate(t){const r=this.index.evaluate(t),l=this.input.evaluate(t);if(r<0)throw new Sr(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new Sr(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new Sr(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var ic=fy;class py{constructor(t,r){this.type=xa,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,na);return l&&u?wo(l.type,[xa,ma,tn,Xs,na])?new py(l,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(l.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!dr(r,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${ui(Ti(r))} instead.`);if(!dr(l,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${ui(Ti(l))} instead.`);return l.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Hp=py;class Pu{constructor(t,r,l){this.type=tn,this.needle=t,this.haystack=r,this.fromIndex=l}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,na);if(!l||!u)return null;if(!wo(l.type,[xa,ma,tn,Xs,na]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ui(l.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,tn);return h?new Pu(l,u,h):null}return new Pu(l,u)}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!dr(r,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${ui(Ti(r))} instead.`);if(!dr(l,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${ui(Ti(l))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(t);return l.indexOf(r,u)}return l.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var my=Pu;class nf{constructor(t,r,l,u,h,p){this.inputType=t,this.type=r,this.input=l,this.cases=u,this.outputs=h,this.otherwise=p}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let l,u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const h={},p=[];for(let b=2;b<t.length-1;b+=2){let x=t[b];const S=t[b+1];Array.isArray(x)||(x=[x]);const T=r.concat(b);if(x.length===0)return T.error("Expected at least one branch label.");for(const R of x){if(typeof R!="number"&&typeof R!="string")return T.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return T.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return T.error("Numeric branch labels must be integer values.");if(l){if(T.checkSubtype(l,Ti(R)))return null}else l=Ti(R);if(h[String(R)]!==void 0)return T.error("Branch labels must be unique.");h[String(R)]=p.length}const P=r.parse(S,b,u);if(!P)return null;u=u||P.type,p.push(P)}const g=r.parse(t[1],1,na);if(!g)return null;const v=r.parse(t[t.length-1],t.length-1,u);return v?g.type.kind!=="value"&&r.concat(1).checkSubtype(l,g.type)?null:new nf(l,u,g,h,p,v):null}evaluate(t){const r=this.input.evaluate(t);return(Ti(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),l=[],u={};for(const p of r){const g=u[this.cases[p]];g===void 0?(u[this.cases[p]]=l.length,l.push([this.cases[p],[p]])):l[g][1].push(p)}const h=p=>this.inputType.kind==="number"?Number(p):p;for(const[p,g]of l)t.push(g.length===1?h(g[0]):g.map(h)),t.push(this.outputs[p].serialize());return t.push(this.otherwise.serialize()),t}}var Zw=nf;class Dd{constructor(t,r,l){this.type=t,this.branches=r,this.otherwise=l}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const u=[];for(let p=1;p<t.length-1;p+=2){const g=r.parse(t[p],p,xa);if(!g)return null;const v=r.parse(t[p+1],p+1,l);if(!v)return null;u.push([g,v]),l=l||v.type}const h=r.parse(t[t.length-1],t.length-1,l);return h?new Dd(l,u,h):null}evaluate(t){for(const[r,l]of this.branches)if(r.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,l]of this.branches)t(r),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var ko=Dd;class gy{constructor(t,r,l,u){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,tn);if(!l||!u)return null;if(!wo(l.type,[Li(na),ma,na]))return r.error(`Expected first argument to be of type array or string, but found ${ui(l.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,tn);return h?new gy(l.type,l,u,h):null}return new gy(l.type,l,u)}evaluate(t){const r=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!dr(r,["string","array"]))throw new Sr(`Expected first argument to be of type array or string, but found ${ui(Ti(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(t);return r.slice(l,u)}return r.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var rC=gy;function ts(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Do(i,t,r,l){return l.compare(t,r)===0}function Od(i,t,r){const l=i!=="=="&&i!=="!=";return class NK{constructor(h,p,g){this.type=xa,this.lhs=h,this.rhs=p,this.collator=g,this.hasUntypedArgument=h.type.kind==="value"||p.type.kind==="value"}static parse(h,p){if(h.length!==3&&h.length!==4)return p.error("Expected two or three arguments.");const g=h[0];let v=p.parse(h[1],1,na);if(!v)return null;if(!ts(g,v.type))return p.concat(1).error(`"${g}" comparisons are not supported for type '${ui(v.type)}'.`);let b=p.parse(h[2],2,na);if(!b)return null;if(!ts(g,b.type))return p.concat(2).error(`"${g}" comparisons are not supported for type '${ui(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return p.error(`Cannot compare types '${ui(v.type)}' and '${ui(b.type)}'.`);l&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new Ys(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new Ys(v.type,[b])));let x=null;if(h.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(x=p.parse(h[3],3,Wo),!x)return null}return new NK(v,b,x)}evaluate(h){const p=this.lhs.evaluate(h),g=this.rhs.evaluate(h);if(l&&this.hasUntypedArgument){const v=Ti(p),b=Ti(g);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new Sr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const v=Ti(p),b=Ti(g);if(v.kind!=="string"||b.kind!=="string")return t(h,p,g)}return this.collator?r(h,p,g,this.collator.evaluate(h)):t(h,p,g)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[i];return this.eachChild(p=>{h.push(p.serialize())}),h}}}const Yw=Od("==",function(i,t,r){return t===r},Do),Kw=Od("!=",function(i,t,r){return t!==r},function(i,t,r,l){return!Do(0,t,r,l)}),Jw=Od("<",function(i,t,r){return t<r},function(i,t,r,l){return l.compare(t,r)<0}),Qw=Od(">",function(i,t,r){return t>r},function(i,t,r,l){return l.compare(t,r)>0}),R_=Od("<=",function(i,t,r){return t<=r},function(i,t,r,l){return l.compare(t,r)<=0}),e2=Od(">=",function(i,t,r){return t>=r},function(i,t,r,l){return l.compare(t,r)>=0});class jp{constructor(t,r,l,u,h,p){this.type=ma,this.number=t,this.locale=r,this.currency=l,this.unit=u,this.minFractionDigits=h,this.maxFractionDigits=p}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const l=r.parse(t[1],1,tn);if(!l)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let h=null;if(u.locale&&(h=r.parse(u.locale,1,ma),!h))return null;let p=null;if(u.currency&&(p=r.parse(u.currency,1,ma),!p))return null;let g=null;if(u.unit&&(g=r.parse(u.unit,1,ma),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=r.parse(u["min-fraction-digits"],1,tn),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=r.parse(u["max-fraction-digits"],1,tn),!b)?null:new jp(l,h,p,g,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class yy{constructor(t){this.type=tn,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=r.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${ui(l.type)} instead.`):new yy(l):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Sr(`Expected value to be of type string or array, but found ${ui(Ti(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(r=>{t.push(r.serialize())}),t}}function vy(i){return function(){i=1831565813+(i|=0)|0;let t=Math.imul(i^i>>>15,1|i);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const $p={"==":Yw,"!=":Kw,">":Qw,"<":Jw,">=":e2,"<=":R_,array:Ys,at:ic,boolean:Ys,case:ko,coalesce:I_,collator:ec,format:Hh,image:jh,in:Hp,"index-of":my,interpolate:ac,"interpolate-hcl":ac,"interpolate-lab":ac,length:yy,let:L_,literal:xu,match:Zw,number:Ys,"number-format":jp,object:Ys,slice:rC,step:Qh,string:Ys,"to-boolean":Ks,"to-color":Ks,"to-number":Ks,"to-string":Ks,var:x_,within:Qg,distance:Kh};function qp(i,[t,r,l,u]){t=t.evaluate(i),r=r.evaluate(i),l=l.evaluate(i);const h=u?u.evaluate(i):1,p=p_(t,r,l,h);if(p)throw new Sr(p);return new xn(t/255*h,r/255*h,l/255*h,h)}function k_(i,[t,r,l,u]){t=t.evaluate(i),r=r.evaluate(i),l=l.evaluate(i);const h=u?u.evaluate(i):1,p=function(b,x,S,T){return typeof b=="number"&&b>=0&&b<=360?typeof x=="number"&&x>=0&&x<=100&&typeof S=="number"&&S>=0&&S<=100?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:`Invalid hsla value [${[b,x,S,T].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof T=="number"?[b,x,S,T]:[b,x,S]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof T=="number"?[b,x,S,T]:[b,x,S]).join(", ")}]: 'h' must be between 0 and 360.`}(t,r,l,h);if(p)throw new Sr(p);const g=`hsla(${t}, ${r}%, ${l}%, ${h})`,v=xn.parse(g);if(!v)throw new Sr(`Failed to parse HSLA color: ${g}`);return v}function _y(i,t){return i in t}function by(i,t){const r=t[i];return r===void 0?null:r}function D_(i,t,r){r.length&&(t+=`${r}`);const l=i.getConfig(t);return l?l.evaluate(i):null}function rc(i){return{type:i}}Ar.register($p,{error:[{kind:"error"},[ma],(i,[t])=>{throw new Sr(t.evaluate(i))}],typeof:[ma,[na],(i,[t])=>ui(Ti(t.evaluate(i)))],"to-rgba":[Li(tn,4),[Yi],(i,[t])=>t.evaluate(i).toArray()],rgb:[Yi,[tn,tn,tn],qp],rgba:[Yi,[tn,tn,tn,tn],qp],hsl:[Yi,[tn,tn,tn],k_],hsla:[Yi,[tn,tn,tn,tn],k_],has:{type:xa,overloads:[[[ma],(i,[t])=>_y(t.evaluate(i),i.properties())],[[ma,Or],(i,[t,r])=>_y(t.evaluate(i),r.evaluate(i))]]},get:{type:na,overloads:[[[ma],(i,[t])=>by(t.evaluate(i),i.properties())],[[ma,Or],(i,[t,r])=>by(t.evaluate(i),r.evaluate(i))]]},config:{type:na,overloads:[[[ma],(i,[t])=>D_(i,t.evaluate(i),"")],[[ma,ma],(i,[t,r])=>D_(i,t.evaluate(i),r.evaluate(i))]]},"feature-state":[na,[ma],(i,[t])=>by(t.evaluate(i),i.featureState||{})],properties:[Or,[],i=>i.properties()],"geometry-type":[ma,[],i=>i.geometryType()],id:[na,[],i=>i.id()],zoom:[tn,[],i=>i.globals.zoom],pitch:[tn,[],i=>i.globals.pitch||0],"distance-from-center":[tn,[],i=>i.distanceFromCenter()],"measure-light":[tn,[ma],(i,[t])=>i.measureLight(t.evaluate(i))],"heatmap-density":[tn,[],i=>i.globals.heatmapDensity||0],"line-progress":[tn,[],i=>i.globals.lineProgress||0],"raster-value":[tn,[],i=>i.globals.rasterValue||0],"sky-radial-progress":[tn,[],i=>i.globals.skyRadialProgress||0],accumulated:[na,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[tn,rc(tn),(i,t)=>{let r=0;for(const l of t)r+=l.evaluate(i);return r}],"*":[tn,rc(tn),(i,t)=>{let r=1;for(const l of t)r*=l.evaluate(i);return r}],"-":{type:tn,overloads:[[[tn,tn],(i,[t,r])=>t.evaluate(i)-r.evaluate(i)],[[tn],(i,[t])=>-t.evaluate(i)]]},"/":[tn,[tn,tn],(i,[t,r])=>t.evaluate(i)/r.evaluate(i)],"%":[tn,[tn,tn],(i,[t,r])=>t.evaluate(i)%r.evaluate(i)],ln2:[tn,[],()=>Math.LN2],pi:[tn,[],()=>Math.PI],e:[tn,[],()=>Math.E],"^":[tn,[tn,tn],(i,[t,r])=>Math.pow(t.evaluate(i),r.evaluate(i))],sqrt:[tn,[tn],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))],log2:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[tn,[tn],(i,[t])=>Math.sin(t.evaluate(i))],cos:[tn,[tn],(i,[t])=>Math.cos(t.evaluate(i))],tan:[tn,[tn],(i,[t])=>Math.tan(t.evaluate(i))],asin:[tn,[tn],(i,[t])=>Math.asin(t.evaluate(i))],acos:[tn,[tn],(i,[t])=>Math.acos(t.evaluate(i))],atan:[tn,[tn],(i,[t])=>Math.atan(t.evaluate(i))],min:[tn,rc(tn),(i,t)=>Math.min(...t.map(r=>r.evaluate(i)))],max:[tn,rc(tn),(i,t)=>Math.max(...t.map(r=>r.evaluate(i)))],abs:[tn,[tn],(i,[t])=>Math.abs(t.evaluate(i))],round:[tn,[tn],(i,[t])=>{const r=t.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[tn,[tn],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[tn,[tn],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[xa,[ma,na],(i,[t,r])=>i.properties()[t.value]===r.value],"filter-id-==":[xa,[na],(i,[t])=>i.id()===t.value],"filter-type-==":[xa,[ma],(i,[t])=>i.geometryType()===t.value],"filter-<":[xa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l<u}],"filter-id-<":[xa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r<l}],"filter->":[xa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l>u}],"filter-id->":[xa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r>l}],"filter-<=":[xa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l<=u}],"filter-id-<=":[xa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r<=l}],"filter->=":[xa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l>=u}],"filter-id->=":[xa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r>=l}],"filter-has":[xa,[na],(i,[t])=>t.value in i.properties()],"filter-has-id":[xa,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[xa,[Li(ma)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[xa,[Li(na)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[xa,[ma,Li(na)],(i,[t,r])=>r.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[xa,[ma,Li(na)],(i,[t,r])=>function(l,u,h,p){for(;h<=p;){const g=h+p>>1;if(u[g]===l)return!0;u[g]>l?p=g-1:h=g+1}return!1}(i.properties()[t.value],r.value,0,r.value.length-1)],all:{type:xa,overloads:[[[xa,xa],(i,[t,r])=>t.evaluate(i)&&r.evaluate(i)],[rc(xa),(i,t)=>{for(const r of t)if(!r.evaluate(i))return!1;return!0}]]},any:{type:xa,overloads:[[[xa,xa],(i,[t,r])=>t.evaluate(i)||r.evaluate(i)],[rc(xa),(i,t)=>{for(const r of t)if(r.evaluate(i))return!0;return!1}]]},"!":[xa,[xa],(i,[t])=>!t.evaluate(i)],"is-supported-script":[xa,[ma],(i,[t])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(t.evaluate(i))}],upcase:[ma,[ma],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[ma,[ma],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[ma,rc(na),(i,t)=>t.map(r=>bu(r.evaluate(i))).join("")],"resolved-locale":[ma,[Wo],(i,[t])=>t.evaluate(i).resolvedLocale()],random:[tn,[tn,tn,na],(i,t)=>{const[r,l,u]=t.map(p=>p.evaluate(i));if(r>l||r===l)return r;let h;if(typeof u=="string")h=function(p){let g=0;if(p.length===0)return g;for(let v=0;v<p.length;v++)g=(g<<5)-g+p.charCodeAt(v),g&=g;return g}(u);else{if(typeof u!="number")throw new Sr(`Invalid seed input: ${u}`);h=u}return r+vy(h)()*(l-r)}]});var af=$p;function xy(i){return{result:"success",value:i}}function Iu(i){return{result:"error",value:i}}function oc(i,t){return!!i&&!!i.parameters&&i.parameters.indexOf(t)>-1}function zd(i){return i["property-type"]==="data-driven"}function t2(i){return oc(i.expression,"measure-light")}function rf(i){return oc(i.expression,"zoom")}function Rc(i){return!!i.expression&&i.expression.interpolated}function wy(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Sn(i){return i}function Xp(i,t){const r=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",u=l||!(l||i.property!==void 0),h=i.type||(Rc(t)?"exponential":"interval");if(r&&((i=As({},i)).stops&&(i.stops=i.stops.map(b=>[b[0],xn.parse(b[1])])),i.default=xn.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Xw[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let p,g,v;if(h==="exponential")p=Lu;else if(h==="interval")p=oC;else if(h==="categorical"){p=n2,g=Object.create(null);for(const b of i.stops)g[b[0]]=b[1];v=typeof i.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);p=Zp}if(l){const b={},x=[];for(let P=0;P<i.stops.length;P++){const R=i.stops[P],z=R[0].zoom;b[z]===void 0&&(b[z]={zoom:z,type:i.type,property:i.property,default:i.default,stops:[]},x.push(z)),b[z].stops.push([R[0].value,R[1]])}const S=[];for(const P of x)S.push([b[P].zoom,Xp(b[P],t)]);const T={name:"linear"};return{kind:"composite",interpolationType:T,interpolationFactor:ac.interpolationFactor.bind(void 0,T),zoomStops:S.map(P=>P[0]),evaluate:({zoom:P},R)=>Lu({stops:S,base:i.base},t,P).evaluate(P,R)}}if(u){const b=h==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:ac.interpolationFactor.bind(void 0,b),zoomStops:i.stops.map(x=>x[0]),evaluate:({zoom:x})=>p(i,t,x,g,v)}}return{kind:"source",evaluate(b,x){const S=x&&x.properties?x.properties[i.property]:void 0;return S===void 0?Fd(i.default,t.default):p(i,t,S,g,v)}}}function Fd(i,t,r){return i!==void 0?i:t!==void 0?t:r!==void 0?r:void 0}function n2(i,t,r,l,u){return Fd(typeof r===u?l[r]:void 0,i.default,t.default)}function oC(i,t,r){if(ka(r)!=="number")return Fd(i.default,t.default);const l=i.stops.length;if(l===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[l-1][0])return i.stops[l-1][1];const u=Bp(i.stops.map(h=>h[0]),r);return i.stops[u][1]}function Lu(i,t,r){const l=i.base!==void 0?i.base:1;if(ka(r)!=="number")return Fd(i.default,t.default);const u=i.stops.length;if(u===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[u-1][0])return i.stops[u-1][1];const h=Bp(i.stops.map(x=>x[0]),r),p=function(x,S,T,P){const R=P-T,z=x-T;return R===0?0:S===1?z/R:(Math.pow(S,z)-1)/(Math.pow(S,R)-1)}(r,l,i.stops[h][0],i.stops[h+1][0]),g=i.stops[h][1],v=i.stops[h+1][1];let b=Up[t.type]||Sn;if(i.colorSpace&&i.colorSpace!=="rgb"){const x=Xw[i.colorSpace];b=(S,T)=>x.reverse(x.interpolate(x.forward(S),x.forward(T),p))}return typeof g.evaluate=="function"?{evaluate(...x){const S=g.evaluate.apply(void 0,x),T=v.evaluate.apply(void 0,x);if(S!==void 0&&T!==void 0)return b(S,T,p)}}:b(g,v,p)}function Zp(i,t,r){return t.type==="color"?r=xn.parse(r):t.type==="formatted"?r=wr.fromString(r.toString()):t.type==="resolvedImage"?r=Jo.fromString(r.toString()):ka(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Fd(r,i.default,t.default)}class Yp{constructor(t,r,l){this.expression=t,this._warningHistory={},this._evaluator=new kp(l),this._defaultValue=r?function(u){return u.type==="color"&&(wy(u.default)||Array.isArray(u.default))?new xn(0,0,0,0):u.type==="color"?xn.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,l,u,h,p,g,v){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(t,r,l,u,h,p,g,v){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Sr(`Expected value to be one of ${Object.keys(this._enumValues).map(x=>JSON.stringify(x)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Kp(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in af}function kc(i,t,r){const l=new sy(af,[],t?function(h){const p={color:Yi,string:ma,number:tn,enum:ma,boolean:xa,formatted:Cc,resolvedImage:Pc};return h.type==="array"?Li(p[h.value]||na,h.length):p[h.type]}(t):void 0,void 0,void 0,r),u=l.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?xy(new Yp(u,t,r)):Iu(l.errors)}class Sy{constructor(t,r,l){this.kind=t,this._styleExpression=r,this.isLightConstant=l,this.isStateDependent=t!=="constant"&&!Np(r.expression),this.isConfigDependent=!iy(r.expression)}evaluateWithoutErrorHandling(t,r,l,u,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,u,h,p)}evaluate(t,r,l,u,h,p){return this._styleExpression.evaluate(t,r,l,u,h,p)}}class Dc{constructor(t,r,l,u,h){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Np(r.expression),this.isLightConstant=h,this.isConfigDependent=!iy(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,r,l,u,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,u,h,p)}evaluate(t,r,l,u,h,p){return this._styleExpression.evaluate(t,r,l,u,h,p)}interpolationFactor(t,r,l){return this.interpolationType?ac.interpolationFactor(this.interpolationType,t,r,l):0}}function Ay(i,t,r){if((i=kc(i,t,r)).result==="error")return i;const l=i.value.expression,u=Tu(l);if(!u&&!zd(t))return Iu([new Es("","data expressions not supported")]);const h=Rd(l,["zoom","pitch","distance-from-center"]);if(!h&&!rf(t))return Iu([new Es("","zoom expressions not supported")]);const p=Rd(l,["measure-light"]);if(!p&&!t2(t))return Iu([new Es("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,v=of(l);return v||h||g?v instanceof Es?Iu([v]):v instanceof ac&&!Rc(t)?Iu([new Es("",'"interpolate" expressions cannot be used with this property')]):xy(v?new Dc(u?"camera":"composite",i.value,v.labels,v instanceof ac?v.interpolation:void 0,p):new Sy(u?"constant":"source",i.value,p)):Iu([new Es("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Jp{constructor(t,r){this._parameters=t,this._specification=r,As(this,Xp(this._parameters,this._specification))}static deserialize(t){return new Jp(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function of(i){let t=null;if(i instanceof L_)t=of(i.result);else if(i instanceof I_){for(const r of i.args)if(t=of(r),t)break}else(i instanceof Qh||i instanceof ac)&&i.input instanceof Ar&&i.input.name==="zoom"&&(t=i);return t instanceof Es||i.eachChild(r=>{const l=of(r);l instanceof Es?t=l:t&&l&&t!==l&&(t=new Es("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ns(i){const t=i.key,r=i.value,l=i.valueSpec||{},u=i.objectElementValidators||{},h=i.style,p=i.styleSpec;let g=[];const v=ka(r);if(v!=="object")return[new sn(t,r,`object expected, ${v} found`)];for(const b in r){const x=b.split(".")[0];let S;u[x]?S=u[x]:l[x]?S=nr:u["*"]?S=u["*"]:l["*"]&&(S=nr),S?g=g.concat(S({key:(t&&`${t}.`)+b,value:r[b],valueSpec:l[x]||l["*"],style:h,styleSpec:p,object:r,objectKey:b},r)):g.push(new qs(t,r[b],`unknown property "${b}"`))}for(const b in l)u[b]||l[b].required&&l[b].default===void 0&&r[b]===void 0&&g.push(new sn(t,r,`missing required property "${b}"`));return g}function O_(i){const t=i.value,r=i.valueSpec,l=i.style,u=i.styleSpec,h=i.key,p=i.arrayElementValidator||nr;if(ka(t)!=="array")return[new sn(h,t,`array expected, ${ka(t)} found`)];if(r.length&&t.length!==r.length)return[new sn(h,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new sn(h,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let g={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(g.function=r.function),ka(r.value)==="object"&&(g=r.value);let v=[];for(let b=0;b<t.length;b++)v=v.concat(p({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:l,styleSpec:u,key:`${h}[${b}]`},!0));return v}function Ey(i){const t=i.key,r=i.value,l=i.valueSpec;let u=ka(r);if(u==="number"&&r!=r&&(u="NaN"),u!=="number")return[new sn(t,r,`number expected, ${u} found`)];if("minimum"in l){let h=l.minimum;if(ka(l.minimum)==="array"&&(h=l.minimum[i.arrayIndex]),r<h)return[new sn(t,r,`${r} is less than the minimum value ${h}`)]}if("maximum"in l){let h=l.maximum;if(ka(l.maximum)==="array"&&(h=l.maximum[i.arrayIndex]),r>h)return[new sn(t,r,`${r} is greater than the maximum value ${h}`)]}return[]}function Qp(i){const t=i.valueSpec,r=Bi(i.value.type);let l,u,h,p={};const g=r!=="categorical"&&i.value.property===void 0,v=!g,b=ka(i.value.stops)==="array"&&ka(i.value.stops[0])==="array"&&ka(i.value.stops[0][0])==="object",x=ns({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(P){if(r==="identity")return[new sn(P.key,P.value,'identity function may not have a "stops" property')];let R=[];const z=P.value;return R=R.concat(O_({key:P.key,value:z,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:S})),ka(z)==="array"&&z.length===0&&R.push(new sn(P.key,z,"array must have at least one stop")),R},default:function(P){return nr({key:P.key,value:P.value,valueSpec:t,style:P.style,styleSpec:P.styleSpec})}}});return r==="identity"&&g&&x.push(new sn(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||x.push(new sn(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!Rc(i.valueSpec)&&x.push(new sn(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(v&&!zd(i.valueSpec)?x.push(new sn(i.key,i.value,"property functions not supported")):g&&!rf(i.valueSpec)&&x.push(new sn(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!b||i.value.property!==void 0||x.push(new sn(i.key,i.value,'"property" property is required')),x;function S(P){let R=[];const z=P.value,U=P.key;if(ka(z)!=="array")return[new sn(U,z,`array expected, ${ka(z)} found`)];if(z.length!==2)return[new sn(U,z,`array length 2 expected, length ${z.length} found`)];if(b){if(ka(z[0])!=="object")return[new sn(U,z,`object expected, ${ka(z[0])} found`)];if(z[0].zoom===void 0)return[new sn(U,z,"object stop key must have zoom")];if(z[0].value===void 0)return[new sn(U,z,"object stop key must have value")];const W=Bi(z[0].zoom);if(typeof W!="number")return[new sn(U,z[0].zoom,"stop zoom values must be numbers")];if(h&&h>W)return[new sn(U,z[0].zoom,"stop zoom values must appear in ascending order")];W!==h&&(h=W,u=void 0,p={}),R=R.concat(ns({key:`${U}[0]`,value:z[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:Ey,value:T}}))}else R=R.concat(T({key:`${U}[0]`,value:z[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},z));return Kp(ai(z[1]))?R.concat([new sn(`${U}[1]`,z[1],"expressions are not allowed in function stops.")]):R.concat(nr({key:`${U}[1]`,value:z[1],valueSpec:t,style:P.style,styleSpec:P.styleSpec}))}function T(P,R){const z=ka(P.value),U=Bi(P.value),W=P.value!==null?P.value:R;if(l){if(z!==l)return[new sn(P.key,W,`${z} stop domain type must match previous stop domain type ${l}`)]}else l=z;if(z!=="number"&&z!=="string"&&z!=="boolean"&&typeof U!="number"&&typeof U!="string"&&typeof U!="boolean")return[new sn(P.key,W,"stop domain value must be a number, string, or boolean")];if(z!=="number"&&r!=="categorical"){let j=`number expected, ${z} found`;return zd(t)&&r===void 0&&(j+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new sn(P.key,W,j)]}return r!=="categorical"||z!=="number"||typeof U=="number"&&isFinite(U)&&Math.floor(U)===U?r!=="categorical"&&z==="number"&&typeof U=="number"&&typeof u=="number"&&u!==void 0&&U<u?[new sn(P.key,W,"stop domain values must appear in ascending order")]:(u=U,r==="categorical"&&U in p?[new sn(P.key,W,"stop domain values must be unique")]:(p[U]=!0,[])):[new sn(P.key,W,`integer expected, found ${String(U)}`)]}}function Nd(i){const t=(i.expressionContext==="property"?Ay:kc)(ai(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new sn(`${i.key}${l.key}`,i.value,l.message));const r=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new sn(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Np(r))return[new sn(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return a2(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Rd(r,["zoom","feature-state"]))return[new sn(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Tu(r))return[new sn(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function a2(i,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const u of t.valueSpec.expression.parameters)r.delete(u);if(r.size===0)return[];const l=[];return i instanceof Ar&&r.has(i.name)?[new sn(t.key,t.value,`["${i.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(i.eachChild(u=>{l.push(...a2(u,t))}),l)}function em(i){const t=i.key,r=i.value,l=i.valueSpec,u=[];return Array.isArray(l.values)?l.values.indexOf(Bi(r))===-1&&u.push(new sn(t,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(Bi(r))===-1&&u.push(new sn(t,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function My(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!My(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function tm(i,t="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};My(i)||(i=Ru(i));const r=i;let l=!0;try{l=function(b){if(!Oc(b))return b;let x=ai(b);return nm(x),x=z_(x),x}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const u=tt[`filter_${t}`],h=kc(l,u);let p=null;if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));p=(b,x,S)=>h.value.evaluate(b,x,{},S);let g=null,v=null;if(l!==r){const b=kc(r,u);if(b.result==="error")throw new Error(b.value.map(x=>`${x.key}: ${x.message}`).join(", "));g=(x,S,T,P,R)=>b.value.evaluate(x,S,{},T,void 0,void 0,P,R),v=!Tu(b.value.expression)}return{filter:p,dynamicFilter:g||void 0,needGeometry:am(l),needFeature:!!v}}function z_(i){if(!Array.isArray(i))return i;const t=function(r){if(Ty.has(r[0])){for(let l=1;l<r.length;l++)if(Oc(r[l]))return!0}return r}(i);return t===!0?t:t.map(r=>z_(r))}function nm(i){let t=!1;const r=[];if(i[0]==="case"){for(let l=1;l<i.length-1;l+=2)t=t||Oc(i[l]),r.push(i[l+1]);r.push(i[i.length-1])}else if(i[0]==="match"){t=t||Oc(i[1]);for(let l=2;l<i.length-1;l+=2)r.push(i[l+1]);r.push(i[i.length-1])}else if(i[0]==="step"){t=t||Oc(i[1]);for(let l=1;l<i.length-1;l+=2)r.push(i[l+1])}t&&(i.length=0,i.push("any",...r));for(let l=1;l<i.length;l++)nm(i[l])}function Oc(i){if(!Array.isArray(i))return!1;if((t=i[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let r=1;r<i.length;r++)if(Oc(i[r]))return!0;return!1}const Ty=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Cy(i,t){return i<t?-1:i>t?1:0}function am(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(am(i[t]))return!0;return!1}function Ru(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?im(i[1],i[2],"=="):t==="!="?rm(im(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?im(i[1],i[2],t):t==="any"?(r=i.slice(1),["any"].concat(r.map(Ru))):t==="all"?["all"].concat(i.slice(1).map(Ru)):t==="none"?["all"].concat(i.slice(1).map(Ru).map(rm)):t==="in"?Py(i[1],i.slice(2)):t==="!in"?rm(Py(i[1],i.slice(2))):t==="has"?Iy(i[1]):t!=="!has"||rm(Iy(i[1]));var r}function im(i,t,r){switch(i){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,i,t]}}function Py(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",i,["literal",t.sort(Cy)]]:["filter-in-small",i,["literal",t]]}}function Iy(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function rm(i){return["!",i]}function om(i){return My(ai(i.value))?Nd(As({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):i2(i)}function i2(i){const t=i.value,r=i.key;if(ka(t)!=="array")return[new sn(r,t,`array expected, ${ka(t)} found`)];const l=i.styleSpec;let u,h=[];if(t.length<1)return[new sn(r,t,"filter array must have at least 1 element")];switch(h=h.concat(em({key:`${r}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Bi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Bi(t[1])==="$type"&&h.push(new sn(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&h.push(new sn(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=ka(t[1]),u!=="string"&&h.push(new sn(`${r}[1]`,t[1],`string expected, ${u} found`)));for(let p=2;p<t.length;p++)u=ka(t[p]),Bi(t[1])==="$type"?h=h.concat(em({key:`${r}[${p}]`,value:t[p],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&h.push(new sn(`${r}[${p}]`,t[p],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let p=1;p<t.length;p++)h=h.concat(i2({key:`${r}[${p}]`,value:t[p],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":u=ka(t[1]),t.length!==2?h.push(new sn(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&h.push(new sn(`${r}[1]`,t[1],`string expected, ${u} found`))}return h}function sm(i,t){const r=i.key,l=i.style,u=i.layer,h=i.styleSpec,p=i.value,g=i.objectKey,v=h[`${t}_${i.layerType}`];if(!v)return[];const b=g.match(/^(.*)-transition$/);if(t==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return nr({key:r,value:p,valueSpec:h.transition,style:l,styleSpec:h});const x=i.valueSpec||v[g];if(!x)return[new qs(r,p,`unknown property "${g}"`)];let S;if(ka(p)==="string"&&zd(x)&&!x.tokens&&(S=/^{([^}]+)}$/.exec(p))){const P=`\`{ "type": "identity", "property": ${S?JSON.stringify(S[1]):'"_"'} }\``;return[new sn(r,p,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${P}.`)]}const T=[];if(i.layerType==="symbol")g!=="text-field"||!l||l.glyphs||l.imports||T.push(new sn(r,p,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&wy(ai(p))&&Bi(p.type)==="identity"&&T.push(new sn(r,p,'"text-font" does not support identity functions'));else if(i.layerType==="model"&&t==="paint"&&u&&u.layout&&u.layout.hasOwnProperty("model-id")&&zd(x)&&(t2(x)||rf(x))){const P=Ay(ai(p),x),R=P.value.expression||P.value._styleExpression.expression;R&&!Rd(R,["measure-light"])&&T.push(new sn(r,p,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return T.concat(nr({key:i.key,value:p,valueSpec:x,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:g}))}function Ly(i){return sm(i,"paint")}function hr(i){return sm(i,"layout")}function Da(i){let t=[];const r=i.value,l=i.key,u=i.style,h=i.styleSpec;r.type||r.ref||t.push(new sn(l,r,'either "type" or "ref" is required'));let p=Bi(r.type);const g=Bi(r.ref);if(r.id){const v=Bi(r.id);for(let b=0;b<i.arrayIndex;b++){const x=u.layers[b];Bi(x.id)===v&&t.push(new sn(l,r.id,`duplicate layer id "${r.id}", previously used at line ${x.id.__line__}`))}}if("ref"in r){let v;["type","source","source-layer","filter","layout"].forEach(b=>{b in r&&t.push(new sn(l,r[b],`"${b}" is prohibited for ref layers`))}),u.layers.forEach(b=>{Bi(b.id)===g&&(v=b)}),v?v.ref?t.push(new sn(l,r.ref,"ref cannot reference another ref layer")):p=Bi(v.type):typeof g=="string"&&t.push(new sn(l,r.ref,`ref layer "${g}" not found`))}else if(p!=="background"&&p!=="sky"&&p!=="slot")if(r.source){const v=u.sources&&u.sources[r.source],b=v&&Bi(v.type);v?b==="vector"&&p==="raster"?t.push(new sn(l,r.source,`layer "${r.id}" requires a raster source`)):b==="raster"&&p!=="raster"?t.push(new sn(l,r.source,`layer "${r.id}" requires a vector source`)):b!=="vector"||r["source-layer"]?b==="raster-dem"&&p!=="hillshade"?t.push(new sn(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):p!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||b==="geojson"&&v.lineMetrics||t.push(new sn(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new sn(l,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new sn(l,r.source,`source "${r.source}" not found`))}else t.push(new sn(l,r,'missing required property "source"'));return t=t.concat(ns({key:l,value:r,valueSpec:h.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>nr({key:`${l}.type`,value:r.type,valueSpec:h.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:v=>om(As({layerType:p},v)),layout:v=>ns({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>hr(As({layerType:p},b))}}),paint:v=>ns({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>Ly(As({layerType:p,layer:r},b))}})}})),t}function Gi(i){const t=i.value,r=i.key,l=ka(t);return l!=="string"?[new sn(r,t,`string expected, ${l} found`)]:[]}const Er={promoteId:function({key:i,value:t}){if(ka(t)==="string")return Gi({key:i,value:t});{const r=[];for(const l in t)r.push(...Gi({key:`${i}.${l}`,value:t[l]}));return r}}};function ho(i){const t=i.value,r=i.key,l=i.styleSpec,u=i.style;if(!t.type)return[new sn(r,t,'"type" is required')];const h=Bi(t.type);let p;switch(h){case"vector":case"raster":case"raster-dem":return p=ns({key:r,value:t,valueSpec:l[`source_${h.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Er}),p;case"geojson":if(p=ns({key:r,value:t,valueSpec:l.source_geojson,style:u,styleSpec:l,objectElementValidators:Er}),t.cluster)for(const g in t.clusterProperties){const[v,b]=t.clusterProperties[g],x=typeof v=="string"?[v,["accumulated"],["get",g]]:v;p.push(...Nd({key:`${r}.${g}.map`,value:b,expressionContext:"cluster-map"})),p.push(...Nd({key:`${r}.${g}.reduce`,value:x,expressionContext:"cluster-reduce"}))}return p;case"video":return ns({key:r,value:t,valueSpec:l.source_video,style:u,styleSpec:l});case"image":return ns({key:r,value:t,valueSpec:l.source_image,style:u,styleSpec:l});case"canvas":return[new sn(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return em({key:`${r}.type`,value:t.type,valueSpec:{values:Ts(l)},style:u,styleSpec:l})}}function Ts(i){return i.source.reduce((t,r)=>{const l=i[r];return l.type.type==="enum"&&(t=t.concat(Object.keys(l.type.values))),t},[])}function Bd(i){const t=i.value;let r=[];if(!t)return r;const l=ka(t);return l!=="string"?(r=r.concat([new sn(i.key,t,`string expected, "${l}" found`)]),r):(function(u){const h=u.indexOf("://")===-1;try{return new URL(u,h?"http://example.com":void 0),!0}catch{return!1}}(t)||(r=r.concat([new sn(i.key,t,`invalid url "${t}"`)])),r)}function Fr(i){const t=i.value,r=i.styleSpec,l=r.light,u=i.style;let h=[];const p=ka(t);if(t===void 0)return h;if(p!=="object")return h=h.concat([new sn("light",t,`object expected, ${p} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&l[v[1]]&&l[v[1]].transition?nr({key:g,value:t[g],valueSpec:r.transition,style:u,styleSpec:r}):l[g]?nr({key:g,value:t[g],valueSpec:l[g],style:u,styleSpec:r}):[new sn(g,t[g],`unknown property "${g}"`)])}return h}function sf(i){const t=i.value;let r=[];if(!t)return r;const l=ka(t);if(l!=="object")return r=r.concat([new sn("light-3d",t,`object expected, ${l} found`)]),r;const u=i.styleSpec,h=u["light-3d"],p=i.key,g=i.style,v=i.style.lights;for(const S of["type","id"])if(!(S in t))return r=r.concat([new sn("light-3d",t,`missing property ${S} on light`)]),r;if(t.type&&v)for(let S=0;S<i.arrayIndex;S++){const T=Bi(t.type),P=v[S];Bi(P.type)===T&&r.push(new sn(p,t.id,`duplicate light type "${t.type}", previously defined at line ${P.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in u))return r=r.concat([new sn("light-3d",t,`Invalid light type ${t.type}`)]),r;const x=u[b];for(const S in t)if(S==="properties"){const T=t[S],P=ka(T);if(P!=="object")return r=r.concat([new sn("properties",T,`object expected, ${P} found`)]),r;for(const R in T)r=r.concat(x[R]?nr({key:R,value:T[R],valueSpec:x[R],style:g,styleSpec:u}):[new qs(i.key,T[R],`unknown property "${R}"`)])}else{const T=S.match(/^(.*)-transition$/);r=r.concat(T&&h[T[1]]&&h[T[1]].transition?nr({key:S,value:t[S],valueSpec:u.transition,style:g,styleSpec:u}):h[S]?nr({key:S,value:t[S],valueSpec:h[S],style:g,styleSpec:u}):[new qs(S,t[S],`unknown property "${S}"`)])}return r}function Ud(i){const t=i.value,r=i.key,l=i.style,u=i.styleSpec,h=u.terrain;let p=[];const g=ka(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new sn("terrain",t,`object expected, ${g} found`)]),p;for(const v in t){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&h[b[1]]&&h[b[1]].transition?nr({key:v,value:t[v],valueSpec:u.transition,style:l,styleSpec:u}):h[v]?nr({key:v,value:t[v],valueSpec:h[v],style:l,styleSpec:u}):[new qs(v,t[v],`unknown property "${v}"`)])}if(t.source){const v=l.sources&&l.sources[t.source],b=v&&Bi(v.type);v?b!=="raster-dem"&&p.push(new sn(r,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):p.push(new sn(r,t.source,`source "${t.source}" not found`))}else p.push(new sn(r,t,'terrain is missing required property "source"'));return p}function lm(i){const t=i.value,r=i.style,l=i.styleSpec,u=l.fog;let h=[];const p=ka(t);if(t===void 0)return h;if(p!=="object")return h=h.concat([new sn("fog",t,`object expected, ${p} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&u[v[1]]&&u[v[1]].transition?nr({key:g,value:t[g],valueSpec:l.transition,style:r,styleSpec:l}):u[g]?nr({key:g,value:t[g],valueSpec:u[g],style:r,styleSpec:l}):[new qs(g,t[g],`unknown property "${g}"`)])}return h}const Ry={"*":()=>[],array:O_,boolean:function(i){const t=i.value,r=i.key,l=ka(t);return l!=="boolean"?[new sn(r,t,`boolean expected, ${l} found`)]:[]},number:Ey,color:function(i){const t=i.key,r=i.value,l=ka(r);return l!=="string"?[new sn(t,r,`color expected, ${l} found`)]:vu(r)===null?[new sn(t,r,`color expected, "${r}" found`)]:[]},enum:em,filter:om,function:Qp,layer:Da,object:ns,source:ho,model:Bd,light:Fr,"light-3d":sf,terrain:Ud,fog:lm,string:Gi,formatted:function(i){return Gi(i).length===0?[]:Nd(i)},resolvedImage:function(i){return Gi(i).length===0?[]:Nd(i)},projection:function(i){const t=i.value,r=i.styleSpec,l=r.projection,u=i.style;let h=[];const p=ka(t);if(p==="object")for(const g in t)h=h.concat(nr({key:g,value:t[g],valueSpec:l[g],style:u,styleSpec:r}));else p!=="string"&&(h=h.concat([new sn("projection",t,`object or string expected, ${p} found`)]));return h},import:function(i){const{value:t,styleSpec:r}=i,{data:l,...u}=t;Object.defineProperty(u,"__line__",{value:t.__line__,enumerable:!1});let h=ns(As({},i,{value:u,valueSpec:r.import}));return Bi(u.id)===""&&h.push(new sn(`${i.key}.id`,u,"import id can't be an empty string")),l&&(h=h.concat(ky(l,r,{key:`${i.key}.data`}))),h}};function nr(i,t=!1){const r=i.value,l=i.valueSpec,u=i.styleSpec;if(l.expression&&wy(Bi(r)))return Qp(i);if(l.expression&&Kp(ai(r)))return Nd(i);if(l.type&&Ry[l.type]){const h=Ry[l.type](i);return t===!0&&h.length>0&&ka(i.value)==="array"?Nd(i):h}return ns(As({},i,{valueSpec:l.type?u[l.type]:l}))}function as(i){const t=i.value,r=i.key,l=Gi(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new sn(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new sn(r,t,'"glyphs" url must include a "{range}" token'))),l}function ky(i,t=tt,r={}){return nr({key:r.key||"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:as,"*":()=>[]}})}function ku(i,t=tt){return is(ky(i,t))}const lf=i=>is(ho(i)),Dy=i=>is(Fr(i)),F_=i=>is(sf(i)),Du=i=>is(Ud(i)),Oy=i=>is(lm(i)),Ou=i=>is(Da(i)),cf=i=>is(om(i)),cm=i=>is(Ly(i)),N_=i=>is(hr(i)),zy=i=>is(Bd(i));function is(i){return i.slice().sort((t,r)=>t.line&&r.line?t.line-r.line:0)}function fo(i,t){let r=!1;if(t&&t.length)for(const l of t)l instanceof qs?ve(l.message):(i.fire(new vn(new Error(l.message))),r=!0);return r}var zu=Cs,Yr=3;function Cs(i,t,r){var l=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var u=new Int32Array(this.arrayBuffer);i=u[0],this.d=(t=u[1])+2*(r=u[2]);for(var h=0;h<this.d*this.d;h++){var p=u[Yr+h],g=u[Yr+h+1];l.push(p===g?null:u.subarray(p,g))}var v=u[Yr+l.length+1];this.keys=u.subarray(u[Yr+l.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var b=0;b<this.d*this.d;b++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=i,this.padding=r,this.scale=t/i,this.uid=0;var x=r/t*i;this.min=-x,this.max=i+x}Cs.prototype.insert=function(i,t,r,l,u){this._forEachCell(t,r,l,u,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u)},Cs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Cs.prototype._insertCell=function(i,t,r,l,u,h){this.cells[u].push(h)},Cs.prototype.query=function(i,t,r,l,u){var h=this.min,p=this.max;if(i<=h&&t<=h&&p<=r&&p<=l&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(i,t,r,l,this._queryCell,g,{},u),g},Cs.prototype._queryCell=function(i,t,r,l,u,h,p,g){var v=this.cells[u];if(v!==null)for(var b=this.keys,x=this.bboxes,S=0;S<v.length;S++){var T=v[S];if(p[T]===void 0){var P=4*T;(g?g(x[P+0],x[P+1],x[P+2],x[P+3]):i<=x[P+2]&&t<=x[P+3]&&r>=x[P+0]&&l>=x[P+1])?(p[T]=!0,h.push(b[T])):p[T]=!1}}},Cs.prototype._forEachCell=function(i,t,r,l,u,h,p,g){for(var v=this._convertToCellCoord(i),b=this._convertToCellCoord(t),x=this._convertToCellCoord(r),S=this._convertToCellCoord(l),T=v;T<=x;T++)for(var P=b;P<=S;P++){var R=this.d*P+T;if((!g||g(this._convertFromCellCoord(T),this._convertFromCellCoord(P),this._convertFromCellCoord(T+1),this._convertFromCellCoord(P+1)))&&u.call(this,i,t,r,l,R,h,p,g))return}},Cs.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Cs.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Cs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,t=Yr+this.cells.length+1+1,r=0,l=0;l<this.cells.length;l++)r+=this.cells[l].length;var u=new Int32Array(t+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var h=t,p=0;p<i.length;p++){var g=i[p];u[Yr+p]=h,u.set(g,h),h+=g.length}return u[Yr+i.length]=h,u.set(this.keys,h),u[Yr+i.length+1]=h+=this.keys.length,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer};var Kr=F(zu);const um={};function un(i,t,r={}){Object.defineProperty(i,"_classRegistryKey",{value:t,writeable:!1}),um[t]={klass:i,omit:r.omit||[]}}un(Object,"Object"),Kr.serialize=function(i,t){const r=i.toArrayBuffer();return t&&t.add(r),{buffer:r}},Kr.deserialize=function(i){return new Kr(i.buffer)},Object.defineProperty(Kr,"name",{value:"Grid"}),un(Kr,"Grid"),un(xn,"Color"),un(Error,"Error"),un(Me,"AJAXError"),un(Jo,"ResolvedImage"),un(Jp,"StylePropertyFunction"),un(Yp,"StyleExpression",{omit:["_evaluator"]}),un(Dc,"ZoomDependentExpression"),un(Sy,"ZoomConstantExpression"),un(Ar,"CompoundExpression",{omit:["_evaluate"]});for(const i in af)um[af[i]._classRegistryKey]||un(af[i],`Expression${i}`);function Fy(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function r2(i){return m.ImageBitmap&&i instanceof m.ImageBitmap}function Ps(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Fy(i)||r2(i))return t&&t.add(i),i;if(ArrayBuffer.isView(i)){const r=i;return t&&t.add(r.buffer),r}if(i instanceof m.ImageData)return t&&t.add(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const l of i)r.push(Ps(l,t));return r}if(i instanceof Map){const r={$name:"Map"};for(const[l,u]of i.entries())r[l]=Ps(u);return r}if(typeof i=="object"){const r=i.constructor,l=r._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const u=r.serialize?r.serialize(i,t):{};if(!r.serialize){for(const h in i)i.hasOwnProperty(h)&&(um[l].omit.indexOf(h)>=0||(u[h]=Ps(i[h],t)));i instanceof Error&&(u.message=i.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof i)}function Wd(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Fy(i)||r2(i)||ArrayBuffer.isView(i)||i instanceof m.ImageData)return i;if(Array.isArray(i))return i.map(Wd);if(typeof i=="object"){const t=i.$name||"Object";if(t==="Map"){const u=new Map;for(const h of Object.keys(i))h!=="$name"&&u.set(h,Wd(i[h]));return u}const{klass:r}=um[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(i);const l=Object.create(r.prototype);for(const u of Object.keys(i))u!=="$name"&&(l[u]=Wd(i[u]));return l}throw new Error("can't deserialize object of type "+typeof i)}const pn={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519,"CJK Unified Ideographs Extension B":i=>i>=131072&&i<=173791};function dm(i){for(const t of i)if(Ny(t.charCodeAt(0)))return!0;return!1}function Vd(i){for(const t of i)if(!o2(t.charCodeAt(0)))return!1;return!0}function o2(i){return!(pn.Arabic(i)||pn["Arabic Supplement"](i)||pn["Arabic Extended-A"](i)||pn["Arabic Presentation Forms-A"](i)||pn["Arabic Presentation Forms-B"](i))}function Ny(i){return!(i!==746&&i!==747&&(i<4352||!(pn["Bopomofo Extended"](i)||pn.Bopomofo(i)||pn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||pn["CJK Compatibility Ideographs"](i)||pn["CJK Compatibility"](i)||pn["CJK Radicals Supplement"](i)||pn["CJK Strokes"](i)||!(!pn["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||pn["CJK Unified Ideographs Extension A"](i)||pn["CJK Unified Ideographs"](i)||pn["Enclosed CJK Letters and Months"](i)||pn["Hangul Compatibility Jamo"](i)||pn["Hangul Jamo Extended-A"](i)||pn["Hangul Jamo Extended-B"](i)||pn["Hangul Jamo"](i)||pn["Hangul Syllables"](i)||pn.Hiragana(i)||pn["Ideographic Description Characters"](i)||pn.Kanbun(i)||pn["Kangxi Radicals"](i)||pn["Katakana Phonetic Extensions"](i)||pn.Katakana(i)&&i!==12540||!(!pn["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!pn["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||pn["Unified Canadian Aboriginal Syllabics"](i)||pn["Unified Canadian Aboriginal Syllabics Extended"](i)||pn["Vertical Forms"](i)||pn["Yijing Hexagram Symbols"](i)||pn["Yi Syllables"](i)||pn["Yi Radicals"](i))))}function By(i){return!(Ny(i)||function(t){return!!(pn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||pn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||pn["Letterlike Symbols"](t)||pn["Number Forms"](t)||pn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||pn["Control Pictures"](t)&&t!==9251||pn["Optical Character Recognition"](t)||pn["Enclosed Alphanumerics"](t)||pn["Geometric Shapes"](t)||pn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||pn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||pn["CJK Symbols and Punctuation"](t)||pn.Katakana(t)||pn["Private Use Area"](t)||pn["CJK Compatibility Forms"](t)||pn["Small Form Variants"](t)||pn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function hm(i){return i>=1424&&i<=2303||pn["Arabic Presentation Forms-A"](i)||pn["Arabic Presentation Forms-B"](i)}function sC(i,t){return!(!t&&hm(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||pn.Khmer(i))}function lC(i){for(const t of i)if(hm(t.charCodeAt(0)))return!0;return!1}const Uy="deferred",Wy="loading",zc="loaded";let B_=null,Nr="unavailable",Fc=null;const Go=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Nr="error"),B_&&B_(i)};function U_(){Vy.fire(new Ht("pluginStateChange",{pluginStatus:Nr,pluginURL:Fc}))}const Vy=new Bn,W_=function(){return Nr},s2=function(){if(Nr!==Uy||!Fc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Nr=Wy,U_(),Fc&&yt({url:Fc},i=>{i?Go(i):(Nr=zc,U_())})},Is={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Nr===zc||Is.applyArabicShaping!=null,isLoading:()=>Nr===Wy,setState(i){Nr=i.pluginStatus,Fc=i.pluginURL},isParsed:()=>Is.applyArabicShaping!=null&&Is.processBidirectionalText!=null&&Is.processStyledBidirectionalText!=null,getPluginURL:()=>Fc};class ii{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(r,l){for(const u of r)if(!sC(u.charCodeAt(0),l))return!1;return!0}(t,Is.isLoaded())}}class Gy{constructor(t,r,l){this.property=t,this.value=r,this.expression=function(u,h,p){if(wy(u))return new Jp(u,h);if(Kp(u)||Array.isArray(u)&&u.length>0){const g=Ay(u,h,p);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&h.type==="color"&&(g=xn.parse(u)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(r===void 0?t.specification.default:r,t.specification,l)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,l){return this.property.possiblyEvaluate(this,t,r,l)}}class rs{constructor(t,r){this.property=t,this.value=new Gy(t,void 0,r)}transitioned(t,r){return new l2(this.property,this.value,r,Ue({},t.transition,this.transition),t.now)}untransitioned(){return new l2(this.property,this.value,null,{},0)}}class Gd{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return le(this._values[t].value.value)}setValue(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new rs(this._values[t].property,this._options)),this._values[t].value=new Gy(this._values[t].property,r===null?void 0:le(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,r){r&&(this._options=r);const l=this._properties.properties;if(t)for(const u in t){const h=t[u];if(gt(u,"-transition")){const p=u.slice(0,-11);l[p]&&this.setTransition(p,h)}else l[u]&&this.setValue(u,h)}}getTransition(t){return le(this._values[t].transition)}setTransition(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new rs(this._values[t].property)),this._values[t].transition=le(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l);const u=this.getTransition(r);u!==void 0&&(t[`${r}-transition`]=u)}return t}transitioned(t,r){const l=new Nc(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].transitioned(t,r._values[u]);return l}untransitioned(){const t=new Nc(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class l2{constructor(t,r,l,u,h){const p=u.delay||0,g=u.duration||0;h=h||0,this.property=t,this.value=r,this.begin=h+p,this.end=this.begin+g,t.specification.transition&&(u.delay||u.duration)&&(this.prior=l)}possiblyEvaluate(t,r,l){const u=t.now||0,h=this.value.possiblyEvaluate(t,r,l),p=this.prior;if(p){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return p.possiblyEvaluate(t,r,l);{const g=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,r,l),h,Re(g))}}return h}}class Nc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,l){const u=new Fu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,l);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Hy{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return le(this._values[t].value)}setValue(t,r){this._values[t]=new Gy(this._values[t].property,r===null?void 0:le(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l)}return t}possiblyEvaluate(t,r,l){const u=new Fu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,l);return u}}class nl{constructor(t,r,l){this.property=t,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,l,u){return this.property.evaluate(this.value,this.parameters,t,r,l,u)}}class Fu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Xt{constructor(t){this.specification=t}possiblyEvaluate(t,r){return t.expression.evaluate(r)}interpolate(t,r,l){const u=Up[this.specification.type];return u?u(t,r,l):t}}class yn{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,l,u){return new nl(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},l,u)}:t.expression,r)}interpolate(t,r,l){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new nl(this,{kind:"constant",value:void 0},t.parameters);const u=Up[this.specification.type];return u?new nl(this,{kind:"constant",value:u(t.value.value,r.value.value,l)},t.parameters):t}evaluate(t,r,l,u,h,p){return t.kind==="constant"?t.value:t.evaluate(r,l,u,h,p)}}class fm{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,u){return!!t.expression.evaluate(r,null,{},l,u)}interpolate(){return!1}}class gi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new ii(0,{});for(const l in t){const u=t[l];u.specification.overridable&&this.overridableProperties.push(l);const h=this.defaultPropertyValues[l]=new Gy(u,void 0),p=this.defaultTransitionablePropertyValues[l]=new rs(u);this.defaultTransitioningPropertyValues[l]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=h.possiblyEvaluate(r)}}}function Ho(i,t){return t?`${i}${t}`:i}function jy(i){const t=i.indexOf("");return t>=0?i.slice(0,t):i}un(yn,"DataDrivenProperty"),un(Xt,"DataConstantProperty"),un(fm,"ColorRampProperty");const V_="-transition";class jo extends Bn{constructor(t,r,l){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=l,t.slot&&(this.slot=t.slot),r.layout&&(this._unevaluatedLayout=new Hy(r.layout,l),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new Gd(r.paint,l);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fu(r.paint)}}setScope(t){this.scope=t,this.fqid=Ho(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,l={}){if(r!=null&&this._validate(N_,`layers.${this.id}.layout.${t}`,t,r,l))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=r);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return gt(t,V_)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,l={}){if(r!=null&&this._validate(cm,`layers.${this.id}.paint.${t}`,t,r,l))return!1;const u=this._transitionablePaint,h=u._properties.properties;if(gt(t,V_)){const T=t.slice(0,-11);return h[T]&&u.setTransition(T,r||void 0),!1}if(!h[t])return!1;const p=u._values[t],g=p.value.isDataDriven(),v=p.value;u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=u._values[t].value,x=b.isDataDriven(),S=gt(t,"pattern")||t==="line-dasharray";return x||g||S||this._handleOverridablePaintPropertyUpdate(t,v,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,r){return null}_handleOverridablePaintPropertyUpdate(t,r,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){return Be({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,r)=>!(t===void 0||r==="layout"&&!Object.keys(t).length||r==="paint"&&!Object.keys(t).length))}_validate(t,r,l,u,h={}){return(!h||h.validate!==!1)&&fo(this,t.call(ku,{key:r,layerType:this.type,objectKey:l,value:u,styleSpec:tt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof nl&&zd(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=tm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}class cC{constructor(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps=new Set,this.changedImages=new Set}updateLayer(t){const r=t.scope;this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._updatedLayers[r].add(t.id)}removeLayer(t){const r=t.scope;this._removedLayers[r]=this._removedLayers[r]||{},this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._removedLayers[r][t.id]=t,this._updatedLayers[r].delete(t.id),this.updatedPaintProps.delete(t.fqid)}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const r in this._updatedLayers)t[r]=t[r]||{},t[r].updatedIds=Array.from(this._updatedLayers[r].values());for(const r in this._removedLayers)t[r]=t[r]||{},t[r].removedIds=Object.keys(this._removedLayers[r]);return t}reset(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps.clear(),this.changedImages.clear()}}const uC={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class E{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class M{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function N(i,t=1){let r=0,l=0;return{members:i.map(u=>{const h=uC[u.type].BYTES_PER_ELEMENT,p=r=H(r,Math.max(t,h)),g=u.components||1;return l=Math.max(l,h),r+=h*g,{name:u.name,type:u.type,components:g,offset:p}}),size:H(r,Math.max(l,t)),alignment:t}}function H(i,t){return Math.ceil(i/t)*t}class J extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.int16[u+0]=r,this.int16[u+1]=l,t}}J.prototype.bytesPerElement=4,un(J,"StructArrayLayout2i4");class ie extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.int16[h+0]=r,this.int16[h+1]=l,this.int16[h+2]=u,t}}ie.prototype.bytesPerElement=6,un(ie,"StructArrayLayout3i6");class je extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.int16[p+0]=r,this.int16[p+1]=l,this.int16[p+2]=u,this.int16[p+3]=h,t}}je.prototype.bytesPerElement=8,un(je,"StructArrayLayout4i8");class vt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=5*t;return this.int16[g+0]=r,this.int16[g+1]=l,this.int16[g+2]=u,this.int16[g+3]=h,this.int16[g+4]=p,t}}vt.prototype.bytesPerElement=10,un(vt,"StructArrayLayout5i10");class jt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=6*t,x=12*t,S=3*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.uint8[x+4]=u,this.uint8[x+5]=h,this.uint8[x+6]=p,this.uint8[x+7]=g,this.float32[S+2]=v,t}}jt.prototype.bytesPerElement=12,un(jt,"StructArrayLayout2i4ub1f12");class dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.float32[p+0]=r,this.float32[p+1]=l,this.float32[p+2]=u,this.float32[p+3]=h,t}}dn.prototype.bytesPerElement=16,un(dn,"StructArrayLayout4f16");class Mn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=6*t,v=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=l,this.uint16[g+2]=u,this.uint16[g+3]=h,this.float32[v+2]=p,t}}Mn.prototype.bytesPerElement=12,un(Mn,"StructArrayLayout4ui1f12");class va extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.uint16[p+0]=r,this.uint16[p+1]=l,this.uint16[p+2]=u,this.uint16[p+3]=h,t}}va.prototype.bytesPerElement=8,un(va,"StructArrayLayout4ui8");class Jn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,l,u,h,p)}emplace(t,r,l,u,h,p,g){const v=6*t;return this.int16[v+0]=r,this.int16[v+1]=l,this.int16[v+2]=u,this.int16[v+3]=h,this.int16[v+4]=p,this.int16[v+5]=g,t}}Jn.prototype.bytesPerElement=12,un(Jn,"StructArrayLayout6i12");class yi extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,x,S,T){const P=this.length;return this.resize(P+1),this.emplace(P,t,r,l,u,h,p,g,v,b,x,S,T)}emplace(t,r,l,u,h,p,g,v,b,x,S,T,P){const R=12*t;return this.int16[R+0]=r,this.int16[R+1]=l,this.int16[R+2]=u,this.int16[R+3]=h,this.uint16[R+4]=p,this.uint16[R+5]=g,this.uint16[R+6]=v,this.uint16[R+7]=b,this.int16[R+8]=x,this.int16[R+9]=S,this.int16[R+10]=T,this.int16[R+11]=P,t}}yi.prototype.bytesPerElement=24,un(yi,"StructArrayLayout4i4ui4i24");class Vn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,l,u,h,p)}emplace(t,r,l,u,h,p,g){const v=10*t,b=5*t;return this.int16[v+0]=r,this.int16[v+1]=l,this.int16[v+2]=u,this.float32[b+2]=h,this.float32[b+3]=p,this.float32[b+4]=g,t}}Vn.prototype.bytesPerElement=20,un(Vn,"StructArrayLayout3i3f20");class po extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}po.prototype.bytesPerElement=4,un(po,"StructArrayLayout1ul4");class Jr extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.uint16[u+0]=r,this.uint16[u+1]=l,t}}Jr.prototype.bytesPerElement=4,un(Jr,"StructArrayLayout2ui4");class Nt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,x,S,T,P){const R=this.length;return this.resize(R+1),this.emplace(R,t,r,l,u,h,p,g,v,b,x,S,T,P)}emplace(t,r,l,u,h,p,g,v,b,x,S,T,P,R){const z=20*t,U=10*t;return this.int16[z+0]=r,this.int16[z+1]=l,this.int16[z+2]=u,this.int16[z+3]=h,this.int16[z+4]=p,this.float32[U+3]=g,this.float32[U+4]=v,this.float32[U+5]=b,this.float32[U+6]=x,this.int16[z+14]=S,this.uint32[U+8]=T,this.uint16[z+18]=P,this.uint16[z+19]=R,t}}Nt.prototype.bytesPerElement=40,un(Nt,"StructArrayLayout5i4f1i1ul2ui40");class xt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=8*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.int16[b+2]=u,this.int16[b+4]=h,this.int16[b+5]=p,this.int16[b+6]=g,this.int16[b+7]=v,t}}xt.prototype.bytesPerElement=16,un(xt,"StructArrayLayout3i2i2i16");class Wt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=4*t,v=8*t;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=u,this.int16[v+6]=h,this.int16[v+7]=p,t}}Wt.prototype.bytesPerElement=16,un(Wt,"StructArrayLayout2f1f2i16");class An extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=12*t,g=3*t;return this.uint8[p+0]=r,this.uint8[p+1]=l,this.float32[g+1]=u,this.float32[g+2]=h,t}}An.prototype.bytesPerElement=12,un(An,"StructArrayLayout2ub2f12");class Dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.float32[h+0]=r,this.float32[h+1]=l,this.float32[h+2]=u,t}}Dn.prototype.bytesPerElement=12,un(Dn,"StructArrayLayout3f12");class Nn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.uint16[h+0]=r,this.uint16[h+1]=l,this.uint16[h+2]=u,t}}Nn.prototype.bytesPerElement=6,un(Nn,"StructArrayLayout3ui6");class wa extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$){const K=this.length;return this.resize(K+1),this.emplace(K,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$)}emplace(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$,K){const ae=30*t,se=15*t,de=60*t;return this.int16[ae+0]=r,this.int16[ae+1]=l,this.int16[ae+2]=u,this.float32[se+2]=h,this.float32[se+3]=p,this.uint16[ae+8]=g,this.uint16[ae+9]=v,this.uint32[se+5]=b,this.uint32[se+6]=x,this.uint32[se+7]=S,this.uint16[ae+16]=T,this.uint16[ae+17]=P,this.uint16[ae+18]=R,this.float32[se+10]=z,this.float32[se+11]=U,this.uint8[de+48]=W,this.uint8[de+49]=j,this.uint8[de+50]=Z,this.uint32[se+13]=Y,this.int16[ae+28]=$,this.uint8[de+58]=K,t}}wa.prototype.bytesPerElement=60,un(wa,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Za extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$,K,ae,se,de,ge,Te,we,Ie,xe,We,qe){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$,K,ae,se,de,ge,Te,we,Ie,xe,We,qe)}emplace(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$,K,ae,se,de,ge,Te,we,Ie,xe,We,qe,Qe){const Ne=20*t,Ve=40*t,at=80*t;return this.float32[Ne+0]=r,this.float32[Ne+1]=l,this.int16[Ve+4]=u,this.int16[Ve+5]=h,this.int16[Ve+6]=p,this.int16[Ve+7]=g,this.int16[Ve+8]=v,this.int16[Ve+9]=b,this.int16[Ve+10]=x,this.int16[Ve+11]=S,this.int16[Ve+12]=T,this.uint16[Ve+13]=P,this.uint16[Ve+14]=R,this.uint16[Ve+15]=z,this.uint16[Ve+16]=U,this.uint16[Ve+17]=W,this.uint16[Ve+18]=j,this.uint16[Ve+19]=Z,this.uint16[Ve+20]=Y,this.uint16[Ve+21]=$,this.uint16[Ve+22]=K,this.uint16[Ve+23]=ae,this.uint16[Ve+24]=se,this.uint16[Ve+25]=de,this.uint16[Ve+26]=ge,this.uint16[Ve+27]=Te,this.uint32[Ne+14]=we,this.float32[Ne+15]=Ie,this.float32[Ne+16]=xe,this.float32[Ne+17]=We,this.float32[Ne+18]=qe,this.uint8[at+76]=Qe,t}}Za.prototype.bytesPerElement=80,un(Za,"StructArrayLayout2f9i15ui1ul4f1ub80");class fr extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}fr.prototype.bytesPerElement=4,un(fr,"StructArrayLayout1f4");class Ua extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=5*t;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=u,this.float32[g+3]=h,this.float32[g+4]=p,t}}Ua.prototype.bytesPerElement=20,un(Ua,"StructArrayLayout5f20");class sc extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=7*t;return this.float32[b+0]=r,this.float32[b+1]=l,this.float32[b+2]=u,this.float32[b+3]=h,this.float32[b+4]=p,this.float32[b+5]=g,this.float32[b+6]=v,t}}sc.prototype.bytesPerElement=28,un(sc,"StructArrayLayout7f28");class G_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=6*t;return this.uint32[3*t+0]=r,this.uint16[p+2]=l,this.uint16[p+3]=u,this.uint16[p+4]=h,t}}G_.prototype.bytesPerElement=12,un(G_,"StructArrayLayout1ul3ui12");class H_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}H_.prototype.bytesPerElement=2,un(H_,"StructArrayLayout1ui2");class j_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.float32[u+0]=r,this.float32[u+1]=l,t}}j_.prototype.bytesPerElement=8,un(j_,"StructArrayLayout2f8");class dC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U){const W=this.length;return this.resize(W+1),this.emplace(W,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U)}emplace(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W){const j=16*t;return this.float32[j+0]=r,this.float32[j+1]=l,this.float32[j+2]=u,this.float32[j+3]=h,this.float32[j+4]=p,this.float32[j+5]=g,this.float32[j+6]=v,this.float32[j+7]=b,this.float32[j+8]=x,this.float32[j+9]=S,this.float32[j+10]=T,this.float32[j+11]=P,this.float32[j+12]=R,this.float32[j+13]=z,this.float32[j+14]=U,this.float32[j+15]=W,t}}dC.prototype.bytesPerElement=64,un(dC,"StructArrayLayout16f64");class c2 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=10*t,x=5*t;return this.uint16[b+0]=r,this.uint16[b+1]=l,this.uint16[b+2]=u,this.uint16[b+3]=h,this.float32[x+2]=p,this.float32[x+3]=g,this.float32[x+4]=v,t}}c2.prototype.bytesPerElement=20,un(c2,"StructArrayLayout4ui3f20");class hC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint8[1*t+0]=r,t}}hC.prototype.bytesPerElement=1,un(hC,"StructArrayLayout1ub1");class eO extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}eO.prototype.size=40;class fC extends Nt{get(t){return new eO(this,t)}}un(fC,"CollisionBoxArray");class tO extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}tO.prototype.size=60;class nO extends wa{get(t){return new tO(this,t)}}un(nO,"PlacedSymbolArray");class aO extends E{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}aO.prototype.size=80;class iO extends Za{get(t){return new aO(this,t)}}un(iO,"SymbolInstanceArray");class rO extends fr{getoffsetX(t){return this.float32[1*t+0]}}un(rO,"GlyphOffsetArray");class oO extends J{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}un(oO,"SymbolLineVertexArray");class sO extends E{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}sO.prototype.size=12;class lO extends G_{get(t){return new sO(this,t)}}un(lO,"FeatureIndexArray");class cO extends Jr{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}un(cO,"FillExtrusionCentroidArray");const QJ=N([{name:"a_pos",components:2,type:"Int16"}],4),eQ=N([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ha{constructor(t=[]){this.segments=t}_prepareSegment(t,r,l,u){let h=this.segments[this.segments.length-1];return t>Ha.MAX_VERTEX_ARRAY_LENGTH&&ve(`Max vertices per segment is ${Ha.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!h||h.vertexLength+t>Ha.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:r,primitiveOffset:l,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h}prepareSegment(t,r,l,u){return this._prepareSegment(t,r.length,l.length,u)}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,l,u){return new Ha([{vertexOffset:t,primitiveOffset:r,vertexLength:l,primitiveLength:u,vaos:{},sortKey:0}])}}function uO(i,t){return 256*(i=ne(Math.floor(i),0,255))+ne(Math.floor(t),0,255)}Ha.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,un(Ha,"SegmentVector");const tQ=N([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),nQ=N([{name:"a_dash",components:4,type:"Uint16"}]);var u2={exports:{}},dO={exports:{}};(function(i){i.exports=function(t,r){var l,u,h,p,g,v,b,x;for(u=t.length-(l=3&t.length),h=r,g=3432918353,v=461845907,x=0;x<u;)b=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24,++x,h=27492+(65535&(p=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(b=0,l){case 3:b^=(255&t.charCodeAt(x+2))<<16;case 2:b^=(255&t.charCodeAt(x+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(x)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}})(dO);var aQ=dO.exports,hO={exports:{}};(function(i){i.exports=function(t,r){for(var l,u=t.length,h=r^u,p=0;u>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(p)|(255&t.charCodeAt(++p))<<8|(255&t.charCodeAt(++p))<<16|(255&t.charCodeAt(++p))<<24))+((1540483477*(l>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),u-=4,++p;switch(u){case 3:h^=(255&t.charCodeAt(p+2))<<16;case 2:h^=(255&t.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}})(hO);var fO=aQ,iQ=hO.exports;u2.exports=fO,u2.exports.murmur3=fO,u2.exports.murmur2=iQ;var pC=F(u2.exports);class $_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,r,l,u){this.ids.push(pO(t)),this.positions.push(r,l,u)}eachPosition(t,r){const l=pO(t);let u=0,h=this.ids.length-1;for(;u<h;){const p=u+h>>1;this.ids[p]>=l?h=p:u=p+1}for(;this.ids[u]===l;)r(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(t,r){const l=new Float64Array(t.ids),u=new Uint32Array(t.positions);return mC(l,u,0,l.length-1),r&&(r.add(l.buffer),r.add(u.buffer)),{ids:l,positions:u}}static deserialize(t){const r=new $_;let l;r.ids=t.ids,r.positions=t.positions;for(const u of r.ids)u!==l&&r.uniqueIds.push(u),l=u;return r.indexed=!0,r}}function pO(i){const t=+i;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:pC(String(i))}function mC(i,t,r,l){for(;r<l;){const u=i[r+l>>1];let h=r-1,p=l+1;for(;;){do h++;while(i[h]<u);do p--;while(i[p]>u);if(h>=p)break;d2(i,h,p),d2(t,3*h,3*p),d2(t,3*h+1,3*p+1),d2(t,3*h+2,3*p+2)}p-r<l-p?(mC(i,t,r,p),r=p+1):(mC(i,t,p+1,l),l=p)}}function d2(i,t,r){const l=i[t];i[t]=i[r],i[r]=l}un($_,"FeaturePositionMap");class Hd{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,r),this.initialized=!0),!!this.location}}class ra extends Hd{constructor(t){super(t),this.current=0}set(t,r,l){this.fetchUniformLocation(t,r)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}}class Zt extends Hd{constructor(t){super(t),this.current=0}set(t,r,l){this.fetchUniformLocation(t,r)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class ca extends Hd{constructor(t){super(t),this.current=[0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}}class Xn extends Hd{constructor(t){super(t),this.current=[0,0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}}class al extends Hd{constructor(t){super(t),this.current=[0,0,0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class $y extends Hd{constructor(t){super(t),this.current=xn.transparent}set(t,r,l){this.fetchUniformLocation(t,r)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const rQ=new Float32Array(16);class jn extends Hd{constructor(t){super(t),this.current=rQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let u=1;u<16;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}}const oQ=new Float32Array(9);class mO extends Hd{constructor(t){super(t),this.current=oQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){for(let u=0;u<9;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}}const sQ=new Float32Array(4);class gC extends Hd{constructor(t){super(t),this.current=sQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){for(let u=0;u<4;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}}function yC(i){return[uO(255*i.r,255*i.g),uO(255*i.b,255*i.a)]}class q_{constructor(t,r,l){this.value=t,this.uniformNames=r.map(u=>`u_${u}`),this.type=l}setUniform(t,r,l,u,h){r.set(t,h,u.constantOr(this.value))}getBinding(t,r){return this.type==="color"?new $y(t):new Zt(t)}}class qy{constructor(t,r){this.uniformNames=r.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,r,l,u,h){const p=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;p&&r.set(t,h,p)}getBinding(t,r){return r==="u_pattern"||r==="u_dash"?new al(t):new Zt(t)}}class jd{constructor(t,r,l,u){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(h=>({name:`a_${h}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,r,l,u,h,p,g){const v=this.paintVertexArray.length,b=this.expression.evaluate(new ii(0,{brightness:p}),r,{},h,u,g);this.paintVertexArray.resize(t),this._setPaintValue(v,t,b)}updatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate({zoom:0,brightness:g},l,u,void 0,h);this._setPaintValue(t,r,v)}_setPaintValue(t,r,l){if(this.type==="color"){const u=yC(l);for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,u[0],u[1])}else{for(let u=t;u<r;u++)this.paintVertexArray.emplace(u,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bc{constructor(t,r,l,u,h,p){this.expression=t,this.uniformNames=r.map(g=>`u_${g}_t`),this.type=l,this.useIntegerZoom=u,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate(new ii(this.zoom,{brightness:p}),r,{},h,u,g),b=this.expression.evaluate(new ii(this.zoom+1,{brightness:p}),r,{},h,u,g),x=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(x,t,v,b)}updatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},l,u,void 0,h),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},l,u,void 0,h);this._setPaintValue(t,r,v,b)}_setPaintValue(t,r,l,u){if(this.type==="color"){const h=yC(l),p=yC(u);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,h[0],h[1],p[0],p[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,l,u);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r,l,u,h){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,g=ne(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);r.set(t,h,g)}getBinding(t,r){return new Zt(t)}}class uf{constructor(t,r,l,u,h){this.expression=t,this.layerId=h,this.paintVertexAttributes=(l==="array"?nQ:tQ).members;for(let p=0;p<r.length;++p);this.paintVertexArray=new u}populatePaintArray(t,r,l){const u=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(u,t,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(t,r,l,u,h,p,g){this._setPaintValues(t,r,l.patterns&&l.patterns[this.layerId],p)}_setPaintValues(t,r,l,u){if(!u||!l)return;const h=u[l];if(!h)return;const{tl:p,br:g,pixelRatio:v}=h;for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,p[0],p[1],g[0],g[1],v)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class pm{constructor(t,r,l=()=>!0){this.binders={},this._buffers=[];const u=[];for(const h in t.paint._values){const p=t.paint.get(h);if(!l(h)||!(p instanceof nl&&zd(p.property.specification)))continue;const g=cQ(h,t.type),v=p.value,b=p.property.specification.type,x=!!p.property.useIntegerZoom,S=h==="line-dasharray"||h.endsWith("pattern"),T=h==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||T)if(v.kind==="source"||T||S){const P=gO(h,b,"source");this.binders[h]=S?new uf(v,g,b,P,t.id):new jd(v,g,b,P),u.push(`/a_${h}`)}else{const P=gO(h,b,"composite");this.binders[h]=new Bc(v,g,b,x,r,P),u.push(`/z_${h}`)}else this.binders[h]=S?new qy(v.value,g):new q_(v.value,g,b),u.push(`/u_${h}`)}this.cacheKey=u.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof jd||r instanceof Bc?r.maxValue:0}populatePaintArrays(t,r,l,u,h,p,g){for(const v in this.binders){const b=this.binders[v];(b instanceof jd||b instanceof Bc||b instanceof uf)&&b.populatePaintArray(t,r,l,u,h,p,g)}}setConstantPatternPositions(t){for(const r in this.binders){const l=this.binders[r];l instanceof qy&&l.setConstantPatternPositions(t)}}updatePaintArrays(t,r,l,u,h,p,g,v){let b=!1;const x=Object.keys(t),S=x.length!==0,T=S?x:r.uniqueIds;for(const P in this.binders){const R=this.binders[P];if((R instanceof jd||R instanceof Bc||R instanceof uf)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const z=h.paint.get(P);R.expression=z.value;for(const U of T){const W=t[U.toString()];r.eachPosition(U,(j,Z,Y)=>{const $=u.feature(j);R.updatePaintArray(Z,Y,$,W,p,g,v)})}if(!S)for(const U of l.uniqueIds){const W=t[U.toString()];l.eachPosition(U,(j,Z,Y)=>{const $=u.feature(j);R.updatePaintArray(Z,Y,$,W,p,g,v)})}b=!0}}return b}defines(){const t=[];for(const r in this.binders){const l=this.binders[r];(l instanceof q_||l instanceof qy)&&t.push(...l.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof jd||l instanceof Bc||l instanceof uf)for(let u=0;u<l.paintVertexAttributes.length;u++)t.push(l.paintVertexAttributes[u].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof q_||l instanceof qy||l instanceof Bc)for(const u of l.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const r=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof q_||u instanceof qy||u instanceof Bc)for(const h of u.uniformNames)r.push({name:h,property:l,binding:u.getBinding(t,h)})}return r}setUniforms(t,r,l,u,h){for(const{name:p,property:g,binding:v}of l)this.binders[g].setUniform(t,v,h,u.get(g),p)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const r=this.binders[t];(r instanceof jd||r instanceof Bc||r instanceof uf)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(t){for(const r in this.binders){const l=this.binders[r];(l instanceof jd||l instanceof Bc||l instanceof uf)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof jd||r instanceof Bc||r instanceof uf)&&r.destroy()}}}class df{constructor(t,r,l=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new pm(u,r,l);this.needsUpload=!1,this._featureMap=new $_,this._featureMapWithoutIds=new $_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,r,l,u,h,p,g,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,u,h,p,g,v);r.id!==void 0?this._featureMap.add(r.id,l,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,l,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,l,u,h,p){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,r,g,u,h,p||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const lQ={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function cQ(i,t){return lQ[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}const uQ={"line-pattern":{source:Mn,composite:Mn},"fill-pattern":{source:Mn,composite:Mn},"fill-extrusion-pattern":{source:Mn,composite:Mn},"line-dasharray":{source:va,composite:va}},dQ={color:{source:j_,composite:dn},number:{source:fr,composite:j_}};function gO(i,t,r){const l=uQ[i];return l&&l[r]||dQ[t][r]}un(q_,"ConstantBinder"),un(qy,"PatternConstantBinder"),un(jd,"SourceExpressionBinder"),un(uf,"PatternCompositeBinder"),un(Bc,"CompositeExpressionBinder"),un(pm,"ProgramConfiguration",{omit:["_buffers"]}),un(df,"ProgramConfigurationSet");class Il{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}setSouthWest(t){return this._sw=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}extend(t){const r=this._sw,l=this._ne;let u,h;if(t instanceof On)u=t,h=t;else{if(!(t instanceof Il))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Il.convert(t)):this.extend(On.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(On.convert(t)):this;if(u=t._sw,h=t._ne,!u||!h)return this}return r||l?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),l.lng=Math.max(h.lng,l.lng),l.lat=Math.max(h.lat,l.lat)):(this._sw=new On(u.lng,u.lat),this._ne=new On(h.lng,h.lat)),this}getCenter(){return new On((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new On(this.getWest(),this.getNorth())}getSouthEast(){return new On(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:l}=On.convert(t);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(t){return!t||t instanceof Il?t:new Il(t)}}var Qr={},eo={};Object.defineProperty(eo,"__esModule",{value:!0}),eo.setMatrixArrayType=function(i){eo.ARRAY_TYPE=vO=i},eo.toRadian=function(i){return i*fQ},eo.equals=function(i,t){return Math.abs(i-t)<=yO*Math.max(1,Math.abs(i),Math.abs(t))},eo.RANDOM=eo.ARRAY_TYPE=eo.EPSILON=void 0;var yO=1e-6;eo.EPSILON=yO;var vO=typeof Float32Array<"u"?Float32Array:Array;eo.ARRAY_TYPE=vO;var hQ=Math.random;eo.RANDOM=hQ;var fQ=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Ci={};function vC(i){return vC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vC(i)}Object.defineProperty(Ci,"__esModule",{value:!0}),Ci.create=function(){var i=new hf.ARRAY_TYPE(4);return hf.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},Ci.clone=function(i){var t=new hf.ARRAY_TYPE(4);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t},Ci.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},Ci.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i},Ci.fromValues=function(i,t,r,l){var u=new hf.ARRAY_TYPE(4);return u[0]=i,u[1]=t,u[2]=r,u[3]=l,u},Ci.set=function(i,t,r,l,u){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i},Ci.transpose=function(i,t){if(i===t){var r=t[1];i[1]=t[2],i[2]=r}else i[0]=t[0],i[1]=t[2],i[2]=t[1],i[3]=t[3];return i},Ci.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*h-u*l;return p?(i[0]=h*(p=1/p),i[1]=-l*p,i[2]=-u*p,i[3]=r*p,i):null},Ci.adjoint=function(i,t){var r=t[0];return i[0]=t[3],i[1]=-t[1],i[2]=-t[2],i[3]=r,i},Ci.determinant=function(i){return i[0]*i[3]-i[2]*i[1]},Ci.multiply=bO,Ci.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+h*g,i[1]=u*v+p*g,i[2]=l*-g+h*v,i[3]=u*-g+p*v,i},Ci.scale=function(i,t,r){var l=t[1],u=t[2],h=t[3],p=r[0],g=r[1];return i[0]=t[0]*p,i[1]=l*p,i[2]=u*g,i[3]=h*g,i},Ci.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=-r,i[3]=l,i},Ci.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=t[1],i},Ci.str=function(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Ci.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},Ci.LDU=function(i,t,r,l){return i[2]=l[2]/l[0],r[0]=l[0],r[1]=l[1],r[3]=l[3]-i[2]*r[1],[i,t,r]},Ci.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i},Ci.subtract=xO,Ci.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]},Ci.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-p)<=hf.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(l-g)<=hf.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=hf.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=hf.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},Ci.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},Ci.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i},Ci.sub=Ci.mul=void 0;var hf=function(i,t){if(i&&i.__esModule)return i;if(i===null||vC(i)!=="object"&&typeof i!="function")return{default:i};var r=_O(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function _O(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(_O=function(l){return l?r:t})(i)}function bO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],x=r[3];return i[0]=l*g+h*v,i[1]=u*g+p*v,i[2]=l*b+h*x,i[3]=u*b+p*x,i}function xO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i}Ci.mul=bO,Ci.sub=xO;var ki={};function _C(i){return _C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_C(i)}Object.defineProperty(ki,"__esModule",{value:!0}),ki.create=function(){var i=new Nu.ARRAY_TYPE(6);return Nu.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[4]=0,i[5]=0),i[0]=1,i[3]=1,i},ki.clone=function(i){var t=new Nu.ARRAY_TYPE(6);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t},ki.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i},ki.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i},ki.fromValues=function(i,t,r,l,u,h){var p=new Nu.ARRAY_TYPE(6);return p[0]=i,p[1]=t,p[2]=r,p[3]=l,p[4]=u,p[5]=h,p},ki.set=function(i,t,r,l,u,h,p){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i},ki.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=r*h-l*u;return v?(i[0]=h*(v=1/v),i[1]=-l*v,i[2]=-u*v,i[3]=r*v,i[4]=(u*g-h*p)*v,i[5]=(l*p-r*g)*v,i):null},ki.determinant=function(i){return i[0]*i[3]-i[1]*i[2]},ki.multiply=SO,ki.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=Math.sin(r),x=Math.cos(r);return i[0]=l*x+h*b,i[1]=u*x+p*b,i[2]=l*-b+h*x,i[3]=u*-b+p*x,i[4]=g,i[5]=v,i},ki.scale=function(i,t,r){var l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=r[0],b=r[1];return i[0]=t[0]*v,i[1]=l*v,i[2]=u*b,i[3]=h*b,i[4]=p,i[5]=g,i},ki.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=r[0],x=r[1];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=l*b+h*x+g,i[5]=u*b+p*x+v,i},ki.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=-r,i[3]=l,i[4]=0,i[5]=0,i},ki.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=t[1],i[4]=0,i[5]=0,i},ki.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=t[0],i[5]=t[1],i},ki.str=function(i){return"mat2d("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+")"},ki.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],1)},ki.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i},ki.subtract=AO,ki.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i},ki.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i},ki.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]},ki.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=t[0],b=t[1],x=t[2],S=t[3],T=t[4],P=t[5];return Math.abs(r-v)<=Nu.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(l-b)<=Nu.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-x)<=Nu.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(h-S)<=Nu.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(p-T)<=Nu.EPSILON*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(g-P)<=Nu.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},ki.sub=ki.mul=void 0;var Nu=function(i,t){if(i&&i.__esModule)return i;if(i===null||_C(i)!=="object"&&typeof i!="function")return{default:i};var r=wO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function wO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(wO=function(l){return l?r:t})(i)}function SO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=r[0],x=r[1],S=r[2],T=r[3],P=r[4],R=r[5];return i[0]=l*b+h*x,i[1]=u*b+p*x,i[2]=l*S+h*T,i[3]=u*S+p*T,i[4]=l*P+h*R+g,i[5]=u*P+p*R+v,i}function AO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i}ki.mul=SO,ki.sub=AO;var $a={};function bC(i){return bC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bC(i)}Object.defineProperty($a,"__esModule",{value:!0}),$a.create=function(){var i=new Ll.ARRAY_TYPE(9);return Ll.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},$a.fromMat4=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[4],i[4]=t[5],i[5]=t[6],i[6]=t[8],i[7]=t[9],i[8]=t[10],i},$a.clone=function(i){var t=new Ll.ARRAY_TYPE(9);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t},$a.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},$a.fromValues=function(i,t,r,l,u,h,p,g,v){var b=new Ll.ARRAY_TYPE(9);return b[0]=i,b[1]=t,b[2]=r,b[3]=l,b[4]=u,b[5]=h,b[6]=p,b[7]=g,b[8]=v,b},$a.set=function(i,t,r,l,u,h,p,g,v,b){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i[8]=b,i},$a.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},$a.transpose=function(i,t){if(i===t){var r=t[1],l=t[2],u=t[5];i[1]=t[3],i[2]=t[6],i[3]=r,i[5]=t[7],i[6]=l,i[7]=u}else i[0]=t[0],i[1]=t[3],i[2]=t[6],i[3]=t[1],i[4]=t[4],i[5]=t[7],i[6]=t[2],i[7]=t[5],i[8]=t[8];return i},$a.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],x=t[8],S=x*p-g*b,T=-x*h+g*v,P=b*h-p*v,R=r*S+l*T+u*P;return R?(i[0]=S*(R=1/R),i[1]=(-x*l+u*b)*R,i[2]=(g*l-u*p)*R,i[3]=T*R,i[4]=(x*r-u*v)*R,i[5]=(-g*r+u*h)*R,i[6]=P*R,i[7]=(-b*r+l*v)*R,i[8]=(p*r-l*h)*R,i):null},$a.adjoint=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],x=t[8];return i[0]=p*x-g*b,i[1]=u*b-l*x,i[2]=l*g-u*p,i[3]=g*v-h*x,i[4]=r*x-u*v,i[5]=u*h-r*g,i[6]=h*b-p*v,i[7]=l*v-r*b,i[8]=r*p-l*h,i},$a.determinant=function(i){var t=i[3],r=i[4],l=i[5],u=i[6],h=i[7],p=i[8];return i[0]*(p*r-l*h)+i[1]*(-p*t+l*u)+i[2]*(h*t-r*u)},$a.multiply=MO,$a.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=t[8],T=r[0],P=r[1];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=g,i[5]=v,i[6]=T*l+P*p+b,i[7]=T*u+P*g+x,i[8]=T*h+P*v+S,i},$a.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=t[8],T=Math.sin(r),P=Math.cos(r);return i[0]=P*l+T*p,i[1]=P*u+T*g,i[2]=P*h+T*v,i[3]=P*p-T*l,i[4]=P*g-T*u,i[5]=P*v-T*h,i[6]=b,i[7]=x,i[8]=S,i},$a.scale=function(i,t,r){var l=r[0],u=r[1];return i[0]=l*t[0],i[1]=l*t[1],i[2]=l*t[2],i[3]=u*t[3],i[4]=u*t[4],i[5]=u*t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},$a.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=t[0],i[7]=t[1],i[8]=1,i},$a.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=0,i[3]=-r,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},$a.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=t[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},$a.fromMat2d=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=0,i[3]=t[2],i[4]=t[3],i[5]=0,i[6]=t[4],i[7]=t[5],i[8]=1,i},$a.fromQuat=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r+r,g=l+l,v=u+u,b=r*p,x=l*p,S=l*g,T=u*p,P=u*g,R=u*v,z=h*p,U=h*g,W=h*v;return i[0]=1-S-R,i[3]=x-W,i[6]=T+U,i[1]=x+W,i[4]=1-b-R,i[7]=P-z,i[2]=T-U,i[5]=P+z,i[8]=1-b-S,i},$a.normalFromMat4=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],x=t[8],S=t[9],T=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15],j=r*g-l*p,Z=r*v-u*p,Y=r*b-h*p,$=l*v-u*g,K=l*b-h*g,ae=u*b-h*v,se=x*z-S*R,de=x*U-T*R,ge=x*W-P*R,Te=S*U-T*z,we=S*W-P*z,Ie=T*W-P*U,xe=j*Ie-Z*we+Y*Te+$*ge-K*de+ae*se;return xe?(i[0]=(g*Ie-v*we+b*Te)*(xe=1/xe),i[1]=(v*ge-p*Ie-b*de)*xe,i[2]=(p*we-g*ge+b*se)*xe,i[3]=(u*we-l*Ie-h*Te)*xe,i[4]=(r*Ie-u*ge+h*de)*xe,i[5]=(l*ge-r*we-h*se)*xe,i[6]=(z*ae-U*K+W*$)*xe,i[7]=(U*Y-R*ae-W*Z)*xe,i[8]=(R*K-z*Y+W*j)*xe,i):null},$a.projection=function(i,t,r){return i[0]=2/t,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/r,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i},$a.str=function(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"},$a.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},$a.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i[8]=t[8]+r[8],i},$a.subtract=TO,$a.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*r,i},$a.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i[6]=t[6]+r[6]*l,i[7]=t[7]+r[7]*l,i[8]=t[8]+r[8]*l,i},$a.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]},$a.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],x=i[8],S=t[0],T=t[1],P=t[2],R=t[3],z=t[4],U=t[5],W=t[6],j=t[7],Z=t[8];return Math.abs(r-S)<=Ll.EPSILON*Math.max(1,Math.abs(r),Math.abs(S))&&Math.abs(l-T)<=Ll.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(u-P)<=Ll.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-R)<=Ll.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(p-z)<=Ll.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(g-U)<=Ll.EPSILON*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(v-W)<=Ll.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(b-j)<=Ll.EPSILON*Math.max(1,Math.abs(b),Math.abs(j))&&Math.abs(x-Z)<=Ll.EPSILON*Math.max(1,Math.abs(x),Math.abs(Z))},$a.sub=$a.mul=void 0;var Ll=function(i,t){if(i&&i.__esModule)return i;if(i===null||bC(i)!=="object"&&typeof i!="function")return{default:i};var r=EO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function EO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(EO=function(l){return l?r:t})(i)}function MO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=t[8],T=r[0],P=r[1],R=r[2],z=r[3],U=r[4],W=r[5],j=r[6],Z=r[7],Y=r[8];return i[0]=T*l+P*p+R*b,i[1]=T*u+P*g+R*x,i[2]=T*h+P*v+R*S,i[3]=z*l+U*p+W*b,i[4]=z*u+U*g+W*x,i[5]=z*h+U*v+W*S,i[6]=j*l+Z*p+Y*b,i[7]=j*u+Z*g+Y*x,i[8]=j*h+Z*v+Y*S,i}function TO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i[6]=t[6]-r[6],i[7]=t[7]-r[7],i[8]=t[8]-r[8],i}$a.mul=MO,$a.sub=TO;var Kn={};function xC(i){return xC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xC(i)}Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.create=function(){var i=new Hi.ARRAY_TYPE(16);return Hi.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},Kn.clone=function(i){var t=new Hi.ARRAY_TYPE(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},Kn.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},Kn.fromValues=function(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z){var U=new Hi.ARRAY_TYPE(16);return U[0]=i,U[1]=t,U[2]=r,U[3]=l,U[4]=u,U[5]=h,U[6]=p,U[7]=g,U[8]=v,U[9]=b,U[10]=x,U[11]=S,U[12]=T,U[13]=P,U[14]=R,U[15]=z,U},Kn.set=function(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i[8]=b,i[9]=x,i[10]=S,i[11]=T,i[12]=P,i[13]=R,i[14]=z,i[15]=U,i},Kn.identity=PO,Kn.transpose=function(i,t){if(i===t){var r=t[1],l=t[2],u=t[3],h=t[6],p=t[7],g=t[11];i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=r,i[6]=t[9],i[7]=t[13],i[8]=l,i[9]=h,i[11]=t[14],i[12]=u,i[13]=p,i[14]=g}else i[0]=t[0],i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=t[1],i[5]=t[5],i[6]=t[9],i[7]=t[13],i[8]=t[2],i[9]=t[6],i[10]=t[10],i[11]=t[14],i[12]=t[3],i[13]=t[7],i[14]=t[11],i[15]=t[15];return i},Kn.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],x=t[8],S=t[9],T=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15],j=r*g-l*p,Z=r*v-u*p,Y=r*b-h*p,$=l*v-u*g,K=l*b-h*g,ae=u*b-h*v,se=x*z-S*R,de=x*U-T*R,ge=x*W-P*R,Te=S*U-T*z,we=S*W-P*z,Ie=T*W-P*U,xe=j*Ie-Z*we+Y*Te+$*ge-K*de+ae*se;return xe?(i[0]=(g*Ie-v*we+b*Te)*(xe=1/xe),i[1]=(u*we-l*Ie-h*Te)*xe,i[2]=(z*ae-U*K+W*$)*xe,i[3]=(T*K-S*ae-P*$)*xe,i[4]=(v*ge-p*Ie-b*de)*xe,i[5]=(r*Ie-u*ge+h*de)*xe,i[6]=(U*Y-R*ae-W*Z)*xe,i[7]=(x*ae-T*Y+P*Z)*xe,i[8]=(p*we-g*ge+b*se)*xe,i[9]=(l*ge-r*we-h*se)*xe,i[10]=(R*K-z*Y+W*j)*xe,i[11]=(S*Y-x*K-P*j)*xe,i[12]=(g*de-p*Te-v*se)*xe,i[13]=(r*Te-l*de+u*se)*xe,i[14]=(z*Z-R*$-U*j)*xe,i[15]=(x*$-S*Z+T*j)*xe,i):null},Kn.adjoint=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],x=t[8],S=t[9],T=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15];return i[0]=g*(T*W-P*U)-S*(v*W-b*U)+z*(v*P-b*T),i[1]=-(l*(T*W-P*U)-S*(u*W-h*U)+z*(u*P-h*T)),i[2]=l*(v*W-b*U)-g*(u*W-h*U)+z*(u*b-h*v),i[3]=-(l*(v*P-b*T)-g*(u*P-h*T)+S*(u*b-h*v)),i[4]=-(p*(T*W-P*U)-x*(v*W-b*U)+R*(v*P-b*T)),i[5]=r*(T*W-P*U)-x*(u*W-h*U)+R*(u*P-h*T),i[6]=-(r*(v*W-b*U)-p*(u*W-h*U)+R*(u*b-h*v)),i[7]=r*(v*P-b*T)-p*(u*P-h*T)+x*(u*b-h*v),i[8]=p*(S*W-P*z)-x*(g*W-b*z)+R*(g*P-b*S),i[9]=-(r*(S*W-P*z)-x*(l*W-h*z)+R*(l*P-h*S)),i[10]=r*(g*W-b*z)-p*(l*W-h*z)+R*(l*b-h*g),i[11]=-(r*(g*P-b*S)-p*(l*P-h*S)+x*(l*b-h*g)),i[12]=-(p*(S*U-T*z)-x*(g*U-v*z)+R*(g*T-v*S)),i[13]=r*(S*U-T*z)-x*(l*U-u*z)+R*(l*T-u*S),i[14]=-(r*(g*U-v*z)-p*(l*U-u*z)+R*(l*v-u*g)),i[15]=r*(g*T-v*S)-p*(l*T-u*S)+x*(l*v-u*g),i},Kn.determinant=function(i){var t=i[0],r=i[1],l=i[2],u=i[3],h=i[4],p=i[5],g=i[6],v=i[7],b=i[8],x=i[9],S=i[10],T=i[11],P=i[12],R=i[13],z=i[14],U=i[15];return(t*p-r*h)*(S*U-T*z)-(t*g-l*h)*(x*U-T*R)+(t*v-u*h)*(x*z-S*R)+(r*g-l*p)*(b*U-T*P)-(r*v-u*p)*(b*z-S*P)+(l*v-u*g)*(b*R-x*P)},Kn.multiply=IO,Kn.translate=function(i,t,r){var l,u,h,p,g,v,b,x,S,T,P,R,z=r[0],U=r[1],W=r[2];return t===i?(i[12]=t[0]*z+t[4]*U+t[8]*W+t[12],i[13]=t[1]*z+t[5]*U+t[9]*W+t[13],i[14]=t[2]*z+t[6]*U+t[10]*W+t[14],i[15]=t[3]*z+t[7]*U+t[11]*W+t[15]):(u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=t[8],T=t[9],P=t[10],R=t[11],i[0]=l=t[0],i[1]=u,i[2]=h,i[3]=p,i[4]=g,i[5]=v,i[6]=b,i[7]=x,i[8]=S,i[9]=T,i[10]=P,i[11]=R,i[12]=l*z+g*U+S*W+t[12],i[13]=u*z+v*U+T*W+t[13],i[14]=h*z+b*U+P*W+t[14],i[15]=p*z+x*U+R*W+t[15]),i},Kn.scale=function(i,t,r){var l=r[0],u=r[1],h=r[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*u,i[5]=t[5]*u,i[6]=t[6]*u,i[7]=t[7]*u,i[8]=t[8]*h,i[9]=t[9]*h,i[10]=t[10]*h,i[11]=t[11]*h,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},Kn.rotate=function(i,t,r,l){var u,h,p,g,v,b,x,S,T,P,R,z,U,W,j,Z,Y,$,K,ae,se,de,ge,Te,we=l[0],Ie=l[1],xe=l[2],We=Math.hypot(we,Ie,xe);return We<Hi.EPSILON?null:(we*=We=1/We,Ie*=We,xe*=We,u=Math.sin(r),h=Math.cos(r),v=t[1],b=t[2],x=t[3],T=t[5],P=t[6],R=t[7],U=t[9],W=t[10],j=t[11],K=we*Ie*(p=1-h)-xe*u,ae=Ie*Ie*p+h,se=xe*Ie*p+we*u,de=we*xe*p+Ie*u,ge=Ie*xe*p-we*u,Te=xe*xe*p+h,i[0]=(g=t[0])*(Z=we*we*p+h)+(S=t[4])*(Y=Ie*we*p+xe*u)+(z=t[8])*($=xe*we*p-Ie*u),i[1]=v*Z+T*Y+U*$,i[2]=b*Z+P*Y+W*$,i[3]=x*Z+R*Y+j*$,i[4]=g*K+S*ae+z*se,i[5]=v*K+T*ae+U*se,i[6]=b*K+P*ae+W*se,i[7]=x*K+R*ae+j*se,i[8]=g*de+S*ge+z*Te,i[9]=v*de+T*ge+U*Te,i[10]=b*de+P*ge+W*Te,i[11]=x*de+R*ge+j*Te,t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i)},Kn.rotateX=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[4],p=t[5],g=t[6],v=t[7],b=t[8],x=t[9],S=t[10],T=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=h*u+b*l,i[5]=p*u+x*l,i[6]=g*u+S*l,i[7]=v*u+T*l,i[8]=b*u-h*l,i[9]=x*u-p*l,i[10]=S*u-g*l,i[11]=T*u-v*l,i},Kn.rotateY=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],g=t[2],v=t[3],b=t[8],x=t[9],S=t[10],T=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=h*u-b*l,i[1]=p*u-x*l,i[2]=g*u-S*l,i[3]=v*u-T*l,i[8]=h*l+b*u,i[9]=p*l+x*u,i[10]=g*l+S*u,i[11]=v*l+T*u,i},Kn.rotateZ=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],g=t[2],v=t[3],b=t[4],x=t[5],S=t[6],T=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=h*u+b*l,i[1]=p*u+x*l,i[2]=g*u+S*l,i[3]=v*u+T*l,i[4]=b*u-h*l,i[5]=x*u-p*l,i[6]=S*u-g*l,i[7]=T*u-v*l,i},Kn.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i},Kn.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromRotation=function(i,t,r){var l,u,h,p=r[0],g=r[1],v=r[2],b=Math.hypot(p,g,v);return b<Hi.EPSILON?null:(p*=b=1/b,g*=b,v*=b,l=Math.sin(t),u=Math.cos(t),i[0]=p*p*(h=1-u)+u,i[1]=g*p*h+v*l,i[2]=v*p*h-g*l,i[3]=0,i[4]=p*g*h-v*l,i[5]=g*g*h+u,i[6]=v*g*h+p*l,i[7]=0,i[8]=p*v*h+g*l,i[9]=g*v*h-p*l,i[10]=v*v*h+u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)},Kn.fromXRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=l,i[6]=r,i[7]=0,i[8]=0,i[9]=-r,i[10]=l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromYRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=0,i[2]=-r,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=r,i[9]=0,i[10]=l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromZRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=0,i[3]=0,i[4]=-r,i[5]=l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromRotationTranslation=LO,Kn.fromQuat2=function(i,t){var r=new Hi.ARRAY_TYPE(3),l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=l*l+u*u+h*h+p*p;return S>0?(r[0]=2*(g*p+x*l+v*h-b*u)/S,r[1]=2*(v*p+x*u+b*l-g*h)/S,r[2]=2*(b*p+x*h+g*u-v*l)/S):(r[0]=2*(g*p+x*l+v*h-b*u),r[1]=2*(v*p+x*u+b*l-g*h),r[2]=2*(b*p+x*h+g*u-v*l)),LO(i,t,r),i},Kn.getTranslation=function(i,t){return i[0]=t[12],i[1]=t[13],i[2]=t[14],i},Kn.getScaling=RO,Kn.getRotation=function(i,t){var r=new Hi.ARRAY_TYPE(3);RO(r,t);var l=1/r[0],u=1/r[1],h=1/r[2],p=t[0]*l,g=t[1]*u,v=t[2]*h,b=t[4]*l,x=t[5]*u,S=t[6]*h,T=t[8]*l,P=t[9]*u,R=t[10]*h,z=p+x+R,U=0;return z>0?(U=2*Math.sqrt(z+1),i[3]=.25*U,i[0]=(S-P)/U,i[1]=(T-v)/U,i[2]=(g-b)/U):p>x&&p>R?(U=2*Math.sqrt(1+p-x-R),i[3]=(S-P)/U,i[0]=.25*U,i[1]=(g+b)/U,i[2]=(T+v)/U):x>R?(U=2*Math.sqrt(1+x-p-R),i[3]=(T-v)/U,i[0]=(g+b)/U,i[1]=.25*U,i[2]=(S+P)/U):(U=2*Math.sqrt(1+R-p-x),i[3]=(g-b)/U,i[0]=(T+v)/U,i[1]=(S+P)/U,i[2]=.25*U),i},Kn.fromRotationTranslationScale=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=t[3],v=u+u,b=h+h,x=p+p,S=u*v,T=u*b,P=u*x,R=h*b,z=h*x,U=p*x,W=g*v,j=g*b,Z=g*x,Y=l[0],$=l[1],K=l[2];return i[0]=(1-(R+U))*Y,i[1]=(T+Z)*Y,i[2]=(P-j)*Y,i[3]=0,i[4]=(T-Z)*$,i[5]=(1-(S+U))*$,i[6]=(z+W)*$,i[7]=0,i[8]=(P+j)*K,i[9]=(z-W)*K,i[10]=(1-(S+R))*K,i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i},Kn.fromRotationTranslationScaleOrigin=function(i,t,r,l,u){var h=t[0],p=t[1],g=t[2],v=t[3],b=h+h,x=p+p,S=g+g,T=h*b,P=h*x,R=h*S,z=p*x,U=p*S,W=g*S,j=v*b,Z=v*x,Y=v*S,$=l[0],K=l[1],ae=l[2],se=u[0],de=u[1],ge=u[2],Te=(1-(z+W))*$,we=(P+Y)*$,Ie=(R-Z)*$,xe=(P-Y)*K,We=(1-(T+W))*K,qe=(U+j)*K,Qe=(R+Z)*ae,Ne=(U-j)*ae,Ve=(1-(T+z))*ae;return i[0]=Te,i[1]=we,i[2]=Ie,i[3]=0,i[4]=xe,i[5]=We,i[6]=qe,i[7]=0,i[8]=Qe,i[9]=Ne,i[10]=Ve,i[11]=0,i[12]=r[0]+se-(Te*se+xe*de+Qe*ge),i[13]=r[1]+de-(we*se+We*de+Ne*ge),i[14]=r[2]+ge-(Ie*se+qe*de+Ve*ge),i[15]=1,i},Kn.fromQuat=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r+r,g=l+l,v=u+u,b=r*p,x=l*p,S=l*g,T=u*p,P=u*g,R=u*v,z=h*p,U=h*g,W=h*v;return i[0]=1-S-R,i[1]=x+W,i[2]=T-U,i[3]=0,i[4]=x-W,i[5]=1-b-R,i[6]=P+z,i[7]=0,i[8]=T+U,i[9]=P-z,i[10]=1-b-S,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.frustum=function(i,t,r,l,u,h,p){var g=1/(r-t),v=1/(u-l),b=1/(h-p);return i[0]=2*h*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*h*v,i[6]=0,i[7]=0,i[8]=(r+t)*g,i[9]=(u+l)*v,i[10]=(p+h)*b,i[11]=-1,i[12]=0,i[13]=0,i[14]=p*h*2*b,i[15]=0,i},Kn.perspectiveNO=kO,Kn.perspectiveZO=function(i,t,r,l,u){var h,p=1/Math.tan(t/2);return i[0]=p/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=u*(h=1/(l-u)),i[14]=u*l*h):(i[10]=-1,i[14]=-l),i},Kn.perspectiveFromFieldOfView=function(i,t,r,l){var u=Math.tan(t.upDegrees*Math.PI/180),h=Math.tan(t.downDegrees*Math.PI/180),p=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),v=2/(p+g),b=2/(u+h);return i[0]=v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=b,i[6]=0,i[7]=0,i[8]=-(p-g)*v*.5,i[9]=(u-h)*b*.5,i[10]=l/(r-l),i[11]=-1,i[12]=0,i[13]=0,i[14]=l*r/(r-l),i[15]=0,i},Kn.orthoNO=DO,Kn.orthoZO=function(i,t,r,l,u,h,p){var g=1/(t-r),v=1/(l-u),b=1/(h-p);return i[0]=-2*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=b,i[11]=0,i[12]=(t+r)*g,i[13]=(u+l)*v,i[14]=h*b,i[15]=1,i},Kn.lookAt=function(i,t,r,l){var u,h,p,g,v,b,x,S,T,P,R=t[0],z=t[1],U=t[2],W=l[0],j=l[1],Z=l[2],Y=r[0],$=r[1],K=r[2];return Math.abs(R-Y)<Hi.EPSILON&&Math.abs(z-$)<Hi.EPSILON&&Math.abs(U-K)<Hi.EPSILON?PO(i):(x=R-Y,S=z-$,T=U-K,u=j*(T*=P=1/Math.hypot(x,S,T))-Z*(S*=P),h=Z*(x*=P)-W*T,p=W*S-j*x,(P=Math.hypot(u,h,p))?(u*=P=1/P,h*=P,p*=P):(u=0,h=0,p=0),g=S*p-T*h,v=T*u-x*p,b=x*h-S*u,(P=Math.hypot(g,v,b))?(g*=P=1/P,v*=P,b*=P):(g=0,v=0,b=0),i[0]=u,i[1]=g,i[2]=x,i[3]=0,i[4]=h,i[5]=v,i[6]=S,i[7]=0,i[8]=p,i[9]=b,i[10]=T,i[11]=0,i[12]=-(u*R+h*z+p*U),i[13]=-(g*R+v*z+b*U),i[14]=-(x*R+S*z+T*U),i[15]=1,i)},Kn.targetTo=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=l[0],v=l[1],b=l[2],x=u-r[0],S=h-r[1],T=p-r[2],P=x*x+S*S+T*T;P>0&&(x*=P=1/Math.sqrt(P),S*=P,T*=P);var R=v*T-b*S,z=b*x-g*T,U=g*S-v*x;return(P=R*R+z*z+U*U)>0&&(R*=P=1/Math.sqrt(P),z*=P,U*=P),i[0]=R,i[1]=z,i[2]=U,i[3]=0,i[4]=S*U-T*z,i[5]=T*R-x*U,i[6]=x*z-S*R,i[7]=0,i[8]=x,i[9]=S,i[10]=T,i[11]=0,i[12]=u,i[13]=h,i[14]=p,i[15]=1,i},Kn.str=function(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"},Kn.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])},Kn.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i[8]=t[8]+r[8],i[9]=t[9]+r[9],i[10]=t[10]+r[10],i[11]=t[11]+r[11],i[12]=t[12]+r[12],i[13]=t[13]+r[13],i[14]=t[14]+r[14],i[15]=t[15]+r[15],i},Kn.subtract=OO,Kn.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*r,i[9]=t[9]*r,i[10]=t[10]*r,i[11]=t[11]*r,i[12]=t[12]*r,i[13]=t[13]*r,i[14]=t[14]*r,i[15]=t[15]*r,i},Kn.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i[6]=t[6]+r[6]*l,i[7]=t[7]+r[7]*l,i[8]=t[8]+r[8]*l,i[9]=t[9]+r[9]*l,i[10]=t[10]+r[10]*l,i[11]=t[11]+r[11]*l,i[12]=t[12]+r[12]*l,i[13]=t[13]+r[13]*l,i[14]=t[14]+r[14]*l,i[15]=t[15]+r[15]*l,i},Kn.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},Kn.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],x=i[8],S=i[9],T=i[10],P=i[11],R=i[12],z=i[13],U=i[14],W=i[15],j=t[0],Z=t[1],Y=t[2],$=t[3],K=t[4],ae=t[5],se=t[6],de=t[7],ge=t[8],Te=t[9],we=t[10],Ie=t[11],xe=t[12],We=t[13],qe=t[14],Qe=t[15];return Math.abs(r-j)<=Hi.EPSILON*Math.max(1,Math.abs(r),Math.abs(j))&&Math.abs(l-Z)<=Hi.EPSILON*Math.max(1,Math.abs(l),Math.abs(Z))&&Math.abs(u-Y)<=Hi.EPSILON*Math.max(1,Math.abs(u),Math.abs(Y))&&Math.abs(h-$)<=Hi.EPSILON*Math.max(1,Math.abs(h),Math.abs($))&&Math.abs(p-K)<=Hi.EPSILON*Math.max(1,Math.abs(p),Math.abs(K))&&Math.abs(g-ae)<=Hi.EPSILON*Math.max(1,Math.abs(g),Math.abs(ae))&&Math.abs(v-se)<=Hi.EPSILON*Math.max(1,Math.abs(v),Math.abs(se))&&Math.abs(b-de)<=Hi.EPSILON*Math.max(1,Math.abs(b),Math.abs(de))&&Math.abs(x-ge)<=Hi.EPSILON*Math.max(1,Math.abs(x),Math.abs(ge))&&Math.abs(S-Te)<=Hi.EPSILON*Math.max(1,Math.abs(S),Math.abs(Te))&&Math.abs(T-we)<=Hi.EPSILON*Math.max(1,Math.abs(T),Math.abs(we))&&Math.abs(P-Ie)<=Hi.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ie))&&Math.abs(R-xe)<=Hi.EPSILON*Math.max(1,Math.abs(R),Math.abs(xe))&&Math.abs(z-We)<=Hi.EPSILON*Math.max(1,Math.abs(z),Math.abs(We))&&Math.abs(U-qe)<=Hi.EPSILON*Math.max(1,Math.abs(U),Math.abs(qe))&&Math.abs(W-Qe)<=Hi.EPSILON*Math.max(1,Math.abs(W),Math.abs(Qe))},Kn.sub=Kn.mul=Kn.ortho=Kn.perspective=void 0;var Hi=function(i,t){if(i&&i.__esModule)return i;if(i===null||xC(i)!=="object"&&typeof i!="function")return{default:i};var r=CO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function CO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(CO=function(l){return l?r:t})(i)}function PO(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function IO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=t[8],T=t[9],P=t[10],R=t[11],z=t[12],U=t[13],W=t[14],j=t[15],Z=r[0],Y=r[1],$=r[2],K=r[3];return i[0]=Z*l+Y*g+$*S+K*z,i[1]=Z*u+Y*v+$*T+K*U,i[2]=Z*h+Y*b+$*P+K*W,i[3]=Z*p+Y*x+$*R+K*j,i[4]=(Z=r[4])*l+(Y=r[5])*g+($=r[6])*S+(K=r[7])*z,i[5]=Z*u+Y*v+$*T+K*U,i[6]=Z*h+Y*b+$*P+K*W,i[7]=Z*p+Y*x+$*R+K*j,i[8]=(Z=r[8])*l+(Y=r[9])*g+($=r[10])*S+(K=r[11])*z,i[9]=Z*u+Y*v+$*T+K*U,i[10]=Z*h+Y*b+$*P+K*W,i[11]=Z*p+Y*x+$*R+K*j,i[12]=(Z=r[12])*l+(Y=r[13])*g+($=r[14])*S+(K=r[15])*z,i[13]=Z*u+Y*v+$*T+K*U,i[14]=Z*h+Y*b+$*P+K*W,i[15]=Z*p+Y*x+$*R+K*j,i}function LO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=l+l,v=u+u,b=h+h,x=l*g,S=l*v,T=l*b,P=u*v,R=u*b,z=h*b,U=p*g,W=p*v,j=p*b;return i[0]=1-(P+z),i[1]=S+j,i[2]=T-W,i[3]=0,i[4]=S-j,i[5]=1-(x+z),i[6]=R+U,i[7]=0,i[8]=T+W,i[9]=R-U,i[10]=1-(x+P),i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i}function RO(i,t){var r=t[4],l=t[5],u=t[6],h=t[8],p=t[9],g=t[10];return i[0]=Math.hypot(t[0],t[1],t[2]),i[1]=Math.hypot(r,l,u),i[2]=Math.hypot(h,p,g),i}function kO(i,t,r,l,u){var h,p=1/Math.tan(t/2);return i[0]=p/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=(u+l)*(h=1/(l-u)),i[14]=2*u*l*h):(i[10]=-1,i[14]=-2*l),i}function DO(i,t,r,l,u,h,p){var g=1/(t-r),v=1/(l-u),b=1/(h-p);return i[0]=-2*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*b,i[11]=0,i[12]=(t+r)*g,i[13]=(u+l)*v,i[14]=(p+h)*b,i[15]=1,i}function OO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i[6]=t[6]-r[6],i[7]=t[7]-r[7],i[8]=t[8]-r[8],i[9]=t[9]-r[9],i[10]=t[10]-r[10],i[11]=t[11]-r[11],i[12]=t[12]-r[12],i[13]=t[13]-r[13],i[14]=t[14]-r[14],i[15]=t[15]-r[15],i}Kn.perspective=kO,Kn.ortho=DO,Kn.mul=IO,Kn.sub=OO;var Gn={},Zn={};function wC(i){return wC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wC(i)}Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.create=FO,Zn.clone=function(i){var t=new $d.ARRAY_TYPE(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},Zn.length=NO,Zn.fromValues=function(i,t,r){var l=new $d.ARRAY_TYPE(3);return l[0]=i,l[1]=t,l[2]=r,l},Zn.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},Zn.set=function(i,t,r,l){return i[0]=t,i[1]=r,i[2]=l,i},Zn.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i},Zn.subtract=BO,Zn.multiply=UO,Zn.divide=WO,Zn.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i[2]=Math.ceil(t[2]),i},Zn.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i[2]=Math.floor(t[2]),i},Zn.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i[2]=Math.min(t[2],r[2]),i},Zn.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i[2]=Math.max(t[2],r[2]),i},Zn.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i[2]=Math.round(t[2]),i},Zn.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i},Zn.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i},Zn.distance=VO,Zn.squaredDistance=GO,Zn.squaredLength=HO,Zn.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i},Zn.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i[2]=1/t[2],i},Zn.normalize=function(i,t){var r=t[0],l=t[1],u=t[2],h=r*r+l*l+u*u;return h>0&&(h=1/Math.sqrt(h)),i[0]=t[0]*h,i[1]=t[1]*h,i[2]=t[2]*h,i},Zn.dot=jO,Zn.cross=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[0],g=r[1],v=r[2];return i[0]=u*v-h*g,i[1]=h*p-l*v,i[2]=l*g-u*p,i},Zn.lerp=function(i,t,r,l){var u=t[0],h=t[1],p=t[2];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i[2]=p+l*(r[2]-p),i},Zn.hermite=function(i,t,r,l,u,h){var p=h*h,g=p*(2*h-3)+1,v=p*(h-2)+h,b=p*(h-1),x=p*(3-2*h);return i[0]=t[0]*g+r[0]*v+l[0]*b+u[0]*x,i[1]=t[1]*g+r[1]*v+l[1]*b+u[1]*x,i[2]=t[2]*g+r[2]*v+l[2]*b+u[2]*x,i},Zn.bezier=function(i,t,r,l,u,h){var p=1-h,g=p*p,v=h*h,b=g*p,x=3*h*g,S=3*v*p,T=v*h;return i[0]=t[0]*b+r[0]*x+l[0]*S+u[0]*T,i[1]=t[1]*b+r[1]*x+l[1]*S+u[1]*T,i[2]=t[2]*b+r[2]*x+l[2]*S+u[2]*T,i},Zn.random=function(i,t){t=t||1;var r=2*$d.RANDOM()*Math.PI,l=2*$d.RANDOM()-1,u=Math.sqrt(1-l*l)*t;return i[0]=Math.cos(r)*u,i[1]=Math.sin(r)*u,i[2]=l*t,i},Zn.transformMat4=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[3]*l+r[7]*u+r[11]*h+r[15];return i[0]=(r[0]*l+r[4]*u+r[8]*h+r[12])/(p=p||1),i[1]=(r[1]*l+r[5]*u+r[9]*h+r[13])/p,i[2]=(r[2]*l+r[6]*u+r[10]*h+r[14])/p,i},Zn.transformMat3=function(i,t,r){var l=t[0],u=t[1],h=t[2];return i[0]=l*r[0]+u*r[3]+h*r[6],i[1]=l*r[1]+u*r[4]+h*r[7],i[2]=l*r[2]+u*r[5]+h*r[8],i},Zn.transformQuat=function(i,t,r){var l=r[0],u=r[1],h=r[2],p=t[0],g=t[1],v=t[2],b=u*v-h*g,x=h*p-l*v,S=l*g-u*p,T=u*S-h*x,P=h*b-l*S,R=l*x-u*b,z=2*r[3];return x*=z,S*=z,P*=2,R*=2,i[0]=p+(b*=z)+(T*=2),i[1]=g+x+P,i[2]=v+S+R,i},Zn.rotateX=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0],h[1]=u[1]*Math.cos(l)-u[2]*Math.sin(l),h[2]=u[1]*Math.sin(l)+u[2]*Math.cos(l),i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Zn.rotateY=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[2]*Math.sin(l)+u[0]*Math.cos(l),h[1]=u[1],h[2]=u[2]*Math.cos(l)-u[0]*Math.sin(l),i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Zn.rotateZ=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0]*Math.cos(l)-u[1]*Math.sin(l),h[1]=u[0]*Math.sin(l)+u[1]*Math.cos(l),h[2]=u[2],i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Zn.angle=function(i,t){var r=i[0],l=i[1],u=i[2],h=t[0],p=t[1],g=t[2],v=Math.sqrt(r*r+l*l+u*u)*Math.sqrt(h*h+p*p+g*g),b=v&&jO(i,t)/v;return Math.acos(Math.min(Math.max(b,-1),1))},Zn.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i},Zn.str=function(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"},Zn.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]},Zn.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=t[0],p=t[1],g=t[2];return Math.abs(r-h)<=$d.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(l-p)<=$d.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(u-g)<=$d.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},Zn.forEach=Zn.sqrLen=Zn.len=Zn.sqrDist=Zn.dist=Zn.div=Zn.mul=Zn.sub=void 0;var $d=function(i,t){if(i&&i.__esModule)return i;if(i===null||wC(i)!=="object"&&typeof i!="function")return{default:i};var r=zO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function zO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(zO=function(l){return l?r:t})(i)}function FO(){var i=new $d.ARRAY_TYPE(3);return $d.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function NO(i){return Math.hypot(i[0],i[1],i[2])}function BO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i}function UO(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i}function WO(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i[2]=t[2]/r[2],i}function VO(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1],t[2]-i[2])}function GO(i,t){var r=t[0]-i[0],l=t[1]-i[1],u=t[2]-i[2];return r*r+l*l+u*u}function HO(i){var t=i[0],r=i[1],l=i[2];return t*t+r*r+l*l}function jO(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}Zn.sub=BO,Zn.mul=UO,Zn.div=WO,Zn.dist=VO,Zn.sqrDist=GO,Zn.len=NO,Zn.sqrLen=HO;var qd,pQ=(qd=FO(),function(i,t,r,l,u,h){var p,g;for(t||(t=3),r||(r=0),g=l?Math.min(l*t+r,i.length):i.length,p=r;p<g;p+=t)qd[0]=i[p],qd[1]=i[p+1],qd[2]=i[p+2],u(qd,qd,h),i[p]=qd[0],i[p+1]=qd[1],i[p+2]=qd[2];return i});Zn.forEach=pQ;var ua={};function SC(i){return SC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},SC(i)}Object.defineProperty(ua,"__esModule",{value:!0}),ua.create=qO,ua.clone=function(i){var t=new lc.ARRAY_TYPE(4);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t},ua.fromValues=function(i,t,r,l){var u=new lc.ARRAY_TYPE(4);return u[0]=i,u[1]=t,u[2]=r,u[3]=l,u},ua.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},ua.set=function(i,t,r,l,u){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i},ua.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i},ua.subtract=XO,ua.multiply=ZO,ua.divide=YO,ua.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i[2]=Math.ceil(t[2]),i[3]=Math.ceil(t[3]),i},ua.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i[2]=Math.floor(t[2]),i[3]=Math.floor(t[3]),i},ua.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i[2]=Math.min(t[2],r[2]),i[3]=Math.min(t[3],r[3]),i},ua.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i[2]=Math.max(t[2],r[2]),i[3]=Math.max(t[3],r[3]),i},ua.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i[2]=Math.round(t[2]),i[3]=Math.round(t[3]),i},ua.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},ua.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i},ua.distance=KO,ua.squaredDistance=JO,ua.length=QO,ua.squaredLength=ez,ua.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=-t[3],i},ua.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i[2]=1/t[2],i[3]=1/t[3],i},ua.normalize=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*r+l*l+u*u+h*h;return p>0&&(p=1/Math.sqrt(p)),i[0]=r*p,i[1]=l*p,i[2]=u*p,i[3]=h*p,i},ua.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},ua.cross=function(i,t,r,l){var u=r[0]*l[1]-r[1]*l[0],h=r[0]*l[2]-r[2]*l[0],p=r[0]*l[3]-r[3]*l[0],g=r[1]*l[2]-r[2]*l[1],v=r[1]*l[3]-r[3]*l[1],b=r[2]*l[3]-r[3]*l[2],x=t[0],S=t[1],T=t[2],P=t[3];return i[0]=S*b-T*v+P*g,i[1]=-x*b+T*p-P*h,i[2]=x*v-S*p+P*u,i[3]=-x*g+S*h-T*u,i},ua.lerp=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=t[3];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i[2]=p+l*(r[2]-p),i[3]=g+l*(r[3]-g),i},ua.random=function(i,t){var r,l,u,h,p,g;t=t||1;do p=(r=2*lc.RANDOM()-1)*r+(l=2*lc.RANDOM()-1)*l;while(p>=1);do g=(u=2*lc.RANDOM()-1)*u+(h=2*lc.RANDOM()-1)*h;while(g>=1);var v=Math.sqrt((1-p)/g);return i[0]=t*r,i[1]=t*l,i[2]=t*u*v,i[3]=t*h*v,i},ua.transformMat4=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3];return i[0]=r[0]*l+r[4]*u+r[8]*h+r[12]*p,i[1]=r[1]*l+r[5]*u+r[9]*h+r[13]*p,i[2]=r[2]*l+r[6]*u+r[10]*h+r[14]*p,i[3]=r[3]*l+r[7]*u+r[11]*h+r[15]*p,i},ua.transformQuat=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[0],g=r[1],v=r[2],b=r[3],x=b*l+g*h-v*u,S=b*u+v*l-p*h,T=b*h+p*u-g*l,P=-p*l-g*u-v*h;return i[0]=x*b+P*-p+S*-v-T*-g,i[1]=S*b+P*-g+T*-p-x*-v,i[2]=T*b+P*-v+x*-g-S*-p,i[3]=t[3],i},ua.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i},ua.str=function(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},ua.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]},ua.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-p)<=lc.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(l-g)<=lc.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=lc.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=lc.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},ua.forEach=ua.sqrLen=ua.len=ua.sqrDist=ua.dist=ua.div=ua.mul=ua.sub=void 0;var lc=function(i,t){if(i&&i.__esModule)return i;if(i===null||SC(i)!=="object"&&typeof i!="function")return{default:i};var r=$O(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function $O(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return($O=function(l){return l?r:t})(i)}function qO(){var i=new lc.ARRAY_TYPE(4);return lc.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function XO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i}function ZO(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i[3]=t[3]*r[3],i}function YO(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i[2]=t[2]/r[2],i[3]=t[3]/r[3],i}function KO(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1],t[2]-i[2],t[3]-i[3])}function JO(i,t){var r=t[0]-i[0],l=t[1]-i[1],u=t[2]-i[2],h=t[3]-i[3];return r*r+l*l+u*u+h*h}function QO(i){return Math.hypot(i[0],i[1],i[2],i[3])}function ez(i){var t=i[0],r=i[1],l=i[2],u=i[3];return t*t+r*r+l*l+u*u}ua.sub=XO,ua.mul=ZO,ua.div=YO,ua.dist=KO,ua.sqrDist=JO,ua.len=QO,ua.sqrLen=ez;var mQ=function(){var i=qO();return function(t,r,l,u,h,p){var g,v;for(r||(r=4),l||(l=0),v=u?Math.min(u*r+l,t.length):t.length,g=l;g<v;g+=r)i[0]=t[g],i[1]=t[g+1],i[2]=t[g+2],i[3]=t[g+3],h(i,i,p),t[g]=i[0],t[g+1]=i[1],t[g+2]=i[2],t[g+3]=i[3];return t}}();function AC(i){return AC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},AC(i)}ua.forEach=mQ,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.create=EC,Gn.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i},Gn.setAxisAngle=nz,Gn.getAxisAngle=function(i,t){var r=2*Math.acos(t[3]),l=Math.sin(r/2);return l>mm.EPSILON?(i[0]=t[0]/l,i[1]=t[1]/l,i[2]=t[2]/l):(i[0]=1,i[1]=0,i[2]=0),r},Gn.getAngle=function(i,t){var r=lz(i,t);return Math.acos(2*r*r-1)},Gn.multiply=az,Gn.rotateX=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+p*g,i[1]=u*v+h*g,i[2]=h*v-u*g,i[3]=p*v-l*g,i},Gn.rotateY=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v-h*g,i[1]=u*v+p*g,i[2]=h*v+l*g,i[3]=p*v-u*g,i},Gn.rotateZ=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+u*g,i[1]=u*v-l*g,i[2]=h*v+p*g,i[3]=p*v-h*g,i},Gn.calculateW=function(i,t){var r=t[0],l=t[1],u=t[2];return i[0]=r,i[1]=l,i[2]=u,i[3]=Math.sqrt(Math.abs(1-r*r-l*l-u*u)),i},Gn.exp=iz,Gn.ln=rz,Gn.pow=function(i,t,r){return rz(i,t),sz(i,i,r),iz(i,i),i},Gn.slerp=f2,Gn.random=function(i){var t=mm.RANDOM(),r=mm.RANDOM(),l=mm.RANDOM(),u=Math.sqrt(1-t),h=Math.sqrt(t);return i[0]=u*Math.sin(2*Math.PI*r),i[1]=u*Math.cos(2*Math.PI*r),i[2]=h*Math.sin(2*Math.PI*l),i[3]=h*Math.cos(2*Math.PI*l),i},Gn.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*r+l*l+u*u+h*h,g=p?1/p:0;return i[0]=-r*g,i[1]=-l*g,i[2]=-u*g,i[3]=h*g,i},Gn.conjugate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=t[3],i},Gn.fromMat3=oz,Gn.fromEuler=function(i,t,r,l){var u=.5*Math.PI/180;t*=u,r*=u,l*=u;var h=Math.sin(t),p=Math.cos(t),g=Math.sin(r),v=Math.cos(r),b=Math.sin(l),x=Math.cos(l);return i[0]=h*v*x-p*g*b,i[1]=p*g*x+h*v*b,i[2]=p*v*b-h*g*x,i[3]=p*v*x+h*g*b,i},Gn.str=function(i){return"quat("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Gn.setAxes=Gn.sqlerp=Gn.rotationTo=Gn.equals=Gn.exactEquals=Gn.normalize=Gn.sqrLen=Gn.squaredLength=Gn.len=Gn.length=Gn.lerp=Gn.dot=Gn.scale=Gn.mul=Gn.add=Gn.set=Gn.copy=Gn.fromValues=Gn.clone=void 0;var mm=h2(eo),gQ=h2($a),Xd=h2(Zn),Rl=h2(ua);function tz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(tz=function(l){return l?r:t})(i)}function h2(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||AC(i)!=="object"&&typeof i!="function")return{default:i};var r=tz(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}function EC(){var i=new mm.ARRAY_TYPE(4);return mm.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function nz(i,t,r){r*=.5;var l=Math.sin(r);return i[0]=l*t[0],i[1]=l*t[1],i[2]=l*t[2],i[3]=Math.cos(r),i}function az(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],x=r[3];return i[0]=l*x+p*g+u*b-h*v,i[1]=u*x+p*v+h*g-l*b,i[2]=h*x+p*b+l*v-u*g,i[3]=p*x-l*g-u*v-h*b,i}function iz(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=Math.sqrt(r*r+l*l+u*u),g=Math.exp(h),v=p>0?g*Math.sin(p)/p:0;return i[0]=r*v,i[1]=l*v,i[2]=u*v,i[3]=g*Math.cos(p),i}function rz(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=Math.sqrt(r*r+l*l+u*u),g=p>0?Math.atan2(p,h)/p:0;return i[0]=r*g,i[1]=l*g,i[2]=u*g,i[3]=.5*Math.log(r*r+l*l+u*u+h*h),i}function f2(i,t,r,l){var u,h,p,g,v,b=t[0],x=t[1],S=t[2],T=t[3],P=r[0],R=r[1],z=r[2],U=r[3];return(h=b*P+x*R+S*z+T*U)<0&&(h=-h,P=-P,R=-R,z=-z,U=-U),1-h>mm.EPSILON?(u=Math.acos(h),p=Math.sin(u),g=Math.sin((1-l)*u)/p,v=Math.sin(l*u)/p):(g=1-l,v=l),i[0]=g*b+v*P,i[1]=g*x+v*R,i[2]=g*S+v*z,i[3]=g*T+v*U,i}function oz(i,t){var r,l=t[0]+t[4]+t[8];if(l>0)r=Math.sqrt(l+1),i[3]=.5*r,i[0]=(t[5]-t[7])*(r=.5/r),i[1]=(t[6]-t[2])*r,i[2]=(t[1]-t[3])*r;else{var u=0;t[4]>t[0]&&(u=1),t[8]>t[3*u+u]&&(u=2);var h=(u+1)%3,p=(u+2)%3;r=Math.sqrt(t[3*u+u]-t[3*h+h]-t[3*p+p]+1),i[u]=.5*r,i[3]=(t[3*h+p]-t[3*p+h])*(r=.5/r),i[h]=(t[3*h+u]+t[3*u+h])*r,i[p]=(t[3*p+u]+t[3*u+p])*r}return i}Gn.clone=Rl.clone,Gn.fromValues=Rl.fromValues,Gn.copy=Rl.copy,Gn.set=Rl.set,Gn.add=Rl.add,Gn.mul=az;var sz=Rl.scale;Gn.scale=sz;var lz=Rl.dot;Gn.dot=lz,Gn.lerp=Rl.lerp;var cz=Rl.length;Gn.length=cz,Gn.len=cz;var uz=Rl.squaredLength;Gn.squaredLength=uz,Gn.sqrLen=uz;var MC=Rl.normalize;Gn.normalize=MC,Gn.exactEquals=Rl.exactEquals,Gn.equals=Rl.equals;var Uc,dz,hz,yQ=(Uc=Xd.create(),dz=Xd.fromValues(1,0,0),hz=Xd.fromValues(0,1,0),function(i,t,r){var l=Xd.dot(t,r);return l<-.999999?(Xd.cross(Uc,dz,t),Xd.len(Uc)<1e-6&&Xd.cross(Uc,hz,t),Xd.normalize(Uc,Uc),nz(i,Uc,Math.PI),i):l>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Xd.cross(Uc,t,r),i[0]=Uc[0],i[1]=Uc[1],i[2]=Uc[2],i[3]=1+l,MC(i,i))});Gn.rotationTo=yQ;var TC,CC,vQ=(TC=EC(),CC=EC(),function(i,t,r,l,u,h){return f2(TC,t,u,h),f2(CC,r,l,h),f2(i,TC,CC,2*h*(1-h)),i});Gn.sqlerp=vQ;var Wc,_Q=(Wc=gQ.create(),function(i,t,r,l){return Wc[0]=r[0],Wc[3]=r[1],Wc[6]=r[2],Wc[1]=l[0],Wc[4]=l[1],Wc[7]=l[2],Wc[2]=-t[0],Wc[5]=-t[1],Wc[8]=-t[2],MC(i,oz(i,Wc))});Gn.setAxes=_Q;var ya={};function PC(i){return PC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PC(i)}Object.defineProperty(ya,"__esModule",{value:!0}),ya.create=function(){var i=new Ls.ARRAY_TYPE(8);return Ls.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[4]=0,i[5]=0,i[6]=0,i[7]=0),i[3]=1,i},ya.clone=function(i){var t=new Ls.ARRAY_TYPE(8);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t},ya.fromValues=function(i,t,r,l,u,h,p,g){var v=new Ls.ARRAY_TYPE(8);return v[0]=i,v[1]=t,v[2]=r,v[3]=l,v[4]=u,v[5]=h,v[6]=p,v[7]=g,v},ya.fromRotationTranslationValues=function(i,t,r,l,u,h,p){var g=new Ls.ARRAY_TYPE(8);g[0]=i,g[1]=t,g[2]=r,g[3]=l;var v=.5*u,b=.5*h,x=.5*p;return g[4]=v*l+b*r-x*t,g[5]=b*l+x*i-v*r,g[6]=x*l+v*t-b*i,g[7]=-v*i-b*t-x*r,g},ya.fromRotationTranslation=mz,ya.fromTranslation=function(i,t){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=.5*t[0],i[5]=.5*t[1],i[6]=.5*t[2],i[7]=0,i},ya.fromRotation=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},ya.fromMat4=function(i,t){var r=Zd.create();fz.getRotation(r,t);var l=new Ls.ARRAY_TYPE(3);return fz.getTranslation(l,t),mz(i,r,l),i},ya.copy=gz,ya.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},ya.set=function(i,t,r,l,u,h,p,g,v){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i},ya.getDual=function(i,t){return i[0]=t[4],i[1]=t[5],i[2]=t[6],i[3]=t[7],i},ya.setDual=function(i,t){return i[4]=t[0],i[5]=t[1],i[6]=t[2],i[7]=t[3],i},ya.getTranslation=function(i,t){var r=t[4],l=t[5],u=t[6],h=t[7],p=-t[0],g=-t[1],v=-t[2],b=t[3];return i[0]=2*(r*b+h*p+l*v-u*g),i[1]=2*(l*b+h*g+u*p-r*v),i[2]=2*(u*b+h*v+r*g-l*p),i},ya.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=.5*r[0],v=.5*r[1],b=.5*r[2],x=t[4],S=t[5],T=t[6],P=t[7];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=p*g+u*b-h*v+x,i[5]=p*v+h*g-l*b+S,i[6]=p*b+l*v-u*g+T,i[7]=-l*g-u*v-h*b+P,i},ya.rotateX=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=g*p+x*l+v*h-b*u,T=v*p+x*u+b*l-g*h,P=b*p+x*h+g*u-v*l,R=x*p-g*l-v*u-b*h;return Zd.rotateX(i,t,r),i[4]=S*(p=i[3])+R*(l=i[0])+T*(h=i[2])-P*(u=i[1]),i[5]=T*p+R*u+P*l-S*h,i[6]=P*p+R*h+S*u-T*l,i[7]=R*p-S*l-T*u-P*h,i},ya.rotateY=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=g*p+x*l+v*h-b*u,T=v*p+x*u+b*l-g*h,P=b*p+x*h+g*u-v*l,R=x*p-g*l-v*u-b*h;return Zd.rotateY(i,t,r),i[4]=S*(p=i[3])+R*(l=i[0])+T*(h=i[2])-P*(u=i[1]),i[5]=T*p+R*u+P*l-S*h,i[6]=P*p+R*h+S*u-T*l,i[7]=R*p-S*l-T*u-P*h,i},ya.rotateZ=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],x=t[7],S=g*p+x*l+v*h-b*u,T=v*p+x*u+b*l-g*h,P=b*p+x*h+g*u-v*l,R=x*p-g*l-v*u-b*h;return Zd.rotateZ(i,t,r),i[4]=S*(p=i[3])+R*(l=i[0])+T*(h=i[2])-P*(u=i[1]),i[5]=T*p+R*u+P*l-S*h,i[6]=P*p+R*h+S*u-T*l,i[7]=R*p-S*l-T*u-P*h,i},ya.rotateByQuatAppend=function(i,t,r){var l=r[0],u=r[1],h=r[2],p=r[3],g=t[0],v=t[1],b=t[2],x=t[3];return i[0]=g*p+x*l+v*h-b*u,i[1]=v*p+x*u+b*l-g*h,i[2]=b*p+x*h+g*u-v*l,i[3]=x*p-g*l-v*u-b*h,i[4]=(g=t[4])*p+(x=t[7])*l+(v=t[5])*h-(b=t[6])*u,i[5]=v*p+x*u+b*l-g*h,i[6]=b*p+x*h+g*u-v*l,i[7]=x*p-g*l-v*u-b*h,i},ya.rotateByQuatPrepend=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],x=r[3];return i[0]=l*x+p*g+u*b-h*v,i[1]=u*x+p*v+h*g-l*b,i[2]=h*x+p*b+l*v-u*g,i[3]=p*x-l*g-u*v-h*b,i[4]=l*(x=r[7])+p*(g=r[4])+u*(b=r[6])-h*(v=r[5]),i[5]=u*x+p*v+h*g-l*b,i[6]=h*x+p*b+l*v-u*g,i[7]=p*x-l*g-u*v-h*b,i},ya.rotateAroundAxis=function(i,t,r,l){if(Math.abs(l)<Ls.EPSILON)return gz(i,t);var u=Math.hypot(r[0],r[1],r[2]);l*=.5;var h=Math.sin(l),p=h*r[0]/u,g=h*r[1]/u,v=h*r[2]/u,b=Math.cos(l),x=t[0],S=t[1],T=t[2],P=t[3];i[0]=x*b+P*p+S*v-T*g,i[1]=S*b+P*g+T*p-x*v,i[2]=T*b+P*v+x*g-S*p,i[3]=P*b-x*p-S*g-T*v;var R=t[4],z=t[5],U=t[6],W=t[7];return i[4]=R*b+W*p+z*v-U*g,i[5]=z*b+W*g+U*p-R*v,i[6]=U*b+W*v+R*g-z*p,i[7]=W*b-R*p-z*g-U*v,i},ya.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i},ya.multiply=yz,ya.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i},ya.lerp=function(i,t,r,l){var u=1-l;return vz(t,r)<0&&(l=-l),i[0]=t[0]*u+r[0]*l,i[1]=t[1]*u+r[1]*l,i[2]=t[2]*u+r[2]*l,i[3]=t[3]*u+r[3]*l,i[4]=t[4]*u+r[4]*l,i[5]=t[5]*u+r[5]*l,i[6]=t[6]*u+r[6]*l,i[7]=t[7]*u+r[7]*l,i},ya.invert=function(i,t){var r=p2(t);return i[0]=-t[0]/r,i[1]=-t[1]/r,i[2]=-t[2]/r,i[3]=t[3]/r,i[4]=-t[4]/r,i[5]=-t[5]/r,i[6]=-t[6]/r,i[7]=t[7]/r,i},ya.conjugate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=t[3],i[4]=-t[4],i[5]=-t[5],i[6]=-t[6],i[7]=t[7],i},ya.normalize=function(i,t){var r=p2(t);if(r>0){r=Math.sqrt(r);var l=t[0]/r,u=t[1]/r,h=t[2]/r,p=t[3]/r,g=t[4],v=t[5],b=t[6],x=t[7],S=l*g+u*v+h*b+p*x;i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=(g-l*S)/r,i[5]=(v-u*S)/r,i[6]=(b-h*S)/r,i[7]=(x-p*S)/r}return i},ya.str=function(i){return"quat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+")"},ya.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]},ya.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],x=t[0],S=t[1],T=t[2],P=t[3],R=t[4],z=t[5],U=t[6],W=t[7];return Math.abs(r-x)<=Ls.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(l-S)<=Ls.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-T)<=Ls.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(h-P)<=Ls.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(p-R)<=Ls.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(g-z)<=Ls.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(v-U)<=Ls.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(b-W)<=Ls.EPSILON*Math.max(1,Math.abs(b),Math.abs(W))},ya.sqrLen=ya.squaredLength=ya.len=ya.length=ya.dot=ya.mul=ya.setReal=ya.getReal=void 0;var Ls=IC(eo),Zd=IC(Gn),fz=IC(Kn);function pz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(pz=function(l){return l?r:t})(i)}function IC(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||PC(i)!=="object"&&typeof i!="function")return{default:i};var r=pz(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}function mz(i,t,r){var l=.5*r[0],u=.5*r[1],h=.5*r[2],p=t[0],g=t[1],v=t[2],b=t[3];return i[0]=p,i[1]=g,i[2]=v,i[3]=b,i[4]=l*b+u*v-h*g,i[5]=u*b+h*p-l*v,i[6]=h*b+l*g-u*p,i[7]=-l*p-u*g-h*v,i}function gz(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i}function yz(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[4],v=r[5],b=r[6],x=r[7],S=t[4],T=t[5],P=t[6],R=t[7],z=r[0],U=r[1],W=r[2],j=r[3];return i[0]=l*j+p*z+u*W-h*U,i[1]=u*j+p*U+h*z-l*W,i[2]=h*j+p*W+l*U-u*z,i[3]=p*j-l*z-u*U-h*W,i[4]=l*x+p*g+u*b-h*v+S*j+R*z+T*W-P*U,i[5]=u*x+p*v+h*g-l*b+T*j+R*U+P*z-S*W,i[6]=h*x+p*b+l*v-u*g+P*j+R*W+S*U-T*z,i[7]=p*x-l*g-u*v-h*b+R*j-S*z-T*U-P*W,i}ya.getReal=Zd.copy,ya.setReal=Zd.copy,ya.mul=yz;var vz=Zd.dot;ya.dot=vz;var _z=Zd.length;ya.length=_z,ya.len=_z;var p2=Zd.squaredLength;ya.squaredLength=p2,ya.sqrLen=p2;var aa={};function LC(i){return LC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LC(i)}Object.defineProperty(aa,"__esModule",{value:!0}),aa.create=xz,aa.clone=function(i){var t=new gm.ARRAY_TYPE(2);return t[0]=i[0],t[1]=i[1],t},aa.fromValues=function(i,t){var r=new gm.ARRAY_TYPE(2);return r[0]=i,r[1]=t,r},aa.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i},aa.set=function(i,t,r){return i[0]=t,i[1]=r,i},aa.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i},aa.subtract=wz,aa.multiply=Sz,aa.divide=Az,aa.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i},aa.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i},aa.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i},aa.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i},aa.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i},aa.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i},aa.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i},aa.distance=Ez,aa.squaredDistance=Mz,aa.length=Tz,aa.squaredLength=Cz,aa.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i},aa.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i},aa.normalize=function(i,t){var r=t[0],l=t[1],u=r*r+l*l;return u>0&&(u=1/Math.sqrt(u)),i[0]=t[0]*u,i[1]=t[1]*u,i},aa.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]},aa.cross=function(i,t,r){var l=t[0]*r[1]-t[1]*r[0];return i[0]=i[1]=0,i[2]=l,i},aa.lerp=function(i,t,r,l){var u=t[0],h=t[1];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i},aa.random=function(i,t){t=t||1;var r=2*gm.RANDOM()*Math.PI;return i[0]=Math.cos(r)*t,i[1]=Math.sin(r)*t,i},aa.transformMat2=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[2]*u,i[1]=r[1]*l+r[3]*u,i},aa.transformMat2d=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[2]*u+r[4],i[1]=r[1]*l+r[3]*u+r[5],i},aa.transformMat3=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[3]*u+r[6],i[1]=r[1]*l+r[4]*u+r[7],i},aa.transformMat4=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[4]*u+r[12],i[1]=r[1]*l+r[5]*u+r[13],i},aa.rotate=function(i,t,r,l){var u=t[0]-r[0],h=t[1]-r[1],p=Math.sin(l),g=Math.cos(l);return i[0]=u*g-h*p+r[0],i[1]=u*p+h*g+r[1],i},aa.angle=function(i,t){var r=i[0],l=i[1],u=t[0],h=t[1],p=Math.sqrt(r*r+l*l)*Math.sqrt(u*u+h*h);return Math.acos(Math.min(Math.max(p&&(r*u+l*h)/p,-1),1))},aa.zero=function(i){return i[0]=0,i[1]=0,i},aa.str=function(i){return"vec2("+i[0]+", "+i[1]+")"},aa.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]},aa.equals=function(i,t){var r=i[0],l=i[1],u=t[0],h=t[1];return Math.abs(r-u)<=gm.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(l-h)<=gm.EPSILON*Math.max(1,Math.abs(l),Math.abs(h))},aa.forEach=aa.sqrLen=aa.sqrDist=aa.dist=aa.div=aa.mul=aa.sub=aa.len=void 0;var gm=function(i,t){if(i&&i.__esModule)return i;if(i===null||LC(i)!=="object"&&typeof i!="function")return{default:i};var r=bz(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(eo);function bz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(bz=function(l){return l?r:t})(i)}function xz(){var i=new gm.ARRAY_TYPE(2);return gm.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0),i}function wz(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i}function Sz(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i}function Az(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i}function Ez(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1])}function Mz(i,t){var r=t[0]-i[0],l=t[1]-i[1];return r*r+l*l}function Tz(i){return Math.hypot(i[0],i[1])}function Cz(i){var t=i[0],r=i[1];return t*t+r*r}aa.len=Tz,aa.sub=wz,aa.mul=Sz,aa.div=Az,aa.dist=Ez,aa.sqrDist=Mz,aa.sqrLen=Cz;var bQ=function(){var i=xz();return function(t,r,l,u,h,p){var g,v;for(r||(r=2),l||(l=0),v=u?Math.min(u*r+l,t.length):t.length,g=l;g<v;g+=r)i[0]=t[g],i[1]=t[g+1],h(i,i,p),t[g]=i[0],t[g+1]=i[1];return t}}();function RC(i){return RC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RC(i)}aa.forEach=bQ,Object.defineProperty(Qr,"__esModule",{value:!0});var Va=Qr.vec4=ke=Qr.vec3=Qr.vec2=Qr.quat2=Ao=Qr.quat=nt=Qr.mat4=Rs=Qr.mat3=Qr.mat2d=Xy=Qr.mat2=Qr.glMatrix=void 0,xQ=Bu(eo);Qr.glMatrix=xQ;var wQ=Bu(Ci),Xy=Qr.mat2=wQ,SQ=Bu(ki);Qr.mat2d=SQ;var AQ=Bu($a),Rs=Qr.mat3=AQ,EQ=Bu(Kn),nt=Qr.mat4=EQ,MQ=Bu(Gn),Ao=Qr.quat=MQ,TQ=Bu(ya);Qr.quat2=TQ;var CQ=Bu(aa);Qr.vec2=CQ;var PQ=Bu(Zn),ke=Qr.vec3=PQ,IQ=Bu(ua);function Pz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(Pz=function(l){return l?r:t})(i)}function Bu(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||RC(i)!=="object"&&typeof i!="function")return{default:i};var r=Pz(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}Va=Qr.vec4=IQ;const LQ=N([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:m2}=LQ,Iz=N([{name:"a_pos_3",components:3,type:"Int16"}]);var ff=N([{name:"a_pos",type:"Int16",components:2}]),Lz={};(function(i,t){(function(r){function l(h,p,g){var v=u(256*h,256*(p=Math.pow(2,g)-p-1),g),b=u(256*(h+1),256*(p+1),g);return v[0]+","+v[1]+","+b[0]+","+b[1]}function u(h,p,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[h*v-2*Math.PI*6378137/2,p*v-2*Math.PI*6378137/2]}r.getURL=function(h,p,g,v,b,x){return x=x||{},h+"?"+["bbox="+l(g,v,b),"format="+(x.format||"image/png"),"service="+(x.service||"WMS"),"version="+(x.version||"1.1.1"),"request="+(x.request||"GetMap"),"srs="+(x.srs||"EPSG:3857"),"width="+(x.width||256),"height="+(x.height||256),"layers="+p].join("&")},r.getTileBBox=l,r.getMercCoords=u,Object.defineProperty(r,"__esModule",{value:!0})})(t)})(0,Lz);var RQ=Lz;class Uu{constructor(t,r,l){this.z=t,this.x=r,this.y=l,this.key=X_(0,t,t,r,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r){const l=RQ.getTileBBox(this.x,this.y,this.z),u=function(h,p,g){let v,b="";for(let x=h;x>0;x--)v=1<<x-1,b+=(p&v?1:0)+(g&v?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class kC{constructor(t,r){this.wrap=t,this.canonical=r,this.key=X_(t,r.z,r.z,r.x,r.y)}}class Ta{constructor(t,r,l,u,h){this.overscaledZ=t,this.wrap=r,this.canonical=new Uu(l,+u,+h),this.key=r===0&&t===l?this.canonical.key:X_(r,t,l,u,h)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const r=this.canonical.z-t;return t>this.canonical.z?new Ta(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ta(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r=!0){if(this.overscaledZ===t&&r)return this.key;if(t>this.canonical.z)return X_(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return X_(this.wrap*+r,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Ta(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,u=2*this.canonical.y;return[new Ta(r,this.wrap,r,l,u),new Ta(r,this.wrap,r,l+1,u),new Ta(r,this.wrap,r,l,u+1),new Ta(r,this.wrap,r,l+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ta(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ta(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new kC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function X_(i,t,r,l,u){const h=1<<Math.min(r,22);let p=h*(u%h)+l%h;return i&&r<22&&(p+=h*h*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*p+r)+(t-r)}const Rz=[i=>{let t=i.canonical.x-1,r=i.wrap;return t<0&&(t=(1<<i.canonical.z)-1,r--),new Ta(i.overscaledZ,r,i.canonical.z,t,i.canonical.y)},i=>{let t=i.canonical.x+1,r=i.wrap;return t===1<<i.canonical.z&&(t=0,r++),new Ta(i.overscaledZ,r,i.canonical.z,t,i.canonical.y)},i=>new Ta(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,(i.canonical.y===0?1<<i.canonical.z:i.canonical.y)-1),i=>new Ta(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y===(1<<i.canonical.z)-1?0:i.canonical.y+1)];un(Uu,"CanonicalTileID"),un(Ta,"OverscaledTileID",{omit:["projMatrix"]});class g2{constructor(t,r){this.pos=t,this.dir=r}intersectsPlane(t,r,l){const u=ke.dot(r,this.dir);if(Math.abs(u)<1e-6)return!1;const h=((t[0]-this.pos[0])*r[0]+(t[1]-this.pos[1])*r[1]+(t[2]-this.pos[2])*r[2])/u;return l[0]=this.pos[0]+this.dir[0]*h,l[1]=this.pos[1]+this.dir[1]*h,l[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,r,l){if(ke.equals(this.pos,t)||r===0)return l[0]=l[1]=l[2]=0,!1;const[u,h,p]=this.dir,g=this.pos[0]-t[0],v=this.pos[1]-t[1],b=this.pos[2]-t[2],x=u*u+h*h+p*p,S=2*(g*u+v*h+b*p),T=S*S-4*x*(g*g+v*v+b*b-r*r);if(T<0){const P=Math.max(-S/2,0),R=g+u*P,z=v+h*P,U=b+p*P,W=Math.hypot(R,z,U);return l[0]=R*r/W,l[1]=z*r/W,l[2]=U*r/W,!1}{const P=(-S-Math.sqrt(T))/(2*x);if(P<0){const R=Math.hypot(g,v,b);return l[0]=g*r/R,l[1]=v*r/R,l[2]=b*r/R,!1}return l[0]=g+u*P,l[1]=v+h*P,l[2]=b+p*P,!0}}}class DC{constructor(t,r,l,u,h){this.TL=t,this.TR=r,this.BR=l,this.BL=u,this.horizon=h}static fromInvProjectionMatrix(t,r,l){const u=[-1,1,1],h=[1,1,1],p=[1,-1,1],g=[-1,-1,1],v=ke.transformMat4(u,u,t),b=ke.transformMat4(h,h,t),x=ke.transformMat4(p,p,t),S=ke.transformMat4(g,g,t);return new DC(v,b,x,S,r/l)}}function Z_(i,t,r){let l=1/0,u=-1/0;const h=[];for(const p of i){ke.sub(h,p,t);const g=ke.dot(h,r);l=Math.min(l,g),u=Math.max(u,g)}return[l,u]}function kz(i,t){let r=!0;for(let l=0;l<i.planes.length;l++){const u=i.planes[l];let h=0;for(let p=0;p<t.length;p++)h+=ke.dot(u,t[p])+u[3]>=0;if(h===0)return 0;h!==t.length&&(r=!1)}return r?2:1}function Dz(i,t){for(const r of i.projections){const l=Z_(t,i.points[0],r.axis);if(r.projection[1]<l[0]||r.projection[0]>l[1])return 0}return 1}function Oz(i,t){let r=0;const l=[0,0,0,0];for(let u=0;u<i.length;u++)l[0]=i[u][0],l[1]=i[u][1],l[2]=i[u][2],l[3]=1,Va.dot(l,t)>=0&&r++;return r}class Yd{constructor(t,r){this.points=t||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=di.fromPoints(this.points),this.projections=[],this.frustumEdges=[ke.sub([],this.points[2],this.points[3]),ke.sub([],this.points[0],this.points[3]),ke.sub([],this.points[4],this.points[0]),ke.sub([],this.points[5],this.points[1]),ke.sub([],this.points[6],this.points[2]),ke.sub([],this.points[7],this.points[3])];for(const l of this.frustumEdges){const u=[0,-l[2],l[1]],h=[l[2],0,-l[0]];this.projections.push({axis:u,projection:Z_(this.points,this.points[0],u)}),this.projections.push({axis:h,projection:Z_(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(t,r,l,u){const h=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const x=Va.transformMat4([],b,t),S=1/x[3]/r*h;return Va.mul(x,x,[S,S,u?1/x[3]:S,S])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const x=ke.sub([],p[b[0]],p[b[1]]),S=ke.sub([],p[b[2]],p[b[1]]),T=ke.normalize([],ke.cross([],x,S)),P=-ke.dot(T,p[b[1]]);return T.concat(P)}),v=[];for(let b=0;b<p.length;b++)v.push([p[b][0],p[b][1],p[b][2]]);return new Yd(v,g)}intersectsPrecise(t,r,l){for(let u=0;u<r.length;u++)if(!Oz(t,r[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!Oz(t,this.planes[u]))return 0;for(const u of l)for(const h of this.frustumEdges){const p=ke.cross([],u,h),g=ke.length(p);if(g===0)continue;ke.scale(p,p,1/g);const v=Z_(this.points,this.points[0],p),b=Z_(t,this.points[0],p);if(v[0]>b[1]||b[0]>v[1])return 0}return 1}}class di{static fromPoints(t){const r=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const u of t)ke.min(r,r,u),ke.max(l,l,u);return new di(r,l)}static fromTileIdAndHeight(t,r,l){const u=1<<t.canonical.z,h=t.canonical.x,p=t.canonical.y;return new di([h/u,p/u,r],[(h+1)/u,(p+1)/u,l])}static applyTransform(t,r){const l=t.getCorners();for(let u=0;u<l.length;++u)ke.transformMat4(l[u],l[u],r);return di.fromPoints(l)}static projectAabbCorners(t,r){const l=t.getCorners();for(let u=0;u<l.length;++u)ke.transformMat4(l[u],l[u],r);return l}constructor(t,r){this.min=t,this.max=r,this.center=ke.scale([],ke.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],l=ke.clone(this.min),u=ke.clone(this.max);for(let h=0;h<r.length;h++)l[h]=r[h]?this.min[h]:this.center[h],u[h]=r[h]?this.center[h]:this.max[h];return u[2]=this.max[2],new di(l,u)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,r=this.max;return[[t[0],t[1],t[2]],[r[0],t[1],t[2]],[r[0],r[1],t[2]],[t[0],r[1],t[2]],[t[0],t[1],r[2]],[r[0],t[1],r[2]],[r[0],r[1],r[2]],[t[0],r[1],r[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?kz(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?kz(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,r){return r||this.intersects(t)?Dz(t,this.getCorners()):0}intersectsPreciseFlat(t,r){return r||this.intersectsFlat(t)?Dz(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let r=0;r<3;++r)if(this.min[r]>t.max[r]||t.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t.min[r]),this.max[r]=Math.max(this.max[r],t.max[r])}encapsulatePoint(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t[r]),this.max[r]=Math.max(this.max[r],t[r])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}un(di,"Aabb");const Y_=5,pf=6,os=dt/Math.PI/2,kQ=16383,Zy=64,OC=[Zy,32,16],cc=-os,uc=os,DQ=[new di([cc,cc,cc],[uc,uc,uc]),new di([cc,cc,cc],[0,0,uc]),new di([0,cc,cc],[uc,0,uc]),new di([cc,0,cc],[0,uc,uc]),new di([0,0,cc],[uc,uc,uc])];function y2(i){return i*os/Ky}function zz(i,t,r,l=!0){const u=ke.scale([],i._camera.position,i.worldSize),h=[t,r,1,1];Va.transformMat4(h,h,i.pixelMatrixInverse),Va.scale(h,h,1/h[3]);const p=ke.sub([],h,u),g=ke.normalize([],p),v=i.globeMatrix,b=[v[12],v[13],v[14]],x=ke.sub([],b,u),S=ke.length(x),T=ke.normalize([],x),P=i.worldSize/(2*Math.PI),R=ke.dot(T,g),z=Math.asin(P/S);if(z<Math.acos(R)){if(!l)return null;const Te=[],we=[];ke.scale(Te,g,S/R),ke.normalize(we,ke.sub(we,Te,x)),ke.normalize(g,ke.add(g,x,ke.scale(g,we,Math.tan(z)*S)))}const U=[];new g2(u,g).closestPointOnSphere(b,P,U);const W=ke.normalize([],At(v,0)),j=ke.normalize([],At(v,1)),Z=ke.normalize([],At(v,2)),Y=ke.dot(W,U),$=ke.dot(j,U),K=ke.dot(Z,U),ae=fe(Math.asin(-$/P));let se=fe(Math.atan2(Y,K));se=i.center.lng+function(Te,we){const Ie=(we-Te+180)%360-180;return Ie<-180?Ie+360:Ie}(i.center.lng,se);const de=go(se),ge=ne(Eo(ae),0,1);return new ga(de,ge)}class OQ{constructor(t,r,l){this.a=ke.sub([],t,l),this.b=ke.sub([],r,l),this.center=l;const u=ke.normalize([],this.a),h=ke.normalize([],this.b);this.angle=Math.acos(ke.dot(u,h))}}function zC(i,t){if(i.angle===0)return null;let r;return r=i.a[t]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[t]/i.a[t]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(l,u,h,p){const g=Math.sin(h);return l*(Math.sin((1-p)*h)/g)+u*(Math.sin(p*h)/g)}(i.a[t],i.b[t],i.angle,ne(r,0,1))+i.center[t]}function dc(i){if(i.z<=1)return DQ[i.z+2*i.y+i.x];const t=NC(v2(i));return di.fromPoints(t)}function Kd(i,t,r){return ke.scale(i,i,1-r),ke.scaleAndAdd(i,i,t,r)}function Fz(i,t){const r=mo(t.zoom);if(r===0)return dc(i);const l=v2(i),u=NC(l),h=go(l.getWest())*t.worldSize,p=go(l.getEast())*t.worldSize,g=Eo(l.getNorth())*t.worldSize,v=Eo(l.getSouth())*t.worldSize,b=[h,g,0],x=[p,g,0],S=[h,v,0],T=[p,v,0],P=nt.invert([],t.globeMatrix);return ke.transformMat4(b,b,P),ke.transformMat4(x,x,P),ke.transformMat4(S,S,P),ke.transformMat4(T,T,P),u[0]=Kd(u[0],S,r),u[1]=Kd(u[1],T,r),u[2]=Kd(u[2],x,r),u[3]=Kd(u[3],b,r),di.fromPoints(u)}function Nz(i,t,r){for(const l of i)ke.transformMat4(l,l,t),ke.scale(l,l,r)}function FC(i,t,r,l){const u=t/i.worldSize,h=i.globeMatrix;if(r.z<=1){const de=dc(r).getCorners();return Nz(de,h,u),di.fromPoints(de)}const p=v2(r,l),g=NC(p);Nz(g,h,u);const v=Number.MAX_VALUE,b=[-v,-v,-v],x=[v,v,v];if(p.contains(i.center)){for(const Te of g)ke.min(x,x,Te),ke.max(b,b,Te);b[2]=0;const de=i.point,ge=[de.x*u,de.y*u,0];return ke.min(x,x,ge),ke.max(b,b,ge),new di(x,b)}const S=[h[12]*u,h[13]*u,h[14]*u],T=p.getCenter(),P=ne(i.center.lat,-ji,ji),R=ne(T.lat,-ji,ji),z=go(i.center.lng),U=Eo(P);let W=z-go(T.lng);const j=U-Eo(R);W>.5?W-=1:W<-.5&&(W+=1);let Z=0;if(Math.abs(W)>Math.abs(j))Z=W>=0?1:3;else{Z=j>=0?0:2;const de=[h[4]*u,h[5]*u,h[6]*u],ge=-Math.sin(be(j>=0?p.getSouth():p.getNorth()))*os;ke.scaleAndAdd(S,S,de,ge)}const Y=g[Z],$=g[(Z+1)%4],K=new OQ(Y,$,S),ae=[zC(K,0)||Y[0],zC(K,1)||Y[1],zC(K,2)||Y[2]],se=mo(i.zoom);if(se>0){const de=function({x:Te,y:we,z:Ie},xe,We,qe,Qe){const Ne=1/(1<<Ie);let Ve=Te*Ne,at=Ve+Ne,mt=we*Ne,lt=mt+Ne,Ct=0;const zt=(Ve+at)/2-qe;return zt>.5?Ct=-1:zt<-.5&&(Ct=1),Ve=((Ve+Ct)*xe-(qe*=xe))*We+qe,at=((at+Ct)*xe-qe)*We+qe,mt=(mt*xe-(Qe*=xe))*We+Qe,lt=(lt*xe-Qe)*We+Qe,[[Ve,lt,0],[at,lt,0],[at,mt,0],[Ve,mt,0]]}(r,t,i._pixelsPerMercatorPixel,z,U);for(let Te=0;Te<g.length;Te++)Kd(g[Te],de[Te],se);const ge=ke.add([],de[Z],de[(Z+1)%4]);ke.scale(ge,ge,.5),Kd(ae,ge,se)}for(const de of g)ke.min(x,x,de),ke.max(b,b,de);return x[2]=Math.min(Y[2],$[2]),ke.min(x,x,ae),ke.max(b,b,ae),new di(x,b)}function v2({x:i,y:t,z:r},l=!1){const u=1/(1<<r),h=new On(il(i*u),t===(1<<r)-1&&l?-90:pr((t+1)*u)),p=new On(il((i+1)*u),t===0&&l?90:pr(t*u));return new Il(h,p)}function NC(i){const t=be(i.getNorth()),r=be(i.getSouth()),l=Math.cos(t),u=Math.cos(r),h=Math.sin(t),p=Math.sin(r),g=i.getWest(),v=i.getEast();return[Yy(u,p,g),Yy(u,p,v),Yy(l,h,v),Yy(l,h,g)]}function Yy(i,t,r,l=os){return r=be(r),[i*Math.sin(r)*l,-t*l,i*Math.cos(r)*l]}function ks(i,t,r){return Yy(Math.cos(be(i)),Math.sin(be(i)),t,r)}function K_(i,t,r,l){const u=1<<r.z,h=(i/dt+r.x)/u;return ks(pr((t/dt+r.y)/u),il(h),l)}function _2({min:i,max:t}){return kQ/Math.max(t[0]-i[0],t[1]-i[1],t[2]-i[2])}const Bz=new Float64Array(16);function ym(i){const t=_2(i),r=nt.fromScaling(Bz,[t,t,t]);return nt.translate(r,r,ke.negate([],i.min))}function BC(i){const t=nt.fromTranslation(Bz,i.min),r=1/_2(i);return nt.scale(t,t,[r,r,r])}function UC(i){const t=dt/(2*Math.PI);return i/(2*Math.PI)/t}function Uz(i,t){return dt/(512*Math.pow(2,i))*_2(dc(t))}function Wz(i,t,r,l,u){const h=UC(r),p=[i,t,-r/(2*Math.PI)],g=nt.identity(new Float64Array(16));return nt.translate(g,g,p),nt.scale(g,g,[h,h,h]),nt.rotateX(g,g,be(-u)),nt.rotateY(g,g,be(-l)),g}function mo(i){return Ee(Y_,pf,i)}function Vz(i,t,r){const l=nt.identity(new Float64Array(16)),u=(t/(1<<i)-.5)*Math.PI*2;return nt.rotateY(l,r.globeMatrix,u),Float32Array.from(l)}function Gz(i,t,r){const l=mo(r.zoom),u=i.style.map._antialias,h=t.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return l===0&&!u&&!h}function zQ(i,t,r,l){const u=t.getNorth(),h=t.getSouth(),p=t.getWest(),g=t.getEast(),v=1<<i.z,b=g-p,x=u-h,S=b/Zy,T=-x/OC[r],P=[0,S,0,T,0,0,u,p,0];if(i.z>0){const R=180/l;Rs.multiply(P,P,[R/b+1,0,0,0,R/x+1,0,-.5*R/S,.5*R/T,1])}return P[2]=v,P[5]=i.x,P[8]=i.y,P}function FQ(i){const t=ji-5;i=ne(i,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(be(i))),3);return Math.round(r*(OC.length-1))}function Hz(i){const t=[0,0,0],r=nt.identity(new Float64Array(16));return nt.multiply(r,i.pixelMatrix,i.globeMatrix),ke.transformMat4(t,t,r),new V(t[0],t[1])}function jz(i,t){const r=ks(t.lat,t.lng),l=function(h){const p=ks(h._center.lat,h._center.lng),g=ke.fromValues(0,1,0);let v=ke.cross([],g,p);const b=nt.fromRotation([],-h.angle,p);v=ke.transformMat4(v,v,b),nt.fromRotation(b,-h._pitch,v);const x=ke.normalize([],p);return ke.scale(x,x,y2(h.cameraToCenterDistance/h.pixelsPerMeter)),ke.transformMat4(x,x,b),ke.add([],p,x)}(i),u=ke.subtract([],l,r);return ke.angle(u,r)}function b2(i,t){return jz(i,t)>Math.PI/2*1.01}const $z=be(85),NQ=Math.cos($z),BQ=Math.sin($z);class UQ{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,r){const l=new J,u=new Nn,h=[],p=t+1+2,g=r[0]+1,v=r[0]+1+(1+r.length),b=(x,S,T)=>{let P=x===p-1?x-2:x===0?x:x-1;return P+=T?24575:0,[P,S]};for(let x=0;x<p;++x)l.emplaceBack(...b(x,0,!0));for(let x=0;x<g;++x)for(let S=0;S<p;++S)l.emplaceBack(...b(S,x,(S===0||S===p-1)&&!0));for(let x=0;x<r.length;++x){const S=r[x];for(let T=0;T<p;++T)l.emplaceBack(...b(T,S,!0))}for(let x=0;x<r.length;++x){const S=u.length,T=r[x]+1+2,P=new Nn;for(let U=0;U<T-1;U++){const W=U===T-2,j=W?p*(v-r.length+x-U):p;for(let Z=0;Z<p-1;Z++){const Y=U*p+Z;U===0||W||Z===0||Z===p-2?(P.emplaceBack(Y+1,Y,Y+j),P.emplaceBack(Y+j,Y+j+1,Y+1)):(u.emplaceBack(Y+1,Y,Y+j),u.emplaceBack(Y+j,Y+j+1,Y+1))}}const R=Ha.simpleSegment(0,S,l.length,u.length-S);for(let U=0;U<P.uint16.length;U+=3)u.emplaceBack(P.uint16[U],P.uint16[U+1],P.uint16[U+2]);const z=Ha.simpleSegment(0,S,l.length,u.length-S);h.push({withoutSkirts:R,withSkirts:z})}return{vertices:l,indices:u,segments:h}}_createGrid(t){const r=this._fillGridMeshWithLods(Zy,OC);this._gridSegments=r.segments,this._gridBuffer=t.createVertexBuffer(r.vertices,ff.members),this._gridIndexBuffer=t.createIndexBuffer(r.indices,!0)}_createPoles(t){const r=new Nn;for(let g=0;g<=Zy;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(r,!0);const l=new Ua,u=new Ua,h=new Ua,p=new Ua;this._poleSegments=[];for(let g=0,v=0;g<Y_;g++){const b=360/(1<<g);l.emplaceBack(0,-os,0,.5,0),u.emplaceBack(0,-os,0,.5,1),h.emplaceBack(0,-os,0,.5,.5),p.emplaceBack(0,-os,0,.5,.5);for(let x=0;x<=Zy;x++){let S=x/Zy,T=0;const P=Ln(0,b,S),[R,z,U]=Yy(NQ,BQ,P,os);l.emplaceBack(R,z,U,S,T),u.emplaceBack(R,z,U,S,1-T);const W=be(P);S=.5+.5*Math.sin(W),T=.5+.5*Math.cos(W),h.emplaceBack(R,z,U,S,T),p.emplaceBack(R,z,U,S,1-T)}this._poleSegments.push(Ha.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(l,m2,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(u,m2,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(h,m2,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(p,m2,!1)}getGridBuffers(t,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const Ky=63710088e-1,WC=2*Math.PI*Ky;class mf{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new mf(Ye(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,l=this.lat*r,u=t.lat*r,h=Math.sin(l)*Math.sin(u)+Math.cos(l)*Math.cos(u)*Math.cos((t.lng-this.lng)*r);return Ky*Math.acos(Math.min(h,1))}toBounds(t=0){const r=360*t/40075017,l=r/Math.cos(Math.PI/180*this.lat);return new Il(new mf(this.lng-l,this.lat-r),new mf(this.lng+l,this.lat+r))}toEcef(t){const r=y2(t);return ks(this.lat,this.lng,os+r)}static convert(t){if(t instanceof mf)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new mf(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new mf(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var On=mf;const WQ=0,VQ=25.5;function x2(i){return WC*Math.cos(i*Math.PI/180)}function go(i){return(180+i)/360}function Eo(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function ja(i,t){return i/x2(t)}function il(i){return 360*i-180}function pr(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function qz(i,t){return i*x2(pr(t))}const ji=85.051129;function Xz(i){return Math.cos(be(ne(i,-ji,ji)))}function gf(i,t){const r=ne(t,WQ,VQ),l=Math.pow(2,r);return Xz(i)*WC/(512*l)}function VC(i){return 1/Math.cos(i*Math.PI/180)}function J_(i,t=0){const r=Math.exp(Math.PI*(1-(i.y+t/dt)/(1<<i.z)*2));return 80150034*r/(r*r+1)/dt/(1<<i.z)}class ga{constructor(t,r,l=0){this.x=+t,this.y=+r,this.z=+l}static fromLngLat(t,r=0){const l=On.convert(t);return new ga(go(l.lng),Eo(l.lat),ja(r,l.lat))}toLngLat(){return new On(il(this.x),pr(this.y))}toAltitude(){return qz(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/WC*VC(pr(this.y))}}function GC(i,t,r,l,u,h,p,g,v){const b=(t+l)/2,x=(r+u)/2,S=new V(b,x);g(S),function(T,P,R,z,U,W){const j=R-U,Z=z-W;return Math.abs((z-P)*j-(R-T)*Z)/Math.hypot(j,Z)}(S.x,S.y,h.x,h.y,p.x,p.y)>=v?(GC(i,t,r,b,x,h,S,g,v),GC(i,b,x,l,u,S,p,g,v)):i.push(p)}function Zz(i,t,r){let l=i[0],u=l.x,h=l.y;t(l);const p=[l];for(let g=1;g<i.length;g++){const v=i[g],{x:b,y:x}=v;t(v),GC(p,u,h,b,x,l,v,t,r),u=b,h=x,l=v}return p}function HC(i,t,r,l){if(l(t,r)){const u=t.add(r)._mult(.5);HC(i,t,u,l),HC(i,u,r,l)}else i.push(r)}function GQ(i,t){let r=i[0];const l=[r];for(let u=1;u<i.length;u++){const h=i[u];HC(l,r,h,t),r=h}return l}const jC=Math.pow(2,14)-1,Yz=-jC-1;function HQ(i,t){const r=Math.round(i.x*t),l=Math.round(i.y*t);return i.x=ne(r,Yz,jC),i.y=ne(l,Yz,jC),(r<i.x||r>i.x+1||l<i.y||l>i.y+1)&&ve("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Wu(i,t,r){const l=i.loadGeometry(),u=i.extent,h=dt/u;if(t&&r&&r.projection.isReprojectedInTileSpace){const p=1<<t.z,{scale:g,x:v,y:b,projection:x}=r,S=T=>{const P=il((t.x+T.x/u)/p),R=pr((t.y+T.y/u)/p),z=x.project(P,R);T.x=(z.x*g-v)*u,T.y=(z.y*g-b)*u};for(let T=0;T<l.length;T++)if(i.type!==1)l[T]=Zz(l[T],S,1);else{const P=[];for(const R of l[T])R.x<0||R.x>=u||R.y<0||R.y>=u||(S(R),P.push(R));l[T]=P}}for(const p of l)for(const g of p)HQ(g,h);return l}function yf(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Wu(i):[]}}function w2(i,t,r,l,u){i.emplaceBack(2*t+(l+1)/2,2*r+(u+1)/2)}function S2(i,t,r){i.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class $C{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new J,this.indexArray=new Nn,this.segments=new Ha,this.programConfigurations=new df(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l,u){const h=this.layers[0],p=[];let g=null;h.type==="circle"&&(g=h.layout.get("circle-sort-key"));for(const{feature:b,id:x,index:S,sourceLayerIndex:T}of t){const P=this.layers[0]._featureFilter.needGeometry,R=yf(b,P);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),R,l))continue;const z=g?g.evaluate(R,{},l):void 0,U={id:x,properties:b.properties,type:b.type,sourceLayerIndex:T,index:S,geometry:P?R.geometry:Wu(b,l,u),patterns:{},sortKey:z};p.push(U)}g&&p.sort((b,x)=>b.sortKey-x.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new Jn,v=u.projection);for(const b of p){const{geometry:x,index:S,sourceLayerIndex:T}=b,P=t[S].feature;this.addFeature(b,x,S,r.availableImages,l,v,r.brightness),r.featureIndex.insert(P,x,S,T,this.index)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,QJ.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,eQ.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,r,l,u,h,p,g){for(const v of r)for(const b of v){const x=b.x,S=b.y;if(x<0||x>=dt||S<0||S>=dt)continue;if(p){const R=p.projectTilePoint(x,S,h),z=p.upVector(h,x,S),U=this.globeExtVertexArray;S2(U,R,z),S2(U,R,z),S2(U,R,z),S2(U,R,z)}const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=T.vertexLength;w2(this.layoutVertexArray,x,S,-1,-1),w2(this.layoutVertexArray,x,S,1,-1),w2(this.layoutVertexArray,x,S,1,1),w2(this.layoutVertexArray,x,S,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},u,h,g)}}function Kz(i,t){for(let r=0;r<i.length;r++)if(vf(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(vf(i,t[r]))return!0;return!!qC(i,t)}function jQ(i,t,r){return!!vf(i,t)||!!XC(t,i,r)}function Jz(i,t){if(i.length===1)return eF(t,i[0]);for(let r=0;r<t.length;r++){const l=t[r];for(let u=0;u<l.length;u++)if(vf(i,l[u]))return!0}for(let r=0;r<i.length;r++)if(eF(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(qC(i,t[r]))return!0;return!1}function $Q(i,t,r){if(i.length>1){if(qC(i,t))return!0;for(let l=0;l<t.length;l++)if(XC(t[l],i,r))return!0}for(let l=0;l<i.length;l++)if(XC(i[l],t,r))return!0;return!1}function qC(i,t){if(i.length===0||t.length===0)return!1;for(let r=0;r<i.length-1;r++){const l=i[r],u=i[r+1];for(let h=0;h<t.length-1;h++)if(qQ(l,u,t[h],t[h+1]))return!0}return!1}function qQ(i,t,r,l){return $e(i,r,l)!==$e(t,r,l)&&$e(i,t,r)!==$e(i,t,l)}function XC(i,t,r){const l=r*r;if(t.length===1)return i.distSqr(t[0])<l;for(let u=1;u<t.length;u++)if(Qz(i,t[u-1],t[u])<l)return!0;return!1}function Qz(i,t,r){const l=t.distSqr(r);if(l===0)return i.distSqr(t);const u=((i.x-t.x)*(r.x-t.x)+(i.y-t.y)*(r.y-t.y))/l;return i.distSqr(u<0?t:u>1?r:r.sub(t)._mult(u)._add(t))}function eF(i,t){let r,l,u,h=!1;for(let p=0;p<i.length;p++){r=i[p];for(let g=0,v=r.length-1;g<r.length;v=g++)l=r[g],u=r[v],l.y>t.y!=u.y>t.y&&t.x<(u.x-l.x)*(t.y-l.y)/(u.y-l.y)+l.x&&(h=!h)}return h}function vf(i,t){let r=!1;for(let l=0,u=i.length-1;l<i.length;u=l++){const h=i[l],p=i[u];h.y>t.y!=p.y>t.y&&t.x<(p.x-h.x)*(t.y-h.y)/(p.y-h.y)+h.x&&(r=!r)}return r}function tF(i,t,r,l,u){for(const p of i)if(t<=p.x&&r<=p.y&&l>=p.x&&u>=p.y)return!0;const h=[new V(t,r),new V(t,u),new V(l,u),new V(l,r)];if(i.length>2){for(const p of h)if(vf(i,p))return!0}for(let p=0;p<i.length-1;p++)if(XQ(i[p],i[p+1],h))return!0;return!1}function XQ(i,t,r){const l=r[0],u=r[2];if(i.x<l.x&&t.x<l.x||i.x>u.x&&t.x>u.x||i.y<l.y&&t.y<l.y||i.y>u.y&&t.y>u.y)return!1;const h=$e(i,t,r[0]);return h!==$e(i,t,r[1])||h!==$e(i,t,r[2])||h!==$e(i,t,r[3])}function Jy(i,t,r,l,u,h){let p=t.y-i.y,g=i.x-t.x;if(h=h||0){const v=p*p+g*g;if(v===0)return!0;const b=Math.sqrt(v);p/=b,g/=b}return!((r.x-i.x)*p+(r.y-i.y)*g-h<0||(l.x-i.x)*p+(l.y-i.y)*g-h<0||(u.x-i.x)*p+(u.y-i.y)*g-h<0)}function ZC(i,t,r,l,u,h,p){return!(Jy(i,t,l,u,h,p)||Jy(t,r,l,u,h,p)||Jy(r,i,l,u,h,p)||Jy(l,u,i,t,r,p)||Jy(u,h,i,t,r,p)||Jy(h,l,i,t,r,p))}function Qy(i,t,r){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(i)}function A2(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function nF(i,t,r,l,u){if(!t[0]&&!t[1])return i;const h=V.convert(t)._mult(u);r==="viewport"&&h._rotate(-l);const p=[];for(let g=0;g<i.length;g++)p.push(i[g].sub(h));return p}function aF(i,t,r,l){const u=V.convert(i)._mult(l);return t==="viewport"&&u._rotate(-r),u}un($C,"CircleBucket",{omit:["layers"]});const ZQ=new gi({"circle-sort-key":new yn(tt.layout_circle["circle-sort-key"]),visibility:new Xt(tt.layout_circle.visibility)});var YQ={paint:new gi({"circle-radius":new yn(tt.paint_circle["circle-radius"]),"circle-color":new yn(tt.paint_circle["circle-color"]),"circle-blur":new yn(tt.paint_circle["circle-blur"]),"circle-opacity":new yn(tt.paint_circle["circle-opacity"]),"circle-translate":new Xt(tt.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(tt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(tt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(tt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yn(tt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yn(tt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yn(tt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xt(tt.paint_circle["circle-emissive-strength"])}),layout:ZQ};const KQ=nt.create(),JQ=(i,t,r,l,u,h)=>{const p=i.transform,g=p.projection.name==="globe";let v;if(h.paint.get("circle-pitch-alignment")==="map")if(g){const x=Uz(p.zoom,t.canonical)*p._pixelsPerMercatorPixel;v=Float32Array.from([x,0,0,x])}else v=p.calculatePixelsToTileUnitsMatrix(r);else v=new Float32Array([p.pixelsToGLUnits[0],0,0,p.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:i.transform.getCameraToCenterDistance(p.projection),u_matrix:i.translatePosMatrix(t.projMatrix,r,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Cn.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:KQ,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=l,b.u_merc_center=u,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=mo(p.zoom);const x=u[0]*dt,S=u[1]*dt;b.u_up_dir=p.projection.upVector(new Uu(0,0,0),x,S)}return b},iF=i=>{const t=[];return i.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),i.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function rF(i,t,r,l,u,h,p,g,v){if(h&&i.queryGeometry.isAboveHorizon)return!1;h&&(v*=i.pixelToTileUnitsFactor);const b=i.tileID.canonical,x=r.projection.upVectorScale(b,r.center.lat,r.worldSize).metersToTile;for(const S of t)for(const T of S){const P=T.add(g),R=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(P.x,P.y,!0):0,z=r.projection.projectTilePoint(P.x,P.y,b);if(R>0){const Z=r.projection.upVector(b,P.x,P.y);z.x+=Z[0]*x*R,z.y+=Z[1]*x*R,z.z+=Z[2]*x*R}const U=h?P:QQ(z.x,z.y,z.z,l),W=h?i.tilespaceRays.map(Z=>tee(Z,R)):i.queryGeometry.screenGeometry,j=Va.transformMat4([],[z.x,z.y,z.z,1],l);if(!p&&h?v*=j[3]/r.cameraToCenterDistance:p&&!h&&(v*=r.cameraToCenterDistance/j[3]),h){const Z=pr((T.y/dt+b.y)/(1<<b.z));v/=r.projection.pixelsPerMeter(Z,1)/ja(1,Z)}if(jQ(W,U,v))return!0}return!1}function QQ(i,t,r,l){const u=Va.transformMat4([],[i,t,r,1],l);return new V(u[0]/u[3],u[1]/u[3])}const oF=ke.fromValues(0,0,0),eee=ke.fromValues(0,0,1);function tee(i,t){const r=ke.create();return oF[2]=t,i.intersectsPlane(oF,eee,r),new V(r[0],r[1])}class sF extends $C{}function lF(i,{width:t,height:r},l,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*r*l)throw new RangeError("mismatched image size")}else u=new Uint8Array(t*r*l);return i.width=t,i.height=r,i.data=u,i}function cF(i,t,r){const{width:l,height:u}=t;l===i.width&&u===i.height||(YC(i,t,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,l),height:Math.min(i.height,u)},r),i.width=l,i.height=u,i.data=t.data)}function YC(i,t,r,l,u,h){if(u.width===0||u.height===0)return t;if(u.width>i.width||u.height>i.height||r.x>i.width-u.width||r.y>i.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||l.x>t.width-u.width||l.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const p=i.data,g=t.data;for(let v=0;v<u.height;v++){const b=((r.y+v)*i.width+r.x)*h,x=((l.y+v)*t.width+l.x)*h;for(let S=0;S<u.width*h;S++)g[x+S]=p[b+S]}return t}un(sF,"HeatmapBucket",{omit:["layers"]});class Jd{constructor(t,r){lF(this,t,1,r)}resize(t){cF(this,new Jd(t),1)}clone(){return new Jd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,u,h){YC(t,r,l,u,h,1)}}class $i{constructor(t,r){lF(this,t,4,r)}resize(t){cF(this,new $i(t),4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new $i({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,u,h){YC(t,r,l,u,h,4)}}class uF{constructor(t,r){this.width=t.width,this.height=t.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}un(Jd,"AlphaImage"),un($i,"RGBAImage");const nee=new gi({visibility:new Xt(tt.layout_heatmap.visibility)});var aee={paint:new gi({"heatmap-radius":new yn(tt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yn(tt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(tt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fm(tt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(tt.paint_heatmap["heatmap-opacity"])}),layout:nee};function E2(i){const t={},r=i.resolution||256,l=i.clips?i.clips.length:1,u=i.image||new $i({width:r,height:l}),h=(p,g,v)=>{t[i.evaluationKey]=v;const b=i.expression.evaluate(t);b&&(u.data[p+g+0]=Math.floor(255*b.r/b.a),u.data[p+g+1]=Math.floor(255*b.g/b.a),u.data[p+g+2]=Math.floor(255*b.b/b.a),u.data[p+g+3]=Math.floor(255*b.a))};if(i.clips)for(let p=0,g=0;p<l;++p,g+=4*r)for(let v=0,b=0;v<r;v++,b+=4){const x=v/(r-1),{start:S,end:T}=i.clips[p];h(g,b,S*(1-x)+T*x)}else for(let p=0,g=0;p<r;p++,g+=4)h(0,g,p/(r-1));return u}const iee=new gi({visibility:new Xt(tt.layout_hillshade.visibility)});var ree={paint:new gi({"hillshade-illumination-direction":new Xt(tt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(tt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(tt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(tt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(tt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(tt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xt(tt.paint_hillshade["hillshade-emissive-strength"])}),layout:iee};const oee=N([{name:"a_pos",components:2,type:"Int16"}],4),{members:see}=oee;var KC={exports:{}};function M2(i,t,r){r=r||2;var l,u,h,p,g,v,b,x=t&&t.length,S=x?t[0]*r:i.length,T=dF(i,0,S,r,!0),P=[];if(!T||T.next===T.prev)return P;if(x&&(T=function(z,U,W,j){var Z,Y,$,K=[];for(Z=0,Y=U.length;Z<Y;Z++)($=dF(z,U[Z]*j,Z<Y-1?U[Z+1]*j:z.length,j,!1))===$.next&&($.steiner=!0),K.push(mee($));for(K.sort(hee),Z=0;Z<K.length;Z++)W=fee(K[Z],W);return W}(i,t,T,r)),i.length>80*r){l=h=i[0],u=p=i[1];for(var R=r;R<S;R+=r)(g=i[R])<l&&(l=g),(v=i[R+1])<u&&(u=v),g>h&&(h=g),v>p&&(p=v);b=(b=Math.max(h-l,p-u))!==0?32767/b:0}return Q_(T,P,r,l,u,b,0),P}function dF(i,t,r,l,u){var h,p;if(u===eP(i,t,r,l)>0)for(h=t;h<r;h+=l)p=pF(h,i[h],i[h+1],p);else for(h=r-l;h>=t;h-=l)p=pF(h,i[h],i[h+1],p);return p&&T2(p,p.next)&&(t1(p),p=p.next),p}function vm(i,t){if(!i)return i;t||(t=i);var r,l=i;do if(r=!1,l.steiner||!T2(l,l.next)&&Mr(l.prev,l,l.next)!==0)l=l.next;else{if(t1(l),(l=t=l.prev)===l.next)break;r=!0}while(r||l!==t);return t}function Q_(i,t,r,l,u,h,p){if(i){!p&&h&&function(x,S,T,P){var R=x;do R.z===0&&(R.z=JC(R.x,R.y,S,T,P)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==x);R.prevZ.nextZ=null,R.prevZ=null,function(z){var U,W,j,Z,Y,$,K,ae,se=1;do{for(W=z,z=null,Y=null,$=0;W;){for($++,j=W,K=0,U=0;U<se&&(K++,j=j.nextZ);U++);for(ae=se;K>0||ae>0&&j;)K!==0&&(ae===0||!j||W.z<=j.z)?(Z=W,W=W.nextZ,K--):(Z=j,j=j.nextZ,ae--),Y?Y.nextZ=Z:z=Z,Z.prevZ=Y,Y=Z;W=j}Y.nextZ=null,se*=2}while($>1)}(R)}(i,l,u,h);for(var g,v,b=i;i.prev!==i.next;)if(g=i.prev,v=i.next,h?cee(i,l,u,h):lee(i))t.push(g.i/r|0),t.push(i.i/r|0),t.push(v.i/r|0),t1(i),i=v.next,b=v.next;else if((i=v)===b){p?p===1?Q_(i=uee(vm(i),t,r),t,r,l,u,h,2):p===2&&dee(i,t,r,l,u,h):Q_(vm(i),t,r,l,u,h,1);break}}}function lee(i){var t=i.prev,r=i,l=i.next;if(Mr(t,r,l)>=0)return!1;for(var u=t.x,h=r.x,p=l.x,g=t.y,v=r.y,b=l.y,x=u<h?u<p?u:p:h<p?h:p,S=g<v?g<b?g:b:v<b?v:b,T=u>h?u>p?u:p:h>p?h:p,P=g>v?g>b?g:b:v>b?v:b,R=l.next;R!==t;){if(R.x>=x&&R.x<=T&&R.y>=S&&R.y<=P&&ev(u,g,h,v,p,b,R.x,R.y)&&Mr(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function cee(i,t,r,l){var u=i.prev,h=i,p=i.next;if(Mr(u,h,p)>=0)return!1;for(var g=u.x,v=h.x,b=p.x,x=u.y,S=h.y,T=p.y,P=g<v?g<b?g:b:v<b?v:b,R=x<S?x<T?x:T:S<T?S:T,z=g>v?g>b?g:b:v>b?v:b,U=x>S?x>T?x:T:S>T?S:T,W=JC(P,R,t,r,l),j=JC(z,U,t,r,l),Z=i.prevZ,Y=i.nextZ;Z&&Z.z>=W&&Y&&Y.z<=j;){if(Z.x>=P&&Z.x<=z&&Z.y>=R&&Z.y<=U&&Z!==u&&Z!==p&&ev(g,x,v,S,b,T,Z.x,Z.y)&&Mr(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,Y.x>=P&&Y.x<=z&&Y.y>=R&&Y.y<=U&&Y!==u&&Y!==p&&ev(g,x,v,S,b,T,Y.x,Y.y)&&Mr(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;Z&&Z.z>=W;){if(Z.x>=P&&Z.x<=z&&Z.y>=R&&Z.y<=U&&Z!==u&&Z!==p&&ev(g,x,v,S,b,T,Z.x,Z.y)&&Mr(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;Y&&Y.z<=j;){if(Y.x>=P&&Y.x<=z&&Y.y>=R&&Y.y<=U&&Y!==u&&Y!==p&&ev(g,x,v,S,b,T,Y.x,Y.y)&&Mr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function uee(i,t,r){var l=i;do{var u=l.prev,h=l.next.next;!T2(u,h)&&hF(u,l,l.next,h)&&e1(u,h)&&e1(h,u)&&(t.push(u.i/r|0),t.push(l.i/r|0),t.push(h.i/r|0),t1(l),t1(l.next),l=i=h),l=l.next}while(l!==i);return vm(l)}function dee(i,t,r,l,u,h){var p=i;do{for(var g=p.next.next;g!==p.prev;){if(p.i!==g.i&&gee(p,g)){var v=fF(p,g);return p=vm(p,p.next),v=vm(v,v.next),Q_(p,t,r,l,u,h,0),void Q_(v,t,r,l,u,h,0)}g=g.next}p=p.next}while(p!==i)}function hee(i,t){return i.x-t.x}function fee(i,t){var r=function(u,h){var p,g=h,v=u.x,b=u.y,x=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var S=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(S<=v&&S>x&&(x=S,p=g.x<g.next.x?g:g.next,S===v))return p}g=g.next}while(g!==h);if(!p)return null;var T,P=p,R=p.x,z=p.y,U=1/0;g=p;do v>=g.x&&g.x>=R&&v!==g.x&&ev(b<z?v:x,b,R,z,b<z?x:v,b,g.x,g.y)&&(T=Math.abs(b-g.y)/(v-g.x),e1(g,u)&&(T<U||T===U&&(g.x>p.x||g.x===p.x&&pee(p,g)))&&(p=g,U=T)),g=g.next;while(g!==P);return p}(i,t);if(!r)return t;var l=fF(r,i);return vm(l,l.next),vm(r,r.next)}function pee(i,t){return Mr(i.prev,i,t.prev)<0&&Mr(t.next,i,i.next)<0}function JC(i,t,r,l,u){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*u|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function mee(i){var t=i,r=i;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==i);return r}function ev(i,t,r,l,u,h,p,g){return(u-p)*(t-g)>=(i-p)*(h-g)&&(i-p)*(l-g)>=(r-p)*(t-g)&&(r-p)*(h-g)>=(u-p)*(l-g)}function gee(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(r,l){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==l.i&&u.next.i!==l.i&&hF(u,u.next,r,l))return!0;u=u.next}while(u!==r);return!1}(i,t)&&(e1(i,t)&&e1(t,i)&&function(r,l){var u=r,h=!1,p=(r.x+l.x)/2,g=(r.y+l.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&p<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==r);return h}(i,t)&&(Mr(i.prev,i,t.prev)||Mr(i,t.prev,t))||T2(i,t)&&Mr(i.prev,i,i.next)>0&&Mr(t.prev,t,t.next)>0)}function Mr(i,t,r){return(t.y-i.y)*(r.x-t.x)-(t.x-i.x)*(r.y-t.y)}function T2(i,t){return i.x===t.x&&i.y===t.y}function hF(i,t,r,l){var u=P2(Mr(i,t,r)),h=P2(Mr(i,t,l)),p=P2(Mr(r,l,i)),g=P2(Mr(r,l,t));return u!==h&&p!==g||!(u!==0||!C2(i,r,t))||!(h!==0||!C2(i,l,t))||!(p!==0||!C2(r,i,l))||!(g!==0||!C2(r,t,l))}function C2(i,t,r){return t.x<=Math.max(i.x,r.x)&&t.x>=Math.min(i.x,r.x)&&t.y<=Math.max(i.y,r.y)&&t.y>=Math.min(i.y,r.y)}function P2(i){return i>0?1:i<0?-1:0}function e1(i,t){return Mr(i.prev,i,i.next)<0?Mr(i,t,i.next)>=0&&Mr(i,i.prev,t)>=0:Mr(i,t,i.prev)<0||Mr(i,i.next,t)<0}function fF(i,t){var r=new QC(i.i,i.x,i.y),l=new QC(t.i,t.x,t.y),u=i.next,h=t.prev;return i.next=t,t.prev=i,r.next=u,u.prev=r,l.next=r,r.prev=l,h.next=l,l.prev=h,l}function pF(i,t,r,l){var u=new QC(i,t,r);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function t1(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function QC(i,t,r){this.i=i,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function eP(i,t,r,l){for(var u=0,h=t,p=r-l;h<r;h+=l)u+=(i[p]-i[h])*(i[h+1]+i[p+1]),p=h;return u}KC.exports=M2,KC.exports.default=M2,M2.deviation=function(i,t,r,l){var u=t&&t.length,h=Math.abs(eP(i,0,u?t[0]*r:i.length,r));if(u)for(var p=0,g=t.length;p<g;p++)h-=Math.abs(eP(i,t[p]*r,p<g-1?t[p+1]*r:i.length,r));var v=0;for(p=0;p<l.length;p+=3){var b=l[p]*r,x=l[p+1]*r,S=l[p+2]*r;v+=Math.abs((i[b]-i[S])*(i[x+1]-i[b+1])-(i[b]-i[x])*(i[S+1]-i[b+1]))}return h===0&&v===0?0:Math.abs((v-h)/h)},M2.flatten=function(i){for(var t=i[0][0].length,r={vertices:[],holes:[],dimensions:t},l=0,u=0;u<i.length;u++){for(var h=0;h<i[u].length;h++)for(var p=0;p<t;p++)r.vertices.push(i[u][h][p]);u>0&&r.holes.push(l+=i[u-1].length)}return r};var I2=F(KC.exports);function tP(i,t){const r=i.length;if(r<=1)return[i];const l=[];let u,h;for(let p=0;p<r;p++){const g=De(i[p]);g!==0&&(i[p].area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(u&&l.push(u),u=[i[p]]):u.push(i[p]))}if(u&&l.push(u),t>1)for(let p=0;p<l.length;p++)l[p].length<=t||(Ic(l[p],t,1,l[p].length-1,yee),l[p]=l[p].slice(0,t));return l}function yee(i,t){return t.area-i.area}function nP(i,t,r){const l=r.patternDependencies;let u=!1;for(const h of t){const p=h.paint.get(`${i}-pattern`);p.isConstant()||(u=!0);const g=p.constantOr(null);g&&(u=!0,l[g]=!0)}return u}function aP(i,t,r,l,u){const h=u.patternDependencies;for(const p of t){const g=p.paint.get(`${i}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:l},r,{},u.availableImages);v=v&&v.name?v.name:v,h[v]=!0,r.patterns[p.id]=v}}return r}class L2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new Nn,this.indexArray2=new Jr,this.programConfigurations=new df(t.layers,t.zoom),this.segments=new Ha,this.segments2=new Ha,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=t.projection}populate(t,r,l,u){this.hasPattern=nP("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),p=[];for(const{feature:g,id:v,index:b,sourceLayerIndex:x}of t){const S=this.layers[0]._featureFilter.needGeometry,T=yf(g,S);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),T,l))continue;const P=h?h.evaluate(T,{},l,r.availableImages):void 0,R={id:v,properties:g.properties,type:g.type,sourceLayerIndex:x,index:b,geometry:S?T.geometry:Wu(g,l,u),patterns:{},sortKey:P};p.push(R)}h&&p.sort((g,v)=>g.sortKey-v.sortKey);for(const g of p){const{geometry:v,index:b,sourceLayerIndex:x}=g;if(this.hasPattern){const S=aP("fill",this.layers,g,this.zoom,r);this.patternFeatures.push(S)}else this.addFeature(g,v,b,l,{},r.availableImages,r.brightness);r.featureIndex.insert(t[b].feature,v,b,x,this.index)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}addFeatures(t,r,l,u,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,l,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,see),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,l,u,h,p=[],g){for(const v of tP(r,500)){let b=0;for(const z of v)b+=z.length;const x=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),S=x.vertexLength,T=[],P=[];for(const z of v){if(z.length===0)continue;z!==v[0]&&P.push(T.length/2);const U=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),W=U.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(W+z.length-1,W),T.push(z[0].x),T.push(z[0].y);for(let j=1;j<z.length;j++)this.layoutVertexArray.emplaceBack(z[j].x,z[j].y),this.indexArray2.emplaceBack(W+j-1,W+j),T.push(z[j].x),T.push(z[j].y);U.vertexLength+=z.length,U.primitiveLength+=z.length}const R=I2(T,P);for(let z=0;z<R.length;z+=3)this.indexArray.emplaceBack(S+R[z],S+R[z+1],S+R[z+2]);x.vertexLength+=b,x.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,g)}}un(L2,"FillBucket",{omit:["layers","patternFeatures"]});const vee=new gi({"fill-sort-key":new yn(tt.layout_fill["fill-sort-key"]),visibility:new Xt(tt.layout_fill.visibility)});var _ee={paint:new gi({"fill-antialias":new Xt(tt.paint_fill["fill-antialias"]),"fill-opacity":new yn(tt.paint_fill["fill-opacity"]),"fill-color":new yn(tt.paint_fill["fill-color"]),"fill-outline-color":new yn(tt.paint_fill["fill-outline-color"]),"fill-translate":new Xt(tt.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(tt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yn(tt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Xt(tt.paint_fill["fill-emissive-strength"])}),layout:vee};const bee=N([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),xee=N([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),wee=N([{name:"a_centroid_pos",components:2,type:"Uint16"}]),See=N([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Aee=N([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Eee}=bee;var R2={},Mee=X,mF=tv;function tv(i,t,r,l,u){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=u,i.readFields(Tee,this,t)}function Tee(i,t,r){i==1?t.id=r.readVarint():i==2?function(l,u){for(var h=l.readVarint()+l.pos;l.pos<h;){var p=u._keys[l.readVarint()],g=u._values[l.readVarint()];u.properties[p]=g}}(r,t):i==3?t.type=r.readVarint():i==4&&(t._geometry=r.pos)}function Cee(i){for(var t,r,l=0,u=0,h=i.length,p=h-1;u<h;p=u++)l+=((r=i[p]).x-(t=i[u]).x)*(t.y+r.y);return l}tv.types=["Unknown","Point","LineString","Polygon"],tv.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,r=i.readVarint()+i.pos,l=1,u=0,h=0,p=0,g=[];i.pos<r;){if(u<=0){var v=i.readVarint();l=7&v,u=v>>3}if(u--,l===1||l===2)h+=i.readSVarint(),p+=i.readSVarint(),l===1&&(t&&g.push(t),t=[]),t.push(new Mee(h,p));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&g.push(t),g},tv.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,r=1,l=0,u=0,h=0,p=1/0,g=-1/0,v=1/0,b=-1/0;i.pos<t;){if(l<=0){var x=i.readVarint();r=7&x,l=x>>3}if(l--,r===1||r===2)(u+=i.readSVarint())<p&&(p=u),u>g&&(g=u),(h+=i.readSVarint())<v&&(v=h),h>b&&(b=h);else if(r!==7)throw new Error("unknown command "+r)}return[p,v,g,b]},tv.prototype.toGeoJSON=function(i,t,r){var l,u,h=this.extent*Math.pow(2,r),p=this.extent*i,g=this.extent*t,v=this.loadGeometry(),b=tv.types[this.type];function x(P){for(var R=0;R<P.length;R++){var z=P[R];P[R]=[360*(z.x+p)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(z.y+g)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var S=[];for(l=0;l<v.length;l++)S[l]=v[l][0];x(v=S);break;case 2:for(l=0;l<v.length;l++)x(v[l]);break;case 3:for(v=function(P){var R=P.length;if(R<=1)return[P];for(var z,U,W=[],j=0;j<R;j++){var Z=Cee(P[j]);Z!==0&&(U===void 0&&(U=Z<0),U===Z<0?(z&&W.push(z),z=[P[j]]):z.push(P[j]))}return z&&W.push(z),W}(v),l=0;l<v.length;l++)for(u=0;u<v[l].length;u++)x(v[l][u])}v.length===1?v=v[0]:b="Multi"+b;var T={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(T.id=this.id),T};var Pee=mF,gF=yF;function yF(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Iee,this,t),this.length=this._features.length}function Iee(i,t,r){i===15?t.version=r.readVarint():i===1?t.name=r.readString():i===5?t.extent=r.readVarint():i===2?t._features.push(r.pos):i===3?t._keys.push(r.readString()):i===4&&t._values.push(function(l){for(var u=null,h=l.readVarint()+l.pos;l.pos<h;){var p=l.readVarint()>>3;u=p===1?l.readString():p===2?l.readFloat():p===3?l.readDouble():p===4?l.readVarint64():p===5?l.readVarint():p===6?l.readSVarint():p===7?l.readBoolean():null}return u}(r))}yF.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new Pee(this._pbf,t,this.extent,this._keys,this._values)};var Lee=gF;function Ree(i,t,r){if(i===3){var l=new Lee(r,r.readVarint()+r.pos);l.length&&(t[l.name]=l)}}var iP=R2.VectorTile=function(i,t){this.layers=i.readFields(Ree,{},t)},k2=R2.VectorTileFeature=mF;function D2(i,t,r,l){const u=[],h=l===0?(p,g,v,b,x,S)=>{p.push(new V(S,v+(S-g)/(b-g)*(x-v)))}:(p,g,v,b,x,S)=>{p.push(new V(g+(S-v)/(x-v)*(b-g),S))};for(const p of i){const g=[];for(const v of p){if(v.length<=2)continue;const b=[];for(let T=0;T<v.length-1;T++){const P=v[T].x,R=v[T].y,z=v[T+1].x,U=v[T+1].y,W=l===0?P:R,j=l===0?z:U;W<t?j>t&&h(b,P,R,z,U,t):W>r?j<r&&h(b,P,R,z,U,r):b.push(v[T]),j<t&&W>=t&&h(b,P,R,z,U,t),j>r&&W<=r&&h(b,P,R,z,U,r)}let x=v[v.length-1];const S=l===0?x.x:x.y;S>=t&&S<=r&&b.push(x),b.length&&(x=b[b.length-1],b[0].x===x.x&&b[0].y===x.y||b.push(b[0]),g.push(b))}g.length&&u.push(g)}return u}R2.VectorTileLayer=gF;class vF{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var kee={read:function(i,t,r,l,u){var h,p,g=8*u-l-1,v=(1<<g)-1,b=v>>1,x=-7,S=r?u-1:0,T=r?-1:1,P=i[t+S];for(S+=T,h=P&(1<<-x)-1,P>>=-x,x+=g;x>0;h=256*h+i[t+S],S+=T,x-=8);for(p=h&(1<<-x)-1,h>>=-x,x+=l;x>0;p=256*p+i[t+S],S+=T,x-=8);if(h===0)h=1-b;else{if(h===v)return p?NaN:1/0*(P?-1:1);p+=Math.pow(2,l),h-=b}return(P?-1:1)*p*Math.pow(2,h-l)},write:function(i,t,r,l,u,h){var p,g,v,b=8*h-u-1,x=(1<<b)-1,S=x>>1,T=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=l?0:h-1,R=l?1:-1,z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,p=x):(p=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-p))<1&&(p--,v*=2),(t+=p+S>=1?T/v:T*Math.pow(2,1-S))*v>=2&&(p++,v/=2),p+S>=x?(g=0,p=x):p+S>=1?(g=(t*v-1)*Math.pow(2,u),p+=S):(g=t*Math.pow(2,S-1)*Math.pow(2,u),p=0));u>=8;i[r+P]=255&g,P+=R,g/=256,u-=8);for(p=p<<u|g,b+=u;b>0;i[r+P]=255&p,P+=R,p/=256,b-=8);i[r+P-R]|=128*z}},_F=vi,O2=kee;function vi(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}vi.Varint=0,vi.Fixed64=1,vi.Bytes=2,vi.Fixed32=5;var rP=4294967296,bF=1/rP,xF=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Qd(i){return i.type===vi.Bytes?i.readVarint()+i.pos:i.pos+1}function nv(i,t,r){return r?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function wF(i,t,r){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(l);for(var u=r.pos-1;u>=i;u--)r.buf[u+l]=r.buf[u]}function Dee(i,t){for(var r=0;r<i.length;r++)t.writeVarint(i[r])}function Oee(i,t){for(var r=0;r<i.length;r++)t.writeSVarint(i[r])}function zee(i,t){for(var r=0;r<i.length;r++)t.writeFloat(i[r])}function Fee(i,t){for(var r=0;r<i.length;r++)t.writeDouble(i[r])}function Nee(i,t){for(var r=0;r<i.length;r++)t.writeBoolean(i[r])}function Bee(i,t){for(var r=0;r<i.length;r++)t.writeFixed32(i[r])}function Uee(i,t){for(var r=0;r<i.length;r++)t.writeSFixed32(i[r])}function Wee(i,t){for(var r=0;r<i.length;r++)t.writeFixed64(i[r])}function Vee(i,t){for(var r=0;r<i.length;r++)t.writeSFixed64(i[r])}function z2(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function av(i,t,r){i[r]=t,i[r+1]=t>>>8,i[r+2]=t>>>16,i[r+3]=t>>>24}function SF(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}vi.prototype={destroy:function(){this.buf=null},readFields:function(i,t,r){for(r=r||this.length;this.pos<r;){var l=this.readVarint(),u=l>>3,h=this.pos;this.type=7&l,i(u,t,this),this.pos===h&&this.skip(l)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=z2(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=SF(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=z2(this.buf,this.pos)+z2(this.buf,this.pos+4)*rP;return this.pos+=8,i},readSFixed64:function(){var i=z2(this.buf,this.pos)+SF(this.buf,this.pos+4)*rP;return this.pos+=8,i},readFloat:function(){var i=O2.read(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=O2.read(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,r,l=this.buf;return t=127&(r=l[this.pos++]),r<128?t:(t|=(127&(r=l[this.pos++]))<<7,r<128?t:(t|=(127&(r=l[this.pos++]))<<14,r<128?t:(t|=(127&(r=l[this.pos++]))<<21,r<128?t:function(u,h,p){var g,v,b=p.buf;if(g=(112&(v=b[p.pos++]))>>4,v<128||(g|=(127&(v=b[p.pos++]))<<3,v<128)||(g|=(127&(v=b[p.pos++]))<<10,v<128)||(g|=(127&(v=b[p.pos++]))<<17,v<128)||(g|=(127&(v=b[p.pos++]))<<24,v<128)||(g|=(1&(v=b[p.pos++]))<<31,v<128))return nv(u,g,h);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&xF?function(r,l,u){return xF.decode(r.subarray(l,u))}(this.buf,t,i):function(r,l,u){for(var h="",p=l;p<u;){var g,v,b,x=r[p],S=null,T=x>239?4:x>223?3:x>191?2:1;if(p+T>u)break;T===1?x<128&&(S=x):T===2?(192&(g=r[p+1]))==128&&(S=(31&x)<<6|63&g)<=127&&(S=null):T===3?(v=r[p+2],(192&(g=r[p+1]))==128&&(192&v)==128&&((S=(15&x)<<12|(63&g)<<6|63&v)<=2047||S>=55296&&S<=57343)&&(S=null)):T===4&&(v=r[p+2],b=r[p+3],(192&(g=r[p+1]))==128&&(192&v)==128&&(192&b)==128&&((S=(15&x)<<18|(63&g)<<12|(63&v)<<6|63&b)<=65535||S>=1114112)&&(S=null)),S===null?(S=65533,T=1):S>65535&&(S-=65536,h+=String.fromCharCode(S>>>10&1023|55296),S=56320|1023&S),h+=String.fromCharCode(S),p+=T}return h}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==vi.Bytes)return i.push(this.readVarint(t));var r=Qd(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==vi.Bytes)return i.push(this.readSVarint());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==vi.Bytes)return i.push(this.readBoolean());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==vi.Bytes)return i.push(this.readFloat());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==vi.Bytes)return i.push(this.readDouble());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==vi.Bytes)return i.push(this.readFixed32());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==vi.Bytes)return i.push(this.readSFixed32());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==vi.Bytes)return i.push(this.readFixed64());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==vi.Bytes)return i.push(this.readSFixed64());var t=Qd(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===vi.Varint)for(;this.buf[this.pos++]>127;);else if(t===vi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===vi.Fixed32)this.pos+=4;else{if(t!==vi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),av(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),av(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),av(this.buf,-1&i,this.pos),av(this.buf,Math.floor(i*bF),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),av(this.buf,-1&i,this.pos),av(this.buf,Math.floor(i*bF),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,r){var l,u;if(t>=0?(l=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(h,p,g){g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,g.buf[g.pos]=127&(h>>>=7)}(l,0,r),function(h,p){var g=(7&h)<<4;p.buf[p.pos++]|=g|((h>>>=3)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h)))))}(u,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(l,u,h){for(var p,g,v=0;v<u.length;v++){if((p=u.charCodeAt(v))>55295&&p<57344){if(!g){p>56319||v+1===u.length?(l[h++]=239,l[h++]=191,l[h++]=189):g=p;continue}if(p<56320){l[h++]=239,l[h++]=191,l[h++]=189,g=p;continue}p=g-55296<<10|p-56320|65536,g=null}else g&&(l[h++]=239,l[h++]=191,l[h++]=189,g=null);p<128?l[h++]=p:(p<2048?l[h++]=p>>6|192:(p<65536?l[h++]=p>>12|224:(l[h++]=p>>18|240,l[h++]=p>>12&63|128),l[h++]=p>>6&63|128),l[h++]=63&p|128)}return h}(this.buf,i,this.pos);var r=this.pos-t;r>=128&&wF(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),O2.write(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),O2.write(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,t){this.pos++;var r=this.pos;i(t,this);var l=this.pos-r;l>=128&&wF(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,t,r){this.writeTag(i,vi.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,Dee,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,Oee,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,Nee,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,zee,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,Fee,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,Bee,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,Uee,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,Wee,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,Vee,t)},writeBytesField:function(i,t){this.writeTag(i,vi.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,vi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,vi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,vi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,vi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,vi.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,vi.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,vi.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,vi.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,vi.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var F2=F(_F);const Gee=["tile","layer","source","sourceLayer","state"];class AF{constructor(t,r,l,u,h){this.type="Feature",this._vectorTileFeature=t,this._z=r,this._x=l,this._y=u,this.properties=t.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const r of Gee)this[r]!==void 0&&(t[r]=this[r]);return t}}class Hee{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,l){const u=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][u]=this.stateChanges[t][u]||{},Ue(this.stateChanges[t][u],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const h in this.state[t])h!==u&&(this.deletedStates[t][h]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][u]===null){this.deletedStates[t][u]={};for(const h in this.state[t][u])l[h]||(this.deletedStates[t][u][h]=null)}else for(const h in l)this.deletedStates[t]&&this.deletedStates[t][u]&&this.deletedStates[t][u][h]===null&&delete this.deletedStates[t][u][h]}removeFeatureState(t,r,l){if(this.deletedStates[t]===null)return;const u=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&r!==void 0)this.deletedStates[t][u]!==null&&(this.deletedStates[t][u]=this.deletedStates[t][u]||{},this.deletedStates[t][u][l]=null);else if(r!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][u])for(l in this.deletedStates[t][u]={},this.stateChanges[t][u])this.deletedStates[t][u][l]=null;else this.deletedStates[t][u]=null;else this.deletedStates[t]=null}getState(t,r){const l=String(r),u=Ue({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const h=this.deletedStates[t][r];if(h===null)return{};for(const p in h)delete u[p]}return u}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const h={};for(const p in this.stateChanges[u])this.state[u][p]||(this.state[u][p]={}),Ue(this.state[u][p],this.stateChanges[u][p]),h[p]=this.state[u][p];l[u]=h}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const h={};if(this.deletedStates[u]===null)for(const p in this.state[u])h[p]={},this.state[u][p]={};else for(const p in this.deletedStates[u]){if(this.deletedStates[u][p]===null)this.state[u][p]={};else if(this.state[u][p])for(const g of Object.keys(this.deletedStates[u][p]))delete this.state[u][p][g];h[p]=this.state[u][p]}l[u]=l[u]||{},Ue(l[u],h)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in t)t[u].setFeatureState(l,r)}}class EF{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,r){const l=this.toIdx(t,r);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,r){return this.leaves[this.toIdx(t,r)]}toIdx(t,r){return r*this.size+t}}function MF(i,t,r,l){let u=0,h=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(l[p])<1e-15){if(r[p]<i[p]||r[p]>t[p])return null}else{const g=1/l[p];let v=(i[p]-r[p])*g,b=(t[p]-r[p])*g;if(v>b){const x=v;v=b,b=x}if(v>u&&(u=v),b<h&&(h=b),u>h)return null}return u}function TF(i,t,r,l,u,h,p,g,v,b,x){const S=l-i,T=u-t,P=h-r,R=p-i,z=g-t,U=v-r,W=x[1]*U-x[2]*z,j=x[2]*R-x[0]*U,Z=x[0]*z-x[1]*R,Y=S*W+T*j+P*Z;if(Math.abs(Y)<1e-15)return null;const $=1/Y,K=b[0]-i,ae=b[1]-t,se=b[2]-r,de=(K*W+ae*j+se*Z)*$;if(de<0||de>1)return null;const ge=ae*P-se*T,Te=se*S-K*P,we=K*T-ae*S,Ie=(x[0]*ge+x[1]*Te+x[2]*we)*$;return Ie<0||de+Ie>1?null:(R*ge+z*Te+U*we)*$}function CF(i,t,r){return(i-t)/(r-t)}function PF(i,t,r,l,u,h,p,g,v){const b=1<<r,x=h-l,S=p-u,T=(i+1)/b*x+l,P=(t+0)/b*S+u,R=(t+1)/b*S+u;g[0]=(i+0)/b*x+l,g[1]=P,v[0]=T,v[1]=R}class IF{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(h){const p=Math.ceil(Math.log2(h.dim/8)),g=[];let v=Math.ceil(Math.pow(2,p));const b=1/v,x=(P,R,z,U,W)=>{const j=U?1:0,Z=(P+1)*z-j,Y=R*z,$=(R+1)*z-j;W[0]=P*z,W[1]=Y,W[2]=Z,W[3]=$};let S=new EF(v);const T=[];for(let P=0;P<v*v;P++){x(P%v,Math.floor(P/v),b,!1,T);const R=_f(T[0],T[1],h),z=_f(T[2],T[1],h),U=_f(T[2],T[3],h),W=_f(T[0],T[3],h);S.minimums.push(Math.min(R,z,U,W)),S.maximums.push(Math.max(R,z,U,W)),S.leaves.push(1)}for(g.push(S),v/=2;v>=1;v/=2){const P=g[g.length-1];S=new EF(v);for(let R=0;R<v*v;R++){x(R%v,Math.floor(R/v),2,!0,T);const z=P.getElevation(T[0],T[1]),U=P.getElevation(T[2],T[1]),W=P.getElevation(T[2],T[3]),j=P.getElevation(T[0],T[3]),Z=P.isLeaf(T[0],T[1]),Y=P.isLeaf(T[2],T[1]),$=P.isLeaf(T[2],T[3]),K=P.isLeaf(T[0],T[3]),ae=Math.min(z.min,U.min,W.min,j.min),se=Math.max(z.max,U.max,W.max,j.max),de=Z&&Y&&$&&K;S.maximums.push(se),S.minimums.push(ae),S.leaves.push(se-ae<=5&&de?1:0)}g.push(S)}return g}(this.dem),l=r.length-1,u=r[l];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,l,0)}raycastRoot(t,r,l,u,h,p,g=1){return MF([t,r,-100],[l,u,this.maximums[0]*g],h,p)}raycast(t,r,l,u,h,p,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(t,r,l,u,h,p,g);if(v==null)return null;const b=[],x=[],S=[],T=[],P=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:R,t:z,nodex:U,nodey:W,depth:j}=P.pop();if(this.leaves[R]){PF(U,W,j,t,r,l,u,S,T);const Y=1<<j,$=(U+0)/Y,K=(U+1)/Y,ae=(W+0)/Y,se=(W+1)/Y,de=_f($,ae,this.dem)*g,ge=_f(K,ae,this.dem)*g,Te=_f(K,se,this.dem)*g,we=_f($,se,this.dem)*g,Ie=TF(S[0],S[1],de,T[0],S[1],ge,T[0],T[1],Te,h,p),xe=TF(T[0],T[1],Te,S[0],T[1],we,S[0],S[1],de,h,p),We=Math.min(Ie!==null?Ie:Number.MAX_VALUE,xe!==null?xe:Number.MAX_VALUE);if(We!==Number.MAX_VALUE)return We;{const qe=ke.scaleAndAdd([],h,p,z);if(LF(de,ge,we,Te,CF(qe[0],S[0],T[0]),CF(qe[1],S[1],T[1]))>=qe[2])return z}continue}let Z=0;for(let Y=0;Y<this._siblingOffset.length;Y++){PF((U<<1)+this._siblingOffset[Y][0],(W<<1)+this._siblingOffset[Y][1],j+1,t,r,l,u,S,T),S[2]=-100,T[2]=this.maximums[this.childOffsets[R]+Y]*g;const $=MF(S,T,h,p);if($!=null){const K=$;b[Y]=K;let ae=!1;for(let se=0;se<Z&&!ae;se++)K>=b[x[se]]&&(x.splice(se,0,Y),ae=!0);ae||(x[Z]=Y),Z++}}for(let Y=0;Y<Z;Y++){const $=x[Y];P.push({idx:this.childOffsets[R]+$,t:b[$],nodex:(U<<1)+this._siblingOffset[$][0],nodey:(W<<1)+this._siblingOffset[$][1],depth:j+1})}}return null}_addNode(t,r,l){return this.minimums.push(t),this.maximums.push(r),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,r,l,u,h){if(t[u].isLeaf(r,l)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const p=u-1,g=t[p];let v=0,b=0;for(let x=0;x<this._siblingOffset.length;x++){const S=2*r+this._siblingOffset[x][0],T=2*l+this._siblingOffset[x][1],P=g.getElevation(S,T),R=g.isLeaf(S,T),z=this._addNode(P.min,P.max,R);R&&(v|=1<<x),b||(b=z)}for(let x=0;x<this._siblingOffset.length;x++)v&1<<x||this._construct(t,2*r+this._siblingOffset[x][0],2*l+this._siblingOffset[x][1],p,b+x)}}function LF(i,t,r,l,u,h){return Ln(Ln(i,r,h),Ln(t,l,h),u)}function _f(i,t,r){const l=r.dim,u=ne(i*l-.5,0,l-1),h=ne(t*l-.5,0,l-1),p=Math.floor(u),g=Math.floor(h),v=Math.min(p+1,l-1),b=Math.min(g+1,l-1);return LF(r.get(p,g),r.get(v,g),r.get(p,b),r.get(v,b),u-p,h-g)}const RF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768],float:[1,1,1,1]};function oP(i,t,r){return(256*i*256+256*t+r)/10-1e4}function sP(i,t,r){return 256*i+t+r/256-32768}class _m{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,r,l,u,h=!1){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return ve(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const p=this.dim=r.height-2,g=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,this._modifiedForSources={},!h){for(let v=0;v<p;v++)g[this._idx(-1,v)]=g[this._idx(0,v)],g[this._idx(p,v)]=g[this._idx(p-1,v)],g[this._idx(v,-1)]=g[this._idx(v,0)],g[this._idx(v,p)]=g[this._idx(v,p-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(p,-1)]=g[this._idx(p-1,0)],g[this._idx(-1,p)]=g[this._idx(0,p-1)],g[this._idx(p,p)]=g[this._idx(p-1,p-1)]}if(u){const v=new Float32Array(r.data.buffer),b=this.encoding==="terrarium"?sP:oP;for(let x=0;x<g.length;++x){const S=4*x;v[x]=b(this.pixels[S],this.pixels[S+1],this.pixels[S+2])}this.encoding="float"}this._timestamp=Cn.now()}_buildQuadTree(){this._tree=new IF(this)}get(t,r,l=!1){l&&(t=ne(t,-1,this.dim),r=ne(r,-1,this.dim));const u=this._idx(t,r);if(this.encoding==="float")return this.floatView||(this.floatView=new Float32Array(this.pixels.buffer)),this.floatView[u];const h=4*u;return(this.encoding==="terrarium"?sP:oP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}set(t,r,l){const u=this._idx(t,r);if(this.encoding==="float"){this.floatView||(this.floatView=new Float32Array(this.pixels.buffer));const v=this.floatView[u];return this.floatView[u]=l,l-v}const h=4*u,p=(this.encoding==="terrarium"?sP:oP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2]),g=_m.pack(l,this.encoding==="terrarium"?"terrarium":"mapbox");return this.pixels[h]=g[0],this.pixels[h+1]=g[1],this.pixels[h+2]=g[2],l-p}static getUnpackVector(t){return RF[t]}get unpackVector(){return RF[this.encoding]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}static pack(t,r){const l=[0,0,0,0],u=_m.getUnpackVector(r);let h=Math.floor((t+u[3])/u[2]);return l[2]=h%256,h=Math.floor(h/256),l[1]=h%256,h=Math.floor(h/256),l[0]=h,l}getPixels(){return this.encoding==="float"?new uF({width:this.stride,height:this.stride},this.pixels):new $i({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,r,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,h=r*this.dim+this.dim,p=l*this.dim,g=l*this.dim+this.dim;switch(r){case-1:u=h-1;break;case 1:h=u+1}switch(l){case-1:p=g-1;break;case 1:g=p+1}const v=-r*this.dim,b=-l*this.dim;for(let x=p;x<g;x++)for(let S=u;S<h;S++){const T=4*this._idx(S,x),P=4*this._idx(S+v,x+b);this.pixels[T+0]=t.pixels[P+0],this.pixels[T+1]=t.pixels[P+1],this.pixels[T+2]=t.pixels[P+2],this.pixels[T+3]=t.pixels[P+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}un(_m,"DEMData"),un(IF,"DemMinMaxQuadTree",{omit:["dem"]});class jee{isDataAvailableAtPoint(t){const r=this._source();if(this.isUsingMockSource()||!r||t.y<0||t.y>1)return!1;const l=r.getSource().maxzoom,u=1<<l,h=Math.floor(t.x),p=Math.floor((t.x-h)*u),g=Math.floor(t.y*u),v=this.findDEMTileFor(new Ta(l,h,l,p,g));return!(!v||!v.dem)}getAtPointOrZero(t,r=0){return this.getAtPoint(t,r)||0}getAtPoint(t,r,l=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const u=this._source();if(!u||t.y<0||t.y>1)return r;const h=u.getSource().maxzoom,p=1<<h,g=Math.floor(t.x),v=t.x-g,b=new Ta(h,g,h,Math.floor(v*p),Math.floor(t.y*p)),x=this.findDEMTileFor(b);if(!x||!x.dem)return r;const S=x.dem,T=1<<x.tileID.canonical.z,P=(v*T-x.tileID.canonical.x)*S.dim,R=(t.y*T-x.tileID.canonical.y)*S.dim,z=Math.floor(P),U=Math.floor(R);return(l?this.exaggeration():1)*Ln(Ln(S.get(z,U),S.get(z,U+1),R-U),Ln(S.get(z+1,U),S.get(z+1,U+1),R-U),P-z)}getAtTileOffset(t,r,l){const u=1<<t.canonical.z;return this.getAtPointOrZero(new ga(t.wrap+(t.canonical.x+r/dt)/u,(t.canonical.y+l/dt)/u))}getAtTileOffsetFunc(t,r,l,u){return h=>{const p=this.getAtTileOffset(t,h.x,h.y),g=u.upVector(t.canonical,h.x,h.y),v=u.upVectorScale(t.canonical,r,l).metersToTile;return ke.scale(g,g,p*v),g}}getForTilePoints(t,r,l,u){if(this.isUsingMockSource())return!1;const h=iv.create(this,t,u);return!!h&&(r.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],l)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(t);if(!r||!r.dem)return null;const l=r.dem.tree,u=r.tileID,h=1<<t.canonical.z-u.canonical.z;let p=t.canonical.x/h-u.canonical.x,g=t.canonical.y/h-u.canonical.y,v=0;for(let b=0;b<t.canonical.z-u.canonical.z&&!l.leaves[v];b++){p*=2,g*=2;const x=2*Math.floor(g)+Math.floor(p);v=l.childOffsets[v]+x,p%=1,g%=1}return{min:this.exaggeration()*l.minimums[v],max:this.exaggeration()*l.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,r,l){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class iv{constructor(t,r,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=l}static create(t,r,l){const u=l||t.findDEMTileFor(r);if(!u||!u.dem)return;const h=u.dem,p=u.tileID,g=1<<r.canonical.z-p.canonical.z;return new iv(u,h.dim/dt/g,[(r.canonical.x/g-p.canonical.x)*h.dim,(r.canonical.y/g-p.canonical.y)*h.dim])}tileCoordToPixel(t,r){const l=r*this._scale+this._offset[1],u=Math.floor(t*this._scale+this._offset[0]),h=Math.floor(l);return new V(u,h)}getElevationAt(t,r,l,u){const h=t*this._scale+this._offset[0],p=r*this._scale+this._offset[1],g=Math.floor(h),v=Math.floor(p),b=this._dem;return u=!!u,l?Ln(Ln(b.get(g,v,u),b.get(g,v+1,u),p-v),Ln(b.get(g+1,v,u),b.get(g+1,v+1,u),p-v),h-g):b.get(g,v,u)}getElevationAtPixel(t,r,l){return this._dem.get(t,r,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*ja(1,t)*this._dem.stride}}class lP{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Kr(dt,16,0),this.featureIndexArray=new lO,this.promoteId=r}insert(t,r,l,u,h,p=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,u,h,p);const v=this.grid;for(let b=0;b<r.length;b++){const x=r[b],S=[1/0,1/0,-1/0,-1/0];for(let T=0;T<x.length;T++){const P=x[T];S[0]=Math.min(S[0],P.x),S[1]=Math.min(S[1],P.y),S[2]=Math.max(S[2],P.x),S[3]=Math.max(S[3],P.y)}S[0]<dt&&S[1]<dt&&S[2]>=0&&S[3]>=0&&v.insert(g,S[0],S[1],S[2],S[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new iP(new F2(this.rawTileData)).layers,this.sourceLayerCoder=new vF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,r,l,u){this.loadVTLayers();const h=t.params||{},p=tm(h.filter),g=t.tileResult,v=t.transform,b=g.bufferedTilespaceBounds,x=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(R,z,U,W)=>tF(g.bufferedTilespaceGeometry,R,z,U,W));x.sort($ee);let S=null;v.elevation&&x.length>0&&(S=iv.create(v.elevation,this.tileID));const T={};let P;for(let R=0;R<x.length;R++){const z=x[R];if(z===P)continue;P=z;const U=this.featureIndexArray.get(z);let W=null;this.loadMatchingFeature(T,U,p,h.layers,h.availableImages,r,l,u,(j,Z,Y,$=0)=>(W||(W=Wu(j,this.tileID.canonical,t.tileTransform)),Z.queryIntersectsFeature(g,j,Y,W,this.z,t.transform,t.pixelPosMatrix,S,$)))}return T}loadMatchingFeature(t,r,l,u,h,p,g,v,b){const{featureIndex:x,bucketIndex:S,sourceLayerIndex:T,layoutVertexArrayOffset:P}=r,R=this.bucketLayerIDs[S];if(u&&!function(j,Z){for(let Y=0;Y<j.length;Y++)if(Z.indexOf(j[Y])>=0)return!0;return!1}(u,R))return;const z=this.sourceLayerCoder.decode(T),U=this.vtLayers[z].feature(x);if(l.needGeometry){const j=yf(U,!0);if(!l.filter(new ii(this.tileID.overscaledZ),j,this.tileID.canonical))return}else if(!l.filter(new ii(this.tileID.overscaledZ),U))return;const W=this.getId(U,z);for(let j=0;j<R.length;j++){const Z=R[j];if(u&&u.indexOf(Z)<0)continue;const Y=p[Z];if(!Y)continue;let $={};W!==void 0&&v&&($=v.getState(Y.sourceLayer||"_geojsonTileLayer",W));const K=Ue({},g[Z]);K.paint=kF(K.paint,Y.paint,U,$,h),K.layout=kF(K.layout,Y.layout,U,$,h);const ae=!b||b(U,Y,$,P);if(!ae)continue;const se=new AF(U,this.z,this.x,this.y,W);se.layer=K;let de=t[Z];de===void 0&&(de=t[Z]=[]),de.push({featureIndex:x,feature:se,intersectionZ:ae})}}lookupSymbolFeatures(t,r,l,u,h,p,g,v){const b={};this.loadVTLayers();const x=tm(h);for(const S of t)this.loadMatchingFeature(b,{bucketIndex:l,sourceLayerIndex:u,featureIndex:S,layoutVertexArrayOffset:0},x,p,g,v,r);return b}loadFeature(t){const{featureIndex:r,sourceLayerIndex:l}=t;this.loadVTLayers();const u=this.sourceLayerCoder.decode(l),h=this.vtFeatures[u];if(h[r])return h[r];const p=this.vtLayers[u].feature(r);return h[r]=p,p}hasLayer(t){for(const r of this.bucketLayerIDs)for(const l of r)if(t===l)return!0;return!1}getId(t,r){let l=t.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];u!=null&&(l=t.properties[u]),typeof l=="boolean"&&(l=Number(l))}return l}}function kF(i,t,r,l,u){return St(i,(h,p)=>{const g=t instanceof Fu?t.get(p):null;return g&&g.evaluate?g.evaluate(r,l,u):g})}function $ee(i,t){return t-i}un(lP,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const qee=N([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xee=N([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Zee=N([{name:"a_projected_pos",components:4,type:"Float32"}],4);N([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Yee=N([{name:"a_z_offset",components:1,type:"Float32"}],4),Kee=N([{name:"a_texb",components:2,type:"Uint16"}]),Jee=N([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Qee=N([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);N([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const DF=N([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ete=N([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);N([{name:"triangle",components:3,type:"Uint16"}]),N([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),N([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),N([{type:"Float32",name:"offsetX"}]),N([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var to=24;const Vc=128;function cP(i,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new ii(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:u}=r;let h=0;for(;h<l.length&&l[h]<=i;)h++;h=Math.max(0,h-1);let p=h;for(;p<l.length&&l[p]<i+1;)p++;p=Math.min(l.length-1,p);const g=l[h],v=l[p];return r.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:v,minSize:r.evaluate(new ii(g)),maxSize:r.evaluate(new ii(v)),interpolationType:u}}}function n1(i,{uSize:t,uSizeT:r},{lowerSize:l,upperSize:u}){return i.kind==="source"?l/Vc:i.kind==="composite"?Ln(l/Vc,u/Vc,r):t}function Vu(i,t){let r=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:u,minZoom:h,maxZoom:p}=i,g=u?ne(ac.interpolationFactor(u,t,h,p),0,1):0;i.kind==="camera"?l=Ln(i.minSize,i.maxSize,g):r=g}return{uSizeT:r,uSize:l}}var tte=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Vc,evaluateSizeForFeature:n1,evaluateSizeForZoom:Vu,getSizeData:cP});function nte(i,t,r){return i.sections.forEach(l=>{l.text=function(u,h,p){const g=h.layout.get("text-transform").evaluate(p,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),Is.applyArabicShaping&&(u=Is.applyArabicShaping(u)),u}(l.text,t,r)}),i}const a1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function ate(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function ite(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}const uP=3;function rte(i,t,r){t.glyphs=[],i===1&&r.readMessage(ote,t)}function ote(i,t,r){if(i===3){const{id:l,bitmap:u,width:h,height:p,left:g,top:v,advance:b}=r.readMessage(ste,{});t.glyphs.push({id:l,bitmap:new Jd({width:h+2*uP,height:p+2*uP},u),metrics:{width:h,height:p,left:g,top:v,advance:b}})}else i===4?t.ascender=r.readSVarint():i===5&&(t.descender=r.readSVarint())}function ste(i,t,r){i===1?t.id=r.readVarint():i===2?t.bitmap=r.readBytes():i===3?t.width=r.readVarint():i===4?t.height=r.readVarint():i===5?t.left=r.readSVarint():i===6?t.top=r.readSVarint():i===7&&(t.advance=r.readVarint())}const OF=uP;function dP(i){let t=0,r=0;for(const p of i)t+=p.w*p.h,r=Math.max(r,p.w);i.sort((p,g)=>g.h-p.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let u=0,h=0;for(const p of i)for(let g=l.length-1;g>=0;g--){const v=l[g];if(!(p.w>v.w||p.h>v.h)){if(p.x=v.x,p.y=v.y,h=Math.max(h,p.y+p.h),u=Math.max(u,p.x+p.w),p.w===v.w&&p.h===v.h){const b=l.pop();g<l.length&&(l[g]=b)}else p.h===v.h?(v.x+=p.w,v.w-=p.w):p.w===v.w?(v.y+=p.h,v.h-=p.h):(l.push({x:v.x+p.w,y:v.y,w:v.w-p.w,h:p.h}),v.y+=p.h,v.h-=p.h);break}}return{w:u,h,fill:t/(u*h)||0}}const Ds=1;class hP{constructor(t,{pixelRatio:r,version:l,stretchX:u,stretchY:h,content:p}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=u,this.stretchY=h,this.content=p,this.version=l}get tl(){return[this.paddedRect.x+Ds,this.paddedRect.y+Ds]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ds,this.paddedRect.y+this.paddedRect.h-Ds]}get displaySize(){return[(this.paddedRect.w-2*Ds)/this.pixelRatio,(this.paddedRect.h-2*Ds)/this.pixelRatio]}}class zF{constructor(t,r){const l={},u={};this.haveRenderCallbacks=[];const h=[];this.addImages(t,l,h),this.addImages(r,u,h);const{w:p,h:g}=dP(h),v=new $i({width:p||1,height:g||1});for(const b in t){const x=t[b],S=l[b].paddedRect;$i.copy(x.data,v,{x:0,y:0},{x:S.x+Ds,y:S.y+Ds},x.data)}for(const b in r){const x=r[b],S=u[b].paddedRect,T=S.x+Ds,P=S.y+Ds,R=x.data.width,z=x.data.height;$i.copy(x.data,v,{x:0,y:0},{x:T,y:P},x.data),$i.copy(x.data,v,{x:0,y:z-1},{x:T,y:P-1},{width:R,height:1}),$i.copy(x.data,v,{x:0,y:0},{x:T,y:P+z},{width:R,height:1}),$i.copy(x.data,v,{x:R-1,y:0},{x:T-1,y:P},{width:1,height:z}),$i.copy(x.data,v,{x:0,y:0},{x:T+R,y:P},{width:1,height:z})}this.image=v,this.iconPositions=l,this.patternPositions=u}addImages(t,r,l){for(const u in t){const h=t[u],p={x:0,y:0,w:h.data.width+2*Ds,h:h.data.height+2*Ds};l.push(p),r[u]=new hP(p,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,r,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>t.hasImage(u,l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,l);for(const u in t.getUpdatedImages(l))this.patchUpdatedImage(this.iconPositions[u],t.getImage(u,l),r),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u,l),r)}patchUpdatedImage(t,r,l){if(!t||!r||t.version===r.version)return;t.version=r.version;const[u,h]=t.tl;l.update(r.data,void 0,{x:u,y:h})}}un(hP,"ImagePosition"),un(zF,"ImageAtlas");const _i={horizontal:1,vertical:2,horizontalOnly:3},FF=-17;class i1{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const l=new i1;return l.scale=t||1,l.fontStack=r,l}static forImage(t){const r=new i1;return r.imageName=t,r}}class rv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const l=new rv;for(let u=0;u<t.sections.length;u++){const h=t.sections[u];h.image?l.addImageSection(h):l.addTextSection(h,r)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(r,l){let u="";for(let h=0;h<r.length;h++){const p=r.charCodeAt(h+1)||null,g=r.charCodeAt(h-1)||null;u+=!l&&(p&&By(p)&&!a1[r[h+1]]||g&&By(g)&&!a1[r[h-1]])||!a1[r[h]]?r[h]:a1[r[h]]}return u}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&N2[this.text.charCodeAt(l)];l++)t++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&N2[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const l=new rv;return l.text=this.text.substring(t,r),l.sectionIndex=this.sectionIndex.slice(t,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(i1.forText(t.scale,t.fontStack||r));const l=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(l)}addImageSection(t){const r=t.image?t.image.namePrimary:"";if(r.length===0)return void ve("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCodePoint(l),this.sections.push(i1.forImage(r)),this.sectionIndex.push(this.sections.length-1)):ve("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fP(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R){const z=rv.fromFeature(i,u);S===_i.vertical&&z.verticalizePunctuation(T);let U=[];const W=function(K,ae,se,de,ge,Te){if(!K)return[];const we=[],Ie=function(Qe,Ne,Ve,at,mt,lt){let Ct=0;for(let zt=0;zt<Qe.length();zt++){const bt=Qe.getSection(zt);Ct+=NF(Qe.getCodePoint(zt),bt,at,mt,Ne,lt)}return Ct/Math.max(1,Math.ceil(Ct/Ve))}(K,ae,se,de,ge,Te),xe=K.text.indexOf("")>=0;let We=0;for(let Qe=0;Qe<K.length();Qe++){const Ne=K.getSection(Qe),Ve=K.getCodePoint(Qe);if(N2[Ve]||(We+=NF(Ve,Ne,de,ge,ae,Te)),Qe<K.length()-1){const at=!((qe=Ve)<11904||!(pn["Bopomofo Extended"](qe)||pn.Bopomofo(qe)||pn["CJK Compatibility Forms"](qe)||pn["CJK Compatibility Ideographs"](qe)||pn["CJK Compatibility"](qe)||pn["CJK Radicals Supplement"](qe)||pn["CJK Strokes"](qe)||pn["CJK Symbols and Punctuation"](qe)||pn["CJK Unified Ideographs Extension A"](qe)||pn["CJK Unified Ideographs"](qe)||pn["Enclosed CJK Letters and Months"](qe)||pn["Halfwidth and Fullwidth Forms"](qe)||pn.Hiragana(qe)||pn["Ideographic Description Characters"](qe)||pn["Kangxi Radicals"](qe)||pn["Katakana Phonetic Extensions"](qe)||pn.Katakana(qe)||pn["Vertical Forms"](qe)||pn["Yi Radicals"](qe)||pn["Yi Syllables"](qe)));(lte[Ve]||at||Ne.imageName)&&we.push(UF(Qe+1,We,Ie,we,cte(Ve,K.getCodePoint(Qe+1),at&&xe),!1))}}var qe;return WF(UF(K.length(),We,Ie,we,0,!0))}(z,b,h,t,l,P),{processBidirectionalText:j,processStyledBidirectionalText:Z}=Is;if(j&&z.sections.length===1){const K=j(z.toString(),W);for(const ae of K){const se=new rv;se.text=ae,se.sections=z.sections;for(let de=0;de<ae.length;de++)se.sectionIndex.push(0);U.push(se)}}else if(Z){const K=Z(z.text,z.sectionIndex,W);for(const ae of K){const se=new rv;se.text=ae[0],se.sectionIndex=ae[1],se.sections=z.sections,U.push(se)}}else U=function(K,ae){const se=[],de=K.text;let ge=0;for(const Te of ae)se.push(K.substring(ge,Te)),ge=Te;return ge<de.length&&se.push(K.substring(ge,de.length)),se}(z,W);const Y=[],$={positionedLines:Y,text:z.toString(),top:x[1],bottom:x[1],left:x[0],right:x[0],writingMode:S,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(K,ae,se,de,ge,Te,we,Ie,xe,We,qe,Qe){let Ne=0,Ve=0,at=0;const mt=Ie==="right"?1:Ie==="left"?0:.5;let lt=!1;for(const on of ge){const rn=on.getSections();for(const cn of rn){if(cn.imageName)continue;const gn=ae[cn.fontStack];if(gn&&(lt=gn.ascender!==void 0&&gn.descender!==void 0,!lt))break}if(!lt)break}let Ct=0;for(const on of ge){on.trim();const rn=on.getMaxScale(),cn=(rn-1)*to,gn={positionedGlyphs:[],lineOffset:0};K.positionedLines[Ct]=gn;const kn=gn.positionedGlyphs;let ea=0;if(!on.length()){Ve+=Te,++Ct;continue}let _a=0,$n=0;for(let In=0;In<on.length();In++){const En=on.getSection(In),da=on.getSectionIndex(In),Ea=on.getCodePoint(In);let Qn=En.scale,qa=null,bi=null,ri=null,Qa=to,ar=0;const xi=!(xe===_i.horizontal||!qe&&!Ny(Ea)||qe&&(N2[Ea]||(zt=Ea,pn.Arabic(zt)||pn["Arabic Supplement"](zt)||pn["Arabic Extended-A"](zt)||pn["Arabic Presentation Forms-A"](zt)||pn["Arabic Presentation Forms-B"](zt))));if(En.imageName){const Di=de[En.imageName];if(!Di)continue;ri=En.imageName,K.iconsInText=K.iconsInText||!0,bi=Di.paddedRect;const Xa=Di.displaySize;Qn=Qn*to/Qe,qa={width:Xa[0],height:Xa[1],left:Ds,top:-OF,advance:xi?Xa[1]:Xa[0],localGlyph:!1},ar=lt?-qa.height*Qn:FF+rn*to-Xa[1]*Qn,Qa=qa.advance;const ss=(xi?Xa[0]:Xa[1])*Qn-to*rn;ss>0&&ss>ea&&(ea=ss)}else{const Di=se[En.fontStack];if(!Di)continue;Di[Ea]&&(bi=Di[Ea]);const Xa=ae[En.fontStack];if(!Xa)continue;const ss=Xa.glyphs[Ea];if(!ss)continue;if(qa=ss.metrics,Qa=Ea!==8203?to:0,lt){const Zu=Xa.ascender!==void 0?Math.abs(Xa.ascender):0,th=Xa.descender!==void 0?Math.abs(Xa.descender):0,nh=(Zu+th)*Qn;_a<nh&&(_a=nh,$n=(Zu-th)/2*Qn),ar=-Zu*Qn}else ar=FF+(rn-Qn)*to}xi?(K.verticalizable=!0,kn.push({glyph:Ea,imageName:ri,x:Ne,y:Ve+ar,vertical:xi,scale:Qn,localGlyph:qa.localGlyph,fontStack:En.fontStack,sectionIndex:da,metrics:qa,rect:bi}),Ne+=Qa*Qn+We):(kn.push({glyph:Ea,imageName:ri,x:Ne,y:Ve+ar,vertical:xi,scale:Qn,localGlyph:qa.localGlyph,fontStack:En.fontStack,sectionIndex:da,metrics:qa,rect:bi}),Ne+=qa.advance*Qn+We)}kn.length!==0&&(at=Math.max(Ne-We,at),lt?VF(kn,mt,ea,$n,Te*rn/2):VF(kn,mt,ea,0,Te/2)),Ne=0;const Un=Te*rn+ea;gn.lineOffset=Math.max(ea,cn),Ve+=Un,++Ct}var zt;const bt=Ve,{horizontalAlign:Et,verticalAlign:en}=B2(we);(function(on,rn,cn,gn,kn,ea){const _a=(rn-cn)*kn,$n=-ea*gn;for(const Un of on)for(const In of Un.positionedGlyphs)In.x+=_a,In.y+=$n})(K.positionedLines,mt,Et,en,at,bt),K.top+=-en*bt,K.bottom=K.top+bt,K.left+=-Et*at,K.right=K.left+at,K.hasBaseline=lt}($,t,r,l,U,p,g,v,S,b,T,R),!function(K){for(const ae of K)if(ae.positionedGlyphs.length!==0)return!1;return!0}(Y)&&$}const N2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lte={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function NF(i,t,r,l,u,h){if(t.imageName){const p=l[t.imageName];return p?p.displaySize[0]*t.scale*to/h+u:0}{const p=r[t.fontStack],g=p&&p.glyphs[i];return g?g.metrics.advance*t.scale+u:0}}function BF(i,t,r,l){const u=Math.pow(i-t,2);return l?i<t?u/2:2*u:u+Math.abs(r)*r}function cte(i,t,r){let l=0;return i===10&&(l-=1e4),r&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function UF(i,t,r,l,u,h){let p=null,g=BF(t,r,u,h);for(const v of l){const b=BF(t-v.x,r,u,h)+v.badness;b<=g&&(p=v,g=b)}return{index:i,x:t,priorBreak:p,badness:g}}function WF(i){return i?WF(i.priorBreak).concat(i.index):[]}function B2(i){let t=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function VF(i,t,r,l,u){if(!(t||r||l||u))return;const h=i.length-1,p=i[h],g=(p.x+p.metrics.advance*p.scale)*t;for(let v=0;v<=h;v++)i[v].x-=g,i[v].y+=r+l+u}function ute(i,t,r,l){const{horizontalAlign:u,verticalAlign:h}=B2(l),p=r[0]-i.displaySize[0]*u,g=r[1]-i.displaySize[1]*h;return{imagePrimary:i,imageSecondary:t,top:g,bottom:g+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function GF(i,t,r,l,u,h){const p=i.imagePrimary;let g;if(p.content){const U=p.content,W=p.pixelRatio||1;g=[U[0]/W,U[1]/W,p.displaySize[0]-U[2]/W,p.displaySize[1]-U[3]/W]}const v=t.left*h,b=t.right*h;let x,S,T,P;r==="width"||r==="both"?(P=u[0]+v-l[3],S=u[0]+b+l[1]):(P=u[0]+(v+b-p.displaySize[0])/2,S=P+p.displaySize[0]);const R=t.top*h,z=t.bottom*h;return r==="height"||r==="both"?(x=u[1]+R-l[0],T=u[1]+z+l[2]):(x=u[1]+(R+z-p.displaySize[1])/2,T=x+p.displaySize[1]),{imagePrimary:p,imageSecondary:void 0,top:x,right:S,bottom:T,left:P,collisionPadding:g}}class eh extends V{constructor(t,r,l,u,h){super(t,r),this.angle=u,this.z=l,h!==void 0&&(this.segment=h)}clone(){return new eh(this.x,this.y,this.z,this.angle,this.segment)}}function HF(i,t,r,l,u){if(t.segment===void 0)return!0;let h=t,p=t.segment+1,g=0;for(;g>-r/2;){if(p--,p<0)return!1;g-=i[p].dist(h),h=i[p]}g+=i[p].dist(i[p+1]),p++;const v=[];let b=0;for(;g<r/2;){const x=i[p],S=i[p+1];if(!S)return!1;let T=i[p-1].angleTo(x)-x.angleTo(S);for(T=Math.abs((T+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:T}),b+=T;g-v[0].distance>l;)b-=v.shift().angleDelta;if(b>u)return!1;p++,g+=x.dist(S)}return!0}function jF(i){let t=0;for(let r=0;r<i.length-1;r++)t+=i[r].dist(i[r+1]);return t}function $F(i,t,r){return i?.6*t*r:0}function qF(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function dte(i,t,r,l,u,h){const p=$F(r,u,h),g=qF(r,l)*h;let v=0;const b=jF(i)/2;for(let x=0;x<i.length-1;x++){const S=i[x],T=i[x+1],P=S.dist(T);if(v+P>b){const R=(b-v)/P,z=Ln(S.x,T.x,R),U=Ln(S.y,T.y,R),W=new eh(z,U,0,T.angleTo(S),x);return!p||HF(i,W,g,p,t)?W:void 0}v+=P}}function hte(i,t,r,l,u,h,p,g,v){const b=$F(l,h,p),x=qF(l,u),S=x*p,T=i[0].x===0||i[0].x===v||i[0].y===0||i[0].y===v;return t-S<t/4&&(t=S+t/4),XF(i,T?t/2*g%t:(x/2+2*h)*p*g%t,t,b,r,S,T,!1,v)}function XF(i,t,r,l,u,h,p,g,v){const b=h/2,x=jF(i);let S=0,T=t-r,P=[];for(let R=0;R<i.length-1;R++){const z=i[R],U=i[R+1],W=z.dist(U),j=U.angleTo(z);for(;T+r<S+W;){T+=r;const Z=(T-S)/W,Y=Ln(z.x,U.x,Z),$=Ln(z.y,U.y,Z);if(Y>=0&&Y<v&&$>=0&&$<v&&T-b>=0&&T+b<=x){const K=new eh(Y,$,0,j,R);l&&!HF(i,K,h,l,u)||P.push(K)}}S+=W}return g||P.length||p||(P=XF(i,S/2,r,l,u,h,p,!0,v)),P}function ZF(i,t,r,l,u){const h=[];for(let p=0;p<i.length;p++){const g=i[p];let v;for(let b=0;b<g.length-1;b++){let x=g[b],S=g[b+1];x.x<t&&S.x<t||(x.x<t?x=new V(t,x.y+(t-x.x)/(S.x-x.x)*(S.y-x.y))._round():S.x<t&&(S=new V(t,x.y+(t-x.x)/(S.x-x.x)*(S.y-x.y))._round()),x.y<r&&S.y<r||(x.y<r?x=new V(x.x+(r-x.y)/(S.y-x.y)*(S.x-x.x),r)._round():S.y<r&&(S=new V(x.x+(r-x.y)/(S.y-x.y)*(S.x-x.x),r)._round()),x.x>=l&&S.x>=l||(x.x>=l?x=new V(l,x.y+(l-x.x)/(S.x-x.x)*(S.y-x.y))._round():S.x>=l&&(S=new V(l,x.y+(l-x.x)/(S.x-x.x)*(S.y-x.y))._round()),x.y>=u&&S.y>=u||(x.y>=u?x=new V(x.x+(u-x.y)/(S.y-x.y)*(S.x-x.x),u)._round():S.y>=u&&(S=new V(x.x+(u-x.y)/(S.y-x.y)*(S.x-x.x),u)._round()),v&&x.equals(v[v.length-1])||(v=[x],h.push(v)),v.push(S)))))}}return h}un(eh,"Anchor");const r1=1e20;function YF(i,t,r,l,u,h,p,g,v){for(let b=t;b<t+l;b++)KF(i,r*h+b,h,u,p,g,v);for(let b=r;b<r+u;b++)KF(i,b*h+t,1,l,p,g,v)}function KF(i,t,r,l,u,h,p){h[0]=0,p[0]=-r1,p[1]=r1,u[0]=i[t];for(let g=1,v=0,b=0;g<l;g++){u[g]=i[t+g*r];const x=g*g;do{const S=h[v];b=(u[g]-u[S]+x-S*S)/(g-S)/2}while(b<=p[v]&&--v>-1);v++,h[v]=g,p[v]=b,p[v+1]=r1}for(let g=0,v=0;g<l;g++){for(;p[v+1]<g;)v++;const b=h[v],x=g-b;i[t+g*r]=u[b]+x*x}}const Gc=2;class ov{constructor(t,r,l){this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=l,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,r){this.urls[r]=t}getGlyphs(t,r,l){const u=[],h=this.urls[r]||w.GLYPHS_URL;for(const p in t)for(const g of t[p])u.push({stack:p,id:g});Xe(u,({stack:p,id:g},v)=>{let b=this.entries[p];b||(b=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let x=b.glyphs[g];if(x!==void 0)return void v(null,{stack:p,id:g,glyph:x});if(x=this._tinySDF(b,p,g),x)return b.glyphs[g]=x,void v(null,{stack:p,id:g,glyph:x});const S=Math.floor(g/256);if(256*S>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[S])return void v(null,{stack:p,id:g,glyph:x});let T=b.requests[S];T||(T=b.requests[S]=[],ov.loadGlyphRange(p,S,h,this.requestManager,(P,R)=>{if(R){b.ascender=R.ascender,b.descender=R.descender;for(const z in R.glyphs)this._doesCharSupportLocalGlyph(+z)||(b.glyphs[+z]=R.glyphs[+z]);b.ranges[S]=!0}for(const z of T)z(P,R);delete b.requests[S]})),T.push((P,R)=>{P?v(P):R&&v(null,{stack:p,id:g,glyph:R.glyphs[g]||null})})},(p,g)=>{if(p)l(p);else if(g){const v={};for(const{stack:b,id:x,glyph:S}of g)v[b]===void 0&&(v[b]={}),v[b].glyphs===void 0&&(v[b].glyphs={}),v[b].glyphs[x]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;l(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(pn["CJK Unified Ideographs"](t)||pn["Hangul Syllables"](t)||pn.Hiragana(t)||pn.Katakana(t)||pn["CJK Symbols and Punctuation"](t)||pn["CJK Unified Ideographs Extension A"](t)||pn["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,r,l){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let h=t.tinySDF;if(!h){let z="400";/bold/i.test(r)?z="900":/medium/i.test(r)?z="500":/light/i.test(r)&&(z="200"),h=t.tinySDF=new ov.TinySDF({fontFamily:u,fontWeight:z,fontSize:24*Gc,buffer:3*Gc,radius:8*Gc}),h.fontWeight=z}if(this.localGlyphs[h.fontWeight][l])return this.localGlyphs[h.fontWeight][l];const p=String.fromCodePoint(l),{data:g,width:v,height:b,glyphWidth:x,glyphHeight:S,glyphLeft:T,glyphTop:P,glyphAdvance:R}=h.draw(p);return this.localGlyphs[h.fontWeight][l]={id:l,bitmap:new Jd({width:v,height:b},g),metrics:{width:x/Gc,height:S/Gc,left:T/Gc,top:P/Gc-27,advance:R/Gc,localGlyph:!0}}}}ov.loadGlyphRange=function(i,t,r,l,u){const h=256*t,p=h+255,g=l.transformRequest(l.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${h}-${p}`),Se.Glyphs);yt(g,(v,b)=>{if(v)u(v);else if(b){const x={},S=function(T){return new F2(T).readFields(rte,{})}(b);for(const T of S.glyphs)x[T.id]=T;u(null,{glyphs:x,ascender:S.ascender,descender:S.descender})}})},ov.TinySDF=class{constructor({fontSize:i=24,buffer:t=3,radius:r=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:h="normal",fontStyle:p="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=r;const g=this.size=i+4*t,v=this._createCanvas(g),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${p} ${h} ${i}px ${u}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(i){const t=document.createElement("canvas");return t.width=t.height=i,t}draw(i){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:h}=this.ctx.measureText(i),p=Math.ceil(r),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-u))),v=Math.min(this.size-this.buffer,p+Math.ceil(l)),b=g+2*this.buffer,x=v+2*this.buffer,S=Math.max(b*x,0),T=new Uint8ClampedArray(S),P={data:T,width:b,height:x,glyphWidth:g,glyphHeight:v,glyphTop:p,glyphLeft:0,glyphAdvance:t};if(g===0||v===0)return P;const{ctx:R,buffer:z,gridInner:U,gridOuter:W}=this;R.clearRect(z,z,g,v),R.fillText(i,z,z+p);const j=R.getImageData(z,z,g,v);W.fill(r1,0,S),U.fill(0,0,S);for(let Z=0;Z<v;Z++)for(let Y=0;Y<g;Y++){const $=j.data[4*(Z*g+Y)+3]/255;if($===0)continue;const K=(Z+z)*b+Y+z;if($===1)W[K]=0,U[K]=r1;else{const ae=.5-$;W[K]=ae>0?ae*ae:0,U[K]=ae<0?ae*ae:0}}YF(W,0,0,b,x,b,this.f,this.v,this.z),YF(U,z,z,g,v,b,this.f,this.v,this.z);for(let Z=0;Z<S;Z++){const Y=Math.sqrt(W[Z])-Math.sqrt(U[Z]);T[Z]=Math.round(255-255*(Y/this.radius+this.cutoff))}return P}};const bf=Ds;function JF(i,t,r,l){const u=[],h=i.imagePrimary,p=h.pixelRatio,g=h.paddedRect.w-2*bf,v=h.paddedRect.h-2*bf,b=i.right-i.left,x=i.bottom-i.top,S=h.stretchX||[[0,g]],T=h.stretchY||[[0,v]],P=(Te,we)=>Te+we[1]-we[0],R=S.reduce(P,0),z=T.reduce(P,0),U=g-R,W=v-z;let j=0,Z=R,Y=0,$=z,K=0,ae=U,se=0,de=W;if(h.content&&l){const Te=h.content;j=U2(S,0,Te[0]),Y=U2(T,0,Te[1]),Z=U2(S,Te[0],Te[2]),$=U2(T,Te[1],Te[3]),K=Te[0]-j,se=Te[1]-Y,ae=Te[2]-Te[0]-Z,de=Te[3]-Te[1]-$}const ge=(Te,we,Ie,xe)=>{const We=W2(Te.stretch-j,Z,b,i.left),qe=V2(Te.fixed-K,ae,Te.stretch,R),Qe=W2(we.stretch-Y,$,x,i.top),Ne=V2(we.fixed-se,de,we.stretch,z),Ve=W2(Ie.stretch-j,Z,b,i.left),at=V2(Ie.fixed-K,ae,Ie.stretch,R),mt=W2(xe.stretch-Y,$,x,i.top),lt=V2(xe.fixed-se,de,xe.stretch,z),Ct=new V(We,Qe),zt=new V(Ve,Qe),bt=new V(Ve,mt),Et=new V(We,mt),en=new V(qe/p,Ne/p),on=new V(at/p,lt/p),rn=t*Math.PI/180;if(rn){const $n=Math.sin(rn),Un=Math.cos(rn),In=[Un,-$n,$n,Un];Ct._matMult(In),zt._matMult(In),Et._matMult(In),bt._matMult(In)}const cn=Te.stretch+Te.fixed,gn=Ie.stretch+Ie.fixed,kn=we.stretch+we.fixed,ea=xe.stretch+xe.fixed,_a=i.imageSecondary;return{tl:Ct,tr:zt,bl:Et,br:bt,texPrimary:{x:h.paddedRect.x+bf+cn,y:h.paddedRect.y+bf+kn,w:gn-cn,h:ea-kn},texSecondary:_a?{x:_a.paddedRect.x+bf+cn,y:_a.paddedRect.y+bf+kn,w:gn-cn,h:ea-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:en,pixelOffsetBR:on,minFontScaleX:ae/p/b,minFontScaleY:de/p/x,isSDF:r}};if(l&&(h.stretchX||h.stretchY)){const Te=QF(S,U,R),we=QF(T,W,z);for(let Ie=0;Ie<Te.length-1;Ie++){const xe=Te[Ie],We=Te[Ie+1];for(let qe=0;qe<we.length-1;qe++)u.push(ge(xe,we[qe],We,we[qe+1]))}}else u.push(ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return u}function U2(i,t,r){let l=0;for(const u of i)l+=Math.max(t,Math.min(r,u[1]))-Math.max(t,Math.min(r,u[0]));return l}function QF(i,t,r){const l=[{fixed:-bf,stretch:0}];for(const[u,h]of i){const p=l[l.length-1];l.push({fixed:u-p.stretch,stretch:p.stretch}),l.push({fixed:u-p.stretch,stretch:p.stretch+(h-u)})}return l.push({fixed:t+bf,stretch:r}),l}function W2(i,t,r,l){return i/t*r+l}function V2(i,t,r,l){return i-t*r/l}function fte(i,t,r,l){const u=t+i.positionedLines[l].lineOffset;return l===0?r+u/2:r+(u+(t+i.positionedLines[l-1].lineOffset))/2}function pte(i,t=1,r=!1){let l=1/0,u=1/0,h=-1/0,p=-1/0;const g=i[0];for(let P=0;P<g.length;P++){const R=g[P];(!P||R.x<l)&&(l=R.x),(!P||R.y<u)&&(u=R.y),(!P||R.x>h)&&(h=R.x),(!P||R.y>p)&&(p=R.y)}const v=Math.min(h-l,p-u);let b=v/2;const x=new Pd([],mte);if(v===0)return new V(l,u);for(let P=l;P<h;P+=v)for(let R=u;R<p;R+=v)x.push(new sv(P+b,R+b,b,i));let S=function(P){let R=0,z=0,U=0;const W=P[0];for(let j=0,Z=W.length,Y=Z-1;j<Z;Y=j++){const $=W[j],K=W[Y],ae=$.x*K.y-K.x*$.y;z+=($.x+K.x)*ae,U+=($.y+K.y)*ae,R+=3*ae}return new sv(z/R,U/R,0,P)}(i),T=x.length;for(;x.length;){const P=x.pop();(P.d>S.d||!S.d)&&(S=P,r&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,T)),P.max-S.d<=t||(b=P.h/2,x.push(new sv(P.p.x-b,P.p.y-b,b,i)),x.push(new sv(P.p.x+b,P.p.y-b,b,i)),x.push(new sv(P.p.x-b,P.p.y+b,b,i)),x.push(new sv(P.p.x+b,P.p.y+b,b,i)),T+=4)}return r&&(console.log(`num probes: ${T}`),console.log(`best distance: ${S.d}`)),S.p}function mte(i,t){return t.max-i.max}class sv{constructor(t,r,l,u){this.p=new V(t,r),this.h=l,this.d=function(h,p){let g=!1,v=1/0;for(let b=0;b<p.length;b++){const x=p[b];for(let S=0,T=x.length,P=T-1;S<T;P=S++){const R=x[S],z=x[P];R.y>h.y!=z.y>h.y&&h.x<(z.x-R.x)*(h.y-R.y)/(z.y-R.y)+R.x&&(g=!g),v=Math.min(v,Qz(h,R,z))}}return(g?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const lv=7,pP=Number.POSITIVE_INFINITY,gte=Math.sqrt(2);function mP(i,[t,r]){let l=0,u=0;if(r===pP){t<0&&(t=0);const h=t/gte;switch(i){case"top-right":case"top-left":u=h-lv;break;case"bottom-right":case"bottom-left":u=-h+lv;break;case"bottom":u=-t+lv;break;case"top":u=t-lv}switch(i){case"top-right":case"bottom-right":l=-h;break;case"top-left":case"bottom-left":l=h;break;case"left":l=t;break;case"right":l=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),i){case"top-right":case"top-left":case"top":u=r-lv;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+lv}switch(i){case"top-right":case"bottom-right":case"right":l=-t;break;case"top-left":case"bottom-left":case"left":l=t}}return[l,u]}function yte(i,t,r,l,u,h,p,g,v,b,x){i.createArrays(),i.tilePixelRatio=dt/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const S=i.layers[0].layout,T=i.layers[0]._unevaluatedLayout._values,P={};if(i.textSizeData.kind==="composite"){const{minZoom:W,maxZoom:j}=i.textSizeData;P.compositeTextSizes=[T["text-size"].possiblyEvaluate(new ii(W),g),T["text-size"].possiblyEvaluate(new ii(j),g)]}if(i.iconSizeData.kind==="composite"){const{minZoom:W,maxZoom:j}=i.iconSizeData;P.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new ii(W),g),T["icon-size"].possiblyEvaluate(new ii(j),g)]}P.layoutTextSize=T["text-size"].possiblyEvaluate(new ii(v+1),g),P.layoutIconSize=T["icon-size"].possiblyEvaluate(new ii(v+1),g),P.textMaxSize=T["text-size"].possiblyEvaluate(new ii(18),g);const R=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",z=S.get("text-size");let U=!1;for(const W of i.features)if(W.icon&&W.icon.nameSecondary){U=!0;break}for(const W of i.features){const j=S.get("text-font").evaluate(W,{},g).join(","),Z=z.evaluate(W,{},g),Y=P.layoutTextSize.evaluate(W,{},g),$=(P.layoutIconSize.evaluate(W,{},g),{horizontal:{},vertical:void 0}),K=W.text;let ae,se=[0,0];if(K){const Te=K.toString(),we=S.get("text-letter-spacing").evaluate(W,{},g)*to,Ie=S.get("text-line-height").evaluate(W,{},g)*to,xe=Vd(Te)?we:0,We=S.get("text-anchor").evaluate(W,{},g),qe=S.get("text-variable-anchor");if(!qe){const mt=S.get("text-radial-offset").evaluate(W,{},g);se=mt?mP(We,[mt*to,pP]):S.get("text-offset").evaluate(W,{},g).map(lt=>lt*to)}let Qe=R?"center":S.get("text-justify").evaluate(W,{},g);const Ne=S.get("symbol-placement")==="point",Ve=Ne?S.get("text-max-width").evaluate(W,{},g)*to:1/0,at=mt=>{i.allowVerticalPlacement&&dm(Te)&&($.vertical=fP(K,t,r,u,j,Ve,Ie,We,mt,xe,se,_i.vertical,!0,Y,Z))};if(!R&&qe){const mt=Qe==="auto"?qe.map(Ct=>gP(Ct)):[Qe];let lt=!1;for(let Ct=0;Ct<mt.length;Ct++){const zt=mt[Ct];if(!$.horizontal[zt])if(lt)$.horizontal[zt]=$.horizontal[0];else{const bt=fP(K,t,r,u,j,Ve,Ie,"center",zt,xe,se,_i.horizontal,!1,Y,Z);bt&&($.horizontal[zt]=bt,lt=bt.positionedLines.length===1)}}at("left")}else{if(Qe==="auto"&&(Qe=gP(We)),Ne||S.get("text-writing-mode").indexOf("horizontal")>=0||!dm(Te)){const mt=fP(K,t,r,u,j,Ve,Ie,We,Qe,xe,se,_i.horizontal,!1,Y,Z);mt&&($.horizontal[Qe]=mt)}at(Ne?"left":Qe)}}let de=!1;if(W.icon&&W.icon.namePrimary){const Te=l[W.icon.namePrimary];Te&&(ae=ute(u[W.icon.namePrimary],W.icon.nameSecondary?u[W.icon.nameSecondary]:void 0,S.get("icon-offset").evaluate(W,{},g),S.get("icon-anchor").evaluate(W,{},g)),de=Te.sdf,i.sdfIcons===void 0?i.sdfIcons=Te.sdf:i.sdfIcons!==Te.sdf&&ve("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Te.pixelRatio!==i.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const ge=tN($.horizontal)||$.vertical;i.iconsInText||(i.iconsInText=!!ge&&ge.iconsInText),(ge||ae)&&vte(i,W,$,ae,l,P,Y,0,se,de,p,g,b,x,U)}h&&i.generateCollisionDebugBuffers(v,i.collisionBoxArray)}function gP(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function vte(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R){let z=h.textMaxSize.evaluate(t,{},S);z===void 0&&(z=p);const U=i.layers[0].layout,W=U.get("icon-offset").evaluate(t,{},S),j=tN(r.horizontal)||r.vertical,Z=T.name==="globe",Y=to,$=p/Y,K=i.tilePixelRatio*z/Y,ae=(We=i.overscaling,i.zoom>18&&We>2&&(We>>=1),Math.max(dt/(512*We),1)*U.get("symbol-spacing")),se=U.get("text-padding")*i.tilePixelRatio,de=U.get("icon-padding")*i.tilePixelRatio,ge=be(U.get("text-max-angle")),Te=U.get("text-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",we=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Ie=U.get("symbol-placement"),xe=ae/2;var We;const qe=U.get("icon-text-fit").evaluate(t,{},S),Qe=U.get("icon-text-fit-padding").evaluate(t,{},S),Ne=qe!=="none";let Ve;i.hasAnyIconTextFit===!1&&Ne&&(i.hasAnyIconTextFit=!0),l&&Ne&&(i.allowVerticalPlacement&&r.vertical&&(Ve=GF(l,r.vertical,qe,Qe,W,$)),j&&(l=GF(l,j,qe,Qe,W,$)));const at=(mt,lt,Ct)=>{if(lt.x<0||lt.x>=dt||lt.y<0||lt.y>=dt)return;let zt=null;if(Z){const{x:bt,y:Et,z:en}=T.projectTilePoint(lt.x,lt.y,Ct);zt={anchor:new eh(bt,Et,en,0,void 0),up:T.upVector(Ct,lt.x,lt.y)}}(function(bt,Et,en,on,rn,cn,gn,kn,ea,_a,$n,Un,In,En,da,Ea,Qn,qa,bi,ri,Qa,ar,xi,Di,Xa,ss,Zu){const th=bt.addToLineVertexArray(Et,on);let nh,P1,I1,z3,s9,l9,c9,u9=0,d9=0,h9=0,f9=0,g5=-1,y5=-1;const Yu={};let p9=pC("");const Cm=en?en.anchor:Et,v5=ea.layout.get("icon-text-fit").evaluate(Qa,{},Xa)!=="none";let _5=0,b5=0;if(ea._unevaluatedLayout.getValue("text-radial-offset")===void 0?[_5,b5]=ea.layout.get("text-offset").evaluate(Qa,{},Xa).map(ol=>ol*to):(_5=ea.layout.get("text-radial-offset").evaluate(Qa,{},Xa)*to,b5=pP),bt.allowVerticalPlacement&&rn.vertical){const ol=rn.vertical;if(da)l9=yP(ol),kn&&(c9=yP(kn));else{const sl=ea.layout.get("text-rotate").evaluate(Qa,{},Xa)+90;I1=G2(_a,Cm,Et,$n,Un,In,ol,En,sl,Ea),kn&&(z3=G2(_a,Cm,Et,$n,Un,In,kn,qa,sl))}}if(cn){const ol=ea.layout.get("icon-rotate").evaluate(Qa,{},Xa),sl=JF(cn,ol,xi,v5),_v=kn?JF(kn,ol,xi,v5):void 0;P1=G2(_a,Cm,Et,$n,Un,In,cn,qa,ol),u9=4*sl.length;const m9=bt.iconSizeData;let Pm=null;m9.kind==="source"?(Pm=[Vc*ea.layout.get("icon-size").evaluate(Qa,{},Xa)],Pm[0]>xf&&ve(`${bt.layerIds[0]}: Value for "icon-size" is >= ${o1}. Reduce your "icon-size".`)):m9.kind==="composite"&&(Pm=[Vc*ar.compositeIconSizes[0].evaluate(Qa,{},Xa),Vc*ar.compositeIconSizes[1].evaluate(Qa,{},Xa)],(Pm[0]>xf||Pm[1]>xf)&&ve(`${bt.layerIds[0]}: Value for "icon-size" is >= ${o1}. Reduce your "icon-size".`)),bt.addSymbols(bt.icon,sl,Pm,ri,bi,Qa,!1,en,Et,th.lineStartIndex,th.lineLength,-1,Di,Xa,ss,Zu),g5=bt.icon.placedSymbolArray.length-1,_v&&(d9=4*_v.length,bt.addSymbols(bt.icon,_v,Pm,ri,bi,Qa,_i.vertical,en,Et,th.lineStartIndex,th.lineLength,-1,Di,Xa,ss,Zu),y5=bt.icon.placedSymbolArray.length-1)}for(const ol in rn.horizontal){const sl=rn.horizontal[ol];nh||(p9=pC(sl.text),da?s9=yP(sl):nh=G2(_a,Cm,Et,$n,Un,In,sl,En,ea.layout.get("text-rotate").evaluate(Qa,{},Xa),Ea));const _v=sl.positionedLines.length===1;if(h9+=eN(bt,en,Et,sl,gn,ea,da,Qa,Ea,th,rn.vertical?_i.horizontal:_i.horizontalOnly,_v?Object.keys(rn.horizontal):[ol],Yu,g5,ar,Di,Xa,ss),_v)break}rn.vertical&&(f9+=eN(bt,en,Et,rn.vertical,gn,ea,da,Qa,Ea,th,_i.vertical,["vertical"],Yu,y5,ar,Di,Xa,ss));let Pf=-1;const x5=(ol,sl)=>ol?Math.max(ol,sl):sl;Pf=x5(s9,Pf),Pf=x5(l9,Pf),Pf=x5(c9,Pf);const eoe=Pf>-1?1:0;bt.glyphOffsetArray.length>=d1.MAX_GLYPHS&&ve("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Qa.sortKey!==void 0&&bt.addToSortKeyRanges(bt.symbolInstances.length,Qa.sortKey),bt.symbolInstances.emplaceBack(Et.x,Et.y,Cm.x,Cm.y,Cm.z,Yu.right>=0?Yu.right:-1,Yu.center>=0?Yu.center:-1,Yu.left>=0?Yu.left:-1,Yu.vertical>=0?Yu.vertical:-1,g5,y5,p9,nh!==void 0?nh:bt.collisionBoxArray.length,nh!==void 0?nh+1:bt.collisionBoxArray.length,I1!==void 0?I1:bt.collisionBoxArray.length,I1!==void 0?I1+1:bt.collisionBoxArray.length,P1!==void 0?P1:bt.collisionBoxArray.length,P1!==void 0?P1+1:bt.collisionBoxArray.length,z3||bt.collisionBoxArray.length,z3?z3+1:bt.collisionBoxArray.length,$n,h9,f9,u9,d9,eoe,0,_5,b5,Pf,0,v5?1:0)})(i,lt,zt,mt,r,l,u,Ve,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,se,Te,v,0,de,we,W,t,h,b,x,S,P,R)};if(Ie==="line")for(const mt of ZF(t.geometry,0,0,dt,dt)){const lt=hte(mt,ae,ge,r.vertical||j,l,Y,K,i.overscaling,dt);for(const Ct of lt)j&&_te(i,j.text,xe,Ct)||at(mt,Ct,S)}else if(Ie==="line-center"){for(const mt of t.geometry)if(mt.length>1){const lt=dte(mt,ge,r.vertical||j,l,Y,K);lt&&at(mt,lt,S)}}else if(t.type==="Polygon")for(const mt of tP(t.geometry,0)){const lt=pte(mt,16);at(mt[0],new eh(lt.x,lt.y,0,0,void 0),S)}else if(t.type==="LineString")for(const mt of t.geometry)at(mt,new eh(mt[0].x,mt[0].y,0,0,void 0),S);else if(t.type==="Point")for(const mt of t.geometry)for(const lt of mt)at([lt],new eh(lt.x,lt.y,0,0,void 0),S)}const o1=255,xf=o1*Vc;function eN(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W){const j=function($,K,ae,se,de,ge,Te,we){const Ie=[];if(K.positionedLines.length===0)return Ie;const xe=se.layout.get("text-rotate").evaluate(ge,{})*Math.PI/180,We=function(at){const mt=at[0],lt=at[1],Ct=mt*lt;return Ct>0?[mt,-lt]:Ct<0?[-mt,lt]:mt===0?[lt,mt]:[lt,-mt]}(ae);let qe=Math.abs(K.top-K.bottom);for(const at of K.positionedLines)qe-=at.lineOffset;const Qe=K.positionedLines.length,Ne=qe/Qe;let Ve=K.top-ae[1];for(let at=0;at<Qe;++at){const mt=K.positionedLines[at];Ve=fte(K,Ne,Ve,at);for(const lt of mt.positionedGlyphs){if(!lt.rect)continue;const Ct=lt.rect||{};let zt=OF+1,bt=!0,Et=1,en=0;if(lt.imageName){const ri=Te[lt.imageName];if(!ri)continue;if(ri.sdf){ve("SDF images are not supported in formatted text and will be ignored.");continue}bt=!1,Et=ri.pixelRatio,zt=Ds/Et}const on=(de||we)&&lt.vertical,rn=lt.metrics.advance*lt.scale/2,cn=lt.metrics,gn=lt.rect;if(gn===null)continue;we&&K.verticalizable&&(en=lt.imageName?rn-lt.metrics.width*lt.scale/2:0);const kn=de?[lt.x+rn,lt.y]:[0,0];let ea=[0,0],_a=[0,0],$n=!1;de||(on?(_a=[lt.x+rn+We[0],lt.y+We[1]-en],$n=!0):ea=[lt.x+rn+ae[0],lt.y+ae[1]-en]);const Un=gn.w*lt.scale/(Et*(lt.localGlyph?Gc:1)),In=gn.h*lt.scale/(Et*(lt.localGlyph?Gc:1));let En,da,Ea,Qn;if(on){const ri=lt.y-Ve,Qa=new V(-rn,rn-ri),ar=-Math.PI/2,xi=new V(..._a);En=new V(-rn+ea[0],ea[1]),En._rotateAround(ar,Qa)._add(xi),En.x+=-ri+rn,En.y-=(cn.left-zt)*lt.scale;const Di=lt.imageName?cn.advance*lt.scale:to*lt.scale,Xa=String.fromCodePoint(lt.glyph);ate(Xa)?En.x+=(1-zt)*lt.scale:ite(Xa)?En.x+=Di-cn.height*lt.scale+(-zt-1)*lt.scale:En.x+=lt.imageName||cn.width+2*zt===gn.w&&cn.height+2*zt===gn.h?(Di-In)/2:(Di-(cn.height+2*zt)*lt.scale)/2,da=new V(En.x,En.y-Un),Ea=new V(En.x+In,En.y),Qn=new V(En.x+In,En.y-Un)}else{const ri=(cn.left-zt)*lt.scale-rn+ea[0],Qa=(-cn.top-zt)*lt.scale+ea[1],ar=ri+Un,xi=Qa+In;En=new V(ri,Qa),da=new V(ar,Qa),Ea=new V(ri,xi),Qn=new V(ar,xi)}if(xe){let ri;ri=de?new V(0,0):$n?new V(We[0],We[1]):new V(ae[0],ae[1]),En._rotateAround(xe,ri),da._rotateAround(xe,ri),Ea._rotateAround(xe,ri),Qn._rotateAround(xe,ri)}const qa=new V(0,0),bi=new V(0,0);Ie.push({tl:En,tr:da,bl:Ea,br:Qn,texPrimary:Ct,texSecondary:void 0,writingMode:K.writingMode,glyphOffset:kn,sectionIndex:lt.sectionIndex,isSDF:bt,pixelOffsetTL:qa,pixelOffsetBR:bi,minFontScaleX:0,minFontScaleY:0})}}return Ie}(0,l,v,h,p,g,u,i.allowVerticalPlacement),Z=i.textSizeData;let Y=null;Z.kind==="source"?(Y=[Vc*h.layout.get("text-size").evaluate(g,{},U)],Y[0]>xf&&ve(`${i.layerIds[0]}: Value for "text-size" is >= ${o1}. Reduce your "text-size".`)):Z.kind==="composite"&&(Y=[Vc*R.compositeTextSizes[0].evaluate(g,{},U),Vc*R.compositeTextSizes[1].evaluate(g,{},U)],(Y[0]>xf||Y[1]>xf)&&ve(`${i.layerIds[0]}: Value for "text-size" is >= ${o1}. Reduce your "text-size".`)),i.addSymbols(i.text,j,Y,v,p,g,x,t,r,b.lineStartIndex,b.lineLength,P,z,U,W,!1);for(const $ of S)T[$]=i.text.placedSymbolArray.length-1;return 4*j.length}function tN(i){for(const t in i)return i[t];return null}function G2(i,t,r,l,u,h,p,g,v,b){let x=p.top,S=p.bottom,T=p.left,P=p.right;const R=p.collisionPadding;if(R&&(T-=R[0],x-=R[1],P+=R[2],S+=R[3]),v){const z=new V(T,x),U=new V(P,x),W=new V(T,S),j=new V(P,S),Z=be(v);let Y=new V(0,0);b&&(Y=new V(b[0],b[1])),z._rotateAround(Z,Y),U._rotateAround(Z,Y),W._rotateAround(Z,Y),j._rotateAround(Z,Y),T=Math.min(z.x,U.x,W.x,j.x),P=Math.max(z.x,U.x,W.x,j.x),x=Math.min(z.y,U.y,W.y,j.y),S=Math.max(z.y,U.y,W.y,j.y)}return i.emplaceBack(t.x,t.y,t.z,r.x,r.y,T,x,P,S,g,l,u,h),i.length-1}function yP(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const t=i.bottom-i.top;return t>0?Math.max(10,t):null}function _te(i,t,r,l){const u=i.compareText;if(t in u){const h=u[t];for(let p=h.length-1;p>=0;p--)if(l.dist(h[p])<r)return!0}else u[t]=[];return u[t].push(l),!1}function nN(i,t){const r=i.fovAboveCenter,l=i.elevation?i.elevation.getMinElevationBelowMSL()*t:0,u=(i._camera.position[2]*i.worldSize-l)/Math.cos(i._pitch),h=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-i._pitch-r,.01)),p=Math.sin(i._pitch)*h+u;return Math.min(1.01*p,u*(1/i._horizonShift))}function bm(i,t){if(!t.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:t};const r=Math.pow(2,-i.z),l=i.x*r,u=(i.x+1)*r,h=i.y*r,p=(i.y+1)*r,g=il(l),v=il(u),b=pr(h),x=pr(p),S=t.project(g,b),T=t.project(v,b),P=t.project(v,x),R=t.project(g,x);let z=Math.min(S.x,T.x,P.x,R.x),U=Math.min(S.y,T.y,P.y,R.y),W=Math.max(S.x,T.x,P.x,R.x),j=Math.max(S.y,T.y,P.y,R.y);const Z=r/16;function Y(K,ae,se,de,ge,Te){const we=(se+ge)/2,Ie=(de+Te)/2,xe=t.project(il(we),pr(Ie)),We=Math.max(0,z-xe.x,U-xe.y,xe.x-W,xe.y-j);z=Math.min(z,xe.x),W=Math.max(W,xe.x),U=Math.min(U,xe.y),j=Math.max(j,xe.y),We>Z&&(Y(K,xe,se,de,we,Ie),Y(xe,ae,we,Ie,ge,Te))}Y(S,T,l,h,u,h),Y(T,P,u,h,u,p),Y(P,R,u,p,l,p),Y(R,S,l,p,l,h),z-=Z,U-=Z,W+=Z,j+=Z;const $=1/Math.max(W-z,j-U);return{scale:$,x:z*$,y:U*$,x2:W*$,y2:j*$,projection:t}}function aN(i,t,r,l,u,h,p,g,v){if(v.name==="globe")return FC(i,t,new Uu(r,l,u),!1);const b=bm({z:r,x:l,y:u},v);return new di([(h+b.x/b.scale)*t,t*(b.y/b.scale),p],[(h+b.x2/b.scale)*t,t*(b.y2/b.scale),g])}function iN(i,{x:t,y:r},l=0){return new V(((t-l)*i.scale-i.x)*dt,(r*i.scale-i.y)*dt)}function rN(i,t,r=0){return ke.fromValues(((t.x-r)*i.scale-i.x)*dt,(t.y*i.scale-i.y)*dt,qz(t.z,t.y))}const bte=nt.identity(new Float32Array(16));class wf{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,r){return{x:0,y:0,z:0}}unproject(t,r){return new On(0,0)}projectTilePoint(t,r,l){return{x:t,y:r,z:0}}locationPoint(t,r,l=!0){return t._coordinatePoint(t.locationCoordinate(r),l)}pixelsPerMeter(t,r){return ja(1,t)*r}pixelSpaceConversion(t,r,l){return 1}farthestPixelDistance(t){return nN(t,t.pixelsPerMeter)}pointCoordinate(t,r,l,u){const h=t.horizonLineFromTop(!1),p=new V(r,Math.max(h,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(p,u))}pointCoordinate3D(t,r,l){const u=new V(r,l);if(t.elevation)return t.elevation.pointCoordinate(u);{const h=this.pointCoordinate(t,u.x,u.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(t,r){if(t.elevation)return!this.pointCoordinate3D(t,r.x,r.y);const l=t.horizonLineFromTop();return r.y<l}createInversionMatrix(t,r){return bte}createTileMatrix(t,r,l){let u,h,p;const g=l.canonical,v=nt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=bm(g,this);u=1,h=b.x+l.wrap*b.scale,p=b.y,nt.scale(v,v,[u/b.scale,u/b.scale,t.pixelsPerMeter/r])}else u=r/t.zoomScale(g.z),h=(g.x+Math.pow(2,g.z)*l.wrap)*u,p=g.y*u;return nt.translate(v,v,[h,p,0]),nt.scale(v,v,[u/dt,u/dt,1]),v}upVector(t,r,l){return[0,0,1]}upVectorScale(t,r,l){return{metersToTile:1}}}class xte extends wf{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[r,l]=this.parallels=t.parallels||[29.5,45.5],u=Math.sin(be(r));this.n=(u+Math.sin(be(l)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(t,r){const{n:l,c:u,r0:h}=this,p=be(t-this.center[0]),g=be(r),v=Math.sqrt(u-2*l*Math.sin(g))/l;return{x:v*Math.sin(p*l),y:v*Math.cos(p*l)-h,z:0}}unproject(t,r){const{n:l,c:u,r0:h}=this,p=h+r;let g=Math.atan2(t,Math.abs(p))*Math.sign(p);p*l<0&&(g-=Math.PI*Math.sign(t)*Math.sign(p));const v=be(this.center[0])*l;g=Ye(g,-Math.PI-v,Math.PI-v);const b=ne(fe(g/l)+this.center[0],-180,180),x=Math.asin(ne((u-(t*t+p*p)*l*l)/(2*l),-1,1)),S=ne(fe(x),-ji,ji);return new On(b,S)}}const s1=1.340264,l1=-.081106,c1=893e-6,u1=.003796,H2=Math.sqrt(3)/2;class wte extends wf{project(t,r){r=r/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(H2*Math.sin(r)),u=l*l,h=u*u*u;return{x:.5*(t*Math.cos(l)/(H2*(s1+3*l1*u+h*(7*c1+9*u1*u)))/Math.PI+.5),y:1-.5*(l*(s1+l1*u+h*(c1+u1*u))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let l=r=(2*(1-r)-1)*Math.PI,u=l*l,h=u*u*u;for(let x,S,T,P=0;P<12&&(S=l*(s1+l1*u+h*(c1+u1*u))-r,T=s1+3*l1*u+h*(7*c1+9*u1*u),x=S/T,l=ne(l-x,-Math.PI/3,Math.PI/3),u=l*l,h=u*u*u,!(Math.abs(x)<1e-12));++P);const p=H2*t*(s1+3*l1*u+h*(7*c1+9*u1*u))/Math.cos(l),g=Math.asin(Math.sin(l)/H2),v=ne(180*p/Math.PI,-180,180),b=ne(180*g/Math.PI,-ji,ji);return new On(v,b)}}class Ste extends wf{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){return{x:.5+t/360,y:.5-r/360,z:0}}unproject(t,r){const l=360*(t-.5),u=ne(360*(.5-r),-ji,ji);return new On(l,u)}}const cv=Math.PI/2;function j2(i){return Math.tan((cv+i)/2)}class Ate extends wf{constructor(t){super(t),this.center=t.center||[0,30];const[r,l]=this.parallels=t.parallels||[30,30];let u=be(r),h=be(l);this.southernCenter=u+h<0,this.southernCenter&&(u=-u,h=-h);const p=Math.cos(u),g=j2(u);this.n=u===h?Math.sin(u):Math.log(p/Math.cos(h))/Math.log(j2(h)/g),this.f=p*Math.pow(j2(u),this.n)/this.n}project(t,r){r=be(r),this.southernCenter&&(r=-r),t=be(t-this.center[0]);const l=1e-6,{n:u,f:h}=this;h>0?r<-cv+l&&(r=-cv+l):r>cv-l&&(r=cv-l);const p=h/Math.pow(j2(r),u);let g=p*Math.sin(u*t),v=h-p*Math.cos(u*t);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(t,r){t=(2*t-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:l,f:u}=this,h=u-r,p=Math.sign(h),g=Math.sign(l)*Math.sqrt(t*t+h*h);let v=Math.atan2(t,Math.abs(h))*p;h*l<0&&(v-=Math.PI*Math.sign(t)*p);const b=ne(fe(v/l)+this.center[0],-180,180),x=ne(fe(2*Math.atan(Math.pow(u/g,1/l))-cv),-ji,ji);return new On(b,this.southernCenter?-x:x)}}class oN extends wf{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,r){return{x:go(t),y:Eo(r),z:0}}unproject(t,r){const l=il(t),u=pr(r);return new On(l,u)}}const sN=be(ji);class Ete extends wf{project(t,r){const l=(r=be(r))*r,u=l*l;return{x:.5*((t=be(t))*(.8707-.131979*l+u*(u*(.003971*l-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+l*(.015085+u*(.028874*l-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let l=r=(2*(1-r)-1)*Math.PI,u=25,h=0,p=l*l;do{p=l*l;const b=p*p;h=(l*(1.007226+p*(.015085+b*(.028874*p-.044475-.005916*b)))-r)/(1.007226+p*(.045255+b*(.259866*p-.311325-.005916*11*b))),l=ne(l-h,-sN,sN)}while(Math.abs(h)>1e-6&&--u>0);p=l*l;const g=ne(fe(t/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),v=fe(l);return new On(g,v)}}const lN=be(ji);class Mte extends wf{project(t,r){r=be(r),t=be(t);const l=Math.cos(r),u=2/Math.PI,h=Math.acos(l*Math.cos(t/2)),p=Math.sin(h)/h,g=.5*(t*u+2*l*Math.sin(t/2)/p)||0,v=.5*(r+Math.sin(r)/p)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(t,r){let l=t=(2*t-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,h=25;const p=1e-6;let g=0,v=0;do{const b=Math.cos(u),x=Math.sin(u),S=2*x*b,T=x*x,P=b*b,R=Math.cos(l/2),z=Math.sin(l/2),U=2*R*z,W=z*z,j=1-P*R*R,Z=j?1/j:0,Y=j?Math.acos(b*R)*Math.sqrt(1/j):0,$=.5*(2*Y*b*z+2*l/Math.PI)-t,K=.5*(Y*x+u)-r,ae=.5*Z*(P*W+Y*b*R*T)+1/Math.PI,se=Z*(U*S/4-Y*x*z),de=.125*Z*(S*z-Y*x*P*U),ge=.5*Z*(T*R+Y*W*b)+.5,Te=se*de-ge*ae;g=(K*se-$*ge)/Te,v=($*de-K*ae)/Te,l=ne(l-g,-Math.PI,Math.PI),u=ne(u-v,-lN,lN)}while((Math.abs(g)>p||Math.abs(v)>p)&&--h>0);return new On(fe(l),fe(u))}}class cN extends wf{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(be(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){const{scale:l,cosPhi:u}=this;return{x:be(t)*u*l+.5,y:-Math.sin(be(r))/u*l+.5,z:0}}unproject(t,r){const{scale:l,cosPhi:u}=this,h=-(r-.5)/l,p=ne(fe((t-.5)/l)/u,-180,180),g=Math.asin(ne(h*u,-1,1)),v=ne(fe(g),-ji,ji);return new On(p,v)}}class Tte extends oN{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,r,l){const u=K_(t,r,l),h=ym(dc(l));return ke.transformMat4(u,u,h),{x:u[0],y:u[1],z:u[2]}}locationPoint(t,r){const l=ks(r.lat,r.lng),u=ke.normalize([],l),h=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(r),t._centerAltitude):t._centerAltitude,p=ja(1,0)*dt*h;ke.scaleAndAdd(l,l,u,p);const g=nt.identity(new Float64Array(16));return nt.multiply(g,t.pixelMatrix,t.globeMatrix),ke.transformMat4(l,l,g),new V(l[0],l[1])}pixelsPerMeter(t,r){return ja(1,0)*r}pixelSpaceConversion(t,r,l){const u=ja(1,t)*r,h=Ln(ja(1,45)*r,u,l);return this.pixelsPerMeter(t,r)/h}createTileMatrix(t,r,l){const u=BC(dc(l.canonical));return nt.multiply(new Float64Array(16),t.globeMatrix,u)}createInversionMatrix(t,r){const{center:l}=t,u=ym(dc(r));return nt.rotateY(u,u,be(l.lng)),nt.rotateX(u,u,be(l.lat)),nt.scale(u,u,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(t,r,l,u){return zz(t,r,l,!0)||new ga(0,0)}pointCoordinate3D(t,r,l){const u=this.pointCoordinate(t,r,l,0);return[u.x,u.y,u.z]}isPointAboveHorizon(t,r){return!zz(t,r.x,r.y,!1)}farthestPixelDistance(t){const r=function(u,h){const p=u.cameraToCenterDistance,g=u._centerAltitude*h,v=u._camera,b=u._camera.forward(),x=ke.add([],ke.scale([],b,-p),[0,0,g]),S=u.worldSize/(2*Math.PI),T=[0,0,-S],P=u.width/u.height,R=Math.tan(u.fovAboveCenter),z=ke.scale([],v.up(),R),U=ke.scale([],v.right(),R*P),W=ke.normalize([],ke.add([],ke.add([],b,z),U)),j=[];let Z;if(new g2(x,W).closestPointOnSphere(T,S,j)){const Y=ke.add([],j,T),$=ke.sub([],Y,x);Z=Math.cos(u.fovAboveCenter)*ke.length($)}else{const Y=ke.sub([],x,T),$=ke.sub([],T,x);ke.normalize($,$);const K=ke.length(Y)-S;Z=Math.sqrt(K*(K+2*S));const ae=Math.acos(Z/(S+K))-Math.acos(ke.dot(b,$));Z*=Math.cos(ae)}return 1.01*Z}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=mo(t.zoom);if(l>0){const u=nN(t,ja(1,t.center.lat)*t.worldSize),h=t.worldSize/(2*Math.PI),p=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Ln(r,u+h*(1-Math.cos(p)),Math.pow(l,10))}return r}upVector(t,r,l){return K_(r,l,t,1)}upVectorScale(t){return{metersToTile:y2(_2(dc(t)))}}}function $2(i){const t=i.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(i.name){case"mercator":return new oN(i);case"equirectangular":return new Ste(i);case"naturalEarth":return new Ete(i);case"equalEarth":return new wte(i);case"winkelTripel":return new Mte(i);case"albers":return r?new cN(i):new xte(i);case"lambertConformalConic":return r?new cN(i):new Ate(i);case"globe":return new Tte(i)}throw new Error(`Invalid projection name: ${i.name}`)}const Cte=new gi({"symbol-placement":new Xt(tt.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(tt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(tt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yn(tt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(tt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xt(tt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Xt(tt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xt(tt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(tt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(tt.layout_symbol["icon-rotation-alignment"]),"icon-size":new yn(tt.layout_symbol["icon-size"]),"icon-text-fit":new yn(tt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yn(tt.layout_symbol["icon-text-fit-padding"]),"icon-image":new yn(tt.layout_symbol["icon-image"]),"icon-rotate":new yn(tt.layout_symbol["icon-rotate"]),"icon-padding":new Xt(tt.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(tt.layout_symbol["icon-keep-upright"]),"icon-offset":new yn(tt.layout_symbol["icon-offset"]),"icon-anchor":new yn(tt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(tt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(tt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(tt.layout_symbol["text-rotation-alignment"]),"text-field":new yn(tt.layout_symbol["text-field"]),"text-font":new yn(tt.layout_symbol["text-font"]),"text-size":new yn(tt.layout_symbol["text-size"]),"text-max-width":new yn(tt.layout_symbol["text-max-width"]),"text-line-height":new yn(tt.layout_symbol["text-line-height"]),"text-letter-spacing":new yn(tt.layout_symbol["text-letter-spacing"]),"text-justify":new yn(tt.layout_symbol["text-justify"]),"text-radial-offset":new yn(tt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(tt.layout_symbol["text-variable-anchor"]),"text-anchor":new yn(tt.layout_symbol["text-anchor"]),"text-max-angle":new Xt(tt.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(tt.layout_symbol["text-writing-mode"]),"text-rotate":new yn(tt.layout_symbol["text-rotate"]),"text-padding":new Xt(tt.layout_symbol["text-padding"]),"text-keep-upright":new Xt(tt.layout_symbol["text-keep-upright"]),"text-transform":new yn(tt.layout_symbol["text-transform"]),"text-offset":new yn(tt.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(tt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xt(tt.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(tt.layout_symbol["text-optional"]),visibility:new Xt(tt.layout_symbol.visibility)});var vP={paint:new gi({"icon-opacity":new yn(tt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new yn(tt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new yn(tt.paint_symbol["text-emissive-strength"]),"icon-color":new yn(tt.paint_symbol["icon-color"]),"icon-halo-color":new yn(tt.paint_symbol["icon-halo-color"]),"icon-halo-width":new yn(tt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yn(tt.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(tt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(tt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new yn(tt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new yn(tt.paint_symbol["text-opacity"]),"text-color":new yn(tt.paint_symbol["text-color"],{runtimeType:Yi,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new yn(tt.paint_symbol["text-halo-color"]),"text-halo-width":new yn(tt.paint_symbol["text-halo-width"]),"text-halo-blur":new yn(tt.paint_symbol["text-halo-blur"]),"text-translate":new Xt(tt.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(tt.paint_symbol["text-translate-anchor"])}),layout:Cte};class uN{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Xs,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}un(uN,"FormatSectionOverride",{omit:["defaultValue"]});class q2 extends jo{constructor(t,r){super(t,vP,r)}recalculate(t,r){super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const u=[];for(const h of l)u.indexOf(h)<0&&u.push(h);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,r,l,u){const h=this.layout.get(t).evaluate(r,{},l,u),p=this._unevaluatedLayout._values[t];return p.isDataDriven()||Kp(p.value)||!h?h:function(g,v){return v.replace(/{([^{}]+)}/g,(b,x)=>x in g?String(g[x]):"")}(r.properties,h)}createBucket(t){return new d1(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of vP.paint.overridableProperties){if(!q2.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),l=new uN(r),u=new Yp(l,r.property.specification);let h=null;h=r.value.kind==="constant"||r.value.kind==="source"?new Sy("source",u):new Dc("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[t]=new nl(r.property,h,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&q2.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const l=t.get("text-field"),u=vP.paint.properties[r];let h=!1;const p=g=>{for(const v of g)if(u.overrides&&u.overrides.hasOverride(v))return void(h=!0)};if(l.value.kind==="constant"&&l.value.value instanceof wr)p(l.value.value.sections);else if(l.value.kind==="source"){const g=b=>{h||(b instanceof xu&&Ti(b.value)===Cc?p(b.value.sections):b instanceof Hh?p(b.sections):b.eachChild(g))},v=l.value;v._styleExpression&&g(v._styleExpression.expression)}return h}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,r=this.paint.get("text-opacity").constantOr(1)!==0,l=[];return t&&l.push("symbolIcon"),r&&l.push("symbolSDF"),l}getDefaultProgramParams(t,r){return{config:new pm(this,r),overrideFog:!1}}}const Pte=k2.types,Ite=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function X2(i,t,r,l,u,h,p,g,v,b,x,S,T){const P=g?Math.min(xf,Math.round(g[0])):0,R=g?Math.min(xf,Math.round(g[1])):0;i.emplaceBack(t,r,Math.round(32*l),Math.round(32*u),h,p,(P<<1)+(v?1:0),R,16*b,16*x,256*S,256*T)}function Z2(i,t,r){i.emplaceBack(t,r)}function Y2(i,t,r,l,u,h,p){i.emplaceBack(t,r,l,u,h,p)}function K2(i,t,r,l,u){const h=5*t+2;i.float32[h+0]=r,i.float32[h+1]=l,i.float32[h+2]=u}function uv(i,t,r,l,u){i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u)}function Lte(i){for(const t of i.sections)if(lC(t.text))return!0;return!1}class _P{constructor(t){this.layoutVertexArray=new yi,this.indexArray=new Nn,this.programConfigurations=t,this.segments=new Ha,this.dynamicLayoutVertexArray=new dn,this.opacityVertexArray=new po,this.placedSymbolArray=new nO,this.iconTransitioningVertexArray=new Jr,this.globeExtVertexArray=new Vn,this.zOffsetVertexArray=new fr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,r,l,u,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qee.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Zee.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Ite,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,Kee.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Xee.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Yee.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}un(_P,"SymbolBuffers");class bP{constructor(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new Ha,this.collisionVertexArray=new An,this.collisionVertexArrayExt=new Dn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Jee.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,Qee.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}un(bP,"CollisionBuffers");class J2{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=nt.identity([]),this.placementViewportMatrix=nt.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=cP(this.zoom,r["text-size"]),this.iconSizeData=cP(this.zoom,r["icon-size"]);const l=this.layers[0].layout,u=l.get("symbol-sort-key"),h=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(p=>_i[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=l.get("symbol-z-elevate")}createArrays(){this.text=new _P(new df(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new _P(new df(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new rO,this.lineVertexArray=new oO,this.symbolInstances=new iO}calculateGlyphDependencies(t,r,l,u,h){for(let p=0;p<t.length;p++){const g=t.codePointAt(p);if(g===void 0)break;if(r[g]=!0,u&&h&&g<=65535){const v=a1[t.charAt(p)];v&&(r[v.charCodeAt(0)]=!0)}}}populate(t,r,l,u){const h=this.layers[0],p=h.layout,g=this.projection.name==="globe",v=p.get("text-font"),b=p.get("text-field"),x=p.get("icon-image"),S=(b.value.kind!=="constant"||b.value.value instanceof wr&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),T=x.value.kind!=="constant"||!!x.value.value||Object.keys(x.parameters).length>0,P=p.get("symbol-sort-key");if(this.features=[],!S&&!T)return;const R=r.iconDependencies,z=r.glyphDependencies,U=r.availableImages,W=new ii(this.zoom);for(const{feature:j,id:Z,index:Y,sourceLayerIndex:$}of t){const K=h._featureFilter.needGeometry,ae=yf(j,K);if(!h._featureFilter.filter(W,ae,l))continue;if(K||(ae.geometry=Wu(j,l,u)),g&&j.type!==1&&l.z<=5){const Te=ae.geometry,we=.98078528056,Ie=(xe,We)=>{const qe=K_(xe.x,xe.y,l,1),Qe=K_(We.x,We.y,l,1);return ke.dot(qe,Qe)<we};for(let xe=0;xe<Te.length;xe++)Te[xe]=GQ(Te[xe],Ie)}let se,de;if(S){const Te=h.getValueAndResolveTokens("text-field",ae,l,U),we=wr.factory(Te);Lte(we)&&(this.hasRTLText=!0),(!this.hasRTLText||W_()==="unavailable"||this.hasRTLText&&Is.isParsed())&&(se=nte(we,h,ae))}if(T){const Te=h.getValueAndResolveTokens("icon-image",ae,l,U);de=Te instanceof Jo?Te:Jo.fromString(Te)}if(!se&&!de)continue;const ge=this.sortFeaturesByKey?P.evaluate(ae,{},l):void 0;if(this.features.push({id:Z,text:se,icon:de,index:Y,sourceLayerIndex:$,geometry:ae.geometry,properties:j.properties,type:Pte[j.type],sortKey:ge}),de&&(R[de.namePrimary]=!0,de.nameSecondary&&(R[de.nameSecondary]=!0)),se){const Te=v.evaluate(ae,{},l).join(","),we=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(_i.vertical)>=0;for(const Ie of se.sections)if(Ie.image)R[Ie.image.namePrimary]=!0;else{const xe=dm(se.toString()),We=Ie.fontStack||Te,qe=z[We]=z[We]||{};this.calculateGlyphDependencies(Ie.text,qe,we,this.allowVerticalPlacement,xe)}}}p.get("symbol-placement")==="line"&&(this.features=function(j){const Z={},Y={},$=[];let K=0;function ae(Te){$.push(j[Te]),K++}function se(Te,we,Ie){const xe=Y[Te];return delete Y[Te],Y[we]=xe,$[xe].geometry[0].pop(),$[xe].geometry[0]=$[xe].geometry[0].concat(Ie[0]),xe}function de(Te,we,Ie){const xe=Z[we];return delete Z[we],Z[Te]=xe,$[xe].geometry[0].shift(),$[xe].geometry[0]=Ie[0].concat($[xe].geometry[0]),xe}function ge(Te,we,Ie){const xe=Ie?we[0][we[0].length-1]:we[0][0];return`${Te}:${xe.x}:${xe.y}`}for(let Te=0;Te<j.length;Te++){const we=j[Te],Ie=we.geometry,xe=we.text?we.text.toString():null;if(!xe){ae(Te);continue}const We=ge(xe,Ie),qe=ge(xe,Ie,!0);if(We in Y&&qe in Z&&Y[We]!==Z[qe]){const Qe=de(We,qe,Ie),Ne=se(We,qe,$[Qe].geometry);delete Z[We],delete Y[qe],Y[ge(xe,$[Ne].geometry,!0)]=Ne,$[Qe].geometry=null}else We in Y?se(We,qe,Ie):qe in Z?de(We,qe,Ie):(ae(Te),Z[We]=K-1,Y[qe]=K-1)}return $.filter(Te=>Te.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((j,Z)=>j.sortKey-Z.sortKey)}update(t,r,l,u,h){const p=Object.keys(t).length!==0;if(p&&!this.stateDependentLayers.length)return;const g=p?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,r,g,l,u,h),this.icon.programConfigurations.updatePaintArrays(t,r,g,l,u,h)}updateZOffset(){const t=(h,p,g)=>{l+=p,l>h.length&&h.resize(l);for(let v=-p;v<0;v++)h.emplace(v+l,g)},r=(h,p,g)=>{u+=p,u>h.length&&h.resize(u);for(let v=-p;v<0;v++)h.emplace(v+u,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let l=0,u=0;for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:b}=p,x=p.zOffset,S=b>0;if((g>0||v>0)&&(t(this.text.zOffsetVertexArray,g,x),t(this.text.zOffsetVertexArray,v,x)),S){const{placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:P}=p;T>=0&&r(this.icon.zOffsetVertexArray,b,x),P>=0&&r(this.icon.zOffsetVertexArray,p.numVerticalIconVertices,x)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const l=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:u,y:h}of r)this.lineVertexArray.emplaceBack(u,h);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U){const W=t.indexArray,j=t.layoutVertexArray,Z=t.globeExtVertexArray,Y=t.segments.prepareSegment(4*r.length,j,W,this.canOverlap?p.sortKey:void 0),$=this.glyphOffsetArray.length,K=Y.vertexLength,ae=this.allowVerticalPlacement&&g===_i.vertical?Math.PI/2:0,se=p.text&&p.text.sections;for(let ge=0;ge<r.length;ge++){const{tl:Te,tr:we,bl:Ie,br:xe,texPrimary:We,texSecondary:qe,pixelOffsetTL:Qe,pixelOffsetBR:Ne,minFontScaleX:Ve,minFontScaleY:at,glyphOffset:mt,isSDF:lt,sectionIndex:Ct}=r[ge],zt=Y.vertexLength,bt=mt[1];if(X2(j,b.x,b.y,Te.x,bt+Te.y,We.x,We.y,l,lt,Qe.x,Qe.y,Ve,at),X2(j,b.x,b.y,we.x,bt+we.y,We.x+We.w,We.y,l,lt,Ne.x,Qe.y,Ve,at),X2(j,b.x,b.y,Ie.x,bt+Ie.y,We.x,We.y+We.h,l,lt,Qe.x,Ne.y,Ve,at),X2(j,b.x,b.y,xe.x,bt+xe.y,We.x+We.w,We.y+We.h,l,lt,Ne.x,Ne.y,Ve,at),v){const{x:Et,y:en,z:on}=v.anchor,[rn,cn,gn]=v.up;Y2(Z,Et,en,on,rn,cn,gn),Y2(Z,Et,en,on,rn,cn,gn),Y2(Z,Et,en,on,rn,cn,gn),Y2(Z,Et,en,on,rn,cn,gn),uv(t.dynamicLayoutVertexArray,Et,en,on,ae)}else uv(t.dynamicLayoutVertexArray,b.x,b.y,b.z,ae);if(U){const Et=qe||We;Z2(t.iconTransitioningVertexArray,Et.x,Et.y),Z2(t.iconTransitioningVertexArray,Et.x+Et.w,Et.y),Z2(t.iconTransitioningVertexArray,Et.x,Et.y+Et.h),Z2(t.iconTransitioningVertexArray,Et.x+Et.w,Et.y+Et.h)}W.emplaceBack(zt,zt+1,zt+2),W.emplaceBack(zt+1,zt+2,zt+3),Y.vertexLength+=4,Y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(mt[0]),ge!==r.length-1&&Ct===r[ge+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,p,p.index,{},P,R,z,se&&se[Ct])}const de=v?v.anchor:b;t.placedSymbolArray.emplaceBack(de.x,de.y,de.z,b.x,b.y,$,this.glyphOffsetArray.length-$,K,x,S,b.segment,l?l[0]:0,l?l[1]:0,u[0],u[1],g,0,!1,0,T,0)}_commitLayoutVertex(t,r,l,u,h,p,g){t.emplaceBack(r,l,u,h,p,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,r,l,u,h,p,g){const v=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),b=v.vertexLength,x=g.tileAnchorX,S=g.tileAnchorY;for(let P=0;P<4;P++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(r,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(r,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(r,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(r,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,x,S,new V(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,x,S,new V(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,x,S,new V(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,x,S,new V(t.x1,t.y2)),v.vertexLength+=4;const T=l.indexArray;T.emplaceBack(b,b+1),T.emplaceBack(b+1,b+2),T.emplaceBack(b+2,b+3),T.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceTextSize(t,p,r,g);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceIconSize(t,r,p.placedIconSymbolIndex);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}generateCollisionDebugBuffers(t,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bP(xt,DF.members,Jr),this.iconCollisionBox=new bP(xt,DF.members,Jr);const l=Vu(this.iconSizeData,t),u=Vu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(u,t,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._addTextDebugCollisionBoxes(u,t,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,t,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,t,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}}getSymbolInstanceTextSize(t,r,l,u){const h=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),p=n1(this.textSizeData,t,h)/to;return this.tilePixelRatio*p}getSymbolInstanceIconSize(t,r,l){const u=this.icon.placedSymbolArray.get(l),h=n1(this.iconSizeData,t,u);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(t,r,l){t.emplaceBack(r,-l,-l),t.emplaceBack(r,l,-l),t.emplaceBack(r,l,l),t.emplaceBack(r,-l,l)}_updateTextDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceTextSize(t,p,r,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding)}}_updateIconDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceIconSize(t,r,p);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding)}}updateCollisionDebugBuffers(t,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Vu(this.iconSizeData,t),u=Vu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(u,t,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._updateTextDebugCollisionBoxes(u,t,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._updateIconDebugCollisionBoxes(l,t,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,t,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,r,l,u,h,p,g,v,b){const x={};if(r<l){const{x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y,featureIndex:$}=t.get(r);x.textBox={x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y},x.textFeatureIndex=$}if(u<h){const{x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y,featureIndex:$}=t.get(u);x.verticalTextBox={x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y},x.verticalTextFeatureIndex=$}if(p<g){const{x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y,featureIndex:$}=t.get(p);x.iconBox={x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y},x.iconFeatureIndex=$}if(v<b){const{x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y,featureIndex:$}=t.get(v);x.verticalIconBox={x1:S,y1:T,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Z,tileAnchorY:Y},x.verticalIconFeatureIndex=$}return x}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,r){const l=t.placedSymbolArray.get(r),u=l.vertexStartIndex+4*l.numGlyphs;for(let h=l.vertexStartIndex;h<u;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),l=Math.cos(t),u=[],h=[],p=[];for(let g=0;g<this.symbolInstances.length;++g){p.push(g);const v=this.symbolInstances.get(g);u.push(0|Math.round(r*v.tileAnchorX+l*v.tileAnchorY)),h.push(v.featureIndex)}return p.sort((g,v)=>u[g]-u[v]||h[v]-h[g]),p}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:b}=l;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&h!==u&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&p!==u&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}un(J2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),J2.MAX_GLYPHS=65535,J2.addDynamicAttributes=uv;var d1=J2;const Rte=N([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:kte}=Rte,Dte=N([{name:"a_packed",components:4,type:"Float32"}]),{members:Ote}=Dte,zte=k2.types,Fte=Math.cos(Math.PI/180*37.5);class Q2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new jt,this.layoutVertexArray2=new dn,this.indexArray=new Nn,this.programConfigurations=new df(t.layers,t.zoom),this.segments=new Ha,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l,u){this.hasPattern=nP("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),p=[];for(const{feature:x,id:S,index:T,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,z=yf(x,R);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),z,l))continue;const U=h?h.evaluate(z,{},l):void 0,W={id:S,properties:x.properties,type:x.type,sourceLayerIndex:P,index:T,geometry:R?z.geometry:Wu(x,l,u),patterns:{},sortKey:U};p.push(W)}h&&p.sort((x,S)=>x.sortKey-S.sortKey);const{lineAtlas:g,featureIndex:v}=r,b=this.addConstantDashes(g);for(const x of p){const{geometry:S,index:T,sourceLayerIndex:P}=x;if(b&&this.addFeatureDashes(x,g),this.hasPattern){const R=aP("line",this.layers,x,this.zoom,r);this.patternFeatures.push(R)}else this.addFeature(x,S,T,l,g.positions,r.availableImages,r.brightness);v.insert(t[T].feature,S,T,P,this.index)}}addConstantDashes(t){let r=!1;for(const l of this.layers){const u=l.paint.get("line-dasharray").value,h=l.layout.get("line-cap").value;if(u.kind!=="constant"||h.kind!=="constant")r=!0;else{const p=h.value,g=u.value;if(!g)continue;t.addDash(g,p)}}return r}addFeatureDashes(t,r){const l=this.zoom;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,p=u.layout.get("line-cap").value;if(h.kind==="constant"&&p.kind==="constant")continue;let g,v;if(h.kind==="constant"){if(g=h.value,!g)continue}else g=h.evaluate({zoom:l},t);v=p.kind==="constant"?p.value:p.evaluate({zoom:l},t),r.addDash(g,v),t.patterns[u.id]=r.getKey(g,v)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}addFeatures(t,r,l,u,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,l,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Ote)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,kte),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,l,u,h,p,g){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),x=v.get("line-cap").evaluate(t,{}),S=v.get("line-miter-limit"),T=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of r)this.addLine(P,t,b,x,S,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,g)}addLine(t,r,l,u,h,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<t.length-1;W++)this.totalDistance+=t[W].dist(t[W+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=zte[r.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let b=0;for(;b<v-1&&t[b].equals(t[b+1]);)b++;if(v<(g?3:2))return;l==="bevel"&&(h=1.05);const x=this.overscaling<=16?15*dt/(512*this.overscaling):0,S=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let T,P,R,z,U;this.e1=this.e2=-1,g&&(T=t[v-2],U=t[b].sub(T)._unit()._perp());for(let W=b;W<v;W++){if(R=W===v-1?g?t[b+1]:void 0:t[W+1],R&&t[W].equals(R))continue;U&&(z=U),T&&(P=T),T=t[W],U=R?R.sub(T)._unit()._perp():z,z=z||U;let j=z.add(U);j.x===0&&j.y===0||j._unit();const Z=z.x*U.x+z.y*U.y,Y=j.x*U.x+j.y*U.y,$=Y!==0?1/Y:1/0,K=2*Math.sqrt(2-2*Y),ae=Y<Fte&&P&&R,se=z.x*U.y-z.y*U.x>0;if(ae&&W>b){const Te=T.dist(P);if(Te>2*x){const we=T.sub(T.sub(P)._mult(x/Te)._round());this.updateDistance(P,we),this.addCurrentVertex(we,z,0,0,S),P=we}}const de=P&&R;let ge=de?l:g?"butt":u;if(de&&ge==="round"&&($<p?ge="miter":$<=2&&(ge="fakeround")),ge==="miter"&&$>h&&(ge="bevel"),ge==="bevel"&&($>2&&(ge="flipbevel"),$<h&&(ge="miter")),P&&this.updateDistance(P,T),ge==="miter")j._mult($),this.addCurrentVertex(T,j,0,0,S);else if(ge==="flipbevel"){if($>100)j=U.mult(-1);else{const Te=$*z.add(U).mag()/z.sub(U).mag();j._perp()._mult(Te*(se?-1:1))}this.addCurrentVertex(T,j,0,0,S),this.addCurrentVertex(T,j.mult(-1),0,0,S)}else if(ge==="bevel"||ge==="fakeround"){const Te=-Math.sqrt($*$-1),we=se?Te:0,Ie=se?0:Te;if(P&&this.addCurrentVertex(T,z,we,Ie,S),ge==="fakeround"){const xe=Math.round(180*K/Math.PI/20);for(let We=1;We<xe;We++){let qe=We/xe;if(qe!==.5){const Ne=qe-.5;qe+=qe*Ne*(qe-1)*((1.0904+Z*(Z*(3.55645-1.43519*Z)-3.2452))*Ne*Ne+(.848013+Z*(.215638*Z-1.06021)))}const Qe=U.sub(z)._mult(qe)._add(z)._unit()._mult(se?-1:1);this.addHalfVertex(T,Qe.x,Qe.y,!1,se,0,S)}}R&&this.addCurrentVertex(T,U,-we,-Ie,S)}else if(ge==="butt")this.addCurrentVertex(T,j,0,0,S);else if(ge==="square"){const Te=P?1:-1;P||this.addCurrentVertex(T,j,Te,Te,S),this.addCurrentVertex(T,j,0,0,S),P&&this.addCurrentVertex(T,j,Te,Te,S)}else ge==="round"&&(P&&(this.addCurrentVertex(T,z,0,0,S),this.addCurrentVertex(T,z,1,1,S,!0)),R&&(this.addCurrentVertex(T,U,-1,-1,S,!0),this.addCurrentVertex(T,U,0,0,S)));if(ae&&W<v-1){const Te=T.dist(R);if(Te>2*x){const we=T.add(R.sub(T)._mult(x/Te)._round());this.updateDistance(T,we),this.addCurrentVertex(we,U,0,0,S),T=we}}}}addCurrentVertex(t,r,l,u,h,p=!1){const g=r.y*u-r.x,v=-r.y-r.x*u;this.addHalfVertex(t,r.x+r.y*l,r.y-r.x*l,p,!1,l,h),this.addHalfVertex(t,g,v,p,!0,-u,h)}addHalfVertex({x:t,y:r},l,u,h,p,g,v){this.layoutVertexArray.emplaceBack((t<<1)+(h?1:0),(r<<1)+(p?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),p?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}un(Q2,"LineBucket",{omit:["layers","patternFeatures"]});class mr{constructor(t,r,l,u){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(r,u)}update(t,r,l){const{width:u,height:h}=t,{context:p}=this,{gl:g}=p,{HTMLImageElement:v,HTMLCanvasElement:b,HTMLVideoElement:x,ImageData:S,ImageBitmap:T}=m;if(g.bindTexture(g.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!r||r.premultiply!==!1)),l||this.size&&this.size[0]===u&&this.size[1]===h){const{x:P,y:R}=l||{x:0,y:0};if(t instanceof v||t instanceof b||t instanceof x||t instanceof S||T&&t instanceof T)g.texSubImage2D(g.TEXTURE_2D,0,P,R,g.RGBA,g.UNSIGNED_BYTE,t);else{let z=this.format,U=g.UNSIGNED_BYTE;this.format===g.R32F&&(z=g.RED,U=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,P,R,u,h,z,U,t.data)}}else if(this.size=[u,h],t instanceof v||t instanceof b||t instanceof x||t instanceof S||T&&t instanceof T){let P=this.format;this.format===g.R8&&(P=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,P,g.UNSIGNED_BYTE,t)}else{let P=this.format,R=this.format,z=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(P=g.DEPTH_COMPONENT16,z=g.UNSIGNED_SHORT),this.format===g.R32F&&(z=g.FLOAT,R=g.RED),g.texImage2D(g.TEXTURE_2D,0,P,u,h,0,R,z,t.data)}this.useMipmap=!!(r&&r.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,r){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?t===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(t,r,l,u){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.magFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),this.magFilter=r),t!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?t===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),this.wrapS=l),u!==this.wrapT&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class e3{constructor(t,r){this.context=t,this.texture=r}bind(t,r){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}}const hc=32,Gu=33,Sf=new Uint16Array(8184);for(let i=0;i<2046;i++){let t=i+2,r=0,l=0,u=0,h=0,p=0,g=0;for(1&t?u=h=p=hc:r=l=g=hc;(t>>=1)>1;){const b=r+u>>1,x=l+h>>1;1&t?(u=r,h=l,r=p,l=g):(r=u,l=h,u=p,h=g),p=b,g=x}const v=4*i;Sf[v+0]=r,Sf[v+1]=l,Sf[v+2]=u,Sf[v+3]=h}const Hu=new Uint16Array(2178),Af=new Uint8Array(1089),t3=new Uint16Array(1089);function dN(i){return i===0?-.03125:i===32?.03125:0}var xP=N([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const hN={type:2,extent:dt,loadGeometry:()=>[[new V(0,0),new V(dt+1,0),new V(dt+1,dt+1),new V(0,dt+1),new V(0,0)]]};class h1{constructor(t,r,l,u,h){this.tileID=t,this.uid=Rt(),this.uses=0,this.tileSize=r,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=h,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(t){const r=t+this.timeAdded;r<Cn.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=bm(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,r,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(u,h){const p={};if(!h)return p;for(const g of u){const v=g.layerIds.map(b=>h.getLayer(b)).filter(Boolean);if(v.length!==0){g.layers=v,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>v.filter(x=>x.id===b)[0]));for(const b of v)p[b.fqid]=g}}return p}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const h=this.buckets[u];if(h instanceof d1){if(this.hasSymbolBuckets=!0,!l)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const h=this.buckets[u];if(h instanceof d1&&h.hasRTLText){this.hasRTLText=!0,Is.isLoading()||Is.isLoaded()||W_()!=="deferred"||s2();break}}this.queryPadding=0;for(const u in this.buckets){const h=this.buckets[u],p=r.style.getOwnLayer(u);if(!p)continue;const g=p.queryRadius(h);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new fC}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new mr(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new mr(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new mr(t,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,r,l){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,l),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const u=r.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,r)))}queryRenderedFeatures(t,r,l,u,h,p,g,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:g,transform:p,params:h,tileTransform:this.tileTransform},t,r,l):{}}querySourceFeatures(t,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),h=r?r.sourceLayer:"",p=u._geojsonTileLayer||u[h];if(!p)return;const g=tm(r&&r.filter),{z:v,x:b,y:x}=this.tileID.canonical,S={z:v,x:b,y:x};for(let T=0;T<p.length;T++){const P=p.feature(T);if(g.needGeometry){const U=yf(P,!0);if(!g.filter(new ii(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!g.filter(new ii(this.tileID.overscaledZ),P))continue;const R=l.getId(P,h),z=new AF(P,v,b,x,R);z.tile=S,t.push(z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const l=Oe(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const h=this.expirationTime-r;h?this.expirationTime=l+Math.max(h,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&r&&this.updateBuckets(t,r)}updateBuckets(t,r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages(),h=r.style.getBrightness();for(const p in this.buckets){if(!r.style.hasLayer(p))continue;const g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",b=l[v];let x={};if(t&&(x=t[v],!b||!x||Object.keys(x).length===0))continue;if(g.update(x,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},h),g instanceof Q2||g instanceof L2){const T=r.style.getOwnSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&T&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(T.id,this.tileID)}const S=r&&r.style&&r.style.getOwnLayer(p);S&&(this.queryPadding=Math.max(this.queryPadding,S.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Cn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Cn.now()+t}setTexture(t,r){const l=r.context,u=l.gl;this.texture=this.texture||r.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new mr(l,t,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(t,r){const l={};for(const u of r)l[u]=!0;this.dependencies[t]=l}hasDependency(t,r){for(const l of t){const u=this.dependencies[l];if(u){for(const h of r)if(u[h])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const l=Wu(hN,this.tileID.canonical,this.tileTransform)[0],u=new J,h=new H_;for(let p=0;p<l.length;p++){const{x:g,y:v}=l[p];u.emplaceBack(g,v),h.emplaceBack(p)}h.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(h),this._tileDebugBuffer=t.createVertexBuffer(u,ff.members),this._tileDebugSegments=Ha.simpleSegment(0,0,u.length,h.length)}_makeTileBoundsBuffers(t,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const l=Wu(hN,this.tileID.canonical,this.tileTransform)[0];let u,h;if(this.isRaster){const p=function(g,v){const b=bm(g,v),x=Math.pow(2,g.z);for(let U=0;U<Gu;U++)for(let W=0;W<Gu;W++){const j=il((g.x+(W+dN(W))/hc)/x),Z=pr((g.y+(U+dN(U))/hc)/x),Y=v.project(j,Z),$=U*Gu+W;Hu[2*$+0]=Math.round((Y.x*b.scale-b.x)*dt),Hu[2*$+1]=Math.round((Y.y*b.scale-b.y)*dt)}Af.fill(0),t3.fill(0);for(let U=2045;U>=0;U--){const W=4*U,j=Sf[W+0],Z=Sf[W+1],Y=Sf[W+2],$=Sf[W+3],K=j+Y>>1,ae=Z+$>>1,se=K+ae-Z,de=ae+j-K,ge=Z*Gu+j,Te=$*Gu+Y,we=ae*Gu+K,Ie=Math.hypot((Hu[2*ge+0]+Hu[2*Te+0])/2-Hu[2*we+0],(Hu[2*ge+1]+Hu[2*Te+1])/2-Hu[2*we+1])>=16;Af[we]=Af[we]||(Ie?1:0),U<1022&&(Af[we]=Af[we]||Af[(Z+de>>1)*Gu+(j+se>>1)]||Af[($+de>>1)*Gu+(Y+se>>1)])}const S=new je,T=new Nn;let P=0;function R(U,W){const j=W*Gu+U;return t3[j]===0&&(S.emplaceBack(Hu[2*j+0],Hu[2*j+1],U*dt/hc,W*dt/hc),t3[j]=++P),t3[j]-1}function z(U,W,j,Z,Y,$){const K=U+j>>1,ae=W+Z>>1;if(Math.abs(U-Y)+Math.abs(W-$)>1&&Af[ae*Gu+K])z(Y,$,U,W,K,ae),z(j,Z,Y,$,K,ae);else{const se=R(U,W),de=R(j,Z),ge=R(Y,$);T.emplaceBack(se,de,ge)}}return z(0,0,hc,hc,hc,0),z(hc,hc,0,0,0,hc),{vertices:S,indices:T}}(this.tileID.canonical,r);u=p.vertices,h=p.indices}else{u=new je,h=new Nn;for(const{x:g,y:v}of l)u.emplaceBack(g,v,0,0);const p=I2(u.int16,void 0,4);for(let g=0;g<p.length;g+=3)h.emplaceBack(p[g],p[g+1],p[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(u,xP.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(h),this._tileBoundsSegments=Ha.simpleSegment(0,0,u.length,h.length)}_makeGlobeTileDebugBuffers(t,r){const l=r.projection;if(!l||l.name!=="globe"||r.freezeTileCoverage)return;const u=this.tileID.canonical,h=ym(Fz(u,r)),p=mo(r.zoom);let g;p>0&&(g=nt.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,u,r,h,g,p),this._makeGlobeTileDebugTextBuffer(t,u,r,h,g,p)}_globePoint(t,r,l,u,h,p,g){let v=K_(t,r,l);if(p){const b=1<<l.z,x=go(u.center.lng),S=Eo(u.center.lat),T=(l.x+.5)/b-x;let P=0;T>.5?P=-1:T<-.5&&(P=1);let R=(t/dt+l.x)/b+P,z=(r/dt+l.y)/b;R=(R-x)*u._pixelsPerMercatorPixel+x,z=(z-S)*u._pixelsPerMercatorPixel+S;const U=[R*u.worldSize,z*u.worldSize,0];ke.transformMat4(U,U,p),v=Kd(v,U,g)}return ke.transformMat4(v,v,h)}_makeGlobeTileDebugBorderBuffer(t,r,l,u,h,p){const g=new J,v=new H_,b=new ie,x=(T,P,R,z,U)=>{const W=(R-T)/(U-1),j=(z-P)/(U-1),Z=g.length;for(let Y=0;Y<U;Y++){const $=T+Y*W,K=P+Y*j;g.emplaceBack($,K);const ae=this._globePoint($,K,r,l,u,h,p);b.emplaceBack(ae[0],ae[1],ae[2]),v.emplaceBack(Z+Y)}},S=dt;x(0,0,S,0,16),x(S,0,S,S,16),x(S,S,0,S,16),x(0,S,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,ff.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,Iz.members),this._tileDebugSegments=Ha.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugTextBuffer(t,r,l,u,h,p){const g=dt/4,v=new J,b=new Nn,x=new ie,S=25;b.reserve(32),v.reserve(S),x.reserve(S);const T=(P,R)=>S*P+R;for(let P=0;P<S;P++){const R=P*g;for(let z=0;z<S;z++){const U=z*g;v.emplaceBack(U,R);const W=this._globePoint(U,R,r,l,u,h,p);x.emplaceBack(W[0],W[1],W[2])}}for(let P=0;P<4;P++)for(let R=0;R<4;R++){const z=T(P,R),U=T(P,R+1),W=T(P+1,R),j=T(P+1,R+1);b.emplaceBack(z,U,W),b.emplaceBack(W,U,j)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(v,ff.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(x,Iz.members),this._tileDebugTextSegments=Ha.simpleSegment(0,0,S,32)}}class Nte{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,l){const u=t.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const h={value:r,timeout:void 0};if(l!==void 0&&(h.timeout=setTimeout(()=>{this.remove(t,h)},l)),this.data[u].push(h),this.order.push(u),this.order.length>this.max){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const l=t.wrapped().key,u=r===void 0?0:this.data[l].indexOf(r),h=this.data[l][u];return this.data[l].splice(u,1),h.timeout&&clearTimeout(h.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(h.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const l in this.data)for(const u of this.data[l])t(u.value)||r.push(u);for(const l of r)this.remove(l.value.tileID,l)}}class Ef{constructor(t,r,l,u){this.id=Ef.uniqueIdxCounter,Ef.uniqueIdxCounter++,this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||u||r.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Ef.uniqueIdxCounter,Ef.uniqueIdxCounter++;const r=this.context.gl;this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Ef.uniqueIdxCounter=0;const Bte={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ute{constructor(t,r,l,u,h,p){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.instanceCount=p,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||h||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let l=0;l<this.attributes.length;l++){const u=r.attributes[this.attributes[l].name];u!==void 0&&t.enableVertexAttribArray(u)}}setVertexAttribPointers(t,r,l){for(let u=0;u<this.attributes.length;u++){const h=this.attributes[u],p=r.attributes[h.name];p!==void 0&&t.vertexAttribPointer(p,h.components,t[Bte[h.type]],!1,this.itemSize,h.offset+this.itemSize*(l||0))}}setVertexAttribDivisor(t,r,l){for(let u=0;u<this.attributes.length;u++){const h=r.attributes[this.attributes[u].name];h!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(h,l)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class hi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wte extends hi{getDefault(){return xn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Vte extends hi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Gte extends hi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Hte extends hi{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class jte extends hi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class $te extends hi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class qte extends hi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Xte extends hi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Zte extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class Yte extends hi{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Kte extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class Jte extends hi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Qte extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class ene extends hi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class tne extends hi{getDefault(){return xn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class nne extends hi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class ane extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class ine extends hi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class rne extends hi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let one=class extends hi{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}};class sne extends hi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class lne extends hi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class cne extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class une extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class dne extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class hne extends hi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class fne extends hi{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class pne extends hi{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class mne extends hi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class gne extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class yne extends hi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class wP extends hi{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class vne extends wP{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class fN extends wP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class _ne extends wP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class bne extends fN{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class xne{constructor(t,r,l,u,h){this.context=t,this.width=r,this.height=l;const p=this.framebuffer=t.gl.createFramebuffer();u&&(this.colorAttachment=new vne(t,p)),h&&(this.depthAttachmentType=h,this.depthAttachment=h==="renderbuffer"?new fN(t,p):new _ne(t,p))}destroy(){const t=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&t.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&t.deleteTexture(r)}t.deleteFramebuffer(this.framebuffer)}}class zn{constructor(t,r,l){this.func=t,this.mask=r,this.range=l}}zn.ReadOnly=!1,zn.ReadWrite=!0,zn.disabled=new zn(519,zn.ReadOnly,[0,1]);const SP=7680;class oa{constructor(t,r,l,u,h,p){this.test=t,this.ref=r,this.mask=l,this.fail=u,this.depthFail=h,this.pass=p}}oa.disabled=new oa({func:519,mask:0},0,0,SP,SP,SP);const n3=771;class Aa{constructor(t,r,l,u){this.blendFunction=t,this.blendColor=r,this.mask=l,this.blendEquation=u}}Aa.Replace=[1,0,1,0],Aa.disabled=new Aa(Aa.Replace,xn.transparent,[!1,!1,!1,!1]),Aa.unblended=new Aa(Aa.Replace,xn.transparent,[!0,!0,!0,!0]),Aa.alphaBlended=new Aa([1,n3,1,n3],xn.transparent,[!0,!0,!0,!0]),Aa.multiply=new Aa([774,0,774,0],xn.transparent,[!0,!0,!0,!0]);const AP=1029,EP=2305;class la{constructor(t,r,l){this.enable=t,this.mode=r,this.frontFace=l}}la.disabled=new la(!1,AP,EP),la.backCCW=new la(!0,AP,EP),la.backCW=new la(!0,AP,2304),la.frontCW=new la(!0,1028,2304),la.frontCCW=new la(!0,1028,EP);class wne{constructor(t){this.gl=t,this.clearColor=new Wte(this),this.clearDepth=new Vte(this),this.clearStencil=new Gte(this),this.colorMask=new Hte(this),this.depthMask=new jte(this),this.stencilMask=new $te(this),this.stencilFunc=new qte(this),this.stencilOp=new Xte(this),this.stencilTest=new Zte(this),this.depthRange=new Yte(this),this.depthTest=new Kte(this),this.depthFunc=new Jte(this),this.blend=new Qte(this),this.blendFunc=new ene(this),this.blendColor=new tne(this),this.blendEquation=new nne(this),this.cullFace=new ane(this),this.cullFaceSide=new ine(this),this.frontFace=new rne(this),this.program=new one(this),this.activeTexture=new sne(this),this.viewport=new lne(this),this.bindFramebuffer=new cne(this),this.bindRenderbuffer=new une(this),this.bindTexture=new dne(this),this.bindVertexBuffer=new hne(this),this.bindElementBuffer=new fne(this),this.bindVertexArrayOES=new pne(this),this.pixelStoreUnpack=new mne(this),this.pixelStoreUnpackPremultiplyAlpha=new gne(this),this.pixelStoreUnpackFlipY=new yne(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r,l){return new Ef(this,t,r,l)}createVertexBuffer(t,r,l,u,h){return new Ute(this,t,r,l,u,h)}createRenderbuffer(t,r,l){const u=this.gl,h=u.createRenderbuffer();return this.bindRenderbuffer.set(h),u.renderbufferStorage(u.RENDERBUFFER,t,r,l),this.bindRenderbuffer.set(null),h}createFramebuffer(t,r,l,u){return new xne(this,t,r,l,u)}clear({color:t,depth:r,stencil:l,colorMask:u}){const h=this.gl;let p=0;t&&(p|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(u||[!0,!0,!0,!0])),r!==void 0&&(p|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Q(t.blendFunction,Aa.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Hc extends Bn{constructor(t,r,l){super(),this.id=t,this._onlySymbols=l,r.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Nte(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Hee,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const r=this._tiles[t];if(r.state!=="errored"&&(r.state!=="loaded"||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,r){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,r)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(t),l.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Ke(this._tiles).map(t=>t.tileID).sort(pN).map(t=>t.key)}getRenderableIds(t,r){const l=[];for(const u in this._tiles)this._isIdRenderable(+u,t,r)&&l.push(this._tiles[u]);return t?l.sort((u,h)=>{const p=u.tileID,g=h.tileID,v=new V(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),b=new V(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-g.overscaledZ||b.y-v.y||b.x-v.x}).map(u=>u.tileID.key):l.map(u=>u.tileID).sort(pN).map(u=>u.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r,l){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())&&(l||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,r){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=r),this._loadTile(l,this._tileLoaded.bind(this,l,t,r)))}_tileLoaded(t,r,l,u){if(u)if(t.state="errored",u.status!==404)this._source.fire(new vn(u,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const h=this.map.painter.terrain;this.update(this.transform,h.getScaledDemTileSize(),!0),h.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Cn.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Ht("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const h=r[u];if(t.neighboringTiles&&t.neighboringTiles[h]){const p=this.getTileByID(h);l(t,p),l(p,t)}}function l(u,h){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let p=h.tileID.canonical.x-u.tileID.canonical.x;const g=h.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),b=h.tileID.key;p===0&&g===0||Math.abs(g)>1||(Math.abs(p)>1&&(Math.abs(p+v)===1?p+=v:Math.abs(p-v)===1&&(p-=v)),h.dem&&u.dem&&(u.dem.backfillBorder(h.dem,p,g),u.neighboringTiles&&u.neighboringTiles[b]&&(u.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,l,u){for(const h in this._tiles){let p=this._tiles[h];if(u[h]||!p.hasData()||p.tileID.overscaledZ<=r||p.tileID.overscaledZ>l)continue;let g=p.tileID;for(;p&&p.tileID.overscaledZ>r+1;){const b=p.tileID.scaledTo(p.tileID.overscaledZ-1);p=this._tiles[b.key],p&&p.hasData()&&(g=b)}let v=g;for(;v.overscaledZ>r;)if(v=v.scaledTo(v.overscaledZ-1),t[v.key]){u[g.key]=g;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=t.overscaledZ-1;l>=r;l--){const u=t.scaledTo(l),h=this._getLoadedTile(u);if(h)return h}}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,r){r=r||this._source.tileSize;const l=Math.ceil(t.width/r)+1,u=Math.ceil(t.height/r)+1,h=Math.floor(l*u*5),p=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,h):h,g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(t){const r=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,r){const l={};for(const u in this._tiles){const h=this._tiles[u];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+r),l[h.tileID.key]=h}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(t,r,l,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;if(this.updateCacheSize(t,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Ta(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[],h.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!MP(this._source.type)){const v=t.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!l}),b=Math.min(v,this._source.maxzoom),x=t.extendTileCoverForShadows(h,u,b);for(const S of x)this._shadowCasterTiles[S.key]=!0,h.push(S)}const p=this._updateRetainedTiles(h);if(MP(this._source.type)&&h.length!==0){const v={},b={},x=Object.keys(p);for(const T of x){const P=p[T],R=this._tiles[T];if(!R||R.fadeEndTime&&R.fadeEndTime<=Cn.now())continue;const z=this.findLoadedParent(P,Math.max(P.overscaledZ-Hc.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),v[z.tileID.key]=z.tileID),b[T]=P}const S=h[h.length-1].overscaledZ;for(const T in this._tiles){const P=this._tiles[T];if(p[T]||!P.hasData())continue;let R=P.tileID;for(;R.overscaledZ>S;){R=R.scaledTo(R.overscaledZ-1);const z=this._tiles[R.key];if(z&&z.hasData()&&b[R.key]){p[T]=P.tileID;break}}}for(const T in v)p[T]||(this._coveredTiles[T]=!0,p[T]=v[T])}for(const v in p)this._tiles[v].clearFadeHold();const g=function(v,b){const x=[];for(const S in v)S in b||x.push(S);return x}(this._tiles,p);for(const v of g){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const r={};if(t.length===0)return r;const l={},u=t.reduce((b,x)=>Math.min(b,x.overscaledZ),1/0),h=t[0].overscaledZ,p=Math.max(h-Hc.maxOverzooming,this._source.minzoom),g=Math.max(h+Hc.maxUnderzooming,this._source.minzoom),v={};for(const b of t){const x=this._addTile(b);r[b.key]=b,x.hasData()||u<this._source.maxzoom&&(v[b.key]=b)}this._retainLoadedChildren(v,u,g,r);for(const b of t){let x=this._tiles[b.key];if(x.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const T=b.children(this._source.maxzoom)[0],P=this.getTile(T);if(P&&P.hasData()){r[T.key]=T;continue}}else{const T=b.children(this._source.maxzoom);if(r[T[0].key]&&r[T[1].key]&&r[T[2].key]&&r[T[3].key])continue}let S=x.wasRequested();for(let T=b.overscaledZ-1;T>=p;--T){const P=b.scaledTo(T);if(l[P.key]||(l[P.key]=!0,x=this.getTile(P),!x&&S&&(x=this._addTile(P)),x&&(r[P.key]=P,S=x.wasRequested(),x.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let l,u=this._tiles[t].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}r.push(u.key);const h=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(h),l)break;u=h}for(const h of r)this._loadedParentTiles[h]=l}}_addTile(t){let r=this._tiles[t.key];if(r)return r.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const l=!!r;if(!l){const u=this.map?this.map.painter:null;r=new h1(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))}return r?(r.uses++,this._tiles[t.key]=r,l||this._source.fire(new Ht("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=r.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,r,l){const u=[],h=this.transform;if(!h)return u;const p=h.projection.name==="globe",g=go(h.center.lng);for(const v in this._tiles){const b=this._tiles[v];if(l&&b.clearQueryDebugViz(),b.holdingForFade())continue;let x;if(p){const S=b.tileID.canonical;if(S.z===0){const T=[Math.abs(ne(g,...f1(S,-1))-g),Math.abs(ne(g,...f1(S,1))-g)];x=[0,2*T.indexOf(Math.min(...T))-1]}else{const T=[Math.abs(ne(g,...f1(S,-1))-g),Math.abs(ne(g,...f1(S,0))-g),Math.abs(ne(g,...f1(S,1))-g)];x=[T.indexOf(Math.min(...T))-1]}}else x=[0];for(const S of x){const T=t.containsTile(b,h,r,S);T&&u.push(T)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,r){const l=this.getRenderableIds(t,r).map(u=>this._tiles[u].tileID);for(const u of l)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return l}sortCoordinatesByDistance(t){const r=t.slice(),l=this.transform._camera.position,u=this.transform._camera.forward(),h={};for(const p of r){const g=1/(1<<p.canonical.z);h[p.key]=((p.canonical.x+.5)*g+p.wrap-l[0])*u[0]+((p.canonical.y+.5)*g-l[1])*u[1]-l[2]*u[2]}return r.sort((p,g)=>h[p.key]-h[g.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(MP(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Cn.now())return!0}return!1}setFeatureState(t,r,l){this._state.updateState(t=t||"_geojsonTileLayer",r,l)}removeFeatureState(t,r,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,l)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,l){const u=this._tiles[t];u&&u.setDependencies(r,l)}reloadTilesForDependencies(t,r){for(const l in this._tiles)this._tiles[l].hasDependency(t,r)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,r))}_preloadTiles(t,r){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,r))};return void this._source.on("data",g)}const l=new Map,u=Array.isArray(t)?t:[t],h=this.map.painter.terrain,p=this.usedForTerrain&&h?h.getScaledDemTileSize():this._source.tileSize;for(const g of u){const v=g.coveringTiles({tileSize:p,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of v)l.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}Xe(Array.from(l.values()),(g,v)=>{const b=new h1(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,x=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),v(x,b)})},r)}}function pN(i,t){const r=Math.abs(2*i.wrap)-+(i.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return i.overscaledZ-t.overscaledZ||l-r||t.canonical.y-i.canonical.y||t.canonical.x-i.canonical.x}function MP(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function f1(i,t){const r=1<<i.z;return[i.x/r+t,(i.x+1)/r+t]}Hc.maxOverzooming=10,Hc.maxUnderzooming=3;const Sne=N([{name:"a_pos_3f",components:3,type:"Float32"}]),Ane=N([{name:"a_color_3f",components:3,type:"Float32"}]),Ene=N([{name:"a_color_4f",components:4,type:"Float32"}]),Mne=N([{name:"a_uv_2f",components:2,type:"Float32"}]),Tne=N([{name:"a_normal_3f",components:3,type:"Float32"}]),Cne=N([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Pne=N([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class TP{constructor(t=0,r=0,l=0,u=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=l,this.right=u}interpolate(t,r,l){return r.top!=null&&t.top!=null&&(this.top=Ln(t.top,r.top,l)),r.bottom!=null&&t.bottom!=null&&(this.bottom=Ln(t.bottom,r.bottom,l)),r.left!=null&&t.left!=null&&(this.left=Ln(t.left,r.left,l)),r.right!=null&&t.right!=null&&(this.right=Ln(t.right,r.right,l)),this}getCenter(t,r){const l=ne((this.left+t-this.right)/2,0,t),u=ne((this.top+r-this.bottom)/2,0,r);return new V(l,u)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new TP(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function mN(i,t){const r=At(i,3);nt.fromQuat(i,t),Ut(i,3,r)}function CP(i,t){const r=Ao.identity([]);return Ao.rotateZ(r,r,-t),Ao.rotateX(r,r,-i),r}function gN(i,t){const r=[i[0],i[1],0],l=[t[0],t[1],0];if(ke.length(r)>=1e-15){const p=ke.normalize([],r);ke.scale(l,p,ke.dot(l,p)),t[0]=l[0],t[1]=l[1]}const u=ke.cross([],t,i);if(ke.len(u)<1e-15)return null;const h=Math.atan2(-u[1],u[0]);return CP(Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2]),h)}class yN{constructor(t,r){this.position=t,this.orientation=r}get position(){return this._position}set position(t){if(t){const r=t instanceof ga?t:new ga(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=Ye(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const l=this.position,u=this._elevation?this._elevation.getAtPointOrZero(ga.fromLngLat(t)):0,h=ga.fromLngLat(t,u),p=[h.x-l.x,h.y-l.y,h.z-l.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=gN(p,r)}setPitchBearing(t,r){this.orientation=CP(be(t),be(-r))}}class a3{constructor(t,r){this._transform=nt.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new ga(t[0],t[1],t[2])}get position(){const t=At(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&Ut(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Ao.identity([]),t&&mN(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,r){this._orientation=CP(t,r),mN(this._transform,this._orientation)}forward(){const t=At(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=At(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=At(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const l=new Float64Array(16);return nt.invert(l,this.getWorldToCamera(t,r)),l}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,r,l){const u=this.position;ke.scale(u,u,-t);const h=new Float64Array(16);return nt.fromScaling(h,[l,l,l]),nt.translate(h,h,u),h[10]*=r,h}getWorldToCamera(t,r){const l=new Float64Array(16),u=new Float64Array(4),h=this.position;return Ao.conjugate(u,this._orientation),ke.scale(h,h,-t),nt.fromQuat(l,u),nt.translate(l,l,h),l[1]*=-1,l[5]*=-1,l[9]*=-1,l[13]*=-1,l[8]*=r,l[9]*=r,l[10]*=r,l[11]*=r,l}getCameraToClipPerspective(t,r,l,u){const h=new Float64Array(16);return nt.perspective(h,t,r,l,u),h}getCameraToClipOrthographic(t,r,l,u,h,p){const g=new Float64Array(16);return nt.ortho(g,t,r,l,u,h,p),g}getDistanceToElevation(t,r=!1){const l=t===0?0:ja(t,r?pr(this.position[1]):this.position[1]),u=this.forward();return(l-this.position[2])/u[2]}clone(){return new a3([...this.position],[...this.orientation])}}function vN(i,t){const r=p1(i.projection,i.zoom,i.width,i.height),l=function(h,p,g,v,b){const x=new On(g.lng-180*Mf,g.lat),S=new On(g.lng+180*Mf,g.lat),T=h.project(x.lng,x.lat),P=h.project(S.lng,S.lat),R=-Math.atan2(P.y-T.y,P.x-T.x),z=ga.fromLngLat(g);z.y=ne(z.y,-1+Mf,1-Mf);const U=z.toLngLat(),W=h.project(U.lng,U.lat),j=ga.fromLngLat(U);j.x+=Mf;const Z=j.toLngLat(),Y=h.project(Z.lng,Z.lat),$=xN(Y.x-W.x,Y.y-W.y,R),K=ga.fromLngLat(U);K.y+=Mf;const ae=K.toLngLat(),se=h.project(ae.lng,ae.lat),de=xN(se.x-W.x,se.y-W.y,R),ge=Math.abs($.x)/Math.abs(de.y),Te=nt.identity([]);nt.rotateZ(Te,Te,-R*(1-(b?0:v)));const we=nt.identity([]);return nt.scale(we,we,[1,1-(1-ge)*v,1]),we[4]=-de.x/de.y*v,nt.rotateZ(we,we,R),nt.multiply(we,Te,we),we}(i.projection,0,i.center,r,t),u=_N(i);return nt.scale(l,l,[u,u,1]),l}function _N(i){const t=i.projection,r=p1(i.projection,i.zoom,i.width,i.height),l=bN(t,i.center),u=bN(t,On.convert(t.center));return Math.pow(2,l*r+(1-r)*u)}function p1(i,t,r,l,u=1/0){const h=i.range;if(!h)return 0;const p=Math.min(u,Math.max(r,l)),g=Math.log(p/1024)/Math.LN2;return Ee(h[0]+g,h[1]+g,t)}const Mf=1/4e4;function bN(i,t){const r=ne(t.lat,-ji,ji),l=new On(t.lng-180*Mf,r),u=new On(t.lng+180*Mf,r),h=i.project(l.lng,r),p=i.project(u.lng,r),g=ga.fromLngLat(l),v=ga.fromLngLat(u),b=p.x-h.x,x=p.y-h.y,S=v.x-g.x,T=v.y-g.y,P=Math.sqrt((S*S+T*T)/(b*b+x*x));return Math.log(P)/Math.LN2}function xN(i,t,r){const l=Math.cos(r),u=Math.sin(r);return{x:i*l-t*u,y:i*u+t*l}}function xm(i,t,r){return t*(dt/(i.tileSize*Math.pow(2,r-i.tileID.overscaledZ)))}const dv={unknown:0,flipRequired:1,flipNotRequired:2},Ine=Math.tan(85*Math.PI/180);function i3(i,t,r,l,u,h,p){const g=nt.create();if(r)if(h.name==="globe"){const v=function(b,x){const{x:S,y:T}=b.point,P=Wz(S,T,b.worldSize/b._pixelsPerMercatorPixel,0,0);return nt.multiply(P,P,BC(dc(x)))}(u,t);nt.multiply(g,g,v)}else{const v=Xy.invert([],p);g[0]=v[0],g[1]=v[1],g[4]=v[2],g[5]=v[3],l||nt.rotateZ(g,g,u.angle)}else nt.multiply(g,u.labelPlaneMatrix,i);return g}function wN(i,t,r,l,u,h,p){const g=i3(i,t,r,l,u,h,p);return h.name==="globe"&&r||(g[2]=g[6]=g[10]=g[14]=0),g}function SN(i,t,r,l,u,h,p){if(r){if(h.name==="globe"){const g=i3(i,t,r,l,u,h,p);return nt.invert(g,g),nt.multiply(g,i,g),g}{const g=nt.clone(i),v=nt.identity([]);return v[0]=p[0],v[1]=p[1],v[4]=p[2],v[5]=p[3],nt.multiply(g,g,v),l||nt.rotateZ(g,g,-u.angle),g}}return u.glCoordMatrix}function jc(i,t,r,l){const u=[i,t,r,1];r?Va.transformMat4(u,u,l):IN(u,u,l);const h=u[3];return u[0]/=h,u[1]/=h,u[2]/=h,u}function AN(i,t){return Math.min(.5+i/t*.5,1.5)}function Lne(i,t){const r=i[0]/i[3],l=i[1]/i[3];return r>=-t[0]&&r<=t[0]&&l>=-t[1]&&l<=t[1]}function Rne(i,t,r,l,u,h,p,g,v,b){const x=r.transform,S=l?i.textSizeData:i.iconSizeData,T=Vu(S,r.transform.zoom),P=x.projection.name==="globe",R=[256/r.width*2+1,256/r.height*2+1],z=l?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;z.clear();let U=null;P&&(U=l?i.text.globeExtVertexArray:i.icon.globeExtVertexArray);const W=i.lineVertexArray,j=l?i.text.placedSymbolArray:i.icon.placedSymbolArray,Z=r.transform.width/r.transform.height;let Y,$=!1;for(let K=0;K<j.length;K++){const ae=j.get(K),{numGlyphs:se,writingMode:de}=ae;if(de!==_i.vertical||$||Y===_i.horizontal||($=!0),Y=de,(ae.hidden||de===_i.vertical)&&!$){hv(se,z);continue}$=!1;const ge=new V(ae.tileAnchorX,ae.tileAnchorY);let{x:Te,y:we,z:Ie}=x.projection.projectTilePoint(ge.x,ge.y,b.canonical);if(v){const[Ct,zt,bt]=v(ge);Te+=Ct,we+=zt,Ie+=bt}const xe=[Te,we,Ie,1];if(Va.transformMat4(xe,xe,t),!Lne(xe,R)){hv(se,z);continue}const We=xe[3],qe=AN(r.transform.getCameraToCenterDistance(x.projection),We),Qe=n1(S,T,ae),Ne=p?Qe/qe:Qe*qe,Ve=jc(Te,we,Ie,u);if(Ve[3]<=0){hv(se,z);continue}let at={};const mt=p?null:v,lt=TN(ae,Ne,!1,g,t,u,h,i.glyphOffsetArray,W,z,U,Ve,ge,at,Z,mt,x.projection,b,p);$=lt.useVertical,mt&&lt.needsFlipping&&(at={}),(lt.notEnoughRoom||$||lt.needsFlipping&&TN(ae,Ne,!0,g,t,u,h,i.glyphOffsetArray,W,z,U,Ve,ge,at,Z,mt,x.projection,b,p).notEnoughRoom)&&hv(se,z)}l?(i.text.dynamicLayoutVertexBuffer.updateData(z),U&&i.text.globeExtVertexBuffer&&i.text.globeExtVertexBuffer.updateData(U)):(i.icon.dynamicLayoutVertexBuffer.updateData(z),U&&i.icon.globeExtVertexBuffer&&i.icon.globeExtVertexBuffer.updateData(U))}function EN(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z){const{lineStartIndex:U,glyphStartIndex:W,segment:j}=g,Z=W+g.numGlyphs,Y=U+g.lineLength,$=t.getoffsetX(W),K=t.getoffsetX(Z-1),ae=r3(i*$,r,l,u,h,p,j,U,Y,v,b,x,S,T,!0,P,R,z);if(!ae)return null;const se=r3(i*K,r,l,u,h,p,j,U,Y,v,b,x,S,T,!0,P,R,z);return se?{first:ae,last:se}:null}function MN(i,t,r,l){return i===_i.horizontal&&Math.abs(l)>Math.abs(r)?{useVertical:!0}:i===_i.vertical?l>0?{needsFlipping:!0}:null:t!==dv.unknown&&function(u,h){return u===0||Math.abs(h/u)>Ine}(r,l)?t===dv.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function TN(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j){const Z=t/24,Y=i.lineOffsetX*Z,$=i.lineOffsetY*Z,{lineStartIndex:K,glyphStartIndex:ae,numGlyphs:se,segment:de,writingMode:ge,flipState:Te}=i,we=K+i.lineLength,Ie=xe=>{if(x){const[Ne,Ve,at]=xe.up,mt=b.length;K2(x,mt+0,Ne,Ve,at),K2(x,mt+1,Ne,Ve,at),K2(x,mt+2,Ne,Ve,at),K2(x,mt+3,Ne,Ve,at)}const[We,qe,Qe]=xe.point;uv(b,We,qe,Qe,xe.angle)};if(se>1){const xe=EN(Z,g,Y,$,r,S,T,i,v,h,P,z,!1,U,W,j);if(!xe)return{notEnoughRoom:!0};if(l&&!r){let[We,qe,Qe]=xe.first.point,[Ne,Ve,at]=xe.last.point;[We,qe]=jc(We,qe,Qe,p),[Ne,Ve]=jc(Ne,Ve,at,p);const mt=MN(ge,Te,(Ne-We)*R,Ve-qe);if(i.flipState=mt&&mt.needsFlipping?dv.flipRequired:dv.flipNotRequired,mt)return mt}Ie(xe.first);for(let We=ae+1;We<ae+se-1;We++){const qe=r3(Z*g.getoffsetX(We),Y,$,r,S,T,de,K,we,v,h,P,z,!1,!1,U,W,j);if(!qe)return b.length-=4*(We-ae),{notEnoughRoom:!0};Ie(qe)}Ie(xe.last)}else{if(l&&!r){const We=jc(T.x,T.y,0,u),qe=K+de+1,Qe=new V(v.getx(qe),v.gety(qe)),Ne=jc(Qe.x,Qe.y,0,u),Ve=Ne[3]>0?Ne:PN(T,Qe,We,1,u,void 0,U,W.canonical),at=MN(ge,Te,(Ve[0]-We[0])*R,Ve[1]-We[1]);if(i.flipState=at&&at.needsFlipping?dv.flipRequired:dv.flipNotRequired,at)return at}const xe=r3(Z*g.getoffsetX(ae),Y,$,r,S,T,de,K,we,v,h,P,z,!1,!1,U,W,j);if(!xe)return{notEnoughRoom:!0};Ie(xe)}return{}}function CN(i,t,r,l,u){const{x:h,y:p,z:g}=l.projectTilePoint(i.x,i.y,t);if(!u)return jc(h,p,g,r);const[v,b,x]=u(i);return jc(h+v,p+b,g+x,r)}function PN(i,t,r,l,u,h,p,g){const v=CN(i.sub(t)._unit()._add(i),g,u,p,h);return ke.sub(v,r,v),ke.normalize(v,v),ke.scaleAndAdd(v,r,v,l)}function r3(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W){const j=l?i-t:i+t;let Z=j>0?1:-1,Y=0;l&&(Z*=-1,Y=Math.PI),Z<0&&(Y+=Math.PI);let $=g+p+(Z>0?0:1)|0,K=u,ae=u,se=0,de=0;const ge=Math.abs(j),Te=[],we=[];let Ie=h,xe=Ie;const We=()=>PN(xe,Ie,ae,ge-se+1,x,T,z,U.canonical);for(;se+de<=ge;){if($+=Z,$<g||$>=v)return null;if(ae=K,xe=Ie,Te.push(ae),P&&we.push(xe),Ie=new V(b.getx($),b.gety($)),K=S[$],!K){const zt=CN(Ie,U.canonical,x,z,T);K=zt[3]>0?S[$]=zt:We()}se+=de,de=ke.distance(ae,K)}R&&T&&(S[$]&&(K=We(),de=ke.distance(ae,K)),S[$]=K);const qe=(ge-se)/de,Qe=Ie.sub(xe)._mult(qe)._add(xe),Ne=ke.sub([],K,ae),Ve=ke.scaleAndAdd([],ae,Ne,qe);let at=[0,0,1],mt=Ne[0],lt=Ne[1];if(W&&(at=z.upVector(U.canonical,Qe.x,Qe.y),at[0]!==0||at[1]!==0||at[2]!==1)){const zt=[at[2],0,-at[0]],bt=ke.cross([],at,zt);ke.normalize(zt,zt),ke.normalize(bt,bt),mt=ke.dot(Ne,zt),lt=ke.dot(Ne,bt)}if(r){const zt=ke.cross([],at,Ne);ke.normalize(zt,zt),ke.scaleAndAdd(Ve,Ve,zt,r*Z)}const Ct=Y+Math.atan2(lt,mt);return Te.push(Ve),P&&we.push(Qe),{point:Ve,angle:Ct,path:Te,tilePath:we,up:at}}function hv(i,t){const r=t.length,l=r+4*i;t.resize(l),t.float32.fill(-1/0,4*r,4*l)}function IN(i,t,r){const l=t[0],u=t[1];return i[0]=r[0]*l+r[4]*u+r[12],i[1]=r[1]*l+r[5]*u+r[13],i[3]=r[3]*l+r[7]*u+r[15],i}const LN=(i,t,r)=>(1-r)*i+r*t,RN=i=>i*i*i*i*i;class PP{constructor(t,r,l,u,h,p,g){this.tileSize=512,this._renderWorldCopies=h===void 0||h,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=l??0,this._maxPitch=u??60,this.setProjection(p),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new On(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new TP,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new a3,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new PP(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t,r=!1){const l=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||l)&&this._updateCameraOnTerrain(),(t||l)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return ht(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=$2(this.projectionOptions);const l=!Q(r,this.getProjection());return l&&this._calcMatrices(),this.mercatorFromTransition=!1,l}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=$2({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return ja(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new V(this.width,this.height)}get bearing(){return Ye(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Xy.create(),Xy.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=ne(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=be(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,r=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!r||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;r||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&l.exaggeration()&&this._centerAltitudeValidForExaggeration!==l.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*l.exaggeration(),this._centerAltitudeValidForExaggeration=l.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=l.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],l=this.horizonLineFromTop();let u=0,h=0;for(let p=0;p<r.length;p++){const g=new V(r[p][0]*this.width,l+r[p][1]*(this.height-l)),v=t.pointCoordinate(g);if(!v)continue;const b=1/Math.hypot(v[0]-this._camera.position[0],v[1]-this._camera.position[1]);u+=v[3]*b,h+=b}return h===0?NaN:u/h}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),l=this.pixelsPerMeter/this.worldSize*r,u=this._mercatorZfromZoom(t),h=this._mercatorZfromZoom(this._maxZoom),p=Math.max(u-l,h);this._setZoom(this._zoomFromMercatorZ(p))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let l;l=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const u=ke.length(ke.sub([],this._camera.position,l));return ne(this._zoomFromMercatorZ(u),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!Ao.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const l=[t.position.x,t.position.y,t.position.z];ke.exactEquals(l,this._camera.position)||(this._setCameraPosition(l),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new yN;return r.position=new ga(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!Ao.length(t))return!1;Ao.normalize(t,t);const r=ke.transformQuat([],[0,0,-1],t),l=ke.transformQuat([],[0,-1,0],t);if(l[2]<0)return!1;const u=gN(r,l);return!!u&&(this._camera.orientation=u,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,l=this.zoomScale(this.maxZoom)*this.tileSize,u=this.cameraToCenterDistance;t[2]=ne(t[2],u/l,u/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,l){this._unmodified=!1,this._edgeInsets.interpolate(t,r,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(t){const r=[new kC(0,t)];if(this.renderWorldCopies){const l=this.pointCoordinate(new V(0,0)),u=this.pointCoordinate(new V(this.width,0)),h=this.pointCoordinate(new V(this.width,this.height)),p=this.pointCoordinate(new V(0,this.height)),g=Math.floor(Math.min(l.x,u.x,h.x,p.x)),v=Math.floor(Math.max(l.x,u.x,h.x,p.x)),b=1;for(let x=g-b;x<=v+b;x++)x!==0&&r.push(new kC(x,t))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,r,l){let u=[];if(r[0]===0&&r[1]===0)return u;for(const p of t){const g=p.canonical,v=p.overscaledZ,b=p.wrap,x=1<<g.z,S=g.x+1<x,T=g.x>0,P=g.y+1<x,R=g.y>0,z=p.wrap-(T?0:1),U=p.wrap+(S?0:1),W=T?g.x-1:x-1,j=S?g.x+1:0;r[0]<0?(u.push(new Ta(v,U,g.z,j,g.y)),r[1]<0&&P&&(u.push(new Ta(v,b,g.z,g.x,g.y+1)),u.push(new Ta(v,U,g.z,j,g.y+1))),r[1]>0&&R&&(u.push(new Ta(v,b,g.z,g.x,g.y-1)),u.push(new Ta(v,U,g.z,j,g.y-1)))):r[0]>0?(u.push(new Ta(v,z,g.z,W,g.y)),r[1]<0&&P&&(u.push(new Ta(v,b,g.z,g.x,g.y+1)),u.push(new Ta(v,z,g.z,W,g.y+1))),r[1]>0&&R&&(u.push(new Ta(v,b,g.z,g.x,g.y-1)),u.push(new Ta(v,z,g.z,W,g.y-1)))):r[1]<0&&P?u.push(new Ta(v,b,g.z,g.x,g.y+1)):R&&u.push(new Ta(v,b,g.z,g.x,g.y-1))}if(u.length>1){u.sort((v,b)=>v.overscaledZ-b.overscaledZ||v.wrap-b.wrap||v.canonical.z-b.canonical.z||v.canonical.x-b.canonical.x||v.canonical.y-b.canonical.y);let p=0,g=0;for(;g<u.length;)u[g].equals(u[p])?++g:u[++p]=u[g++];u.length=p+1}const h=[];for(const p of u)u.some(g=>p.isChildOf(g))||h.push(p);return u=h.filter(p=>!t.some(g=>!!(p.overscaledZ<l&&g.isChildOf(p))||p.equals(g)||p.isChildOf(g))),u}coveringTiles(t){let r=this.coveringZoomLevel(t);const l=r,u=this.elevation&&this.elevation.exaggeration(),h=u&&!t.isTerrainDEM,p=this.projection.name==="mercator";if(t.minzoom!==void 0&&r<t.minzoom)return[];t.maxzoom!==void 0&&r>t.maxzoom&&(r=t.maxzoom);const g=this.locationCoordinate(this.center),v=this.center.lat,b=1<<r,x=[b*g.x,b*g.y,0],S=this.projection.name==="globe",T=!S,P=Yd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,T),R=S?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),z=b*ja(1,this.center.lat),U=this._camera.position[2]/ja(1,this.center.lat),W=[b*R.x,b*R.y,U*(T?1:z)],j=S||u,Z=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Y=this.isLODDisabled(!0)?r:0,$=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,K=t.isTerrainDEM?-$:this._elevation?this._elevation.getMinElevationBelowMSL():0,ae=this.projection.isReprojectedInTileSpace?_N(this):1,se=Ne=>{const at=new ga(Ne.x+25e-6,Ne.y,Ne.z),mt=new ga(Ne.x,Ne.y+25e-6,Ne.z),lt=Ne.toLngLat(),Ct=at.toLngLat(),zt=mt.toLngLat(),bt=this.locationCoordinate(lt),Et=this.locationCoordinate(Ct),en=this.locationCoordinate(zt),on=Math.hypot(Et.x-bt.x,Et.y-bt.y),rn=Math.hypot(en.x-bt.x,en.y-bt.y);return Math.sqrt(on*rn)*ae/25e-6},de=Ne=>{const Ve=$,at=K;return{aabb:aN(this,b,0,0,0,Ne,at,Ve,this.projection),zoom:0,x:0,y:0,minZ:at,maxZ:Ve,wrap:Ne,fullyVisible:!1}},ge=[];let Te=[];const we=r,Ie=t.reparseOverscaled?l:r,xe=Ne=>Ne*Ne,We=xe((U-this._centerAltitude)*z),qe=Ne=>{if(!this._elevation||!Ne.tileID||!p)return;const Ve=this._elevation.getMinMaxForTile(Ne.tileID),at=Ne.aabb;Ve?(at.min[2]=Ve.min,at.max[2]=Ve.max,at.center[2]=(at.min[2]+at.max[2])/2):(Ne.shouldSplit=Qe(Ne),Ne.shouldSplit||(at.min[2]=at.max[2]=at.center[2]=this._centerAltitude))},Qe=Ne=>{if(Ne.zoom<Y)return!0;if(Ne.zoom===we)return!1;if(Ne.shouldSplit!=null)return Ne.shouldSplit;const Ve=Ne.aabb.distanceX(W),at=Ne.aabb.distanceY(W);let mt=We,lt=1;if(S){mt=xe(Ne.aabb.distanceZ(W));const bt=Math.pow(2,Ne.zoom),Et=pr((Ne.y+1)/bt),en=pr(Ne.y/bt),on=Math.min(Math.max(v,Et),en),rn=x2(on)/x2(v);if(lt=on===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,rn/this._mercatorScaleRatio),this.zoom<=Y_&&Ne.zoom===we-1&&rn>=.9)return!0}else if(h&&(mt=xe(Ne.aabb.distanceZ(W)*z)),this.projection.isReprojectedInTileSpace&&l<=5){const bt=Math.pow(2,Ne.zoom),Et=se(new ga((Ne.x+.5)/bt,(Ne.y+.5)/bt));lt=Et>.85?1:Et}const Ct=Ve*Ve+at*at+mt,zt=xe((1<<we-Ne.zoom)*Z*lt*((bt,Et)=>{if(Et*xe(.707)<bt)return 1;const en=Math.sqrt(Et/bt);return en/(1.4144271570014144+(Math.pow(1.1,en-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(mt,We),Ct));return Ct<zt};if(this.renderWorldCopies)for(let Ne=1;Ne<=3;Ne++)ge.push(de(-Ne)),ge.push(de(Ne));for(ge.push(de(0));ge.length>0;){const Ne=ge.pop(),Ve=Ne.x,at=Ne.y;let mt=Ne.fullyVisible;const lt=()=>this.projection.name==="globe"&&(Ne.y===0||Ne.y===(1<<Ne.zoom)-1);if(!mt){let Ct=j?Ne.aabb.intersects(P):Ne.aabb.intersectsFlat(P);if(Ct===0&&lt()){const zt=new Uu(Ne.zoom,Ve,at);Ct=FC(this,b,zt,!0).intersects(P)}if(Ct===0)continue;mt=Ct===2}if(Ne.zoom!==we&&Qe(Ne))for(let Ct=0;Ct<4;Ct++){const zt=(Ve<<1)+Ct%2,bt=(at<<1)+(Ct>>1),Et={aabb:p?Ne.aabb.quadrant(Ct):aN(this,b,Ne.zoom+1,zt,bt,Ne.wrap,Ne.minZ,Ne.maxZ,this.projection),zoom:Ne.zoom+1,x:zt,y:bt,wrap:Ne.wrap,fullyVisible:mt,tileID:void 0,shouldSplit:void 0,minZ:Ne.minZ,maxZ:Ne.maxZ};h&&!S&&(Et.tileID=new Ta(Ne.zoom+1===we?Ie:Ne.zoom+1,Ne.wrap,Ne.zoom+1,zt,bt),qe(Et)),ge.push(Et)}else{const Ct=Ne.zoom===we?Ie:Ne.zoom;if(t.minzoom&&t.minzoom>Ct)continue;if(!mt){let en=j?Ne.aabb.intersectsPrecise(P):Ne.aabb.intersectsPreciseFlat(P);if(en===0&&lt()){const on=new Uu(Ne.zoom,Ve,at);en=FC(this,b,on,!0).intersectsPrecise(P)}if(en===0)continue}const zt=x[0]-(.5+Ve+(Ne.wrap<<Ne.zoom))*(1<<r-Ne.zoom),bt=x[1]-.5-at,Et=Ne.tileID?Ne.tileID:new Ta(Ct,Ne.wrap,Ne.zoom,Ve,at);Te.push({tileID:Et,distanceSq:zt*zt+bt*bt})}}if(this.fogCullDistSq){const Ne=this.fogCullDistSq,Ve=this.horizonLineFromTop();Te=Te.filter(at=>{const mt=[0,0,0,1],lt=[dt,dt,0,1],Ct=this.calculateFogTileMatrix(at.tileID.toUnwrapped());Va.transformMat4(mt,mt,Ct),Va.transformMat4(lt,lt,Ct);const zt=function(en,on,rn){let cn=0;for(let gn=0;gn<2;++gn)en[gn]>0&&(cn+=(en[gn]-0)*(en[gn]-0)),on[gn]<0&&(cn+=(0-on[gn])*(0-on[gn]));return cn}(Va.min([],mt,lt),Va.max([],mt,lt));if(zt===0)return!0;let bt=!1;const Et=this._elevation;if(Et&&zt>Ne&&Ve!==0){const en=this.calculateProjMatrix(at.tileID.toUnwrapped());let on;t.isTerrainDEM||(on=Et.getMinMaxForTile(at.tileID)),on||(on={min:K,max:$});const rn=function(gn){const kn=Math.round((gn+45+360)%360/90)%4;return Ce[kn]}(this.rotation),cn=[rn[0]*dt,rn[1]*dt,on.max];ke.transformMat4(cn,cn,en),bt=(1-cn[1])*this.height*.5<Ve}return zt<Ne||bt})}return Te.sort((Ne,Ve)=>Ne.distanceSq-Ve.distanceSq).map(Ne=>Ne.tileID)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=ne(t.lat,-ji,ji),l=this.projection.project(t.lng,r);return new V(l.x*this.worldSize,l.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/ja(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let l,u;const h=this.centerPoint;if(this.projection.name==="globe"){const g=this.worldSize;l=(r.x-h.x)/g,u=(r.y-h.y)/g}else{const g=this.pointCoordinate(r),v=this.pointCoordinate(h);l=g.x-v.x,u=g.y-v.y}const p=this.locationCoordinate(t);this.setLocation(new ga(p.x-l,p.y-u))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,r){const l=r?ja(r,t.lat):void 0,u=this.projection.project(t.lng,t.lat);return new ga(u.x,u.y,l)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,r){const l=r??this._centerAltitude,u=[t.x,t.y,0,1],h=[t.x,t.y,1,1];Va.transformMat4(u,u,this.pixelMatrixInverse),Va.transformMat4(h,h,this.pixelMatrixInverse);const p=h[3];Va.scale(u,u,1/u[3]),Va.scale(h,h,1/p);const g=u[2],v=h[2];return{p0:u,p1:h,t:g===v?0:(l-g)/(v-g)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],l=[t.x,t.y,1,1];return Va.transformMat4(r,r,this.pixelMatrixInverse),Va.transformMat4(l,l,this.pixelMatrixInverse),Va.scale(r,r,1/r[3]),Va.scale(l,l,1/l[3]),r[2]=ja(r[2],this._center.lat)*this.worldSize,l[2]=ja(l[2],this._center.lat)*this.worldSize,Va.scale(r,r,1/this.worldSize),Va.scale(l,l,1/this.worldSize),new g2([r[0],r[1],r[2]],ke.normalize([],ke.sub([],l,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:l,t:u}=t,h=ja(r[2],this._center.lat),p=ja(l[2],this._center.lat);return new ga(Ln(r[0],l[0],u)/this.worldSize,Ln(r[1],l[1],u)/this.worldSize,Ln(h,p,u))}pointCoordinate(t,r=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,r)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new ga(r[0],r[1],r[2]);let l=0,u=this.horizonLineFromTop();if(t.y>u)return this.pointCoordinate(t);const h=.02*u,p=t.clone();for(let g=0;g<10&&u-l>h;g++){p.y=Ln(l,u,.66);const v=this.projection.pointCoordinate3D(this,p.x,p.y);v?(u=p.y,r=v):l=p.y}return r?new ga(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=pf)return!this.isPointAboveHorizon(t);const r=this.pointCoordinate(t);return r.y>=0&&r.y<=1}_coordinatePoint(t,r){const l=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,u=[t.x*this.worldSize,t.y*this.worldSize,l+t.toAltitude(),1];return Va.transformMat4(u,u,this.pixelMatrix),u[3]>0?new V(u[0]/u[3],u[1]/u[3]):new V(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,l=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,h=this.pointLocation3D(new V(r,t)),p=this.pointLocation3D(new V(u,t)),g=this.pointLocation3D(new V(u,l)),v=this.pointLocation3D(new V(r,l));let b=Math.min(h.lng,p.lng,g.lng,v.lng),x=Math.max(h.lng,p.lng,g.lng,v.lng),S=Math.min(h.lat,p.lat,g.lat,v.lat),T=Math.max(h.lat,p.lat,g.lat,v.lat);const P=Math.pow(2,-this.zoom)/16*270,R=this.projection.name==="globe"?1:4,z=(U,W,j,Z,Y)=>{const $=(U+j)/2,K=(W+Z)/2,ae=new V($,K),{lng:se,lat:de}=this.pointLocation3D(ae),ge=Math.max(0,b-se,S-de,se-x,de-T);b=Math.min(b,se),x=Math.max(x,se),S=Math.min(S,de),T=Math.max(T,de),(Y<R||ge>P)&&(z(U,W,$,K,Y+1),z($,K,j,Z,Y+1))};if(z(r,t,u,t,1),z(u,t,u,l,1),z(u,l,r,l,1),z(r,l,r,t,1),this.projection.name==="globe"){const[U,W]=function(j){const Z=nt.identity(new Float64Array(16));nt.multiply(Z,j.pixelMatrix,j.globeMatrix);const Y=[0,cc,0],$=[0,uc,0];return ke.transformMat4(Y,Y,Z),ke.transformMat4($,$,Z),[Y[0]>0&&Y[0]<=j.width&&Y[1]>0&&Y[1]<=j.height&&!b2(j,new On(j.center.lat,90)),$[0]>0&&$[0]<=j.width&&$[1]>0&&$[1]<=j.height&&!b2(j,new On(j.center.lat,-90))]}(this);U?(T=90,x=180,b=-180):W&&(S=-90,x=180,b=-180)}return new Il(new On(b,S),new On(x,T))}_getBoundsRectangular(t,r){const{top:l,left:u}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,p=this.width-this._edgeInsets.right,g=new V(u,l),v=new V(p,l),b=new V(p,h),x=new V(u,h);let S=this.pointCoordinate(g,t),T=this.pointCoordinate(v,t);const P=this.pointCoordinate(b,r),R=this.pointCoordinate(x,r),z=(U,W)=>(W.y-U.y)/(W.x-U.x);return S.y>1&&T.y>=0?S=new ga((1-R.y)/z(R,S)+R.x,1):S.y<0&&T.y<=1&&(S=new ga(-R.y/z(R,S)+R.x,0)),T.y>1&&S.y>=0?T=new ga((1-P.y)/z(P,T)+P.x,1):T.y<0&&S.y<=1&&(T=new ga(-P.y/z(P,T)+P.x,0)),new Il().extend(this.coordinateLocation(S)).extend(this.coordinateLocation(T)).extend(this.coordinateLocation(R)).extend(this.coordinateLocation(P))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=t.visibleDemTiles.reduce((l,u)=>{if(u.dem){const h=u.dem.tree;l.min=Math.min(l.min,h.minimums[0]),l.max=Math.max(l.max,h.maximums[0])}return l},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*t.exaggeration(),r.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,l=this.height/2-r*(1-this._horizonShift);return t?Math.max(0,l):l}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-ji,this.maxLat=ji,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=go(this.minLng)*this.tileSize,this.worldMaxX=go(this.maxLng)*this.tileSize,this.worldMinY=Eo(this.maxLat)*this.tileSize,this.worldMaxY=Eo(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,r){return this.projection.createTileMatrix(this,r,t)}calculateDistanceTileData(t){const r=t.key,l=this._distanceTileDataCache;if(l[r])return l[r];const u=t.canonical,h=1/this.height,p=this.cameraWorldSize,g=p/this.zoomScale(u.z),v=(u.x+Math.pow(2,u.z)*t.wrap)*g,b=u.y*g,x=this.point;x.x*=p/this.worldSize,x.y*=p/this.worldSize;const S=this.angle,T=Math.sin(-S),P=-Math.cos(-S);return l[r]={bearing:[T,P],center:[(x.x-v)*h,(x.y-b)*h],scale:g/dt*h},l[r]}calculateFogTileMatrix(t){const r=t.key,l=this._fogTileMatrixCache;if(l[r])return l[r];const u=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return nt.multiply(u,this.worldToFogMatrix,u),l[r]=new Float32Array(u),l[r]}calculateProjMatrix(t,r=!1){const l=t.key,u=r?this._alignedProjMatrixCache:this._projMatrixCache;if(u[l])return u[l];const h=this.calculatePosMatrix(t,this.worldSize);return nt.multiply(h,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.alignedProjMatrix:this.projMatrix,h),u[l]=new Float32Array(h),u[l]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,l=this._pixelsToTileUnitsCache;if(l[r])return l[r];const u=function(h,p){const{scale:g}=h.tileTransform,v=g*dt/(h.tileSize*Math.pow(2,p.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return Xy.scale(new Float32Array(4),p.inverseAdjustmentMatrix,[v,v])}(t,this);return l[r]=u,l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,r=nt.fromScaling([],[t,t,t]);return nt.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const r=ja(1,this._center.lat)*this.worldSize,l=this._computeCameraPosition(r),u=this._camera.forward(),h=ja(1,this._center.lat);l[2]/=h,u[2]/=h,ke.normalize(u,u);const p=t.raycast(l,u,t.exaggeration());if(p){const g=ke.scaleAndAdd([],l,u,p),v=new ga(g[0],g[1],ja(g[2],pr(g[1]))),b=(v.z+ke.length([v.x-l[0],v.y-l[1],v.z-l[2]*h]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(b),this._centerAltitude=v.toAltitude(),this._center=this.coordinateLocation(v),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,l=ja(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(l),h=r.getAtPointOrZero(new ga(...u)),p=this.pixelsPerMeter/this.worldSize*h,g=this._minimumHeightOverTerrain(),v=u[2]-p;if(v<=g)if(v<0||t){const b=this.locationCoordinate(this._center,this._centerAltitude),x=[u[0],u[1],b.z-u[2]],S=ke.length(x);x[2]-=(g-v)/this._pixelsPerMercatorPixel;const T=ke.length(x);if(T===0)return;ke.scale(x,x,S/T*this._pixelsPerMercatorPixel),this._camera.position=[u[0],u[1],b.z*this._pixelsPerMercatorPixel-x[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const T=this.center;return T.lat=ne(T.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(T.lng=ne(T.lng,this.minLng,this.maxLng)),this.center=T,void(this._constraining=!1)}const r=this._unmodified,{x:l,y:u}=this.point;let h=0,p=l,g=u;const v=this.width/2,b=this.height/2,x=this.worldMinY*this.scale,S=this.worldMaxY*this.scale;if(u-b<x&&(g=x+b),u+b>S&&(g=S-b),S-x<this.height&&(h=Math.max(h,this.height/(S-x)),g=(S+x)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const T=this.worldMinX*this.scale,P=this.worldMaxX*this.scale,R=this.worldSize/2-(T+P)/2;p=(l+R+this.worldSize)%this.worldSize-R,p-v<T&&(p=T+v),p+v>P&&(p=P-v),P-T<this.width&&(h=Math.max(h,this.width/(P-T)),p=(P+T)/2)}p===l&&g===u||(this.center=this.unproject(new V(p,g))),h&&(this.zoom+=this.scaleZoom(h)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r=this.projection.name==="globe",l=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=ja(1,this.center.lat)/ja(1,45));const u=p1(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,u),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const h=this.projection.zAxisUnit==="meters"?l:1,p=this._camera.getWorldToCamera(this.worldSize,h);let g;const v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(v[8]=2*-t.x/this.width,v[9]=2*t.y/this.height,this.isOrthographic){let de=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ge=de*this.aspect,Te=-ge,we=-de;ge-=t.x,Te-=t.x,de+=t.y,we+=t.y,g=this._camera.getCameraToClipOrthographic(Te,ge,we,de,this._nearZ,this._farZ),((Ie,xe,We,qe)=>{for(let Qe=0;Qe<16;Qe++)Ie[Qe]=LN(xe[Qe],We[Qe],qe)})(g,g,v,RN(this.pitch>=15?1:this.pitch/15))}else g=v;const b=nt.mul([],v,p);let x=nt.mul([],g,p);if(this.projection.isReprojectedInTileSpace){const de=this.locationCoordinate(this.center),ge=nt.identity([]);nt.translate(ge,ge,[de.x*this.worldSize,de.y*this.worldSize,0]),nt.multiply(ge,ge,vN(this)),nt.translate(ge,ge,[-de.x*this.worldSize,-de.y*this.worldSize,0]),nt.multiply(x,x,ge),nt.multiply(b,b,ge),this.inverseAdjustmentMatrix=function(Te){const we=vN(Te,!0);return Xy.invert([],[we[0],we[1],we[4],we[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=nt.scale([],x,[this.worldSize,this.worldSize,this.worldSize/h,1]),this.projMatrix=x,this.invProjMatrix=nt.invert(new Float64Array(16),this.projMatrix);const S=nt.invert([],g);this.frustumCorners=DC.fromInvProjectionMatrix(S,this.horizonLineFromTop(),this.height),this.cameraFrustum=Yd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const T=new Float32Array(16);nt.identity(T),nt.scale(T,T,[1,-1,1]),nt.rotateX(T,T,this._pitch),nt.rotateZ(T,T,this.angle);const P=nt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=nt.clone(P);const R=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;P[8]=2*-t.x/this.width,P[9]=2*(t.y+R)/this.height,this.skyboxMatrix=nt.multiply(T,P,T);const z=this.point,U=z.x,W=z.y,j=this.width%2/2,Z=this.height%2/2,Y=Math.cos(this.angle),$=Math.sin(this.angle),K=U-Math.round(U)+Y*j+$*Z,ae=W-Math.round(W)+Y*Z+$*j,se=new Float64Array(x);if(nt.translate(se,se,[K>.5?K-1:K,ae>.5?ae-1:ae,0]),this.alignedProjMatrix=se,x=nt.create(),nt.scale(x,x,[this.width/2,-this.height/2,1]),nt.translate(x,x,[1,-1,0]),this.labelPlaneMatrix=x,x=nt.create(),nt.scale(x,x,[1,-1,1]),nt.translate(x,x,[-1,-1,0]),nt.scale(x,x,[2/this.width,2/this.height,1]),this.glCoordMatrix=x,this.pixelMatrix=nt.multiply(new Float64Array(16),this.labelPlaneMatrix,b),this._calcFogMatrices(),this._distanceTileDataCache={},x=nt.invert(new Float64Array(16),this.pixelMatrix),!x)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=x,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ge){const{x:Te,y:we}=ge.point,{lng:Ie,lat:xe}=ge._center;return Wz(Te,we,ge.worldSize,Ie,xe)}(this);const de=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ke.transformMat4(de,de,p),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=x;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,l=this._camera.position,u=1/this.height/this._pixelsPerMercatorPixel,h=[t,t,r];ke.scale(h,h,u),ke.scale(l,l,-1),ke.multiply(l,l,h);const p=nt.create();nt.translate(p,p,l),nt.scale(p,p,h),this.mercatorFogMatrix=p,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,u)}_computeCameraPosition(t){const r=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,l=this._camera.forward(),u=this.point,h=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-t/this.worldSize*this._centerAltitude;return[u.x/this.worldSize-l[0]*h,u.y/this.worldSize-l[1]*h,t/this.worldSize*this._centerAltitude-l[2]*h]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),l=this._camera.position[2],u=t[2];let h=1;this.projection.wrap&&(this.center=this.center.wrap()),u>0&&(h=Math.min((r-l)/u,1)),this._camera.position=ke.scaleAndAdd([],this._camera.position,t,h),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:l,bearing:u}=this._camera.getPitchBearing(),h=ja(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,p=this._mercatorZfromZoom(this._maxZoom)*Math.cos(be(this._maxPitch)),g=Math.max((t[2]-h)/Math.cos(l),p),v=this._zoomFromMercatorZ(g);ke.scaleAndAdd(t,t,r,g),this._pitch=ne(l,be(this.minPitch),be(this.maxPitch)),this.angle=Ye(u,-Math.PI,Math.PI),this._setZoom(ne(v,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new ga(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,l=pf,u=0,h=1/0;for(;l-r>1e-6&&l>r;){const p=r+.5*(l-r),g=this.tileSize*Math.pow(2,p),v=this.getCameraToCenterDistance(this.projection,p,g),b=this.scaleZoom(v/(t*this.tileSize)),x=Math.abs(p-b);x<h&&(h=x,u=p),p<b?r=p:l=p}return u}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(ve("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const l=Math.min(t.x,r.x),u=Math.max(t.x,r.x),h=Math.min(t.y,r.y),p=Math.max(t.y,r.y);if(h<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const g=[new V(l,h),new V(u,p),new V(l,p),new V(u,h)],v=this.renderWorldCopies?-3:0,b=this.renderWorldCopies?4:1;for(const x of g){const S=this.pointRayIntersection(x);if(S.t<0)return!0;const T=this.rayIntersectionCoordinate(S);if(T.x<v||T.y<0||T.x>b||T.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+fe(this.fovAboveCenter)>88||this.anyCornerOffEdge(new V(0,0),new V(this.width,this.height))}zoomDeltaToMovement(t,r){const l=ke.length(ke.sub([],this._camera.position,t)),u=this._zoomFromMercatorZ(l)+r;return l-this._mercatorZfromZoom(u)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([r,l,u],h){const p=[r,l,u,1];Va.transformMat4(p,p,h);const g=p[3]=Math.max(p[3],1e-6);return p[0]/=g,p[1]/=g,p[2]/=g,p}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new V(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new V(0,t))}}getCameraToCenterDistance(t,r=this.zoom,l=this.worldSize){const u=p1(t,r,this.width,this.height,1024),h=t.pixelSpaceConversion(this.center.lat,l,u);let p=.5/Math.tan(.5*this._fov)*this.height*h;return this.isOrthographic&&(p=LN(1,p,RN(this.pitch>=15?1:this.pitch/15))),p}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&nt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return Yd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function kN(i,t,r){nt.identity(i),nt.rotateZ(i,i,be(t[2])),nt.rotateX(i,i,be(t[0])),nt.rotateY(i,i,be(t[1])),nt.scale(i,i,r),nt.multiply(i,i,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function o3(i,t,r,l,u,h,p,g){const v=[r[0]-t[0],r[1]-t[1],0],b=[l[0]-t[0],l[1]-t[1],0];if(ke.length(v)<1e-12||ke.length(b)<1e-12)return Ao.identity(i);const x=ke.cross([],v,b);ke.normalize(x,x),ke.subtract(b,l,t),v[2]=(h-u)*g,b[2]=(p-u)*g;const S=v;return ke.cross(S,v,b),ke.normalize(S,S),Ao.rotationTo(i,x,S)}function DN(i,t,r=!1){const l=mo(t.zoom),u=function(h,p,g){const v=p.worldSize,b=[h[12],h[13],h[14]],x=pr(b[1]/v),S=il(b[0]/v),T=nt.identity([]),P=ja(1,x)*v,R=ja(1,0)*v*gf(x,p.zoom),z=1/UC(v);let U=R*z;if(g){const Y=p1(p.projection,p.zoom,p.width,p.height,1024);U=z*p.projection.pixelSpaceConversion(p.center.lat,v,Y)}const W=ks(x,S);ke.add(W,W,ke.scale([],ke.normalize([],W),P*U*b[2]));const j=function(Y){const $=[Y[0],Y[1],Y[2]];let K=[0,1,0];const ae=ke.cross([],K,$);return ke.cross(K,$,ae),ke.squaredLength(K)===0&&(K=[0,1,0],ke.cross(ae,$,K)),ke.normalize(ae,ae),ke.normalize(K,K),ke.normalize($,$),[ae[0],ae[1],ae[2],0,K[0],K[1],K[2],0,$[0],$[1],$[2],0,Y[0],Y[1],Y[2],1]}(W);nt.scale(T,T,[U,U,U*P]),nt.translate(T,T,[-b[0],-b[1],-b[2]]);const Z=nt.multiply([],p.globeMatrix,j);return nt.multiply(Z,Z,T),nt.multiply(Z,Z,h),Z}(i,t,r);if(l>0){const h=function(p,g){const v=g.worldSize,b=ja(1,0)*v*gf(g.center.lat,g.zoom)/UC(v),x=ja(1,g.center.lat)*v,S=nt.identity([]);return nt.rotateY(S,S,be(g.center.lng)),nt.rotateX(S,S,be(g.center.lat)),nt.translate(S,S,[0,0,os]),nt.scale(S,S,[b,b,b*x]),nt.translate(S,S,[g.point.x-.5*v,g.point.y-.5*v,0]),nt.multiply(S,S,p),nt.multiply(S,g.globeMatrix,S)}(i,t);return function(p,g,v){const b=(R,z,U)=>{const W=ke.length(R),j=ke.length(z),Z=Kd(R,z,U);return ke.scale(Z,Z,1/ke.length(Z)*Ln(W,j,U))},x=b([p[0],p[1],p[2]],[g[0],g[1],g[2]],v),S=b([p[4],p[5],p[6]],[g[4],g[5],g[6]],v),T=b([p[8],p[9],p[10]],[g[8],g[9],g[10]],v),P=Kd([p[12],p[13],p[14]],[g[12],g[13],g[14]],v);return[x[0],x[1],x[2],0,S[0],S[1],S[2],0,T[0],T[1],T[2],0,P[0],P[1],P[2],1]}(u,h,l)}return u}const wm=64,kne=[1,1,1];class ON{constructor(t,r,l,u){this.id=t,this.position=r!=null?new On(r[0],r[1]):new On(0,0),this.orientation=l??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,r){if(nt.multiply(t.matrix,r,t.matrix),t.meshes)for(const l of t.meshes){const u=di.applyTransform(l.aabb,t.matrix);this.aabb.encapsulate(u)}if(t.children)for(const l of t.children)this._applyTransformations(l,t.matrix)}computeBoundsAndApplyParent(){const t=nt.identity([]);for(const r of this.nodes)this._applyTransformations(r,t)}_positionModelOnTerrain(t,r){const l=t.elevation;if(!l)return 0;const u=di.projectAabbCorners(this.aabb,this.matrix),h=ja(1,this.position.lat)*t.worldSize,p=function(W,j){const Z=[0,0,1],Y=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const $ of Y){const K=W[$.corners[0]],ae=W[$.corners[1]],se=W[$.corners[2]],de=[ae[0]-K[0],ae[1]-K[1],j*(ae[2]-K[2])],ge=ke.cross(de,de,[se[0]-K[0],se[1]-K[1],j*(se[2]-K[2])]);ke.normalize(ge,ge),$.dotProductWithUp=ke.dot(ge,Z)}return Y.sort(($,K)=>$.dotProductWithUp-K.dotProductWithUp),Y[0].corners}(u,h),g=u[p[0]],v=u[p[1]],b=u[p[2]],x=u[p[3]],S=l.getAtPointOrZero(new ga(g[0]/t.worldSize,g[1]/t.worldSize),0),T=l.getAtPointOrZero(new ga(v[0]/t.worldSize,v[1]/t.worldSize),0),P=l.getAtPointOrZero(new ga(b[0]/t.worldSize,b[1]/t.worldSize),0),R=l.getAtPointOrZero(new ga(x[0]/t.worldSize,x[1]/t.worldSize),0),z=(S+R)/2,U=(T+P)/2;return z>U?T<P?o3(r,v,x,g,T,R,S,h):o3(r,b,g,x,P,S,R,h):S<R?o3(r,g,v,b,S,T,P,h):o3(r,x,b,v,R,P,T,h),Math.max(z,U)}computeModelMatrix(t,r,l,u,h,p,g=!1){const v=t.transform,b=v.zoom,x=v.project(this.position),S=gf(this.position.lat,b),T=1/S;nt.identity(this.matrix),nt.translate(this.matrix,this.matrix,[x.x+u[0]*T,x.y+u[1]*T,u[2]]);let P=1,R=1;const z=v.worldSize;if(g){if(v.projection.name==="mercator"){let Z=0;v.elevation&&(Z=v.elevation.getAtPointOrZero(new ga(x.x/z,x.y/z),0));const Y=Va.transformMat4([],[x.x,x.y,Z,1],v.projMatrix)[3]/v.cameraToCenterDistance;P=Y,R=Y*gf(v.center.lat,b)}else if(v.projection.name==="globe"){const Z=DN(this.matrix,v),Y=nt.multiply([],v.projMatrix,Z),$=[0,0,0,1];Va.transformMat4($,$,Y);const K=$[3]/v.cameraToCenterDistance,ae=mo(b),se=v.projection.pixelsPerMeter(this.position.lat,z)*gf(this.position.lat,b),de=v.projection.pixelsPerMeter(v.center.lat,z)*gf(v.center.lat,b);P=K/Ln(se,Xz(v.center.lat),ae),R=K*S/se,P*=de,R*=de}}else P=T;nt.scale(this.matrix,this.matrix,[P,P,R]);const U=[...this.matrix],W=this.orientation,j=[];if(kN(j,[W[0]+r[0],W[1]+r[1],W[2]+r[2]],l),nt.multiply(this.matrix,U,j),h&&v.elevation){let Z=0;const Y=[];if(p&&v.elevation){Z=this._positionModelOnTerrain(v,Y);const $=nt.fromQuat([],Y),K=nt.multiply([],$,j);nt.multiply(this.matrix,U,K)}else Z=v.elevation.getAtPointOrZero(new ga(x.x/z,x.y/z),0);Z!==0&&(this.matrix[14]+=Z)}}upload(t){if(!this.uploaded){for(const r of this.nodes)IP(r,t);for(const r of this.nodes)s3(r);this.uploaded=!0}}destroy(){for(const t of this.nodes)l3(t)}}function m1(i,t,r=!1){i.uploaded||(i.gfxTexture=new mr(t,i.image,r?t.gl.R8:t.gl.RGBA,{useMipmap:i.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),i.uploaded=!0,i.image=null)}function Dne(i,t,r){i.indexBuffer=t.createIndexBuffer(i.indexArray,!1,!0),i.vertexBuffer=t.createVertexBuffer(i.vertexArray,Sne.members,!1,!0),i.normalArray&&(i.normalBuffer=t.createVertexBuffer(i.normalArray,Tne.members,!1,!0)),i.texcoordArray&&(i.texcoordBuffer=t.createVertexBuffer(i.texcoordArray,Mne.members,!1,!0)),i.colorArray&&(i.colorBuffer=t.createVertexBuffer(i.colorArray,(i.colorArray.bytesPerElement===12?Ane:Ene).members,!1,!0)),i.featureArray&&(i.pbrBuffer=t.createVertexBuffer(i.featureArray,Pne.members,!0)),i.segments=Ha.simpleSegment(0,0,i.vertexArray.length,i.indexArray.length);const l=i.material;l.pbrMetallicRoughness.baseColorTexture&&m1(l.pbrMetallicRoughness.baseColorTexture,t),l.pbrMetallicRoughness.metallicRoughnessTexture&&m1(l.pbrMetallicRoughness.metallicRoughnessTexture,t),l.normalTexture&&m1(l.normalTexture,t),l.occlusionTexture&&m1(l.occlusionTexture,t,r),l.emissionTexture&&m1(l.emissionTexture,t)}function IP(i,t,r){if(i.meshes)for(const l of i.meshes)Dne(l,t,r);if(i.children)for(const l of i.children)IP(l,t,r)}function s3(i){if(i.meshes)for(const t of i.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(i.children)for(const t of i.children)s3(t)}function l3(i){if(i.meshes)for(const r of i.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((t=r.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(i.children)for(const r of i.children)l3(r)}class zN{constructor(t,r){this.feature=t,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class FN{constructor(){this.instancedDataArray=new dC,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class NN{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,r,l,u){this.tileToMeter=J_(l);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:p,id:g,index:v,sourceLayerIndex:b}of t){const x=yf(p,h);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),x,l))continue;const S={id:g,sourceLayerIndex:b,index:v,geometry:h?x.geometry:Wu(p,l,u),properties:p.properties,type:p.type,patterns:{}},T=this.addFeature(S,S.geometry,x);T&&r.featureIndex.insert(p,S.geometry,v,b,this.index,this.instancesPerModel[T].instancedDataArray.length)}this.lookup=null}update(t,r,l,u){for(const h in this.instancesPerModel){const p=this.instancesPerModel[h];for(const g in t)p.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(p.features[p.idToFeaturesIndex[g]],t[g],p,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const r in this.instancesPerModel){const l=this.instancesPerModel[r];for(const u of l.features){const h=this.layers[0],p=u.feature,g=this.canonical,v=h.paint.get("model-rotation").evaluate(p,{},g),b=h.paint.get("model-scale").evaluate(p,{},g),x=h.paint.get("model-translation").evaluate(p,{},g);ke.exactEquals(u.rotation,v)&&ke.exactEquals(u.scale,b)&&ke.exactEquals(u.translation,x)||(this.evaluate(u,u.featureStates,l,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const r in this.instancesPerModel){const l=this.instancesPerModel[r];l.instancedDataArray.length<0||l.instancedDataArray.length===0||(l.instancedDataBuffer?l.instancedDataBuffer.updateData(l.instancedDataArray):l.instancedDataBuffer=t.createVertexBuffer(l.instancedDataArray,Cne.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const r=this.instancesPerModel[t];r.instancedDataArray.length!==0&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(t,r,l){const u=this.layers[0],h=u.layout.get("model-id").evaluate(l,{},this.canonical);if(!h)return ve(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),h;this.instancesPerModel[h]||(this.instancesPerModel[h]=new FN);const p=this.instancesPerModel[h],g=p.instancedDataArray,v=new zN(l,g.length);for(const b of r)for(const x of b){if(x.x<0||x.x>=dt||x.y<0||x.y>=dt)continue;const S=(this.lookupDim-1)/dt,T=this.lookupDim*(x.y*S|0)+x.x*S|0;if(this.lookup){if(this.lookup[T]!==0)continue;this.lookup[T]=1}this.instanceCount++;const P=g.length;g.resize(P+1),p.instancesEvaluatedElevation.push(0),g.float32[16*P]=x.x,g.float32[16*P+1]=x.y}return v.instancedDataCount=p.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(t.id&&(p.idToFeaturesIndex[t.id]=p.features.length),p.features.push(v),this.evaluate(v,{},p,!1)),h}evaluate(t,r,l,u){const h=this.layers[0],p=t.feature,g=this.canonical,v=t.rotation=h.paint.get("model-rotation").evaluate(p,r,g),b=t.scale=h.paint.get("model-scale").evaluate(p,r,g),x=t.translation=h.paint.get("model-translation").evaluate(p,r,g),S=h.paint.get("model-color").evaluate(p,r,g);S.a=h.paint.get("model-color-mix-intensity").evaluate(p,r,g);const T=[];this.maxVerticalOffset<x[2]&&(this.maxVerticalOffset=x[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),kN(T,v,b);const P=Math.round(100*S.a)+S.b/1.05;for(let R=0;R<t.instancedDataCount;++R){const z=t.instancedDataOffset+R,U=16*z,W=l.instancedDataArray.float32;let j=0;u&&(j=W[U+6]-l.instancesEvaluatedElevation[z]);const Z=0|W[U+1];W[U]=(0|W[U])+S.r/1.05,W[U+1]=Z+S.g/1.05,W[U+2]=P,W[U+3]=1/(g.z>10?this.tileToMeter:J_(g,Z)),W[U+4]=x[0],W[U+5]=x[1],W[U+6]=x[2]+j,W[U+7]=T[0],W[U+8]=T[1],W[U+9]=T[2],W[U+10]=T[4],W[U+11]=T[5],W[U+12]=T[6],W[U+13]=T[8],W[U+14]=T[9],W[U+15]=T[10],l.instancesEvaluatedElevation[z]=x[2]}}}un(NN,"ModelBucket",{omit:["layers"]}),un(FN,"PerModelAttributes"),un(zN,"ModelFeature");const One=new gi({visibility:new Xt(tt.layout_model.visibility),"model-id":new yn(tt.layout_model["model-id"])});var zne={paint:new gi({"model-opacity":new Xt(tt.paint_model["model-opacity"]),"model-rotation":new yn(tt.paint_model["model-rotation"]),"model-scale":new yn(tt.paint_model["model-scale"]),"model-translation":new yn(tt.paint_model["model-translation"]),"model-color":new yn(tt.paint_model["model-color"]),"model-color-mix-intensity":new yn(tt.paint_model["model-color-mix-intensity"]),"model-type":new Xt(tt.paint_model["model-type"]),"model-cast-shadows":new Xt(tt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xt(tt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xt(tt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new yn(tt.paint_model["model-emissive-strength"]),"model-roughness":new yn(tt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new yn(tt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xt(tt.paint_model["model-cutoff-fade-range"])}),layout:One};const LP=new Float32Array(262144),Sm=new Uint8Array(262144);function BN(i){let t=0;if(i.meshes)for(const r of i.meshes)t=Math.max(t,r.aabb.max[2]);if(i.children)for(const r of i.children)t=Math.max(t,BN(r));return t}const UN=["","wall","door","roof","window","lamp","logo"];class WN{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:BN(t)}}}}class VN{constructor(t,r,l,u){this.nodes=t,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,l&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=u,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const l of r){const u=l.node;this.uploaded?this.updatePbrBuffer(u):IP(u,t,!0)}for(const l of r)s3(l.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let r=!1;if(!t.meshes)return r;for(const l of t.meshes)l.pbrBuffer&&(l.pbrBuffer.updateData(l.featureArray),r=!0);return r}needsReEvaluation(t,r,l){const u=t.transform.projectionOptions,h=t.style.getBrightness(),p=this.brightness!==h;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||g1(l.paint.get("model-color").value,p)||g1(l.paint.get("model-color-mix-intensity").value,p)||g1(l.paint.get("model-roughness").value,p)||g1(l.paint.get("model-emissive-strength").value,p)||g1(l.paint.get("model-height-based-emissive-strength-multiplier").value,p))&&(this.projection=u,this.brightness=h,!0)}evaluateScale(t,r){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const l=this.getNodesInfo(),u=this.id.canonical;for(const h of l){const p=h.feature;h.evaluatedScale=r.paint.get("model-scale").evaluate(p,{},u)}}evaluate(t){const r=this.getNodesInfo();for(const l of r){if(!l.node.meshes)continue;const u=l.feature,h=l.node.meshes&&l.node.meshes[0].featureData,p=l.evaluatedColor[2],g=l.evaluatedRMEA[2],v=this.id.canonical;if(l.hasTranslucentParts=!1,h){for(let b=0;b<UN.length;b++){const x=UN[b];x.length&&(u.properties.part=x);const S=t.paint.get("model-color").evaluate(u,{},v),T=t.paint.get("model-color-mix-intensity").evaluate(u,{},v);l.evaluatedColor[b]=[S.r,S.g,S.b,T],l.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(u,{},v),l.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v),l.evaluatedRMEA[b][3]=S.a,l.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!l.hasTranslucentParts&&S.a<1&&(l.hasTranslucentParts=!0)}delete u.properties.part,Nne(l,p!==l.evaluatedColor[2]||g!==l.evaluatedRMEA[2])}l.evaluatedScale=t.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(l.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,r,l,u){const h=t.findDEMTileFor(l);if(h&&(h.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const p=iv.create(t,l,h);if(!p)return;4&this.modelTraits&&this.updateDEM(t,p,l,u);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const b=v.footprint.vertices;let x=p.getElevationAt(b[0].x,b[0].y,!0,!0);for(let S=1;S<b.length;S++)x=Math.min(x,p.getElevationAt(b[S].x,b[S].y,!0,!0));v.elevation=x}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=r}}updateDEM(t,r,l,u){let h=r._dem._modifiedForSources[u];if(h===void 0&&(r._dem._modifiedForSources[u]=[],h=r._dem._modifiedForSources[u]),h.includes(l.canonical))return;const p=r._dem.dim;h.push(l.canonical);let g=!1;for(const v of this.getNodesInfo()){const b=v.node;if(!b.footprint||!b.footprint.grid)continue;const x=b.footprint.grid,S=r.tileCoordToPixel(x.min.x,x.min.y),T=r.tileCoordToPixel(x.max.x,x.max.y),P=Math.min(Math.min(p-T.y,S.x),Math.min(S.y,p-T.x));if(P<0)continue;const R=ne(P,2,5);let z=Math.max(0,S.x-R),U=Math.max(0,S.y-R),W=Math.min(T.x+R,p-1),j=Math.min(T.y+R,p-1);for(let K=U;K<=j;++K)for(let ae=z;ae<=W;++ae)Sm[K*p+ae]=255;let Z=0,Y=0;for(let K=0;K<x.cellsY;++K)for(let ae=0;ae<x.cellsX;++ae){if(!x.cells[K*x.cellsX+ae])continue;const se=r.tileCoordToPixel(x.min.x+ae/x.xScale,x.min.y+K/x.yScale),de=r.tileCoordToPixel(x.min.x+(ae+1)/x.xScale,x.min.y+(K+1)/x.yScale);for(let ge=se.y;ge<=Math.min(de.y+1,p-1);++ge)for(let Te=se.x;Te<=Math.min(de.x+1,p-1);++Te)Sm[ge*p+Te]===255&&(Sm[ge*p+Te]=0,Z+=r.getElevationAtPixel(Te,ge),Y++)}const $=Z/Y;z=Math.max(1,S.x-R),U=Math.max(1,S.y-R),W=Math.min(T.x+R,p-2),j=Math.min(T.y+R,p-2),g=!0;for(let K=U;K<=j;++K)for(let ae=z;ae<=W;++ae)Sm[K*p+ae]===0&&(LP[K*p+ae]=r._dem.set(ae,K,$));for(let K=1;K<R;++K){z=Math.max(1,S.x-K),U=Math.max(1,S.y-K),W=Math.min(T.x+K,p-2),j=Math.min(T.y+K,p-2);for(let ae=U;ae<=j;++ae)for(let se=z;se<=W;++se){const de=ae*p+se;if(Sm[de]===255){let ge=0,Te=0,we=-1,Ie=-1;for(let xe=-1;xe<=1;++xe)for(let We=-1;We<=1;++We){const qe=(ae+xe)*p+se+We;if(Sm[qe]>=K)continue;const Qe=LP[qe],Ne=Math.abs(Qe);Ne>Te&&(ge=Qe,Te=Ne,we=We,Ie=xe)}if(Te>.1){const xe=1-(K+.5*Math.abs(we*Ie))/R;let We=r._dem.get(se,ae)+ge*xe;const qe=r._dem.get(se+we,ae+Ie),Qe=r._dem.get(se-we,ae-Ie,!0);(We-qe)*(We-Qe)>0&&(We=(qe+Qe)/2),LP[de]=r._dem.set(se,ae,We),Sm[de]=K}}}}}g&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=Cn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new WN(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)l3(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const r of t)s3(r.node),l3(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const l=r.getReplacementRegionsForTile(t.toUnwrapped()),u=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const p=u[h].node;u[h].hiddenByReplacement=!!p.footprint&&!l.find(g=>g.footprint===p.footprint)}}getHeightAtTileCoord(t,r){const l=this.getNodesInfo(),u=[];for(let h=0;h<this.nodesInfo.length;h++){const p=l[h],g=p.node.meshes[0];if(t<g.aabb.min[0]||r<g.aabb.min[1]||t>g.aabb.max[0]||r>g.aabb.max[1])continue;const v=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*wm|0,b=Math.min(63,(r-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*wm|0)*wm+Math.min(63,v);if(!(g.heightmap[b]<0&&p.node.footprint))return p.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:p.feature.properties.height,hidden:!1,verticalScale:p.evaluatedScale[2]};if(p.node.footprint.grid.query(new V(t,r),new V(t,r),u),u.length>0)return{height:void 0,maxHeight:p.feature.properties.height,hidden:p.hiddenByReplacement,verticalScale:p.evaluatedScale[2]}}}}function g1(i,t){return!i.isLightConstant&&t}function Fne(i,t,r,l,u,h,p,g){let v=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,x=240&t|(240&t)>>4;r[3]>0&&(v=Ln(v,255*r[0],r[3]),b=Ln(b,255*r[1],r[3]),x=Ln(x,255*r[2],r[3]));const S=v<<8|b,T=x<<8|Math.floor(255*l[3]),P=function(K){const ae=ne(K,0,2);return Math.min(Math.round(.5*ae*255),255)}(l[2])<<8|15*l[0]<<4|15*l[1],R=ne(u[0],0,1),z=ne(u[1],0,1),U=ne(u[2],0,1),W=ne(u[3],0,1);let j,Z,Y,$;if(R!==z&&p!==h&&z!==R){const K=p-h;Z=1/(K*(z-R)),Y=-(h+K*R)/(K*(z-R));const ae=ne(u[4],-1,1);$=Math.pow(10,ae),j=255*U<<8|255*W}else j=65535,Z=0,Y=1,$=1;if(i.emplaceBack(S,T,P,j,Z,Y,$),g){const K=g.length;g.clear();for(let ae=0;ae<K;ae++)g.emplaceBack(S,T,P,j,Z,Y,$)}}function Nne(i,t){const r=i.node;let l=0;for(const u of r.meshes){if(r.lights&&r.lightMeshIndex===l||!u.featureData)continue;u.featureArray=new c2,u.featureArray.reserve(u.featureData.length);let h=t;for(const p of u.featureData){let g;const v=65535&p,b=(15&v)<8?15&v:0,x=p>>16&65535,S=i.evaluatedRMEA[b],T=i.evaluatedColor[b],P=i.emissionHeightBasedParams[b];if(h&&b===2&&r.lights&&(g=new c2,g.resize(10*r.lights.length)),Fne(u.featureArray,x,T,S,P,u.aabb.min[2],u.aabb.max[2],g),g&&h){h=!1;const R=r.meshes[r.lightMeshIndex];R.featureArray=g,R.featureArray._trim()}}u.featureArray._trim(),l++}}un(VN,"Tiled3dModelBucket",{omit:["layers"]}),un(WN,"Tiled3dModelFeature");class Bne{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const r=jN(new V(0,0),new V(dt,dt),t),l=[];for(const u of this._activeRegions){if(u.hiddenByOverlap||!HN(r,u))continue;const h=Une(u.min,u.max,t);l.push({min:h.min,max:h.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId})}return l}setSources(t){this._setSources(t.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const l=[];for(const u of r.cache.getVisibleCoordinates()){const h=r.cache.getTile(u).buckets[r.layer];if(h)for(const p of h.getNodesInfo()){const g=p.node;g.footprint&&l.push({footprint:g.footprint,id:u.toUnwrapped()})}}return l}})))}_addSource(t){const r=t.getFootprints();if(r.length!==0){for(const l of r){if(!l.footprint)continue;const u=jN(l.footprint.min,l.footprint.max,l.id);this._activeRegions.push({min:u.min,max:u.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:l.id,footprint:l.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,l)=>r.priority-l.priority||c3(r.min,l.min)||c3(r.max,l.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let r=0,l=0;for(;!t&&r!==this._activeRegions.length;){const u=this._activeRegions[r],h=this._prevRegions[l];t=u.priority!==h.priority||!GN(u,h),++r,++l}}if(t){++this._updateTime;const r=l=>{const u=this._activeRegions;if(l>=u.length)return l;const h=u[l].priority;for(;l<u.length&&u[l].priority===h;)++l;return l};if(this._sourceIds.length>1){let l=0,u=r(l);for(;l!==u;){let h=l;const p=l;for(;h!==u;){const g=this._activeRegions[h];g.hiddenByOverlap=!1;for(let v=0;v<p;v++){const b=this._activeRegions[v];if(!b.hiddenByOverlap&&HN(g,b)&&(g.hiddenByOverlap=qN(g.footprint,g.tileId,b.footprint,b.tileId),g.hiddenByOverlap))break}++h}l=u,u=r(l)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=t.length-1;r>=0;r--)this._addSource(t[r]);this._computeReplacement()}}function c3(i,t){return i.x-t.x||i.y-t.y}function GN(i,t){return c3(i.min,t.min)===0&&c3(i.max,t.max)===0}function HN(i,t){return!(i.min.x>t.max.x||i.max.x<t.min.x||i.min.y>t.max.y||i.max.y<t.min.y)}function jN(i,t,r){const l=1/dt,u=1/(1<<r.canonical.z),h=(t.x*l+r.canonical.x)*u+r.wrap,p=(t.y*l+r.canonical.y)*u;return{min:new V((i.x*l+r.canonical.x)*u+r.wrap,(i.y*l+r.canonical.y)*u),max:new V(h,p)}}function Une(i,t,r){const l=1<<r.canonical.z,u=((t.x-r.wrap)*l-r.canonical.x)*dt,h=(t.y*l-r.canonical.y)*dt;return{min:new V(((i.x-r.wrap)*l-r.canonical.x)*dt,(i.y*l-r.canonical.y)*dt),max:new V(u,h)}}function $N(i,t,r,l,u,h,p){const g=i.indices,v=i.vertices,b=[];for(let x=l;x<l+u;x+=3){const S=t[r[x+0]+h],T=t[r[x+1]+h],P=t[r[x+2]+h],R=Math.min(S.x,T.x,P.x),z=Math.max(S.x,T.x,P.x),U=Math.min(S.y,T.y,P.y),W=Math.max(S.y,T.y,P.y);b.length=0,i.grid.query(new V(R,U),new V(z,W),b);for(let j=0;j<b.length;j++){const Z=b[j];if(ZC(v[g[3*Z+0]],v[g[3*Z+1]],v[g[3*Z+2]],S,T,P,p))return!0}}return!1}function qN(i,t,r,l){if(!i||!r)return!1;let u=i.vertices;if(!t.canonical.equals(l.canonical)||t.wrap!==l.wrap){if(r.vertices.length<i.vertices.length)return qN(r,l,i,t);const h=t.canonical,p=l.canonical,g=Math.pow(2,p.z-h.z);u=i.vertices.map(v=>new V(v.x*h.x*dt*g-p.x*dt,v.y*h.y*dt*g-p.y*dt))}return $N(r,u,i.indices,0,i.indices.length,0,0)}const Wne=k2.types,Vne=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],Gne=["fill-extrusion-flood-light-ground-radius"],Hne=Math.pow(2,13),jne=Math.pow(2,15)-1,XN=new V(0,1),ju=2147483648;function y1(i,t,r,l,u,h,p,g){i.emplaceBack((t<<1)+p,(r<<1)+h,(Math.floor(l*Hne)<<1)+u,Math.round(g))}function u3(i,t,r,l,u,h){i.emplaceBack(t.x,t.y,(r.x<<1)+l,(r.y<<1)+u,h)}function v1(i,t,r){i.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class ZN{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class YN{constructor(){this.centroidXY=new V(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new V(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new V(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new V(this.max.x-this.min.x,this.max.y-this.min.y)}}class KN{constructor(){this.acc=new V(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,r){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=r.x,t.min.y=t.max.y=r.y)}appendEdge(t,r,l){this.accCount++,this.acc._add(r);let u=!!this.borders;r.x<t.min.x?(t.min.x=r.x,u=!0):r.x>t.max.x&&(t.max.x=r.x,u=!0),r.y<t.min.y?(t.min.y=r.y,u=!0):r.y>t.max.y&&(t.max.y=r.y,u=!0),((r.x===0||r.x===dt)&&r.x===l.x)!=((r.y===0||r.y===dt)&&r.y===l.y)&&this.processBorderOverlap(r,l),u&&this.checkBorderIntersection(r,l)}checkBorderIntersection(t,r){r.x<0!=t.x<0&&this.addBorderIntersection(0,Ln(r.y,t.y,(0-r.x)/(t.x-r.x))),r.x>dt!=t.x>dt&&this.addBorderIntersection(1,Ln(r.y,t.y,(dt-r.x)/(t.x-r.x))),r.y<0!=t.y<0&&this.addBorderIntersection(2,Ln(r.x,t.x,(0-r.y)/(t.y-r.y))),r.y>dt!=t.y>dt&&this.addBorderIntersection(3,Ln(r.x,t.x,(dt-r.y)/(t.y-r.y)))}addBorderIntersection(t,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];r<l[0]&&(l[0]=r),r>l[1]&&(l[1]=r)}processBorderOverlap(t,r){if(t.x===r.x){if(t.y===r.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,r.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,r.x),this.addBorderIntersection(l,t.x)}}centroid(){return this.accCount===0?new V(0,0):new V(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,r)=>t+ +(r[0]!==Number.MAX_VALUE),0):0}}function JN(i,t){const r=i.add(t)._unit(),l=ne(i.x*r.x+i.y*r.y,-1,1);var u,h,p;return u=Math.acos(l),Math.min(4,Math.max(-4,Math.tan(u)))/4*jne*((h=i).x*(p=t).y-h.y*p.x<0?-1:1)}const $ne=[i=>i.x<0,i=>i.x>dt,i=>i.y<0,i=>i.y>dt];function qne(i,t,r,l){const u=[4];if(l===0)return u;r._mult(l);const h=i.sub(r),p=t.sub(r),g=[i,t,h,p];for(let v=0;v<4;v++)for(const b of g)if($ne[v](b)){u.push(v);break}return u}class QN{constructor(t){this.vertexArray=new vt,this.indexArray=new Nn,this.programConfigurations=new df(t.layers,t.zoom,r=>Gne.includes(r)),this._segments=new Ha,this.hiddenByLandmarkVertexArray=new hC,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Ha}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,r,l){const u=t.length;if(u>2){let h=Math.max(0,this._segments.get().length-1);const p=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[h].length);let g;h!==this._segments.get().length-1&&(h++,this._segmentToGroundQuads[h]=[],this._segmentToRegionTriCounts[h]=[0,0,0,0,0]);{const v=t[0],b=t[1];g=JN(v.sub(t[u-1])._perp()._unit(),b.sub(v)._perp()._unit())}for(let v=0;v<u;v++){const b=v===u-1?0:v+1,x=t[v],S=t[b],T=t[b===u-1?0:b+1],P=S.sub(x)._perp()._unit(),R=JN(P,T.sub(S)._perp()._unit()),z=g,U=R;if(RP(x,S,r)||nB(x,r)&&nB(S,r)){g=R;continue}const W=p.vertexLength;u3(this.vertexArray,x,S,1,1,z),u3(this.vertexArray,x,S,1,0,z),u3(this.vertexArray,x,S,0,1,U),u3(this.vertexArray,x,S,0,0,U),p.vertexLength+=4;const j=qne(x,S,P,l);for(const Z of j)this._segmentToGroundQuads[h].push({id:W,region:Z}),this._segmentToRegionTriCounts[h][Z]+=2,p.primitiveLength+=2;g=R}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),r=t.length;for(let l=0;l<r;l++)this._segmentToGroundQuads[l].sort((u,h)=>u.region-h.region);for(let l=0;l<r;l++){const u=this._segmentToGroundQuads[l],h=t[l],p=this._segmentToRegionTriCounts[l];p.reduce((v,b)=>v+b,0);let g=0;for(let v=0;v<=4;v++){const b=p[v];if(b!==0){let x=this.regionSegments[v];x||(x=this.regionSegments[v]=new Ha);const S={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+g,vertexLength:h.vertexLength,primitiveLength:b};x.get().push(S)}g+=b}for(let v=0;v<u.length;v++){const b=u[v].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,r,l,u,h,p){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,r,l,u,h,p)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,xee.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,r,l,u,h,p){this.hasData()&&this.programConfigurations.updatePaintArrays(t,r,l,u,h,p)}updateHiddenByLandmark(t){if(!this.hasData())return;const r=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const l=t.flags&ju?1:0;for(let u=t.groundVertexArrayOffset;u<r;++u)this.hiddenByLandmarkVertexArray.emplace(u,l);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,See.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const r=this.regionSegments[t];r&&r.destroy()}}}}class _1{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Nn,this.footprintVertices=new J,this.footprintSegments=[],this.layoutVertexArray=new je,this.centroidVertexArray=new cO,this.indexArray=new Nn,this.programConfigurations=new df(t.layers,t.zoom,r=>Vne.includes(r)),this.segments=new Ha,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new QN(t),this.maxHeight=0,this.partLookup={}}populate(t,r,l,u){this.features=[],this.hasPattern=nP("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=J_(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:h,id:p,index:g,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,x=yf(h,b);if(!this.layers[0]._featureFilter.filter(new ii(this.zoom),x,l))continue;const S={id:p,sourceLayerIndex:v,index:g,geometry:b?x.geometry:Wu(h,l,u),properties:h.properties,type:h.type,patterns:{}},T=this.layoutVertexArray.length;this.hasPattern?this.features.push(aP("fill-extrusion",this.layers,S,this.zoom,r)):this.addFeature(S,S.geometry,g,l,{},r.availableImages,u,r.brightness),r.featureIndex.insert(h,S.geometry,g,v,this.index,T)}this.sortBorders(),this.groundEffect.prepareBorderSegments()}addFeatures(t,r,l,u,h,p){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,r,l,u,h,p)}this.sortBorders()}update(t,r,l,u,h){const p=Object.keys(t).length!==0;if(p&&!this.stateDependentLayers.length)return;const g=p?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,r,g,l,u,h),this.groundEffect.update(t,r,g,l,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Eee),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Aee.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,wee.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,l,u,h,p,g,v){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,x=[new V(0,0),new V(dt,dt)],S=g.projection,T=S.name==="globe",P=Wne[t.type]==="Polygon",R=new KN;R.centroidDataIndex=this.centroidData.length;const z=new YN,U=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},u)<=0,W=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},u);z.height=W,z.vertexArrayOffset=this.layoutVertexArray.length,z.groundVertexArrayOffset=this.groundEffect.vertexArray.length,T&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Jn);const j=tP(r,500);for(let se=j.length-1;se>=0;se--){const de=j[se];(de.length===0||(Z=de[0]).every(ge=>ge.x<=0)||Z.every(ge=>ge.x>=dt)||Z.every(ge=>ge.y<=0)||Z.every(ge=>ge.y>=dt))&&j.splice(se,1)}var Z;let Y;if(T)Y=oB(j,x,u);else{Y=[];for(const se of j)Y.push({polygon:se,bounds:x})}const $=P?this.edgeRadius:0,K=$>0&&this.zoom<17,ae=(se,de)=>{if(se.length===0)return!1;const ge=se[se.length-1];return de.x===ge.x&&de.y===ge.y};for(const{polygon:se,bounds:de}of Y){let ge=0,Te=0;for(const xe of se)P&&!xe[0].equals(xe[xe.length-1])&&xe.push(xe[0]),Te+=P?xe.length-1:xe.length;const we=this.segments.prepareSegment((P?5:4)*Te,this.layoutVertexArray,this.indexArray);z.footprintSegIdx<0&&(z.footprintSegIdx=this.footprintSegments.length);const Ie=new ZN;if(Ie.vertexOffset=this.footprintVertices.length,Ie.indexOffset=3*this.footprintIndices.length,Ie.ringIndices=[],P){const xe=[],We=[];ge=we.vertexLength;for(let Qe=0;Qe<se.length;Qe++){const Ne=se[Qe];Ne.length&&Qe!==0&&We.push(xe.length/2);const Ve=[];let at,mt;at=Ne[1].sub(Ne[0])._perp()._unit(),Ie.ringIndices.push(Ne.length-1);for(let lt=1;lt<Ne.length;lt++){const Ct=Ne[lt],zt=Ne[lt===Ne.length-1?1:lt+1],bt=Ct.clone();if($){mt=zt.sub(Ct)._perp()._unit();const Et=at.add(mt)._unit(),en=$*Math.min(4,1/(at.x*Et.x+at.y*Et.y));bt.x+=en*Et.x,bt.y+=en*Et.y,bt.x=Math.round(bt.x),bt.y=Math.round(bt.y),at=mt}!U||$!==0&&!K||ae(Ve,bt)||Ve.push(bt),y1(this.layoutVertexArray,bt.x,bt.y,0,0,1,1,0),we.vertexLength++,this.footprintVertices.emplaceBack(Ct.x,Ct.y),xe.push(Ct.x,Ct.y),T&&v1(this.layoutVertexExtArray,S.projectTilePoint(bt.x,bt.y,u),S.upVector(u,bt.x,bt.y))}U&&($===0||K)&&(Ve.length!==0&&ae(Ve,Ve[0])&&Ve.pop(),this.groundEffect.addData(Ve,de,b))}const qe=I2(xe,We);for(let Qe=0;Qe<qe.length;Qe+=3)this.footprintIndices.emplaceBack(Ie.vertexOffset+qe[Qe+0],Ie.vertexOffset+qe[Qe+1],Ie.vertexOffset+qe[Qe+2]),this.indexArray.emplaceBack(ge+qe[Qe],ge+qe[Qe+2],ge+qe[Qe+1]),we.primitiveLength++;Ie.indexCount+=qe.length,Ie.vertexCount+=this.footprintVertices.length-Ie.vertexOffset}for(let xe=0;xe<se.length;xe++){const We=se[xe];R.startRing(z,We[0]);let qe=We.length>4&&aB(We[We.length-2],We[0],We[1]),Qe=$?Xne(We[We.length-2],We[0],We[1],$):0;const Ne=[];let Ve,at,mt;at=We[1].sub(We[0])._perp()._unit();let lt=!0;for(let Ct=1,zt=0;Ct<We.length;Ct++){let bt=We[Ct-1],Et=We[Ct];const en=We[Ct===We.length-1?1:Ct+1];if(R.appendEdge(z,Et,bt),RP(Et,bt,de)){$&&(at=en.sub(Et)._perp()._unit(),lt=!lt);continue}const on=Et.sub(bt)._perp(),rn=on.x/(Math.abs(on.x)+Math.abs(on.y)),cn=on.y>0?1:0,gn=bt.dist(Et);if(zt+gn>32768&&(zt=0),$){mt=en.sub(Et)._perp()._unit();let $n=tB(bt,Et,en,eB(at,mt),$);isNaN($n)&&($n=0);const Un=Et.sub(bt)._unit();bt=bt.add(Un.mult(Qe))._round(),Et=Et.add(Un.mult(-$n))._round(),Qe=$n,at=mt,U&&this.zoom>=17&&(ae(Ne,bt)||Ne.push(bt),ae(Ne,Et)||Ne.push(Et))}const kn=we.vertexLength,ea=We.length>4&&aB(bt,Et,en);let _a=iB(zt,qe,lt);if(y1(this.layoutVertexArray,bt.x,bt.y,rn,cn,0,0,_a),y1(this.layoutVertexArray,bt.x,bt.y,rn,cn,0,1,_a),zt+=gn,_a=iB(zt,ea,!lt),qe=ea,y1(this.layoutVertexArray,Et.x,Et.y,rn,cn,0,0,_a),y1(this.layoutVertexArray,Et.x,Et.y,rn,cn,0,1,_a),we.vertexLength+=4,this.indexArray.emplaceBack(kn+0,kn+1,kn+2),this.indexArray.emplaceBack(kn+1,kn+3,kn+2),we.primitiveLength+=2,$){const $n=ge+(Ct===1?We.length-2:Ct-2),Un=Ct===1?ge:$n+1;if(this.indexArray.emplaceBack(kn+1,$n,kn+3),this.indexArray.emplaceBack($n,Un,kn+3),we.primitiveLength+=2,Ve===void 0&&(Ve=kn),!RP(en,We[Ct],de)){const In=Ct===We.length-1?Ve:we.vertexLength;this.indexArray.emplaceBack(kn+2,kn+3,In),this.indexArray.emplaceBack(kn+3,In+1,In),this.indexArray.emplaceBack(kn+3,Un,In+1),we.primitiveLength+=3}lt=!lt}if(T){const $n=this.layoutVertexExtArray,Un=S.projectTilePoint(bt.x,bt.y,u),In=S.projectTilePoint(Et.x,Et.y,u),En=S.upVector(u,bt.x,bt.y),da=S.upVector(u,Et.x,Et.y);v1($n,Un,En),v1($n,Un,En),v1($n,In,da),v1($n,In,da)}}P&&(ge+=We.length-1),U&&$&&this.zoom>=17&&(Ne.length!==0&&ae(Ne,Ne[0])&&Ne.pop(),this.groundEffect.addData(Ne,de,b))}this.footprintSegments.push(Ie),++z.footprintSegLen}if(z.vertexCount=this.layoutVertexArray.length-z.vertexArrayOffset,z.groundVertexCount=this.groundEffect.vertexArray.length-z.groundVertexArrayOffset,z.vertexCount!==0){if(z.centroidXY=R.borders?XN:this.encodeCentroid(R,z),this.centroidData.push(z),R.borders){this.featuresOnBorder.push(R);const se=this.featuresOnBorder.length-1;for(let de=0;de<R.borders.length;de++)R.borders[de][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[de].push(se)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,v),this.groundEffect.addPaintPropertiesData(t,l,h,p,u,v),this.maxHeight=Math.max(this.maxHeight,W)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((r,l)=>this.featuresOnBorder[r].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,r){const l=t.centroid(),u=r.span(),h=Math.min(7,Math.round(u.x*this.tileToMeter/10)),p=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new V(ne(l.x,1,dt-1)<<3|h,ne(l.y,1,dt-1)<<3|p)}showCentroid(t){const r=this.centroidData[t.centroidDataIndex];r.flags&=ju,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const r=t.vertexArrayOffset,l=t.vertexCount+t.vertexArrayOffset,u=t.flags&ju?XN:t.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==u.y||h!==u.x){for(let p=r;p<l;++p)this.centroidVertexArray.emplace(p,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const l=r.getReplacementRegionsForTile(t.toUnwrapped());if(function(h,p){if(h.length!==p.length)return!1;for(let g=0;g<h.length;g++)if(h[g].sourceId!==p[g].sourceId||!GN(h[g],p[g]))return!1;return!0}(this.activeReplacements,l))return;if(this.activeReplacements=l,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const h of this.centroidData)h.flags&=2147483647;const u=[];for(const h of this.activeReplacements){const p=Math.pow(2,h.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&ju||h.min.x>g.max.x||g.min.x>h.max.x||h.min.y>g.max.y||g.min.y>h.max.y))for(let v=0;v<g.footprintSegLen;v++){const b=this.footprintSegments[g.footprintSegIdx+v];if(u.length=0,Zne(this.footprintVertices,b.vertexOffset,b.vertexCount,h.footprintTileId.canonical,t.canonical,u),$N(h.footprint,u,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-p)){g.flags|=ju;break}}}for(const h of this.centroidData)this.writeCentroidToBuffer(h);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,r,l){let u=!1;for(let h=0;h<l.footprintSegLen;h++){const p=this.footprintSegments[l.footprintSegIdx+h];let g=0;for(const v of p.ringIndices){for(let b=g,x=v+g-1;b<v+g;x=b++){const S=this.footprintVertices.int16[2*(b+p.vertexOffset)+0],T=this.footprintVertices.int16[2*(b+p.vertexOffset)+1],P=this.footprintVertices.int16[2*(x+p.vertexOffset)+1];T>r!=P>r&&t<(this.footprintVertices.int16[2*(x+p.vertexOffset)+0]-S)*(r-T)/(P-T)+S&&(u=!u)}g=v}}return u}getHeightAtTileCoord(t,r){let l=Number.NEGATIVE_INFINITY,u=!0;const h=4*(t+dt)*dt+(r+dt);if(this.partLookup.hasOwnProperty(h)){const p=this.partLookup[h];return p?{height:p.height,hidden:!!(p.flags&ju)}:void 0}for(const p of this.centroidData)t>p.max.x||p.min.x>t||r>p.max.y||p.min.y>r||this.footprintContainsPoint(t,r,p)&&p&&p.height>l&&(l=p.height,this.partLookup[h]=p,u=!!(p.flags&ju));if(l!==Number.NEGATIVE_INFINITY)return{height:l,hidden:u};this.partLookup[h]=void 0}}function eB(i,t){const r=i.add(t)._unit();return i.x*r.x+i.y*r.y}function Xne(i,t,r,l){const u=t.sub(i)._perp()._unit(),h=r.sub(t)._perp()._unit();return tB(i,t,r,eB(u,h),l)}function tB(i,t,r,l,u){const h=Math.sqrt(1-l*l);return Math.min(i.dist(t)/3,t.dist(r)/3,u*h/l)}function RP(i,t,r){return i.x<r[0].x&&t.x<r[0].x||i.x>r[1].x&&t.x>r[1].x||i.y<r[0].y&&t.y<r[0].y||i.y>r[1].y&&t.y>r[1].y}function nB(i,t){return i.x<t[0].x||i.x>t[1].x||i.y<t[0].y||i.y>t[1].y}function aB(i,t,r){if(i.x<0||i.x>=dt||t.x<0||t.x>=dt||r.x<0||r.x>=dt)return!1;const l=r.sub(t),u=l.perp(),h=i.sub(t);return(l.x*h.x+l.y*h.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(h.x*h.x+h.y*h.y))>-.866&&u.x*h.x+u.y*h.y<0}function iB(i,t,r){const l=t?2|i:-3&i;return r?1|l:-2&l}function rB(){const i=Math.PI/32,t=Math.tan(i),r=Ky;return r*Math.sqrt(1+2*t*t)-r}function oB(i,t,r){const l=1<<r.z,u=il(r.x/l),h=il((r.x+1)/l),p=pr(r.y/l),g=pr((r.y+1)/l);return function(v,b,x,S,T=0,P){const R=[];if(!v.length||!x||!S)return R;const z=(K,ae)=>{for(const se of K)R.push({polygon:se,bounds:ae})},U=Math.ceil(Math.log2(x)),W=Math.ceil(Math.log2(S)),j=U-W,Z=[];for(let K=0;K<Math.abs(j);K++)Z.push(j>0?0:1);for(let K=0;K<Math.min(U,W);K++)Z.push(0),Z.push(1);let Y=v;if(Y=D2(Y,b[0].y-T,b[1].y+T,1),Y=D2(Y,b[0].x-T,b[1].x+T,0),!Y.length)return R;const $=[];for(Z.length?$.push({polygons:Y,bounds:b,depth:0}):z(Y,b);$.length;){const K=$.pop(),ae=K.depth,se=Z[ae],de=K.bounds[0],ge=K.bounds[1],Te=se===0?de.x:de.y,we=se===0?ge.x:ge.y,Ie=P?P(se,Te,we):.5*(Te+we),xe=D2(K.polygons,Te-T,Ie+T,se),We=D2(K.polygons,Ie-T,we+T,se);if(xe.length){const qe=[de,new V(se===0?Ie:ge.x,se===1?Ie:ge.y)];Z.length>ae+1?$.push({polygons:xe,bounds:qe,depth:ae+1}):z(xe,qe)}if(We.length){const qe=[new V(se===0?Ie:de.x,se===1?Ie:de.y),ge];Z.length>ae+1?$.push({polygons:We,bounds:qe,depth:ae+1}):z(We,qe)}}return R}(i,t,Math.ceil((h-u)/11.25),Math.ceil((p-g)/11.25),1,(v,b,x)=>{if(v===0)return .5*(b+x);{const S=pr((r.y+b/dt)/l);return(Eo(.5*(pr((r.y+x/dt)/l)+S))*l-r.y)*dt}})}function Zne(i,t,r,l,u,h){const p=Math.pow(2,l.z-u.z);for(let g=0;g<r;g++){let v=i.int16[2*(g+t)+0],b=i.int16[2*(g+t)+1];v=(v+u.x*dt)*p-l.x*dt,b=(b+u.y*dt)*p-l.y*dt,h.push(new V(v,b))}}un(_1,"FillExtrusionBucket",{omit:["layers","features"]}),un(YN,"PartData"),un(ZN,"FootprintSegment"),un(KN,"BorderCentroidData"),un(QN,"GroundEffect");const Yne=new gi({visibility:new Xt(tt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xt(tt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Kne={paint:new gi({"fill-extrusion-opacity":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yn(tt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yn(tt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yn(tt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yn(tt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new yn(tt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new yn(tt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xt(tt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"])}),layout:Yne};class fv extends V{constructor(t,r,l){super(t,r),this.z=l}}function b1(i,t){return i.x*t.x+i.y*t.y}function sB(i,t){if(i.length===1){let r=0;const l=t[r++];let u;for(;!u||l.equals(u);)if(u=t[r++],!u)return 1/0;for(;r<t.length;r++){const h=t[r],p=i[0],g=u.sub(l),v=h.sub(l),b=p.sub(l),x=b1(g,g),S=b1(g,v),T=b1(v,v),P=b1(b,g),R=b1(b,v),z=x*T-S*S,U=(T*P-S*R)/z,W=(x*R-S*P)/z,j=l.z*(1-U-W)+u.z*U+h.z*W;if(isFinite(j))return j}return 1/0}{let r=1/0;for(const l of t)r=Math.min(r,l.z);return r}}function lB(i,t,r,l,u,h,p,g){const v=p*u.getElevationAt(i,t,!0,!0),b=h[0]!==0,x=b?h[1]===0?p*(h[0]/7-450):p*function(S,T,P){const R=Math.floor(T[0]/8),z=Math.floor(T[1]/8),U=10*(T[0]-8*R),W=10*(T[1]-8*z),j=S.getElevationAt(R,z,!0,!0),Z=S.getMeterToDEM(P),Y=Math.floor(.5*(U*Z-1)),$=Math.floor(.5*(W*Z-1)),K=S.tileCoordToPixel(R,z),ae=2*Y+1,se=2*$+1,de=function(We,qe,Qe,Ne,Ve){return[We.getElevationAtPixel(qe,Qe,!0),We.getElevationAtPixel(qe+Ve,Qe,!0),We.getElevationAtPixel(qe,Qe+Ve,!0),We.getElevationAtPixel(qe+Ne,Qe+Ve,!0)]}(S,K.x-Y,K.y-$,ae,se),ge=Math.abs(de[0]-de[1]),Te=Math.abs(de[2]-de[3]),we=Math.abs(de[0]-de[2])+Math.abs(de[1]-de[3]),Ie=Math.min(.25,.5*Z*(ge+Te)/ae),xe=Math.min(.25,.5*Z*we/se);return j+Math.max(Ie*U,xe*W)}(u,h,g):v;return{base:v+(r===0)?-1:r,top:b?Math.max(x+l,v+r+2):v+l}}const Jne=new gi({"line-cap":new yn(tt.layout_line["line-cap"]),"line-join":new yn(tt.layout_line["line-join"]),"line-miter-limit":new Xt(tt.layout_line["line-miter-limit"]),"line-round-limit":new Xt(tt.layout_line["line-round-limit"]),"line-sort-key":new yn(tt.layout_line["line-sort-key"]),visibility:new Xt(tt.layout_line.visibility)});var cB={paint:new gi({"line-opacity":new yn(tt.paint_line["line-opacity"]),"line-color":new yn(tt.paint_line["line-color"]),"line-translate":new Xt(tt.paint_line["line-translate"]),"line-translate-anchor":new Xt(tt.paint_line["line-translate-anchor"]),"line-width":new yn(tt.paint_line["line-width"]),"line-gap-width":new yn(tt.paint_line["line-gap-width"]),"line-offset":new yn(tt.paint_line["line-offset"]),"line-blur":new yn(tt.paint_line["line-blur"]),"line-dasharray":new yn(tt.paint_line["line-dasharray"]),"line-pattern":new yn(tt.paint_line["line-pattern"]),"line-gradient":new fm(tt.paint_line["line-gradient"]),"line-trim-offset":new Xt(tt.paint_line["line-trim-offset"]),"line-emissive-strength":new Xt(tt.paint_line["line-emissive-strength"]),"line-border-width":new yn(tt.paint_line["line-border-width"]),"line-border-color":new yn(tt.paint_line["line-border-color"])}),layout:Jne};const Qne=(i,t,r,l,u,h,p)=>{const g=i.transform,v=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:dB(i,t,r,l),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:fB(r)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:uB(t,i.transform),u_alpha_discard_threshold:0,u_trim_offset:p,u_emissive_strength:r.paint.get("line-emissive-strength")}},eae=(i,t,r,l,u)=>{const h=i.transform;return{u_matrix:dB(i,t,r,l),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:h.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:uB(t,h),u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function uB(i,t){return 1/xm(i,1,t.tileZoom)}function dB(i,t,r,l){return i.translatePosMatrix(l||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const hB=i=>{const t=[];fB(i)&&t.push("RENDER_LINE_DASH"),i.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=i.paint.get("line-trim-offset");return r[0]===0&&r[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),i.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function fB(i){const t=i.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const pB=new class extends yn{possiblyEvaluate(i,t){return t=new ii(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,r,l){return t=Ue({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,r,l)}}(cB.paint.properties["line-width"].specification);function mB(i,t){return t>0?t+2*i:i}pB.useIntegerZoom=!0;const tae=new gi({visibility:new Xt(tt.layout_background.visibility)});var nae={paint:new gi({"background-color":new Xt(tt.paint_background["background-color"]),"background-pattern":new Xt(tt.paint_background["background-pattern"]),"background-opacity":new Xt(tt.paint_background["background-opacity"]),"background-emissive-strength":new Xt(tt.paint_background["background-emissive-strength"])}),layout:tae};const aae=new gi({visibility:new Xt(tt.layout_raster.visibility)});var iae={paint:new gi({"raster-opacity":new Xt(tt.paint_raster["raster-opacity"]),"raster-color":new fm(tt.paint_raster["raster-color"]),"raster-color-mix":new Xt(tt.paint_raster["raster-color-mix"]),"raster-color-range":new Xt(tt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xt(tt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(tt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(tt.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(tt.paint_raster["raster-saturation"]),"raster-contrast":new Xt(tt.paint_raster["raster-contrast"]),"raster-resampling":new Xt(tt.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(tt.paint_raster["raster-fade-duration"])}),layout:aae};function gB(i,t,r,l,u,h,p,g){const v=[i,r,u,t,l,h,1,1,1],b=[p,g,1],x=Rs.adjoint([],v),[S,T,P]=ke.transformMat3(b,b,Rs.transpose(x,x));return Rs.multiply(v,[S,0,0,0,T,0,0,0,P],v)}class $u extends Bn{constructor(t,r,l,u){super(),this.id=t,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=r,this._dirty=!1}load(t,r){if(this._loaded=r||!1,this.fire(new Ht("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qt(this.map._requestManager.transformRequest(this.url,Se.Image),(l,u)=>{if(this._imageRequest=null,this._loaded=!0,l)this.fire(new vn(l));else if(u){const{HTMLImageElement:h}=m;this.image=u instanceof h?Cn.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new e3(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof e3||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=t[0][1],l=t[0][1];for(const h of t)h[1]>l&&(l=h[1]),h[1]<r&&(r=h[1]);const u=(l+r)/2;if(u>ji?this.onNorthPole=!0:u<-ji&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=t.map(ga.fromLngLat);this.tileID=function(p){let g=1/0,v=1/0,b=-1/0,x=-1/0;for(const R of p)g=Math.min(g,R.x),v=Math.min(v,R.y),b=Math.max(b,R.x),x=Math.max(x,R.y);const S=Math.max(b-g,x-v),T=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),P=Math.pow(2,T);return new Uu(T,Math.floor((g+b)/2*P),Math.floor((v+x)/2*P))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const v in this.tiles){const b=this.tiles[v];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}if(this._boundsArray)return;const r=bm(this.tileID,this.map.transform.projection),[l,u,h,p]=this.coordinates.map(v=>{const b=r.projection.project(v[0],v[1]);return iN(r,b)._round()});this.perspectiveTransform=function(v,b,x,S,T,P,R,z,U,W){const j=gB(0,0,v,0,0,b,v,b),Z=gB(x,S,T,P,R,z,U,W);return Rs.multiply(Z,Rs.adjoint(j,j),Z),[Z[6]/Z[8]*v/dt,Z[7]/Z[8]*b/dt]}(this.width,this.height,l.x,l.y,u.x,u.y,p.x,p.y,h.x,h.y);const g=this._boundsArray=new je;g.emplaceBack(l.x,l.y,0,0),g.emplaceBack(u.x,u.y,dt,0),g.emplaceBack(p.x,p.y,0,dt),g.emplaceBack(h.x,h.y,dt,dt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,xP.members),this.boundsSegments=Ha.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const r=this.map.painter.context,l=r.gl;!this._dirty||this.texture instanceof e3||(this.texture?this.texture.update(this.image):(this.texture=new mr(r,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(r)}loadTile(t,r){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},r(null)):(t.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class rae extends jo{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const oae=new gi({visibility:new Xt(tt.layout_sky.visibility)});var sae={paint:new gi({"sky-type":new Xt(tt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xt(tt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xt(tt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xt(tt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xt(tt.paint_sky["sky-gradient-radius"]),"sky-gradient":new fm(tt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xt(tt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xt(tt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xt(tt.paint_sky["sky-opacity"])}),layout:oae};function kP(i,t,r){const l=[0,0,1],u=Ao.identity([]);return Ao.rotateY(u,u,r?-be(i)+Math.PI:be(i)),Ao.rotateX(u,u,-be(t)),ke.transformQuat(l,l,u),ke.normalize(l,l)}var lae={paint:new gi({})};const cae={circle:class extends jo{constructor(i,t){super(i,YQ,t)}createBucket(i){return new $C(i)}queryRadius(i){const t=i;return Qy("circle-radius",this,t)+Qy("circle-stroke-width",this,t)+A2(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,r,l,u,h,p,g){const v=aF(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return rF(i,l,h,p,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(i,t){const r=iF(this);return{config:new pm(this,t),defines:r,overrideFog:!1}}},heatmap:class extends jo{createBucket(i){return new sF(i)}constructor(i,t){super(i,aee,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=E2({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Qy("heatmap-radius",this,i)}queryIntersectsFeature(i,t,r,l,u,h,p,g){const v=this.paint.get("heatmap-radius").evaluate(t,r);return rF(i,l,h,p,g,!0,!0,new V(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(i,t){return i==="heatmap"?{config:new pm(this,t),overrideFog:!1}:{}}},hillshade:class extends jo{constructor(i,t){super(i,ree,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(i,t){return{overrideFog:!1}}},fill:class extends jo{constructor(i,t){super(i,_ee,t)}getProgramIds(){const i=this.paint.get("fill-pattern"),t=i&&i.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(i,t){return{config:new pm(this,t),overrideFog:!1}}recalculate(i,t){super.recalculate(i,t);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new L2(i)}queryRadius(){return A2(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,r,l,u,h){return!i.queryGeometry.isAboveHorizon&&Jz(nF(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends jo{constructor(i,t){super(i,Kne,t)}createBucket(i){return new _1(i)}queryRadius(){return A2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(i,t,r,l,u,h,p,g,v){const b=aF(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),x=this.paint.get("fill-extrusion-height").evaluate(t,r),S=this.paint.get("fill-extrusion-base").evaluate(t,r),T=[0,0],P=g&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,z=i.tile.getBucket(this);if(P&&z instanceof _1){const Y=z.centroidVertexArray,$=v+1;$<Y.length&&(T[0]=Y.geta_centroid_pos0($),T[1]=Y.geta_centroid_pos1($))}if(T[0]===0&&T[1]===1)return!1;h.projection.name==="globe"&&(l=oB([l],[new V(0,0),new V(dt,dt)],i.tileID.canonical).map(Y=>Y.polygon).flat());const U=P?g:null,[W,j]=function(Y,$,K,ae,se,de,ge,Te,we,Ie,xe){return Y.projection.name==="globe"?function(We,qe,Qe,Ne,Ve,at,mt,lt,Ct,zt,bt){const Et=[],en=[],on=We.projection.upVectorScale(bt,We.center.lat,We.worldSize).metersToTile,rn=[0,0,0,1],cn=[0,0,0,1],gn=(ea,_a,$n,Un)=>{ea[0]=_a,ea[1]=$n,ea[2]=Un,ea[3]=1},kn=rB();Qe>0&&(Qe+=kn),Ne+=kn;for(const ea of qe){const _a=[],$n=[];for(const Un of ea){const In=Un.x+Ve.x,En=Un.y+Ve.y,da=We.projection.projectTilePoint(In,En,bt),Ea=We.projection.upVector(bt,Un.x,Un.y);let Qn=Qe,qa=Ne;if(mt){const bi=lB(In,En,Qe,Ne,mt,lt,Ct,zt);Qn+=bi.base,qa+=bi.top}Qe!==0?gn(rn,da.x+Ea[0]*on*Qn,da.y+Ea[1]*on*Qn,da.z+Ea[2]*on*Qn):gn(rn,da.x,da.y,da.z),gn(cn,da.x+Ea[0]*on*qa,da.y+Ea[1]*on*qa,da.z+Ea[2]*on*qa),ke.transformMat4(rn,rn,at),ke.transformMat4(cn,cn,at),_a.push(new fv(rn[0],rn[1],rn[2])),$n.push(new fv(cn[0],cn[1],cn[2]))}Et.push(_a),en.push($n)}return[Et,en]}(Y,$,K,ae,se,de,ge,Te,we,Ie,xe):ge?function(We,qe,Qe,Ne,Ve,at,mt,lt,Ct){const zt=[],bt=[],Et=[0,0,0,1];for(const en of We){const on=[],rn=[];for(const cn of en){const gn=cn.x+Ne.x,kn=cn.y+Ne.y,ea=lB(gn,kn,qe,Qe,at,mt,lt,Ct);Et[0]=gn,Et[1]=kn,Et[2]=ea.base,Et[3]=1,Va.transformMat4(Et,Et,Ve),Et[3]=Math.max(Et[3],1e-5);const _a=new fv(Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]);Et[0]=gn,Et[1]=kn,Et[2]=ea.top,Et[3]=1,Va.transformMat4(Et,Et,Ve),Et[3]=Math.max(Et[3],1e-5);const $n=new fv(Et[0]/Et[3],Et[1]/Et[3],Et[2]/Et[3]);on.push(_a),rn.push($n)}zt.push(on),bt.push(rn)}return[zt,bt]}($,K,ae,se,de,ge,Te,we,Ie):function(We,qe,Qe,Ne,Ve){const at=[],mt=[],lt=Ve[8]*qe,Ct=Ve[9]*qe,zt=Ve[10]*qe,bt=Ve[11]*qe,Et=Ve[8]*Qe,en=Ve[9]*Qe,on=Ve[10]*Qe,rn=Ve[11]*Qe;for(const cn of We){const gn=[],kn=[];for(const ea of cn){const _a=ea.x+Ne.x,$n=ea.y+Ne.y,Un=Ve[0]*_a+Ve[4]*$n+Ve[12],In=Ve[1]*_a+Ve[5]*$n+Ve[13],En=Ve[2]*_a+Ve[6]*$n+Ve[14],da=Ve[3]*_a+Ve[7]*$n+Ve[15],Ea=Un+lt,Qn=In+Ct,qa=En+zt,bi=Math.max(da+bt,1e-5),ri=Un+Et,Qa=In+en,ar=En+on,xi=Math.max(da+rn,1e-5);gn.push(new fv(Ea/bi,Qn/bi,qa/bi)),kn.push(new fv(ri/xi,Qa/xi,ar/xi))}at.push(gn),mt.push(kn)}return[at,mt]}($,K,ae,se,de)}(h,l,S,x,b,p,U,T,R,h.center.lat,i.tileID.canonical),Z=i.queryGeometry;return function(Y,$,K){let ae=1/0;Jz(K,$)&&(ae=sB(K,$[0]));for(let se=0;se<$.length;se++){const de=$[se],ge=Y[se];for(let Te=0;Te<de.length-1;Te++){const we=de[Te],Ie=[we,de[Te+1],ge[Te+1],ge[Te],we];Kz(K,Ie)&&(ae=Math.min(ae,sB(K,Ie)))}}return ae!==1/0&&ae}(W,j,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends jo{constructor(i,t){super(i,cB,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Qh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=pB.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Q2(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(i,t){const r=hB(this);return{config:new pm(this,t),defines:r,overrideFog:!1}}queryRadius(i){const t=i,r=mB(Qy("line-width",this,t),Qy("line-gap-width",this,t)),l=Qy("line-offset",this,t);return r/2+Math.abs(l)+A2(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,r,l,u,h){if(i.queryGeometry.isAboveHorizon)return!1;const p=nF(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),g=i.pixelToTileUnitsFactor/2*mB(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),v=this.paint.get("line-offset").evaluate(t,r);return v&&(l=function(b,x){const S=[],T=new V(0,0);for(let P=0;P<b.length;P++){const R=b[P],z=[];for(let U=0;U<R.length;U++){const W=R[U],j=R[U+1],Z=U===0?T:W.sub(R[U-1])._unit()._perp(),Y=U===R.length-1?T:j.sub(W)._unit()._perp(),$=Z._add(Y)._unit();$._mult(1/($.x*Y.x+$.y*Y.y)),z.push($._mult(x)._add(W))}S.push(z)}return S}(l,v*i.pixelToTileUnitsFactor)),function(b,x,S){for(let T=0;T<x.length;T++){const P=x[T];if(b.length>=3){for(let R=0;R<P.length;R++)if(vf(b,P[R]))return!0}if($Q(b,P,S))return!0}return!1}(p,l,g)}isTileClipped(){return!0}},symbol:q2,background:class extends jo{constructor(i,t){super(i,nae,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(i,t){return{overrideFog:!1}}},raster:class extends jo{constructor(i,t){super(i,iae,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(i){return!(i&&i._source instanceof $u&&(i._source.onNorthPole||i._source.onSouthPole))}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-color"].value.expression,[t,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=E2({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:r}],resolution:256}),this.colorRampTexture=null}},sky:class extends jo{constructor(i,t){super(i,sae,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=E2({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(i,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),u=!l,h=i.style.light,p=h.properties.get("position");return u&&h.properties.get("anchor")==="viewport"&&ve("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?kP(p.azimuthal,90-p.polar,t):kP(l[0],90-l[1],t)}const r=this.paint.get("sky-gradient-center");return kP(r[0],90-r[1],t)}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}},slot:class extends jo{constructor(i,t){super(i,lae)}},model:class extends jo{constructor(i,t){super(i,zne,t)}createBucket(i){return new NN(i)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(i,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven()||i!=="model-color"&&i!=="model-color-mix-intensity"&&i!=="model-rotation"&&i!=="model-scale"&&i!=="model-translation"&&i!=="model-emissive-strength")}_isPropertyZoomDependent(i){const t=this._transitionablePaint._values[i];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof Dc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function d3(i,t){return i.type==="custom"?new rae(i):new cae[i.type](i,t)}function uae(i){const{userImage:t}=i;return!!(t&&t.render&&t.render())&&(i.data.replace(new Uint8Array(t.data.buffer)),!0)}class dae extends Bn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new $i({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,r){if(this.loaded[r]!==t&&(this.loaded[r]=t,t)){for(const{ids:l,callback:u}of this.requestors)this._notify(l,r,u);this.requestors=[]}}hasImage(t,r){return!!this.getImage(t,r)}getImage(t,r){return this.images[r][t]}addImage(t,r,l){this._validate(t,l)&&(this.images[r][t]=l)}_validate(t,r){let l=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new vn(new Error(`Image "${t}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new vn(new Error(`Image "${t}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new vn(new Error(`Image "${t}" has invalid "content" value`))),l=!1),l}_validateStretch(t,r){if(!t)return!0;let l=0;for(const u of t){if(u[0]<l||u[1]<u[0]||r<u[1])return!1;l=u[1]}return!0}_validateContent(t,r){return!(t&&(t.length!==4||t[0]<0||r.data.width<t[0]||t[1]<0||r.data.height<t[1]||t[2]<0||r.data.width<t[2]||t[3]<0||r.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,r,l){l.version=this.images[r][t].version+1,this.images[r][t]=l,this.updatedImages[r][t]=!0}removeImage(t,r){const l=this.images[r][t];delete this.images[r][t],delete this.patterns[r][t],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,r,l){let u=!0;const h=!!this.loaded[r];if(!h)for(const p of t)this.images[r][p]||(u=!1);h||u?this._notify(t,r,l):this.requestors.push({ids:t,scope:r,callback:l})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,r,l){const u={};for(const h of t){this.images[r][h]||this.fire(new Ht("styleimagemissing",{id:h}));const p=this.images[r][h];p?u[h]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:ve(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,u)}getPixelSize(t){const{width:r,height:l}=this.atlasImage[t];return{width:r,height:l}}getPattern(t,r){const l=this.patterns[r][t],u=this.getImage(t,r);if(!u)return null;if(l&&l.position.version===u.version)return l.position;if(l)l.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},p=new hP(h,u);this.patterns[r][t]={bin:h,position:p}}return this._updatePatternAtlas(r),this.patterns[r][t].position}bind(t,r){const l=t.gl;let u=this.atlasTexture[r];u?this.dirty&&(u.update(this.atlasImage[r]),this.dirty=!1):(u=new mr(t,this.atlasImage[r],l.RGBA),this.atlasTexture[r]=u),u.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const r=[];for(const p in this.patterns[t])r.push(this.patterns[t][p].bin);const{w:l,h:u}=dP(r),h=this.atlasImage[t];h.resize({width:l||1,height:u||1});for(const p in this.patterns[t]){const{bin:g}=this.patterns[t][p],v=g.x+1,b=g.y+1,x=this.images[t][p].data,S=x.width,T=x.height;$i.copy(x,h,{x:0,y:0},{x:v,y:b},{width:S,height:T}),$i.copy(x,h,{x:0,y:T-1},{x:v,y:b-1},{width:S,height:1}),$i.copy(x,h,{x:0,y:0},{x:v,y:b+T},{width:S,height:1}),$i.copy(x,h,{x:S-1,y:0},{x:v-1,y:b},{width:1,height:T}),$i.copy(x,h,{x:0,y:0},{x:v+S,y:b},{width:1,height:T})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,r){for(const l of t){if(this.callbackDispatchedThisFrame[r][l])continue;this.callbackDispatchedThisFrame[r][l]=!0;const u=this.images[r][l];uae(u)&&this.updateImage(l,r,u)}}}const hae=new gi({anchor:new Xt(tt.light.anchor),position:new class{constructor(i){this.specification=i}possiblyEvaluate(i,t){return ot(i.expression.evaluate(t))}interpolate(i,t,r){return{x:Ln(i.x,t.x,r),y:Ln(i.y,t.y,r),z:Ln(i.z,t.z,r),azimuthal:Ln(i.azimuthal,t.azimuthal,r),polar:Ln(i.polar,t.polar,r)}}}(tt.light.position),color:new Xt(tt.light.color),intensity:new Xt(tt.light.intensity)});class yB extends Bn{constructor(t,r="flat"){super(),this._transitionable=new Gd(hae),this.setLight(t,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r,l={}){this._validate(Dy,t,l)||(this._transitionable.setTransitionOrValue(t),this.id=r)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,l){return(!l||l.validate!==!1)&&fo(this,t.call(ku,Ue({value:r,style:{glyphs:!0,sprite:!0},styleSpec:tt})))}}const fae=new gi({source:new Xt(tt.terrain.source),exaggeration:new Xt(tt.terrain.exaggeration)});let pae=class extends Bn{constructor(i,t){super(),this._transitionable=new Gd(fae),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}setScope(i){this.scope=i}get(){return this._transitionable.serialize()}set(i){this._transitionable.setTransitionOrValue(i)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}getExaggeration(i){return this._transitioning.possiblyEvaluate(new ii(i)).get("exaggeration")}isZoomDependent(){const i=this._transitionable._values.exaggeration;return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof Dc}};const vB=45,_B=65,Am=.05;function h3(i,t,r,l){const u=Ee(vB,_B,r),[h,p]=bB(i,l);let g=1-Math.min(1,Math.exp((t-h)/(p-h)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*u*i.alpha}function bB(i,t){const r=.5/Math.tan(.5*t);return[i.range[0]+r,i.range[1]+r]}function xB(i,t,r,l,u){const h=ke.transformMat4([],[t,r,l],u.mercatorFogMatrix);return h3(i,ke.length(h),u.pitch,u._fov)}function wB(i,t,r,l,u,h,p){const g=[[r,l,0],[u,l,0],[u,h,0],[r,h,0]];let v=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(const x of g){const S=ke.transformMat4([],x,t),T=ke.length(S);v=Math.min(v,T),b=Math.max(b,T)}return[h3(i,v,p.pitch,p._fov),h3(i,b,p.pitch,p._fov)]}const mae=new gi({range:new Xt(tt.fog.range),color:new Xt(tt.fog.color),"high-color":new Xt(tt.fog["high-color"]),"space-color":new Xt(tt.fog["space-color"]),"horizon-blend":new Xt(tt.fog["horizon-blend"]),"star-intensity":new Xt(tt.fog["star-intensity"]),"vertical-range":new Xt(tt.fog["vertical-range"])});class gae extends Bn{constructor(t,r){super(),this._transitionable=new Gd(mae),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r=t.projection.name==="globe",l=mo(t.zoom),u=this.properties.get("range"),h=[.5,3];return{range:r?[Ln(h[0],u[0],l),Ln(h[1],u[1],l)]:u,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(this._validate(Oy,t,r))return;const l=Ue({},t);for(const u of Object.keys(tt.fog))l[u]===void 0&&(l[u]=tt.fog[u].default);this._transitionable.setTransitionOrValue(l)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Ee(vB,_B,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(l,u,h){const p=ga.fromLngLat(u),g=h.elevation?h.elevation.getAtPointOrZero(p):0;return xB(l,p.x,p.y,g,h)}(this.state,t,r):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(t.toUnwrapped());return wB(this.state,r,0,0,dt,dt,this._transform)}getOpacityForBounds(t,r,l,u,h){return this._transform.projection.supportsFog?wB(this.state,t,r,l,u,h,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?bB(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const l of r){const u=t.points[l];let h;if(u[2]>=0)h=u;else{const p=t.points[l-4];h=ef(p,u,p[2]/(p[2]-u[2]))}if(xB(this.state,h[0],h[1],0,this._transform)>=Am)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,l){return(!l||l.validate!==!1)&&fo(this,t.call(ku,Ue({value:r,style:{glyphs:!0,sprite:!0},styleSpec:tt})))}}class yae{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class vae{constructor(){this.tasks={},this.taskQueue=[],ft(["process"],this),this.invoker=new yae(this.process),this.nextId=0}add(t,r){const l=this.nextId++,u=function({type:h,isSymbolTile:p,zoom:g}){return g=g||0,h==="message"?0:h!=="maybePrepare"||p?h!=="parseTile"||p?h==="parseTile"&&p?300-g:h==="maybePrepare"&&p?400-g:500:200-g:100-g}(r);if(u===0){te();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:r,priority:u,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){te();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let t=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const h=this.tasks[this.taskQueue[u]];h.priority<r&&(r=h.priority,t=u)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class SB{constructor(t,r,l){this.target=t,this.parent=r,this.mapId=l,this.callbacks={},this.cancelCallbacks={},ft(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new vae}send(t,r,l,u,h=!1,p){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=p,this.callbacks[g]=l);const v=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!l,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:Ps(r,v)},v),{cancel:()=>{l&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(t){const r=t.data,l=r.id;if(l&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const u=this.cancelCallbacks[l];delete this.cancelCallbacks[l],u&&u.cancel()}else if(r.mustQueue||te()){const u=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,r),u&&u.metadata||{type:"message"})}else this.processTask(l,r)}processTask(t,r){if(r.type==="<response>"){const l=this.callbacks[t];delete this.callbacks[t],l&&(r.error?l(Wd(r.error)):l(null,Wd(r.data)))}else{const l=new Set,u=r.hasCallback?(p,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:p?Ps(p):null,data:Ps(g,l)},l)}:p=>{},h=Wd(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,h,u);else if(this.parent.getWorkerSource){const p=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,p[0],h.source,h.scope)[p[1]](h,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Em{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Rt();const l=this.workerPool.acquire(this.id);for(let u=0;u<l.length;u++){const h=new Em.Actor(l[u],r,this.id);h.name=`Worker ${u}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,r,l){Xe(this.actors,(u,h)=>{u.send(t,r,h)},l=l||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Em.Actor=SB;class AB extends Bn{constructor(t,r,l,u){super(),this.scope=l,this._options=t,this.properties=new Fu(r),this._transitionable=new Gd(r,new Map(u)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,r){this._options=t,this._transitionable.setTransitionOrValue(t.properties,r)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const _ae=new gi({color:new Xt(tt.properties_light_ambient.color),intensity:new Xt(tt.properties_light_ambient.intensity)}),bae=new gi({direction:new class{constructor(i){this.specification=i}possiblyEvaluate(i,t){return function([r,l]){const u=ot([1,r,l]);return{x:u.x,y:u.y,z:u.z}}(i.expression.evaluate(t))}interpolate(i,t,r){return{x:Ln(i.x,t.x,r),y:Ln(i.y,t.y,r),z:Ln(i.z,t.z,r)}}}(tt.properties_light_directional.direction),color:new Xt(tt.properties_light_directional.color),intensity:new Xt(tt.properties_light_directional.intensity),"cast-shadows":new Xt(tt.properties_light_directional["cast-shadows"]),"shadow-intensity":new Xt(tt.properties_light_directional["shadow-intensity"])});class DP{constructor(t,r,l,u){this.screenBounds=t,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=l,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,u)}static createFromScreenPoints(t,r){let l,u;if(t instanceof V||typeof t[0]=="number"){const h=V.convert(t);l=[h],u=r.isPointAboveHorizon(h)}else{const h=V.convert(t[0]),p=V.convert(t[1]);l=[h,p],u=ue(h,p).every(g=>r.isPointAboveHorizon(g))}return new DP(l,r.getCameraPoint(),u,r)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return ue(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],l=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=ue(r,l,0,!1);return this.cameraPoint.y>l.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<l.x?u.splice(3,0,this.cameraPoint):this.cameraPoint.x>=l.x?u[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(u[3]=this.cameraPoint)),function(h,p){const g=[];for(let v=0;v<h.length;v++){const b=Ye(v-1,-1,h.length-1),x=Ye(v+1,-1,h.length-1),S=h[v],T=h[x],P=h[b].sub(S).unit(),R=T.sub(S).unit(),z=R.angleWithSep(P.x,P.y),U=P.add(R).unit().mult(-1*p/Math.sin(z/2));g.push(S.add(U))}return g}(u,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],l=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=ue(r,l,t),h=this.cameraPoint.clone();switch(3*((h.y>r.y)+(h.y>l.y))+((h.x>r.x)+(h.x>l.x))){case 0:u[0]=h,u[4]=h.clone();break;case 1:u.splice(1,0,h);break;case 2:u[1]=h;break;case 3:u.splice(4,0,h);break;case 5:u.splice(2,0,h);break;case 6:u[3]=h;break;case 7:u.splice(3,0,h);break;case 8:u[2]=h}return u}containsTile(t,r,l,u=0){const h=t.queryPadding/r._pixelsPerMercatorPixel+1,p=l?this._bufferedCameraMercator(h,r):this._bufferedScreenMercator(h,r);let g=t.tileID.wrap+(p.unwrapped?u:0);const v=p.polygon.map(U=>iN(t.tileTransform,U,g));if(!tF(v,0,0,dt,dt))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?u:0);const b=this.screenGeometryMercator.polygon.map(U=>rN(t.tileTransform,U,g)),x=b.map(U=>new V(U[0],U[1])),S=r.getFreeCameraOptions().position||new ga(0,0,0),T=rN(t.tileTransform,S,g),P=b.map(U=>{const W=ke.sub(U,U,T);return ke.normalize(W,W),new g2(T,W)}),R=xm(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:x,tilespaceRays:P,bufferedTilespaceGeometry:v,bufferedTilespaceBounds:(z=He(v),z.min.x=ne(z.min.x,0,dt),z.min.y=ne(z.min.y,0,dt),z.max.x=ne(z.max.x,0,dt),z.max.y=ne(z.max.y,0,dt),z),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:R};var z}_bufferedScreenMercator(t,r){const l=EB(t);if(this._screenRaycastCache[l])return this._screenRaycastCache[l];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),r):{polygon:this.bufferedScreenGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._screenRaycastCache[l]=u,u}}_bufferedCameraMercator(t,r){const l=EB(t);if(this._cameraRaycastCache[l])return this._cameraRaycastCache[l];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),r):{polygon:this.bufferedCameraGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._cameraRaycastCache[l]=u,u}}_projectAndResample(t,r){const l=function(h,p){const g=nt.multiply([],p.pixelMatrix,p.globeMatrix),v=[0,-os,0,1],b=[0,os,0,1],x=[0,0,0,1];Va.transformMat4(v,v,g),Va.transformMat4(b,b,g),Va.transformMat4(x,x,g);const S=new V(v[0]/v[3],v[1]/v[3]),T=new V(b[0]/b[3],b[1]/b[3]),P=vf(h,S)&&v[3]<x[3],R=vf(h,T)&&b[3]<x[3];if(!P&&!R)return null;const z=function(ae,se,de){for(let ge=1;ge<ae.length;ge++){const Te=x1(se.pointCoordinate3D(ae[ge-1]).x),we=x1(se.pointCoordinate3D(ae[ge]).x);if(de<0){if(Te<we)return{idx:ge,t:-Te/(we-1-Te)}}else if(we<Te)return{idx:ge,t:(1-Te)/(we+1-Te)}}return null}(h,p,P?-1:1);if(!z)return null;const{idx:U,t:W}=z;let j=U>1?OP(h.slice(0,U),p):[],Z=U<h.length?OP(h.slice(U),p):[];j=j.map(ae=>new V(x1(ae.x),ae.y)),Z=Z.map(ae=>new V(x1(ae.x),ae.y));const Y=[...j];Y.length===0&&Y.push(Z[Z.length-1]);const $=Ln(Y[Y.length-1].y,(Z.length===0?j[0]:Z[0]).y,W);let K;return K=P?[new V(0,$),new V(0,0),new V(1,0),new V(1,$)]:[new V(1,$),new V(1,1),new V(0,1),new V(0,$)],Y.push(...K),Z.length===0?Y.push(j[0]):Y.push(...Z),{polygon:Y.map(ae=>new ga(ae.x,ae.y)),unwrapped:!1}}(t,r);if(l)return l;const u=function(h,p){let g=!1,v=-1/0,b=0;for(let S=0;S<h.length-1;S++)h[S].x>v&&(v=h[S].x,b=S);for(let S=0;S<h.length-1;S++){const T=(b+S)%(h.length-1),P=h[T],R=h[T+1];Math.abs(P.x-R.x)>.5&&(P.x<R.x?(P.x+=1,T===0&&(h[h.length-1].x+=1)):(R.x+=1,T+1===h.length-1&&(h[0].x+=1)),g=!0)}const x=go(p.center.lng);return g&&x<Math.abs(x-1)&&h.forEach(S=>{S.x-=1}),{polygon:h,unwrapped:g}}(OP(t,r).map(h=>new V(x1(h.x),h.y)),r);return{polygon:u.polygon.map(h=>new ga(h.x,h.y)),unwrapped:u.unwrapped}}}function OP(i,t){return Zz(i,r=>{const l=t.pointCoordinate3D(r);r.x=l.x,r.y=l.y},1/256)}function x1(i){return i<0?1+i%1:i%1}function EB(i){return 100*i|0}function zP(i,t,r,l,u){const h=function(p,g){if(p)return u(p);if(g){i.url&&g.tiles&&i.tiles&&delete i.tiles;const v=ht(Ue(g,i),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(b=>b.id)),v.tiles=t.canonicalizeTileset(v,i.url),u(null,v)}};return i.url?et(t.transformRequest(t.normalizeSourceURL(i.url,null,r,l),Se.Source),h):Cn.frame(()=>h(null,i))}class f3{constructor(t,r,l){this.bounds=Il.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),l=Math.floor(go(this.bounds.getWest())*r),u=Math.floor(Eo(this.bounds.getNorth())*r),h=Math.ceil(go(this.bounds.getEast())*r),p=Math.ceil(Eo(this.bounds.getSouth())*r);return t.x>=l&&t.x<h&&t.y>=u&&t.y<p}}class MB{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.image=new Jd({width:t,height:r}),this.positions={},this.uploaded=!1}getDash(t,r){const l=this.getKey(t,r);return this.positions[l]}trim(){const t=this.width,r=this.height=Pt(this.nextRow);this.image.resize({width:t,height:r})}getKey(t,r){return t.join(",")+r}getDashRanges(t,r,l){const u=[];let h=t.length%2==1?-t[t.length-1]*l:0,p=t[0]*l,g=!0;u.push({left:h,right:p,isDash:g,zeroLength:t[0]===0});let v=t[0];for(let b=1;b<t.length;b++){g=!g;const x=t[b];h=v*l,v+=x,p=v*l,u.push({left:h,right:p,isDash:g,zeroLength:x===0})}return u}addRoundDash(t,r,l){const u=r/2;for(let h=-l;h<=l;h++){const p=this.width*(this.nextRow+l+h);let g=0,v=t[g];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++g]);const x=Math.abs(b-v.left),S=Math.abs(b-v.right),T=Math.min(x,S);let P;const R=h/l*(u+1);if(v.isDash){const z=u-Math.abs(R);P=Math.sqrt(T*T+z*z)}else P=u-Math.sqrt(T*T+R*R);this.image.data[p+b]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(t,r){for(let v=t.length-1;v>=0;--v){const b=t[v],x=t[v+1];b.zeroLength?t.splice(v,1):x&&x.isDash===b.isDash&&(x.left=b.left,t.splice(v,1))}const l=t[0],u=t[t.length-1];l.isDash===u.isDash&&(l.left=u.left-this.width,u.right=l.right+this.width);const h=this.width*this.nextRow;let p=0,g=t[p];for(let v=0;v<this.width;v++){v/g.right>1&&(g=t[++p]);const b=Math.abs(v-g.left),x=Math.abs(v-g.right),S=Math.min(b,x);this.image.data[h+v]=Math.max(0,Math.min(255,(g.isDash?S:-S)+r+128))}}addDash(t,r){const l=this.getKey(t,r);if(this.positions[l])return this.positions[l];const u=r==="round",h=u?7:0,p=2*h+1;if(this.nextRow+p>this.height)return ve("LineAtlas out of space"),null;t.length===0&&t.push(1);let g=0;for(let x=0;x<t.length;x++)t[x]<0&&(ve("Negative value is found in line dasharray, replacing values with 0"),t[x]=0),g+=t[x];if(g!==0){const x=this.width/g,S=this.getDashRanges(t,this.width,x);u?this.addRoundDash(S,x,h):this.addRegularDash(S,r==="square"?.5*x:0)}const v=this.nextRow+h;this.nextRow+=p;const b={tl:[v,h],br:[g,0]};return this.positions[l]=b,b}}un(MB,"LineAtlas");const TB=1*Gc;class CB{constructor(t){const r={},l=[];for(const g in t){const v=t[g],b=r[g]={};for(const x in v.glyphs){const S=v.glyphs[+x];if(!S||S.bitmap.width===0||S.bitmap.height===0)continue;const T=S.metrics.localGlyph?TB:1,P={x:0,y:0,w:S.bitmap.width+2*T,h:S.bitmap.height+2*T};l.push(P),b[x]=P}}const{w:u,h}=dP(l),p=new Jd({width:u||1,height:h||1});for(const g in t){const v=t[g];for(const b in v.glyphs){const x=v.glyphs[+b];if(!x||x.bitmap.width===0||x.bitmap.height===0)continue;const S=r[g][b],T=x.metrics.localGlyph?TB:1;Jd.copy(x.bitmap,p,{x:0,y:0},{x:S.x+T,y:S.y+T},x.bitmap)}}this.image=p,this.positions=r}}un(CB,"GlyphAtlas");class xae{constructor(t){this.tileID=new Ta(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=bm(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,r,l,u,h){this.status="parsing",this.data=t,this.collisionBoxArray=new fC;const p=new vF(Object.keys(t.layers).sort()),g=new lP(this.tileID,this.promoteId);g.bucketLayerIDs=[];const v={},b=new MB(256,256),x={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:l,brightness:this.brightness},S=r.familiesBySource[this.source];for(const j in S){const Z=t.layers[j];if(!Z)continue;let Y=!1,$=!1,K=!1;for(const de of S[j])de[0].type==="symbol"?Y=!0:$=!0,de[0].is3D()&&de[0].type!=="model"&&(K=!0);if(this.extraShadowCaster&&!K||this.isSymbolTile===!0&&!Y||this.isSymbolTile===!1&&!$)continue;Z.version===1&&ve(`Vector tile source "${this.source}" layer "${j}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ae=p.encode(j),se=[];for(let de=0;de<Z.length;de++){const ge=Z.feature(de),Te=g.getId(ge,j);se.push({feature:ge,id:Te,index:de,sourceLayerIndex:ae})}for(const de of S[j]){const ge=de[0];(!this.extraShadowCaster||ge.is3D()&&ge.type!=="model")&&(this.isSymbolTile!==void 0&&ge.type==="symbol"!==this.isSymbolTile||ge.minzoom&&this.zoom<Math.floor(ge.minzoom)||ge.maxzoom&&this.zoom>=ge.maxzoom||ge.visibility!=="none"&&(FP(de,this.zoom,x.brightness,l),(v[ge.id]=ge.createBucket({index:g.bucketLayerIDs.length,layers:de,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ae,sourceID:this.source,projection:this.projection.spec})).populate(se,x,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(de.map(Te=>Te.id))))}}let T,P,R,z;b.trim();const U={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},W=()=>{if(T)return h(T);if(this.extraShadowCaster)this.status="done",h(null,{buckets:Ke(v).filter(j=>!j.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:x.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(P&&R&&z){const j=new CB(P),Z=new zF(R,z);for(const Y in v){const $=v[Y];$ instanceof d1?(FP($.layers,this.zoom,x.brightness,l),yte($,P,j.positions,R,Z.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):$.hasPattern&&($ instanceof Q2||$ instanceof L2||$ instanceof _1)&&(FP($.layers,this.zoom,x.brightness,l),$.addFeatures(x,this.tileID.canonical,Z.patternPositions,l,this.tileTransform,this.brightness))}this.status="done",h(null,{buckets:Ke(v).filter(Y=>!Y.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:j.image,lineAtlas:b,imageAtlas:Z,brightness:x.brightness})}};if(!this.extraShadowCaster){const j=St(x.glyphDependencies,$=>Object.keys($).map(Number));Object.keys(j).length?u.send("getGlyphs",{uid:this.uid,stacks:j,scope:this.scope},($,K)=>{T||(T=$,P=K,W())},void 0,!1,U):P={};const Z=Object.keys(x.iconDependencies);Z.length?u.send("getImages",{icons:Z,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},($,K)=>{T||(T=$,R=K,W())},void 0,!1,U):R={};const Y=Object.keys(x.patternDependencies);Y.length?u.send("getImages",{icons:Y,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},($,K)=>{T||(T=$,z=K,W())},void 0,!1,U):z={}}W()}}function FP(i,t,r,l){const u=new ii(t,{brightness:r});for(const h of i)h.recalculate(u,l)}class PB{constructor(t){this.entries={},this.scheduler=t}request(t,r,l,u){const h=this.entries[t]=this.entries[t]||{callbacks:[]};if(h.result){const[p,g]=h.result;return this.scheduler?this.scheduler.add(()=>{u(p,g)},r):u(p,g),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=l((p,g)=>{h.result=[p,g];for(const v of h.callbacks)this.scheduler?this.scheduler.add(()=>{v(p,g)},r):v(p,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(p=>p!==u),h.callbacks.length||(h.cancel(),delete this.entries[t]))}}}function IB(i,t,r){const l=JSON.stringify(i.request);return i.data&&(this.deduped.entries[l]={result:[null,i.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},u=>{const h=yt(i.request,(p,g,v,b)=>{p?u(p):g&&u(null,{vectorTile:r?void 0:new iP(new F2(g)),rawData:g,cacheControl:v,expires:b})});return()=>{h.cancel(),u()}},t)}class LB extends Bn{constructor(t,r,l,u){if(super(),this.id=t,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Ue(this,ht(r,["url","scheme","tileSize","promoteId"])),this._options=Ue({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new PB}load(t){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=zP(this._options,this.map._requestManager,r,l,(u,h)=>{this._tileJSONRequest=null,this._loaded=!0,u?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new vn(u))):h&&(Ue(this,h),h.bounds&&(this.tileBounds=new f3(h.bounds,this.minzoom,this.maxzoom)),ln(h.tiles,this.map._requestManager._customAccessToken),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),t&&t(u)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Ho(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ue({},this._options)}loadTile(t,r){const l=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(l,Se.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(u.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=r:t.request=t.actor.send("reloadTile",u,h.bind(this));else if(t.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",u,h.bind(this),void 0,!0);else{const p=IB.call({deduped:this._deduped},u,(g,v)=>{g||!v?h.call(this,g):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},t.actor&&t.actor.send("loadTile",u,h.bind(this),void 0,!0))},!0);t.request={cancel:p}}function h(p,g){return delete t.request,t.aborted?r(null):p&&p.status!==404?r(p):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),Ze(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class w1 extends Bn{constructor(t,r,l,u){super(),this.id=t,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Ue({type:"raster"},r),Ue(this,ht(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"})),this._tileJSONRequest=zP(this._options,this.map._requestManager,null,null,(r,l)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new vn(r)):l&&(Ue(this,l),l.bounds&&(this.tileBounds=new f3(l.bounds,this.minzoom,this.maxzoom)),ln(l.tiles),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Ho(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ue({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,r){const l=Cn.devicePixelRatio>=2,u=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),l,this.tileSize);t.request=Qt(this.map._requestManager.transformRequest(u,Se.Tile),(h,p,g,v)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):h?(t.state="errored",r(h)):p?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:v}),t.setTexture(p,this.map.painter),t.state="loaded",Ze(this.dispatcher),void r(null)):r(null)))}static loadTileData(t,r,l){t.setTexture(r,l)}static unloadTileData(t,r){t.texture&&r.saveTileTexture(t.texture)}abortTile(t,r){t.request&&(t.request.cancel(),delete t.request),r()}unloadTile(t,r){t.texture&&this.map.painter.saveTileTexture(t.texture),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let NP;function wae(){return O3.workerClass!=null?new O3.workerClass:new m.Worker(O3.workerUrl)}const BP="mapboxgl_preloaded_worker_pool";class pv{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<pv.workerCount;)this.workers.push(new wae);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[BP]}numActive(){return Object.keys(this.active).length}}let S1;function A1(){return S1||(S1=new pv),S1}pv.workerCount=2;let E1,UP,$c,WP=null;function RB(){return te()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:UP||w.DRACO_URL}const VP=5123,GP=5126,HP={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[VP]:Uint16Array,5125:Uint32Array,[GP]:Float32Array},Sae={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[VP]:"DT_UINT16",5125:"DT_UINT32",[GP]:"DT_FLOAT32"},jP={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function kB(i,t,r){const l=r.json.bufferViews.length,u=r.buffers.length;t.bufferView=l,r.json.bufferViews[l]={buffer:u,byteLength:i.byteLength},r.buffers[u]=i}const $P="KHR_draco_mesh_compression";function Aae(i,t){const r=i.extensions&&i.extensions[$P];if(!r)return;const l=new $c.Decoder,u=FB(t,r.bufferView),h=new $c.Mesh;if(!l.DecodeArrayToMesh(u,u.byteLength,h))throw new Error("Failed to decode Draco mesh");const p=t.json.accessors[i.indices],g=HP[p.componentType],v=p.count*g.BYTES_PER_ELEMENT,b=$c._malloc(v);g===Uint16Array?l.GetTrianglesUInt16Array(h,v,b):l.GetTrianglesUInt32Array(h,v,b),kB($c.memory.buffer.slice(b,b+v),p,t),$c._free(b);for(const x of Object.keys(r.attributes)){const S=l.GetAttributeByUniqueId(h,r.attributes[x]),T=t.json.accessors[i.attributes[x]],P=Sae[T.componentType],R=T.count*jP[T.type]*HP[T.componentType].BYTES_PER_ELEMENT,z=$c._malloc(R);l.GetAttributeDataArrayForAllPoints(h,S,$c[P],R,z),kB($c.memory.buffer.slice(z,z+R),T,t),$c._free(z)}l.destroy(),h.destroy(),delete i.extensions[$P]}const DB=1179937895,OB=new TextDecoder("utf8");function zB(i,t){return new URL(i,t).href}async function Eae(i,t,r,l){const u=await fetch(zB(i.uri,l)),h=await u.arrayBuffer();t.buffers[r]=h}function FB(i,t){const r=i.json.bufferViews[t];return new Uint8Array(i.buffers[r.buffer],r.byteOffset||0,r.byteLength)}async function Mae(i,t,r,l){if(i.uri){const u=zB(i.uri,l),h=await fetch(u),p=await h.blob();t.images[r]=await m.createImageBitmap(p)}else if(i.bufferView!==void 0){const u=FB(t,i.bufferView),h=new m.Blob([u],{type:i.mimeType});t.images[r]=await m.createImageBitmap(h)}}async function NB(i,t=0,r){const l={json:null,images:[],buffers:[]};if(new Uint32Array(i,t,1)[0]===DB){const x=new Uint32Array(i,t);let S=2;const T=(x[S++]>>2)-3,P=x[S++]>>2;if(S++,l.json=JSON.parse(OB.decode(x.subarray(S,S+P))),S+=P,S<T){const R=x[S++];S++;const z=t+(S<<2);l.buffers[0]=i.slice(z,z+R)}}else l.json=JSON.parse(OB.decode(new Uint8Array(i,t)));const{buffers:u,images:h,meshes:p,extensionsUsed:g}=l.json;if(u){const x=[];for(let S=0;S<u.length;S++){const T=u[S];T.uri?x.push(Eae(T,l,S,r)):l.buffers[S]||(l.buffers[S]=null)}await Promise.all(x)}const v=[],b=g&&g.includes($P);if(b&&v.push(async function(){if(!$c){if(E1)return E1;E1=async function(x){let S,T=null;function P(){S=new Uint8Array(T.buffer)}function R(){throw new Error("Unexpected Draco error.")}const z={a:{a:R,d:function(lt,Ct,zt){return S.copyWithin(lt,Ct,Ct+zt)},c:function(lt){const Ct=S.length,zt=Math.max(lt>>>0,Math.ceil(1.2*Ct)),bt=Math.ceil((zt-Ct)/65536);try{return T.grow(bt),P(),!0}catch{return!1}},b:R}},U=await(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(x,z):WebAssembly.instantiate(await(await x).arrayBuffer(),z)),{Rb:W,Qb:j,P:Z,T:Y,X:$,Ja:K,La:ae,Qa:se,Va:de,Wa:ge,eb:Te,jb:we,f:Ie,e:xe,yb:We,zb:qe,Ab:Qe,Bb:Ne,Db:Ve,Gb:at}=U.instance.exports;T=xe;const mt=(()=>{let lt=0,Ct=0,zt=0,bt=0;return Et=>{zt&&(W(bt),W(lt),Ct+=zt,zt=lt=0),lt||(Ct+=128,lt=j(Ct));const en=Et.length+7&-8;let on=lt;en>=Ct&&(zt=en,on=bt=j(en));for(let rn=0;rn<Et.length;rn++)S[on+rn]=Et[rn];return on}})();return P(),Ie(),{memory:xe,_free:W,_malloc:j,Mesh:class{constructor(){this.ptr=Z()}destroy(){Y(this.ptr)}},Decoder:class{constructor(){this.ptr=K()}destroy(){we(this.ptr)}DecodeArrayToMesh(lt,Ct,zt){const bt=mt(lt),Et=ae(this.ptr,bt,Ct,zt.ptr);return!!$(Et)}GetAttributeByUniqueId(lt,Ct){return{ptr:se(this.ptr,lt.ptr,Ct)}}GetTrianglesUInt16Array(lt,Ct,zt){de(this.ptr,lt.ptr,Ct,zt)}GetTrianglesUInt32Array(lt,Ct,zt){ge(this.ptr,lt.ptr,Ct,zt)}GetAttributeDataArrayForAllPoints(lt,Ct,zt,bt,Et){Te(this.ptr,lt.ptr,Ct.ptr,zt,bt,Et)}},DT_INT8:We(),DT_UINT8:qe(),DT_INT16:Qe(),DT_UINT16:Ne(),DT_UINT32:Ve(),DT_FLOAT32:at()}}(fetch(RB())),$c=await E1,E1=void 0}}()),h)for(let x=0;x<h.length;x++)v.push(Mae(h[x],l,x,r));if(v.length&&await Promise.all(v),b&&p)for(const{primitives:x}of p)for(const S of x)Aae(S,l);return l}async function BB(i){const t=await fetch(i);return NB(await t.arrayBuffer(),0,i)}class UB{constructor(t,r,l){if(this.triangleCount=r.length/3,this.min=new V(0,0),this.max=new V(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||l===0)return;const u=t.map(x=>x.x),h=t.map(x=>x.y);this.min=new V(Math.min(...u),Math.min(...h)),this.max=new V(Math.max(...u),Math.max(...h));const p=this.max.sub(this.min);p.x=Math.max(p.x,1),p.y=Math.max(p.y,1);const g=Math.max(p.x,p.y)/l;this.cellsX=Math.max(1,Math.ceil(p.x/g)),this.cellsY=Math.max(1,Math.ceil(p.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let x=0;x<this.triangleCount;x++){const S=t[r[3*x+0]].sub(this.min),T=t[r[3*x+1]].sub(this.min),P=t[r[3*x+2]].sub(this.min),R=Tf(Math.floor(Math.min(S.x,T.x,P.x)),this.xScale,this.cellsX),z=Tf(Math.floor(Math.max(S.x,T.x,P.x)),this.xScale,this.cellsX),U=Tf(Math.floor(Math.min(S.y,T.y,P.y)),this.yScale,this.cellsY),W=Tf(Math.floor(Math.max(S.y,T.y,P.y)),this.yScale,this.cellsY),j=new V(0,0),Z=new V(0,0),Y=new V(0,0),$=new V(0,0);for(let K=U;K<=W;++K){j.y=Z.y=K*g,Y.y=$.y=(K+1)*g;for(let ae=R;ae<=z;++ae)j.x=Y.x=ae*g,Z.x=$.x=(ae+1)*g,(ZC(S,T,P,j,Z,$)||ZC(S,T,P,j,$,Y))&&v.push({cellIdx:K*this.cellsX+ae,triIdx:x})}}if(v.length===0)return;v.sort((x,S)=>x.cellIdx-S.cellIdx||x.triIdx-S.triIdx);let b=0;for(;b<v.length;){const x=v[b].cellIdx,S={start:this.payload.length,len:0};for(;b<v.length&&v[b].cellIdx===x;)++S.len,this.payload.push(v[b++].triIdx);this.cells[x]=S}}query(t,r,l){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>r.x||t.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const u=Tf(t.x-this.min.x,this.xScale,this.cellsX),h=Tf(r.x-this.min.x,this.xScale,this.cellsX),p=Tf(t.y-this.min.y,this.yScale,this.cellsY),g=Tf(r.y-this.min.y,this.yScale,this.cellsY);for(let v=p;v<=g;v++)for(let b=u;b<=h;b++){const x=this.cells[v*this.cellsX+b];if(x)for(let S=0;S<x.len;S++){const T=this.payload[x.start+S],P=Math.floor(T/8),R=1<<T%8;if(!(this.lookup[P]&R)&&(this.lookup[P]|=R,l.push(T),l.length===this.triangleCount))return}}}}function Tf(i,t,r){return Math.max(0,Math.min(r-1,Math.floor(i*t)))}function Mm(i,t){const r=i.json.bufferViews[t.bufferView];return new HP[t.componentType](i.buffers[r.buffer],(t.byteOffset||0)+(r.byteOffset||0),t.count*jP[t.type])}function Tae(i,t,r){const l=i.indices,u=i.attributes,h={};h.indexArray=new Nn;const p=t.json.accessors[l],g=p.count/3;h.indexArray.reserve(g);const v=Mm(t,p);for(let T=0;T<g;T++)h.indexArray.emplaceBack(v[3*T],v[3*T+1],v[3*T+2]);h.indexArray._trim(),h.vertexArray=new Dn;const b=t.json.accessors[u.POSITION];h.vertexArray.reserve(b.count);const x=Mm(t,b);for(let T=0;T<b.count;T++)h.vertexArray.emplaceBack(x[3*T],x[3*T+1],x[3*T+2]);if(h.vertexArray._trim(),h.aabb=new di(b.min,b.max),h.centroid=function(T,P){const R=[0,0,0],z=T.length;if(z>0){for(let U=0;U<z;U++){const W=3*T[U];R[0]+=P[W],R[1]+=P[W+1],R[2]+=P[W+2]}R[0]/=z,R[1]/=z,R[2]/=z}return R}(v,x),u.COLOR_0!==void 0){const T=t.json.accessors[u.COLOR_0],P=jP[T.type];if(T.componentType===GP){h.colorArray=P===3?new Dn:new dn,h.colorArray.reserve(T.count);const R=Mm(t,T);if(P===3)for(let z=0;z<T.count;z++)h.colorArray.emplaceBack(R[3*z],R[3*z+1],R[3*z+2]);else for(let z=0;z<T.count;z++)h.colorArray.emplaceBack(R[4*z],R[4*z+1],R[4*z+2],R[4*z+3]);h.colorArray._trim()}else if(T.componentType===VP&&P===4){h.colorArray=new dn,h.colorArray.resize(T.count);const R=Mm(t,T),z=1/65535,U=h.colorArray.float32;for(let W=0;W<4*R.length;++W)U[W]=R[W]*z}else ve(`glTF color buffer parsing for accessor ${JSON.stringify(T)} is not supported`)}if(u.NORMAL!==void 0){h.normalArray=new Dn;const T=t.json.accessors[u.NORMAL];h.normalArray.reserve(T.count);const P=Mm(t,T);for(let R=0;R<T.count;R++)h.normalArray.emplaceBack(P[3*R],P[3*R+1],P[3*R+2]);h.normalArray._trim()}if(u.TEXCOORD_0!==void 0&&r.length>0){h.texcoordArray=new j_;const T=t.json.accessors[u.TEXCOORD_0];h.texcoordArray.reserve(T.count);const P=Mm(t,T);for(let R=0;R<T.count;R++)h.texcoordArray.emplaceBack(P[2*R],P[2*R+1]);h.texcoordArray._trim()}const S=i.material;return h.material=function(T,P){const{emissiveFactor:R=[0,0,0],alphaMode:z="OPAQUE",alphaCutoff:U=.5,normalTexture:W,occlusionTexture:j,emissiveTexture:Z,doubleSided:Y}=T,{baseColorFactor:$=[1,1,1,1],metallicFactor:K=1,roughnessFactor:ae=1,baseColorTexture:se,metallicRoughnessTexture:de}=T.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new xn(...$),metallicFactor:K,roughnessFactor:ae,baseColorTexture:se?P[se.index]:void 0,metallicRoughnessTexture:de?P[de.index]:void 0},doubleSided:Y,emissiveFactor:R,alphaMode:z,alphaCutoff:U,normalTexture:W?P[W.index]:void 0,occlusionTexture:j?P[j.index]:void 0,emissionTexture:Z?P[Z.index]:void 0,defined:T.defined===void 0}}(S!==void 0?t.json.materials[S]:{defined:!1},r),u._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Mm(t,t.json.accessors[u._FEATURE_RGBA4444]).buffer)),h}function WB(i,t,r){const{matrix:l,rotation:u,translation:h,scale:p,mesh:g,extras:v,children:b}=i,x={};if(x.matrix=l||nt.fromRotationTranslationScale([],u||[0,0,0,1],h||[0,0,0],p||[1,1,1]),g!==void 0){x.meshes=r[g];const S=x.anchor=[0,0];for(const T of x.meshes){const{min:P,max:R}=T.aabb;S[0]+=P[0]+R[0],S[1]+=P[1]+R[1]}S[0]=Math.floor(S[0]/x.meshes.length/2),S[1]=Math.floor(S[1]/x.meshes.length/2)}if(v&&(v.id&&(x.id=v.id),v.lights&&(x.lights=function(S){if(!S.length)return[];const T=function(W){const j=atob(W),Z=new Uint8Array(j.length);for(let Y=0;Y<j.length;Y++)Z[Y]=j.codePointAt(Y);return Z}(S),P=[],R=T.length/24,z=new Uint16Array(T.buffer),U=new Float32Array(T.buffer);for(let W=0;W<R;W++){const j=z[2*W*6]/30,Z=z[2*W*6+1]/30,Y=z[2*W*6+10]/100,$=U[6*W+1],K=U[6*W+2],ae=U[6*W+3],se=U[6*W+4],de=ae-$,ge=se-K,Te=Math.hypot(de,ge);P.push({pos:[$+.5*de,K+.5*ge,Z],normal:[ge/Te,-de/Te,0],width:Te,height:j,depth:Y,points:[$,K,ae,se]})}return P}(v.lights))),b){const S=[];for(const T of b)S.push(WB(t.json.nodes[T],t,r));x.children=S}return x}function Cae(i){if(i.vertices.length===0||i.indices.length===0)return null;const[t,r]=[i.vertices[0].clone(),i.vertices[0].clone()];for(let p=1;p<i.vertices.length;++p){const g=i.vertices[p];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),r.x=Math.max(r.x,g.x),r.y=Math.max(r.y,g.y)}const l=Math.ceil(Math.max(r.x-t.x,r.y-t.y)/256),u=Math.max(8,l),h=new UB(i.vertices,i.indices,u);return{vertices:i.vertices,indices:i.indices,grid:h,min:t,max:r}}function Pae(i){if(!i.extras||!i.extras.ground)return null;const t=i.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const r=t[0];if(!r||!Array.isArray(r)||r.length===0)return null;const l=[];for(const p of r){if(!Array.isArray(p)||p.length!==2)continue;const g=p[0],v=p[1];typeof g=="number"&&typeof v=="number"&&l.push(new V(g,v))}if(l.length<3)return null;l.length>1&&l[l.length-1].equals(l[0])&&l.pop();let u=0;for(let p=0;p<l.length;p++){const g=l[p],v=l[(p+1)%l.length],b=l[(p+2)%l.length];u+=(g.x-v.x)*(b.y-v.y)-(b.x-v.x)*(g.y-v.y)}u>0&&l.reverse();const h=I2(l.flatMap(p=>[p.x,p.y]),[]);return h.length===0?null:{vertices:l,indices:h}}function Iae(i){const t=[],r=[];let l=0;for(const u of i){l=t.length;const h=u.vertexArray.float32,p=u.indexArray.uint16;for(let g=0;g<u.vertexArray.length;g++)t.push(new V(h[3*g+0],h[3*g+1]));for(let g=0;g<3*u.indexArray.length;g++)r.push(p[g]+l)}if(r.length%3!=0)return null;for(let u=0;u<r.length;u+=3){const h=t[r[u+0]],p=t[r[u+1]],g=t[r[u+2]];(h.x-p.x)*(g.y-p.y)-(g.x-p.x)*(h.y-p.y)>0&&([r[u+1],r[u+2]]=[r[u+2],r[u+1]])}return{vertices:t,indices:r}}function qP(i){const t=function(v,b){const x=[],S=m.WebGL2RenderingContext;if(v.json.textures)for(const T of v.json.textures){const P={magFilter:S.LINEAR,minFilter:S.NEAREST,wrapS:S.REPEAT,wrapT:S.REPEAT};T.sampler!==void 0&&Object.assign(P,v.json.samplers[T.sampler]),x.push({image:b[T.source],sampler:P,uploaded:!1})}return x}(i,i.images),r=function(v,b){const x=[];for(const S of v.json.meshes){const T=[];for(const P of S.primitives)T.push(Tae(P,v,b));x.push(T)}return x}(i,t),{scenes:l,scene:u,nodes:h}=i.json,p=l?l[u||0].nodes:h,g=[];for(const v of p)g.push(WB(h[v],i,r));return function(v,b,x){const S={},T=new Set;for(let P=0;P<v.length;P++){const R=x[b[P]];if(!R.extras)continue;const z=R.extras["mapbox:footprint:version"],U=R.extras["mapbox:footprint:id"];(z||U)&&T.add(P),z==="1.0.0"&&U&&(S[U]=P)}for(let P=0;P<v.length;P++){if(T.has(P))continue;const R=v[P],z=x[b[P]];if(!z.extras)continue;let U=null;R.id in S&&(U=Iae(v[S[R.id]].meshes)),U||(U=Pae(z)),U&&(R.footprint=Cae(U))}if(T.size>0){const P=Array.from(T.values()).sort((R,z)=>R-z);for(let R=P.length-1;R>=0;R--)v.splice(P[R],1)}}(g,p,i.json.nodes),g}function Lae(i){i.heightmap=new Float32Array(4096),i.heightmap.fill(-1);const t=i.vertexArray.float32,r=i.aabb.min[0]-1,l=i.aabb.min[1]-1,u=wm/(i.aabb.max[0]-r+2),h=wm/(i.aabb.max[1]-l+2);for(let p=0;p<t.length;p+=3){const g=t[p+2],v=(t[p+0]-r)*u|0,b=(t[p+1]-l)*h|0;g>i.heightmap[b*wm+v]&&(i.heightmap[b*wm+v]=g)}}function Rae(i,t){const r={};r.indexArray=new Nn,r.indexArray.reserve(4*i.length),r.vertexArray=new Dn,r.vertexArray.reserve(10*i.length),r.colorArray=new dn,r.vertexArray.reserve(10*i.length);let l=0;for(const p of i){const g=Math.min(10,Math.max(4,1.3*p.height))*t,v=[-p.normal[1],p.normal[0],0],b=Math.min(.29,.1*p.width/p.depth),x=p.width-2*p.depth*t*(b+.01),S=ke.scaleAndAdd([],p.pos,v,x/2),T=ke.scaleAndAdd([],p.pos,v,-x/2),P=[S[0],S[1],S[2]+p.height],R=[T[0],T[1],T[2]+p.height],z=ke.scaleAndAdd([],p.normal,v,b);ke.scale(z,z,g);const U=ke.scaleAndAdd([],p.normal,v,-b);ke.scale(U,U,g),ke.add(z,S,z),ke.add(U,T,U),S[2]+=.1,T[2]+=.1,r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]),r.vertexArray.emplaceBack(S[0],S[1],S[2]),r.vertexArray.emplaceBack(T[0],T[1],T[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(R[0],R[1],R[2]),r.vertexArray.emplaceBack(S[0],S[1],S[2]),r.vertexArray.emplaceBack(T[0],T[1],T[2]),r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]);const W=x/g/2;r.colorArray.emplaceBack(-W-b,-1,W,.8),r.colorArray.emplaceBack(W+b,-1,W,.8),r.colorArray.emplaceBack(-W,0,W,1.3),r.colorArray.emplaceBack(W,0,W,1.3),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.indexArray.emplaceBack(6+l,4+l,8+l),r.indexArray.emplaceBack(7+l,9+l,5+l),r.indexArray.emplaceBack(0+l,1+l,2+l),r.indexArray.emplaceBack(1+l,3+l,2+l),l+=10}const u={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=xn.white,u.pbrMetallicRoughness=h,r.material=u,r.aabb=new di([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}un(UB,"TriangleGridIndex");const XP={vector:LB,raster:w1,"raster-dem":class extends w1{constructor(i,t,r,l){super(i,t,r,l),this.type="raster-dem",this.maxzoom=22,this._options=Ue({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(i,t){var h,p;const r=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);i.request=Qt(this.map._requestManager.transformRequest(r,Se.Tile),(function(g,v,b,x){if(delete i.request,i.aborted)i.state="unloaded",t(null);else if(g)i.state="errored",t(g);else if(v){this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:b,expires:x});const T=m.ImageBitmap&&v instanceof m.ImageBitmap&&(NP==null&&(NP=m.OffscreenCanvas&&new m.OffscreenCanvas(1,1).getContext("2d")&&typeof m.createImageBitmap=="function"),NP),P=1-(v.width-((S=v.width)<=1?1:Math.pow(2,Math.floor(Math.log(S)/Math.LN2))))/2;P<1||i.neighboringTiles||(i.neighboringTiles=this._getNeighboringTiles(i.tileID));const R=T?v:Cn.getImageData(v,P),z={uid:i.uid,coord:i.tileID,source:this.id,scope:this.scope,rawImageData:R,encoding:this.encoding,padding:P,convertToFloat:l};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",z,u.bind(this),void 0,!0))}var S}).bind(this));const l=(p=(h=this.map)==null?void 0:h.painter)==null?void 0:p.terrainUseFloatDEM();function u(g,v){g&&(i.state="errored",t(g)),v&&(i.dem=v,i.dem.onDeserialize(),i.needsHillshadePrepare=!0,i.needsDEMTextureUpload=!0,i.state="loaded",t(null))}}_getNeighboringTiles(i){const t=i.canonical,r=Math.pow(2,t.z),l=(t.x-1+r)%r,u=t.x===0?i.wrap-1:i.wrap,h=(t.x+1+r)%r,p=t.x+1===r?i.wrap+1:i.wrap,g={};return g[new Ta(i.overscaledZ,u,t.z,l,t.y).key]={backfilled:!1},g[new Ta(i.overscaledZ,p,t.z,h,t.y).key]={backfilled:!1},t.y>0&&(g[new Ta(i.overscaledZ,u,t.z,l,t.y-1).key]={backfilled:!1},g[new Ta(i.overscaledZ,i.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new Ta(i.overscaledZ,p,t.z,h,t.y-1).key]={backfilled:!1}),t.y+1<r&&(g[new Ta(i.overscaledZ,u,t.z,l,t.y+1).key]={backfilled:!1},g[new Ta(i.overscaledZ,i.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new Ta(i.overscaledZ,p,t.z,h,t.y+1).key]={backfilled:!1}),g}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.hillshadeFBO&&(i.hillshadeFBO.destroy(),delete i.hillshadeFBO),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded"}},geojson:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(l),this._data=t.data,this._options=Ue({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const u=dt/this.tileSize;this.workerOptions=Ue({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*u,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*u,extent:dt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:dt,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*u,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(i){this.map=i,this.setData(this._data)}setData(i){return this._data=i,this._updateWorkerData(),this}getClusterExpansionZoom(i,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id,scope:this.scope},t),this}getClusterChildren(i,t){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id,scope:this.scope},t),this}getClusterLeaves(i,t,r,l){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:i,limit:t,offset:r},l),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Ht("dataloading",{dataType:"source"})),this._loaded=!1;const i=Ue({},this.workerOptions);i.scope=this.scope;const t=this._data;typeof t=="string"?(i.request=this.map._requestManager.transformRequest(Cn.resolveURL(t),Se.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,i,(r,l)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new vn(r));else{const u={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&l&&l.resourceTiming&&l.resourceTiming[this.id]&&(u.resourceTiming=l.resourceTiming[this.id]),this.fire(new Ht("data",u)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(i,t){const r=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const l={type:this.type,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};i.request=this.actor.send(r,l,(u,h)=>(delete i.request,i.unloadVectorData(),i.aborted?t(null):u?t(u):(i.loadVectorData(h,this.map.painter,r==="reloadTile"),t(null))),void 0,r==="loadTile")}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Ue({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends $u{constructor(i,t,r,l){super(i,t,r,l),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const i=this.options;this.urls=[];for(const t of i.urls)this.urls.push(this.map._requestManager.transformRequest(t,Se.Source).url);(function(t,r){const l=m.document.createElement("video");l.muted=!0,l.onloadstart=function(){r(null,l)};for(let u=0;u<t.length;u++){const h=m.document.createElement("source");ut(t[u])||(l.crossOrigin="Anonymous"),h.src=t[u],l.appendChild(h)}})(this.urls,(t,r)=>{this._loaded=!0,t?this.fire(new vn(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const t=this.video.seekable;i<t.start(0)||i>t.end(0)?this.fire(new vn(new sn(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,t=i.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new mr(i,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(i)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:$u,model:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="model",this.models=[],this._loaded=!1,this._options=t}async load(){for(const i in this._options.models){const t=this._options.models[i],r=await BB(this.map._requestManager.transformRequest(t.uri,Se.Model).url).catch(h=>{this.fire(new vn(new Error(`Could not load model ${i} from ${t.uri}: ${h.message}`)))});if(!r)continue;const l=qP(r),u=new ON(i,t.position,t.orientation,l);u.computeBoundsAndApplyParent(),this.models.push(u)}this._loaded=!0,this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(i){this.map=i,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(i,t){}serialize(){return{type:"model"}}},"batched-model":class extends Bn{constructor(i,t,r,l){super(),this.type="batched-model",this.id=i,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(l)}onAdd(i){this.map=i,this.load()}load(i){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=zP(this._options,this.map._requestManager,t,r,(l,u)=>{this._tileJSONRequest=null,this._loaded=!0,l?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),r&&r.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new vn(l))):u&&(Ue(this,u),u.bounds&&(this.tileBounds=new f3(u.bounds,this.minzoom,this.maxzoom)),ln(u.tiles,this.map._requestManager._customAccessToken),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),i&&i(l)})}hasTransition(){return!1}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loaded(){return this._loaded}loadTile(i,t){const r=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),l={request:this.map._requestManager.transformRequest(r,Se.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:i.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(i.actor&&i.state!=="expired")if(i.state==="loading")i.reloadCallback=t;else{if(i.buckets){const h=Object.values(i.buckets);for(const p of h)p.dirty=!0;return void(i.state="loaded")}i.request=i.actor.send("reloadTile",l,u.bind(this))}else i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",l,u.bind(this),void 0,!0);function u(h,p){return i.aborted?t(null):h&&h.status!==404?t(h):(p&&(p.resourceTiming&&(i.resourceTiming=p.resourceTiming),this.map._refreshExpiredTiles&&i.setExpiryData(p),i.buckets={...i.buckets,...p.buckets}),i.state="loaded",void t(null))}}serialize(){return Ue({},this._options)}},canvas:class extends $u{constructor(i,t,r,l){super(i,t,r,l),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(u=>!Array.isArray(u)||u.length!==2||u.some(h=>typeof h!="number"))||this.fire(new vn(new sn(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new vn(new sn(`sources.${i}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new vn(new sn(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof m.HTMLCanvasElement||this.fire(new vn(new sn(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new vn(new sn(`sources.${i}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof m.HTMLCanvasElement?this.options.canvas:m.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new vn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!i&&!this._playing||this.texture instanceof e3||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new mr(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}},custom:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=t,this.setEventedParent(l),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new vn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new vn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new f3(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Ue(this,ht(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return ht(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(i){this._map=i,this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(i),this.load()}onRemove(i){this._implementation.onRemove&&this._implementation.onRemove(i)}hasTile(i){if(this._implementation.hasTile){const{x:t,y:r,z:l}=i.canonical;return this._implementation.hasTile({x:t,y:r,z:l})}return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,t){const{x:r,y:l,z:u}=i.tileID.canonical,h=new m.AbortController;i.request=Promise.resolve(this._implementation.loadTile({x:r,y:l,z:u},{signal:h.signal})).then((function(p){return delete i.request,i.aborted?(i.state="unloaded",t(null)):p===void 0?(i.state="errored",t(null)):p===null?(this.loadTileData(i,{width:this.tileSize,height:this.tileSize,data:null}),i.state="loaded",t(null)):function(g){return g instanceof m.ImageData||g instanceof m.HTMLCanvasElement||g instanceof m.ImageBitmap||g instanceof m.HTMLImageElement}(p)?(this.loadTileData(i,p),i.state="loaded",void t(null)):(i.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(p=>{p.code!==20&&(i.state="errored",t(p))}),i.request.cancel=()=>h.abort()}loadTileData(i,t){w1.loadTileData(i,t,this._map.painter)}unloadTileData(i){w1.unloadTileData(i,this._map.painter)}unloadTile(i,t){if(this.unloadTileData(i),this._implementation.unloadTile){const{x:r,y:l,z:u}=i.tileID.canonical;this._implementation.unloadTile({x:r,y:l,z:u})}t()}abortTile(i,t){i.request&&i.request.cancel&&(i.request.cancel(),delete i.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(i=>({x:i.canonical.x,y:i.canonical.y,z:i.canonical.z}))}_clearTiles(){const i=Ho(this.id,this.scope);this._map.style.clearSource(i)}_update(){this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))}}},ZP=function(i,t,r,l){const u=new XP[t.type](i,t,r,l);if(u.id!==i)throw new Error(`Expected Source id to be ${i} instead of ${u.id}`);return ft(["load","abort","unload","serialize","prepare"],u),u};function kae(i,t){const r=nt.identity([]);return nt.scale(r,r,[.5*i.width,.5*-i.height,1]),nt.translate(r,r,[1,-1,0]),nt.multiply(r,r,i.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(r)}function Dae(i,t,r,l,u,h,p,g=!1){const v=i.tilesIn(l,p,g);v.sort(VB);const b=[];for(const S of v)b.push({wrappedTileID:S.tile.tileID.wrapped().key,queryResults:S.tile.queryRenderedFeatures(t,r,i._state,S,u,h,kae(i.transform,S.tile.tileID),g)});const x=function(S){const T={},P={};for(const R of S){const z=R.queryResults,U=R.wrappedTileID,W=P[U]=P[U]||{};for(const j in z){const Z=z[j],Y=W[j]=W[j]||{},$=T[j]=T[j]||[];for(const K of Z)Y[K.featureIndex]||(Y[K.featureIndex]=!0,$.push(K))}}return T}(b);for(const S in x)x[S].forEach(T=>{const P=T.feature,R=P.layer;R&&R.type!=="background"&&R.type!=="sky"&&R.type!=="slot"&&(P.source=R.source,R["source-layer"]&&(P.sourceLayer=R["source-layer"]),P.state=P.id!==void 0?i.getFeatureState(R["source-layer"],P.id):{})});return x}function Oae(i,t){const r=i.getRenderableIds().map(h=>i.getTileByID(h)),l=[],u={};for(let h=0;h<r.length;h++){const p=r[h],g=p.tileID.canonical.key;u[g]||(u[g]=!0,p.querySourceFeatures(l,t))}return l}function VB(i,t){const r=i.tileID,l=t.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}class zae{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const r=this.style._mergedLayers[t];if(r.type==="fill-extrusion")this.layers.push(r);else if(r.type==="model"){const l=this.style.getLayerSource(r);l&&l.type==="batched-model"&&this.layers.push(r)}}}updateZOffset(t,r){this.currentBuildingBuckets=[];for(let u=0;u<this.layers.length;++u){const h=this.layers[u],p=this.style.getLayerSourceCache(h);let g=1;h.type==="fill-extrusion"&&(g=h.paint.get("fill-extrusion-opacity")>0?h.paint.get("fill-extrusion-vertical-scale"):0);let v=p?p.getTile(r):null;if(!v&&p&&r.canonical.z>p.getSource().minzoom){let b=r.scaledTo(Math.min(p.getSource().maxzoom,r.overscaledZ-1));for(;b.overscaledZ>=p.getSource().minzoom&&(v=p.getTile(b),!v&&b.overscaledZ!==0);)b=b.scaledTo(b.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:v?v.getBucket(h):null,tileID:v?v.tileID:r,verticalScale:g})}t.hasAnyZOffset=!1;let l=!1;for(let u=0;u<t.symbolInstances.length;u++){const h=t.symbolInstances.get(u),p=h.zOffset,g=this._getHeightAtTileOffset(r,h.tileAnchorX,h.tileAnchorY);h.zOffset=g!==-1?g:p,l||p===h.zOffset||(l=!0),t.hasAnyZOffset||h.zOffset===0||(t.hasAnyZOffset=!0)}l&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,r,l,u){let h=r,p=l;if(t.canonical.z!==u.canonical.z){const g=u.canonical,v=1/(1<<t.canonical.z-g.z);h=(r+t.canonical.x*dt)*v-g.x*dt|0,p=(l+t.canonical.y*dt)*v-g.y*dt|0}return{tileX:h,tileY:p}}_getHeightAtTileOffset(t,r,l){let u;for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="fill-extrusion")continue;const{bucket:p,tileID:g,verticalScale:v}=this.currentBuildingBuckets[h];if(!p)continue;const{tileX:b,tileY:x}=this._mapCoordToOverlappingTile(t,r,l,g),S=p.getHeightAtTileCoord(b,x);if(S&&S.height!==void 0){if(!S.hidden)return S.height*v;u=S.height}}for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="model")continue;const{bucket:p,tileID:g}=this.currentBuildingBuckets[h];if(!p)continue;const{tileX:v,tileY:b}=this._mapCoordToOverlappingTile(t,r,l,g),x=p.getHeightAtTileCoord(v,b);if(x&&!x.hidden)return x.height===void 0&&u!==void 0?Math.min(x.maxHeight,u)*x.verticalScale:(x.height||0)*x.verticalScale}return-1}}var GB=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Fae(i,t){const r={};for(const l in i)l!=="ref"&&(r[l]=i[l]);return GB.forEach(l=>{l in t&&(r[l]=t[l])}),r}function HB(i){i=i.slice();const t=Object.create(null);for(let r=0;r<i.length;r++)t[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=Fae(i[r],t[i[r].ref]));return i}const Fa={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData"};function jB(i,t,r){r.push({command:Fa.addSource,args:[i,t[i]]})}function $B(i,t,r){t.push({command:Fa.removeSource,args:[i]}),r[i]=!0}function Nae(i,t,r,l){$B(i,r,l),jB(i,t,r)}function Bae(i,t,r){let l;for(l in i[r])if(i[r].hasOwnProperty(l)&&l!=="data"&&!Q(i[r][l],t[r][l]))return!1;for(l in t[r])if(t[r].hasOwnProperty(l)&&l!=="data"&&!Q(i[r][l],t[r][l]))return!1;return!0}function p3(i,t,r,l,u,h){let p;for(p in t=t||{},i=i||{})i.hasOwnProperty(p)&&(Q(i[p],t[p])||r.push({command:h,args:[l,p,t[p],u]}));for(p in t)t.hasOwnProperty(p)&&!i.hasOwnProperty(p)&&(Q(i[p],t[p])||r.push({command:h,args:[l,p,t[p],u]}))}function m3(i){return i.id}function g3(i,t){return i[t.id]=t,i}class Uae{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=ne(t,0,1);let r=1,l=this._distances[r];const u=t*this.paddedLength+this.padding;for(;l<u&&r<this._distances.length;)l=this._distances[++r];const h=r-1,p=this._distances[h],g=l-p,v=g>0?(u-p)/g:0;return this.points[h].mult(1-v).add(this.points[r].mult(v))}}class qB{constructor(t,r,l){const u=this.boxCells=[],h=this.circleCells=[];this.xCellCount=Math.ceil(t/l),this.yCellCount=Math.ceil(r/l);for(let p=0;p<this.xCellCount*this.yCellCount;p++)u.push([]),h.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,l,u,h){this._forEachCell(r,l,u,h,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(h)}insertCircle(t,r,l,u){this._forEachCell(r-u,l-u,r+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(l),this.circles.push(u)}_insertBoxCell(t,r,l,u,h,p){this.boxCells[h].push(p)}_insertCircleCell(t,r,l,u,h,p){this.circleCells[h].push(p)}_query(t,r,l,u,h,p){if(l<0||t>this.width||u<0||r>this.height)return!h&&[];const g=[];if(t<=0&&r<=0&&this.width<=l&&this.height<=u){if(h)return!0;for(let v=0;v<this.boxKeys.length;v++)g.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(let v=0;v<this.circleKeys.length;v++){const b=this.circles[3*v],x=this.circles[3*v+1],S=this.circles[3*v+2];g.push({key:this.circleKeys[v],x1:b-S,y1:x-S,x2:b+S,y2:x+S})}return p?g.filter(p):g}return this._forEachCell(t,r,l,u,this._queryCell,g,{hitTest:h,seenUids:{box:{},circle:{}}},p),h?g.length>0:g}_queryCircle(t,r,l,u,h){const p=t-l,g=t+l,v=r-l,b=r+l;if(g<0||p>this.width||b<0||v>this.height)return!u&&[];const x=[];return this._forEachCell(p,v,g,b,this._queryCellCircle,x,{hitTest:u,circle:{x:t,y:r,radius:l},seenUids:{box:{},circle:{}}},h),u?x.length>0:x}query(t,r,l,u,h){return this._query(t,r,l,u,!1,h)}hitTest(t,r,l,u,h){return this._query(t,r,l,u,!0,h)}hitTestCircle(t,r,l,u){return this._queryCircle(t,r,l,!0,u)}_queryCell(t,r,l,u,h,p,g,v){const b=g.seenUids,x=this.boxCells[h];if(x!==null){const T=this.bboxes;for(const P of x)if(!b.box[P]){b.box[P]=!0;const R=4*P;if(t<=T[R+2]&&r<=T[R+3]&&l>=T[R+0]&&u>=T[R+1]&&(!v||v(this.boxKeys[P]))){if(g.hitTest)return p.push(!0),!0;p.push({key:this.boxKeys[P],x1:T[R],y1:T[R+1],x2:T[R+2],y2:T[R+3]})}}}const S=this.circleCells[h];if(S!==null){const T=this.circles;for(const P of S)if(!b.circle[P]){b.circle[P]=!0;const R=3*P;if(this._circleAndRectCollide(T[R],T[R+1],T[R+2],t,r,l,u)&&(!v||v(this.circleKeys[P]))){if(g.hitTest)return p.push(!0),!0;{const z=T[R],U=T[R+1],W=T[R+2];p.push({key:this.circleKeys[P],x1:z-W,y1:U-W,x2:z+W,y2:U+W})}}}}}_queryCellCircle(t,r,l,u,h,p,g,v){const b=g.circle,x=g.seenUids,S=this.boxCells[h];if(S!==null){const P=this.bboxes;for(const R of S)if(!x.box[R]){x.box[R]=!0;const z=4*R;if(this._circleAndRectCollide(b.x,b.y,b.radius,P[z+0],P[z+1],P[z+2],P[z+3])&&(!v||v(this.boxKeys[R])))return p.push(!0),!0}}const T=this.circleCells[h];if(T!==null){const P=this.circles;for(const R of T)if(!x.circle[R]){x.circle[R]=!0;const z=3*R;if(this._circlesCollide(P[z],P[z+1],P[z+2],b.x,b.y,b.radius)&&(!v||v(this.circleKeys[R])))return p.push(!0),!0}}}_forEachCell(t,r,l,u,h,p,g,v){const b=this._convertToXCellCoord(t),x=this._convertToYCellCoord(r),S=this._convertToXCellCoord(l),T=this._convertToYCellCoord(u);for(let P=b;P<=S;P++)for(let R=x;R<=T;R++)if(h.call(this,t,r,l,u,this.xCellCount*R+P,p,g,v))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,l,u,h,p){const g=u-t,v=h-r,b=l+p;return b*b>g*g+v*v}_circleAndRectCollide(t,r,l,u,h,p,g){const v=(p-u)/2,b=Math.abs(t-(u+v));if(b>v+l)return!1;const x=(g-h)/2,S=Math.abs(r-(h+x));if(S>x+l)return!1;if(b<=v||S<=x)return!0;const T=b-v,P=S-x;return T*T+P*P<=l*l}}const qu=100;class Wae{constructor(t,r,l=new qB(t.width+200,t.height+200,25),u=new qB(t.width+200,t.height+200,25)){this.transform=t,this.grid=l,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+qu,this.screenBottomBoundary=t.height+qu,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=r}placeCollisionBox(t,r,l,u,h,p,g,v){let b=l.projectedAnchorX,x=l.projectedAnchorY,S=l.projectedAnchorZ;const T=l.elevation,P=l.tileID,R=t.getProjection();if(T&&P){const[K,ae,se]=R.upVector(P.canonical,l.tileAnchorX,l.tileAnchorY),de=R.upVectorScale(P.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;b+=K*T*de,x+=ae*T*de,S+=se*T*de}const z=this.projectAndGetPerspectiveRatio(g,b,x,S,l.tileID,R.name==="globe"||!!T||this.transform.pitch>0,R),U=p*z.perspectiveRatio,W=(l.x1*r+u.x-l.padding)*U+z.point.x,j=(l.y1*r+u.y-l.padding)*U+z.point.y,Z=(l.x2*r+u.x+l.padding)*U+z.point.x,Y=(l.y2*r+u.y+l.padding)*U+z.point.y,$=z.perspectiveRatio<=.55||z.occluded;return!this.isInsideGrid(W,j,Z,Y)||!h&&this.grid.hitTest(W,j,Z,Y,v)||$?{box:[],offscreen:!1,occluded:z.occluded}:{box:[W,j,Z,Y],offscreen:this.isOffscreen(W,j,Z,Y),occluded:!1}}placeCollisionCircles(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z){const U=[],W=this.transform.elevation,j=t.getProjection(),Z=W?W.getAtTileOffsetFunc(z,this.transform.center.lat,this.transform.worldSize,j):null,Y=new V(l.tileAnchorX,l.tileAnchorY);let{x:$,y:K,z:ae}=j.projectTilePoint(Y.x,Y.y,z.canonical);if(Z){const[Qe,Ne,Ve]=Z(Y);$+=Qe,K+=Ne,ae+=Ve}const se=j.name==="globe",de=this.projectAndGetPerspectiveRatio(g,$,K,ae,z,se||!!W||this.transform.pitch>0,j),{perspectiveRatio:ge}=de,Te=(S?p/ge:p*ge)/to,we=jc($,K,ae,v),Ie=de.signedDistanceFromCamera>0?EN(Te,h,l.lineOffsetX*Te,l.lineOffsetY*Te,!1,we,Y,l,u,v,{},W&&!S?Z:null,S&&!!W,j,z,S):null;let xe=!1,We=!1,qe=!0;if(Ie&&!de.occluded){const Qe=.5*P*ge+R,Ne=new V(-100,-100),Ve=new V(this.screenRightBoundary,this.screenBottomBoundary),at=new Uae,{first:mt,last:lt}=Ie,Ct=mt.path.length;let zt=[];for(let en=Ct-1;en>=1;en--)zt.push(mt.path[en]);for(let en=1;en<lt.path.length;en++)zt.push(lt.path[en]);const bt=2.5*Qe;b&&(zt=zt.map(([en,on,rn],cn)=>(Z&&!se&&(rn=Z(cn<Ct-1?mt.tilePath[Ct-1-cn]:lt.tilePath[cn-Ct+2])[2]),jc(en,on,rn,b))),zt.some(en=>en[3]<=0)&&(zt=[]));let Et=[];if(zt.length>0){let en=1/0,on=-1/0,rn=1/0,cn=-1/0;for(const gn of zt)en=Math.min(en,gn[0]),rn=Math.min(rn,gn[1]),on=Math.max(on,gn[0]),cn=Math.max(cn,gn[1]);on>=Ne.x&&en<=Ve.x&&cn>=Ne.y&&rn<=Ve.y&&(Et=[zt.map(gn=>new V(gn[0],gn[1]))],(en<Ne.x||on>Ve.x||rn<Ne.y||cn>Ve.y)&&(Et=ZF(Et,Ne.x,Ne.y,Ve.x,Ve.y)))}for(const en of Et){at.reset(en,.25*Qe);let on=0;on=at.length<=.5*Qe?1:Math.ceil(at.paddedLength/bt)+1;for(let rn=0;rn<on;rn++){const cn=rn/Math.max(on-1,1),gn=at.lerp(cn),kn=gn.x+qu,ea=gn.y+qu;U.push(kn,ea,Qe,0);const _a=kn-Qe,$n=ea-Qe,Un=kn+Qe,In=ea+Qe;if(qe=qe&&this.isOffscreen(_a,$n,Un,In),We=We||this.isInsideGrid(_a,$n,Un,In),!r&&this.grid.hitTestCircle(kn,ea,Qe,T)&&(xe=!0,!x))return{circles:[],offscreen:!1,collisionDetected:xe,occluded:!1}}}}return{circles:!x&&xe||!We?[]:U,offscreen:qe,collisionDetected:xe,occluded:de.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,u=1/0,h=-1/0,p=-1/0;for(const x of t){const S=new V(x.x+qu,x.y+qu);l=Math.min(l,S.x),u=Math.min(u,S.y),h=Math.max(h,S.x),p=Math.max(p,S.y),r.push(S)}const g=this.grid.query(l,u,h,p).concat(this.ignoredGrid.query(l,u,h,p)),v={},b={};for(const x of g){const S=x.key;v[S.bucketInstanceId]===void 0&&(v[S.bucketInstanceId]={}),v[S.bucketInstanceId][S.featureIndex]||Kz(r,[new V(x.x1,x.y1),new V(x.x2,x.y1),new V(x.x2,x.y2),new V(x.x1,x.y2)])&&(v[S.bucketInstanceId][S.featureIndex]=!0,b[S.bucketInstanceId]===void 0&&(b[S.bucketInstanceId]=[]),b[S.bucketInstanceId].push(S.featureIndex))}return b}insertCollisionBox(t,r,l,u,h){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:u,collisionGroupID:h},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,l,u,h){const p=r?this.ignoredGrid:this.grid,g={bucketInstanceId:l,featureIndex:u,collisionGroupID:h};for(let v=0;v<t.length;v+=4)p.insertCircle(g,t[v],t[v+1],t[v+2])}projectAndGetPerspectiveRatio(t,r,l,u,h,p,g){const v=[r,l,u,1];let b=!1;u||this.transform.pitch>0?(Va.transformMat4(v,v,t),this.fogState&&h&&g.name!=="globe"&&(b=function(T,P,R,z,U,W){const j=W.calculateFogTileMatrix(U),Z=[P,R,z];return ke.transformMat4(Z,Z,j),h3(T,ke.length(Z),W.pitch,W._fov)}(this.fogState,r,l,u,h.toUnwrapped(),this.transform)>.9)):IN(v,v,t);const x=v[3];return{point:new V((v[0]/x+1)/2*this.transform.width+qu,(-v[1]/x+1)/2*this.transform.height+qu),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/x*.5,1.5),signedDistanceFromCamera:x,occluded:p&&v[2]>x||b}}isOffscreen(t,r,l,u){return l<qu||t>=this.screenRightBoundary||u<qu||r>this.screenBottomBoundary}isInsideGrid(t,r,l,u){return l>=0&&t<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=nt.identity([]);return nt.translate(t,t,[-100,-100,0]),t}}function YP(i,t,r){const l=t.createTileMatrix(i,i.worldSize,r.toUnwrapped());return nt.multiply(new Float32Array(16),i.projMatrix,l)}function Vae(i,t,r){if(t.projection.name===r.projection.name)return i.projMatrix;const l=r.clone();return l.setProjection(t.projection),YP(l,t.getProjection(),i)}function KP(i,t,r){return t.name===r.projection.name?i.projMatrix:YP(r,t,i)}class XB{constructor(t,r,l,u){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class M1{constructor(t,r,l,u,h,p=!1){this.text=new XB(t?t.text:null,r,l,h),this.icon=new XB(t?t.icon:null,r,u,h),this.clipped=p}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class JP{constructor(t,r,l,u=!1){this.text=t,this.icon=r,this.skipFade=l,this.clipped=u}}class Gae{constructor(){this.invProjMatrix=nt.create(),this.viewportMatrix=nt.create(),this.circles=[]}}class Hae{constructor(t,r,l,u,h){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=h}}class jae{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[t]}}function ZB(i,t,r,l,u){const{horizontalAlign:h,verticalAlign:p}=B2(i),g=-(h-.5)*t,v=-(p-.5)*r,b=mP(i,l);return new V(g+b[0]*u,v+b[1]*u)}function QP(i,t,r,l,u){const h=new V(i,t);return r&&h._rotate(l?u:-u),h}class $ae{constructor(t,r,l,u,h,p){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Wae(this.transform,h),this.buildingIndex=p,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new jae(l),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,l,u){const h=l.getBucket(r),p=l.latestFeatureIndex;if(!h||!p||r.fqid!==h.layerIds[0])return;const g=h.layers[0].layout,v=l.collisionBoxArray,b=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),x=l.tileSize/dt,S=l.tileID.toUnwrapped();this.transform.setProjection(h.projection);const T=(P=l.tileID,R=h.getProjection(),z=this.transform,R.name===this.projection?z.calculateProjMatrix(P.toUnwrapped()):YP(z,R,P));var P,R,z;const U=g.get("text-pitch-alignment")==="map",W=g.get("text-rotation-alignment")==="map";r.compileFilter();const j=r.dynamicFilter(),Z=r.dynamicFilterNeedsFeature(),Y=this.transform.calculatePixelsToTileUnitsMatrix(l),$=wN(T,l.tileID.canonical,U,W,this.transform,h.getProjection(),Y);let K=null;if(U){const de=SN(T,l.tileID.canonical,U,W,this.transform,h.getProjection(),Y);K=nt.multiply([],this.transform.labelPlaneMatrix,de)}let ae=null;j&&l.latestFeatureIndex&&(ae={unwrappedTileID:S,dynamicFilter:j,dynamicFilterNeedsFeature:Z,featureIndex:l.latestFeatureIndex}),this.retainedQueryData[h.bucketInstanceId]=new Hae(h.bucketInstanceId,p,h.sourceLayerIndex,h.index,l.tileID);const se={bucket:h,layout:g,posMatrix:T,textLabelPlaneMatrix:$,labelToScreenMatrix:K,clippingData:ae,scale:b,textPixelRatio:x,holdingForFade:l.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:Vu(h.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Vu(h.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(h.sourceID)};if(u)for(const de of h.sortKeyRanges){const{sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:we}=de;t.push({sortKey:ge,symbolInstanceStart:Te,symbolInstanceEnd:we,parameters:se})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:h.symbolInstances.length,parameters:se})}attemptAnchorPlacement(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j){const{textOffset0:Z,textOffset1:Y,crossTileID:$}=T,K=[Z,Y],ae=ZB(t,l,u,K,h),se=this.collisionIndex.placeCollisionBox(R,h,r,QP(ae.x,ae.y,p,g,this.transform.angle),S,v,b,x.predicate);if(U){const de=R.getSymbolInstanceIconSize(j,this.transform.zoom,T.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(R,de,U,QP(ae.x,ae.y,p,g,this.transform.angle),S,v,b,x.predicate).box.length===0)return}if(se.box.length>0){let de;return this.prevPlacement&&this.prevPlacement.variableOffsets[$]&&this.prevPlacement.placements[$]&&this.prevPlacement.placements[$].text&&(de=this.prevPlacement.variableOffsets[$].anchor),this.variableOffsets[$]={textOffset:K,width:l,height:u,anchor:t,textScale:h,prevAnchor:de},this.markUsedJustification(R,t,T,z),R.allowVerticalPlacement&&(this.markUsedOrientation(R,z,T),this.placedOrientations[$]=z),{shift:ae,placedGlyphBoxes:se}}}placeLayerBucketPart(t,r,l,u){const{bucket:h,layout:p,posMatrix:g,textLabelPlaneMatrix:v,labelToScreenMatrix:b,clippingData:x,textPixelRatio:S,holdingForFade:T,collisionBoxArray:P,partiallyEvaluatedTextSize:R,partiallyEvaluatedIconSize:z,collisionGroup:U}=t.parameters,W=p.get("text-optional"),j=p.get("icon-optional"),Z=p.get("text-allow-overlap"),Y=p.get("icon-allow-overlap"),$=p.get("text-rotation-alignment")==="map",K=p.get("text-pitch-alignment")==="map",ae=p.get("symbol-z-order")==="viewport-y",se=p.get("symbol-z-elevate");this.transform.setProjection(h.projection);let de=Z&&(Y||!h.hasIconData()||j),ge=Y&&(Z||!h.hasTextData()||W);!h.collisionArrays&&P&&h.deserializeCollisionBoxes(P),l&&u&&h.updateCollisionDebugBuffers(this.transform.zoom,P);const Te=(we,Ie,xe)=>{const{crossTileID:We,numVerticalGlyphVertices:qe}=we;if(x){const Un={zoom:this.transform.zoom,pitch:this.transform.pitch};let In=null;if(x.dynamicFilterNeedsFeature){const En=this.retainedQueryData[h.bucketInstanceId];In=x.featureIndex.loadFeature({featureIndex:we.featureIndex,bucketIndex:En.bucketIndex,sourceLayerIndex:En.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,x.dynamicFilter)(Un,In,this.retainedQueryData[h.bucketInstanceId].tileID.canonical,new V(we.tileAnchorX,we.tileAnchorY),this.transform.calculateDistanceTileData(x.unwrappedTileID)))return this.placements[We]=new JP(!1,!1,!1,!0),void r.add(We)}if(r.has(We))return;if(T)return void(this.placements[We]=new JP(!1,!1,!1));let Qe=!1,Ne=!1,Ve=!0,at=!1,mt=!1,lt=null,Ct={box:null,offscreen:null,occluded:null},zt={box:null,offscreen:null,occluded:null},bt=null,Et=null,en=null,on=0,rn=0,cn=0;xe.textFeatureIndex?on=xe.textFeatureIndex:we.useRuntimeCollisionCircles&&(on=we.featureIndex),xe.verticalTextFeatureIndex&&(rn=xe.verticalTextFeatureIndex);const gn=Un=>{Un.tileID=this.retainedQueryData[h.bucketInstanceId].tileID;const In=this.transform.elevation;Un.elevation=we.zOffset+(In?In.getAtTileOffset(Un.tileID,Un.tileAnchorX,Un.tileAnchorY):0)},kn=xe.textBox;if(kn){gn(kn);const Un=En=>{let da=_i.horizontal;if(h.allowVerticalPlacement&&!En&&this.prevPlacement){const Ea=this.prevPlacement.placedOrientations[We];Ea&&(this.placedOrientations[We]=Ea,da=Ea,this.markUsedOrientation(h,da,we))}return da},In=(En,da)=>{if(h.allowVerticalPlacement&&qe>0&&xe.verticalTextBox){for(const Ea of h.writingModes)if(Ea===_i.vertical?(Ct=da(),zt=Ct):Ct=En(),Ct&&Ct.box&&Ct.box.length)break}else Ct=En()};if(p.get("text-variable-anchor")){let En=p.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[We]){const Qn=this.prevPlacement.variableOffsets[We];En.indexOf(Qn.anchor)>0&&(En=En.filter(qa=>qa!==Qn.anchor),En.unshift(Qn.anchor))}const da=(Qn,qa,bi)=>{const ri=h.getSymbolInstanceTextSize(R,we,this.transform.zoom,Ie),Qa=(Qn.x2-Qn.x1)*ri+2*Qn.padding,ar=(Qn.y2-Qn.y1)*ri+2*Qn.padding,xi=we.hasIconTextFit&&!Y?qa:null;xi&&gn(xi);let Di={box:[],offscreen:!1,occluded:!1};const Xa=Z?2*En.length:En.length;for(let ss=0;ss<Xa;++ss){const Zu=this.attemptAnchorPlacement(En[ss%En.length],Qn,Qa,ar,ri,$,K,S,g,U,ss>=En.length,we,Ie,h,bi,xi,R,z);if(Zu&&(Di=Zu.placedGlyphBoxes,Di&&Di.box&&Di.box.length)){Qe=!0,lt=Zu.shift;break}}return Di};In(()=>da(kn,xe.iconBox,_i.horizontal),()=>{const Qn=xe.verticalTextBox;return Qn&&gn(Qn),h.allowVerticalPlacement&&!(Ct&&Ct.box&&Ct.box.length)&&qe>0&&Qn?da(Qn,xe.verticalIconBox,_i.vertical):{box:null,offscreen:null,occluded:null}}),Ct&&(Qe=Ct.box,Ve=Ct.offscreen,at=Ct.occluded);const Ea=Un(!(!Ct||!Ct.box));if(!Qe&&this.prevPlacement){const Qn=this.prevPlacement.variableOffsets[We];Qn&&(this.variableOffsets[We]=Qn,this.markUsedJustification(h,Qn.anchor,we,Ea))}}else{const En=(da,Ea)=>{const Qn=h.getSymbolInstanceTextSize(R,we,this.transform.zoom,Ie),qa=this.collisionIndex.placeCollisionBox(h,Qn,da,new V(0,0),Z,S,g,U.predicate);return qa&&qa.box&&qa.box.length&&(this.markUsedOrientation(h,Ea,we),this.placedOrientations[We]=Ea),qa};In(()=>En(kn,_i.horizontal),()=>{const da=xe.verticalTextBox;return h.allowVerticalPlacement&&qe>0&&da?(gn(da),En(da,_i.vertical)):{box:null,offscreen:null,occluded:null}}),Un(!!(Ct&&Ct.box&&Ct.box.length))}}if(bt=Ct,Qe=bt&&bt.box&&bt.box.length>0,Ve=bt&&bt.offscreen,at=bt&&bt.occluded,we.useRuntimeCollisionCircles){const Un=h.text.placedSymbolArray.get(we.centerJustifiedTextSymbolIndex>=0?we.centerJustifiedTextSymbolIndex:we.verticalPlacedTextSymbolIndex),In=n1(h.textSizeData,R,Un),En=p.get("text-padding");Et=this.collisionIndex.placeCollisionCircles(h,Z,Un,h.lineVertexArray,h.glyphOffsetArray,In,g,v,b,l,K,U.predicate,we.collisionCircleDiameter*In/to,En,this.retainedQueryData[h.bucketInstanceId].tileID),Qe=Z||Et.circles.length>0&&!Et.collisionDetected,Ve=Ve&&Et.offscreen,at=Et.occluded}if(xe.iconFeatureIndex&&(cn=xe.iconFeatureIndex),xe.iconBox){const Un=In=>{gn(In);const En=we.hasIconTextFit&&lt?QP(lt.x,lt.y,$,K,this.transform.angle):new V(0,0),da=h.getSymbolInstanceIconSize(z,this.transform.zoom,we.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(h,da,In,En,Y,S,g,U.predicate)};zt&&zt.box&&zt.box.length&&xe.verticalIconBox?(en=Un(xe.verticalIconBox),Ne=en.box.length>0):(en=Un(xe.iconBox),Ne=en.box.length>0),Ve=Ve&&en.offscreen,mt=en.occluded}const ea=W||we.numHorizontalGlyphVertices===0&&qe===0,_a=j||we.numIconVertices===0;if(ea||_a?_a?ea||(Ne=Ne&&Qe):Qe=Ne&&Qe:Ne=Qe=Ne&&Qe,Qe&&bt&&bt.box&&this.collisionIndex.insertCollisionBox(bt.box,p.get("text-ignore-placement"),h.bucketInstanceId,zt&&zt.box&&rn?rn:on,U.ID),Ne&&en&&this.collisionIndex.insertCollisionBox(en.box,p.get("icon-ignore-placement"),h.bucketInstanceId,cn,U.ID),Et&&(Qe&&this.collisionIndex.insertCollisionCircles(Et.circles,p.get("text-ignore-placement"),h.bucketInstanceId,on,U.ID),l)){const Un=h.bucketInstanceId;let In=this.collisionCircleArrays[Un];In===void 0&&(In=this.collisionCircleArrays[Un]=new Gae);for(let En=0;En<Et.circles.length;En+=4)In.circles.push(Et.circles[En+0]),In.circles.push(Et.circles[En+1]),In.circles.push(Et.circles[En+2]),In.circles.push(Et.collisionDetected?1:0)}const $n=h.projection.name!=="globe";de=de&&($n||!at),ge=ge&&($n||!mt),this.placements[We]=new JP(Qe||de,Ne||ge,Ve||h.justReloaded),r.add(We)};if(se&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,this.retainedQueryData[h.bucketInstanceId].tileID),h.updateZOffset()),ae){const we=h.getSortedSymbolIndexes(this.transform.angle);for(let Ie=we.length-1;Ie>=0;--Ie){const xe=we[Ie];Te(h.symbolInstances.get(xe),xe,h.collisionArrays[xe])}h.hasAnyZOffset&&ve(`${h.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(h.hasAnyZOffset){const we=h.getSortedIndexesByZOffset();for(let Ie=0;Ie<we.length;++Ie){const xe=we[Ie];Te(h.symbolInstances.get(xe),xe,h.collisionArrays[xe])}}else for(let we=t.symbolInstanceStart;we<t.symbolInstanceEnd;we++)Te(h.symbolInstances.get(we),we,h.collisionArrays[we]);if(l&&h.bucketInstanceId in this.collisionCircleArrays){const we=this.collisionCircleArrays[h.bucketInstanceId];nt.invert(we.invProjMatrix,g),we.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(t,r,l,u){const{leftJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:v,crossTileID:b}=l,x=gP(r),S=u===_i.vertical?v:x==="left"?h:x==="center"?p:x==="right"?g:-1;h>=0&&(t.text.placedSymbolArray.get(h).crossTileID=S>=0&&h!==S?0:b),p>=0&&(t.text.placedSymbolArray.get(p).crossTileID=S>=0&&p!==S?0:b),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=S>=0&&g!==S?0:b),v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=S>=0&&v!==S?0:b)}markUsedOrientation(t,r,l){const u=r===_i.horizontal||r===_i.horizontalOnly?r:0,h=r===_i.vertical?r:0,{leftJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:b}=l,x=t.text.placedSymbolArray;p>=0&&(x.get(p).placedOrientation=u),g>=0&&(x.get(g).placedOrientation=u),v>=0&&(x.get(v).placedOrientation=u),b>=0&&(x.get(b).placedOrientation=h)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(t):1,h=r?r.opacities:{},p=r?r.variableOffsets:{},g=r?r.placedOrientations:{};for(const v in this.placements){const b=this.placements[v],x=h[v];x?(this.opacities[v]=new M1(x,u,b.text,b.icon,null,b.clipped),l=l||b.text!==x.text.placed||b.icon!==x.icon.placed):(this.opacities[v]=new M1(null,u,b.text,b.icon,b.skipFade,b.clipped),l=l||b.text||b.icon)}for(const v in h){const b=h[v];if(!this.opacities[v]){const x=new M1(b,u,!1,!1);x.isHidden()||(this.opacities[v]=x,l=l||b.text.placed||b.icon.placed)}}for(const v in p)this.variableOffsets[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.variableOffsets[v]=p[v]);for(const v in g)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=g[v]);l?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const l=new Set;for(const u of r){const h=u.getBucket(t);h&&u.latestFeatureIndex&&t.fqid===h.layerIds[0]&&(this.updateBucketOpacities(h,l,u.collisionBoxArray),h.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,u.tileID),h.updateZOffset()))}}updateBucketOpacities(t,r,l){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const u=t.layers[0].layout,h=!!t.layers[0].dynamicFilter(),p=new M1(null,0,!1,!1,!0),g=u.get("text-allow-overlap"),v=u.get("icon-allow-overlap"),b=u.get("text-variable-anchor"),x=u.get("text-rotation-alignment")==="map",S=u.get("text-pitch-alignment")==="map",T=new M1(null,0,g&&(v||!t.hasIconData()||u.get("icon-optional")),v&&(g||!t.hasTextData()||u.get("text-optional")),!0);!t.collisionArrays&&l&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(l);const P=(z,U,W)=>{for(let j=0;j<U/4;j++)z.opacityVertexArray.emplaceBack(W)};let R=0;for(let z=0;z<t.symbolInstances.length;z++){const U=t.symbolInstances.get(z),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:j,crossTileID:Z,numIconVertices:Y}=U,$=r.has(Z);let K=this.opacities[Z];$?K=p:K||(K=T,this.opacities[Z]=K),r.add(Z);const ae=W>0||j>0,se=Y>0,de=this.placedOrientations[Z],ge=de===_i.vertical,Te=de===_i.horizontal||de===_i.horizontalOnly;if(!ae&&!se||K.isHidden()||R++,ae){const we=YB(K.text);P(t.text,W,ge?v3:we),P(t.text,j,Te?v3:we);const Ie=K.text.isHidden(),{leftJustifiedTextSymbolIndex:xe,centerJustifiedTextSymbolIndex:We,rightJustifiedTextSymbolIndex:qe,verticalPlacedTextSymbolIndex:Qe}=U,Ne=t.text.placedSymbolArray,Ve=Ie||ge?1:0;xe>=0&&(Ne.get(xe).hidden=Ve),We>=0&&(Ne.get(We).hidden=Ve),qe>=0&&(Ne.get(qe).hidden=Ve),Qe>=0&&(Ne.get(Qe).hidden=Ie||Te?1:0);const at=this.variableOffsets[Z];at&&this.markUsedJustification(t,at.anchor,U,de);const mt=this.placedOrientations[Z];mt&&(this.markUsedJustification(t,"left",U,mt),this.markUsedOrientation(t,mt,U))}if(se){const we=YB(K.icon),{placedIconSymbolIndex:Ie,verticalPlacedIconSymbolIndex:xe}=U,We=t.icon.placedSymbolArray,qe=K.icon.isHidden()?1:0;Ie>=0&&(P(t.icon,Y,ge?v3:we),We.get(Ie).hidden=qe),xe>=0&&(P(t.icon,U.numVerticalIconVertices,Te?v3:we),We.get(xe).hidden=qe)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const we=t.collisionArrays[z];if(we){let Ie=new V(0,0),xe=!0;if(we.textBox||we.verticalTextBox){if(b){const qe=this.variableOffsets[Z];qe?(Ie=ZB(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textScale),x&&Ie._rotate(S?this.transform.angle:-this.transform.angle)):xe=!1}h&&(xe=!K.clipped),we.textBox&&y3(t.textCollisionBox.collisionVertexArray,K.text.placed,!xe||ge,Ie.x,Ie.y),we.verticalTextBox&&y3(t.textCollisionBox.collisionVertexArray,K.text.placed,!xe||Te,Ie.x,Ie.y)}const We=xe&&!!(!Te&&we.verticalIconBox);we.iconBox&&y3(t.iconCollisionBox.collisionVertexArray,K.icon.placed,We,U.hasIconTextFit?Ie.x:0,U.hasIconTextFit?Ie.y:0),we.verticalIconBox&&y3(t.iconCollisionBox.collisionVertexArray,K.icon.placed,!We,U.hasIconTextFit?Ie.x:0,U.hasIconTextFit?Ie.y:0)}}}if(t.fullyClipped=R===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const z=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=z.invProjMatrix,t.placementViewportMatrix=z.viewportMatrix,t.collisionCircleArray=z.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>t}setStale(){this.stale=!0}}function y3(i,t,r,l,u){i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0)}const qae=Math.pow(2,25),Xae=Math.pow(2,24),Zae=Math.pow(2,17),Yae=Math.pow(2,16),Kae=Math.pow(2,9),Jae=Math.pow(2,8),Qae=Math.pow(2,1);function YB(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;const t=i.placed?1:0,r=Math.floor(127*i.opacity);return r*qae+t*Xae+r*Zae+t*Yae+r*Kae+t*Jae+r*Qae+t}const v3=0;class eie{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,r,l,u,h){const p=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(p,u,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,h())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,p.sort((g,v)=>g.sortKey-v.sortKey));this._currentPartIndex<p.length;){const g=p[this._currentPartIndex];if(r.placeLayerBucketPart(g,this._seenCrossTileIDs,l,g.symbolInstanceStart===0),this._currentPartIndex++,h())return!0}return!1}}class tie{constructor(t,r,l,u,h,p,g,v,b){this.placement=new $ae(t,h,p,g,v,b),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=u,this._done=!1}isDone(){return this._done}continuePlacement(t,r,l,u){const h=Cn.now(),p=()=>{const g=Cn.now()-h;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=r[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=v)&&(!g.maxzoom||g.maxzoom>v)){const b=g,x=b.layout.get("symbol-z-elevate");if(this._inProgressLayer||(this._inProgressLayer=new eie(b)),this._inProgressLayer.continuePlacement(x?u[g.source]:l[g.source],this.placement,this._showCollisionBoxes,g,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const KB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class _3{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=l>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const h=KB[15&l];if(!h)throw new Error("Unrecognized array type.");const[p]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new _3(g,p,h,t)}constructor(t,r=64,l=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const h=KB.indexOf(this.ArrayType),p=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${l}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+p+g+v),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=r,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return e5(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,l,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:p,nodeSize:g}=this,v=[0,h.length-1,0],b=[];for(;v.length;){const x=v.pop()||0,S=v.pop()||0,T=v.pop()||0;if(S-T<=g){for(let U=T;U<=S;U++){const W=p[2*U],j=p[2*U+1];W>=t&&W<=l&&j>=r&&j<=u&&b.push(h[U])}continue}const P=T+S>>1,R=p[2*P],z=p[2*P+1];R>=t&&R<=l&&z>=r&&z<=u&&b.push(h[P]),(x===0?t<=R:r<=z)&&(v.push(T),v.push(P-1),v.push(1-x)),(x===0?l>=R:u>=z)&&(v.push(P+1),v.push(S),v.push(1-x))}return b}within(t,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:p}=this,g=[0,u.length-1,0],v=[],b=l*l;for(;g.length;){const x=g.pop()||0,S=g.pop()||0,T=g.pop()||0;if(S-T<=p){for(let U=T;U<=S;U++)QB(h[2*U],h[2*U+1],t,r)<=b&&v.push(u[U]);continue}const P=T+S>>1,R=h[2*P],z=h[2*P+1];QB(R,z,t,r)<=b&&v.push(u[P]),(x===0?t-l<=R:r-l<=z)&&(g.push(T),g.push(P-1),g.push(1-x)),(x===0?t+l>=R:r+l>=z)&&(g.push(P+1),g.push(S),g.push(1-x))}return v}}function e5(i,t,r,l,u,h){if(u-l<=r)return;const p=l+u>>1;JB(i,t,p,l,u,h),e5(i,t,r,l,p-1,1-h),e5(i,t,r,p+1,u,1-h)}function JB(i,t,r,l,u,h){for(;u>l;){if(u-l>600){const b=u-l+1,x=r-l+1,S=Math.log(b),T=.5*Math.exp(2*S/3),P=.5*Math.sqrt(S*T*(b-T)/b)*(x-b/2<0?-1:1);JB(i,t,r,Math.max(l,Math.floor(r-x*T/b+P)),Math.min(u,Math.floor(r+(b-x)*T/b+P)),h)}const p=t[2*r+h];let g=l,v=u;for(T1(i,t,l,r),t[2*u+h]>p&&T1(i,t,l,u);g<v;){for(T1(i,t,g,v),g++,v--;t[2*g+h]<p;)g++;for(;t[2*v+h]>p;)v--}t[2*l+h]===p?T1(i,t,l,v):(v++,T1(i,t,v,u)),v<=r&&(l=v+1),r<=v&&(u=v-1)}}function T1(i,t,r,l){t5(i,r,l),t5(t,2*r,2*l),t5(t,2*r+1,2*l+1)}function t5(i,t,r){const l=i[t];i[t]=i[r],i[r]=l}function QB(i,t,r,l){const u=i-r,h=t-l;return u*u+h*h}const n5=512/dt/2;class nie{constructor(t,r,l){this.tileID=t,this.bucketInstanceId=l,this.index=new _3(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const u=t.canonical.x*dt,h=t.canonical.y*dt;for(let p=0;p<r.length;p++){const{key:g,crossTileID:v,tileAnchorX:b,tileAnchorY:x}=r.get(p),S=Math.floor((u+b)*n5),T=Math.floor((h+x)*n5);this.index.add(S,T),this.keys.push(g),this.crossTileIDs.push(v)}this.index.finish()}findMatches(t,r,l){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),h=n5/Math.pow(2,r.canonical.z-this.tileID.canonical.z),p=r.canonical.x*dt,g=r.canonical.y*dt;for(let v=0;v<t.length;v++){const b=t.get(v);if(b.crossTileID)continue;const{key:x,tileAnchorX:S,tileAnchorY:T}=b,P=Math.floor((p+S)*h),R=Math.floor((g+T)*h),z=this.index.range(P-u,R-u,P+u,R+u);for(const U of z){const W=this.crossTileIDs[U];if(this.keys[U]===x&&!l.has(W)){l.add(W),b.crossTileID=W;break}}}}}class aie{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class iie{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(r!==0)for(const l in this.indexes){const u=this.indexes[l],h={};for(const p in u){const g=u[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+r),h[g.tileID.key]=g}this.indexes[l]=h}this.lng=t}addBucket(t,r,l){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let h=0;h<r.symbolInstances.length;h++)r.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const u=this.usedCrossTileIDs[t.overscaledZ];for(const h in this.indexes){const p=this.indexes[h];if(Number(h)>t.overscaledZ)for(const g in p){const v=p[g];v.tileID.isChildOf(t)&&v.findMatches(r.symbolInstances,t,u)}else{const g=p[t.scaledTo(Number(h)).key];g&&g.findMatches(r.symbolInstances,t,u)}}for(let h=0;h<r.symbolInstances.length;h++){const p=r.symbolInstances.get(h);p.crossTileID||(p.crossTileID=l.generate(),u.add(p.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new nie(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const l of r.crossTileIDs)this.usedCrossTileIDs[t].delete(l)}removeStaleBuckets(t){let r=!1;for(const l in this.indexes){const u=this.indexes[l];for(const h in u)t[u[h].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[h]),delete u[h],r=!0)}return r}}class rie{constructor(){this.layerIndexes={},this.crossTileIDs=new aie,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,l,u){let h=this.layerIndexes[t.fqid];h===void 0&&(h=this.layerIndexes[t.fqid]=new iie);let p=!1;const g={};u.name!=="globe"&&h.handleWrapJump(l);for(const v of r){const b=v.getBucket(t);b&&t.fqid===b.layerIds[0]&&(b.bucketInstanceId||(b.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(v.tileID,b,this.crossTileIDs)&&(p=!0),g[b.bucketInstanceId]=!0)}return h.removeStaleBuckets(g)&&(p=!0),p}pruneUnusedLayers(t){const r={};t.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var e8=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,t8="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",n8=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,a8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,i8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,r8=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,o8=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const s8=[];w3(e8,s8);const b3={"_prelude_fog.vertex.glsl":a8,"_prelude_terrain.vertex.glsl":n8,"_prelude_shadow.vertex.glsl":r8,"_prelude_fog.fragment.glsl":i8,"_prelude_shadow.fragment.glsl":o8,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`},x3={};Wa("",n8),Wa(i8,a8),Wa(o8,r8);const l8=Wa(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),c8=e8,u8=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var d8={background:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wa(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wa("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#if __VERSION__ >=300
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:Wa(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Wa(`#include "_prelude_shadow.fragment.glsl"
#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Wa(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture2D(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
attribute highp vec4 a_pos_end;attribute highp float a_angular_offset_factor;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Wa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture(u_image,coord).r/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_with_emission_ground(gl_FragColor,u_emissive_strength);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;attribute vec2 a_texture_pos;
#endif
varying vec2 v_pos0;varying vec2 v_pos1;void main() {vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*u_globe_matrix*vec4(a_globe_pos,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Wa(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Wa(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Wa(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Wa(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Wa(`#include "_prelude_fog.fragment.glsl"
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,t8),skyboxGradient:Wa(`#include "_prelude_fog.fragment.glsl"
varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,t8),skyboxCapture:Wa(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wa(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;varying highp vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=mix(color,mat.baseColor.rgb,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Wa(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Wa(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function w3(i,t){const r=i.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let l of r)if(l=l.trim(),l[0]==="#"&&l.includes("if")&&!l.includes("endif")){l=l.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const u=l.split(" ");for(const h of u)t.includes(h)||t.push(h)}}function Wa(i,t){const r=/#include\s+"([^"]+)"/g,l=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let u=t.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);u&&(u=u.filter((b,x)=>u.indexOf(b)===x));const h={},p=[],g=[];i=i.replace(r,(b,x)=>(g.push(x),"")),t=t.replace(r,(b,x)=>(p.push(x),""));let v=[...s8];w3(i,v),w3(t,v);for(const b of[...p,...g])b3[b]||console.error(`Undefined include: ${b}`),x3[b]||(x3[b]=[],w3(b3[b],x3[b])),v=[...v,...x3[b]];return{fragmentSource:i=i.replace(l,(b,x,S,T,P)=>(h[P]=!0,x==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${S} ${T} ${P};
#else
uniform ${S} ${T} u_${P};
#endif
`:x==="initialize"?`
#ifdef HAS_UNIFORM_u_${P}
    ${S} ${T} ${P} = u_${P};
#endif
`:x==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    varying ${S} ${T} ${P};
#endif
`:x==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(l,(b,x,S,T,P)=>{const R=T==="float"?"vec2":T,z=P.match(/color/)?"color":R;return x==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${P}
attribute ${S} ${T} a_${P};
#endif
`:h[P]?x==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${S} ${R} a_${P};
varying ${S} ${T} ${P};
#else
uniform ${S} ${T} u_${P};
#endif
`:x==="initialize"?z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${S} ${T} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${S} ${T} ${P} = u_${P};
#endif
`:x==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    attribute ${S} ${T} a_${P};
    varying ${S} ${T} ${P};
#endif
`:x==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${P} = a_${P};
#endif
`:void 0:x==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${S} ${R} a_${P};
#else
uniform ${S} ${T} u_${P};
#endif
`:x==="define-instanced"?z==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${P}0;
attribute vec4 a_${P}1;
attribute vec4 a_${P}2;
attribute vec4 a_${P}3;
#else
uniform ${S} ${T} u_${P};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${S} ${R} a_${P};
#else
uniform ${S} ${T} u_${P};
#endif
`:x==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${S} ${T} ${P} = a_${P};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${S} ${T} ${P} = a_${P};
#else
    ${S} ${T} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${S} ${T} ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${S} ${T} ${P} = u_${P};
#endif
`}),staticAttributes:u,usedDefines:v,vertexIncludes:p,fragmentIncludes:g}}class oie{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,r,l,u,h,p,g,v){this.context=t;let b=this.boundPaintVertexBuffers.length!==u.length;for(let S=0;!b&&S<u.length;S++)this.boundPaintVertexBuffers[S]!==u[S]&&(b=!0);let x=this.boundDynamicVertexBuffers.length!==g.length;for(let S=0;!x&&S<g.length;S++)this.boundDynamicVertexBuffers[S]!==g[S]&&(x=!0);if(!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||b||x||this.boundIndexBuffer!==h||this.boundVertexOffset!==p)this.freshBind(r,l,u,h,p,g,v);else{t.bindVertexArrayOES.set(this.vao);for(const S of g)S&&(S.bind(),v&&S.instanceCount&&S.setVertexAttribDivisor(t.gl,r,v));h&&h.dynamicDraw&&h.bind()}}freshBind(t,r,l,u,h,p,g){const v=t.numAttributes,b=this.context,x=b.gl;this.vao&&this.destroy(),this.vao=b.gl.createVertexArray(),b.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=h,this.boundDynamicVertexBuffers=p,r.enableAttributes(x,t),r.bind(),r.setVertexAttribPointers(x,t,h);for(const S of l)S.enableAttributes(x,t),S.bind(),S.setVertexAttribPointers(x,t,h);for(const S of p)S&&(S.enableAttributes(x,t),S.bind(),S.setVertexAttribPointers(x,t,h),g&&S.instanceCount&&S.setVertexAttribDivisor(x,t,g));u&&u.bind(),b.currentNumAttributes=v}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function sie(i,t){const r=Math.pow(2,t.canonical.z),l=t.canonical.y;return[new ga(0,l/r).toLngLat().lat,new ga(0,(l+1)/r).toLngLat().lat]}function lie(i,t,r,l,u,h,p){const g=i.context,v=g.gl,b=r.hillshadeFBO;if(!b)return;i.prepareDrawTile();const x=i.isTileAffectedByFog(t),S=i.getOrCreateProgram("hillshade",{overrideFog:x});g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,b.colorAttachment.get());const T=((U,W,j,Z)=>{const Y=j.paint.get("hillshade-shadow-color"),$=j.paint.get("hillshade-highlight-color"),K=j.paint.get("hillshade-accent-color"),ae=j.paint.get("hillshade-emissive-strength");let se=be(j.paint.get("hillshade-illumination-direction"));if(j.paint.get("hillshade-illumination-anchor")==="viewport")se-=U.transform.angle;else if(U.style&&U.style.enable3dLights()&&U.style.directionalLight){const ge=U.style.directionalLight.properties.get("direction");se=be(ce(ge.x,ge.y,ge.z)[1])}const de=!U.options.moving;return{u_matrix:Z||U.transform.calculateProjMatrix(W.tileID.toUnwrapped(),de),u_image:0,u_latrange:sie(0,W.tileID),u_light:[j.paint.get("hillshade-exaggeration"),se],u_shadow:Y,u_highlight:$,u_emissive_strength:ae,u_accent:K}})(i,r,l,i.terrain?t.projMatrix:null);i.uploadCommonUniforms(g,S,t.toUnwrapped());const{tileBoundsBuffer:P,tileBoundsIndexBuffer:R,tileBoundsSegments:z}=i.getTileBoundsBuffers(r);S.draw(i,v.TRIANGLES,u,h,p,la.disabled,T,l.id,P,R,z)}function h8(i,t,r){if(!t.needsDEMTextureUpload)return;const l=i.context,u=l.gl;l.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||i.getTileTexture(r.stride);const h=r.getPixels();t.demTexture?t.demTexture.update(h,{premultiply:!1}):t.demTexture=new mr(l,h,i.terrainUseFloatDEM()?u.R32F:u.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function cie(i,t,r){const l=i.context,u=l.gl;if(!t.dem)return;const h=t.dem;if(l.activeTexture.set(u.TEXTURE1),h8(i,t,h),!t.demTexture)return;t.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const p=h.dim;l.activeTexture.set(u.TEXTURE0);let g=t.hillshadeFBO;if(!g){const T=new mr(l,{width:p,height:p,data:null},u.RGBA);T.bind(u.LINEAR,u.CLAMP_TO_EDGE),g=t.hillshadeFBO=l.createFramebuffer(p,p,!0,"renderbuffer"),g.colorAttachment.set(T.texture)}l.bindFramebuffer.set(g.framebuffer),l.viewport.set([0,0,p,p]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:b,tileBoundsSegments:x}=i.getMercatorTileBoundsBuffers(),S=[];i.terrainUseFloatDEM()&&S.push("TERRAIN_DEM_FLOAT_FORMAT"),i.getOrCreateProgram("hillshadePrepare",{defines:S}).draw(i,u.TRIANGLES,zn.disabled,oa.disabled,Aa.unblended,la.disabled,((T,P)=>{const R=P.stride,z=nt.create();return nt.ortho(z,0,dt,-dt,0,0,1),nt.translate(z,z,[0,-dt,0]),{u_matrix:z,u_image:1,u_dimension:[R,R],u_zoom:T.overscaledZ,u_unpack:P.unpackVector}})(t.tileID,h),r.id,v,b,x),t.needsHillshadePrepare=!1}const f8=i=>({u_matrix:new jn(i),u_image0:new ra(i),u_skirt_height:new Zt(i),u_ground_shadow_factor:new Xn(i)}),p8=(i,t,r)=>({u_matrix:i,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:r}),m8=(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R)=>({u_proj_matrix:Float32Array.from(i),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(l),u_merc_matrix:r,u_zoom_transition:u,u_merc_center:h,u_image0:0,u_frustum_tl:p,u_frustum_tr:g,u_frustum_br:v,u_frustum_bl:b,u_globe_pos:x,u_globe_radius:S,u_viewport:T,u_grid_matrix:R?Float32Array.from(R):new Float32Array(9),u_skirt_height:P}),mv=(i,t)=>{if(t>0&&i.terrain&&ve("Cutoff is currently disabled on terrain"),t<=0||i.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const r=i.transform,l=Math.max(Math.abs(r._zoom-(i.minCutoffZoom-1)),1),u=r.isLODDisabled(!1)?Ee(60,45,r.pitch):Ee(30,15,r.pitch),h=r._farZ-r._nearZ,p=t*r.height,g=((1-(v=u))*(.75*r.cameraToCenterDistance)+v*(r._farZ+p))*l;var v;return{shouldRenderCutoff:u<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(g-r._nearZ)/h,(g-p-r._nearZ)/h]}}};function g8(i,t){return i!=null&&t!=null&&!(!i.hasData()||!t.hasData())&&i.demTexture!=null&&t.demTexture!=null&&i.tileID.key!==t.tileID.key}const gv=new class{constructor(){this.operations={}}newMorphing(i,t,r,l,u){if(i in this.operations){const h=this.operations[i];h.to.tileID.key!==r.tileID.key&&(h.queued=r)}else this.operations[i]={startTime:l,phase:0,duration:u,from:t,to:r,queued:null}}getMorphValuesForProxy(i){if(!(i in this.operations))return null;const t=this.operations[i];return{from:t.from,to:t.to,phase:t.phase}}update(i){for(const t in this.operations){const r=this.operations[t];for(r.phase=(i-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,i)){delete this.operations[t];break}}}_nextOp(i,t){return!!i.queued&&(i.from=i.to,i.to=i.queued,i.queued=null,i.phase=0,i.startTime=t,!0)}_validOp(i){return i.from.hasData()&&i.to.hasData()}},y8={0:null,1:"TERRAIN_VERTEX_MORPHING"};function v8(i,t,r){if(t===0)return 0;const l=t<1&&r===514?.25/t:1;return 6*Math.pow(1.5,22-i)*Math.max(t,1)*l}function uie(i,t){const r=1<<i.z;return!t&&(i.x===0||i.x===r-1)||i.y===0||i.y===r-1}const a5=i=>({u_matrix:i});function _8(i,t,r,l,u){if(u>0){const h=Cn.now(),p=(h-i.timeAdded)/u,g=t?(h-t.timeAdded)/u:-1,v=r.getSource(),b=l.coveringZoomLevel({tileSize:v.tileSize,roundZoom:v.roundZoom}),x=!t||Math.abs(t.tileID.overscaledZ-b)>Math.abs(i.tileID.overscaledZ-b),S=x&&i.refreshedUponExpiration?1:ne(x?p:1-g,0,1);return i.refreshedUponExpiration&&p>=1&&(i.refreshedUponExpiration=!1),t?{opacity:1,mix:1-S}:{opacity:S,mix:0}}return{opacity:1,mix:0}}class die extends Hc{constructor(t){const r={type:"raster-dem",maxzoom:t.transform.maxZoom},l=new Em(A1(),null),u=ZP("mock-dem",r,l,t.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,r){t.state="loaded",r(null)}}class hie extends Hc{constructor(t){const r=ZP("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Em(A1(),null),t.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,l){if(t.freezeTileCoverage)return;this.transform=t;const u=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((h,p)=>{if(h[p.key]="",!this._tiles[p.key]){const g=new h1(p,this._source.tileSize*p.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[p.key]=g}return h},{});for(const h in this._tiles)h in u||(this.freeFBO(h),this._tiles[h].unloadVectorData(),delete this._tiles[h])}freeFBO(t){const r=this.proxyCachedFBO[t];if(r!==void 0){const l=Object.values(r);this.renderCachePool.push(...l),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class b8 extends Ta{constructor(t,r,l){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=r,this.projMatrix=l}}class fie extends jee{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[l,u,h]=function(v){const b=new J,x=new Nn,S=131;b.reserve(17161),x.reserve(33800);const T=dt/128,P=dt+T/2,R=P+T;for(let U=-T;U<R;U+=T)for(let W=-T;W<R;W+=T){const j=W<0||W>P||U<0||U>P?24575:0,Z=ne(Math.round(W),0,dt),Y=ne(Math.round(U),0,dt);b.emplaceBack(Z+j,Y)}const z=(U,W)=>{const j=W*S+U;x.emplaceBack(j+1,j,j+S),x.emplaceBack(j+S,j+S+1,j+1)};for(let U=1;U<129;U++)for(let W=1;W<129;W++)z(W,U);return[0,129].forEach(U=>{for(let W=0;W<130;W++)z(W,U),z(U,W)}),[b,x,32768]}(),p=t.context;this.gridBuffer=p.createVertexBuffer(l,ff.members),this.gridIndexBuffer=p.createIndexBuffer(u),this.gridSegments=Ha.simpleSegment(0,0,l.length,u.length),this.gridNoSkirtSegments=Ha.simpleSegment(0,0,l.length,h),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hie(r.map),this.orthoMatrix=nt.create(),nt.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,dt,0,dt,0,1);const g=p.gl;this._overlapStencilMode=new oa({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new die(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,r,l){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const u=t.terrain.properties,h=t.terrain.drapeRenderMode===0,p=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Cn.now();const g=t.terrain&&t.terrain.scope,v=u.get("source"),b=h?this._mockSourceCache:t.getSourceCache(v,g);if(!b)return void ve(`Couldn't find terrain source "${v}".`);if(this.sourceCache=b,this._exaggeration=p?this.calculateExaggeration(r):u.get("exaggeration"),!r.projection.requiresDraping&&p&&this._exaggeration===0)return void this._disable();this.enabled=!0;const x=()=>{this.sourceCache.used&&ve(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const S=this.getScaledDemTileSize();this.sourceCache.update(r,S,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),r.updateElevation(!0,l),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(t){const r=this._previousCameraAltitude,l=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=l;const u=r!=null?l-r:Number.MAX_VALUE;if(Math.abs(u)<2)return this._exaggeration;const h=t.zoom,p=this._style.terrain;if(!this._previousUpdateTimestamp)return p.getExaggeration(h);let g=h-this._previousZoom;const v=this._previousUpdateTimestamp;let b=h;this._evaluationZoom!=null&&(b=this._evaluationZoom,Math.abs(h-b)>.5&&(g=.5*(h-b+g)),g*u<0&&(b+=g)),this._evaluationZoom=b;const x=p.getExaggeration(b),S=x===p.getExaggeration(Math.max(0,b-.1));if(S&&Math.abs(x-this._exaggeration)<.01)return x;let T=Math.min(.1,.00375*(this._updateTimestamp-v));return(S||x<.1||Math.abs(g)<1e-4)&&(T=Math.min(.2,4*T)),Ln(this._exaggeration,x,T)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,l=this.painter.transform;this._initializing&&(this._initializing=l._centerAltitude===0&&this.getAtPointOrZero(ga.fromLngLat(l.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const u=this.proxyCoords=r.getIds().map(v=>{const b=r.getTileByID(v).tileID;return b.projMatrix=l.calculateProjMatrix(b.toUnwrapped()),b});(function(v,b){const x=b.transform.pointCoordinate(b.transform.getCameraPoint()),S=new V(x.x,x.y);v.sort((T,P)=>{if(P.overscaledZ-T.overscaledZ)return P.overscaledZ-T.overscaledZ;const R=new V(T.canonical.x+(1<<T.canonical.z)*T.wrap,T.canonical.y),z=new V(P.canonical.x+(1<<P.canonical.z)*P.wrap,P.canonical.y),U=S.mult(1<<T.canonical.z);return U.x-=.5,U.y-=.5,U.distSqr(R)-U.distSqr(z)})})(u,this.painter);const h=this.proxyToSource||{};this.proxyToSource={},u.forEach(v=>{this.proxyToSource[v.key]={}}),this.terrainTileForTile={};const p=this._style._mergedSourceCaches;for(const v in p){const b=p[v];if(!b.used||(b!==this.sourceCache&&this.resetTileLookupCache(b.id),this._setupProxiedCoordsForOrtho(b,t[v],h),b.usedForTerrain))continue;const x=t[v];b.getSource().reparseOverscaled&&this._assignTerrainTiles(x)}this.proxiedCoords[r.id]=u.map(v=>new b8(v,v.key,this.orthoMatrix)),this._assignTerrainTiles(u),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(h),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const v of this.proxyCoords){const b=this.terrainTileForTile[v.key];if(!b)continue;const x=b.tileID.key;x in g||(this._visibleDemTiles.push(b),g[x]=x)}}_assignTerrainTiles(t){this._initializing||t.forEach(r=>{if(this.terrainTileForTile[r.key])return;const l=this._findTileCoveringTileID(r,this.sourceCache);l&&(this.terrainTileForTile[r.key]=l)})}_prepareDEMTextures(){const t=this.painter.context,r=t.gl;for(const l in this.terrainTileForTile){const u=this.terrainTileForTile[l],h=u.dem;!h||u.demTexture&&!u.needsDEMTextureUpload||(t.activeTexture.set(r.TEXTURE1),h8(this.painter,u,h))}}_prepareDemTileUniforms(t,r,l,u){if(!r||r.demTexture==null)return!1;const h=t.tileID.canonical,p=Math.pow(2,r.tileID.canonical.z-h.z),g=u||"";return l[`u_dem_tl${g}`]=[h.x*p%1,h.y*p%1],l[`u_dem_scale${g}`]=p,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const l=new $i({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new mr(t,l,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const r=this._visibleDemTiles.reduce((l,u)=>{if(!u.dem)return l;const h=u.dem.tree.minimums[0];return h>0&&t++,l+h},0);return t?r/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const l=this._getLoadedAreaMinimum(),[u,h]=(()=>{if(this.painter.terrainUseFloatDEM()){const g=new uF({width:1,height:1},new Float32Array([l]));return[r.R32F,g]}{const g=new $i({width:1,height:1},new Uint8Array(_m.pack(l,this.sourceCache.getSource().encoding)));return[r.RGBA,g]}})();this._emptyDEMTextureDirty=!1;let p=this._emptyDEMTexture;return p?p.update(h,{premultiply:!1}):p=this._emptyDEMTexture=new mr(t,h,u,{premultiply:!1}),p}setupElevationDraw(t,r,l){const u=this.painter.context,h=u.gl,p=(g=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:_m.getUnpackVector(g),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var g;p.u_exaggeration=this.exaggeration();let v=null,b=null,x=1;if(l&&l.morphing&&this._useVertexMorphing){const P=l.morphing.srcDemTile,R=l.morphing.dstDemTile;x=l.morphing.phase,P&&R&&(this._prepareDemTileUniforms(t,P,p,"_prev")&&(b=P),this._prepareDemTileUniforms(t,R,p)&&(v=R))}const S=P=>P&&P.demTexture&&this.painter.terrainUseFloatDEM()?h.LINEAR:h.NEAREST,T=P=>{p.u_dem_size=P.size[0]===1?1:P.size[0]-2};if(b&&v)u.activeTexture.set(h.TEXTURE2),v.demTexture.bind(S(v),h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE4),b.demTexture.bind(S(b),h.CLAMP_TO_EDGE),v.demTexture&&T(v.demTexture),p.u_dem_lerp=x;else{v=this.terrainTileForTile[t.tileID.key],u.activeTexture.set(h.TEXTURE2);const P=this._prepareDemTileUniforms(t,v,p)?v.demTexture:this.emptyDEMTexture;P.bind(S(v),h.CLAMP_TO_EDGE),T(P)}if(u.activeTexture.set(h.TEXTURE3),l&&l.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),this._depthFBO&&(p.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),p.u_depth_size_inv=[1,1]),l&&l.useMeterToDem&&v){const P=(1<<v.tileID.canonical.z)*ja(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;p.u_meter_to_dem=P}if(l&&l.labelPlaneMatrixInv&&(p.u_label_plane_matrix_inv=l.labelPlaneMatrixInv),r.setTerrainUniformValues(u,p),this.painter.transform.projection.name==="globe"){const P=this.globeUniformValues(this.painter.transform,t.tileID.canonical,l&&l.useDenormalizedUpVectorScale);r.setGlobeUniformValues(u,P)}}globeUniformValues(t,r,l){const u=t.projection;return{u_tile_tl_up:u.upVector(r,0,0),u_tile_tr_up:u.upVector(r,dt,0),u_tile_br_up:u.upVector(r,dt,dt),u_tile_bl_up:u.upVector(r,0,dt),u_tile_up_scale:l?y2(1):u.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,l=this.painter.context;t.length!==0&&(l.bindFramebuffer.set(null),l.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(u,h,p,g,v){if(u.transform.projection.name==="globe")(function(b,x,S,T,P){const R=b.context,z=R.gl;let U,W;const j=b.transform,Z=Gz(b,R,j),Y=(Ie,xe)=>{if(W===xe)return;const We=[y8[xe],"PROJECTION_GLOBE_VIEW"];Z&&We.push("CUSTOM_ANTIALIASING");const qe=b.isTileAffectedByFog(Ie);U=b.getOrCreateProgram("globeRaster",{defines:We,overrideFog:qe}),W=xe},$=b.colorModeForRenderPass(),K=new zn(z.LEQUAL,zn.ReadWrite,b.depthRangeFor3D);gv.update(P);const ae=function(Ie){const xe=Ie.pixelsPerMeter,We=xe/ja(1,Ie.center.lat),qe=nt.identity(new Float64Array(16));return nt.translate(qe,qe,[Ie.point.x,Ie.point.y,0]),nt.scale(qe,qe,[We,We,xe]),Float32Array.from(qe)}(j),se=[go(j.center.lng),Eo(j.center.lat)],de=b.globeSharedBuffers,ge=[j.width*Cn.devicePixelRatio,j.height*Cn.devicePixelRatio],Te=Float32Array.from(j.globeMatrix),we={useDenormalizedUpVectorScale:!0};{const Ie=b.transform,xe=v8(Ie.zoom,x.exaggeration(),x.sourceCache._source.tileSize);W=-1;const We=z.TRIANGLES;for(const qe of T){const Qe=S.getTile(qe),Ne=oa.disabled,Ve=x.prevTerrainTileForTile[qe.key],at=x.terrainTileForTile[qe.key];g8(Ve,at)&&gv.newMorphing(qe.key,Ve,at,P,250),R.activeTexture.set(z.TEXTURE0),Qe.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const mt=gv.getMorphValuesForProxy(qe.key),lt=mt?1:0;mt&&As(we,{morphing:{srcDemTile:mt.from,dstDemTile:mt.to,phase:Re(mt.phase)}});const Ct=v2(qe.canonical),zt=FQ(Ct.getCenter().lat),bt=zQ(qe.canonical,Ct,zt,Ie.worldSize/Ie._pixelsPerMercatorPixel),Et=ym(dc(qe.canonical)),en=m8(Ie.projMatrix,Te,ae,Et,mo(Ie.zoom),se,Ie.frustumCorners.TL,Ie.frustumCorners.TR,Ie.frustumCorners.BR,Ie.frustumCorners.BL,Ie.globeCenterInViewSpace,Ie.globeRadius,ge,xe,bt);if(Y(qe,lt),U&&(x.setupElevationDraw(Qe,U,we),b.uploadCommonUniforms(R,U,qe.toUnwrapped()),de)){const[on,rn,cn]=de.getGridBuffers(zt,xe!==0);U.draw(b,We,K,Ne,$,la.backCCW,en,"globe_raster",on,rn,cn)}}}if(de&&(b.renderDefaultNorthPole||b.renderDefaultSouthPole)){const Ie=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Z&&Ie.push("CUSTOM_ANTIALIASING"),U=b.getOrCreateProgram("globeRaster",{defines:Ie});for(const xe of T){const{x:We,y:qe,z:Qe}=xe.canonical,Ne=qe===0,Ve=qe===(1<<Qe)-1,[at,mt,lt,Ct]=de.getPoleBuffers(Qe,!1);if(Ct&&(Ne||Ve)){const zt=S.getTile(xe);R.activeTexture.set(z.TEXTURE0),zt.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);let bt=Vz(Qe,We,j);const Et=ym(dc(xe.canonical)),en=(on,rn)=>on.draw(b,z.TRIANGLES,K,oa.disabled,$,la.disabled,m8(j.projMatrix,bt,bt,Et,0,se,j.frustumCorners.TL,j.frustumCorners.TR,j.frustumCorners.BR,j.frustumCorners.BL,j.globeCenterInViewSpace,j.globeRadius,ge,0),"globe_pole_raster",rn,lt,Ct);x.setupElevationDraw(zt,U,we),b.uploadCommonUniforms(R,U,xe.toUnwrapped()),Ne&&b.renderDefaultNorthPole&&en(U,at),Ve&&b.renderDefaultSouthPole&&(bt=nt.scale(nt.create(),bt,[1,-1,1]),en(U,mt))}}}})(u,h,p,g,v);else{const b=u.context,x=b.gl;let S,T;const P=u.shadowRenderer,R=mv(u,u.longestCutoffRange),z=$=>{if(T===$)return;const K=[];K.push(y8[$]),R.shouldRenderCutoff&&K.push("RENDER_CUTOFF"),S=u.getOrCreateProgram("terrainRaster",{defines:K}),T=$},U=u.colorModeForRenderPass(),W=new zn(x.LEQUAL,zn.ReadWrite,u.depthRangeFor3D);gv.update(v);const j=u.transform,Z=v8(j.zoom,h.exaggeration(),h.sourceCache._source.tileSize);let Y=[0,0,0];if(P){const $=u.style.directionalLight,K=u.style.ambientLight;$&&K&&(Y=l5($,K))}{T=-1;const $=x.TRIANGLES,[K,ae]=[h.gridIndexBuffer,h.gridSegments];for(const se of g){const de=p.getTile(se),ge=oa.disabled,Te=h.prevTerrainTileForTile[se.key],we=h.terrainTileForTile[se.key];g8(Te,we)&&gv.newMorphing(se.key,Te,we,v,250),b.activeTexture.set(x.TEXTURE0),de.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST);const Ie=gv.getMorphValuesForProxy(se.key),xe=Ie?1:0;let We;Ie&&(We={morphing:{srcDemTile:Ie.from,dstDemTile:Ie.to,phase:Re(Ie.phase)}});const qe=p8(se.projMatrix,uie(se.canonical,j.renderWorldCopies)?Z/10:Z,Y);if(z(xe),!S)continue;h.setupElevationDraw(de,S,We);const Qe=se.toUnwrapped();P&&P.setupShadows(Qe,S),u.uploadCommonUniforms(b,S,Qe,null,R),S.draw(u,$,W,ge,U,la.backCCW,qe,"terrain_raster",h.gridBuffer,K,ae)}}}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const r=this.painter,l=this.painter.context,u=this.proxySourceCache,h=this.proxiedCoords[u.id],p=this._drapedRenderBatches.shift(),g=r.style.order,v=[];let b=0;for(const x of h){const S=u.getTileByID(x.proxyTileKey),T=u.proxyCachedFBO[x.key]?u.proxyCachedFBO[x.key][t]:void 0,P=T!==void 0?u.renderCache[T]:this.pool[b++],R=T!==void 0;if(S.texture=P.tex,R&&!P.dirty){v.push(S.tileID);continue}let z;l.bindFramebuffer.set(P.fb.framebuffer),this.renderedToTile=!1,P.dirty&&(l.clear({color:xn.transparent,stencil:0}),P.dirty=!1);for(let U=p.start;U<=p.end;++U){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const j=r.style.getLayerSourceCache(W),Z=j?this.proxyToSource[x.key][j.id]:[x];if(!Z)continue;const Y=Z;l.viewport.set([0,0,P.fb.width,P.fb.height]),z!==(j?j.id:null)&&(this._setupStencil(P,Z,W,j),z=j?j.id:null),r.renderLayer(r,j,W,Y)}if(this._drapedRenderBatches.length===0)for(const U of this._pendingGroundEffectLayers){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const j=r.style.getLayerSourceCache(W),Z=j?this.proxyToSource[x.key][j.id]:[x];if(!Z)continue;const Y=Z;l.viewport.set([0,0,P.fb.width,P.fb.height]),z!==(j?j.id:null)&&(this._setupStencil(P,Z,W,j),z=j?j.id:null),r.renderLayer(r,j,W,Y)}this.renderedToTile?(P.dirty=!0,v.push(S.tileID)):R||--b,b===5&&(b=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,l.bindFramebuffer.set(null),l.viewport.set([0,0,r.width,r.height]),p.end+1}postRender(){}isLayerOrderingCorrect(t){const r=t.order.length;let l=-1,u=r;for(let h=0;h<r;++h)this._style.isLayerDraped(t._mergedLayers[t.order[h]])?l=Math.max(l,h):u=Math.min(u,h);return u>l}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{t=Math.min(t,r.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,r,l){if(!this._visibleDemTiles)return null;const u=this._visibleDemTiles.filter(h=>h.dem).map(h=>{const p=h.tileID,g=1<<p.overscaledZ,{x:v,y:b}=p.canonical,x=v/g,S=(v+1)/g,T=b/g,P=(b+1)/g;return{minx:x,miny:T,maxx:S,maxy:P,t:h.dem.tree.raycastRoot(x,T,S,P,t,r,l),tile:h}});u.sort((h,p)=>(h.t!==null?h.t:Number.MAX_VALUE)-(p.t!==null?p.t:Number.MAX_VALUE));for(const h of u){if(h.t==null)return null;const p=h.tile.dem.tree.raycast(h.minx,h.miny,h.maxx,h.maxy,t,r,l);if(p!=null)return p}return null}_createFBO(){const t=this.painter.context,r=t.gl,l=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const u=new mr(t,{width:l[0],height:l[1],data:null},r.RGBA);u.bind(r.LINEAR,r.CLAMP_TO_EDGE);const h=t.createFramebuffer(l[0],l[1],!0,null);return h.colorAttachment.set(u.texture),h.depthAttachment=new bne(t,h.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,l[0],l[1]),this._stencilRef=0,h.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):h.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:h,tex:u,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const r=this._style._mergedLayers[t],l=r.isHidden(this.painter.transform.zoom);return r.type==="custom"?!l&&r.shouldRedrape():!l&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const l of this._style.getSources())if(l instanceof LB){t=!0;break}if(!t)return;const r={};for(let l=0;l<this._style.order.length;++l){const u=this._style._mergedLayers[this._style.order[l]],h=this._style.getLayerSourceCache(u);if(h&&!r[h.id]&&!u.isHidden(this.painter.transform.zoom)&&u.type==="line"&&u.widthExpression()instanceof Dc){r[h.id]=!0;for(const p of this.proxyCoords){const g=this.proxyToSource[p.key][h.id];if(g)for(const v of g)this._clearRenderCacheForTile(h.id,v)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l]._source instanceof w1){t=!0;break}if(!t)return;const r={};for(let l=0;l<this._style.order.length;++l){const u=this._style._mergedLayers[this._style.order[l]],h=this._style.getLayerSourceCache(u);if(!h||r[h.id]||u.isHidden(this.painter.transform.zoom)||u.type!=="raster")continue;const p=u.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const v=this.proxyToSource[g.key][h.id];if(v)for(const b of v){const x=_8(h.getTile(b),h.findLoadedParent(b,0),h,this.painter.transform,p);(x.opacity!==1||x.mix!==0)&&this._clearRenderCacheForTile(h.id,b)}}}}_setupDrapedRenderBatches(){const t=this._style.order,r=t.length;if(r===0)return;const l=[];this._pendingGroundEffectLayers=[];let u,h=0,p=this._style._mergedLayers[t[h]];for(;!this._style.isLayerDraped(p)&&p.isHidden(this.painter.transform.zoom)&&++h<r;)p=this._style._mergedLayers[t[h]];for(;h<r;++h){const g=this._style._mergedLayers[t[h]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?u===void 0&&(u=h):(g.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(h),u!==void 0&&(l.push({start:u,end:h-1}),u=void 0)))}if(u!==void 0&&l.push({start:u,end:h-1}),l.length!==0){const g=l[l.length-1];this._pendingGroundEffectLayers.every(b=>b>g.end)||ve("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=l}_setupRenderCache(t){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const p=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let g=0;g<p.length;++g){const v=Object.values(p[g]);r.renderCachePool.push(...v)}}return}this._clearRasterLayersFromRenderCache();const l=this.proxyCoords,u=this._tilesDirty;for(let p=l.length-1;p>=0;p--){const g=l[p];if(r.getTileByID(g.key),r.proxyCachedFBO[g.key]!==void 0){const v=t[g.key],b=this.proxyToSource[g.key];let x=0;for(const S in b){const T=b[S],P=v[S];if(!P||P.length!==T.length||T.some((R,z)=>R!==P[z]||u[S]&&u[S].hasOwnProperty(R.key))){x=-1;break}++x}for(const S in r.proxyCachedFBO[g.key])r.renderCache[r.proxyCachedFBO[g.key][S]].dirty=x<0||x!==Object.values(v).length}}const h=[...this._drapedRenderBatches];h.sort((p,g)=>g.end-g.start-(p.end-p.start));for(const p of h)for(const g of l){if(r.proxyCachedFBO[g.key])continue;let v=r.renderCachePool.pop();v===void 0&&r.renderCache.length<50&&(v=r.renderCache.length,r.renderCache.push(this._createFBO())),v!==void 0&&(r.proxyCachedFBO[g.key]={},r.proxyCachedFBO[g.key][p.start]=v,r.renderCache[v].dirty=!0)}this._tilesDirty={}}_setupStencil(t,r,l,u){if(!u||!this._sourceTilesOverlap[u.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const h=this.painter.context,p=h.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let g;if(l.isTileClipped())g=r.length,this._overlapStencilMode.test={func:p.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:p.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(h.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,l.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):oa.disabled}_renderTileClippingMasks(t,r){const l=this.painter,u=this.painter.context,h=u.gl;l._tileClippingMaskIDs={},u.setColorMode(Aa.disabled),u.setDepthMode(zn.disabled);const p=l.getOrCreateProgram("clippingMask");for(const g of t){const v=l._tileClippingMaskIDs[g.key]=--r;p.draw(l,h.TRIANGLES,zn.disabled,new oa({func:h.ALWAYS,mask:0},v,255,h.KEEP,h.KEEP,h.REPLACE),Aa.disabled,la.disabled,a5(g.projMatrix),"$clipping",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const l=[t.x,t.y,1,1];Va.transformMat4(l,l,r.pixelMatrixInverse),Va.scale(l,l,1/l[3]),l[0]/=r.worldSize,l[1]/=r.worldSize;const u=r._camera.position,h=ja(1,r.center.lat),p=[u[0],u[1],u[2]/h,0],g=ke.subtract([],l.slice(0,3),p);ke.normalize(g,g);const v=this.raycast(p,g,this._exaggeration);return v!==null&&v?(ke.scaleAndAdd(p,p,g,v),p[3]=p[2],p[2]*=h,p):null}drawDepth(){const t=this.painter,r=t.context,l=this.proxySourceCache,u=Math.ceil(t.width),h=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===u&&this._depthFBO.height===h||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const p=r.gl,g=r.createFramebuffer(u,h,!0,"renderbuffer");r.activeTexture.set(p.TEXTURE0);const v=new mr(r,{width:u,height:h,data:null},p.RGBA);v.bind(p.NEAREST,p.CLAMP_TO_EDGE),g.colorAttachment.set(v.texture);const b=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,u,h);g.depthAttachment.set(b),this._depthFBO=g,this._depthTexture=v}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,u,h]),function(p,g,v,b){if(p.transform.projection.name==="globe")return;const x=p.context,S=x.gl;x.clear({depth:1});const T=p.getOrCreateProgram("terrainDepth"),P=new zn(S.LESS,zn.ReadWrite,p.depthRangeFor3D);for(const R of b){const z=v.getTile(R),U=p8(R.projMatrix,0,[0,0,0]);g.setupElevationDraw(z,T),T.draw(p,S.TRIANGLES,P,oa.disabled,Aa.unblended,la.backCCW,U,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,l,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,r,l){if(t.getSource()instanceof $u)return this._setupProxiedCoordsForImageSource(t,r,l);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords;for(let g=0;g<h.length;g++){const v=h[g],b=this._findTileCoveringTileID(v,t);if(b){const x=this._createProxiedId(v,b,l[v.key]&&l[v.key][t.id]);u.push(x),this.proxyToSource[v.key][t.id]=[x]}}let p=!1;for(let g=0;g<r.length;g++){const v=t.getTile(r[g]);if(!v||!v.hasData())continue;const b=this._findTileCoveringTileID(v.tileID,this.proxySourceCache);if(b&&b.tileID.canonical.z!==v.tileID.canonical.z){const x=this.proxyToSource[b.tileID.key][t.id],S=this._createProxiedId(b.tileID,v,l[b.tileID.key]&&l[b.tileID.key][t.id]);x?x.splice(x.length-1,0,S):this.proxyToSource[b.tileID.key][t.id]=[S],u.push(S),p=!0}}this._sourceTilesOverlap[t.id]=p}_setupProxiedCoordsForImageSource(t,r,l){if(!t.getSource().loaded())return;const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords,p=t.getSource(),g=p.tileID;if(!g)return;const v=new V(g.x,g.y)._div(1<<g.z),b=p.coordinates.map(ga.fromLngLat).reduce((S,T)=>(S.min.x=Math.min(S.min.x,T.x-v.x),S.min.y=Math.min(S.min.y,T.y-v.y),S.max.x=Math.max(S.max.x,T.x-v.x),S.max.y=Math.max(S.max.y,T.y-v.y),S),{min:new V(Number.MAX_VALUE,Number.MAX_VALUE),max:new V(-Number.MAX_VALUE,-Number.MAX_VALUE)}),x=(S,T)=>{const P=S.wrap+S.canonical.x/(1<<S.canonical.z),R=S.canonical.y/(1<<S.canonical.z),z=dt/(1<<S.canonical.z),U=T.wrap+T.canonical.x/(1<<T.canonical.z),W=T.canonical.y/(1<<T.canonical.z);return P+z<U+b.min.x||P>U+b.max.x||R+z<W+b.min.y||R>W+b.max.y};for(let S=0;S<h.length;S++){const T=h[S];for(let P=0;P<r.length;P++){const R=t.getTile(r[P]);if(!R||!R.hasData()||x(T,R.tileID))continue;const z=this._createProxiedId(T,R,l[T.key]&&l[T.key][t.id]),U=this.proxyToSource[T.key][t.id];U?U.push(z):this.proxyToSource[T.key][t.id]=[z],u.push(z)}}}_createProxiedId(t,r,l){let u=this.orthoMatrix;if(l){const h=l.find(p=>p.key===r.tileID.key);if(h)return h}if(r.tileID.key!==t.key){const h=t.canonical.z-r.tileID.canonical.z;let p,g,v;u=nt.create();const b=r.tileID.wrap-t.wrap<<t.overscaledZ;h>0?(p=dt>>h,g=p*((r.tileID.canonical.x<<h)-t.canonical.x+b),v=p*((r.tileID.canonical.y<<h)-t.canonical.y)):(p=dt<<-h,g=dt*(r.tileID.canonical.x-(t.canonical.x+b<<-h)),v=dt*(r.tileID.canonical.y-(t.canonical.y<<-h))),nt.ortho(u,0,p,0,p,0,1),nt.translate(u,u,[g,v,0])}return new b8(r.tileID,t.key,u)}_findTileCoveringTileID(t,r){let l=r.getTile(t);if(l&&l.hasData())return l;const u=this._findCoveringTileCache[r.id],h=u[t.key];if(l=h?r.getTileByID(h):null,l&&l.hasData()||h===null)return l;let p=l?l.tileID:t,g=p.overscaledZ;const v=r.getSource().minzoom,b=[];if(!h){const S=r.getSource().maxzoom;if(t.canonical.z>=S){const T=t.canonical.z-S;r.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,r.transform.tileZoom),p=new Ta(g,t.wrap,S,t.canonical.x>>T,t.canonical.y>>T)):T!==0&&(g=S,p=new Ta(g,t.wrap,S,t.canonical.x>>T,t.canonical.y>>T))}p.key!==t.key&&(b.push(p.key),l=r.getTile(p))}const x=S=>{b.forEach(T=>{u[T]=S}),b.length=0};for(g-=1;g>=v&&(!l||!l.hasData());g--){l&&x(l.tileID.key);const S=p.calculateScaledKey(g);if(l=r.getTileByID(S),l&&l.hasData())break;const T=u[S];if(T===null)break;T===void 0?b.push(S):l=r.getTileByID(T)}return x(l?l.tileID.key:null),l&&l.hasData()?l:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,r){let l=this._tilesDirty[t];l||(l=this._tilesDirty[t]={}),l[r.key]=!0}}function pie(i,t,r){const l=function(g,v,b){const x=ke.dot(v,g),S=ke.dot(b,[.2126,.7152,.0722]),T=(R,z,U)=>(1-U)*R+U*z,P=T(1-.3*Math.min(S,1),1,Math.min(x+1,1));return T(.92,1,Math.asin(ne(v[2],-1,1))/Math.PI+.5)*P}(i,[0,0,1],t),u=[0,0,0];ke.scale(u,r.slice(0,3),l);const h=[0,0,0];ke.scale(h,t.slice(0,3),i[2]);const p=[0,0,0];return ke.add(p,u,h),$t(p)}const mie=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],gie=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class x8{static cacheKey(t,r,l,u){let h=`${r}${u?u.cacheKey:""}`;for(const p of l)t.usedDefines.includes(p)&&(h+=`/${p}`);return h}constructor(t,r,l,u,h,p){const g=t.gl;this.program=g.createProgram(),this.configuration=u,this.name=r,this.fixedDefines=[...p];const v=function(W){const j=[];for(let Z=0;Z<W.length;Z++){if(W[Z]===null)continue;const Y=W[Z].split(" ");j.push(Y.pop())}return j}(l.staticAttributes),b=u?u.getBinderAttributes():[],x=v.concat(b);let S=u?u.defines():[];S=S.concat(p.map(W=>`#define ${W}`));const T=`#version 300 es
`;let P=T+S.concat(u8,u8,c8,l8.fragmentSource).join(`
`);for(const W of l.fragmentIncludes)P+=`
${b3[W]}`;P+=`
${l.fragmentSource}`;let R=T+S.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,c8,l8.vertexSource).join(`
`);for(const W of l.vertexIncludes)R+=`
${b3[W]}`;R+=`
${l.vertexSource}`;const z=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(z,P),g.compileShader(z),g.attachShader(this.program,z);const U=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(U,R),g.compileShader(U),g.attachShader(this.program,U),this.attributes={},this.numAttributes=x.length;for(let W=0;W<this.numAttributes;W++)if(x[W]){const j=x[W].startsWith("a_")?x[W]:`a_${x[W]}`;g.bindAttribLocation(this.program,W,j),this.attributes[j]=W}g.linkProgram(this.program),g.deleteShader(U),g.deleteShader(z),this.fixedUniforms=h(t),this.binderUniforms=u?u.getUniforms(t):[],p.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new ra(W),u_dem_prev:new ra(W),u_dem_unpack:new al(W),u_dem_tl:new ca(W),u_dem_scale:new Zt(W),u_dem_tl_prev:new ca(W),u_dem_scale_prev:new Zt(W),u_dem_size:new Zt(W),u_dem_lerp:new Zt(W),u_exaggeration:new Zt(W),u_depth:new ra(W),u_depth_size_inv:new ca(W),u_meter_to_dem:new Zt(W),u_label_plane_matrix_inv:new jn(W)}))(t)),p.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new Xn(W),u_tile_tr_up:new Xn(W),u_tile_br_up:new Xn(W),u_tile_bl_up:new Xn(W),u_tile_up_scale:new Zt(W)}))(t)),p.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new jn(W),u_fog_range:new ca(W),u_fog_color:new al(W),u_fog_horizon_blend:new Zt(W),u_fog_vertical_limit:new ca(W),u_fog_temporal_offset:new Zt(W),u_frustum_tl:new Xn(W),u_frustum_tr:new Xn(W),u_frustum_br:new Xn(W),u_frustum_bl:new Xn(W),u_globe_pos:new Xn(W),u_globe_radius:new Zt(W),u_globe_transition:new Zt(W),u_is_globe:new ra(W),u_viewport:new ca(W)}))(t)),p.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(W=>({u_cutoff_params:new al(W)}))(t)),p.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(W=>({u_lighting_ambient_color:new Xn(W),u_lighting_directional_dir:new Xn(W),u_lighting_directional_color:new Xn(W),u_ground_radiance:new Xn(W)}))(t)),p.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(W=>({u_light_matrix_0:new jn(W),u_light_matrix_1:new jn(W),u_fade_range:new ca(W),u_shadow_normal_offset:new Xn(W),u_shadow_intensity:new Zt(W),u_shadow_texel_size:new Zt(W),u_shadow_map_resolution:new Zt(W),u_shadow_direction:new Xn(W),u_shadow_bias:new Xn(W),u_shadowmap_0:new ra(W),u_shadowmap_1:new ra(W)}))(t))}}setTerrainUniformValues(t,r){if(!this.terrainUniforms)return;const l=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u]&&l[u].set(this.program,u,r[u])}}setGlobeUniformValues(t,r){if(!this.globeUniforms)return;const l=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u]&&l[u].set(this.program,u,r[u])}}setFogUniformValues(t,r){if(!this.fogUniforms)return;const l=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setCutoffUniformValues(t,r){if(!this.cutoffUniforms)return;const l=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setLightsUniformValues(t,r){if(!this.lightsUniforms)return;const l=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setShadowUniformValues(t,r){if(this.failedToCreate||!this.shadowUniforms)return;const l=this.shadowUniforms;t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}_drawDebugWireframe(t,r,l,u,h,p,g,v,b,x){const S=t.options.wireframe;if(S.terrain===!1&&S.layers2D===!1&&S.layers3D===!1)return;const T=t.context;if(!(()=>!(!S.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!S.layers2D||t._terrain&&t._terrain.renderingToTexture||!mie.includes(this.name))||!(!S.layers3D||!gie.includes(this.name)))())return;const P=T.gl,R=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,h,T);if(!R)return;const z=[...this.fixedDefines];z.push("DEBUG_WIREFRAME");const U=t.getOrCreateProgram(this.name,{config:this.configuration,defines:z});T.program.set(U.program);const W=(Y,$,K)=>{if($[Y]&&K[Y])for(const ae in $[Y])K[Y][ae]&&K[Y][ae].set(K.program,ae,$[Y][ae].current)};b&&b.setUniforms(U.program,T,U.binderUniforms,g,{zoom:v}),W("fixedUniforms",this,U),W("terrainUniforms",this,U),W("globeUniforms",this,U),W("fogUniforms",this,U),W("lightsUniforms",this,U),W("shadowUniforms",this,U),R.bind(),T.setColorMode(new Aa([P.ONE,P.ONE_MINUS_SRC_ALPHA,P.ZERO,P.ONE],xn.transparent,[!0,!0,!0,!1])),T.setDepthMode(new zn(r.func===P.LESS?P.LEQUAL:r.func,zn.ReadOnly,r.range)),T.setStencilMode(oa.disabled);const j=3*p.primitiveLength*2,Z=3*p.primitiveOffset*2*2;x&&x>1?P.drawElementsInstanced(P.LINES,j,P.UNSIGNED_SHORT,Z,x):P.drawElements(P.LINES,j,P.UNSIGNED_SHORT,Z),h.bind(),T.program.set(this.program),T.setDepthMode(r),T.setStencilMode(l),T.setColorMode(u)}draw(t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U){const W=t.context,j=W.gl;if(this.failedToCreate)return;W.program.set(this.program),W.setDepthMode(l),W.setStencilMode(u),W.setColorMode(h),W.setCullFace(p);for(const $ of Object.keys(this.fixedUniforms))this.fixedUniforms[$].set(this.program,$,g[$]);R&&R.setUniforms(this.program,W,this.binderUniforms,T,{zoom:P});const Z={[j.LINES]:2,[j.TRIANGLES]:3,[j.LINE_STRIP]:1}[r],Y=U&&U>0?1:void 0;for(const $ of S.get()){const K=$.vaos||($.vaos={});(K[v]||(K[v]=new oie)).bind(W,this,b,R?R.getPaintVertexBuffers():[],x,$.vertexOffset,z||[],Y),U&&U>1?j.drawElementsInstanced(r,$.primitiveLength*Z,j.UNSIGNED_SHORT,$.primitiveOffset*Z*2,U):j.drawElements(r,$.primitiveLength*Z,j.UNSIGNED_SHORT,$.primitiveOffset*Z*2),r===j.TRIANGLES&&this._drawDebugWireframe(t,l,u,h,x,$,T,P,R,U)}}}function w8(i,t){const r=Math.pow(2,t.tileID.overscaledZ),l=t.tileSize*Math.pow(2,i.transform.tileZoom)/r,u=l*(t.tileID.canonical.x+t.tileID.wrap*r),h=l*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/xm(t,1,i.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}const yie=nt.create(),S8=(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R)=>{const z=t.style.light,U=z.properties.get("position"),W=[U.x,U.y,U.z],j=Rs.create();z.properties.get("anchor")==="viewport"&&(Rs.fromRotation(j,-t.transform.angle),ke.transformMat3(W,W,j));const Z=z.properties.get("color"),Y=t.transform,$={u_matrix:i,u_lightpos:W,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+r,u_opacity:l,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:yie,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:u,u_edge_radius:h,u_flood_light_color:S,u_vertical_scale:T,u_flood_light_intensity:P,u_ground_shadow_factor:R};return Y.projection.name==="globe"&&($.u_tile_id=[p.canonical.x,p.canonical.y,1<<p.canonical.z],$.u_zoom_transition=v,$.u_inv_rot_matrix=x,$.u_merc_center=b,$.u_up_dir=Y.projection.upVector(new Uu(0,0,0),b[0]*dt,b[1]*dt),$.u_height_lift=g),$},vie=(i,t,r)=>({u_matrix:i,u_edge_radius:t,u_vertical_scale:r}),_ie=(i,t,r,l,u,h,p,g,v,b,x,S,T,P)=>{const R=S8(i,t,r,l,u,h,p,v,b,x,S,T,P,1,[0,0,0]),z={u_height_factor:-Math.pow(2,p.overscaledZ)/g.tileSize/8};return Ue(R,w8(t,g),z)},A8=(i,t)=>({u_matrix:i,u_emissive_strength:t}),E8=(i,t,r,l)=>Ue(A8(i,t),w8(r,l)),bie=(i,t,r)=>({u_matrix:i,u_world:r,u_emissive_strength:t}),xie=(i,t,r,l,u)=>Ue(E8(i,t,r,l),{u_world:u}),wie=(i,t,r,l)=>{const u=dt/r.tileSize;return{u_matrix:i,u_camera_to_center_distance:t.getCameraToCenterDistance(l),u_extrude_scale:[t.pixelsToGLUnits[0]/u,t.pixelsToGLUnits[1]/u]}},M8=(i,t,r=1)=>({u_matrix:i,u_color:t,u_overlay:0,u_overlay_scale:r}),Sie=nt.create(),Aie=(i,t,r,l,u,h,p)=>{const g=i.transform,v=g.projection.name==="globe",b=v?Uz(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:xm(r,1,h),x={u_matrix:t.projMatrix,u_extrude_scale:b,u_intensity:p,u_inv_rot_matrix:Sie,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){x.u_inv_rot_matrix=l,x.u_merc_center=u,x.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],x.u_zoom_transition=mo(g.zoom);const S=u[0]*dt,T=u[1]*dt;x.u_up_dir=g.projection.upVector(new Uu(0,0,0),S,T)}return x},T8=(i,t,r,l,u,h,p,g,v,b,x)=>{return{u_matrix:i,u_normalize_matrix:t,u_globe_matrix:r,u_tl_parent:l,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(T=p.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(S=p.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Eie(p.paint.get("raster-hue-rotate")),u_perspective_transform:g,u_colorization_mix:b,u_colorization_scale:Mie(x),u_color_ramp:v};var S,T};function Eie(i){i*=Math.PI/180;const t=Math.sin(i),r=Math.cos(i);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function Mie([i,t]){if(i===t)return[i,t];const r=(t+i)/2,l=(t-i)/2*256/255;return[-(i=r-l)/((t=r+l)-i),1/(t-i)]}const C8=nt.create(),P8=(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U)=>{const W=u.transform,j={u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:W.getCameraToCenterDistance(z),u_rotate_symbol:+r,u_aspect_ratio:W.width/W.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:h,u_label_plane_matrix:p,u_coord_matrix:g,u_is_text:+v,u_pitch_with_map:+l,u_texsize:b,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:C8,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:C8,u_up_vector:[0,-1,0],u_icon_transition:U||0};return z.name==="globe"&&(j.u_tile_id=[x.canonical.x,x.canonical.y,1<<x.canonical.z],j.u_zoom_transition=S,j.u_inv_rot_matrix=P,j.u_merc_center=T,j.u_camera_forward=W._camera.forward(),j.u_ecef_origin=function(Z,Y){const $=[0,0,0],K=ym(dc(Y.canonical));return ke.transformMat4($,$,K),ke.transformMat4($,$,Z),$}(W.globeMatrix,x.toUnwrapped()),j.u_tile_matrix=Float32Array.from(W.globeMatrix),j.u_up_vector=R),j},I8=(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U)=>Ue(P8(i,t,r,l,u,h,p,g,v,b,S,T,P,R,z,U),{u_gamma_scale:l?u.transform.getCameraToCenterDistance(U)*Math.cos(u.terrain?0:u.transform._pitch):1,u_device_pixel_ratio:Cn.devicePixelRatio,u_is_halo:+x,undefined:void 0}),Tie=(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z)=>Ue(I8(i,t,r,l,u,h,p,g,!0,v,!0,x,S,T,P,R,z),{u_texsize_icon:b,u_texture_icon:1}),Cie=(i,t,r,l)=>({u_matrix:i,u_emissive_strength:t,u_opacity:r,u_color:l}),Pie=(i,t,r,l,u,h,p)=>Ue(function(g,v,b,x){const S=b.imageManager.getPattern(g.toString(),v),{width:T,height:P}=b.imageManager.getPixelSize(v),R=Math.pow(2,x.tileID.overscaledZ),z=x.tileSize*Math.pow(2,b.transform.tileZoom)/R,U=z*(x.tileID.canonical.x+x.tileID.wrap*R),W=z*x.tileID.canonical.y;return{u_image:0,u_pattern_tl:S.tl,u_pattern_br:S.br,u_texsize:[T,P],u_pattern_size:S.displaySize,u_tile_units_to_pixels:1/xm(x,1,b.transform.tileZoom),u_pixel_coord_upper:[U>>16,W>>16],u_pixel_coord_lower:[65535&U,65535&W]}}(u,h,l,p),{u_matrix:i,u_emissive_strength:t,u_opacity:r}),rl={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},i5=(i,t,r,l,u,h,p,g,v,b,x,S=[0,0,0])=>{const T=l.style.light,P=T.properties.get("position"),R=[-P.x,-P.y,P.z],z=Rs.create();T.properties.get("anchor")==="viewport"&&(Rs.fromRotation(z,-l.transform.angle),ke.transformMat3(R,R,z));const U=b.alphaMode==="MASK",W=T.properties.get("color"),j=x.paint.get("model-ambient-occlusion-intensity"),Z=x.paint.get("model-color").constantOr(xn.white),Y=x.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:i,u_lighting_matrix:t,u_normal_matrix:r,u_lightpos:R,u_lightintensity:T.properties.get("intensity"),u_lightcolor:[W.r,W.g,W.b],u_camera_pos:S,u_opacity:u,u_baseTextureIsAlpha:0,u_alphaMask:+U,u_alphaCutoff:b.alphaCutoff,u_baseColorFactor:[h.r,h.g,h.b,h.a],u_emissiveFactor:[p[0],p[1],p[2],1],u_metallicFactor:g,u_roughnessFactor:v,u_baseColorTexture:rl.BaseColor,u_metallicRoughnessTexture:rl.MetallicRoughness,u_normalTexture:rl.Normal,u_occlusionTexture:rl.Occlusion,u_emissionTexture:rl.Emission,u_color_mix:[Z.r,Z.g,Z.b,Y],u_aoIntensity:j}},L8=new Float32Array(16),R8=(i,t=L8,r=L8)=>({u_matrix:i,u_instance:t,u_node_matrix:r}),Iie={fillExtrusion:i=>({u_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Zt(i),u_lightcolor:new Xn(i),u_vertical_gradient:new Zt(i),u_opacity:new Zt(i),u_edge_radius:new Zt(i),u_ao:new ca(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_up_dir:new Xn(i),u_height_lift:new Zt(i),u_flood_light_color:new Xn(i),u_vertical_scale:new Zt(i),u_flood_light_intensity:new Zt(i),u_ground_shadow_factor:new Xn(i)}),fillExtrusionDepth:i=>({u_matrix:new jn(i),u_edge_radius:new Zt(i),u_vertical_scale:new Zt(i)}),fillExtrusionPattern:i=>({u_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Zt(i),u_lightcolor:new Xn(i),u_vertical_gradient:new Zt(i),u_height_factor:new Zt(i),u_edge_radius:new Zt(i),u_ao:new ca(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_up_dir:new Xn(i),u_height_lift:new Zt(i),u_image:new ra(i),u_texsize:new ca(i),u_pixel_coord_upper:new ca(i),u_pixel_coord_lower:new ca(i),u_tile_units_to_pixels:new Zt(i),u_opacity:new Zt(i)}),fillExtrusionGroundEffect:i=>({u_matrix:new jn(i),u_opacity:new Zt(i),u_ao_pass:new Zt(i),u_meter_to_tile:new Zt(i),u_ao:new ca(i),u_flood_light_intensity:new Zt(i),u_flood_light_color:new Xn(i),u_attenuation:new Zt(i),u_edge_radius:new Zt(i),u_fb:new ra(i),u_fb_size:new Zt(i)}),fill:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i)}),fillPattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i),u_image:new ra(i),u_texsize:new ca(i),u_pixel_coord_upper:new ca(i),u_pixel_coord_lower:new ca(i),u_tile_units_to_pixels:new Zt(i)}),fillOutline:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i),u_world:new ca(i)}),fillOutlinePattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i),u_world:new ca(i),u_image:new ra(i),u_texsize:new ca(i),u_pixel_coord_upper:new ca(i),u_pixel_coord_lower:new ca(i),u_tile_units_to_pixels:new Zt(i)}),circle:i=>({u_camera_to_center_distance:new Zt(i),u_extrude_scale:new gC(i),u_device_pixel_ratio:new Zt(i),u_matrix:new jn(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_up_dir:new Xn(i),u_emissive_strength:new Zt(i)}),collisionBox:i=>({u_matrix:new jn(i),u_camera_to_center_distance:new Zt(i),u_extrude_scale:new ca(i)}),collisionCircle:i=>({u_matrix:new jn(i),u_inv_matrix:new jn(i),u_camera_to_center_distance:new Zt(i),u_viewport_size:new ca(i)}),debug:i=>({u_color:new $y(i),u_matrix:new jn(i),u_overlay:new ra(i),u_overlay_scale:new Zt(i)}),clippingMask:i=>({u_matrix:new jn(i)}),heatmap:i=>({u_extrude_scale:new Zt(i),u_intensity:new Zt(i),u_matrix:new jn(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_up_dir:new Xn(i)}),heatmapTexture:i=>({u_image:new ra(i),u_color_ramp:new ra(i),u_opacity:new Zt(i)}),hillshade:i=>({u_matrix:new jn(i),u_image:new ra(i),u_latrange:new ca(i),u_light:new ca(i),u_shadow:new $y(i),u_highlight:new $y(i),u_emissive_strength:new Zt(i),u_accent:new $y(i)}),hillshadePrepare:i=>({u_matrix:new jn(i),u_image:new ra(i),u_dimension:new ca(i),u_zoom:new Zt(i),u_unpack:new al(i)}),line:i=>({u_matrix:new jn(i),u_pixels_to_tile_units:new gC(i),u_device_pixel_ratio:new Zt(i),u_units_to_pixels:new ca(i),u_dash_image:new ra(i),u_gradient_image:new ra(i),u_image_height:new Zt(i),u_texsize:new ca(i),u_tile_units_to_pixels:new Zt(i),u_alpha_discard_threshold:new Zt(i),u_trim_offset:new ca(i),u_emissive_strength:new Zt(i)}),linePattern:i=>({u_matrix:new jn(i),u_texsize:new ca(i),u_pixels_to_tile_units:new gC(i),u_device_pixel_ratio:new Zt(i),u_image:new ra(i),u_units_to_pixels:new ca(i),u_tile_units_to_pixels:new Zt(i),u_alpha_discard_threshold:new Zt(i)}),raster:i=>({u_matrix:new jn(i),u_normalize_matrix:new jn(i),u_globe_matrix:new jn(i),u_tl_parent:new ca(i),u_scale_parent:new Zt(i),u_fade_t:new Zt(i),u_opacity:new Zt(i),u_image0:new ra(i),u_image1:new ra(i),u_brightness_low:new Zt(i),u_brightness_high:new Zt(i),u_saturation_factor:new Zt(i),u_contrast_factor:new Zt(i),u_spin_weights:new Xn(i),u_perspective_transform:new ca(i),u_colorization_mix:new al(i),u_colorization_scale:new ca(i),u_color_ramp:new ra(i)}),symbolIcon:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Zt(i),u_size:new Zt(i),u_camera_to_center_distance:new Zt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Zt(i),u_fade_change:new Zt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ca(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_camera_forward:new Xn(i),u_tile_matrix:new jn(i),u_up_vector:new Xn(i),u_ecef_origin:new Xn(i),u_texture:new ra(i),u_icon_transition:new Zt(i)}),symbolSDF:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Zt(i),u_size:new Zt(i),u_camera_to_center_distance:new Zt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Zt(i),u_fade_change:new Zt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ca(i),u_texture:new ra(i),u_gamma_scale:new Zt(i),u_device_pixel_ratio:new Zt(i),u_tile_id:new Xn(i),u_zoom_transition:new Zt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ca(i),u_camera_forward:new Xn(i),u_tile_matrix:new jn(i),u_up_vector:new Xn(i),u_ecef_origin:new Xn(i),u_is_halo:new ra(i)}),symbolTextAndIcon:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Zt(i),u_size:new Zt(i),u_camera_to_center_distance:new Zt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Zt(i),u_fade_change:new Zt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ca(i),u_texsize_icon:new ca(i),u_texture:new ra(i),u_texture_icon:new ra(i),u_gamma_scale:new Zt(i),u_device_pixel_ratio:new Zt(i),u_is_halo:new ra(i)}),background:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i),u_opacity:new Zt(i),u_color:new $y(i)}),backgroundPattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Zt(i),u_opacity:new Zt(i),u_image:new ra(i),u_pattern_tl:new ca(i),u_pattern_br:new ca(i),u_texsize:new ca(i),u_pattern_size:new ca(i),u_pixel_coord_upper:new ca(i),u_pixel_coord_lower:new ca(i),u_tile_units_to_pixels:new Zt(i)}),terrainRaster:f8,terrainDepth:f8,skybox:i=>({u_matrix:new jn(i),u_sun_direction:new Xn(i),u_cubemap:new ra(i),u_opacity:new Zt(i),u_temporal_offset:new Zt(i)}),skyboxGradient:i=>({u_matrix:new jn(i),u_color_ramp:new ra(i),u_center_direction:new Xn(i),u_radius:new Zt(i),u_opacity:new Zt(i),u_temporal_offset:new Zt(i)}),skyboxCapture:i=>({u_matrix_3f:new mO(i),u_sun_direction:new Xn(i),u_sun_intensity:new Zt(i),u_color_tint_r:new al(i),u_color_tint_m:new al(i),u_luminance:new Zt(i)}),globeRaster:i=>({u_proj_matrix:new jn(i),u_globe_matrix:new jn(i),u_normalize_matrix:new jn(i),u_merc_matrix:new jn(i),u_zoom_transition:new Zt(i),u_merc_center:new ca(i),u_image0:new ra(i),u_grid_matrix:new mO(i),u_skirt_height:new Zt(i),u_frustum_tl:new Xn(i),u_frustum_tr:new Xn(i),u_frustum_br:new Xn(i),u_frustum_bl:new Xn(i),u_globe_pos:new Xn(i),u_globe_radius:new Zt(i),u_viewport:new ca(i)}),globeAtmosphere:i=>({u_frustum_tl:new Xn(i),u_frustum_tr:new Xn(i),u_frustum_br:new Xn(i),u_frustum_bl:new Xn(i),u_horizon:new Zt(i),u_transition:new Zt(i),u_fadeout_range:new Zt(i),u_color:new al(i),u_high_color:new al(i),u_space_color:new al(i),u_temporal_offset:new Zt(i),u_horizon_angle:new Zt(i)}),model:i=>({u_matrix:new jn(i),u_lighting_matrix:new jn(i),u_normal_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Zt(i),u_lightcolor:new Xn(i),u_camera_pos:new Xn(i),u_opacity:new Zt(i),u_baseColorFactor:new al(i),u_emissiveFactor:new al(i),u_metallicFactor:new Zt(i),u_roughnessFactor:new Zt(i),u_baseTextureIsAlpha:new ra(i),u_alphaMask:new ra(i),u_alphaCutoff:new Zt(i),u_baseColorTexture:new ra(i),u_metallicRoughnessTexture:new ra(i),u_normalTexture:new ra(i),u_occlusionTexture:new ra(i),u_emissionTexture:new ra(i),u_color_mix:new al(i),u_aoIntensity:new Zt(i)}),modelDepth:i=>({u_matrix:new jn(i),u_instance:new jn(i),u_node_matrix:new jn(i)}),groundShadow:i=>({u_matrix:new jn(i),u_ground_shadow_factor:new Xn(i)}),stars:i=>({u_matrix:new jn(i),u_up:new Xn(i),u_right:new Xn(i),u_intensity_multiplier:new Zt(i)})};let S3;function k8(i,t,r,l,u,h,p){const g=i.context,v=g.gl,b=i.transform,x=i.getOrCreateProgram("collisionBox"),S=[];let T=0,P=0;for(let Y=0;Y<l.length;Y++){const $=l[Y],K=t.getTile($),ae=K.getBucket(r);if(!ae)continue;const se=Vae($,ae,b);let de=se;u[0]===0&&u[1]===0||(de=i.translatePosMatrix(se,K,u,h));const ge=p?ae.textCollisionBox:ae.iconCollisionBox,Te=ae.collisionCircleArray;if(Te.length>0){const we=nt.create(),Ie=de;nt.mul(we,ae.placementInvProjMatrix,b.glCoordMatrix),nt.mul(we,we,ae.placementViewportMatrix),S.push({circleArray:Te,circleOffset:P,transform:Ie,invTransform:we,projection:ae.getProjection()}),T+=Te.length/4,P=T}ge&&(i.terrain&&i.terrain.setupElevationDraw(K,x),x.draw(i,v.LINES,zn.disabled,oa.disabled,i.colorModeForRenderPass(),la.disabled,wie(de,b,K,ae.getProjection()),r.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,null,b.zoom,null,[ge.collisionVertexBuffer,ge.collisionVertexBufferExt]))}if(!p||!S.length)return;const R=i.getOrCreateProgram("collisionCircle"),z=new Wt;z.resize(4*T),z._trim();let U=0;for(const Y of S)for(let $=0;$<Y.circleArray.length/4;$++){const K=4*$,ae=Y.circleArray[K+0],se=Y.circleArray[K+1],de=Y.circleArray[K+2],ge=Y.circleArray[K+3];z.emplace(U++,ae,se,de,ge,0),z.emplace(U++,ae,se,de,ge,1),z.emplace(U++,ae,se,de,ge,2),z.emplace(U++,ae,se,de,ge,3)}(!S3||S3.length<2*T)&&(S3=function(Y){const $=2*Y,K=new Nn;K.resize($),K._trim();for(let ae=0;ae<$;ae++){const se=6*ae;K.uint16[se+0]=4*ae+0,K.uint16[se+1]=4*ae+1,K.uint16[se+2]=4*ae+2,K.uint16[se+3]=4*ae+2,K.uint16[se+4]=4*ae+3,K.uint16[se+5]=4*ae+0}return K}(T));const W=g.createIndexBuffer(S3,!0),j=g.createVertexBuffer(z,ete.members,!0);for(const Y of S){const $={u_matrix:Y.transform,u_inv_matrix:Y.invTransform,u_camera_to_center_distance:(Z=b).getCameraToCenterDistance(Y.projection),u_viewport_size:[Z.width,Z.height]};R.draw(i,v.TRIANGLES,zn.disabled,oa.disabled,i.colorModeForRenderPass(),la.disabled,$,r.id,j,W,Ha.simpleSegment(0,2*Y.circleOffset,Y.circleArray.length,Y.circleArray.length/2),null,b.zoom)}var Z;j.destroy(),W.destroy()}const D8=nt.create();function Lie({width:i,height:t,anchor:r,textOffset:l,textScale:u},h){const{horizontalAlign:p,verticalAlign:g}=B2(r),v=-(p-.5)*i,b=-(g-.5)*t,x=mP(r,l);return new V((v/u+x[0])*h,(b/u+x[1])*h)}function Rie(i,t,r,l,u,h,p,g,v,b,x){const S=i.text.placedSymbolArray,T=i.text.dynamicLayoutVertexArray,P=i.icon.dynamicLayoutVertexArray,R={},z=i.getProjection(),U=KP(g,z,h),W=h.elevation,j=z.upVectorScale(g.canonical,h.center.lat,h.worldSize).metersToTile;T.clear();for(let Z=0;Z<S.length;Z++){const Y=S.get(Z),{tileAnchorX:$,tileAnchorY:K,numGlyphs:ae}=Y,se=Y.hidden||!Y.crossTileID||i.allowVerticalPlacement&&!Y.placedOrientation?null:l[Y.crossTileID];if(se){let de=0,ge=0,Te=0;if(W){const at=W?W.getAtTileOffset(g,$,K):0,[mt,lt,Ct]=z.upVector(g.canonical,$,K);de=at*mt*j,ge=at*lt*j,Te=at*Ct*j}let[we,Ie,xe,We]=jc(Y.projectedAnchorX+de,Y.projectedAnchorY+ge,Y.projectedAnchorZ+Te,r?U:p);const qe=AN(h.getCameraToCenterDistance(z),We);let Qe=u.evaluateSizeForFeature(i.textSizeData,b,Y)*qe/to;r&&(Qe*=i.tilePixelRatio/v);const Ne=Lie(se,Qe);r?({x:we,y:Ie,z:xe}=z.projectTilePoint($+Ne.x,K+Ne.y,g.canonical),[we,Ie,xe]=jc(we+de,Ie+ge,xe+Te,p)):(t&&Ne._rotate(-h.angle),we+=Ne.x,Ie+=Ne.y,xe=0);const Ve=i.allowVerticalPlacement&&Y.placedOrientation===_i.vertical?Math.PI/2:0;for(let at=0;at<ae;at++)uv(T,we,Ie,xe,Ve);x&&Y.associatedIconIndex>=0&&(R[Y.associatedIconIndex]={x:we,y:Ie,z:xe,angle:Ve})}else hv(ae,T)}if(x){P.clear();const Z=i.icon.placedSymbolArray;for(let Y=0;Y<Z.length;Y++){const $=Z.get(Y),{numGlyphs:K}=$,ae=R[Y];if($.hidden||!ae)hv(K,P);else{const{x:se,y:de,z:ge,angle:Te}=ae;for(let we=0;we<K;we++)uv(P,se,de,ge,Te)}}i.icon.dynamicLayoutVertexBuffer.updateData(P)}i.text.dynamicLayoutVertexBuffer.updateData(T)}function kie(i,t,r){return r.iconsInText&&t?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}function O8(i,t,r,l,u,h,p,g,v,b,x,S){const T=i.context,P=T.gl,R=i.transform,z=g==="map",U=v==="map",W=z&&r.layout.get("symbol-placement")!=="point",j=z&&!U&&!W,Z=r.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Y=!1;const $=i.depthModeForSublayer(0,zn.ReadOnly),K=[go(R.center.lng),Eo(R.center.lat)],ae=r.layout.get("text-variable-anchor"),se=R.projection.name==="globe",de=[],ge=[0,-1,0];let Te=ge;!se&&!R.mercatorFromTransition||z||(Te=function(we){const Ie=we._camera.getWorldToCamera(we.worldSize,1),xe=nt.multiply([],Ie,we.globeMatrix);nt.invert(xe,xe);const We=[0,0,0],qe=[0,1,0,0];return Va.transformMat4(qe,qe,xe),We[0]=qe[0],We[1]=qe[1],We[2]=qe[2],ke.normalize(We,We),We}(R));for(const we of l){const Ie=t.getTile(we),xe=Ie.getBucket(r);if(!xe||xe.projection.name==="mercator"&&se)continue;const We=u?xe.text:xe.icon;if(!We||xe.fullyClipped||!We.segments.get().length)continue;const qe=We.programConfigurations.get(r.id),Qe=u||xe.sdfIcons,Ne=u?xe.textSizeData:xe.iconSizeData,Ve=U||R.pitch!==0,at=Vu(Ne,R.zoom);let mt,lt,Ct,zt,bt=[0,0],Et=null;if(u)lt=Ie.glyphAtlasTexture,Ct=P.LINEAR,mt=Ie.glyphAtlasTexture.size,xe.iconsInText&&(bt=Ie.imageAtlasTexture.size,Et=Ie.imageAtlasTexture,zt=Ve||i.options.rotating||i.options.zooming||Ne.kind==="composite"||Ne.kind==="camera"?P.LINEAR:P.NEAREST);else{const xi=r.layout.get("icon-size").constantOr(0)!==1||xe.iconsNeedLinear;lt=Ie.imageAtlasTexture,Ct=Qe||i.options.rotating||i.options.zooming||xi||Ve?P.LINEAR:P.NEAREST,mt=Ie.imageAtlasTexture.size}const en=xe.projection.name==="globe",on=en?Te:ge,rn=en?mo(R.zoom):0,cn=KP(we,xe.getProjection(),R),gn=R.calculatePixelsToTileUnitsMatrix(Ie),kn=i3(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn),ea=i.terrain&&U&&W?nt.invert(nt.create(),kn):D8,_a=SN(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn),$n=ae&&xe.hasTextData(),Un=xe.hasIconTextFit()&&$n&&xe.hasIconData();if(W){const xi=R.elevation,Di=xi?xi.getAtTileOffsetFunc(we,R.center.lat,R.worldSize,xe.getProjection()):null,Xa=wN(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn);Rne(xe,cn,i,u,Xa,_a,U,b,Di,we)}const In=W||u&&ae||Un,En=i.translatePosMatrix(cn,Ie,h,p),da=In?D8:kn,Ea=i.translatePosMatrix(_a,Ie,h,p,!0),Qn=xe.getProjection().createInversionMatrix(R,we.canonical),qa=r.paint.get("icon-image-cross-fade").constantOr(0),bi=[];i.terrainRenderModeElevated()&&U&&bi.push("PITCH_WITH_MAP_TERRAIN"),en&&(bi.push("PROJECTION_GLOBE_VIEW"),In&&bi.push("PROJECTED_POS_ON_VIEWPORT")),qa>0&&bi.push("ICON_TRANSITION"),We.zOffsetVertexBuffer&&bi.push("Z_OFFSET");const ri=Qe&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Qa;Qa=Qe?xe.iconsInText?Tie(Ne.kind,at,j,U,i,En,da,Ea,mt,bt,we,rn,K,Qn,on,xe.getProjection()):I8(Ne.kind,at,j,U,i,En,da,Ea,u,mt,!0,we,rn,K,Qn,on,xe.getProjection()):P8(Ne.kind,at,j,U,i,En,da,Ea,u,mt,we,rn,K,Qn,on,xe.getProjection(),qa);const ar={program:i.getOrCreateProgram(kie(Qe,u,xe),{config:qe,defines:bi}),buffers:We,uniformValues:Qa,atlasTexture:lt,atlasTextureIcon:Et,atlasInterpolation:Ct,atlasInterpolationIcon:zt,isSDF:Qe,hasHalo:ri,tile:Ie,labelPlaneMatrixInv:ea};if(Z&&xe.canOverlap){Y=!0;const xi=We.segments.get();for(const Di of xi)de.push({segments:new Ha([Di]),sortKey:Di.sortKey,state:ar})}else de.push({segments:We.segments,sortKey:0,state:ar})}Y&&de.sort((we,Ie)=>we.sortKey-Ie.sortKey);for(const we of de){const Ie=we.state;if(i.terrain&&i.terrain.setupElevationDraw(Ie.tile,Ie.program,{useDepthForOcclusion:!se&&!R.isOrthographic,labelPlaneMatrixInv:Ie.labelPlaneMatrixInv}),T.activeTexture.set(P.TEXTURE0),Ie.atlasTexture.bind(Ie.atlasInterpolation,P.CLAMP_TO_EDGE),Ie.atlasTextureIcon&&(T.activeTexture.set(P.TEXTURE1),Ie.atlasTextureIcon&&Ie.atlasTextureIcon.bind(Ie.atlasInterpolationIcon,P.CLAMP_TO_EDGE)),i.uploadCommonLightUniforms(i.context,Ie.program),Ie.hasHalo){const xe=Ie.uniformValues;xe.u_is_halo=1,r5(Ie.buffers,we.segments,r,i,Ie.program,$,x,S,xe,2),xe.u_is_halo=0}else{if(Ie.isSDF){const xe=Ie.uniformValues;Ie.hasHalo&&(xe.u_is_halo=1,r5(Ie.buffers,we.segments,r,i,Ie.program,$,x,S,xe,1)),xe.u_is_halo=0}r5(Ie.buffers,we.segments,r,i,Ie.program,$,x,S,Ie.uniformValues,1)}}}function r5(i,t,r,l,u,h,p,g,v,b){const x=[i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer,i.iconTransitioningVertexBuffer,i.globeExtVertexBuffer,i.zOffsetVertexBuffer];u.draw(l,l.context.gl.TRIANGLES,h,p,g,la.disabled,v,r.id,i.layoutVertexBuffer,i.indexBuffer,t,r.paint,l.transform.zoom,i.programConfigurations.get(r.id),x,b)}function z8(i,t,r,l,u,h,p){const g=i.context.gl,v=r.paint.get("fill-pattern"),b=v&&v.constantOr(1);let x,S,T,P,R;p?(S=b&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",x=g.LINES):(S=b?"fillPattern":"fill",x=g.TRIANGLES);for(const z of l){const U=t.getTile(z);if(b&&!U.patternsLoaded())continue;const W=U.getBucket(r);if(!W)continue;i.prepareDrawTile();const j=W.programConfigurations.get(r.id),Z=i.isTileAffectedByFog(z),Y=i.getOrCreateProgram(S,{config:j,overrideFog:Z});b&&(i.context.activeTexture.set(g.TEXTURE0),U.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),j.updatePaintBuffers());const $=v.constantOr(null);if($&&U.imageAtlas){const se=U.imageAtlas.patternPositions[$.toString()];se&&j.setConstantPatternPositions(se)}const K=i.translatePosMatrix(z.projMatrix,U,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),ae=r.paint.get("fill-emissive-strength");if(p){P=W.indexBuffer2,R=W.segments2;const se=i.terrain&&i.terrain.renderingToTexture?i.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];T=S==="fillOutlinePattern"&&b?xie(K,ae,i,U,se):bie(K,ae,se)}else P=W.indexBuffer,R=W.segments,T=b?E8(K,ae,i,U):A8(K,ae);i.uploadCommonUniforms(i.context,Y,z.toUnwrapped()),Y.draw(i,x,u,i.stencilModeForClipping(z),h,la.disabled,T,r.id,W.layoutVertexBuffer,P,R,r.paint,i.transform.zoom,j,void 0)}}function A3(i,t,r,l,u,h,p,g){const v=i.context,b=v.gl,x=i.transform,S=r.paint.get("fill-extrusion-pattern"),T=S.constantOr(1),P=r.paint.get("fill-extrusion-opacity"),R=i.style.enable3dLights(),z=r.paint.get(R&&!T?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),U=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),z],W=r.layout.get("fill-extrusion-edge-radius"),j=W>0&&!r.paint.get("fill-extrusion-rounded-roof"),Z=j?0:W,Y=x.projection.name==="globe"?rB():0,$=x.projection.name==="globe",K=$?mo(x.zoom):0,ae=[go(x.center.lng),Eo(x.center.lat)],se=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),de=r.paint.get("fill-extrusion-flood-light-intensity"),ge=r.paint.get("fill-extrusion-vertical-scale"),Te=mv(i,r.paint.get("fill-extrusion-cutoff-fade-range")),we=[];let Ie;$&&we.push("PROJECTION_GLOBE_VIEW"),U[0]>0&&we.push("FAUX_AO"),j&&we.push("ZERO_ROOF_RADIUS"),g&&we.push("HAS_CENTROID"),de>0&&we.push("FLOOD_LIGHT"),Te.shouldRenderCutoff&&we.push("RENDER_CUTOFF");const xe=i.renderPass==="shadow",We=i.shadowRenderer,qe=xe&&!!We;i.shadowRenderer&&(i.shadowRenderer.useNormalOffset=!0);let Qe=[0,0,0];if(We){const Ve=i.style.directionalLight,at=i.style.ambientLight;Ve&&at&&(Qe=l5(Ve,at)),Ie=we.concat(["SHADOWS_SINGLE_CASCADE"])}const Ne=qe?"fillExtrusionDepth":T?"fillExtrusionPattern":"fillExtrusion";for(const Ve of l){const at=t.getTile(Ve),mt=at.getBucket(r);if(!mt||mt.projection.name!==x.projection.name)continue;let lt=!1;We&&(lt=We.getMaxCascadeForTile(Ve.toUnwrapped())===0);const Ct=i.isTileAffectedByFog(Ve),zt=mt.programConfigurations.get(r.id),bt=i.getOrCreateProgram(Ne,{config:zt,defines:lt?Ie:we,overrideFog:Ct});if(i.terrain){const cn=i.terrain;i.style.terrainSetForDrapingOnly(),cn.setupElevationDraw(at,bt,{useMeterToDem:!0})}if(!mt.centroidVertexBuffer){const cn=bt.attributes.a_centroid_pos;cn!==void 0&&b.vertexAttrib2f(cn,0,0)}!xe&&We&&We.setupShadows(at.tileID.toUnwrapped(),bt,"vector-tile",at.tileID.overscaledZ),T&&(i.context.activeTexture.set(b.TEXTURE0),at.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),zt.updatePaintBuffers());const Et=S.constantOr(null);if(Et&&at.imageAtlas){const cn=at.imageAtlas.patternPositions[Et.toString()];cn&&zt.setConstantPatternPositions(cn)}const en=r.paint.get("fill-extrusion-vertical-gradient");let on;if(xe&&We){if(Nie(at.tileID,mt,i))continue;const cn=We.calculateShadowPassMatrixFromTile(at.tileID.toUnwrapped());on=vie(cn,Z,ge)}else{const cn=i.translatePosMatrix(Ve.projMatrix,at,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),gn=x.projection.createInversionMatrix(x,Ve.canonical);on=T?_ie(cn,i,en,P,U,Z,Ve,at,Y,K,ae,gn,se,ge):S8(cn,i,en,P,U,Z,Ve,Y,K,ae,gn,se,ge,de,Qe)}i.uploadCommonUniforms(v,bt,Ve.toUnwrapped(),null,Te);const rn=[];(i.terrain||g)&&rn.push(mt.centroidVertexBuffer),$&&rn.push(mt.layoutVertexExtBuffer),bt.draw(i,v.gl.TRIANGLES,u,h,p,la.backCCW,on,r.id,mt.layoutVertexBuffer,mt.indexBuffer,mt.segments,r.paint,i.transform.zoom,zt,rn)}i.shadowRenderer&&(i.shadowRenderer.useNormalOffset=!1)}function yv(i,t,r,l,u,h,p,g,v,b,x,S,T,P,R,z,U,W,j){const Z=i.context,Y=Z.gl,$=i.transform,K=i.transform.zoom,ae=[],se=mv(i,r.paint.get("fill-extrusion-cutoff-fade-range"));b==="clear"?(ae.push("CLEAR_SUBPASS"),j&&(ae.push("CLEAR_FROM_TEXTURE"),Z.activeTexture.set(Y.TEXTURE0),j.bind(Y.LINEAR,Y.CLAMP_TO_EDGE))):b==="sdf"&&ae.push("SDF_SUBPASS"),U&&ae.push("HAS_CENTROID"),se.shouldRenderCutoff&&ae.push("RENDER_CUTOFF");const de=r.layout.get("fill-extrusion-edge-radius"),ge=(Te,we,Ie,xe,We)=>{const qe=we.programConfigurations.get(r.id),Qe=i.isTileAffectedByFog(Te),Ne=i.getOrCreateProgram("fillExtrusionGroundEffect",{config:qe,defines:ae,overrideFog:Qe}),Ve=((mt,lt,Ct,zt,bt,Et,en,on,rn,cn,gn)=>({u_matrix:lt,u_opacity:Ct,u_ao_pass:zt?1:0,u_meter_to_tile:bt,u_ao:Et,u_flood_light_intensity:en,u_flood_light_color:on,u_attenuation:rn,u_edge_radius:cn,u_fb:0,u_fb_size:gn}))(0,xe,x,v,We,[S,T*We],P,R,z,K>=17?0:de*We,j?j.size[0]:0),at=[];U&&at.push(we.hiddenByLandmarkVertexBuffer),i.uploadCommonUniforms(Z,Ne,Te.toUnwrapped(),null,se),Ne.draw(i,Z.gl.TRIANGLES,u,h,p,g,Ve,r.id,we.vertexBuffer,we.indexBuffer,Ie,r.paint,K,qe,at)};for(const Te of l){const we=t.getTile(Te),Ie=we.getBucket(r);if(!Ie||Ie.projection.name!==$.projection.name||!Ie.groundEffect||Ie.groundEffect&&!Ie.groundEffect.hasData())continue;const xe=Ie.groundEffect,We=1/Ie.tileToMeter;{const qe=i.translatePosMatrix(Te.projMatrix,we,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Qe=xe.getDefaultSegment();ge(Te,xe,Qe,qe,We)}if(W)for(let qe=0;qe<4;qe++){const Qe=Rz[qe](Te),Ne=t.getTile(Qe);if(!Ne)continue;const Ve=Ne.getBucket(r);if(!Ve||Ve.projection.name!==$.projection.name||!Ve.groundEffect||Ve.groundEffect&&!Ve.groundEffect.hasData())continue;const at=Ve.groundEffect;let mt,lt;qe===0?(mt=[-dt,0,0],lt=1):qe===1?(mt=[dt,0,0],lt=0):qe===2?(mt=[0,-dt,0],lt=3):(mt=[0,dt,0],lt=2);const Ct=at.regionSegments[lt];if(!Ct)continue;const zt=new Float32Array(16);nt.translate(zt,Te.projMatrix,mt),ge(Te,at,Ct,i.translatePosMatrix(zt,we,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),We)}}}function Die(i,t,r,l,u,h,p){l.centroidVertexArray.length===0&&l.createCentroidsBuffer();const g=h?h.findDEMTileFor(r):null;if(!(g&&g.dem||p))return;const v=W=>{const j=t.getSource().minzoom,Z=$=>{const K=t.getTileByID($);if(K&&K.hasData())return K.getBucket(u)},Y=[0,-1,1];for(const $ of Y){if(W.overscaledZ+$<j)continue;const K=Z(W.calculateScaledKey(W.overscaledZ+$));if(K)return K}},b=[0,0,0],x=(W,j)=>(b[0]=Math.min(W.min.y,j.min.y),b[1]=Math.max(W.max.y,j.max.y),b[2]=dt-j.min.x>W.max.x?j.min.x-dt:W.max.x,b),S=(W,j)=>(b[0]=Math.min(W.min.x,j.min.x),b[1]=Math.max(W.max.x,j.max.x),b[2]=dt-j.min.y>W.max.y?j.min.y-dt:W.max.y,b),T=[(W,j)=>x(W,j),(W,j)=>x(j,W),(W,j)=>S(W,j),(W,j)=>S(j,W)],P=(W,j,Z,Y,$,K,ae)=>{if(!h)return 0;const se=[[K?Z:W,K?W:Z,0],[K?Z:j,K?j:Z,0]],de=ae<0?dt+ae:ae,ge=[K?de:(W+j)/2,K?(W+j)/2:de,0];return Z===0&&ae<0||Z!==0&&ae>0?h.getForTilePoints($,[ge],!0,Y):se.push(ge),h.getForTilePoints(r,se,!0,g),Math.max(se[0][2],se[1][2],ge[2])/h.exaggeration()};for(let W=0;W<4;W++){const j=l.borderFeatureIndices[W];if(j.length===0)continue;const Z=Rz[W](r),Y=v(Z);if(!(Y&&Y instanceof _1)||l.borderDoneWithNeighborZ[W]===Y.canonical.z)continue;Y.centroidVertexArray.length===0&&Y.createCentroidsBuffer();const $=h?h.findDEMTileFor(Z):null;if(!($&&$.dem||p))continue;const K=(W<2?1:5)-W,ae=Y.borderDoneWithNeighborZ[K]!==l.canonical.z,se=Y.borderFeatureIndices[K];let de=0;if(l.canonical.z!==Y.canonical.z){for(const ge of j)l.showCentroid(l.featuresOnBorder[ge]);if(ae)for(const ge of se)Y.showCentroid(Y.featuresOnBorder[ge]);l.borderDoneWithNeighborZ[W]=Y.canonical.z,Y.borderDoneWithNeighborZ[K]=l.canonical.z}for(const ge of j){const Te=l.featuresOnBorder[ge],we=l.centroidData[Te.centroidDataIndex],Ie=Te.borders[W];let xe;for(;de<se.length;){xe=Y.featuresOnBorder[se[de]];const We=xe.borders[K];if(We[1]>Ie[0]+3||We[0]>Ie[0]-3)break;Y.showCentroid(xe),de++}if(xe&&de<se.length){const We=de;let qe=0;for(;!(xe.borders[K][0]>Ie[1]-3)&&(qe++,++de!==se.length);)xe=Y.featuresOnBorder[se[de]];if(xe=Y.featuresOnBorder[se[We]],qe>1){const Ve=xe.borders[K];Math.abs(Ie[0]-Ve[0])<3&&Math.abs(Ie[1]-Ve[1])<3&&(qe=1,de=We+1)}else if(qe===0){l.showCentroid(Te);continue}const Qe=Y.centroidData[xe.centroidDataIndex];p&&qe===1&&(((z=we).flags|(U=Qe).flags)&ju?(z.flags|=ju,U.flags|=ju):(z.flags&=2147483647,U.flags&=2147483647));let Ne=new V(0,0);if(qe>1)de=We;else if($&&$.dem&&!(Te.intersectsCount()>1||xe.intersectsCount()>1)){const Ve=T[W](we,Qe),at=W%2?dt-1:0;R=P(Ve[0],Math.min(dt-1,Ve[1]),at,$,Z,W<2,Ve[2]),Ne=new V(Math.ceil(7*(R+450)),0)}we.centroidXY=Qe.centroidXY=Ne,l.writeCentroidToBuffer(we),Y.writeCentroidToBuffer(Qe)}else l.showCentroid(Te)}l.borderDoneWithNeighborZ[W]=Y.canonical.z,Y.borderDoneWithNeighborZ[K]=l.canonical.z}var R,z,U;(l.needsCentroidUpdate||!l.centroidVertexBuffer&&l.centroidVertexArray.length!==0)&&l.uploadCentroid(i)}const Oie=[1,0,0],zie=[0,1,0],Fie=[0,0,1];function Nie(i,t,r){const l=r.transform,u=r.shadowRenderer;if(!u)return!0;const h=i.toUnwrapped(),p=l.tileSize*u._cascades[r.currentShadowCascade].scale;let g=t.maxHeight;if(l.elevation){const z=l.elevation.getMinMaxForTile(i);z&&(g+=z.max)}const v=[...u.shadowDirection];v[2]=-v[2];const b=u.computeSimplifiedTileShadowVolume(h,g,p,v);if(!b)return!1;const x=[Oie,zie,Fie,v,[v[0],0,v[2]],[0,v[1],v[2]]],S=l.projection.name==="globe",T=l.scaleZoom(p),P=Yd.fromInvProjectionMatrix(l.invProjMatrix,l.worldSize,T,!S),R=u.getCurrentCascadeFrustum();return P.intersectsPrecise(b.vertices,b.planes,x)===0||R.intersectsPrecise(b.vertices,b.planes,x)===0}const Bie=new xn(1,0,0,1),Uie=new xn(0,1,0,1),Wie=new xn(0,0,1,1),Vie=new xn(1,0,1,1),Gie=new xn(0,1,1,1);function Hie(i,t,r){const l=i.context,u=i.transform,h=l.gl,p=u.projection.name==="globe",g=p?["PROJECTION_GLOBE_VIEW"]:[];let v=r.projMatrix;if(p&&mo(u.zoom)>0){const ge=BC(Fz(r.canonical,u));v=nt.multiply(new Float32Array(16),u.globeMatrix,ge),nt.multiply(v,u.projMatrix,v)}const b=i.getOrCreateProgram("debug",{defines:g}),x=t.getTileByID(r.key);i.terrain&&i.terrain.setupElevationDraw(x,b);const S=zn.disabled,T=oa.disabled,P=i.colorModeForRenderPass(),R="$debug";l.activeTexture.set(h.TEXTURE0),i.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),p?x._makeGlobeTileDebugBuffers(i.context,u):x._makeDebugTileBoundsBuffers(i.context,u.projection);const z=x._tileDebugBuffer||i.debugBuffer,U=x._tileDebugIndexBuffer||i.debugIndexBuffer,W=x._tileDebugSegments||i.debugSegments;b.draw(i,h.LINE_STRIP,S,T,P,la.disabled,M8(v,xn.red),R,z,U,W,null,null,null,[x._globeTileDebugBorderBuffer]);const j=x.latestRawTileData,Z=Math.floor((j&&j.byteLength||0)/1024),Y=t.getTile(r).tileSize,$=512/Math.min(Y,512)*(r.overscaledZ/u.zoom)*.5;let K=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(K+=` => ${r.overscaledZ}`),K+=` ${Z}kb`,function(ge,Te){ge.initDebugOverlayCanvas();const we=ge.debugOverlayCanvas,Ie=ge.context.gl,xe=ge.debugOverlayCanvas.getContext("2d");xe.clearRect(0,0,we.width,we.height),xe.shadowColor="white",xe.shadowBlur=2,xe.lineWidth=1.5,xe.strokeStyle="white",xe.textBaseline="top",xe.font="bold 36px Open Sans, sans-serif",xe.fillText(Te,5,5),xe.strokeText(Te,5,5),ge.debugOverlayTexture.update(we),ge.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(i,K);const ae=x._tileDebugTextBuffer||i.debugBuffer,se=x._tileDebugTextIndexBuffer||i.quadTriangleIndexBuffer,de=x._tileDebugTextSegments||i.debugSegments;b.draw(i,h.TRIANGLES,S,T,Aa.alphaBlended,la.disabled,M8(v,xn.transparent,$),R,ae,se,de,null,null,null,[x._globeTileDebugTextBuffer])}function F8(i,t,r,l){E3(i,0,t+r/2,i.transform.width,r,l)}function N8(i,t,r,l){E3(i,t-r/2,0,r,i.transform.height,l)}function E3(i,t,r,l,u,h){const p=i.context,g=p.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Cn.devicePixelRatio,r*Cn.devicePixelRatio,l*Cn.devicePixelRatio,u*Cn.devicePixelRatio),p.clear({color:h}),g.disable(g.SCISSOR_TEST)}const jie=N([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:$ie}=jie;function Cf(i,t,r,l){i.emplaceBack(t,r,l)}class B8{constructor(t){this.vertexArray=new Dn,this.indices=new Nn,Cf(this.vertexArray,-1,-1,1),Cf(this.vertexArray,1,-1,1),Cf(this.vertexArray,-1,1,1),Cf(this.vertexArray,1,1,1),Cf(this.vertexArray,-1,-1,-1),Cf(this.vertexArray,1,-1,-1),Cf(this.vertexArray,-1,1,-1),Cf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,$ie),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=Ha.simpleSegment(0,0,36,12)}}function vv(i,t,r,l,u,h){const p=i.context.gl,g=t.paint.get("sky-atmosphere-color"),v=t.paint.get("sky-atmosphere-halo-color"),b=t.paint.get("sky-atmosphere-sun-intensity"),x=((S,T,P,R,z)=>({u_matrix_3f:S,u_sun_direction:T,u_sun_intensity:P,u_color_tint_r:[R.r,R.g,R.b,R.a],u_color_tint_m:[z.r,z.g,z.b,z.a],u_luminance:5e-5}))(Rs.fromMat4(Rs.create(),l),u,b,g,v);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+h,t.skyboxTexture,0),r.draw(i,p.TRIANGLES,zn.disabled,oa.disabled,Aa.unblended,la.frontCW,x,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const qie=N([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Xie{constructor(t){const r=new Ua;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const l=new Nn;l.emplaceBack(0,1,2),l.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,qie.members),this.indexBuffer=t.createIndexBuffer(l),this.segments=Ha.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Zie=N([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Yie{constructor(){this.colorModeAlphaBlendedWriteRGB=new Aa([1,n3,1,n3],xn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Aa([1,0,1,0],xn.transparent,[!1,!1,!1,!0])}update(t){const r=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new Xie(r);const l=100,u=200,h=function(x){const S=vy(30),T=[];for(let P=0;P<16e3;++P){const R=2*Math.PI*S(),z=Math.acos(1-2*S())-.5*Math.PI;T.push(ke.fromValues(Math.cos(z)*Math.cos(R),Math.cos(z)*Math.sin(R),Math.sin(z)))}return T}(),p=vy(300),g=new sc,v=new Nn;let b=0;for(let x=0;x<h.length;++x){const S=ke.scale([],h[x],200),T=Math.max(0,1+.01*l*(1*p()-.5)),P=Math.max(0,1+.01*u*(1*p()-.5));g.emplaceBack(S[0],S[1],S[2],-1,-1,T,P),g.emplaceBack(S[0],S[1],S[2],1,-1,T,P),g.emplaceBack(S[0],S[1],S[2],1,1,T,P),g.emplaceBack(S[0],S[1],S[2],-1,1,T,P),v.emplaceBack(b+0,b+1,b+2),v.emplaceBack(b+0,b+2,b+3),b+=4}this.starsVx=r.createVertexBuffer(g,Zie.members),this.starsIdx=r.createIndexBuffer(v),this.starsSegments=Ha.simpleSegment(0,0,g.length,v.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,r){const l=t.context,u=l.gl,h=t.transform,p=new zn(u.LEQUAL,zn.ReadOnly,[0,1]),g=mo(h.zoom),v=r.properties.get("color").toArray01(),b=r.properties.get("high-color").toArray01(),x=r.properties.get("space-color").toArray01PremultipliedAlpha(),S=5e-4,T=ne((r.properties.get("horizon-blend")-0)/1*.2495+S,5e-4,.25),P=Gz(t,l,h)&&T===S?h.worldSize/(2*Math.PI*1.025)-1:h.globeRadius,R=t.frameCounter/1e3%1,z=ke.length(h.globeCenterInViewSpace),U=Math.sqrt(Math.pow(z,2)-Math.pow(P,2)),W=Math.acos(U/z),j=Z=>{const Y=h.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Z&&Y.push("ALPHA_PASS");const $=t.getOrCreateProgram("globeAtmosphere",{defines:Y}),K=((se,de,ge,Te,we,Ie,xe,We,qe,Qe,Ne,Ve)=>({u_frustum_tl:se,u_frustum_tr:de,u_frustum_br:ge,u_frustum_bl:Te,u_horizon:we,u_transition:Ie,u_fadeout_range:xe,u_color:We,u_high_color:qe,u_space_color:Qe,u_temporal_offset:Ne,u_horizon_angle:Ve}))(h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.frustumCorners.horizon,g,T,v,b,x,R,W);t.uploadCommonUniforms(l,$);const ae=this.atmosphereBuffer;ae&&$.draw(t,u.TRIANGLES,p,oa.disabled,Z?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,la.backCW,K,Z?"atmosphere_glow_alpha":"atmosphere_glow",ae.vertexBuffer,ae.indexBuffer,ae.segments)};j(!1),j(!0)}drawStars(t,r){const l=ne(r.properties.get("star-intensity"),0,1);if(l===0)return;const u=t.context,h=u.gl,p=t.transform,g=t.getOrCreateProgram("stars"),v=Ao.identity([]);Ao.rotateX(v,v,-p._pitch),Ao.rotateZ(v,v,-p.angle),Ao.rotateX(v,v,be(p._center.lat)),Ao.rotateY(v,v,-be(p._center.lng));const b=nt.fromQuat(new Float32Array(16),v),x=nt.multiply([],p.starsProjMatrix,b),S=Rs.fromMat4([],b),T=Rs.invert([],S),P=[0,1,0];ke.transformMat3(P,P,T),ke.scale(P,P,.15);const R=[1,0,0];ke.transformMat3(R,R,T),ke.scale(R,R,.15);const z=((U,W,j,Z)=>({u_matrix:Float32Array.from(U),u_up:W,u_right:j,u_intensity_multiplier:Z}))(x,P,R,l);t.uploadCommonUniforms(u,g),this.starsVx&&this.starsIdx&&g.draw(t,h.TRIANGLES,zn.disabled,oa.disabled,this.colorModeAlphaBlendedWriteRGB,la.disabled,z,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function U8(i,t){const r=[...i],l=t.cameraWorldSizeForFog/t.worldSize,u=nt.identity([]);return nt.scale(u,u,[l,l,1]),nt.multiply(r,u,r),nt.multiply(r,t.worldToFogMatrix,r),r}function o5(i,t,r,l){const u=r.material,h=l.context,{baseColorTexture:p,metallicRoughnessTexture:g}=u.pbrMetallicRoughness,{normalTexture:v,occlusionTexture:b,emissionTexture:x}=u;function S(T,P,R){if(T&&(i.push(P),h.activeTexture.set(h.gl.TEXTURE0+R),T.gfxTexture)){const{minFilter:z,magFilter:U,wrapS:W,wrapT:j}=T.sampler;T.gfxTexture.bindExtraParam(z,U,W,j)}}S(p,"HAS_TEXTURE_u_baseColorTexture",rl.BaseColor),S(g,"HAS_TEXTURE_u_metallicRoughnessTexture",rl.MetallicRoughness),S(v,"HAS_TEXTURE_u_normalTexture",rl.Normal),S(b,"HAS_TEXTURE_u_occlusionTexture",rl.Occlusion),S(x,"HAS_TEXTURE_u_emissionTexture",rl.Emission),r.texcoordBuffer&&(i.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(r.texcoordBuffer)),r.colorBuffer&&(i.push(r.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(r.colorBuffer)),r.normalBuffer&&(i.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(r.normalBuffer)),r.pbrBuffer&&(i.push("HAS_ATTRIBUTE_a_pbr"),i.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(r.pbrBuffer)),u.alphaMode!=="OPAQUE"&&u.alphaMode!=="MASK"||i.push("UNPREMULT_TEXTURE_IN_SHADER"),u.defined||i.push("DIFFUSE_SHADED"),i.push("USE_STANDARD_DERIVATIVES")}function M3(i,t,r,l,u,h){const p=r.paint.get("model-opacity"),g=t.context,v=new zn(t.context.gl.LEQUAL,zn.ReadWrite,t.depthRangeFor3D),b=t.transform,x=i.mesh,S=x.material,T=S.pbrMetallicRoughness,P=t.style.fog;let R;R=t.transform.projection.zAxisUnit==="pixels"?[...i.nodeModelMatrix]:nt.multiply([],l.zScaleMatrix,i.nodeModelMatrix),nt.multiply(R,l.negCameraPosMatrix,R);const z=nt.invert([],R);nt.transpose(z,z);const U=i5(new Float32Array(i.worldViewProjection),new Float32Array(R),new Float32Array(z),t,p,T.baseColorFactor,S.emissiveFactor,T.metallicFactor,T.roughnessFactor,S,r),W={defines:[]},j=[];o5(W.defines,j,x,t);const Z=t.shadowRenderer;Z&&(Z.useNormalOffset=!1);let Y=null;if(P){const ae=U8(i.nodeModelMatrix,t.transform);if(Y=new Float32Array(ae),b.projection.name!=="globe"){const se=x.aabb.min,de=x.aabb.max,[ge,Te]=P.getOpacityForBounds(ae,se[0],se[1],de[0],de[1]);W.overrideFog=ge>=Am||Te>=Am}}const $=mv(t,r.paint.get("model-cutoff-fade-range"));$.shouldRenderCutoff&&W.defines.push("RENDER_CUTOFF");const K=t.getOrCreateProgram("model",W);t.uploadCommonUniforms(g,K,null,Y,$),t.renderPass!=="shadow"&&Z&&Z.setupShadowsFromMatrix(i.nodeModelMatrix,K),K.draw(t,g.gl.TRIANGLES,v,u,h,x.material.doubleSided?la.disabled:la.backCCW,U,r.id,x.vertexBuffer,x.indexBuffer,x.segments,r.paint,t.transform.zoom,void 0,j)}function W8(i,t,r,l,u,h,p){let g;g=i.projection.name==="globe"?DN(r,i):[...r],nt.multiply(g,g,t.matrix);const v=nt.multiply([],l,g);if(t.meshes)for(const b of t.meshes){if(b.material.alphaMode!=="BLEND"){p.push({mesh:b,depth:0,modelIndex:u,worldViewProjection:v,nodeModelMatrix:g});continue}const x=ke.transformMat4([],b.centroid,v);x[2]>0&&h.push({mesh:b,depth:x[2],modelIndex:u,worldViewProjection:v,nodeModelMatrix:g})}if(t.children)for(const b of t.children)W8(i,b,r,l,u,h,p)}function s5(i,t,r,l){const u=r.shadowRenderer;if(!u)return;const h=u.getShadowPassDepthMode(),p=u.getShadowPassColorMode(),g=u.calculateShadowPassMatrixFromMatrix(t),v=R8(g);r.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(r,r.context.gl.TRIANGLES,h,oa.disabled,p,la.backCCW,v,l.id,i.vertexBuffer,i.indexBuffer,i.segments,l.paint,r.transform.zoom,void 0,void 0)}function Kie(i,t,r){const l=t.updateZoomBasedPaintProperties(),u=function(h,p,g){let v,b,x,S=h.terrain?h.terrain.exaggeration():0;if(h.terrain&&S>0){const T=h.terrain,P=T.findDEMTileFor(g);P&&P.dem?v=iv.create(T,g,P):S=0}if(S===0&&(p.terrainElevationMin=0,p.terrainElevationMax=0),S===p.validForExaggeration&&(S===0||v&&v._demTile&&v._demTile.tileID===p.validForDEMTile.id&&v._dem._timestamp===p.validForDEMTile.timestamp))return!1;for(const T in p.instancesPerModel){const P=p.instancesPerModel[T];for(let R=0;R<P.instancedDataArray.length;++R){const z=(v?S*v.getElevationAt(0|P.instancedDataArray.float32[16*R],0|P.instancedDataArray.float32[16*R+1],!0,!0):0)+P.instancesEvaluatedElevation[R];P.instancedDataArray.float32[16*R+6]=z,b=b?Math.min(p.terrainElevationMin,z):z,x=x?Math.max(p.terrainElevationMax,z):z}}return p.terrainElevationMin=b||0,p.terrainElevationMax=x||0,p.validForExaggeration=S,p.validForDEMTile=v&&v._demTile?{id:v._demTile.tileID,timestamp:v._dem._timestamp}:{id:void 0,timestamp:0},!0}(i,t,r);(l||u)&&(t.uploaded=!1,t.upload(i.context))}const Xu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new di([0,0,0],[dt,dt,0])};function Jie(i,t){const r=1<<i.canonical.z,l=t.getFreeCameraOptions().position,u=t.elevation,h=i.canonical.x/r,p=(i.canonical.x+1)/r,g=i.canonical.y/r,v=(i.canonical.y+1)/r;let b=t._centerAltitude;if(u){const P=u.getMinMaxForTile(i);P&&P.max>b&&(b=P.max)}const x=ne(l.x,h,p)-l.x,S=ne(l.y,g,v)-l.y,T=ja(b,t.center.lat)-l.z;return t._zoomFromMercatorZ(Math.sqrt(x*x+S*S+T*T))}function V8(i,t,r,l,u,h,p){const g=i.context,v=i.renderPass==="shadow",b=i.shadowRenderer,x=v&&b?b.getShadowPassDepthMode():new zn(g.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D),S=i.isTileAffectedByFog(h);if(r.meshes)for(const T of r.meshes){const P=["MODEL_POSITION_ON_GPU"],R=[];let z,U,W;l.instancedDataArray.length>20&&P.push("INSTANCED_ARRAYS");const j=mv(i,t.paint.get("model-cutoff-fade-range"));if(j.shouldRenderCutoff&&P.push("RENDER_CUTOFF"),v&&b)z=i.getOrCreateProgram("modelDepth",{defines:P}),U=R8(p.shadowTileMatrix,p.shadowTileMatrix,Float32Array.from(r.matrix)),W=b.getShadowPassColorMode();else{o5(P,R,T,i),z=i.getOrCreateProgram("model",{defines:P,overrideFog:S});const Y=T.material,$=Y.pbrMetallicRoughness,K=t.paint.get("model-opacity");U=i5(h.projMatrix,Float32Array.from(r.matrix),new Float32Array(16),i,K,$.baseColorFactor,Y.emissiveFactor,$.metallicFactor,$.roughnessFactor,Y,t,u),b&&(p.shadowUniformsInitialized?z.setShadowUniformValues(g,b.getShadowUniformValues()):(b.setupShadows(h.toUnwrapped(),z,"model-tile",h.overscaledZ),p.shadowUniformsInitialized=!0)),W=j.shouldRenderCutoff||K<1||Y.alphaMode!=="OPAQUE"?Aa.alphaBlended:Aa.unblended}i.uploadCommonUniforms(g,z,h.toUnwrapped(),null,j);const Z=T.material.doubleSided?la.disabled:la.backCCW;if(l.instancedDataArray.length>20)R.push(l.instancedDataBuffer),z.draw(i,g.gl.TRIANGLES,x,oa.disabled,W,Z,U,t.id,T.vertexBuffer,T.indexBuffer,T.segments,t.paint,i.transform.zoom,void 0,R,l.instancedDataArray.length);else{const Y=v?"u_instance":"u_normal_matrix";for(let $=0;$<l.instancedDataArray.length;++$)U[Y]=new Float32Array(l.instancedDataArray.arrayBuffer,64*$,16),z.draw(i,g.gl.TRIANGLES,x,oa.disabled,W,Z,U,t.id,T.vertexBuffer,T.indexBuffer,T.segments,t.paint,i.transform.zoom,void 0,R)}}if(r.children)for(const T of r.children)V8(i,t,T,l,u,h,p)}const Qie=[1,-1,1];function ere(i,t,r,l){if(!r.modelManager)return!0;const u=r.modelManager;if(!r.shadowRenderer)return!0;const h=r.shadowRenderer,p=t.aabb;let g=!0,v=i.maxHeight;if(v===0){let x=0;for(const S in i.instancesPerModel){const T=u.getModel(S,l);T?x=Math.max(x,Math.max(Math.max(T.aabb.max[0],T.aabb.max[1]),T.aabb.max[2])):g=!1}v=i.maxScale*x*1.41+i.maxVerticalOffset,g&&(i.maxHeight=v)}p.max[2]=v,p.min[2]+=i.terrainElevationMin,p.max[2]+=i.terrainElevationMax,ke.transformMat4(p.min,p.min,t.tileMatrix),ke.transformMat4(p.max,p.max,t.tileMatrix);const b=p.intersects(h.getCurrentCascadeFrustum());return r.currentShadowCascade===0&&(i.isInsideFirstShadowMapFrustum=b===2),b===0}class tre{}class nre{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,r,l){{const S=this._storage.get(r.id);if(S)return S.lastUsedFrameIdx=t,S.buf}const u=l.gl,h=u.getBufferParameter(u.ELEMENT_ARRAY_BUFFER,u.BUFFER_SIZE),p=new ArrayBuffer(h),g=new Int16Array(p);u.getBufferSubData(u.ELEMENT_ARRAY_BUFFER,0,new Int16Array(p));const v=new Jr;for(let S=0;S<h/2;S+=3){const T=g[S],P=g[S+1],R=g[S+2];v.emplaceBack(T,P),v.emplaceBack(P,R),v.emplaceBack(R,T)}const b=l.bindVertexArrayOES.current,x=new tre;return x.buf=new Ef(l,v),x.lastUsedFrameIdx=t,this._storage.set(r.id,x),l.bindVertexArrayOES.set(b),x.buf}update(t){for(const[r,l]of this._storage)t-l.lastUsedFrameIdx>30&&(l.buf.destroy(),this._storage.delete(r))}destroy(){for(const[t,r]of this._storage)r.buf.destroy(),this._storage.delete(t)}}const G8={symbol:function(i,t,r,l,u){if(i.renderPass!=="translucent")return;const h=oa.disabled,p=i.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(g,v,b,x,S,T,P){const R=v.transform,z=S==="map",U=T==="map";for(const W of g){const j=x.getTile(W),Z=j.getBucket(b);if(!Z||!Z.text||!Z.text.segments.get().length)continue;const Y=Vu(Z.textSizeData,R.zoom),$=KP(W,Z.getProjection(),R),K=R.calculatePixelsToTileUnitsMatrix(j),ae=i3($,j.tileID.canonical,U,z,R,Z.getProjection(),K),se=Z.hasIconTextFit()&&Z.hasIconData();if(Y){const de=Math.pow(2,R.zoom-j.tileID.overscaledZ);Rie(Z,z,U,P,tte,R,ae,W,de,Y,se)}}}(l,i,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),u),r.paint.get("icon-opacity").constantOr(1)!==0&&O8(i,t,r,l,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),h,p),r.paint.get("text-opacity").constantOr(1)!==0&&O8(i,t,r,l,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),h,p),t.map.showCollisionBoxes&&(k8(i,t,r,l,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),k8(i,t,r,l,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(i,t,r,l){if(i.renderPass!=="translucent")return;const u=r.paint.get("circle-opacity"),h=r.paint.get("circle-stroke-width"),p=r.paint.get("circle-stroke-opacity"),g=r.layout.get("circle-sort-key").constantOr(1)!==void 0,v=r.paint.get("circle-emissive-strength");if(u.constantOr(1)===0&&(h.constantOr(1)===0||p.constantOr(1)===0))return;const b=i.context,x=b.gl,S=i.transform,T=i.depthModeForSublayer(0,zn.ReadOnly),P=oa.disabled,R=i.colorModeForDrapableLayerRenderPass(v),z=S.projection.name==="globe",U=[go(S.center.lng),Eo(S.center.lat)],W=[];for(let Z=0;Z<l.length;Z++){const Y=l[Z],$=t.getTile(Y),K=$.getBucket(r);if(!K||K.projection.name!==S.projection.name)continue;const ae=K.programConfigurations.get(r.id),se=iF(r),de=i.isTileAffectedByFog(Y);z&&se.push("PROJECTION_GLOBE_VIEW");const ge=i.getOrCreateProgram("circle",{config:ae,defines:se,overrideFog:de}),Te=K.layoutVertexBuffer,we=K.globeExtVertexBuffer,Ie=K.indexBuffer,xe=S.projection.createInversionMatrix(S,Y.canonical),We={programConfiguration:ae,program:ge,layoutVertexBuffer:Te,globeExtVertexBuffer:we,indexBuffer:Ie,uniformValues:JQ(i,Y,$,xe,U,r),tile:$};if(g){const qe=K.segments.get();for(const Qe of qe)W.push({segments:new Ha([Qe]),sortKey:Qe.sortKey,state:We})}else W.push({segments:K.segments,sortKey:0,state:We})}g&&W.sort((Z,Y)=>Z.sortKey-Y.sortKey);const j={useDepthForOcclusion:!z};for(const Z of W){const{programConfiguration:Y,program:$,layoutVertexBuffer:K,globeExtVertexBuffer:ae,indexBuffer:se,uniformValues:de,tile:ge}=Z.state,Te=Z.segments;i.terrain&&i.terrain.setupElevationDraw(ge,$,j),i.uploadCommonUniforms(b,$,ge.tileID.toUnwrapped()),$.draw(i,x.TRIANGLES,T,P,R,la.disabled,de,r.id,K,se,Te,r.paint,S.zoom,Y,[ae])}},heatmap:function(i,t,r,l){if(r.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){const u=i.context,h=u.gl,p=oa.disabled,g=new Aa([h.ONE,h.ONE,h.ONE,h.ONE],xn.transparent,[!0,!0,!0,!0]);(function(P,R,z,U){const W=P.gl,j=R.width*U,Z=R.height*U;P.activeTexture.set(W.TEXTURE1),P.viewport.set([0,0,j,Z]);let Y=z.heatmapFbo;if(!Y||Y&&(Y.width!==j||Y.height!==Z)){Y&&Y.destroy();const $=W.createTexture();W.bindTexture(W.TEXTURE_2D,$),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),Y=z.heatmapFbo=P.createFramebuffer(j,Z,!0,null),function(K,ae,se,de,ge,Te){const we=K.gl;we.texImage2D(we.TEXTURE_2D,0,K.extRenderToTextureHalfFloat?we.RGBA16F:we.RGBA,ge,Te,0,we.RGBA,K.extRenderToTextureHalfFloat?we.HALF_FLOAT:we.UNSIGNED_BYTE,null),de.colorAttachment.set(se)}(P,0,$,Y,j,Z)}else W.bindTexture(W.TEXTURE_2D,Y.colorAttachment.get()),P.bindFramebuffer.set(Y.framebuffer)})(u,i,r,i.transform.projection.name==="globe"?.5:.25),u.clear({color:xn.transparent});const v=i.transform,b=v.projection.name==="globe",x=b?["PROJECTION_GLOBE_VIEW"]:[],S=b?la.frontCCW:la.disabled,T=[go(v.center.lng),Eo(v.center.lat)];for(let P=0;P<l.length;P++){const R=l[P];if(t.hasRenderableParent(R))continue;const z=t.getTile(R),U=z.getBucket(r);if(!U||U.projection.name!==v.projection.name)continue;const W=i.isTileAffectedByFog(R),j=U.programConfigurations.get(r.id),Z=i.getOrCreateProgram("heatmap",{config:j,defines:x,overrideFog:W}),{zoom:Y}=i.transform;i.terrain&&i.terrain.setupElevationDraw(z,Z),i.uploadCommonUniforms(u,Z,R.toUnwrapped());const $=v.projection.createInversionMatrix(v,R.canonical);Z.draw(i,h.TRIANGLES,zn.disabled,p,g,S,Aie(i,R,z,$,T,Y,r.paint.get("heatmap-intensity")),r.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,r.paint,i.transform.zoom,j,b?[U.globeExtVertexBuffer]:null)}u.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(u,h){const p=u.context,g=p.gl,v=h.heatmapFbo;if(!v)return;p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,v.colorAttachment.get()),p.activeTexture.set(g.TEXTURE1);let b=h.colorRampTexture;b||(b=h.colorRampTexture=new mr(p,h.colorRamp,g.RGBA)),b.bind(g.LINEAR,g.CLAMP_TO_EDGE),u.getOrCreateProgram("heatmapTexture").draw(u,g.TRIANGLES,zn.disabled,oa.disabled,u.colorModeForRenderPass(),la.disabled,((x,S,T,P)=>({u_image:0,u_color_ramp:1,u_opacity:S.paint.get("heatmap-opacity")}))(0,h),h.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments,h.paint,u.transform.zoom)}(i,r))},line:function(i,t,r,l){if(i.renderPass!=="translucent")return;const u=r.paint.get("line-opacity"),h=r.paint.get("line-width");if(u.constantOr(1)===0||h.constantOr(1)===0)return;const p=r.paint.get("line-emissive-strength"),g=i.depthModeForSublayer(0,zn.ReadOnly),v=i.colorModeForDrapableLayerRenderPass(p),b=i.terrain&&i.terrain.renderingToTexture?1:Cn.devicePixelRatio,x=r.paint.get("line-dasharray"),S=x.constantOr(1),T=r.layout.get("line-cap"),P=r.paint.get("line-pattern"),R=P.constantOr(1),z=r.paint.get("line-pattern").constantOr(1),U=r.paint.get("line-opacity").constantOr(1)!==1;let W=!z&&U;const j=r.paint.get("line-gradient"),Z=R?"linePattern":"line",Y=i.context,$=Y.gl,K=hB(r);i.terrain&&i.terrain.clipOrMaskOverlapStencilType()&&(W=!1);for(const ae of l){const se=t.getTile(ae);if(R&&!se.patternsLoaded())continue;const de=se.getBucket(r);if(!de)continue;i.prepareDrawTile();const ge=de.programConfigurations.get(r.id),Te=i.isTileAffectedByFog(ae),we=i.getOrCreateProgram(Z,{config:ge,defines:K,overrideFog:Te}),Ie=P.constantOr(null);if(Ie&&se.imageAtlas){const mt=se.imageAtlas.patternPositions[Ie.toString()];mt&&ge.setConstantPatternPositions(mt)}const xe=x.constantOr(null),We=T.constantOr(null);if(!R&&xe&&We&&se.lineAtlas){const mt=se.lineAtlas.getDash(xe,We);mt&&ge.setConstantPatternPositions(mt)}let[qe,Qe]=r.paint.get("line-trim-offset");(We==="round"||We==="square")&&qe!==Qe&&(qe===0&&(qe-=1),Qe===1&&(Qe+=1));const Ne=i.terrain?ae.projMatrix:null,Ve=R?eae(i,se,r,Ne,b):Qne(i,se,r,Ne,de.lineClipsArray.length,b,[qe,Qe]);if(j){const mt=de.gradients[r.id];let lt=mt.texture;if(r.gradientVersion!==mt.version){let Ct=256;if(r.stepInterpolant){const zt=t.getSource().maxzoom,bt=ae.canonical.z===zt?Math.ceil(1<<i.transform.maxZoom-ae.canonical.z):1;Ct=ne(Pt(de.maxLineLength/dt*1024*bt),256,Y.maxTextureSize)}mt.gradient=E2({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:Ct,image:mt.gradient||void 0,clips:de.lineClipsArray}),mt.texture?mt.texture.update(mt.gradient):mt.texture=new mr(Y,mt.gradient,$.RGBA),mt.version=r.gradientVersion,lt=mt.texture}Y.activeTexture.set($.TEXTURE1),lt.bind(r.stepInterpolant?$.NEAREST:$.LINEAR,$.CLAMP_TO_EDGE)}S&&(Y.activeTexture.set($.TEXTURE0),se.lineAtlasTexture.bind($.LINEAR,$.REPEAT),ge.updatePaintBuffers()),R&&(Y.activeTexture.set($.TEXTURE0),se.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ge.updatePaintBuffers()),i.uploadCommonUniforms(Y,we,ae.toUnwrapped());const at=mt=>{we.draw(i,$.TRIANGLES,g,mt,v,la.disabled,Ve,r.id,de.layoutVertexBuffer,de.indexBuffer,de.segments,r.paint,i.transform.zoom,ge,[de.layoutVertexBuffer2])};if(W){const mt=i.stencilModeForClipping(ae).ref;mt===0&&i.terrain&&Y.clear({stencil:0});const lt={func:$.EQUAL,mask:255};Ve.u_alpha_discard_threshold=.8,at(new oa(lt,mt,255,$.KEEP,$.KEEP,$.INVERT)),Ve.u_alpha_discard_threshold=0,at(new oa(lt,mt,255,$.KEEP,$.KEEP,$.KEEP))}else at(i.stencilModeForClipping(ae))}W&&(i.resetStencilClippingMasks(),i.terrain&&Y.clear({stencil:0}))},fill:function(i,t,r,l){const u=r.paint.get("fill-color"),h=r.paint.get("fill-opacity");if(h.constantOr(1)===0)return;const p=r.paint.get("fill-emissive-strength"),g=i.colorModeForDrapableLayerRenderPass(p),v=r.paint.get("fill-pattern"),b=i.opaquePassEnabledForLayer()&&!v.constantOr(1)&&u.constantOr(xn.transparent).a===1&&h.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===b){const x=i.depthModeForSublayer(1,i.renderPass==="opaque"?zn.ReadWrite:zn.ReadOnly);z8(i,t,r,l,x,g,!1)}if(i.renderPass==="translucent"&&r.paint.get("fill-antialias")){const x=i.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,zn.ReadOnly);z8(i,t,r,l,x,g,!0)}},"fill-extrusion":function(i,t,r,l){const u=r.paint.get("fill-extrusion-opacity"),h=i.context,p=h.gl,g=i.terrain,v=g&&g.renderingToTexture,b=r.paint.get("fill-extrusion-cutoff-fade-range");if(u===0)return;const x=i.conflationActive&&i.layerUsedInConflation(r,t.getSource());if(x&&function(S,T,P,R){for(const z of R){const U=T.getTile(z).getBucket(P);U&&(U.updateReplacement(z,S.replacementSource),U.uploadCentroid(S.context))}}(i,t,r,l),g||x)for(const S of l){const T=t.getTile(S).getBucket(r);T&&Die(i.context,t,S,T,r,g,x)}if(i.renderPass==="shadow"&&i.shadowRenderer){const S=i.shadowRenderer;if(g&&u<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Dc)return;const T=S.getShadowPassDepthMode(),P=S.getShadowPassColorMode();A3(i,t,r,l,T,oa.disabled,P,x)}else if(i.renderPass==="translucent"){const S=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!v){const T=new zn(i.context.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D);b===0&&u===1&&S?A3(i,t,r,l,T,oa.disabled,Aa.unblended,x):(A3(i,t,r,l,T,oa.disabled,Aa.disabled,x),A3(i,t,r,l,T,i.stencilModeFor3D(),i.colorModeForRenderPass(),x),i.resetStencilClippingMasks())}if(i.style.enable3dLights()&&S&&(!g&&i.transform.projection.name!=="globe"||v)){const T=r.paint.get("fill-extrusion-opacity"),P=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),R=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),z=r.paint.get("fill-extrusion-flood-light-intensity"),U=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),W=P>0&&R>0,j=z>0,Z=($,K,ae)=>(1-ae)*$+ae*K,Y=$=>{const K=i.depthModeForSublayer(1,zn.ReadOnly,p.LEQUAL,!0),ae=r.paint.get($?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),se=Z(.1,3,ae),de=i._showOverdrawInspector;if(!de){const ge=new oa({func:p.ALWAYS,mask:255},255,255,p.KEEP,p.KEEP,p.REPLACE),Te=new Aa([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0],p.MIN);yv(i,t,r,l,K,ge,Te,la.disabled,$,"sdf",T,P,R,z,U,se,x,!1)}{const ge=de?oa.disabled:new oa({func:p.EQUAL,mask:255},255,255,p.KEEP,p.DECR,p.DECR),Te=de?i.colorModeForRenderPass():new Aa([p.ONE_MINUS_DST_ALPHA,p.DST_ALPHA,p.ONE,p.ONE],xn.transparent,[!0,!0,!0,!0]);yv(i,t,r,l,K,ge,Te,la.disabled,$,"color",T,P,R,z,U,se,x,!1)}};if(v){const $=(K,ae,se)=>{const de=i.depthModeForSublayer(1,zn.ReadOnly,p.LEQUAL,!1),ge=r.paint.get(K?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Te=Z(.1,3,ge);{const we=new Aa([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0]);yv(i,t,r,l,de,oa.disabled,we,la.disabled,K,"clear",T,P,R,z,U,Te,x,ae)}{const we=new oa({func:p.ALWAYS,mask:255},255,255,p.KEEP,p.KEEP,p.REPLACE),Ie=new Aa([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0],p.MIN);yv(i,t,r,l,de,we,Ie,la.disabled,K,"sdf",T,P,R,z,U,Te,x,ae)}{const we=K?p.ZERO:p.ONE_MINUS_DST_ALPHA,Ie=new oa({func:p.EQUAL,mask:255},255,255,p.KEEP,p.DECR,p.DECR),xe=new Aa([we,p.DST_ALPHA,p.ONE_MINUS_DST_ALPHA,p.ZERO],xn.transparent,[!0,!0,!0,!0]);yv(i,t,r,l,de,Ie,xe,la.disabled,K,"color",T,P,R,z,U,Te,x,ae)}{const we=new Aa([p.ONE,p.ONE,p.ONE,K?p.ZERO:p.ONE],xn.transparent,[!1,!1,!1,!0],K?p.FUNC_ADD:p.MAX);yv(i,t,r,l,de,oa.disabled,we,la.disabled,K,"clear",T,P,R,z,U,Te,x,ae,se)}};if(W||j){let K;if(i.prepareDrawTile(),g){const ae=g.drapeBufferSize[0],se=g.drapeBufferSize[1];K=g.framebufferCopyTexture,K&&(!K||K.size[0]===ae&&K.size[1]===se)||(K&&K.destroy(),K=g.framebufferCopyTexture=new mr(h,new $i({width:ae,height:se}),p.RGBA)),K.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,0,0,ae,se,0)}W&&$(!0,!1,K),j&&$(!1,!0,K)}}else W&&Y(!0),j&&Y(!1)}}},hillshade:function(i,t,r,l){if(i.renderPass!=="offscreen"&&i.renderPass!=="translucent")return;const u=i.context,h=i.terrain&&i.terrain.renderingToTexture,[p,g]=i.renderPass!=="translucent"||h?[{},l]:i.stencilConfigForOverlap(l);for(const v of g){const b=t.getTile(v);if(b.needsHillshadePrepare&&i.renderPass==="offscreen")cie(i,b,r);else if(i.renderPass==="translucent"){const x=i.depthModeForSublayer(0,zn.ReadOnly),S=r.paint.get("hillshade-emissive-strength"),T=i.colorModeForDrapableLayerRenderPass(S),P=h&&i.terrain?i.terrain.stencilModeForRTTOverlap(v):p[v.overscaledZ];lie(i,v,b,r,x,P,T)}}u.viewport.set([0,0,i.width,i.height]),i.resetStencilClippingMasks()},raster:function(i,t,r,l,u,h){if(i.renderPass!=="translucent"||r.paint.get("raster-opacity")===0)return;const p=i.context,g=p.gl,v=t.getSource(),b=function(Z,Y,$){const K=[];let ae,se;if(Z.paint.get("raster-color")){K.push("RASTER_COLOR"),ae=Z.paint.get("raster-color-mix"),se=Z.paint.get("raster-color-range"),Y.activeTexture.set($.TEXTURE2);let de=Z.colorRampTexture;de||(de=Z.colorRampTexture=new mr(Y,Z.colorRamp,$.RGBA)),de.bind($.LINEAR,$.CLAMP_TO_EDGE)}return{mix:ae,range:se,defines:K}}(r,p,g),x=b.defines;let S=!1;if(v instanceof $u&&!l.length){if(i.transform.projection.name!=="globe")return;if(v.onNorthPole)S=!0,x.push("PROJECTION_GLOBE_VIEW");else{if(!v.onSouthPole)return;S=!0,x.push("PROJECTION_GLOBE_VIEW")}}const T=i.colorModeForDrapableLayerRenderPass(),P=i.terrain&&i.terrain.renderingToTexture,R=!i.options.moving,z=r.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;if(S){const Z=t.getSource();if(!(Z instanceof $u))return;const Y=Z.texture;if(!Y)return;const $=i.globeSharedBuffers;if(!$)return;const K=new zn(g.LEQUAL,zn.ReadWrite,i.depthRangeFor3D),ae=Float32Array.from(i.transform.projMatrix);let se=Vz(0,0,i.transform);const de=Float32Array.from(ym(dc(new Uu(0,0,0)))),ge={opacity:1,mix:0};i.terrain&&i.terrain.prepareDrawTile(),p.activeTexture.set(g.TEXTURE0),Y.bind(z,g.CLAMP_TO_EDGE),p.activeTexture.set(g.TEXTURE1),Y.bind(z,g.CLAMP_TO_EDGE),Y.useMipmap&&p.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax);const[Te,we,Ie,xe]=$.getPoleBuffers(0,!0);let We;Z.onNorthPole?(We=Te,i.renderDefaultNorthPole=!1):(se=nt.scale(nt.create(),se,[1,-1,1]),We=we,i.renderDefaultSouthPole=!1);const qe=T8(ae,de,se,[0,0],1,ge,r,Z.perspectiveTransform||[0,0],2,b.mix||[0,0,0,0],b.range||[0,0]),Qe=i.getOrCreateProgram("raster",{defines:b.defines});return i.uploadCommonUniforms(p,Qe,null),void Qe.draw(i,g.TRIANGLES,K,oa.disabled,T,la.disabled,qe,r.id,We,Ie,xe)}if(!l.length)return;const[U,W]=v instanceof $u||P?[{},l]:i.stencilConfigForOverlap(l),j=W[W.length-1].overscaledZ;for(const Z of W){const Y=P?zn.disabled:i.depthModeForSublayer(Z.overscaledZ-j,r.paint.get("raster-opacity")===1?zn.ReadWrite:zn.ReadOnly,g.LESS),$=Z.toUnwrapped(),K=t.getTile(Z);if(P&&(!K||!K.hasData())||!K.texture)continue;const ae=P?Z.projMatrix:i.transform.calculateProjMatrix($,R),se=i.terrain&&P?i.terrain.stencilModeForRTTOverlap(Z):U[Z.overscaledZ],de=h?0:r.paint.get("raster-fade-duration");K.registerFadeDuration(de);const ge=t.findLoadedParent(Z,0),Te=_8(K,ge,t,i.transform,de);let we,Ie;i.terrain&&i.terrain.prepareDrawTile(),p.activeTexture.set(g.TEXTURE0),K.texture.bind(z,g.CLAMP_TO_EDGE),p.activeTexture.set(g.TEXTURE1),ge?(ge.texture.bind(z,g.CLAMP_TO_EDGE),we=Math.pow(2,ge.tileID.overscaledZ-K.tileID.overscaledZ),Ie=[K.tileID.canonical.x*we%1,K.tileID.canonical.y*we%1]):K.texture.bind(z,g.CLAMP_TO_EDGE),K.texture.useMipmap&&p.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax);const xe=v instanceof $u?v.perspectiveTransform:[0,0],We=new Float32Array(16),qe=T8(ae,We,We,Ie||[0,0],we||1,Te,r,xe,2,b.mix||[0,0,0,0],b.range||[0,0]),Qe=i.isTileAffectedByFog(Z),Ne=i.getOrCreateProgram("raster",{defines:b.defines,overrideFog:Qe});if(i.uploadCommonUniforms(p,Ne,$),v instanceof $u)v.boundsBuffer&&v.boundsSegments&&Ne.draw(i,g.TRIANGLES,Y,oa.disabled,T,la.disabled,qe,r.id,v.boundsBuffer,i.quadTriangleIndexBuffer,v.boundsSegments);else{const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:at,tileBoundsSegments:mt}=i.getTileBoundsBuffers(K);Ne.draw(i,g.TRIANGLES,Y,se,T,la.disabled,qe,r.id,Ve,at,mt)}}i.resetStencilClippingMasks()},background:function(i,t,r,l){const u=r.paint.get("background-color"),h=r.paint.get("background-opacity"),p=r.paint.get("background-emissive-strength");if(h===0)return;const g=i.context,v=g.gl,b=i.transform,x=b.tileSize,S=r.paint.get("background-pattern");if(i.isPatternMissing(S,r.scope))return;const T=!S&&u.a===1&&h===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==T)return;const P=oa.disabled,R=i.depthModeForSublayer(0,T==="opaque"?zn.ReadWrite:zn.ReadOnly),z=i.colorModeForDrapableLayerRenderPass(p),U=S?"backgroundPattern":"background";let W,j=l;j||(W=i.getBackgroundTiles(),j=Object.values(W).map(Z=>Z.tileID)),S&&(g.activeTexture.set(v.TEXTURE0),i.imageManager.bind(i.context,r.scope));for(const Z of j){const Y=i.isTileAffectedByFog(Z),$=i.getOrCreateProgram(U,{overrideFog:Y}),K=Z.toUnwrapped(),ae=l?Z.projMatrix:i.transform.calculateProjMatrix(K);i.prepareDrawTile();const se=t?t.getTile(Z):W?W[Z.key]:new h1(Z,x,b.zoom,i),de=S?Pie(ae,p,h,i,S,r.scope,{tileID:Z,tileSize:x}):Cie(ae,p,h,u);i.uploadCommonUniforms(g,$,K);const{tileBoundsBuffer:ge,tileBoundsIndexBuffer:Te,tileBoundsSegments:we}=i.getTileBoundsBuffers(se);$.draw(i,v.TRIANGLES,R,P,z,la.disabled,de,r.id,ge,Te,we)}},sky:function(i,t,r){const l=i._atmosphere?mo(i.transform.zoom):1,u=r.paint.get("sky-opacity")*l;if(u===0)return;const h=i.context,p=r.paint.get("sky-type"),g=new zn(h.gl.LEQUAL,zn.ReadOnly,[0,1]),v=i.frameCounter/1e3%1;p==="atmosphere"?i.renderPass==="offscreen"?r.needsSkyboxCapture(i)&&(function(b,x,S,T){const P=b.context,R=P.gl;let z=x.skyboxFbo;if(!z){z=x.skyboxFbo=P.createFramebuffer(32,32,!0,null),x.skyboxGeometry=new B8(P),x.skyboxTexture=P.gl.createTexture(),R.bindTexture(R.TEXTURE_CUBE_MAP,x.skyboxTexture),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MAG_FILTER,R.LINEAR);for(let Z=0;Z<6;++Z)R.texImage2D(R.TEXTURE_CUBE_MAP_POSITIVE_X+Z,0,R.RGBA,32,32,0,R.RGBA,R.UNSIGNED_BYTE,null)}P.bindFramebuffer.set(z.framebuffer),P.viewport.set([0,0,32,32]);const U=x.getCenter(b,!0),W=b.getOrCreateProgram("skyboxCapture"),j=new Float64Array(16);nt.identity(j),nt.rotateY(j,j,.5*-Math.PI),vv(b,x,W,j,U,0),nt.identity(j),nt.rotateY(j,j,.5*Math.PI),vv(b,x,W,j,U,1),nt.identity(j),nt.rotateX(j,j,.5*-Math.PI),vv(b,x,W,j,U,2),nt.identity(j),nt.rotateX(j,j,.5*Math.PI),vv(b,x,W,j,U,3),nt.identity(j),vv(b,x,W,j,U,4),nt.identity(j),nt.rotateY(j,j,Math.PI),vv(b,x,W,j,U,5),P.viewport.set([0,0,b.width,b.height])}(i,r),r.markSkyboxValid(i)):i.renderPass==="sky"&&function(b,x,S,T,P){const R=b.context,z=R.gl,U=b.transform,W=b.getOrCreateProgram("skybox");R.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_CUBE_MAP,x.skyboxTexture);const j=((Z,Y,$,K,ae)=>({u_matrix:Z,u_sun_direction:Y,u_cubemap:0,u_opacity:K,u_temporal_offset:ae}))(U.skyboxMatrix,x.getCenter(b,!1),0,T,P);b.uploadCommonUniforms(R,W),W.draw(b,z.TRIANGLES,S,oa.disabled,b.colorModeForRenderPass(),la.backCW,j,"skybox",x.skyboxGeometry.vertexBuffer,x.skyboxGeometry.indexBuffer,x.skyboxGeometry.segment)}(i,r,g,u,v):p==="gradient"&&i.renderPass==="sky"&&function(b,x,S,T,P){const R=b.context,z=R.gl,U=b.transform,W=b.getOrCreateProgram("skyboxGradient");x.skyboxGeometry||(x.skyboxGeometry=new B8(R)),R.activeTexture.set(z.TEXTURE0);let j=x.colorRampTexture;j||(j=x.colorRampTexture=new mr(R,x.colorRamp,z.RGBA)),j.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Z=((Y,$,K,ae,se)=>({u_matrix:Y,u_color_ramp:0,u_center_direction:$,u_radius:be(K),u_opacity:ae,u_temporal_offset:se}))(U.skyboxMatrix,x.getCenter(b,!1),x.paint.get("sky-gradient-radius"),T,P);b.uploadCommonUniforms(R,W),W.draw(b,z.TRIANGLES,S,oa.disabled,b.colorModeForRenderPass(),la.backCW,Z,"skyboxGradient",x.skyboxGeometry.vertexBuffer,x.skyboxGeometry.indexBuffer,x.skyboxGeometry.segment)}(i,r,g,u,v)},debug:function(i,t,r){for(let l=0;l<r.length;l++)Hie(i,t,r[l])},custom:function(i,t,r,l){const u=i.context,h=r.implementation;if(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes("custom")||i.terrain&&(i.terrain.renderingToTexture||i.renderPass==="offscreen")&&r.isLayerDraped(t)){if(i.renderPass==="offscreen"){const p=h.prerender;if(p){if(i.setCustomLayerDefaults(),u.setColorMode(i.colorModeForRenderPass()),i.transform.projection.name==="globe"){const g=i.transform.pointMerc;p.call(h,u.gl,i.transform.customLayerMatrix(),i.transform.getProjection(),i.transform.globeToMercatorMatrix(),mo(i.transform.zoom),[g.x,g.y],i.transform.pixelsPerMeterRatio)}else p.call(h,u.gl,i.transform.customLayerMatrix());u.setDirty(),i.setBaseState()}}else if(i.renderPass==="translucent"){if(i.terrain&&i.terrain.renderingToTexture){const g=h.renderToTile;if(g){const v=l[0].canonical,b=new ga(v.x+l[0].wrap*(1<<v.z),v.y,v.z);u.setDepthMode(zn.disabled),u.setStencilMode(oa.disabled),u.setColorMode(i.colorModeForRenderPass()),i.setCustomLayerDefaults(),g.call(h,u.gl,b),u.setDirty(),i.setBaseState()}return}i.setCustomLayerDefaults(),u.setColorMode(i.colorModeForRenderPass()),u.setStencilMode(oa.disabled);const p=h.renderingMode==="3d"?new zn(i.context.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,zn.ReadOnly);if(u.setDepthMode(p),i.transform.projection.name==="globe"){const g=i.transform.pointMerc;h.render(u.gl,i.transform.customLayerMatrix(),i.transform.getProjection(),i.transform.globeToMercatorMatrix(),mo(i.transform.zoom),[g.x,g.y],i.transform.pixelsPerMeterRatio)}else h.render(u.gl,i.transform.customLayerMatrix());u.setDirty(),i.setBaseState(),u.bindFramebuffer.set(null)}}else ve("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(i,t,r,l){if(i.renderPass==="opaque")return;const u=r.paint.get("model-opacity");if(u===0)return;const h=r.paint.get("model-cast-shadows");if(i.renderPass==="shadow"&&(!h||i.terrain&&u<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof Dc))return;const p=i.shadowRenderer,g=r.paint.get("model-receive-shadows");p&&(p.useNormalOffset=!0,g||(p.enabled=!1));const v=()=>{p&&(p.useNormalOffset=!0,g||(p.enabled=!0))},b=t.getSource();if(i.renderPass==="light-beam"&&b.type!=="batched-model")return;if(b.type==="vector"||b.type==="geojson")return function(W,j,Z,Y){const $=W.transform;if($.projection.name!=="mercator")return void ve(`Drawing 3D models for ${$.projection.name} projection is not yet implemented`);const K=$.getFreeCameraOptions().position;if(!W.modelManager)return;const ae=W.modelManager,se=W.shadowRenderer;if(!Z._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const de=Z._unevaluatedLayout._values["model-id"],ge={...Z.layout.get("model-id").parameters};for(const Te of Y){const we=j.getTile(Te).getBucket(Z);if(!we||we.projection.name!==$.projection.name)continue;const Ie=Jie(Te,$);ge.zoom=Ie;const xe=de.possiblyEvaluate(ge);if(Kie(W,we,Te),Xu.shadowUniformsInitialized=!1,Xu.useSingleShadowCascade=!!se&&se.getMaxCascadeForTile(Te.toUnwrapped())===0,W.renderPass==="shadow"&&se){if(W.currentShadowCascade===1&&we.isInsideFirstShadowMapFrustum)continue;const Qe=$.calculatePosMatrix(Te.toUnwrapped(),$.worldSize);if(Xu.tileMatrix.set(Qe),Xu.shadowTileMatrix=Float32Array.from(se.calculateShadowPassMatrixFromMatrix(Qe)),Xu.aabb.min.fill(0),Xu.aabb.max[0]=Xu.aabb.max[1]=dt,Xu.aabb.max[2]=0,ere(we,Xu,W,Z.scope))continue}const We=1<<Te.canonical.z,qe=[((K.x-Te.wrap)*We-Te.canonical.x)*dt,(K.y*We-Te.canonical.y)*dt,K.z*We*dt];for(let Qe in we.instancesPerModel){const Ne=we.instancesPerModel[Qe];Ne.features.length>0&&(Qe=xe.evaluate(Ne.features[0].feature,{}));const Ve=ae.getModel(Qe,Z.scope);if(Ve&&Ve.uploaded)for(const at of Ve.nodes)V8(W,Z,at,Ne,qe,Te,Xu)}}}(i,t,r,l),void v();if(!b.loaded())return;if(b.type==="batched-model")return function(W,j,Z,Y){const $=W.context,K=W.transform,ae=W.style.fog,se=W.shadowRenderer;if(K.projection.name!=="mercator")return void ve(`Drawing 3D landmark models for ${K.projection.name} projection is not yet implemented`);const de=W.transform.getFreeCameraOptions().position,ge=ke.scale([],[de.x,de.y,de.z],W.transform.worldSize);ke.negate(ge,ge);const Te=nt.identity([]),we=gf(K.center.lat,K.zoom),Ie=nt.fromScaling([],[1,1,1/we]);nt.translate(Te,Te,ge);const xe=Z.paint.get("model-opacity"),We=new zn($.gl.LEQUAL,zn.ReadWrite,W.depthRangeFor3D),qe=new zn($.gl.LEQUAL,zn.ReadOnly,W.depthRangeFor3D),Qe=function(Ne,Ve){for(const at of Y){const mt=j.getTile(at).getBucket(Z);if(!mt||!mt.uploaded)continue;let lt=!1;se&&(lt=se.getMaxCascadeForTile(at.toUnwrapped())===0);const Ct=K.calculatePosMatrix(at.toUnwrapped(),K.worldSize),zt=mt.modelTraits;for(const bt of mt.getNodesInfo()){if(bt.hiddenByReplacement||!bt.node.meshes)continue;const Et=bt.node,en=W.renderPass==="light-beam",on=[...Ct],rn=bt.evaluatedScale;let cn=0;W.terrain&&Et.elevation&&(cn=Et.elevation*W.terrain.exaggeration()),nt.translate(on,on,[(Et.anchor?Et.anchor[0]:0)*(rn[0]-1),(Et.anchor?Et.anchor[1]:0)*(rn[1]-1),cn]),rn!==kne&&nt.scale(on,on,rn),nt.multiply(on,on,Et.matrix);const gn=nt.multiply([],Ie,on);nt.multiply(gn,Te,gn);const kn=nt.invert([],gn);nt.transpose(kn,kn),nt.scale(kn,kn,Qie);const ea=nt.multiply([],K.projMatrix,on);for(let _a=0;_a<Et.meshes.length;++_a){const $n=Et.meshes[_a],Un=_a===Et.lightMeshIndex;if(Un){if(!en&&!W.terrain&&W.shadowRenderer){W.currentLayer<W.firstLightBeamLayer&&(W.firstLightBeamLayer=W.currentLayer);continue}}else if(en)continue;const In={defines:[]},En=[];o5(In.defines,En,$n,W),4&zt||In.defines.push("DIFFUSE_SHADED"),lt&&In.defines.push("SHADOWS_SINGLE_CASCADE");const da=W.renderPass==="shadow";if(da){s5($n,on,W,Z);continue}let Ea=null;if(ae){const Qa=U8(on,W.transform);if(Ea=new Float32Array(Qa),K.projection.name!=="globe"){const ar=$n.aabb.min,xi=$n.aabb.max,[Di,Xa]=ae.getOpacityForBounds(Qa,ar[0],ar[1],xi[0],xi[1]);In.overrideFog=Di>=Am||Xa>=Am}}const Qn=W.getOrCreateProgram("model",In);!da&&se&&(se.useNormalOffset=!!$n.normalBuffer,se.setupShadowsFromMatrix(on,Qn,se.useNormalOffset)),W.uploadCommonUniforms($,Qn,at.toUnwrapped(),Ea);const qa=$n.material,bi=qa.pbrMetallicRoughness;bi.metallicFactor=.9,bi.roughnessFactor=.5;const ri=i5(new Float32Array(ea),new Float32Array(gn),new Float32Array(kn),W,xe,bi.baseColorFactor,qa.emissiveFactor,bi.metallicFactor,bi.roughnessFactor,qa,Z);Qn.draw(W,$.gl.TRIANGLES,Ve&&!Un?We:qe,oa.disabled,Ne?Un||xe<1||bt.hasTranslucentParts?Aa.alphaBlended:Aa.unblended:Aa.disabled,la.backCCW,ri,Z.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Z.paint,W.transform.zoom,void 0,En)}}}};(function(Ne,Ve,at,mt){const lt=Ne.terrain?Ne.terrain.exaggeration():0,Ct=Ne.transform.zoom;for(const zt of mt){const bt=Ve.getTile(zt).getBucket(at);bt&&(Ne.conflationActive&&bt.updateReplacement(zt,Ne.replacementSource),bt.evaluateScale(Ne,at),Ne.terrain&&lt>0&&bt.elevationUpdate(Ne.terrain,lt,zt,at.source),bt.needsReEvaluation(Ne,Ct,at)&&bt.evaluate(at))}})(W,j,Z,Y),xe===1?Qe(!0,!0):(Qe(!1,!0),Qe(!0,!1))}(i,t,r,l),void v();const x=b.getModels(),S=[],T=i.transform.getFreeCameraOptions().position,P=ke.scale([],[T.x,T.y,T.z],i.transform.worldSize);ke.negate(P,P);const R=[],z=[];let U=0;for(const W of x){const j=r.paint.get("model-rotation").constantOr(null),Z=r.paint.get("model-scale").constantOr(null),Y=r.paint.get("model-translation").constantOr(null);W.computeModelMatrix(i,j,Z,Y,!0,!0,!1);const $=nt.identity([]),K=gf(W.position.lat,i.transform.zoom),ae=nt.fromScaling([],[1,1,1/K]);nt.translate($,$,P),S.push({zScaleMatrix:ae,negCameraPosMatrix:$});for(const se of W.nodes)W8(i.transform,se,W.matrix,i.transform.projMatrix,U,R,z);U++}if(R.sort((W,j)=>j.depth-W.depth),i.renderPass!=="shadow"){if(u===1)for(const W of z)M3(W,i,r,S[W.modelIndex],oa.disabled,i.colorModeForRenderPass());else{for(const W of z)M3(W,i,r,S[W.modelIndex],oa.disabled,Aa.disabled);for(const W of z)M3(W,i,r,S[W.modelIndex],i.stencilModeFor3D(),i.colorModeForRenderPass());i.resetStencilClippingMasks()}for(const W of R)M3(W,i,r,S[W.modelIndex],oa.disabled,i.colorModeForRenderPass());v()}else{for(const W of z)s5(W.mesh,W.nodeModelMatrix,i,r);for(const W of R)s5(W.mesh,W.nodeModelMatrix,i,r);v()}}},H8={modelUpload:function(i,t,r){const l=t.getSource();if(!l.loaded())return;if(l.type==="vector"||l.type==="geojson")return void(i.modelManager&&i.modelManager.upload(i,r));if(l.type==="batched-model")return;const u=l.getModels();for(const h of u)h.upload(i.context)}};class are{constructor(t,r){this.context=new wne(t),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Hc.maxUnderzooming+Hc.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new Bne,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ore(this),this._wireframeDebugCache=new nre,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,r){const l=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(l||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new fie(this,t));const u=this._terrain;this.transform.elevation=l?u:null,u.update(t,this.transform,r),this.transform.elevation&&!u.enabled&&(this.transform.elevation=null)}_updateFog(t){const r=t.fog;if(!r||this.transform.projection.name==="globe"||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[l,u]=r.getFovAdjustedRange(this.transform._fov);if(l>u)return void(this.transform.fogCullDistSq=null);const h=l+.78*(u-l);this.transform.fogCullDistSq=h*h}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,r){if(this.width=t*Cn.devicePixelRatio,this.height=r*Cn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style.order)this.style._mergedLayers[l].resize()}setup(){const t=this.context,r=new J;r.emplaceBack(0,0),r.emplaceBack(dt,0),r.emplaceBack(0,dt),r.emplaceBack(dt,dt),this.tileExtentBuffer=t.createVertexBuffer(r,ff.members),this.tileExtentSegments=Ha.simpleSegment(0,0,4,2);const l=new J;l.emplaceBack(0,0),l.emplaceBack(dt,0),l.emplaceBack(0,dt),l.emplaceBack(dt,dt),this.debugBuffer=t.createVertexBuffer(l,ff.members),this.debugSegments=Ha.simpleSegment(0,0,4,5);const u=new J;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(-1,1),u.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(u,ff.members),this.viewportSegments=Ha.simpleSegment(0,0,4,2);const h=new je;h.emplaceBack(0,0,0,0),h.emplaceBack(dt,0,dt,0),h.emplaceBack(0,dt,0,dt),h.emplaceBack(dt,dt,dt,dt),this.mercatorBoundsBuffer=t.createVertexBuffer(h,xP.members),this.mercatorBoundsSegments=Ha.simpleSegment(0,0,4,2);const p=new Nn;p.emplaceBack(0,1,2),p.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(p);const g=new H_;for(const b of[0,1,3,2,0])g.emplaceBack(b);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new mr(t,new $i({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=nt.create();const v=this.context.gl;this.stencilClearMode=new oa({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO),this.loadTimeStamps.push(m.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,zn.disabled,this.stencilClearMode,Aa.disabled,la.disabled,a5(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,l){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!l||l.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const v of l)if(this._tileClippingMaskIDs[v.key]===void 0){g=!0;break}if(!g)return}this.currentStencilSource=r.id;const u=this.context,h=u.gl;this.nextStencilID+l.length>256&&this.clearStencil(),u.setColorMode(Aa.disabled),u.setDepthMode(zn.disabled);const p=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of l){const v=r.getTile(g),b=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:x,tileBoundsIndexBuffer:S,tileBoundsSegments:T}=this.getTileBoundsBuffers(v);p.draw(this,h.TRIANGLES,zn.disabled,new oa({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),Aa.disabled,la.disabled,a5(g.projMatrix),"$clipping",x,S,T)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new oa({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new oa({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,l=t.sort((p,g)=>g.overscaledZ-p.overscaledZ),u=l[l.length-1].overscaledZ,h=l[0].overscaledZ-u+1;if(h>1){this.currentStencilSource=void 0,this.nextStencilID+h>256&&this.clearStencil();const p={};for(let g=0;g<h;g++)p[g+u]=new oa({func:r.GEQUAL,mask:255},g+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=h,[p,l]}return[{[u]:oa.disabled},l]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Aa([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new xn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Aa.unblended:Aa.alphaBlended}colorModeForDrapableLayerRenderPass(t){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Aa([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new xn(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,r,l,u=!1){if(!this.opaquePassEnabledForLayer()&&!u)return zn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new zn(l||this.context.gl.LEQUAL,r,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=r;const l=this.style._mergedLayers,u=this.style.order,h=u.map($=>l[$]),p=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Cn.now()),this.imageManager.beginFrame();let g=0,v=!1;for(const $ in p){const K=p[$];K.used&&(K.prepare(this.context),K.getSource().usedInConflation&&++g)}const b={},x={},S={},T={},P={};for(const $ in p){const K=p[$];b[$]=K.getVisibleCoordinates(),x[$]=b[$].slice().reverse(),S[$]=K.getVisibleCoordinates(!0).reverse(),T[$]=K.getShadowCasterCoordinates(),P[$]=K.sortCoordinatesByDistance(b[$])}const R=$=>{const K=this.style.getLayerSourceCache($);return K&&K.used?K.getSource():null};if(g){const $=[];for(const K of h)this.layerUsedInConflation(K,R(K))&&$.push(K);if($&&$.length>1){const K=[];for(const ae of $){const se=this.style.getLayerSourceCache(ae);se&&se.used&&se.getSource().usedInConflation&&K.push({layer:ae.fqid,cache:se})}this.replacementSource.setSources(K),v=!0}}v||this.replacementSource.clear(),this.conflationActive=v,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const $ of h){const K=$.cutoffRange();if(this.longestCutoffRange=Math.max(K,this.longestCutoffRange),K>0){const ae=R($);ae&&(this.minCutoffZoom=Math.max(ae.minzoom,this.minCutoffZoom)),$.minzoom&&(this.minCutoffZoom=Math.max($.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let $=0;$<h.length;$++)if(h[$].is3D()){this.opaquePassCutoff=$;break}const z=this.style&&this.style.fog;z?(this._fogVisible=z.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=z.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0);const U=this._shadowRenderer;if(U){U.updateShadowParameters(this.transform,this.style.directionalLight);for(const $ in p)for(const K of b[$]){let ae={min:0,max:0};this.terrain&&(ae=this.terrain.getMinMaxForTile(K)||ae),U.addShadowReceiver(K.toUnwrapped(),ae.min,ae.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new UQ(this.context));for(const $ of h){if($.isHidden(this.transform.zoom))continue;const K=t.getLayerSourceCache($);this.uploadLayer(this,$,K)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Yie),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!ni.has(this.context.gl))return;this.renderPass="offscreen";for(const $ of h){const K=t.getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const ae=K?x[K.id]:void 0;($.type==="custom"||$.type==="raster"||$.isSky()||ae&&ae.length)&&this.renderLayer(this,K,$,ae)}this.depthRangeFor3D=[0,1-(h.length+2)*this.numSublayers*this.depthEpsilon];const W=this.terrain;W&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&W.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,T)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const j=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Z=(()=>{if(r.showOverdrawInspector)return xn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!j){const $=this.style.fog.properties.get("color").toArray01();return new xn(...$)}if(this.style.fog&&this.transform.projection.supportsFog&&j){const $=this.style.fog.properties.get("space-color").toArray01();return new xn(...$)}return xn.transparent})();if(this.context.clear({color:Z,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&j&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const $=h[this.currentLayer],K=t.getLayerSourceCache($);if($.isSky())continue;const ae=K?($.is3D()?P:x)[K.id]:void 0;this._renderTileClippingMasks($,K,ae),this.renderLayer(this,K,$,ae)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&j&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||mo(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const $=h[this.currentLayer],K=t.getLayerSourceCache($);$.isSky()&&this.renderLayer(this,K,$,K?x[K.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Y=0;for(U&&(Y=U.getShadowCastingLayerCount());this.currentLayer<u.length;){const $=h[this.currentLayer],K=t.getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(W&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=W.renderBatch(this.currentLayer);continue}let ae;if(K&&(ae=($.type==="symbol"?S:$.is3D()?P:x)[K.id]),this._renderTileClippingMasks($,K,K?b[K.id]:void 0),this.renderLayer(this,K,$,ae),!W&&U&&Y>0&&$.hasShadowPass()&&--Y==0&&(U.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const se=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=se;this.currentLayer++){const de=h[this.currentLayer];if(!de.hasLightBeamPass())continue;const ge=t.getLayerSourceCache(de);this.renderLayer(this,ge,de,ge?x[ge.id]:void 0)}this.currentLayer=se,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let $=null;h.forEach(K=>{const ae=t.getLayerSourceCache(K);ae&&!K.isHidden(this.transform.zoom)&&ae.getVisibleCoordinates().length&&(!$||$.getSource().maxzoom<ae.getSource().maxzoom)&&($=ae)}),$&&this.options.showTileBoundaries&&G8.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const K=$.transform.padding;F8($,$.transform.height-(K.top||0),3,Bie),F8($,K.bottom||0,3,Uie),N8($,K.left||0,3,Wie),N8($,$.transform.width-(K.right||0),3,Vie);const ae=$.transform.centerPoint;(function(se,de,ge,Te){E3(se,de-1,ge-10,2,20,Te),E3(se,de-10,ge-1,20,2,Te)})($,ae.x,$.transform.height-ae.y,Gie)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(m.performance.now()),this.saveCanvasCopy()),v||(this.conflationActive=!1)}uploadLayer(t,r,l){this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&r.type==="custom")&&H8[`${r.type}Upload`]&&H8[`${r.type}Upload`](t,l,r.scope),this.gpuTimingEnd()}renderLayer(t,r,l,u){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="sky"||l.type==="custom"||l.type==="model"||l.type==="raster"||u&&u.length)&&(this.id=l.id,this.gpuTimingStart(l),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(l.type)||t.terrain&&l.type==="custom")&&G8[l.type](t,r,l,u,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery,l=this.context.gl;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:l.createQuery()}),u.calls++,l.beginQuery(r.TIME_ELAPSED_EXT,u.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,r=this.context.gl,l=r.createQuery();this.deferredRenderGpuTimeQueries.push(l),r.beginQuery(t.TIME_ELAPSED_EXT,l)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const r={};for(const l in t){const u=t[l],h=this.context.extTimerQuery,p=h.getQueryParameter(u.query,this.context.gl.QUERY_RESULT)/1e6;h.deleteQueryEXT(u.query),r[l]=p}return r}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery,l=this.context.gl;let u=0;for(const h of t)u+=r.getQueryParameter(h,l.QUERY_RESULT)/1e6,r.deleteQueryEXT(h);return u}translatePosMatrix(t,r,l,u,h){if(!l[0]&&!l[1])return t;const p=h?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(p){const b=Math.sin(p),x=Math.cos(p);l=[l[0]*x-l[1]*b,l[0]*b+l[1]*x]}const g=[h?l[0]:xm(r,l[0],this.transform.zoom),h?l[1]:xm(r,l[1],this.transform.zoom),0],v=new Float32Array(16);return nt.translate(v,t,g),v}saveTileTexture(t){const r=this._tileTextures[t.size[0]];r?r.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t,r){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}terrainUseFloatDEM(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,r,l){const u=l===void 0?this.terrain&&this.terrain.renderingToTexture:l,h=this.terrain&&this.terrain.exaggeration()===0,p=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(p.push("LIGHTING_3D_MODE"),p.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):u||p.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||p.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?p.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):p.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(p.push("TERRAIN"),this.terrainUseFloatDEM()&&p.push("TERRAIN_DEM_FLOAT_FORMAT"),h&&p.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&p.push("GLOBE"),!this._fogVisible||u||r!==void 0&&!r||p.push("FOG","FOG_DITHERING"),u&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}getOrCreateProgram(t,r){this.cache=this.cache||{};const l=r&&r.defines||[],u=r&&r.config,h=this.currentGlobalDefines(t,r&&r.overrideFog,r&&r.overrideRtt).concat(l),p=x8.cacheKey(d8[t],t,h,u);return this.cache[p]||(this.cache[p]=new x8(this.context,t,d8[t],u,Iie[t],h)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=m.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new mr(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,r){if(this.style.enable3dLights()){const l=this.style.directionalLight,u=this.style.ambientLight;if(l&&u){const h=((p,g)=>{const v=p.properties.get("direction"),b=p.properties.get("color").toArray01(),x=p.properties.get("intensity"),S=g.properties.get("color").toArray01(),T=g.properties.get("intensity"),P=[v.x,v.y,v.z],R=Vt(S,T),z=Vt(b,x);return{u_lighting_ambient_color:R,u_lighting_directional_dir:P,u_lighting_directional_color:z,u_ground_radiance:pie(P,z,R)}})(l,u);r.setLightsUniformValues(t,h)}}}uploadCommonUniforms(t,r,l,u,h){if(this.uploadCommonLightUniforms(t,r),this.terrain&&this.terrain.renderingToTexture)return;const p=this.style.fog;if(p){const g=p.getOpacity(this.transform.pitch),v=((b,x,S,T,P,R,z,U,W,j,Z,Y)=>{const $=b.transform,K=x.properties.get("color").toArray01();K[3]=T;const ae=b.frameCounter/1e3%1,[se,de]=x.properties.get("vertical-range");return{u_fog_matrix:S?$.calculateFogTileMatrix(S):Y||b.identityMat,u_fog_range:x.getFovAdjustedRange($._fov),u_fog_color:K,u_fog_horizon_blend:x.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(se,de),de],u_fog_temporal_offset:ae,u_frustum_tl:P,u_frustum_tr:R,u_frustum_br:z,u_frustum_bl:U,u_globe_pos:W,u_globe_radius:j,u_viewport:Z,u_globe_transition:mo($.zoom),u_is_globe:+($.projection.name==="globe")}})(this,p,l,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Cn.devicePixelRatio,this.transform.height*Cn.devicePixelRatio],u);r.setFogUniformValues(t,v)}h&&r.setCutoffUniformValues(t,h.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},l=this.transform.coveringTiles({tileSize:512});for(const u of l)r[u.key]=t[u.key]||new h1(u,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,r){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!r||r.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let r=this._cachedTileFogOpacities[t.key];return r||(this._cachedTileFogOpacities[t.key]=r=this.style.fog.getOpacityForTile(t)),r[0]>=Am||r[1]>=Am}}const Tm=2048;class ire{constructor(t,r){this.aabb=t,this.lastCascade=r}}class rre{add(t,r){const l=this.receivers[t.key];l!==void 0?(l.aabb.min[0]=Math.min(l.aabb.min[0],r.min[0]),l.aabb.min[1]=Math.min(l.aabb.min[1],r.min[1]),l.aabb.min[2]=Math.min(l.aabb.min[2],r.min[2]),l.aabb.max[0]=Math.max(l.aabb.max[0],r.max[0]),l.aabb.max[1]=Math.max(l.aabb.max[1],r.max[1]),l.aabb.max[2]=Math.max(l.aabb.max[2],r.max[2])):this.receivers[t.key]=new ire(r,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,r,l){const u=di.fromPoints(t.points);let h=0;for(const p in this.receivers){const g=this.receivers[p];if(!g||!u.intersectsAabb(g.aabb))continue;g.aabb.min=u.closestPoint(g.aabb.min),g.aabb.max=u.closestPoint(g.aabb.max);const v=g.aabb.getCorners();for(let b=0;b<l.length;b++){let x=!0;for(const S of v){const T=[S[0]*r,S[1]*r,S[2]];if(ke.transformMat4(T,T,l[b].matrix),T[0]<-1||T[0]>1||T[1]<-1||T[1]>1){x=!1;break}}if(g.lastCascade=b,h=Math.max(h,b),x)break}}return h+1}}class ore{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new rre,this._depthMode=new zn(t.context.gl.LEQUAL,zn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,r){const l=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const u=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||u<=0||(this._shadowLayerCount=l.style.order.reduce((P,R)=>{const z=l.style._mergedLayers[R];return P+(z.hasShadowPass()&&!z.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const h=l.context,p=Tm,g=Tm;if(this._cascades.length===0)for(let P=0;P<2;++P){const R=l._shadowMapDebug,z=h.gl,U=h.createFramebuffer(p,g,R,"texture"),W=new mr(h,{width:p,height:g,data:null},z.DEPTH_COMPONENT);if(U.depthAttachment.set(W.texture),R){const j=new mr(h,{width:p,height:g,data:null},z.RGBA);U.colorAttachment.set(j.texture)}this._cascades.push({framebuffer:U,texture:W,matrix:[],far:0,boundingSphereRadius:0,frustum:new Yd,scale:0})}this.shadowDirection=j8(r);let v=0;if(t.elevation){const P=t.elevation,R=[1e4,-1e4];P.visibleDemTiles.filter(z=>z.dem).forEach(z=>{const U=z.dem.tree;R[0]=Math.min(R[0],U.minimums[0]),R[1]=Math.max(R[1],U.maximums[0])}),R[0]!==1e4&&(v=(R[1]-R[0])*P.exaggeration())}const b=1.5*t.cameraToCenterDistance,x=3*b,S=new Float64Array(16);for(let P=0;P<2;++P){const R=this._cascades[P];let z=t.height/50,U=1;P===0?U=b:(z=b,U=x);const[W,j]=sre(t,this.shadowDirection,z,U,Tm,v);R.scale=t.scale,R.matrix=W,R.boundingSphereRadius=j,nt.invert(S,R.matrix),R.frustum=Yd.fromInvProjectionMatrix(S,1,0,!0),R.far=U}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=u,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Tm,this._uniformValues.u_shadowmap_0=rl.ShadowMap0,this._uniformValues.u_shadowmap_1=rl.ShadowMap0+1,this._groundShadowTiles=l.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const T=l.transform.elevation;for(const P of this._groundShadowTiles){let R={min:0,max:0};if(T){const z=T.getMinMaxForTile(P);z&&(R=z)}this.addShadowReceiver(P.toUnwrapped(),R.min,R.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,r){if(!this._enabled)return;const l=this.painter,u=l.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(l.transform.getFrustum(0),l.transform.worldSize,this._cascades),u.viewport.set([0,0,Tm,Tm]);for(let h=0;h<this._numCascadesToRender;++h){l.currentShadowCascade=h,u.bindFramebuffer.set(this._cascades[h].framebuffer.framebuffer),u.clear({color:xn.white,depth:1});for(const p of t.order){const g=t._mergedLayers[p];if(!g.hasShadowPass()||g.isHidden(l.transform.zoom))continue;const v=t.getLayerSourceCache(g),b=v?r[v.id]:void 0;(g.type==="model"||b&&b.length)&&l.renderLayer(l,v,g,b)}}l.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,r=t.style,l=t.context,u=r.directionalLight,h=r.ambientLight;if(!u||!h)return;const p=[],g=mv(t,t.longestCutoffRange);g.shouldRenderCutoff&&p.push("RENDER_CUTOFF");const v=l5(u,h),b=new zn(l.gl.LEQUAL,zn.ReadOnly,t.depthRangeFor3D);for(const x of this._groundShadowTiles){const S=x.toUnwrapped(),T=t.isTileAffectedByFog(x),P=t.getOrCreateProgram("groundShadow",{defines:p,overrideFog:T});this.setupShadows(S,P),t.uploadCommonUniforms(l,P,S,null,g);const R={u_matrix:t.transform.calculateProjMatrix(S),u_ground_shadow_factor:v};P.draw(t,l.gl.TRIANGLES,b,oa.disabled,Aa.multiply,la.disabled,R,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Aa.unblended:Aa.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const r=this.painter.transform,l=r.calculatePosMatrix(t,r.worldSize);return nt.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}calculateShadowPassMatrixFromMatrix(t){return nt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,r,l,u=0){if(!this._enabled)return;const h=this.painter.transform,p=this.painter.context,g=p.gl,v=this._uniformValues,b=new Float64Array(16),x=h.calculatePosMatrix(t,h.worldSize);for(let S=0;S<2;S++)nt.multiply(b,this._cascades[S].matrix,x),v[S===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),p.activeTexture.set(g.TEXTURE0+rl.ShadowMap0+S),this._cascades[S].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!l,this.useNormalOffset){const S=J_(t.canonical),T=2/h.tileSize*dt/Tm,P=T*this._cascades[0].boundingSphereRadius,R=T*this._cascades[1].boundingSphereRadius,z=(l==="vector-tile"?1:3)/Math.pow(2,u-t.canonical.z-(1-h.zoom+Math.floor(h.zoom)));v.u_shadow_normal_offset=[S,P*z,R*z],v.u_shadow_bias=[6e-5,.0012,.012]}else v.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(p,v)}setupShadowsFromMatrix(t,r,l=!1){if(!this._enabled)return;const u=this.painter.context,h=u.gl,p=this._uniformValues,g=new Float64Array(16);for(let v=0;v<2;v++)nt.multiply(g,this._cascades[v].matrix,t),p[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),u.activeTexture.set(h.TEXTURE0+rl.ShadowMap0+v),this._cascades[v].texture.bind(h.NEAREST,h.CLAMP_TO_EDGE);this.useNormalOffset=l,l?(p.u_shadow_normal_offset=[1,5,5],p.u_shadow_bias=[6e-5,.0012,.012]):p.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(u,p)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,r,l,u){if(u[2]>=0)return{};const h=function(v,b,x){const S=x/(1<<v.canonical.z);return new di([v.canonical.x*S+v.wrap*x,v.canonical.y*S+v.wrap*x,0],[(v.canonical.x+1)*S+v.wrap*x,(v.canonical.y+1)*S+v.wrap*x,b])}(t,r,l).getCorners(),p=r/-u[2];u[0]<0?(ke.add(h[0],h[0],[u[0]*p,0,0]),ke.add(h[3],h[3],[u[0]*p,0,0])):u[0]>0&&(ke.add(h[1],h[1],[u[0]*p,0,0]),ke.add(h[2],h[2],[u[0]*p,0,0])),u[1]<0?(ke.add(h[0],h[0],[0,u[1]*p,0]),ke.add(h[1],h[1],[0,u[1]*p,0])):u[1]>0&&(ke.add(h[2],h[2],[0,u[1]*p,0]),ke.add(h[3],h[3],[0,u[1]*p,0]));const g={};return g.vertices=h,g.planes=[T3(h[1],h[0],h[4]),T3(h[2],h[1],h[5]),T3(h[3],h[2],h[6]),T3(h[0],h[3],h[7])],g}addShadowReceiver(t,r,l){this._receivers.add(t,di.fromTileIdAndHeight(t,r,l))}getMaxCascadeForTile(t){const r=this._receivers.get(t);return r&&r.lastCascade?r.lastCascade:0}}function T3(i,t,r){const l=ke.sub([],r,t),u=ke.sub([],i,t),h=ke.cross([],l,u),p=ke.length(h);return p===0?[0,0,1,0]:(ke.scale(h,h,1/p),[h[0],h[1],h[2],-ke.dot(h,t)])}function j8(i){const t=i.properties.get("direction"),r=ce(t.x,t.y,t.z);r[2]=ne(r[2],0,75);const l=ot([r[0],r[1],r[2]]);return ke.fromValues(l.x,l.y,l.z)}function l5(i,t){const r=i.properties.get("color"),l=i.properties.get("intensity"),u=i.properties.get("direction"),h=[u.x,u.y,u.z],p=t.properties.get("color"),g=t.properties.get("intensity"),v=Math.max(ke.dot([0,0,1],h),0),b=[0,0,0];ke.scale(b,p.toArray01Linear().slice(0,3),g);const x=[0,0,0];return ke.scale(x,r.toArray01Linear().slice(0,3),v*l),$t([b[0]>0?b[0]/(b[0]+x[0]):0,b[1]>0?b[1]/(b[1]+x[1]):0,b[2]>0?b[2]/(b[2]+x[2]):0])}function sre(i,t,r,l,u,h){const p=i.zoom,g=i.scale,v=i.worldSize,b=1/v,x=i.aspect,S=Math.sqrt(1+x*x)*Math.tan(.5*i.fovX),T=S*S,P=l-r,R=l+r;let z,U;T>P/R?(z=l,U=l*S):(z=.5*R*(1+T),U=.5*Math.sqrt(P*P+2*(l*l+r*r)*T+R*R*T*T));const W=i.projection.pixelsPerMeter(i.center.lat,v),j=i._camera.getCameraToWorldMercator(),Z=[0,0,-z*b];ke.transformMat4(Z,Z,j);let Y=U*b;const $=i._edgeInsets;if(!($.left===0&&$.top===0&&$.right===0&&$.bottom===0||$.left===$.right&&$.top===$.bottom)){const mt=i._camera.getWorldToCamera(i.worldSize,i.projection.zAxisUnit==="meters"?W:1),lt=i._camera.getCameraToClipPerspective(i._fov,i.width/i.height,r,l);lt[8]=2*-i.centerOffset.x/i.width,lt[9]=2*i.centerOffset.y/i.height;const Ct=new Float64Array(16);nt.mul(Ct,lt,mt);const zt=new Float64Array(16);nt.invert(zt,Ct);const bt=Yd.fromInvProjectionMatrix(zt,v,p,!0);for(const Et of bt.points){const en=((K=Et)[0]/=g,K[1]/=g,K[2]=ja(K[2],i._center.lat),K);Y=Math.max(Y,ke.len(ke.subtract([],Z,en)))}}var K;Y*=u/(u-1);const ae=Math.acos(t[2]),se=Math.atan2(-t[0],-t[1]),de=new a3;de.position=Z,de.setPitchBearing(ae,se);const ge=de.getWorldToCamera(v,W),Te=Y*v,we=Math.min(i._mercatorZfromZoom(17)*v*-2,-2*Te),Ie=de.getCameraToClipOrthographic(-Te,Te,-Te,Te,we,(Te+h*W)/t[2]),xe=new Float64Array(16);nt.multiply(xe,Ie,ge);const We=ke.fromValues(Math.floor(1e6*Z[0])/1e6*v,Math.floor(1e6*Z[1])/1e6*v,0),qe=.5*u,Qe=[0,0,0];ke.transformMat4(Qe,We,xe),ke.scale(Qe,Qe,qe);const Ne=[Math.floor(Qe[0]),Math.floor(Qe[1]),Math.floor(Qe[2])],Ve=[0,0,0];ke.sub(Ve,Qe,Ne),ke.scale(Ve,Ve,-1/qe);const at=new Float64Array(16);return nt.identity(at),nt.translate(at,at,Ve),nt.multiply(xe,at,xe),[xe,Te]}class lre extends Bn{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}async loadModel(t,r){const l=await BB(this.requestManager.transformRequest(r,Se.Model).url).catch(p=>{this.fire(new vn(new Error(`Could not load model ${t} from ${r}: ${p.message}`)))});if(!l)return;const u=qP(l),h=new ON(t,void 0,void 0,u);return h.computeBoundsAndApplyParent(),h}async load(t,r){this.models[r]||(this.models[r]={});const l=Object.keys(t);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+l.length;const u=[];for(const p of l)u.push(this.loadModel(p,t[p]));const h=await Promise.allSettled(u);for(let p=0;p<h.length;p++){const{status:g,value:v}=h[p];g==="fulfilled"&&v&&(this.models[r][l[p]]=v)}this.numModelsLoading[r]-=l.length,this.fire(new Ht("data",{dataType:"style"}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,r){return!!this.getModel(t,r)}getModel(t,r){return this.models[r]||(this.models[r]={}),this.models[r][t]}async addModel(t,r,l){this.models[l]||(this.models[l]={}),this.hasModel(t,l)&&this.removeModel(t,l),this.load({[t]:this.requestManager.normalizeModelURL(r)},l)}addModels(t,r){const l={};for(const u in t)l[u]=this.requestManager.normalizeModelURL(t[u]);this.load(l,r)}removeModel(t,r){this.models[r]||(this.models[r]={});const l=this.models[r][t];delete this.models[r][t],l.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,r){this.models[r]||(this.models[r]={});for(const l in this.models[r])this.models[r][l].upload(t.context)}}const C1=(i,t)=>fo(i,t&&t.filter(r=>r.identifier!=="source.canvas")),cre=ht(Fa,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData"]),ure=ht(Fa,["setCenter","setZoom","setBearing","setPitch"]),$8={version:8,layers:[],sources:{}},q8={duration:300,delay:0},dre=new Set(["fill","line","background","hillshade","raster"]);class qc extends Bn{constructor(t,r={}){super(),this.map=t,this.scope=r.scope||"",this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=Ue({},q8),this._buildingIndex=new zae(this),this.crossTileSymbolIndex=new rie,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new cC,this.dispatcher=r.dispatcher?r.dispatcher:new Em(A1(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new dae,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new ov(t._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new lre(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=r.config||new Map,this._configDependentLayers=new Set,this._changes.reset(),this.dispatcher.broadcast("setReferrer",ze());const l=this;this._rtlTextPluginCallback=qc.registerForPluginStateChange(u=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:u.pluginStatus,pluginURL:u.pluginURL},(h,p)=>{if(Go(h),p&&p.every(g=>g))for(const g in l._sourceCaches){const v=l._sourceCaches[g],b=v.getSource().type;b!=="vector"&&b!=="geojson"||v.reload()}})}),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.getOwnSource(u.sourceId);if(h&&h.vectorLayerIds)for(const p in this._layers){const g=this._layers[p];g.source===h.id&&this._validateLayer(g)}})}loadURL(t,r={}){this.fire(new Ht("dataloading",{dataType:"style"}));const l=typeof r.validate=="boolean"?r.validate:!wn(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken),this.resolvedImports.add(t);const u=this.importsCache.get(t);if(u)return this._load(u,l);const h=this.map._requestManager.transformRequest(t,Se.Style);this._request=et(h,(p,g)=>{if(this._request=null,p)this.fire(new vn(p));else if(g)return this.importsCache.set(t,g),this._load(g,l)})}loadJSON(t,r={}){this.fire(new Ht("dataloading",{dataType:"style"})),this._request=Cn.frame(()=>{this._request=null,this._load(t,r.validate!==!1)})}loadEmpty(){this.fire(new Ht("dataloading",{dataType:"style"})),this._load($8,!1)}_loadImports(t,r){if(this.importDepth>=4)return ve("Style doesn't support nesting deeper than 5"),this._reloadImports();const l=[];for(const u of t){const h=this._createFragmentStyle(u),p=new Promise(v=>h.on("style.import.load",v));if(l.push(p),this.resolvedImports.has(u.url)){h.loadEmpty();continue}const g=u.data||this.importsCache.get(u.url);g?h.loadJSON(g,{validate:r}):u.url?h.loadURL(u.url,{validate:r}):h.loadEmpty(),this.fragments.push({style:h,id:u.id,config:u.config})}Promise.all(l).then(()=>this._reloadImports())}_createFragmentStyle(t){const r=this.scope?Ho(t.id,this.scope):t.id,l=new Map,u=t.config;if(u)for(const p of Object.keys(u)){const g=kc(u[p]);g.result==="success"&&l.set(p,g.value.expression)}const h=new qc(this.map,{scope:r,config:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager});return h.setEventedParent(this.map,{style:h}),h}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new Ht("data",{dataType:"style"})),this.fire(new Ht(this.importDepth===0?"style.load":"style.import.load"))}_load(t,r){const l=t.schema;if(this.importDepth===0&&(t.fragment||l&&t.fragment!==!1)){const p=Ue({},$8,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(p,r)}if(l)for(const p of Object.keys(l)){if(this.options.has(p))continue;const g=kc(l[p].default);g.result==="success"&&this.options.set(p,g.value.expression)}if(r&&C1(this,ku(t)))return;this._loaded=!0,this.stylesheet=le(t);for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});this._changes.changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const u=HB(this.stylesheet.layers);if(this._order=u.map(p=>p.id),this.stylesheet.light&&ve("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const p=this.stylesheet.lights[0];this.light=new yB(p.properties,p.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new yB(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const p of u){const g=d3(p,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const v=this.getOwnLayerSourceCache(g),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();v&&g.canCastShadows()&&b&&(v.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const h=this.stylesheet.terrain;h&&!this.terrainSetForDrapingOnly()&&this._createTerrain(h,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.fire(new Ht("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,r):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new Ht(this.importDepth===0?"style.load":"style.import.load")))}mergeAll(){let t,r,l,u,h,p,g,v;this.forEachFragmentStyle(b=>{b.light!=null&&(t=b.light),b.ambientLight!=null&&(r=b.ambientLight),b.directionalLight!=null&&(l=b.directionalLight),b.terrain!=null&&(!u||u&&u.drapeRenderMode===0||b.terrain.drapeRenderMode===1)&&(u=b.terrain),b.fog!=null&&(h=b.fog),b.stylesheet&&(b.stylesheet.camera!=null&&(v=b.stylesheet.camera),b.stylesheet.projection!=null&&(p=b.stylesheet.projection),b.stylesheet.transition!=null&&(g=b.stylesheet.transition))}),this.light=t,this.ambientLight=r,this.directionalLight=l,this.terrain=u,this.fog=h,this.camera=v||{"camera-projection":"perspective"},this.projection=p||{name:"mercator"},this.transition=Ue({},q8,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const r=l=>{for(const u of l.fragments)r(u.style);t(l)};r(this)}mergeTerrain(){let t;this.forEachFragmentStyle(r=>{r.terrain!=null&&(!t||t&&t.drapeRenderMode===0||r.terrain.drapeRenderMode===1)&&(t=r.terrain)}),this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(r=>{r.stylesheet.projection!=null&&(t=r.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},r={},l={};this.forEachFragmentStyle(u=>{for(const h in u._sourceCaches){const p=Ho(h,u.scope);t[p]=u._sourceCaches[h]}for(const h in u._otherSourceCaches){const p=Ho(h,u.scope);r[p]=u._otherSourceCaches[h]}for(const h in u._symbolSourceCaches){const p=Ho(h,u.scope);l[p]=u._symbolSourceCaches[h]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=l}mergeLayers(){const t={},r=[],l={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(h=>{for(const p of h._order){const g=h._layers[p];if(g.type==="slot"){const v=jy(p);if(t[v])continue;t[v]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):r.push(g)}}),this._mergedOrder=[];const u=(h=[])=>{for(const p of h)if(p.type==="slot"){const g=jy(p.id);t[g]&&u(t[g])}else{const g=Ho(p.id,p.scope);this._mergedOrder.push(g),l[g]=p,p.is3D()&&(this._has3DLayers=!0),p.type==="circle"&&(this._hasCircleLayers=!0),p.type==="symbol"&&(this._hasSymbolLayers=!0)}};u(r),this._mergedLayers=l,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Ue({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.importDepth>0||(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(r,l,u){let h,p,g;const v=Cn.devicePixelRatio>1?"@2x":"";let b=et(l.transformRequest(l.normalizeSpriteURL(r,v,".json"),Se.SpriteJSON),(T,P)=>{b=null,g||(g=T,h=P,S())}),x=Qt(l.transformRequest(l.normalizeSpriteURL(r,v,".png"),Se.SpriteImage),(T,P)=>{x=null,g||(g=T,p=P,S())});function S(){if(g)u(g);else if(h&&p){const T=Cn.getImageData(p),P={};for(const R in h){const{width:z,height:U,x:W,y:j,sdf:Z,pixelRatio:Y,stretchX:$,stretchY:K,content:ae}=h[R],se=new $i({width:z,height:U});$i.copy(T,se,{x:W,y:j},{x:0,y:0},{width:z,height:U}),P[R]={data:se,pixelRatio:Y,sdf:Z,stretchX:$,stretchY:K,content:ae}}u(null,P)}}return{cancel(){b&&(b.cancel(),b=null),x&&(x.cancel(),x=null)}}}(t,this.map._requestManager,(r,l)=>{if(this._spriteRequest=null,r)this.fire(new vn(r));else if(l)for(const u in l)this.imageManager.addImage(u,this.scope,l[u]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Ht("data",{dataType:"style"}))})}_validateLayer(t){const r=this.getOwnSource(t.source);if(!r)return;const l=t.sourceLayer;l&&(r.type==="geojson"||r.vectorLayerIds&&r.vectorLayerIds.indexOf(l)===-1)&&this.fire(new vn(new Error(`Source layer "${l}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.updatedSourceCaches).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,r)=>{const l=this.fragments[r];return l&&l.style&&(t.data=l.style.serialize()),t})}_serializeSources(){const t={};for(const r in this._sourceCaches){const l=this._sourceCaches[r].getSource();t[l.id]||(t[l.id]=l.serialize())}return t}_serializeLayers(t){const r=[];for(const l of t){const u=this._layers[l];u&&u.type!=="custom"&&r.push(u.serialize())}return r}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):dre.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const r=this.calculateLightsBrightness();t.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const l=this._changes.changed;if(this._changes.changed){const h=this._changes.getLayerUpdatesByScope();for(const p in h){const{updatedIds:g,removedIds:v}=h[p];(g||v)&&this._updateWorkerLayers(p,g,v)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const u={};for(const h in this._mergedSourceCaches){const p=this._mergedSourceCaches[h];u[h]=p.used,p.used=!1}for(const h of this._mergedOrder){const p=this._mergedLayers[h];if(p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)){const g=this.getOwnLayerSourceCache(p);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=p.minzoom||0;g<(p.maxzoom||25.5);g++){const v=this.map.painter;if(v){const b=p.getProgramIds();if(!b)continue;for(const x of b){const S=p.getDefaultProgramParams(x,t.zoom);S&&(v.style=this,this.fog&&(v._fogVisible=!0,S.overrideFog=!0,v.getOrCreateProgram(x,S)),v._fogVisible=!1,S.overrideFog=!1,v.getOrCreateProgram(x,S),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(S.overrideRtt=!0,v.getOrCreateProgram(x,S)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const h in u){const p=this._mergedSourceCaches[h];u[h]!==p.used&&p.getSource().fire(new Ht("data",{sourceDataType:"visibility",dataType:"source",sourceId:p.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new Ht("data",{dataType:"style"}));for(const{style:h}of this.fragments)h.update(t)}_updateTilesForChangedImages(){const t=Array.from(this._changes.changedImages.keys());if(t.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changes.changedImages.clear()}}_updateWorkerLayers(t,r,l){const u=this.getFragmentStyle(t);this.dispatcher.broadcast("updateLayers",{layers:r?u._serializeLayers(r):[],scope:t,removedIds:l||[],options:u.options})}setState(t){if(this._checkLoaded(),C1(this,ku(t)))return!1;(t=le(t)).layers=HB(t.layers);const r=function(u,h){if(!u)return[{command:Fa.setStyle,args:[h]}];let p=[];try{if(!Q(u.version,h.version))return[{command:Fa.setStyle,args:[h]}];Q(u.center,h.center)||p.push({command:Fa.setCenter,args:[h.center]}),Q(u.zoom,h.zoom)||p.push({command:Fa.setZoom,args:[h.zoom]}),Q(u.bearing,h.bearing)||p.push({command:Fa.setBearing,args:[h.bearing]}),Q(u.pitch,h.pitch)||p.push({command:Fa.setPitch,args:[h.pitch]}),Q(u.sprite,h.sprite)||p.push({command:Fa.setSprite,args:[h.sprite]}),Q(u.glyphs,h.glyphs)||p.push({command:Fa.setGlyphs,args:[h.glyphs]}),Q(u.transition,h.transition)||p.push({command:Fa.setTransition,args:[h.transition]}),Q(u.light,h.light)||p.push({command:Fa.setLight,args:[h.light]}),Q(u.fog,h.fog)||p.push({command:Fa.setFog,args:[h.fog]}),Q(u.projection,h.projection)||p.push({command:Fa.setProjection,args:[h.projection]}),Q(u.lights,h.lights)||p.push({command:Fa.setLights,args:[h.lights]}),Q(u.camera,h.camera)||p.push({command:Fa.setCamera,args:[h.camera]});const g={},v=[];(function(S,T,P,R){let z;for(z in T=T||{},S=S||{})S.hasOwnProperty(z)&&(T.hasOwnProperty(z)||$B(z,P,R));for(z in T){if(!T.hasOwnProperty(z))continue;const U=T[z];S.hasOwnProperty(z)?Q(S[z],U)||(S[z].type==="geojson"&&U.type==="geojson"&&Bae(S,T,z)?P.push({command:Fa.setGeoJSONSourceData,args:[z,U.data]}):Nae(z,T,P,R)):jB(z,T,P)}})(u.sources,h.sources,v,g);const b=[];u.layers&&u.layers.forEach(S=>{S.source&&g[S.source]?p.push({command:Fa.removeLayer,args:[S.id]}):b.push(S)});let x=u.terrain;x&&g[x.source]&&(p.push({command:Fa.setTerrain,args:[void 0]}),x=void 0),p=p.concat(v),Q(x,h.terrain)||p.push({command:Fa.setTerrain,args:[h.terrain]}),function(S,T,P){T=T||[];const R=(S=S||[]).map(m3),z=T.map(m3),U=S.reduce(g3,{}),W=T.reduce(g3,{}),j=R.slice(),Z=Object.create(null);let Y,$,K,ae,se,de,ge;for(Y=0,$=0;Y<R.length;Y++)K=R[Y],W.hasOwnProperty(K)?$++:(P.push({command:Fa.removeLayer,args:[K]}),j.splice(j.indexOf(K,$),1));for(Y=0,$=0;Y<z.length;Y++)K=z[z.length-1-Y],j[j.length-1-Y]!==K&&(U.hasOwnProperty(K)?(P.push({command:Fa.removeLayer,args:[K]}),j.splice(j.lastIndexOf(K,j.length-$),1)):$++,de=j[j.length-Y],P.push({command:Fa.addLayer,args:[W[K],de]}),j.splice(j.length-Y,0,K),Z[K]=!0);for(Y=0;Y<z.length;Y++)if(K=z[Y],ae=U[K],se=W[K],!Z[K]&&!Q(ae,se))if(Q(ae.source,se.source)&&Q(ae["source-layer"],se["source-layer"])&&Q(ae.type,se.type)){for(ge in p3(ae.layout,se.layout,P,K,null,Fa.setLayoutProperty),p3(ae.paint,se.paint,P,K,null,Fa.setPaintProperty),Q(ae.filter,se.filter)||P.push({command:Fa.setFilter,args:[K,se.filter]}),Q(ae.minzoom,se.minzoom)&&Q(ae.maxzoom,se.maxzoom)||P.push({command:Fa.setLayerZoomRange,args:[K,se.minzoom,se.maxzoom]}),ae)ae.hasOwnProperty(ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?p3(ae[ge],se[ge],P,K,ge.slice(6),Fa.setPaintProperty):Q(ae[ge],se[ge])||P.push({command:Fa.setLayerProperty,args:[K,ge,se[ge]]}));for(ge in se)se.hasOwnProperty(ge)&&!ae.hasOwnProperty(ge)&&ge!=="layout"&&ge!=="paint"&&ge!=="filter"&&ge!=="metadata"&&ge!=="minzoom"&&ge!=="maxzoom"&&(ge.indexOf("paint.")===0?p3(ae[ge],se[ge],P,K,ge.slice(6),Fa.setPaintProperty):Q(ae[ge],se[ge])||P.push({command:Fa.setLayerProperty,args:[K,ge,se[ge]]}))}else P.push({command:Fa.removeLayer,args:[K]}),de=j[j.lastIndexOf(K)+1],P.push({command:Fa.addLayer,args:[se,de]})}(b,h.layers,p),function(S=[],T=[],P){T=T||[];const R=(S=S||[]).map(m3),z=T.map(m3),U=S.reduce(g3,{}),W=T.reduce(g3,{}),j=R.slice();let Z,Y,$,K;for(Z=0,Y=0;Z<R.length;Z++)$=R[Z],W.hasOwnProperty($)?Y++:(P.push({command:Fa.removeImport,args:[$]}),j.splice(j.indexOf($,Y),1));for(Z=0,Y=0;Z<z.length;Z++)$=z[z.length-1-Z],j[j.length-1-Z]!==$&&(U.hasOwnProperty($)?(P.push({command:Fa.removeImport,args:[$]}),j.splice(j.lastIndexOf($,j.length-Y),1)):Y++,K=j[j.length-Z],P.push({command:Fa.addImport,args:[W[$],K]}),j.splice(j.length-Z,0,$));for(const ae of T){const se=U[ae.id];if(!se||Q(se,ae))continue;Q(se.url,ae.url)||P.push({command:Fa.setImportUrl,args:[ae.id,ae.url]});const de=ae.data;Q(se&&se.data,de)||P.push({command:Fa.setImportData,args:[ae.id,de]})}}(u.imports,h.imports,p)}catch(g){console.warn("Unable to compute style diff:",g),p=[{command:Fa.setStyle,args:[h]}]}return p}(this.serialize(),t).filter(u=>!(u.command in ure));if(r.length===0)return!1;const l=r.filter(u=>!(u.command in cre));if(l.length>0)throw new Error(`Unimplemented: ${l.map(u=>u.command).join(", ")}.`);return r.forEach(u=>{this[u.command].apply(this,u.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,r){return this.getImage(t)?this.fire(new vn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,r),this._afterImageUpdated(t),this)}updateImage(t,r){this.imageManager.updateImage(t,this.scope,r)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new vn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.changedImages.add(t),this._changes.changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Ht("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,r,l={}){return this._checkLoaded(),this._validate(zy,`models.${t}`,r,null,l)||(this.modelManager.addModel(t,r,this.scope),this._changes.changed=!0),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new vn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,r,l={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(lf,`sources.${t}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=ZP(t,r,this.dispatcher,this);u.scope=this.scope,u.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u.id),source:u.serialize(),sourceId:u.id}));const h=p=>{const g=(p?"symbol:":"other:")+u.id,v=Ho(g,this.scope),b=this._sourceCaches[g]=new Hc(v,u,p);(p?this._symbolSourceCaches:this._otherSourceCaches)[u.id]=b,b.onAdd(this.map)};h(!1),r.type!=="vector"&&r.type!=="geojson"||h(!0),u.onAdd&&u.onAdd(this.map),this.mergeSources(),this._changes.changed=!0}removeSource(t){this._checkLoaded();const r=this.getOwnSource(t);if(!r)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new vn(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new vn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const l=this.getOwnSourceCaches(t);for(const u of l){const h=jy(u.id);delete this._sourceCaches[h],delete this._changes.updatedSourceCaches[u.id],u.fire(new Ht("data",{sourceDataType:"metadata",dataType:"source",sourceId:u.getSource().id})),u.setEventedParent(null),u.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.changed=!0,this}setGeoJSONSourceData(t,r){this._checkLoaded(),this.getOwnSource(t).setData(r),this._changes.changed=!0}getOwnSource(t){const r=this.getOwnSourceCache(t);return r&&r.getSource()}getOwnSources(){const t=[];for(const r in this._otherSourceCaches){const l=this.getOwnSourceCache(r);l&&t.push(l.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const u of t){if(this._validate(F_,"lights",u))return;switch(u.type){case"ambient":if(this.ambientLight){const h=this.ambientLight;h.set(u),h.updateTransitions(r)}else this.ambientLight=new AB(u,_ae,this.scope,this.options);break;case"directional":if(this.directionalLight){const h=this.directionalLight;h.set(u),h.updateTransitions(r)}else this.directionalLight=new AB(u,bae,this.scope,this.options)}}const l=new ii(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,r=this.ambientLight;if(!t||!r)return;const l=S=>.2126*(S[0]<=.03928?S[0]/12.92:Math.pow((S[0]+.055)/1.055,2.4))+.7152*(S[1]<=.03928?S[1]/12.92:Math.pow((S[1]+.055)/1.055,2.4))+.0722*(S[2]<=.03928?S[2]/12.92:Math.pow((S[2]+.055)/1.055,2.4)),u=t.properties.get("color").toArray01(),h=t.properties.get("intensity"),p=t.properties.get("direction"),g=1-ce(p.x,p.y,p.z)[2]/90,v=l(u)*h*g,b=r.properties.get("color").toArray01(),x=r.properties.get("intensity");return(v+l(b)*x)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;const r=this.fragments.find(({id:l})=>l===t);if(!r)throw new Error(`Style import not found: ${t}`);return r.style}setConfigProperty(t,r,l){const u=kc(l);if(u.result!=="success")return void C1(this,u.value);const h=u.value.expression,p=this.getFragmentStyle(t);p.options.set(r,h);for(const g of p._configDependentLayers){const v=this.getLayer(g);v&&(v.possiblyEvaluateVisibility(),this._updateLayer(v))}this.ambientLight&&this.ambientLight.scope===t&&this.ambientLight.updateConfig(p.options),this.directionalLight&&this.directionalLight.scope===t&&this.directionalLight.updateConfig(p.options),this._changes.changed=!0}addLayer(t,r,l={}){this._checkLoaded();const u=t.id;if(this._layers[u])return void this.fire(new vn(new Error(`Layer with id "${u}" already exists on this map`)));let h;if(t.type==="custom"){if(C1(this,function(x){const S=[],T=x.id;return T===void 0&&S.push({message:`layers.${T}: missing required property "id"`}),x.render===void 0&&S.push({message:`layers.${T}: missing required method "render"`}),x.renderingMode&&x.renderingMode!=="2d"&&x.renderingMode!=="3d"&&S.push({message:`layers.${T}: property "renderingMode" must be either "2d" or "3d"`}),S}(t)))return;h=d3(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(u,t.source),t=Ue(t=le(t),{source:u})),this._validate(Ou,`layers.${u}`,t,{arrayIndex:-1},l))return;h=d3(t,this.options),this._validateLayer(h),h.setEventedParent(this,{layer:{id:u}}),this._serializedLayers[h.id]=h.serialize()}h.isConfigDependent&&this._configDependentLayers.add(h.fqid),h.setScope(this.scope);const p=r?this._order.indexOf(r):this._order.length;if(r&&p===-1)return void this.fire(new vn(new Error(`Layer with id "${r}" does not exist on this map.`)));this._order.splice(p,0,u),this._layerOrderChanged=!0,this._layers[u]=h;const g=this.getOwnLayerSourceCache(h),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&h.canCastShadows()&&v&&(g.castsShadows=!0);const b=this._changes.getRemovedLayer(h);if(b&&h.source&&g&&h.type!=="custom"){this._changes.discardLayerRemoval(h);const x=Ho(h.source,h.scope);b.type!==h.type?this._changes.updatedSourceCaches[x]="clear":(this._changes.updatedSourceCaches[x]="reload",g.pause())}this._updateLayer(h),h.onAdd&&h.onAdd(this.map),h.scope=this.scope,this.mergeLayers()}moveLayer(t,r){if(this._checkLoaded(),this._changes.changed=!0,!this._layers[t])return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const l=this._order.indexOf(t);this._order.splice(l,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new vn(new Error(`Layer with id "${r}" does not exist on this map.`))):(this._order.splice(u,0,t),this._layerOrderChanged=!0,this.mergeLayers())}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));r.setEventedParent(null);const l=this._order.indexOf(t);this._order.splice(l,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.changed=!0,this._layerOrderChanged=!0,this._configDependentLayers.delete(r.fqid),this._changes.removeLayer(r);const u=this.getOwnLayerSourceCache(r);if(u&&u.castsShadows){let h=!1;for(const p in this._layers)if(this._layers[p].source===r.source&&this._layers[p].canCastShadows()){h=!0;break}u.castsShadows=h}r.onRemove&&r.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const r in this._layers)if(this._layers[r].type===t)return!0;return!1}setLayerZoomRange(t,r,l){this._checkLoaded();const u=this.getOwnLayer(t);u?u.minzoom===r&&u.maxzoom===l||(r!=null&&(u.minzoom=r),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,r,l={}){this._checkLoaded();const u=this.getOwnLayer(t);if(u){if(!Q(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(cf,`layers.${u.id}.filter`,r,{layerType:u.type},l)||(u.filter=le(r),this._updateLayer(u)))}else this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const r=this.getOwnLayer(t);if(r)return le(r.filter);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}setLayoutProperty(t,r,l,u={}){this._checkLoaded();const h=this.getOwnLayer(t);h?Q(h.getLayoutProperty(r),l)||(h.setLayoutProperty(r,l,u),h.isConfigDependent&&this._configDependentLayers.add(h.fqid),this._updateLayer(h)):this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,r){const l=this.getOwnLayer(t);if(l)return l.getLayoutProperty(r);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,r,l,u={}){this._checkLoaded();const h=this.getOwnLayer(t);if(!h)return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)));if(Q(h.getPaintProperty(r),l))return;const p=h.setPaintProperty(r,l,u);h.isConfigDependent&&this._configDependentLayers.add(h.fqid),p&&this._updateLayer(h),this._changes.changed=!0,this._changes.updatedPaintProps.add(h.fqid)}getPaintProperty(t,r){const l=this.getOwnLayer(t);if(l)return l.getPaintProperty(r);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}setFeatureState(t,r){this._checkLoaded();const l=t.source,u=t.sourceLayer,h=this.getOwnSource(l);if(!h)return void this.fire(new vn(new Error(`The source '${l}' does not exist in the map's style.`)));const p=h.type;if(p==="geojson"&&u)return void this.fire(new vn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(p==="vector"&&!u)return void this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new vn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(l);for(const v of g)v.setFeatureState(u,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const l=t.source,u=this.getOwnSource(l);if(!u)return void this.fire(new vn(new Error(`The source '${l}' does not exist in the map's style.`)));const h=u.type,p=h==="vector"?t.sourceLayer:void 0;if(h==="vector"&&!p)return void this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new vn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(l);for(const v of g)v.removeFeatureState(p,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,l=t.sourceLayer,u=this.getOwnSource(r);if(u){if(u.type!=="vector"||l)return t.id===void 0&&this.fire(new vn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(l,t.id);this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new vn(new Error(`The source '${r}' does not exist in the map's style.`)))}setTransition(t){return this.stylesheet.transition=Ue({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Ue({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),r=t&&this.terrain&&this.terrain.scope===this.scope?t:void 0;return Be({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const r=this.getLayerSourceCache(t),l=Ho(t.source,t.scope);t.source&&!this._changes.updatedSourceCaches[l]&&r&&r.getSource().type!=="raster"&&(this._changes.updatedSourceCaches[l]="reload",r.pause()),this._changes.changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const r=g=>this._mergedLayers[g].type==="fill-extrusion",l=this.order,u={},h=[];for(let g=l.length-1;g>=0;g--){const v=l[g];if(r(v)){u[v]=g;for(const b of t){const x=b[v];if(x)for(const S of x)h.push(S)}}}h.sort((g,v)=>v.intersectionZ-g.intersectionZ);const p=[];for(let g=l.length-1;g>=0;g--){const v=l[g];if(r(v))for(let b=h.length-1;b>=0;b--){const x=h[b].feature;if(u[x.layer.id]<g)break;p.push(x),h.pop()}else for(const b of t){const x=b[v];if(x)for(const S of x)p.push(S.feature)}}return p}queryRenderedFeatures(t,r,l){r&&r.filter&&this._validate(cf,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const u={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new vn(new Error("parameters.layers must be an Array."))),[];for(const b of r.layers){const x=this._mergedLayers[b];if(!x)return this.fire(new vn(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];u[x.source]=!0}}const h=[],p=r.serializedLayers||{},g=r&&r.layers?r.layers.some(b=>{const x=this.getLayer(b);return x&&x.is3D()}):this.has3DLayers(),v=DP.createFromScreenPoints(t,l);for(const b in this._mergedSourceCaches){const x=this._mergedSourceCaches[b].getSource();if(!x||x.scope!==r.scope)continue;const S=this._mergedSourceCaches[b].getSource().id;r.layers&&!u[S]||h.push(Dae(this._mergedSourceCaches[b],this._mergedLayers,p,v,r,l,g,!!this.map._showQueryGeometry))}return this.placement&&h.push(function(b,x,S,T,P,R,z){const U={},W=R.queryRenderedSymbols(T),j=[];for(const Z of Object.keys(W).map(Number))j.push(z[Z]);j.sort(VB);for(const Z of j){const Y=Z.featureIndex.lookupSymbolFeatures(W[Z.bucketInstanceId],x,Z.bucketIndex,Z.sourceLayerIndex,P.filter,P.layers,P.availableImages,b);for(const $ in Y){const K=U[$]=U[$]||[],ae=Y[$];ae.sort((se,de)=>{const ge=Z.featureSortOrder;if(ge){const Te=ge.indexOf(se.featureIndex);return ge.indexOf(de.featureIndex)-Te}return de.featureIndex-se.featureIndex});for(const se of ae)K.push(se)}}for(const Z in U)U[Z].forEach(Y=>{const $=Y.feature,K=S(b[Z]);if(!K)return;const ae=K.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=ae});return U}(this._mergedLayers,p,this.getLayerSourceCache.bind(this),v.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)}querySourceFeatures(t,r){r&&r.filter&&this._validate(cf,"querySourceFeatures.filter",r.filter,null,r);const l=this.getOwnSourceCaches(t);let u=[];for(const h of l)u=u.concat(Oae(h,r));return u}addSourceType(t,r,l){return qc.getSourceType(t)?l(new Error(`A source type called "${t}" already exists.`)):(qc.setSourceType(t,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:r.workerSourceURL},l):l(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,r,l={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const g in t)if(!Q(t[g],u[g])){h=!0;break}if(!h)return;const p=this._getTransitionParameters();this.light.setLight(t,r,l),this.light.updateTransitions(p)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,r=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let l=t;if(r===1){if(typeof l.source=="object"){const u="terrain-dem-src";this.addSource(u,l.source),l=le(l),l=Ue(l,{source:u})}if(this._validate(Du,"terrain",l))return}if(!this.terrain||this.terrain&&r!==this.terrain.drapeRenderMode){if(!l)return;this._createTerrain(l,r),this.fire(new Ht("data",{dataType:"style"}))}else{const u=this.terrain,h=u.get();for(const p of Object.keys(tt.terrain))!l.hasOwnProperty(p)&&tt.terrain[p].default&&(l[p]=tt.terrain[p].default);for(const p in t)if(!Q(t[p],h[p])){u.set(t),this.stylesheet.terrain=t;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new Ht("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const r=this.fog=new gae(t,this.map.transform);this.stylesheet.fog=r.get();const l=this._getTransitionParameters({duration:0});r.updateTransitions(l)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!Q(r.get(),t)){r.set(t),this.stylesheet.fog=r.get();const l=this._getTransitionParameters({duration:0});r.updateTransitions(l)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Cn.now(),transition:Ue(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],r=[];for(const l in this._mergedLayers)this.isLayerDraped(this._mergedLayers[l])?t.push(l):r.push(l);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...r)}_createTerrain(t,r){const l=this.terrain=new pae(t,r);l.setScope(this.scope),this.stylesheet.terrain=t,this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const u=this._getTransitionParameters({duration:0});l.updateTransitions(u)}_force3DLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="fill-extrusion"&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="symbol"&&this._updateLayer(r)}}_validate(t,r,l,u,h={}){if(h&&h.validate===!1)return!1;const p=Ue({},this.serialize());return C1(this,t.call(ku,Ue({key:r,style:p,value:l,styleSpec:tt},u)))}_remove(){for(const{style:t}of this.fragments)t._remove();this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Vy.off("pluginStateChange",this._rtlTextPluginCallback),this.mergeLayers(),this.mergeSources();for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.ambientLight,delete this.directionalLight,this.importDepth===0&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const r=this.getSourceCaches(t);for(const l of r)l.clearTiles()}reloadSource(t){const r=this.getSourceCaches(t);for(const l of r)l.resume(),l.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let r;this.directionalLight&&(r=j8(this.directionalLight));for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].update(t,void 0,void 0,r)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const r=this._sourceCaches[t];r.resume(),r.reload()}}_updatePlacement(t,r,l,u,h=!1){let p=!1,g=!1;const v={},b={};for(const x of this._mergedOrder){const S=this._mergedLayers[x];if(S.type!=="symbol")continue;if(!v[S.source]){const P=this.getLayerSourceCache(S);if(!P)continue;const R=P.getRenderableIds(!0).map(z=>P.getTileByID(z));b[S.source]=R.slice(),v[S.source]=R.sort((z,U)=>U.tileID.overscaledZ-z.tileID.overscaledZ||(z.tileID.isLessThan(U.tileID)?-1:1))}const T=this.crossTileSymbolIndex.addLayer(S,v[S.source],t.center.lng,t.projection);p=p||T}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),h=h||this._layerOrderChanged||l===0,this._layerOrderChanged&&this.fire(new Ht("neworder")),(h||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Cn.now(),t.zoom))&&(this.pauseablePlacement=new tie(t,this._mergedOrder,h,r,l,u,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,v,b),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Cn.now()),g=!0),p&&this.pauseablePlacement.placement.setStale()),g||p)for(const x of this._mergedOrder){const S=this._mergedLayers[x];S.type==="symbol"&&this.placement.updateLayerOpacities(S,v[S.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Cn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const r=this.stylesheet.imports;return r?r.findIndex(({id:u})=>u===t.id)!==-1?(this.fire(new vn(new Error(`Import with id '${t.id}' already exists in the map's style.`))),this):(this.stylesheet.imports?this.stylesheet.imports.push(t):this.stylesheet.imports=[t],this._loadImports([t],!0),this):this}setImportUrl(t,r){this._checkLoaded();const l=this.stylesheet.imports;if(!l)return this;const u=this.getImportIndex(t);if(u===-1)return this;l[u].url=r;const h=this.fragments[u];h.style=this._createFragmentStyle({id:t,url:r});const p=new Promise(g=>h.style.on("style.import.load",g));return h.style.loadURL(r),p.then(()=>this._reloadImports()),this}setImportData(t,r){this._checkLoaded();const l=this.stylesheet.imports;if(!l)return this;const u=this.getImportIndex(t);return u===-1?this:r?(this.fragments[u].style.setState(r),this._reloadImports(),this):(delete l[u].data,this.setImportUrl(t,l[u].url))}removeImport(t){this._checkLoaded();const r=this.stylesheet.imports;if(!r)return this;const l=this.getImportIndex(t);return l===-1||(r.splice(l,1),this.fragments[l].style._remove(),this.fragments.splice(l,1),this._reloadImports()),this}getImportIndex(t){const r=this.stylesheet.imports;if(!r)return-1;const l=r.findIndex(u=>u.id===t);return l===-1&&this.fire(new vn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),l}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const r in this._mergedOtherSourceCaches){const l=this._mergedOtherSourceCaches[r];l&&t.push(l.getSource())}return t}getSource(t,r){const l=this.getSourceCache(t,r);return l&&l.getSource()}getLayerSource(t){const r=this.getLayerSourceCache(t);return r&&r.getSource()}getSourceCache(t,r){const l=Ho(t,r);return this._mergedOtherSourceCaches[l]}getLayerSourceCache(t){const r=Ho(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){const r=[];return this._mergedOtherSourceCaches[t]&&r.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&r.push(this._mergedSymbolSourceCaches[t]),r}updateSourceCaches(){for(const t in this._changes.updatedSourceCaches){const r=this._changes.updatedSourceCaches[t];r==="reload"?this.reloadSource(t):r==="clear"&&this.clearSource(t)}}updateLayers(t){for(const r of this._changes.updatedPaintProps){const l=this.getLayer(r);l&&l.updateTransitions(t)}}getImages(t,r,l){this.imageManager.getImages(r.icons,r.scope,l),this._updateTilesForChangedImages();const u=h=>{h&&h.setDependencies(r.tileID.key,r.type,r.icons)};u(this._otherSourceCaches[r.source]),u(this._symbolSourceCaches[r.source])}getGlyphs(t,r,l){this.glyphManager.getGlyphs(r.stacks,r.scope,l)}getResource(t,r,l){return Je(r,l)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const r=[];return this._otherSourceCaches[t]&&r.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&r.push(this._symbolSourceCaches[t]),r}_isSourceCacheLoaded(t){const r=this.getOwnSourceCaches(t);return r.length===0?(this.fire(new vn(new Error(`There is no source with ID '${t}'`))),!1):r.every(l=>l.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function X8(i,t){let r=!1,l=null;const u=()=>{l=null,r&&(i(),l=setTimeout(u,t),r=!1)};return()=>(r=!0,l||u(),l)}qc.getSourceType=function(i){return XP[i]},qc.setSourceType=function(i,t){XP[i]=t},qc.registerForPluginStateChange=function(i){return i({pluginStatus:Nr,pluginURL:Fc}),Vy.on("pluginStateChange",i),i};class hre{constructor(t){this._hashName=t&&encodeURIComponent(t),ft(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=X8(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,m.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),m.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=Z8(t);if(this._hashName){const l=this._hashName;let u=!1;const h=m.location.hash.slice(1).split("&").map(p=>{const g=p.split("=")[0];return g===l?(u=!0,`${g}=${r}`):p}).filter(p=>p);return u||h.push(`${l}=${r}`),`#${h.join("&")}`}return`#${r}`}_getCurrentHash(){const t=m.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(l=>isNaN(l))){const l=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(r[3]||0):t.getBearing();return t.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=m.location.href.replace(/(#.+)?$/,this.getHashString());m.history.replaceState(m.history.state,null,t)}}function Z8(i,t){const r=i.getCenter(),l=Math.round(100*i.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),h=Math.pow(10,u),p=Math.round(r.lng*h)/h,g=Math.round(r.lat*h)/h,v=i.getBearing(),b=i.getPitch();let x=t?`/${p}/${g}/${l}`:`${l}/${g}/${p}`;return(v||b)&&(x+="/"+Math.round(10*v)/10),b&&(x+=`/${Math.round(b)}`),x}const C3={linearity:.3,easing:ye(0,0,.3,1)},fre=Ue({deceleration:2500,maxSpeed:1400},C3),pre=Ue({deceleration:20,maxSpeed:1400},C3),mre=Ue({deceleration:1e3,maxSpeed:360},C3),gre=Ue({deceleration:1e3,maxSpeed:90},C3);class yre{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Cn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Cn.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new V(0,0),pinchAround:void 0,around:void 0};for(const{settings:h}of this._inertiaBuffer)r.zoom+=h.zoomDelta||0,r.bearing+=h.bearingDelta||0,r.pitch+=h.pitchDelta||0,h.panDelta&&r.pan._add(h.panDelta),h.around&&(r.around=h.around),h.pinchAround&&(r.pinchAround=h.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const h=I3(r.pan.mag(),l,Ue({},fre,t||{}));u.offset=r.pan.mult(h.amount/r.pan.mag()),u.center=this._map.transform.center,P3(u,h)}if(r.zoom){const h=I3(r.zoom,l,pre);u.zoom=this._map.transform.zoom+h.amount,P3(u,h)}if(r.bearing){const h=I3(r.bearing,l,mre);u.bearing=this._map.transform.bearing+ne(h.amount,-179,179),P3(u,h)}if(r.pitch){const h=I3(r.pitch,l,gre);u.pitch=this._map.transform.pitch+h.amount,P3(u,h)}if(u.zoom||u.bearing){const h=r.pinchAround===void 0?r.around:r.pinchAround;u.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),u.noMoveStart=!0,u}}function P3(i,t){(!i.duration||i.duration<t.duration)&&(i.duration=t.duration,i.easing=t.easing)}function I3(i,t,r){const{maxSpeed:l,linearity:u,deceleration:h}=r,p=ne(i*u/(t/1e3),-l,l),g=Math.abs(p)/(h*u);return{easing:r.easing,duration:1e3*g,amount:p*(g/2)}}class kl extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l,u={}){const h=El(r.getCanvasContainer(),l);super(t,Ue({point:h,lngLat:r.unproject(h),originalEvent:l},u)),this._defaultPrevented=!1,this.target=r}}class L3 extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l){const u=t==="touchend"?l.changedTouches:l.touches,h=xd(r.getCanvasContainer(),u),p=h.map(v=>r.unproject(v)),g=h.reduce((v,b,x,S)=>v.add(b.div(S.length)),new V(0,0));super(t,{points:h,point:g,lngLats:p,lngLat:r.unproject(g),originalEvent:l}),this._defaultPrevented=!1}}class vre extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l){super(t,{originalEvent:l}),this._defaultPrevented=!1}}class _re{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new vre(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new kl(t.type,this._map,t))}mouseup(t){this._map.fire(new kl(t.type,this._map,t))}preclick(t){const r=Ue({},t);r.type="preclick",this._map.fire(new kl(r.type,this._map,r))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(t),this._map.fire(new kl(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new kl(t.type,this._map,t))}mouseover(t){this._map.fire(new kl(t.type,this._map,t))}mouseout(t){this._map.fire(new kl(t.type,this._map,t))}touchstart(t){return this._firePreventable(new L3(t.type,this._map,t))}touchmove(t){this._map.fire(new L3(t.type,this._map,t))}touchend(t){this._map.fire(new L3(t.type,this._map,t))}touchcancel(t){this._map.fire(new L3(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bre{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new kl(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new kl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new kl(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class xre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(Ip(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const l=r,u=this._startPos,h=this._lastPos;if(!u||!h||h.equals(l)||!this._box&&l.dist(u)<this._clickTolerance)return;this._lastPos=l,this._box||(this._box=Yn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const p=Math.min(u.x,l.x),g=Math.max(u.x,l.x),v=Math.min(u.y,l.y),b=Math.max(u.y,l.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${p}px,${v}px)`,this._box.style.width=g-p+"px",this._box.style.height=b-v+"px")})}mouseupWindow(t,r){if(!this._active)return;const l=this._startPos,u=r;if(l&&t.button===0){if(this.reset(),Al(),l.x!==u.x||l.y!==u.y)return this._map.fire(new Ht("boxzoomend",{originalEvent:t})),{cameraAnimation:h=>h.fitScreenCoordinates(l,u,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Jl(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new Ht(t,{originalEvent:r}))}}function c5(i,t){const r={};for(let l=0;l<i.length;l++)r[i[l].identifier]=t[l];return r}class wre{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const h=new V(0,0);for(const p of u)h._add(p);return h.div(u.length)}(r),this.touches=c5(l,r)))}touchmove(t,r,l){if(this.aborted||!this.centroid)return;const u=c5(l,r);for(const h in this.touches){const p=u[h];(!p||p.dist(this.touches[h])>30)&&(this.aborted=!0)}}touchend(t,r,l){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class u5{constructor(t){this.singleTap=new wre(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,r,l){this.singleTap.touchstart(t,r,l)}touchmove(t,r,l){this.singleTap.touchmove(t,r,l)}touchend(t,r,l){const u=this.singleTap.touchend(t,r,l);if(u){const h=t.timeStamp-this.lastTime<500,p=!this.lastTap||this.lastTap.dist(u)<30;if(h&&p||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Sre{constructor(){this._zoomIn=new u5({numTouches:1,numTaps:2}),this._zoomOut=new u5({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,l){this._zoomIn.touchstart(t,r,l),this._zoomOut.touchstart(t,r,l)}touchmove(t,r,l){this._zoomIn.touchmove(t,r,l),this._zoomOut.touchmove(t,r,l)}touchend(t,r,l){const u=this._zoomIn.touchend(t,r,l),h=this._zoomOut.touchend(t,r,l);return u?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:p=>p.easeTo({duration:300,zoom:p.getZoom()+1,around:p.unproject(u)},{originalEvent:t})}):h?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:p=>p.easeTo({duration:300,zoom:p.getZoom()-1,around:p.unproject(h)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Are={0:1,2:2};class d5{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,r){return!1}_move(t,r){return{}}mousedown(t,r){if(this._lastPoint)return;const l=Gh(t);this._correctButton(t,l)&&(this._lastPoint=r,this._eventButton=l)}mousemoveWindow(t,r){const l=this._lastPoint;if(l){if(t.preventDefault(),this._eventButton!=null&&function(u,h){const p=Are[h];return u.buttons===void 0||(u.buttons&p)!==p}(t,this._eventButton))this.reset();else if(this._moved||!(r.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(l,r)}}mouseupWindow(t){this._lastPoint&&Gh(t)===this._eventButton&&(this._moved&&Al(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ere extends d5{mousedown(t,r){super.mousedown(t,r),this._lastPoint&&(this._active=!0)}_correctButton(t,r){return r===0&&!t.ctrlKey}_move(t,r){return{around:r,panDelta:r.sub(t)}}}class Y8 extends d5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const l=.8*(r.x-t.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(t){t.preventDefault()}}class K8 extends d5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const l=-.5*(r.y-t.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(t){t.preventDefault()}}class Mre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),ft(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new V(0,0)}touchstart(t,r,l){return this._calculateTransform(t,r,l)}touchmove(t,r,l){if(this._active&&!(l.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(l.length===1&&!it())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,l)}}touchend(t,r,l){this._calculateTransform(t,r,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,l){l.length>0&&(this._active=!0);const u=c5(l,r),h=new V(0,0),p=new V(0,0);let g=0;for(const b in u){const x=u[b],S=this._touches[b];S&&(h._add(x),p._add(x.sub(S)),g++,u[b]=x)}if(this._touches=u,g<this._minTouches||!p.mag())return;const v=p.div(g);return this._sum._add(v),this._sum.mag()<this._clickTolerance?void 0:{around:h.div(g),panDelta:v}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Yn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class h5{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,r,l){return{}}touchstart(t,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,l){const u=this._firstTwoTouches;if(!u)return;t.preventDefault();const[h,p]=u,g=R3(l,r,h),v=R3(l,r,p);if(!g||!v)return;const b=this._aroundCenter?null:g.add(v).div(2);return this._move([g,v],b,t)}touchend(t,r,l){if(!this._firstTwoTouches)return;const[u,h]=this._firstTwoTouches,p=R3(l,r,u),g=R3(l,r,h);p&&g||(this._active&&Al(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function R3(i,t,r){for(let l=0;l<i.length;l++)if(i[l].identifier===r)return t[l]}function J8(i,t){return Math.log(i/t)/Math.LN2}class Tre extends h5{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const l=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(J8(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:J8(this._distance,l),pinchAround:r}}}function Q8(i,t){return 180*i.angleWith(t)/Math.PI}class Cre extends h5{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r){const l=this._vector;if(this._vector=t[0].sub(t[1]),l&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Q8(this._vector,l),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,l=this._startVector;if(!l)return!1;const u=Q8(t,l);return Math.abs(u)<r}}function f5(i){return Math.abs(i.y)>Math.abs(i.x)}class Pre extends h5{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,f5(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,l){const u=this._lastPoints;if(!u)return;const h=t[0].sub(u[0]),p=t[1].sub(u[1]);return this._map._cooperativeGestures&&!it()&&l.touches.length<3||(this._valid=this.gestureBeginsVertically(h,p,l.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+p.y)/2*-.5})}gestureBeginsVertically(t,r,l){if(this._valid!==void 0)return this._valid;const u=t.mag()>=2,h=r.mag()>=2;if(!u&&!h)return;if(!u||!h)return this._firstMove==null&&(this._firstMove=l),l-this._firstMove<100&&void 0;const p=t.y>0==r.y>0;return f5(t)&&f5(r)&&p}}const Ire={panStep:100,bearingStep:15,pitchStep:10};class Lre{constructor(){const t=Ire;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,l=0,u=0,h=0,p=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?l=-1:(t.preventDefault(),h=-1);break;case 39:t.shiftKey?l=1:(t.preventDefault(),h=1);break;case 38:t.shiftKey?u=1:(t.preventDefault(),p=-1);break;case 40:t.shiftKey?u=-1:(t.preventDefault(),p=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:g=>{const v=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:Rre,zoom:r?Math.round(v)+r*(t.shiftKey?2:1):v,bearing:g.getBearing()+l*this._bearingStep,pitch:g.getPitch()+u*this._pitchStep,offset:[-h*this._panStep,-p*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Rre(i){return i*(2-i)}const e9=4.000244140625;class kre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,ft(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||it()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===m.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const l=Cn.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%e9==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=El(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>e9?this._wheelZoomRate:this._defaultZoomRate;let x=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&x!==0&&(x=1/x);const S=r(),T=Math.pow(2,S),P=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):T;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(P*x))),this._type==="wheel"&&(this._startZoom=S,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:r(),u=this._startZoom,h=this._easing;let p,g=!1;if(this._type==="wheel"&&u&&h){const b=Math.min((Cn.now()-this._lastWheelEventTime)/200,1);p=Ln(u,l,h(b)),b<1?this._frameId||(this._frameId=!0):g=!0}else p=l,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let v=p-r();return v*this._lastDelta<0&&(v=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:v,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=Ae;if(this._prevEase){const l=this._prevEase,u=(Cn.now()-l.start)/l.duration,h=l.easing(u+.01)-l.easing(u),p=.27/Math.sqrt(h*h+1e-4)*.01;r=ye(p,Math.sqrt(.0729-p*p),.25,1)}return this._prevEase={start:Cn.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Yn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(m.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Dre{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ore{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,r){return t.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(t.shiftKey?-1:1),around:l.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zre{constructor(){this._tap=new u5({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,r,l){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=r[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(t,r,l))}touchmove(t,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=r[0],h=u.y-this._swipePoint.y;return this._swipePoint=u,t.preventDefault(),this._active=!0,{zoomDelta:h/128}}}else this._tap.touchmove(t,r,l)}touchend(t,r,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(t,r,l)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fre{constructor(t,r,l){this._el=t,this._mousePan=r,this._touchPan=l}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nre{constructor(t,r,l){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Bre{constructor(t,r,l,u){this._el=t,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const k3=i=>i.zoom||i.drag||i.pitch||i.rotate;class Ure extends Ht{}class Wre{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const l=ke.sub([],r,t);this.radius=ke.length(l[2]<0?ke.div([],l,this.constants):[l[0],l[1],0])}projectRay(t){ke.div(t,t,this.constants),ke.normalize(t,t),ke.mul(t,t,this.constants);const r=ke.scale([],t,this.radius);if(r[2]>0){const l=ke.scale([],[0,0,1],ke.dot(r,[0,0,1])),u=ke.scale([],ke.normalize([],[r[0],r[1],0]),this.radius),h=ke.add([],r,ke.scale([],ke.sub([],ke.add([],u,l),r),2));r[0]=h[0],r[1]=h[1]}return r}}function D3(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}class Vre{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new yre(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Wre,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),ft(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[m.document,"mousemove",{capture:!0}],[m.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[m,"blur",void 0]];for(const[u,h,p]of this._listeners)u.addEventListener(h,u===m.document?this.handleWindowEvent:this.handleEvent,p)}destroy(){for(const[t,r,l]of this._listeners)t.removeEventListener(r,t===m.document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(t){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new _re(r,t));const u=r.boxZoom=new xre(r,t);this._add("boxZoom",u);const h=new Sre,p=new Ore;r.doubleClickZoom=new Dre(p,h),this._add("tapZoom",h),this._add("clickZoom",p);const g=new zre;this._add("tapDragZoom",g);const v=r.touchPitch=new Pre(r);this._add("touchPitch",v);const b=new Y8(t),x=new K8(t);r.dragRotate=new Nre(t,b,x),this._add("mouseRotate",b,["mousePitch"]),this._add("mousePitch",x,["mouseRotate"]);const S=new Ere(t),T=new Mre(r,t);r.dragPan=new Fre(l,S,T),this._add("mousePan",S),this._add("touchPan",T,["touchZoom","touchRotate"]);const P=new Cre,R=new Tre;r.touchZoomRotate=new Bre(l,R,P,g),this._add("touchRotate",P,["touchPan","touchZoom"]),this._add("touchZoom",R,["touchPan","touchRotate"]),this._add("blockableMapEvent",new bre(r));const z=r.scrollZoom=new kre(r,this);this._add("scrollZoom",z,["mousePan"]);const U=r.keyboard=new Lre;this._add("keyboard",U);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[W]&&r[W].enable(t[W])}_add(t,r,l){this._handlers.push({handlerName:t,handler:r,allowed:l}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!k3(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,r,l){for(const u in t)if(u!==l&&(!r||r.indexOf(u)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const r=[];for(const l of t)this._el.contains(l.target)&&r.push(l);return r}handleEvent(t,r){this._updatingCamera=!0;const l=t.type==="renderFrame",u=l?void 0:t,h={needsRenderFrame:!1},p={},g={},v=t.touches?this._getMapTouches(t.touches):void 0,b=v?xd(this._el,v):l?void 0:El(this._el,t);for(const{handlerName:T,handler:P,allowed:R}of this._handlers){if(!P.isEnabled())continue;let z;this._blockedByActive(g,R,T)?P.reset():P[r||t.type]&&(z=P[r||t.type](t,b,v),this.mergeHandlerResult(h,p,z,T,u),z&&z.needsRenderFrame&&this._triggerRenderFrame()),(z||P.isActive())&&(g[T]=P)}const x={};for(const T in this._previousActiveHandlers)g[T]||(x[T]=u);this._previousActiveHandlers=g,(Object.keys(x).length||D3(h))&&(this._changes.push([h,p,x]),this._triggerRenderFrame()),(Object.keys(g).length||D3(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:S}=h;S&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],S(this._map))}mergeHandlerResult(t,r,l,u,h){if(!l)return;Ue(t,l);const p={handlerName:u,originalEvent:l.originalEvent||h};l.zoomDelta!==void 0&&(r.zoom=p),l.panDelta!==void 0&&(r.drag=p),l.pitchDelta!==void 0&&(r.pitch=p),l.bearingDelta!==void 0&&(r.rotate=p)}_applyChanges(){const t={},r={},l={};for(const[u,h,p]of this._changes)u.panDelta&&(t.panDelta=(t.panDelta||new V(0,0))._add(u.panDelta)),u.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(t.around=u.around),u.aroundCoord!==void 0&&(t.aroundCoord=u.aroundCoord),u.pinchAround!==void 0&&(t.pinchAround=u.pinchAround),u.noInertia&&(t.noInertia=u.noInertia),Ue(r,h),Ue(l,p);this._updateMapTransform(t,r,l),this._changes=[]}_updateMapTransform(t,r,l){const u=this._map,h=u.transform,p=j=>[j.x,j.y,j.z];if((j=>{const Z=this._eventsInProgress.drag;return Z&&!this._handlersById[Z.handlerName].isActive()})()&&!D3(t)){const j=h.zoom;h.cameraElevationReference="sea",this._originalZoom!=null&&h._orthographicProjectionAtLowPitch&&h.projection.name!=="globe"&&h.pitch===0?(h.cameraElevationReference="ground",h.zoom=this._originalZoom):(h.recenterOnTerrain(),h.cameraElevationReference="ground"),j!==h.zoom&&this._map._update(!0)}if(h._isCameraConstrained&&u._stop(!0),!D3(t))return void this._fireEvents(r,l,!0);let{panDelta:g,zoomDelta:v,bearingDelta:b,pitchDelta:x,around:S,aroundCoord:T,pinchAround:P}=t;h._isCameraConstrained&&(v>0&&(v=0),h._isCameraConstrained=!1),P!==void 0&&(S=P),(v||(j=>r[j]&&!this._eventsInProgress[j])("drag"))&&S&&(this._dragOrigin=p(h.pointCoordinate3D(S)),this._originalZoom=h.zoom,this._trackingEllipsoid.setup(h._camera.position,this._dragOrigin)),h.cameraElevationReference="sea",u._stop(!0),S=S||u.transform.centerPoint,b&&(h.bearing+=b),x&&(h.pitch+=x),h._updateCameraState();const R=[0,0,0];if(g)if(h.projection.name==="mercator"){const j=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(S).dir),Z=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(S.sub(g)).dir);R[0]=Z[0]-j[0],R[1]=Z[1]-j[1]}else{const j=h.pointCoordinate(S);if(h.projection.name==="globe"){g=g.rotate(-h.angle);const Z=h._pixelsPerMercatorPixel/h.worldSize;R[0]=-g.x*VC(pr(j.y))*Z,R[1]=-g.y*VC(h.center.lat)*Z}else{const Z=h.pointCoordinate(S.sub(g));j&&Z&&(R[0]=Z.x-j.x,R[1]=Z.y-j.y)}}const z=h.zoom,U=[0,0,0];if(v){const j=p(T||h.pointCoordinate3D(S)),Z={dir:ke.normalize([],ke.sub([],j,h._camera.position))};if(Z.dir[2]<0){const Y=h.zoomDeltaToMovement(j,v);ke.scale(U,Z.dir,Y)}}const W=ke.add(R,R,U);h._translateCameraConstrained(W),v&&Math.abs(h.zoom-z)>1e-4&&h.recenterOnTerrain(),h.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,l,!0)}_fireEvents(t,r,l){const u=k3(this._eventsInProgress),h=k3(t),p={};for(const x in t){const{originalEvent:S}=t[x];this._eventsInProgress[x]||(p[`${x}start`]=S),this._eventsInProgress[x]=t[x]}!u&&h&&this._fireEvent("movestart",h.originalEvent);for(const x in p)this._fireEvent(x,p[x]);h&&this._fireEvent("move",h.originalEvent);for(const x in t){const{originalEvent:S}=t[x];this._fireEvent(x,S)}const g={};let v;for(const x in this._eventsInProgress){const{handlerName:S,originalEvent:T}=this._eventsInProgress[x];this._handlersById[S].isActive()||(delete this._eventsInProgress[x],v=r[S]||T,g[`${x}end`]=v)}for(const x in g)this._fireEvent(x,g[x]);const b=k3(this._eventsInProgress);if(l&&(u||h)&&!b){this._updatingCamera=!0;const x=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),S=T=>T!==0&&-this._bearingSnap<T&&T<this._bearingSnap;x?(S(x.bearing||this._map.getBearing())&&(x.bearing=0),this._map.easeTo(x,{originalEvent:v})):(this._map.fire(new Ht("moveend",{originalEvent:v})),S(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new Ht(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Ure("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const t9="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Gre extends Bn{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=r.respectPrefersReducedMotion!==!1,ft(["_renderFrameCallback"],this)}getCenter(){return new On(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,l){return t=V.convert(t).mult(-1),this.panTo(this.transform.center,Ue({offset:t},r),l)}panTo(t,r,l){return this.easeTo(Ue({center:t},r),l)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,l){return this.easeTo(Ue({zoom:t},r),l)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,l){return this.easeTo(Ue({bearing:t},r),l)}resetNorth(t,r){return this.rotateTo(0,Ue({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(Ue({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Il.convert(t);const l=r&&r.bearing||0,u=r&&r.pitch||0,h=t.getNorthWest(),p=t.getSouthEast();return this._cameraForBounds(this.transform,h,p,l,u,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if(typeof(t=Ue({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const l=t.padding;t.padding={top:l,bottom:l,right:l,left:l}}return t.padding=Ue(r,t.padding),t}_minimumAABBFrustumDistance(t,r){const l=r.max[0]-r.min[0],u=r.max[1]-r.min[1];return l/u>t.aspect?l/(2*Math.tan(.5*t.fovX)*t.aspect):u/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,r,l,u,h,p){const g=t.clone(),v=this._extendCameraOptions(p);g.bearing=u,g.pitch=h;const b=On.convert(r),x=On.convert(l),S=.5*(b.lat+x.lat),T=.5*(b.lng+x.lng),P=ks(S,T),R=ke.normalize([],P),z=ke.normalize([],ke.cross([],R,[0,1,0])),U=ke.cross([],z,R),W=[z[0],z[1],z[2],0,U[0],U[1],U[2],0,R[0],R[1],R[2],0,0,0,0,1],j=[P,ks(b.lat,b.lng),ks(x.lat,b.lng),ks(x.lat,x.lng),ks(b.lat,x.lng),ks(S,b.lng),ks(S,x.lng),ks(b.lat,T),ks(x.lat,T)];let Z=di.fromPoints(j.map(Ve=>[ke.dot(z,Ve),ke.dot(U,Ve),ke.dot(R,Ve)]));const Y=ke.transformMat4([],Z.center,W);ke.squaredLength(Y)===0&&ke.set(Y,0,0,1),ke.normalize(Y,Y),ke.scale(Y,Y,os),g.center=function([Ve,at,mt]){const lt=Math.hypot(Ve,at,mt),Ct=Math.atan2(Ve,mt),zt=.5*Math.PI-Math.acos(-at/lt);return new On(fe(Ct),fe(zt))}(Y);const $=g.getWorldToCameraMatrix(),K=nt.invert(new Float64Array(16),$);Z=di.applyTransform(Z,nt.multiply([],$,W)),ke.transformMat4(Y,Y,$);const ae=.5*(Z.max[2]-Z.min[2]),se=this._minimumAABBFrustumDistance(g,Z),de=ke.scale([],[0,0,1],ae),ge=ke.add(de,Y,de),Te=se+(g.pitch===0?0:ke.distance(Y,ge)),we=g.globeCenterInViewSpace,Ie=ke.sub([],Y,[we[0],we[1],we[2]]);ke.normalize(Ie,Ie),ke.scale(Ie,Ie,Te);const xe=ke.add([],Y,Ie);ke.transformMat4(xe,xe,K);const We=Ky/os,qe=ke.length(xe),Qe=ja(Math.max(qe*We-Ky,Number.EPSILON),0),Ne=Math.min(g.zoomFromMercatorZAdjusted(Qe),v.maxZoom);return Ne>.5*(Y_+pf)?(g.setProjection({name:"mercator"}),g.zoom=Ne,this._cameraForBounds(g,r,l,u,h,p)):{center:g.center,zoom:Ne,bearing:u,pitch:h}}queryTerrainElevation(t,r){const l=this.transform.elevation;return l?(r=Ue({},{exaggerated:!0},r),l.getAtPoint(ga.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,l,u,h,p){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,r,l,u,h,p);const g=t.clone(),v=this._extendCameraOptions(p),b=g.padding;g.bearing=u,g.pitch=h;const x=On.convert(r),S=On.convert(l),T=new On(x.lng,S.lat),P=new On(S.lng,x.lat),R=g.project(x),z=g.project(S),U=this.queryTerrainElevation(x),W=this.queryTerrainElevation(S),j=this.queryTerrainElevation(T),Z=this.queryTerrainElevation(P),Y=[[R.x,R.y,Math.min(U||0,W||0,j||0,Z||0)],[z.x,z.y,Math.max(U||0,W||0,j||0,Z||0)]];let $=di.fromPoints(Y);const K=g.getWorldToCameraMatrix(),ae=nt.invert(new Float64Array(16),K);$=di.applyTransform($,K);const se=ke.sub([],$.max,$.min),de=b.left||0,ge=b.right||0,Te=b.bottom||0,we=b.top||0,{left:Ie,right:xe,top:We,bottom:qe}=v.padding,Qe=.5*(de+ge),Ne=.5*(we+Te),Ve=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(de+ge+Ie+xe))/se[0],(g.height-(Te+we+qe+We))/se[1])),v.maxZoom),at=g.scale/g.zoomScale(Ve);$=new di([$.min[0]-(Ie+Qe)*at,$.min[1]-(qe+Ne)*at,$.min[2]],[$.max[0]+(xe+Qe)*at,$.max[1]+(We+Ne)*at,$.max[2]]);const mt=.5*se[2],lt=this._minimumAABBFrustumDistance(g,$),Ct=[0,0,1,0];Va.transformMat4(Ct,Ct,K),Va.normalize(Ct,Ct);const zt=ke.scale([],Ct,lt+mt),bt=ke.add([],$.center,zt),Et=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new V(v.offset.x,v.offset.y):V.convert(v.offset)).rotate(-be(u));$.center[0]-=Et.x*at,$.center[1]+=Et.y*at,ke.transformMat4($.center,$.center,ae),ke.transformMat4(bt,bt,ae);const en=[$.center[0],$.center[1],bt[2]*g.pixelsPerMeter];ke.scale(en,en,1/g.worldSize);const on=il(en[0]),rn=pr(en[1]),cn=Math.min(g._zoomFromMercatorZ(en[2]),v.maxZoom),gn=new On(on,rn);return g.mercatorFromTransition&&cn<.5*(Y_+pf)?(g.setProjection({name:"globe"}),g.zoom=cn,this._cameraForBounds(g,r,l,u,h,p)):{center:gn,zoom:cn,bearing:u,pitch:h}}fitBounds(t,r,l){const u=this.cameraForBounds(t,r);return this._fitInternal(u,r,l)}fitScreenCoordinates(t,r,l,u,h){const p=V.convert(t),g=V.convert(r),v=new V(Math.min(p.x,g.x),Math.min(p.y,g.y)),b=new V(Math.max(p.x,g.x),Math.max(p.y,g.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(p,g))return this;const x=this.transform.pointLocation3D(v),S=this.transform.pointLocation3D(b),T=this.transform.pointLocation3D(new V(v.x,b.y)),P=this.transform.pointLocation3D(new V(b.x,v.y)),R=[Math.min(x.lng,S.lng,T.lng,P.lng),Math.min(x.lat,S.lat,T.lat,P.lat)],z=[Math.max(x.lng,S.lng,T.lng,P.lng),Math.max(x.lat,S.lat,T.lat,P.lat)],U=u&&u.pitch?u.pitch:this.getPitch(),W=this._cameraForBounds(this.transform,R,z,l,U,u);return this._fitInternal(W,u,h)}_fitInternal(t,r,l){return t?(delete(r=Ue(t,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(t,r){this.stop();const l=t.preloadOnly?this.transform.clone():this.transform;let u=!1,h=!1,p=!1;return"zoom"in t&&l.zoom!==+t.zoom&&(u=!0,l.zoom=+t.zoom),t.center!==void 0&&(l.center=On.convert(t.center)),"bearing"in t&&l.bearing!==+t.bearing&&(h=!0,l.bearing=+t.bearing),"pitch"in t&&l.pitch!==+t.pitch&&(p=!0,l.pitch=+t.pitch),t.padding==null||l.isPaddingEqual(t.padding)||(l.padding=t.padding),t.preloadOnly?(this._preloadTiles(l),this):(this.fire(new Ht("movestart",r)).fire(new Ht("move",r)),u&&this.fire(new Ht("zoomstart",r)).fire(new Ht("zoom",r)).fire(new Ht("zoomend",r)),h&&this.fire(new Ht("rotatestart",r)).fire(new Ht("rotate",r)).fire(new Ht("rotateend",r)),p&&this.fire(new Ht("pitchstart",r)).fire(new Ht("pitch",r)).fire(new Ht("pitchend",r)),this.fire(new Ht("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||ve(t9),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const l=this.transform;if(!l.projection.supportsFreeCamera)return ve(t9),this;this.stop();const u=l.zoom,h=l.pitch,p=l.bearing;l.setFreeCameraOptions(t);const g=u!==l.zoom,v=h!==l.pitch,b=p!==l.bearing;return this.fire(new Ht("movestart",r)).fire(new Ht("move",r)),g&&this.fire(new Ht("zoomstart",r)).fire(new Ht("zoom",r)).fire(new Ht("zoomend",r)),b&&this.fire(new Ht("rotatestart",r)).fire(new Ht("rotate",r)).fire(new Ht("rotateend",r)),v&&this.fire(new Ht("pitchstart",r)).fire(new Ht("pitch",r)).fire(new Ht("pitchend",r)),this.fire(new Ht("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),((t=Ue({offset:[0,0],duration:500,easing:Ae},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const l=this.transform,u=this.getZoom(),h=this.getBearing(),p=this.getPitch(),g=this.getPadding(),v="zoom"in t?+t.zoom:u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,x="pitch"in t?+t.pitch:p,S="padding"in t?t.padding:l.padding,T=V.convert(t.offset);let P,R,z;if(l.projection.name==="globe"){const de=ga.fromLngLat(l.center),ge=T.rotate(-l.angle);de.x+=ge.x/l.worldSize,de.y+=ge.y/l.worldSize;const Te=de.toLngLat(),we=On.convert(t.center||Te);this._normalizeCenter(we),P=l.centerPoint.add(ge),R=new V(de.x,de.y).mult(l.worldSize),z=new V(go(we.lng),Eo(we.lat)).mult(l.worldSize).sub(R)}else{P=l.centerPoint.add(T);const de=l.pointLocation(P),ge=On.convert(t.center||de);this._normalizeCenter(ge),R=l.project(de),z=l.project(ge).sub(R)}const U=l.zoomScale(v-u);let W,j;t.around&&(W=On.convert(t.around),j=l.locationPoint(W));const Z=this._zooming||v!==u,Y=this._rotating||h!==b,$=this._pitching||x!==p,K=!l.isPaddingEqual(S),ae=de=>ge=>{if(Z&&(de.zoom=Ln(u,v,ge)),Y&&(de.bearing=Ln(h,b,ge)),$&&(de.pitch=Ln(p,x,ge)),K&&(de.interpolatePadding(g,S,ge),P=de.centerPoint.add(T)),W)de.setLocationAtPoint(W,j);else{const Te=de.zoomScale(de.zoom-u),we=v>u?Math.min(2,U):Math.max(.5,U),Ie=Math.pow(we,1-ge),xe=de.unproject(R.add(z.mult(ge*Ie)).mult(Te));de.setLocationAtPoint(de.renderWorldCopies?xe.wrap():xe,P)}return t.preloadOnly||this._fireMoveEvents(r),de};if(t.preloadOnly){const de=this._emulate(ae,t.duration,l);return this._preloadTiles(de),this}const se={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Z,this._rotating=Y,this._pitching=$,this._padding=K,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,se),this._ease(ae(l),de=>{l.cameraElevationReference==="sea"&&l.recenterOnTerrain(),this._afterEase(r,de)},t),this}_prepareEase(t,r,l={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),r||l.moving||this.fire(new Ht("movestart",t)),this._zooming&&!l.zooming&&this.fire(new Ht("zoomstart",t)),this._rotating&&!l.rotating&&this.fire(new Ht("rotatestart",t)),this._pitching&&!l.pitching&&this.fire(new Ht("pitchstart",t))}_fireMoveEvents(t){this.fire(new Ht("move",t)),this._zooming&&this.fire(new Ht("zoom",t)),this._rotating&&this.fire(new Ht("rotate",t)),this._pitching&&this.fire(new Ht("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const l=this._zooming,u=this._rotating,h=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new Ht("zoomend",t)),u&&this.fire(new Ht("rotateend",t)),h&&this.fire(new Ht("pitchend",t)),this.fire(new Ht("moveend",t))}flyTo(t,r){if(this._prefersReducedMotion(t)){const Ve=ht(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ve,r)}this.stop(),t=Ue({offset:[0,0],speed:1.2,curve:1.42,easing:Ae},t);const l=this.transform,u=this.getZoom(),h=this.getBearing(),p=this.getPitch(),g=this.getPadding(),v="zoom"in t?ne(+t.zoom,l.minZoom,l.maxZoom):u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,x="pitch"in t?+t.pitch:p,S="padding"in t?t.padding:l.padding,T=l.zoomScale(v-u),P=V.convert(t.offset);let R=l.centerPoint.add(P);const z=l.pointLocation(R),U=On.convert(t.center||z);this._normalizeCenter(U);const W=l.project(z),j=l.project(U).sub(W);let Z=t.curve;const Y=Math.max(l.width,l.height),$=Y/T,K=j.mag();if("minZoom"in t){const Ve=ne(Math.min(t.minZoom,u,v),l.minZoom,l.maxZoom),at=Y/l.zoomScale(Ve-u);Z=Math.sqrt(at/K*2)}const ae=Z*Z;function se(Ve){const at=($*$-Y*Y+(Ve?-1:1)*ae*ae*K*K)/(2*(Ve?$:Y)*ae*K);return Math.log(Math.sqrt(at*at+1)-at)}function de(Ve){return(Math.exp(Ve)-Math.exp(-Ve))/2}function ge(Ve){return(Math.exp(Ve)+Math.exp(-Ve))/2}const Te=se(0);let we=function(Ve){return ge(Te)/ge(Te+Z*Ve)},Ie=function(Ve){return Y*((ge(Te)*(de(at=Te+Z*Ve)/ge(at))-de(Te))/ae)/K;var at},xe=(se(1)-Te)/Z;if(Math.abs(K)<1e-6||!isFinite(xe)){if(Math.abs(Y-$)<1e-6)return this.easeTo(t,r);const Ve=$<Y?-1:1;xe=Math.abs(Math.log($/Y))/Z,Ie=function(){return 0},we=function(at){return Math.exp(Ve*Z*at)}}t.duration="duration"in t?+t.duration:1e3*xe/("screenSpeed"in t?+t.screenSpeed/Z:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const We=h!==b,qe=x!==p,Qe=!l.isPaddingEqual(S),Ne=Ve=>at=>{const mt=at*xe,lt=1/we(mt);Ve.zoom=at===1?v:u+Ve.scaleZoom(lt),We&&(Ve.bearing=Ln(h,b,at)),qe&&(Ve.pitch=Ln(p,x,at)),Qe&&(Ve.interpolatePadding(g,S,at),R=Ve.centerPoint.add(P));const Ct=at===1?U:Ve.unproject(W.add(j.mult(Ie(mt))).mult(lt));return Ve.setLocationAtPoint(Ve.renderWorldCopies?Ct.wrap():Ct,R),Ve._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),Ve};if(t.preloadOnly){const Ve=this._emulate(Ne,t.duration,l);return this._preloadTiles(Ve),this}return this._zooming=!0,this._rotating=We,this._pitching=qe,this._padding=Qe,this._prepareEase(r,!1),this._ease(Ne(l),()=>this._afterEase(r),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const l=this._onEaseEnd;this._onEaseEnd=void 0,l.call(this,r)}if(!t){const l=this.handlers;l&&l.stop(!1)}return this}_ease(t,r,l){l.animate===!1||l.duration===0?(t(1),r()):(this._easeStart=Cn.now(),this._easeOptions=l,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Cn.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=Ye(t,-180,180);const l=Math.abs(t-r);return Math.abs(t-360-r)<l&&(t-=360),Math.abs(t+360-r)<l&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(!r.renderWorldCopies||r.maxBounds)return;const l=t.lng-r.center.lng;t.lng+=l>180?-360:l<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Cn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,r,l){const u=Math.ceil(15*r/1e3),h=[],p=t(l.clone());for(let g=0;g<=u;g++){const v=p(g/u);h.push(v.clone())}return h}}class n9{constructor(t={}){this.options=t,ft(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const r=this.options&&this.options.compact;return this._map=t,this._container=Yn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Yn("button","mapboxgl-ctrl-attrib-button",this._container),Yn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Yn("div","mapboxgl-ctrl-attrib-inner",this._container),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),r===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,r){const l=this._map._getUIString(`AttributionControl.${r}`);t.setAttribute("aria-label",l),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",l)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||w.ACCESS_TOKEN}];if(t){const l=r.reduce((u,h,p)=>(h.value&&(u+=`${h.key}=${h.value}${p<r.length-1?"&":""}`),u),"?");t.href=`${w.FEEDBACK_URL}/${l}#${Z8(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style._sourceCaches;for(const u in r){const h=r[u];if(h.used){const p=h.getSource();p.attribution&&t.indexOf(p.attribution)<0&&t.push(p.attribution)}}t.sort((u,h)=>u.length-h.length),t=t.filter((u,h)=>{for(let p=h+1;p<t.length;p++)if(t[p].indexOf(u)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const l=t.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,t.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class a9{constructor(){ft(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Yn("div","mapboxgl-ctrl");const r=Yn("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const r in t){const l=t[r].getSource();if(l.hasOwnProperty("mapbox_logo")&&!l.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const r=t[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class i9{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const u of l)if(u.id===t)return void(u.cancelled=!0)}run(t=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function r9(i,t,r){if(i=new On(i.lng,i.lat),t){const l=new On(i.lng-360,i.lat),u=new On(i.lng+360,i.lat),h=360*Math.ceil(Math.abs(i.lng-r.center.lng)/360),p=r.locationPoint(i).distSqr(t),g=t.x<0||t.y<0||t.x>r.width||t.y>r.height;r.locationPoint(l).distSqr(t)<p&&(g||Math.abs(l.lng-r.center.lng)<h)?i=l:r.locationPoint(u).distSqr(t)<p&&(g||Math.abs(u.lng-r.center.lng)<h)&&(i=u)}for(;Math.abs(i.lng-r.center.lng)>180;){const l=r.locationPoint(i);if(l.x>=0&&l.y>=0&&l.x<=r.width&&l.y<=r.height)break;i.lng>r.center.lng?i.lng-=360:i.lng+=360}return i}const p5={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class m5 extends Bn{constructor(t,r){if(super(),(t instanceof m.HTMLElement||r)&&(t=Ue({element:t},r)),ft(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=V.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Yn("div");const h=41,p=27,g=Vi("svg",{display:"block",height:h*this._scale+"px",width:p*this._scale+"px",viewBox:`0 0 ${p} ${h}`},this._element),v=Vi("radialGradient",{id:"shadowGradient"},Vi("defs",{},g));Vi("stop",{offset:"10%","stop-opacity":.4},v),Vi("stop",{offset:"100%","stop-opacity":.05},v),Vi("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),Vi("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),Vi("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),Vi("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=V.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()});const l=this._element.classList;for(const h in p5)l.remove(`mapboxgl-marker-anchor-${h}`);l.add(`mapboxgl-marker-anchor-${this._anchor}`);const u=t&&t.className?t.className.trim().split(/\s+/):[];l.add(...u),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=On.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const u=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const r=t.code,l=t.charCode||t.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()}_onMapClick(t){const r=t.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,r=this._pos;if(!t||!r)return!1;const l=t.unproject(r),u=t.getFreeCameraOptions();if(!u.position)return!1;const h=u.position.toLngLat();return h.distanceTo(l)<.9*h.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const l=t.unproject(r);let u;t._showingGlobe()&&b2(t.transform,this._lngLat)?u=0:(u=1-t._queryFogOpacity(l),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(u*=this._occludedOpacity)),this._element.style.opacity=`${u}`,this._element.style.pointerEvents=u>0?"auto":"none",this._popup&&this._popup._setOpacity(u),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${p5[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${r.x}px,${r.y}px)
        `}_calculateXYTransform(){const t=this._pos,r=this._map,l=this.getPitchAlignment();if(!r||!t||l!=="map")return"";if(!r._showingGlobe()){const v=r.getPitch();return v?`rotateX(${v}deg)`:""}const u=fe(jz(r.transform,this._lngLat)),h=t.sub(Hz(r.transform)),p=Math.abs(h.x)+Math.abs(h.y);if(p===0)return"";const g=u/p;return`rotateX(${-h.y*g}deg) rotateY(${h.x*g}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let l=0;const u=this.getRotationAlignment();if(u==="map")if(r._showingGlobe()){const h=r.project(new On(this._lngLat.lng,this._lngLat.lat+.001)),p=r.project(new On(this._lngLat.lng,this._lngLat.lat-.001)).sub(h);l=fe(Math.atan2(p.y,p.x))-90}else l=-r.getBearing();else if(u==="horizon"){const h=Ee(4,6,r.getZoom()),p=Hz(r.transform);p.y+=h*r.transform.height;const g=t.sub(p),v=fe(Math.atan2(g.y,g.x));l=(v>90?v-270:v+90)*(1-h)}return l+=this._rotation,l?`rotateZ(${l}deg)`:""}_update(t){m.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=r9(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),t===!0?this._updateFrameId=m.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=V.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const r=this._map;if(!r)return;const l=this._pointerdownPos,u=this._positionDelta;if(l&&u){if(!this._isDragging){const h=this._clickTolerance||r._clickTolerance;if(t.point.dist(l)<h)return;this._isDragging=!0}this._pos=t.point.sub(u),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Ht("dragstart"))),this.fire(new Ht("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new Ht("dragend")),this._state="inactive"}_addDragHandler(t){const r=this._map,l=this._pos;r&&l&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(l),this._pointerdownPos=t.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const r=this._map;return r&&(t?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Hre={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},jre=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function o9(i=new V(0,0),t="bottom"){if(typeof i=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(i,2)));switch(t){case"top":return new V(0,i);case"top-left":return new V(r,r);case"top-right":return new V(-r,r);case"bottom":return new V(0,-i);case"bottom-left":return new V(r,-r);case"bottom-right":return new V(-r,-r);case"left":return new V(i,0);case"right":return new V(-i,0)}return new V(0,0)}return i instanceof V||Array.isArray(i)?V.convert(i):V.convert(i[t]||[0,0])}class $re{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=Re((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,r,l){this._start=this.getValue(r),this._end=t,this._startTime=r,this._endTime=r+l}}const qre={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Xre={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Zre={showCompass:!0,showZoom:!0,visualizePitch:!1};class Yre{constructor(t,r,l=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new Y8({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,l&&(this.mousePitch=new K8({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),ft(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,r){this.mouseRotate.mousedown(t,r),this.mousePitch&&this.mousePitch.mousedown(t,r),Ip()}move(t,r){const l=this.map,u=this.mouseRotate.mousemoveWindow(t,r),h=u&&u.bearingDelta;if(h&&l.setBearing(l.getBearing()+h),this.mousePitch){const p=this.mousePitch.mousemoveWindow(t,r),g=p&&p.pitchDelta;g&&l.setPitch(l.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Jl(),m.removeEventListener("mousemove",this.mousemove),m.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Ue({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),El(this.element,t)),m.addEventListener("mousemove",this.mousemove),m.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,El(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=xd(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=xd(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Kre={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Jre={maxWidth:100,unit:"metric"},Qre={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},O3={version:y,supported:Ra,setRTLTextPlugin:function(i,t,r=!1){if(Nr===Uy||Nr===Wy||Nr===zc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fc=Cn.resolveURL(i),Nr=Uy,B_=t,U_(),r||s2()},getRTLTextPluginStatus:W_,Map:class extends Gre{constructor(i){if(Xi.mark(ei.create),(i=Ue({},Xre,i)).minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(i.antialias&&function(t){const r=t.navigator?t.navigator.userAgent:null;return!!function(l){if(pt==null){const u=l.navigator?l.navigator.userAgent:null;pt=!!l.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return pt}(t)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(m)&&(i.antialias=!1,ve("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new PP(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),i),this._interactive=i.interactive,this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=i.preserveDrawingBuffer,this._antialias=i.antialias,this._trackResize=i.trackResize,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=i.crossSourceCollisions,this._collectResourceTiming=i.collectResourceTiming,this._language=this._parseLanguage(i.language),this._worldview=i.worldview,this._renderTaskQueue=new i9,this._domRenderTaskQueue=new i9,this._controls=[],this._markers=[],this._popups=[],this._mapId=Rt(),this._locale=Ue({},qre,i.locale),this._clickTolerance=i.clickTolerance,this._cooperativeGestures=i.cooperativeGestures,this._performanceMetricsCollection=i.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new $re(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new nn(i.transformRequest,i.accessToken,i.testMode),this._silenceAuthErrors=!!i.testMode,typeof i.container=="string"){if(this._container=m.document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container.toString()}' not found.`)}else{if(!(i.container instanceof m.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(this._container.childNodes.length>0&&ve("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),i.maxBounds&&this.setMaxBounds(i.maxBounds),ft(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),m!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in m.document?"fullscreenchange":"webkitfullscreenchange",m.addEventListener("online",this._onWindowOnline,!1),m.addEventListener("resize",this._onWindowResize,!1),m.addEventListener("orientationchange",this._onWindowResize,!1),m.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),m.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Vre(this,i),this._localFontFamily=i.localFontFamily,this._localIdeographFontFamily=i.localIdeographFontFamily,(i.style||!i.testMode)&&this.setStyle(i.style||w.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),i.projection&&this.setProjection(i.projection),i.hash&&(this._hash=new hre(typeof i.hash=="string"&&i.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch});const t=i.bounds;t&&(this.resize(),this.fitBounds(t,Ue({},i.fitBoundsOptions,{duration:0})))}this.resize(),i.attributionControl&&this.addControl(new n9({customAttribution:i.customAttribution})),this._logoControl=new a9,this.addControl(this._logoControl,i.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new Ht(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new Ht(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(i,t){if(t===void 0&&(t=i.getDefaultPosition?i.getDefaultPosition():"top-right"),!i||!i.onAdd)return this.fire(new vn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=i.onAdd(this);this._controls.push(i);const l=this._controlPositions[t];return t.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(i){if(!i||!i.onRemove)return this.fire(new vn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(i);return t>-1&&this._controls.splice(t,1),i.onRemove(this),this}hasControl(i){return this._controls.indexOf(i)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(i){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new Ht("movestart",i)).fire(new Ht("move",i)),this.fire(new Ht("resize",i)),t&&this.fire(new Ht("moveend",i)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(i){return this.transform.setMaxBounds(Il.convert(i)),this._update()}setMinZoom(i){if((i=i??-2)>=-2&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this._update(),this.getZoom()<i?this.setZoom(i):this.fire(new Ht("zoomstart")).fire(new Ht("zoom")).fire(new Ht("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(i){if((i=i??22)>=this.transform.minZoom)return this.transform.maxZoom=i,this._update(),this.getZoom()>i?this.setZoom(i):this.fire(new Ht("zoomstart")).fire(new Ht("zoom")).fire(new Ht("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(i){if((i=i??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(i>=0&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this._update(),this.getPitch()<i?this.setPitch(i):this.fire(new Ht("pitchstart")).fire(new Ht("pitch")).fire(new Ht("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(i){if((i=i??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this._update(),this.getPitch()>i?this.setPitch(i):this.fire(new Ht("pitchstart")).fire(new Ht("pitch")).fire(new Ht("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(i){return this.transform.renderWorldCopies=i,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(i){return i==="auto"?m.navigator.language:Array.isArray(i)?i.length===0?void 0:i.map(t=>t==="auto"?m.navigator.language:t):i}setLanguage(i){const t=this._parseLanguage(i);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(i){return this.style&&i!==this._worldview?(this._worldview=i,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(i){return this._lazyInitEmptyStyle(),i?typeof i=="string"&&(i={name:i}):i=null,this._useExplicitProjection=!!i,this._prioritizeAndUpdateProjection(i,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const i=this.transform,t=i.projection.name;let r;t==="globe"&&i.zoom>=pf?(i.setMercatorFromTransition(),r=!0):t==="mercator"&&i.zoom<pf&&(i.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(i,t){return this._updateProjection(i||t||{name:"mercator"})}_updateProjection(i){let t;if(t=i.name==="globe"&&this.transform.zoom>=pf?this.transform.setMercatorFromTransition():this.transform.setProjection(i),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const r in this.style._sourceCaches)this.style._sourceCaches[r].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(i){return this.transform.locationPoint3D(On.convert(i))}unproject(i){return this.transform.pointLocation3D(V.convert(i))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(i,t,r){if(i==="mouseenter"||i==="mouseover"){let l=!1;const u=p=>{const g=t.filter(b=>this.getLayer(b)),v=g.length?this.queryRenderedFeatures(p.point,{layers:g}):[];v.length?l||(l=!0,r.call(this,new kl(i,this,p.originalEvent,{features:v}))):l=!1},h=()=>{l=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}if(i==="mouseleave"||i==="mouseout"){let l=!1;const u=p=>{const g=t.filter(v=>this.getLayer(v));(g.length?this.queryRenderedFeatures(p.point,{layers:g}):[]).length?l=!0:l&&(l=!1,r.call(this,new kl(i,this,p.originalEvent)))},h=p=>{l&&(l=!1,r.call(this,new kl(i,this,p.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}{const l=u=>{const h=t.filter(g=>this.getLayer(g)),p=h.length?this.queryRenderedFeatures(u.point,{layers:h}):[];p.length&&(u.features=p,r.call(this,u),delete u.features)};return{layers:new Set(t),listener:r,delegates:{[i]:l}}}}on(i,t,r){if(r===void 0)return super.on(i,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const l=this._createDelegatedListener(i,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[i]=this._delegatedListeners[i]||[],this._delegatedListeners[i].push(l);for(const u in l.delegates)this.on(u,l.delegates[u]);return this}once(i,t,r){if(r===void 0)return super.once(i,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const l=this._createDelegatedListener(i,t,r);for(const u in l.delegates)this.once(u,l.delegates[u]);return this}off(i,t,r){if(r===void 0)return super.off(i,t);t=new Set(Array.isArray(t)?t:[t]);for(const h of t)if(!this._isValidId(h))return this;const l=(h,p)=>{if(h.size!==p.size)return!1;for(const g of h)if(!p.has(g))return!1;return!0},u=this._delegatedListeners?this._delegatedListeners[i]:void 0;return u&&(h=>{for(let p=0;p<h.length;p++){const g=h[p];if(g.listener===r&&l(g.layers,t)){for(const v in g.delegates)this.off(v,g.delegates[v]);return h.splice(p,1),this}}})(u),this}queryRenderedFeatures(i,t){if(!this.style)return[];if(t!==void 0||i===void 0||i instanceof V||Array.isArray(i)||(t=i,i=void 0),i=i||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const r of t.layers)if(!this._isValidId(r))return[]}return this.style.queryRenderedFeatures(i,t,this.transform)}querySourceFeatures(i,t){return this._isValidId(i)?this.style.querySourceFeatures(i,t):[]}isPointOnSurface(i){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&ve(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(V.convert(i))}setStyle(i,t){return(t=Ue({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&i?(this._diffStyle(i,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(i,t))}_getUIString(i){const t=this._locale[i];if(t==null)throw new Error(`Missing UI string '${i}'`);return t}_updateStyle(i,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),i&&(this.style=new qc(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof i=="string"?this.style.loadURL(i):this.style.loadJSON(i)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new qc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(i,t){if(typeof i=="string"){const r=this._requestManager.normalizeStyleURL(i),l=this._requestManager.transformRequest(r,Se.Style);et(l,(u,h)=>{u?this.fire(new vn(u)):h&&this._updateDiff(h,t)})}else typeof i=="object"&&this._updateDiff(i,t)}_updateDiff(i,t){try{this.style.setState(i)&&this._update(!0)}catch(r){ve(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(i,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(ve("There is no style added to the map."),!1)}_isValidId(i){return!function(t){return t.indexOf("")>=0}(i)||(this.fire(new vn(new Error(`IDs can't contain special symbols: "${i}".`))),!1)}addSource(i,t){return this._isValidId(i)?(this._lazyInitEmptyStyle(),this.style.addSource(i,t),this._update(!0)):this}isSourceLoaded(i){return!!this._isValidId(i)&&!!this.style&&this.style._isSourceCacheLoaded(i)}areTilesLoaded(){const i=this.style&&this.style._sourceCaches;for(const t in i){const r=i[t]._tiles;for(const l in r){const u=r[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}addSourceType(i,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(i,t,r)}removeSource(i){return this._isValidId(i)?(this.style.removeSource(i),this._updateTerrain(),this._update(!0)):this}getSource(i){return this._isValidId(i)?this.style.getOwnSource(i):null}addImage(i,t,{pixelRatio:r=1,sdf:l=!1,stretchX:u,stretchY:h,content:p}={}){if(this._lazyInitEmptyStyle(),t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap){const{width:g,height:v,data:b}=Cn.getImageData(t);this.style.addImage(i,{data:new $i({width:g,height:v},b),pixelRatio:r,stretchX:u,stretchY:h,content:p,sdf:l,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new vn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:v}=t,b=t;this.style.addImage(i,{data:new $i({width:g,height:v},new Uint8Array(b.data)),pixelRatio:r,stretchX:u,stretchY:h,content:p,sdf:l,version:0,userImage:b}),b.onAdd&&b.onAdd(this,i)}}updateImage(i,t){this._lazyInitEmptyStyle();const r=this.style.getImage(i);if(!r)return void this.fire(new vn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap?Cn.getImageData(t):t,{width:u,height:h}=l;u!==void 0&&h!==void 0?u===r.data.width&&h===r.data.height?(r.data.replace(l.data,!(t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap)),this.style.updateImage(i,r)):this.fire(new vn(new Error(`The width and height of the updated image (${u}, ${h})
                must be that same as the previous version of the image
                (${r.data.width}, ${r.data.height})`))):this.fire(new vn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(i){return i?!!this.style&&!!this.style.getImage(i):(this.fire(new vn(new Error("Missing required image id"))),!1)}removeImage(i){this.style.removeImage(i)}loadImage(i,t){Qt(this._requestManager.transformRequest(i,Se.Image),(r,l)=>{t(r,l instanceof m.HTMLImageElement?Cn.getImageData(l):l)})}listImages(){return this.style.listImages()}addModel(i,t){this._lazyInitEmptyStyle(),this.style.addModel(i,t)}hasModel(i){return i?this.style.hasModel(i):(this.fire(new vn(new Error("Missing required model id"))),!1)}removeModel(i){this.style.removeModel(i)}listModels(){return this.style.listModels()}addLayer(i,t){return this._isValidId(i.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(i,t),this._update(!0)):this}moveLayer(i,t){return this._isValidId(i)?(this.style.moveLayer(i,t),this._update(!0)):this}removeLayer(i){return this._isValidId(i)?(this.style.removeLayer(i),this._update(!0)):this}setLights(i){if(this._lazyInitEmptyStyle(),i&&i.length===1&&i[0].type==="flat"){const t=i[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(i),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const i=this.style.getLights()||[];return i.length===0&&i.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),i}getLayer(i){return this._isValidId(i)?this.style.getOwnLayer(i):null}setLayerZoomRange(i,t,r){return this._isValidId(i)?(this.style.setLayerZoomRange(i,t,r),this._update(!0)):this}setFilter(i,t,r={}){return this._isValidId(i)?(this.style.setFilter(i,t,r),this._update(!0)):this}getFilter(i){return this._isValidId(i)?this.style.getFilter(i):null}setPaintProperty(i,t,r,l={}){return this._isValidId(i)?(this.style.setPaintProperty(i,t,r,l),this._update(!0)):this}getPaintProperty(i,t){return this._isValidId(i)?this.style.getPaintProperty(i,t):null}setLayoutProperty(i,t,r,l={}){return this._isValidId(i)?(this.style.setLayoutProperty(i,t,r,l),this._update(!0)):this}getLayoutProperty(i,t){return this._isValidId(i)?this.style.getLayoutProperty(i,t):null}setConfigProperty(i,t,r){return this.style.setConfigProperty(i,t,r),this._update(!0)}setLight(i,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:i}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(i){return this._lazyInitEmptyStyle(),!i&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(i),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(i){return this._lazyInitEmptyStyle(),this.style.setFog(i),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(i){return this.style.setCamera(i),this._triggerCameraUpdate(i)}_triggerCameraUpdate(i){return this._update(this.transform.setOrthographicProjectionAtLowPitch(i["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(i){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(On.convert(i),this.transform):0}setFeatureState(i,t){return this._isValidId(i.source)?(this.style.setFeatureState(i,t),this._update()):this}removeFeatureState(i,t){return this._isValidId(i.source)?(this.style.removeFeatureState(i,t),this._update()):this}getFeatureState(i){return this._isValidId(i.source)?this.style.getFeatureState(i):null}_updateContainerDimensions(){if(!this._container)return;const i=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let r,l,u,h=this._container;for(;h&&(!l||!u);){const p=m.getComputedStyle(h).transform;p&&p!=="none"&&(r=p.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&r[0]!=="0"&&r[0]!=="1"&&(l=r[0]),r[3]&&r[3]!=="0"&&r[3]!=="1"&&(u=r[3])),h=h.parentElement}this._containerWidth=l?Math.abs(i/l):i,this._containerHeight=u?Math.abs(t/u):t}_detectMissingCSS(){m.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&ve("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const i=this._container;i.classList.add("mapboxgl-map"),(this._missingCSSCanary=Yn("div","mapboxgl-canary",i)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Yn("div","mapboxgl-canvas-container",i);this._canvas=Yn("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=Yn("div","mapboxgl-control-container",i),l=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{l[u]=Yn("div",`mapboxgl-ctrl-${u}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(i,t){const r=Cn.devicePixelRatio||1;this._canvas.width=r*Math.ceil(i),this._canvas.height=r*Math.ceil(t),this._canvas.style.width=`${i}px`,this._canvas.style.height=`${t}px`}_addMarker(i){this._markers.push(i)}_removeMarker(i){const t=this._markers.indexOf(i);t!==-1&&this._markers.splice(t,1)}_addPopup(i){this._popups.push(i)}_removePopup(i){const t=this._popups.indexOf(i);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const i=Ue({},Ra.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",i);t?(_r(t,!0),this.painter=new are(t,this.transform),this.on("data",r=>{r.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),A.testSupport(t)):this.fire(new vn(new Error("Failed to initialize WebGL")))}_contextLost(i){i.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Ht("webglcontextlost",{originalEvent:i}))}_contextRestored(i){this._setupPainter(),this.resize(),this._update(),this.fire(new Ht("webglcontextrestored",{originalEvent:i}))}_onMapScroll(i){if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(i){return this.style?(this._styleDirty=this._styleDirty||i,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(i){return this._update(),this._renderTaskQueue.add(i)}_cancelRenderFrame(i){this._renderTaskQueue.remove(i)}_requestDomTask(i){!this.loaded()||this.loaded()&&!this.isMoving()?i():this._domRenderTaskQueue.add(i)}_render(i){let t;this.fire(new Ht("renderstart"));const r=this.painter.context.extTimerQuery,l=Cn.now(),u=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=u.createQuery(),u.beginQuery(r.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],m.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],m.performance.now())),this._renderTaskQueue.run(i),this._domRenderTaskQueue.run(i),this._removed)return;this._updateProjectionTransition();const h=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,b=this.transform.pitch,x=Cn.now(),S=new ii(v,{now:x,fadeDuration:h,pitch:b,transition:this.style.transition});this.style.update(S)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let p=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),p=this._updateAverageElevation(l),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):p=this._updateAverageElevation(l),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,h,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:h,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Ht("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Ht("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const v=Cn.now()-l;u.endQuery(r.TIME_ELAPSED_EXT),setTimeout(()=>{const b=u.getQueryParameter(t,u.QUERY_RESULT)/1e6;u.deleteQuery(t),this.fire(new Ht("gpu-timing-frame",{cpuTime:v,gpuTime:b})),m.performance.mark("frame-gpu",{startTime:l,detail:{gpuTime:b}})},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(v);this.fire(new Ht("gpu-timing-layer",{layerTimes:b}))},50)}if(this.listens("gpu-timing-deferred-render")){const v=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const b=this.painter.queryGpuTimeDeferredRender(v);this.fire(new Ht("gpu-timing-deferred-render",{gpuTime:b}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||p;if(g||this._repaint)this.triggerRepaint();else{const v=!this.isMoving()&&this.loaded();if(v&&(p=this._updateAverageElevation(l,!0)),p)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new Ht("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const b=this._calculateSpeedIndex();this.fire(new Ht("speedindexcompleted",{speedIndex:b})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,Xi.mark(ei.fullLoad),this._performanceMetricsCollection&&sa(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(i){for(const t of this._markers)i&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!i||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(i,t=!1){const r=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&r(0);const l=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(l||(t||i-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(i)){const u=this.transform.averageElevation;let h=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(h)?h=0:this._averageElevationLastSampledAt=i;const p=Math.abs(u-h);if(p>1){if(this._isInitialLoad||l)return this._averageElevation.jumpTo(h),r(h);this._averageElevation.easeTo(h,i,300)}else if(p>1e-4)return this._averageElevation.jumpTo(h),r(h)}return!!this._averageElevation.isEasing(i)&&r(this._averageElevation.getValue(i))}_authenticate(){ia(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,i=>{if(i&&(i.message===mn||i.status===401)){const t=this.painter.context.gl;_r(t,!1),this._logoControl instanceof a9&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new vn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),qn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const i=this._isDragging();this.painter.updateTerrain(this.style,i)}_calculateSpeedIndex(){const i=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,l=r.createFramebuffer();function u(h){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,h,0);const p=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,p),p}return r.bindFramebuffer(r.FRAMEBUFFER,l),this._canvasPixelComparison(u(i),t.canvasCopies.map(u),t.timeStamps)}_canvasPixelComparison(i,t,r){let l=r[1]-r[0];const u=i.length/4;for(let h=0;h<t.length;h++){const p=t[h];let g=0;for(let v=0;v<p.length;v+=4)p[v]===i[v]&&p[v+1]===i[v+1]&&p[v+2]===i[v+2]&&p[v+3]===i[v+3]&&(g+=1);l+=(r[h+2]-r[h+1])*(1-g/u)}return l}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),m!==void 0&&(m.removeEventListener("resize",this._onWindowResize,!1),m.removeEventListener("orientationchange",this._onWindowResize,!1),m.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),m.removeEventListener("online",this._onWindowOnline,!1),m.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ni.delete(this.painter.context.gl),this._removed=!0,this.fire(new Ht("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(i){this._renderNextFrame=this._renderNextFrame||i,this.style&&!this._frame&&(this._frame=Cn.frame(t=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(t)}))}_preloadTiles(i){return Xe(this.style?Object.values(this.style._sourceCaches):[],(t,r)=>t._preloadTiles(i,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(i){this._trackResize&&this.resize({originalEvent:i})._update()}_onVisibilityChange(){m.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(i){this._showTileBoundaries!==i&&(this._showTileBoundaries=i,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(i){this._showTerrainWireframe!==i&&(this._showTerrainWireframe=i,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(i){this._showLayers2DWireframe!==i&&(this._showLayers2DWireframe=i,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(i){this._showLayers3DWireframe!==i&&(this._showLayers3DWireframe=i,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(i){this._speedIndexTiming!==i&&(this._speedIndexTiming=i,this._update())}get showPadding(){return!!this._showPadding}set showPadding(i){this._showPadding!==i&&(this._showPadding=i,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(i){this._showCollisionBoxes!==i&&(this._showCollisionBoxes=i,i?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(i){this._showOverdrawInspector!==i&&(this._showOverdrawInspector=i,this._update())}get repaint(){return!!this._repaint}set repaint(i){this._repaint!==i&&(this._repaint=i,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(i){this._vertices=i,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(i){this._showTileAABBs!==i&&(this._showTileAABBs=i,i&&this._update())}_setCacheLimits(i,t){(function(r,l){wt=r,Yt=l})(i,t)}get version(){return y}},NavigationControl:class{constructor(i){this.options=Ue({},Zre,i),this._container=Yn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(ft(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Yn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Yn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(ft(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:t}):r.resetNorth({},{originalEvent:t}))}),this._compassIcon=Yn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const i=this._map;if(!i)return;const t=i.getZoom(),r=t===i.getMaxZoom(),l=t===i.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())}_rotateCompassArrow(){const i=this._map;if(!i)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(i.transform.pitch*(Math.PI/180)),.5)}) rotateX(${i.transform.pitch}deg) rotateZ(${i.transform.angle*(180/Math.PI)}deg)`:`rotate(${i.transform.angle*(180/Math.PI)}deg)`;i._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(i){return this._map=i,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),i.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&i.on("pitch",this._rotateCompassArrow),i.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Yre(i,this._compass,this.options.visualizePitch)),this._container}onRemove(){const i=this._map;i&&(this._container.remove(),this.options.showZoom&&i.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&i.off("pitch",this._rotateCompassArrow),i.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(i,t){const r=Yn("button",i,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(i,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);i.setAttribute("aria-label",r),i.firstElementChild&&i.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends Bn{constructor(i){super(),this.options=Ue({geolocation:m.navigator.geolocation},Kre,i),ft(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=X8(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(i){return this._map=i,this._container=Yn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(i){const t=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,i(r)};this._supportsGeolocation!==void 0?i(this._supportsGeolocation):m.navigator.permissions!==void 0?m.navigator.permissions.query({name:"geolocation"}).then(r=>t(r.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(i){const t=this._map.getMaxBounds(),r=i.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new Ht("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ht("geolocate",i)),this._finish()}}_updateCamera(i){const t=new On(i.coords.longitude,i.coords.latitude),r=i.coords.accuracy,l=Ue({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(r),l,{geolocateSource:!0})}_updateMarker(i){if(i){const t=new On(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const i=this._map.transform,t=ja(1,i._center.lat)*i.worldSize,r=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ht("error",i)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(i){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Yn("button","mapboxgl-ctrl-geolocate",this._container),Yn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){ve("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Yn("div","mapboxgl-user-location"),this._dotElement.appendChild(Yn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Yn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new m5({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Yn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new m5({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Ht("trackuserlocationend")))})}}_onDeviceOrientation(i){this._userLocationDotMarker&&(i.webkitCompassHeading?this._heading=i.webkitCompassHeading:i.absolute===!0&&(this._heading=-1*i.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return ve("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Ht("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Ht("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Ht("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let i;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(i={maximumAge:6e5,timeout:0},this._noTimeout=!0):(i=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,i),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const i=()=>{m.addEventListener("ondeviceorientationabsolute"in m?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};m.DeviceMotionEvent!==void 0&&typeof m.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&i()}).catch(console.error):i()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),m.removeEventListener("deviceorientation",this._onDeviceOrientation),m.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:n9,ScaleControl:class{constructor(i){this.options=Ue({},Jre,i),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),ft(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const i=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,l=t._containerWidth/2-i/2,u=t.unproject([l,r]),h=t.unproject([l+i,r]),p=u.distanceTo(h);if(this.options.unit==="imperial"){const g=3.2808*p;g>5280?this._setScale(i,g/5280,"mile"):this._setScale(i,g,"foot")}else this.options.unit==="nautical"?this._setScale(i,p/1852,"nautical-mile"):p>=1e3?this._setScale(i,p/1e3,"kilometer"):this._setScale(i,p,"meter")}_setScale(i,t,r){this._map._requestDomTask(()=>{const l=function(h){const p=Math.pow(10,`${Math.floor(h)}`.length-1);let g=h/p;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(v){const b=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*b)/b}(g),p*g}(t),u=l/t;this._container.innerHTML=this._isNumberFormatSupported&&r!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(l):`${l}&nbsp;${Qre[r]}`,this._container.style.width=i*u+"px"})}onAdd(i){return this._map=i,this._language=i.getLanguage(),this._container=Yn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",i.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(i){this._language=i,this._update()}setUnit(i){this.options.unit=i,this._update()}},FullscreenControl:class{constructor(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof m.HTMLElement?this._container=i.container:ve("Full screen control 'container' must be a DOM element.")),ft(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in m.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in m.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(i){return this._map=i,this._container||(this._container=this._map.getContainer()),this._controlContainer=Yn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",ve("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,m.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!m.document.fullscreenEnabled&&!m.document.webkitFullscreenEnabled)}_setupUI(){const i=this._fullscreenButton=Yn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Yn("span","mapboxgl-ctrl-icon",i).setAttribute("aria-hidden","true"),i.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),m.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const i=this._getTitle();this._fullscreenButton.setAttribute("aria-label",i),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",i)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(m.document.fullscreenElement||m.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?m.document.exitFullscreen?m.document.exitFullscreen():m.document.webkitCancelFullScreen&&m.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Bn{constructor(i){super(),this.options=Ue(Object.create(Hre),i),ft(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(i&&i.className?i.className.trim().split(/\s+/):[])}addTo(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&i.on("preclick",this._onClose),this.options.closeOnMove&&i.on("move",this._onClose),i.on("remove",this.remove),this._update(),i._addPopup(this),this._focusFirstElement(),this._trackPointer?(i.on("mousemove",this._onMouseEvent),i.on("mouseup",this._onMouseEvent),i._canvasContainer.classList.add("mapboxgl-track-pointer")):i.on("move",this._update),this.fire(new Ht("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const i=this._map;return i&&(i.off("move",this._update),i.off("move",this._onClose),i.off("preclick",this._onClose),i.off("click",this._onClose),i.off("remove",this.remove),i.off("mousemove",this._onMouseEvent),i.off("mouseup",this._onMouseEvent),i.off("drag",this._onMouseEvent),i._canvasContainer&&i._canvasContainer.classList.remove("mapboxgl-track-pointer"),i._removePopup(this),this._map=void 0),this.fire(new Ht("close")),this}getLngLat(){return this._lngLat}setLngLat(i){this._lngLat=On.convert(i),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const i=this._map;return i&&(i.off("move",this._update),i.on("mousemove",this._onMouseEvent),i.on("drag",this._onMouseEvent),i._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(i){return this.setDOMContent(m.document.createTextNode(i))}setHTML(i){const t=m.document.createDocumentFragment(),r=m.document.createElement("body");let l;for(r.innerHTML=i;l=r.firstChild,l;)t.appendChild(l);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(i){return this.options.maxWidth=i,this._update(),this}setDOMContent(i){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Yn("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(i),this.options.closeButton){const r=this._closeButton=Yn("button","mapboxgl-popup-close-button",t);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(i){return this._classList.add(i),this._updateClassList(),this}removeClassName(i){return this._classList.delete(i),this._updateClassList(),this}setOffset(i){return this.options.offset=i,this._update(),this}toggleClassName(i){let t;return this._classList.delete(i)?t=!1:(this._classList.add(i),t=!0),this._updateClassList(),t}_onMouseEvent(i){this._update(i.point)}_getAnchor(i){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,l=this._pos;if(!t||!r||!l)return"bottom";const u=r.offsetWidth,h=r.offsetHeight,p=l.x<u/2,g=l.x>t.transform.width-u/2;if(l.y+i<h)return p?"top-left":g?"top-right":"top";if(l.y>t.transform.height-h){if(p)return"bottom-left";if(g)return"bottom-right"}return p?"left":g?"right":"bottom"}_updateClassList(){const i=this._container;if(!i)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),i.className=t.join(" ")}_update(i){const t=this._map,r=this._content;if(!t||!this._lngLat&&!this._trackPointer||!r)return;let l=this._container;if(l||(l=this._container=Yn("div","mapboxgl-popup",t.getContainer()),this._tip=Yn("div","mapboxgl-popup-tip",l),l.appendChild(r)),this.options.maxWidth&&l.style.maxWidth!==this.options.maxWidth&&(l.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=r9(this._lngLat,this._pos,t.transform)),!this._trackPointer||i){const u=this._pos=this._trackPointer&&i?i:t.project(this._lngLat),h=o9(this.options.offset),p=this._anchor=this._getAnchor(h.y),g=o9(this.options.offset,p),v=u.add(g).round();t._requestDomTask(()=>{this._container&&p&&(this._container.style.transform=`${p5[p]} translate(${v.x}px,${v.y}px)`)})}if(!this._marker&&t._showingGlobe()){const u=b2(t.transform,this._lngLat)?0:1;this._setOpacity(u)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const i=this._container.querySelector(jre);i&&i.focus()}_onClose(){this.remove()}_setOpacity(i){this._container&&(this._container.style.opacity=`${i}`),this._content&&(this._content.style.pointerEvents=i?"auto":"none")}},Marker:m5,Style:qc,LngLat:On,LngLatBounds:Il,Point:V,MercatorCoordinate:ga,FreeCameraOptions:yN,Evented:Bn,config:w,prewarm:function(){A1().acquire(BP)},clearPrewarmedResources:function(){const i=S1;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(BP),S1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return w.ACCESS_TOKEN},set accessToken(i){w.ACCESS_TOKEN=i},get baseApiUrl(){return w.API_URL},set baseApiUrl(i){w.API_URL=i},get workerCount(){return pv.workerCount},set workerCount(i){pv.workerCount=i},get maxParallelImageRequests(){return w.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(i){w.MAX_PARALLEL_IMAGE_REQUESTS=i},clearStorage(i){(function(t){if(!qt())return;const r=m.caches.delete(Ft);t&&r.catch(t).then(()=>t())})(i)},workerUrl:"",workerClass:null,get dracoUrl(){return RB()},set dracoUrl(i){(function(t){UP=Cn.resolveURL(t),WP||(WP=new Em(A1(),new Bn)),WP.broadcast("setDracoUrl",UP)})(i)},setNow:Cn.setNow,restoreNow:Cn.restoreNow};f.A=SB,f.D=_m,f.E=dt,f.F=lP,f.K=_3,f.O=Ta,f.P=V,f.T=VN,f.V=k2,f.a=R2,f.b=_F,f.c=d3,f.d=class extends Bn{constructor(i,t,r,l,u,h){super(),this.actor=i,this.layerIndex=t,this.availableImages=r,this.loadVectorData=u||IB,this.loading={},this.loaded={},this.deduped=new PB(i.scheduler),this.isSpriteLoaded=l,this.scheduler=i.scheduler,this.brightness=h}loadTile(i,t){const r=i.uid,l=i&&i.request,u=l&&l.collectResourceTiming,h=this.loading[r]=new xae(i);h.abort=this.loadVectorData(i,(p,g)=>{const v=!this.loading[r];if(delete this.loading[r],v||p||!g)return h.status="done",v||(this.loaded[r]=h),t(p);const b=g.rawData,x={};g.expires&&(x.expires=g.expires),g.cacheControl&&(x.cacheControl=g.cacheControl),h.vectorTile=g.vectorTile||new iP(new F2(b));const S=()=>{h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,(T,P)=>{if(T||!P)return t(T);const R={};if(u){const z=lo(l);z.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(z)))}t(null,Ue({rawTileData:b.slice(0)},P,x,R))})};this.isSpriteLoaded?S():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(S,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):S()}),this.loaded=this.loaded||{},this.loaded[r]=h})}reloadTile(i,t){const r=this.loaded,l=i.uid,u=this;if(r&&r[l]){const h=r[l];h.showCollisionBoxes=i.showCollisionBoxes,h.projection=i.projection,h.brightness=i.brightness,h.tileTransform=bm(i.tileID.canonical,i.projection),h.extraShadowCaster=i.extraShadowCaster;const p=(g,v)=>{const b=h.reloadCallback;b&&(delete h.reloadCallback,h.parse(h.vectorTile,u.layerIndex,this.availableImages,u.actor,b)),t(g,v)};h.status==="parsing"?h.reloadCallback=p:h.status==="done"&&(h.vectorTile?h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,p):p())}}abortTile(i,t){const r=i.uid,l=this.loading[r];l&&(l.abort&&l.abort(),delete this.loading[r]),t()}removeTile(i,t){const r=this.loaded,l=i.uid;r&&r[l]&&delete r[l],t()}},f.e=kc,f.f=lo,f.g=F,f.h=et,f.i=yt,f.j=function(i,t){const r=qP(i);for(const l of r){for(const u of l.meshes)Lae(u);l.lights&&(l.lightMeshIndex=l.meshes.length,l.meshes.push(Rae(l.lights,t)))}return r},f.k=ii,f.l=async function(i){let t=0;if(new Uint32Array(i,0,1)[0]!==DB){const r=new Uint32Array(i,0,7),[,,l,u,h,p]=r;t=r.byteLength+u+h+p+h,(l!==i.byteLength||t>=i.byteLength)&&ve("Invalid b3dm header information.")}return NB(i,t)},f.m=$2,f.n=Is,f.o=Ht,f.p=X,f.q=function(i){Dt(),Ge&&Ge.then(t=>{t.keys().then(r=>{for(let l=0;l<r.length-i;l++)t.delete(r[l])})})},f.r=GB,f.s=O3,f.t=J_,f.v=Ke,f.w=m}),c(["./shared"],function(f){function m(Be){if(typeof Be=="number"||typeof Be=="boolean"||typeof Be=="string"||Be==null)return JSON.stringify(Be);if(Array.isArray(Be)){let oe="[";for(const ve of Be)oe+=`${m(ve)},`;return`${oe}]`}let le="{";for(const oe of Object.keys(Be).sort())le+=`${oe}:${m(Be[oe])},`;return`${le}}`}function y(Be){let le="";for(const oe of f.r)le+=`/${m(Be[oe])}`;return le}class _{constructor(le){this.keyCache={},le&&this.replace(le)}replace(le,oe){this._layerConfigs={},this._layers={},this.update(le,[],oe)}update(le,oe,ve){this._options=ve;for(const De of le){this._layerConfigs[De.id]=De;const ot=this._layers[De.id]=f.c(De,this._options);ot.setScope(this.scope),ot.compileFilter(),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of oe)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const $e=function(De,ot){const ce={};for(let Oe=0;Oe<De.length;Oe++){const pt=ot&&ot[De[Oe].id]||y(De[Oe]);ot&&(ot[De[Oe].id]=pt);let it=ce[pt];it||(it=ce[pt]=[]),it.push(De[Oe])}const te=[];for(const Oe in ce)te.push(ce[Oe]);return te}(f.v(this._layerConfigs),this.keyCache);for(const De of $e){const ot=De.map(st=>this._layers[st.id]),ce=ot[0];if(ce.visibility==="none")continue;const te=ce.source||"";let Oe=this.familiesBySource[te];Oe||(Oe=this.familiesBySource[te]={});const pt=ce.sourceLayer||"_geojsonTileLayer";let it=Oe[pt];it||(it=Oe[pt]=[]),it.push(ot)}}}class w{loadTile(le,oe){const{uid:ve,encoding:$e,rawImageData:De,padding:ot}=le,ce=f.w.ImageBitmap&&De instanceof f.w.ImageBitmap?this.getImageData(De,ot):De;oe(null,new f.D(ve,ce,$e,le.convertToFloat,ot<1))}getImageData(le,oe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(le.width,le.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=le.width,this.offscreenCanvas.height=le.height,this.offscreenCanvasContext.drawImage(le,0,0,le.width,le.height);const ve=this.offscreenCanvasContext.getImageData(-oe,-oe,le.width+2*oe,le.height+2*oe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}function A(Be,le){if(Be.length!==0){C(Be[0],le);for(var oe=1;oe<Be.length;oe++)C(Be[oe],!le)}}function C(Be,le){for(var oe=0,ve=0,$e=0,De=Be.length,ot=De-1;$e<De;ot=$e++){var ce=(Be[$e][0]-Be[ot][0])*(Be[ot][1]+Be[$e][1]),te=oe+ce;ve+=Math.abs(oe)>=Math.abs(ce)?oe-te+ce:ce-te+oe,oe=te}oe+ve>=0!=!!le&&Be.reverse()}var I=f.g(function Be(le,oe){var ve,$e=le&&le.type;if($e==="FeatureCollection")for(ve=0;ve<le.features.length;ve++)Be(le.features[ve],oe);else if($e==="GeometryCollection")for(ve=0;ve<le.geometries.length;ve++)Be(le.geometries[ve],oe);else if($e==="Feature")Be(le.geometry,oe);else if($e==="Polygon")A(le.coordinates,oe);else if($e==="MultiPolygon")for(ve=0;ve<le.coordinates.length;ve++)A(le.coordinates[ve],oe);return le});const k=f.V.prototype.toGeoJSON;var D={exports:{}},L=f.p,O=f.a.VectorTileFeature,F=B;function B(Be,le){this.options=le||{},this.features=Be,this.length=Be.length}function G(Be,le){this.id=typeof Be.id=="number"?Be.id:void 0,this.type=Be.type,this.rawGeometry=Be.type===1?[Be.geometry]:Be.geometry,this.properties=Be.tags,this.extent=le||4096}B.prototype.feature=function(Be){return new G(this.features[Be],this.options.extent)},G.prototype.loadGeometry=function(){var Be=this.rawGeometry;this.geometry=[];for(var le=0;le<Be.length;le++){for(var oe=Be[le],ve=[],$e=0;$e<oe.length;$e++)ve.push(new L(oe[$e][0],oe[$e][1]));this.geometry.push(ve)}return this.geometry},G.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Be=this.geometry,le=1/0,oe=-1/0,ve=1/0,$e=-1/0,De=0;De<Be.length;De++)for(var ot=Be[De],ce=0;ce<ot.length;ce++){var te=ot[ce];le=Math.min(le,te.x),oe=Math.max(oe,te.x),ve=Math.min(ve,te.y),$e=Math.max($e,te.y)}return[le,ve,oe,$e]},G.prototype.toGeoJSON=O.prototype.toGeoJSON;var q=f.b,X=F;function ee(Be){var le=new q;return function(oe,ve){for(var $e in oe.layers)ve.writeMessage(3,V,oe.layers[$e])}(Be,le),le.finish()}function V(Be,le){var oe;le.writeVarintField(15,Be.version||1),le.writeStringField(1,Be.name||""),le.writeVarintField(5,Be.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Be.length;oe++)ve.feature=Be.feature(oe),le.writeMessage(2,Q,ve);var $e=ve.keys;for(oe=0;oe<$e.length;oe++)le.writeStringField(3,$e[oe]);var De=ve.values;for(oe=0;oe<De.length;oe++)le.writeMessage(4,Ce,De[oe])}function Q(Be,le){var oe=Be.feature;oe.id!==void 0&&le.writeVarintField(1,oe.id),le.writeMessage(2,me,Be),le.writeVarintField(3,oe.type),le.writeMessage(4,fe,oe)}function me(Be,le){var oe=Be.feature,ve=Be.keys,$e=Be.values,De=Be.keycache,ot=Be.valuecache;for(var ce in oe.properties){var te=oe.properties[ce],Oe=De[ce];if(te!==null){Oe===void 0&&(ve.push(ce),De[ce]=Oe=ve.length-1),le.writeVarint(Oe);var pt=typeof te;pt!=="string"&&pt!=="boolean"&&pt!=="number"&&(te=JSON.stringify(te));var it=pt+":"+te,st=ot[it];st===void 0&&($e.push(te),ot[it]=st=$e.length-1),le.writeVarint(st)}}}function pe(Be,le){return(le<<3)+(7&Be)}function be(Be){return Be<<1^Be>>31}function fe(Be,le){for(var oe=Be.loadGeometry(),ve=Be.type,$e=0,De=0,ot=oe.length,ce=0;ce<ot;ce++){var te=oe[ce],Oe=1;ve===1&&(Oe=te.length),le.writeVarint(pe(1,Oe));for(var pt=ve===3?te.length-1:te.length,it=0;it<pt;it++){it===1&&ve!==1&&le.writeVarint(pe(2,pt-1));var st=te[it].x-$e,At=te[it].y-De;le.writeVarint(be(st)),le.writeVarint(be(At)),$e+=st,De+=At}ve===3&&le.writeVarint(pe(7,1))}}function Ce(Be,le){var oe=typeof Be;oe==="string"?le.writeStringField(1,Be):oe==="boolean"?le.writeBooleanField(7,Be):oe==="number"&&(Be%1!=0?le.writeDoubleField(3,Be):Be<0?le.writeSVarintField(6,Be):le.writeVarintField(5,Be))}D.exports=ee,D.exports.fromVectorTileJs=ee,D.exports.fromGeojsonVt=function(Be,le){le=le||{};var oe={};for(var ve in Be)oe[ve]=new X(Be[ve].features,le),oe[ve].name=ve,oe[ve].version=le.version,oe[ve].extent=le.extent;return ee({layers:oe})},D.exports.GeoJSONWrapper=X;var Re=f.g(D.exports);const He={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Be=>Be},ue=Math.fround||(ye=new Float32Array(1),Be=>(ye[0]=+Be,ye[0]));var ye;const Ae=3,ne=5,Ee=6;class Ye{constructor(le){this.options=Object.assign(Object.create(He),le),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(le){const{log:oe,minZoom:ve,maxZoom:$e}=this.options;oe&&console.time("total time");const De=`prepare ${le.length} points`;oe&&console.time(De),this.points=le;const ot=[];for(let te=0;te<le.length;te++){const Oe=le[te];if(!Oe.geometry)continue;const[pt,it]=Oe.geometry.coordinates,st=ue(Ue(pt)),At=ue(ht(it));ot.push(st,At,1/0,te,-1,1),this.options.reduce&&ot.push(0)}let ce=this.trees[$e+1]=this._createTree(ot);oe&&console.timeEnd(De);for(let te=$e;te>=ve;te--){const Oe=+Date.now();ce=this.trees[te]=this._createTree(this._cluster(ce,te)),oe&&console.log("z%d: %d clusters in %dms",te,ce.numItems,+Date.now()-Oe)}return oe&&console.timeEnd("total time"),this}getClusters(le,oe){let ve=((le[0]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,le[1]));let De=le[2]===180?180:((le[2]+180)%360+360)%360-180;const ot=Math.max(-90,Math.min(90,le[3]));if(le[2]-le[0]>=360)ve=-180,De=180;else if(ve>De){const it=this.getClusters([ve,$e,180,ot],oe),st=this.getClusters([-180,$e,De,ot],oe);return it.concat(st)}const ce=this.trees[this._limitZoom(oe)],te=ce.range(Ue(ve),ht(ot),Ue(De),ht($e)),Oe=ce.data,pt=[];for(const it of te){const st=this.stride*it;pt.push(Oe[st+ne]>1?Xe(Oe,st,this.clusterProps):this.points[Oe[st+Ae]])}return pt}getChildren(le){const oe=this._getOriginId(le),ve=this._getOriginZoom(le),$e="No cluster with the specified id.",De=this.trees[ve];if(!De)throw new Error($e);const ot=De.data;if(oe*this.stride>=ot.length)throw new Error($e);const ce=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),te=De.within(ot[oe*this.stride],ot[oe*this.stride+1],ce),Oe=[];for(const pt of te){const it=pt*this.stride;ot[it+4]===le&&Oe.push(ot[it+ne]>1?Xe(ot,it,this.clusterProps):this.points[ot[it+Ae]])}if(Oe.length===0)throw new Error($e);return Oe}getLeaves(le,oe,ve){const $e=[];return this._appendLeaves($e,le,oe=oe||10,ve=ve||0,0),$e}getTile(le,oe,ve){const $e=this.trees[this._limitZoom(le)],De=Math.pow(2,le),{extent:ot,radius:ce}=this.options,te=ce/ot,Oe=(ve-te)/De,pt=(ve+1+te)/De,it={features:[]};return this._addTileFeatures($e.range((oe-te)/De,Oe,(oe+1+te)/De,pt),$e.data,oe,ve,De,it),oe===0&&this._addTileFeatures($e.range(1-te/De,Oe,1,pt),$e.data,De,ve,De,it),oe===De-1&&this._addTileFeatures($e.range(0,Oe,te/De,pt),$e.data,-1,ve,De,it),it.features.length?it:null}getClusterExpansionZoom(le){let oe=this._getOriginZoom(le)-1;for(;oe<=this.options.maxZoom;){const ve=this.getChildren(le);if(oe++,ve.length!==1)break;le=ve[0].properties.cluster_id}return oe}_appendLeaves(le,oe,ve,$e,De){const ot=this.getChildren(oe);for(const ce of ot){const te=ce.properties;if(te&&te.cluster?De+te.point_count<=$e?De+=te.point_count:De=this._appendLeaves(le,te.cluster_id,ve,$e,De):De<$e?De++:le.push(ce),le.length===ve)break}return De}_createTree(le){const oe=new f.K(le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ve=0;ve<le.length;ve+=this.stride)oe.add(le[ve],le[ve+1]);return oe.finish(),oe.data=le,oe}_addTileFeatures(le,oe,ve,$e,De,ot){for(const ce of le){const te=ce*this.stride,Oe=oe[te+ne]>1;let pt,it,st;if(Oe)pt=Ke(oe,te,this.clusterProps),it=oe[te],st=oe[te+1];else{const Vt=this.points[oe[te+Ae]];pt=Vt.properties;const[$t,Ft]=Vt.geometry.coordinates;it=Ue($t),st=ht(Ft)}const At={type:1,geometry:[[Math.round(this.options.extent*(it*De-ve)),Math.round(this.options.extent*(st*De-$e))]],tags:pt};let Ut;Ut=Oe||this.options.generateId?oe[te+Ae]:this.points[oe[te+Ae]].id,Ut!==void 0&&(At.id=Ut),ot.features.push(At)}}_limitZoom(le){return Math.max(this.options.minZoom,Math.min(Math.floor(+le),this.options.maxZoom+1))}_cluster(le,oe){const{radius:ve,extent:$e,reduce:De,minPoints:ot}=this.options,ce=ve/($e*Math.pow(2,oe)),te=le.data,Oe=[],pt=this.stride;for(let it=0;it<te.length;it+=pt){if(te[it+2]<=oe)continue;te[it+2]=oe;const st=te[it],At=te[it+1],Ut=le.within(te[it],te[it+1],ce),Vt=te[it+ne];let $t=Vt;for(const Ft of Ut){const wt=Ft*pt;te[wt+2]>oe&&($t+=te[wt+ne])}if($t>Vt&&$t>=ot){let Ft,wt=st*Vt,Yt=At*Vt,Ge=-1;const It=((it/pt|0)<<5)+(oe+1)+this.points.length;for(const qt of Ut){const Dt=qt*pt;if(te[Dt+2]<=oe)continue;te[Dt+2]=oe;const fn=te[Dt+ne];wt+=te[Dt]*fn,Yt+=te[Dt+1]*fn,te[Dt+4]=It,De&&(Ft||(Ft=this._map(te,it,!0),Ge=this.clusterProps.length,this.clusterProps.push(Ft)),De(Ft,this._map(te,Dt)))}te[it+4]=It,Oe.push(wt/$t,Yt/$t,1/0,It,-1,$t),De&&Oe.push(Ge)}else{for(let Ft=0;Ft<pt;Ft++)Oe.push(te[it+Ft]);if($t>1)for(const Ft of Ut){const wt=Ft*pt;if(!(te[wt+2]<=oe)){te[wt+2]=oe;for(let Yt=0;Yt<pt;Yt++)Oe.push(te[wt+Yt])}}}}return Oe}_getOriginId(le){return le-this.points.length>>5}_getOriginZoom(le){return(le-this.points.length)%32}_map(le,oe,ve){if(le[oe+ne]>1){const ot=this.clusterProps[le[oe+Ee]];return ve?Object.assign({},ot):ot}const $e=this.points[le[oe+Ae]].properties,De=this.options.map($e);return ve&&De===$e?Object.assign({},De):De}}function Xe(Be,le,oe){return{type:"Feature",id:Be[le+Ae],properties:Ke(Be,le,oe),geometry:{type:"Point",coordinates:[(ve=Be[le],360*(ve-.5)),Lt(Be[le+1])]}};var ve}function Ke(Be,le,oe){const ve=Be[le+ne],$e=ve>=1e4?`${Math.round(ve/1e3)}k`:ve>=1e3?Math.round(ve/100)/10+"k":ve,De=Be[le+Ee],ot=De===-1?{}:Object.assign({},oe[De]);return Object.assign(ot,{cluster:!0,cluster_id:Be[le+Ae],point_count:ve,point_count_abbreviated:$e})}function Ue(Be){return Be/360+.5}function ht(Be){const le=Math.sin(Be*Math.PI/180),oe=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return oe<0?0:oe>1?1:oe}function Lt(Be){const le=(180-360*Be)*Math.PI/180;return 360*Math.atan(Math.exp(le))/Math.PI-90}var Rt={exports:{}};Rt.exports=function(){function Be(Se,Me,ze,Je){for(var et,yt=Je,ut=ze-Me>>1,ct=ze-Me,Gt=Se[Me],Mt=Se[Me+1],Qt=Se[ze],mn=Se[ze+1],nn=Me+3;nn<ze;nn+=3){var wn=le(Se[nn],Se[nn+1],Gt,Mt,Qt,mn);if(wn>yt)et=nn,yt=wn;else if(wn===yt){var Hn=Math.abs(nn-ut);Hn<ct&&(et=nn,ct=Hn)}}yt>Je&&(et-Me>3&&Be(Se,Me,et,Je),Se[et+2]=yt,ze-et>3&&Be(Se,et,ze,Je))}function le(Se,Me,ze,Je,et,yt){var ut=et-ze,ct=yt-Je;if(ut!==0||ct!==0){var Gt=((Se-ze)*ut+(Me-Je)*ct)/(ut*ut+ct*ct);Gt>1?(ze=et,Je=yt):Gt>0&&(ze+=ut*Gt,Je+=ct*Gt)}return(ut=Se-ze)*ut+(ct=Me-Je)*ct}function oe(Se,Me,ze,Je){var et={id:Se===void 0?null:Se,type:Me,geometry:ze,tags:Je,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(yt){var ut=yt.geometry,ct=yt.type;if(ct==="Point"||ct==="MultiPoint"||ct==="LineString")ve(yt,ut);else if(ct==="Polygon"||ct==="MultiLineString")for(var Gt=0;Gt<ut.length;Gt++)ve(yt,ut[Gt]);else if(ct==="MultiPolygon")for(Gt=0;Gt<ut.length;Gt++)for(var Mt=0;Mt<ut[Gt].length;Mt++)ve(yt,ut[Gt][Mt])}(et),et}function ve(Se,Me){for(var ze=0;ze<Me.length;ze+=3)Se.minX=Math.min(Se.minX,Me[ze]),Se.minY=Math.min(Se.minY,Me[ze+1]),Se.maxX=Math.max(Se.maxX,Me[ze]),Se.maxY=Math.max(Se.maxY,Me[ze+1])}function $e(Se,Me,ze,Je){if(Me.geometry){var et=Me.geometry.coordinates,yt=Me.geometry.type,ut=Math.pow(ze.tolerance/((1<<ze.maxZoom)*ze.extent),2),ct=[],Gt=Me.id;if(ze.promoteId?Gt=Me.properties[ze.promoteId]:ze.generateId&&(Gt=Je||0),yt==="Point")De(et,ct);else if(yt==="MultiPoint")for(var Mt=0;Mt<et.length;Mt++)De(et[Mt],ct);else if(yt==="LineString")ot(et,ct,ut,!1);else if(yt==="MultiLineString"){if(ze.lineMetrics){for(Mt=0;Mt<et.length;Mt++)ot(et[Mt],ct=[],ut,!1),Se.push(oe(Gt,"LineString",ct,Me.properties));return}ce(et,ct,ut,!1)}else if(yt==="Polygon")ce(et,ct,ut,!0);else{if(yt!=="MultiPolygon"){if(yt==="GeometryCollection"){for(Mt=0;Mt<Me.geometry.geometries.length;Mt++)$e(Se,{id:Gt,geometry:Me.geometry.geometries[Mt],properties:Me.properties},ze,Je);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Mt=0;Mt<et.length;Mt++){var Qt=[];ce(et[Mt],Qt,ut,!0),ct.push(Qt)}}Se.push(oe(Gt,yt,ct,Me.properties))}}function De(Se,Me){Me.push(te(Se[0])),Me.push(Oe(Se[1])),Me.push(0)}function ot(Se,Me,ze,Je){for(var et,yt,ut=0,ct=0;ct<Se.length;ct++){var Gt=te(Se[ct][0]),Mt=Oe(Se[ct][1]);Me.push(Gt),Me.push(Mt),Me.push(0),ct>0&&(ut+=Je?(et*Mt-Gt*yt)/2:Math.sqrt(Math.pow(Gt-et,2)+Math.pow(Mt-yt,2))),et=Gt,yt=Mt}var Qt=Me.length-3;Me[2]=1,Be(Me,0,Qt,ze),Me[Qt+2]=1,Me.size=Math.abs(ut),Me.start=0,Me.end=Me.size}function ce(Se,Me,ze,Je){for(var et=0;et<Se.length;et++){var yt=[];ot(Se[et],yt,ze,Je),Me.push(yt)}}function te(Se){return Se/360+.5}function Oe(Se){var Me=Math.sin(Se*Math.PI/180),ze=.5-.25*Math.log((1+Me)/(1-Me))/Math.PI;return ze<0?0:ze>1?1:ze}function pt(Se,Me,ze,Je,et,yt,ut,ct){if(Je/=Me,yt>=(ze/=Me)&&ut<Je)return Se;if(ut<ze||yt>=Je)return null;for(var Gt=[],Mt=0;Mt<Se.length;Mt++){var Qt=Se[Mt],mn=Qt.geometry,nn=Qt.type,wn=et===0?Qt.minX:Qt.minY,Hn=et===0?Qt.maxX:Qt.maxY;if(wn>=ze&&Hn<Je)Gt.push(Qt);else if(!(Hn<ze||wn>=Je)){var fa=[];if(nn==="Point"||nn==="MultiPoint")it(mn,fa,ze,Je,et);else if(nn==="LineString")st(mn,fa,ze,Je,et,!1,ct.lineMetrics);else if(nn==="MultiLineString")Ut(mn,fa,ze,Je,et,!1);else if(nn==="Polygon")Ut(mn,fa,ze,Je,et,!0);else if(nn==="MultiPolygon")for(var Ca=0;Ca<mn.length;Ca++){var Ma=[];Ut(mn[Ca],Ma,ze,Je,et,!0),Ma.length&&fa.push(Ma)}if(fa.length){if(ct.lineMetrics&&nn==="LineString"){for(Ca=0;Ca<fa.length;Ca++)Gt.push(oe(Qt.id,nn,fa[Ca],Qt.tags));continue}nn!=="LineString"&&nn!=="MultiLineString"||(fa.length===1?(nn="LineString",fa=fa[0]):nn="MultiLineString"),nn!=="Point"&&nn!=="MultiPoint"||(nn=fa.length===3?"Point":"MultiPoint"),Gt.push(oe(Qt.id,nn,fa,Qt.tags))}}}return Gt.length?Gt:null}function it(Se,Me,ze,Je,et){for(var yt=0;yt<Se.length;yt+=3){var ut=Se[yt+et];ut>=ze&&ut<=Je&&(Me.push(Se[yt]),Me.push(Se[yt+1]),Me.push(Se[yt+2]))}}function st(Se,Me,ze,Je,et,yt,ut){for(var ct,Gt,Mt=At(Se),Qt=et===0?$t:Ft,mn=Se.start,nn=0;nn<Se.length-3;nn+=3){var wn=Se[nn],Hn=Se[nn+1],fa=Se[nn+2],Ca=Se[nn+3],Ma=Se[nn+4],Ii=et===0?wn:Hn,pi=et===0?Ca:Ma,Le=!1;ut&&(ct=Math.sqrt(Math.pow(wn-Ca,2)+Math.pow(Hn-Ma,2))),Ii<ze?pi>ze&&(Gt=Qt(Mt,wn,Hn,Ca,Ma,ze),ut&&(Mt.start=mn+ct*Gt)):Ii>Je?pi<Je&&(Gt=Qt(Mt,wn,Hn,Ca,Ma,Je),ut&&(Mt.start=mn+ct*Gt)):Vt(Mt,wn,Hn,fa),pi<ze&&Ii>=ze&&(Gt=Qt(Mt,wn,Hn,Ca,Ma,ze),Le=!0),pi>Je&&Ii<=Je&&(Gt=Qt(Mt,wn,Hn,Ca,Ma,Je),Le=!0),!yt&&Le&&(ut&&(Mt.end=mn+ct*Gt),Me.push(Mt),Mt=At(Se)),ut&&(mn+=ct)}var _t=Se.length-3;wn=Se[_t],Hn=Se[_t+1],fa=Se[_t+2],(Ii=et===0?wn:Hn)>=ze&&Ii<=Je&&Vt(Mt,wn,Hn,fa),_t=Mt.length-3,yt&&_t>=3&&(Mt[_t]!==Mt[0]||Mt[_t+1]!==Mt[1])&&Vt(Mt,Mt[0],Mt[1],Mt[2]),Mt.length&&Me.push(Mt)}function At(Se){var Me=[];return Me.size=Se.size,Me.start=Se.start,Me.end=Se.end,Me}function Ut(Se,Me,ze,Je,et,yt){for(var ut=0;ut<Se.length;ut++)st(Se[ut],Me,ze,Je,et,yt,!1)}function Vt(Se,Me,ze,Je){Se.push(Me),Se.push(ze),Se.push(Je)}function $t(Se,Me,ze,Je,et,yt){var ut=(yt-Me)/(Je-Me);return Se.push(yt),Se.push(ze+(et-ze)*ut),Se.push(1),ut}function Ft(Se,Me,ze,Je,et,yt){var ut=(yt-ze)/(et-ze);return Se.push(Me+(Je-Me)*ut),Se.push(yt),Se.push(1),ut}function wt(Se,Me){for(var ze=[],Je=0;Je<Se.length;Je++){var et,yt=Se[Je],ut=yt.type;if(ut==="Point"||ut==="MultiPoint"||ut==="LineString")et=Yt(yt.geometry,Me);else if(ut==="MultiLineString"||ut==="Polygon"){et=[];for(var ct=0;ct<yt.geometry.length;ct++)et.push(Yt(yt.geometry[ct],Me))}else if(ut==="MultiPolygon")for(et=[],ct=0;ct<yt.geometry.length;ct++){for(var Gt=[],Mt=0;Mt<yt.geometry[ct].length;Mt++)Gt.push(Yt(yt.geometry[ct][Mt],Me));et.push(Gt)}ze.push(oe(yt.id,ut,et,yt.tags))}return ze}function Yt(Se,Me){var ze=[];ze.size=Se.size,Se.start!==void 0&&(ze.start=Se.start,ze.end=Se.end);for(var Je=0;Je<Se.length;Je+=3)ze.push(Se[Je]+Me,Se[Je+1],Se[Je+2]);return ze}function Ge(Se,Me){if(Se.transformed)return Se;var ze,Je,et,yt=1<<Se.z,ut=Se.x,ct=Se.y;for(ze=0;ze<Se.features.length;ze++){var Gt=Se.features[ze],Mt=Gt.geometry,Qt=Gt.type;if(Gt.geometry=[],Qt===1)for(Je=0;Je<Mt.length;Je+=2)Gt.geometry.push(It(Mt[Je],Mt[Je+1],Me,yt,ut,ct));else for(Je=0;Je<Mt.length;Je++){var mn=[];for(et=0;et<Mt[Je].length;et+=2)mn.push(It(Mt[Je][et],Mt[Je][et+1],Me,yt,ut,ct));Gt.geometry.push(mn)}}return Se.transformed=!0,Se}function It(Se,Me,ze,Je,et,yt){return[Math.round(ze*(Se*Je-et)),Math.round(ze*(Me*Je-yt))]}function qt(Se,Me,ze,Je,et){for(var yt=Me===et.maxZoom?0:et.tolerance/((1<<Me)*et.extent),ut={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ze,y:Je,z:Me,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ct=0;ct<Se.length;ct++){ut.numFeatures++,Dt(ut,Se[ct],yt,et);var Gt=Se[ct].minX,Mt=Se[ct].minY,Qt=Se[ct].maxX,mn=Se[ct].maxY;Gt<ut.minX&&(ut.minX=Gt),Mt<ut.minY&&(ut.minY=Mt),Qt>ut.maxX&&(ut.maxX=Qt),mn>ut.maxY&&(ut.maxY=mn)}return ut}function Dt(Se,Me,ze,Je){var et=Me.geometry,yt=Me.type,ut=[];if(yt==="Point"||yt==="MultiPoint")for(var ct=0;ct<et.length;ct+=3)ut.push(et[ct]),ut.push(et[ct+1]),Se.numPoints++,Se.numSimplified++;else if(yt==="LineString")fn(ut,et,Se,ze,!1,!1);else if(yt==="MultiLineString"||yt==="Polygon")for(ct=0;ct<et.length;ct++)fn(ut,et[ct],Se,ze,yt==="Polygon",ct===0);else if(yt==="MultiPolygon")for(var Gt=0;Gt<et.length;Gt++){var Mt=et[Gt];for(ct=0;ct<Mt.length;ct++)fn(ut,Mt[ct],Se,ze,!0,ct===0)}if(ut.length){var Qt=Me.tags||null;if(yt==="LineString"&&Je.lineMetrics){for(var mn in Qt={},Me.tags)Qt[mn]=Me.tags[mn];Qt.mapbox_clip_start=et.start/et.size,Qt.mapbox_clip_end=et.end/et.size}var nn={geometry:ut,type:yt==="Polygon"||yt==="MultiPolygon"?3:yt==="LineString"||yt==="MultiLineString"?2:1,tags:Qt};Me.id!==null&&(nn.id=Me.id),Se.features.push(nn)}}function fn(Se,Me,ze,Je,et,yt){var ut=Je*Je;if(Je>0&&Me.size<(et?ut:Je))ze.numPoints+=Me.length/3;else{for(var ct=[],Gt=0;Gt<Me.length;Gt+=3)(Je===0||Me[Gt+2]>ut)&&(ze.numSimplified++,ct.push(Me[Gt]),ct.push(Me[Gt+1])),ze.numPoints++;et&&function(Mt,Qt){for(var mn=0,nn=0,wn=Mt.length,Hn=wn-2;nn<wn;Hn=nn,nn+=2)mn+=(Mt[nn]-Mt[Hn])*(Mt[nn+1]+Mt[Hn+1]);if(mn>0===Qt)for(nn=0,wn=Mt.length;nn<wn/2;nn+=2){var fa=Mt[nn],Ca=Mt[nn+1];Mt[nn]=Mt[wn-2-nn],Mt[nn+1]=Mt[wn-1-nn],Mt[wn-2-nn]=fa,Mt[wn-1-nn]=Ca}}(ct,yt),Se.push(ct)}}function _e(Se,Me){var ze=(Me=this.options=function(et,yt){for(var ut in yt)et[ut]=yt[ut];return et}(Object.create(this.options),Me)).debug;if(ze&&console.time("preprocess data"),Me.maxZoom<0||Me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Me.promoteId&&Me.generateId)throw new Error("promoteId and generateId cannot be used together.");var Je=function(et,yt){var ut=[];if(et.type==="FeatureCollection")for(var ct=0;ct<et.features.length;ct++)$e(ut,et.features[ct],yt,ct);else $e(ut,et.type==="Feature"?et:{geometry:et},yt);return ut}(Se,Me);this.tiles={},this.tileCoords=[],ze&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Me.indexMaxZoom,Me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Je=function(et,yt){var ut=yt.buffer/yt.extent,ct=et,Gt=pt(et,1,-1-ut,ut,0,-1,2,yt),Mt=pt(et,1,1-ut,2+ut,0,-1,2,yt);return(Gt||Mt)&&(ct=pt(et,1,-ut,1+ut,0,-1,2,yt)||[],Gt&&(ct=wt(Gt,1).concat(ct)),Mt&&(ct=ct.concat(wt(Mt,-1)))),ct}(Je,Me)).length&&this.splitTile(Je,0,0,0),ze&&(Je.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ze(Se,Me,ze){return 32*((1<<Se)*ze+Me)+Se}return _e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_e.prototype.splitTile=function(Se,Me,ze,Je,et,yt,ut){for(var ct=[Se,Me,ze,Je],Gt=this.options,Mt=Gt.debug;ct.length;){Je=ct.pop(),ze=ct.pop(),Me=ct.pop(),Se=ct.pop();var Qt=1<<Me,mn=Ze(Me,ze,Je),nn=this.tiles[mn];if(!nn&&(Mt>1&&console.time("creation"),nn=this.tiles[mn]=qt(Se,Me,ze,Je,Gt),this.tileCoords.push({z:Me,x:ze,y:Je}),Mt)){Mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Me,ze,Je,nn.numFeatures,nn.numPoints,nn.numSimplified),console.timeEnd("creation"));var wn="z"+Me;this.stats[wn]=(this.stats[wn]||0)+1,this.total++}if(nn.source=Se,et){if(Me===Gt.maxZoom||Me===et)continue;var Hn=1<<et-Me;if(ze!==Math.floor(yt/Hn)||Je!==Math.floor(ut/Hn))continue}else if(Me===Gt.indexMaxZoom||nn.numPoints<=Gt.indexMaxPoints)continue;if(nn.source=null,Se.length!==0){Mt>1&&console.time("clipping");var fa,Ca,Ma,Ii,pi,Le,_t=.5*Gt.buffer/Gt.extent,kt=.5-_t,Tt=.5+_t,Ot=1+_t;fa=Ca=Ma=Ii=null,pi=pt(Se,Qt,ze-_t,ze+Tt,0,nn.minX,nn.maxX,Gt),Le=pt(Se,Qt,ze+kt,ze+Ot,0,nn.minX,nn.maxX,Gt),Se=null,pi&&(fa=pt(pi,Qt,Je-_t,Je+Tt,1,nn.minY,nn.maxY,Gt),Ca=pt(pi,Qt,Je+kt,Je+Ot,1,nn.minY,nn.maxY,Gt),pi=null),Le&&(Ma=pt(Le,Qt,Je-_t,Je+Tt,1,nn.minY,nn.maxY,Gt),Ii=pt(Le,Qt,Je+kt,Je+Ot,1,nn.minY,nn.maxY,Gt),Le=null),Mt>1&&console.timeEnd("clipping"),ct.push(fa||[],Me+1,2*ze,2*Je),ct.push(Ca||[],Me+1,2*ze,2*Je+1),ct.push(Ma||[],Me+1,2*ze+1,2*Je),ct.push(Ii||[],Me+1,2*ze+1,2*Je+1)}}},_e.prototype.getTile=function(Se,Me,ze){var Je=this.options,et=Je.extent,yt=Je.debug;if(Se<0||Se>24)return null;var ut=1<<Se,ct=Ze(Se,Me=(Me%ut+ut)%ut,ze);if(this.tiles[ct])return Ge(this.tiles[ct],et);yt>1&&console.log("drilling down to z%d-%d-%d",Se,Me,ze);for(var Gt,Mt=Se,Qt=Me,mn=ze;!Gt&&Mt>0;)Mt--,Qt=Math.floor(Qt/2),mn=Math.floor(mn/2),Gt=this.tiles[Ze(Mt,Qt,mn)];return Gt&&Gt.source?(yt>1&&console.log("found parent tile z%d-%d-%d",Mt,Qt,mn),yt>1&&console.time("drilling down"),this.splitTile(Gt.source,Mt,Qt,mn,Se,Me,ze),yt>1&&console.timeEnd("drilling down"),this.tiles[ct]?Ge(this.tiles[ct],et):null):null},function(Se,Me){return new _e(Se,Me)}}();var Jt=f.g(Rt.exports);function Pt(Be,le){const oe=Be.tileID.canonical;if(!this._geoJSONIndex)return le(null,null);const ve=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!ve)return le(null,null);const $e=new class{constructor(ot){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.E,this.length=ot.length,this._features=ot}feature(ot){return new class{constructor(ce){this._feature=ce,this.extent=f.E,this.type=ce.type,this.properties=ce.tags,"id"in ce&&!isNaN(ce.id)&&(this.id=parseInt(ce.id,10))}loadGeometry(){if(this._feature.type===1){const ce=[];for(const te of this._feature.geometry)ce.push([new f.P(te[0],te[1])]);return ce}{const ce=[];for(const te of this._feature.geometry){const Oe=[];for(const pt of te)Oe.push(new f.P(pt[0],pt[1]));ce.push(Oe)}return ce}}toGeoJSON(ce,te,Oe){return k.call(this,ce,te,Oe)}}(this._features[ot])}}(ve.features);let De=Re($e);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),le(null,{vectorTile:$e,rawData:De.buffer})}class Pe extends f.d{constructor(le,oe,ve,$e,De,ot){super(le,oe,ve,$e,Pt,ot),De&&(this.loadGeoJSON=De)}loadData(le,oe){const ve=le&&le.request,$e=ve&&ve.collectResourceTiming;this.loadGeoJSON(le,(De,ot)=>{if(De||!ot)return oe(De);if(typeof ot!="object")return oe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));{I(ot,!0);try{if(le.filter){const te=f.e(le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(te.result==="error")throw new Error(te.value.map(pt=>`${pt.key}: ${pt.message}`).join(", "));ot={type:"FeatureCollection",features:ot.features.filter(pt=>te.value.evaluate({zoom:0},pt))}}this._geoJSONIndex=le.cluster?new Ye(function({superclusterOptions:te,clusterProperties:Oe}){if(!Oe||!te)return te;const pt={},it={},st={accumulated:null,zoom:0},At={properties:null},Ut=Object.keys(Oe);for(const Vt of Ut){const[$t,Ft]=Oe[Vt],wt=f.e(Ft),Yt=f.e(typeof $t=="string"?[$t,["accumulated"],["get",Vt]]:$t);pt[Vt]=wt.value,it[Vt]=Yt.value}return te.map=Vt=>{At.properties=Vt;const $t={};for(const Ft of Ut)$t[Ft]=pt[Ft].evaluate(st,At);return $t},te.reduce=(Vt,$t)=>{At.properties=$t;for(const Ft of Ut)st.accumulated=Vt[Ft],Vt[Ft]=it[Ft].evaluate(st,At)},te}(le)).load(ot.features):Jt(ot,le.geojsonVtOptions)}catch(te){return oe(te)}this.loaded={};const ce={};if($e){const te=f.f(ve);te&&(ce.resourceTiming={},ce.resourceTiming[le.source]=JSON.parse(JSON.stringify(te)))}oe(null,ce)}})}reloadTile(le,oe){const ve=this.loaded;return ve&&ve[le.uid]?super.reloadTile(le,oe):this.loadTile(le,oe)}loadGeoJSON(le,oe){if(le.request)f.h(le.request,oe);else{if(typeof le.data!="string")return oe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));try{return oe(null,JSON.parse(le.data))}catch{return oe(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(le,oe){try{oe(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(ve){oe(ve)}}getClusterChildren(le,oe){try{oe(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(ve){oe(ve)}}getClusterLeaves(le,oe){try{oe(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(ve){oe(ve)}}}class ft{constructor(le,oe){this.tileID=new f.O(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=le.projection,this.brightness=oe}async parse(le,oe,ve,$e){this.status="parsing";const De=new f.O(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),ot={},ce=oe.familiesBySource[ve.source],te=new f.F(De,ve.promoteId);te.bucketLayerIDs=[];const Oe=await f.l(le).catch(At=>$e(new Error(At.message)));if(!Oe)return $e(new Error("Could not parse tile"));const pt=f.j(Oe,1/f.t(ve.tileID.canonical)),it=Oe.json.extensionsUsed&&Oe.json.extensionsUsed.includes("MAPBOX_mesh_features"),st=new f.k(this.zoom,{brightness:this.brightness});for(const At in ce)for(const Ut of ce[At]){const Vt=Ut[0],$t=Oe.json.extensionsUsed;Vt.recalculate(st,[]);const Ft=new f.T(pt,De,$t&&$t.includes("MAPBOX_mesh_features"),this.brightness);it||(Ft.needsUpload=!0),ot[Vt.fqid]=Ft,Ft.evaluate(Vt)}this.status="done",$e(null,{buckets:ot,featureIndex:te})}}class gt{constructor(le,oe,ve,$e,De,ot){this.actor=le,this.layerIndex=oe,this.brightness=ot,this.loading={},this.loaded={}}loadTile(le,oe){const ve=le.uid,$e=this.loading[ve]=new ft(le,this.brightness);f.i(le.request,(De,ot)=>{const ce=!this.loading[ve];return delete this.loading[ve],ce||De?($e.status="done",ce||(this.loaded[ve]=$e),oe(De)):ot&&ot.byteLength!==0?void $e.parse(ot,this.layerIndex,le,(te,Oe)=>{$e.status="done",this.loaded=this.loaded||{},this.loaded[ve]=$e,te||!Oe?oe(te):oe(null,Oe)}):($e.status="done",this.loaded[ve]=$e,oe())})}reloadTile(le,oe){const ve=this.loaded,$e=le.uid;if(ve&&ve[$e]){const De=ve[$e];De.projection=le.projection,De.brightness=le.brightness;const ot=(ce,te)=>{De.reloadCallback&&(delete De.reloadCallback,this.loadTile(le,oe)),oe(ce,te)};De.status==="parsing"?De.reloadCallback=ot:De.status==="done"&&this.loadTile(le,oe)}}abortTile(le,oe){const ve=le.uid;this.loading[ve]&&delete this.loading[ve],oe()}removeTile(le,oe){const ve=this.loaded,$e=le.uid;ve&&ve[$e]&&delete ve[$e],oe()}}class St{constructor(le){this.self=le,this.actor=new f.A(le,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.m({name:"mercator"}),this.workerSourceTypes={vector:f.d,geojson:Pe,"batched-model":gt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(oe,ve)=>{if(this.workerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.workerSourceTypes[oe]=ve},this.self.registerRTLTextPlugin=oe=>{if(f.n.isParsed())throw new Error("RTL text plugin already registered.");f.n.applyArabicShaping=oe.applyArabicShaping,f.n.processBidirectionalText=oe.processBidirectionalText,f.n.processStyledBidirectionalText=oe.processStyledBidirectionalText}}clearCaches(le,oe,ve){delete this.layerIndexes[le],delete this.availableImages[le],delete this.workerSources[le],delete this.demWorkerSources[le],ve()}checkIfReady(le,oe,ve){ve()}setReferrer(le,oe){this.referrer=oe}spriteLoaded(le,{scope:oe,isLoaded:ve}){if(this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),this.isSpriteLoaded[le][oe]=ve,this.workerSources[le]&&this.workerSources[le][oe])for(const $e in this.workerSources[le][oe]){const De=this.workerSources[le][oe][$e];for(const ot in De)De[ot]instanceof f.d&&(De[ot].isSpriteLoaded=ve,De[ot].fire(new f.o("isSpriteLoaded")))}}setImages(le,{scope:oe,images:ve},$e){if(this.availableImages[le]||(this.availableImages[le]={}),this.availableImages[le][oe]=ve,this.workerSources[le]&&this.workerSources[le][oe]){for(const De in this.workerSources[le][oe]){const ot=this.workerSources[le][oe][De];for(const ce in ot)ot[ce].availableImages=ve}$e()}else $e()}setProjection(le,oe){this.projections[le]=f.m(oe)}setBrightness(le,oe,ve){this.brightness=oe,ve()}setLayers(le,oe,ve){this.getLayerIndex(le,oe.scope).replace(oe.layers,oe.options),ve()}updateLayers(le,oe,ve){this.getLayerIndex(le,oe.scope).update(oe.layers,oe.removedIds,oe.options),ve()}loadTile(le,oe,ve){oe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,oe.type,oe.source,oe.scope).loadTile(oe,ve)}loadDEMTile(le,oe,ve){this.getDEMWorkerSource(le,oe.source,oe.scope).loadTile(oe,ve)}reloadTile(le,oe,ve){oe.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,oe.type,oe.source,oe.scope).reloadTile(oe,ve)}abortTile(le,oe,ve){this.getWorkerSource(le,oe.type,oe.source,oe.scope).abortTile(oe,ve)}removeTile(le,oe,ve){this.getWorkerSource(le,oe.type,oe.source,oe.scope).removeTile(oe,ve)}removeSource(le,oe,ve){if(!(this.workerSources[le]&&this.workerSources[le][oe.scope]&&this.workerSources[le][oe.scope][oe.type]&&this.workerSources[le][oe.scope][oe.type][oe.source]))return;const $e=this.workerSources[le][oe.scope][oe.type][oe.source];delete this.workerSources[le][oe.scope][oe.type][oe.source],$e.removeSource!==void 0?$e.removeSource(oe,ve):ve()}loadWorkerSource(le,oe,ve){try{this.self.importScripts(oe.url),ve()}catch($e){ve($e.toString())}}syncRTLPluginState(le,oe,ve){try{f.n.setState(oe);const $e=f.n.getPluginURL();if(f.n.isLoaded()&&!f.n.isParsed()&&$e!=null){this.self.importScripts($e);const De=f.n.isParsed();ve(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${$e}`),De)}}catch($e){ve($e.toString())}}setDracoUrl(le,oe){this.dracoUrl=oe}getAvailableImages(le,oe){this.availableImages[le]||(this.availableImages[le]={});let ve=this.availableImages[le][oe];return ve||(ve=[]),ve}getLayerIndex(le,oe){this.layerIndexes[le]||(this.layerIndexes[le]={});let ve=this.layerIndexes[le][oe];return ve||(ve=this.layerIndexes[le][oe]=new _,ve.scope=oe),ve}getWorkerSource(le,oe,ve,$e){if(this.workerSources[le]||(this.workerSources[le]={}),this.workerSources[le][$e]||(this.workerSources[le][$e]={}),this.workerSources[le][$e][oe]||(this.workerSources[le][$e][oe]={}),this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),!this.workerSources[le][$e][oe][ve]){const De={send:(ot,ce,te,Oe,pt,it)=>{this.actor.send(ot,ce,te,le,pt,it)},scheduler:this.actor.scheduler};this.workerSources[le][$e][oe][ve]=new this.workerSourceTypes[oe](De,this.getLayerIndex(le,$e),this.getAvailableImages(le,$e),this.isSpriteLoaded[le][$e],void 0,this.brightness)}return this.workerSources[le][$e][oe][ve]}getDEMWorkerSource(le,oe,ve){return this.demWorkerSources[le]||(this.demWorkerSources[le]={}),this.demWorkerSources[le][ve]||(this.demWorkerSources[le][ve]={}),this.demWorkerSources[le][ve][oe]||(this.demWorkerSources[le][ve][oe]=new w),this.demWorkerSources[le][ve][oe]}enforceCacheSizeLimit(le,oe){f.q(oe)}getWorkerPerformanceMetrics(le,oe,ve){ve(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new St(self)),St}),c(["./shared"],function(f){return f.s});var d=s;return d})})(FK);var oEe=FK.exports;const vd=uw(oEe);const sEe=({setMap:n,setSelectedCity:e})=>{vd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const a=re.useRef(null),o=re.useRef(null),[s,c]=re.useState(!1);let d=null;return re.useEffect(()=>{o.current||!a.current||(o.current=new vd.Map({attributionControl:!1,container:a.current,style:"mapbox://styles/stanronzhin/clok1b9my006901o4gkfc25b2",center:[30,40],zoom:2,pitch:25}),o.current.on("load",()=>{o.current&&(o.current.addSource("city_points",{type:"geojson",data:"data/esg_city_points.geojson",cluster:!0,clusterMaxZoom:7,clusterRadius:20}).addSource("city_clusters",{type:"geojson",data:"data/esg_urban_clusters.geojson"}),o.current.addLayer({id:"city_point_clusters",type:"circle",source:"city_points",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#f7f7f7",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,100,30,750,40]}}),o.current.addLayer({id:"city_point_cluster-count",type:"symbol",source:"city_points",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Suisse Intl Regular","Arial Unicode MS Bold"],"text-size":20}}),o.current.addLayer({id:"city_point_points",type:"symbol",source:"city_points",paint:{},layout:{"icon-image":["match",["get","Category"],["C1"],"esg_point_C1",["C3"],"esg_point_C3",["B2"],"esg_point_B2",["B3"],"esg_point_B3",["C2"],"esg_point_C2",["A1"],"esg_point_A1",["A2"],"esg_point_A2",["A3"],"esg_point_A3",["B1"],"esg_point_B1","esg_point_new"],"icon-size":["interpolate",["linear"],["zoom"],1,.35,2,.5,3,.6,6,.7,10,.8,22,.7]},filter:["!",["has","point_count"]]},"city_point_cluster-count"),o.current.addLayer({id:"city_point_labels",type:"symbol",source:"city_points",layout:{"text-line-height":0,"text-size":["interpolate",["linear"],["zoom"],0,12,1,15,2,20,3,25,6,30,10,35,22,25],"text-radial-offset":0,"symbol-avoid-edges":!0,"text-font":["Suisse Intl Regular","Arial Unicode MS Regular"],"text-offset":[0,-1.2],"text-anchor":"bottom","text-field":["to-string",["get","City_Name"]]},paint:{"text-color":"#ffffff"}}),o.current.addLayer({id:"city_cluster_hover",source:"city_clusters",type:"fill",paint:{"fill-color":"#ffffff","fill-opacity":["case",["boolean",["feature-state","hover"],!1],0,.07]}}),o.current.addLayer({id:"city_cluster_line",source:"city_clusters",type:"line",paint:{"line-color":"#ffffff","line-opacity":["interpolate",["linear"],["zoom"],0,0,8,0,10,1,22,1]}}),o.current.on("click","city_point_clusters",f=>{const m=o.current.queryRenderedFeatures(f.point,{layers:["city_point_clusters"]}),y=m[0].properties.cluster_id;f.features[0].properties.City_Name,o.current.getSource("city_points").getClusterExpansionZoom(y,(_,w)=>{_||o.current.easeTo({center:m[0].geometry.coordinates,zoom:w+3.2,duration:3e3})})}),o.current.on("click","city_point_labels",f=>{o.current&&o.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),o.current.on("click","city_point_points",f=>{if(!o.current)return;const m=f.features[0].properties.City_Name;e(m),o.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),o.current.on("mouseenter","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseenter","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseleave","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseenter","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("click","city_cluster_hover",f=>{o.current&&f.features[0].properties.City_Name}),o.current.on("mousemove","city_cluster_hover",f=>{if(f.features.length>0){if(!o.current)return;d!==null&&o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1}),d=f.features[0].id,o.current.setFeatureState({source:"city_clusters",id:d},{hover:!0})}}),o.current.on("mouseleave","city_cluster_hover",()=>{if(d!==null){if(!o.current)return;o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1})}d=null}))}),n(o.current))},[]),re.useEffect(()=>{o.current&&o.current.easeTo({center:[55,25],duration:5e3,zoom:2.5,pitch:15,easing:f=>f})},[s]),he("div",{ref:a,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},iI=({color:n,title:e,value:a,status:o})=>{const{classes:s}=mT();return Bt("div",{className:s.statItem,children:[he("div",{className:s.statTitle,children:e}),he("div",{className:s.statValue,children:a}),he("div",{className:s.statStatus,style:{color:n,borderColor:`${n}30`},children:o})]})},bh={LOW:"#FF632F",AVERAGE:"#FF9B3F",VERY_LARGE:"#FF3B29",STRONG:"#A0DA8B"},ru=({label:n,status:e})=>{const{classes:a}=mT();return e?Bt("div",{className:a.smallRowWrapper,children:[Bt("div",{style:{display:"block",float:"left",height:"100%",padding:"8px 0",marginRight:"3vh",width:"9vh"},children:[" ",he("div",{className:a.statsSmallText,children:n})]}),he("div",{style:{flex:1,display:"flex",justifyContent:"flex-start"},children:he("div",{className:a.statStatus,style:{color:bh[e.toUpperCase()],borderColor:`${bh[e.toUpperCase()]}30`},children:e})})]}):null},lEe={A1:"#35CB00",A2:"#75D652",A3:"#B7DE86",B1:"#ECE38E",B2:"#FFD748",B3:"#FFC700",C1:"#FF9B3F",C2:"#FF632F",C3:"#F74B3C"},a0=({label:n,subLabel:e,status:a,isFirst:o})=>{const{classes:s}=mT();if(!a)return null;const c=a.replace("-","");return Bt("div",{style:{display:"flex",flexDirection:"column",gap:"1.3vh",alignItems:o?"flex-start":"center"},children:[he("div",{className:s.statsBigText,style:{textAlign:o?"left":"center"},children:n==="Urban resilience index"?Bt("div",{children:["Urban",he("br",{}),"resilience index"]}):n}),e&&he("div",{className:s.lowOpacityLabel,style:{marginTop:"-.6vh"},children:e}),he("div",{className:s.statStatusBig,style:{color:"#fff",marginTop:o?"0":"1.5vh",padding:"1vh 3vh",backgroundColor:o?lEe[c]:"rgba(255, 255, 255, 0.07)"},children:a})]})},cEe=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.96718879043169,32.00280698304451],zoom:10.000000000000009,bearing:101.60000000000173,pitch:49.99999999999967,vscale:.7},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439,vscale:.9},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50,vscale:1},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.48226179199627,9.083198866519695],zoom:10.591526871591094,bearing:-20.799999999999727,pitch:47.51373809516402,vscale:.7},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62,vscale:.9},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.82667518481037,-6.350464399947057],zoom:9.099467639422393,bearing:-153.5999999999998,pitch:46.99999999999997,vscale:1},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.579160832283065,-33.973034474213975],zoom:10.174985293257919,bearing:0,pitch:39.98000000000012,vscale:.8},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.48427166516629,-33.02603685224794],zoom:10.663321631643026,bearing:167.86383725437076,pitch:41.000000000000135,vscale:1.5,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,vscale:.7,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,vscale:.6,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.286496264601823,-4.2411132990048515],zoom:11.378416402173768,bearing:-76.7999999999999,pitch:47.499999999999844,vscale:.15,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.88647818381759,43.256008733418724],zoom:10.249467639422363,bearing:0,pitch:44.97999999999996,vscale:1.5,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.2747162313259,15.633478866808957],zoom:11.643190533205994,bearing:0,pitch:44.94535508727158,vscale:.35,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],uEe=({selectedCityName:n})=>{vd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{var s;if(a.current||!e.current)return;const o=(s=cEe.find(c=>c.properties.City_Name===n))==null?void 0:s.properties;a.current=new vd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:o==null?void 0:o.center,zoom:o==null?void 0:o.zoom,bearing:o==null?void 0:o.bearing,pitch:o==null?void 0:o.pitch}),a.current.on("load",()=>{if(!a.current)return;a.current.resize();let c,d,f=!1;function m(y){c===void 0&&(c=y);const _=y-c;if(d!==y){const w=Math.min((o==null?void 0:o.vscale)/2500*_,o==null?void 0:o.vscale);a.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",w),w===1&&(f=!0)}_<2500&&(d=y,f||requestAnimationFrame(m))}m(0)})},[]),he("div",{ref:e,style:{pointerEvents:"none",position:"absolute",top:"20vh",right:"0",width:"60%",height:"80vh"}})},zs={Adoni:"Adoni_IEC_A&S_Report.pdf",Almaty:"Almaty_IEC_A&S_Report.pdf",Brazzaville:"Brazzaville_IEC_A&S_Report.pdf",DarEsSalaam:"Dar es Salaam_IEC_A&S_Report.pdf",DubaiExpo:"Dubai_Expo_IEC_A&S_Report.pdf",Dubai:"Dubai_IEC_A&S_Report.pdf",Natal:"Natal_IEC_A&S_Report.pdf",Valparaiso:"Valparaiso_IEC_A&S_Report.pdf"},k6=[{City:"Dubai",Country:"UAE","Text description":"Largest city of the UAE, one of the main global cities",Population:"4 865 222","Population description":"large","Population density":40.6,"Population density description":"medium","Population city proper":"3 549 900","Population density city proper":22.049068322981366,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-3",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.053,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:3,Efficiency:4,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Dubai/1.jpg","/assets/Dubai/2.jpg","/assets/Dubai/3.jpg","/assets/Dubai/4.jpg","/assets/Dubai/5.jpg"],pdfName:zs.Dubai},{City:"Expo City Dubai",Country:"UAE","Text description":"New city of innovation and advanced technologies",Population:"2 275","Population description":"small","Population density":8.8,"Population density description":"small","Population city proper":"2 275","Population density city proper":8.8,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-2",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Very strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":0,"Poverty headcount ratio at national poverty lines description":"very strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very strong",Efficiency:"Very strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:5,Efficiency:5,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],pdfName:zs.DubaiExpo},{City:"Valparaiso",Country:"Chile","Text description":"Second largest city of the country, the major Chile's port",Population:"965 937","Population description":"large","Population density":41.7,"Population density description":"medium","Population city proper":"252 888","Population density city proper":52.739937434827944,Climate:"14C, 16 kph, 345 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"C-1",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.21,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"11 082","Mean salary description":"very strong","Literacy rate among population":.992,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Average","Natural disaster hazards":"Very strong","Water availability":"Average","Food availability":"Strong","Energy availability":"Very strong",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Average",SME:"Very low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":2},images:["/assets/Valparaiso/1.jpg","/assets/Valparaiso/2.jpg","/assets/Valparaiso/3.jpg","/assets/Valparaiso/4.jpg","/assets/Valparaiso/5.jpg"],pdfName:zs.Valparaiso},{City:"Dar es Salaam",Country:"Tanzania","Text description":"Largest city of the country, one of the Africa's main centres",Population:"9 314 731","Population description":"very large","Population density":71.9,"Population density description":"large","Population city proper":"5 383 728","Population density city proper":163.14327272727272,Climate:"27C, 17 kph, 1 114 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"C-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Very low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.333,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":199,"Mean salary description":"very low","Literacy rate among population":.867,"Literacy rate among population description":"strong","Air pollution":"Average","Water pollution":"Very low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Strong","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Low",Safety_1:"Very low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:2,Safety:1,Affordability:4,"Environmental impact":5},images:["/assets/DarEsSalaam/1.jpg","/assets/DarEsSalaam/2.jpg","/assets/DarEsSalaam/3.jpg","/assets/DarEsSalaam/4.jpg","/assets/DarEsSalaam/5.jpg"],pdfName:zs.DarEsSalaam},{City:"Adoni",Country:"India","Text description":"A historical city and an agricultural centre in Andhra Pradesh",Population:"232 552","Population description":"medium","Population density":64.4,"Population density description":"large","Population city proper":"184 625","Population density city proper":93.71827411167513,Climate:"27C, 17 kph, 691 mm ","Climate description":"Temperate, desert, hot summer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Very low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very low","Poverty headcount ratio at national poverty lines":.273,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"2 769","Mean salary description":"average","Literacy rate among population":.774,"Literacy rate among population description":"average","Air pollution":"Average","Water pollution":"Low","Land use and waste":"Strong","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Average","Energy availability":"Strong",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Low",Efficiency:"Strong",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:4,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":4},images:["/assets/Adoni/1.jpg","/assets/Adoni/2.jpeg","/assets/Adoni/3.jpeg","/assets/Adoni/4.jpg","/assets/Adoni/5.jpeg","/assets/Adoni/6.png"],pdfName:zs.Adoni},{City:"Natal",Country:"Brazil","Text description":"Regional centre of the Rio Grande do Norte",Population:"1 318 291","Population description":"large","Population density":53,"Population density description":"large","Population city proper":"896 710","Population density city proper":52.74764705882353,Climate:"26C, 23 kph, 1 225 mm ","Climate description":"Tropical, dry summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.15,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"1 794","Mean salary description":"average","Literacy rate among population":.993,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Average","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Average",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:4,"Environmental impact":5},images:["/assets/Natal/1.png","/assets/Natal/2.png","/assets/Natal/3.jpeg","/assets/Natal/4.jpeg"],pdfName:zs.Natal},{City:"Brazzaville",Country:"Congo","Text description":"Capital and largest city of the Republic of the Congo",Population:"3 186 838","Population description":"large","Population density":374,"Population density description":"very large","Population city proper":"1 932 610","Population density city proper":193.261,Climate:"25C, 8 kph, 1 095 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-1",Environmental:"Average",Social:"Very low",Governmental:"Average","Current state":"Average","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.193,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"1 282","Mean salary description":"average","Literacy rate among population":.818,"Literacy rate among population description":"average","Air pollution":"Strong","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Low","Energy availability":"Average",Health:"Very low",Education:"Average",Wealth:"Low",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Very low",Accountability:"Very low","City budget":"Very low",SME:"Very low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Very low",Accessibility:"Low",Safety_1:"Average",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:4,Efficiency:1,Accessibility:2,Safety:3,Affordability:4,"Environmental impact":4},images:["/assets/Brazzaville/1.jpeg","/assets/Brazzaville/2.jpg","/assets/Brazzaville/3.jpeg","/assets/Brazzaville/4.jpeg"],pdfName:zs.Brazzaville},{City:"Almaty",Country:"Kazakhstan","Text description":"Largest city in the country",Population:"2 539 108","Population description":"large","Population density":37.7,"Population density description":"medium","Population city proper":"2 211 198","Population density city proper":32.35110460863204,Climate:"7C, 10 kph, 891 mm ","Climate description":"Continental, humid, warm summer","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"A-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.187,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 901","Mean salary description":"average","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Very strong","Food availability":"Strong","Energy availability":"Strong",Health:"Very strong",Education:"Strong",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Strong",Inclusion:"Low",Accountability:"Average","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Low","Environmental impact":"Strong",tr_graph:{Satisfaction:1,Efficiency:2,Accessibility:3,Safety:4,Affordability:2,"Environmental impact":4},images:["/assets/Almaty/1.jpg","/assets/Almaty/2.jpg","/assets/Almaty/3.jpg","/assets/Almaty/4.jpg"],pdfName:zs.Almaty},{City:"Cape Town",Country:"South Africa","Text description":"Second largest city of the country, the regional centre of the Western Cape",Population:"4 293 836","Population description":"large","Population density":67.7,"Population density description":"large","Population city proper":"4 005 016","Population density city proper":16.38043353783231,Climate:"16C, 20 kph, 621 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Strong","Current state":"Strong","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.555,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":"1 686","Mean salary description":"average","Literacy rate among population":.971,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Low","Energy availability":"Low",Health:"Very low",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Average",Transport:"Strong",Inclusion:"Strong",Accountability:"Strong","City budget":"Low",SME:"Average","Public services":"Strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/CapeTown/1.jpg","/assets/CapeTown/2.jpg","/assets/CapeTown/3.jpg","/assets/CapeTown/4.jpg"],pdfName:zs.Dubai},{City:"Mexico City",Country:"Mexico","Text description":"Capital and the largest city of Mexico, one of the largest urban areas in the World",Population:"17 317 588","Population description":"very large","Population density":88.5,"Population density description":"large","Population city proper":"8 843 706","Population density city proper":120.3225306122449,Climate:"16C, 8 kph, 1 058 mm ","Climate description":"Temperate, dry winter, hot summmer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Low","Ability & Willingness":"Low","Basic needs Scope":"C-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.363,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":891,"Mean salary description":"low","Literacy rate among population":.991,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Very low","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Very low",Accountability:"Low","City budget":"Low",SME:"Low","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:2,Efficiency:1,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Mexico/1.jpg","/assets/Mexico/2.png","/assets/Mexico/3.jpeg","/assets/Mexico/4.jpg","/assets/Mexico/5.jpeg","/assets/Mexico/6.jpeg"],pdfName:zs.Dubai},{City:"Jakarta",Country:"Indonesia","Text description":"Capital and the largest city of Indonesia, one of the largest urban areas in the World",Population:"38 758 456","Population description":"very large","Population density":91.8,"Population density description":"very large","Population city proper":"10 679 951","Population density city proper":161.51643149887332,Climate:"26C, 10 kph, 2 097 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Low","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.047,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":554,"Mean salary description":"low","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Average","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Low","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Strong",Livability:"Average",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Low",SME:"Strong","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:3,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Jakarta/1.jpg","/assets/Jakarta/2.jpg","/assets/Jakarta/3.jpg","/assets/Jakarta/4.jpeg","/assets/Jakarta/5.jpeg","/assets/Jakarta/6.jpeg"],pdfName:zs.Dubai},{City:"Panama City",Country:"Panama","Text description":"Capital and the largest city of Panama",Population:"1 584 643","Population description":"large","Population density":66.6,"Population density description":"large","Population city proper":"1 367 767","Population density city proper":47.40302904276703,Climate:"26C, 17 kph, 2 088 mm ","Climate description":"Tropical, monsoonal","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.046,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"1 279","Mean salary description":"average","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Average",Inclusion:"Average",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Strong","Sustainability commitment":"Strong",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":4},images:["/assets/Panama/1.jpg","/assets/Panama/2.jpeg","/assets/Panama/3.jpeg","/assets/Panama/4.jpg","/assets/Panama/5.jpeg","/assets/Panama/6.jpeg","/assets/Panama/7.jpg"],pdfName:zs.Dubai},{City:"Amman",Country:"Jordan","Text description":"Capital and the largest city of Jordan",Population:"6 366 731","Population description":"very large","Population density":137.1,"Population density description":"very large","Population city proper":"1 812 059","Population density city proper":119.68685601056804,Climate:"17C, 13 kph, 187 mm ","Climate description":"Arid, dry summer, cold","Urban Resilience Index":"B-1",Environmental:"Low",Social:"Strong",Governmental:"Strong","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.157,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 284","Mean salary description":"average","Literacy rate among population":.994,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Average","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Average",SME:"Average","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":2},images:["/assets/Amman/1.jpg","/assets/Amman/2.jpeg","/assets/Amman/3.jpeg","/assets/Amman/4.jpeg","/assets/Amman/5.jpeg"],pdfName:zs.Dubai},{City:"Bangkok",Country:"Thailand","Text description":"Capital and the largest city of Thailand",Population:"19 005 476","Population description":"very large","Population density":70.8,"Population density description":"large","Population city proper":"5 666 264","Population density city proper":36.11385595920969,Climate:"28C, 10 kph, 1 207 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Low","Current state":"Low","Ability & Willingness":"Average","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.063,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":421,"Mean salary description":"low","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Low","Water availability":"Strong","Food availability":"Low","Energy availability":"Strong",Health:"Strong",Education:"Low",Wealth:"Average",Safety:"Very strong",Livability:"Average",Transport:"Low",Inclusion:"Strong",Accountability:"Low","City budget":"Very low",SME:"Very strong","Public services":"Low","Sustainability commitment":"Strong",Satisfaction:"Average",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:1,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":3},images:["/assets/Bangkok/1.jpg","/assets/Bangkok/2.jpg","/assets/Bangkok/3.jpg","/assets/Bangkok/4.jpg","/assets/Bangkok/5.jpg"],pdfName:zs.Dubai},{City:"Colombo",Country:"Sri Lanka","Text description":"Largest city and commercial capital of Sri Lanka",Population:"4 938 510","Population description":"large","Population density":38,"Population density description":"medium","Population city proper":"2 324 349","Population density city proper":33.25248927038626,Climate:"26C, 16 kph, 2 387 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Low","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Average","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.143,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":183,"Mean salary description":"very low","Literacy rate among population":.99,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Low","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Strong",Inclusion:"Average",Accountability:"Very low","City budget":"Low",SME:"Average","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/Colombo/1.jpg","/assets/Colombo/2.jpg","/assets/Colombo/3.jpg","/assets/Colombo/4.jpg"],pdfName:zs.Dubai}],BK=["Dubai","Expo City Dubai","Valparaiso","Dar es Salaam","Adoni","Natal","Brazzaville","Almaty","Cape Town","Mexico City","Jakarta","Panama City","Amman","Bangkok","Colombo"],dEe=[{city:"Dubai",E:`Mitigate effects of air pollution, especially SO2, NO2:\r
- promoting electric vehicles,\r
- implementation of urban planning policies aimed at reducing long-distance travel within the city, providing new communities with the leisure, and social infrastructure.\r
\r
Introduction of modern technologies for construction waste.`,S:"Strengthen social policy eradicating poverty and ensuring equality in a city (poverty headcount ratio at national poverty lines is still around 5%).",G:`Gender-balancing of bureaucratic procedures.\r
\r
Strengthening labor conditions regulation, primarily for low-skilled personnel (relatively high slavery index  40% vulnerability to modern slavery).`},{city:"Expo City Dubai",E:`Mitigate the effects of pollution, especially particulate matter.\r
- For instance, expand the deployment of regenerative-air vacuum sweepers for both streets and sidewalks. Introduce technologies for indoor air purification in buildings.\r
- Continue planting trees.`,S:"Develop healthcare policies aimed to expand hospital capacity and training of doctors.",G:`Streamline SME access to become ECD residents by minimizing obstacles to renting and launching an entrepreneurship support program.\r
\r
Establish one-stop shop platform for all municipal and state services, creating a one-stop-shop approach.`},{city:"Valparaiso",E:"Strengthening control over SO2 emissions, increasing environmental requirements for ships entering the port.",S:"A programme for the development of public spaces in the city, involving the creation of leisure facilities.",G:"Creation of an ecosystem for start-ups and entrepreneurship (low level of officially registered small businesses per 1 inhabitant  383,7)."},{city:"Dar es Salaam",E:"Policy on treatment of drinking water sources (high average of pH concentration in water (8,5) and high toxins metrics), including modernisation of sewerage and construction of treatment plants, improvement of financial management. Attracting investments of development institutions in water supply and sewage systems.",S:`Community Literacy Programme (literacy rate  76,8%). Development of teacher training system, development of online education with the involvement of teachers from swahili and english speaking countries.\r
\r
 Remote employment promotion.`,G:"Statistics and accounting quality improvement."},{city:"Adoni",E:"Policy on reclamation of landfills and degraded lands. Construction of waste incineration plants, which will also improve energy supply to certain areas.",S:"A programme to improve road safety (+20,8% road fatalities in 2019-2022). Attracting investment to improve the quality of roads. ",G:"Development of mobile communication infrastructure."},{city:"Natal",E:"Natural disasters mitigation policy (increasing frequency of hurricanes and the rise on the sea level).",S:`Social inclusion policy as a response for high number of violence crimes (violent crime rate  31,9 per 1,000 population), including those aimed at the integration of residents of favelas into the labour market, entrepreneurship and social support.\r
\r
Development of social and communal infrastructure outside the administrative boundaries of the city in areas of active housing construction.\r
\r
Organisation of volunteer programmes (the lowest volunteerism rate among the cities  less than 0,1 volunteer per capita).`,G:"Increasing transparency of city finances and reporting."},{city:"Brazzaville",E:`Strengthen waste management strategy due to relatively low levels of waste recycling.\r
\r
Extensive urban sprawl requires urgent measures to preserve green areas.`,S:`Expansion of hospital capacity and training of doctors. \r
\r
Providing slums with basic infrastructure (energy, clean water, waste collection).\r
\r
Establishment of a programme to support micro-enterprises and trade infrastructure development projects.`,G:"Mandatory publication of the city budget and its discussion with stakeholders."},{city:"Almaty",E:"Replacing coal with gas as the main source of energy.",S:"Transport policy aimed at making public transport more attractive, implementation of LRT and BRT projects; polycentric urban development.",G:"Strengthening controls over financial flows and anti-corruption policies (high number of news on bribery scandals)."},{city:"Cape Town",E:"Strengthen waste management strategy due to relatively low levels of waste recycling.",S:`Develop complex programs to decrease child mortality rate (womens healthcare programs, trainings of doctors, hospital equipment).\r
\r
Country-level system to increase literacy rate. Training programs for teachers which will also allow to decrease average number of pupils in the class.\r
\r
Social inclusion policy as a response to high violent crime rates.`,G:"Develop city policies to increase small and medium enterprises activity."},{city:"Mexico City",E:"Mitigate effects of air pollution. Especially SO2, NO2.",S:"Reform healthcare system paying special attention to implementation of effective city ambulance system. Develop plan aimed at increasing life expectancy at birth. ",G:`Pay attention to ESG planning and reporting as currently no policies are implemented.\r
\r
Increase transparency of city finance and reporting.`},{city:"Jakarta",E:`Mitigate effects of high CO2 emissions and concentrations.\r
\r
Increase parks and green zones ares.`,S:`Develop programs aimed at transport system transformation (decrease of heavy traffic).\r
\r
Diversify importers of cereal and food to decrease risks implemented by high level of dependency on imports.`,G:"Increase transparency of city finance and reporting."},{city:"Panama City",E:"Improve policy on reclamation of landfills and degraded lands.",S:`Develop special programs aimed at increase in school attendance. Develop trainings of teachers.\r
\r
Strengthen inclusion policies, especially  for women and refugees.`,G:`Increase financial transparency of city government companies.\r
\r
Build up government system to intensify e-gov services provision.`},{city:"Amman",E:`Mitigate effects of high NO2 concentrations.\r
\r
Strengthen construction waste management strategy.`,S:"Develop measures that will allow to decrease number of road fatalities.",G:"Develop system that will allow to implement free phone to call the police, ambulance, firefighters at least for citizens."},{city:"Bangkok",E:"Improve waste management system and introduce more effective natural disaster mitigation measures.",S:`Reform system of ambulance due to extremely long time needed.\r
\r
Increase investments in the compulsory education system.`,G:"Despite strong SME support measures public services system needs to be reshaped in order to standardize procedures and reduce waiting times"},{city:"Colombo",E:"While significant improvements have been made in natural disaster risk mitigation, the city still needs to turn its attention to air and water pollution where policies lag behind.",S:"Introduction of new social welfare policies to combat poverty. Despite relatively high levels of safety and healthcare the city is still behind its peers in terms of food availability and wealth.",G:`Strengthen budget policies and regulations to be able to plan long term measures.\r
\r
The city needs to invest into ESG strategies and reporting.`}],hEe=Mc()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden"},blueSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#1433AE"},whiteSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#ffffff"},blackSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#000000"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"}}),fEe=Mc()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}}),pEe=({title:n,text:e})=>{const{classes:a}=fEe();return Bt("div",{className:a.wrapper,children:[he("div",{className:a.titleWrapper,children:he(Ws,{className:a.title,children:n})}),he(Ws,{className:a.text,children:e})]})};/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function Bw(n){return n+.5|0}const Zf=(n,e,a)=>Math.max(Math.min(n,a),e);function Eb(n){return Zf(Bw(n*2.55),0,255)}function hp(n){return Zf(Bw(n*255),0,255)}function yh(n){return Zf(Bw(n/2.55)/100,0,1)}function dG(n){return Zf(Bw(n*100),0,100)}const pc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},DR=[..."0123456789ABCDEF"],mEe=n=>DR[n&15],gEe=n=>DR[(n&240)>>4]+DR[n&15],nA=n=>(n&240)>>4===(n&15),yEe=n=>nA(n.r)&&nA(n.g)&&nA(n.b)&&nA(n.a);function vEe(n){var e=n.length,a;return n[0]==="#"&&(e===4||e===5?a={r:255&pc[n[1]]*17,g:255&pc[n[2]]*17,b:255&pc[n[3]]*17,a:e===5?pc[n[4]]*17:255}:(e===7||e===9)&&(a={r:pc[n[1]]<<4|pc[n[2]],g:pc[n[3]]<<4|pc[n[4]],b:pc[n[5]]<<4|pc[n[6]],a:e===9?pc[n[7]]<<4|pc[n[8]]:255})),a}const _Ee=(n,e)=>n<255?e(n):"";function bEe(n){var e=yEe(n)?mEe:gEe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+_Ee(n.a,e):void 0}const xEe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function UK(n,e,a){const o=e*Math.min(a,1-a),s=(c,d=(c+n/30)%12)=>a-o*Math.max(Math.min(d-3,9-d,1),-1);return[s(0),s(8),s(4)]}function wEe(n,e,a){const o=(s,c=(s+n/60)%6)=>a-a*e*Math.max(Math.min(c,4-c,1),0);return[o(5),o(3),o(1)]}function SEe(n,e,a){const o=UK(n,1,.5);let s;for(e+a>1&&(s=1/(e+a),e*=s,a*=s),s=0;s<3;s++)o[s]*=1-e-a,o[s]+=e;return o}function AEe(n,e,a,o,s){return n===s?(e-a)/o+(e<a?6:0):e===s?(a-n)/o+2:(n-e)/o+4}function D6(n){const a=n.r/255,o=n.g/255,s=n.b/255,c=Math.max(a,o,s),d=Math.min(a,o,s),f=(c+d)/2;let m,y,_;return c!==d&&(_=c-d,y=f>.5?_/(2-c-d):_/(c+d),m=AEe(a,o,s,_,c),m=m*60+.5),[m|0,y||0,f]}function O6(n,e,a,o){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,a,o)).map(hp)}function z6(n,e,a){return O6(UK,n,e,a)}function EEe(n,e,a){return O6(SEe,n,e,a)}function MEe(n,e,a){return O6(wEe,n,e,a)}function WK(n){return(n%360+360)%360}function TEe(n){const e=xEe.exec(n);let a=255,o;if(!e)return;e[5]!==o&&(a=e[6]?Eb(+e[5]):hp(+e[5]));const s=WK(+e[2]),c=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?o=EEe(s,c,d):e[1]==="hsv"?o=MEe(s,c,d):o=z6(s,c,d),{r:o[0],g:o[1],b:o[2],a}}function CEe(n,e){var a=D6(n);a[0]=WK(a[0]+e),a=z6(a),n.r=a[0],n.g=a[1],n.b=a[2]}function PEe(n){if(!n)return;const e=D6(n),a=e[0],o=dG(e[1]),s=dG(e[2]);return n.a<255?`hsla(${a}, ${o}%, ${s}%, ${yh(n.a)})`:`hsl(${a}, ${o}%, ${s}%)`}const hG={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},fG={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function IEe(){const n={},e=Object.keys(fG),a=Object.keys(hG);let o,s,c,d,f;for(o=0;o<e.length;o++){for(d=f=e[o],s=0;s<a.length;s++)c=a[s],f=f.replace(c,hG[c]);c=parseInt(fG[d],16),n[f]=[c>>16&255,c>>8&255,c&255]}return n}let aA;function LEe(n){aA||(aA=IEe(),aA.transparent=[0,0,0,0]);const e=aA[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const REe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function kEe(n){const e=REe.exec(n);let a=255,o,s,c;if(e){if(e[7]!==o){const d=+e[7];a=e[8]?Eb(d):Zf(d*255,0,255)}return o=+e[1],s=+e[3],c=+e[5],o=255&(e[2]?Eb(o):Zf(o,0,255)),s=255&(e[4]?Eb(s):Zf(s,0,255)),c=255&(e[6]?Eb(c):Zf(c,0,255)),{r:o,g:s,b:c,a}}}function DEe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${yh(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const rI=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Kv=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function OEe(n,e,a){const o=Kv(yh(n.r)),s=Kv(yh(n.g)),c=Kv(yh(n.b));return{r:hp(rI(o+a*(Kv(yh(e.r))-o))),g:hp(rI(s+a*(Kv(yh(e.g))-s))),b:hp(rI(c+a*(Kv(yh(e.b))-c))),a:n.a+a*(e.a-n.a)}}function iA(n,e,a){if(n){let o=D6(n);o[e]=Math.max(0,Math.min(o[e]+o[e]*a,e===0?360:1)),o=z6(o),n.r=o[0],n.g=o[1],n.b=o[2]}}function VK(n,e){return n&&Object.assign(e||{},n)}function pG(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=hp(n[3]))):(e=VK(n,{r:0,g:0,b:0,a:1}),e.a=hp(e.a)),e}function zEe(n){return n.charAt(0)==="r"?kEe(n):TEe(n)}class nw{constructor(e){if(e instanceof nw)return e;const a=typeof e;let o;a==="object"?o=pG(e):a==="string"&&(o=vEe(e)||LEe(e)||zEe(e)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var e=VK(this._rgb);return e&&(e.a=yh(e.a)),e}set rgb(e){this._rgb=pG(e)}rgbString(){return this._valid?DEe(this._rgb):void 0}hexString(){return this._valid?bEe(this._rgb):void 0}hslString(){return this._valid?PEe(this._rgb):void 0}mix(e,a){if(e){const o=this.rgb,s=e.rgb;let c;const d=a===c?.5:a,f=2*d-1,m=o.a-s.a,y=((f*m===-1?f:(f+m)/(1+f*m))+1)/2;c=1-y,o.r=255&y*o.r+c*s.r+.5,o.g=255&y*o.g+c*s.g+.5,o.b=255&y*o.b+c*s.b+.5,o.a=d*o.a+(1-d)*s.a,this.rgb=o}return this}interpolate(e,a){return e&&(this._rgb=OEe(this._rgb,e._rgb,a)),this}clone(){return new nw(this.rgb)}alpha(e){return this._rgb.a=hp(e),this}clearer(e){const a=this._rgb;return a.a*=1-e,this}greyscale(){const e=this._rgb,a=Bw(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=a,this}opaquer(e){const a=this._rgb;return a.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return iA(this._rgb,2,e),this}darken(e){return iA(this._rgb,2,-e),this}saturate(e){return iA(this._rgb,1,e),this}desaturate(e){return iA(this._rgb,1,-e),this}rotate(e){return CEe(this._rgb,e),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function uh(){}const FEe=(()=>{let n=0;return()=>n++})();function li(n){return n===null||typeof n>"u"}function or(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ka(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function $r(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function zl(n,e){return $r(n)?n:e}function za(n,e){return typeof n>"u"?e:n}const NEe=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,GK=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Qi(n,e,a){if(n&&typeof n.call=="function")return n.apply(a,e)}function zi(n,e,a,o){let s,c,d;if(or(n))if(c=n.length,o)for(s=c-1;s>=0;s--)e.call(a,n[s],s);else for(s=0;s<c;s++)e.call(a,n[s],s);else if(Ka(n))for(d=Object.keys(n),c=d.length,s=0;s<c;s++)e.call(a,n[d[s]],d[s])}function eM(n,e){let a,o,s,c;if(!n||!e||n.length!==e.length)return!1;for(a=0,o=n.length;a<o;++a)if(s=n[a],c=e[a],s.datasetIndex!==c.datasetIndex||s.index!==c.index)return!1;return!0}function tM(n){if(or(n))return n.map(tM);if(Ka(n)){const e=Object.create(null),a=Object.keys(n),o=a.length;let s=0;for(;s<o;++s)e[a[s]]=tM(n[a[s]]);return e}return n}function HK(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function BEe(n,e,a,o){if(!HK(n))return;const s=e[n],c=a[n];Ka(s)&&Ka(c)?aw(s,c,o):e[n]=tM(c)}function aw(n,e,a){const o=or(e)?e:[e],s=o.length;if(!Ka(n))return n;a=a||{};const c=a.merger||BEe;let d;for(let f=0;f<s;++f){if(d=o[f],!Ka(d))continue;const m=Object.keys(d);for(let y=0,_=m.length;y<_;++y)c(m[y],n,d,a)}return n}function nx(n,e){return aw(n,e,{merger:UEe})}function UEe(n,e,a){if(!HK(n))return;const o=e[n],s=a[n];Ka(o)&&Ka(s)?nx(o,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=tM(s))}const mG={"":n=>n,x:n=>n.x,y:n=>n.y};function WEe(n){const e=n.split("."),a=[];let o="";for(const s of e)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function VEe(n){const e=WEe(n);return a=>{for(const o of e){if(o==="")break;a=a&&a[o]}return a}}function bp(n,e){return(mG[e]||(mG[e]=VEe(e)))(n)}function F6(n){return n.charAt(0).toUpperCase()+n.slice(1)}const iw=n=>typeof n<"u",xp=n=>typeof n=="function",gG=(n,e)=>{if(n.size!==e.size)return!1;for(const a of n)if(!e.has(a))return!1;return!0};function GEe(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const cr=Math.PI,lr=2*cr,HEe=lr+cr,nM=Number.POSITIVE_INFINITY,jEe=cr/180,so=cr/2,Wm=cr/4,yG=cr*2/3,Yf=Math.log10,pd=Math.sign;function ax(n,e,a){return Math.abs(n-e)<a}function vG(n){const e=Math.round(n);n=ax(n,e,n/1e3)?e:n;const a=Math.pow(10,Math.floor(Yf(n))),o=n/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function $Ee(n){const e=[],a=Math.sqrt(n);let o;for(o=1;o<a;o++)n%o===0&&(e.push(o),e.push(n/o));return a===(a|0)&&e.push(a),e.sort((s,c)=>s-c).pop(),e}function n_(n){return!isNaN(parseFloat(n))&&isFinite(n)}function qEe(n,e){const a=Math.round(n);return a-e<=n&&a+e>=n}function jK(n,e,a){let o,s,c;for(o=0,s=n.length;o<s;o++)c=n[o][a],isNaN(c)||(e.min=Math.min(e.min,c),e.max=Math.max(e.max,c))}function ou(n){return n*(cr/180)}function N6(n){return n*(180/cr)}function _G(n){if(!$r(n))return;let e=1,a=0;for(;Math.round(n*e)/e!==n;)e*=10,a++;return a}function $K(n,e){const a=e.x-n.x,o=e.y-n.y,s=Math.sqrt(a*a+o*o);let c=Math.atan2(o,a);return c<-.5*cr&&(c+=lr),{angle:c,distance:s}}function OR(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function XEe(n,e){return(n-e+HEe)%lr-cr}function Nl(n){return(n%lr+lr)%lr}function rw(n,e,a,o){const s=Nl(n),c=Nl(e),d=Nl(a),f=Nl(c-s),m=Nl(d-s),y=Nl(s-c),_=Nl(s-d);return s===c||s===d||o&&c===d||f>m&&y<_}function Fo(n,e,a){return Math.max(e,Math.min(a,n))}function ZEe(n){return Fo(n,-32768,32767)}function Eh(n,e,a,o=1e-6){return n>=Math.min(e,a)-o&&n<=Math.max(e,a)+o}function B6(n,e,a){a=a||(d=>n[d]<e);let o=n.length-1,s=0,c;for(;o-s>1;)c=s+o>>1,a(c)?s=c:o=c;return{lo:s,hi:o}}const Mh=(n,e,a,o)=>B6(n,a,o?s=>{const c=n[s][e];return c<a||c===a&&n[s+1][e]===a}:s=>n[s][e]<a),YEe=(n,e,a)=>B6(n,a,o=>n[o][e]>=a);function KEe(n,e,a){let o=0,s=n.length;for(;o<s&&n[o]<e;)o++;for(;s>o&&n[s-1]>a;)s--;return o>0||s<n.length?n.slice(o,s):n}const qK=["push","pop","shift","splice","unshift"];function JEe(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),qK.forEach(a=>{const o="_onData"+F6(a),s=n[a];Object.defineProperty(n,a,{configurable:!0,enumerable:!1,value(...c){const d=s.apply(this,c);return n._chartjs.listeners.forEach(f=>{typeof f[o]=="function"&&f[o](...c)}),d}})})}function bG(n,e){const a=n._chartjs;if(!a)return;const o=a.listeners,s=o.indexOf(e);s!==-1&&o.splice(s,1),!(o.length>0)&&(qK.forEach(c=>{delete n[c]}),delete n._chartjs)}function XK(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const ZK=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function YK(n,e){let a=[],o=!1;return function(...s){a=s,o||(o=!0,ZK.call(window,()=>{o=!1,n.apply(e,a)}))}}function QEe(n,e){let a;return function(...o){return e?(clearTimeout(a),a=setTimeout(n,e,o)):n.apply(this,o),e}}const U6=n=>n==="start"?"left":n==="end"?"right":"center",fs=(n,e,a)=>n==="start"?e:n==="end"?a:(e+a)/2,eMe=(n,e,a,o)=>n===(o?"left":"right")?a:n==="center"?(e+a)/2:e;function KK(n,e,a){const o=e.length;let s=0,c=o;if(n._sorted){const{iScale:d,_parsed:f}=n,m=d.axis,{min:y,max:_,minDefined:w,maxDefined:A}=d.getUserBounds();w&&(s=Fo(Math.min(Mh(f,m,y).lo,a?o:Mh(e,m,d.getPixelForValue(y)).lo),0,o-1)),A?c=Fo(Math.max(Mh(f,d.axis,_,!0).hi+1,a?0:Mh(e,m,d.getPixelForValue(_),!0).hi+1),s,o)-s:c=o-s}return{start:s,count:c}}function JK(n){const{xScale:e,yScale:a,_scaleRanges:o}=n,s={xmin:e.min,xmax:e.max,ymin:a.min,ymax:a.max};if(!o)return n._scaleRanges=s,!0;const c=o.xmin!==e.min||o.xmax!==e.max||o.ymin!==a.min||o.ymax!==a.max;return Object.assign(o,s),c}const rA=n=>n===0||n===1,xG=(n,e,a)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*lr/a)),wG=(n,e,a)=>Math.pow(2,-10*n)*Math.sin((n-e)*lr/a)+1,ix={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*so)+1,easeOutSine:n=>Math.sin(n*so),easeInOutSine:n=>-.5*(Math.cos(cr*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>rA(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>rA(n)?n:xG(n,.075,.3),easeOutElastic:n=>rA(n)?n:wG(n,.075,.3),easeInOutElastic(n){return rA(n)?n:n<.5?.5*xG(n*2,.1125,.45):.5+.5*wG(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-ix.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?ix.easeInBounce(n*2)*.5:ix.easeOutBounce(n*2-1)*.5+.5};function W6(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function SG(n){return W6(n)?n:new nw(n)}function oI(n){return W6(n)?n:new nw(n).saturate(.5).darken(.1).hexString()}const tMe=["x","y","borderWidth","radius","tension"],nMe=["color","borderColor","backgroundColor"];function aMe(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:nMe},numbers:{type:"number",properties:tMe}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function iMe(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const AG=new Map;function rMe(n,e){e=e||{};const a=n+JSON.stringify(e);let o=AG.get(a);return o||(o=new Intl.NumberFormat(n,e),AG.set(a,o)),o}function Uw(n,e,a){return rMe(e,a).format(n)}const QK={values(n){return or(n)?n:""+n},numeric(n,e,a){if(n===0)return"0";const o=this.chart.options.locale;let s,c=n;if(a.length>1){const y=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(y<1e-4||y>1e15)&&(s="scientific"),c=oMe(n,a)}const d=Yf(Math.abs(c)),f=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),m={notation:s,minimumFractionDigits:f,maximumFractionDigits:f};return Object.assign(m,this.options.ticks.format),Uw(n,o,m)},logarithmic(n,e,a){if(n===0)return"0";const o=a[e].significand||n/Math.pow(10,Math.floor(Yf(n)));return[1,2,3,5,10,15].includes(o)||e>.8*a.length?QK.numeric.call(this,n,e,a):""}};function oMe(n,e){let a=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(a)>=1&&n!==Math.floor(n)&&(a=n-Math.floor(n)),a}var JT={formatters:QK};function sMe(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,a)=>a.lineWidth,tickColor:(e,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:JT.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const zg=Object.create(null),zR=Object.create(null);function rx(n,e){if(!e)return n;const a=e.split(".");for(let o=0,s=a.length;o<s;++o){const c=a[o];n=n[c]||(n[c]=Object.create(null))}return n}function sI(n,e,a){return typeof e=="string"?aw(rx(n,e),a):aw(rx(n,""),e)}class lMe{constructor(e,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>oI(s.backgroundColor),this.hoverBorderColor=(o,s)=>oI(s.borderColor),this.hoverColor=(o,s)=>oI(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(a)}set(e,a){return sI(this,e,a)}get(e){return rx(this,e)}describe(e,a){return sI(zR,e,a)}override(e,a){return sI(zg,e,a)}route(e,a,o,s){const c=rx(this,e),d=rx(this,o),f="_"+a;Object.defineProperties(c,{[f]:{value:c[a],writable:!0},[a]:{enumerable:!0,get(){const m=this[f],y=d[s];return Ka(m)?Object.assign({},y,m):za(m,y)},set(m){this[f]=m}}})}apply(e){e.forEach(a=>a(this))}}var qr=new lMe({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[aMe,iMe,sMe]);function cMe(n){return!n||li(n.size)||li(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function aM(n,e,a,o,s){let c=e[s];return c||(c=e[s]=n.measureText(s).width,a.push(s)),c>o&&(o=c),o}function uMe(n,e,a,o){o=o||{};let s=o.data=o.data||{},c=o.garbageCollect=o.garbageCollect||[];o.font!==e&&(s=o.data={},c=o.garbageCollect=[],o.font=e),n.save(),n.font=e;let d=0;const f=a.length;let m,y,_,w,A;for(m=0;m<f;m++)if(w=a[m],w!=null&&!or(w))d=aM(n,s,c,d,w);else if(or(w))for(y=0,_=w.length;y<_;y++)A=w[y],A!=null&&!or(A)&&(d=aM(n,s,c,d,A));n.restore();const C=c.length/2;if(C>a.length){for(m=0;m<C;m++)delete s[c[m]];c.splice(0,C)}return d}function Vm(n,e,a){const o=n.currentDevicePixelRatio,s=a!==0?Math.max(a/2,.5):0;return Math.round((e-s)*o)/o+s}function EG(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function FR(n,e,a,o){eJ(n,e,a,o,null)}function eJ(n,e,a,o,s){let c,d,f,m,y,_,w,A;const C=e.pointStyle,I=e.rotation,k=e.radius;let D=(I||0)*jEe;if(C&&typeof C=="object"&&(c=C.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){n.save(),n.translate(a,o),n.rotate(D),n.drawImage(C,-C.width/2,-C.height/2,C.width,C.height),n.restore();return}if(!(isNaN(k)||k<=0)){switch(n.beginPath(),C){default:s?n.ellipse(a,o,s/2,k,0,0,lr):n.arc(a,o,k,0,lr),n.closePath();break;case"triangle":_=s?s/2:k,n.moveTo(a+Math.sin(D)*_,o-Math.cos(D)*k),D+=yG,n.lineTo(a+Math.sin(D)*_,o-Math.cos(D)*k),D+=yG,n.lineTo(a+Math.sin(D)*_,o-Math.cos(D)*k),n.closePath();break;case"rectRounded":y=k*.516,m=k-y,d=Math.cos(D+Wm)*m,w=Math.cos(D+Wm)*(s?s/2-y:m),f=Math.sin(D+Wm)*m,A=Math.sin(D+Wm)*(s?s/2-y:m),n.arc(a-w,o-f,y,D-cr,D-so),n.arc(a+A,o-d,y,D-so,D),n.arc(a+w,o+f,y,D,D+so),n.arc(a-A,o+d,y,D+so,D+cr),n.closePath();break;case"rect":if(!I){m=Math.SQRT1_2*k,_=s?s/2:m,n.rect(a-_,o-m,2*_,2*m);break}D+=Wm;case"rectRot":w=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,A=Math.sin(D)*(s?s/2:k),n.moveTo(a-w,o-f),n.lineTo(a+A,o-d),n.lineTo(a+w,o+f),n.lineTo(a-A,o+d),n.closePath();break;case"crossRot":D+=Wm;case"cross":w=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,A=Math.sin(D)*(s?s/2:k),n.moveTo(a-w,o-f),n.lineTo(a+w,o+f),n.moveTo(a+A,o-d),n.lineTo(a-A,o+d);break;case"star":w=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,A=Math.sin(D)*(s?s/2:k),n.moveTo(a-w,o-f),n.lineTo(a+w,o+f),n.moveTo(a+A,o-d),n.lineTo(a-A,o+d),D+=Wm,w=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,A=Math.sin(D)*(s?s/2:k),n.moveTo(a-w,o-f),n.lineTo(a+w,o+f),n.moveTo(a+A,o-d),n.lineTo(a-A,o+d);break;case"line":d=s?s/2:Math.cos(D)*k,f=Math.sin(D)*k,n.moveTo(a-d,o-f),n.lineTo(a+d,o+f);break;case"dash":n.moveTo(a,o),n.lineTo(a+Math.cos(D)*(s?s/2:k),o+Math.sin(D)*k);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Th(n,e,a){return a=a||.5,!e||n&&n.x>e.left-a&&n.x<e.right+a&&n.y>e.top-a&&n.y<e.bottom+a}function QT(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function eC(n){n.restore()}function dMe(n,e,a,o,s){if(!e)return n.lineTo(a.x,a.y);if(s==="middle"){const c=(e.x+a.x)/2;n.lineTo(c,e.y),n.lineTo(c,a.y)}else s==="after"!=!!o?n.lineTo(e.x,a.y):n.lineTo(a.x,e.y);n.lineTo(a.x,a.y)}function hMe(n,e,a,o){if(!e)return n.lineTo(a.x,a.y);n.bezierCurveTo(o?e.cp1x:e.cp2x,o?e.cp1y:e.cp2y,o?a.cp2x:a.cp1x,o?a.cp2y:a.cp1y,a.x,a.y)}function fMe(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),li(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function pMe(n,e,a,o,s){if(s.strikethrough||s.underline){const c=n.measureText(o),d=e-c.actualBoundingBoxLeft,f=e+c.actualBoundingBoxRight,m=a-c.actualBoundingBoxAscent,y=a+c.actualBoundingBoxDescent,_=s.strikethrough?(m+y)/2:y;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(d,_),n.lineTo(f,_),n.stroke()}}function mMe(n,e){const a=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=a}function Fg(n,e,a,o,s,c={}){const d=or(e)?e:[e],f=c.strokeWidth>0&&c.strokeColor!=="";let m,y;for(n.save(),n.font=s.string,fMe(n,c),m=0;m<d.length;++m)y=d[m],c.backdrop&&mMe(n,c.backdrop),f&&(c.strokeColor&&(n.strokeStyle=c.strokeColor),li(c.strokeWidth)||(n.lineWidth=c.strokeWidth),n.strokeText(y,a,o,c.maxWidth)),n.fillText(y,a,o,c.maxWidth),pMe(n,a,o,y,c),o+=Number(s.lineHeight);n.restore()}function ow(n,e){const{x:a,y:o,w:s,h:c,radius:d}=e;n.arc(a+d.topLeft,o+d.topLeft,d.topLeft,1.5*cr,cr,!0),n.lineTo(a,o+c-d.bottomLeft),n.arc(a+d.bottomLeft,o+c-d.bottomLeft,d.bottomLeft,cr,so,!0),n.lineTo(a+s-d.bottomRight,o+c),n.arc(a+s-d.bottomRight,o+c-d.bottomRight,d.bottomRight,so,0,!0),n.lineTo(a+s,o+d.topRight),n.arc(a+s-d.topRight,o+d.topRight,d.topRight,0,-so,!0),n.lineTo(a+d.topLeft,o)}const gMe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,yMe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function vMe(n,e){const a=(""+n).match(gMe);if(!a||a[1]==="normal")return e*1.2;switch(n=+a[2],a[3]){case"px":return n;case"%":n/=100;break}return e*n}const _Me=n=>+n||0;function V6(n,e){const a={},o=Ka(e),s=o?Object.keys(e):e,c=Ka(n)?o?d=>za(n[d],n[e[d]]):d=>n[d]:()=>n;for(const d of s)a[d]=_Me(c(d));return a}function tJ(n){return V6(n,{top:"y",right:"x",bottom:"y",left:"x"})}function wg(n){return V6(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ws(n){const e=tJ(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Po(n,e){n=n||{},e=e||qr.font;let a=za(n.size,e.size);typeof a=="string"&&(a=parseInt(a,10));let o=za(n.style,e.style);o&&!(""+o).match(yMe)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:za(n.family,e.family),lineHeight:vMe(za(n.lineHeight,e.lineHeight),a),size:a,style:o,weight:za(n.weight,e.weight),string:""};return s.string=cMe(s),s}function Mb(n,e,a,o){let s=!0,c,d,f;for(c=0,d=n.length;c<d;++c)if(f=n[c],f!==void 0&&(e!==void 0&&typeof f=="function"&&(f=f(e),s=!1),a!==void 0&&or(f)&&(f=f[a%f.length],s=!1),f!==void 0))return o&&!s&&(o.cacheable=!1),f}function bMe(n,e,a){const{min:o,max:s}=n,c=GK(e,(s-o)/2),d=(f,m)=>a&&f===0?0:f+m;return{min:d(o,-Math.abs(c)),max:d(s,c)}}function Pp(n,e){return Object.assign(Object.create(n),e)}function G6(n,e=[""],a,o,s=()=>n[0]){const c=a||n;typeof o>"u"&&(o=rJ("_fallback",n));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:c,_fallback:o,_getTarget:s,override:f=>G6([f,...n],e,c,o)};return new Proxy(d,{deleteProperty(f,m){return delete f[m],delete f._keys,delete n[0][m],!0},get(f,m){return aJ(f,m,()=>CMe(m,e,n,f))},getOwnPropertyDescriptor(f,m){return Reflect.getOwnPropertyDescriptor(f._scopes[0],m)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(f,m){return TG(f).includes(m)},ownKeys(f){return TG(f)},set(f,m,y){const _=f._storage||(f._storage=s());return f[m]=_[m]=y,delete f._keys,!0}})}function a_(n,e,a,o){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:a,_stack:new Set,_descriptors:nJ(n,o),setContext:c=>a_(n,c,a,o),override:c=>a_(n.override(c),e,a,o)};return new Proxy(s,{deleteProperty(c,d){return delete c[d],delete n[d],!0},get(c,d,f){return aJ(c,d,()=>wMe(c,d,f))},getOwnPropertyDescriptor(c,d){return c._descriptors.allKeys?Reflect.has(n,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,d)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(c,d){return Reflect.has(n,d)},ownKeys(){return Reflect.ownKeys(n)},set(c,d,f){return n[d]=f,delete c[d],!0}})}function nJ(n,e={scriptable:!0,indexable:!0}){const{_scriptable:a=e.scriptable,_indexable:o=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:a,indexable:o,isScriptable:xp(a)?a:()=>a,isIndexable:xp(o)?o:()=>o}}const xMe=(n,e)=>n?n+F6(e):e,H6=(n,e)=>Ka(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function aJ(n,e,a){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const o=a();return n[e]=o,o}function wMe(n,e,a){const{_proxy:o,_context:s,_subProxy:c,_descriptors:d}=n;let f=o[e];return xp(f)&&d.isScriptable(e)&&(f=SMe(e,f,n,a)),or(f)&&f.length&&(f=AMe(e,f,n,d.isIndexable)),H6(e,f)&&(f=a_(f,s,c&&c[e],d)),f}function SMe(n,e,a,o){const{_proxy:s,_context:c,_subProxy:d,_stack:f}=a;if(f.has(n))throw new Error("Recursion detected: "+Array.from(f).join("->")+"->"+n);f.add(n);let m=e(c,d||o);return f.delete(n),H6(n,m)&&(m=j6(s._scopes,s,n,m)),m}function AMe(n,e,a,o){const{_proxy:s,_context:c,_subProxy:d,_descriptors:f}=a;if(typeof c.index<"u"&&o(n))return e[c.index%e.length];if(Ka(e[0])){const m=e,y=s._scopes.filter(_=>_!==m);e=[];for(const _ of m){const w=j6(y,s,n,_);e.push(a_(w,c,d&&d[n],f))}}return e}function iJ(n,e,a){return xp(n)?n(e,a):n}const EMe=(n,e)=>n===!0?e:typeof n=="string"?bp(e,n):void 0;function MMe(n,e,a,o,s){for(const c of e){const d=EMe(a,c);if(d){n.add(d);const f=iJ(d._fallback,a,s);if(typeof f<"u"&&f!==a&&f!==o)return f}else if(d===!1&&typeof o<"u"&&a!==o)return null}return!1}function j6(n,e,a,o){const s=e._rootScopes,c=iJ(e._fallback,a,o),d=[...n,...s],f=new Set;f.add(o);let m=MG(f,d,a,c||a,o);return m===null||typeof c<"u"&&c!==a&&(m=MG(f,d,c,m,o),m===null)?!1:G6(Array.from(f),[""],s,c,()=>TMe(e,a,o))}function MG(n,e,a,o,s){for(;a;)a=MMe(n,e,a,o,s);return a}function TMe(n,e,a){const o=n._getTarget();e in o||(o[e]={});const s=o[e];return or(s)&&Ka(a)?a:s||{}}function CMe(n,e,a,o){let s;for(const c of e)if(s=rJ(xMe(c,n),a),typeof s<"u")return H6(n,s)?j6(a,o,n,s):s}function rJ(n,e){for(const a of e){if(!a)continue;const o=a[n];if(typeof o<"u")return o}}function TG(n){let e=n._keys;return e||(e=n._keys=PMe(n._scopes)),e}function PMe(n){const e=new Set;for(const a of n)for(const o of Object.keys(a).filter(s=>!s.startsWith("_")))e.add(o);return Array.from(e)}function oJ(n,e,a,o){const{iScale:s}=n,{key:c="r"}=this._parsing,d=new Array(o);let f,m,y,_;for(f=0,m=o;f<m;++f)y=f+a,_=e[y],d[f]={r:s.parse(bp(_,c),y)};return d}const IMe=Number.EPSILON||1e-14,i_=(n,e)=>e<n.length&&!n[e].skip&&n[e],sJ=n=>n==="x"?"y":"x";function LMe(n,e,a,o){const s=n.skip?e:n,c=e,d=a.skip?e:a,f=OR(c,s),m=OR(d,c);let y=f/(f+m),_=m/(f+m);y=isNaN(y)?0:y,_=isNaN(_)?0:_;const w=o*y,A=o*_;return{previous:{x:c.x-w*(d.x-s.x),y:c.y-w*(d.y-s.y)},next:{x:c.x+A*(d.x-s.x),y:c.y+A*(d.y-s.y)}}}function RMe(n,e,a){const o=n.length;let s,c,d,f,m,y=i_(n,0);for(let _=0;_<o-1;++_)if(m=y,y=i_(n,_+1),!(!m||!y)){if(ax(e[_],0,IMe)){a[_]=a[_+1]=0;continue}s=a[_]/e[_],c=a[_+1]/e[_],f=Math.pow(s,2)+Math.pow(c,2),!(f<=9)&&(d=3/Math.sqrt(f),a[_]=s*d*e[_],a[_+1]=c*d*e[_])}}function kMe(n,e,a="x"){const o=sJ(a),s=n.length;let c,d,f,m=i_(n,0);for(let y=0;y<s;++y){if(d=f,f=m,m=i_(n,y+1),!f)continue;const _=f[a],w=f[o];d&&(c=(_-d[a])/3,f[`cp1${a}`]=_-c,f[`cp1${o}`]=w-c*e[y]),m&&(c=(m[a]-_)/3,f[`cp2${a}`]=_+c,f[`cp2${o}`]=w+c*e[y])}}function DMe(n,e="x"){const a=sJ(e),o=n.length,s=Array(o).fill(0),c=Array(o);let d,f,m,y=i_(n,0);for(d=0;d<o;++d)if(f=m,m=y,y=i_(n,d+1),!!m){if(y){const _=y[e]-m[e];s[d]=_!==0?(y[a]-m[a])/_:0}c[d]=f?y?pd(s[d-1])!==pd(s[d])?0:(s[d-1]+s[d])/2:s[d-1]:s[d]}RMe(n,s,c),kMe(n,c,e)}function oA(n,e,a){return Math.max(Math.min(n,a),e)}function OMe(n,e){let a,o,s,c,d,f=Th(n[0],e);for(a=0,o=n.length;a<o;++a)d=c,c=f,f=a<o-1&&Th(n[a+1],e),c&&(s=n[a],d&&(s.cp1x=oA(s.cp1x,e.left,e.right),s.cp1y=oA(s.cp1y,e.top,e.bottom)),f&&(s.cp2x=oA(s.cp2x,e.left,e.right),s.cp2y=oA(s.cp2y,e.top,e.bottom)))}function zMe(n,e,a,o,s){let c,d,f,m;if(e.spanGaps&&(n=n.filter(y=>!y.skip)),e.cubicInterpolationMode==="monotone")DMe(n,s);else{let y=o?n[n.length-1]:n[0];for(c=0,d=n.length;c<d;++c)f=n[c],m=LMe(y,f,n[Math.min(c+1,d-(o?0:1))%d],e.tension),f.cp1x=m.previous.x,f.cp1y=m.previous.y,f.cp2x=m.next.x,f.cp2y=m.next.y,y=f}e.capBezierPoints&&OMe(n,a)}function lJ(){return typeof window<"u"&&typeof document<"u"}function $6(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function iM(n,e,a){let o;return typeof n=="string"?(o=parseInt(n,10),n.indexOf("%")!==-1&&(o=o/100*e.parentNode[a])):o=n,o}const tC=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function FMe(n,e){return tC(n).getPropertyValue(e)}const NMe=["top","right","bottom","left"];function Sg(n,e,a){const o={};a=a?"-"+a:"";for(let s=0;s<4;s++){const c=NMe[s];o[c]=parseFloat(n[e+"-"+c+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const BMe=(n,e,a)=>(n>0||e>0)&&(!a||!a.shadowRoot);function UMe(n,e){const a=n.touches,o=a&&a.length?a[0]:n,{offsetX:s,offsetY:c}=o;let d=!1,f,m;if(BMe(s,c,n.target))f=s,m=c;else{const y=e.getBoundingClientRect();f=o.clientX-y.left,m=o.clientY-y.top,d=!0}return{x:f,y:m,box:d}}function eg(n,e){if("native"in n)return n;const{canvas:a,currentDevicePixelRatio:o}=e,s=tC(a),c=s.boxSizing==="border-box",d=Sg(s,"padding"),f=Sg(s,"border","width"),{x:m,y,box:_}=UMe(n,a),w=d.left+(_&&f.left),A=d.top+(_&&f.top);let{width:C,height:I}=e;return c&&(C-=d.width+f.width,I-=d.height+f.height),{x:Math.round((m-w)/C*a.width/o),y:Math.round((y-A)/I*a.height/o)}}function WMe(n,e,a){let o,s;if(e===void 0||a===void 0){const c=$6(n);if(!c)e=n.clientWidth,a=n.clientHeight;else{const d=c.getBoundingClientRect(),f=tC(c),m=Sg(f,"border","width"),y=Sg(f,"padding");e=d.width-y.width-m.width,a=d.height-y.height-m.height,o=iM(f.maxWidth,c,"clientWidth"),s=iM(f.maxHeight,c,"clientHeight")}}return{width:e,height:a,maxWidth:o||nM,maxHeight:s||nM}}const sA=n=>Math.round(n*10)/10;function VMe(n,e,a,o){const s=tC(n),c=Sg(s,"margin"),d=iM(s.maxWidth,n,"clientWidth")||nM,f=iM(s.maxHeight,n,"clientHeight")||nM,m=WMe(n,e,a);let{width:y,height:_}=m;if(s.boxSizing==="content-box"){const A=Sg(s,"border","width"),C=Sg(s,"padding");y-=C.width+A.width,_-=C.height+A.height}return y=Math.max(0,y-c.width),_=Math.max(0,o?y/o:_-c.height),y=sA(Math.min(y,d,m.maxWidth)),_=sA(Math.min(_,f,m.maxHeight)),y&&!_&&(_=sA(y/2)),(e!==void 0||a!==void 0)&&o&&m.height&&_>m.height&&(_=m.height,y=sA(Math.floor(_*o))),{width:y,height:_}}function CG(n,e,a){const o=e||1,s=Math.floor(n.height*o),c=Math.floor(n.width*o);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const d=n.canvas;return d.style&&(a||!d.style.height&&!d.style.width)&&(d.style.height=`${n.height}px`,d.style.width=`${n.width}px`),n.currentDevicePixelRatio!==o||d.height!==s||d.width!==c?(n.currentDevicePixelRatio=o,d.height=s,d.width=c,n.ctx.setTransform(o,0,0,o,0,0),!0):!1}const GMe=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function PG(n,e){const a=FMe(n,e),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function tg(n,e,a,o){return{x:n.x+a*(e.x-n.x),y:n.y+a*(e.y-n.y)}}function HMe(n,e,a,o){return{x:n.x+a*(e.x-n.x),y:o==="middle"?a<.5?n.y:e.y:o==="after"?a<1?n.y:e.y:a>0?e.y:n.y}}function jMe(n,e,a,o){const s={x:n.cp2x,y:n.cp2y},c={x:e.cp1x,y:e.cp1y},d=tg(n,s,a),f=tg(s,c,a),m=tg(c,e,a),y=tg(d,f,a),_=tg(f,m,a);return tg(y,_,a)}const $Me=function(n,e){return{x(a){return n+n+e-a},setWidth(a){e=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},qMe=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function O0(n,e,a){return n?$Me(e,a):qMe()}function cJ(n,e){let a,o;(e==="ltr"||e==="rtl")&&(a=n.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",e,"important"),n.prevTextDirection=o)}function uJ(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function dJ(n){return n==="angle"?{between:rw,compare:XEe,normalize:Nl}:{between:Eh,compare:(e,a)=>e-a,normalize:e=>e}}function IG({start:n,end:e,count:a,loop:o,style:s}){return{start:n%a,end:e%a,loop:o&&(e-n+1)%a===0,style:s}}function XMe(n,e,a){const{property:o,start:s,end:c}=a,{between:d,normalize:f}=dJ(o),m=e.length;let{start:y,end:_,loop:w}=n,A,C;if(w){for(y+=m,_+=m,A=0,C=m;A<C&&d(f(e[y%m][o]),s,c);++A)y--,_--;y%=m,_%=m}return _<y&&(_+=m),{start:y,end:_,loop:w,style:n.style}}function hJ(n,e,a){if(!a)return[n];const{property:o,start:s,end:c}=a,d=e.length,{compare:f,between:m,normalize:y}=dJ(o),{start:_,end:w,loop:A,style:C}=XMe(n,e,a),I=[];let k=!1,D=null,L,O,F;const B=()=>m(s,F,L)&&f(s,F)!==0,G=()=>f(c,L)===0||m(c,F,L),q=()=>k||B(),X=()=>!k||G();for(let ee=_,V=_;ee<=w;++ee)O=e[ee%d],!O.skip&&(L=y(O[o]),L!==F&&(k=m(L,s,c),D===null&&q()&&(D=f(L,s)===0?ee:V),D!==null&&X()&&(I.push(IG({start:D,end:ee,loop:A,count:d,style:C})),D=null),V=ee,F=L));return D!==null&&I.push(IG({start:D,end:w,loop:A,count:d,style:C})),I}function fJ(n,e){const a=[],o=n.segments;for(let s=0;s<o.length;s++){const c=hJ(o[s],n.points,e);c.length&&a.push(...c)}return a}function ZMe(n,e,a,o){let s=0,c=e-1;if(a&&!o)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,a&&(c+=s);c>s&&n[c%e].skip;)c--;return c%=e,{start:s,end:c}}function YMe(n,e,a,o){const s=n.length,c=[];let d=e,f=n[e],m;for(m=e+1;m<=a;++m){const y=n[m%s];y.skip||y.stop?f.skip||(o=!1,c.push({start:e%s,end:(m-1)%s,loop:o}),e=d=y.stop?m:null):(d=m,f.skip&&(e=m)),f=y}return d!==null&&c.push({start:e%s,end:d%s,loop:o}),c}function KMe(n,e){const a=n.points,o=n.options.spanGaps,s=a.length;if(!s)return[];const c=!!n._loop,{start:d,end:f}=ZMe(a,s,c,o);if(o===!0)return LG(n,[{start:d,end:f,loop:c}],a,e);const m=f<d?f+s:f,y=!!n._fullLoop&&d===0&&f===s-1;return LG(n,YMe(a,d,m,y),a,e)}function LG(n,e,a,o){return!o||!o.setContext||!a?e:JMe(n,e,a,o)}function JMe(n,e,a,o){const s=n._chart.getContext(),c=RG(n.options),{_datasetIndex:d,options:{spanGaps:f}}=n,m=a.length,y=[];let _=c,w=e[0].start,A=w;function C(I,k,D,L){const O=f?-1:1;if(I!==k){for(I+=m;a[I%m].skip;)I-=O;for(;a[k%m].skip;)k+=O;I%m!==k%m&&(y.push({start:I%m,end:k%m,loop:D,style:L}),_=L,w=k%m)}}for(const I of e){w=f?w:I.start;let k=a[w%m],D;for(A=w+1;A<=I.end;A++){const L=a[A%m];D=RG(o.setContext(Pp(s,{type:"segment",p0:k,p1:L,p0DataIndex:(A-1)%m,p1DataIndex:A%m,datasetIndex:d}))),QMe(D,_)&&C(w,A-1,I.loop,_),k=L,_=D}w<A-1&&C(w,A-1,I.loop,_)}return y}function RG(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function QMe(n,e){if(!e)return!1;const a=[],o=function(s,c){return W6(c)?(a.includes(c)||a.push(c),a.indexOf(c)):c};return JSON.stringify(n,o)!==JSON.stringify(e,o)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class eTe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,a,o,s){const c=a.listeners[s],d=a.duration;c.forEach(f=>f({chart:e,initial:a.initial,numSteps:d,currentStep:Math.min(o-a.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=ZK.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let a=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const c=o.items;let d=c.length-1,f=!1,m;for(;d>=0;--d)m=c[d],m._active?(m._total>o.duration&&(o.duration=m._total),m.tick(e),f=!0):(c[d]=c[c.length-1],c.pop());f&&(s.draw(),this._notify(s,o,e,"progress")),c.length||(o.running=!1,this._notify(s,o,e,"complete"),o.initial=!1),a+=c.length}),this._lastDate=e,a===0&&(this._running=!1)}_getAnims(e){const a=this._charts;let o=a.get(e);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(e,o)),o}listen(e,a,o){this._getAnims(e).listeners[a].push(o)}add(e,a){!a||!a.length||this._getAnims(e).items.push(...a)}has(e){return this._getAnims(e).items.length>0}start(e){const a=this._charts.get(e);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const a=this._charts.get(e);return!(!a||!a.running||!a.items.length)}stop(e){const a=this._charts.get(e);if(!a||!a.items.length)return;const o=a.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();a.items=[],this._notify(e,a,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var hh=new eTe;const kG="transparent",tTe={boolean(n,e,a){return a>.5?e:n},color(n,e,a){const o=SG(n||kG),s=o.valid&&SG(e||kG);return s&&s.valid?s.mix(o,a).hexString():e},number(n,e,a){return n+(e-n)*a}};class nTe{constructor(e,a,o,s){const c=a[o];s=Mb([e.to,s,c,e.from]);const d=Mb([e.from,c,s]);this._active=!0,this._fn=e.fn||tTe[e.type||typeof d],this._easing=ix[e.easing]||ix.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=a,this._prop=o,this._from=d,this._to=s,this._promises=void 0}active(){return this._active}update(e,a,o){if(this._active){this._notify(!1);const s=this._target[this._prop],c=o-this._start,d=this._duration-c;this._start=o,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=c,this._loop=!!e.loop,this._to=Mb([e.to,a,s,e.from]),this._from=Mb([e.from,s,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const a=e-this._start,o=this._duration,s=this._prop,c=this._from,d=this._loop,f=this._to;let m;if(this._active=c!==f&&(d||a<o),!this._active){this._target[s]=f,this._notify(!0);return}if(a<0){this._target[s]=c;return}m=a/o%2,m=d&&m>1?2-m:m,m=this._easing(Math.min(1,Math.max(0,m))),this._target[s]=this._fn(c,f,m)}wait(){const e=this._promises||(this._promises=[]);return new Promise((a,o)=>{e.push({res:a,rej:o})})}_notify(e){const a=e?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][a]()}}class pJ{constructor(e,a){this._chart=e,this._properties=new Map,this.configure(a)}configure(e){if(!Ka(e))return;const a=Object.keys(qr.animation),o=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const c=e[s];if(!Ka(c))return;const d={};for(const f of a)d[f]=c[f];(or(c.properties)&&c.properties||[s]).forEach(f=>{(f===s||!o.has(f))&&o.set(f,d)})})}_animateOptions(e,a){const o=a.options,s=iTe(e,o);if(!s)return[];const c=this._createAnimations(s,o);return o.$shared&&aTe(e.options.$animations,o).then(()=>{e.options=o},()=>{}),c}_createAnimations(e,a){const o=this._properties,s=[],c=e.$animations||(e.$animations={}),d=Object.keys(a),f=Date.now();let m;for(m=d.length-1;m>=0;--m){const y=d[m];if(y.charAt(0)==="$")continue;if(y==="options"){s.push(...this._animateOptions(e,a));continue}const _=a[y];let w=c[y];const A=o.get(y);if(w)if(A&&w.active()){w.update(A,_,f);continue}else w.cancel();if(!A||!A.duration){e[y]=_;continue}c[y]=w=new nTe(A,e,y,_),s.push(w)}return s}update(e,a){if(this._properties.size===0){Object.assign(e,a);return}const o=this._createAnimations(e,a);if(o.length)return hh.add(this._chart,o),!0}}function aTe(n,e){const a=[],o=Object.keys(e);for(let s=0;s<o.length;s++){const c=n[o[s]];c&&c.active()&&a.push(c.wait())}return Promise.all(a)}function iTe(n,e){if(!e)return;let a=n.options;if(!a){n.options=e;return}return a.$shared&&(n.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function DG(n,e){const a=n&&n.options||{},o=a.reverse,s=a.min===void 0?e:0,c=a.max===void 0?e:0;return{start:o?c:s,end:o?s:c}}function rTe(n,e,a){if(a===!1)return!1;const o=DG(n,a),s=DG(e,a);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function oTe(n){let e,a,o,s;return Ka(n)?(e=n.top,a=n.right,o=n.bottom,s=n.left):e=a=o=s=n,{top:e,right:a,bottom:o,left:s,disabled:n===!1}}function mJ(n,e){const a=[],o=n._getSortedDatasetMetas(e);let s,c;for(s=0,c=o.length;s<c;++s)a.push(o[s].index);return a}function OG(n,e,a,o={}){const s=n.keys,c=o.mode==="single";let d,f,m,y;if(e!==null){for(d=0,f=s.length;d<f;++d){if(m=+s[d],m===a){if(o.all)continue;break}y=n.values[m],$r(y)&&(c||e===0||pd(e)===pd(y))&&(e+=y)}return e}}function sTe(n){const e=Object.keys(n),a=new Array(e.length);let o,s,c;for(o=0,s=e.length;o<s;++o)c=e[o],a[o]={x:c,y:n[c]};return a}function zG(n,e){const a=n&&n.options.stacked;return a||a===void 0&&e.stack!==void 0}function lTe(n,e,a){return`${n.id}.${e.id}.${a.stack||a.type}`}function cTe(n){const{min:e,max:a,minDefined:o,maxDefined:s}=n.getUserBounds();return{min:o?e:Number.NEGATIVE_INFINITY,max:s?a:Number.POSITIVE_INFINITY}}function uTe(n,e,a){const o=n[e]||(n[e]={});return o[a]||(o[a]={})}function FG(n,e,a,o){for(const s of e.getMatchingVisibleMetas(o).reverse()){const c=n[s.index];if(a&&c>0||!a&&c<0)return s.index}return null}function NG(n,e){const{chart:a,_cachedMeta:o}=n,s=a._stacks||(a._stacks={}),{iScale:c,vScale:d,index:f}=o,m=c.axis,y=d.axis,_=lTe(c,d,o),w=e.length;let A;for(let C=0;C<w;++C){const I=e[C],{[m]:k,[y]:D}=I,L=I._stacks||(I._stacks={});A=L[y]=uTe(s,_,k),A[f]=D,A._top=FG(A,d,!0,o.type),A._bottom=FG(A,d,!1,o.type);const O=A._visualValues||(A._visualValues={});O[f]=D}}function lI(n,e){const a=n.scales;return Object.keys(a).filter(o=>a[o].axis===e).shift()}function dTe(n,e){return Pp(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function hTe(n,e,a){return Pp(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:a,index:e,mode:"default",type:"data"})}function cb(n,e){const a=n.controller.index,o=n.vScale&&n.vScale.axis;if(o){e=e||n._parsed;for(const s of e){const c=s._stacks;if(!c||c[o]===void 0||c[o][a]===void 0)return;delete c[o][a],c[o]._visualValues!==void 0&&c[o]._visualValues[a]!==void 0&&delete c[o]._visualValues[a]}}}const cI=n=>n==="reset"||n==="none",BG=(n,e)=>e?n:Object.assign({},n),fTe=(n,e,a)=>n&&!e.hidden&&e._stacked&&{keys:mJ(a,!0),values:null};class cu{constructor(e,a){this.chart=e,this._ctx=e.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=zG(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&cb(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,a=this._cachedMeta,o=this.getDataset(),s=(w,A,C,I)=>w==="x"?A:w==="r"?I:C,c=a.xAxisID=za(o.xAxisID,lI(e,"x")),d=a.yAxisID=za(o.yAxisID,lI(e,"y")),f=a.rAxisID=za(o.rAxisID,lI(e,"r")),m=a.indexAxis,y=a.iAxisID=s(m,c,d,f),_=a.vAxisID=s(m,d,c,f);a.xScale=this.getScaleForId(c),a.yScale=this.getScaleForId(d),a.rScale=this.getScaleForId(f),a.iScale=this.getScaleForId(y),a.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const a=this._cachedMeta;return e===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&bG(this._data,this),e._stacked&&cb(e)}_dataCheck(){const e=this.getDataset(),a=e.data||(e.data=[]),o=this._data;if(Ka(a))this._data=sTe(a);else if(o!==a){if(o){bG(o,this);const s=this._cachedMeta;cb(s),s._parsed=[]}a&&Object.isExtensible(a)&&JEe(a,this),this._syncList=[],this._data=a}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const a=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const c=a._stacked;a._stacked=zG(a.vScale,a),a.stack!==o.stack&&(s=!0,cb(a),a.stack=o.stack),this._resyncElements(e),(s||c!==a._stacked)&&NG(this,a._parsed)}configure(){const e=this.chart.config,a=e.datasetScopeKeys(this._type),o=e.getOptionScopes(this.getDataset(),a,!0);this.options=e.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,a){const{_cachedMeta:o,_data:s}=this,{iScale:c,_stacked:d}=o,f=c.axis;let m=e===0&&a===s.length?!0:o._sorted,y=e>0&&o._parsed[e-1],_,w,A;if(this._parsing===!1)o._parsed=s,o._sorted=!0,A=s;else{or(s[e])?A=this.parseArrayData(o,s,e,a):Ka(s[e])?A=this.parseObjectData(o,s,e,a):A=this.parsePrimitiveData(o,s,e,a);const C=()=>w[f]===null||y&&w[f]<y[f];for(_=0;_<a;++_)o._parsed[_+e]=w=A[_],m&&(C()&&(m=!1),y=w);o._sorted=m}d&&NG(this,A)}parsePrimitiveData(e,a,o,s){const{iScale:c,vScale:d}=e,f=c.axis,m=d.axis,y=c.getLabels(),_=c===d,w=new Array(s);let A,C,I;for(A=0,C=s;A<C;++A)I=A+o,w[A]={[f]:_||c.parse(y[I],I),[m]:d.parse(a[I],I)};return w}parseArrayData(e,a,o,s){const{xScale:c,yScale:d}=e,f=new Array(s);let m,y,_,w;for(m=0,y=s;m<y;++m)_=m+o,w=a[_],f[m]={x:c.parse(w[0],_),y:d.parse(w[1],_)};return f}parseObjectData(e,a,o,s){const{xScale:c,yScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,y=new Array(s);let _,w,A,C;for(_=0,w=s;_<w;++_)A=_+o,C=a[A],y[_]={x:c.parse(bp(C,f),A),y:d.parse(bp(C,m),A)};return y}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,a,o){const s=this.chart,c=this._cachedMeta,d=a[e.axis],f={keys:mJ(s,!0),values:a._stacks[e.axis]._visualValues};return OG(f,d,c.index,{mode:o})}updateRangeFromParsed(e,a,o,s){const c=o[a.axis];let d=c===null?NaN:c;const f=s&&o._stacks[a.axis];s&&f&&(s.values=f,d=OG(s,c,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,a){const o=this._cachedMeta,s=o._parsed,c=o._sorted&&e===o.iScale,d=s.length,f=this._getOtherScale(e),m=fTe(a,o,this.chart),y={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:w}=cTe(f);let A,C;function I(){C=s[A];const k=C[f.axis];return!$r(C[e.axis])||_>k||w<k}for(A=0;A<d&&!(!I()&&(this.updateRangeFromParsed(y,e,C,m),c));++A);if(c){for(A=d-1;A>=0;--A)if(!I()){this.updateRangeFromParsed(y,e,C,m);break}}return y}getAllParsedValues(e){const a=this._cachedMeta._parsed,o=[];let s,c,d;for(s=0,c=a.length;s<c;++s)d=a[s][e.axis],$r(d)&&o.push(d);return o}getMaxOverflow(){return!1}getLabelAndValue(e){const a=this._cachedMeta,o=a.iScale,s=a.vScale,c=this.getParsed(e);return{label:o?""+o.getLabelForValue(c[o.axis]):"",value:s?""+s.getLabelForValue(c[s.axis]):""}}_update(e){const a=this._cachedMeta;this.update(e||"default"),a._clip=oTe(za(this.options.clip,rTe(a.xScale,a.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,a=this.chart,o=this._cachedMeta,s=o.data||[],c=a.chartArea,d=[],f=this._drawStart||0,m=this._drawCount||s.length-f,y=this.options.drawActiveElementsOnTop;let _;for(o.dataset&&o.dataset.draw(e,c,f,m),_=f;_<f+m;++_){const w=s[_];w.hidden||(w.active&&y?d.push(w):w.draw(e,c))}for(_=0;_<d.length;++_)d[_].draw(e,c)}getStyle(e,a){const o=a?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(e||0,o)}getContext(e,a,o){const s=this.getDataset();let c;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];c=d.$context||(d.$context=hTe(this.getContext(),e,d)),c.parsed=this.getParsed(e),c.raw=s.data[e],c.index=c.dataIndex=e}else c=this.$context||(this.$context=dTe(this.chart.getContext(),this.index)),c.dataset=s,c.index=c.datasetIndex=this.index;return c.active=!!a,c.mode=o,c}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,a){return this._resolveElementOptions(this.dataElementType.id,a,e)}_resolveElementOptions(e,a="default",o){const s=a==="active",c=this._cachedDataOpts,d=e+"-"+a,f=c[d],m=this.enableOptionSharing&&iw(o);if(f)return BG(f,m);const y=this.chart.config,_=y.datasetElementScopeKeys(this._type,e),w=s?[`${e}Hover`,"hover",e,""]:[e,""],A=y.getOptionScopes(this.getDataset(),_),C=Object.keys(qr.elements[e]),I=()=>this.getContext(o,s,a),k=y.resolveNamedOptions(A,C,I,w);return k.$shared&&(k.$shared=m,c[d]=Object.freeze(BG(k,m))),k}_resolveAnimations(e,a,o){const s=this.chart,c=this._cachedDataOpts,d=`animation-${a}`,f=c[d];if(f)return f;let m;if(s.options.animation!==!1){const _=this.chart.config,w=_.datasetAnimationScopeKeys(this._type,a),A=_.getOptionScopes(this.getDataset(),w);m=_.createResolver(A,this.getContext(e,o,a))}const y=new pJ(s,m&&m.animations);return m&&m._cacheable&&(c[d]=Object.freeze(y)),y}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,a){return!a||cI(e)||this.chart._animationsDisabled}_getSharedOptions(e,a){const o=this.resolveDataElementOptions(e,a),s=this._sharedOptions,c=this.getSharedOptions(o),d=this.includeOptions(a,c)||c!==s;return this.updateSharedOptions(c,a,o),{sharedOptions:c,includeOptions:d}}updateElement(e,a,o,s){cI(s)?Object.assign(e,o):this._resolveAnimations(a,s).update(e,o)}updateSharedOptions(e,a,o){e&&!cI(a)&&this._resolveAnimations(void 0,a).update(e,o)}_setStyle(e,a,o,s){e.active=s;const c=this.getStyle(a,s);this._resolveAnimations(a,o,s).update(e,{options:!s&&this.getSharedOptions(c)||c})}removeHoverStyle(e,a,o){this._setStyle(e,o,"active",!1)}setHoverStyle(e,a,o){this._setStyle(e,o,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const a=this._data,o=this._cachedMeta.data;for(const[f,m,y]of this._syncList)this[f](m,y);this._syncList=[];const s=o.length,c=a.length,d=Math.min(c,s);d&&this.parse(0,d),c>s?this._insertElements(s,c-s,e):c<s&&this._removeElements(c,s-c)}_insertElements(e,a,o=!0){const s=this._cachedMeta,c=s.data,d=e+a;let f;const m=y=>{for(y.length+=a,f=y.length-1;f>=d;f--)y[f]=y[f-a]};for(m(c),f=e;f<d;++f)c[f]=new this.dataElementType;this._parsing&&m(s._parsed),this.parse(e,a),o&&this.updateElements(c,e,a,"reset")}updateElements(e,a,o,s){}_removeElements(e,a){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(e,a);o._stacked&&cb(o,s)}o.data.splice(e,a)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[a,o,s]=e;this[a](o,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,a){a&&this._sync(["_removeElements",e,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",e,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}_n(cu,"defaults",{}),_n(cu,"datasetElementType",null),_n(cu,"dataElementType",null);function pTe(n,e){if(!n._cache.$bar){const a=n.getMatchingVisibleMetas(e);let o=[];for(let s=0,c=a.length;s<c;s++)o=o.concat(a[s].controller.getAllParsedValues(n));n._cache.$bar=XK(o.sort((s,c)=>s-c))}return n._cache.$bar}function mTe(n){const e=n.iScale,a=pTe(e,n.type);let o=e._length,s,c,d,f;const m=()=>{d===32767||d===-32768||(iw(f)&&(o=Math.min(o,Math.abs(d-f)||o)),f=d)};for(s=0,c=a.length;s<c;++s)d=e.getPixelForValue(a[s]),m();for(f=void 0,s=0,c=e.ticks.length;s<c;++s)d=e.getPixelForTick(s),m();return o}function gTe(n,e,a,o){const s=a.barThickness;let c,d;return li(s)?(c=e.min*a.categoryPercentage,d=a.barPercentage):(c=s*o,d=1),{chunk:c/o,ratio:d,start:e.pixels[n]-c/2}}function yTe(n,e,a,o){const s=e.pixels,c=s[n];let d=n>0?s[n-1]:null,f=n<s.length-1?s[n+1]:null;const m=a.categoryPercentage;d===null&&(d=c-(f===null?e.end-e.start:f-c)),f===null&&(f=c+c-d);const y=c-(c-Math.min(d,f))/2*m;return{chunk:Math.abs(f-d)/2*m/o,ratio:a.barPercentage,start:y}}function vTe(n,e,a,o){const s=a.parse(n[0],o),c=a.parse(n[1],o),d=Math.min(s,c),f=Math.max(s,c);let m=d,y=f;Math.abs(d)>Math.abs(f)&&(m=f,y=d),e[a.axis]=y,e._custom={barStart:m,barEnd:y,start:s,end:c,min:d,max:f}}function gJ(n,e,a,o){return or(n)?vTe(n,e,a,o):e[a.axis]=a.parse(n,o),e}function UG(n,e,a,o){const s=n.iScale,c=n.vScale,d=s.getLabels(),f=s===c,m=[];let y,_,w,A;for(y=a,_=a+o;y<_;++y)A=e[y],w={},w[s.axis]=f||s.parse(d[y],y),m.push(gJ(A,w,c,y));return m}function uI(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function _Te(n,e,a){return n!==0?pd(n):(e.isHorizontal()?1:-1)*(e.min>=a?1:-1)}function bTe(n){let e,a,o,s,c;return n.horizontal?(e=n.base>n.x,a="left",o="right"):(e=n.base<n.y,a="bottom",o="top"),e?(s="end",c="start"):(s="start",c="end"),{start:a,end:o,reverse:e,top:s,bottom:c}}function xTe(n,e,a,o){let s=e.borderSkipped;const c={};if(!s){n.borderSkipped=c;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:f,reverse:m,top:y,bottom:_}=bTe(n);s==="middle"&&a&&(n.enableBorderRadius=!0,(a._top||0)===o?s=y:(a._bottom||0)===o?s=_:(c[WG(_,d,f,m)]=!0,s=y)),c[WG(s,d,f,m)]=!0,n.borderSkipped=c}function WG(n,e,a,o){return o?(n=wTe(n,e,a),n=VG(n,a,e)):n=VG(n,e,a),n}function wTe(n,e,a){return n===e?a:n===a?e:n}function VG(n,e,a){return n==="start"?e:n==="end"?a:n}function STe(n,{inflateAmount:e},a){n.inflateAmount=e==="auto"?a===1?.33:0:e}class $A extends cu{parsePrimitiveData(e,a,o,s){return UG(e,a,o,s)}parseArrayData(e,a,o,s){return UG(e,a,o,s)}parseObjectData(e,a,o,s){const{iScale:c,vScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,y=c.axis==="x"?f:m,_=d.axis==="x"?f:m,w=[];let A,C,I,k;for(A=o,C=o+s;A<C;++A)k=a[A],I={},I[c.axis]=c.parse(bp(k,y),A),w.push(gJ(bp(k,_),I,d,A));return w}updateRangeFromParsed(e,a,o,s){super.updateRangeFromParsed(e,a,o,s);const c=o._custom;c&&a===this._cachedMeta.vScale&&(e.min=Math.min(e.min,c.min),e.max=Math.max(e.max,c.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const a=this._cachedMeta,{iScale:o,vScale:s}=a,c=this.getParsed(e),d=c._custom,f=uI(d)?"["+d.start+", "+d.end+"]":""+s.getLabelForValue(c[s.axis]);return{label:""+o.getLabelForValue(c[o.axis]),value:f}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,e)}updateElements(e,a,o,s){const c=s==="reset",{index:d,_cachedMeta:{vScale:f}}=this,m=f.getBasePixel(),y=f.isHorizontal(),_=this._getRuler(),{sharedOptions:w,includeOptions:A}=this._getSharedOptions(a,s);for(let C=a;C<a+o;C++){const I=this.getParsed(C),k=c||li(I[f.axis])?{base:m,head:m}:this._calculateBarValuePixels(C),D=this._calculateBarIndexPixels(C,_),L=(I._stacks||{})[f.axis],O={horizontal:y,base:k.base,enableBorderRadius:!L||uI(I._custom)||d===L._top||d===L._bottom,x:y?k.head:D.center,y:y?D.center:k.head,height:y?D.size:Math.abs(k.size),width:y?Math.abs(k.size):D.size};A&&(O.options=w||this.resolveDataElementOptions(C,e[C].active?"active":s));const F=O.options||e[C].options;xTe(O,F,L,d),STe(O,F,_.ratio),this.updateElement(e[C],C,O,s)}}_getStacks(e,a){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),c=o.options.stacked,d=[],f=m=>{const y=m.controller.getParsed(a),_=y&&y[m.vScale.axis];if(li(_)||isNaN(_))return!0};for(const m of s)if(!(a!==void 0&&f(m))&&((c===!1||d.indexOf(m.stack)===-1||c===void 0&&m.stack===void 0)&&d.push(m.stack),m.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,a,o){const s=this._getStacks(e,o),c=a!==void 0?s.indexOf(a):-1;return c===-1?s.length-1:c}_getRuler(){const e=this.options,a=this._cachedMeta,o=a.iScale,s=[];let c,d;for(c=0,d=a.data.length;c<d;++c)s.push(o.getPixelForValue(this.getParsed(c)[o.axis],c));const f=e.barThickness;return{min:f||mTe(a),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:e.grouped,ratio:f?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:a,_stacked:o,index:s},options:{base:c,minBarLength:d}}=this,f=c||0,m=this.getParsed(e),y=m._custom,_=uI(y);let w=m[a.axis],A=0,C=o?this.applyStack(a,m,o):w,I,k;C!==w&&(A=C-w,C=w),_&&(w=y.barStart,C=y.barEnd-y.barStart,w!==0&&pd(w)!==pd(y.barEnd)&&(A=0),A+=w);const D=!li(c)&&!_?c:A;let L=a.getPixelForValue(D);if(this.chart.getDataVisibility(e)?I=a.getPixelForValue(A+C):I=L,k=I-L,Math.abs(k)<d){k=_Te(k,a,f)*d,w===f&&(L-=k/2);const O=a.getPixelForDecimal(0),F=a.getPixelForDecimal(1),B=Math.min(O,F),G=Math.max(O,F);L=Math.max(Math.min(L,G),B),I=L+k,o&&!_&&(m._stacks[a.axis]._visualValues[s]=a.getValueForPixel(I)-a.getValueForPixel(L))}if(L===a.getPixelForValue(f)){const O=pd(k)*a.getLineWidthForValue(f)/2;L+=O,k-=O}return{size:k,base:L,head:I,center:I+k/2}}_calculateBarIndexPixels(e,a){const o=a.scale,s=this.options,c=s.skipNull,d=za(s.maxBarThickness,1/0);let f,m;if(a.grouped){const y=c?this._getStackCount(e):a.stackCount,_=s.barThickness==="flex"?yTe(e,a,s,y):gTe(e,a,s,y),w=this._getStackIndex(this.index,this._cachedMeta.stack,c?e:void 0);f=_.start+_.chunk*w+_.chunk/2,m=Math.min(d,_.chunk*_.ratio)}else f=o.getPixelForValue(this.getParsed(e)[o.axis],e),m=Math.min(d,a.min*a.ratio);return{base:f-m/2,head:f+m/2,center:f,size:m}}draw(){const e=this._cachedMeta,a=e.vScale,o=e.data,s=o.length;let c=0;for(;c<s;++c)this.getParsed(c)[a.axis]!==null&&o[c].draw(this._ctx)}}_n($A,"id","bar"),_n($A,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),_n($A,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class qA extends cu{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,a,o,s){const c=super.parsePrimitiveData(e,a,o,s);for(let d=0;d<c.length;d++)c[d]._custom=this.resolveDataElementOptions(d+o).radius;return c}parseArrayData(e,a,o,s){const c=super.parseArrayData(e,a,o,s);for(let d=0;d<c.length;d++){const f=a[o+d];c[d]._custom=za(f[2],this.resolveDataElementOptions(d+o).radius)}return c}parseObjectData(e,a,o,s){const c=super.parseObjectData(e,a,o,s);for(let d=0;d<c.length;d++){const f=a[o+d];c[d]._custom=za(f&&f.r&&+f.r,this.resolveDataElementOptions(d+o).radius)}return c}getMaxOverflow(){const e=this._cachedMeta.data;let a=0;for(let o=e.length-1;o>=0;--o)a=Math.max(a,e[o].size(this.resolveDataElementOptions(o))/2);return a>0&&a}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:c}=a,d=this.getParsed(e),f=s.getLabelForValue(d.x),m=c.getLabelForValue(d.y),y=d._custom;return{label:o[e]||"",value:"("+f+", "+m+(y?", "+y:"")+")"}}update(e){const a=this._cachedMeta.data;this.updateElements(a,0,a.length,e)}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f}=this._cachedMeta,{sharedOptions:m,includeOptions:y}=this._getSharedOptions(a,s),_=d.axis,w=f.axis;for(let A=a;A<a+o;A++){const C=e[A],I=!c&&this.getParsed(A),k={},D=k[_]=c?d.getPixelForDecimal(.5):d.getPixelForValue(I[_]),L=k[w]=c?f.getBasePixel():f.getPixelForValue(I[w]);k.skip=isNaN(D)||isNaN(L),y&&(k.options=m||this.resolveDataElementOptions(A,C.active?"active":s),c&&(k.options.radius=0)),this.updateElement(C,A,k,s)}}resolveDataElementOptions(e,a){const o=this.getParsed(e);let s=super.resolveDataElementOptions(e,a);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const c=s.radius;return a!=="active"&&(s.radius=0),s.radius+=za(o&&o._custom,c),s}}_n(qA,"id","bubble"),_n(qA,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),_n(qA,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function ATe(n,e,a){let o=1,s=1,c=0,d=0;if(e<lr){const f=n,m=f+e,y=Math.cos(f),_=Math.sin(f),w=Math.cos(m),A=Math.sin(m),C=(F,B,G)=>rw(F,f,m,!0)?1:Math.max(B,B*a,G,G*a),I=(F,B,G)=>rw(F,f,m,!0)?-1:Math.min(B,B*a,G,G*a),k=C(0,y,w),D=C(so,_,A),L=I(cr,y,w),O=I(cr+so,_,A);o=(k-L)/2,s=(D-O)/2,c=-(k+L)/2,d=-(D+O)/2}return{ratioX:o,ratioY:s,offsetX:c,offsetY:d}}class pg extends cu{constructor(e,a){super(e,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,a){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let c=m=>+o[m];if(Ka(o[e])){const{key:m="value"}=this._parsing;c=y=>+bp(o[y],m)}let d,f;for(d=e,f=e+a;d<f;++d)s._parsed[d]=c(d)}}_getRotation(){return ou(this.options.rotation-90)}_getCircumference(){return ou(this.options.circumference)}_getRotationExtents(){let e=lr,a=-lr;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,c=s._getRotation(),d=s._getCircumference();e=Math.min(e,c),a=Math.max(a,c+d)}return{rotation:e,circumference:a-e}}update(e){const a=this.chart,{chartArea:o}=a,s=this._cachedMeta,c=s.data,d=this.getMaxBorderWidth()+this.getMaxOffset(c)+this.options.spacing,f=Math.max((Math.min(o.width,o.height)-d)/2,0),m=Math.min(NEe(this.options.cutout,f),1),y=this._getRingWeight(this.index),{circumference:_,rotation:w}=this._getRotationExtents(),{ratioX:A,ratioY:C,offsetX:I,offsetY:k}=ATe(w,_,m),D=(o.width-d)/A,L=(o.height-d)/C,O=Math.max(Math.min(D,L)/2,0),F=GK(this.options.radius,O),B=Math.max(F*m,0),G=(F-B)/this._getVisibleDatasetWeightTotal();this.offsetX=I*F,this.offsetY=k*F,s.total=this.calculateTotal(),this.outerRadius=F-G*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-G*y,0),this.updateElements(c,0,c.length,e)}_circumference(e,a){const o=this.options,s=this._cachedMeta,c=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*c/lr)}updateElements(e,a,o,s){const c=s==="reset",d=this.chart,f=d.chartArea,y=d.options.animation,_=(f.left+f.right)/2,w=(f.top+f.bottom)/2,A=c&&y.animateScale,C=A?0:this.innerRadius,I=A?0:this.outerRadius,{sharedOptions:k,includeOptions:D}=this._getSharedOptions(a,s);let L=this._getRotation(),O;for(O=0;O<a;++O)L+=this._circumference(O,c);for(O=a;O<a+o;++O){const F=this._circumference(O,c),B=e[O],G={x:_+this.offsetX,y:w+this.offsetY,startAngle:L,endAngle:L+F,circumference:F,outerRadius:I,innerRadius:C};D&&(G.options=k||this.resolveDataElementOptions(O,B.active?"active":s)),L+=F,this.updateElement(B,O,G,s)}}calculateTotal(){const e=this._cachedMeta,a=e.data;let o=0,s;for(s=0;s<a.length;s++){const c=e._parsed[s];c!==null&&!isNaN(c)&&this.chart.getDataVisibility(s)&&!a[s].hidden&&(o+=Math.abs(c))}return o}calculateCircumference(e){const a=this._cachedMeta.total;return a>0&&!isNaN(e)?lr*(Math.abs(e)/a):0}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],c=Uw(a._parsed[e],o.options.locale);return{label:s[e]||"",value:c}}getMaxBorderWidth(e){let a=0;const o=this.chart;let s,c,d,f,m;if(!e){for(s=0,c=o.data.datasets.length;s<c;++s)if(o.isDatasetVisible(s)){d=o.getDatasetMeta(s),e=d.data,f=d.controller;break}}if(!e)return 0;for(s=0,c=e.length;s<c;++s)m=f.resolveDataElementOptions(s),m.borderAlign!=="inner"&&(a=Math.max(a,m.borderWidth||0,m.hoverBorderWidth||0));return a}getMaxOffset(e){let a=0;for(let o=0,s=e.length;o<s;++o){const c=this.resolveDataElementOptions(o);a=Math.max(a,c.offset||0,c.hoverOffset||0)}return a}_getRingWeightOffset(e){let a=0;for(let o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(e){return Math.max(za(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}_n(pg,"id","doughnut"),_n(pg,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),_n(pg,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),_n(pg,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const a=e.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return a.labels.map((c,d)=>{const m=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:m.backgroundColor,strokeStyle:m.borderColor,fontColor:s,lineWidth:m.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}});class ox extends cu{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const a=this._cachedMeta,{dataset:o,data:s=[],_dataset:c}=a,d=this.chart._animationsDisabled;let{start:f,count:m}=KK(a,s,d);this._drawStart=f,this._drawCount=m,JK(a)&&(f=0,m=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!c._decimated,o.points=s;const y=this.resolveDatasetElementOptions(e);this.options.showLine||(y.borderWidth=0),y.segment=this.options.segment,this.updateElement(o,void 0,{animated:!d,options:y},e),this.updateElements(s,f,m,e)}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f,_stacked:m,_dataset:y}=this._cachedMeta,{sharedOptions:_,includeOptions:w}=this._getSharedOptions(a,s),A=d.axis,C=f.axis,{spanGaps:I,segment:k}=this.options,D=n_(I)?I:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||c||s==="none",O=a+o,F=e.length;let B=a>0&&this.getParsed(a-1);for(let G=0;G<F;++G){const q=e[G],X=L?q:{};if(G<a||G>=O){X.skip=!0;continue}const ee=this.getParsed(G),V=li(ee[C]),Q=X[A]=d.getPixelForValue(ee[A],G),me=X[C]=c||V?f.getBasePixel():f.getPixelForValue(m?this.applyStack(f,ee,m):ee[C],G);X.skip=isNaN(Q)||isNaN(me)||V,X.stop=G>0&&Math.abs(ee[A]-B[A])>D,k&&(X.parsed=ee,X.raw=y.data[G]),w&&(X.options=_||this.resolveDataElementOptions(G,q.active?"active":s)),L||this.updateElement(q,G,X,s),B=ee}}getMaxOverflow(){const e=this._cachedMeta,a=e.dataset,o=a.options&&a.options.borderWidth||0,s=e.data||[];if(!s.length)return o;const c=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,c,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}_n(ox,"id","line"),_n(ox,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),_n(ox,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class sx extends cu{constructor(e,a){super(e,a),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],c=Uw(a._parsed[e].r,o.options.locale);return{label:s[e]||"",value:c}}parseObjectData(e,a,o,s){return oJ.bind(this)(e,a,o,s)}update(e){const a=this._cachedMeta.data;this._updateRadius(),this.updateElements(a,0,a.length,e)}getMinMax(){const e=this._cachedMeta,a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((o,s)=>{const c=this.getParsed(s).r;!isNaN(c)&&this.chart.getDataVisibility(s)&&(c<a.min&&(a.min=c),c>a.max&&(a.max=c))}),a}_updateRadius(){const e=this.chart,a=e.chartArea,o=e.options,s=Math.min(a.right-a.left,a.bottom-a.top),c=Math.max(s/2,0),d=Math.max(o.cutoutPercentage?c/100*o.cutoutPercentage:1,0),f=(c-d)/e.getVisibleDatasetCount();this.outerRadius=c-f*this.index,this.innerRadius=this.outerRadius-f}updateElements(e,a,o,s){const c=s==="reset",d=this.chart,m=d.options.animation,y=this._cachedMeta.rScale,_=y.xCenter,w=y.yCenter,A=y.getIndexAngle(0)-.5*cr;let C=A,I;const k=360/this.countVisibleElements();for(I=0;I<a;++I)C+=this._computeAngle(I,s,k);for(I=a;I<a+o;I++){const D=e[I];let L=C,O=C+this._computeAngle(I,s,k),F=d.getDataVisibility(I)?y.getDistanceFromCenterForValue(this.getParsed(I).r):0;C=O,c&&(m.animateScale&&(F=0),m.animateRotate&&(L=O=A));const B={x:_,y:w,innerRadius:0,outerRadius:F,startAngle:L,endAngle:O,options:this.resolveDataElementOptions(I,D.active?"active":s)};this.updateElement(D,I,B,s)}}countVisibleElements(){const e=this._cachedMeta;let a=0;return e.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&a++}),a}_computeAngle(e,a,o){return this.chart.getDataVisibility(e)?ou(this.resolveDataElementOptions(e,a).angle||o):0}}_n(sx,"id","polarArea"),_n(sx,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),_n(sx,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const a=e.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return a.labels.map((c,d)=>{const m=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:m.backgroundColor,strokeStyle:m.borderColor,fontColor:s,lineWidth:m.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class NR extends pg{}_n(NR,"id","pie"),_n(NR,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class lx extends cu{getLabelAndValue(e){const a=this._cachedMeta.vScale,o=this.getParsed(e);return{label:a.getLabels()[e],value:""+a.getLabelForValue(o[a.axis])}}parseObjectData(e,a,o,s){return oJ.bind(this)(e,a,o,s)}update(e){const a=this._cachedMeta,o=a.dataset,s=a.data||[],c=a.iScale.getLabels();if(o.points=s,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const f={_loop:!0,_fullLoop:c.length===s.length,options:d};this.updateElement(o,void 0,f,e)}this.updateElements(s,0,s.length,e)}updateElements(e,a,o,s){const c=this._cachedMeta.rScale,d=s==="reset";for(let f=a;f<a+o;f++){const m=e[f],y=this.resolveDataElementOptions(f,m.active?"active":s),_=c.getPointPositionForValue(f,this.getParsed(f).r),w=d?c.xCenter:_.x,A=d?c.yCenter:_.y,C={x:w,y:A,angle:_.angle,skip:isNaN(w)||isNaN(A),options:y};this.updateElement(m,f,C,s)}}}_n(lx,"id","radar"),_n(lx,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),_n(lx,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class XA extends cu{getLabelAndValue(e){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:c}=a,d=this.getParsed(e),f=s.getLabelForValue(d.x),m=c.getLabelForValue(d.y);return{label:o[e]||"",value:"("+f+", "+m+")"}}update(e){const a=this._cachedMeta,{data:o=[]}=a,s=this.chart._animationsDisabled;let{start:c,count:d}=KK(a,o,s);if(this._drawStart=c,this._drawCount=d,JK(a)&&(c=0,d=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:f,_dataset:m}=a;f._chart=this.chart,f._datasetIndex=this.index,f._decimated=!!m._decimated,f.points=o;const y=this.resolveDatasetElementOptions(e);y.segment=this.options.segment,this.updateElement(f,void 0,{animated:!s,options:y},e)}else this.datasetElementType&&(delete a.dataset,this.datasetElementType=!1);this.updateElements(o,c,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f,_stacked:m,_dataset:y}=this._cachedMeta,_=this.resolveDataElementOptions(a,s),w=this.getSharedOptions(_),A=this.includeOptions(s,w),C=d.axis,I=f.axis,{spanGaps:k,segment:D}=this.options,L=n_(k)?k:Number.POSITIVE_INFINITY,O=this.chart._animationsDisabled||c||s==="none";let F=a>0&&this.getParsed(a-1);for(let B=a;B<a+o;++B){const G=e[B],q=this.getParsed(B),X=O?G:{},ee=li(q[I]),V=X[C]=d.getPixelForValue(q[C],B),Q=X[I]=c||ee?f.getBasePixel():f.getPixelForValue(m?this.applyStack(f,q,m):q[I],B);X.skip=isNaN(V)||isNaN(Q)||ee,X.stop=B>0&&Math.abs(q[C]-F[C])>L,D&&(X.parsed=q,X.raw=y.data[B]),A&&(X.options=w||this.resolveDataElementOptions(B,G.active?"active":s)),O||this.updateElement(G,B,X,s),F=q}this.updateSharedOptions(w,s,_)}getMaxOverflow(){const e=this._cachedMeta,a=e.data||[];if(!this.options.showLine){let f=0;for(let m=a.length-1;m>=0;--m)f=Math.max(f,a[m].size(this.resolveDataElementOptions(m))/2);return f>0&&f}const o=e.dataset,s=o.options&&o.options.borderWidth||0;if(!a.length)return s;const c=a[0].size(this.resolveDataElementOptions(0)),d=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,c,d)/2}}_n(XA,"id","scatter"),_n(XA,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),_n(XA,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var ETe=Object.freeze({__proto__:null,BarController:$A,BubbleController:qA,DoughnutController:pg,LineController:ox,PieController:NR,PolarAreaController:sx,RadarController:lx,ScatterController:XA});function Gm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class q6{constructor(e){_n(this,"options");this.options=e||{}}static override(e){Object.assign(q6.prototype,e)}init(){}formats(){return Gm()}parse(){return Gm()}format(){return Gm()}add(){return Gm()}diff(){return Gm()}startOf(){return Gm()}endOf(){return Gm()}}var MTe={_date:q6};function TTe(n,e,a,o){const{controller:s,data:c,_sorted:d}=n,f=s._cachedMeta.iScale;if(f&&e===f.axis&&e!=="r"&&d&&c.length){const m=f._reversePixels?YEe:Mh;if(o){if(s._sharedOptions){const y=c[0],_=typeof y.getRange=="function"&&y.getRange(e);if(_){const w=m(c,e,a-_),A=m(c,e,a+_);return{lo:w.lo,hi:A.hi}}}}else return m(c,e,a)}return{lo:0,hi:c.length-1}}function Ww(n,e,a,o,s){const c=n.getSortedVisibleDatasetMetas(),d=a[e];for(let f=0,m=c.length;f<m;++f){const{index:y,data:_}=c[f],{lo:w,hi:A}=TTe(c[f],e,d,s);for(let C=w;C<=A;++C){const I=_[C];I.skip||o(I,y,C)}}}function CTe(n){const e=n.indexOf("x")!==-1,a=n.indexOf("y")!==-1;return function(o,s){const c=e?Math.abs(o.x-s.x):0,d=a?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))}}function dI(n,e,a,o,s){const c=[];return!s&&!n.isPointInArea(e)||Ww(n,a,e,function(f,m,y){!s&&!Th(f,n.chartArea,0)||f.inRange(e.x,e.y,o)&&c.push({element:f,datasetIndex:m,index:y})},!0),c}function PTe(n,e,a,o){let s=[];function c(d,f,m){const{startAngle:y,endAngle:_}=d.getProps(["startAngle","endAngle"],o),{angle:w}=$K(d,{x:e.x,y:e.y});rw(w,y,_)&&s.push({element:d,datasetIndex:f,index:m})}return Ww(n,a,e,c),s}function ITe(n,e,a,o,s,c){let d=[];const f=CTe(a);let m=Number.POSITIVE_INFINITY;function y(_,w,A){const C=_.inRange(e.x,e.y,s);if(o&&!C)return;const I=_.getCenterPoint(s);if(!(!!c||n.isPointInArea(I))&&!C)return;const D=f(e,I);D<m?(d=[{element:_,datasetIndex:w,index:A}],m=D):D===m&&d.push({element:_,datasetIndex:w,index:A})}return Ww(n,a,e,y),d}function hI(n,e,a,o,s,c){return!c&&!n.isPointInArea(e)?[]:a==="r"&&!o?PTe(n,e,a,s):ITe(n,e,a,o,s,c)}function GG(n,e,a,o,s){const c=[],d=a==="x"?"inXRange":"inYRange";let f=!1;return Ww(n,a,e,(m,y,_)=>{m[d](e[a],s)&&(c.push({element:m,datasetIndex:y,index:_}),f=f||m.inRange(e.x,e.y,s))}),o&&!f?[]:c}var LTe={evaluateInteractionItems:Ww,modes:{index(n,e,a,o){const s=eg(e,n),c=a.axis||"x",d=a.includeInvisible||!1,f=a.intersect?dI(n,s,c,o,d):hI(n,s,c,!1,o,d),m=[];return f.length?(n.getSortedVisibleDatasetMetas().forEach(y=>{const _=f[0].index,w=y.data[_];w&&!w.skip&&m.push({element:w,datasetIndex:y.index,index:_})}),m):[]},dataset(n,e,a,o){const s=eg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;let f=a.intersect?dI(n,s,c,o,d):hI(n,s,c,!1,o,d);if(f.length>0){const m=f[0].datasetIndex,y=n.getDatasetMeta(m).data;f=[];for(let _=0;_<y.length;++_)f.push({element:y[_],datasetIndex:m,index:_})}return f},point(n,e,a,o){const s=eg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;return dI(n,s,c,o,d)},nearest(n,e,a,o){const s=eg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;return hI(n,s,c,a.intersect,o,d)},x(n,e,a,o){const s=eg(e,n);return GG(n,s,"x",a.intersect,o)},y(n,e,a,o){const s=eg(e,n);return GG(n,s,"y",a.intersect,o)}}};const yJ=["left","top","right","bottom"];function ub(n,e){return n.filter(a=>a.pos===e)}function HG(n,e){return n.filter(a=>yJ.indexOf(a.pos)===-1&&a.box.axis===e)}function db(n,e){return n.sort((a,o)=>{const s=e?o:a,c=e?a:o;return s.weight===c.weight?s.index-c.index:s.weight-c.weight})}function RTe(n){const e=[];let a,o,s,c,d,f;for(a=0,o=(n||[]).length;a<o;++a)s=n[a],{position:c,options:{stack:d,stackWeight:f=1}}=s,e.push({index:a,box:s,pos:c,horizontal:s.isHorizontal(),weight:s.weight,stack:d&&c+d,stackWeight:f});return e}function kTe(n){const e={};for(const a of n){const{stack:o,pos:s,stackWeight:c}=a;if(!o||!yJ.includes(s))continue;const d=e[o]||(e[o]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=c}return e}function DTe(n,e){const a=kTe(n),{vBoxMaxWidth:o,hBoxMaxHeight:s}=e;let c,d,f;for(c=0,d=n.length;c<d;++c){f=n[c];const{fullSize:m}=f.box,y=a[f.stack],_=y&&f.stackWeight/y.weight;f.horizontal?(f.width=_?_*o:m&&e.availableWidth,f.height=s):(f.width=o,f.height=_?_*s:m&&e.availableHeight)}return a}function OTe(n){const e=RTe(n),a=db(e.filter(y=>y.box.fullSize),!0),o=db(ub(e,"left"),!0),s=db(ub(e,"right")),c=db(ub(e,"top"),!0),d=db(ub(e,"bottom")),f=HG(e,"x"),m=HG(e,"y");return{fullSize:a,leftAndTop:o.concat(c),rightAndBottom:s.concat(m).concat(d).concat(f),chartArea:ub(e,"chartArea"),vertical:o.concat(s).concat(m),horizontal:c.concat(d).concat(f)}}function jG(n,e,a,o){return Math.max(n[a],e[a])+Math.max(n[o],e[o])}function vJ(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function zTe(n,e,a,o){const{pos:s,box:c}=a,d=n.maxPadding;if(!Ka(s)){a.size&&(n[s]-=a.size);const w=o[a.stack]||{size:0,count:1};w.size=Math.max(w.size,a.horizontal?c.height:c.width),a.size=w.size/w.count,n[s]+=a.size}c.getPadding&&vJ(d,c.getPadding());const f=Math.max(0,e.outerWidth-jG(d,n,"left","right")),m=Math.max(0,e.outerHeight-jG(d,n,"top","bottom")),y=f!==n.w,_=m!==n.h;return n.w=f,n.h=m,a.horizontal?{same:y,other:_}:{same:_,other:y}}function FTe(n){const e=n.maxPadding;function a(o){const s=Math.max(e[o]-n[o],0);return n[o]+=s,s}n.y+=a("top"),n.x+=a("left"),a("right"),a("bottom")}function NTe(n,e){const a=e.maxPadding;function o(s){const c={left:0,top:0,right:0,bottom:0};return s.forEach(d=>{c[d]=Math.max(e[d],a[d])}),c}return o(n?["left","right"]:["top","bottom"])}function Tb(n,e,a,o){const s=[];let c,d,f,m,y,_;for(c=0,d=n.length,y=0;c<d;++c){f=n[c],m=f.box,m.update(f.width||e.w,f.height||e.h,NTe(f.horizontal,e));const{same:w,other:A}=zTe(e,a,f,o);y|=w&&s.length,_=_||A,m.fullSize||s.push(f)}return y&&Tb(s,e,a,o)||_}function lA(n,e,a,o,s){n.top=a,n.left=e,n.right=e+o,n.bottom=a+s,n.width=o,n.height=s}function $G(n,e,a,o){const s=a.padding;let{x:c,y:d}=e;for(const f of n){const m=f.box,y=o[f.stack]||{count:1,placed:0,weight:1},_=f.stackWeight/y.weight||1;if(f.horizontal){const w=e.w*_,A=y.size||m.height;iw(y.start)&&(d=y.start),m.fullSize?lA(m,s.left,d,a.outerWidth-s.right-s.left,A):lA(m,e.left+y.placed,d,w,A),y.start=d,y.placed+=w,d=m.bottom}else{const w=e.h*_,A=y.size||m.width;iw(y.start)&&(c=y.start),m.fullSize?lA(m,c,s.top,A,a.outerHeight-s.bottom-s.top):lA(m,c,e.top+y.placed,A,w),y.start=c,y.placed+=w,c=m.right}}e.x=c,e.y=d}var ys={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(a){e.draw(a)}}]},n.boxes.push(e)},removeBox(n,e){const a=n.boxes?n.boxes.indexOf(e):-1;a!==-1&&n.boxes.splice(a,1)},configure(n,e,a){e.fullSize=a.fullSize,e.position=a.position,e.weight=a.weight},update(n,e,a,o){if(!n)return;const s=ws(n.options.layout.padding),c=Math.max(e-s.width,0),d=Math.max(a-s.height,0),f=OTe(n.boxes),m=f.vertical,y=f.horizontal;zi(n.boxes,k=>{typeof k.beforeLayout=="function"&&k.beforeLayout()});const _=m.reduce((k,D)=>D.box.options&&D.box.options.display===!1?k:k+1,0)||1,w=Object.freeze({outerWidth:e,outerHeight:a,padding:s,availableWidth:c,availableHeight:d,vBoxMaxWidth:c/2/_,hBoxMaxHeight:d/2}),A=Object.assign({},s);vJ(A,ws(o));const C=Object.assign({maxPadding:A,w:c,h:d,x:s.left,y:s.top},s),I=DTe(m.concat(y),w);Tb(f.fullSize,C,w,I),Tb(m,C,w,I),Tb(y,C,w,I)&&Tb(m,C,w,I),FTe(C),$G(f.leftAndTop,C,w,I),C.x+=C.w,C.y+=C.h,$G(f.rightAndBottom,C,w,I),n.chartArea={left:C.left,top:C.top,right:C.left+C.w,bottom:C.top+C.h,height:C.h,width:C.w},zi(f.chartArea,k=>{const D=k.box;Object.assign(D,n.chartArea),D.update(C.w,C.h,{left:0,top:0,right:0,bottom:0})})}};class _J{acquireContext(e,a){}releaseContext(e){return!1}addEventListener(e,a,o){}removeEventListener(e,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(e,a,o,s){return a=Math.max(0,a||e.width),o=o||e.height,{width:a,height:Math.max(0,s?Math.floor(a/s):o)}}isAttached(e){return!0}updateConfig(e){}}class BTe extends _J{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ZA="$chartjs",UTe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},qG=n=>n===null||n==="";function WTe(n,e){const a=n.style,o=n.getAttribute("height"),s=n.getAttribute("width");if(n[ZA]={initial:{height:o,width:s,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",qG(s)){const c=PG(n,"width");c!==void 0&&(n.width=c)}if(qG(o))if(n.style.height==="")n.height=n.width/(e||2);else{const c=PG(n,"height");c!==void 0&&(n.height=c)}return n}const bJ=GMe?{passive:!0}:!1;function VTe(n,e,a){n.addEventListener(e,a,bJ)}function GTe(n,e,a){n.canvas.removeEventListener(e,a,bJ)}function HTe(n,e){const a=UTe[n.type]||n.type,{x:o,y:s}=eg(n,e);return{type:a,chart:e,native:n,x:o!==void 0?o:null,y:s!==void 0?s:null}}function rM(n,e){for(const a of n)if(a===e||a.contains(e))return!0}function jTe(n,e,a){const o=n.canvas,s=new MutationObserver(c=>{let d=!1;for(const f of c)d=d||rM(f.addedNodes,o),d=d&&!rM(f.removedNodes,o);d&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}function $Te(n,e,a){const o=n.canvas,s=new MutationObserver(c=>{let d=!1;for(const f of c)d=d||rM(f.removedNodes,o),d=d&&!rM(f.addedNodes,o);d&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}const sw=new Map;let XG=0;function xJ(){const n=window.devicePixelRatio;n!==XG&&(XG=n,sw.forEach((e,a)=>{a.currentDevicePixelRatio!==n&&e()}))}function qTe(n,e){sw.size||window.addEventListener("resize",xJ),sw.set(n,e)}function XTe(n){sw.delete(n),sw.size||window.removeEventListener("resize",xJ)}function ZTe(n,e,a){const o=n.canvas,s=o&&$6(o);if(!s)return;const c=YK((f,m)=>{const y=s.clientWidth;a(f,m),y<s.clientWidth&&a()},window),d=new ResizeObserver(f=>{const m=f[0],y=m.contentRect.width,_=m.contentRect.height;y===0&&_===0||c(y,_)});return d.observe(s),qTe(n,c),d}function fI(n,e,a){a&&a.disconnect(),e==="resize"&&XTe(n)}function YTe(n,e,a){const o=n.canvas,s=YK(c=>{n.ctx!==null&&a(HTe(c,n))},n);return VTe(o,e,s),s}class KTe extends _J{acquireContext(e,a){const o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(WTe(e,a),o):null}releaseContext(e){const a=e.canvas;if(!a[ZA])return!1;const o=a[ZA].initial;["height","width"].forEach(c=>{const d=o[c];li(d)?a.removeAttribute(c):a.setAttribute(c,d)});const s=o.style||{};return Object.keys(s).forEach(c=>{a.style[c]=s[c]}),a.width=a.width,delete a[ZA],!0}addEventListener(e,a,o){this.removeEventListener(e,a);const s=e.$proxies||(e.$proxies={}),d={attach:jTe,detach:$Te,resize:ZTe}[a]||YTe;s[a]=d(e,a,o)}removeEventListener(e,a){const o=e.$proxies||(e.$proxies={}),s=o[a];if(!s)return;({attach:fI,detach:fI,resize:fI}[a]||GTe)(e,a,s),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,a,o,s){return VMe(e,a,o,s)}isAttached(e){const a=$6(e);return!!(a&&a.isConnected)}}function JTe(n){return!lJ()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?BTe:KTe}class fu{constructor(){_n(this,"x");_n(this,"y");_n(this,"active",!1);_n(this,"options");_n(this,"$animations")}tooltipPosition(e){const{x:a,y:o}=this.getProps(["x","y"],e);return{x:a,y:o}}hasValue(){return n_(this.x)&&n_(this.y)}getProps(e,a){const o=this.$animations;if(!a||!o)return this;const s={};return e.forEach(c=>{s[c]=o[c]&&o[c].active()?o[c]._to:this[c]}),s}}_n(fu,"defaults",{}),_n(fu,"defaultRoutes");function QTe(n,e){const a=n.options.ticks,o=eCe(n),s=Math.min(a.maxTicksLimit||o,o),c=a.major.enabled?nCe(e):[],d=c.length,f=c[0],m=c[d-1],y=[];if(d>s)return aCe(e,y,c,d/s),y;const _=tCe(c,e,s);if(d>0){let w,A;const C=d>1?Math.round((m-f)/(d-1)):null;for(cA(e,y,_,li(C)?0:f-C,f),w=0,A=d-1;w<A;w++)cA(e,y,_,c[w],c[w+1]);return cA(e,y,_,m,li(C)?e.length:m+C),y}return cA(e,y,_),y}function eCe(n){const e=n.options.offset,a=n._tickSize(),o=n._length/a+(e?0:1),s=n._maxLength/a;return Math.floor(Math.min(o,s))}function tCe(n,e,a){const o=iCe(n),s=e.length/a;if(!o)return Math.max(s,1);const c=$Ee(o);for(let d=0,f=c.length-1;d<f;d++){const m=c[d];if(m>s)return m}return Math.max(s,1)}function nCe(n){const e=[];let a,o;for(a=0,o=n.length;a<o;a++)n[a].major&&e.push(a);return e}function aCe(n,e,a,o){let s=0,c=a[0],d;for(o=Math.ceil(o),d=0;d<n.length;d++)d===c&&(e.push(n[d]),s++,c=a[s*o])}function cA(n,e,a,o,s){const c=za(o,0),d=Math.min(za(s,n.length),n.length);let f=0,m,y,_;for(a=Math.ceil(a),s&&(m=s-o,a=m/Math.floor(m/a)),_=c;_<0;)f++,_=Math.round(c+f*a);for(y=Math.max(c,0);y<d;y++)y===_&&(e.push(n[y]),f++,_=Math.round(c+f*a))}function iCe(n){const e=n.length;let a,o;if(e<2)return!1;for(o=n[0],a=1;a<e;++a)if(n[a]-n[a-1]!==o)return!1;return o}const rCe=n=>n==="left"?"right":n==="right"?"left":n,ZG=(n,e,a)=>e==="top"||e==="left"?n[e]+a:n[e]-a,YG=(n,e)=>Math.min(e||n,n);function KG(n,e){const a=[],o=n.length/e,s=n.length;let c=0;for(;c<s;c+=o)a.push(n[Math.floor(c)]);return a}function oCe(n,e,a){const o=n.ticks.length,s=Math.min(e,o-1),c=n._startPixel,d=n._endPixel,f=1e-6;let m=n.getPixelForTick(s),y;if(!(a&&(o===1?y=Math.max(m-c,d-m):e===0?y=(n.getPixelForTick(1)-m)/2:y=(m-n.getPixelForTick(s-1))/2,m+=s<e?y:-y,m<c-f||m>d+f)))return m}function sCe(n,e){zi(n,a=>{const o=a.gc,s=o.length/2;let c;if(s>e){for(c=0;c<s;++c)delete a.data[o[c]];o.splice(0,s)}})}function hb(n){return n.drawTicks?n.tickLength:0}function JG(n,e){if(!n.display)return 0;const a=Po(n.font,e),o=ws(n.padding);return(or(n.text)?n.text.length:1)*a.lineHeight+o.height}function lCe(n,e){return Pp(n,{scale:e,type:"scale"})}function cCe(n,e,a){return Pp(n,{tick:a,index:e,type:"tick"})}function uCe(n,e,a){let o=U6(n);return(a&&e!=="right"||!a&&e==="right")&&(o=rCe(o)),o}function dCe(n,e,a,o){const{top:s,left:c,bottom:d,right:f,chart:m}=n,{chartArea:y,scales:_}=m;let w=0,A,C,I;const k=d-s,D=f-c;if(n.isHorizontal()){if(C=fs(o,c,f),Ka(a)){const L=Object.keys(a)[0],O=a[L];I=_[L].getPixelForValue(O)+k-e}else a==="center"?I=(y.bottom+y.top)/2+k-e:I=ZG(n,a,e);A=f-c}else{if(Ka(a)){const L=Object.keys(a)[0],O=a[L];C=_[L].getPixelForValue(O)-D+e}else a==="center"?C=(y.left+y.right)/2-D+e:C=ZG(n,a,e);I=fs(o,d,s),w=a==="left"?-so:so}return{titleX:C,titleY:I,maxWidth:A,rotation:w}}class $g extends fu{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,a){return e}getUserBounds(){let{_userMin:e,_userMax:a,_suggestedMin:o,_suggestedMax:s}=this;return e=zl(e,Number.POSITIVE_INFINITY),a=zl(a,Number.NEGATIVE_INFINITY),o=zl(o,Number.POSITIVE_INFINITY),s=zl(s,Number.NEGATIVE_INFINITY),{min:zl(e,o),max:zl(a,s),minDefined:$r(e),maxDefined:$r(a)}}getMinMax(e){let{min:a,max:o,minDefined:s,maxDefined:c}=this.getUserBounds(),d;if(s&&c)return{min:a,max:o};const f=this.getMatchingVisibleMetas();for(let m=0,y=f.length;m<y;++m)d=f[m].controller.getMinMax(this,e),s||(a=Math.min(a,d.min)),c||(o=Math.max(o,d.max));return a=c&&a>o?o:a,o=s&&a>o?a:o,{min:zl(a,zl(o,a)),max:zl(o,zl(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Qi(this.options.beforeUpdate,[this])}update(e,a,o){const{beginAtZero:s,grace:c,ticks:d}=this.options,f=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=bMe(this,c,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const m=f<this.ticks.length;this._convertTicksToLabels(m?KG(this.ticks,f):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=QTe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),m&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,e=!e),this._startPixel=a,this._endPixel=o,this._reversePixels=e,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Qi(this.options.afterUpdate,[this])}beforeSetDimensions(){Qi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Qi(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Qi(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Qi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const a=this.options.ticks;let o,s,c;for(o=0,s=e.length;o<s;o++)c=e[o],c.label=Qi(a.callback,[c.value,o,e],this)}afterTickToLabelConversion(){Qi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Qi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,a=e.ticks,o=YG(this.ticks.length,e.ticks.maxTicksLimit),s=a.minRotation||0,c=a.maxRotation;let d=s,f,m,y;if(!this._isVisible()||!a.display||s>=c||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const _=this._getLabelSizes(),w=_.widest.width,A=_.highest.height,C=Fo(this.chart.width-w,0,this.maxWidth);f=e.offset?this.maxWidth/o:C/(o-1),w+6>f&&(f=C/(o-(e.offset?.5:1)),m=this.maxHeight-hb(e.grid)-a.padding-JG(e.title,this.chart.options.font),y=Math.sqrt(w*w+A*A),d=N6(Math.min(Math.asin(Fo((_.highest.height+6)/f,-1,1)),Math.asin(Fo(m/y,-1,1))-Math.asin(Fo(A/y,-1,1)))),d=Math.max(s,Math.min(c,d))),this.labelRotation=d}afterCalculateLabelRotation(){Qi(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Qi(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:a,options:{ticks:o,title:s,grid:c}}=this,d=this._isVisible(),f=this.isHorizontal();if(d){const m=JG(s,a.options.font);if(f?(e.width=this.maxWidth,e.height=hb(c)+m):(e.height=this.maxHeight,e.width=hb(c)+m),o.display&&this.ticks.length){const{first:y,last:_,widest:w,highest:A}=this._getLabelSizes(),C=o.padding*2,I=ou(this.labelRotation),k=Math.cos(I),D=Math.sin(I);if(f){const L=o.mirror?0:D*w.width+k*A.height;e.height=Math.min(this.maxHeight,e.height+L+C)}else{const L=o.mirror?0:k*w.width+D*A.height;e.width=Math.min(this.maxWidth,e.width+L+C)}this._calculatePadding(y,_,D,k)}}this._handleMargins(),f?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,a,o,s){const{ticks:{align:c,padding:d},position:f}=this.options,m=this.labelRotation!==0,y=f!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,w=this.right-this.getPixelForTick(this.ticks.length-1);let A=0,C=0;m?y?(A=s*e.width,C=o*a.height):(A=o*e.height,C=s*a.width):c==="start"?C=a.width:c==="end"?A=e.width:c!=="inner"&&(A=e.width/2,C=a.width/2),this.paddingLeft=Math.max((A-_+d)*this.width/(this.width-_),0),this.paddingRight=Math.max((C-w+d)*this.width/(this.width-w),0)}else{let _=a.height/2,w=e.height/2;c==="start"?(_=0,w=e.height):c==="end"&&(_=a.height,w=0),this.paddingTop=_+d,this.paddingBottom=w+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Qi(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:a}=this.options;return a==="top"||a==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let a,o;for(a=0,o=e.length;a<o;a++)li(e[a].label)&&(e.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=KG(o,a)),this._labelSizes=e=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,a,o){const{ctx:s,_longestTextCache:c}=this,d=[],f=[],m=Math.floor(a/YG(a,o));let y=0,_=0,w,A,C,I,k,D,L,O,F,B,G;for(w=0;w<a;w+=m){if(I=e[w].label,k=this._resolveTickFontOptions(w),s.font=D=k.string,L=c[D]=c[D]||{data:{},gc:[]},O=k.lineHeight,F=B=0,!li(I)&&!or(I))F=aM(s,L.data,L.gc,F,I),B=O;else if(or(I))for(A=0,C=I.length;A<C;++A)G=I[A],!li(G)&&!or(G)&&(F=aM(s,L.data,L.gc,F,G),B+=O);d.push(F),f.push(B),y=Math.max(F,y),_=Math.max(B,_)}sCe(c,a);const q=d.indexOf(y),X=f.indexOf(_),ee=V=>({width:d[V]||0,height:f[V]||0});return{first:ee(0),last:ee(a-1),widest:ee(q),highest:ee(X),widths:d,heights:f}}getLabelForValue(e){return e}getPixelForValue(e,a){return NaN}getValueForPixel(e){}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const a=this._startPixel+e*this._length;return ZEe(this._alignToPixels?Vm(this.chart,a,0):a)}getDecimalForPixel(e){const a=(e-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:a}=this;return e<0&&a<0?a:e>0&&a>0?e:0}getContext(e){const a=this.ticks||[];if(e>=0&&e<a.length){const o=a[e];return o.$context||(o.$context=cCe(this.getContext(),e,o))}return this.$context||(this.$context=lCe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,a=ou(this.labelRotation),o=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),c=this._getLabelSizes(),d=e.autoSkipPadding||0,f=c?c.widest.width+d:0,m=c?c.highest.height+d:0;return this.isHorizontal()?m*o>f*s?f/o:m/s:m*s<f*o?m/o:f/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const a=this.axis,o=this.chart,s=this.options,{grid:c,position:d,border:f}=s,m=c.offset,y=this.isHorizontal(),w=this.ticks.length+(m?1:0),A=hb(c),C=[],I=f.setContext(this.getContext()),k=I.display?I.width:0,D=k/2,L=function(Re){return Vm(o,Re,k)};let O,F,B,G,q,X,ee,V,Q,me,pe,be;if(d==="top")O=L(this.bottom),X=this.bottom-A,V=O-D,me=L(e.top)+D,be=e.bottom;else if(d==="bottom")O=L(this.top),me=e.top,be=L(e.bottom)-D,X=O+D,V=this.top+A;else if(d==="left")O=L(this.right),q=this.right-A,ee=O-D,Q=L(e.left)+D,pe=e.right;else if(d==="right")O=L(this.left),Q=e.left,pe=L(e.right)-D,q=O+D,ee=this.left+A;else if(a==="x"){if(d==="center")O=L((e.top+e.bottom)/2+.5);else if(Ka(d)){const Re=Object.keys(d)[0],He=d[Re];O=L(this.chart.scales[Re].getPixelForValue(He))}me=e.top,be=e.bottom,X=O+D,V=X+A}else if(a==="y"){if(d==="center")O=L((e.left+e.right)/2);else if(Ka(d)){const Re=Object.keys(d)[0],He=d[Re];O=L(this.chart.scales[Re].getPixelForValue(He))}q=O-D,ee=q-A,Q=e.left,pe=e.right}const fe=za(s.ticks.maxTicksLimit,w),Ce=Math.max(1,Math.ceil(w/fe));for(F=0;F<w;F+=Ce){const Re=this.getContext(F),He=c.setContext(Re),ue=f.setContext(Re),ye=He.lineWidth,Ae=He.color,ne=ue.dash||[],Ee=ue.dashOffset,Ye=He.tickWidth,Xe=He.tickColor,Ke=He.tickBorderDash||[],Ue=He.tickBorderDashOffset;B=oCe(this,F,m),B!==void 0&&(G=Vm(o,B,ye),y?q=ee=Q=pe=G:X=V=me=be=G,C.push({tx1:q,ty1:X,tx2:ee,ty2:V,x1:Q,y1:me,x2:pe,y2:be,width:ye,color:Ae,borderDash:ne,borderDashOffset:Ee,tickWidth:Ye,tickColor:Xe,tickBorderDash:Ke,tickBorderDashOffset:Ue}))}return this._ticksLength=w,this._borderValue=O,C}_computeLabelItems(e){const a=this.axis,o=this.options,{position:s,ticks:c}=o,d=this.isHorizontal(),f=this.ticks,{align:m,crossAlign:y,padding:_,mirror:w}=c,A=hb(o.grid),C=A+_,I=w?-_:C,k=-ou(this.labelRotation),D=[];let L,O,F,B,G,q,X,ee,V,Q,me,pe,be="middle";if(s==="top")q=this.bottom-I,X=this._getXAxisLabelAlignment();else if(s==="bottom")q=this.top+I,X=this._getXAxisLabelAlignment();else if(s==="left"){const Ce=this._getYAxisLabelAlignment(A);X=Ce.textAlign,G=Ce.x}else if(s==="right"){const Ce=this._getYAxisLabelAlignment(A);X=Ce.textAlign,G=Ce.x}else if(a==="x"){if(s==="center")q=(e.top+e.bottom)/2+C;else if(Ka(s)){const Ce=Object.keys(s)[0],Re=s[Ce];q=this.chart.scales[Ce].getPixelForValue(Re)+C}X=this._getXAxisLabelAlignment()}else if(a==="y"){if(s==="center")G=(e.left+e.right)/2-C;else if(Ka(s)){const Ce=Object.keys(s)[0],Re=s[Ce];G=this.chart.scales[Ce].getPixelForValue(Re)}X=this._getYAxisLabelAlignment(A).textAlign}a==="y"&&(m==="start"?be="top":m==="end"&&(be="bottom"));const fe=this._getLabelSizes();for(L=0,O=f.length;L<O;++L){F=f[L],B=F.label;const Ce=c.setContext(this.getContext(L));ee=this.getPixelForTick(L)+c.labelOffset,V=this._resolveTickFontOptions(L),Q=V.lineHeight,me=or(B)?B.length:1;const Re=me/2,He=Ce.color,ue=Ce.textStrokeColor,ye=Ce.textStrokeWidth;let Ae=X;d?(G=ee,X==="inner"&&(L===O-1?Ae=this.options.reverse?"left":"right":L===0?Ae=this.options.reverse?"right":"left":Ae="center"),s==="top"?y==="near"||k!==0?pe=-me*Q+Q/2:y==="center"?pe=-fe.highest.height/2-Re*Q+Q:pe=-fe.highest.height+Q/2:y==="near"||k!==0?pe=Q/2:y==="center"?pe=fe.highest.height/2-Re*Q:pe=fe.highest.height-me*Q,w&&(pe*=-1),k!==0&&!Ce.showLabelBackdrop&&(G+=Q/2*Math.sin(k))):(q=ee,pe=(1-me)*Q/2);let ne;if(Ce.showLabelBackdrop){const Ee=ws(Ce.backdropPadding),Ye=fe.heights[L],Xe=fe.widths[L];let Ke=pe-Ee.top,Ue=0-Ee.left;switch(be){case"middle":Ke-=Ye/2;break;case"bottom":Ke-=Ye;break}switch(X){case"center":Ue-=Xe/2;break;case"right":Ue-=Xe;break}ne={left:Ue,top:Ke,width:Xe+Ee.width,height:Ye+Ee.height,color:Ce.backdropColor}}D.push({label:B,font:V,textOffset:pe,options:{rotation:k,color:He,strokeColor:ue,strokeWidth:ye,textAlign:Ae,textBaseline:be,translation:[G,q],backdrop:ne}})}return D}_getXAxisLabelAlignment(){const{position:e,ticks:a}=this.options;if(-ou(this.labelRotation))return e==="top"?"left":"right";let s="center";return a.align==="start"?s="left":a.align==="end"?s="right":a.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:a,ticks:{crossAlign:o,mirror:s,padding:c}}=this.options,d=this._getLabelSizes(),f=e+c,m=d.widest.width;let y,_;return a==="left"?s?(_=this.right+c,o==="near"?y="left":o==="center"?(y="center",_+=m/2):(y="right",_+=m)):(_=this.right-f,o==="near"?y="right":o==="center"?(y="center",_-=m/2):(y="left",_=this.left)):a==="right"?s?(_=this.left+c,o==="near"?y="right":o==="center"?(y="center",_-=m/2):(y="left",_-=m)):(_=this.left+f,o==="near"?y="left":o==="center"?(y="center",_+=m/2):(y="right",_=this.right)):y="right",{textAlign:y,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:a},left:o,top:s,width:c,height:d}=this;a&&(e.save(),e.fillStyle=a,e.fillRect(o,s,c,d),e.restore())}getLineWidthForValue(e){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const s=this.ticks.findIndex(c=>c.value===e);return s>=0?a.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const a=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let c,d;const f=(m,y,_)=>{!_.width||!_.color||(o.save(),o.lineWidth=_.width,o.strokeStyle=_.color,o.setLineDash(_.borderDash||[]),o.lineDashOffset=_.borderDashOffset,o.beginPath(),o.moveTo(m.x,m.y),o.lineTo(y.x,y.y),o.stroke(),o.restore())};if(a.display)for(c=0,d=s.length;c<d;++c){const m=s[c];a.drawOnChartArea&&f({x:m.x1,y:m.y1},{x:m.x2,y:m.y2},m),a.drawTicks&&f({x:m.tx1,y:m.ty1},{x:m.tx2,y:m.ty2},{color:m.tickColor,width:m.tickWidth,borderDash:m.tickBorderDash,borderDashOffset:m.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:a,options:{border:o,grid:s}}=this,c=o.setContext(this.getContext()),d=o.display?c.width:0;if(!d)return;const f=s.setContext(this.getContext(0)).lineWidth,m=this._borderValue;let y,_,w,A;this.isHorizontal()?(y=Vm(e,this.left,d)-d/2,_=Vm(e,this.right,f)+f/2,w=A=m):(w=Vm(e,this.top,d)-d/2,A=Vm(e,this.bottom,f)+f/2,y=_=m),a.save(),a.lineWidth=c.width,a.strokeStyle=c.color,a.beginPath(),a.moveTo(y,w),a.lineTo(_,A),a.stroke(),a.restore()}drawLabels(e){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&QT(o,s);const c=this.getLabelItems(e);for(const d of c){const f=d.options,m=d.font,y=d.label,_=d.textOffset;Fg(o,y,0,_,m,f)}s&&eC(o)}drawTitle(){const{ctx:e,options:{position:a,title:o,reverse:s}}=this;if(!o.display)return;const c=Po(o.font),d=ws(o.padding),f=o.align;let m=c.lineHeight/2;a==="bottom"||a==="center"||Ka(a)?(m+=d.bottom,or(o.text)&&(m+=c.lineHeight*(o.text.length-1))):m+=d.top;const{titleX:y,titleY:_,maxWidth:w,rotation:A}=dCe(this,m,a,f);Fg(e,o.text,0,0,c,{color:o.color,maxWidth:w,rotation:A,textAlign:uCe(f,a,s),textBaseline:"middle",translation:[y,_]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,a=e.ticks&&e.ticks.z||0,o=za(e.grid&&e.grid.z,-1),s=za(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==$g.prototype.draw?[{z:a,draw:c=>{this.draw(c)}}]:[{z:o,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:a,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(e){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let c,d;for(c=0,d=a.length;c<d;++c){const f=a[c];f[o]===this.id&&(!e||f.type===e)&&s.push(f)}return s}_resolveTickFontOptions(e){const a=this.options.ticks.setContext(this.getContext(e));return Po(a.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class uA{constructor(e,a,o){this.type=e,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const a=Object.getPrototypeOf(e);let o;pCe(a)&&(o=this.register(a));const s=this.items,c=e.id,d=this.scope+"."+c;if(!c)throw new Error("class does not have id: "+e);return c in s||(s[c]=e,hCe(e,d,o),this.override&&qr.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const a=this.items,o=e.id,s=this.scope;o in a&&delete a[o],s&&o in qr[s]&&(delete qr[s][o],this.override&&delete zg[o])}}function hCe(n,e,a){const o=aw(Object.create(null),[a?qr.get(a):{},qr.get(e),n.defaults]);qr.set(e,o),n.defaultRoutes&&fCe(e,n.defaultRoutes),n.descriptors&&qr.describe(e,n.descriptors)}function fCe(n,e){Object.keys(e).forEach(a=>{const o=a.split("."),s=o.pop(),c=[n].concat(o).join("."),d=e[a].split("."),f=d.pop(),m=d.join(".");qr.route(c,s,m,f)})}function pCe(n){return"id"in n&&"defaults"in n}class mCe{constructor(){this.controllers=new uA(cu,"datasets",!0),this.elements=new uA(fu,"elements"),this.plugins=new uA(Object,"plugins"),this.scales=new uA($g,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,a,o){[...a].forEach(s=>{const c=o||this._getRegistryForType(s);o||c.isForType(s)||c===this.plugins&&s.id?this._exec(e,c,s):zi(s,d=>{const f=o||this._getRegistryForType(d);this._exec(e,f,d)})})}_exec(e,a,o){const s=F6(e);Qi(o["before"+s],[],o),a[e](o),Qi(o["after"+s],[],o)}_getRegistryForType(e){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(e))return o}return this.plugins}_get(e,a,o){const s=a.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+o+".");return s}}var ed=new mCe;class gCe{constructor(){this._init=[]}notify(e,a,o,s){a==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const c=s?this._descriptors(e).filter(s):this._descriptors(e),d=this._notify(c,e,a,o);return a==="afterDestroy"&&(this._notify(c,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,a,o,s){s=s||{};for(const c of e){const d=c.plugin,f=d[o],m=[a,s,c.options];if(Qi(f,m,d)===!1&&s.cancelable)return!1}return!0}invalidate(){li(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),a}_createDescriptors(e,a){const o=e&&e.config,s=za(o.options&&o.options.plugins,{}),c=yCe(o);return s===!1&&!a?[]:_Ce(e,c,s,a)}_notifyStateChanges(e){const a=this._oldCache||[],o=this._cache,s=(c,d)=>c.filter(f=>!d.some(m=>f.plugin.id===m.plugin.id));this._notify(s(a,o),e,"stop"),this._notify(s(o,a),e,"start")}}function yCe(n){const e={},a=[],o=Object.keys(ed.plugins.items);for(let c=0;c<o.length;c++)a.push(ed.getPlugin(o[c]));const s=n.plugins||[];for(let c=0;c<s.length;c++){const d=s[c];a.indexOf(d)===-1&&(a.push(d),e[d.id]=!0)}return{plugins:a,localIds:e}}function vCe(n,e){return!e&&n===!1?null:n===!0?{}:n}function _Ce(n,{plugins:e,localIds:a},o,s){const c=[],d=n.getContext();for(const f of e){const m=f.id,y=vCe(o[m],s);y!==null&&c.push({plugin:f,options:bCe(n.config,{plugin:f,local:a[m]},y,d)})}return c}function bCe(n,{plugin:e,local:a},o,s){const c=n.pluginScopeKeys(e),d=n.getOptionScopes(o,c);return a&&e.defaults&&d.push(e.defaults),n.createResolver(d,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function BR(n,e){const a=qr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||a.indexAxis||"x"}function xCe(n,e){let a=n;return n==="_index_"?a=e:n==="_value_"&&(a=e==="x"?"y":"x"),a}function wCe(n,e){return n===e?"_index_":"_value_"}function QG(n){if(n==="x"||n==="y"||n==="r")return n}function SCe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function UR(n,...e){if(QG(n))return n;for(const a of e){const o=a.axis||SCe(a.position)||n.length>1&&QG(n[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function eH(n,e,a){if(a[e+"AxisID"]===n)return{axis:e}}function ACe(n,e){if(e.data&&e.data.datasets){const a=e.data.datasets.filter(o=>o.xAxisID===n||o.yAxisID===n);if(a.length)return eH(n,"x",a[0])||eH(n,"y",a[0])}return{}}function ECe(n,e){const a=zg[n.type]||{scales:{}},o=e.scales||{},s=BR(n.type,e),c=Object.create(null);return Object.keys(o).forEach(d=>{const f=o[d];if(!Ka(f))return console.error(`Invalid scale configuration for scale: ${d}`);if(f._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const m=UR(d,f,ACe(d,n),qr.scales[f.type]),y=wCe(m,s),_=a.scales||{};c[d]=nx(Object.create(null),[{axis:m},f,_[m],_[y]])}),n.data.datasets.forEach(d=>{const f=d.type||n.type,m=d.indexAxis||BR(f,e),_=(zg[f]||{}).scales||{};Object.keys(_).forEach(w=>{const A=xCe(w,m),C=d[A+"AxisID"]||A;c[C]=c[C]||Object.create(null),nx(c[C],[{axis:A},o[C],_[w]])})}),Object.keys(c).forEach(d=>{const f=c[d];nx(f,[qr.scales[f.type],qr.scale])}),c}function wJ(n){const e=n.options||(n.options={});e.plugins=za(e.plugins,{}),e.scales=ECe(n,e)}function SJ(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function MCe(n){return n=n||{},n.data=SJ(n.data),wJ(n),n}const tH=new Map,AJ=new Set;function dA(n,e){let a=tH.get(n);return a||(a=e(),tH.set(n,a),AJ.add(a)),a}const fb=(n,e,a)=>{const o=bp(e,a);o!==void 0&&n.add(o)};class TCe{constructor(e){this._config=MCe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=SJ(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),wJ(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return dA(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,a){return dA(`${e}.transition.${a}`,()=>[[`datasets.${e}.transitions.${a}`,`transitions.${a}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,a){return dA(`${e}-${a}`,()=>[[`datasets.${e}.elements.${a}`,`datasets.${e}`,`elements.${a}`,""]])}pluginScopeKeys(e){const a=e.id,o=this.type;return dA(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,a){const o=this._scopeCache;let s=o.get(e);return(!s||a)&&(s=new Map,o.set(e,s)),s}getOptionScopes(e,a,o){const{options:s,type:c}=this,d=this._cachedScopes(e,o),f=d.get(a);if(f)return f;const m=new Set;a.forEach(_=>{e&&(m.add(e),_.forEach(w=>fb(m,e,w))),_.forEach(w=>fb(m,s,w)),_.forEach(w=>fb(m,zg[c]||{},w)),_.forEach(w=>fb(m,qr,w)),_.forEach(w=>fb(m,zR,w))});const y=Array.from(m);return y.length===0&&y.push(Object.create(null)),AJ.has(a)&&d.set(a,y),y}chartOptionScopes(){const{options:e,type:a}=this;return[e,zg[a]||{},qr.datasets[a]||{},{type:a},qr,zR]}resolveNamedOptions(e,a,o,s=[""]){const c={$shared:!0},{resolver:d,subPrefixes:f}=nH(this._resolverCache,e,s);let m=d;if(PCe(d,a)){c.$shared=!1,o=xp(o)?o():o;const y=this.createResolver(e,o,f);m=a_(d,o,y)}for(const y of a)c[y]=m[y];return c}createResolver(e,a,o=[""],s){const{resolver:c}=nH(this._resolverCache,e,o);return Ka(a)?a_(c,a,void 0,s):c}}function nH(n,e,a){let o=n.get(e);o||(o=new Map,n.set(e,o));const s=a.join();let c=o.get(s);return c||(c={resolver:G6(e,a),subPrefixes:a.filter(f=>!f.toLowerCase().includes("hover"))},o.set(s,c)),c}const CCe=n=>Ka(n)&&Object.getOwnPropertyNames(n).reduce((e,a)=>e||xp(n[a]),!1);function PCe(n,e){const{isScriptable:a,isIndexable:o}=nJ(n);for(const s of e){const c=a(s),d=o(s),f=(d||c)&&n[s];if(c&&(xp(f)||CCe(f))||d&&or(f))return!0}return!1}var ICe="4.4.0";const LCe=["top","bottom","left","right","chartArea"];function aH(n,e){return n==="top"||n==="bottom"||LCe.indexOf(n)===-1&&e==="x"}function iH(n,e){return function(a,o){return a[n]===o[n]?a[e]-o[e]:a[n]-o[n]}}function rH(n){const e=n.chart,a=e.options.animation;e.notifyPlugins("afterRender"),Qi(a&&a.onComplete,[n],e)}function RCe(n){const e=n.chart,a=e.options.animation;Qi(a&&a.onProgress,[n],e)}function EJ(n){return lJ()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const YA={},oH=n=>{const e=EJ(n);return Object.values(YA).filter(a=>a.canvas===e).pop()};function kCe(n,e,a){const o=Object.keys(n);for(const s of o){const c=+s;if(c>=e){const d=n[s];delete n[s],(a>0||c>e)&&(n[c+a]=d)}}}function DCe(n,e,a,o){return!a||n.type==="mouseout"?null:o?e:n}function hA(n,e,a){return n.options.clip?n[a]:e[a]}function OCe(n,e){const{xScale:a,yScale:o}=n;return a&&o?{left:hA(a,e,"left"),right:hA(a,e,"right"),top:hA(o,e,"top"),bottom:hA(o,e,"bottom")}:e}var Nf;let Vw=(Nf=class{static register(...e){ed.add(...e),sH()}static unregister(...e){ed.remove(...e),sH()}constructor(e,a){const o=this.config=new TCe(a),s=EJ(e),c=oH(s);if(c)throw new Error("Canvas is already in use. Chart with ID '"+c.id+"' must be destroyed before the canvas with ID '"+c.canvas.id+"' can be reused.");const d=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||JTe(s)),this.platform.updateConfig(o);const f=this.platform.acquireContext(s,d.aspectRatio),m=f&&f.canvas,y=m&&m.height,_=m&&m.width;if(this.id=FEe(),this.ctx=f,this.canvas=m,this.width=_,this.height=y,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new gCe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=QEe(w=>this.update(w),d.resizeDelay||0),this._dataChanges=[],YA[this.id]=this,!f||!m){console.error("Failed to create chart: can't acquire context from the given item");return}hh.listen(this,"complete",rH),hh.listen(this,"progress",RCe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:a},width:o,height:s,_aspectRatio:c}=this;return li(e)?a&&c?c:s?o/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ed}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():CG(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return EG(this.canvas,this.ctx),this}stop(){return hh.stop(this),this}resize(e,a){hh.running(this)?this._resizeBeforeDraw={width:e,height:a}:this._resize(e,a)}_resize(e,a){const o=this.options,s=this.canvas,c=o.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(s,e,a,c),f=o.devicePixelRatio||this.platform.getDevicePixelRatio(),m=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,CG(this,f,!0)&&(this.notifyPlugins("resize",{size:d}),Qi(o.onResize,[this,d],this),this.attached&&this._doResize(m)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};zi(a,(o,s)=>{o.id=s})}buildOrUpdateScales(){const e=this.options,a=e.scales,o=this.scales,s=Object.keys(o).reduce((d,f)=>(d[f]=!1,d),{});let c=[];a&&(c=c.concat(Object.keys(a).map(d=>{const f=a[d],m=UR(d,f),y=m==="r",_=m==="x";return{options:f,dposition:y?"chartArea":_?"bottom":"left",dtype:y?"radialLinear":_?"category":"linear"}}))),zi(c,d=>{const f=d.options,m=f.id,y=UR(m,f),_=za(f.type,d.dtype);(f.position===void 0||aH(f.position,y)!==aH(d.dposition))&&(f.position=d.dposition),s[m]=!0;let w=null;if(m in o&&o[m].type===_)w=o[m];else{const A=ed.getScale(_);w=new A({id:m,type:_,ctx:this.ctx,chart:this}),o[w.id]=w}w.init(f,e)}),zi(s,(d,f)=>{d||delete o[f]}),zi(o,d=>{ys.configure(this,d,d.options),ys.addBox(this,d)})}_updateMetasets(){const e=this._metasets,a=this.data.datasets.length,o=e.length;if(e.sort((s,c)=>s.index-c.index),o>a){for(let s=a;s<o;++s)this._destroyDatasetMeta(s);e.splice(a,o-a)}this._sortedMetasets=e.slice(0).sort(iH("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:a}}=this;e.length>a.length&&delete this._stacks,e.forEach((o,s)=>{a.filter(c=>c===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],a=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=a.length;o<s;o++){const c=a[o];let d=this.getDatasetMeta(o);const f=c.type||this.config.type;if(d.type&&d.type!==f&&(this._destroyDatasetMeta(o),d=this.getDatasetMeta(o)),d.type=f,d.indexAxis=c.indexAxis||BR(f,this.options),d.order=c.order||0,d.index=o,d.label=""+c.label,d.visible=this.isDatasetVisible(o),d.controller)d.controller.updateIndex(o),d.controller.linkScales();else{const m=ed.getController(f),{datasetElementType:y,dataElementType:_}=qr.datasets[f];Object.assign(m,{dataElementType:ed.getElement(_),datasetElementType:y&&ed.getElement(y)}),d.controller=new m(this,o),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){zi(this.data.datasets,(e,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const c=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let y=0,_=this.data.datasets.length;y<_;y++){const{controller:w}=this.getDatasetMeta(y),A=!s&&c.indexOf(w)===-1;w.buildOrUpdateElements(A),d=Math.max(+w.getMaxOverflow(),d)}d=this._minPadding=o.layout.autoPadding?d:0,this._updateLayout(d),s||zi(c,y=>{y.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(iH("z","_idx"));const{_active:f,_lastEvent:m}=this;m?this._eventHandler(m,!0):f.length&&this._updateHoverStyles(f,f,!0),this.render()}_updateScales(){zi(this.scales,e=>{ys.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(e.events);(!gG(a,o)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:c}of a){const d=o==="_removeElements"?-c:c;kCe(e,s,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=c=>new Set(e.filter(d=>d[0]===c).map((d,f)=>f+","+d.splice(1).join(","))),s=o(0);for(let c=1;c<a;c++)if(!gG(s,o(c)))return;return Array.from(s).map(c=>c.split(",")).map(c=>({method:c[1],start:+c[2],count:+c[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ys.update(this,this.width,this.height,e);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],zi(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,c)=>{s._idx=c}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,xp(e)?e({datasetIndex:a}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,a){const o=this.getDatasetMeta(e),s={meta:o,index:e,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(a),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(hh.has(this)?this.attached&&!hh.running(this)&&hh.start(this):(this.draw(),rH({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resize(o,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(e=0;e<a.length&&a[e].z<=0;++e)a[e].draw(this.chartArea);for(this._drawDatasets();e<a.length;++e)a[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const a=this._sortedMetasets,o=[];let s,c;for(s=0,c=a.length;s<c;++s){const d=a[s];(!e||d.visible)&&o.push(d)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let a=e.length-1;a>=0;--a)this._drawDataset(e[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const a=this.ctx,o=e._clip,s=!o.disabled,c=OCe(e,this.chartArea),d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(s&&QT(a,{left:o.left===!1?0:c.left-o.left,right:o.right===!1?this.width:c.right+o.right,top:o.top===!1?0:c.top-o.top,bottom:o.bottom===!1?this.height:c.bottom+o.bottom}),e.controller.draw(),s&&eC(a),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return Th(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,a,o,s){const c=LTe.modes[a];return typeof c=="function"?c(this,e,o,s):[]}getDatasetMeta(e){const a=this.data.datasets[e],o=this._metasets;let s=o.filter(c=>c&&c._dataset===a).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:e,_dataset:a,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=Pp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const a=this.data.datasets[e];if(!a)return!1;const o=this.getDatasetMeta(e);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(e,a){const o=this.getDatasetMeta(e);o.hidden=!a}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,a,o){const s=o?"show":"hide",c=this.getDatasetMeta(e),d=c.controller._resolveAnimations(void 0,s);iw(a)?(c.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(e,o),d.update(c,{visible:o}),this.update(f=>f.datasetIndex===e?s:void 0))}hide(e,a){this._updateVisibility(e,a,!1)}show(e,a){this._updateVisibility(e,a,!0)}_destroyDatasetMeta(e){const a=this._metasets[e];a&&a.controller&&a.controller._destroy(),delete this._metasets[e]}_stop(){let e,a;for(this.stop(),hh.remove(this),e=0,a=this.data.datasets.length;e<a;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:a}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),EG(e,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete YA[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,a=this.platform,o=(c,d)=>{a.addEventListener(this,c,d),e[c]=d},s=(c,d,f)=>{c.offsetX=d,c.offsetY=f,this._eventHandler(c)};zi(this.options.events,c=>o(c,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,a=this.platform,o=(m,y)=>{a.addEventListener(this,m,y),e[m]=y},s=(m,y)=>{e[m]&&(a.removeEventListener(this,m,y),delete e[m])},c=(m,y)=>{this.canvas&&this.resize(m,y)};let d;const f=()=>{s("attach",f),this.attached=!0,this.resize(),o("resize",c),o("detach",d)};d=()=>{this.attached=!1,s("resize",c),this._stop(),this._resize(0,0),o("attach",f)},a.isAttached(this.canvas)?f():d()}unbindEvents(){zi(this._listeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._listeners={},zi(this._responsiveListeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,a,o){const s=o?"set":"remove";let c,d,f,m;for(a==="dataset"&&(c=this.getDatasetMeta(e[0].datasetIndex),c.controller["_"+s+"DatasetHoverStyle"]()),f=0,m=e.length;f<m;++f){d=e[f];const y=d&&this.getDatasetMeta(d.datasetIndex).controller;y&&y[s+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const a=this._active||[],o=e.map(({datasetIndex:c,index:d})=>{const f=this.getDatasetMeta(c);if(!f)throw new Error("No dataset found at index "+c);return{datasetIndex:c,element:f.data[d],index:d}});!eM(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(e,a,o){return this._plugins.notify(this,e,a,o)}isPluginEnabled(e){return this._plugins._cache.filter(a=>a.plugin.id===e).length===1}_updateHoverStyles(e,a,o){const s=this.options.hover,c=(m,y)=>m.filter(_=>!y.some(w=>_.datasetIndex===w.datasetIndex&&_.index===w.index)),d=c(a,e),f=o?e:c(e,a);d.length&&this.updateHoverStyle(d,s.mode,!1),f.length&&s.mode&&this.updateHoverStyle(f,s.mode,!0)}_eventHandler(e,a){const o={event:e,replay:a,cancelable:!0,inChartArea:this.isPointInArea(e)},s=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const c=this._handleEvent(e,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(c||o.changed)&&this.render(),this}_handleEvent(e,a,o){const{_active:s=[],options:c}=this,d=a,f=this._getActiveElements(e,s,o,d),m=GEe(e),y=DCe(e,this._lastEvent,o,m);o&&(this._lastEvent=null,Qi(c.onHover,[e,f,this],this),m&&Qi(c.onClick,[e,f,this],this));const _=!eM(f,s);return(_||a)&&(this._active=f,this._updateHoverStyles(f,s,a)),this._lastEvent=y,_}_getActiveElements(e,a,o,s){if(e.type==="mouseout")return[];if(!o)return a;const c=this.options.hover;return this.getElementsAtEventForMode(e,c.mode,c,s)}},_n(Nf,"defaults",qr),_n(Nf,"instances",YA),_n(Nf,"overrides",zg),_n(Nf,"registry",ed),_n(Nf,"version",ICe),_n(Nf,"getChart",oH),Nf);function sH(){return zi(Vw.instances,n=>n._plugins.invalidate())}function zCe(n,e,a){const{startAngle:o,pixelMargin:s,x:c,y:d,outerRadius:f,innerRadius:m}=e;let y=s/f;n.beginPath(),n.arc(c,d,f,o-y,a+y),m>s?(y=s/m,n.arc(c,d,m,a+y,o-y,!0)):n.arc(c,d,s,a+so,o-so),n.closePath(),n.clip()}function FCe(n){return V6(n,["outerStart","outerEnd","innerStart","innerEnd"])}function NCe(n,e,a,o){const s=FCe(n.options.borderRadius),c=(a-e)/2,d=Math.min(c,o*e/2),f=m=>{const y=(a-Math.min(c,m))*o/2;return Fo(m,0,Math.min(c,y))};return{outerStart:f(s.outerStart),outerEnd:f(s.outerEnd),innerStart:Fo(s.innerStart,0,d),innerEnd:Fo(s.innerEnd,0,d)}}function Jv(n,e,a,o){return{x:a+n*Math.cos(e),y:o+n*Math.sin(e)}}function oM(n,e,a,o,s,c){const{x:d,y:f,startAngle:m,pixelMargin:y,innerRadius:_}=e,w=Math.max(e.outerRadius+o+a-y,0),A=_>0?_+o+a+y:0;let C=0;const I=s-m;if(o){const Ce=_>0?_-o:0,Re=w>0?w-o:0,He=(Ce+Re)/2,ue=He!==0?I*He/(He+o):I;C=(I-ue)/2}const k=Math.max(.001,I*w-a/cr)/w,D=(I-k)/2,L=m+D+C,O=s-D-C,{outerStart:F,outerEnd:B,innerStart:G,innerEnd:q}=NCe(e,A,w,O-L),X=w-F,ee=w-B,V=L+F/X,Q=O-B/ee,me=A+G,pe=A+q,be=L+G/me,fe=O-q/pe;if(n.beginPath(),c){const Ce=(V+Q)/2;if(n.arc(d,f,w,V,Ce),n.arc(d,f,w,Ce,Q),B>0){const ye=Jv(ee,Q,d,f);n.arc(ye.x,ye.y,B,Q,O+so)}const Re=Jv(pe,O,d,f);if(n.lineTo(Re.x,Re.y),q>0){const ye=Jv(pe,fe,d,f);n.arc(ye.x,ye.y,q,O+so,fe+Math.PI)}const He=(O-q/A+(L+G/A))/2;if(n.arc(d,f,A,O-q/A,He,!0),n.arc(d,f,A,He,L+G/A,!0),G>0){const ye=Jv(me,be,d,f);n.arc(ye.x,ye.y,G,be+Math.PI,L-so)}const ue=Jv(X,L,d,f);if(n.lineTo(ue.x,ue.y),F>0){const ye=Jv(X,V,d,f);n.arc(ye.x,ye.y,F,L-so,V)}}else{n.moveTo(d,f);const Ce=Math.cos(V)*w+d,Re=Math.sin(V)*w+f;n.lineTo(Ce,Re);const He=Math.cos(Q)*w+d,ue=Math.sin(Q)*w+f;n.lineTo(He,ue)}n.closePath()}function BCe(n,e,a,o,s){const{fullCircles:c,startAngle:d,circumference:f}=e;let m=e.endAngle;if(c){oM(n,e,a,o,m,s);for(let y=0;y<c;++y)n.fill();isNaN(f)||(m=d+(f%lr||lr))}return oM(n,e,a,o,m,s),n.fill(),m}function UCe(n,e,a,o,s){const{fullCircles:c,startAngle:d,circumference:f,options:m}=e,{borderWidth:y,borderJoinStyle:_,borderDash:w,borderDashOffset:A}=m,C=m.borderAlign==="inner";if(!y)return;n.setLineDash(w||[]),n.lineDashOffset=A,C?(n.lineWidth=y*2,n.lineJoin=_||"round"):(n.lineWidth=y,n.lineJoin=_||"bevel");let I=e.endAngle;if(c){oM(n,e,a,o,I,s);for(let k=0;k<c;++k)n.stroke();isNaN(f)||(I=d+(f%lr||lr))}C&&zCe(n,e,I),c||(oM(n,e,a,o,I,s),n.stroke())}class Cb extends fu{constructor(a){super();_n(this,"circumference");_n(this,"endAngle");_n(this,"fullCircles");_n(this,"innerRadius");_n(this,"outerRadius");_n(this,"pixelMargin");_n(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,a&&Object.assign(this,a)}inRange(a,o,s){const c=this.getProps(["x","y"],s),{angle:d,distance:f}=$K(c,{x:a,y:o}),{startAngle:m,endAngle:y,innerRadius:_,outerRadius:w,circumference:A}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),C=(this.options.spacing+this.options.borderWidth)/2,k=za(A,y-m)>=lr||rw(d,m,y),D=Eh(f,_+C,w+C);return k&&D}getCenterPoint(a){const{x:o,y:s,startAngle:c,endAngle:d,innerRadius:f,outerRadius:m}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],a),{offset:y,spacing:_}=this.options,w=(c+d)/2,A=(f+m+_+y)/2;return{x:o+Math.cos(w)*A,y:s+Math.sin(w)*A}}tooltipPosition(a){return this.getCenterPoint(a)}draw(a){const{options:o,circumference:s}=this,c=(o.offset||0)/4,d=(o.spacing||0)/2,f=o.circular;if(this.pixelMargin=o.borderAlign==="inner"?.33:0,this.fullCircles=s>lr?Math.floor(s/lr):0,s===0||this.innerRadius<0||this.outerRadius<0)return;a.save();const m=(this.startAngle+this.endAngle)/2;a.translate(Math.cos(m)*c,Math.sin(m)*c);const y=1-Math.sin(Math.min(cr,s||0)),_=c*y;a.fillStyle=o.backgroundColor,a.strokeStyle=o.borderColor,BCe(a,this,_,d,f),UCe(a,this,_,d,f),a.restore()}}_n(Cb,"id","arc"),_n(Cb,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),_n(Cb,"defaultRoutes",{backgroundColor:"backgroundColor"}),_n(Cb,"descriptors",{_scriptable:!0,_indexable:a=>a!=="borderDash"});function MJ(n,e,a=e){n.lineCap=za(a.borderCapStyle,e.borderCapStyle),n.setLineDash(za(a.borderDash,e.borderDash)),n.lineDashOffset=za(a.borderDashOffset,e.borderDashOffset),n.lineJoin=za(a.borderJoinStyle,e.borderJoinStyle),n.lineWidth=za(a.borderWidth,e.borderWidth),n.strokeStyle=za(a.borderColor,e.borderColor)}function WCe(n,e,a){n.lineTo(a.x,a.y)}function VCe(n){return n.stepped?dMe:n.tension||n.cubicInterpolationMode==="monotone"?hMe:WCe}function TJ(n,e,a={}){const o=n.length,{start:s=0,end:c=o-1}=a,{start:d,end:f}=e,m=Math.max(s,d),y=Math.min(c,f),_=s<d&&c<d||s>f&&c>f;return{count:o,start:m,loop:e.loop,ilen:y<m&&!_?o+y-m:y-m}}function GCe(n,e,a,o){const{points:s,options:c}=e,{count:d,start:f,loop:m,ilen:y}=TJ(s,a,o),_=VCe(c);let{move:w=!0,reverse:A}=o||{},C,I,k;for(C=0;C<=y;++C)I=s[(f+(A?y-C:C))%d],!I.skip&&(w?(n.moveTo(I.x,I.y),w=!1):_(n,k,I,A,c.stepped),k=I);return m&&(I=s[(f+(A?y:0))%d],_(n,k,I,A,c.stepped)),!!m}function HCe(n,e,a,o){const s=e.points,{count:c,start:d,ilen:f}=TJ(s,a,o),{move:m=!0,reverse:y}=o||{};let _=0,w=0,A,C,I,k,D,L;const O=B=>(d+(y?f-B:B))%c,F=()=>{k!==D&&(n.lineTo(_,D),n.lineTo(_,k),n.lineTo(_,L))};for(m&&(C=s[O(0)],n.moveTo(C.x,C.y)),A=0;A<=f;++A){if(C=s[O(A)],C.skip)continue;const B=C.x,G=C.y,q=B|0;q===I?(G<k?k=G:G>D&&(D=G),_=(w*_+B)/++w):(F(),n.lineTo(B,G),I=q,w=0,k=D=G),L=G}F()}function WR(n){const e=n.options,a=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!a?HCe:GCe}function jCe(n){return n.stepped?HMe:n.tension||n.cubicInterpolationMode==="monotone"?jMe:tg}function $Ce(n,e,a,o){let s=e._path;s||(s=e._path=new Path2D,e.path(s,a,o)&&s.closePath()),MJ(n,e.options),n.stroke(s)}function qCe(n,e,a,o){const{segments:s,options:c}=e,d=WR(e);for(const f of s)MJ(n,c,f.style),n.beginPath(),d(n,e,f,{start:a,end:a+o-1})&&n.closePath(),n.stroke()}const XCe=typeof Path2D=="function";function ZCe(n,e,a,o){XCe&&!e.options.segment?$Ce(n,e,a,o):qCe(n,e,a,o)}class Kf extends fu{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,a){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;zMe(this._points,o,e,s,a),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=KMe(this,this.options.segment))}first(){const e=this.segments,a=this.points;return e.length&&a[e[0].start]}last(){const e=this.segments,a=this.points,o=e.length;return o&&a[e[o-1].end]}interpolate(e,a){const o=this.options,s=e[a],c=this.points,d=fJ(this,{property:a,start:s,end:s});if(!d.length)return;const f=[],m=jCe(o);let y,_;for(y=0,_=d.length;y<_;++y){const{start:w,end:A}=d[y],C=c[w],I=c[A];if(C===I){f.push(C);continue}const k=Math.abs((s-C[a])/(I[a]-C[a])),D=m(C,I,k,o.stepped);D[a]=e[a],f.push(D)}return f.length===1?f[0]:f}pathSegment(e,a,o){return WR(this)(e,this,a,o)}path(e,a,o){const s=this.segments,c=WR(this);let d=this._loop;a=a||0,o=o||this.points.length-a;for(const f of s)d&=c(e,this,f,{start:a,end:a+o-1});return!!d}draw(e,a,o,s){const c=this.options||{};(this.points||[]).length&&c.borderWidth&&(e.save(),ZCe(e,this,o,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}_n(Kf,"id","line"),_n(Kf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),_n(Kf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),_n(Kf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function lH(n,e,a,o){const s=n.options,{[a]:c}=n.getProps([a],o);return Math.abs(e-c)<s.radius+s.hitRadius}class KA extends fu{constructor(a){super();_n(this,"parsed");_n(this,"skip");_n(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,a&&Object.assign(this,a)}inRange(a,o,s){const c=this.options,{x:d,y:f}=this.getProps(["x","y"],s);return Math.pow(a-d,2)+Math.pow(o-f,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(a,o){return lH(this,a,"x",o)}inYRange(a,o){return lH(this,a,"y",o)}getCenterPoint(a){const{x:o,y:s}=this.getProps(["x","y"],a);return{x:o,y:s}}size(a){a=a||this.options||{};let o=a.radius||0;o=Math.max(o,o&&a.hoverRadius||0);const s=o&&a.borderWidth||0;return(o+s)*2}draw(a,o){const s=this.options;this.skip||s.radius<.1||!Th(this,o,this.size(s)/2)||(a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.fillStyle=s.backgroundColor,FR(a,s,this.x,this.y))}getRange(){const a=this.options||{};return a.radius+a.hitRadius}}_n(KA,"id","point"),_n(KA,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),_n(KA,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function CJ(n,e){const{x:a,y:o,base:s,width:c,height:d}=n.getProps(["x","y","base","width","height"],e);let f,m,y,_,w;return n.horizontal?(w=d/2,f=Math.min(a,s),m=Math.max(a,s),y=o-w,_=o+w):(w=c/2,f=a-w,m=a+w,y=Math.min(o,s),_=Math.max(o,s)),{left:f,top:y,right:m,bottom:_}}function Jf(n,e,a,o){return n?0:Fo(e,a,o)}function YCe(n,e,a){const o=n.options.borderWidth,s=n.borderSkipped,c=tJ(o);return{t:Jf(s.top,c.top,0,a),r:Jf(s.right,c.right,0,e),b:Jf(s.bottom,c.bottom,0,a),l:Jf(s.left,c.left,0,e)}}function KCe(n,e,a){const{enableBorderRadius:o}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,c=wg(s),d=Math.min(e,a),f=n.borderSkipped,m=o||Ka(s);return{topLeft:Jf(!m||f.top||f.left,c.topLeft,0,d),topRight:Jf(!m||f.top||f.right,c.topRight,0,d),bottomLeft:Jf(!m||f.bottom||f.left,c.bottomLeft,0,d),bottomRight:Jf(!m||f.bottom||f.right,c.bottomRight,0,d)}}function JCe(n){const e=CJ(n),a=e.right-e.left,o=e.bottom-e.top,s=YCe(n,a/2,o/2),c=KCe(n,a/2,o/2);return{outer:{x:e.left,y:e.top,w:a,h:o,radius:c},inner:{x:e.left+s.l,y:e.top+s.t,w:a-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,c.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,c.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,c.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,c.bottomRight-Math.max(s.b,s.r))}}}}function pI(n,e,a,o){const s=e===null,c=a===null,f=n&&!(s&&c)&&CJ(n,o);return f&&(s||Eh(e,f.left,f.right))&&(c||Eh(a,f.top,f.bottom))}function QCe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function ePe(n,e){n.rect(e.x,e.y,e.w,e.h)}function mI(n,e,a={}){const o=n.x!==a.x?-e:0,s=n.y!==a.y?-e:0,c=(n.x+n.w!==a.x+a.w?e:0)-o,d=(n.y+n.h!==a.y+a.h?e:0)-s;return{x:n.x+o,y:n.y+s,w:n.w+c,h:n.h+d,radius:n.radius}}class JA extends fu{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:a,options:{borderColor:o,backgroundColor:s}}=this,{inner:c,outer:d}=JCe(this),f=QCe(d.radius)?ow:ePe;e.save(),(d.w!==c.w||d.h!==c.h)&&(e.beginPath(),f(e,mI(d,a,c)),e.clip(),f(e,mI(c,-a,d)),e.fillStyle=o,e.fill("evenodd")),e.beginPath(),f(e,mI(c,a)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,a,o){return pI(this,e,a,o)}inXRange(e,a){return pI(this,e,null,a)}inYRange(e,a){return pI(this,null,e,a)}getCenterPoint(e){const{x:a,y:o,base:s,horizontal:c}=this.getProps(["x","y","base","horizontal"],e);return{x:c?(a+s)/2:a,y:c?o:(o+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}_n(JA,"id","bar"),_n(JA,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),_n(JA,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var tPe=Object.freeze({__proto__:null,ArcElement:Cb,BarElement:JA,LineElement:Kf,PointElement:KA});const VR=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],cH=VR.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function PJ(n){return VR[n%VR.length]}function IJ(n){return cH[n%cH.length]}function nPe(n,e){return n.borderColor=PJ(e),n.backgroundColor=IJ(e),++e}function aPe(n,e){return n.backgroundColor=n.data.map(()=>PJ(e++)),e}function iPe(n,e){return n.backgroundColor=n.data.map(()=>IJ(e++)),e}function rPe(n){let e=0;return(a,o)=>{const s=n.getDatasetMeta(o).controller;s instanceof pg?e=aPe(a,e):s instanceof sx?e=iPe(a,e):s&&(e=nPe(a,e))}}function uH(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function oPe(n){return n&&(n.borderColor||n.backgroundColor)}var sPe={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,a){if(!a.enabled)return;const{data:{datasets:o},options:s}=n.config,{elements:c}=s;if(!a.forceOverride&&(uH(o)||oPe(s)||c&&uH(c)))return;const d=rPe(n);o.forEach(d)}};function lPe(n,e,a,o,s){const c=s.samples||o;if(c>=a)return n.slice(e,e+a);const d=[],f=(a-2)/(c-2);let m=0;const y=e+a-1;let _=e,w,A,C,I,k;for(d[m++]=n[_],w=0;w<c-2;w++){let D=0,L=0,O;const F=Math.floor((w+1)*f)+1+e,B=Math.min(Math.floor((w+2)*f)+1,a)+e,G=B-F;for(O=F;O<B;O++)D+=n[O].x,L+=n[O].y;D/=G,L/=G;const q=Math.floor(w*f)+1+e,X=Math.min(Math.floor((w+1)*f)+1,a)+e,{x:ee,y:V}=n[_];for(C=I=-1,O=q;O<X;O++)I=.5*Math.abs((ee-D)*(n[O].y-V)-(ee-n[O].x)*(L-V)),I>C&&(C=I,A=n[O],k=O);d[m++]=A,_=k}return d[m++]=n[y],d}function cPe(n,e,a,o){let s=0,c=0,d,f,m,y,_,w,A,C,I,k;const D=[],L=e+a-1,O=n[e].x,B=n[L].x-O;for(d=e;d<e+a;++d){f=n[d],m=(f.x-O)/B*o,y=f.y;const G=m|0;if(G===_)y<I?(I=y,w=d):y>k&&(k=y,A=d),s=(c*s+f.x)/++c;else{const q=d-1;if(!li(w)&&!li(A)){const X=Math.min(w,A),ee=Math.max(w,A);X!==C&&X!==q&&D.push({...n[X],x:s}),ee!==C&&ee!==q&&D.push({...n[ee],x:s})}d>0&&q!==C&&D.push(n[q]),D.push(f),_=G,c=0,I=k=y,w=A=C=d}}return D}function LJ(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function dH(n){n.data.datasets.forEach(e=>{LJ(e)})}function uPe(n,e){const a=e.length;let o=0,s;const{iScale:c}=n,{min:d,max:f,minDefined:m,maxDefined:y}=c.getUserBounds();return m&&(o=Fo(Mh(e,c.axis,d).lo,0,a-1)),y?s=Fo(Mh(e,c.axis,f).hi+1,o,a)-o:s=a-o,{start:o,count:s}}var dPe={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,a)=>{if(!a.enabled){dH(n);return}const o=n.width;n.data.datasets.forEach((s,c)=>{const{_data:d,indexAxis:f}=s,m=n.getDatasetMeta(c),y=d||s.data;if(Mb([f,n.options.indexAxis])==="y"||!m.controller.supportsDecimation)return;const _=n.scales[m.xAxisID];if(_.type!=="linear"&&_.type!=="time"||n.options.parsing)return;let{start:w,count:A}=uPe(m,y);const C=a.threshold||4*o;if(A<=C){LJ(s);return}li(d)&&(s._data=y,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(k){this._data=k}}));let I;switch(a.algorithm){case"lttb":I=lPe(y,w,A,o,a);break;case"min-max":I=cPe(y,w,A,o);break;default:throw new Error(`Unsupported decimation algorithm '${a.algorithm}'`)}s._decimated=I})},destroy(n){dH(n)}};function hPe(n,e,a){const o=n.segments,s=n.points,c=e.points,d=[];for(const f of o){let{start:m,end:y}=f;y=X6(m,y,s);const _=GR(a,s[m],s[y],f.loop);if(!e.segments){d.push({source:f,target:_,start:s[m],end:s[y]});continue}const w=fJ(e,_);for(const A of w){const C=GR(a,c[A.start],c[A.end],A.loop),I=hJ(f,s,C);for(const k of I)d.push({source:k,target:A,start:{[a]:hH(_,C,"start",Math.max)},end:{[a]:hH(_,C,"end",Math.min)}})}}return d}function GR(n,e,a,o){if(o)return;let s=e[n],c=a[n];return n==="angle"&&(s=Nl(s),c=Nl(c)),{property:n,start:s,end:c}}function fPe(n,e){const{x:a=null,y:o=null}=n||{},s=e.points,c=[];return e.segments.forEach(({start:d,end:f})=>{f=X6(d,f,s);const m=s[d],y=s[f];o!==null?(c.push({x:m.x,y:o}),c.push({x:y.x,y:o})):a!==null&&(c.push({x:a,y:m.y}),c.push({x:a,y:y.y}))}),c}function X6(n,e,a){for(;e>n;e--){const o=a[e];if(!isNaN(o.x)&&!isNaN(o.y))break}return e}function hH(n,e,a,o){return n&&e?o(n[a],e[a]):n?n[a]:e?e[a]:0}function RJ(n,e){let a=[],o=!1;return or(n)?(o=!0,a=n):a=fPe(n,e),a.length?new Kf({points:a,options:{tension:0},_loop:o,_fullLoop:o}):null}function fH(n){return n&&n.fill!==!1}function pPe(n,e,a){let s=n[e].fill;const c=[e];let d;if(!a)return s;for(;s!==!1&&c.indexOf(s)===-1;){if(!$r(s))return s;if(d=n[s],!d)return!1;if(d.visible)return s;c.push(s),s=d.fill}return!1}function mPe(n,e,a){const o=_Pe(n);if(Ka(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return $r(s)&&Math.floor(s)===s?gPe(o[0],e,s,a):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function gPe(n,e,a,o){return(n==="-"||n==="+")&&(a=e+a),a===e||a<0||a>=o?!1:a}function yPe(n,e){let a=null;return n==="start"?a=e.bottom:n==="end"?a=e.top:Ka(n)?a=e.getPixelForValue(n.value):e.getBasePixel&&(a=e.getBasePixel()),a}function vPe(n,e,a){let o;return n==="start"?o=a:n==="end"?o=e.options.reverse?e.min:e.max:Ka(n)?o=n.value:o=e.getBaseValue(),o}function _Pe(n){const e=n.options,a=e.fill;let o=za(a&&a.target,a);return o===void 0&&(o=!!e.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function bPe(n){const{scale:e,index:a,line:o}=n,s=[],c=o.segments,d=o.points,f=xPe(e,a);f.push(RJ({x:null,y:e.bottom},o));for(let m=0;m<c.length;m++){const y=c[m];for(let _=y.start;_<=y.end;_++)wPe(s,d[_],f)}return new Kf({points:s,options:{}})}function xPe(n,e){const a=[],o=n.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const c=o[s];if(c.index===e)break;c.hidden||a.unshift(c.dataset)}return a}function wPe(n,e,a){const o=[];for(let s=0;s<a.length;s++){const c=a[s],{first:d,last:f,point:m}=SPe(c,e,"x");if(!(!m||d&&f)){if(d)o.unshift(m);else if(n.push(m),!f)break}}n.push(...o)}function SPe(n,e,a){const o=n.interpolate(e,a);if(!o)return{};const s=o[a],c=n.segments,d=n.points;let f=!1,m=!1;for(let y=0;y<c.length;y++){const _=c[y],w=d[_.start][a],A=d[_.end][a];if(Eh(s,w,A)){f=s===w,m=s===A;break}}return{first:f,last:m,point:o}}class kJ{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,a,o){const{x:s,y:c,radius:d}=this;return a=a||{start:0,end:lr},e.arc(s,c,d,a.end,a.start,!0),!o.bounds}interpolate(e){const{x:a,y:o,radius:s}=this,c=e.angle;return{x:a+Math.cos(c)*s,y:o+Math.sin(c)*s,angle:c}}}function APe(n){const{chart:e,fill:a,line:o}=n;if($r(a))return EPe(e,a);if(a==="stack")return bPe(n);if(a==="shape")return!0;const s=MPe(n);return s instanceof kJ?s:RJ(s,o)}function EPe(n,e){const a=n.getDatasetMeta(e);return a&&n.isDatasetVisible(e)?a.dataset:null}function MPe(n){return(n.scale||{}).getPointPositionForValue?CPe(n):TPe(n)}function TPe(n){const{scale:e={},fill:a}=n,o=yPe(a,e);if($r(o)){const s=e.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function CPe(n){const{scale:e,fill:a}=n,o=e.options,s=e.getLabels().length,c=o.reverse?e.max:e.min,d=vPe(a,e,c),f=[];if(o.grid.circular){const m=e.getPointPositionForValue(0,c);return new kJ({x:m.x,y:m.y,radius:e.getDistanceFromCenterForValue(d)})}for(let m=0;m<s;++m)f.push(e.getPointPositionForValue(m,d));return f}function gI(n,e,a){const o=APe(e),{line:s,scale:c,axis:d}=e,f=s.options,m=f.fill,y=f.backgroundColor,{above:_=y,below:w=y}=m||{};o&&s.points.length&&(QT(n,a),PPe(n,{line:s,target:o,above:_,below:w,area:a,scale:c,axis:d}),eC(n))}function PPe(n,e){const{line:a,target:o,above:s,below:c,area:d,scale:f}=e,m=a._loop?"angle":e.axis;n.save(),m==="x"&&c!==s&&(pH(n,o,d.top),mH(n,{line:a,target:o,color:s,scale:f,property:m}),n.restore(),n.save(),pH(n,o,d.bottom)),mH(n,{line:a,target:o,color:c,scale:f,property:m}),n.restore()}function pH(n,e,a){const{segments:o,points:s}=e;let c=!0,d=!1;n.beginPath();for(const f of o){const{start:m,end:y}=f,_=s[m],w=s[X6(m,y,s)];c?(n.moveTo(_.x,_.y),c=!1):(n.lineTo(_.x,a),n.lineTo(_.x,_.y)),d=!!e.pathSegment(n,f,{move:d}),d?n.closePath():n.lineTo(w.x,a)}n.lineTo(e.first().x,a),n.closePath(),n.clip()}function mH(n,e){const{line:a,target:o,property:s,color:c,scale:d}=e,f=hPe(a,o,s);for(const{source:m,target:y,start:_,end:w}of f){const{style:{backgroundColor:A=c}={}}=m,C=o!==!0;n.save(),n.fillStyle=A,IPe(n,d,C&&GR(s,_,w)),n.beginPath();const I=!!a.pathSegment(n,m);let k;if(C){I?n.closePath():gH(n,o,w,s);const D=!!o.pathSegment(n,y,{move:I,reverse:!0});k=I&&D,k||gH(n,o,_,s)}n.closePath(),n.fill(k?"evenodd":"nonzero"),n.restore()}}function IPe(n,e,a){const{top:o,bottom:s}=e.chart.chartArea,{property:c,start:d,end:f}=a||{};c==="x"&&(n.beginPath(),n.rect(d,o,f-d,s-o),n.clip())}function gH(n,e,a,o){const s=e.interpolate(a,o);s&&n.lineTo(s.x,s.y)}var LPe={id:"filler",afterDatasetsUpdate(n,e,a){const o=(n.data.datasets||[]).length,s=[];let c,d,f,m;for(d=0;d<o;++d)c=n.getDatasetMeta(d),f=c.dataset,m=null,f&&f.options&&f instanceof Kf&&(m={visible:n.isDatasetVisible(d),index:d,fill:mPe(f,d,o),chart:n,axis:c.controller.options.indexAxis,scale:c.vScale,line:f}),c.$filler=m,s.push(m);for(d=0;d<o;++d)m=s[d],!(!m||m.fill===!1)&&(m.fill=pPe(s,d,a.propagate))},beforeDraw(n,e,a){const o=a.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),c=n.chartArea;for(let d=s.length-1;d>=0;--d){const f=s[d].$filler;f&&(f.line.updateControlPoints(c,f.axis),o&&f.fill&&gI(n.ctx,f,c))}},beforeDatasetsDraw(n,e,a){if(a.drawTime!=="beforeDatasetsDraw")return;const o=n.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const c=o[s].$filler;fH(c)&&gI(n.ctx,c,n.chartArea)}},beforeDatasetDraw(n,e,a){const o=e.meta.$filler;!fH(o)||a.drawTime!=="beforeDatasetDraw"||gI(n.ctx,o,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const yH=(n,e)=>{let{boxHeight:a=e,boxWidth:o=e}=n;return n.usePointStyle&&(a=Math.min(a,e),o=n.pointStyleWidth||Math.min(o,e)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(e,a)}},RPe=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class vH extends fu{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a,o){this.maxWidth=e,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let a=Qi(e.generateLabels,[this.chart],this)||[];e.filter&&(a=a.filter(o=>e.filter(o,this.chart.data))),e.sort&&(a=a.sort((o,s)=>e.sort(o,s,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:e,ctx:a}=this;if(!e.display){this.width=this.height=0;return}const o=e.labels,s=Po(o.font),c=s.size,d=this._computeTitleHeight(),{boxWidth:f,itemHeight:m}=yH(o,c);let y,_;a.font=s.string,this.isHorizontal()?(y=this.maxWidth,_=this._fitRows(d,c,f,m)+10):(_=this.maxHeight,y=this._fitCols(d,s,f,m)+10),this.width=Math.min(y,e.maxWidth||this.maxWidth),this.height=Math.min(_,e.maxHeight||this.maxHeight)}_fitRows(e,a,o,s){const{ctx:c,maxWidth:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],y=this.lineWidths=[0],_=s+f;let w=e;c.textAlign="left",c.textBaseline="middle";let A=-1,C=-_;return this.legendItems.forEach((I,k)=>{const D=o+a/2+c.measureText(I.text).width;(k===0||y[y.length-1]+D+2*f>d)&&(w+=_,y[y.length-(k>0?0:1)]=0,C+=_,A++),m[k]={left:0,top:C,row:A,width:D,height:s},y[y.length-1]+=D+f}),w}_fitCols(e,a,o,s){const{ctx:c,maxHeight:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],y=this.columnSizes=[],_=d-e;let w=f,A=0,C=0,I=0,k=0;return this.legendItems.forEach((D,L)=>{const{itemWidth:O,itemHeight:F}=kPe(o,a,c,D,s);L>0&&C+F+2*f>_&&(w+=A+f,y.push({width:A,height:C}),I+=A+f,k++,A=C=0),m[L]={left:I,top:C,col:k,width:O,height:F},A=Math.max(A,O),C+=F+f}),w+=A,y.push({width:A,height:C}),w}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:s},rtl:c}}=this,d=O0(c,this.left,this.width);if(this.isHorizontal()){let f=0,m=fs(o,this.left+s,this.right-this.lineWidths[f]);for(const y of a)f!==y.row&&(f=y.row,m=fs(o,this.left+s,this.right-this.lineWidths[f])),y.top+=this.top+e+s,y.left=d.leftForLtr(d.x(m),y.width),m+=y.width+s}else{let f=0,m=fs(o,this.top+e+s,this.bottom-this.columnSizes[f].height);for(const y of a)y.col!==f&&(f=y.col,m=fs(o,this.top+e+s,this.bottom-this.columnSizes[f].height)),y.top=m,y.left+=this.left+s,y.left=d.leftForLtr(d.x(y.left),y.width),m+=y.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;QT(e,this),this._draw(),eC(e)}}_draw(){const{options:e,columnSizes:a,lineWidths:o,ctx:s}=this,{align:c,labels:d}=e,f=qr.color,m=O0(e.rtl,this.left,this.width),y=Po(d.font),{padding:_}=d,w=y.size,A=w/2;let C;this.drawTitle(),s.textAlign=m.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=y.string;const{boxWidth:I,boxHeight:k,itemHeight:D}=yH(d,w),L=function(q,X,ee){if(isNaN(I)||I<=0||isNaN(k)||k<0)return;s.save();const V=za(ee.lineWidth,1);if(s.fillStyle=za(ee.fillStyle,f),s.lineCap=za(ee.lineCap,"butt"),s.lineDashOffset=za(ee.lineDashOffset,0),s.lineJoin=za(ee.lineJoin,"miter"),s.lineWidth=V,s.strokeStyle=za(ee.strokeStyle,f),s.setLineDash(za(ee.lineDash,[])),d.usePointStyle){const Q={radius:k*Math.SQRT2/2,pointStyle:ee.pointStyle,rotation:ee.rotation,borderWidth:V},me=m.xPlus(q,I/2),pe=X+A;eJ(s,Q,me,pe,d.pointStyleWidth&&I)}else{const Q=X+Math.max((w-k)/2,0),me=m.leftForLtr(q,I),pe=wg(ee.borderRadius);s.beginPath(),Object.values(pe).some(be=>be!==0)?ow(s,{x:me,y:Q,w:I,h:k,radius:pe}):s.rect(me,Q,I,k),s.fill(),V!==0&&s.stroke()}s.restore()},O=function(q,X,ee){Fg(s,ee.text,q,X+D/2,y,{strikethrough:ee.hidden,textAlign:m.textAlign(ee.textAlign)})},F=this.isHorizontal(),B=this._computeTitleHeight();F?C={x:fs(c,this.left+_,this.right-o[0]),y:this.top+_+B,line:0}:C={x:this.left+_,y:fs(c,this.top+B+_,this.bottom-a[0].height),line:0},cJ(this.ctx,e.textDirection);const G=D+_;this.legendItems.forEach((q,X)=>{s.strokeStyle=q.fontColor,s.fillStyle=q.fontColor;const ee=s.measureText(q.text).width,V=m.textAlign(q.textAlign||(q.textAlign=d.textAlign)),Q=I+A+ee;let me=C.x,pe=C.y;m.setWidth(this.width),F?X>0&&me+Q+_>this.right&&(pe=C.y+=G,C.line++,me=C.x=fs(c,this.left+_,this.right-o[C.line])):X>0&&pe+G>this.bottom&&(me=C.x=me+a[C.line].width+_,C.line++,pe=C.y=fs(c,this.top+B+_,this.bottom-a[C.line].height));const be=m.x(me);if(L(be,pe,q),me=eMe(V,me+I+A,F?me+Q:this.right,e.rtl),O(m.x(me),pe,q),F)C.x+=Q+_;else if(typeof q.text!="string"){const fe=y.lineHeight;C.y+=DJ(q,fe)+_}else C.y+=G}),uJ(this.ctx,e.textDirection)}drawTitle(){const e=this.options,a=e.title,o=Po(a.font),s=ws(a.padding);if(!a.display)return;const c=O0(e.rtl,this.left,this.width),d=this.ctx,f=a.position,m=o.size/2,y=s.top+m;let _,w=this.left,A=this.width;if(this.isHorizontal())A=Math.max(...this.lineWidths),_=this.top+y,w=fs(e.align,w,this.right-A);else{const I=this.columnSizes.reduce((k,D)=>Math.max(k,D.height),0);_=y+fs(e.align,this.top,this.bottom-I-e.labels.padding-this._computeTitleHeight())}const C=fs(f,w,w+A);d.textAlign=c.textAlign(U6(f)),d.textBaseline="middle",d.strokeStyle=a.color,d.fillStyle=a.color,d.font=o.string,Fg(d,a.text,C,_,o)}_computeTitleHeight(){const e=this.options.title,a=Po(e.font),o=ws(e.padding);return e.display?a.lineHeight+o.height:0}_getLegendItemAt(e,a){let o,s,c;if(Eh(e,this.left,this.right)&&Eh(a,this.top,this.bottom)){for(c=this.legendHitBoxes,o=0;o<c.length;++o)if(s=c[o],Eh(e,s.left,s.left+s.width)&&Eh(a,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(e){const a=this.options;if(!zPe(e.type,a))return;const o=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,c=RPe(s,o);s&&!c&&Qi(a.onLeave,[e,s,this],this),this._hoveredItem=o,o&&!c&&Qi(a.onHover,[e,o,this],this)}else o&&Qi(a.onClick,[e,o,this],this)}}function kPe(n,e,a,o,s){const c=DPe(o,n,e,a),d=OPe(s,o,e.lineHeight);return{itemWidth:c,itemHeight:d}}function DPe(n,e,a,o){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((c,d)=>c.length>d.length?c:d)),e+a.size/2+o.measureText(s).width}function OPe(n,e,a){let o=n;return typeof e.text!="string"&&(o=DJ(e,a)),o}function DJ(n,e){const a=n.text?n.text.length:0;return e*a}function zPe(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var FPe={id:"legend",_element:vH,start(n,e,a){const o=n.legend=new vH({ctx:n.ctx,options:a,chart:n});ys.configure(n,o,a),ys.addBox(n,o)},stop(n){ys.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,a){const o=n.legend;ys.configure(n,o,a),o.options=a},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,a){const o=e.datasetIndex,s=a.chart;s.isDatasetVisible(o)?(s.hide(o),e.hidden=!0):(s.show(o),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:s,color:c,useBorderRadius:d,borderRadius:f}}=n.legend.options;return n._getSortedDatasetMetas().map(m=>{const y=m.controller.getStyle(a?0:void 0),_=ws(y.borderWidth);return{text:e[m.index].label,fillStyle:y.backgroundColor,fontColor:c,hidden:!m.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:y.borderColor,pointStyle:o||y.pointStyle,rotation:y.rotation,textAlign:s||y.textAlign,borderRadius:d&&(f||y.borderRadius),datasetIndex:m.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class Z6 extends fu{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=a;const s=or(o.text)?o.text.length:1;this._padding=ws(o.padding);const c=s*Po(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=c:this.width=c}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:a,left:o,bottom:s,right:c,options:d}=this,f=d.align;let m=0,y,_,w;return this.isHorizontal()?(_=fs(f,o,c),w=a+e,y=c-o):(d.position==="left"?(_=o+e,w=fs(f,s,a),m=cr*-.5):(_=c-e,w=fs(f,a,s),m=cr*.5),y=s-a),{titleX:_,titleY:w,maxWidth:y,rotation:m}}draw(){const e=this.ctx,a=this.options;if(!a.display)return;const o=Po(a.font),c=o.lineHeight/2+this._padding.top,{titleX:d,titleY:f,maxWidth:m,rotation:y}=this._drawArgs(c);Fg(e,a.text,0,0,o,{color:a.color,maxWidth:m,rotation:y,textAlign:U6(a.align),textBaseline:"middle",translation:[d,f]})}}function NPe(n,e){const a=new Z6({ctx:n.ctx,options:e,chart:n});ys.configure(n,a,e),ys.addBox(n,a),n.titleBlock=a}var BPe={id:"title",_element:Z6,start(n,e,a){NPe(n,a)},stop(n){const e=n.titleBlock;ys.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,a){const o=n.titleBlock;ys.configure(n,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const fA=new WeakMap;var UPe={id:"subtitle",start(n,e,a){const o=new Z6({ctx:n.ctx,options:a,chart:n});ys.configure(n,o,a),ys.addBox(n,o),fA.set(n,o)},stop(n){ys.removeBox(n,fA.get(n)),fA.delete(n)},beforeUpdate(n,e,a){const o=fA.get(n);ys.configure(n,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Pb={average(n){if(!n.length)return!1;let e,a,o=0,s=0,c=0;for(e=0,a=n.length;e<a;++e){const d=n[e].element;if(d&&d.hasValue()){const f=d.tooltipPosition();o+=f.x,s+=f.y,++c}}return{x:o/c,y:s/c}},nearest(n,e){if(!n.length)return!1;let a=e.x,o=e.y,s=Number.POSITIVE_INFINITY,c,d,f;for(c=0,d=n.length;c<d;++c){const m=n[c].element;if(m&&m.hasValue()){const y=m.getCenterPoint(),_=OR(e,y);_<s&&(s=_,f=m)}}if(f){const m=f.tooltipPosition();a=m.x,o=m.y}return{x:a,y:o}}};function Ju(n,e){return e&&(or(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function fh(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function WPe(n,e){const{element:a,datasetIndex:o,index:s}=e,c=n.getDatasetMeta(o).controller,{label:d,value:f}=c.getLabelAndValue(s);return{chart:n,label:d,parsed:c.getParsed(s),raw:n.data.datasets[o].data[s],formattedValue:f,dataset:c.getDataset(),dataIndex:s,datasetIndex:o,element:a}}function _H(n,e){const a=n.chart.ctx,{body:o,footer:s,title:c}=n,{boxWidth:d,boxHeight:f}=e,m=Po(e.bodyFont),y=Po(e.titleFont),_=Po(e.footerFont),w=c.length,A=s.length,C=o.length,I=ws(e.padding);let k=I.height,D=0,L=o.reduce((B,G)=>B+G.before.length+G.lines.length+G.after.length,0);if(L+=n.beforeBody.length+n.afterBody.length,w&&(k+=w*y.lineHeight+(w-1)*e.titleSpacing+e.titleMarginBottom),L){const B=e.displayColors?Math.max(f,m.lineHeight):m.lineHeight;k+=C*B+(L-C)*m.lineHeight+(L-1)*e.bodySpacing}A&&(k+=e.footerMarginTop+A*_.lineHeight+(A-1)*e.footerSpacing);let O=0;const F=function(B){D=Math.max(D,a.measureText(B).width+O)};return a.save(),a.font=y.string,zi(n.title,F),a.font=m.string,zi(n.beforeBody.concat(n.afterBody),F),O=e.displayColors?d+2+e.boxPadding:0,zi(o,B=>{zi(B.before,F),zi(B.lines,F),zi(B.after,F)}),O=0,a.font=_.string,zi(n.footer,F),a.restore(),D+=I.width,{width:D,height:k}}function VPe(n,e){const{y:a,height:o}=e;return a<o/2?"top":a>n.height-o/2?"bottom":"center"}function GPe(n,e,a,o){const{x:s,width:c}=o,d=a.caretSize+a.caretPadding;if(n==="left"&&s+c+d>e.width||n==="right"&&s-c-d<0)return!0}function HPe(n,e,a,o){const{x:s,width:c}=a,{width:d,chartArea:{left:f,right:m}}=n;let y="center";return o==="center"?y=s<=(f+m)/2?"left":"right":s<=c/2?y="left":s>=d-c/2&&(y="right"),GPe(y,n,e,a)&&(y="center"),y}function bH(n,e,a){const o=a.yAlign||e.yAlign||VPe(n,a);return{xAlign:a.xAlign||e.xAlign||HPe(n,e,a,o),yAlign:o}}function jPe(n,e){let{x:a,width:o}=n;return e==="right"?a-=o:e==="center"&&(a-=o/2),a}function $Pe(n,e,a){let{y:o,height:s}=n;return e==="top"?o+=a:e==="bottom"?o-=s+a:o-=s/2,o}function xH(n,e,a,o){const{caretSize:s,caretPadding:c,cornerRadius:d}=n,{xAlign:f,yAlign:m}=a,y=s+c,{topLeft:_,topRight:w,bottomLeft:A,bottomRight:C}=wg(d);let I=jPe(e,f);const k=$Pe(e,m,y);return m==="center"?f==="left"?I+=y:f==="right"&&(I-=y):f==="left"?I-=Math.max(_,A)+s:f==="right"&&(I+=Math.max(w,C)+s),{x:Fo(I,0,o.width-e.width),y:Fo(k,0,o.height-e.height)}}function pA(n,e,a){const o=ws(a.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-o.right:n.x+o.left}function wH(n){return Ju([],fh(n))}function qPe(n,e,a){return Pp(n,{tooltip:e,tooltipItems:a,type:"tooltip"})}function SH(n,e){const a=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return a?n.override(a):n}const OJ={beforeTitle:uh,title(n){if(n.length>0){const e=n[0],a=e.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(o>0&&e.dataIndex<o)return a[e.dataIndex]}return""},afterTitle:uh,beforeBody:uh,beforeLabel:uh,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const a=n.formattedValue;return li(a)||(e+=a),e},labelColor(n){const a=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const a=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:uh,afterBody:uh,beforeFooter:uh,footer:uh,afterFooter:uh};function ll(n,e,a,o){const s=n[e].call(a,o);return typeof s>"u"?OJ[e].call(a,o):s}class HR extends fu{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const a=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&a.options.animation&&o.animations,c=new pJ(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(c)),c}getContext(){return this.$context||(this.$context=qPe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,a){const{callbacks:o}=a,s=ll(o,"beforeTitle",this,e),c=ll(o,"title",this,e),d=ll(o,"afterTitle",this,e);let f=[];return f=Ju(f,fh(s)),f=Ju(f,fh(c)),f=Ju(f,fh(d)),f}getBeforeBody(e,a){return wH(ll(a.callbacks,"beforeBody",this,e))}getBody(e,a){const{callbacks:o}=a,s=[];return zi(e,c=>{const d={before:[],lines:[],after:[]},f=SH(o,c);Ju(d.before,fh(ll(f,"beforeLabel",this,c))),Ju(d.lines,ll(f,"label",this,c)),Ju(d.after,fh(ll(f,"afterLabel",this,c))),s.push(d)}),s}getAfterBody(e,a){return wH(ll(a.callbacks,"afterBody",this,e))}getFooter(e,a){const{callbacks:o}=a,s=ll(o,"beforeFooter",this,e),c=ll(o,"footer",this,e),d=ll(o,"afterFooter",this,e);let f=[];return f=Ju(f,fh(s)),f=Ju(f,fh(c)),f=Ju(f,fh(d)),f}_createItems(e){const a=this._active,o=this.chart.data,s=[],c=[],d=[];let f=[],m,y;for(m=0,y=a.length;m<y;++m)f.push(WPe(this.chart,a[m]));return e.filter&&(f=f.filter((_,w,A)=>e.filter(_,w,A,o))),e.itemSort&&(f=f.sort((_,w)=>e.itemSort(_,w,o))),zi(f,_=>{const w=SH(e.callbacks,_);s.push(ll(w,"labelColor",this,_)),c.push(ll(w,"labelPointStyle",this,_)),d.push(ll(w,"labelTextColor",this,_))}),this.labelColors=s,this.labelPointStyles=c,this.labelTextColors=d,this.dataPoints=f,f}update(e,a){const o=this.options.setContext(this.getContext()),s=this._active;let c,d=[];if(!s.length)this.opacity!==0&&(c={opacity:0});else{const f=Pb[o.position].call(this,s,this._eventPosition);d=this._createItems(o),this.title=this.getTitle(d,o),this.beforeBody=this.getBeforeBody(d,o),this.body=this.getBody(d,o),this.afterBody=this.getAfterBody(d,o),this.footer=this.getFooter(d,o);const m=this._size=_H(this,o),y=Object.assign({},f,m),_=bH(this.chart,o,y),w=xH(o,y,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,c={opacity:1,x:w.x,y:w.y,width:m.width,height:m.height,caretX:f.x,caretY:f.y}}this._tooltipItems=d,this.$context=void 0,c&&this._resolveAnimations().update(this,c),e&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(e,a,o,s){const c=this.getCaretPosition(e,o,s);a.lineTo(c.x1,c.y1),a.lineTo(c.x2,c.y2),a.lineTo(c.x3,c.y3)}getCaretPosition(e,a,o){const{xAlign:s,yAlign:c}=this,{caretSize:d,cornerRadius:f}=o,{topLeft:m,topRight:y,bottomLeft:_,bottomRight:w}=wg(f),{x:A,y:C}=e,{width:I,height:k}=a;let D,L,O,F,B,G;return c==="center"?(B=C+k/2,s==="left"?(D=A,L=D-d,F=B+d,G=B-d):(D=A+I,L=D+d,F=B-d,G=B+d),O=D):(s==="left"?L=A+Math.max(m,_)+d:s==="right"?L=A+I-Math.max(y,w)-d:L=this.caretX,c==="top"?(F=C,B=F-d,D=L-d,O=L+d):(F=C+k,B=F+d,D=L+d,O=L-d),G=F),{x1:D,x2:L,x3:O,y1:F,y2:B,y3:G}}drawTitle(e,a,o){const s=this.title,c=s.length;let d,f,m;if(c){const y=O0(o.rtl,this.x,this.width);for(e.x=pA(this,o.titleAlign,o),a.textAlign=y.textAlign(o.titleAlign),a.textBaseline="middle",d=Po(o.titleFont),f=o.titleSpacing,a.fillStyle=o.titleColor,a.font=d.string,m=0;m<c;++m)a.fillText(s[m],y.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+f,m+1===c&&(e.y+=o.titleMarginBottom-f)}}_drawColorBox(e,a,o,s,c){const d=this.labelColors[o],f=this.labelPointStyles[o],{boxHeight:m,boxWidth:y}=c,_=Po(c.bodyFont),w=pA(this,"left",c),A=s.x(w),C=m<_.lineHeight?(_.lineHeight-m)/2:0,I=a.y+C;if(c.usePointStyle){const k={radius:Math.min(y,m)/2,pointStyle:f.pointStyle,rotation:f.rotation,borderWidth:1},D=s.leftForLtr(A,y)+y/2,L=I+m/2;e.strokeStyle=c.multiKeyBackground,e.fillStyle=c.multiKeyBackground,FR(e,k,D,L),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,FR(e,k,D,L)}else{e.lineWidth=Ka(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const k=s.leftForLtr(A,y),D=s.leftForLtr(s.xPlus(A,1),y-2),L=wg(d.borderRadius);Object.values(L).some(O=>O!==0)?(e.beginPath(),e.fillStyle=c.multiKeyBackground,ow(e,{x:k,y:I,w:y,h:m,radius:L}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),ow(e,{x:D,y:I+1,w:y-2,h:m-2,radius:L}),e.fill()):(e.fillStyle=c.multiKeyBackground,e.fillRect(k,I,y,m),e.strokeRect(k,I,y,m),e.fillStyle=d.backgroundColor,e.fillRect(D,I+1,y-2,m-2))}e.fillStyle=this.labelTextColors[o]}drawBody(e,a,o){const{body:s}=this,{bodySpacing:c,bodyAlign:d,displayColors:f,boxHeight:m,boxWidth:y,boxPadding:_}=o,w=Po(o.bodyFont);let A=w.lineHeight,C=0;const I=O0(o.rtl,this.x,this.width),k=function(ee){a.fillText(ee,I.x(e.x+C),e.y+A/2),e.y+=A+c},D=I.textAlign(d);let L,O,F,B,G,q,X;for(a.textAlign=d,a.textBaseline="middle",a.font=w.string,e.x=pA(this,D,o),a.fillStyle=o.bodyColor,zi(this.beforeBody,k),C=f&&D!=="right"?d==="center"?y/2+_:y+2+_:0,B=0,q=s.length;B<q;++B){for(L=s[B],O=this.labelTextColors[B],a.fillStyle=O,zi(L.before,k),F=L.lines,f&&F.length&&(this._drawColorBox(a,e,B,I,o),A=Math.max(w.lineHeight,m)),G=0,X=F.length;G<X;++G)k(F[G]),A=w.lineHeight;zi(L.after,k)}C=0,A=w.lineHeight,zi(this.afterBody,k),e.y-=c}drawFooter(e,a,o){const s=this.footer,c=s.length;let d,f;if(c){const m=O0(o.rtl,this.x,this.width);for(e.x=pA(this,o.footerAlign,o),e.y+=o.footerMarginTop,a.textAlign=m.textAlign(o.footerAlign),a.textBaseline="middle",d=Po(o.footerFont),a.fillStyle=o.footerColor,a.font=d.string,f=0;f<c;++f)a.fillText(s[f],m.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+o.footerSpacing}}drawBackground(e,a,o,s){const{xAlign:c,yAlign:d}=this,{x:f,y:m}=e,{width:y,height:_}=o,{topLeft:w,topRight:A,bottomLeft:C,bottomRight:I}=wg(s.cornerRadius);a.fillStyle=s.backgroundColor,a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.beginPath(),a.moveTo(f+w,m),d==="top"&&this.drawCaret(e,a,o,s),a.lineTo(f+y-A,m),a.quadraticCurveTo(f+y,m,f+y,m+A),d==="center"&&c==="right"&&this.drawCaret(e,a,o,s),a.lineTo(f+y,m+_-I),a.quadraticCurveTo(f+y,m+_,f+y-I,m+_),d==="bottom"&&this.drawCaret(e,a,o,s),a.lineTo(f+C,m+_),a.quadraticCurveTo(f,m+_,f,m+_-C),d==="center"&&c==="left"&&this.drawCaret(e,a,o,s),a.lineTo(f,m+w),a.quadraticCurveTo(f,m,f+w,m),a.closePath(),a.fill(),s.borderWidth>0&&a.stroke()}_updateAnimationTarget(e){const a=this.chart,o=this.$animations,s=o&&o.x,c=o&&o.y;if(s||c){const d=Pb[e.position].call(this,this._active,this._eventPosition);if(!d)return;const f=this._size=_H(this,e),m=Object.assign({},d,this._size),y=bH(a,e,m),_=xH(e,m,y,a);(s._to!==_.x||c._to!==_.y)&&(this.xAlign=y.xAlign,this.yAlign=y.yAlign,this.width=f.width,this.height=f.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(e){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const s={width:this.width,height:this.height},c={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const d=ws(a.padding),f=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&f&&(e.save(),e.globalAlpha=o,this.drawBackground(c,e,s,a),cJ(e,a.textDirection),c.y+=d.top,this.drawTitle(c,e,a),this.drawBody(c,e,a),this.drawFooter(c,e,a),uJ(e,a.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,a){const o=this._active,s=e.map(({datasetIndex:f,index:m})=>{const y=this.chart.getDatasetMeta(f);if(!y)throw new Error("Cannot find a dataset at index "+f);return{datasetIndex:f,element:y.data[m],index:m}}),c=!eM(o,s),d=this._positionChanged(s,a);(c||d)&&(this._active=s,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,c=this._active||[],d=this._getActiveElements(e,c,a,o),f=this._positionChanged(d,e),m=a||!eM(d,c)||f;return m&&(this._active=d,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,a))),m}_getActiveElements(e,a,o,s){const c=this.options;if(e.type==="mouseout")return[];if(!s)return a;const d=this.chart.getElementsAtEventForMode(e,c.mode,c,o);return c.reverse&&d.reverse(),d}_positionChanged(e,a){const{caretX:o,caretY:s,options:c}=this,d=Pb[c.position].call(this,e,a);return d!==!1&&(o!==d.x||s!==d.y)}}_n(HR,"positioners",Pb);var XPe={id:"tooltip",_element:HR,positioners:Pb,afterInit(n,e,a){a&&(n.tooltip=new HR({chart:n,options:a}))},beforeUpdate(n,e,a){n.tooltip&&n.tooltip.initialize(a)},reset(n,e,a){n.tooltip&&n.tooltip.initialize(a)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const a={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",a)}},afterEvent(n,e){if(n.tooltip){const a=e.replay;n.tooltip.handleEvent(e.event,a,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:OJ},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},ZPe=Object.freeze({__proto__:null,Colors:sPe,Decimation:dPe,Filler:LPe,Legend:FPe,SubTitle:UPe,Title:BPe,Tooltip:XPe});const YPe=(n,e,a,o)=>(typeof e=="string"?(a=n.push(e)-1,o.unshift({index:a,label:e})):isNaN(e)&&(a=null),a);function KPe(n,e,a,o){const s=n.indexOf(e);if(s===-1)return YPe(n,e,a,o);const c=n.lastIndexOf(e);return s!==c?a:s}const JPe=(n,e)=>n===null?null:Fo(Math.round(n),0,e);function AH(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class jR extends $g{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:s,label:c}of a)o[s]===c&&o.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,a){if(li(e))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===e?a:KPe(o,e,za(a,e),this._addedLabels),JPe(a,o.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:a}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(o=0),a||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const e=this.min,a=this.max,o=this.options.offset,s=[];let c=this.getLabels();c=e===0&&a===c.length-1?c:c.slice(e,a+1),this._valueRange=Math.max(c.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let d=e;d<=a;d++)s.push({value:d});return s}getLabelForValue(e){return AH.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}_n(jR,"id","category"),_n(jR,"defaults",{ticks:{callback:AH}});function QPe(n,e){const a=[],{bounds:s,step:c,min:d,max:f,precision:m,count:y,maxTicks:_,maxDigits:w,includeBounds:A}=n,C=c||1,I=_-1,{min:k,max:D}=e,L=!li(d),O=!li(f),F=!li(y),B=(D-k)/(w+1);let G=vG((D-k)/I/C)*C,q,X,ee,V;if(G<1e-14&&!L&&!O)return[{value:k},{value:D}];V=Math.ceil(D/G)-Math.floor(k/G),V>I&&(G=vG(V*G/I/C)*C),li(m)||(q=Math.pow(10,m),G=Math.ceil(G*q)/q),s==="ticks"?(X=Math.floor(k/G)*G,ee=Math.ceil(D/G)*G):(X=k,ee=D),L&&O&&c&&qEe((f-d)/c,G/1e3)?(V=Math.round(Math.min((f-d)/G,_)),G=(f-d)/V,X=d,ee=f):F?(X=L?d:X,ee=O?f:ee,V=y-1,G=(ee-X)/V):(V=(ee-X)/G,ax(V,Math.round(V),G/1e3)?V=Math.round(V):V=Math.ceil(V));const Q=Math.max(_G(G),_G(X));q=Math.pow(10,li(m)?Q:m),X=Math.round(X*q)/q,ee=Math.round(ee*q)/q;let me=0;for(L&&(A&&X!==d?(a.push({value:d}),X<d&&me++,ax(Math.round((X+me*G)*q)/q,d,EH(d,B,n))&&me++):X<d&&me++);me<V;++me){const pe=Math.round((X+me*G)*q)/q;if(O&&pe>f)break;a.push({value:pe})}return O&&A&&ee!==f?a.length&&ax(a[a.length-1].value,f,EH(f,B,n))?a[a.length-1].value=f:a.push({value:f}):(!O||ee===f)&&a.push({value:ee}),a}function EH(n,e,{horizontal:a,minRotation:o}){const s=ou(o),c=(a?Math.sin(s):Math.cos(s))||.001,d=.75*e*(""+n).length;return Math.min(e/c,d)}class sM extends $g{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,a){return li(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:s,max:c}=this;const d=m=>s=a?s:m,f=m=>c=o?c:m;if(e){const m=pd(s),y=pd(c);m<0&&y<0?f(0):m>0&&y>0&&d(0)}if(s===c){let m=c===0?1:Math.abs(c*.05);f(c+m),e||d(s-m)}this.min=s,this.max=c}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=e,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),a=a||11),a&&(s=Math.min(a,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,a=e.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:e.bounds,min:e.min,max:e.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},c=this._range||this,d=QPe(s,c);return e.bounds==="ticks"&&jK(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&e.length){const s=(o-a)/Math.max(e.length-1,1)/2;a-=s,o+=s}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(e){return Uw(e,this.chart.options.locale,this.options.ticks.format)}}class $R extends sM{determineDataLimits(){const{min:e,max:a}=this.getMinMax(!0);this.min=$r(e)?e:0,this.max=$r(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),a=e?this.width:this.height,o=ou(this.options.ticks.minRotation),s=(e?Math.sin(o):Math.cos(o))||.001,c=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,c.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}_n($R,"id","linear"),_n($R,"defaults",{ticks:{callback:JT.formatters.numeric}});const lw=n=>Math.floor(Yf(n)),Hm=(n,e)=>Math.pow(10,lw(n)+e);function MH(n){return n/Math.pow(10,lw(n))===1}function TH(n,e,a){const o=Math.pow(10,a),s=Math.floor(n/o);return Math.ceil(e/o)-s}function e5e(n,e){const a=e-n;let o=lw(a);for(;TH(n,e,o)>10;)o++;for(;TH(n,e,o)<10;)o--;return Math.min(o,lw(n))}function t5e(n,{min:e,max:a}){e=zl(n.min,e);const o=[],s=lw(e);let c=e5e(e,a),d=c<0?Math.pow(10,Math.abs(c)):1;const f=Math.pow(10,c),m=s>c?Math.pow(10,s):0,y=Math.round((e-m)*d)/d,_=Math.floor((e-m)/f/10)*f*10;let w=Math.floor((y-_)/Math.pow(10,c)),A=zl(n.min,Math.round((m+_+w*Math.pow(10,c))*d)/d);for(;A<a;)o.push({value:A,major:MH(A),significand:w}),w>=10?w=w<15?15:20:w++,w>=20&&(c++,w=2,d=c>=0?1:d),A=Math.round((m+_+w*Math.pow(10,c))*d)/d;const C=zl(n.max,A);return o.push({value:C,major:MH(C),significand:w}),o}class qR extends $g{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,a){const o=sM.prototype.parse.apply(this,[e,a]);if(o===0){this._zero=!0;return}return $r(o)&&o>0?o:null}determineDataLimits(){const{min:e,max:a}=this.getMinMax(!0);this.min=$r(e)?Math.max(0,e):null,this.max=$r(a)?Math.max(0,a):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!$r(this._userMin)&&(this.min=e===Hm(this.min,0)?Hm(this.min,-1):Hm(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:a}=this.getUserBounds();let o=this.min,s=this.max;const c=f=>o=e?o:f,d=f=>s=a?s:f;o===s&&(o<=0?(c(1),d(10)):(c(Hm(o,-1)),d(Hm(s,1)))),o<=0&&c(Hm(s,-1)),s<=0&&d(Hm(o,1)),this.min=o,this.max=s}buildTicks(){const e=this.options,a={min:this._userMin,max:this._userMax},o=t5e(a,this);return e.bounds==="ticks"&&jK(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(e){return e===void 0?"0":Uw(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Yf(e),this._valueRange=Yf(this.max)-Yf(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Yf(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const a=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+a*this._valueRange)}}_n(qR,"id","logarithmic"),_n(qR,"defaults",{ticks:{callback:JT.formatters.logarithmic,major:{enabled:!0}}});function XR(n){const e=n.ticks;if(e.display&&n.display){const a=ws(e.backdropPadding);return za(e.font&&e.font.size,qr.font.size)+a.height}return 0}function n5e(n,e,a){return a=or(a)?a:[a],{w:uMe(n,e.string,a),h:a.length*e.lineHeight}}function CH(n,e,a,o,s){return n===o||n===s?{start:e-a/2,end:e+a/2}:n<o||n>s?{start:e-a,end:e}:{start:e,end:e+a}}function a5e(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},a=Object.assign({},e),o=[],s=[],c=n._pointLabels.length,d=n.options.pointLabels,f=d.centerPointLabels?cr/c:0;for(let m=0;m<c;m++){const y=d.setContext(n.getPointLabelContext(m));s[m]=y.padding;const _=n.getPointPosition(m,n.drawingArea+s[m],f),w=Po(y.font),A=n5e(n.ctx,w,n._pointLabels[m]);o[m]=A;const C=Nl(n.getIndexAngle(m)+f),I=Math.round(N6(C)),k=CH(I,_.x,A.w,0,180),D=CH(I,_.y,A.h,90,270);i5e(a,e,C,k,D)}n.setCenterPoint(e.l-a.l,a.r-e.r,e.t-a.t,a.b-e.b),n._pointLabelItems=s5e(n,o,s)}function i5e(n,e,a,o,s){const c=Math.abs(Math.sin(a)),d=Math.abs(Math.cos(a));let f=0,m=0;o.start<e.l?(f=(e.l-o.start)/c,n.l=Math.min(n.l,e.l-f)):o.end>e.r&&(f=(o.end-e.r)/c,n.r=Math.max(n.r,e.r+f)),s.start<e.t?(m=(e.t-s.start)/d,n.t=Math.min(n.t,e.t-m)):s.end>e.b&&(m=(s.end-e.b)/d,n.b=Math.max(n.b,e.b+m))}function r5e(n,e,a){const o=n.drawingArea,{extra:s,additionalAngle:c,padding:d,size:f}=a,m=n.getPointPosition(e,o+s+d,c),y=Math.round(N6(Nl(m.angle+so))),_=u5e(m.y,f.h,y),w=l5e(y),A=c5e(m.x,f.w,w);return{visible:!0,x:m.x,y:_,textAlign:w,left:A,top:_,right:A+f.w,bottom:_+f.h}}function o5e(n,e){if(!e)return!0;const{left:a,top:o,right:s,bottom:c}=n;return!(Th({x:a,y:o},e)||Th({x:a,y:c},e)||Th({x:s,y:o},e)||Th({x:s,y:c},e))}function s5e(n,e,a){const o=[],s=n._pointLabels.length,c=n.options,{centerPointLabels:d,display:f}=c.pointLabels,m={extra:XR(c)/2,additionalAngle:d?cr/s:0};let y;for(let _=0;_<s;_++){m.padding=a[_],m.size=e[_];const w=r5e(n,_,m);o.push(w),f==="auto"&&(w.visible=o5e(w,y),w.visible&&(y=w))}return o}function l5e(n){return n===0||n===180?"center":n<180?"left":"right"}function c5e(n,e,a){return a==="right"?n-=e:a==="center"&&(n-=e/2),n}function u5e(n,e,a){return a===90||a===270?n-=e/2:(a>270||a<90)&&(n-=e),n}function d5e(n,e,a){const{left:o,top:s,right:c,bottom:d}=a,{backdropColor:f}=e;if(!li(f)){const m=wg(e.borderRadius),y=ws(e.backdropPadding);n.fillStyle=f;const _=o-y.left,w=s-y.top,A=c-o+y.width,C=d-s+y.height;Object.values(m).some(I=>I!==0)?(n.beginPath(),ow(n,{x:_,y:w,w:A,h:C,radius:m}),n.fill()):n.fillRect(_,w,A,C)}}function h5e(n,e){const{ctx:a,options:{pointLabels:o}}=n;for(let s=e-1;s>=0;s--){const c=n._pointLabelItems[s];if(!c.visible)continue;const d=o.setContext(n.getPointLabelContext(s));d5e(a,d,c);const f=Po(d.font),{x:m,y,textAlign:_}=c;Fg(a,n._pointLabels[s],m,y+f.lineHeight/2,f,{color:d.color,textAlign:_,textBaseline:"middle"})}}function zJ(n,e,a,o){const{ctx:s}=n;if(a)s.arc(n.xCenter,n.yCenter,e,0,lr);else{let c=n.getPointPosition(0,e);s.moveTo(c.x,c.y);for(let d=1;d<o;d++)c=n.getPointPosition(d,e),s.lineTo(c.x,c.y)}}function f5e(n,e,a,o,s){const c=n.ctx,d=e.circular,{color:f,lineWidth:m}=e;!d&&!o||!f||!m||a<0||(c.save(),c.strokeStyle=f,c.lineWidth=m,c.setLineDash(s.dash),c.lineDashOffset=s.dashOffset,c.beginPath(),zJ(n,a,d,o),c.closePath(),c.stroke(),c.restore())}function p5e(n,e,a){return Pp(n,{label:a,index:e,type:"pointLabel"})}class Ib extends sM{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ws(XR(this.options)/2),a=this.width=this.maxWidth-e.width,o=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+a/2+e.left),this.yCenter=Math.floor(this.top+o/2+e.top),this.drawingArea=Math.floor(Math.min(a,o)/2)}determineDataLimits(){const{min:e,max:a}=this.getMinMax(!1);this.min=$r(e)&&!isNaN(e)?e:0,this.max=$r(a)&&!isNaN(a)?a:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/XR(this.options))}generateTickLabels(e){sM.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((a,o)=>{const s=Qi(this.options.pointLabels.callback,[a,o],this);return s||s===0?s:""}).filter((a,o)=>this.chart.getDataVisibility(o))}fit(){const e=this.options;e.display&&e.pointLabels.display?a5e(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,a,o,s){this.xCenter+=Math.floor((e-a)/2),this.yCenter+=Math.floor((o-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,a,o,s))}getIndexAngle(e){const a=lr/(this._pointLabels.length||1),o=this.options.startAngle||0;return Nl(e*a+ou(o))}getDistanceFromCenterForValue(e){if(li(e))return NaN;const a=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*a:(e-this.min)*a}getValueForDistanceFromCenter(e){if(li(e))return NaN;const a=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-a:this.min+a}getPointLabelContext(e){const a=this._pointLabels||[];if(e>=0&&e<a.length){const o=a[e];return p5e(this.getContext(),e,o)}}getPointPosition(e,a,o=0){const s=this.getIndexAngle(e)-so+o;return{x:Math.cos(s)*a+this.xCenter,y:Math.sin(s)*a+this.yCenter,angle:s}}getPointPositionForValue(e,a){return this.getPointPosition(e,this.getDistanceFromCenterForValue(a))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:a,top:o,right:s,bottom:c}=this._pointLabelItems[e];return{left:a,top:o,right:s,bottom:c}}drawBackground(){const{backgroundColor:e,grid:{circular:a}}=this.options;if(e){const o=this.ctx;o.save(),o.beginPath(),zJ(this,this.getDistanceFromCenterForValue(this._endValue),a,this._pointLabels.length),o.closePath(),o.fillStyle=e,o.fill(),o.restore()}}drawGrid(){const e=this.ctx,a=this.options,{angleLines:o,grid:s,border:c}=a,d=this._pointLabels.length;let f,m,y;if(a.pointLabels.display&&h5e(this,d),s.display&&this.ticks.forEach((_,w)=>{if(w!==0){m=this.getDistanceFromCenterForValue(_.value);const A=this.getContext(w),C=s.setContext(A),I=c.setContext(A);f5e(this,C,m,d,I)}}),o.display){for(e.save(),f=d-1;f>=0;f--){const _=o.setContext(this.getPointLabelContext(f)),{color:w,lineWidth:A}=_;!A||!w||(e.lineWidth=A,e.strokeStyle=w,e.setLineDash(_.borderDash),e.lineDashOffset=_.borderDashOffset,m=this.getDistanceFromCenterForValue(a.ticks.reverse?this.min:this.max),y=this.getPointPosition(f,m),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(y.x,y.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,a=this.options,o=a.ticks;if(!o.display)return;const s=this.getIndexAngle(0);let c,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((f,m)=>{if(m===0&&!a.reverse)return;const y=o.setContext(this.getContext(m)),_=Po(y.font);if(c=this.getDistanceFromCenterForValue(this.ticks[m].value),y.showLabelBackdrop){e.font=_.string,d=e.measureText(f.label).width,e.fillStyle=y.backdropColor;const w=ws(y.backdropPadding);e.fillRect(-d/2-w.left,-c-_.size/2-w.top,d+w.width,_.size+w.height)}Fg(e,f.label,0,-c,_,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),e.restore()}drawTitle(){}}_n(Ib,"id","radialLinear"),_n(Ib,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:JT.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),_n(Ib,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),_n(Ib,"descriptors",{angleLines:{_fallback:"grid"}});const nC={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},pl=Object.keys(nC);function PH(n,e){return n-e}function IH(n,e){if(li(e))return null;const a=n._adapter,{parser:o,round:s,isoWeekday:c}=n._parseOpts;let d=e;return typeof o=="function"&&(d=o(d)),$r(d)||(d=typeof o=="string"?a.parse(d,o):a.parse(d)),d===null?null:(s&&(d=s==="week"&&(n_(c)||c===!0)?a.startOf(d,"isoWeek",c):a.startOf(d,s)),+d)}function LH(n,e,a,o){const s=pl.length;for(let c=pl.indexOf(n);c<s-1;++c){const d=nC[pl[c]],f=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((a-e)/(f*d.size))<=o)return pl[c]}return pl[s-1]}function m5e(n,e,a,o,s){for(let c=pl.length-1;c>=pl.indexOf(a);c--){const d=pl[c];if(nC[d].common&&n._adapter.diff(s,o,d)>=e-1)return d}return pl[a?pl.indexOf(a):0]}function g5e(n){for(let e=pl.indexOf(n)+1,a=pl.length;e<a;++e)if(nC[pl[e]].common)return pl[e]}function RH(n,e,a){if(!a)n[e]=!0;else if(a.length){const{lo:o,hi:s}=B6(a,e),c=a[o]>=e?a[o]:a[s];n[c]=!0}}function y5e(n,e,a,o){const s=n._adapter,c=+s.startOf(e[0].value,o),d=e[e.length-1].value;let f,m;for(f=c;f<=d;f=+s.add(f,1,o))m=a[f],m>=0&&(e[m].major=!0);return e}function kH(n,e,a){const o=[],s={},c=e.length;let d,f;for(d=0;d<c;++d)f=e[d],s[f]=d,o.push({value:f,major:!1});return c===0||!a?o:y5e(n,o,s,a)}class cw extends $g{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,a={}){const o=e.time||(e.time={}),s=this._adapter=new MTe._date(e.adapters.date);s.init(a),nx(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(e),this._normalized=a.normalized}parse(e,a){return e===void 0?null:IH(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,a=this._adapter,o=e.time.unit||"day";let{min:s,max:c,minDefined:d,maxDefined:f}=this.getUserBounds();function m(y){!d&&!isNaN(y.min)&&(s=Math.min(s,y.min)),!f&&!isNaN(y.max)&&(c=Math.max(c,y.max))}(!d||!f)&&(m(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&m(this.getMinMax(!1))),s=$r(s)&&!isNaN(s)?s:+a.startOf(Date.now(),o),c=$r(c)&&!isNaN(c)?c:+a.endOf(Date.now(),o)+1,this.min=Math.min(s,c-1),this.max=Math.max(s+1,c)}_getLabelBounds(){const e=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.length&&(a=e[0],o=e[e.length-1]),{min:a,max:o}}buildTicks(){const e=this.options,a=e.time,o=e.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const c=this.min,d=this.max,f=KEe(s,c,d);return this._unit=a.unit||(o.autoSkip?LH(a.minUnit,this.min,this.max,this._getLabelCapacity(c)):m5e(this,f.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:g5e(this._unit),this.initOffsets(s),e.reverse&&f.reverse(),kH(this,f,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let a=0,o=0,s,c;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?a=1-s:a=(this.getDecimalForValue(e[1])-s)/2,c=this.getDecimalForValue(e[e.length-1]),e.length===1?o=c:o=(c-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;a=Fo(a,0,d),o=Fo(o,0,d),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const e=this._adapter,a=this.min,o=this.max,s=this.options,c=s.time,d=c.unit||LH(c.minUnit,a,o,this._getLabelCapacity(a)),f=za(s.ticks.stepSize,1),m=d==="week"?c.isoWeekday:!1,y=n_(m)||m===!0,_={};let w=a,A,C;if(y&&(w=+e.startOf(w,"isoWeek",m)),w=+e.startOf(w,y?"day":d),e.diff(o,a,d)>1e5*f)throw new Error(a+" and "+o+" are too far apart with stepSize of "+f+" "+d);const I=s.ticks.source==="data"&&this.getDataTimestamps();for(A=w,C=0;A<o;A=+e.add(A,f,d),C++)RH(_,A,I);return(A===o||s.bounds==="ticks"||C===1)&&RH(_,A,I),Object.keys(_).sort(PH).map(k=>+k)}getLabelForValue(e){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(e,o.tooltipFormat):a.format(e,o.displayFormats.datetime)}format(e,a){const s=this.options.time.displayFormats,c=this._unit,d=a||s[c];return this._adapter.format(e,d)}_tickFormatFunction(e,a,o,s){const c=this.options,d=c.ticks.callback;if(d)return Qi(d,[e,a,o],this);const f=c.time.displayFormats,m=this._unit,y=this._majorUnit,_=m&&f[m],w=y&&f[y],A=o[a],C=y&&w&&A&&A.major;return this._adapter.format(e,s||(C?w:_))}generateTickLabels(e){let a,o,s;for(a=0,o=e.length;a<o;++a)s=e[a],s.label=this._tickFormatFunction(s.value,a,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const a=this._offsets,o=this.getDecimalForValue(e);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(e){const a=this.options.ticks,o=this.ctx.measureText(e).width,s=ou(this.isHorizontal()?a.maxRotation:a.minRotation),c=Math.cos(s),d=Math.sin(s),f=this._resolveTickFontOptions(0).size;return{w:o*c+f*d,h:o*d+f*c}}_getLabelCapacity(e){const a=this.options.time,o=a.displayFormats,s=o[a.unit]||o.millisecond,c=this._tickFormatFunction(e,0,kH(this,[e],this._majorUnit),s),d=this._getLabelSize(c),f=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return f>0?f:1}getDataTimestamps(){let e=this._cache.data||[],a,o;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(a=0,o=s.length;a<o;++a)e=e.concat(s[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let a,o;if(e.length)return e;const s=this.getLabels();for(a=0,o=s.length;a<o;++a)e.push(IH(this,s[a]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return XK(e.sort(PH))}}_n(cw,"id","time"),_n(cw,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function mA(n,e,a){let o=0,s=n.length-1,c,d,f,m;a?(e>=n[o].pos&&e<=n[s].pos&&({lo:o,hi:s}=Mh(n,"pos",e)),{pos:c,time:f}=n[o],{pos:d,time:m}=n[s]):(e>=n[o].time&&e<=n[s].time&&({lo:o,hi:s}=Mh(n,"time",e)),{time:c,pos:f}=n[o],{time:d,pos:m}=n[s]);const y=d-c;return y?f+(m-f)*(e-c)/y:f}class ZR extends cw{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(e);this._minPos=mA(a,this.min),this._tableRange=mA(a,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:a,max:o}=this,s=[],c=[];let d,f,m,y,_;for(d=0,f=e.length;d<f;++d)y=e[d],y>=a&&y<=o&&s.push(y);if(s.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(d=0,f=s.length;d<f;++d)_=s[d+1],m=s[d-1],y=s[d],Math.round((_+m)/2)!==y&&c.push({time:y,pos:d/(f-1)});return c}_generate(){const e=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(e)||!o.length)&&o.splice(0,0,e),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((s,c)=>s-c)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?e=this.normalize(a.concat(o)):e=a.length?a:o,e=this._cache.all=e,e}getDecimalForValue(e){return(mA(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return mA(this._table,o*this._tableRange+this._minPos,!0)}}_n(ZR,"id","timeseries"),_n(ZR,"defaults",cw.defaults);var v5e=Object.freeze({__proto__:null,CategoryScale:jR,LinearScale:$R,LogarithmicScale:qR,RadialLinearScale:Ib,TimeScale:cw,TimeSeriesScale:ZR});const _5e=[ETe,tPe,ZPe,v5e],FJ="label";function DH(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function b5e(n,e){const a=n.options;a&&e&&Object.assign(a,e)}function NJ(n,e){n.labels=e}function BJ(n,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:FJ;const o=[];n.datasets=e.map(s=>{const c=n.datasets.find(d=>d[a]===s[a]);return!c||!s.data||o.includes(c)?{...s}:(o.push(c),Object.assign(c,s),c)})}function x5e(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FJ;const a={labels:[],datasets:[]};return NJ(a,n.labels),BJ(a,n.datasets,e),a}function w5e(n,e){const{height:a=150,width:o=300,redraw:s=!1,datasetIdKey:c,type:d,data:f,options:m,plugins:y=[],fallbackContent:_,updateMode:w,...A}=n,C=re.useRef(null),I=re.useRef(),k=()=>{C.current&&(I.current=new Vw(C.current,{type:d,data:x5e(f,c),options:m&&{...m},plugins:y}),DH(e,I.current))},D=()=>{DH(e,null),I.current&&(I.current.destroy(),I.current=null)};return re.useEffect(()=>{!s&&I.current&&m&&b5e(I.current,m)},[s,m]),re.useEffect(()=>{!s&&I.current&&NJ(I.current.config.data,f.labels)},[s,f.labels]),re.useEffect(()=>{!s&&I.current&&f.datasets&&BJ(I.current.config.data,f.datasets,c)},[s,f.datasets]),re.useEffect(()=>{I.current&&(s?(D(),setTimeout(k)):I.current.update(w))},[s,m,f.labels,f.datasets,w]),re.useEffect(()=>{I.current&&(D(),setTimeout(k))},[d]),re.useEffect(()=>(k(),()=>D()),[]),he("canvas",{...Object.assign({ref:C,role:"img",height:a,width:o},A),children:_})}const S5e=re.forwardRef(w5e);function UJ(n,e){return Vw.register(e),re.forwardRef((a,o)=>he(S5e,{...Object.assign({},a,{ref:o,type:n})}))}const WJ=UJ("line",ox),A5e=UJ("radar",lx);var Y6={},VJ={exports:{}};(function(n){function e(a){return a&&a.__esModule?a:{default:a}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(VJ);var GJ=VJ.exports,yI={};const E5e=GH(Mfe);var OH;function HJ(){return OH||(OH=1,function(n){"use client";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=E5e}(yI)),yI}const jJ=GH(vde);var M5e=GJ;Object.defineProperty(Y6,"__esModule",{value:!0});var K6=Y6.default=void 0,T5e=M5e(HJ()),C5e=jJ,P5e=(0,T5e.default)((0,C5e.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");K6=Y6.default=P5e;var J6={},I5e=GJ;Object.defineProperty(J6,"__esModule",{value:!0});var Q6=J6.default=void 0,L5e=I5e(HJ()),R5e=jJ,k5e=(0,L5e.default)((0,R5e.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");Q6=J6.default=k5e;const D5e=({cities:n,value:e,onChange:a})=>{const[o,s]=re.useState(null),c=!!o,d=m=>{console.log("click"),s(m.currentTarget)},f=()=>{console.log("close"),s(null)};return Bt("div",{style:{width:220,marginTop:0},children:[he(Vs,{onClick:d,endIcon:c?he(Q6,{}):he(K6,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),he(Aw,{anchorEl:o,open:c,onClose:f,children:Object.entries(n).map(([m,y])=>he(q0,{selected:y===e,onClick:()=>{f(),a(m)},children:y},m))})]})},wc={DUBAI:"Dubai",EXPO_CITY_DUBAI:"Expo City Dubai",VALPARAISO:"Valparaiso",DAR_ES_SALAAM:"Dar es Salaam",ADONI:"Adoni",NATAL:"Natal",BRAZZAVILLE:"Brazzaville",ALMATY:"Almaty",CAPE_TOWN:"Cape Town",MEXICO_CITY:"Mexico City",JAKARTA:"Jakarta",PANAMA:"Panama",AMMAN:"Amman",BANGKOK:"Bangkok",COLOMBO:"Colombo"},O5e=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":"Low","Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],QA=["Very low","Low","Average","Strong","Very strong"],$J=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],z5e=n=>{const e=document.createElement("canvas"),a=e.getContext("2d"),o=e.width/2,s=e.height/2,c=15,d=23;return a.beginPath(),a.arc(o,s,c,0,2*Math.PI,!1),a.fillStyle=n,a.fill(),a.beginPath(),a.arc(o,s,d,0,2*Math.PI,!1),a.lineWidth=1,a.strokeStyle=n,a.stroke(),e},F5e=n=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:n.map(e=>wc[e]),offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{type:"category",offset:!0,labels:QA,reverse:!0,ticks:{color:$J,font:{size:13},padding:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),N5e=(n,e)=>{const c=n.map(f=>wc[f]).map(f=>O5e.find(m=>m.City===f)).map(f=>f[e]).map(f=>QA[f-1]),d=f=>{const m=QA.indexOf(f);if(m===-1)throw new Error("Invalid value");return $J[m]};return{xLabels:n.map(f=>wc[f]),yLabels:QA,datasets:c.map((f,m)=>({label:f,data:new Array(6).fill(null).map((y,_)=>m===_?f:null),pointStyle:z5e(d(f)),showLine:!1}))}},B5e=({category:n})=>{const[e,a]=Vl.useState(Object.keys(wc).slice(0,6)),o=F5e(e),s=N5e(e,n);return Bt("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[he(WJ,{width:"1260px",height:"330px",options:o,data:s}),he("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:e.map((c,d)=>he(D5e,{cities:wc,onChange:f=>{a(m=>{const y=[...m];return y[d]=f,y})},value:wc[c]},c))})]})},zH=({label:n,color:e,cities:a,position:o,onClick:s})=>{const[c,d]=re.useState(n),[f,m]=re.useState(null),y=!!f,_=A=>{m(A.currentTarget)},w=()=>{m(null)};return Bt("div",{children:[he(Vs,{onClick:_,children:Bt("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[he("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),he("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:c}),o!==0&&he("div",{style:{marginLeft:"1vh"},children:he("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),he(Aw,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:f,open:y,onClose:w,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:a==null?void 0:a.map((A,C)=>he(q0,{onClick:()=>{d(A),s==null||s(A,o),w()},children:A},A))})]})},Gw=Mc()({root:{padding:0,margin:0,color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),U5e=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.5469712757516376},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:1.378},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:4,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:5,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:0},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",value:1,natural_value:"no"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:1,natural_value:"no"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Panama",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:127},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:1,natural_value:"no"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:5,natural_value:"yes"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]}],W5e=n=>{const e=n.split(" "),a=[];let o="";for(let s=0;s<e.length;s++)o.length+e[s].length<30?o+=e[s]+" ":(a.push(o),o=e[s]+" ");return a.push(o),a},FH=(n,e)=>U5e.find(a=>a.city===n).data.filter(a=>a.category===e).map(({category:a,indicator:o,value:s})=>({category:a,indicator:o,value:s})),pb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],V5e=({city:n,category:e})=>{Gw();const a=BK.filter(_=>n!==_),[o,s]=re.useState(a.slice(0,5)),c=FH(n,e),d=o.map(_=>FH(_,e)),f={labels:c.map(_=>W5e(_.indicator)),datasets:[c,...d].map((_,w)=>({label:w?o[w-1]:n,backgroundColor:"transparent",borderWidth:w===0?8:1,borderColor:pb[w],pointBackgroundColor:pb[w],pointBorderColor:pb[w],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:_.map(A=>A.value)}))},m=(_,w)=>{s(A=>{const C=[...A];return C[w-1]=_,C})};return Bt(rd,{children:[he(A5e,{style:{position:"absolute",top:"50%",right:"4vh",transform:"translateY(-50%)",boxSizing:"border-box",display:"block",height:805,width:1e3},data:f,options:{responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},suggestedMin:0}}}}),Bt("div",{style:{boxSizing:"border-box",position:"absolute",left:"8vh",top:"30vh"},children:[he(zH,{label:n,color:pb[0],position:0}),o.map((_,w)=>he(zH,{label:_,color:pb[w+1],cities:a,position:w+1,onClick:m},_))]})]})},G5e=({cities:n,value:e,onChange:a})=>{const[o,s]=re.useState(null),c=!!o,d=m=>{s(m.currentTarget)},f=()=>{s(null)};return Bt("div",{style:{width:220,marginTop:0},children:[he(Vs,{onClick:d,endIcon:c?he(Q6,{}):he(K6,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),he(Aw,{anchorEl:o,open:c,onClose:f,children:Object.entries(n).map(([m,y])=>he(q0,{selected:y===e,onClick:()=>{f(),a(m)},children:y},m))})]})},H5e=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.5469712757516376},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:1.378},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:4,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:5,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:0},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",value:1,natural_value:"no"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:1,natural_value:"no"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Panama",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:127},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:1,natural_value:"no"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:5,natural_value:"yes"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]}],j5e=["Very low","Low","Average","Strong","Very strong"],$5e=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],q5e=n=>{const e=document.createElement("canvas"),a=e.getContext("2d"),o=e.width/2,s=e.height/2,c=15,d=23;return a.beginPath(),a.arc(o,s,c,0,2*Math.PI,!1),a.fillStyle=n,a.fill(),a.beginPath(),a.arc(o,s,d,0,2*Math.PI,!1),a.lineWidth=1,a.strokeStyle=n,a.stroke(),e},X5e=n=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{labels:n.map(e=>wc[e]),offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{suggestedMin:0,ticks:{color:"rgba(255, 255, 255, 0.3)",font:{size:13},padding:10,maxTicksLimit:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),Z5e=(n,e,a)=>{const s=n.map(d=>wc[d]).map(d=>H5e.find(f=>f.city===d)).map(d=>({...d.data.find(f=>f.category===e&&f.indicator===a),city:d.city})),c=d=>$5e[d-1];return{xLabels:n.map(d=>wc[d]),yLabels:j5e,datasets:s.map((d,f)=>({label:d.city,data:new Array(6).fill(null).map((m,y)=>f===y?d.natural_value:null),pointStyle:q5e(c(d.value)),showLine:!1}))}},vI=({category:n,indicator:e})=>{const[a,o]=Vl.useState(Object.keys(wc).slice(0,6)),s=X5e(a),c=Z5e(a,n,e);return Bt("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[he(WJ,{width:"1260px",height:"330px",options:s,data:c}),he("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:a.map((d,f)=>he(G5e,{cities:wc,onChange:m=>{o(y=>{const _=[...y];return _[f]=m,_})},value:wc[d]},d))})]})},NH={Air_pollution:`The Air Pollution category assesses the levels of air pollutants impacting the urban environment and residents. Air pollution directly affects public health, quality of life, and the environment in cities. In the Global South, this issue is particularly acute for many urban areas as industrialization and motorization rates here are still on the rise.\r
\r
We measure the concentration of the most important pollutants based on World Health Organization guidelines[2]. These indicators help us to evaluate the extent of air pollution and its impact on human health and the environment, enabling cities to take informed actions to reduce pollution.`,Water_pollution:`The Water Pollution category evaluates the quality of water sources and the impact of pollution on the urban environment and communities. Adequate clean water supply is essential for public health and the natural environment. Particularly, in the Global South, where access to safe water is often limited, while pollution sources are diverse.\r
\r
We measure the levels of contamination from pollutants, industrial waste, and inadequate sanitation based on the WHO standards while also evaluating the effectiveness of local efforts to mitigate water pollution and safeguard the health and well-being of their communities. These indicators help us to determine the extent of water pollution and the effectiveness of purification methods, gauging efforts to ensure clean and safe water.`,Land_use_and_waste:`The Land Use and Waste category assesses how cities manage land resources and handle waste. The issue of land and waste directly impacts urban development and environmental sustainability. Rapid urbanization and resource constraints in the Global South pose distinct challenges to land use and waste management. The category also evaluates a city's efforts to expand green spaces and promote environmental sustainability. Urban greening directly affects livability, health, and resilience to climate change. Vegetation cover mitigates the effect of urban heat island cooling the environment. In the Global South, where rapid urbanization and environmental challenges it causes lead to significant inequalities, greening initiatives are crucial for improving quality of life.\r
\r
We measure land use practices, waste management methods, recycling rates, as well as waste disposal practices based on extensive scientific research. These indicators are designed to evaluate sustainable land management, waste reduction, and environmental protection that guide cities toward eco-friendliness.`,Natural_disaster_hazards:`The Natural Disaster Hazards category aims to assess a city's vulnerability to natural disasters and its capacity to mitigate their impact. For cities around the world, the problem of natural disasters is particularly acute due to higher population densities that multiply the damage caused by natural hazards. In the environmental and social settings of the Global South, this often becomes a key challenge for community safety.\r
\r
We measure resilience by evaluating natural conditions that can exacerbate the situation, as well as past records of extreme events including their type and volume of damage caused based on recent scientific studies. These indicators evaluate the impact of natural disasters on communities and overall sustainability.`,Water_availability:`The Water Availability category evaluates access to water resources. Water scarcity issues and population growth in many urban areas of the Global South make this issue essential for ensuring equitable access to drinking and technical water.\r
\r
It assesses the adequacy of water supply, and its affordability considering the cities' capacity to ensure equitable and sustainable access to water and sanitation services for their residents. These indicators reflect how cities address water security, resilience, and equitable access to such a vital resource.`,Food_availability:`The Food Availability category evaluates access to and availability of food resources. This category is often crucial in the Global South due to food security concerns, vulnerable populations, and sustainability challenges. This category is essential to consider as it measures equitable access to nutritious food addressing hunger and malnutrition.\r
\r
We capture and measure data on food supply chains and access to food. This assessment is designed to measure the cities' capacity to ensure a consistent and accessible food supply, as well as their ability to address hunger and nutritional requirements for their residents.`,Energy_availability:`The Energy Availability category specifically targets challenges related to ensuring reliable energy access, affordability, and sustainability of generation sources. It is essential in the Global South due to energy access disparities, sustainability challenges, and rapid economic development.\r
\r
We capture and measure data on energy infrastructure, electricity access, energy efficiency, and renewable energy adoption. This evaluation is intended to measure the cities' capacity to provide affordable and renewable energy for their residents, while also promoting environmental sustainability.`,Health:`The Health category assesses a city's healthcare infrastructure and residents access to healthcare. It centers on the distinct healthcare challenges faced by urban areas in the Global South, including intrinsic burdens of diseases that impact public health, healthcare infrastructure, and overall well-being. \r
\r
We capture and measure data on healthcare access, disease prevention, healthcare quality, and public health outcomes based on the extensive SDG-related WHO guidelines. This evaluation is crafted to assess the cities ability to deliver quality healthcare, reduce mortality rates, and enhance the well-being of residents, while also addressing their unique healthcare needs and challenges.`,Education:`The Education category assesses a citys commitment to high-quality education, access to schools, and educational outcomes. It addresses the unique educational challenges faced by the cities in the Global South due to their generally higher share of the younger population, including issues related to access, quality, and educational attainment.\r
\r
We capture and measure data on educational infrastructure, enrollment rates, as well as literacy and numeracy skills in line with the UN recommendations. This assessment aims to evaluate the cities capacity to provide accessible, high-quality education, promote educational attainment, and offer lifelong learning opportunities for their residents while addressing their specific educational needs and challenges.`,Wealth:`The Wealth category assesses a citys economic well-being and income distribution. This issue is crucial for the growing economies in the Global South facing vast disparities and poverty challenges.\r
\r
We capture and measure data on income distribution, poverty rates, and economic opportunities based on international practices. This assessment aims to evaluate the cities' capacity to address economic disparities, reduce poverty, and enhance economic well-being for their residents while considering their unique economic challenges.`,Safety:`The Safety category addresses issues related to road safety, crime, and overall safety. These challenges are inherent to cities of the Global South experiencing population growth, poverty, and increasing motorization rates. \r
\r
We capture and measure data on crime and traffic accident rates and law enforcement effectiveness based on substantive scientific research. This assessment aims to evaluate the cities ability to enhance safety, reduce crime, and promote overall security for their residents while addressing their safety challenges and concerns.`,Livability:`The Livability category assesses a city's quality of life, infrastructure, and overall living conditions. These challenges are quite acute for the rapidly changing urban environment in the Global South where authorities seek to improve living conditions and have to focus on infrastructure development.\r
\r
We capture and measure data on housing and infrastructure quality standards, communications, and basic healthcare service availability as well as public perception of this complex category. This evaluation is designed to assess the cities' efforts in promoting environmentally sustainable and livable urban environments, addressing infrastructure and accessibility challenges, and enhancing the overall quality of life for their residents.`,Transport:`The Transport category assesses a city's transportation and mobility infrastructure and accessibility. We address here the specific transportation challenges and infrastructure issues that rapidly urbanizing areas in the Global South face, including issues related to traffic congestion, accessibility, and public transportation.\r
\r
We capture and measure data on the outcomes of transport policies regarding public transit infrastructure, its accessibility, affordability and performance, traffic congestion, and green initiatives based on broad scientific evidence. This assessment aims to evaluate the cities transportation system performance that defines the mobility of their residents.`,Inclusion:`The Inclusion category assesses a citys commitment to inclusivity and equity, ensuring that all residents have equal access to opportunities and services. This category is crucial in the Global South as it addresses social disparities, discrimination, and social justice issues.\r
\r
We capture and measure data on social equity, access to education and healthcare, economic opportunities, and the presence of anti-discrimination policies based on extensive research. This assessment aims to evaluate the cities performance regarding social inclusion, gender equity, and support for groups at risk.`,Accountability:`The Accountability category assesses a citys commitment to transparency, governance, and accountability. This category is crucial in the Global South where the potential for change is maximized through the promotion of good governance and responsible public resources use.\r
\r
This assessment aims to evaluate cities commitment to transparent governance, accountability in resource allocation, and overall effective administration. This category shows how cities ensure responsible resource management, citizens trust, and effective governance.`,City_budget:`The City Budget category evaluates a citys financial management, allocation of funds, and budget transparency. The topic is of higher importance for the Global South as it encompasses the stability of government financial planning.\r
\r
We capture and measure data on budget allocations to essential services, financial transparency, fiscal responsibility, and adherence to financial sustainability principles. This assessment aims to evaluate the cities' capacity to manage their budgets effectively, ensure fiscal stability, and plan for long-term financial sustainability.`,SME:`The SME category evaluates a city's support for and the impact of SMEs on the local economy. SMEs in the Global South are a significant source of employment and economic growth. It is crucial for fostering local businesses and reducing unemployment. \r
\r
We capture and measure data on employment generation, business sustainability, and innovation related to SMEs and entrepreneurship. This assessment aims to evaluate the cities efforts in promoting a vibrant entrepreneurial ecosystem, supporting small and medium-sized enterprises.`,Public_services:`The Public Services category assesses the quality and accessibility of essential government and municipal services. This category is crucial in the Global South due to disparities in access to services. It is essential for improving living standards, health, and social equity.\r
\r
We capture and measure data on the availability and performance of key government services. This evaluation aims to represent the citys commitment to public service digitalization, efficient emergency response, and citizen engagement in the context of government services`,Sustainability_commitment:`The Sustainability Commitment category assesses a city's dedication and efforts to promote sustainability and environmental responsibility. This category is critical in the Global South because of the more pronounced need to prioritize sustainable development, resilience, and environmental stewardship.\r
\r
We capture and measure a city's sustainability policies, initiatives, and their effectiveness. This assessment aims to evaluate the cities' dedication to sustainable development, ESG principles, and the UN Sustainable Development Goals to build community resilience.`},qJ=({city:n,category:e,setClickedCategory:a})=>{const{classes:o}=hEe(),[s,c]=re.useState(!0),d=()=>{c(!s)},f=e.replace(" ","_"),m=Object.keys(NH).includes(f)?NH[f]:"No description available";return console.log("category",e),Bt("div",{className:o.backgroundWrapper,children:[Bt("div",{onClick:()=>{a(null)},className:o.returnBack,children:[he("img",{className:o.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),he(Ws,{className:o.returnBackText,children:"Back to Urban resilience index"})]}),Bt("div",{className:o.content,children:[Bt("div",{className:o.blueSection,children:[he(pEe,{title:e,text:m}),he(B5e,{category:e})]}),Bt("div",{className:o.whiteSection,children:[Bt("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:[Bt("div",{className:o.title,style:{color:"#000000",fontFamily:"SuisseIntl-Light"},children:["Indicators of"," "]}),he("div",{className:o.title,style:{color:"#2D67FF"},children:e})]}),he(V5e,{category:e,city:n})]}),(e==="Wealth"||e==="Water availability")&&he("div",{className:o.blueSection,children:e==="Wealth"?Bt(rd,{children:[Bt("div",{style:{position:"absolute",top:"4vh",left:"8vh",display:"flex",flexDirection:"row",alignItems:"left",justifyContent:"left",gap:"1vw"},children:[he("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{cursor:"pointer"},onClick:d}),he("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{cursor:"pointer",transform:"rotate(180deg)"},onClick:d})]}),s?Bt(rd,{children:[he("div",{style:{position:"absolute",top:"16vh",left:"8vh"},children:Bt("div",{className:o.title,style:{fontSize:"6vh"},children:["Disposable monthly income",he("br",{}),he("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"US dollars thousand"})]})}),he(vI,{category:"Wealth",indicator:"Disposable monthly income"})]}):Bt(rd,{children:[he("div",{style:{position:"absolute",top:"16vh",left:"8vh"},children:Bt("div",{className:o.title,style:{fontSize:"6vh"},children:["Perception of wealth & poverty index",he("br",{}),he("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"index"})]})}),he(vI,{category:"Wealth",indicator:"Perception of wealth & poverty index"})]})]}):Bt(rd,{children:[he("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:Bt("div",{className:o.title,style:{fontSize:"6vh"},children:["Percentage of population with access to drinking water",he("br",{}),he("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"%"})]})}),he(vI,{category:"Water availability",indicator:"Percentage of population with access to drinking water"})]})})]})]})};Mc()({closeBtn:{background:"#2D67FF",width:45,height:45,position:"absolute",top:0,left:70},text:{color:"#FFF",fontSize:18,fontWeight:300,position:"absolute",top:85,right:70,width:710},fat:{fontWeight:"500 !important"},content:{padding:70,border:"1px solid #000",position:"relative",width:1335,"& h2":{fontSize:60,fontWeight:300,letterSpacing:"-1.2px",position:"absolute",top:70,left:70,lineHeight:"70px"}},blue:{backgroundColor:"#1433AE",color:"#FFF"},white:{backgroundColor:"#FFF",color:"#000"}});const Y5e=({selectedCityName:n})=>{const{classes:e}=mT(),a=qk(),o=k6.find(s=>s.City===n);return Bt(rd,{children:[o&&Bt("div",{className:e.root,children:[Bt("div",{className:e.titleWrapper,children:[Bt("div",{className:e.cityNameAndCountryNameWrapper,children:[he("div",{className:e.cityName,children:n}),he("div",{className:e.countryName,children:o.Country})]}),Bt("div",{className:e.cityDescription,children:["Largest city in the",he("br",{}),"country, centre ",he("br",{}),"of region",he("br",{})]})]}),Bt("div",{className:e.statWrapper,children:[he(iI,{color:"#FF3B29",title:"Population",value:o.Population,status:o["Population description"]}),he(iI,{color:"#FF3B29",title:"Population density",value:o["Population density"]+" people/ha",status:o["Population density description"]}),he(iI,{color:"#2D67FF",title:"Climate",value:o.Climate,status:o["Climate description"]})]}),Bt("div",{style:{display:"flex",marginTop:"3.7vh",marginLeft:"-2.1vh",paddingLeft:"2vh",borderLeft:"1px solid #fff",height:"auto"},children:[Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto"},children:[he(a0,{label:"Urban resilience index",status:o["Urban Resilience Index"],isFirst:!0}),Bt("div",{className:e.smallItemsListWrapper,children:[he(ru,{label:"Environmental",status:o.Environmental}),he(ru,{label:"Social",status:o.Social}),he(ru,{label:"Governmental",status:o.Governmental})]}),he("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:he(ru,{label:"Ability & Willingness",status:o["Ability & Willingness"]})})]}),Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[he(a0,{label:"Basic needs",subLabel:"Scope 0",status:o["Basic needs Scope"]}),he(a0,{label:"Transport resilience index",status:o["Transport Resilience Index"]})]}),Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[he(a0,{label:"Natural risk exposure",status:o["Natural Risk Exposure"]}),he(a0,{label:"Urban sentiment index",status:o["Urban Sentiment Index"]})]})]})]}),he(uEe,{selectedCityName:n}),he(Vs,{onClick:()=>{a("/city/"+n)},style:{position:"absolute",bottom:"9vh",right:"10vh",width:"20vh",height:"6.5vh",borderRadius:50,zIndex:1e3,background:"#2D67FF",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"3vh",fontWeight:100,textTransform:"none"},children:"Subscribe"}),he("div",{className:e.bottomWrapper,style:{position:"absolute",margin:"unset",bottom:"3vh"},children:Bt("div",{className:e.smallTextWrapper,children:[he(Ws,{className:e.smallText,children:"How the rating works"}),he("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]})}),he("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"15vh",right:"30%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."})]})},K5e=()=>{const[n,e]=re.useState("map"),[a,o]=re.useState(null),[s,c]=re.useState(null);return Bt(_ve,{backgroundColor:"#2429B5",children:[he(xve,{isCitySelected:!!s,setSelectedCity:c}),s?he(Y5e,{selectedCityName:s}):he(QAe,{map:a,currentView:n,setCurrentView:e,isZoomButtonsVisible:n==="map"}),n==="graph"&&!s&&he(rEe,{setSelectedCity:c}),n==="map"&&!s&&he(sEe,{setMap:o,setSelectedCity:c})]})},XJ=Mc()({root:{position:"absolute",overflowY:"scroll",backgroundColor:"#203CBF",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},sticky:{position:"sticky",top:0,left:0,right:0,zIndex:1}}),BH=({label:n,color:e,cities:a,position:o,onClick:s})=>{const[c,d]=re.useState(n),[f,m]=re.useState(null),y=!!f,_=A=>{m(A.currentTarget)},w=()=>{m(null)};return Bt("div",{children:[he(Vs,{id:"demo-positioned-button","aria-controls":y?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":y?"true":void 0,onClick:a?_:void 0,disabled:!a,children:Bt("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[he("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),he("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:c}),o!==0&&he("div",{style:{marginLeft:"1vh"},children:he("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),he(Aw,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:f,open:y,onClose:w,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:a==null?void 0:a.map((A,C)=>he(q0,{onClick:()=>{d(A),s==null||s(A,o),w()},children:A},A))})]})};Vw.register(..._5e);const J5e=({chartData:n})=>{const e=s=>n,a=re.useRef(null),o=s=>{var d;if(!s)return;const c=s.getContext("2d");c&&((d=a.current)==null||d.destroy(),a.current=new Vw(c,{type:"radar",data:e(),options:{plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{pointLabels:{font:{size:18}}}}}}))};return re.useEffect(()=>{a.current&&(a.current.data=e(),a.current.update())},[n]),he("canvas",{ref:o})},ZJ=re.createContext(void 0),uu=()=>{const n=re.useContext(ZJ);if(!n)throw new Error("useSelectedCityData must be used within a CityDataProvider");return n},Q5e=({children:n})=>{const{classes:e}=Gw(),a=uu();return Bt("div",{className:e.contentWrapper,children:[Bt("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column",zIndex:1e3},children:[Bt("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},children:[he("b",{children:"Transport"})," resilience",he("br",{}),"index",he("span",{style:{paddingTop:"-1.5vh",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1.4vh 2vh",verticalAlign:"middle",backgroundColor:bh[a==null?void 0:a["Transport Resilience Index"].toUpperCase()]?bh[a==null?void 0:a["Transport Resilience Index"].toUpperCase()]:"#A0DA8B",color:"#000",borderRadius:50,width:"fit-content"},children:a==null?void 0:a["Transport Resilience Index"]})]}),he("div",{style:{display:"flex",flexDirection:"column",gap:".5vh",marginTop:"9vh"},children:n})]}),he("div",{className:e.pageContainer,children:Bt("div",{className:e.bottomWrapper,children:[he("div",{className:e.smallTextWrapper}),he("div",{}),Bt(Vs,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[he("div",{children:"Download report"}),he("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})},mb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],e4e=()=>{const{classes:n}=Gw(),[e,a]=re.useState({}),o=uu(),s=BK.filter(m=>m!==o.City),[c,d]=re.useState(s.slice(0,5));re.useEffect(()=>{const m=k6.filter(w=>c.includes(w.City)),y=[o,...m].map((w,A)=>({label:w.City,backgroundColor:"transparent",borderWidth:A===0?8:1,borderColor:mb[A],pointBackgroundColor:mb[A],pointBorderColor:mb[A],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:[w.tr_graph.Efficiency,w.tr_graph.Accessibility,w.tr_graph.Safety,w.tr_graph.Affordability,w.tr_graph["Environmental impact"],w.tr_graph.Satisfaction]}));a({labels:["Efficiency","Accessibility","Safety","Affordability","Environmental impact","Satisfaction"],datasets:y})},[c]);const f=(m,y)=>{d(_=>{const w=[..._];return w[y-1]=m,w})};return he("div",{style:{position:"relative",backgroundColor:"#fff"},children:Bt("div",{className:n.root,children:[he("div",{style:{position:"absolute",top:"15vh",right:"35vh",width:"80vh",zIndex:9999},children:he(J5e,{chartData:e})}),Bt(Q5e,{children:[he(BH,{label:o.City,color:mb[0],position:0}),c.map((m,y)=>he(BH,{label:m,color:mb[y+1],cities:s,position:y+1,onClick:f},m))]})]})})},t4e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},n4e=({invertColors:n})=>{const e=s=>t4e[s],{classes:a}=wX(),o=qk();return Bt("div",{className:a.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[he("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:Bt("div",{className:a.menuIconWrapper,children:[Bt("div",{onClick:()=>{o("/")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[he("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),he(Ws,{className:a.whiteText,style:{color:n?"#000":"#fff"},children:e("back")})]}),n?he("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):he("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),he(Ws,{className:a.whiteText,style:{color:n?"#000":"#fff"},children:e("menu")})]})}),n?he("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):he("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Bt("div",{className:a.buttonsWrapper,children:[he(Vs,{style:{color:"#000",background:"#fff",borderRadius:50,padding:".8vh 2vh",textTransform:"none",fontFamily:"SuisseIntl-Regular",fontSize:"1.7vh"},children:"Dashboard"}),n?he("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:he("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},gb=({children:n,isActive:e})=>{const{classes:a}=XJ();return he("div",{className:`${a.sectionWrapper} `,children:n})},YJ=Mc()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),a4e=({children:n})=>{const{classes:e}=MD();return he("div",{className:e.root,children:he("div",{className:e.contentWrapper,children:n})})},i4e=({cityName:n,countryName:e})=>{const{classes:a}=YJ();return Bt("div",{className:a.titleWrapper,children:[he(Ws,{className:a.bigText,children:n}),he(Ws,{className:a.bigTextSubtitle,children:e})]})},gA=({label:n,subLabel:e,status:a,isFirst:o,filled:s})=>he(rd,{children:o?Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",textAlign:"center"},children:n}),he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",opacity:.6},children:e}),he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:a?bh[a.toUpperCase()]:"#fff",borderColor:a?`${bh[a.toUpperCase()]}30`:"#fff"},children:a})]}):Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",textAlign:"center"},children:n}),he("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:bh[a.toUpperCase()],borderColor:`${bh[a.toUpperCase()]}30`,borderWidth:1,backgroundColor:s?`${bh[a.toUpperCase()]}30`:"transparent"},children:a})]})}),r4e=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.9294491509595,31.99991210008109],zoom:10.302824376136313,bearing:101.60000000000173,pitch:49.99999999999965},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.4827698424715,9.050655704984095],zoom:10.591526871591094,bearing:0,pitch:50.01373809516397},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.7549140865068,-6.279782111773116],zoom:9.250879827490543,bearing:-171.20000000000033,pitch:43.5},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.595325073248517,-33.98842317442896],zoom:10.326397481326069,bearing:12.8,pitch:35.48000000000009},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.49418255077882,-33.02916530602038],zoom:10.663321631643026,bearing:179.0638372543699,pitch:54.5411711309316,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.258412531048407,-4.0848396587145],zoom:10.033264905407863,bearing:0,pitch:50,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.89615639234319,43.22632526745298],zoom:10.552292015558665,bearing:0,pitch:56.979999999999954,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.27052715393592,15.658568511522205],zoom:11.055099976780857,bearing:0,pitch:44.94535508727158,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],o4e=({selectedCityName:n,setMap:e})=>{vd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const a=re.useRef(null),o=re.useRef(null);return re.useEffect(()=>{var c;if(o.current||!a.current)return;const s=(c=r4e.find(d=>d.properties.City_Name===n))==null?void 0:c.properties;o.current=new vd.Map({attributionControl:!0,container:a.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:s==null?void 0:s.center,zoom:s==null?void 0:s.zoom,bearing:s==null?void 0:s.bearing,pitch:s==null?void 0:s.pitch}),o.current.on("load",()=>{if(!o.current)return;o.current.resize();let d,f,m=!1;function y(_){d===void 0&&(d=_);const w=_-d;if(f!==_){const A=Math.min(24e-5*w,.6);o.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",A),A===1&&(m=!0)}w<2500&&(f=_,m||requestAnimationFrame(y))}y(0)}),e(o.current)},[]),he("div",{ref:a,style:{pointerEvents:"none",position:"absolute",top:"10vh",right:"0",width:"100%",height:"90vh"}})},s4e=({map:n})=>Bt("div",{style:{userSelect:"none",position:"absolute",right:"40vh",bottom:"3vh",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[he("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:he("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),he("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:he("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),l4e=({setActiveSection:n})=>{const{classes:e}=YJ(),[a,o]=re.useState(null),s=uu();return Bt("div",{style:{position:"relative"},children:[he(o4e,{setMap:o,selectedCityName:s.City}),Bt(a4e,{children:[Bt("div",{className:e.pageContainer,children:[he(i4e,{cityName:s.City,countryName:s.Country}),Bt("div",{style:{position:"absolute",top:"30%",left:"2vh",borderLeft:"1px solid #fff",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:[he(a0,{label:"Urban resilience index",status:s["Urban Resilience Index"],isFirst:!0}),Bt("div",{className:e.smallItemsListWrapper,children:[he(ru,{label:"Environmental",status:s.Environmental}),he(ru,{label:"Social",status:s.Social}),he(ru,{label:"Governmental",status:s.Governmental})]}),he("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:he(ru,{label:"Ability & Willingness",status:s["Ability & Willingness"]})})]}),Bt("div",{style:{position:"absolute",top:"27%",right:"9vh",display:"flex",flexDirection:"column",gap:"3.2vh",height:"43.5vh"},children:[he(gA,{isFirst:!0,label:"Basic needs",subLabel:"Scope 0",status:s["Basic needs Scope"]}),he(gA,{label:"Urban sentiment index",status:s["Urban Sentiment Index"],filled:!0}),he(gA,{label:"Natural risk exposure",status:s["Natural Risk Exposure"]}),he(gA,{label:"Transport resilience index",status:s["Transport Resilience Index"],filled:!0})]}),Bt("div",{className:e.bottomWrapper,children:[Bt("div",{className:e.smallTextWrapper,children:[he(Ws,{className:e.smallText,children:"How the rating works"}),he("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),Bt("div",{children:[(s.City==="Dubai"||s.City==="Dar es Salaam")&&he(Vs,{onClick:()=>{const c=document.getElementById("landing");c.scrollTo({top:c.clientHeight*5,behavior:"smooth"})},style:{marginBottom:"5vh",backgroundColor:"#3752BA",color:"#fff",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",alignItems:"center"},children:"Geoanalytics"}),Bt("div",{onClick:()=>{const c=document.getElementById("landing");c.scrollTo({top:c.clientHeight,behavior:"smooth"})},style:{pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"column",gap:"1.2vh",alignItems:"center"},children:[he("div",{children:"Scroll down"}),he("img",{src:"/assets/arrowDown.svg",alt:"arrow down",style:{animation:"bounce 2s infinite"}})]})]}),Bt(Vs,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[he("div",{onClick:()=>{const c=s.pdfName,d=document.createElement("a");d.href=`/pdf/${c}`,d.download=c,d.click()},children:"Download report"}),he("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]}),he("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"22vh",right:"50%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."}),he(s4e,{map:a})]})]})},Qv=({label:n,value:e,status:a,color:o})=>Bt("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[he("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",textAlign:"center"},children:n}),he("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2.5vh",marginTop:".7vh",textAlign:"center"},children:e}),he("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",fontWeight:600,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#fff",color:o,borderRadius:50,width:"fit-content"},children:a})]}),c4e=({bgUrl:n,isActive:e,onClick:a})=>he("div",{onClick:a,style:{pointerEvents:"all",cursor:"pointer",height:"4.5vh",width:"4.5vh",borderRadius:"50%",border:"1px solid #fff",backgroundImage:e?"none":`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:e&&he("div",{style:{height:"10px",width:"10px",borderRadius:"50%",backgroundColor:"#fff"}})}),u4e=({imagesUrls:n,activeImageIndex:e})=>he("div",{style:{position:"absolute",width:"100%",height:"100%"},children:n.map((a,o)=>he("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:`url(${a})`,backgroundSize:"cover",backgroundPosition:"center",opacity:e===o?1:0,transition:"opacity 0.5s ease"}},o))}),d4e=({setActiveSection:n})=>{const[e,a]=re.useState(0),{classes:o}=Gw(),s=uu();return Bt("div",{style:{position:"relative"},children:[he(u4e,{imagesUrls:s.images,activeImageIndex:e}),Bt("div",{className:o.root,children:[he("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"40vh",background:"linear-gradient(180deg, rgba(0,0,0,0.4) 75%, rgba(0,0,0,0))"}}),he("div",{className:o.contentWrapper,children:Bt("div",{className:o.pageContainer,children:[Bt("div",{style:{position:"absolute",top:"15.7vh",display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh"},children:[he(Qv,{label:Bt("div",{children:["Poverty headcount ratio ",he("br",{})," at national poverty lines"]}),value:s["Poverty headcount ratio at national poverty lines"]+"of population",status:s["Poverty headcount ratio at national poverty lines description"],color:"#A0DA8B"}),he(Qv,{label:he("div",{children:"Population"}),value:s.Population,status:s["Population description"],color:"#FF3B29"}),he(Qv,{label:he("div",{children:"Climate"}),value:s.Climate,status:s["Climate description"],color:"#2D67FF"}),he(Qv,{label:he("div",{children:"Population density"}),value:s["Population density"]+"people/ha",status:s["Population density description"],color:"#FF3B29"}),he(Qv,{label:he("div",{children:"Mean salary"}),value:s["Mean salary"]+"PPP$",status:s["Mean salary description"],color:"#FF3B29"}),he(Qv,{label:Bt("div",{children:["Literacy rate among ",he("br",{}),"population (15-24 Years)"]}),value:s["Literacy rate among population"],status:s["Literacy rate among population description"],color:"#A0DA8B"})]}),Bt("div",{className:o.bottomWrapper,children:[he("div",{}),he("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:s.images.map((c,d)=>he(c4e,{bgUrl:c,onClick:()=>{a(d)},isActive:e===d},d))}),Bt(Vs,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},children:[he("div",{onClick:()=>{const c=s.pdfName,d=document.createElement("a");d.href=`/pdf/${c}`,d.download=c,d.click()},children:"Download report"}),he("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]})})]})]})},_I=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":2,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],bI=({children:n,side:e,setHoveredSide:a,setClickedCategory:o})=>{const[s,c]=re.useState(!1);return Bt("div",{onMouseEnter:()=>{c(!0),a(e)},onMouseLeave:()=>{c(!1),a(null)},style:{border:s?"1px solid #fff":"none",position:"absolute",backgroundImage:"url(/assets/cube_solid_bg.png)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",height:e==="top"?"40.6vh":"45vh",width:e==="top"?"45.6vh":"45vh",padding:"2vh 1vh",boxSizing:"border-box",top:e==="left"?"40vh":e==="right"?"40.1vh":"16.4vh",right:e==="left"?"55.1vh":e==="right"?"24.9vh":"39.7vh",transform:e==="left"?"skew(0deg, 35.5deg) scale(0.67)":e==="right"?"skew(0deg, -35.5deg) scale(0.67)":"rotate3d(1.1, 0.7, 1.2, -63.7deg)"},children:[n,he("div",{style:{position:"absolute",bottom:"2vh",right:"2vh",fontFamily:"SuisseIntl-Light",fontSize:"2vh",opacity:s?1:.7},children:e==="left"?"Environment":e==="right"?"Governmental":"Social"})]})},xI=({title:n,color:e,setClickedCategory:a})=>{const[o,s]=re.useState(!1);return he("div",{onClick:()=>{a(n)},onMouseOver:()=>{s(!0)},onMouseOut:()=>{s(!1)},style:{cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"2.1vh",color:"#fff"},children:Bt("div",{style:{width:"fit-content",height:"fit-content",backgroundColor:o?e:"transparent",borderRadius:"32px",display:"flex",alignItems:"center",flexDirection:"row",padding:".6vh 2vh",gap:"1.5vh"},children:[he("div",{children:n}),he("div",{style:{width:"2vh",height:"2vh",backgroundColor:o?"#fff":e,borderRadius:"50%"}})]})})},yA=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],wI={left:["Air pollution","Water pollution","Land use and waste","Natural disaster hazards"],right:["Accountability","City budget","SME","Public services","Sustainability commitment"],top:["Water availability","Food availability","Energy availability","Health","Education","Wealth","Safety","Livability","Transport","Inclusion"]},h4e=({setHoveredSide:n,setClickedCategory:e})=>Bt("div",{style:{zIndex:1,width:"60vw",height:"100vh",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",alignItems:"center",justifyContent:"center"},children:[he(bI,{side:"left",setHoveredSide:n,children:he("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:wI.left.map(a=>{const s=uu().City,d=_I.find(m=>m.City===s)[a],f=yA[d-1]?yA[d-1]:"#FF632F";return he(xI,{title:a,color:f,setClickedCategory:e},a)})})}),he(bI,{side:"right",setHoveredSide:n,setClickedCategory:e,children:he("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:wI.right.map(a=>{const s=uu().City,d=_I.find(f=>f.City===s)[a];return he(xI,{title:a,color:yA[d-1],setClickedCategory:e},a)})})}),he(bI,{side:"top",setHoveredSide:n,setClickedCategory:e,children:he("div",{style:{display:"flex",flexDirection:"column",gap:"-1vh"},children:wI.top.map(a=>{const s=uu().City,d=_I.find(f=>f.City===s)[a];return he(xI,{title:a,color:yA[d-1],setClickedCategory:e},a)})})})]}),f4e=({clickedCategory:n,setClickedCategory:e})=>{const{classes:a}=Gw(),[o,s]=re.useState(null),[c,d]=re.useState(null),f=uu();return re.useEffect(()=>{const m=dEe.find(A=>A.city===f.City),y=m.E,_=m.S,w=m.G;d(o==="left"?y:o==="top"?_:o==="right"?w:null)},[o]),re.useEffect(()=>{console.log(n)},[n]),he(rd,{children:he("div",{style:{position:"relative",backgroundImage:"url(/assets/new_bg_cube.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:Bt("div",{className:a.root,children:[he(h4e,{setHoveredSide:s,setClickedCategory:e}),Bt("div",{className:a.contentWrapper,children:[Bt("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column"},children:[Bt("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#fff"},children:["Urban ",he("b",{children:"resilience"}),he("br",{}),"index",he("span",{style:{paddingTop:"-1.5vh",verticalAlign:"middle",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#FF632F",color:"#fff",borderRadius:50,width:"fit-content"},children:f["Urban Resilience Index"]})]}),he("div",{style:{position:"absolute",top:"22vh",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:Bt("div",{className:a.smallItemsListWrapper,children:[he(ru,{label:"Environmental",status:f.Environmental}),he(ru,{label:"Social",status:f.Social}),he(ru,{label:"Governmental",status:f.Governmental})]})})]}),Bt("div",{style:{position:"absolute",top:"33%",lineHeight:"1.5",right:"5vh",width:"30vh",fontFamily:"SuisseIntl-Light",fontSize:"1.9vh"},children:[o==="left"||o==="top"||o==="right"?"Policy hints":"",he("br",{}),he("br",{}),c]}),he("div",{className:a.pageContainer,children:Bt("div",{className:a.bottomWrapper,children:[Bt("div",{className:a.smallTextWrapper,children:[he(Ws,{className:a.smallText,children:"How the rating works"}),he("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),Bt(Vs,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[he("div",{onClick:()=>{const m=f.pdfName,y=document.createElement("a");y.href=`/pdf/${m}`,y.download=m,y.click()},children:"Download report"}),he("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})]})})})},p4e=({cityData:n,children:e})=>he(ZJ.Provider,{value:n,children:e}),m4e=({setMap:n})=>{vd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{a.current||!e.current||(a.current=new vd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[55.28314923749909,25.02940197161118],zoom:10.5,bearing:0,pitch:60}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.bly9vkw2"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.3wcn7mfu"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.6j7olk89"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",12196,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],2.109820365905762,"#000004",5.94,"#50127b",9.78,"#b6377a",13.62,"#fb8761",17.892879486083984,"#fcfdbf"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","No2_mean"],1.002105474472046,"#440154",4,"#3b528b",7,"#21908d",10,"#5dc963",12.314108322964207,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5989.198242187499,"#edf8fb",6005,"#b2e2e2",6021,"#66c2a4",6037.02,"#2ca25f",6053.04296875,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],781,"#f6eff7",862.3,"#d0d6e8",925.4,"#a0bedb",939,"#67a9cf",953,"#3598ab",965,"#138484",998.3495483398436,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","UV_mean"],.703,"#cfcfcf",.85,"#b1b0af",1.1,"#a79e75",1.16,"#c5b56c",1.32,"#e5d05a",1.479856308970643,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.45878sao"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.cazbwhrj"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.cbntwjd4"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.446ij1ot"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.a1bmhhk8"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.87imwe7u"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.ddx873qu"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.d77lnwg2"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("urban cluster")||!a.current.getLayer("Population 3D"))return;const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas","urban cluster"];for(const s of o){if(document.getElementById(s))continue;const c=document.createElement("a");c.id=s,c.href="#",c.textContent=s,c.className="active",c.onclick=function(f){const m=this.textContent;f.preventDefault(),f.stopPropagation(),a.getLayoutProperty(m,"visibility")==="none"?(a.current.setLayoutProperty(m,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(m,"visibility","none"))},document.getElementById("menu").appendChild(c)}}),n(a.current))},[]),he("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},g4e=({children:n})=>he("div",{style:{position:"relative",height:"100%",width:"100%",backgroundColor:"#fff"},children:n}),y4e=({children:n})=>he("div",{style:{position:"absolute",left:"10vh",top:"15vh",zIndex:1},children:n}),v4e=Mc()({title:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},subTitle:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",color:"#000",maxWidth:"30vh",marginTop:"3vh"}}),_4e=Mc()({root:{backgroundColor:"#fff",padding:"2vh 2vh",borderRadius:20,marginTop:"3vh",display:"flex",flexDirection:"column",gap:"2vh",width:"fit-content"},populationWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),UH=({label:n,isTitle:e,isActive:a,onClick:o})=>{const[s,c]=re.useState(!1);return he("button",{onClick:o,onMouseOut:()=>!e&&c(!1),onMouseOver:()=>!e&&c(!0),style:{cursor:s?"pointer":"default",fontFamily:s||a?"SuisseIntl-Regular":"SuisseIntl-Light",fontWeight:s||a?600:400,backgroundColor:"#fff",color:a?"#2D67FF":"#000",border:"none",textAlign:"left"},children:Bt("div",{style:{pointerEvents:"all",position:"relative",fontSize:"1.8vh",width:"100%"},children:[n,n==="Population"&&he(Vye,{checked:a})]})})},b4e={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/builtupAreas.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2d.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxco.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/co.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10.svg",order:23,align:"right"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},parks:{label:"Parks",mapboxId:"Parks",order:8,align:"left"},parksServiceArea:{label:"Parks service area",mapboxId:"Parks service area",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:9,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:10,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:11,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:12,align:"left"}},x4e={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/builtupAreas.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2d.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:8,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:9,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:10,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxco.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/co.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10.svg",order:23,align:"right"}},w4e=({map:n,setLegend:e})=>{const{classes:a}=_4e(),[o,s]=re.useState({}),f=uu().City==="Dubai"?b4e:x4e;re.useEffect(()=>{n&&Object.keys(o).forEach(_=>{n.setLayoutProperty(_,"visibility",o[_]?"visible":"none")})},[o]);const m=Object.keys(f).filter(_=>f[_].align==="left"),y=Object.keys(f).filter(_=>f[_].align==="right");return he("div",{className:a.root,children:Bt("div",{style:{display:"flex",flexDirection:"row"},children:[he("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:m.map(_=>{const w=f[_],{label:A,mapboxId:C,order:I}=w,k=o[C];return he(UH,{label:A,isActive:k,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[C]:!k}),e(w.legendSvgUrl?w.legendSvgUrl:w.legendText?w.legendText:null)}},C)})}),he("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:y.map(_=>{const w=f[_],{label:A,mapboxId:C,order:I}=w,k=o[C];return he(UH,{label:A,isActive:k,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[C]:!k}),e(w.legendSvgUrl||null)}},C)})})]})})},S4e=({map:n})=>Bt("div",{style:{userSelect:"none",position:"relative",zIndex:2,height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[he("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:he("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),he("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:he("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),A4e=({setMap:n})=>{vd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{a.current||!e.current||(a.current=new vd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[39.269901998819705,-6.951262195503958],zoom:10.599919543075876,bearing:0,pitch:63}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.dpou9n43"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.8brf2wm2"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.2xkqu3zj"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",21877,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],0,"#ffffff",1.35,"#570f6e",2.7,"#bb3755",4.05,"#f98d0a",5.358946323394775,"#fcffa4"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","NO2_mean"],2.05233907699585,"#440154",2.2,"#3b528b",2.4,"#21908d",2.6,"#5dc962",2.772989511489868,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5762.0478515625,"#edf8fb",5771.03,"#b2e2e2",5780.02,"#66c2a4",5789.01,"#2ca25f",5797.997504716548,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],802.5854707726206,"#f6eff7",821,"#bdc9e1",836,"#67a9cf",851.48,"#1c9099",867.7780797321312,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","PM10_mean"],-.560415429762831,"#ffffff",-.463,"#f0f0f0",-.365,"#7d7c78",-.268,"#beaf6f",-.170282865193472,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.8z6owmcr"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.20jvy6c8"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.76qo6b2w"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.co2x6sdc"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.couih9de"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.2vtfxzn2"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.cxu2vccw"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.8u6mbzcw"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("Population 3D"))return;const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas"];for(const s of o){if(document.getElementById(s))continue;const c=document.createElement("a");c.id=s,c.href="#",c.textContent=s,c.className="active",c.onclick=function(f){const m=this.textContent;f.preventDefault(),f.stopPropagation(),a.current.getLayoutProperty(m,"visibility")==="none"?(a.current.setLayoutProperty(m,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(m,"visibility","none"))},document.getElementById("menu").appendChild(c)}console.log("A idle event occurred."),console.log("Center - "+a.current.getCenter()),console.log("Zoom - "+a.current.getZoom()),console.log("Bearing - "+a.current.getBearing()),console.log("Pitch - "+a.current.getPitch())}),n(a.current))},[]),he("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},E4e=()=>{const{classes:n}=v4e(),e=uu(),[a,o]=re.useState(null),[s,c]=re.useState(null),f=uu().City;return re.useEffect(()=>{},[s]),Bt(g4e,{children:[Bt(y4e,{children:[Bt("div",{className:n.title,children:["Geoanalytics: ",e==null?void 0:e.City]}),he(w4e,{map:a,setLegend:c})]}),f==="Dubai"&&he(m4e,{setMap:o}),f==="Dar es Salaam"&&he(A4e,{setMap:o}),Bt("div",{style:{position:"absolute",bottom:"5vh",right:"5vh",zIndex:1e3,display:"flex",flexDirection:"row",width:"fit-content",gap:"4vh",alignItems:"center"},children:[he(S4e,{map:a}),s&&s.includes("/")?he("img",{src:s}):s&&he("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",width:"10vw"},children:s})]})]})},WH=()=>{const{classes:n}=XJ(),[e,a]=re.useState(0);re.useState(!1);const[o,s]=re.useState(null),c=qk(),{cityName:d}=mce(),f=k6.find(y=>y.City===d);f||c("/");const m=y=>{const _=document.getElementById("landing"),w=_.clientHeight,A=_.scrollTop;let C=0;y=="down"?C=A+w:y=="up"&&(C=A-w),_.scrollTo({top:C,left:0,behavior:"smooth"})};return re.useEffect(()=>{const y=document.getElementById("landing");return y.addEventListener("wheel",_=>{_.deltaY<0||_.deltaY>0}),()=>{y.removeEventListener("scroll",m)}},[]),re.useEffect(()=>{const y=document.getElementById("landing");return y.addEventListener("scroll",_=>{}),()=>{y.removeEventListener("scroll",m)}},[]),re.useEffect(()=>{const y=document.getElementById("landing");y.addEventListener("scroll",_=>{const w=y.clientHeight,A=y.scrollTop,C=Math.floor(A/w);a(C)})},[]),Bt(p4e,{cityData:f,children:[he("div",{style:{position:"absolute",backgroundColor:"#203CBF",width:"100vw",height:"100vh"},children:he(n4e,{invertColors:e===3||e===4})}),Bt("div",{className:n.root,id:"landing",children:[he(gb,{isActive:e===0,sectionIndex:0,children:he(l4e,{setActiveSection:a})},0),he(gb,{isActive:e===1,sectionIndex:1,children:he(d4e,{setActiveSection:a})},1),he(gb,{isActive:e===2,sectionIndex:2,children:he(f4e,{setClickedCategory:s,clickedCategory:o})},2),he(gb,{isActive:e===3,sectionIndex:3,children:he(e4e,{})},3),((f==null?void 0:f.City)==="Dubai"||(f==null?void 0:f.City)==="Dar es Salaam")&&he(gb,{isActive:e===5,sectionIndex:5,children:he(E4e,{})},5)]}),o&&he(qJ,{category:o,city:f.City,setClickedCategory:s})]})},M4e=[{path:"/",element:he(K5e,{})},{path:"/city",element:he(WH,{}),state:{selectedCityName:"Moscow"}},{path:"/city/:cityName",element:he(WH,{})},{path:"/test",element:he(qJ,{category:"Wealth",city:"Dubai"})}],T4e=()=>prompt("Enter password")==="g"?(localStorage.setItem("user","admin"),he(JJ,{})):he("div",{children:"Wrong password"}),KJ=document.getElementById("root");if(!KJ)throw new Error("There is no root element in HTML!");const C4e=Pce(M4e),P4e=localStorage.getItem("user"),JJ=()=>he(_fe,{theme:ive,children:he(Nce,{router:C4e})});SI.createRoot(KJ).render(he(Vl.StrictMode,{children:P4e==="admin"?he(JJ,{}):T4e()}));
