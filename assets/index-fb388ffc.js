var _oe=Object.defineProperty;var boe=(n,e,a)=>e in n?_oe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var _n=(n,e,a)=>(boe(n,typeof e!="symbol"?e+"":e,a),a);function lj(n,e){for(var a=0;a<e.length;a++){const o=e[a];if(typeof o!="string"&&!Array.isArray(o)){for(const s in o)if(s!=="default"&&!(s in n)){const c=Object.getOwnPropertyDescriptor(o,s);c&&Object.defineProperty(n,s,c.get?c:{enumerable:!0,get:()=>o[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(s){if(s.ep)return;s.ep=!0;const c=a(s);fetch(s.href,c)}})();var xoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function cj(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var a=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};a.prototype=e.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(a,o,s.get?s:{enumerable:!0,get:function(){return n[o]}})}),a}var uj={exports:{}},Qa={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yw=Symbol.for("react.element"),woe=Symbol.for("react.portal"),Soe=Symbol.for("react.fragment"),Aoe=Symbol.for("react.strict_mode"),Eoe=Symbol.for("react.profiler"),Moe=Symbol.for("react.provider"),Toe=Symbol.for("react.context"),Coe=Symbol.for("react.forward_ref"),Poe=Symbol.for("react.suspense"),Ioe=Symbol.for("react.memo"),Loe=Symbol.for("react.lazy"),D9=Symbol.iterator;function Roe(n){return n===null||typeof n!="object"?null:(n=D9&&n[D9]||n["@@iterator"],typeof n=="function"?n:null)}var dj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hj=Object.assign,fj={};function u_(n,e,a){this.props=n,this.context=e,this.refs=fj,this.updater=a||dj}u_.prototype.isReactComponent={};u_.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};u_.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function pj(){}pj.prototype=u_.prototype;function hk(n,e,a){this.props=n,this.context=e,this.refs=fj,this.updater=a||dj}var fk=hk.prototype=new pj;fk.constructor=hk;hj(fk,u_.prototype);fk.isPureReactComponent=!0;var O9=Array.isArray,mj=Object.prototype.hasOwnProperty,pk={current:null},gj={key:!0,ref:!0,__self:!0,__source:!0};function yj(n,e,a){var o,s={},c=null,d=null;if(e!=null)for(o in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(c=""+e.key),e)mj.call(e,o)&&!gj.hasOwnProperty(o)&&(s[o]=e[o]);var f=arguments.length-2;if(f===1)s.children=a;else if(1<f){for(var m=Array(f),y=0;y<f;y++)m[y]=arguments[y+2];s.children=m}if(n&&n.defaultProps)for(o in f=n.defaultProps,f)s[o]===void 0&&(s[o]=f[o]);return{$$typeof:yw,type:n,key:c,ref:d,props:s,_owner:pk.current}}function koe(n,e){return{$$typeof:yw,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function mk(n){return typeof n=="object"&&n!==null&&n.$$typeof===yw}function Doe(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(a){return e[a]})}var z9=/\/+/g;function z5(n,e){return typeof n=="object"&&n!==null&&n.key!=null?Doe(""+n.key):e.toString(36)}function IA(n,e,a,o,s){var c=typeof n;(c==="undefined"||c==="boolean")&&(n=null);var d=!1;if(n===null)d=!0;else switch(c){case"string":case"number":d=!0;break;case"object":switch(n.$$typeof){case yw:case woe:d=!0}}if(d)return d=n,s=s(d),n=o===""?"."+z5(d,0):o,O9(s)?(a="",n!=null&&(a=n.replace(z9,"$&/")+"/"),IA(s,e,a,"",function(y){return y})):s!=null&&(mk(s)&&(s=koe(s,a+(!s.key||d&&d.key===s.key?"":(""+s.key).replace(z9,"$&/")+"/")+n)),e.push(s)),1;if(d=0,o=o===""?".":o+":",O9(n))for(var f=0;f<n.length;f++){c=n[f];var m=o+z5(c,f);d+=IA(c,e,a,m,s)}else if(m=Roe(n),typeof m=="function")for(n=m.call(n),f=0;!(c=n.next()).done;)c=c.value,m=o+z5(c,f++),d+=IA(c,e,a,m,s);else if(c==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function H3(n,e,a){if(n==null)return n;var o=[],s=0;return IA(n,o,"","",function(c){return e.call(a,c,s++)}),o}function Ooe(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(a){(n._status===0||n._status===-1)&&(n._status=1,n._result=a)},function(a){(n._status===0||n._status===-1)&&(n._status=2,n._result=a)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var js={current:null},LA={transition:null},zoe={ReactCurrentDispatcher:js,ReactCurrentBatchConfig:LA,ReactCurrentOwner:pk};Qa.Children={map:H3,forEach:function(n,e,a){H3(n,function(){e.apply(this,arguments)},a)},count:function(n){var e=0;return H3(n,function(){e++}),e},toArray:function(n){return H3(n,function(e){return e})||[]},only:function(n){if(!mk(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Qa.Component=u_;Qa.Fragment=Soe;Qa.Profiler=Eoe;Qa.PureComponent=hk;Qa.StrictMode=Aoe;Qa.Suspense=Poe;Qa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zoe;Qa.cloneElement=function(n,e,a){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var o=hj({},n.props),s=n.key,c=n.ref,d=n._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,d=pk.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var f=n.type.defaultProps;for(m in e)mj.call(e,m)&&!gj.hasOwnProperty(m)&&(o[m]=e[m]===void 0&&f!==void 0?f[m]:e[m])}var m=arguments.length-2;if(m===1)o.children=a;else if(1<m){f=Array(m);for(var y=0;y<m;y++)f[y]=arguments[y+2];o.children=f}return{$$typeof:yw,type:n.type,key:s,ref:c,props:o,_owner:d}};Qa.createContext=function(n){return n={$$typeof:Toe,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Moe,_context:n},n.Consumer=n};Qa.createElement=yj;Qa.createFactory=function(n){var e=yj.bind(null,n);return e.type=n,e};Qa.createRef=function(){return{current:null}};Qa.forwardRef=function(n){return{$$typeof:Coe,render:n}};Qa.isValidElement=mk;Qa.lazy=function(n){return{$$typeof:Loe,_payload:{_status:-1,_result:n},_init:Ooe}};Qa.memo=function(n,e){return{$$typeof:Ioe,type:n,compare:e===void 0?null:e}};Qa.startTransition=function(n){var e=LA.transition;LA.transition={};try{n()}finally{LA.transition=e}};Qa.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Qa.useCallback=function(n,e){return js.current.useCallback(n,e)};Qa.useContext=function(n){return js.current.useContext(n)};Qa.useDebugValue=function(){};Qa.useDeferredValue=function(n){return js.current.useDeferredValue(n)};Qa.useEffect=function(n,e){return js.current.useEffect(n,e)};Qa.useId=function(){return js.current.useId()};Qa.useImperativeHandle=function(n,e,a){return js.current.useImperativeHandle(n,e,a)};Qa.useInsertionEffect=function(n,e){return js.current.useInsertionEffect(n,e)};Qa.useLayoutEffect=function(n,e){return js.current.useLayoutEffect(n,e)};Qa.useMemo=function(n,e){return js.current.useMemo(n,e)};Qa.useReducer=function(n,e,a){return js.current.useReducer(n,e,a)};Qa.useRef=function(n){return js.current.useRef(n)};Qa.useState=function(n){return js.current.useState(n)};Qa.useSyncExternalStore=function(n,e,a){return js.current.useSyncExternalStore(n,e,a)};Qa.useTransition=function(){return js.current.useTransition()};Qa.version="18.2.0";uj.exports=Qa;var re=uj.exports;const $l=gw(re),hE=lj({__proto__:null,default:$l},[re]);var BI={},vj={exports:{}},Jl={},_j={exports:{}},bj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,pe){var Ae=le.length;le.push(pe);e:for(;0<Ae;){var ae=Ae-1>>>1,Ee=le[ae];if(0<s(Ee,pe))le[ae]=pe,le[Ae]=Ee,Ae=ae;else break e}}function a(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var pe=le[0],Ae=le.pop();if(Ae!==pe){le[0]=Ae;e:for(var ae=0,Ee=le.length,Ze=Ee>>>1;ae<Ze;){var Xe=2*(ae+1)-1,Ke=le[Xe],Ue=Xe+1,ft=le[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ft,Ke)?(le[ae]=ft,le[Ue]=Ae,ae=Ue):(le[ae]=Ke,le[Xe]=Ae,ae=Xe);else if(Ue<Ee&&0>s(ft,Ae))le[ae]=ft,le[Ue]=Ae,ae=Ue;else break e}}return pe}function s(le,pe){var Ae=le.sortIndex-pe.sortIndex;return Ae!==0?Ae:le.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,x=null,S=3,T=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(le){for(var pe=a(y);pe!==null;){if(pe.callback===null)o(y);else if(pe.startTime<=le)o(y),pe.sortIndex=pe.expirationTime,e(m,pe);else break;pe=a(y)}}function B(le){if(k=!1,F(le),!I)if(a(m)!==null)I=!0,Le(G);else{var pe=a(y);pe!==null&&Ge(B,pe.startTime-le)}}function G(le,pe){I=!1,k&&(k=!1,L(te),te=-1),T=!0;var Ae=S;try{for(F(pe),x=a(m);x!==null&&(!(x.expirationTime>pe)||le&&!ge());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=pe);pe=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===a(m)&&o(m),F(pe)}else o(m);x=a(m)}if(x!==null)var Ze=!0;else{var Xe=a(y);Xe!==null&&Ge(B,Xe.startTime-pe),Ze=!1}return Ze}finally{x=null,S=Ae,T=!1}}var q=!1,X=null,te=-1,V=5,Q=-1;function ge(){return!(n.unstable_now()-Q<V)}function me(){if(X!==null){var le=n.unstable_now();Q=le;var pe=!0;try{pe=X(!0,le)}finally{pe?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(me)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=me,be=function(){Ce.postMessage(null)}}else be=function(){D(me,0)};function Le(le){X=le,q||(q=!0,be())}function Ge(le,pe){te=D(function(){le(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Le(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var pe=3;break;default:pe=S}var Ae=S;S=pe;try{return le()}finally{S=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,pe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Ae=S;S=le;try{return pe()}finally{S=Ae}},n.unstable_scheduleCallback=function(le,pe,Ae){var ae=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ae+Ae:ae):Ae=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,le={id:_++,callback:pe,priorityLevel:le,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ae?(le.sortIndex=Ae,e(y,le),a(m)===null&&le===a(y)&&(k?(L(te),te=-1):k=!0,Ge(B,Ae-ae))):(le.sortIndex=Ee,e(m,le),I||T||(I=!0,Le(G))),le},n.unstable_shouldYield=ge,n.unstable_wrapCallback=function(le){var pe=S;return function(){var Ae=S;S=pe;try{return le.apply(this,arguments)}finally{S=Ae}}}})(bj);_j.exports=bj;var Foe=_j.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xj=re,Kl=Foe;function hn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)e+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wj=new Set,mx={};function Wg(n,e){U0(n,e),U0(n+"Capture",e)}function U0(n,e){for(mx[n]=e,n=0;n<e.length;n++)wj.add(e[n])}var Rh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),UI=Object.prototype.hasOwnProperty,Noe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,F9={},N9={};function Boe(n){return UI.call(N9,n)?!0:UI.call(F9,n)?!1:Noe.test(n)?N9[n]=!0:(F9[n]=!0,!1)}function Uoe(n,e,a,o){if(a!==null&&a.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Woe(n,e,a,o){if(e===null||typeof e>"u"||Uoe(n,e,a,o))return!0;if(o)return!1;if(a!==null)switch(a.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $s(n,e,a,o,s,c,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=s,this.mustUseProperty=a,this.propertyName=n,this.type=e,this.sanitizeURL=c,this.removeEmptyString=d}var ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ts[n]=new $s(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];ts[e]=new $s(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ts[n]=new $s(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ts[n]=new $s(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ts[n]=new $s(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ts[n]=new $s(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ts[n]=new $s(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ts[n]=new $s(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ts[n]=new $s(n,5,!1,n.toLowerCase(),null,!1,!1)});var gk=/[\-:]([a-z])/g;function yk(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(gk,yk);ts[e]=new $s(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(gk,yk);ts[e]=new $s(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(gk,yk);ts[e]=new $s(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ts[n]=new $s(n,1,!1,n.toLowerCase(),null,!1,!1)});ts.xlinkHref=new $s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ts[n]=new $s(n,1,!1,n.toLowerCase(),null,!0,!0)});function vk(n,e,a,o){var s=ts.hasOwnProperty(e)?ts[e]:null;(s!==null?s.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Woe(e,a,s,o)&&(a=null),o||s===null?Boe(e)&&(a===null?n.removeAttribute(e):n.setAttribute(e,""+a)):s.mustUseProperty?n[s.propertyName]=a===null?s.type===3?!1:"":a:(e=s.attributeName,o=s.attributeNamespace,a===null?n.removeAttribute(e):(s=s.type,a=s===3||s===4&&a===!0?"":""+a,o?n.setAttributeNS(o,e,a):n.setAttribute(e,a))))}var Uh=xj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j3=Symbol.for("react.element"),s0=Symbol.for("react.portal"),l0=Symbol.for("react.fragment"),_k=Symbol.for("react.strict_mode"),WI=Symbol.for("react.profiler"),Sj=Symbol.for("react.provider"),Aj=Symbol.for("react.context"),bk=Symbol.for("react.forward_ref"),VI=Symbol.for("react.suspense"),GI=Symbol.for("react.suspense_list"),xk=Symbol.for("react.memo"),Vf=Symbol.for("react.lazy"),Ej=Symbol.for("react.offscreen"),B9=Symbol.iterator;function F1(n){return n===null||typeof n!="object"?null:(n=B9&&n[B9]||n["@@iterator"],typeof n=="function"?n:null)}var Dr=Object.assign,F5;function Sb(n){if(F5===void 0)try{throw Error()}catch(a){var e=a.stack.trim().match(/\n( *(at )?)/);F5=e&&e[1]||""}return`
`+F5+n}var N5=!1;function B5(n,e){if(!n||N5)return"";N5=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var o=y}Reflect.construct(n,[],e)}else{try{e.call()}catch(y){o=y}n.call(e.prototype)}else{try{throw Error()}catch(y){o=y}n()}}catch(y){if(y&&o&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),c=o.stack.split(`
`),d=s.length-1,f=c.length-1;1<=d&&0<=f&&s[d]!==c[f];)f--;for(;1<=d&&0<=f;d--,f--)if(s[d]!==c[f]){if(d!==1||f!==1)do if(d--,f--,0>f||s[d]!==c[f]){var m=`
`+s[d].replace(" at new "," at ");return n.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",n.displayName)),m}while(1<=d&&0<=f);break}}}finally{N5=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?Sb(n):""}function Voe(n){switch(n.tag){case 5:return Sb(n.type);case 16:return Sb("Lazy");case 13:return Sb("Suspense");case 19:return Sb("SuspenseList");case 0:case 2:case 15:return n=B5(n.type,!1),n;case 11:return n=B5(n.type.render,!1),n;case 1:return n=B5(n.type,!0),n;default:return""}}function HI(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case l0:return"Fragment";case s0:return"Portal";case WI:return"Profiler";case _k:return"StrictMode";case VI:return"Suspense";case GI:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Aj:return(n.displayName||"Context")+".Consumer";case Sj:return(n._context.displayName||"Context")+".Provider";case bk:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case xk:return e=n.displayName||null,e!==null?e:HI(n.type)||"Memo";case Vf:e=n._payload,n=n._init;try{return HI(n(e))}catch{}}return null}function Goe(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return HI(e);case 8:return e===_k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function mp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Mj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Hoe(n){var e=Mj(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),o=""+n[e];if(!n.hasOwnProperty(e)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var s=a.get,c=a.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(d){o=""+d,c.call(this,d)}}),Object.defineProperty(n,e,{enumerable:a.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function $3(n){n._valueTracker||(n._valueTracker=Hoe(n))}function Tj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var a=e.getValue(),o="";return n&&(o=Mj(n)?n.checked?"true":"false":n.value),n=o,n!==a?(e.setValue(n),!0):!1}function fE(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function jI(n,e){var a=e.checked;return Dr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function U9(n,e){var a=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;a=mp(e.value!=null?e.value:a),n._wrapperState={initialChecked:o,initialValue:a,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Cj(n,e){e=e.checked,e!=null&&vk(n,"checked",e,!1)}function $I(n,e){Cj(n,e);var a=mp(e.value),o=e.type;if(a!=null)o==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(o==="submit"||o==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?qI(n,e.type,a):e.hasOwnProperty("defaultValue")&&qI(n,e.type,mp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function W9(n,e,a){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,a||e===n.value||(n.value=e),n.defaultValue=e}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function qI(n,e,a){(e!=="number"||fE(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var Ab=Array.isArray;function M0(n,e,a,o){if(n=n.options,e){e={};for(var s=0;s<a.length;s++)e["$"+a[s]]=!0;for(a=0;a<n.length;a++)s=e.hasOwnProperty("$"+n[a].value),n[a].selected!==s&&(n[a].selected=s),s&&o&&(n[a].defaultSelected=!0)}else{for(a=""+mp(a),e=null,s=0;s<n.length;s++){if(n[s].value===a){n[s].selected=!0,o&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function XI(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(hn(91));return Dr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function V9(n,e){var a=e.value;if(a==null){if(a=e.children,e=e.defaultValue,a!=null){if(e!=null)throw Error(hn(92));if(Ab(a)){if(1<a.length)throw Error(hn(93));a=a[0]}e=a}e==null&&(e=""),a=e}n._wrapperState={initialValue:mp(a)}}function Pj(n,e){var a=mp(e.value),o=mp(e.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),e.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),o!=null&&(n.defaultValue=""+o)}function G9(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Ij(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function YI(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Ij(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var q3,Lj=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,a,o,s){MSApp.execUnsafeLocalFunction(function(){return n(e,a,o,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(q3=q3||document.createElement("div"),q3.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=q3.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function gx(n,e){if(e){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=e;return}}n.textContent=e}var Fb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},joe=["Webkit","ms","Moz","O"];Object.keys(Fb).forEach(function(n){joe.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Fb[e]=Fb[n]})});function Rj(n,e,a){return e==null||typeof e=="boolean"||e===""?"":a||typeof e!="number"||e===0||Fb.hasOwnProperty(n)&&Fb[n]?(""+e).trim():e+"px"}function kj(n,e){n=n.style;for(var a in e)if(e.hasOwnProperty(a)){var o=a.indexOf("--")===0,s=Rj(a,e[a],o);a==="float"&&(a="cssFloat"),o?n.setProperty(a,s):n[a]=s}}var $oe=Dr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ZI(n,e){if(e){if($oe[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(hn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(hn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(hn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(hn(62))}}function KI(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JI=null;function wk(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var QI=null,T0=null,C0=null;function H9(n){if(n=bw(n)){if(typeof QI!="function")throw Error(hn(280));var e=n.stateNode;e&&(e=SM(e),QI(n.stateNode,n.type,e))}}function Dj(n){T0?C0?C0.push(n):C0=[n]:T0=n}function Oj(){if(T0){var n=T0,e=C0;if(C0=T0=null,H9(n),e)for(n=0;n<e.length;n++)H9(e[n])}}function zj(n,e){return n(e)}function Fj(){}var U5=!1;function Nj(n,e,a){if(U5)return n(e,a);U5=!0;try{return zj(n,e,a)}finally{U5=!1,(T0!==null||C0!==null)&&(Fj(),Oj())}}function yx(n,e){var a=n.stateNode;if(a===null)return null;var o=SM(a);if(o===null)return null;a=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(n=n.type,o=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!o;break e;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(hn(231,e,typeof a));return a}var eL=!1;if(Rh)try{var N1={};Object.defineProperty(N1,"passive",{get:function(){eL=!0}}),window.addEventListener("test",N1,N1),window.removeEventListener("test",N1,N1)}catch{eL=!1}function qoe(n,e,a,o,s,c,d,f,m){var y=Array.prototype.slice.call(arguments,3);try{e.apply(a,y)}catch(_){this.onError(_)}}var Nb=!1,pE=null,mE=!1,tL=null,Xoe={onError:function(n){Nb=!0,pE=n}};function Yoe(n,e,a,o,s,c,d,f,m){Nb=!1,pE=null,qoe.apply(Xoe,arguments)}function Zoe(n,e,a,o,s,c,d,f,m){if(Yoe.apply(this,arguments),Nb){if(Nb){var y=pE;Nb=!1,pE=null}else throw Error(hn(198));mE||(mE=!0,tL=y)}}function Vg(n){var e=n,a=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(a=e.return),n=e.return;while(n)}return e.tag===3?a:null}function Bj(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function j9(n){if(Vg(n)!==n)throw Error(hn(188))}function Koe(n){var e=n.alternate;if(!e){if(e=Vg(n),e===null)throw Error(hn(188));return e!==n?null:n}for(var a=n,o=e;;){var s=a.return;if(s===null)break;var c=s.alternate;if(c===null){if(o=s.return,o!==null){a=o;continue}break}if(s.child===c.child){for(c=s.child;c;){if(c===a)return j9(s),n;if(c===o)return j9(s),e;c=c.sibling}throw Error(hn(188))}if(a.return!==o.return)a=s,o=c;else{for(var d=!1,f=s.child;f;){if(f===a){d=!0,a=s,o=c;break}if(f===o){d=!0,o=s,a=c;break}f=f.sibling}if(!d){for(f=c.child;f;){if(f===a){d=!0,a=c,o=s;break}if(f===o){d=!0,o=c,a=s;break}f=f.sibling}if(!d)throw Error(hn(189))}}if(a.alternate!==o)throw Error(hn(190))}if(a.tag!==3)throw Error(hn(188));return a.stateNode.current===a?n:e}function Uj(n){return n=Koe(n),n!==null?Wj(n):null}function Wj(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Wj(n);if(e!==null)return e;n=n.sibling}return null}var Vj=Kl.unstable_scheduleCallback,$9=Kl.unstable_cancelCallback,Joe=Kl.unstable_shouldYield,Qoe=Kl.unstable_requestPaint,co=Kl.unstable_now,ese=Kl.unstable_getCurrentPriorityLevel,Sk=Kl.unstable_ImmediatePriority,Gj=Kl.unstable_UserBlockingPriority,gE=Kl.unstable_NormalPriority,tse=Kl.unstable_LowPriority,Hj=Kl.unstable_IdlePriority,_M=null,cd=null;function nse(n){if(cd&&typeof cd.onCommitFiberRoot=="function")try{cd.onCommitFiberRoot(_M,n,void 0,(n.current.flags&128)===128)}catch{}}var cu=Math.clz32?Math.clz32:rse,ase=Math.log,ise=Math.LN2;function rse(n){return n>>>=0,n===0?32:31-(ase(n)/ise|0)|0}var X3=64,Y3=4194304;function Eb(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function yE(n,e){var a=n.pendingLanes;if(a===0)return 0;var o=0,s=n.suspendedLanes,c=n.pingedLanes,d=a&268435455;if(d!==0){var f=d&~s;f!==0?o=Eb(f):(c&=d,c!==0&&(o=Eb(c)))}else d=a&~s,d!==0?o=Eb(d):c!==0&&(o=Eb(c));if(o===0)return 0;if(e!==0&&e!==o&&!(e&s)&&(s=o&-o,c=e&-e,s>=c||s===16&&(c&4194240)!==0))return e;if(o&4&&(o|=a&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=o;0<e;)a=31-cu(e),s=1<<a,o|=n[a],e&=~s;return o}function ose(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sse(n,e){for(var a=n.suspendedLanes,o=n.pingedLanes,s=n.expirationTimes,c=n.pendingLanes;0<c;){var d=31-cu(c),f=1<<d,m=s[d];m===-1?(!(f&a)||f&o)&&(s[d]=ose(f,e)):m<=e&&(n.expiredLanes|=f),c&=~f}}function nL(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function jj(){var n=X3;return X3<<=1,!(X3&4194240)&&(X3=64),n}function W5(n){for(var e=[],a=0;31>a;a++)e.push(n);return e}function vw(n,e,a){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-cu(e),n[e]=a}function lse(n,e){var a=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var o=n.eventTimes;for(n=n.expirationTimes;0<a;){var s=31-cu(a),c=1<<s;e[s]=0,o[s]=-1,n[s]=-1,a&=~c}}function Ak(n,e){var a=n.entangledLanes|=e;for(n=n.entanglements;a;){var o=31-cu(a),s=1<<o;s&e|n[o]&e&&(n[o]|=e),a&=~s}}var Ni=0;function $j(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var qj,Ek,Xj,Yj,Zj,aL=!1,Z3=[],tp=null,np=null,ap=null,vx=new Map,_x=new Map,Hf=[],cse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function q9(n,e){switch(n){case"focusin":case"focusout":tp=null;break;case"dragenter":case"dragleave":np=null;break;case"mouseover":case"mouseout":ap=null;break;case"pointerover":case"pointerout":vx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_x.delete(e.pointerId)}}function B1(n,e,a,o,s,c){return n===null||n.nativeEvent!==c?(n={blockedOn:e,domEventName:a,eventSystemFlags:o,nativeEvent:c,targetContainers:[s]},e!==null&&(e=bw(e),e!==null&&Ek(e)),n):(n.eventSystemFlags|=o,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function use(n,e,a,o,s){switch(e){case"focusin":return tp=B1(tp,n,e,a,o,s),!0;case"dragenter":return np=B1(np,n,e,a,o,s),!0;case"mouseover":return ap=B1(ap,n,e,a,o,s),!0;case"pointerover":var c=s.pointerId;return vx.set(c,B1(vx.get(c)||null,n,e,a,o,s)),!0;case"gotpointercapture":return c=s.pointerId,_x.set(c,B1(_x.get(c)||null,n,e,a,o,s)),!0}return!1}function Kj(n){var e=ig(n.target);if(e!==null){var a=Vg(e);if(a!==null){if(e=a.tag,e===13){if(e=Bj(a),e!==null){n.blockedOn=e,Zj(n.priority,function(){Xj(a)});return}}else if(e===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function RA(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var a=iL(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var o=new a.constructor(a.type,a);JI=o,a.target.dispatchEvent(o),JI=null}else return e=bw(a),e!==null&&Ek(e),n.blockedOn=a,!1;e.shift()}return!0}function X9(n,e,a){RA(n)&&a.delete(e)}function dse(){aL=!1,tp!==null&&RA(tp)&&(tp=null),np!==null&&RA(np)&&(np=null),ap!==null&&RA(ap)&&(ap=null),vx.forEach(X9),_x.forEach(X9)}function U1(n,e){n.blockedOn===e&&(n.blockedOn=null,aL||(aL=!0,Kl.unstable_scheduleCallback(Kl.unstable_NormalPriority,dse)))}function bx(n){function e(s){return U1(s,n)}if(0<Z3.length){U1(Z3[0],n);for(var a=1;a<Z3.length;a++){var o=Z3[a];o.blockedOn===n&&(o.blockedOn=null)}}for(tp!==null&&U1(tp,n),np!==null&&U1(np,n),ap!==null&&U1(ap,n),vx.forEach(e),_x.forEach(e),a=0;a<Hf.length;a++)o=Hf[a],o.blockedOn===n&&(o.blockedOn=null);for(;0<Hf.length&&(a=Hf[0],a.blockedOn===null);)Kj(a),a.blockedOn===null&&Hf.shift()}var P0=Uh.ReactCurrentBatchConfig,vE=!0;function hse(n,e,a,o){var s=Ni,c=P0.transition;P0.transition=null;try{Ni=1,Mk(n,e,a,o)}finally{Ni=s,P0.transition=c}}function fse(n,e,a,o){var s=Ni,c=P0.transition;P0.transition=null;try{Ni=4,Mk(n,e,a,o)}finally{Ni=s,P0.transition=c}}function Mk(n,e,a,o){if(vE){var s=iL(n,e,a,o);if(s===null)K5(n,e,o,_E,a),q9(n,o);else if(use(s,n,e,a,o))o.stopPropagation();else if(q9(n,o),e&4&&-1<cse.indexOf(n)){for(;s!==null;){var c=bw(s);if(c!==null&&qj(c),c=iL(n,e,a,o),c===null&&K5(n,e,o,_E,a),c===s)break;s=c}s!==null&&o.stopPropagation()}else K5(n,e,o,null,a)}}var _E=null;function iL(n,e,a,o){if(_E=null,n=wk(o),n=ig(n),n!==null)if(e=Vg(n),e===null)n=null;else if(a=e.tag,a===13){if(n=Bj(e),n!==null)return n;n=null}else if(a===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return _E=n,null}function Jj(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ese()){case Sk:return 1;case Gj:return 4;case gE:case tse:return 16;case Hj:return 536870912;default:return 16}default:return 16}}var qf=null,Tk=null,kA=null;function Qj(){if(kA)return kA;var n,e=Tk,a=e.length,o,s="value"in qf?qf.value:qf.textContent,c=s.length;for(n=0;n<a&&e[n]===s[n];n++);var d=a-n;for(o=1;o<=d&&e[a-o]===s[c-o];o++);return kA=s.slice(n,1<o?1-o:void 0)}function DA(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function K3(){return!0}function Y9(){return!1}function Ql(n){function e(a,o,s,c,d){this._reactName=a,this._targetInst=s,this.type=o,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var f in n)n.hasOwnProperty(f)&&(a=n[f],this[f]=a?a(c):c[f]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?K3:Y9,this.isPropagationStopped=Y9,this}return Dr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=K3)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=K3)},persist:function(){},isPersistent:K3}),e}var d_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ck=Ql(d_),_w=Dr({},d_,{view:0,detail:0}),pse=Ql(_w),V5,G5,W1,bM=Dr({},_w,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pk,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==W1&&(W1&&n.type==="mousemove"?(V5=n.screenX-W1.screenX,G5=n.screenY-W1.screenY):G5=V5=0,W1=n),V5)},movementY:function(n){return"movementY"in n?n.movementY:G5}}),Z9=Ql(bM),mse=Dr({},bM,{dataTransfer:0}),gse=Ql(mse),yse=Dr({},_w,{relatedTarget:0}),H5=Ql(yse),vse=Dr({},d_,{animationName:0,elapsedTime:0,pseudoElement:0}),_se=Ql(vse),bse=Dr({},d_,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),xse=Ql(bse),wse=Dr({},d_,{data:0}),K9=Ql(wse),Sse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ase={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ese={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mse(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Ese[n])?!!e[n]:!1}function Pk(){return Mse}var Tse=Dr({},_w,{key:function(n){if(n.key){var e=Sse[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=DA(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ase[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pk,charCode:function(n){return n.type==="keypress"?DA(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?DA(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Cse=Ql(Tse),Pse=Dr({},bM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),J9=Ql(Pse),Ise=Dr({},_w,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pk}),Lse=Ql(Ise),Rse=Dr({},d_,{propertyName:0,elapsedTime:0,pseudoElement:0}),kse=Ql(Rse),Dse=Dr({},bM,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ose=Ql(Dse),zse=[9,13,27,32],Ik=Rh&&"CompositionEvent"in window,Bb=null;Rh&&"documentMode"in document&&(Bb=document.documentMode);var Fse=Rh&&"TextEvent"in window&&!Bb,e$=Rh&&(!Ik||Bb&&8<Bb&&11>=Bb),Q9=String.fromCharCode(32),eU=!1;function t$(n,e){switch(n){case"keyup":return zse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function n$(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var c0=!1;function Nse(n,e){switch(n){case"compositionend":return n$(e);case"keypress":return e.which!==32?null:(eU=!0,Q9);case"textInput":return n=e.data,n===Q9&&eU?null:n;default:return null}}function Bse(n,e){if(c0)return n==="compositionend"||!Ik&&t$(n,e)?(n=Qj(),kA=Tk=qf=null,c0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return e$&&e.locale!=="ko"?null:e.data;default:return null}}var Use={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tU(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Use[n.type]:e==="textarea"}function a$(n,e,a,o){Dj(o),e=bE(e,"onChange"),0<e.length&&(a=new Ck("onChange","change",null,a,o),n.push({event:a,listeners:e}))}var Ub=null,xx=null;function Wse(n){p$(n,0)}function xM(n){var e=h0(n);if(Tj(e))return n}function Vse(n,e){if(n==="change")return e}var i$=!1;if(Rh){var j5;if(Rh){var $5="oninput"in document;if(!$5){var nU=document.createElement("div");nU.setAttribute("oninput","return;"),$5=typeof nU.oninput=="function"}j5=$5}else j5=!1;i$=j5&&(!document.documentMode||9<document.documentMode)}function aU(){Ub&&(Ub.detachEvent("onpropertychange",r$),xx=Ub=null)}function r$(n){if(n.propertyName==="value"&&xM(xx)){var e=[];a$(e,xx,n,wk(n)),Nj(Wse,e)}}function Gse(n,e,a){n==="focusin"?(aU(),Ub=e,xx=a,Ub.attachEvent("onpropertychange",r$)):n==="focusout"&&aU()}function Hse(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return xM(xx)}function jse(n,e){if(n==="click")return xM(e)}function $se(n,e){if(n==="input"||n==="change")return xM(e)}function qse(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var fu=typeof Object.is=="function"?Object.is:qse;function wx(n,e){if(fu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var a=Object.keys(n),o=Object.keys(e);if(a.length!==o.length)return!1;for(o=0;o<a.length;o++){var s=a[o];if(!UI.call(e,s)||!fu(n[s],e[s]))return!1}return!0}function iU(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function rU(n,e){var a=iU(n);n=0;for(var o;a;){if(a.nodeType===3){if(o=n+a.textContent.length,n<=e&&o>=e)return{node:a,offset:e-n};n=o}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=iU(a)}}function o$(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?o$(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function s$(){for(var n=window,e=fE();e instanceof n.HTMLIFrameElement;){try{var a=typeof e.contentWindow.location.href=="string"}catch{a=!1}if(a)n=e.contentWindow;else break;e=fE(n.document)}return e}function Lk(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Xse(n){var e=s$(),a=n.focusedElem,o=n.selectionRange;if(e!==a&&a&&a.ownerDocument&&o$(a.ownerDocument.documentElement,a)){if(o!==null&&Lk(a)){if(e=o.start,n=o.end,n===void 0&&(n=e),"selectionStart"in a)a.selectionStart=e,a.selectionEnd=Math.min(n,a.value.length);else if(n=(e=a.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=a.textContent.length,c=Math.min(o.start,s);o=o.end===void 0?c:Math.min(o.end,s),!n.extend&&c>o&&(s=o,o=c,c=s),s=rU(a,c);var d=rU(a,o);s&&d&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==d.node||n.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),c>o?(n.addRange(e),n.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),n.addRange(e)))}}for(e=[],n=a;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<e.length;a++)n=e[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Yse=Rh&&"documentMode"in document&&11>=document.documentMode,u0=null,rL=null,Wb=null,oL=!1;function oU(n,e,a){var o=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;oL||u0==null||u0!==fE(o)||(o=u0,"selectionStart"in o&&Lk(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Wb&&wx(Wb,o)||(Wb=o,o=bE(rL,"onSelect"),0<o.length&&(e=new Ck("onSelect","select",null,e,a),n.push({event:e,listeners:o}),e.target=u0)))}function J3(n,e){var a={};return a[n.toLowerCase()]=e.toLowerCase(),a["Webkit"+n]="webkit"+e,a["Moz"+n]="moz"+e,a}var d0={animationend:J3("Animation","AnimationEnd"),animationiteration:J3("Animation","AnimationIteration"),animationstart:J3("Animation","AnimationStart"),transitionend:J3("Transition","TransitionEnd")},q5={},l$={};Rh&&(l$=document.createElement("div").style,"AnimationEvent"in window||(delete d0.animationend.animation,delete d0.animationiteration.animation,delete d0.animationstart.animation),"TransitionEvent"in window||delete d0.transitionend.transition);function wM(n){if(q5[n])return q5[n];if(!d0[n])return n;var e=d0[n],a;for(a in e)if(e.hasOwnProperty(a)&&a in l$)return q5[n]=e[a];return n}var c$=wM("animationend"),u$=wM("animationiteration"),d$=wM("animationstart"),h$=wM("transitionend"),f$=new Map,sU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sp(n,e){f$.set(n,e),Wg(e,[n])}for(var X5=0;X5<sU.length;X5++){var Y5=sU[X5],Zse=Y5.toLowerCase(),Kse=Y5[0].toUpperCase()+Y5.slice(1);Sp(Zse,"on"+Kse)}Sp(c$,"onAnimationEnd");Sp(u$,"onAnimationIteration");Sp(d$,"onAnimationStart");Sp("dblclick","onDoubleClick");Sp("focusin","onFocus");Sp("focusout","onBlur");Sp(h$,"onTransitionEnd");U0("onMouseEnter",["mouseout","mouseover"]);U0("onMouseLeave",["mouseout","mouseover"]);U0("onPointerEnter",["pointerout","pointerover"]);U0("onPointerLeave",["pointerout","pointerover"]);Wg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Jse=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mb));function lU(n,e,a){var o=n.type||"unknown-event";n.currentTarget=a,Zoe(o,e,void 0,n),n.currentTarget=null}function p$(n,e){e=(e&4)!==0;for(var a=0;a<n.length;a++){var o=n[a],s=o.event;o=o.listeners;e:{var c=void 0;if(e)for(var d=o.length-1;0<=d;d--){var f=o[d],m=f.instance,y=f.currentTarget;if(f=f.listener,m!==c&&s.isPropagationStopped())break e;lU(s,f,y),c=m}else for(d=0;d<o.length;d++){if(f=o[d],m=f.instance,y=f.currentTarget,f=f.listener,m!==c&&s.isPropagationStopped())break e;lU(s,f,y),c=m}}}if(mE)throw n=tL,mE=!1,tL=null,n}function or(n,e){var a=e[dL];a===void 0&&(a=e[dL]=new Set);var o=n+"__bubble";a.has(o)||(m$(e,n,2,!1),a.add(o))}function Z5(n,e,a){var o=0;e&&(o|=4),m$(a,n,o,e)}var Q3="_reactListening"+Math.random().toString(36).slice(2);function Sx(n){if(!n[Q3]){n[Q3]=!0,wj.forEach(function(a){a!=="selectionchange"&&(Jse.has(a)||Z5(a,!1,n),Z5(a,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Q3]||(e[Q3]=!0,Z5("selectionchange",!1,e))}}function m$(n,e,a,o){switch(Jj(e)){case 1:var s=hse;break;case 4:s=fse;break;default:s=Mk}a=s.bind(null,e,a,n),s=void 0,!eL||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),o?s!==void 0?n.addEventListener(e,a,{capture:!0,passive:s}):n.addEventListener(e,a,!0):s!==void 0?n.addEventListener(e,a,{passive:s}):n.addEventListener(e,a,!1)}function K5(n,e,a,o,s){var c=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var f=o.stateNode.containerInfo;if(f===s||f.nodeType===8&&f.parentNode===s)break;if(d===4)for(d=o.return;d!==null;){var m=d.tag;if((m===3||m===4)&&(m=d.stateNode.containerInfo,m===s||m.nodeType===8&&m.parentNode===s))return;d=d.return}for(;f!==null;){if(d=ig(f),d===null)return;if(m=d.tag,m===5||m===6){o=c=d;continue e}f=f.parentNode}}o=o.return}Nj(function(){var y=c,_=wk(a),x=[];e:{var S=f$.get(n);if(S!==void 0){var T=Ck,I=n;switch(n){case"keypress":if(DA(a)===0)break e;case"keydown":case"keyup":T=Cse;break;case"focusin":I="focus",T=H5;break;case"focusout":I="blur",T=H5;break;case"beforeblur":case"afterblur":T=H5;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=Z9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=gse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=Lse;break;case c$:case u$:case d$:T=_se;break;case h$:T=kse;break;case"scroll":T=pse;break;case"wheel":T=Ose;break;case"copy":case"cut":case"paste":T=xse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=J9}var k=(e&4)!==0,D=!k&&n==="scroll",L=k?S!==null?S+"Capture":null:S;k=[];for(var O=y,F;O!==null;){F=O;var B=F.stateNode;if(F.tag===5&&B!==null&&(F=B,L!==null&&(B=yx(O,L),B!=null&&k.push(Ax(O,B,F)))),D)break;O=O.return}0<k.length&&(S=new T(S,I,null,a,_),x.push({event:S,listeners:k}))}}if(!(e&7)){e:{if(S=n==="mouseover"||n==="pointerover",T=n==="mouseout"||n==="pointerout",S&&a!==JI&&(I=a.relatedTarget||a.fromElement)&&(ig(I)||I[kh]))break e;if((T||S)&&(S=_.window===_?_:(S=_.ownerDocument)?S.defaultView||S.parentWindow:window,T?(I=a.relatedTarget||a.toElement,T=y,I=I?ig(I):null,I!==null&&(D=Vg(I),I!==D||I.tag!==5&&I.tag!==6)&&(I=null)):(T=null,I=y),T!==I)){if(k=Z9,B="onMouseLeave",L="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(k=J9,B="onPointerLeave",L="onPointerEnter",O="pointer"),D=T==null?S:h0(T),F=I==null?S:h0(I),S=new k(B,O+"leave",T,a,_),S.target=D,S.relatedTarget=F,B=null,ig(_)===y&&(k=new k(L,O+"enter",I,a,_),k.target=F,k.relatedTarget=D,B=k),D=B,T&&I)t:{for(k=T,L=I,O=0,F=k;F;F=Sv(F))O++;for(F=0,B=L;B;B=Sv(B))F++;for(;0<O-F;)k=Sv(k),O--;for(;0<F-O;)L=Sv(L),F--;for(;O--;){if(k===L||L!==null&&k===L.alternate)break t;k=Sv(k),L=Sv(L)}k=null}else k=null;T!==null&&cU(x,S,T,k,!1),I!==null&&D!==null&&cU(x,D,I,k,!0)}}e:{if(S=y?h0(y):window,T=S.nodeName&&S.nodeName.toLowerCase(),T==="select"||T==="input"&&S.type==="file")var G=Vse;else if(tU(S))if(i$)G=$se;else{G=Hse;var q=Gse}else(T=S.nodeName)&&T.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(G=jse);if(G&&(G=G(n,y))){a$(x,G,a,_);break e}q&&q(n,S,y),n==="focusout"&&(q=S._wrapperState)&&q.controlled&&S.type==="number"&&qI(S,"number",S.value)}switch(q=y?h0(y):window,n){case"focusin":(tU(q)||q.contentEditable==="true")&&(u0=q,rL=y,Wb=null);break;case"focusout":Wb=rL=u0=null;break;case"mousedown":oL=!0;break;case"contextmenu":case"mouseup":case"dragend":oL=!1,oU(x,a,_);break;case"selectionchange":if(Yse)break;case"keydown":case"keyup":oU(x,a,_)}var X;if(Ik)e:{switch(n){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else c0?t$(n,a)&&(te="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(te="onCompositionStart");te&&(e$&&a.locale!=="ko"&&(c0||te!=="onCompositionStart"?te==="onCompositionEnd"&&c0&&(X=Qj()):(qf=_,Tk="value"in qf?qf.value:qf.textContent,c0=!0)),q=bE(y,te),0<q.length&&(te=new K9(te,n,null,a,_),x.push({event:te,listeners:q}),X?te.data=X:(X=n$(a),X!==null&&(te.data=X)))),(X=Fse?Nse(n,a):Bse(n,a))&&(y=bE(y,"onBeforeInput"),0<y.length&&(_=new K9("onBeforeInput","beforeinput",null,a,_),x.push({event:_,listeners:y}),_.data=X))}p$(x,e)})}function Ax(n,e,a){return{instance:n,listener:e,currentTarget:a}}function bE(n,e){for(var a=e+"Capture",o=[];n!==null;){var s=n,c=s.stateNode;s.tag===5&&c!==null&&(s=c,c=yx(n,a),c!=null&&o.unshift(Ax(n,c,s)),c=yx(n,e),c!=null&&o.push(Ax(n,c,s))),n=n.return}return o}function Sv(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function cU(n,e,a,o,s){for(var c=e._reactName,d=[];a!==null&&a!==o;){var f=a,m=f.alternate,y=f.stateNode;if(m!==null&&m===o)break;f.tag===5&&y!==null&&(f=y,s?(m=yx(a,c),m!=null&&d.unshift(Ax(a,m,f))):s||(m=yx(a,c),m!=null&&d.push(Ax(a,m,f)))),a=a.return}d.length!==0&&n.push({event:e,listeners:d})}var Qse=/\r\n?/g,ele=/\u0000|\uFFFD/g;function uU(n){return(typeof n=="string"?n:""+n).replace(Qse,`
`).replace(ele,"")}function eS(n,e,a){if(e=uU(e),uU(n)!==e&&a)throw Error(hn(425))}function xE(){}var sL=null,lL=null;function cL(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var uL=typeof setTimeout=="function"?setTimeout:void 0,tle=typeof clearTimeout=="function"?clearTimeout:void 0,dU=typeof Promise=="function"?Promise:void 0,nle=typeof queueMicrotask=="function"?queueMicrotask:typeof dU<"u"?function(n){return dU.resolve(null).then(n).catch(ale)}:uL;function ale(n){setTimeout(function(){throw n})}function J5(n,e){var a=e,o=0;do{var s=a.nextSibling;if(n.removeChild(a),s&&s.nodeType===8)if(a=s.data,a==="/$"){if(o===0){n.removeChild(s),bx(e);return}o--}else a!=="$"&&a!=="$?"&&a!=="$!"||o++;a=s}while(a);bx(e)}function ip(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function hU(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(e===0)return n;e--}else a==="/$"&&e++}n=n.previousSibling}return null}var h_=Math.random().toString(36).slice(2),rd="__reactFiber$"+h_,Ex="__reactProps$"+h_,kh="__reactContainer$"+h_,dL="__reactEvents$"+h_,ile="__reactListeners$"+h_,rle="__reactHandles$"+h_;function ig(n){var e=n[rd];if(e)return e;for(var a=n.parentNode;a;){if(e=a[kh]||a[rd]){if(a=e.alternate,e.child!==null||a!==null&&a.child!==null)for(n=hU(n);n!==null;){if(a=n[rd])return a;n=hU(n)}return e}n=a,a=n.parentNode}return null}function bw(n){return n=n[rd]||n[kh],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function h0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(hn(33))}function SM(n){return n[Ex]||null}var hL=[],f0=-1;function Ap(n){return{current:n}}function cr(n){0>f0||(n.current=hL[f0],hL[f0]=null,f0--)}function tr(n,e){f0++,hL[f0]=n.current,n.current=e}var gp={},Es=Ap(gp),_l=Ap(!1),Mg=gp;function W0(n,e){var a=n.type.contextTypes;if(!a)return gp;var o=n.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var s={},c;for(c in a)s[c]=e[c];return o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function bl(n){return n=n.childContextTypes,n!=null}function wE(){cr(_l),cr(Es)}function fU(n,e,a){if(Es.current!==gp)throw Error(hn(168));tr(Es,e),tr(_l,a)}function g$(n,e,a){var o=n.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return a;o=o.getChildContext();for(var s in o)if(!(s in e))throw Error(hn(108,Goe(n)||"Unknown",s));return Dr({},a,o)}function SE(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||gp,Mg=Es.current,tr(Es,n),tr(_l,_l.current),!0}function pU(n,e,a){var o=n.stateNode;if(!o)throw Error(hn(169));a?(n=g$(n,e,Mg),o.__reactInternalMemoizedMergedChildContext=n,cr(_l),cr(Es),tr(Es,n)):cr(_l),tr(_l,a)}var yh=null,AM=!1,Q5=!1;function y$(n){yh===null?yh=[n]:yh.push(n)}function ole(n){AM=!0,y$(n)}function Ep(){if(!Q5&&yh!==null){Q5=!0;var n=0,e=Ni;try{var a=yh;for(Ni=1;n<a.length;n++){var o=a[n];do o=o(!0);while(o!==null)}yh=null,AM=!1}catch(s){throw yh!==null&&(yh=yh.slice(n+1)),Vj(Sk,Ep),s}finally{Ni=e,Q5=!1}}return null}var p0=[],m0=0,AE=null,EE=0,bc=[],xc=0,Tg=null,wh=1,Sh="";function $m(n,e){p0[m0++]=EE,p0[m0++]=AE,AE=n,EE=e}function v$(n,e,a){bc[xc++]=wh,bc[xc++]=Sh,bc[xc++]=Tg,Tg=n;var o=wh;n=Sh;var s=32-cu(o)-1;o&=~(1<<s),a+=1;var c=32-cu(e)+s;if(30<c){var d=s-s%5;c=(o&(1<<d)-1).toString(32),o>>=d,s-=d,wh=1<<32-cu(e)+s|a<<s|o,Sh=c+n}else wh=1<<c|a<<s|o,Sh=n}function Rk(n){n.return!==null&&($m(n,1),v$(n,1,0))}function kk(n){for(;n===AE;)AE=p0[--m0],p0[m0]=null,EE=p0[--m0],p0[m0]=null;for(;n===Tg;)Tg=bc[--xc],bc[xc]=null,Sh=bc[--xc],bc[xc]=null,wh=bc[--xc],bc[xc]=null}var Xl=null,ql=null,_r=!1,iu=null;function _$(n,e){var a=Sc(5,null,null,0);a.elementType="DELETED",a.stateNode=e,a.return=n,e=n.deletions,e===null?(n.deletions=[a],n.flags|=16):e.push(a)}function mU(n,e){switch(n.tag){case 5:var a=n.type;return e=e.nodeType!==1||a.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Xl=n,ql=ip(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Xl=n,ql=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(a=Tg!==null?{id:wh,overflow:Sh}:null,n.memoizedState={dehydrated:e,treeContext:a,retryLane:1073741824},a=Sc(18,null,null,0),a.stateNode=e,a.return=n,n.child=a,Xl=n,ql=null,!0):!1;default:return!1}}function fL(n){return(n.mode&1)!==0&&(n.flags&128)===0}function pL(n){if(_r){var e=ql;if(e){var a=e;if(!mU(n,e)){if(fL(n))throw Error(hn(418));e=ip(a.nextSibling);var o=Xl;e&&mU(n,e)?_$(o,a):(n.flags=n.flags&-4097|2,_r=!1,Xl=n)}}else{if(fL(n))throw Error(hn(418));n.flags=n.flags&-4097|2,_r=!1,Xl=n}}}function gU(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Xl=n}function tS(n){if(n!==Xl)return!1;if(!_r)return gU(n),_r=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!cL(n.type,n.memoizedProps)),e&&(e=ql)){if(fL(n))throw b$(),Error(hn(418));for(;e;)_$(n,e),e=ip(e.nextSibling)}if(gU(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(hn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(e===0){ql=ip(n.nextSibling);break e}e--}else a!=="$"&&a!=="$!"&&a!=="$?"||e++}n=n.nextSibling}ql=null}}else ql=Xl?ip(n.stateNode.nextSibling):null;return!0}function b$(){for(var n=ql;n;)n=ip(n.nextSibling)}function V0(){ql=Xl=null,_r=!1}function Dk(n){iu===null?iu=[n]:iu.push(n)}var sle=Uh.ReactCurrentBatchConfig;function eu(n,e){if(n&&n.defaultProps){e=Dr({},e),n=n.defaultProps;for(var a in n)e[a]===void 0&&(e[a]=n[a]);return e}return e}var ME=Ap(null),TE=null,g0=null,Ok=null;function zk(){Ok=g0=TE=null}function Fk(n){var e=ME.current;cr(ME),n._currentValue=e}function mL(n,e,a){for(;n!==null;){var o=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),n===a)break;n=n.return}}function I0(n,e){TE=n,Ok=g0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(yl=!0),n.firstContext=null)}function Mc(n){var e=n._currentValue;if(Ok!==n)if(n={context:n,memoizedValue:e,next:null},g0===null){if(TE===null)throw Error(hn(308));g0=n,TE.dependencies={lanes:0,firstContext:n}}else g0=g0.next=n;return e}var rg=null;function Nk(n){rg===null?rg=[n]:rg.push(n)}function x$(n,e,a,o){var s=e.interleaved;return s===null?(a.next=a,Nk(e)):(a.next=s.next,s.next=a),e.interleaved=a,Dh(n,o)}function Dh(n,e){n.lanes|=e;var a=n.alternate;for(a!==null&&(a.lanes|=e),a=n,n=n.return;n!==null;)n.childLanes|=e,a=n.alternate,a!==null&&(a.childLanes|=e),a=n,n=n.return;return a.tag===3?a.stateNode:null}var Gf=!1;function Bk(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w$(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ph(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function rp(n,e,a){var o=n.updateQueue;if(o===null)return null;if(o=o.shared,li&2){var s=o.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),o.pending=e,Dh(n,a)}return s=o.interleaved,s===null?(e.next=e,Nk(o)):(e.next=s.next,s.next=e),o.interleaved=e,Dh(n,a)}function OA(n,e,a){if(e=e.updateQueue,e!==null&&(e=e.shared,(a&4194240)!==0)){var o=e.lanes;o&=n.pendingLanes,a|=o,e.lanes=a,Ak(n,a)}}function yU(n,e){var a=n.updateQueue,o=n.alternate;if(o!==null&&(o=o.updateQueue,a===o)){var s=null,c=null;if(a=a.firstBaseUpdate,a!==null){do{var d={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};c===null?s=c=d:c=c.next=d,a=a.next}while(a!==null);c===null?s=c=e:c=c.next=e}else s=c=e;a={baseState:o.baseState,firstBaseUpdate:s,lastBaseUpdate:c,shared:o.shared,effects:o.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=e:n.next=e,a.lastBaseUpdate=e}function CE(n,e,a,o){var s=n.updateQueue;Gf=!1;var c=s.firstBaseUpdate,d=s.lastBaseUpdate,f=s.shared.pending;if(f!==null){s.shared.pending=null;var m=f,y=m.next;m.next=null,d===null?c=y:d.next=y,d=m;var _=n.alternate;_!==null&&(_=_.updateQueue,f=_.lastBaseUpdate,f!==d&&(f===null?_.firstBaseUpdate=y:f.next=y,_.lastBaseUpdate=m))}if(c!==null){var x=s.baseState;d=0,_=y=m=null,f=c;do{var S=f.lane,T=f.eventTime;if((o&S)===S){_!==null&&(_=_.next={eventTime:T,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var I=n,k=f;switch(S=e,T=a,k.tag){case 1:if(I=k.payload,typeof I=="function"){x=I.call(T,x,S);break e}x=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=k.payload,S=typeof I=="function"?I.call(T,x,S):I,S==null)break e;x=Dr({},x,S);break e;case 2:Gf=!0}}f.callback!==null&&f.lane!==0&&(n.flags|=64,S=s.effects,S===null?s.effects=[f]:S.push(f))}else T={eventTime:T,lane:S,tag:f.tag,payload:f.payload,callback:f.callback,next:null},_===null?(y=_=T,m=x):_=_.next=T,d|=S;if(f=f.next,f===null){if(f=s.shared.pending,f===null)break;S=f,f=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(1);if(_===null&&(m=x),s.baseState=m,s.firstBaseUpdate=y,s.lastBaseUpdate=_,e=s.shared.interleaved,e!==null){s=e;do d|=s.lane,s=s.next;while(s!==e)}else c===null&&(s.shared.lanes=0);Pg|=d,n.lanes=d,n.memoizedState=x}}function vU(n,e,a){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var o=n[e],s=o.callback;if(s!==null){if(o.callback=null,o=a,typeof s!="function")throw Error(hn(191,s));s.call(o)}}}var S$=new xj.Component().refs;function gL(n,e,a,o){e=n.memoizedState,a=a(o,e),a=a==null?e:Dr({},e,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var EM={isMounted:function(n){return(n=n._reactInternals)?Vg(n)===n:!1},enqueueSetState:function(n,e,a){n=n._reactInternals;var o=Hs(),s=sp(n),c=Ph(o,s);c.payload=e,a!=null&&(c.callback=a),e=rp(n,c,s),e!==null&&(uu(e,n,s,o),OA(e,n,s))},enqueueReplaceState:function(n,e,a){n=n._reactInternals;var o=Hs(),s=sp(n),c=Ph(o,s);c.tag=1,c.payload=e,a!=null&&(c.callback=a),e=rp(n,c,s),e!==null&&(uu(e,n,s,o),OA(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var a=Hs(),o=sp(n),s=Ph(a,o);s.tag=2,e!=null&&(s.callback=e),e=rp(n,s,o),e!==null&&(uu(e,n,o,a),OA(e,n,o))}};function _U(n,e,a,o,s,c,d){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(o,c,d):e.prototype&&e.prototype.isPureReactComponent?!wx(a,o)||!wx(s,c):!0}function A$(n,e,a){var o=!1,s=gp,c=e.contextType;return typeof c=="object"&&c!==null?c=Mc(c):(s=bl(e)?Mg:Es.current,o=e.contextTypes,c=(o=o!=null)?W0(n,s):gp),e=new e(a,c),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=EM,n.stateNode=e,e._reactInternals=n,o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=c),e}function bU(n,e,a,o){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(a,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(a,o),e.state!==n&&EM.enqueueReplaceState(e,e.state,null)}function yL(n,e,a,o){var s=n.stateNode;s.props=a,s.state=n.memoizedState,s.refs=S$,Bk(n);var c=e.contextType;typeof c=="object"&&c!==null?s.context=Mc(c):(c=bl(e)?Mg:Es.current,s.context=W0(n,c)),s.state=n.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(gL(n,e,c,a),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&EM.enqueueReplaceState(s,s.state,null),CE(n,a,s,o),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function V1(n,e,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(hn(309));var o=a.stateNode}if(!o)throw Error(hn(147,n));var s=o,c=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(d){var f=s.refs;f===S$&&(f=s.refs={}),d===null?delete f[c]:f[c]=d},e._stringRef=c,e)}if(typeof n!="string")throw Error(hn(284));if(!a._owner)throw Error(hn(290,n))}return n}function nS(n,e){throw n=Object.prototype.toString.call(e),Error(hn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function xU(n){var e=n._init;return e(n._payload)}function E$(n){function e(L,O){if(n){var F=L.deletions;F===null?(L.deletions=[O],L.flags|=16):F.push(O)}}function a(L,O){if(!n)return null;for(;O!==null;)e(L,O),O=O.sibling;return null}function o(L,O){for(L=new Map;O!==null;)O.key!==null?L.set(O.key,O):L.set(O.index,O),O=O.sibling;return L}function s(L,O){return L=lp(L,O),L.index=0,L.sibling=null,L}function c(L,O,F){return L.index=F,n?(F=L.alternate,F!==null?(F=F.index,F<O?(L.flags|=2,O):F):(L.flags|=2,O)):(L.flags|=1048576,O)}function d(L){return n&&L.alternate===null&&(L.flags|=2),L}function f(L,O,F,B){return O===null||O.tag!==6?(O=o4(F,L.mode,B),O.return=L,O):(O=s(O,F),O.return=L,O)}function m(L,O,F,B){var G=F.type;return G===l0?_(L,O,F.props.children,B,F.key):O!==null&&(O.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Vf&&xU(G)===O.type)?(B=s(O,F.props),B.ref=V1(L,O,F),B.return=L,B):(B=WA(F.type,F.key,F.props,null,L.mode,B),B.ref=V1(L,O,F),B.return=L,B)}function y(L,O,F,B){return O===null||O.tag!==4||O.stateNode.containerInfo!==F.containerInfo||O.stateNode.implementation!==F.implementation?(O=s4(F,L.mode,B),O.return=L,O):(O=s(O,F.children||[]),O.return=L,O)}function _(L,O,F,B,G){return O===null||O.tag!==7?(O=vg(F,L.mode,B,G),O.return=L,O):(O=s(O,F),O.return=L,O)}function x(L,O,F){if(typeof O=="string"&&O!==""||typeof O=="number")return O=o4(""+O,L.mode,F),O.return=L,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case j3:return F=WA(O.type,O.key,O.props,null,L.mode,F),F.ref=V1(L,null,O),F.return=L,F;case s0:return O=s4(O,L.mode,F),O.return=L,O;case Vf:var B=O._init;return x(L,B(O._payload),F)}if(Ab(O)||F1(O))return O=vg(O,L.mode,F,null),O.return=L,O;nS(L,O)}return null}function S(L,O,F,B){var G=O!==null?O.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return G!==null?null:f(L,O,""+F,B);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case j3:return F.key===G?m(L,O,F,B):null;case s0:return F.key===G?y(L,O,F,B):null;case Vf:return G=F._init,S(L,O,G(F._payload),B)}if(Ab(F)||F1(F))return G!==null?null:_(L,O,F,B,null);nS(L,F)}return null}function T(L,O,F,B,G){if(typeof B=="string"&&B!==""||typeof B=="number")return L=L.get(F)||null,f(O,L,""+B,G);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case j3:return L=L.get(B.key===null?F:B.key)||null,m(O,L,B,G);case s0:return L=L.get(B.key===null?F:B.key)||null,y(O,L,B,G);case Vf:var q=B._init;return T(L,O,F,q(B._payload),G)}if(Ab(B)||F1(B))return L=L.get(F)||null,_(O,L,B,G,null);nS(O,B)}return null}function I(L,O,F,B){for(var G=null,q=null,X=O,te=O=0,V=null;X!==null&&te<F.length;te++){X.index>te?(V=X,X=null):V=X.sibling;var Q=S(L,X,F[te],B);if(Q===null){X===null&&(X=V);break}n&&X&&Q.alternate===null&&e(L,X),O=c(Q,O,te),q===null?G=Q:q.sibling=Q,q=Q,X=V}if(te===F.length)return a(L,X),_r&&$m(L,te),G;if(X===null){for(;te<F.length;te++)X=x(L,F[te],B),X!==null&&(O=c(X,O,te),q===null?G=X:q.sibling=X,q=X);return _r&&$m(L,te),G}for(X=o(L,X);te<F.length;te++)V=T(X,L,te,F[te],B),V!==null&&(n&&V.alternate!==null&&X.delete(V.key===null?te:V.key),O=c(V,O,te),q===null?G=V:q.sibling=V,q=V);return n&&X.forEach(function(ge){return e(L,ge)}),_r&&$m(L,te),G}function k(L,O,F,B){var G=F1(F);if(typeof G!="function")throw Error(hn(150));if(F=G.call(F),F==null)throw Error(hn(151));for(var q=G=null,X=O,te=O=0,V=null,Q=F.next();X!==null&&!Q.done;te++,Q=F.next()){X.index>te?(V=X,X=null):V=X.sibling;var ge=S(L,X,Q.value,B);if(ge===null){X===null&&(X=V);break}n&&X&&ge.alternate===null&&e(L,X),O=c(ge,O,te),q===null?G=ge:q.sibling=ge,q=ge,X=V}if(Q.done)return a(L,X),_r&&$m(L,te),G;if(X===null){for(;!Q.done;te++,Q=F.next())Q=x(L,Q.value,B),Q!==null&&(O=c(Q,O,te),q===null?G=Q:q.sibling=Q,q=Q);return _r&&$m(L,te),G}for(X=o(L,X);!Q.done;te++,Q=F.next())Q=T(X,L,te,Q.value,B),Q!==null&&(n&&Q.alternate!==null&&X.delete(Q.key===null?te:Q.key),O=c(Q,O,te),q===null?G=Q:q.sibling=Q,q=Q);return n&&X.forEach(function(me){return e(L,me)}),_r&&$m(L,te),G}function D(L,O,F,B){if(typeof F=="object"&&F!==null&&F.type===l0&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case j3:e:{for(var G=F.key,q=O;q!==null;){if(q.key===G){if(G=F.type,G===l0){if(q.tag===7){a(L,q.sibling),O=s(q,F.props.children),O.return=L,L=O;break e}}else if(q.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===Vf&&xU(G)===q.type){a(L,q.sibling),O=s(q,F.props),O.ref=V1(L,q,F),O.return=L,L=O;break e}a(L,q);break}else e(L,q);q=q.sibling}F.type===l0?(O=vg(F.props.children,L.mode,B,F.key),O.return=L,L=O):(B=WA(F.type,F.key,F.props,null,L.mode,B),B.ref=V1(L,O,F),B.return=L,L=B)}return d(L);case s0:e:{for(q=F.key;O!==null;){if(O.key===q)if(O.tag===4&&O.stateNode.containerInfo===F.containerInfo&&O.stateNode.implementation===F.implementation){a(L,O.sibling),O=s(O,F.children||[]),O.return=L,L=O;break e}else{a(L,O);break}else e(L,O);O=O.sibling}O=s4(F,L.mode,B),O.return=L,L=O}return d(L);case Vf:return q=F._init,D(L,O,q(F._payload),B)}if(Ab(F))return I(L,O,F,B);if(F1(F))return k(L,O,F,B);nS(L,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,O!==null&&O.tag===6?(a(L,O.sibling),O=s(O,F),O.return=L,L=O):(a(L,O),O=o4(F,L.mode,B),O.return=L,L=O),d(L)):a(L,O)}return D}var G0=E$(!0),M$=E$(!1),xw={},ud=Ap(xw),Mx=Ap(xw),Tx=Ap(xw);function og(n){if(n===xw)throw Error(hn(174));return n}function Uk(n,e){switch(tr(Tx,e),tr(Mx,n),tr(ud,xw),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:YI(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=YI(e,n)}cr(ud),tr(ud,e)}function H0(){cr(ud),cr(Mx),cr(Tx)}function T$(n){og(Tx.current);var e=og(ud.current),a=YI(e,n.type);e!==a&&(tr(Mx,n),tr(ud,a))}function Wk(n){Mx.current===n&&(cr(ud),cr(Mx))}var Pr=Ap(0);function PE(n){for(var e=n;e!==null;){if(e.tag===13){var a=e.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var e4=[];function Vk(){for(var n=0;n<e4.length;n++)e4[n]._workInProgressVersionPrimary=null;e4.length=0}var zA=Uh.ReactCurrentDispatcher,t4=Uh.ReactCurrentBatchConfig,Cg=0,Rr=null,Po=null,Bo=null,IE=!1,Vb=!1,Cx=0,lle=0;function ps(){throw Error(hn(321))}function Gk(n,e){if(e===null)return!1;for(var a=0;a<e.length&&a<n.length;a++)if(!fu(n[a],e[a]))return!1;return!0}function Hk(n,e,a,o,s,c){if(Cg=c,Rr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,zA.current=n===null||n.memoizedState===null?hle:fle,n=a(o,s),Vb){c=0;do{if(Vb=!1,Cx=0,25<=c)throw Error(hn(301));c+=1,Bo=Po=null,e.updateQueue=null,zA.current=ple,n=a(o,s)}while(Vb)}if(zA.current=LE,e=Po!==null&&Po.next!==null,Cg=0,Bo=Po=Rr=null,IE=!1,e)throw Error(hn(300));return n}function jk(){var n=Cx!==0;return Cx=0,n}function td(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bo===null?Rr.memoizedState=Bo=n:Bo=Bo.next=n,Bo}function Tc(){if(Po===null){var n=Rr.alternate;n=n!==null?n.memoizedState:null}else n=Po.next;var e=Bo===null?Rr.memoizedState:Bo.next;if(e!==null)Bo=e,Po=n;else{if(n===null)throw Error(hn(310));Po=n,n={memoizedState:Po.memoizedState,baseState:Po.baseState,baseQueue:Po.baseQueue,queue:Po.queue,next:null},Bo===null?Rr.memoizedState=Bo=n:Bo=Bo.next=n}return Bo}function Px(n,e){return typeof e=="function"?e(n):e}function n4(n){var e=Tc(),a=e.queue;if(a===null)throw Error(hn(311));a.lastRenderedReducer=n;var o=Po,s=o.baseQueue,c=a.pending;if(c!==null){if(s!==null){var d=s.next;s.next=c.next,c.next=d}o.baseQueue=s=c,a.pending=null}if(s!==null){c=s.next,o=o.baseState;var f=d=null,m=null,y=c;do{var _=y.lane;if((Cg&_)===_)m!==null&&(m=m.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),o=y.hasEagerState?y.eagerState:n(o,y.action);else{var x={lane:_,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};m===null?(f=m=x,d=o):m=m.next=x,Rr.lanes|=_,Pg|=_}y=y.next}while(y!==null&&y!==c);m===null?d=o:m.next=f,fu(o,e.memoizedState)||(yl=!0),e.memoizedState=o,e.baseState=d,e.baseQueue=m,a.lastRenderedState=o}if(n=a.interleaved,n!==null){s=n;do c=s.lane,Rr.lanes|=c,Pg|=c,s=s.next;while(s!==n)}else s===null&&(a.lanes=0);return[e.memoizedState,a.dispatch]}function a4(n){var e=Tc(),a=e.queue;if(a===null)throw Error(hn(311));a.lastRenderedReducer=n;var o=a.dispatch,s=a.pending,c=e.memoizedState;if(s!==null){a.pending=null;var d=s=s.next;do c=n(c,d.action),d=d.next;while(d!==s);fu(c,e.memoizedState)||(yl=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),a.lastRenderedState=c}return[c,o]}function C$(){}function P$(n,e){var a=Rr,o=Tc(),s=e(),c=!fu(o.memoizedState,s);if(c&&(o.memoizedState=s,yl=!0),o=o.queue,$k(R$.bind(null,a,o,n),[n]),o.getSnapshot!==e||c||Bo!==null&&Bo.memoizedState.tag&1){if(a.flags|=2048,Ix(9,L$.bind(null,a,o,s,e),void 0,null),Vo===null)throw Error(hn(349));Cg&30||I$(a,e,s)}return s}function I$(n,e,a){n.flags|=16384,n={getSnapshot:e,value:a},e=Rr.updateQueue,e===null?(e={lastEffect:null,stores:null},Rr.updateQueue=e,e.stores=[n]):(a=e.stores,a===null?e.stores=[n]:a.push(n))}function L$(n,e,a,o){e.value=a,e.getSnapshot=o,k$(e)&&D$(n)}function R$(n,e,a){return a(function(){k$(e)&&D$(n)})}function k$(n){var e=n.getSnapshot;n=n.value;try{var a=e();return!fu(n,a)}catch{return!0}}function D$(n){var e=Dh(n,1);e!==null&&uu(e,n,1,-1)}function wU(n){var e=td();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Px,lastRenderedState:n},e.queue=n,n=n.dispatch=dle.bind(null,Rr,n),[e.memoizedState,n]}function Ix(n,e,a,o){return n={tag:n,create:e,destroy:a,deps:o,next:null},e=Rr.updateQueue,e===null?(e={lastEffect:null,stores:null},Rr.updateQueue=e,e.lastEffect=n.next=n):(a=e.lastEffect,a===null?e.lastEffect=n.next=n:(o=a.next,a.next=n,n.next=o,e.lastEffect=n)),n}function O$(){return Tc().memoizedState}function FA(n,e,a,o){var s=td();Rr.flags|=n,s.memoizedState=Ix(1|e,a,void 0,o===void 0?null:o)}function MM(n,e,a,o){var s=Tc();o=o===void 0?null:o;var c=void 0;if(Po!==null){var d=Po.memoizedState;if(c=d.destroy,o!==null&&Gk(o,d.deps)){s.memoizedState=Ix(e,a,c,o);return}}Rr.flags|=n,s.memoizedState=Ix(1|e,a,c,o)}function SU(n,e){return FA(8390656,8,n,e)}function $k(n,e){return MM(2048,8,n,e)}function z$(n,e){return MM(4,2,n,e)}function F$(n,e){return MM(4,4,n,e)}function N$(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function B$(n,e,a){return a=a!=null?a.concat([n]):null,MM(4,4,N$.bind(null,e,n),a)}function qk(){}function U$(n,e){var a=Tc();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Gk(e,o[1])?o[0]:(a.memoizedState=[n,e],n)}function W$(n,e){var a=Tc();e=e===void 0?null:e;var o=a.memoizedState;return o!==null&&e!==null&&Gk(e,o[1])?o[0]:(n=n(),a.memoizedState=[n,e],n)}function V$(n,e,a){return Cg&21?(fu(a,e)||(a=jj(),Rr.lanes|=a,Pg|=a,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,yl=!0),n.memoizedState=a)}function cle(n,e){var a=Ni;Ni=a!==0&&4>a?a:4,n(!0);var o=t4.transition;t4.transition={};try{n(!1),e()}finally{Ni=a,t4.transition=o}}function G$(){return Tc().memoizedState}function ule(n,e,a){var o=sp(n);if(a={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null},H$(n))j$(e,a);else if(a=x$(n,e,a,o),a!==null){var s=Hs();uu(a,n,o,s),$$(a,e,o)}}function dle(n,e,a){var o=sp(n),s={lane:o,action:a,hasEagerState:!1,eagerState:null,next:null};if(H$(n))j$(e,s);else{var c=n.alternate;if(n.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var d=e.lastRenderedState,f=c(d,a);if(s.hasEagerState=!0,s.eagerState=f,fu(f,d)){var m=e.interleaved;m===null?(s.next=s,Nk(e)):(s.next=m.next,m.next=s),e.interleaved=s;return}}catch{}finally{}a=x$(n,e,s,o),a!==null&&(s=Hs(),uu(a,n,o,s),$$(a,e,o))}}function H$(n){var e=n.alternate;return n===Rr||e!==null&&e===Rr}function j$(n,e){Vb=IE=!0;var a=n.pending;a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e}function $$(n,e,a){if(a&4194240){var o=e.lanes;o&=n.pendingLanes,a|=o,e.lanes=a,Ak(n,a)}}var LE={readContext:Mc,useCallback:ps,useContext:ps,useEffect:ps,useImperativeHandle:ps,useInsertionEffect:ps,useLayoutEffect:ps,useMemo:ps,useReducer:ps,useRef:ps,useState:ps,useDebugValue:ps,useDeferredValue:ps,useTransition:ps,useMutableSource:ps,useSyncExternalStore:ps,useId:ps,unstable_isNewReconciler:!1},hle={readContext:Mc,useCallback:function(n,e){return td().memoizedState=[n,e===void 0?null:e],n},useContext:Mc,useEffect:SU,useImperativeHandle:function(n,e,a){return a=a!=null?a.concat([n]):null,FA(4194308,4,N$.bind(null,e,n),a)},useLayoutEffect:function(n,e){return FA(4194308,4,n,e)},useInsertionEffect:function(n,e){return FA(4,2,n,e)},useMemo:function(n,e){var a=td();return e=e===void 0?null:e,n=n(),a.memoizedState=[n,e],n},useReducer:function(n,e,a){var o=td();return e=a!==void 0?a(e):e,o.memoizedState=o.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},o.queue=n,n=n.dispatch=ule.bind(null,Rr,n),[o.memoizedState,n]},useRef:function(n){var e=td();return n={current:n},e.memoizedState=n},useState:wU,useDebugValue:qk,useDeferredValue:function(n){return td().memoizedState=n},useTransition:function(){var n=wU(!1),e=n[0];return n=cle.bind(null,n[1]),td().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,a){var o=Rr,s=td();if(_r){if(a===void 0)throw Error(hn(407));a=a()}else{if(a=e(),Vo===null)throw Error(hn(349));Cg&30||I$(o,e,a)}s.memoizedState=a;var c={value:a,getSnapshot:e};return s.queue=c,SU(R$.bind(null,o,c,n),[n]),o.flags|=2048,Ix(9,L$.bind(null,o,c,a,e),void 0,null),a},useId:function(){var n=td(),e=Vo.identifierPrefix;if(_r){var a=Sh,o=wh;a=(o&~(1<<32-cu(o)-1)).toString(32)+a,e=":"+e+"R"+a,a=Cx++,0<a&&(e+="H"+a.toString(32)),e+=":"}else a=lle++,e=":"+e+"r"+a.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},fle={readContext:Mc,useCallback:U$,useContext:Mc,useEffect:$k,useImperativeHandle:B$,useInsertionEffect:z$,useLayoutEffect:F$,useMemo:W$,useReducer:n4,useRef:O$,useState:function(){return n4(Px)},useDebugValue:qk,useDeferredValue:function(n){var e=Tc();return V$(e,Po.memoizedState,n)},useTransition:function(){var n=n4(Px)[0],e=Tc().memoizedState;return[n,e]},useMutableSource:C$,useSyncExternalStore:P$,useId:G$,unstable_isNewReconciler:!1},ple={readContext:Mc,useCallback:U$,useContext:Mc,useEffect:$k,useImperativeHandle:B$,useInsertionEffect:z$,useLayoutEffect:F$,useMemo:W$,useReducer:a4,useRef:O$,useState:function(){return a4(Px)},useDebugValue:qk,useDeferredValue:function(n){var e=Tc();return Po===null?e.memoizedState=n:V$(e,Po.memoizedState,n)},useTransition:function(){var n=a4(Px)[0],e=Tc().memoizedState;return[n,e]},useMutableSource:C$,useSyncExternalStore:P$,useId:G$,unstable_isNewReconciler:!1};function j0(n,e){try{var a="",o=e;do a+=Voe(o),o=o.return;while(o);var s=a}catch(c){s=`
Error generating stack: `+c.message+`
`+c.stack}return{value:n,source:e,stack:s,digest:null}}function i4(n,e,a){return{value:n,source:null,stack:a??null,digest:e??null}}function vL(n,e){try{console.error(e.value)}catch(a){setTimeout(function(){throw a})}}var mle=typeof WeakMap=="function"?WeakMap:Map;function q$(n,e,a){a=Ph(-1,a),a.tag=3,a.payload={element:null};var o=e.value;return a.callback=function(){kE||(kE=!0,CL=o),vL(n,e)},a}function X$(n,e,a){a=Ph(-1,a),a.tag=3;var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var s=e.value;a.payload=function(){return o(s)},a.callback=function(){vL(n,e)}}var c=n.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(a.callback=function(){vL(n,e),typeof o!="function"&&(op===null?op=new Set([this]):op.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),a}function AU(n,e,a){var o=n.pingCache;if(o===null){o=n.pingCache=new mle;var s=new Set;o.set(e,s)}else s=o.get(e),s===void 0&&(s=new Set,o.set(e,s));s.has(a)||(s.add(a),n=Ple.bind(null,n,e,a),e.then(n,n))}function EU(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function MU(n,e,a,o,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(e=Ph(-1,1),e.tag=2,rp(a,e,1))),a.lanes|=1),n)}var gle=Uh.ReactCurrentOwner,yl=!1;function Gs(n,e,a,o){e.child=n===null?M$(e,null,a,o):G0(e,n.child,a,o)}function TU(n,e,a,o,s){a=a.render;var c=e.ref;return I0(e,s),o=Hk(n,e,a,o,c,s),a=jk(),n!==null&&!yl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Oh(n,e,s)):(_r&&a&&Rk(e),e.flags|=1,Gs(n,e,o,s),e.child)}function CU(n,e,a,o,s){if(n===null){var c=a.type;return typeof c=="function"&&!tD(c)&&c.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(e.tag=15,e.type=c,Y$(n,e,c,o,s)):(n=WA(a.type,null,o,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(c=n.child,!(n.lanes&s)){var d=c.memoizedProps;if(a=a.compare,a=a!==null?a:wx,a(d,o)&&n.ref===e.ref)return Oh(n,e,s)}return e.flags|=1,n=lp(c,o),n.ref=e.ref,n.return=e,e.child=n}function Y$(n,e,a,o,s){if(n!==null){var c=n.memoizedProps;if(wx(c,o)&&n.ref===e.ref)if(yl=!1,e.pendingProps=o=c,(n.lanes&s)!==0)n.flags&131072&&(yl=!0);else return e.lanes=n.lanes,Oh(n,e,s)}return _L(n,e,a,o,s)}function Z$(n,e,a){var o=e.pendingProps,s=o.children,c=n!==null?n.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},tr(v0,Wl),Wl|=a;else{if(!(a&1073741824))return n=c!==null?c.baseLanes|a:a,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,tr(v0,Wl),Wl|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=c!==null?c.baseLanes:a,tr(v0,Wl),Wl|=o}else c!==null?(o=c.baseLanes|a,e.memoizedState=null):o=a,tr(v0,Wl),Wl|=o;return Gs(n,e,s,a),e.child}function K$(n,e){var a=e.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(e.flags|=512,e.flags|=2097152)}function _L(n,e,a,o,s){var c=bl(a)?Mg:Es.current;return c=W0(e,c),I0(e,s),a=Hk(n,e,a,o,c,s),o=jk(),n!==null&&!yl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Oh(n,e,s)):(_r&&o&&Rk(e),e.flags|=1,Gs(n,e,a,s),e.child)}function PU(n,e,a,o,s){if(bl(a)){var c=!0;SE(e)}else c=!1;if(I0(e,s),e.stateNode===null)NA(n,e),A$(e,a,o),yL(e,a,o,s),o=!0;else if(n===null){var d=e.stateNode,f=e.memoizedProps;d.props=f;var m=d.context,y=a.contextType;typeof y=="object"&&y!==null?y=Mc(y):(y=bl(a)?Mg:Es.current,y=W0(e,y));var _=a.getDerivedStateFromProps,x=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";x||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==o||m!==y)&&bU(e,d,o,y),Gf=!1;var S=e.memoizedState;d.state=S,CE(e,o,d,s),m=e.memoizedState,f!==o||S!==m||_l.current||Gf?(typeof _=="function"&&(gL(e,a,_,o),m=e.memoizedState),(f=Gf||_U(e,a,f,o,S,m,y))?(x||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=m),d.props=o,d.state=m,d.context=y,o=f):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{d=e.stateNode,w$(n,e),f=e.memoizedProps,y=e.type===e.elementType?f:eu(e.type,f),d.props=y,x=e.pendingProps,S=d.context,m=a.contextType,typeof m=="object"&&m!==null?m=Mc(m):(m=bl(a)?Mg:Es.current,m=W0(e,m));var T=a.getDerivedStateFromProps;(_=typeof T=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==x||S!==m)&&bU(e,d,o,m),Gf=!1,S=e.memoizedState,d.state=S,CE(e,o,d,s);var I=e.memoizedState;f!==x||S!==I||_l.current||Gf?(typeof T=="function"&&(gL(e,a,T,o),I=e.memoizedState),(y=Gf||_U(e,a,y,o,S,I,m)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,I,m),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,I,m)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=I),d.props=o,d.state=I,d.context=m,o=y):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),o=!1)}return bL(n,e,a,o,c,s)}function bL(n,e,a,o,s,c){K$(n,e);var d=(e.flags&128)!==0;if(!o&&!d)return s&&pU(e,a,!1),Oh(n,e,c);o=e.stateNode,gle.current=e;var f=d&&typeof a.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,n!==null&&d?(e.child=G0(e,n.child,null,c),e.child=G0(e,null,f,c)):Gs(n,e,f,c),e.memoizedState=o.state,s&&pU(e,a,!0),e.child}function J$(n){var e=n.stateNode;e.pendingContext?fU(n,e.pendingContext,e.pendingContext!==e.context):e.context&&fU(n,e.context,!1),Uk(n,e.containerInfo)}function IU(n,e,a,o,s){return V0(),Dk(s),e.flags|=256,Gs(n,e,a,o),e.child}var xL={dehydrated:null,treeContext:null,retryLane:0};function wL(n){return{baseLanes:n,cachePool:null,transitions:null}}function Q$(n,e,a){var o=e.pendingProps,s=Pr.current,c=!1,d=(e.flags&128)!==0,f;if((f=d)||(f=n!==null&&n.memoizedState===null?!1:(s&2)!==0),f?(c=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),tr(Pr,s&1),n===null)return pL(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=o.children,n=o.fallback,c?(o=e.mode,c=e.child,d={mode:"hidden",children:d},!(o&1)&&c!==null?(c.childLanes=0,c.pendingProps=d):c=PM(d,o,0,null),n=vg(n,o,a,null),c.return=e,n.return=e,c.sibling=n,e.child=c,e.child.memoizedState=wL(a),e.memoizedState=xL,n):Xk(e,d));if(s=n.memoizedState,s!==null&&(f=s.dehydrated,f!==null))return yle(n,e,d,o,f,s,a);if(c){c=o.fallback,d=e.mode,s=n.child,f=s.sibling;var m={mode:"hidden",children:o.children};return!(d&1)&&e.child!==s?(o=e.child,o.childLanes=0,o.pendingProps=m,e.deletions=null):(o=lp(s,m),o.subtreeFlags=s.subtreeFlags&14680064),f!==null?c=lp(f,c):(c=vg(c,d,a,null),c.flags|=2),c.return=e,o.return=e,o.sibling=c,e.child=o,o=c,c=e.child,d=n.child.memoizedState,d=d===null?wL(a):{baseLanes:d.baseLanes|a,cachePool:null,transitions:d.transitions},c.memoizedState=d,c.childLanes=n.childLanes&~a,e.memoizedState=xL,o}return c=n.child,n=c.sibling,o=lp(c,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=a),o.return=e,o.sibling=null,n!==null&&(a=e.deletions,a===null?(e.deletions=[n],e.flags|=16):a.push(n)),e.child=o,e.memoizedState=null,o}function Xk(n,e){return e=PM({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function aS(n,e,a,o){return o!==null&&Dk(o),G0(e,n.child,null,a),n=Xk(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function yle(n,e,a,o,s,c,d){if(a)return e.flags&256?(e.flags&=-257,o=i4(Error(hn(422))),aS(n,e,d,o)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(c=o.fallback,s=e.mode,o=PM({mode:"visible",children:o.children},s,0,null),c=vg(c,s,d,null),c.flags|=2,o.return=e,c.return=e,o.sibling=c,e.child=o,e.mode&1&&G0(e,n.child,null,d),e.child.memoizedState=wL(d),e.memoizedState=xL,c);if(!(e.mode&1))return aS(n,e,d,null);if(s.data==="$!"){if(o=s.nextSibling&&s.nextSibling.dataset,o)var f=o.dgst;return o=f,c=Error(hn(419)),o=i4(c,o,void 0),aS(n,e,d,o)}if(f=(d&n.childLanes)!==0,yl||f){if(o=Vo,o!==null){switch(d&-d){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(o.suspendedLanes|d)?0:s,s!==0&&s!==c.retryLane&&(c.retryLane=s,Dh(n,s),uu(o,n,s,-1))}return eD(),o=i4(Error(hn(421))),aS(n,e,d,o)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=Ile.bind(null,n),s._reactRetry=e,null):(n=c.treeContext,ql=ip(s.nextSibling),Xl=e,_r=!0,iu=null,n!==null&&(bc[xc++]=wh,bc[xc++]=Sh,bc[xc++]=Tg,wh=n.id,Sh=n.overflow,Tg=e),e=Xk(e,o.children),e.flags|=4096,e)}function LU(n,e,a){n.lanes|=e;var o=n.alternate;o!==null&&(o.lanes|=e),mL(n.return,e,a)}function r4(n,e,a,o,s){var c=n.memoizedState;c===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:a,tailMode:s}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=o,c.tail=a,c.tailMode=s)}function eq(n,e,a){var o=e.pendingProps,s=o.revealOrder,c=o.tail;if(Gs(n,e,o.children,a),o=Pr.current,o&2)o=o&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&LU(n,a,e);else if(n.tag===19)LU(n,a,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}o&=1}if(tr(Pr,o),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(a=e.child,s=null;a!==null;)n=a.alternate,n!==null&&PE(n)===null&&(s=a),a=a.sibling;a=s,a===null?(s=e.child,e.child=null):(s=a.sibling,a.sibling=null),r4(e,!1,s,a,c);break;case"backwards":for(a=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&PE(n)===null){e.child=s;break}n=s.sibling,s.sibling=a,a=s,s=n}r4(e,!0,a,null,c);break;case"together":r4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function NA(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Oh(n,e,a){if(n!==null&&(e.dependencies=n.dependencies),Pg|=e.lanes,!(a&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(hn(153));if(e.child!==null){for(n=e.child,a=lp(n,n.pendingProps),e.child=a,a.return=e;n.sibling!==null;)n=n.sibling,a=a.sibling=lp(n,n.pendingProps),a.return=e;a.sibling=null}return e.child}function vle(n,e,a){switch(e.tag){case 3:J$(e),V0();break;case 5:T$(e);break;case 1:bl(e.type)&&SE(e);break;case 4:Uk(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,s=e.memoizedProps.value;tr(ME,o._currentValue),o._currentValue=s;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(tr(Pr,Pr.current&1),e.flags|=128,null):a&e.child.childLanes?Q$(n,e,a):(tr(Pr,Pr.current&1),n=Oh(n,e,a),n!==null?n.sibling:null);tr(Pr,Pr.current&1);break;case 19:if(o=(a&e.childLanes)!==0,n.flags&128){if(o)return eq(n,e,a);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),tr(Pr,Pr.current),o)break;return null;case 22:case 23:return e.lanes=0,Z$(n,e,a)}return Oh(n,e,a)}var tq,SL,nq,aq;tq=function(n,e){for(var a=e.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===e)break;for(;a.sibling===null;){if(a.return===null||a.return===e)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};SL=function(){};nq=function(n,e,a,o){var s=n.memoizedProps;if(s!==o){n=e.stateNode,og(ud.current);var c=null;switch(a){case"input":s=jI(n,s),o=jI(n,o),c=[];break;case"select":s=Dr({},s,{value:void 0}),o=Dr({},o,{value:void 0}),c=[];break;case"textarea":s=XI(n,s),o=XI(n,o),c=[];break;default:typeof s.onClick!="function"&&typeof o.onClick=="function"&&(n.onclick=xE)}ZI(a,o);var d;a=null;for(y in s)if(!o.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var f=s[y];for(d in f)f.hasOwnProperty(d)&&(a||(a={}),a[d]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(mx.hasOwnProperty(y)?c||(c=[]):(c=c||[]).push(y,null));for(y in o){var m=o[y];if(f=s!=null?s[y]:void 0,o.hasOwnProperty(y)&&m!==f&&(m!=null||f!=null))if(y==="style")if(f){for(d in f)!f.hasOwnProperty(d)||m&&m.hasOwnProperty(d)||(a||(a={}),a[d]="");for(d in m)m.hasOwnProperty(d)&&f[d]!==m[d]&&(a||(a={}),a[d]=m[d])}else a||(c||(c=[]),c.push(y,a)),a=m;else y==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,f=f?f.__html:void 0,m!=null&&f!==m&&(c=c||[]).push(y,m)):y==="children"?typeof m!="string"&&typeof m!="number"||(c=c||[]).push(y,""+m):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(mx.hasOwnProperty(y)?(m!=null&&y==="onScroll"&&or("scroll",n),c||f===m||(c=[])):(c=c||[]).push(y,m))}a&&(c=c||[]).push("style",a);var y=c;(e.updateQueue=y)&&(e.flags|=4)}};aq=function(n,e,a,o){a!==o&&(e.flags|=4)};function G1(n,e){if(!_r)switch(n.tailMode){case"hidden":e=n.tail;for(var a=null;e!==null;)e.alternate!==null&&(a=e),e=e.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var o=null;a!==null;)a.alternate!==null&&(o=a),a=a.sibling;o===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:o.sibling=null}}function ms(n){var e=n.alternate!==null&&n.alternate.child===n.child,a=0,o=0;if(e)for(var s=n.child;s!==null;)a|=s.lanes|s.childLanes,o|=s.subtreeFlags&14680064,o|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)a|=s.lanes|s.childLanes,o|=s.subtreeFlags,o|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=o,n.childLanes=a,e}function _le(n,e,a){var o=e.pendingProps;switch(kk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ms(e),null;case 1:return bl(e.type)&&wE(),ms(e),null;case 3:return o=e.stateNode,H0(),cr(_l),cr(Es),Vk(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(tS(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,iu!==null&&(LL(iu),iu=null))),SL(n,e),ms(e),null;case 5:Wk(e);var s=og(Tx.current);if(a=e.type,n!==null&&e.stateNode!=null)nq(n,e,a,o,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(hn(166));return ms(e),null}if(n=og(ud.current),tS(e)){o=e.stateNode,a=e.type;var c=e.memoizedProps;switch(o[rd]=e,o[Ex]=c,n=(e.mode&1)!==0,a){case"dialog":or("cancel",o),or("close",o);break;case"iframe":case"object":case"embed":or("load",o);break;case"video":case"audio":for(s=0;s<Mb.length;s++)or(Mb[s],o);break;case"source":or("error",o);break;case"img":case"image":case"link":or("error",o),or("load",o);break;case"details":or("toggle",o);break;case"input":U9(o,c),or("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!c.multiple},or("invalid",o);break;case"textarea":V9(o,c),or("invalid",o)}ZI(a,c),s=null;for(var d in c)if(c.hasOwnProperty(d)){var f=c[d];d==="children"?typeof f=="string"?o.textContent!==f&&(c.suppressHydrationWarning!==!0&&eS(o.textContent,f,n),s=["children",f]):typeof f=="number"&&o.textContent!==""+f&&(c.suppressHydrationWarning!==!0&&eS(o.textContent,f,n),s=["children",""+f]):mx.hasOwnProperty(d)&&f!=null&&d==="onScroll"&&or("scroll",o)}switch(a){case"input":$3(o),W9(o,c,!0);break;case"textarea":$3(o),G9(o);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(o.onclick=xE)}o=s,e.updateQueue=o,o!==null&&(e.flags|=4)}else{d=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Ij(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof o.is=="string"?n=d.createElement(a,{is:o.is}):(n=d.createElement(a),a==="select"&&(d=n,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):n=d.createElementNS(n,a),n[rd]=e,n[Ex]=o,tq(n,e,!1,!1),e.stateNode=n;e:{switch(d=KI(a,o),a){case"dialog":or("cancel",n),or("close",n),s=o;break;case"iframe":case"object":case"embed":or("load",n),s=o;break;case"video":case"audio":for(s=0;s<Mb.length;s++)or(Mb[s],n);s=o;break;case"source":or("error",n),s=o;break;case"img":case"image":case"link":or("error",n),or("load",n),s=o;break;case"details":or("toggle",n),s=o;break;case"input":U9(n,o),s=jI(n,o),or("invalid",n);break;case"option":s=o;break;case"select":n._wrapperState={wasMultiple:!!o.multiple},s=Dr({},o,{value:void 0}),or("invalid",n);break;case"textarea":V9(n,o),s=XI(n,o),or("invalid",n);break;default:s=o}ZI(a,s),f=s;for(c in f)if(f.hasOwnProperty(c)){var m=f[c];c==="style"?kj(n,m):c==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&Lj(n,m)):c==="children"?typeof m=="string"?(a!=="textarea"||m!=="")&&gx(n,m):typeof m=="number"&&gx(n,""+m):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(mx.hasOwnProperty(c)?m!=null&&c==="onScroll"&&or("scroll",n):m!=null&&vk(n,c,m,d))}switch(a){case"input":$3(n),W9(n,o,!1);break;case"textarea":$3(n),G9(n);break;case"option":o.value!=null&&n.setAttribute("value",""+mp(o.value));break;case"select":n.multiple=!!o.multiple,c=o.value,c!=null?M0(n,!!o.multiple,c,!1):o.defaultValue!=null&&M0(n,!!o.multiple,o.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=xE)}switch(a){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ms(e),null;case 6:if(n&&e.stateNode!=null)aq(n,e,n.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(hn(166));if(a=og(Tx.current),og(ud.current),tS(e)){if(o=e.stateNode,a=e.memoizedProps,o[rd]=e,(c=o.nodeValue!==a)&&(n=Xl,n!==null))switch(n.tag){case 3:eS(o.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&eS(o.nodeValue,a,(n.mode&1)!==0)}c&&(e.flags|=4)}else o=(a.nodeType===9?a:a.ownerDocument).createTextNode(o),o[rd]=e,e.stateNode=o}return ms(e),null;case 13:if(cr(Pr),o=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(_r&&ql!==null&&e.mode&1&&!(e.flags&128))b$(),V0(),e.flags|=98560,c=!1;else if(c=tS(e),o!==null&&o.dehydrated!==null){if(n===null){if(!c)throw Error(hn(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(hn(317));c[rd]=e}else V0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ms(e),c=!1}else iu!==null&&(LL(iu),iu=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=a,e):(o=o!==null,o!==(n!==null&&n.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(n===null||Pr.current&1?Lo===0&&(Lo=3):eD())),e.updateQueue!==null&&(e.flags|=4),ms(e),null);case 4:return H0(),SL(n,e),n===null&&Sx(e.stateNode.containerInfo),ms(e),null;case 10:return Fk(e.type._context),ms(e),null;case 17:return bl(e.type)&&wE(),ms(e),null;case 19:if(cr(Pr),c=e.memoizedState,c===null)return ms(e),null;if(o=(e.flags&128)!==0,d=c.rendering,d===null)if(o)G1(c,!1);else{if(Lo!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(d=PE(n),d!==null){for(e.flags|=128,G1(c,!1),o=d.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=a,a=e.child;a!==null;)c=a,n=o,c.flags&=14680066,d=c.alternate,d===null?(c.childLanes=0,c.lanes=n,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=d.childLanes,c.lanes=d.lanes,c.child=d.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=d.memoizedProps,c.memoizedState=d.memoizedState,c.updateQueue=d.updateQueue,c.type=d.type,n=d.dependencies,c.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return tr(Pr,Pr.current&1|2),e.child}n=n.sibling}c.tail!==null&&co()>$0&&(e.flags|=128,o=!0,G1(c,!1),e.lanes=4194304)}else{if(!o)if(n=PE(d),n!==null){if(e.flags|=128,o=!0,a=n.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),G1(c,!0),c.tail===null&&c.tailMode==="hidden"&&!d.alternate&&!_r)return ms(e),null}else 2*co()-c.renderingStartTime>$0&&a!==1073741824&&(e.flags|=128,o=!0,G1(c,!1),e.lanes=4194304);c.isBackwards?(d.sibling=e.child,e.child=d):(a=c.last,a!==null?a.sibling=d:e.child=d,c.last=d)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=co(),e.sibling=null,a=Pr.current,tr(Pr,o?a&1|2:a&1),e):(ms(e),null);case 22:case 23:return Qk(),o=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?Wl&1073741824&&(ms(e),e.subtreeFlags&6&&(e.flags|=8192)):ms(e),null;case 24:return null;case 25:return null}throw Error(hn(156,e.tag))}function ble(n,e){switch(kk(e),e.tag){case 1:return bl(e.type)&&wE(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return H0(),cr(_l),cr(Es),Vk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Wk(e),null;case 13:if(cr(Pr),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(hn(340));V0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return cr(Pr),null;case 4:return H0(),null;case 10:return Fk(e.type._context),null;case 22:case 23:return Qk(),null;case 24:return null;default:return null}}var iS=!1,bs=!1,xle=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function y0(n,e){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(o){Hr(n,e,o)}else a.current=null}function AL(n,e,a){try{a()}catch(o){Hr(n,e,o)}}var RU=!1;function wle(n,e){if(sL=vE,n=s$(),Lk(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else e:{a=(a=n.ownerDocument)&&a.defaultView||window;var o=a.getSelection&&a.getSelection();if(o&&o.rangeCount!==0){a=o.anchorNode;var s=o.anchorOffset,c=o.focusNode;o=o.focusOffset;try{a.nodeType,c.nodeType}catch{a=null;break e}var d=0,f=-1,m=-1,y=0,_=0,x=n,S=null;t:for(;;){for(var T;x!==a||s!==0&&x.nodeType!==3||(f=d+s),x!==c||o!==0&&x.nodeType!==3||(m=d+o),x.nodeType===3&&(d+=x.nodeValue.length),(T=x.firstChild)!==null;)S=x,x=T;for(;;){if(x===n)break t;if(S===a&&++y===s&&(f=d),S===c&&++_===o&&(m=d),(T=x.nextSibling)!==null)break;x=S,S=x.parentNode}x=T}a=f===-1||m===-1?null:{start:f,end:m}}else a=null}a=a||{start:0,end:0}}else a=null;for(lL={focusedElem:n,selectionRange:a},vE=!1,Fn=e;Fn!==null;)if(e=Fn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Fn=n;else for(;Fn!==null;){e=Fn;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var k=I.memoizedProps,D=I.memoizedState,L=e.stateNode,O=L.getSnapshotBeforeUpdate(e.elementType===e.type?k:eu(e.type,k),D);L.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var F=e.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(hn(163))}}catch(B){Hr(e,e.return,B)}if(n=e.sibling,n!==null){n.return=e.return,Fn=n;break}Fn=e.return}return I=RU,RU=!1,I}function Gb(n,e,a){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&n)===n){var c=s.destroy;s.destroy=void 0,c!==void 0&&AL(e,a,c)}s=s.next}while(s!==o)}}function TM(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var a=e=e.next;do{if((a.tag&n)===n){var o=a.create;a.destroy=o()}a=a.next}while(a!==e)}}function EL(n){var e=n.ref;if(e!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof e=="function"?e(n):e.current=n}}function iq(n){var e=n.alternate;e!==null&&(n.alternate=null,iq(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[rd],delete e[Ex],delete e[dL],delete e[ile],delete e[rle])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function rq(n){return n.tag===5||n.tag===3||n.tag===4}function kU(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||rq(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ML(n,e,a){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?a.nodeType===8?a.parentNode.insertBefore(n,e):a.insertBefore(n,e):(a.nodeType===8?(e=a.parentNode,e.insertBefore(n,a)):(e=a,e.appendChild(n)),a=a._reactRootContainer,a!=null||e.onclick!==null||(e.onclick=xE));else if(o!==4&&(n=n.child,n!==null))for(ML(n,e,a),n=n.sibling;n!==null;)ML(n,e,a),n=n.sibling}function TL(n,e,a){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?a.insertBefore(n,e):a.appendChild(n);else if(o!==4&&(n=n.child,n!==null))for(TL(n,e,a),n=n.sibling;n!==null;)TL(n,e,a),n=n.sibling}var Ko=null,nu=!1;function Rf(n,e,a){for(a=a.child;a!==null;)oq(n,e,a),a=a.sibling}function oq(n,e,a){if(cd&&typeof cd.onCommitFiberUnmount=="function")try{cd.onCommitFiberUnmount(_M,a)}catch{}switch(a.tag){case 5:bs||y0(a,e);case 6:var o=Ko,s=nu;Ko=null,Rf(n,e,a),Ko=o,nu=s,Ko!==null&&(nu?(n=Ko,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):Ko.removeChild(a.stateNode));break;case 18:Ko!==null&&(nu?(n=Ko,a=a.stateNode,n.nodeType===8?J5(n.parentNode,a):n.nodeType===1&&J5(n,a),bx(n)):J5(Ko,a.stateNode));break;case 4:o=Ko,s=nu,Ko=a.stateNode.containerInfo,nu=!0,Rf(n,e,a),Ko=o,nu=s;break;case 0:case 11:case 14:case 15:if(!bs&&(o=a.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){s=o=o.next;do{var c=s,d=c.destroy;c=c.tag,d!==void 0&&(c&2||c&4)&&AL(a,e,d),s=s.next}while(s!==o)}Rf(n,e,a);break;case 1:if(!bs&&(y0(a,e),o=a.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=a.memoizedProps,o.state=a.memoizedState,o.componentWillUnmount()}catch(f){Hr(a,e,f)}Rf(n,e,a);break;case 21:Rf(n,e,a);break;case 22:a.mode&1?(bs=(o=bs)||a.memoizedState!==null,Rf(n,e,a),bs=o):Rf(n,e,a);break;default:Rf(n,e,a)}}function DU(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new xle),e.forEach(function(o){var s=Lle.bind(null,n,o);a.has(o)||(a.add(o),o.then(s,s))})}}function Zc(n,e){var a=e.deletions;if(a!==null)for(var o=0;o<a.length;o++){var s=a[o];try{var c=n,d=e,f=d;e:for(;f!==null;){switch(f.tag){case 5:Ko=f.stateNode,nu=!1;break e;case 3:Ko=f.stateNode.containerInfo,nu=!0;break e;case 4:Ko=f.stateNode.containerInfo,nu=!0;break e}f=f.return}if(Ko===null)throw Error(hn(160));oq(c,d,s),Ko=null,nu=!1;var m=s.alternate;m!==null&&(m.return=null),s.return=null}catch(y){Hr(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)sq(e,n),e=e.sibling}function sq(n,e){var a=n.alternate,o=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Zc(e,n),Qu(n),o&4){try{Gb(3,n,n.return),TM(3,n)}catch(k){Hr(n,n.return,k)}try{Gb(5,n,n.return)}catch(k){Hr(n,n.return,k)}}break;case 1:Zc(e,n),Qu(n),o&512&&a!==null&&y0(a,a.return);break;case 5:if(Zc(e,n),Qu(n),o&512&&a!==null&&y0(a,a.return),n.flags&32){var s=n.stateNode;try{gx(s,"")}catch(k){Hr(n,n.return,k)}}if(o&4&&(s=n.stateNode,s!=null)){var c=n.memoizedProps,d=a!==null?a.memoizedProps:c,f=n.type,m=n.updateQueue;if(n.updateQueue=null,m!==null)try{f==="input"&&c.type==="radio"&&c.name!=null&&Cj(s,c),KI(f,d);var y=KI(f,c);for(d=0;d<m.length;d+=2){var _=m[d],x=m[d+1];_==="style"?kj(s,x):_==="dangerouslySetInnerHTML"?Lj(s,x):_==="children"?gx(s,x):vk(s,_,x,y)}switch(f){case"input":$I(s,c);break;case"textarea":Pj(s,c);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!c.multiple;var T=c.value;T!=null?M0(s,!!c.multiple,T,!1):S!==!!c.multiple&&(c.defaultValue!=null?M0(s,!!c.multiple,c.defaultValue,!0):M0(s,!!c.multiple,c.multiple?[]:"",!1))}s[Ex]=c}catch(k){Hr(n,n.return,k)}}break;case 6:if(Zc(e,n),Qu(n),o&4){if(n.stateNode===null)throw Error(hn(162));s=n.stateNode,c=n.memoizedProps;try{s.nodeValue=c}catch(k){Hr(n,n.return,k)}}break;case 3:if(Zc(e,n),Qu(n),o&4&&a!==null&&a.memoizedState.isDehydrated)try{bx(e.containerInfo)}catch(k){Hr(n,n.return,k)}break;case 4:Zc(e,n),Qu(n);break;case 13:Zc(e,n),Qu(n),s=n.child,s.flags&8192&&(c=s.memoizedState!==null,s.stateNode.isHidden=c,!c||s.alternate!==null&&s.alternate.memoizedState!==null||(Kk=co())),o&4&&DU(n);break;case 22:if(_=a!==null&&a.memoizedState!==null,n.mode&1?(bs=(y=bs)||_,Zc(e,n),bs=y):Zc(e,n),Qu(n),o&8192){if(y=n.memoizedState!==null,(n.stateNode.isHidden=y)&&!_&&n.mode&1)for(Fn=n,_=n.child;_!==null;){for(x=Fn=_;Fn!==null;){switch(S=Fn,T=S.child,S.tag){case 0:case 11:case 14:case 15:Gb(4,S,S.return);break;case 1:y0(S,S.return);var I=S.stateNode;if(typeof I.componentWillUnmount=="function"){o=S,a=S.return;try{e=o,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(k){Hr(o,a,k)}}break;case 5:y0(S,S.return);break;case 22:if(S.memoizedState!==null){zU(x);continue}}T!==null?(T.return=S,Fn=T):zU(x)}_=_.sibling}e:for(_=null,x=n;;){if(x.tag===5){if(_===null){_=x;try{s=x.stateNode,y?(c=s.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(f=x.stateNode,m=x.memoizedProps.style,d=m!=null&&m.hasOwnProperty("display")?m.display:null,f.style.display=Rj("display",d))}catch(k){Hr(n,n.return,k)}}}else if(x.tag===6){if(_===null)try{x.stateNode.nodeValue=y?"":x.memoizedProps}catch(k){Hr(n,n.return,k)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===n)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===n)break e;for(;x.sibling===null;){if(x.return===null||x.return===n)break e;_===x&&(_=null),x=x.return}_===x&&(_=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:Zc(e,n),Qu(n),o&4&&DU(n);break;case 21:break;default:Zc(e,n),Qu(n)}}function Qu(n){var e=n.flags;if(e&2){try{e:{for(var a=n.return;a!==null;){if(rq(a)){var o=a;break e}a=a.return}throw Error(hn(160))}switch(o.tag){case 5:var s=o.stateNode;o.flags&32&&(gx(s,""),o.flags&=-33);var c=kU(n);TL(n,c,s);break;case 3:case 4:var d=o.stateNode.containerInfo,f=kU(n);ML(n,f,d);break;default:throw Error(hn(161))}}catch(m){Hr(n,n.return,m)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Sle(n,e,a){Fn=n,lq(n)}function lq(n,e,a){for(var o=(n.mode&1)!==0;Fn!==null;){var s=Fn,c=s.child;if(s.tag===22&&o){var d=s.memoizedState!==null||iS;if(!d){var f=s.alternate,m=f!==null&&f.memoizedState!==null||bs;f=iS;var y=bs;if(iS=d,(bs=m)&&!y)for(Fn=s;Fn!==null;)d=Fn,m=d.child,d.tag===22&&d.memoizedState!==null?FU(s):m!==null?(m.return=d,Fn=m):FU(s);for(;c!==null;)Fn=c,lq(c),c=c.sibling;Fn=s,iS=f,bs=y}OU(n)}else s.subtreeFlags&8772&&c!==null?(c.return=s,Fn=c):OU(n)}}function OU(n){for(;Fn!==null;){var e=Fn;if(e.flags&8772){var a=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bs||TM(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!bs)if(a===null)o.componentDidMount();else{var s=e.elementType===e.type?a.memoizedProps:eu(e.type,a.memoizedProps);o.componentDidUpdate(s,a.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&vU(e,c,o);break;case 3:var d=e.updateQueue;if(d!==null){if(a=null,e.child!==null)switch(e.child.tag){case 5:a=e.child.stateNode;break;case 1:a=e.child.stateNode}vU(e,d,a)}break;case 5:var f=e.stateNode;if(a===null&&e.flags&4){a=f;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&a.focus();break;case"img":m.src&&(a.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var _=y.memoizedState;if(_!==null){var x=_.dehydrated;x!==null&&bx(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(hn(163))}bs||e.flags&512&&EL(e)}catch(S){Hr(e,e.return,S)}}if(e===n){Fn=null;break}if(a=e.sibling,a!==null){a.return=e.return,Fn=a;break}Fn=e.return}}function zU(n){for(;Fn!==null;){var e=Fn;if(e===n){Fn=null;break}var a=e.sibling;if(a!==null){a.return=e.return,Fn=a;break}Fn=e.return}}function FU(n){for(;Fn!==null;){var e=Fn;try{switch(e.tag){case 0:case 11:case 15:var a=e.return;try{TM(4,e)}catch(m){Hr(e,a,m)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var s=e.return;try{o.componentDidMount()}catch(m){Hr(e,s,m)}}var c=e.return;try{EL(e)}catch(m){Hr(e,c,m)}break;case 5:var d=e.return;try{EL(e)}catch(m){Hr(e,d,m)}}}catch(m){Hr(e,e.return,m)}if(e===n){Fn=null;break}var f=e.sibling;if(f!==null){f.return=e.return,Fn=f;break}Fn=e.return}}var Ale=Math.ceil,RE=Uh.ReactCurrentDispatcher,Yk=Uh.ReactCurrentOwner,Ac=Uh.ReactCurrentBatchConfig,li=0,Vo=null,wo=null,es=0,Wl=0,v0=Ap(0),Lo=0,Lx=null,Pg=0,CM=0,Zk=0,Hb=null,hl=null,Kk=0,$0=1/0,gh=null,kE=!1,CL=null,op=null,rS=!1,Xf=null,DE=0,jb=0,PL=null,BA=-1,UA=0;function Hs(){return li&6?co():BA!==-1?BA:BA=co()}function sp(n){return n.mode&1?li&2&&es!==0?es&-es:sle.transition!==null?(UA===0&&(UA=jj()),UA):(n=Ni,n!==0||(n=window.event,n=n===void 0?16:Jj(n.type)),n):1}function uu(n,e,a,o){if(50<jb)throw jb=0,PL=null,Error(hn(185));vw(n,a,o),(!(li&2)||n!==Vo)&&(n===Vo&&(!(li&2)&&(CM|=a),Lo===4&&jf(n,es)),xl(n,o),a===1&&li===0&&!(e.mode&1)&&($0=co()+500,AM&&Ep()))}function xl(n,e){var a=n.callbackNode;sse(n,e);var o=yE(n,n===Vo?es:0);if(o===0)a!==null&&$9(a),n.callbackNode=null,n.callbackPriority=0;else if(e=o&-o,n.callbackPriority!==e){if(a!=null&&$9(a),e===1)n.tag===0?ole(NU.bind(null,n)):y$(NU.bind(null,n)),nle(function(){!(li&6)&&Ep()}),a=null;else{switch($j(o)){case 1:a=Sk;break;case 4:a=Gj;break;case 16:a=gE;break;case 536870912:a=Hj;break;default:a=gE}a=gq(a,cq.bind(null,n))}n.callbackPriority=e,n.callbackNode=a}}function cq(n,e){if(BA=-1,UA=0,li&6)throw Error(hn(327));var a=n.callbackNode;if(L0()&&n.callbackNode!==a)return null;var o=yE(n,n===Vo?es:0);if(o===0)return null;if(o&30||o&n.expiredLanes||e)e=OE(n,o);else{e=o;var s=li;li|=2;var c=dq();(Vo!==n||es!==e)&&(gh=null,$0=co()+500,yg(n,e));do try{Tle();break}catch(f){uq(n,f)}while(1);zk(),RE.current=c,li=s,wo!==null?e=0:(Vo=null,es=0,e=Lo)}if(e!==0){if(e===2&&(s=nL(n),s!==0&&(o=s,e=IL(n,s))),e===1)throw a=Lx,yg(n,0),jf(n,o),xl(n,co()),a;if(e===6)jf(n,o);else{if(s=n.current.alternate,!(o&30)&&!Ele(s)&&(e=OE(n,o),e===2&&(c=nL(n),c!==0&&(o=c,e=IL(n,c))),e===1))throw a=Lx,yg(n,0),jf(n,o),xl(n,co()),a;switch(n.finishedWork=s,n.finishedLanes=o,e){case 0:case 1:throw Error(hn(345));case 2:qm(n,hl,gh);break;case 3:if(jf(n,o),(o&130023424)===o&&(e=Kk+500-co(),10<e)){if(yE(n,0)!==0)break;if(s=n.suspendedLanes,(s&o)!==o){Hs(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=uL(qm.bind(null,n,hl,gh),e);break}qm(n,hl,gh);break;case 4:if(jf(n,o),(o&4194240)===o)break;for(e=n.eventTimes,s=-1;0<o;){var d=31-cu(o);c=1<<d,d=e[d],d>s&&(s=d),o&=~c}if(o=s,o=co()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Ale(o/1960))-o,10<o){n.timeoutHandle=uL(qm.bind(null,n,hl,gh),o);break}qm(n,hl,gh);break;case 5:qm(n,hl,gh);break;default:throw Error(hn(329))}}}return xl(n,co()),n.callbackNode===a?cq.bind(null,n):null}function IL(n,e){var a=Hb;return n.current.memoizedState.isDehydrated&&(yg(n,e).flags|=256),n=OE(n,e),n!==2&&(e=hl,hl=a,e!==null&&LL(e)),n}function LL(n){hl===null?hl=n:hl.push.apply(hl,n)}function Ele(n){for(var e=n;;){if(e.flags&16384){var a=e.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var o=0;o<a.length;o++){var s=a[o],c=s.getSnapshot;s=s.value;try{if(!fu(c(),s))return!1}catch{return!1}}}if(a=e.child,e.subtreeFlags&16384&&a!==null)a.return=e,e=a;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function jf(n,e){for(e&=~Zk,e&=~CM,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var a=31-cu(e),o=1<<a;n[a]=-1,e&=~o}}function NU(n){if(li&6)throw Error(hn(327));L0();var e=yE(n,0);if(!(e&1))return xl(n,co()),null;var a=OE(n,e);if(n.tag!==0&&a===2){var o=nL(n);o!==0&&(e=o,a=IL(n,o))}if(a===1)throw a=Lx,yg(n,0),jf(n,e),xl(n,co()),a;if(a===6)throw Error(hn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,qm(n,hl,gh),xl(n,co()),null}function Jk(n,e){var a=li;li|=1;try{return n(e)}finally{li=a,li===0&&($0=co()+500,AM&&Ep())}}function Ig(n){Xf!==null&&Xf.tag===0&&!(li&6)&&L0();var e=li;li|=1;var a=Ac.transition,o=Ni;try{if(Ac.transition=null,Ni=1,n)return n()}finally{Ni=o,Ac.transition=a,li=e,!(li&6)&&Ep()}}function Qk(){Wl=v0.current,cr(v0)}function yg(n,e){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,tle(a)),wo!==null)for(a=wo.return;a!==null;){var o=a;switch(kk(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&wE();break;case 3:H0(),cr(_l),cr(Es),Vk();break;case 5:Wk(o);break;case 4:H0();break;case 13:cr(Pr);break;case 19:cr(Pr);break;case 10:Fk(o.type._context);break;case 22:case 23:Qk()}a=a.return}if(Vo=n,wo=n=lp(n.current,null),es=Wl=e,Lo=0,Lx=null,Zk=CM=Pg=0,hl=Hb=null,rg!==null){for(e=0;e<rg.length;e++)if(a=rg[e],o=a.interleaved,o!==null){a.interleaved=null;var s=o.next,c=a.pending;if(c!==null){var d=c.next;c.next=s,o.next=d}a.pending=o}rg=null}return n}function uq(n,e){do{var a=wo;try{if(zk(),zA.current=LE,IE){for(var o=Rr.memoizedState;o!==null;){var s=o.queue;s!==null&&(s.pending=null),o=o.next}IE=!1}if(Cg=0,Bo=Po=Rr=null,Vb=!1,Cx=0,Yk.current=null,a===null||a.return===null){Lo=1,Lx=e,wo=null;break}e:{var c=n,d=a.return,f=a,m=e;if(e=es,f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var y=m,_=f,x=_.tag;if(!(_.mode&1)&&(x===0||x===11||x===15)){var S=_.alternate;S?(_.updateQueue=S.updateQueue,_.memoizedState=S.memoizedState,_.lanes=S.lanes):(_.updateQueue=null,_.memoizedState=null)}var T=EU(d);if(T!==null){T.flags&=-257,MU(T,d,f,c,e),T.mode&1&&AU(c,y,e),e=T,m=y;var I=e.updateQueue;if(I===null){var k=new Set;k.add(m),e.updateQueue=k}else I.add(m);break e}else{if(!(e&1)){AU(c,y,e),eD();break e}m=Error(hn(426))}}else if(_r&&f.mode&1){var D=EU(d);if(D!==null){!(D.flags&65536)&&(D.flags|=256),MU(D,d,f,c,e),Dk(j0(m,f));break e}}c=m=j0(m,f),Lo!==4&&(Lo=2),Hb===null?Hb=[c]:Hb.push(c),c=d;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var L=q$(c,m,e);yU(c,L);break e;case 1:f=m;var O=c.type,F=c.stateNode;if(!(c.flags&128)&&(typeof O.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(op===null||!op.has(F)))){c.flags|=65536,e&=-e,c.lanes|=e;var B=X$(c,f,e);yU(c,B);break e}}c=c.return}while(c!==null)}fq(a)}catch(G){e=G,wo===a&&a!==null&&(wo=a=a.return);continue}break}while(1)}function dq(){var n=RE.current;return RE.current=LE,n===null?LE:n}function eD(){(Lo===0||Lo===3||Lo===2)&&(Lo=4),Vo===null||!(Pg&268435455)&&!(CM&268435455)||jf(Vo,es)}function OE(n,e){var a=li;li|=2;var o=dq();(Vo!==n||es!==e)&&(gh=null,yg(n,e));do try{Mle();break}catch(s){uq(n,s)}while(1);if(zk(),li=a,RE.current=o,wo!==null)throw Error(hn(261));return Vo=null,es=0,Lo}function Mle(){for(;wo!==null;)hq(wo)}function Tle(){for(;wo!==null&&!Joe();)hq(wo)}function hq(n){var e=mq(n.alternate,n,Wl);n.memoizedProps=n.pendingProps,e===null?fq(n):wo=e,Yk.current=null}function fq(n){var e=n;do{var a=e.alternate;if(n=e.return,e.flags&32768){if(a=ble(a,e),a!==null){a.flags&=32767,wo=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Lo=6,wo=null;return}}else if(a=_le(a,e,Wl),a!==null){wo=a;return}if(e=e.sibling,e!==null){wo=e;return}wo=e=n}while(e!==null);Lo===0&&(Lo=5)}function qm(n,e,a){var o=Ni,s=Ac.transition;try{Ac.transition=null,Ni=1,Cle(n,e,a,o)}finally{Ac.transition=s,Ni=o}return null}function Cle(n,e,a,o){do L0();while(Xf!==null);if(li&6)throw Error(hn(327));a=n.finishedWork;var s=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(hn(177));n.callbackNode=null,n.callbackPriority=0;var c=a.lanes|a.childLanes;if(lse(n,c),n===Vo&&(wo=Vo=null,es=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||rS||(rS=!0,gq(gE,function(){return L0(),null})),c=(a.flags&15990)!==0,a.subtreeFlags&15990||c){c=Ac.transition,Ac.transition=null;var d=Ni;Ni=1;var f=li;li|=4,Yk.current=null,wle(n,a),sq(a,n),Xse(lL),vE=!!sL,lL=sL=null,n.current=a,Sle(a),Qoe(),li=f,Ni=d,Ac.transition=c}else n.current=a;if(rS&&(rS=!1,Xf=n,DE=s),c=n.pendingLanes,c===0&&(op=null),nse(a.stateNode),xl(n,co()),e!==null)for(o=n.onRecoverableError,a=0;a<e.length;a++)s=e[a],o(s.value,{componentStack:s.stack,digest:s.digest});if(kE)throw kE=!1,n=CL,CL=null,n;return DE&1&&n.tag!==0&&L0(),c=n.pendingLanes,c&1?n===PL?jb++:(jb=0,PL=n):jb=0,Ep(),null}function L0(){if(Xf!==null){var n=$j(DE),e=Ac.transition,a=Ni;try{if(Ac.transition=null,Ni=16>n?16:n,Xf===null)var o=!1;else{if(n=Xf,Xf=null,DE=0,li&6)throw Error(hn(331));var s=li;for(li|=4,Fn=n.current;Fn!==null;){var c=Fn,d=c.child;if(Fn.flags&16){var f=c.deletions;if(f!==null){for(var m=0;m<f.length;m++){var y=f[m];for(Fn=y;Fn!==null;){var _=Fn;switch(_.tag){case 0:case 11:case 15:Gb(8,_,c)}var x=_.child;if(x!==null)x.return=_,Fn=x;else for(;Fn!==null;){_=Fn;var S=_.sibling,T=_.return;if(iq(_),_===y){Fn=null;break}if(S!==null){S.return=T,Fn=S;break}Fn=T}}}var I=c.alternate;if(I!==null){var k=I.child;if(k!==null){I.child=null;do{var D=k.sibling;k.sibling=null,k=D}while(k!==null)}}Fn=c}}if(c.subtreeFlags&2064&&d!==null)d.return=c,Fn=d;else e:for(;Fn!==null;){if(c=Fn,c.flags&2048)switch(c.tag){case 0:case 11:case 15:Gb(9,c,c.return)}var L=c.sibling;if(L!==null){L.return=c.return,Fn=L;break e}Fn=c.return}}var O=n.current;for(Fn=O;Fn!==null;){d=Fn;var F=d.child;if(d.subtreeFlags&2064&&F!==null)F.return=d,Fn=F;else e:for(d=O;Fn!==null;){if(f=Fn,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:TM(9,f)}}catch(G){Hr(f,f.return,G)}if(f===d){Fn=null;break e}var B=f.sibling;if(B!==null){B.return=f.return,Fn=B;break e}Fn=f.return}}if(li=s,Ep(),cd&&typeof cd.onPostCommitFiberRoot=="function")try{cd.onPostCommitFiberRoot(_M,n)}catch{}o=!0}return o}finally{Ni=a,Ac.transition=e}}return!1}function BU(n,e,a){e=j0(a,e),e=q$(n,e,1),n=rp(n,e,1),e=Hs(),n!==null&&(vw(n,1,e),xl(n,e))}function Hr(n,e,a){if(n.tag===3)BU(n,n,a);else for(;e!==null;){if(e.tag===3){BU(e,n,a);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(op===null||!op.has(o))){n=j0(a,n),n=X$(e,n,1),e=rp(e,n,1),n=Hs(),e!==null&&(vw(e,1,n),xl(e,n));break}}e=e.return}}function Ple(n,e,a){var o=n.pingCache;o!==null&&o.delete(e),e=Hs(),n.pingedLanes|=n.suspendedLanes&a,Vo===n&&(es&a)===a&&(Lo===4||Lo===3&&(es&130023424)===es&&500>co()-Kk?yg(n,0):Zk|=a),xl(n,e)}function pq(n,e){e===0&&(n.mode&1?(e=Y3,Y3<<=1,!(Y3&130023424)&&(Y3=4194304)):e=1);var a=Hs();n=Dh(n,e),n!==null&&(vw(n,e,a),xl(n,a))}function Ile(n){var e=n.memoizedState,a=0;e!==null&&(a=e.retryLane),pq(n,a)}function Lle(n,e){var a=0;switch(n.tag){case 13:var o=n.stateNode,s=n.memoizedState;s!==null&&(a=s.retryLane);break;case 19:o=n.stateNode;break;default:throw Error(hn(314))}o!==null&&o.delete(e),pq(n,a)}var mq;mq=function(n,e,a){if(n!==null)if(n.memoizedProps!==e.pendingProps||_l.current)yl=!0;else{if(!(n.lanes&a)&&!(e.flags&128))return yl=!1,vle(n,e,a);yl=!!(n.flags&131072)}else yl=!1,_r&&e.flags&1048576&&v$(e,EE,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;NA(n,e),n=e.pendingProps;var s=W0(e,Es.current);I0(e,a),s=Hk(null,e,o,n,s,a);var c=jk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bl(o)?(c=!0,SE(e)):c=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Bk(e),s.updater=EM,e.stateNode=s,s._reactInternals=e,yL(e,o,n,a),e=bL(null,e,o,!0,c,a)):(e.tag=0,_r&&c&&Rk(e),Gs(null,e,s,a),e=e.child),e;case 16:o=e.elementType;e:{switch(NA(n,e),n=e.pendingProps,s=o._init,o=s(o._payload),e.type=o,s=e.tag=kle(o),n=eu(o,n),s){case 0:e=_L(null,e,o,n,a);break e;case 1:e=PU(null,e,o,n,a);break e;case 11:e=TU(null,e,o,n,a);break e;case 14:e=CU(null,e,o,eu(o.type,n),a);break e}throw Error(hn(306,o,""))}return e;case 0:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:eu(o,s),_L(n,e,o,s,a);case 1:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:eu(o,s),PU(n,e,o,s,a);case 3:e:{if(J$(e),n===null)throw Error(hn(387));o=e.pendingProps,c=e.memoizedState,s=c.element,w$(n,e),CE(e,o,null,a);var d=e.memoizedState;if(o=d.element,c.isDehydrated)if(c={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){s=j0(Error(hn(423)),e),e=IU(n,e,o,a,s);break e}else if(o!==s){s=j0(Error(hn(424)),e),e=IU(n,e,o,a,s);break e}else for(ql=ip(e.stateNode.containerInfo.firstChild),Xl=e,_r=!0,iu=null,a=M$(e,null,o,a),e.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(V0(),o===s){e=Oh(n,e,a);break e}Gs(n,e,o,a)}e=e.child}return e;case 5:return T$(e),n===null&&pL(e),o=e.type,s=e.pendingProps,c=n!==null?n.memoizedProps:null,d=s.children,cL(o,s)?d=null:c!==null&&cL(o,c)&&(e.flags|=32),K$(n,e),Gs(n,e,d,a),e.child;case 6:return n===null&&pL(e),null;case 13:return Q$(n,e,a);case 4:return Uk(e,e.stateNode.containerInfo),o=e.pendingProps,n===null?e.child=G0(e,null,o,a):Gs(n,e,o,a),e.child;case 11:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:eu(o,s),TU(n,e,o,s,a);case 7:return Gs(n,e,e.pendingProps,a),e.child;case 8:return Gs(n,e,e.pendingProps.children,a),e.child;case 12:return Gs(n,e,e.pendingProps.children,a),e.child;case 10:e:{if(o=e.type._context,s=e.pendingProps,c=e.memoizedProps,d=s.value,tr(ME,o._currentValue),o._currentValue=d,c!==null)if(fu(c.value,d)){if(c.children===s.children&&!_l.current){e=Oh(n,e,a);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var f=c.dependencies;if(f!==null){d=c.child;for(var m=f.firstContext;m!==null;){if(m.context===o){if(c.tag===1){m=Ph(-1,a&-a),m.tag=2;var y=c.updateQueue;if(y!==null){y=y.shared;var _=y.pending;_===null?m.next=m:(m.next=_.next,_.next=m),y.pending=m}}c.lanes|=a,m=c.alternate,m!==null&&(m.lanes|=a),mL(c.return,a,e),f.lanes|=a;break}m=m.next}}else if(c.tag===10)d=c.type===e.type?null:c.child;else if(c.tag===18){if(d=c.return,d===null)throw Error(hn(341));d.lanes|=a,f=d.alternate,f!==null&&(f.lanes|=a),mL(d,a,e),d=c.sibling}else d=c.child;if(d!==null)d.return=c;else for(d=c;d!==null;){if(d===e){d=null;break}if(c=d.sibling,c!==null){c.return=d.return,d=c;break}d=d.return}c=d}Gs(n,e,s.children,a),e=e.child}return e;case 9:return s=e.type,o=e.pendingProps.children,I0(e,a),s=Mc(s),o=o(s),e.flags|=1,Gs(n,e,o,a),e.child;case 14:return o=e.type,s=eu(o,e.pendingProps),s=eu(o.type,s),CU(n,e,o,s,a);case 15:return Y$(n,e,e.type,e.pendingProps,a);case 17:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:eu(o,s),NA(n,e),e.tag=1,bl(o)?(n=!0,SE(e)):n=!1,I0(e,a),A$(e,o,s),yL(e,o,s,a),bL(null,e,o,!0,n,a);case 19:return eq(n,e,a);case 22:return Z$(n,e,a)}throw Error(hn(156,e.tag))};function gq(n,e){return Vj(n,e)}function Rle(n,e,a,o){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sc(n,e,a,o){return new Rle(n,e,a,o)}function tD(n){return n=n.prototype,!(!n||!n.isReactComponent)}function kle(n){if(typeof n=="function")return tD(n)?1:0;if(n!=null){if(n=n.$$typeof,n===bk)return 11;if(n===xk)return 14}return 2}function lp(n,e){var a=n.alternate;return a===null?(a=Sc(n.tag,e,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=e,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,e=n.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function WA(n,e,a,o,s,c){var d=2;if(o=n,typeof n=="function")tD(n)&&(d=1);else if(typeof n=="string")d=5;else e:switch(n){case l0:return vg(a.children,s,c,e);case _k:d=8,s|=8;break;case WI:return n=Sc(12,a,e,s|2),n.elementType=WI,n.lanes=c,n;case VI:return n=Sc(13,a,e,s),n.elementType=VI,n.lanes=c,n;case GI:return n=Sc(19,a,e,s),n.elementType=GI,n.lanes=c,n;case Ej:return PM(a,s,c,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Sj:d=10;break e;case Aj:d=9;break e;case bk:d=11;break e;case xk:d=14;break e;case Vf:d=16,o=null;break e}throw Error(hn(130,n==null?n:typeof n,""))}return e=Sc(d,a,e,s),e.elementType=n,e.type=o,e.lanes=c,e}function vg(n,e,a,o){return n=Sc(7,n,o,e),n.lanes=a,n}function PM(n,e,a,o){return n=Sc(22,n,o,e),n.elementType=Ej,n.lanes=a,n.stateNode={isHidden:!1},n}function o4(n,e,a){return n=Sc(6,n,null,e),n.lanes=a,n}function s4(n,e,a){return e=Sc(4,n.children!==null?n.children:[],n.key,e),e.lanes=a,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Dle(n,e,a,o,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=W5(0),this.expirationTimes=W5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=W5(0),this.identifierPrefix=o,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function nD(n,e,a,o,s,c,d,f,m){return n=new Dle(n,e,a,f,m),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Sc(3,null,null,e),n.current=c,c.stateNode=n,c.memoizedState={element:o,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bk(c),n}function Ole(n,e,a){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s0,key:o==null?null:""+o,children:n,containerInfo:e,implementation:a}}function yq(n){if(!n)return gp;n=n._reactInternals;e:{if(Vg(n)!==n||n.tag!==1)throw Error(hn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bl(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(hn(171))}if(n.tag===1){var a=n.type;if(bl(a))return g$(n,a,e)}return e}function vq(n,e,a,o,s,c,d,f,m){return n=nD(a,o,!0,n,s,c,d,f,m),n.context=yq(null),a=n.current,o=Hs(),s=sp(a),c=Ph(o,s),c.callback=e??null,rp(a,c,s),n.current.lanes=s,vw(n,s,o),xl(n,o),n}function IM(n,e,a,o){var s=e.current,c=Hs(),d=sp(s);return a=yq(a),e.context===null?e.context=a:e.pendingContext=a,e=Ph(c,d),e.payload={element:n},o=o===void 0?null:o,o!==null&&(e.callback=o),n=rp(s,e,d),n!==null&&(uu(n,s,d,c),OA(n,s,d)),d}function zE(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function UU(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<e?a:e}}function aD(n,e){UU(n,e),(n=n.alternate)&&UU(n,e)}function zle(){return null}var _q=typeof reportError=="function"?reportError:function(n){console.error(n)};function iD(n){this._internalRoot=n}LM.prototype.render=iD.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(hn(409));IM(n,e,null,null)};LM.prototype.unmount=iD.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ig(function(){IM(null,n,null,null)}),e[kh]=null}};function LM(n){this._internalRoot=n}LM.prototype.unstable_scheduleHydration=function(n){if(n){var e=Yj();n={blockedOn:null,target:n,priority:e};for(var a=0;a<Hf.length&&e!==0&&e<Hf[a].priority;a++);Hf.splice(a,0,n),a===0&&Kj(n)}};function rD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function RM(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function WU(){}function Fle(n,e,a,o,s){if(s){if(typeof o=="function"){var c=o;o=function(){var y=zE(d);c.call(y)}}var d=vq(e,o,n,0,null,!1,!1,"",WU);return n._reactRootContainer=d,n[kh]=d.current,Sx(n.nodeType===8?n.parentNode:n),Ig(),d}for(;s=n.lastChild;)n.removeChild(s);if(typeof o=="function"){var f=o;o=function(){var y=zE(m);f.call(y)}}var m=nD(n,0,!1,null,null,!1,!1,"",WU);return n._reactRootContainer=m,n[kh]=m.current,Sx(n.nodeType===8?n.parentNode:n),Ig(function(){IM(e,m,a,o)}),m}function kM(n,e,a,o,s){var c=a._reactRootContainer;if(c){var d=c;if(typeof s=="function"){var f=s;s=function(){var m=zE(d);f.call(m)}}IM(e,d,n,s)}else d=Fle(a,e,n,s,o);return zE(d)}qj=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var a=Eb(e.pendingLanes);a!==0&&(Ak(e,a|1),xl(e,co()),!(li&6)&&($0=co()+500,Ep()))}break;case 13:Ig(function(){var o=Dh(n,1);if(o!==null){var s=Hs();uu(o,n,1,s)}}),aD(n,1)}};Ek=function(n){if(n.tag===13){var e=Dh(n,134217728);if(e!==null){var a=Hs();uu(e,n,134217728,a)}aD(n,134217728)}};Xj=function(n){if(n.tag===13){var e=sp(n),a=Dh(n,e);if(a!==null){var o=Hs();uu(a,n,e,o)}aD(n,e)}};Yj=function(){return Ni};Zj=function(n,e){var a=Ni;try{return Ni=n,e()}finally{Ni=a}};QI=function(n,e,a){switch(e){case"input":if($I(n,a),e=a.name,a.type==="radio"&&e!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<a.length;e++){var o=a[e];if(o!==n&&o.form===n.form){var s=SM(o);if(!s)throw Error(hn(90));Tj(o),$I(o,s)}}}break;case"textarea":Pj(n,a);break;case"select":e=a.value,e!=null&&M0(n,!!a.multiple,e,!1)}};zj=Jk;Fj=Ig;var Nle={usingClientEntryPoint:!1,Events:[bw,h0,SM,Dj,Oj,Jk]},H1={findFiberByHostInstance:ig,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Ble={bundleType:H1.bundleType,version:H1.version,rendererPackageName:H1.rendererPackageName,rendererConfig:H1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Uh.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Uj(n),n===null?null:n.stateNode},findFiberByHostInstance:H1.findFiberByHostInstance||zle,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oS.isDisabled&&oS.supportsFiber)try{_M=oS.inject(Ble),cd=oS}catch{}}Jl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nle;Jl.createPortal=function(n,e){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rD(e))throw Error(hn(200));return Ole(n,e,null,a)};Jl.createRoot=function(n,e){if(!rD(n))throw Error(hn(299));var a=!1,o="",s=_q;return e!=null&&(e.unstable_strictMode===!0&&(a=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=nD(n,1,!1,null,null,a,!1,o,s),n[kh]=e.current,Sx(n.nodeType===8?n.parentNode:n),new iD(e)};Jl.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(hn(188)):(n=Object.keys(n).join(","),Error(hn(268,n)));return n=Uj(e),n=n===null?null:n.stateNode,n};Jl.flushSync=function(n){return Ig(n)};Jl.hydrate=function(n,e,a){if(!RM(e))throw Error(hn(200));return kM(null,n,e,!0,a)};Jl.hydrateRoot=function(n,e,a){if(!rD(n))throw Error(hn(405));var o=a!=null&&a.hydratedSources||null,s=!1,c="",d=_q;if(a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onRecoverableError!==void 0&&(d=a.onRecoverableError)),e=vq(e,null,n,1,a??null,s,!1,c,d),n[kh]=e.current,Sx(n),o)for(n=0;n<o.length;n++)a=o[n],s=a._getVersion,s=s(a._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[a,s]:e.mutableSourceEagerHydrationData.push(a,s);return new LM(e)};Jl.render=function(n,e,a){if(!RM(e))throw Error(hn(200));return kM(null,n,e,!1,a)};Jl.unmountComponentAtNode=function(n){if(!RM(n))throw Error(hn(40));return n._reactRootContainer?(Ig(function(){kM(null,null,n,!1,function(){n._reactRootContainer=null,n[kh]=null})}),!0):!1};Jl.unstable_batchedUpdates=Jk;Jl.unstable_renderSubtreeIntoContainer=function(n,e,a,o){if(!RM(a))throw Error(hn(200));if(n==null||n._reactInternals===void 0)throw Error(hn(38));return kM(n,e,a,!1,o)};Jl.version="18.2.0-next-9e3b772b8-20220608";function bq(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bq)}catch(n){console.error(n)}}bq(),vj.exports=Jl;var ww=vj.exports;const Tb=gw(ww),Ule=lj({__proto__:null,default:Tb},[ww]);var VU=ww;BI.createRoot=VU.createRoot,BI.hydrateRoot=VU.hydrateRoot;/**
 * @remix-run/router v1.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jr(){return jr=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},jr.apply(this,arguments)}var oo;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(oo||(oo={}));const GU="popstate";function Wle(n){n===void 0&&(n={});function e(o,s){let{pathname:c,search:d,hash:f}=o.location;return Rx("",{pathname:c,search:d,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function a(o,s){return typeof s=="string"?s:Sw(s)}return Gle(e,a,null,n)}function Ka(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Lg(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Vle(){return Math.random().toString(36).substr(2,8)}function HU(n,e){return{usr:n.state,key:n.key,idx:e}}function Rx(n,e,a,o){return a===void 0&&(a=null),jr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Wh(e):e,{state:a,key:e&&e.key||o||Vle()})}function Sw(n){let{pathname:e="/",search:a="",hash:o=""}=n;return a&&a!=="?"&&(e+=a.charAt(0)==="?"?a:"?"+a),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function Wh(n){let e={};if(n){let a=n.indexOf("#");a>=0&&(e.hash=n.substr(a),n=n.substr(0,a));let o=n.indexOf("?");o>=0&&(e.search=n.substr(o),n=n.substr(0,o)),n&&(e.pathname=n)}return e}function Gle(n,e,a,o){o===void 0&&(o={});let{window:s=document.defaultView,v5Compat:c=!1}=o,d=s.history,f=oo.Pop,m=null,y=_();y==null&&(y=0,d.replaceState(jr({},d.state,{idx:y}),""));function _(){return(d.state||{idx:null}).idx}function x(){f=oo.Pop;let D=_(),L=D==null?null:D-y;y=D,m&&m({action:f,location:k.location,delta:L})}function S(D,L){f=oo.Push;let O=Rx(k.location,D,L);a&&a(O,D),y=_()+1;let F=HU(O,y),B=k.createHref(O);try{d.pushState(F,"",B)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;s.location.assign(B)}c&&m&&m({action:f,location:k.location,delta:1})}function T(D,L){f=oo.Replace;let O=Rx(k.location,D,L);a&&a(O,D),y=_();let F=HU(O,y),B=k.createHref(O);d.replaceState(F,"",B),c&&m&&m({action:f,location:k.location,delta:0})}function I(D){let L=s.location.origin!=="null"?s.location.origin:s.location.href,O=typeof D=="string"?D:Sw(D);return Ka(L,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,L)}let k={get action(){return f},get location(){return n(s,d)},listen(D){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(GU,x),m=D,()=>{s.removeEventListener(GU,x),m=null}},createHref(D){return e(s,D)},createURL:I,encodeLocation(D){let L=I(D);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:S,replace:T,go(D){return d.go(D)}};return k}var so;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(so||(so={}));const Hle=new Set(["lazy","caseSensitive","path","id","index","children"]);function jle(n){return n.index===!0}function RL(n,e,a,o){return a===void 0&&(a=[]),o===void 0&&(o={}),n.map((s,c)=>{let d=[...a,c],f=typeof s.id=="string"?s.id:d.join("-");if(Ka(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ka(!o[f],'Found a route id collision on id "'+f+`".  Route id's must be globally unique within Data Router usages`),jle(s)){let m=jr({},s,e(s),{id:f});return o[f]=m,m}else{let m=jr({},s,e(s),{id:f,children:void 0});return o[f]=m,s.children&&(m.children=RL(s.children,e,d,o)),m}})}function _0(n,e,a){a===void 0&&(a="/");let o=typeof e=="string"?Wh(e):e,s=Aw(o.pathname||"/",a);if(s==null)return null;let c=xq(n);qle(c);let d=null;for(let f=0;d==null&&f<c.length;++f)d=nce(c[f],rce(s));return d}function $le(n,e){let{route:a,pathname:o,params:s}=n;return{id:a.id,pathname:o,params:s,data:e[a.id],handle:a.handle}}function xq(n,e,a,o){e===void 0&&(e=[]),a===void 0&&(a=[]),o===void 0&&(o="");let s=(c,d,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};m.relativePath.startsWith("/")&&(Ka(m.relativePath.startsWith(o),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(o.length));let y=cp([o,m.relativePath]),_=a.concat(m);c.children&&c.children.length>0&&(Ka(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),xq(c.children,e,_,y)),!(c.path==null&&!c.index)&&e.push({path:y,score:ece(y,c.index),routesMeta:_})};return n.forEach((c,d)=>{var f;if(c.path===""||!((f=c.path)!=null&&f.includes("?")))s(c,d);else for(let m of wq(c.path))s(c,d,m)}),e}function wq(n){let e=n.split("/");if(e.length===0)return[];let[a,...o]=e,s=a.endsWith("?"),c=a.replace(/\?$/,"");if(o.length===0)return s?[c,""]:[c];let d=wq(o.join("/")),f=[];return f.push(...d.map(m=>m===""?c:[c,m].join("/"))),s&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function qle(n){n.sort((e,a)=>e.score!==a.score?a.score-e.score:tce(e.routesMeta.map(o=>o.childrenIndex),a.routesMeta.map(o=>o.childrenIndex)))}const Xle=/^:\w+$/,Yle=3,Zle=2,Kle=1,Jle=10,Qle=-2,jU=n=>n==="*";function ece(n,e){let a=n.split("/"),o=a.length;return a.some(jU)&&(o+=Qle),e&&(o+=Zle),a.filter(s=>!jU(s)).reduce((s,c)=>s+(Xle.test(c)?Yle:c===""?Kle:Jle),o)}function tce(n,e){return n.length===e.length&&n.slice(0,-1).every((o,s)=>o===e[s])?n[n.length-1]-e[e.length-1]:0}function nce(n,e){let{routesMeta:a}=n,o={},s="/",c=[];for(let d=0;d<a.length;++d){let f=a[d],m=d===a.length-1,y=s==="/"?e:e.slice(s.length)||"/",_=ace({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},y);if(!_)return null;Object.assign(o,_.params);let x=f.route;c.push({params:o,pathname:cp([s,_.pathname]),pathnameBase:cce(cp([s,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(s=cp([s,_.pathnameBase]))}return c}function ace(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[a,o]=ice(n.path,n.caseSensitive,n.end),s=e.match(a);if(!s)return null;let c=s[0],d=c.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:o.reduce((y,_,x)=>{let{paramName:S,isOptional:T}=_;if(S==="*"){let k=f[x]||"";d=c.slice(0,c.length-k.length).replace(/(.)\/+$/,"$1")}const I=f[x];return T&&!I?y[S]=void 0:y[S]=oce(I||"",S),y},{}),pathname:c,pathnameBase:d,pattern:n}}function ice(n,e,a){e===void 0&&(e=!1),a===void 0&&(a=!0),Lg(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let o=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(d,f,m)=>(o.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(o.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),o]}function rce(n){try{return decodeURI(n)}catch(e){return Lg(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function oce(n,e){try{return decodeURIComponent(n)}catch(a){return Lg(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+a+").")),n}}function Aw(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let a=e.endsWith("/")?e.length-1:e.length,o=n.charAt(a);return o&&o!=="/"?null:n.slice(a)||"/"}function sce(n,e){e===void 0&&(e="/");let{pathname:a,search:o="",hash:s=""}=typeof n=="string"?Wh(n):n;return{pathname:a?a.startsWith("/")?a:lce(a,e):e,search:uce(o),hash:dce(s)}}function lce(n,e){let a=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?a.length>1&&a.pop():s!=="."&&a.push(s)}),a.length>1?a.join("/"):"/"}function l4(n,e,a,o){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oD(n){return n.filter((e,a)=>a===0||e.route.path&&e.route.path.length>0)}function Sq(n,e,a,o){o===void 0&&(o=!1);let s;typeof n=="string"?s=Wh(n):(s=jr({},n),Ka(!s.pathname||!s.pathname.includes("?"),l4("?","pathname","search",s)),Ka(!s.pathname||!s.pathname.includes("#"),l4("#","pathname","hash",s)),Ka(!s.search||!s.search.includes("#"),l4("#","search","hash",s)));let c=n===""||s.pathname==="",d=c?"/":s.pathname,f;if(d==null)f=a;else if(o){let x=e[e.length-1].replace(/^\//,"").split("/");if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),x.pop();s.pathname=S.join("/")}f="/"+x.join("/")}else{let x=e.length-1;if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),x-=1;s.pathname=S.join("/")}f=x>=0?e[x]:"/"}let m=sce(s,f),y=d&&d!=="/"&&d.endsWith("/"),_=(c||d===".")&&a.endsWith("/");return!m.pathname.endsWith("/")&&(y||_)&&(m.pathname+="/"),m}const cp=n=>n.join("/").replace(/\/\/+/g,"/"),cce=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),uce=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,dce=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class sD{constructor(e,a,o,s){s===void 0&&(s=!1),this.status=e,this.statusText=a||"",this.internal=s,o instanceof Error?(this.data=o.toString(),this.error=o):this.data=o}}function Aq(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Eq=["post","put","patch","delete"],hce=new Set(Eq),fce=["get",...Eq],pce=new Set(fce),mce=new Set([301,302,303,307,308]),gce=new Set([307,308]),c4={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},yce={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},j1={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Mq=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vce=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),Tq="remix-router-transitions";function _ce(n){const e=n.window?n.window:typeof window<"u"?window:void 0,a=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",o=!a;Ka(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(n.mapRouteProperties)s=n.mapRouteProperties;else if(n.detectErrorBoundary){let _e=n.detectErrorBoundary;s=Ye=>({hasErrorBoundary:_e(Ye)})}else s=vce;let c={},d=RL(n.routes,s,void 0,c),f,m=n.basename||"/",y=jr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),_=null,x=new Set,S=null,T=null,I=null,k=n.hydrationData!=null,D=_0(d,n.history.location,m),L=null;if(D==null){let _e=vc(404,{pathname:n.history.location.pathname}),{matches:Ye,route:Se}=QU(d);D=Ye,L={[Se.id]:_e}}let O=!D.some(_e=>_e.route.lazy)&&(!D.some(_e=>_e.route.loader)||n.hydrationData!=null),F,B={historyAction:n.history.action,location:n.history.location,matches:D,initialized:O,navigation:c4,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||L,fetchers:new Map,blockers:new Map},G=oo.Pop,q=!1,X,te=!1,V=new Map,Q=null,ge=!1,me=!1,be=[],fe=[],Ce=new Map,Le=0,Ge=-1,le=new Map,pe=new Set,Ae=new Map,ae=new Map,Ee=new Set,Ze=new Map,Xe=new Map,Ke=!1;function Ue(){if(_=n.history.listen(_e=>{let{action:Ye,location:Se,delta:Me}=_e;if(Ke){Ke=!1;return}Lg(Xe.size===0||Me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ze=St({currentLocation:B.location,nextLocation:Se,historyAction:Ye});if(ze&&Me!=null){Ke=!0,n.history.go(Me*-1),Nt(ze,{state:"blocked",location:Se,proceed(){Nt(ze,{state:"proceeding",proceed:void 0,reset:void 0,location:Se}),n.history.go(Me)},reset(){let Qe=new Map(B.blockers);Qe.set(ze,j1),kt({blockers:Qe})}});return}return pt(Ye,Se)}),a){Ice(e,V);let _e=()=>Lce(e,V);e.addEventListener("pagehide",_e),Q=()=>e.removeEventListener("pagehide",_e)}return B.initialized||pt(oo.Pop,B.location),F}function ft(){_&&_(),Q&&Q(),x.clear(),X&&X.abort(),B.fetchers.forEach((_e,Ye)=>Oe(Ye)),B.blockers.forEach((_e,Ye)=>$t(Ye))}function Rt(_e){return x.add(_e),()=>x.delete(_e)}function kt(_e,Ye){Ye===void 0&&(Ye={}),B=jr({},B,_e);let Se=[],Me=[];y.v7_fetcherPersist&&B.fetchers.forEach((ze,Qe)=>{ze.state==="idle"&&(Ee.has(Qe)?Me.push(Qe):Se.push(Qe))}),[...x].forEach(ze=>ze(B,{deletedFetchers:Me,unstable_viewTransitionOpts:Ye.viewTransitionOpts,unstable_flushSync:Ye.flushSync===!0})),y.v7_fetcherPersist&&(Se.forEach(ze=>B.fetchers.delete(ze)),Me.forEach(ze=>Oe(ze)))}function Jt(_e,Ye,Se){var Me,ze;let{flushSync:Qe}=Se===void 0?{}:Se,tt=B.actionData!=null&&B.navigation.formMethod!=null&&au(B.navigation.formMethod)&&B.navigation.state==="loading"&&((Me=_e.state)==null?void 0:Me._isRedirect)!==!0,vt;Ye.actionData?Object.keys(Ye.actionData).length>0?vt=Ye.actionData:vt=null:tt?vt=B.actionData:vt=null;let dt=Ye.loaderData?JU(B.loaderData,Ye.loaderData,Ye.matches||[],Ye.errors):B.loaderData,ut=B.blockers;ut.size>0&&(ut=new Map(ut),ut.forEach((Qt,mn)=>ut.set(mn,j1)));let Gt=q===!0||B.navigation.formMethod!=null&&au(B.navigation.formMethod)&&((ze=_e.state)==null?void 0:ze._isRedirect)!==!0;f&&(d=f,f=void 0),ge||G===oo.Pop||(G===oo.Push?n.history.push(_e,_e.state):G===oo.Replace&&n.history.replace(_e,_e.state));let Tt;if(G===oo.Pop){let Qt=V.get(B.location.pathname);Qt&&Qt.has(_e.pathname)?Tt={currentLocation:B.location,nextLocation:_e}:V.has(_e.pathname)&&(Tt={currentLocation:_e,nextLocation:B.location})}else if(te){let Qt=V.get(B.location.pathname);Qt?Qt.add(_e.pathname):(Qt=new Set([_e.pathname]),V.set(B.location.pathname,Qt)),Tt={currentLocation:B.location,nextLocation:_e}}kt(jr({},Ye,{actionData:vt,loaderData:dt,historyAction:G,location:_e,initialized:!0,navigation:c4,revalidation:"idle",restoreScrollPosition:Ot(_e,Ye.matches||B.matches),preventScrollReset:Gt,blockers:ut}),{viewTransitionOpts:Tt,flushSync:Qe===!0}),G=oo.Pop,q=!1,te=!1,ge=!1,me=!1,be=[],fe=[]}async function It(_e,Ye){if(typeof _e=="number"){n.history.go(_e);return}let Se=kL(B.location,B.matches,m,y.v7_prependBasename,_e,Ye==null?void 0:Ye.fromRouteId,Ye==null?void 0:Ye.relative),{path:Me,submission:ze,error:Qe}=$U(y.v7_normalizeFormMethod,!1,Se,Ye),tt=B.location,vt=Rx(B.location,Me,Ye&&Ye.state);vt=jr({},vt,n.history.encodeLocation(vt));let dt=Ye&&Ye.replace!=null?Ye.replace:void 0,ut=oo.Push;dt===!0?ut=oo.Replace:dt===!1||ze!=null&&au(ze.formMethod)&&ze.formAction===B.location.pathname+B.location.search&&(ut=oo.Replace);let Gt=Ye&&"preventScrollReset"in Ye?Ye.preventScrollReset===!0:void 0,Tt=(Ye&&Ye.unstable_flushSync)===!0,Qt=St({currentLocation:tt,nextLocation:vt,historyAction:ut});if(Qt){Nt(Qt,{state:"blocked",location:vt,proceed(){Nt(Qt,{state:"proceeding",proceed:void 0,reset:void 0,location:vt}),It(_e,Ye)},reset(){let mn=new Map(B.blockers);mn.set(Qt,j1),kt({blockers:mn})}});return}return await pt(ut,vt,{submission:ze,pendingError:Qe,preventScrollReset:Gt,replace:Ye&&Ye.replace,enableViewTransition:Ye&&Ye.unstable_viewTransition,flushSync:Tt})}function Pe(){if(De(),kt({revalidation:"loading"}),B.navigation.state!=="submitting"){if(B.navigation.state==="idle"){pt(B.historyAction,B.location,{startUninterruptedRevalidation:!0});return}pt(G||B.historyAction,B.navigation.location,{overrideNavigation:B.navigation})}}async function pt(_e,Ye,Se){X&&X.abort(),X=null,G=_e,ge=(Se&&Se.startUninterruptedRevalidation)===!0,qt(B.location,B.matches),q=(Se&&Se.preventScrollReset)===!0,te=(Se&&Se.enableViewTransition)===!0;let Me=f||d,ze=Se&&Se.overrideNavigation,Qe=_0(Me,Ye,m),tt=(Se&&Se.flushSync)===!0;if(!Qe){let mn=vc(404,{pathname:Ye.pathname}),{matches:nn,route:wn}=QU(Me);Zt(),Jt(Ye,{matches:nn,loaderData:{},errors:{[wn.id]:mn}},{flushSync:tt});return}if(B.initialized&&!me&&Ace(B.location,Ye)&&!(Se&&Se.submission&&au(Se.submission.formMethod))){Jt(Ye,{matches:Qe},{flushSync:tt});return}X=new AbortController;let vt=q1(n.history,Ye,X.signal,Se&&Se.submission),dt,ut;if(Se&&Se.pendingError)ut={[$b(Qe).route.id]:Se.pendingError};else if(Se&&Se.submission&&au(Se.submission.formMethod)){let mn=await yt(vt,Ye,Se.submission,Qe,{replace:Se.replace,flushSync:tt});if(mn.shortCircuited)return;dt=mn.pendingActionData,ut=mn.pendingActionError,ze=u4(Ye,Se.submission),tt=!1,vt=new Request(vt.url,{signal:vt.signal})}let{shortCircuited:Gt,loaderData:Tt,errors:Qt}=await At(vt,Ye,Qe,ze,Se&&Se.submission,Se&&Se.fetcherSubmission,Se&&Se.replace,tt,dt,ut);Gt||(X=null,Jt(Ye,jr({matches:Qe},dt?{actionData:dt}:{},{loaderData:Tt,errors:Qt})))}async function yt(_e,Ye,Se,Me,ze){ze===void 0&&(ze={}),De();let Qe=Cce(Ye,Se);kt({navigation:Qe},{flushSync:ze.flushSync===!0});let tt,vt=OL(Me,Ye);if(!vt.route.action&&!vt.route.lazy)tt={type:so.error,error:vc(405,{method:_e.method,pathname:Ye.pathname,routeId:vt.route.id})};else if(tt=await $1("action",_e,vt,Me,c,s,m),_e.signal.aborted)return{shortCircuited:!0};if(R0(tt)){let dt;return ze&&ze.replace!=null?dt=ze.replace:dt=tt.location===B.location.pathname+B.location.search,await ve(B,tt,{submission:Se,replace:dt}),{shortCircuited:!0}}if(qb(tt)){let dt=$b(Me,vt.route.id);return(ze&&ze.replace)!==!0&&(G=oo.Push),{pendingActionData:{},pendingActionError:{[dt.route.id]:tt.error}}}if(sg(tt))throw vc(400,{type:"defer-action"});return{pendingActionData:{[vt.route.id]:tt.data}}}async function At(_e,Ye,Se,Me,ze,Qe,tt,vt,dt,ut){let Gt=Me||u4(Ye,ze),Tt=ze||Qe||n7(Gt),Qt=f||d,[mn,nn]=qU(n.history,B,Se,Tt,Ye,me,be,fe,Ae,pe,Qt,m,dt,ut);if(Zt(Ct=>!(Se&&Se.some(zt=>zt.route.id===Ct))||mn&&mn.some(zt=>zt.route.id===Ct)),Ge=++Le,mn.length===0&&nn.length===0){let Ct=Et();return Jt(Ye,jr({matches:Se,loaderData:{},errors:ut||null},dt?{actionData:dt}:{},Ct?{fetchers:new Map(B.fetchers)}:{}),{flushSync:vt}),{shortCircuited:!0}}if(!ge){nn.forEach(zt=>{let ln=B.fetchers.get(zt.key),Tn=X1(void 0,ln?ln.data:void 0);B.fetchers.set(zt.key,Tn)});let Ct=dt||B.actionData;kt(jr({navigation:Gt},Ct?Object.keys(Ct).length===0?{actionData:null}:{actionData:Ct}:{},nn.length>0?{fetchers:new Map(B.fetchers)}:{}),{flushSync:vt})}nn.forEach(Ct=>{Ce.has(Ct.key)&&ot(Ct.key),Ct.controller&&Ce.set(Ct.key,Ct.controller)});let wn=()=>nn.forEach(Ct=>ot(Ct.key));X&&X.signal.addEventListener("abort",wn);let{results:Hn,loaderResults:fa,fetcherResults:Pa}=await $e(B.matches,Se,mn,nn,_e);if(_e.signal.aborted)return{shortCircuited:!0};X&&X.signal.removeEventListener("abort",wn),nn.forEach(Ct=>Ce.delete(Ct.key));let Ta=e7(Hn);if(Ta){if(Ta.idx>=mn.length){let Ct=nn[Ta.idx-mn.length].key;pe.add(Ct)}return await ve(B,Ta.result,{replace:tt}),{shortCircuited:!0}}let{loaderData:Li,errors:mi}=KU(B,Se,mn,fa,ut,nn,Pa,Ze);Ze.forEach((Ct,zt)=>{Ct.subscribe(ln=>{(ln||Ct.done)&&Ze.delete(zt)})});let Re=Et(),bt=Ut(Ge),Dt=Re||bt||nn.length>0;return jr({loaderData:Li,errors:mi},Dt?{fetchers:new Map(B.fetchers)}:{})}function Be(_e,Ye,Se,Me){if(o)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ce.has(_e)&&ot(_e);let ze=(Me&&Me.unstable_flushSync)===!0,Qe=f||d,tt=kL(B.location,B.matches,m,y.v7_prependBasename,Se,Ye,Me==null?void 0:Me.relative),vt=_0(Qe,tt,m);if(!vt){de(_e,Ye,vc(404,{pathname:tt}),{flushSync:ze});return}let{path:dt,submission:ut,error:Gt}=$U(y.v7_normalizeFormMethod,!0,tt,Me);if(Gt){de(_e,Ye,Gt,{flushSync:ze});return}let Tt=OL(vt,dt);if(q=(Me&&Me.preventScrollReset)===!0,ut&&au(ut.formMethod)){ue(_e,Ye,dt,Tt,vt,ze,ut);return}Ae.set(_e,{routeId:Ye,path:dt}),se(_e,Ye,dt,Tt,vt,ze,ut)}async function ue(_e,Ye,Se,Me,ze,Qe,tt){if(De(),Ae.delete(_e),!Me.route.action&&!Me.route.lazy){let ln=vc(405,{method:tt.formMethod,pathname:Se,routeId:Ye});de(_e,Ye,ln,{flushSync:Qe});return}let vt=B.fetchers.get(_e);st(_e,Pce(tt,vt),{flushSync:Qe});let dt=new AbortController,ut=q1(n.history,Se,dt.signal,tt);Ce.set(_e,dt);let Gt=Le,Tt=await $1("action",ut,Me,ze,c,s,m);if(ut.signal.aborted){Ce.get(_e)===dt&&Ce.delete(_e);return}if(Ee.has(_e)){st(_e,Wf(void 0));return}if(R0(Tt))if(Ce.delete(_e),Ge>Gt){st(_e,Wf(void 0));return}else return pe.add(_e),st(_e,X1(tt)),ve(B,Tt,{fetcherSubmission:tt});if(qb(Tt)){de(_e,Ye,Tt.error);return}if(sg(Tt))throw vc(400,{type:"defer-action"});let Qt=B.navigation.location||B.location,mn=q1(n.history,Qt,dt.signal),nn=f||d,wn=B.navigation.state!=="idle"?_0(nn,B.navigation.location,m):B.matches;Ka(wn,"Didn't find any matches after fetcher action");let Hn=++Le;le.set(_e,Hn);let fa=X1(tt,Tt.data);B.fetchers.set(_e,fa);let[Pa,Ta]=qU(n.history,B,wn,tt,Qt,me,be,fe,Ae,pe,nn,m,{[Me.route.id]:Tt.data},void 0);Ta.filter(ln=>ln.key!==_e).forEach(ln=>{let Tn=ln.key,qn=B.fetchers.get(Tn),an=X1(void 0,qn?qn.data:void 0);B.fetchers.set(Tn,an),Ce.has(Tn)&&ot(Tn),ln.controller&&Ce.set(Tn,ln.controller)}),kt({fetchers:new Map(B.fetchers)});let Li=()=>Ta.forEach(ln=>ot(ln.key));dt.signal.addEventListener("abort",Li);let{results:mi,loaderResults:Re,fetcherResults:bt}=await $e(B.matches,wn,Pa,Ta,mn);if(dt.signal.aborted)return;dt.signal.removeEventListener("abort",Li),le.delete(_e),Ce.delete(_e),Ta.forEach(ln=>Ce.delete(ln.key));let Dt=e7(mi);if(Dt){if(Dt.idx>=Pa.length){let ln=Ta[Dt.idx-Pa.length].key;pe.add(ln)}return ve(B,Dt.result)}let{loaderData:Ct,errors:zt}=KU(B,B.matches,Pa,Re,void 0,Ta,bt,Ze);if(B.fetchers.has(_e)){let ln=Wf(Tt.data);B.fetchers.set(_e,ln)}Ut(Hn),B.navigation.state==="loading"&&Hn>Ge?(Ka(G,"Expected pending action"),X&&X.abort(),Jt(B.navigation.location,{matches:wn,loaderData:Ct,errors:zt,fetchers:new Map(B.fetchers)})):(kt({errors:zt,loaderData:JU(B.loaderData,Ct,wn,zt),fetchers:new Map(B.fetchers)}),me=!1)}async function se(_e,Ye,Se,Me,ze,Qe,tt){let vt=B.fetchers.get(_e);st(_e,X1(tt,vt?vt.data:void 0),{flushSync:Qe});let dt=new AbortController,ut=q1(n.history,Se,dt.signal);Ce.set(_e,dt);let Gt=Le,Tt=await $1("loader",ut,Me,ze,c,s,m);if(sg(Tt)&&(Tt=await Iq(Tt,ut.signal,!0)||Tt),Ce.get(_e)===dt&&Ce.delete(_e),!ut.signal.aborted){if(Ee.has(_e)){st(_e,Wf(void 0));return}if(R0(Tt))if(Ge>Gt){st(_e,Wf(void 0));return}else{pe.add(_e),await ve(B,Tt);return}if(qb(Tt)){de(_e,Ye,Tt.error);return}Ka(!sg(Tt),"Unhandled fetcher deferred data"),st(_e,Wf(Tt.data))}}async function ve(_e,Ye,Se){let{submission:Me,fetcherSubmission:ze,replace:Qe}=Se===void 0?{}:Se;Ye.revalidate&&(me=!0);let tt=Rx(_e.location,Ye.location,{_isRedirect:!0});if(Ka(tt,"Expected a location on the redirect navigation"),a){let Qt=!1;if(Ye.reloadDocument)Qt=!0;else if(Mq.test(Ye.location)){const mn=n.history.createURL(Ye.location);Qt=mn.origin!==e.location.origin||Aw(mn.pathname,m)==null}if(Qt){Qe?e.location.replace(Ye.location):e.location.assign(Ye.location);return}}X=null;let vt=Qe===!0?oo.Replace:oo.Push,{formMethod:dt,formAction:ut,formEncType:Gt}=_e.navigation;!Me&&!ze&&dt&&ut&&Gt&&(Me=n7(_e.navigation));let Tt=Me||ze;if(gce.has(Ye.status)&&Tt&&au(Tt.formMethod))await pt(vt,tt,{submission:jr({},Tt,{formAction:Ye.location}),preventScrollReset:q});else{let Qt=u4(tt,Me);await pt(vt,tt,{overrideNavigation:Qt,fetcherSubmission:ze,preventScrollReset:q})}}async function $e(_e,Ye,Se,Me,ze){let Qe=await Promise.all([...Se.map(dt=>$1("loader",ze,dt,Ye,c,s,m)),...Me.map(dt=>dt.matches&&dt.match&&dt.controller?$1("loader",q1(n.history,dt.path,dt.controller.signal),dt.match,dt.matches,c,s,m):{type:so.error,error:vc(404,{pathname:dt.path})})]),tt=Qe.slice(0,Se.length),vt=Qe.slice(Se.length);return await Promise.all([t7(_e,Se,tt,tt.map(()=>ze.signal),!1,B.loaderData),t7(_e,Me.map(dt=>dt.match),vt,Me.map(dt=>dt.controller?dt.controller.signal:null),!0)]),{results:Qe,loaderResults:tt,fetcherResults:vt}}function De(){me=!0,be.push(...Zt()),Ae.forEach((_e,Ye)=>{Ce.has(Ye)&&(fe.push(Ye),ot(Ye))})}function st(_e,Ye,Se){Se===void 0&&(Se={}),B.fetchers.set(_e,Ye),kt({fetchers:new Map(B.fetchers)},{flushSync:(Se&&Se.flushSync)===!0})}function de(_e,Ye,Se,Me){Me===void 0&&(Me={});let ze=$b(B.matches,Ye);Oe(_e),kt({errors:{[ze.route.id]:Se},fetchers:new Map(B.fetchers)},{flushSync:(Me&&Me.flushSync)===!0})}function ne(_e){return y.v7_fetcherPersist&&(ae.set(_e,(ae.get(_e)||0)+1),Ee.has(_e)&&Ee.delete(_e)),B.fetchers.get(_e)||yce}function Oe(_e){let Ye=B.fetchers.get(_e);Ce.has(_e)&&!(Ye&&Ye.state==="loading"&&le.has(_e))&&ot(_e),Ae.delete(_e),le.delete(_e),pe.delete(_e),Ee.delete(_e),B.fetchers.delete(_e)}function mt(_e){if(y.v7_fetcherPersist){let Ye=(ae.get(_e)||0)-1;Ye<=0?(ae.delete(_e),Ee.add(_e)):ae.set(_e,Ye)}else Oe(_e);kt({fetchers:new Map(B.fetchers)})}function ot(_e){let Ye=Ce.get(_e);Ka(Ye,"Expected fetch controller: "+_e),Ye.abort(),Ce.delete(_e)}function lt(_e){for(let Ye of _e){let Se=ne(Ye),Me=Wf(Se.data);B.fetchers.set(Ye,Me)}}function Et(){let _e=[],Ye=!1;for(let Se of pe){let Me=B.fetchers.get(Se);Ka(Me,"Expected fetcher: "+Se),Me.state==="loading"&&(pe.delete(Se),_e.push(Se),Ye=!0)}return lt(_e),Ye}function Ut(_e){let Ye=[];for(let[Se,Me]of le)if(Me<_e){let ze=B.fetchers.get(Se);Ka(ze,"Expected fetcher: "+Se),ze.state==="loading"&&(ot(Se),le.delete(Se),Ye.push(Se))}return lt(Ye),Ye.length>0}function Vt(_e,Ye){let Se=B.blockers.get(_e)||j1;return Xe.get(_e)!==Ye&&Xe.set(_e,Ye),Se}function $t(_e){B.blockers.delete(_e),Xe.delete(_e)}function Nt(_e,Ye){let Se=B.blockers.get(_e)||j1;Ka(Se.state==="unblocked"&&Ye.state==="blocked"||Se.state==="blocked"&&Ye.state==="blocked"||Se.state==="blocked"&&Ye.state==="proceeding"||Se.state==="blocked"&&Ye.state==="unblocked"||Se.state==="proceeding"&&Ye.state==="unblocked","Invalid blocker state transition: "+Se.state+" -> "+Ye.state);let Me=new Map(B.blockers);Me.set(_e,Ye),kt({blockers:Me})}function St(_e){let{currentLocation:Ye,nextLocation:Se,historyAction:Me}=_e;if(Xe.size===0)return;Xe.size>1&&Lg(!1,"A router only supports one blocker at a time");let ze=Array.from(Xe.entries()),[Qe,tt]=ze[ze.length-1],vt=B.blockers.get(Qe);if(!(vt&&vt.state==="proceeding")&&tt({currentLocation:Ye,nextLocation:Se,historyAction:Me}))return Qe}function Zt(_e){let Ye=[];return Ze.forEach((Se,Me)=>{(!_e||_e(Me))&&(Se.cancel(),Ye.push(Me),Ze.delete(Me))}),Ye}function He(_e,Ye,Se){if(S=_e,I=Ye,T=Se||null,!k&&B.navigation===c4){k=!0;let Me=Ot(B.location,B.matches);Me!=null&&kt({restoreScrollPosition:Me})}return()=>{S=null,I=null,T=null}}function Lt(_e,Ye){return T&&T(_e,Ye.map(Me=>$le(Me,B.loaderData)))||_e.key}function qt(_e,Ye){if(S&&I){let Se=Lt(_e,Ye);S[Se]=I()}}function Ot(_e,Ye){if(S){let Se=Lt(_e,Ye),Me=S[Se];if(typeof Me=="number")return Me}return null}function fn(_e){c={},f=RL(_e,s,void 0,c)}return F={get basename(){return m},get state(){return B},get routes(){return d},get window(){return e},initialize:Ue,subscribe:Rt,enableScrollRestoration:He,navigate:It,fetch:Be,revalidate:Pe,createHref:_e=>n.history.createHref(_e),encodeLocation:_e=>n.history.encodeLocation(_e),getFetcher:ne,deleteFetcher:mt,dispose:ft,getBlocker:Vt,deleteBlocker:$t,_internalFetchControllers:Ce,_internalActiveDeferreds:Ze,_internalSetRoutes:fn},F}function bce(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function kL(n,e,a,o,s,c,d){let f,m;if(c){f=[];for(let _ of e)if(f.push(_),_.route.id===c){m=_;break}}else f=e,m=e[e.length-1];let y=Sq(s||".",oD(f).map(_=>_.pathnameBase),Aw(n.pathname,a)||n.pathname,d==="path");return s==null&&(y.search=n.search,y.hash=n.hash),(s==null||s===""||s===".")&&m&&m.route.index&&!lD(y.search)&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),o&&a!=="/"&&(y.pathname=y.pathname==="/"?a:cp([a,y.pathname])),Sw(y)}function $U(n,e,a,o){if(!o||!bce(o))return{path:a};if(o.formMethod&&!Tce(o.formMethod))return{path:a,error:vc(405,{method:o.formMethod})};let s=()=>({path:a,error:vc(400,{type:"invalid-body"})}),c=o.formMethod||"get",d=n?c.toUpperCase():c.toLowerCase(),f=Pq(a);if(o.body!==void 0){if(o.formEncType==="text/plain"){if(!au(d))return s();let S=typeof o.body=="string"?o.body:o.body instanceof FormData||o.body instanceof URLSearchParams?Array.from(o.body.entries()).reduce((T,I)=>{let[k,D]=I;return""+T+k+"="+D+`
`},""):String(o.body);return{path:a,submission:{formMethod:d,formAction:f,formEncType:o.formEncType,formData:void 0,json:void 0,text:S}}}else if(o.formEncType==="application/json"){if(!au(d))return s();try{let S=typeof o.body=="string"?JSON.parse(o.body):o.body;return{path:a,submission:{formMethod:d,formAction:f,formEncType:o.formEncType,formData:void 0,json:S,text:void 0}}}catch{return s()}}}Ka(typeof FormData=="function","FormData is not available in this environment");let m,y;if(o.formData)m=DL(o.formData),y=o.formData;else if(o.body instanceof FormData)m=DL(o.body),y=o.body;else if(o.body instanceof URLSearchParams)m=o.body,y=ZU(m);else if(o.body==null)m=new URLSearchParams,y=new FormData;else try{m=new URLSearchParams(o.body),y=ZU(m)}catch{return s()}let _={formMethod:d,formAction:f,formEncType:o&&o.formEncType||"application/x-www-form-urlencoded",formData:y,json:void 0,text:void 0};if(au(_.formMethod))return{path:a,submission:_};let x=Wh(a);return e&&x.search&&lD(x.search)&&m.append("index",""),x.search="?"+m,{path:Sw(x),submission:_}}function xce(n,e){let a=n;if(e){let o=n.findIndex(s=>s.route.id===e);o>=0&&(a=n.slice(0,o))}return a}function qU(n,e,a,o,s,c,d,f,m,y,_,x,S,T){let I=T?Object.values(T)[0]:S?Object.values(S)[0]:void 0,k=n.createURL(e.location),D=n.createURL(s),L=T?Object.keys(T)[0]:void 0,F=xce(a,L).filter((G,q)=>{if(G.route.lazy)return!0;if(G.route.loader==null)return!1;if(wce(e.loaderData,e.matches[q],G)||d.some(V=>V===G.route.id))return!0;let X=e.matches[q],te=G;return XU(G,jr({currentUrl:k,currentParams:X.params,nextUrl:D,nextParams:te.params},o,{actionResult:I,defaultShouldRevalidate:c||k.pathname+k.search===D.pathname+D.search||k.search!==D.search||Cq(X,te)}))}),B=[];return m.forEach((G,q)=>{if(!a.some(ge=>ge.route.id===G.routeId))return;let X=_0(_,G.path,x);if(!X){B.push({key:q,routeId:G.routeId,path:G.path,matches:null,match:null,controller:null});return}let te=e.fetchers.get(q),V=OL(X,G.path),Q=!1;y.has(q)?Q=!1:f.includes(q)?Q=!0:te&&te.state!=="idle"&&te.data===void 0?Q=c:Q=XU(V,jr({currentUrl:k,currentParams:e.matches[e.matches.length-1].params,nextUrl:D,nextParams:a[a.length-1].params},o,{actionResult:I,defaultShouldRevalidate:c})),Q&&B.push({key:q,routeId:G.routeId,path:G.path,matches:X,match:V,controller:new AbortController})}),[F,B]}function wce(n,e,a){let o=!e||a.route.id!==e.route.id,s=n[a.route.id]===void 0;return o||s}function Cq(n,e){let a=n.route.path;return n.pathname!==e.pathname||a!=null&&a.endsWith("*")&&n.params["*"]!==e.params["*"]}function XU(n,e){if(n.route.shouldRevalidate){let a=n.route.shouldRevalidate(e);if(typeof a=="boolean")return a}return e.defaultShouldRevalidate}async function YU(n,e,a){if(!n.lazy)return;let o=await n.lazy();if(!n.lazy)return;let s=a[n.id];Ka(s,"No route found in manifest");let c={};for(let d in o){let m=s[d]!==void 0&&d!=="hasErrorBoundary";Lg(!m,'Route "'+s.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!m&&!Hle.has(d)&&(c[d]=o[d])}Object.assign(s,c),Object.assign(s,jr({},e(s),{lazy:void 0}))}async function $1(n,e,a,o,s,c,d,f){f===void 0&&(f={});let m,y,_,x=I=>{let k,D=new Promise((L,O)=>k=O);return _=()=>k(),e.signal.addEventListener("abort",_),Promise.race([I({request:e,params:a.params,context:f.requestContext}),D])};try{let I=a.route[n];if(a.route.lazy)if(I){let k,D=await Promise.all([x(I).catch(L=>{k=L}),YU(a.route,c,s)]);if(k)throw k;y=D[0]}else if(await YU(a.route,c,s),I=a.route[n],I)y=await x(I);else if(n==="action"){let k=new URL(e.url),D=k.pathname+k.search;throw vc(405,{method:e.method,pathname:D,routeId:a.route.id})}else return{type:so.data,data:void 0};else if(I)y=await x(I);else{let k=new URL(e.url),D=k.pathname+k.search;throw vc(404,{pathname:D})}Ka(y!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+a.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(I){m=so.error,y=I}finally{_&&e.signal.removeEventListener("abort",_)}if(Mce(y)){let I=y.status;if(mce.has(I)){let L=y.headers.get("Location");if(Ka(L,"Redirects returned/thrown from loaders/actions must have a Location header"),!Mq.test(L))L=kL(new URL(e.url),o.slice(0,o.indexOf(a)+1),d,!0,L);else if(!f.isStaticRequest){let O=new URL(e.url),F=L.startsWith("//")?new URL(O.protocol+L):new URL(L),B=Aw(F.pathname,d)!=null;F.origin===O.origin&&B&&(L=F.pathname+F.search+F.hash)}if(f.isStaticRequest)throw y.headers.set("Location",L),y;return{type:so.redirect,status:I,location:L,revalidate:y.headers.get("X-Remix-Revalidate")!==null,reloadDocument:y.headers.get("X-Remix-Reload-Document")!==null}}if(f.isRouteRequest)throw{type:m===so.error?so.error:so.data,response:y};let k,D=y.headers.get("Content-Type");return D&&/\bapplication\/json\b/.test(D)?k=await y.json():k=await y.text(),m===so.error?{type:m,error:new sD(I,y.statusText,k),headers:y.headers}:{type:so.data,data:k,statusCode:y.status,headers:y.headers}}if(m===so.error)return{type:m,error:y};if(Ece(y)){var S,T;return{type:so.deferred,deferredData:y,statusCode:(S=y.init)==null?void 0:S.status,headers:((T=y.init)==null?void 0:T.headers)&&new Headers(y.init.headers)}}return{type:so.data,data:y}}function q1(n,e,a,o){let s=n.createURL(Pq(e)).toString(),c={signal:a};if(o&&au(o.formMethod)){let{formMethod:d,formEncType:f}=o;c.method=d.toUpperCase(),f==="application/json"?(c.headers=new Headers({"Content-Type":f}),c.body=JSON.stringify(o.json)):f==="text/plain"?c.body=o.text:f==="application/x-www-form-urlencoded"&&o.formData?c.body=DL(o.formData):c.body=o.formData}return new Request(s,c)}function DL(n){let e=new URLSearchParams;for(let[a,o]of n.entries())e.append(a,typeof o=="string"?o:o.name);return e}function ZU(n){let e=new FormData;for(let[a,o]of n.entries())e.append(a,o);return e}function Sce(n,e,a,o,s){let c={},d=null,f,m=!1,y={};return a.forEach((_,x)=>{let S=e[x].route.id;if(Ka(!R0(_),"Cannot handle redirect results in processLoaderData"),qb(_)){let T=$b(n,S),I=_.error;o&&(I=Object.values(o)[0],o=void 0),d=d||{},d[T.route.id]==null&&(d[T.route.id]=I),c[S]=void 0,m||(m=!0,f=Aq(_.error)?_.error.status:500),_.headers&&(y[S]=_.headers)}else sg(_)?(s.set(S,_.deferredData),c[S]=_.deferredData.data):c[S]=_.data,_.statusCode!=null&&_.statusCode!==200&&!m&&(f=_.statusCode),_.headers&&(y[S]=_.headers)}),o&&(d=o,c[Object.keys(o)[0]]=void 0),{loaderData:c,errors:d,statusCode:f||200,loaderHeaders:y}}function KU(n,e,a,o,s,c,d,f){let{loaderData:m,errors:y}=Sce(e,a,o,s,f);for(let _=0;_<c.length;_++){let{key:x,match:S,controller:T}=c[_];Ka(d!==void 0&&d[_]!==void 0,"Did not find corresponding fetcher result");let I=d[_];if(!(T&&T.signal.aborted))if(qb(I)){let k=$b(n.matches,S==null?void 0:S.route.id);y&&y[k.route.id]||(y=jr({},y,{[k.route.id]:I.error})),n.fetchers.delete(x)}else if(R0(I))Ka(!1,"Unhandled fetcher revalidation redirect");else if(sg(I))Ka(!1,"Unhandled fetcher deferred data");else{let k=Wf(I.data);n.fetchers.set(x,k)}}return{loaderData:m,errors:y}}function JU(n,e,a,o){let s=jr({},e);for(let c of a){let d=c.route.id;if(e.hasOwnProperty(d)?e[d]!==void 0&&(s[d]=e[d]):n[d]!==void 0&&c.route.loader&&(s[d]=n[d]),o&&o.hasOwnProperty(d))break}return s}function $b(n,e){return(e?n.slice(0,n.findIndex(o=>o.route.id===e)+1):[...n]).reverse().find(o=>o.route.hasErrorBoundary===!0)||n[0]}function QU(n){let e=n.length===1?n[0]:n.find(a=>a.index||!a.path||a.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function vc(n,e){let{pathname:a,routeId:o,method:s,type:c}=e===void 0?{}:e,d="Unknown Server Error",f="Unknown @remix-run/router error";return n===400?(d="Bad Request",s&&a&&o?f="You made a "+s+' request to "'+a+'" but '+('did not provide a `loader` for route "'+o+'", ')+"so there is no way to handle the request.":c==="defer-action"?f="defer() is not supported in actions":c==="invalid-body"&&(f="Unable to encode submission body")):n===403?(d="Forbidden",f='Route "'+o+'" does not match URL "'+a+'"'):n===404?(d="Not Found",f='No route matches URL "'+a+'"'):n===405&&(d="Method Not Allowed",s&&a&&o?f="You made a "+s.toUpperCase()+' request to "'+a+'" but '+('did not provide an `action` for route "'+o+'", ')+"so there is no way to handle the request.":s&&(f='Invalid request method "'+s.toUpperCase()+'"')),new sD(n||500,d,new Error(f),!0)}function e7(n){for(let e=n.length-1;e>=0;e--){let a=n[e];if(R0(a))return{result:a,idx:e}}}function Pq(n){let e=typeof n=="string"?Wh(n):n;return Sw(jr({},e,{hash:""}))}function Ace(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function sg(n){return n.type===so.deferred}function qb(n){return n.type===so.error}function R0(n){return(n&&n.type)===so.redirect}function Ece(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function Mce(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function Tce(n){return pce.has(n.toLowerCase())}function au(n){return hce.has(n.toLowerCase())}async function t7(n,e,a,o,s,c){for(let d=0;d<a.length;d++){let f=a[d],m=e[d];if(!m)continue;let y=n.find(x=>x.route.id===m.route.id),_=y!=null&&!Cq(y,m)&&(c&&c[m.route.id])!==void 0;if(sg(f)&&(s||_)){let x=o[d];Ka(x,"Expected an AbortSignal for revalidating fetcher deferred result"),await Iq(f,x,s).then(S=>{S&&(a[d]=S||a[d])})}}}async function Iq(n,e,a){if(a===void 0&&(a=!1),!await n.deferredData.resolveData(e)){if(a)try{return{type:so.data,data:n.deferredData.unwrappedData}}catch(s){return{type:so.error,error:s}}return{type:so.data,data:n.deferredData.data}}}function lD(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function OL(n,e){let a=typeof e=="string"?Wh(e).search:e.search;if(n[n.length-1].route.index&&lD(a||""))return n[n.length-1];let o=oD(n);return o[o.length-1]}function n7(n){let{formMethod:e,formAction:a,formEncType:o,text:s,formData:c,json:d}=n;if(!(!e||!a||!o)){if(s!=null)return{formMethod:e,formAction:a,formEncType:o,formData:void 0,json:void 0,text:s};if(c!=null)return{formMethod:e,formAction:a,formEncType:o,formData:c,json:void 0,text:void 0};if(d!==void 0)return{formMethod:e,formAction:a,formEncType:o,formData:void 0,json:d,text:void 0}}}function u4(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function Cce(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function X1(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function Pce(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function Wf(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function Ice(n,e){try{let a=n.sessionStorage.getItem(Tq);if(a){let o=JSON.parse(a);for(let[s,c]of Object.entries(o||{}))c&&Array.isArray(c)&&e.set(s,new Set(c||[]))}}catch{}}function Lce(n,e){if(e.size>0){let a={};for(let[o,s]of e)a[o]=[...s];try{n.sessionStorage.setItem(Tq,JSON.stringify(a))}catch(o){Lg(!1,"Failed to save applied view transitions in sessionStorage ("+o+").")}}}/**
 * React Router v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function FE(){return FE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},FE.apply(this,arguments)}const DM=re.createContext(null),Lq=re.createContext(null),OM=re.createContext(null),zM=re.createContext(null),Gg=re.createContext({outlet:null,matches:[],isDataRoute:!1}),Rq=re.createContext(null);function FM(){return re.useContext(zM)!=null}function kq(){return FM()||Ka(!1),re.useContext(zM).location}function Dq(n){re.useContext(OM).static||re.useLayoutEffect(n)}function Vh(){let{isDataRoute:n}=re.useContext(Gg);return n?Hce():Rce()}function Rce(){FM()||Ka(!1);let n=re.useContext(DM),{basename:e,navigator:a}=re.useContext(OM),{matches:o}=re.useContext(Gg),{pathname:s}=kq(),c=JSON.stringify(oD(o).map(m=>m.pathnameBase)),d=re.useRef(!1);return Dq(()=>{d.current=!0}),re.useCallback(function(m,y){if(y===void 0&&(y={}),!d.current)return;if(typeof m=="number"){a.go(m);return}let _=Sq(m,JSON.parse(c),s,y.relative==="path");n==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:cp([e,_.pathname])),(y.replace?a.replace:a.push)(_,y.state,y)},[e,a,c,s,n])}function kce(){let{matches:n}=re.useContext(Gg),e=n[n.length-1];return e?e.params:{}}function Dce(n,e,a){FM()||Ka(!1);let{navigator:o}=re.useContext(OM),{matches:s}=re.useContext(Gg),c=s[s.length-1],d=c?c.params:{};c&&c.pathname;let f=c?c.pathnameBase:"/";c&&c.route;let m=kq(),y;if(e){var _;let k=typeof e=="string"?Wh(e):e;f==="/"||(_=k.pathname)!=null&&_.startsWith(f)||Ka(!1),y=k}else y=m;let x=y.pathname||"/",S=f==="/"?x:x.slice(f.length)||"/",T=_0(n,{pathname:S}),I=Bce(T&&T.map(k=>Object.assign({},k,{params:Object.assign({},d,k.params),pathname:cp([f,o.encodeLocation?o.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?f:cp([f,o.encodeLocation?o.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),s,a);return e&&I?re.createElement(zM.Provider,{value:{location:FE({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:oo.Pop}},I):I}function Oce(){let n=Gce(),e=Aq(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),a=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},c=null;return re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},e),a?re.createElement("pre",{style:s},a):null,c)}const zce=re.createElement(Oce,null);class Fce extends re.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,a){return a.location!==e.location||a.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||a.error,location:a.location,revalidation:e.revalidation||a.revalidation}}componentDidCatch(e,a){console.error("React Router caught the following error during render",e,a)}render(){return this.state.error?re.createElement(Gg.Provider,{value:this.props.routeContext},re.createElement(Rq.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Nce(n){let{routeContext:e,match:a,children:o}=n,s=re.useContext(DM);return s&&s.static&&s.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=a.route.id),re.createElement(Gg.Provider,{value:e},o)}function Bce(n,e,a){var o;if(e===void 0&&(e=[]),a===void 0&&(a=null),n==null){var s;if((s=a)!=null&&s.errors)n=a.matches;else return null}let c=n,d=(o=a)==null?void 0:o.errors;if(d!=null){let f=c.findIndex(m=>m.route.id&&(d==null?void 0:d[m.route.id]));f>=0||Ka(!1),c=c.slice(0,Math.min(c.length,f+1))}return c.reduceRight((f,m,y)=>{let _=m.route.id?d==null?void 0:d[m.route.id]:null,x=null;a&&(x=m.route.errorElement||zce);let S=e.concat(c.slice(0,y+1)),T=()=>{let I;return _?I=x:m.route.Component?I=re.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=f,re.createElement(Nce,{match:m,routeContext:{outlet:f,matches:S,isDataRoute:a!=null},children:I})};return a&&(m.route.ErrorBoundary||m.route.errorElement||y===0)?re.createElement(Fce,{location:a.location,revalidation:a.revalidation,component:x,error:_,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):T()},null)}var Oq=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Oq||{}),NE=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(NE||{});function Uce(n){let e=re.useContext(DM);return e||Ka(!1),e}function Wce(n){let e=re.useContext(Lq);return e||Ka(!1),e}function Vce(n){let e=re.useContext(Gg);return e||Ka(!1),e}function zq(n){let e=Vce(),a=e.matches[e.matches.length-1];return a.route.id||Ka(!1),a.route.id}function Gce(){var n;let e=re.useContext(Rq),a=Wce(NE.UseRouteError),o=zq(NE.UseRouteError);return e||((n=a.errors)==null?void 0:n[o])}function Hce(){let{router:n}=Uce(Oq.UseNavigateStable),e=zq(NE.UseNavigateStable),a=re.useRef(!1);return Dq(()=>{a.current=!0}),re.useCallback(function(s,c){c===void 0&&(c={}),a.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,FE({fromRouteId:e},c)))},[n,e])}function jce(n){let{basename:e="/",children:a=null,location:o,navigationType:s=oo.Pop,navigator:c,static:d=!1}=n;FM()&&Ka(!1);let f=e.replace(/^\/*/,"/"),m=re.useMemo(()=>({basename:f,navigator:c,static:d}),[f,c,d]);typeof o=="string"&&(o=Wh(o));let{pathname:y="/",search:_="",hash:x="",state:S=null,key:T="default"}=o,I=re.useMemo(()=>{let k=Aw(y,f);return k==null?null:{location:{pathname:k,search:_,hash:x,state:S,key:T},navigationType:s}},[f,y,_,x,S,T,s]);return I==null?null:re.createElement(OM.Provider,{value:m},re.createElement(zM.Provider,{children:a,value:I}))}new Promise(()=>{});function $ce(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:re.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:re.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function BE(){return BE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},BE.apply(this,arguments)}function qce(n,e){return _ce({basename:e==null?void 0:e.basename,future:BE({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:Wle({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||Xce(),routes:n,mapRouteProperties:$ce,window:e==null?void 0:e.window}).initialize()}function Xce(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=BE({},e,{errors:Yce(e.errors)})),e}function Yce(n){if(!n)return null;let e=Object.entries(n),a={};for(let[o,s]of e)if(s&&s.__type==="RouteErrorResponse")a[o]=new sD(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let c=window[s.__subType];if(typeof c=="function")try{let d=new c(s.message);d.stack="",a[o]=d}catch{}}if(a[o]==null){let c=new Error(s.message);c.stack="",a[o]=c}}else a[o]=s;return a}const Zce=re.createContext({isTransitioning:!1}),Kce=re.createContext(new Map),Jce="startTransition",a7=hE[Jce],Qce="flushSync",i7=Ule[Qce];function eue(n){a7?a7(n):n()}function Y1(n){i7?i7(n):n()}class tue{constructor(){this.status="pending",this.promise=new Promise((e,a)=>{this.resolve=o=>{this.status==="pending"&&(this.status="resolved",e(o))},this.reject=o=>{this.status==="pending"&&(this.status="rejected",a(o))}})}}function nue(n){let{fallbackElement:e,router:a,future:o}=n,[s,c]=re.useState(a.state),[d,f]=re.useState(),[m,y]=re.useState({isTransitioning:!1}),[_,x]=re.useState(),[S,T]=re.useState(),[I,k]=re.useState(),D=re.useRef(new Map),{v7_startTransition:L}=o||{},O=re.useCallback(X=>{L?eue(X):X()},[L]),F=re.useCallback((X,te)=>{let{deletedFetchers:V,unstable_flushSync:Q,unstable_viewTransitionOpts:ge}=te;V.forEach(be=>D.current.delete(be)),X.fetchers.forEach((be,fe)=>{be.data!==void 0&&D.current.set(fe,be.data)});let me=a.window==null||typeof a.window.document.startViewTransition!="function";if(!ge||me){Q?Y1(()=>c(X)):O(()=>c(X));return}if(Q){Y1(()=>{S&&(_&&_.resolve(),S.skipTransition()),y({isTransitioning:!0,flushSync:!0,currentLocation:ge.currentLocation,nextLocation:ge.nextLocation})});let be=a.window.document.startViewTransition(()=>{Y1(()=>c(X))});be.finished.finally(()=>{Y1(()=>{x(void 0),T(void 0),f(void 0),y({isTransitioning:!1})})}),Y1(()=>T(be));return}S?(_&&_.resolve(),S.skipTransition(),k({state:X,currentLocation:ge.currentLocation,nextLocation:ge.nextLocation})):(f(X),y({isTransitioning:!0,flushSync:!1,currentLocation:ge.currentLocation,nextLocation:ge.nextLocation}))},[a.window,S,_,D,O]);re.useLayoutEffect(()=>a.subscribe(F),[a,F]),re.useEffect(()=>{m.isTransitioning&&!m.flushSync&&x(new tue)},[m]),re.useEffect(()=>{if(_&&d&&a.window){let X=d,te=_.promise,V=a.window.document.startViewTransition(async()=>{O(()=>c(X)),await te});V.finished.finally(()=>{x(void 0),T(void 0),f(void 0),y({isTransitioning:!1})}),T(V)}},[O,d,_,a.window]),re.useEffect(()=>{_&&d&&s.location.key===d.location.key&&_.resolve()},[_,S,s.location,d]),re.useEffect(()=>{!m.isTransitioning&&I&&(f(I.state),y({isTransitioning:!0,flushSync:!1,currentLocation:I.currentLocation,nextLocation:I.nextLocation}),k(void 0))},[m.isTransitioning,I]);let B=re.useMemo(()=>({createHref:a.createHref,encodeLocation:a.encodeLocation,go:X=>a.navigate(X),push:(X,te,V)=>a.navigate(X,{state:te,preventScrollReset:V==null?void 0:V.preventScrollReset}),replace:(X,te,V)=>a.navigate(X,{replace:!0,state:te,preventScrollReset:V==null?void 0:V.preventScrollReset})}),[a]),G=a.basename||"/",q=re.useMemo(()=>({router:a,navigator:B,static:!1,basename:G}),[a,B,G]);return re.createElement(re.Fragment,null,re.createElement(DM.Provider,{value:q},re.createElement(Lq.Provider,{value:s},re.createElement(Kce.Provider,{value:D.current},re.createElement(Zce.Provider,{value:m},re.createElement(jce,{basename:G,location:s.location,navigationType:s.historyAction,navigator:B},s.initialized?re.createElement(aue,{routes:a.routes,state:s}):e))))),null)}function aue(n){let{routes:e,state:a}=n;return Dce(e,void 0,a)}var r7;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(r7||(r7={}));var o7;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(o7||(o7={}));const iue={black:"#000",white:"#fff"},kx=iue,rue={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Av=rue,oue={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Ev=oue,sue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Mv=sue,lue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Tv=lue,cue={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Cv=cue,uue={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Z1=uue,due={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},hue=due;function rt(){return rt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},rt.apply(this,arguments)}function bh(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function Fq(n){if(!bh(n))return n;const e={};return Object.keys(n).forEach(a=>{e[a]=Fq(n[a])}),e}function wl(n,e,a={clone:!0}){const o=a.clone?rt({},n):n;return bh(n)&&bh(e)&&Object.keys(e).forEach(s=>{s!=="__proto__"&&(bh(e[s])&&s in n&&bh(n[s])?o[s]=wl(n[s],e[s],a):a.clone?o[s]=bh(e[s])?Fq(e[s]):e[s]:o[s]=e[s])}),o}function yp(n){let e="https://mui.com/production-error/?code="+n;for(let a=1;a<arguments.length;a+=1)e+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+n+"; visit "+e+" for the full message."}var Vi={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cD=Symbol.for("react.element"),uD=Symbol.for("react.portal"),NM=Symbol.for("react.fragment"),BM=Symbol.for("react.strict_mode"),UM=Symbol.for("react.profiler"),WM=Symbol.for("react.provider"),VM=Symbol.for("react.context"),fue=Symbol.for("react.server_context"),GM=Symbol.for("react.forward_ref"),HM=Symbol.for("react.suspense"),jM=Symbol.for("react.suspense_list"),$M=Symbol.for("react.memo"),qM=Symbol.for("react.lazy"),pue=Symbol.for("react.offscreen"),Nq;Nq=Symbol.for("react.module.reference");function Cc(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case cD:switch(n=n.type,n){case NM:case UM:case BM:case HM:case jM:return n;default:switch(n=n&&n.$$typeof,n){case fue:case VM:case GM:case qM:case $M:case WM:return n;default:return e}}case uD:return e}}}Vi.ContextConsumer=VM;Vi.ContextProvider=WM;Vi.Element=cD;Vi.ForwardRef=GM;Vi.Fragment=NM;Vi.Lazy=qM;Vi.Memo=$M;Vi.Portal=uD;Vi.Profiler=UM;Vi.StrictMode=BM;Vi.Suspense=HM;Vi.SuspenseList=jM;Vi.isAsyncMode=function(){return!1};Vi.isConcurrentMode=function(){return!1};Vi.isContextConsumer=function(n){return Cc(n)===VM};Vi.isContextProvider=function(n){return Cc(n)===WM};Vi.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===cD};Vi.isForwardRef=function(n){return Cc(n)===GM};Vi.isFragment=function(n){return Cc(n)===NM};Vi.isLazy=function(n){return Cc(n)===qM};Vi.isMemo=function(n){return Cc(n)===$M};Vi.isPortal=function(n){return Cc(n)===uD};Vi.isProfiler=function(n){return Cc(n)===UM};Vi.isStrictMode=function(n){return Cc(n)===BM};Vi.isSuspense=function(n){return Cc(n)===HM};Vi.isSuspenseList=function(n){return Cc(n)===jM};Vi.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===NM||n===UM||n===BM||n===HM||n===jM||n===pue||typeof n=="object"&&n!==null&&(n.$$typeof===qM||n.$$typeof===$M||n.$$typeof===WM||n.$$typeof===VM||n.$$typeof===GM||n.$$typeof===Nq||n.getModuleId!==void 0)};Vi.typeOf=Cc;function xa(n){if(typeof n!="string")throw new Error(yp(7));return n.charAt(0).toUpperCase()+n.slice(1)}function zL(...n){return n.reduce((e,a)=>a==null?e:function(...s){e.apply(this,s),a.apply(this,s)},()=>{})}function XM(n,e=166){let a;function o(...s){const c=()=>{n.apply(this,s)};clearTimeout(a),a=setTimeout(c,e)}return o.clear=()=>{clearTimeout(a)},o}function mue(n,e){return()=>null}function VA(n,e){var a,o;return re.isValidElement(n)&&e.indexOf((a=n.type.muiName)!=null?a:(o=n.type)==null||(o=o._payload)==null||(o=o.value)==null?void 0:o.muiName)!==-1}function Sl(n){return n&&n.ownerDocument||document}function gd(n){return Sl(n).defaultView||window}function gue(n,e){return()=>null}function UE(n,e){typeof n=="function"?n(e):n&&(n.current=e)}const yue=typeof window<"u"?re.useLayoutEffect:re.useEffect,zh=yue;let s7=0;function vue(n){const[e,a]=re.useState(n),o=n||e;return re.useEffect(()=>{e==null&&(s7+=1,a(`mui-${s7}`))},[e]),o}const l7=hE["useId".toString()];function Bq(n){if(l7!==void 0){const e=l7();return n??e}return vue(n)}function _ue(n,e,a,o,s){return null}function WE({controlled:n,default:e,name:a,state:o="value"}){const{current:s}=re.useRef(n!==void 0),[c,d]=re.useState(e),f=s?n:c,m=re.useCallback(y=>{s||d(y)},[]);return[f,m]}function lg(n){const e=re.useRef(n);return zh(()=>{e.current=n}),re.useRef((...a)=>(0,e.current)(...a)).current}function ns(...n){return re.useMemo(()=>n.every(e=>e==null)?null:e=>{n.forEach(a=>{UE(a,e)})},n)}let YM=!0,FL=!1,c7;const bue={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function xue(n){const{type:e,tagName:a}=n;return!!(a==="INPUT"&&bue[e]&&!n.readOnly||a==="TEXTAREA"&&!n.readOnly||n.isContentEditable)}function wue(n){n.metaKey||n.altKey||n.ctrlKey||(YM=!0)}function d4(){YM=!1}function Sue(){this.visibilityState==="hidden"&&FL&&(YM=!0)}function Aue(n){n.addEventListener("keydown",wue,!0),n.addEventListener("mousedown",d4,!0),n.addEventListener("pointerdown",d4,!0),n.addEventListener("touchstart",d4,!0),n.addEventListener("visibilitychange",Sue,!0)}function Eue(n){const{target:e}=n;try{return e.matches(":focus-visible")}catch{}return YM||xue(e)}function Uq(){const n=re.useCallback(s=>{s!=null&&Aue(s.ownerDocument)},[]),e=re.useRef(!1);function a(){return e.current?(FL=!0,window.clearTimeout(c7),c7=window.setTimeout(()=>{FL=!1},100),e.current=!1,!0):!1}function o(s){return Eue(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:o,onBlur:a,ref:n}}function Wq(n){const e=n.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function dD(n,e){const a=rt({},e);return Object.keys(n).forEach(o=>{if(o.toString().match(/^(components|slots)$/))a[o]=rt({},n[o],a[o]);else if(o.toString().match(/^(componentsProps|slotProps)$/)){const s=n[o]||{},c=e[o];a[o]={},!c||!Object.keys(c)?a[o]=s:!s||!Object.keys(s)?a[o]=c:(a[o]=rt({},c),Object.keys(s).forEach(d=>{a[o][d]=dD(s[d],c[d])}))}else a[o]===void 0&&(a[o]=n[o])}),a}function hr(n,e,a=void 0){const o={};return Object.keys(n).forEach(s=>{o[s]=n[s].reduce((c,d)=>{if(d){const f=e(d);f!==""&&c.push(f),a&&a[d]&&c.push(a[d])}return c},[]).join(" ")}),o}const u7=n=>n,Mue=()=>{let n=u7;return{configure(e){n=e},generate(e){return n(e)},reset(){n=u7}}},Tue=Mue(),Vq=Tue,Cue={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function nr(n,e,a="Mui"){const o=Cue[e];return o?`${a}-${o}`:`${Vq.generate(n)}-${e}`}function Bi(n,e,a="Mui"){const o={};return e.forEach(s=>{o[s]=nr(n,s,a)}),o}const q0="$$material";function ya(n,e){if(n==null)return{};var a={},o=Object.keys(n),s,c;for(c=0;c<o.length;c++)s=o[c],!(e.indexOf(s)>=0)&&(a[s]=n[s]);return a}function Gq(n){var e=Object.create(null);return function(a){return e[a]===void 0&&(e[a]=n(a)),e[a]}}var Pue=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,Iue=Gq(function(n){return Pue.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91});function Lue(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function Rue(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var kue=function(){function n(a){var o=this;this._insertTag=function(s){var c;o.tags.length===0?o.insertionPoint?c=o.insertionPoint.nextSibling:o.prepend?c=o.container.firstChild:c=o.before:c=o.tags[o.tags.length-1].nextSibling,o.container.insertBefore(s,c),o.tags.push(s)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(o){o.forEach(this._insertTag)},e.insert=function(o){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(Rue(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var c=Lue(s);try{c.insertRule(o,c.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(o));this.ctr++},e.flush=function(){this.tags.forEach(function(o){return o.parentNode&&o.parentNode.removeChild(o)}),this.tags=[],this.ctr=0},n}(),vs="-ms-",VE="-moz-",Si="-webkit-",Hq="comm",hD="rule",fD="decl",Due="@import",jq="@keyframes",Oue="@layer",zue=Math.abs,ZM=String.fromCharCode,Fue=Object.assign;function Nue(n,e){return Jo(n,0)^45?(((e<<2^Jo(n,0))<<2^Jo(n,1))<<2^Jo(n,2))<<2^Jo(n,3):0}function $q(n){return n.trim()}function Bue(n,e){return(n=e.exec(n))?n[0]:n}function Ai(n,e,a){return n.replace(e,a)}function NL(n,e){return n.indexOf(e)}function Jo(n,e){return n.charCodeAt(e)|0}function Dx(n,e,a){return n.slice(e,a)}function ad(n){return n.length}function pD(n){return n.length}function sS(n,e){return e.push(n),n}function Uue(n,e){return n.map(e).join("")}var KM=1,X0=1,qq=0,Al=0,xo=0,f_="";function JM(n,e,a,o,s,c,d){return{value:n,root:e,parent:a,type:o,props:s,children:c,line:KM,column:X0,length:d,return:""}}function K1(n,e){return Fue(JM("",null,null,"",null,null,0),n,{length:-n.length},e)}function Wue(){return xo}function Vue(){return xo=Al>0?Jo(f_,--Al):0,X0--,xo===10&&(X0=1,KM--),xo}function Yl(){return xo=Al<qq?Jo(f_,Al++):0,X0++,xo===10&&(X0=1,KM++),xo}function dd(){return Jo(f_,Al)}function GA(){return Al}function Ew(n,e){return Dx(f_,n,e)}function Ox(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Xq(n){return KM=X0=1,qq=ad(f_=n),Al=0,[]}function Yq(n){return f_="",n}function HA(n){return $q(Ew(Al-1,BL(n===91?n+2:n===40?n+1:n)))}function Gue(n){for(;(xo=dd())&&xo<33;)Yl();return Ox(n)>2||Ox(xo)>3?"":" "}function Hue(n,e){for(;--e&&Yl()&&!(xo<48||xo>102||xo>57&&xo<65||xo>70&&xo<97););return Ew(n,GA()+(e<6&&dd()==32&&Yl()==32))}function BL(n){for(;Yl();)switch(xo){case n:return Al;case 34:case 39:n!==34&&n!==39&&BL(xo);break;case 40:n===41&&BL(n);break;case 92:Yl();break}return Al}function jue(n,e){for(;Yl()&&n+xo!==47+10;)if(n+xo===42+42&&dd()===47)break;return"/*"+Ew(e,Al-1)+"*"+ZM(n===47?n:Yl())}function $ue(n){for(;!Ox(dd());)Yl();return Ew(n,Al)}function que(n){return Yq(jA("",null,null,null,[""],n=Xq(n),0,[0],n))}function jA(n,e,a,o,s,c,d,f,m){for(var y=0,_=0,x=d,S=0,T=0,I=0,k=1,D=1,L=1,O=0,F="",B=s,G=c,q=o,X=F;D;)switch(I=O,O=Yl()){case 40:if(I!=108&&Jo(X,x-1)==58){NL(X+=Ai(HA(O),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:X+=HA(O);break;case 9:case 10:case 13:case 32:X+=Gue(I);break;case 92:X+=Hue(GA()-1,7);continue;case 47:switch(dd()){case 42:case 47:sS(Xue(jue(Yl(),GA()),e,a),m);break;default:X+="/"}break;case 123*k:f[y++]=ad(X)*L;case 125*k:case 59:case 0:switch(O){case 0:case 125:D=0;case 59+_:L==-1&&(X=Ai(X,/\f/g,"")),T>0&&ad(X)-x&&sS(T>32?h7(X+";",o,a,x-1):h7(Ai(X," ","")+";",o,a,x-2),m);break;case 59:X+=";";default:if(sS(q=d7(X,e,a,y,_,s,f,F,B=[],G=[],x),c),O===123)if(_===0)jA(X,e,q,q,B,c,x,f,G);else switch(S===99&&Jo(X,3)===110?100:S){case 100:case 108:case 109:case 115:jA(n,q,q,o&&sS(d7(n,q,q,0,0,s,f,F,s,B=[],x),G),s,G,x,f,o?B:G);break;default:jA(X,q,q,q,[""],G,0,f,G)}}y=_=T=0,k=L=1,F=X="",x=d;break;case 58:x=1+ad(X),T=I;default:if(k<1){if(O==123)--k;else if(O==125&&k++==0&&Vue()==125)continue}switch(X+=ZM(O),O*k){case 38:L=_>0?1:(X+="\f",-1);break;case 44:f[y++]=(ad(X)-1)*L,L=1;break;case 64:dd()===45&&(X+=HA(Yl())),S=dd(),_=x=ad(F=X+=$ue(GA())),O++;break;case 45:I===45&&ad(X)==2&&(k=0)}}return c}function d7(n,e,a,o,s,c,d,f,m,y,_){for(var x=s-1,S=s===0?c:[""],T=pD(S),I=0,k=0,D=0;I<o;++I)for(var L=0,O=Dx(n,x+1,x=zue(k=d[I])),F=n;L<T;++L)(F=$q(k>0?S[L]+" "+O:Ai(O,/&\f/g,S[L])))&&(m[D++]=F);return JM(n,e,a,s===0?hD:f,m,y,_)}function Xue(n,e,a){return JM(n,e,a,Hq,ZM(Wue()),Dx(n,2,-2),0)}function h7(n,e,a,o){return JM(n,e,a,fD,Dx(n,0,o),Dx(n,o+1,-1),o)}function k0(n,e){for(var a="",o=pD(n),s=0;s<o;s++)a+=e(n[s],s,n,e)||"";return a}function Yue(n,e,a,o){switch(n.type){case Oue:if(n.children.length)break;case Due:case fD:return n.return=n.return||n.value;case Hq:return"";case jq:return n.return=n.value+"{"+k0(n.children,o)+"}";case hD:n.value=n.props.join(",")}return ad(a=k0(n.children,o))?n.return=n.value+"{"+a+"}":""}function Zue(n){var e=pD(n);return function(a,o,s,c){for(var d="",f=0;f<e;f++)d+=n[f](a,o,s,c)||"";return d}}function Kue(n){return function(e){e.root||(e=e.return)&&n(e)}}var Jue=function(e,a,o){for(var s=0,c=0;s=c,c=dd(),s===38&&c===12&&(a[o]=1),!Ox(c);)Yl();return Ew(e,Al)},Que=function(e,a){var o=-1,s=44;do switch(Ox(s)){case 0:s===38&&dd()===12&&(a[o]=1),e[o]+=Jue(Al-1,a,o);break;case 2:e[o]+=HA(s);break;case 4:if(s===44){e[++o]=dd()===58?"&\f":"",a[o]=e[o].length;break}default:e[o]+=ZM(s)}while(s=Yl());return e},ede=function(e,a){return Yq(Que(Xq(e),a))},f7=new WeakMap,tde=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var a=e.value,o=e.parent,s=e.column===o.column&&e.line===o.line;o.type!=="rule";)if(o=o.parent,!o)return;if(!(e.props.length===1&&a.charCodeAt(0)!==58&&!f7.get(o))&&!s){f7.set(e,!0);for(var c=[],d=ede(a,c),f=o.props,m=0,y=0;m<d.length;m++)for(var _=0;_<f.length;_++,y++)e.props[y]=c[m]?d[m].replace(/&\f/g,f[_]):f[_]+" "+d[m]}}},nde=function(e){if(e.type==="decl"){var a=e.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(e.return="",e.value="")}};function Zq(n,e){switch(Nue(n,e)){case 5103:return Si+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Si+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Si+n+VE+n+vs+n+n;case 6828:case 4268:return Si+n+vs+n+n;case 6165:return Si+n+vs+"flex-"+n+n;case 5187:return Si+n+Ai(n,/(\w+).+(:[^]+)/,Si+"box-$1$2"+vs+"flex-$1$2")+n;case 5443:return Si+n+vs+"flex-item-"+Ai(n,/flex-|-self/,"")+n;case 4675:return Si+n+vs+"flex-line-pack"+Ai(n,/align-content|flex-|-self/,"")+n;case 5548:return Si+n+vs+Ai(n,"shrink","negative")+n;case 5292:return Si+n+vs+Ai(n,"basis","preferred-size")+n;case 6060:return Si+"box-"+Ai(n,"-grow","")+Si+n+vs+Ai(n,"grow","positive")+n;case 4554:return Si+Ai(n,/([^-])(transform)/g,"$1"+Si+"$2")+n;case 6187:return Ai(Ai(Ai(n,/(zoom-|grab)/,Si+"$1"),/(image-set)/,Si+"$1"),n,"")+n;case 5495:case 3959:return Ai(n,/(image-set\([^]*)/,Si+"$1$`$1");case 4968:return Ai(Ai(n,/(.+:)(flex-)?(.*)/,Si+"box-pack:$3"+vs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Si+n+n;case 4095:case 3583:case 4068:case 2532:return Ai(n,/(.+)-inline(.+)/,Si+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ad(n)-1-e>6)switch(Jo(n,e+1)){case 109:if(Jo(n,e+4)!==45)break;case 102:return Ai(n,/(.+:)(.+)-([^]+)/,"$1"+Si+"$2-$3$1"+VE+(Jo(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~NL(n,"stretch")?Zq(Ai(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(Jo(n,e+1)!==115)break;case 6444:switch(Jo(n,ad(n)-3-(~NL(n,"!important")&&10))){case 107:return Ai(n,":",":"+Si)+n;case 101:return Ai(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Si+(Jo(n,14)===45?"inline-":"")+"box$3$1"+Si+"$2$3$1"+vs+"$2box$3")+n}break;case 5936:switch(Jo(n,e+11)){case 114:return Si+n+vs+Ai(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Si+n+vs+Ai(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Si+n+vs+Ai(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Si+n+vs+n+n}return n}var ade=function(e,a,o,s){if(e.length>-1&&!e.return)switch(e.type){case fD:e.return=Zq(e.value,e.length);break;case jq:return k0([K1(e,{value:Ai(e.value,"@","@"+Si)})],s);case hD:if(e.length)return Uue(e.props,function(c){switch(Bue(c,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return k0([K1(e,{props:[Ai(c,/:(read-\w+)/,":"+VE+"$1")]})],s);case"::placeholder":return k0([K1(e,{props:[Ai(c,/:(plac\w+)/,":"+Si+"input-$1")]}),K1(e,{props:[Ai(c,/:(plac\w+)/,":"+VE+"$1")]}),K1(e,{props:[Ai(c,/:(plac\w+)/,vs+"input-$1")]})],s)}return""})}},ide=[ade],rde=function(e){var a=e.key;if(a==="css"){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,function(k){var D=k.getAttribute("data-emotion");D.indexOf(" ")!==-1&&(document.head.appendChild(k),k.setAttribute("data-s",""))})}var s=e.stylisPlugins||ide,c={},d,f=[];d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(k){for(var D=k.getAttribute("data-emotion").split(" "),L=1;L<D.length;L++)c[D[L]]=!0;f.push(k)});var m,y=[tde,nde];{var _,x=[Yue,Kue(function(k){_.insert(k)})],S=Zue(y.concat(s,x)),T=function(D){return k0(que(D),S)};m=function(D,L,O,F){_=O,T(D?D+"{"+L.styles+"}":L.styles),F&&(I.inserted[L.name]=!0)}}var I={key:a,sheet:new kue({key:a,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:c,registered:{},insert:m};return I.sheet.hydrate(f),I},Kq={exports:{}},Ui={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Go=typeof Symbol=="function"&&Symbol.for,mD=Go?Symbol.for("react.element"):60103,gD=Go?Symbol.for("react.portal"):60106,QM=Go?Symbol.for("react.fragment"):60107,eT=Go?Symbol.for("react.strict_mode"):60108,tT=Go?Symbol.for("react.profiler"):60114,nT=Go?Symbol.for("react.provider"):60109,aT=Go?Symbol.for("react.context"):60110,yD=Go?Symbol.for("react.async_mode"):60111,iT=Go?Symbol.for("react.concurrent_mode"):60111,rT=Go?Symbol.for("react.forward_ref"):60112,oT=Go?Symbol.for("react.suspense"):60113,ode=Go?Symbol.for("react.suspense_list"):60120,sT=Go?Symbol.for("react.memo"):60115,lT=Go?Symbol.for("react.lazy"):60116,sde=Go?Symbol.for("react.block"):60121,lde=Go?Symbol.for("react.fundamental"):60117,cde=Go?Symbol.for("react.responder"):60118,ude=Go?Symbol.for("react.scope"):60119;function ec(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case mD:switch(n=n.type,n){case yD:case iT:case QM:case tT:case eT:case oT:return n;default:switch(n=n&&n.$$typeof,n){case aT:case rT:case lT:case sT:case nT:return n;default:return e}}case gD:return e}}}function Jq(n){return ec(n)===iT}Ui.AsyncMode=yD;Ui.ConcurrentMode=iT;Ui.ContextConsumer=aT;Ui.ContextProvider=nT;Ui.Element=mD;Ui.ForwardRef=rT;Ui.Fragment=QM;Ui.Lazy=lT;Ui.Memo=sT;Ui.Portal=gD;Ui.Profiler=tT;Ui.StrictMode=eT;Ui.Suspense=oT;Ui.isAsyncMode=function(n){return Jq(n)||ec(n)===yD};Ui.isConcurrentMode=Jq;Ui.isContextConsumer=function(n){return ec(n)===aT};Ui.isContextProvider=function(n){return ec(n)===nT};Ui.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===mD};Ui.isForwardRef=function(n){return ec(n)===rT};Ui.isFragment=function(n){return ec(n)===QM};Ui.isLazy=function(n){return ec(n)===lT};Ui.isMemo=function(n){return ec(n)===sT};Ui.isPortal=function(n){return ec(n)===gD};Ui.isProfiler=function(n){return ec(n)===tT};Ui.isStrictMode=function(n){return ec(n)===eT};Ui.isSuspense=function(n){return ec(n)===oT};Ui.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===QM||n===iT||n===tT||n===eT||n===oT||n===ode||typeof n=="object"&&n!==null&&(n.$$typeof===lT||n.$$typeof===sT||n.$$typeof===nT||n.$$typeof===aT||n.$$typeof===rT||n.$$typeof===lde||n.$$typeof===cde||n.$$typeof===ude||n.$$typeof===sde)};Ui.typeOf=ec;Kq.exports=Ui;var dde=Kq.exports,Qq=dde,hde={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},fde={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},eX={};eX[Qq.ForwardRef]=hde;eX[Qq.Memo]=fde;var pde=!0;function tX(n,e,a){var o="";return a.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):o+=s+" "}),o}var nX=function(e,a,o){var s=e.key+"-"+a.name;(o===!1||pde===!1)&&e.registered[s]===void 0&&(e.registered[s]=a.styles)},vD=function(e,a,o){nX(e,a,o);var s=e.key+"-"+a.name;if(e.inserted[a.name]===void 0){var c=a;do e.insert(a===c?"."+s:"",c,e.sheet,!0),c=c.next;while(c!==void 0)}};function mde(n){for(var e=0,a,o=0,s=n.length;s>=4;++o,s-=4)a=n.charCodeAt(o)&255|(n.charCodeAt(++o)&255)<<8|(n.charCodeAt(++o)&255)<<16|(n.charCodeAt(++o)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,e=(a&65535)*1540483477+((a>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(o+2)&255)<<16;case 2:e^=(n.charCodeAt(o+1)&255)<<8;case 1:e^=n.charCodeAt(o)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var gde={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},yde=/[A-Z]|^ms/g,vde=/_EMO_([^_]+?)_([^]*?)_EMO_/g,aX=function(e){return e.charCodeAt(1)===45},p7=function(e){return e!=null&&typeof e!="boolean"},h4=Gq(function(n){return aX(n)?n:n.replace(yde,"-$&").toLowerCase()}),m7=function(e,a){switch(e){case"animation":case"animationName":if(typeof a=="string")return a.replace(vde,function(o,s,c){return id={name:s,styles:c,next:id},s})}return gde[e]!==1&&!aX(e)&&typeof a=="number"&&a!==0?a+"px":a};function zx(n,e,a){if(a==null)return"";if(a.__emotion_styles!==void 0)return a;switch(typeof a){case"boolean":return"";case"object":{if(a.anim===1)return id={name:a.name,styles:a.styles,next:id},a.name;if(a.styles!==void 0){var o=a.next;if(o!==void 0)for(;o!==void 0;)id={name:o.name,styles:o.styles,next:id},o=o.next;var s=a.styles+";";return s}return _de(n,e,a)}case"function":{if(n!==void 0){var c=id,d=a(n);return id=c,zx(n,e,d)}break}}if(e==null)return a;var f=e[a];return f!==void 0?f:a}function _de(n,e,a){var o="";if(Array.isArray(a))for(var s=0;s<a.length;s++)o+=zx(n,e,a[s])+";";else for(var c in a){var d=a[c];if(typeof d!="object")e!=null&&e[d]!==void 0?o+=c+"{"+e[d]+"}":p7(d)&&(o+=h4(c)+":"+m7(c,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var f=0;f<d.length;f++)p7(d[f])&&(o+=h4(c)+":"+m7(c,d[f])+";");else{var m=zx(n,e,d);switch(c){case"animation":case"animationName":{o+=h4(c)+":"+m+";";break}default:o+=c+"{"+m+"}"}}}return o}var g7=/label:\s*([^\s;\n{]+)\s*(;|$)/g,id,cT=function(e,a,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,c="";id=void 0;var d=e[0];d==null||d.raw===void 0?(s=!1,c+=zx(o,a,d)):c+=d[0];for(var f=1;f<e.length;f++)c+=zx(o,a,e[f]),s&&(c+=d[f]);g7.lastIndex=0;for(var m="",y;(y=g7.exec(c))!==null;)m+="-"+y[1];var _=mde(c)+m;return{name:_,styles:c,next:id}},bde=function(e){return e()},iX=hE["useInsertionEffect"]?hE["useInsertionEffect"]:!1,xde=iX||bde,y7=iX||re.useLayoutEffect,_D=re.createContext(typeof HTMLElement<"u"?rde({key:"css"}):null);_D.Provider;var wde=function(){return re.useContext(_D)},rX=function(e){return re.forwardRef(function(a,o){var s=re.useContext(_D);return e(a,s,o)})},uT=re.createContext({}),Sde=rX(function(n,e){var a=n.styles,o=cT([a],void 0,re.useContext(uT)),s=re.useRef();return y7(function(){var c=e.key+"-global",d=new e.sheet.constructor({key:c,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),f=!1,m=document.querySelector('style[data-emotion="'+c+" "+o.name+'"]');return e.sheet.tags.length&&(d.before=e.sheet.tags[0]),m!==null&&(f=!0,m.setAttribute("data-emotion",c),d.hydrate([m])),s.current=[d,f],function(){d.flush()}},[e]),y7(function(){var c=s.current,d=c[0],f=c[1];if(f){c[1]=!1;return}if(o.next!==void 0&&vD(e,o.next,!0),d.tags.length){var m=d.tags[d.tags.length-1].nextElementSibling;d.before=m,d.flush()}e.insert("",o,d,!1)},[e,o.name]),null});function Ade(){for(var n=arguments.length,e=new Array(n),a=0;a<n;a++)e[a]=arguments[a];return cT(e)}var bD=function(){var e=Ade.apply(void 0,arguments),a="animation-"+e.name;return{name:a,styles:"@keyframes "+a+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Ede=Iue,Mde=function(e){return e!=="theme"},v7=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?Ede:Mde},_7=function(e,a,o){var s;if(a){var c=a.shouldForwardProp;s=e.__emotion_forwardProp&&c?function(d){return e.__emotion_forwardProp(d)&&c(d)}:c}return typeof s!="function"&&o&&(s=e.__emotion_forwardProp),s},Tde=function(e){var a=e.cache,o=e.serialized,s=e.isStringTag;return nX(a,o,s),xde(function(){return vD(a,o,s)}),null},Cde=function n(e,a){var o=e.__emotion_real===e,s=o&&e.__emotion_base||e,c,d;a!==void 0&&(c=a.label,d=a.target);var f=_7(e,a,o),m=f||v7(s),y=!m("as");return function(){var _=arguments,x=o&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(c!==void 0&&x.push("label:"+c+";"),_[0]==null||_[0].raw===void 0)x.push.apply(x,_);else{x.push(_[0][0]);for(var S=_.length,T=1;T<S;T++)x.push(_[T],_[0][T])}var I=rX(function(k,D,L){var O=y&&k.as||s,F="",B=[],G=k;if(k.theme==null){G={};for(var q in k)G[q]=k[q];G.theme=re.useContext(uT)}typeof k.className=="string"?F=tX(D.registered,B,k.className):k.className!=null&&(F=k.className+" ");var X=cT(x.concat(B),D.registered,G);F+=D.key+"-"+X.name,d!==void 0&&(F+=" "+d);var te=y&&f===void 0?v7(O):m,V={};for(var Q in k)y&&Q==="as"||te(Q)&&(V[Q]=k[Q]);return V.className=F,V.ref=L,re.createElement(re.Fragment,null,re.createElement(Tde,{cache:D,serialized:X,isStringTag:typeof O=="string"}),re.createElement(O,V))});return I.displayName=c!==void 0?c:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",I.defaultProps=e.defaultProps,I.__emotion_real=I,I.__emotion_base=s,I.__emotion_styles=x,I.__emotion_forwardProp=f,Object.defineProperty(I,"toString",{value:function(){return"."+d}}),I.withComponent=function(k,D){return n(k,rt({},a,D,{shouldForwardProp:_7(I,D,!0)})).apply(void 0,x)},I}},Pde=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],UL=Cde.bind();Pde.forEach(function(n){UL[n]=UL(n)});var oX={exports:{}},dT={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ide=re,Lde=Symbol.for("react.element"),Rde=Symbol.for("react.fragment"),kde=Object.prototype.hasOwnProperty,Dde=Ide.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ode={key:!0,ref:!0,__self:!0,__source:!0};function sX(n,e,a){var o,s={},c=null,d=null;a!==void 0&&(c=""+a),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)kde.call(e,o)&&!Ode.hasOwnProperty(o)&&(s[o]=e[o]);if(n&&n.defaultProps)for(o in e=n.defaultProps,e)s[o]===void 0&&(s[o]=e[o]);return{$$typeof:Lde,type:n,key:c,ref:d,props:s,_owner:Dde.current}}dT.Fragment=Rde;dT.jsx=sX;dT.jsxs=sX;oX.exports=dT;var xD=oX.exports;const ee=xD.jsx,Je=xD.jsxs,vl=xD.Fragment,zde=Object.freeze(Object.defineProperty({__proto__:null,Fragment:vl,jsx:ee,jsxs:Je},Symbol.toStringTag,{value:"Module"}));function Fde(n){return n==null||Object.keys(n).length===0}function Nde(n){const{styles:e,defaultTheme:a={}}=n;return ee(Sde,{styles:typeof e=="function"?s=>e(Fde(s)?a:s):e})}/**
 * @mui/styled-engine v5.14.17
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Bde(n,e){return UL(n,e)}const Ude=(n,e)=>{Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=e(n.__emotion_styles))},Wde=["values","unit","step"],Vde=n=>{const e=Object.keys(n).map(a=>({key:a,val:n[a]}))||[];return e.sort((a,o)=>a.val-o.val),e.reduce((a,o)=>rt({},a,{[o.key]:o.val}),{})};function Gde(n){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:o=5}=n,s=ya(n,Wde),c=Vde(e),d=Object.keys(c);function f(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${a})`}function m(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-o/100}${a})`}function y(S,T){const I=d.indexOf(T);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${a}) and (max-width:${(I!==-1&&typeof e[d[I]]=="number"?e[d[I]]:T)-o/100}${a})`}function _(S){return d.indexOf(S)+1<d.length?y(S,d[d.indexOf(S)+1]):f(S)}function x(S){const T=d.indexOf(S);return T===0?f(d[1]):T===d.length-1?m(d[T]):y(S,d[d.indexOf(S)+1]).replace("@media","@media not all and")}return rt({keys:d,values:c,up:f,down:m,between:y,only:_,not:x,unit:a},s)}const Hde={borderRadius:4},jde=Hde;function Xb(n,e){return e?wl(n,e,{clone:!1}):n}const wD={xs:0,sm:600,md:900,lg:1200,xl:1536},b7={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${wD[n]}px)`};function Fh(n,e,a){const o=n.theme||{};if(Array.isArray(e)){const c=o.breakpoints||b7;return e.reduce((d,f,m)=>(d[c.up(c.keys[m])]=a(e[m]),d),{})}if(typeof e=="object"){const c=o.breakpoints||b7;return Object.keys(e).reduce((d,f)=>{if(Object.keys(c.values||wD).indexOf(f)!==-1){const m=c.up(f);d[m]=a(e[f],f)}else{const m=f;d[m]=e[m]}return d},{})}return a(e)}function $de(n={}){var e;return((e=n.keys)==null?void 0:e.reduce((o,s)=>{const c=n.up(s);return o[c]={},o},{}))||{}}function qde(n,e){return n.reduce((a,o)=>{const s=a[o];return(!s||Object.keys(s).length===0)&&delete a[o],a},e)}function hT(n,e,a=!0){if(!e||typeof e!="string")return null;if(n&&n.vars&&a){const o=`vars.${e}`.split(".").reduce((s,c)=>s&&s[c]?s[c]:null,n);if(o!=null)return o}return e.split(".").reduce((o,s)=>o&&o[s]!=null?o[s]:null,n)}function GE(n,e,a,o=a){let s;return typeof n=="function"?s=n(a):Array.isArray(n)?s=n[a]||o:s=hT(n,a)||o,e&&(s=e(s,o,n)),s}function Ii(n){const{prop:e,cssProperty:a=n.prop,themeKey:o,transform:s}=n,c=d=>{if(d[e]==null)return null;const f=d[e],m=d.theme,y=hT(m,o)||{};return Fh(d,f,x=>{let S=GE(y,s,x);return x===S&&typeof x=="string"&&(S=GE(y,s,`${e}${x==="default"?"":xa(x)}`,x)),a===!1?S:{[a]:S}})};return c.propTypes={},c.filterProps=[e],c}function Xde(n){const e={};return a=>(e[a]===void 0&&(e[a]=n(a)),e[a])}const Yde={m:"margin",p:"padding"},Zde={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},x7={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Kde=Xde(n=>{if(n.length>2)if(x7[n])n=x7[n];else return[n];const[e,a]=n.split(""),o=Yde[e],s=Zde[a]||"";return Array.isArray(s)?s.map(c=>o+c):[o+s]}),SD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],AD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...SD,...AD];function Mw(n,e,a,o){var s;const c=(s=hT(n,e,!1))!=null?s:a;return typeof c=="number"?d=>typeof d=="string"?d:c*d:Array.isArray(c)?d=>typeof d=="string"?d:c[d]:typeof c=="function"?c:()=>{}}function lX(n){return Mw(n,"spacing",8)}function Tw(n,e){if(typeof e=="string"||e==null)return e;const a=Math.abs(e),o=n(a);return e>=0?o:typeof o=="number"?-o:`-${o}`}function Jde(n,e){return a=>n.reduce((o,s)=>(o[s]=Tw(e,a),o),{})}function Qde(n,e,a,o){if(e.indexOf(a)===-1)return null;const s=Kde(a),c=Jde(s,o),d=n[a];return Fh(n,d,c)}function cX(n,e){const a=lX(n.theme);return Object.keys(n).map(o=>Qde(n,e,o,a)).reduce(Xb,{})}function Vr(n){return cX(n,SD)}Vr.propTypes={};Vr.filterProps=SD;function Gr(n){return cX(n,AD)}Gr.propTypes={};Gr.filterProps=AD;function ehe(n=8){if(n.mui)return n;const e=lX({spacing:n}),a=(...o)=>(o.length===0?[1]:o).map(c=>{const d=e(c);return typeof d=="number"?`${d}px`:d}).join(" ");return a.mui=!0,a}function fT(...n){const e=n.reduce((o,s)=>(s.filterProps.forEach(c=>{o[c]=s}),o),{}),a=o=>Object.keys(o).reduce((s,c)=>e[c]?Xb(s,e[c](o)):s,{});return a.propTypes={},a.filterProps=n.reduce((o,s)=>o.concat(s.filterProps),[]),a}function od(n){return typeof n!="number"?n:`${n}px solid`}const the=Ii({prop:"border",themeKey:"borders",transform:od}),nhe=Ii({prop:"borderTop",themeKey:"borders",transform:od}),ahe=Ii({prop:"borderRight",themeKey:"borders",transform:od}),ihe=Ii({prop:"borderBottom",themeKey:"borders",transform:od}),rhe=Ii({prop:"borderLeft",themeKey:"borders",transform:od}),ohe=Ii({prop:"borderColor",themeKey:"palette"}),she=Ii({prop:"borderTopColor",themeKey:"palette"}),lhe=Ii({prop:"borderRightColor",themeKey:"palette"}),che=Ii({prop:"borderBottomColor",themeKey:"palette"}),uhe=Ii({prop:"borderLeftColor",themeKey:"palette"}),pT=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const e=Mw(n.theme,"shape.borderRadius",4),a=o=>({borderRadius:Tw(e,o)});return Fh(n,n.borderRadius,a)}return null};pT.propTypes={};pT.filterProps=["borderRadius"];fT(the,nhe,ahe,ihe,rhe,ohe,she,lhe,che,uhe,pT);const mT=n=>{if(n.gap!==void 0&&n.gap!==null){const e=Mw(n.theme,"spacing",8),a=o=>({gap:Tw(e,o)});return Fh(n,n.gap,a)}return null};mT.propTypes={};mT.filterProps=["gap"];const gT=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const e=Mw(n.theme,"spacing",8),a=o=>({columnGap:Tw(e,o)});return Fh(n,n.columnGap,a)}return null};gT.propTypes={};gT.filterProps=["columnGap"];const yT=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const e=Mw(n.theme,"spacing",8),a=o=>({rowGap:Tw(e,o)});return Fh(n,n.rowGap,a)}return null};yT.propTypes={};yT.filterProps=["rowGap"];const dhe=Ii({prop:"gridColumn"}),hhe=Ii({prop:"gridRow"}),fhe=Ii({prop:"gridAutoFlow"}),phe=Ii({prop:"gridAutoColumns"}),mhe=Ii({prop:"gridAutoRows"}),ghe=Ii({prop:"gridTemplateColumns"}),yhe=Ii({prop:"gridTemplateRows"}),vhe=Ii({prop:"gridTemplateAreas"}),_he=Ii({prop:"gridArea"});fT(mT,gT,yT,dhe,hhe,fhe,phe,mhe,ghe,yhe,vhe,_he);function D0(n,e){return e==="grey"?e:n}const bhe=Ii({prop:"color",themeKey:"palette",transform:D0}),xhe=Ii({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:D0}),whe=Ii({prop:"backgroundColor",themeKey:"palette",transform:D0});fT(bhe,xhe,whe);function Gl(n){return n<=1&&n!==0?`${n*100}%`:n}const She=Ii({prop:"width",transform:Gl}),ED=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const e=a=>{var o,s;const c=((o=n.theme)==null||(o=o.breakpoints)==null||(o=o.values)==null?void 0:o[a])||wD[a];return c?((s=n.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${c}${n.theme.breakpoints.unit}`}:{maxWidth:c}:{maxWidth:Gl(a)}};return Fh(n,n.maxWidth,e)}return null};ED.filterProps=["maxWidth"];const Ahe=Ii({prop:"minWidth",transform:Gl}),Ehe=Ii({prop:"height",transform:Gl}),Mhe=Ii({prop:"maxHeight",transform:Gl}),The=Ii({prop:"minHeight",transform:Gl});Ii({prop:"size",cssProperty:"width",transform:Gl});Ii({prop:"size",cssProperty:"height",transform:Gl});const Che=Ii({prop:"boxSizing"});fT(She,ED,Ahe,Ehe,Mhe,The,Che);const Phe={border:{themeKey:"borders",transform:od},borderTop:{themeKey:"borders",transform:od},borderRight:{themeKey:"borders",transform:od},borderBottom:{themeKey:"borders",transform:od},borderLeft:{themeKey:"borders",transform:od},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:pT},color:{themeKey:"palette",transform:D0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:D0},backgroundColor:{themeKey:"palette",transform:D0},p:{style:Gr},pt:{style:Gr},pr:{style:Gr},pb:{style:Gr},pl:{style:Gr},px:{style:Gr},py:{style:Gr},padding:{style:Gr},paddingTop:{style:Gr},paddingRight:{style:Gr},paddingBottom:{style:Gr},paddingLeft:{style:Gr},paddingX:{style:Gr},paddingY:{style:Gr},paddingInline:{style:Gr},paddingInlineStart:{style:Gr},paddingInlineEnd:{style:Gr},paddingBlock:{style:Gr},paddingBlockStart:{style:Gr},paddingBlockEnd:{style:Gr},m:{style:Vr},mt:{style:Vr},mr:{style:Vr},mb:{style:Vr},ml:{style:Vr},mx:{style:Vr},my:{style:Vr},margin:{style:Vr},marginTop:{style:Vr},marginRight:{style:Vr},marginBottom:{style:Vr},marginLeft:{style:Vr},marginX:{style:Vr},marginY:{style:Vr},marginInline:{style:Vr},marginInlineStart:{style:Vr},marginInlineEnd:{style:Vr},marginBlock:{style:Vr},marginBlockStart:{style:Vr},marginBlockEnd:{style:Vr},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:mT},rowGap:{style:yT},columnGap:{style:gT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Gl},maxWidth:{style:ED},minWidth:{transform:Gl},height:{transform:Gl},maxHeight:{transform:Gl},minHeight:{transform:Gl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},vT=Phe;function Ihe(...n){const e=n.reduce((o,s)=>o.concat(Object.keys(s)),[]),a=new Set(e);return n.every(o=>a.size===Object.keys(o).length)}function Lhe(n,e){return typeof n=="function"?n(e):n}function Rhe(){function n(a,o,s,c){const d={[a]:o,theme:s},f=c[a];if(!f)return{[a]:o};const{cssProperty:m=a,themeKey:y,transform:_,style:x}=f;if(o==null)return null;if(y==="typography"&&o==="inherit")return{[a]:o};const S=hT(s,y)||{};return x?x(d):Fh(d,o,I=>{let k=GE(S,_,I);return I===k&&typeof I=="string"&&(k=GE(S,_,`${a}${I==="default"?"":xa(I)}`,I)),m===!1?k:{[m]:k}})}function e(a){var o;const{sx:s,theme:c={}}=a||{};if(!s)return null;const d=(o=c.unstable_sxConfig)!=null?o:vT;function f(m){let y=m;if(typeof m=="function")y=m(c);else if(typeof m!="object")return m;if(!y)return null;const _=$de(c.breakpoints),x=Object.keys(_);let S=_;return Object.keys(y).forEach(T=>{const I=Lhe(y[T],c);if(I!=null)if(typeof I=="object")if(d[T])S=Xb(S,n(T,I,c,d));else{const k=Fh({theme:c},I,D=>({[T]:D}));Ihe(k,I)?S[T]=e({sx:I,theme:c}):S=Xb(S,k)}else S=Xb(S,n(T,I,c,d))}),qde(x,S)}return Array.isArray(s)?s.map(f):f(s)}return e}const uX=Rhe();uX.filterProps=["sx"];const MD=uX,khe=["breakpoints","palette","spacing","shape"];function TD(n={},...e){const{breakpoints:a={},palette:o={},spacing:s,shape:c={}}=n,d=ya(n,khe),f=Gde(a),m=ehe(s);let y=wl({breakpoints:f,direction:"ltr",components:{},palette:rt({mode:"light"},o),spacing:m,shape:rt({},jde,c)},d);return y=e.reduce((_,x)=>wl(_,x),y),y.unstable_sxConfig=rt({},vT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(x){return MD({sx:x,theme:this})},y}function Dhe(n){return Object.keys(n).length===0}function dX(n=null){const e=re.useContext(uT);return!e||Dhe(e)?n:e}const Ohe=TD();function CD(n=Ohe){return dX(n)}function zhe({styles:n,themeId:e,defaultTheme:a={}}){const o=CD(a),s=typeof n=="function"?n(e&&o[e]||o):n;return ee(Nde,{styles:s})}const Fhe=["sx"],Nhe=n=>{var e,a;const o={systemProps:{},otherProps:{}},s=(e=n==null||(a=n.theme)==null?void 0:a.unstable_sxConfig)!=null?e:vT;return Object.keys(n).forEach(c=>{s[c]?o.systemProps[c]=n[c]:o.otherProps[c]=n[c]}),o};function Bhe(n){const{sx:e}=n,a=ya(n,Fhe),{systemProps:o,otherProps:s}=Nhe(a);let c;return Array.isArray(e)?c=[o,...e]:typeof e=="function"?c=(...d)=>{const f=e(...d);return bh(f)?rt({},o,f):o}:c=rt({},o,e),rt({},s,{sx:c})}function hX(n){var e,a,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(a=hX(n[e]))&&(o&&(o+=" "),o+=a);else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function Va(){for(var n,e,a=0,o="";a<arguments.length;)(n=arguments[a++])&&(e=hX(n))&&(o&&(o+=" "),o+=e);return o}const Uhe=["variant"];function w7(n){return n.length===0}function fX(n){const{variant:e}=n,a=ya(n,Uhe);let o=e||"";return Object.keys(a).sort().forEach(s=>{s==="color"?o+=w7(o)?n[s]:xa(n[s]):o+=`${w7(o)?s:xa(s)}${xa(n[s].toString())}`}),o}const Whe=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Vhe(n){return Object.keys(n).length===0}function Ghe(n){return typeof n=="string"&&n.charCodeAt(0)>96}const Hhe=(n,e)=>e.components&&e.components[n]&&e.components[n].styleOverrides?e.components[n].styleOverrides:null,HE=n=>{const e={};return n&&n.forEach(a=>{const o=fX(a.props);e[o]=a.style}),e},jhe=(n,e)=>{let a=[];return e&&e.components&&e.components[n]&&e.components[n].variants&&(a=e.components[n].variants),HE(a)},jE=(n,e,a)=>{const{ownerState:o={}}=n,s=[];return a&&a.forEach(c=>{let d=!0;Object.keys(c.props).forEach(f=>{o[f]!==c.props[f]&&n[f]!==c.props[f]&&(d=!1)}),d&&s.push(e[fX(c.props)])}),s},$he=(n,e,a,o)=>{var s;const c=a==null||(s=a.components)==null||(s=s[o])==null?void 0:s.variants;return jE(n,e,c)};function Yb(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const qhe=TD(),Xhe=n=>n&&n.charAt(0).toLowerCase()+n.slice(1);function $A({defaultTheme:n,theme:e,themeId:a}){return Vhe(e)?n:e[a]||e}function Yhe(n){return n?(e,a)=>a[n]:null}const S7=({styledArg:n,props:e,defaultTheme:a,themeId:o})=>{const s=n(rt({},e,{theme:$A(rt({},e,{defaultTheme:a,themeId:o}))}));let c;if(s&&s.variants&&(c=s.variants,delete s.variants),c){const d=jE(e,HE(c),c);return[s,...d]}return s};function Zhe(n={}){const{themeId:e,defaultTheme:a=qhe,rootShouldForwardProp:o=Yb,slotShouldForwardProp:s=Yb}=n,c=d=>MD(rt({},d,{theme:$A(rt({},d,{defaultTheme:a,themeId:e}))}));return c.__mui_systemSx=!0,(d,f={})=>{Ude(d,B=>B.filter(G=>!(G!=null&&G.__mui_systemSx)));const{name:m,slot:y,skipVariantsResolver:_,skipSx:x,overridesResolver:S=Yhe(Xhe(y))}=f,T=ya(f,Whe),I=_!==void 0?_:y&&y!=="Root"&&y!=="root"||!1,k=x||!1;let D,L=Yb;y==="Root"||y==="root"?L=o:y?L=s:Ghe(d)&&(L=void 0);const O=Bde(d,rt({shouldForwardProp:L,label:D},T)),F=(B,...G)=>{const q=G?G.map(Q=>{if(typeof Q=="function"&&Q.__emotion_real!==Q)return ge=>S7({styledArg:Q,props:ge,defaultTheme:a,themeId:e});if(bh(Q)){let ge=Q,me;return Q&&Q.variants&&(me=Q.variants,delete ge.variants,ge=be=>{let fe=Q;return jE(be,HE(me),me).forEach(Le=>{fe=wl(fe,Le)}),fe}),ge}return Q}):[];let X=B;if(bh(B)){let Q;B&&B.variants&&(Q=B.variants,delete X.variants,X=ge=>{let me=B;return jE(ge,HE(Q),Q).forEach(fe=>{me=wl(me,fe)}),me})}else typeof B=="function"&&B.__emotion_real!==B&&(X=Q=>S7({styledArg:B,props:Q,defaultTheme:a,themeId:e}));m&&S&&q.push(Q=>{const ge=$A(rt({},Q,{defaultTheme:a,themeId:e})),me=Hhe(m,ge);if(me){const be={};return Object.entries(me).forEach(([fe,Ce])=>{be[fe]=typeof Ce=="function"?Ce(rt({},Q,{theme:ge})):Ce}),S(Q,be)}return null}),m&&!I&&q.push(Q=>{const ge=$A(rt({},Q,{defaultTheme:a,themeId:e}));return $he(Q,jhe(m,ge),ge,m)}),k||q.push(c);const te=q.length-G.length;if(Array.isArray(B)&&te>0){const Q=new Array(te).fill("");X=[...B,...Q],X.raw=[...B.raw,...Q]}const V=O(X,...q);return d.muiName&&(V.muiName=d.muiName),V};return O.withConfig&&(F.withConfig=O.withConfig),F}}function Khe(n){const{theme:e,name:a,props:o}=n;return!e||!e.components||!e.components[a]||!e.components[a].defaultProps?o:dD(e.components[a].defaultProps,o)}function Jhe({props:n,name:e,defaultTheme:a,themeId:o}){let s=CD(a);return o&&(s=s[o]||s),Khe({theme:s,name:e,props:n})}function PD(n,e=0,a=1){return Math.min(Math.max(e,n),a)}function Qhe(n){n=n.slice(1);const e=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let a=n.match(e);return a&&a[0].length===1&&(a=a.map(o=>o+o)),a?`rgb${a.length===4?"a":""}(${a.map((o,s)=>s<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function Rg(n){if(n.type)return n;if(n.charAt(0)==="#")return Rg(Qhe(n));const e=n.indexOf("("),a=n.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error(yp(9,n));let o=n.substring(e+1,n.length-1),s;if(a==="color"){if(o=o.split(" "),s=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(yp(10,s))}else o=o.split(",");return o=o.map(c=>parseFloat(c)),{type:a,values:o,colorSpace:s}}function _T(n){const{type:e,colorSpace:a}=n;let{values:o}=n;return e.indexOf("rgb")!==-1?o=o.map((s,c)=>c<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),e.indexOf("color")!==-1?o=`${a} ${o.join(" ")}`:o=`${o.join(", ")}`,`${e}(${o})`}function efe(n){n=Rg(n);const{values:e}=n,a=e[0],o=e[1]/100,s=e[2]/100,c=o*Math.min(s,1-s),d=(y,_=(y+a/30)%12)=>s-c*Math.max(Math.min(_-3,9-_,1),-1);let f="rgb";const m=[Math.round(d(0)*255),Math.round(d(8)*255),Math.round(d(4)*255)];return n.type==="hsla"&&(f+="a",m.push(e[3])),_T({type:f,values:m})}function A7(n){n=Rg(n);let e=n.type==="hsl"||n.type==="hsla"?Rg(efe(n)).values:n.values;return e=e.map(a=>(n.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function tfe(n,e){const a=A7(n),o=A7(e);return(Math.max(a,o)+.05)/(Math.min(a,o)+.05)}function Qo(n,e){return n=Rg(n),e=PD(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${e}`:n.values[3]=e,_T(n)}function pX(n,e){if(n=Rg(n),e=PD(e),n.type.indexOf("hsl")!==-1)n.values[2]*=1-e;else if(n.type.indexOf("rgb")!==-1||n.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)n.values[a]*=1-e;return _T(n)}function mX(n,e){if(n=Rg(n),e=PD(e),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*e;else if(n.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)n.values[a]+=(255-n.values[a])*e;else if(n.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)n.values[a]+=(1-n.values[a])*e;return _T(n)}const nfe=re.createContext(null),gX=nfe;function yX(){return re.useContext(gX)}const afe=typeof Symbol=="function"&&Symbol.for,ife=afe?Symbol.for("mui.nested"):"__THEME_NESTED__";function rfe(n,e){return typeof e=="function"?e(n):rt({},n,e)}function ofe(n){const{children:e,theme:a}=n,o=yX(),s=re.useMemo(()=>{const c=o===null?a:rfe(o,a);return c!=null&&(c[ife]=o!==null),c},[a,o]);return ee(gX.Provider,{value:s,children:e})}const E7={};function M7(n,e,a,o=!1){return re.useMemo(()=>{const s=n&&e[n]||e;if(typeof a=="function"){const c=a(s),d=n?rt({},e,{[n]:c}):c;return o?()=>d:d}return n?rt({},e,{[n]:a}):rt({},e,a)},[n,e,a,o])}function sfe(n){const{children:e,theme:a,themeId:o}=n,s=dX(E7),c=yX()||E7,d=M7(o,s,a),f=M7(o,c,a,!0);return ee(ofe,{theme:f,children:ee(uT.Provider,{value:d,children:e})})}function lfe(n,e){return rt({toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}}},e)}const cfe=["mode","contrastThreshold","tonalOffset"],T7={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:kx.white,default:kx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},f4={text:{primary:kx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:kx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function C7(n,e,a,o){const s=o.light||o,c=o.dark||o*1.5;n[e]||(n.hasOwnProperty(a)?n[e]=n[a]:e==="light"?n.light=mX(n.main,s):e==="dark"&&(n.dark=pX(n.main,c)))}function ufe(n="light"){return n==="dark"?{main:Mv[200],light:Mv[50],dark:Mv[400]}:{main:Mv[700],light:Mv[400],dark:Mv[800]}}function dfe(n="light"){return n==="dark"?{main:Ev[200],light:Ev[50],dark:Ev[400]}:{main:Ev[500],light:Ev[300],dark:Ev[700]}}function hfe(n="light"){return n==="dark"?{main:Av[500],light:Av[300],dark:Av[700]}:{main:Av[700],light:Av[400],dark:Av[800]}}function ffe(n="light"){return n==="dark"?{main:Tv[400],light:Tv[300],dark:Tv[700]}:{main:Tv[700],light:Tv[500],dark:Tv[900]}}function pfe(n="light"){return n==="dark"?{main:Cv[400],light:Cv[300],dark:Cv[700]}:{main:Cv[800],light:Cv[500],dark:Cv[900]}}function mfe(n="light"){return n==="dark"?{main:Z1[400],light:Z1[300],dark:Z1[700]}:{main:"#ed6c02",light:Z1[500],dark:Z1[900]}}function gfe(n){const{mode:e="light",contrastThreshold:a=3,tonalOffset:o=.2}=n,s=ya(n,cfe),c=n.primary||ufe(e),d=n.secondary||dfe(e),f=n.error||hfe(e),m=n.info||ffe(e),y=n.success||pfe(e),_=n.warning||mfe(e);function x(k){return tfe(k,f4.text.primary)>=a?f4.text.primary:T7.text.primary}const S=({color:k,name:D,mainShade:L=500,lightShade:O=300,darkShade:F=700})=>{if(k=rt({},k),!k.main&&k[L]&&(k.main=k[L]),!k.hasOwnProperty("main"))throw new Error(yp(11,D?` (${D})`:"",L));if(typeof k.main!="string")throw new Error(yp(12,D?` (${D})`:"",JSON.stringify(k.main)));return C7(k,"light",O,o),C7(k,"dark",F,o),k.contrastText||(k.contrastText=x(k.main)),k},T={dark:f4,light:T7};return wl(rt({common:rt({},kx),mode:e,primary:S({color:c,name:"primary"}),secondary:S({color:d,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:S({color:f,name:"error"}),warning:S({color:_,name:"warning"}),info:S({color:m,name:"info"}),success:S({color:y,name:"success"}),grey:hue,contrastThreshold:a,getContrastText:x,augmentColor:S,tonalOffset:o},T[e]),s)}const yfe=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function vfe(n){return Math.round(n*1e5)/1e5}const P7={textTransform:"uppercase"},I7='"Roboto", "Helvetica", "Arial", sans-serif';function _fe(n,e){const a=typeof e=="function"?e(n):e,{fontFamily:o=I7,fontSize:s=14,fontWeightLight:c=300,fontWeightRegular:d=400,fontWeightMedium:f=500,fontWeightBold:m=700,htmlFontSize:y=16,allVariants:_,pxToRem:x}=a,S=ya(a,yfe),T=s/14,I=x||(L=>`${L/y*T}rem`),k=(L,O,F,B,G)=>rt({fontFamily:o,fontWeight:L,fontSize:I(O),lineHeight:F},o===I7?{letterSpacing:`${vfe(B/O)}em`}:{},G,_),D={h1:k(c,96,1.167,-1.5),h2:k(c,60,1.2,-.5),h3:k(d,48,1.167,0),h4:k(d,34,1.235,.25),h5:k(d,24,1.334,0),h6:k(f,20,1.6,.15),subtitle1:k(d,16,1.75,.15),subtitle2:k(f,14,1.57,.1),body1:k(d,16,1.5,.15),body2:k(d,14,1.43,.15),button:k(f,14,1.75,.4,P7),caption:k(d,12,1.66,.4),overline:k(d,12,2.66,1,P7),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return wl(rt({htmlFontSize:y,pxToRem:I,fontFamily:o,fontSize:s,fontWeightLight:c,fontWeightRegular:d,fontWeightMedium:f,fontWeightBold:m},D),S,{clone:!1})}const bfe=.2,xfe=.14,wfe=.12;function vr(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${bfe})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${xfe})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${wfe})`].join(",")}const Sfe=["none",vr(0,2,1,-1,0,1,1,0,0,1,3,0),vr(0,3,1,-2,0,2,2,0,0,1,5,0),vr(0,3,3,-2,0,3,4,0,0,1,8,0),vr(0,2,4,-1,0,4,5,0,0,1,10,0),vr(0,3,5,-1,0,5,8,0,0,1,14,0),vr(0,3,5,-1,0,6,10,0,0,1,18,0),vr(0,4,5,-2,0,7,10,1,0,2,16,1),vr(0,5,5,-3,0,8,10,1,0,3,14,2),vr(0,5,6,-3,0,9,12,1,0,3,16,2),vr(0,6,6,-3,0,10,14,1,0,4,18,3),vr(0,6,7,-4,0,11,15,1,0,4,20,3),vr(0,7,8,-4,0,12,17,2,0,5,22,4),vr(0,7,8,-4,0,13,19,2,0,5,24,4),vr(0,7,9,-4,0,14,21,2,0,5,26,4),vr(0,8,9,-5,0,15,22,2,0,6,28,5),vr(0,8,10,-5,0,16,24,2,0,6,30,5),vr(0,8,11,-5,0,17,26,2,0,6,32,5),vr(0,9,11,-5,0,18,28,2,0,7,34,6),vr(0,9,12,-6,0,19,29,2,0,7,36,6),vr(0,10,13,-6,0,20,31,3,0,8,38,7),vr(0,10,13,-6,0,21,33,3,0,8,40,7),vr(0,10,14,-6,0,22,35,3,0,8,42,7),vr(0,11,14,-7,0,23,36,3,0,9,44,8),vr(0,11,15,-7,0,24,38,3,0,9,46,8)],Afe=Sfe,Efe=["duration","easing","delay"],Mfe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Tfe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function L7(n){return`${Math.round(n)}ms`}function Cfe(n){if(!n)return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function Pfe(n){const e=rt({},Mfe,n.easing),a=rt({},Tfe,n.duration);return rt({getAutoHeightDuration:Cfe,create:(s=["all"],c={})=>{const{duration:d=a.standard,easing:f=e.easeInOut,delay:m=0}=c;return ya(c,Efe),(Array.isArray(s)?s:[s]).map(y=>`${y} ${typeof d=="string"?d:L7(d)} ${f} ${typeof m=="string"?m:L7(m)}`).join(",")}},n,{easing:e,duration:a})}const Ife={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Lfe=Ife,Rfe=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function vX(n={},...e){const{mixins:a={},palette:o={},transitions:s={},typography:c={}}=n,d=ya(n,Rfe);if(n.vars)throw new Error(yp(18));const f=gfe(o),m=TD(n);let y=wl(m,{mixins:lfe(m.breakpoints,a),palette:f,shadows:Afe.slice(),typography:_fe(f,c),transitions:Pfe(s),zIndex:rt({},Lfe)});return y=wl(y,d),y=e.reduce((_,x)=>wl(_,x),y),y.unstable_sxConfig=rt({},vT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(x){return MD({sx:x,theme:this})},y}const kfe=vX(),bT=kfe;function p_(){const n=CD(bT);return n[q0]||n}function br({props:n,name:e}){return Jhe({props:n,name:e,defaultTheme:bT,themeId:q0})}const El=n=>Yb(n)&&n!=="classes",Dfe=Yb,Ofe=Zhe({themeId:q0,defaultTheme:bT,rootShouldForwardProp:El}),ca=Ofe,zfe=["theme"];function Ffe(n){let{theme:e}=n,a=ya(n,zfe);const o=e[q0];return ee(sfe,rt({},a,{themeId:o?q0:void 0,theme:o||e}))}const Nfe=n=>{let e;return n<1?e=5.11916*n**2:e=4.5*Math.log(n+1)+2,(e/100).toFixed(2)},R7=Nfe;function Bfe(n){return nr("MuiSvgIcon",n)}Bi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Ufe=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Wfe=n=>{const{color:e,fontSize:a,classes:o}=n,s={root:["root",e!=="inherit"&&`color${xa(e)}`,`fontSize${xa(a)}`]};return hr(s,Bfe,o)},Vfe=ca("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.color!=="inherit"&&e[`color${xa(a.color)}`],e[`fontSize${xa(a.fontSize)}`]]}})(({theme:n,ownerState:e})=>{var a,o,s,c,d,f,m,y,_,x,S,T,I;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=n.transitions)==null||(o=a.create)==null?void 0:o.call(a,"fill",{duration:(s=n.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((c=n.typography)==null||(d=c.pxToRem)==null?void 0:d.call(c,20))||"1.25rem",medium:((f=n.typography)==null||(m=f.pxToRem)==null?void 0:m.call(f,24))||"1.5rem",large:((y=n.typography)==null||(_=y.pxToRem)==null?void 0:_.call(y,35))||"2.1875rem"}[e.fontSize],color:(x=(S=(n.vars||n).palette)==null||(S=S[e.color])==null?void 0:S.main)!=null?x:{action:(T=(n.vars||n).palette)==null||(T=T.action)==null?void 0:T.active,disabled:(I=(n.vars||n).palette)==null||(I=I.action)==null?void 0:I.disabled,inherit:void 0}[e.color]}}),_X=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiSvgIcon"}),{children:s,className:c,color:d="inherit",component:f="svg",fontSize:m="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:x,viewBox:S="0 0 24 24"}=o,T=ya(o,Ufe),I=re.isValidElement(s)&&s.type==="svg",k=rt({},o,{color:d,component:f,fontSize:m,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:S,hasSvgAsChild:I}),D={};_||(D.viewBox=S);const L=Wfe(k);return Je(Vfe,rt({as:f,className:Va(L.root,c),focusable:"false",color:y,"aria-hidden":x?void 0:!0,role:x?"img":void 0,ref:a},D,T,I&&s.props,{ownerState:k,children:[I?s.props.children:s,x?ee("title",{children:x}):null]}))});_X.muiName="SvgIcon";const k7=_X;function Cw(n,e){function a(o,s){return ee(k7,rt({"data-testid":`${e}Icon`,ref:s},o,{children:n}))}return a.muiName=k7.muiName,re.memo(re.forwardRef(a))}const Gfe={configure:n=>{Vq.configure(n)}},Hfe=Object.freeze(Object.defineProperty({__proto__:null,capitalize:xa,createChainedFunction:zL,createSvgIcon:Cw,debounce:XM,deprecatedPropType:mue,isMuiElement:VA,ownerDocument:Sl,ownerWindow:gd,requirePropFactory:gue,setRef:UE,unstable_ClassNameGenerator:Gfe,unstable_useEnhancedEffect:zh,unstable_useId:Bq,unsupportedProp:_ue,useControlled:WE,useEventCallback:lg,useForkRef:ns,useIsFocusVisible:Uq},Symbol.toStringTag,{value:"Module"}));function WL(n,e){return WL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,s){return o.__proto__=s,o},WL(n,e)}function bX(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,WL(n,e)}const D7={disabled:!1},$E=$l.createContext(null);var jfe=function(e){return e.scrollTop},Cb="unmounted",Xm="exited",Ym="entering",a0="entered",VL="exiting",Gh=function(n){bX(e,n);function e(o,s){var c;c=n.call(this,o,s)||this;var d=s,f=d&&!d.isMounting?o.enter:o.appear,m;return c.appearStatus=null,o.in?f?(m=Xm,c.appearStatus=Ym):m=a0:o.unmountOnExit||o.mountOnEnter?m=Cb:m=Xm,c.state={status:m},c.nextCallback=null,c}e.getDerivedStateFromProps=function(s,c){var d=s.in;return d&&c.status===Cb?{status:Xm}:null};var a=e.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(s){var c=null;if(s!==this.props){var d=this.state.status;this.props.in?d!==Ym&&d!==a0&&(c=Ym):(d===Ym||d===a0)&&(c=VL)}this.updateStatus(!1,c)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var s=this.props.timeout,c,d,f;return c=d=f=s,s!=null&&typeof s!="number"&&(c=s.exit,d=s.enter,f=s.appear!==void 0?s.appear:d),{exit:c,enter:d,appear:f}},a.updateStatus=function(s,c){if(s===void 0&&(s=!1),c!==null)if(this.cancelNextCallback(),c===Ym){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:Tb.findDOMNode(this);d&&jfe(d)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Xm&&this.setState({status:Cb})},a.performEnter=function(s){var c=this,d=this.props.enter,f=this.context?this.context.isMounting:s,m=this.props.nodeRef?[f]:[Tb.findDOMNode(this),f],y=m[0],_=m[1],x=this.getTimeouts(),S=f?x.appear:x.enter;if(!s&&!d||D7.disabled){this.safeSetState({status:a0},function(){c.props.onEntered(y)});return}this.props.onEnter(y,_),this.safeSetState({status:Ym},function(){c.props.onEntering(y,_),c.onTransitionEnd(S,function(){c.safeSetState({status:a0},function(){c.props.onEntered(y,_)})})})},a.performExit=function(){var s=this,c=this.props.exit,d=this.getTimeouts(),f=this.props.nodeRef?void 0:Tb.findDOMNode(this);if(!c||D7.disabled){this.safeSetState({status:Xm},function(){s.props.onExited(f)});return}this.props.onExit(f),this.safeSetState({status:VL},function(){s.props.onExiting(f),s.onTransitionEnd(d.exit,function(){s.safeSetState({status:Xm},function(){s.props.onExited(f)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(s,c){c=this.setNextCallback(c),this.setState(s,c)},a.setNextCallback=function(s){var c=this,d=!0;return this.nextCallback=function(f){d&&(d=!1,c.nextCallback=null,s(f))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},a.onTransitionEnd=function(s,c){this.setNextCallback(c);var d=this.props.nodeRef?this.props.nodeRef.current:Tb.findDOMNode(this),f=s==null&&!this.props.addEndListener;if(!d||f){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var m=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],y=m[0],_=m[1];this.props.addEndListener(y,_)}s!=null&&setTimeout(this.nextCallback,s)},a.render=function(){var s=this.state.status;if(s===Cb)return null;var c=this.props,d=c.children;c.in,c.mountOnEnter,c.unmountOnExit,c.appear,c.enter,c.exit,c.timeout,c.addEndListener,c.onEnter,c.onEntering,c.onEntered,c.onExit,c.onExiting,c.onExited,c.nodeRef;var f=ya(c,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return $l.createElement($E.Provider,{value:null},typeof d=="function"?d(s,f):$l.cloneElement($l.Children.only(d),f))},e}($l.Component);Gh.contextType=$E;Gh.propTypes={};function Pv(){}Gh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Pv,onEntering:Pv,onEntered:Pv,onExit:Pv,onExiting:Pv,onExited:Pv};Gh.UNMOUNTED=Cb;Gh.EXITED=Xm;Gh.ENTERING=Ym;Gh.ENTERED=a0;Gh.EXITING=VL;const ID=Gh;function $fe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function LD(n,e){var a=function(c){return e&&re.isValidElement(c)?e(c):c},o=Object.create(null);return n&&re.Children.map(n,function(s){return s}).forEach(function(s){o[s.key]=a(s)}),o}function qfe(n,e){n=n||{},e=e||{};function a(_){return _ in e?e[_]:n[_]}var o=Object.create(null),s=[];for(var c in n)c in e?s.length&&(o[c]=s,s=[]):s.push(c);var d,f={};for(var m in e){if(o[m])for(d=0;d<o[m].length;d++){var y=o[m][d];f[o[m][d]]=a(y)}f[m]=a(m)}for(d=0;d<s.length;d++)f[s[d]]=a(s[d]);return f}function cg(n,e,a){return a[e]!=null?a[e]:n.props[e]}function Xfe(n,e){return LD(n.children,function(a){return re.cloneElement(a,{onExited:e.bind(null,a),in:!0,appear:cg(a,"appear",n),enter:cg(a,"enter",n),exit:cg(a,"exit",n)})})}function Yfe(n,e,a){var o=LD(n.children),s=qfe(e,o);return Object.keys(s).forEach(function(c){var d=s[c];if(re.isValidElement(d)){var f=c in e,m=c in o,y=e[c],_=re.isValidElement(y)&&!y.props.in;m&&(!f||_)?s[c]=re.cloneElement(d,{onExited:a.bind(null,d),in:!0,exit:cg(d,"exit",n),enter:cg(d,"enter",n)}):!m&&f&&!_?s[c]=re.cloneElement(d,{in:!1}):m&&f&&re.isValidElement(y)&&(s[c]=re.cloneElement(d,{onExited:a.bind(null,d),in:y.props.in,exit:cg(d,"exit",n),enter:cg(d,"enter",n)}))}}),s}var Zfe=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},Kfe={component:"div",childFactory:function(e){return e}},RD=function(n){bX(e,n);function e(o,s){var c;c=n.call(this,o,s)||this;var d=c.handleExited.bind($fe(c));return c.state={contextValue:{isMounting:!0},handleExited:d,firstRender:!0},c}var a=e.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,c){var d=c.children,f=c.handleExited,m=c.firstRender;return{children:m?Xfe(s,f):Yfe(s,d,f),firstRender:!1}},a.handleExited=function(s,c){var d=LD(this.props.children);s.key in d||(s.props.onExited&&s.props.onExited(c),this.mounted&&this.setState(function(f){var m=rt({},f.children);return delete m[s.key],{children:m}}))},a.render=function(){var s=this.props,c=s.component,d=s.childFactory,f=ya(s,["component","childFactory"]),m=this.state.contextValue,y=Zfe(this.state.children).map(d);return delete f.appear,delete f.enter,delete f.exit,c===null?$l.createElement($E.Provider,{value:m},y):$l.createElement($E.Provider,{value:m},$l.createElement(c,f,y))},e}($l.Component);RD.propTypes={};RD.defaultProps=Kfe;const Jfe=RD,kD=n=>n.scrollTop;function Y0(n,e){var a,o;const{timeout:s,easing:c,style:d={}}=n;return{duration:(a=d.transitionDuration)!=null?a:typeof s=="number"?s:s[e.mode]||0,easing:(o=d.transitionTimingFunction)!=null?o:typeof c=="object"?c[e.mode]:c,delay:d.transitionDelay}}function Qfe(n){return nr("MuiPaper",n)}Bi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const epe=["className","component","elevation","square","variant"],tpe=n=>{const{square:e,elevation:a,variant:o,classes:s}=n,c={root:["root",o,!e&&"rounded",o==="elevation"&&`elevation${a}`]};return hr(c,Qfe,s)},npe=ca("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[a.variant],!a.square&&e.rounded,a.variant==="elevation"&&e[`elevation${a.elevation}`]]}})(({theme:n,ownerState:e})=>{var a;return rt({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!e.square&&{borderRadius:n.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.divider}`},e.variant==="elevation"&&rt({boxShadow:(n.vars||n).shadows[e.elevation]},!n.vars&&n.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Qo("#fff",R7(e.elevation))}, ${Qo("#fff",R7(e.elevation))})`},n.vars&&{backgroundImage:(a=n.vars.overlays)==null?void 0:a[e.elevation]}))}),ape=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiPaper"}),{className:s,component:c="div",elevation:d=1,square:f=!1,variant:m="elevation"}=o,y=ya(o,epe),_=rt({},o,{component:c,elevation:d,square:f,variant:m}),x=tpe(_);return ee(npe,rt({as:c,ownerState:_,className:Va(x.root,s),ref:a},y))}),ipe=ape;function rpe(n){const{className:e,classes:a,pulsate:o=!1,rippleX:s,rippleY:c,rippleSize:d,in:f,onExited:m,timeout:y}=n,[_,x]=re.useState(!1),S=Va(e,a.ripple,a.rippleVisible,o&&a.ripplePulsate),T={width:d,height:d,top:-(d/2)+c,left:-(d/2)+s},I=Va(a.child,_&&a.childLeaving,o&&a.childPulsate);return!f&&!_&&x(!0),re.useEffect(()=>{if(!f&&m!=null){const k=setTimeout(m,y);return()=>{clearTimeout(k)}}},[m,f,y]),ee("span",{className:S,style:T,children:ee("span",{className:I})})}const ope=Bi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),_c=ope,spe=["center","classes","className"];let xT=n=>n,O7,z7,F7,N7;const GL=550,lpe=80,cpe=bD(O7||(O7=xT`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),upe=bD(z7||(z7=xT`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),dpe=bD(F7||(F7=xT`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),hpe=ca("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),fpe=ca(rpe,{name:"MuiTouchRipple",slot:"Ripple"})(N7||(N7=xT`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),_c.rippleVisible,cpe,GL,({theme:n})=>n.transitions.easing.easeInOut,_c.ripplePulsate,({theme:n})=>n.transitions.duration.shorter,_c.child,_c.childLeaving,upe,GL,({theme:n})=>n.transitions.easing.easeInOut,_c.childPulsate,dpe,({theme:n})=>n.transitions.easing.easeInOut),ppe=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:c={},className:d}=o,f=ya(o,spe),[m,y]=re.useState([]),_=re.useRef(0),x=re.useRef(null);re.useEffect(()=>{x.current&&(x.current(),x.current=null)},[m]);const S=re.useRef(!1),T=re.useRef(0),I=re.useRef(null),k=re.useRef(null);re.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]);const D=re.useCallback(B=>{const{pulsate:G,rippleX:q,rippleY:X,rippleSize:te,cb:V}=B;y(Q=>[...Q,ee(fpe,{classes:{ripple:Va(c.ripple,_c.ripple),rippleVisible:Va(c.rippleVisible,_c.rippleVisible),ripplePulsate:Va(c.ripplePulsate,_c.ripplePulsate),child:Va(c.child,_c.child),childLeaving:Va(c.childLeaving,_c.childLeaving),childPulsate:Va(c.childPulsate,_c.childPulsate)},timeout:GL,pulsate:G,rippleX:q,rippleY:X,rippleSize:te},_.current)]),_.current+=1,x.current=V},[c]),L=re.useCallback((B={},G={},q=()=>{})=>{const{pulsate:X=!1,center:te=s||G.pulsate,fakeElement:V=!1}=G;if((B==null?void 0:B.type)==="mousedown"&&S.current){S.current=!1;return}(B==null?void 0:B.type)==="touchstart"&&(S.current=!0);const Q=V?null:k.current,ge=Q?Q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let me,be,fe;if(te||B===void 0||B.clientX===0&&B.clientY===0||!B.clientX&&!B.touches)me=Math.round(ge.width/2),be=Math.round(ge.height/2);else{const{clientX:Ce,clientY:Le}=B.touches&&B.touches.length>0?B.touches[0]:B;me=Math.round(Ce-ge.left),be=Math.round(Le-ge.top)}if(te)fe=Math.sqrt((2*ge.width**2+ge.height**2)/3),fe%2===0&&(fe+=1);else{const Ce=Math.max(Math.abs((Q?Q.clientWidth:0)-me),me)*2+2,Le=Math.max(Math.abs((Q?Q.clientHeight:0)-be),be)*2+2;fe=Math.sqrt(Ce**2+Le**2)}B!=null&&B.touches?I.current===null&&(I.current=()=>{D({pulsate:X,rippleX:me,rippleY:be,rippleSize:fe,cb:q})},T.current=setTimeout(()=>{I.current&&(I.current(),I.current=null)},lpe)):D({pulsate:X,rippleX:me,rippleY:be,rippleSize:fe,cb:q})},[s,D]),O=re.useCallback(()=>{L({},{pulsate:!0})},[L]),F=re.useCallback((B,G)=>{if(clearTimeout(T.current),(B==null?void 0:B.type)==="touchend"&&I.current){I.current(),I.current=null,T.current=setTimeout(()=>{F(B,G)});return}I.current=null,y(q=>q.length>0?q.slice(1):q),x.current=G},[]);return re.useImperativeHandle(a,()=>({pulsate:O,start:L,stop:F}),[O,L,F]),ee(hpe,rt({className:Va(_c.root,c.root,d),ref:k},f,{children:ee(Jfe,{component:null,exit:!0,children:m})}))}),mpe=ppe;function gpe(n){return nr("MuiButtonBase",n)}const ype=Bi("MuiButtonBase",["root","disabled","focusVisible"]),vpe=ype,_pe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],bpe=n=>{const{disabled:e,focusVisible:a,focusVisibleClassName:o,classes:s}=n,d=hr({root:["root",e&&"disabled",a&&"focusVisible"]},gpe,s);return a&&o&&(d.root+=` ${o}`),d},xpe=ca("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${vpe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),wpe=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:c=!1,children:d,className:f,component:m="button",disabled:y=!1,disableRipple:_=!1,disableTouchRipple:x=!1,focusRipple:S=!1,LinkComponent:T="a",onBlur:I,onClick:k,onContextMenu:D,onDragLeave:L,onFocus:O,onFocusVisible:F,onKeyDown:B,onKeyUp:G,onMouseDown:q,onMouseLeave:X,onMouseUp:te,onTouchEnd:V,onTouchMove:Q,onTouchStart:ge,tabIndex:me=0,TouchRippleProps:be,touchRippleRef:fe,type:Ce}=o,Le=ya(o,_pe),Ge=re.useRef(null),le=re.useRef(null),pe=ns(le,fe),{isFocusVisibleRef:Ae,onFocus:ae,onBlur:Ee,ref:Ze}=Uq(),[Xe,Ke]=re.useState(!1);y&&Xe&&Ke(!1),re.useImperativeHandle(s,()=>({focusVisible:()=>{Ke(!0),Ge.current.focus()}}),[]);const[Ue,ft]=re.useState(!1);re.useEffect(()=>{ft(!0)},[]);const Rt=Ue&&!_&&!y;re.useEffect(()=>{Xe&&S&&!_&&Ue&&le.current.pulsate()},[_,S,Xe,Ue]);function kt(Et,Ut,Vt=x){return lg($t=>(Ut&&Ut($t),!Vt&&le.current&&le.current[Et]($t),!0))}const Jt=kt("start",q),It=kt("stop",D),Pe=kt("stop",L),pt=kt("stop",te),yt=kt("stop",Et=>{Xe&&Et.preventDefault(),X&&X(Et)}),At=kt("start",ge),Be=kt("stop",V),ue=kt("stop",Q),se=kt("stop",Et=>{Ee(Et),Ae.current===!1&&Ke(!1),I&&I(Et)},!1),ve=lg(Et=>{Ge.current||(Ge.current=Et.currentTarget),ae(Et),Ae.current===!0&&(Ke(!0),F&&F(Et)),O&&O(Et)}),$e=()=>{const Et=Ge.current;return m&&m!=="button"&&!(Et.tagName==="A"&&Et.href)},De=re.useRef(!1),st=lg(Et=>{S&&!De.current&&Xe&&le.current&&Et.key===" "&&(De.current=!0,le.current.stop(Et,()=>{le.current.start(Et)})),Et.target===Et.currentTarget&&$e()&&Et.key===" "&&Et.preventDefault(),B&&B(Et),Et.target===Et.currentTarget&&$e()&&Et.key==="Enter"&&!y&&(Et.preventDefault(),k&&k(Et))}),de=lg(Et=>{S&&Et.key===" "&&le.current&&Xe&&!Et.defaultPrevented&&(De.current=!1,le.current.stop(Et,()=>{le.current.pulsate(Et)})),G&&G(Et),k&&Et.target===Et.currentTarget&&$e()&&Et.key===" "&&!Et.defaultPrevented&&k(Et)});let ne=m;ne==="button"&&(Le.href||Le.to)&&(ne=T);const Oe={};ne==="button"?(Oe.type=Ce===void 0?"button":Ce,Oe.disabled=y):(!Le.href&&!Le.to&&(Oe.role="button"),y&&(Oe["aria-disabled"]=y));const mt=ns(a,Ze,Ge),ot=rt({},o,{centerRipple:c,component:m,disabled:y,disableRipple:_,disableTouchRipple:x,focusRipple:S,tabIndex:me,focusVisible:Xe}),lt=bpe(ot);return Je(xpe,rt({as:ne,className:Va(lt.root,f),ownerState:ot,onBlur:se,onClick:k,onContextMenu:It,onFocus:ve,onKeyDown:st,onKeyUp:de,onMouseDown:Jt,onMouseLeave:yt,onMouseUp:pt,onDragLeave:Pe,onTouchEnd:Be,onTouchMove:ue,onTouchStart:At,ref:mt,tabIndex:y?-1:me,type:Ce},Oe,Le,{children:[d,Rt?ee(mpe,rt({ref:pe,center:c},be)):null]}))}),wT=wpe;function Spe(n){return nr("MuiTypography",n)}Bi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Ape=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Epe=n=>{const{align:e,gutterBottom:a,noWrap:o,paragraph:s,variant:c,classes:d}=n,f={root:["root",c,n.align!=="inherit"&&`align${xa(e)}`,a&&"gutterBottom",o&&"noWrap",s&&"paragraph"]};return hr(f,Spe,d)},Mpe=ca("span",{name:"MuiTypography",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.variant&&e[a.variant],a.align!=="inherit"&&e[`align${xa(a.align)}`],a.noWrap&&e.noWrap,a.gutterBottom&&e.gutterBottom,a.paragraph&&e.paragraph]}})(({theme:n,ownerState:e})=>rt({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&n.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),B7={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Tpe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Cpe=n=>Tpe[n]||n,Ppe=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiTypography"}),s=Cpe(o.color),c=Bhe(rt({},o,{color:s})),{align:d="inherit",className:f,component:m,gutterBottom:y=!1,noWrap:_=!1,paragraph:x=!1,variant:S="body1",variantMapping:T=B7}=c,I=ya(c,Ape),k=rt({},c,{align:d,color:s,className:f,component:m,gutterBottom:y,noWrap:_,paragraph:x,variant:S,variantMapping:T}),D=m||(x?"p":T[S]||B7[S])||"span",L=Epe(k);return ee(Mpe,rt({as:D,ref:a,ownerState:k,className:Va(L.root,f)},I))}),Ha=Ppe;function qE(n){return typeof n=="string"}function Ipe(n,e,a){return n===void 0||qE(n)?e:rt({},e,{ownerState:rt({},e.ownerState,a)})}function xX(n,e=[]){if(n===void 0)return{};const a={};return Object.keys(n).filter(o=>o.match(/^on[A-Z]/)&&typeof n[o]=="function"&&!e.includes(o)).forEach(o=>{a[o]=n[o]}),a}function Lpe(n,e,a){return typeof n=="function"?n(e,a):n}function U7(n){if(n===void 0)return{};const e={};return Object.keys(n).filter(a=>!(a.match(/^on[A-Z]/)&&typeof n[a]=="function")).forEach(a=>{e[a]=n[a]}),e}function Rpe(n){const{getSlotProps:e,additionalProps:a,externalSlotProps:o,externalForwardedProps:s,className:c}=n;if(!e){const T=Va(a==null?void 0:a.className,c,s==null?void 0:s.className,o==null?void 0:o.className),I=rt({},a==null?void 0:a.style,s==null?void 0:s.style,o==null?void 0:o.style),k=rt({},a,s,o);return T.length>0&&(k.className=T),Object.keys(I).length>0&&(k.style=I),{props:k,internalRef:void 0}}const d=xX(rt({},s,o)),f=U7(o),m=U7(s),y=e(d),_=Va(y==null?void 0:y.className,a==null?void 0:a.className,c,s==null?void 0:s.className,o==null?void 0:o.className),x=rt({},y==null?void 0:y.style,a==null?void 0:a.style,s==null?void 0:s.style,o==null?void 0:o.style),S=rt({},y,a,m,f);return _.length>0&&(S.className=_),Object.keys(x).length>0&&(S.style=x),{props:S,internalRef:y.ref}}const kpe=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Z0(n){var e;const{elementType:a,externalSlotProps:o,ownerState:s,skipResolvingSlotProps:c=!1}=n,d=ya(n,kpe),f=c?{}:Lpe(o,s),{props:m,internalRef:y}=Rpe(rt({},d,{externalSlotProps:f})),_=ns(y,f==null?void 0:f.ref,(e=n.additionalProps)==null?void 0:e.ref);return Ipe(a,rt({},m,{ref:_}),s)}const Dpe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Ope(n){const e=parseInt(n.getAttribute("tabindex")||"",10);return Number.isNaN(e)?n.contentEditable==="true"||(n.nodeName==="AUDIO"||n.nodeName==="VIDEO"||n.nodeName==="DETAILS")&&n.getAttribute("tabindex")===null?0:n.tabIndex:e}function zpe(n){if(n.tagName!=="INPUT"||n.type!=="radio"||!n.name)return!1;const e=o=>n.ownerDocument.querySelector(`input[type="radio"]${o}`);let a=e(`[name="${n.name}"]:checked`);return a||(a=e(`[name="${n.name}"]`)),a!==n}function Fpe(n){return!(n.disabled||n.tagName==="INPUT"&&n.type==="hidden"||zpe(n))}function Npe(n){const e=[],a=[];return Array.from(n.querySelectorAll(Dpe)).forEach((o,s)=>{const c=Ope(o);c===-1||!Fpe(o)||(c===0?e.push(o):a.push({documentOrder:s,tabIndex:c,node:o}))}),a.sort((o,s)=>o.tabIndex===s.tabIndex?o.documentOrder-s.documentOrder:o.tabIndex-s.tabIndex).map(o=>o.node).concat(e)}function Bpe(){return!0}function Upe(n){const{children:e,disableAutoFocus:a=!1,disableEnforceFocus:o=!1,disableRestoreFocus:s=!1,getTabbable:c=Npe,isEnabled:d=Bpe,open:f}=n,m=re.useRef(!1),y=re.useRef(null),_=re.useRef(null),x=re.useRef(null),S=re.useRef(null),T=re.useRef(!1),I=re.useRef(null),k=ns(e.ref,I),D=re.useRef(null);re.useEffect(()=>{!f||!I.current||(T.current=!a)},[a,f]),re.useEffect(()=>{if(!f||!I.current)return;const F=Sl(I.current);return I.current.contains(F.activeElement)||(I.current.hasAttribute("tabIndex")||I.current.setAttribute("tabIndex","-1"),T.current&&I.current.focus()),()=>{s||(x.current&&x.current.focus&&(m.current=!0,x.current.focus()),x.current=null)}},[f]),re.useEffect(()=>{if(!f||!I.current)return;const F=Sl(I.current),B=X=>{D.current=X,!(o||!d()||X.key!=="Tab")&&F.activeElement===I.current&&X.shiftKey&&(m.current=!0,_.current&&_.current.focus())},G=()=>{const X=I.current;if(X===null)return;if(!F.hasFocus()||!d()||m.current){m.current=!1;return}if(X.contains(F.activeElement)||o&&F.activeElement!==y.current&&F.activeElement!==_.current)return;if(F.activeElement!==S.current)S.current=null;else if(S.current!==null)return;if(!T.current)return;let te=[];if((F.activeElement===y.current||F.activeElement===_.current)&&(te=c(I.current)),te.length>0){var V,Q;const ge=!!((V=D.current)!=null&&V.shiftKey&&((Q=D.current)==null?void 0:Q.key)==="Tab"),me=te[0],be=te[te.length-1];typeof me!="string"&&typeof be!="string"&&(ge?be.focus():me.focus())}else X.focus()};F.addEventListener("focusin",G),F.addEventListener("keydown",B,!0);const q=setInterval(()=>{F.activeElement&&F.activeElement.tagName==="BODY"&&G()},50);return()=>{clearInterval(q),F.removeEventListener("focusin",G),F.removeEventListener("keydown",B,!0)}},[a,o,s,d,f,c]);const L=F=>{x.current===null&&(x.current=F.relatedTarget),T.current=!0,S.current=F.target;const B=e.props.onFocus;B&&B(F)},O=F=>{x.current===null&&(x.current=F.relatedTarget),T.current=!0};return Je(re.Fragment,{children:[ee("div",{tabIndex:f?0:-1,onFocus:O,ref:y,"data-testid":"sentinelStart"}),re.cloneElement(e,{ref:k,onFocus:L}),ee("div",{tabIndex:f?0:-1,onFocus:O,ref:_,"data-testid":"sentinelEnd"})]})}function Wpe(n){return typeof n=="function"?n():n}const Vpe=re.forwardRef(function(e,a){const{children:o,container:s,disablePortal:c=!1}=e,[d,f]=re.useState(null),m=ns(re.isValidElement(o)?o.ref:null,a);if(zh(()=>{c||f(Wpe(s)||document.body)},[s,c]),zh(()=>{if(d&&!c)return UE(a,d),()=>{UE(a,null)}},[a,d,c]),c){if(re.isValidElement(o)){const y={ref:m};return re.cloneElement(o,y)}return ee(re.Fragment,{children:o})}return ee(re.Fragment,{children:d&&ww.createPortal(o,d)})});function Gpe(n){const e=Sl(n);return e.body===n?gd(n).innerWidth>e.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function Zb(n,e){e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function W7(n){return parseInt(gd(n).getComputedStyle(n).paddingRight,10)||0}function Hpe(n){const a=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(n.tagName)!==-1,o=n.tagName==="INPUT"&&n.getAttribute("type")==="hidden";return a||o}function V7(n,e,a,o,s){const c=[e,a,...o];[].forEach.call(n.children,d=>{const f=c.indexOf(d)===-1,m=!Hpe(d);f&&m&&Zb(d,s)})}function p4(n,e){let a=-1;return n.some((o,s)=>e(o)?(a=s,!0):!1),a}function jpe(n,e){const a=[],o=n.container;if(!e.disableScrollLock){if(Gpe(o)){const d=Wq(Sl(o));a.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight=`${W7(o)+d}px`;const f=Sl(o).querySelectorAll(".mui-fixed");[].forEach.call(f,m=>{a.push({value:m.style.paddingRight,property:"padding-right",el:m}),m.style.paddingRight=`${W7(m)+d}px`})}let c;if(o.parentNode instanceof DocumentFragment)c=Sl(o).body;else{const d=o.parentElement,f=gd(o);c=(d==null?void 0:d.nodeName)==="HTML"&&f.getComputedStyle(d).overflowY==="scroll"?d:o}a.push({value:c.style.overflow,property:"overflow",el:c},{value:c.style.overflowX,property:"overflow-x",el:c},{value:c.style.overflowY,property:"overflow-y",el:c}),c.style.overflow="hidden"}return()=>{a.forEach(({value:c,el:d,property:f})=>{c?d.style.setProperty(f,c):d.style.removeProperty(f)})}}function $pe(n){const e=[];return[].forEach.call(n.children,a=>{a.getAttribute("aria-hidden")==="true"&&e.push(a)}),e}class qpe{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,a){let o=this.modals.indexOf(e);if(o!==-1)return o;o=this.modals.length,this.modals.push(e),e.modalRef&&Zb(e.modalRef,!1);const s=$pe(a);V7(a,e.mount,e.modalRef,s,!0);const c=p4(this.containers,d=>d.container===a);return c!==-1?(this.containers[c].modals.push(e),o):(this.containers.push({modals:[e],container:a,restore:null,hiddenSiblings:s}),o)}mount(e,a){const o=p4(this.containers,c=>c.modals.indexOf(e)!==-1),s=this.containers[o];s.restore||(s.restore=jpe(s,a))}remove(e,a=!0){const o=this.modals.indexOf(e);if(o===-1)return o;const s=p4(this.containers,d=>d.modals.indexOf(e)!==-1),c=this.containers[s];if(c.modals.splice(c.modals.indexOf(e),1),this.modals.splice(o,1),c.modals.length===0)c.restore&&c.restore(),e.modalRef&&Zb(e.modalRef,a),V7(c.container,e.mount,e.modalRef,c.hiddenSiblings,!1),this.containers.splice(s,1);else{const d=c.modals[c.modals.length-1];d.modalRef&&Zb(d.modalRef,!1)}return o}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function Xpe(n){return typeof n=="function"?n():n}function Ype(n){return n?n.props.hasOwnProperty("in"):!1}const Zpe=new qpe;function Kpe(n){const{container:e,disableEscapeKeyDown:a=!1,disableScrollLock:o=!1,manager:s=Zpe,closeAfterTransition:c=!1,onTransitionEnter:d,onTransitionExited:f,children:m,onClose:y,open:_,rootRef:x}=n,S=re.useRef({}),T=re.useRef(null),I=re.useRef(null),k=ns(I,x),[D,L]=re.useState(!_),O=Ype(m);let F=!0;(n["aria-hidden"]==="false"||n["aria-hidden"]===!1)&&(F=!1);const B=()=>Sl(T.current),G=()=>(S.current.modalRef=I.current,S.current.mount=T.current,S.current),q=()=>{s.mount(G(),{disableScrollLock:o}),I.current&&(I.current.scrollTop=0)},X=lg(()=>{const Le=Xpe(e)||B().body;s.add(G(),Le),I.current&&q()}),te=re.useCallback(()=>s.isTopModal(G()),[s]),V=lg(Le=>{T.current=Le,Le&&(_&&te()?q():I.current&&Zb(I.current,F))}),Q=re.useCallback(()=>{s.remove(G(),F)},[F,s]);re.useEffect(()=>()=>{Q()},[Q]),re.useEffect(()=>{_?X():(!O||!c)&&Q()},[_,Q,O,c,X]);const ge=Le=>Ge=>{var le;(le=Le.onKeyDown)==null||le.call(Le,Ge),!(Ge.key!=="Escape"||Ge.which===229||!te())&&(a||(Ge.stopPropagation(),y&&y(Ge,"escapeKeyDown")))},me=Le=>Ge=>{var le;(le=Le.onClick)==null||le.call(Le,Ge),Ge.target===Ge.currentTarget&&y&&y(Ge,"backdropClick")};return{getRootProps:(Le={})=>{const Ge=xX(n);delete Ge.onTransitionEnter,delete Ge.onTransitionExited;const le=rt({},Ge,Le);return rt({role:"presentation"},le,{onKeyDown:ge(le),ref:k})},getBackdropProps:(Le={})=>{const Ge=Le;return rt({"aria-hidden":!0},Ge,{onClick:me(Ge),open:_})},getTransitionProps:()=>{const Le=()=>{L(!1),d&&d()},Ge=()=>{L(!0),f&&f(),c&&Q()};return{onEnter:zL(Le,m==null?void 0:m.props.onEnter),onExited:zL(Ge,m==null?void 0:m.props.onExited)}},rootRef:k,portalRef:V,isTopModal:te,exited:D,hasTransition:O}}const Jpe=["onChange","maxRows","minRows","style","value"];function lS(n){return parseInt(n,10)||0}const Qpe={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function G7(n){return n==null||Object.keys(n).length===0||n.outerHeightStyle===0&&!n.overflow}const eme=re.forwardRef(function(e,a){const{onChange:o,maxRows:s,minRows:c=1,style:d,value:f}=e,m=ya(e,Jpe),{current:y}=re.useRef(f!=null),_=re.useRef(null),x=ns(a,_),S=re.useRef(null),T=re.useRef(0),[I,k]=re.useState({outerHeightStyle:0}),D=re.useCallback(()=>{const B=_.current,q=gd(B).getComputedStyle(B);if(q.width==="0px")return{outerHeightStyle:0};const X=S.current;X.style.width=q.width,X.value=B.value||e.placeholder||"x",X.value.slice(-1)===`
`&&(X.value+=" ");const te=q.boxSizing,V=lS(q.paddingBottom)+lS(q.paddingTop),Q=lS(q.borderBottomWidth)+lS(q.borderTopWidth),ge=X.scrollHeight;X.value="x";const me=X.scrollHeight;let be=ge;c&&(be=Math.max(Number(c)*me,be)),s&&(be=Math.min(Number(s)*me,be)),be=Math.max(be,me);const fe=be+(te==="border-box"?V+Q:0),Ce=Math.abs(be-ge)<=1;return{outerHeightStyle:fe,overflow:Ce}},[s,c,e.placeholder]),L=(B,G)=>{const{outerHeightStyle:q,overflow:X}=G;return T.current<20&&(q>0&&Math.abs((B.outerHeightStyle||0)-q)>1||B.overflow!==X)?(T.current+=1,{overflow:X,outerHeightStyle:q}):B},O=re.useCallback(()=>{const B=D();G7(B)||k(G=>L(G,B))},[D]);zh(()=>{const B=()=>{const ge=D();G7(ge)||ww.flushSync(()=>{k(me=>L(me,ge))})},G=()=>{T.current=0,B()};let q;const X=XM(G),te=_.current,V=gd(te);V.addEventListener("resize",X);let Q;return typeof ResizeObserver<"u"&&(Q=new ResizeObserver(G),Q.observe(te)),()=>{X.clear(),cancelAnimationFrame(q),V.removeEventListener("resize",X),Q&&Q.disconnect()}},[D]),zh(()=>{O()}),re.useEffect(()=>{T.current=0},[f]);const F=B=>{T.current=0,y||O(),o&&o(B)};return Je(re.Fragment,{children:[ee("textarea",rt({value:f,onChange:F,ref:x,rows:c,style:rt({height:I.outerHeightStyle,overflow:I.overflow?"hidden":void 0},d)},m)),ee("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:S,tabIndex:-1,style:rt({},Qpe.shadow,d,{paddingTop:0,paddingBottom:0})})]})});function Pw({props:n,states:e,muiFormControl:a}){return e.reduce((o,s)=>(o[s]=n[s],a&&typeof n[s]>"u"&&(o[s]=a[s]),o),{})}const tme=re.createContext(void 0),DD=tme;function m_(){return re.useContext(DD)}function nme(n){return ee(zhe,rt({},n,{defaultTheme:bT,themeId:q0}))}function H7(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function XE(n,e=!1){return n&&(H7(n.value)&&n.value!==""||e&&H7(n.defaultValue)&&n.defaultValue!=="")}function ame(n){return n.startAdornment}function ime(n){return nr("MuiInputBase",n)}const rme=Bi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),K0=rme,ome=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],ST=(n,e)=>{const{ownerState:a}=n;return[e.root,a.formControl&&e.formControl,a.startAdornment&&e.adornedStart,a.endAdornment&&e.adornedEnd,a.error&&e.error,a.size==="small"&&e.sizeSmall,a.multiline&&e.multiline,a.color&&e[`color${xa(a.color)}`],a.fullWidth&&e.fullWidth,a.hiddenLabel&&e.hiddenLabel]},AT=(n,e)=>{const{ownerState:a}=n;return[e.input,a.size==="small"&&e.inputSizeSmall,a.multiline&&e.inputMultiline,a.type==="search"&&e.inputTypeSearch,a.startAdornment&&e.inputAdornedStart,a.endAdornment&&e.inputAdornedEnd,a.hiddenLabel&&e.inputHiddenLabel]},sme=n=>{const{classes:e,color:a,disabled:o,error:s,endAdornment:c,focused:d,formControl:f,fullWidth:m,hiddenLabel:y,multiline:_,readOnly:x,size:S,startAdornment:T,type:I}=n,k={root:["root",`color${xa(a)}`,o&&"disabled",s&&"error",m&&"fullWidth",d&&"focused",f&&"formControl",S&&S!=="medium"&&`size${xa(S)}`,_&&"multiline",T&&"adornedStart",c&&"adornedEnd",y&&"hiddenLabel",x&&"readOnly"],input:["input",o&&"disabled",I==="search"&&"inputTypeSearch",_&&"inputMultiline",S==="small"&&"inputSizeSmall",y&&"inputHiddenLabel",T&&"inputAdornedStart",c&&"inputAdornedEnd",x&&"readOnly"]};return hr(k,ime,e)},ET=ca("div",{name:"MuiInputBase",slot:"Root",overridesResolver:ST})(({theme:n,ownerState:e})=>rt({},n.typography.body1,{color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${K0.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"}},e.multiline&&rt({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),MT=ca("input",{name:"MuiInputBase",slot:"Input",overridesResolver:AT})(({theme:n,ownerState:e})=>{const a=n.palette.mode==="light",o=rt({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),s={opacity:"0 !important"},c=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5};return rt({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${K0.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":c,"&:focus::-moz-placeholder":c,"&:focus:-ms-input-placeholder":c,"&:focus::-ms-input-placeholder":c},[`&.${K0.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),lme=ee(nme,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),cme=re.forwardRef(function(e,a){var o;const s=br({props:e,name:"MuiInputBase"}),{"aria-describedby":c,autoComplete:d,autoFocus:f,className:m,components:y={},componentsProps:_={},defaultValue:x,disabled:S,disableInjectingGlobalStyles:T,endAdornment:I,fullWidth:k=!1,id:D,inputComponent:L="input",inputProps:O={},inputRef:F,maxRows:B,minRows:G,multiline:q=!1,name:X,onBlur:te,onChange:V,onClick:Q,onFocus:ge,onKeyDown:me,onKeyUp:be,placeholder:fe,readOnly:Ce,renderSuffix:Le,rows:Ge,slotProps:le={},slots:pe={},startAdornment:Ae,type:ae="text",value:Ee}=s,Ze=ya(s,ome),Xe=O.value!=null?O.value:Ee,{current:Ke}=re.useRef(Xe!=null),Ue=re.useRef(),ft=re.useCallback(lt=>{},[]),Rt=ns(Ue,F,O.ref,ft),[kt,Jt]=re.useState(!1),It=m_(),Pe=Pw({props:s,muiFormControl:It,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Pe.focused=It?It.focused:kt,re.useEffect(()=>{!It&&S&&kt&&(Jt(!1),te&&te())},[It,S,kt,te]);const pt=It&&It.onFilled,yt=It&&It.onEmpty,At=re.useCallback(lt=>{XE(lt)?pt&&pt():yt&&yt()},[pt,yt]);zh(()=>{Ke&&At({value:Xe})},[Xe,At,Ke]);const Be=lt=>{if(Pe.disabled){lt.stopPropagation();return}ge&&ge(lt),O.onFocus&&O.onFocus(lt),It&&It.onFocus?It.onFocus(lt):Jt(!0)},ue=lt=>{te&&te(lt),O.onBlur&&O.onBlur(lt),It&&It.onBlur?It.onBlur(lt):Jt(!1)},se=(lt,...Et)=>{if(!Ke){const Ut=lt.target||Ue.current;if(Ut==null)throw new Error(yp(1));At({value:Ut.value})}O.onChange&&O.onChange(lt,...Et),V&&V(lt,...Et)};re.useEffect(()=>{At(Ue.current)},[]);const ve=lt=>{Ue.current&&lt.currentTarget===lt.target&&Ue.current.focus(),Q&&Q(lt)};let $e=L,De=O;q&&$e==="input"&&(Ge?De=rt({type:void 0,minRows:Ge,maxRows:Ge},De):De=rt({type:void 0,maxRows:B,minRows:G},De),$e=eme);const st=lt=>{At(lt.animationName==="mui-auto-fill-cancel"?Ue.current:{value:"x"})};re.useEffect(()=>{It&&It.setAdornedStart(!!Ae)},[It,Ae]);const de=rt({},s,{color:Pe.color||"primary",disabled:Pe.disabled,endAdornment:I,error:Pe.error,focused:Pe.focused,formControl:It,fullWidth:k,hiddenLabel:Pe.hiddenLabel,multiline:q,size:Pe.size,startAdornment:Ae,type:ae}),ne=sme(de),Oe=pe.root||y.Root||ET,mt=le.root||_.root||{},ot=pe.input||y.Input||MT;return De=rt({},De,(o=le.input)!=null?o:_.input),Je(re.Fragment,{children:[!T&&lme,Je(Oe,rt({},mt,!qE(Oe)&&{ownerState:rt({},de,mt.ownerState)},{ref:a,onClick:ve},Ze,{className:Va(ne.root,mt.className,m,Ce&&"MuiInputBase-readOnly"),children:[Ae,ee(DD.Provider,{value:null,children:ee(ot,rt({ownerState:de,"aria-invalid":Pe.error,"aria-describedby":c,autoComplete:d,autoFocus:f,defaultValue:x,disabled:Pe.disabled,id:D,onAnimationStart:st,name:X,placeholder:fe,readOnly:Ce,required:Pe.required,rows:Ge,value:Xe,onKeyDown:me,onKeyUp:be,type:ae},De,!qE(ot)&&{as:$e,ownerState:rt({},de,De.ownerState)},{ref:Rt,className:Va(ne.input,De.className,Ce&&"MuiInputBase-readOnly"),onBlur:ue,onChange:se,onFocus:Be}))}),I,Le?Le(rt({},Pe,{startAdornment:Ae})):null]}))]})}),OD=cme;function ume(n){return nr("MuiInput",n)}const dme=rt({},K0,Bi("MuiInput",["root","underline","input"])),J1=dme;function hme(n){return nr("MuiOutlinedInput",n)}const fme=rt({},K0,Bi("MuiOutlinedInput",["root","notchedOutline","input"])),kf=fme;function pme(n){return nr("MuiFilledInput",n)}const mme=rt({},K0,Bi("MuiFilledInput",["root","underline","input"])),Lm=mme,gme=Cw(ee("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),yme=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],vme={entering:{opacity:1},entered:{opacity:1}},_me=re.forwardRef(function(e,a){const o=p_(),s={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:c,appear:d=!0,children:f,easing:m,in:y,onEnter:_,onEntered:x,onEntering:S,onExit:T,onExited:I,onExiting:k,style:D,timeout:L=s,TransitionComponent:O=ID}=e,F=ya(e,yme),B=re.useRef(null),G=ns(B,f.ref,a),q=fe=>Ce=>{if(fe){const Le=B.current;Ce===void 0?fe(Le):fe(Le,Ce)}},X=q(S),te=q((fe,Ce)=>{kD(fe);const Le=Y0({style:D,timeout:L,easing:m},{mode:"enter"});fe.style.webkitTransition=o.transitions.create("opacity",Le),fe.style.transition=o.transitions.create("opacity",Le),_&&_(fe,Ce)}),V=q(x),Q=q(k),ge=q(fe=>{const Ce=Y0({style:D,timeout:L,easing:m},{mode:"exit"});fe.style.webkitTransition=o.transitions.create("opacity",Ce),fe.style.transition=o.transitions.create("opacity",Ce),T&&T(fe)}),me=q(I);return ee(O,rt({appear:d,in:y,nodeRef:B,onEnter:te,onEntered:V,onEntering:X,onExit:ge,onExited:me,onExiting:Q,addEndListener:fe=>{c&&c(B.current,fe)},timeout:L},F,{children:(fe,Ce)=>re.cloneElement(f,rt({style:rt({opacity:0,visibility:fe==="exited"&&!y?"hidden":void 0},vme[fe],D,f.props.style),ref:G},Ce))}))}),bme=_me;function xme(n){return nr("MuiBackdrop",n)}Bi("MuiBackdrop",["root","invisible"]);const wme=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Sme=n=>{const{classes:e,invisible:a}=n;return hr({root:["root",a&&"invisible"]},xme,e)},Ame=ca("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.invisible&&e.invisible]}})(({ownerState:n})=>rt({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},n.invisible&&{backgroundColor:"transparent"})),Eme=re.forwardRef(function(e,a){var o,s,c;const d=br({props:e,name:"MuiBackdrop"}),{children:f,className:m,component:y="div",components:_={},componentsProps:x={},invisible:S=!1,open:T,slotProps:I={},slots:k={},TransitionComponent:D=bme,transitionDuration:L}=d,O=ya(d,wme),F=rt({},d,{component:y,invisible:S}),B=Sme(F),G=(o=I.root)!=null?o:x.root;return ee(D,rt({in:T,timeout:L},O,{children:ee(Ame,rt({"aria-hidden":!0},G,{as:(s=(c=k.root)!=null?c:_.Root)!=null?s:y,className:Va(B.root,m,G==null?void 0:G.className),ownerState:rt({},F,G==null?void 0:G.ownerState),classes:B,ref:a,children:f}))}))}),Mme=Eme;function Tme(n){return nr("MuiButton",n)}const Cme=Bi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),cS=Cme,Pme=re.createContext({}),Ime=Pme,Lme=re.createContext(void 0),Rme=Lme,kme=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Dme=n=>{const{color:e,disableElevation:a,fullWidth:o,size:s,variant:c,classes:d}=n,f={root:["root",c,`${c}${xa(e)}`,`size${xa(s)}`,`${c}Size${xa(s)}`,e==="inherit"&&"colorInherit",a&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${xa(s)}`],endIcon:["endIcon",`iconSize${xa(s)}`]},m=hr(f,Tme,d);return rt({},d,m)},wX=n=>rt({},n.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},n.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},n.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Ome=ca(wT,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[a.variant],e[`${a.variant}${xa(a.color)}`],e[`size${xa(a.size)}`],e[`${a.variant}Size${xa(a.size)}`],a.color==="inherit"&&e.colorInherit,a.disableElevation&&e.disableElevation,a.fullWidth&&e.fullWidth]}})(({theme:n,ownerState:e})=>{var a,o;const s=n.palette.mode==="light"?n.palette.grey[300]:n.palette.grey[800],c=n.palette.mode==="light"?n.palette.grey.A100:n.palette.grey[700];return rt({},n.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":rt({textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(n.vars||n).palette[e.color].main}`,backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:n.vars?n.vars.palette.Button.inheritContainedHoverBg:c,boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2],backgroundColor:(n.vars||n).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(n.vars||n).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[e.color].main}}),"&:active":rt({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[8]}),[`&.${cS.focusVisible}`]:rt({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[6]}),[`&.${cS.disabled}`]:rt({color:(n.vars||n).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main,border:n.vars?`1px solid rgba(${n.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${Qo(n.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:n.vars?n.vars.palette.text.primary:(a=(o=n.palette).getContrastText)==null?void 0:a.call(o,n.palette.grey[300]),backgroundColor:n.vars?n.vars.palette.Button.inheritContainedBg:s,boxShadow:(n.vars||n).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].contrastText,backgroundColor:(n.vars||n).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:n.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:n})=>n.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${cS.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${cS.disabled}`]:{boxShadow:"none"}}),zme=ca("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.startIcon,e[`iconSize${xa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inherit",marginRight:8,marginLeft:-4},n.size==="small"&&{marginLeft:-2},wX(n))),Fme=ca("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.endIcon,e[`iconSize${xa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inherit",marginRight:-4,marginLeft:8},n.size==="small"&&{marginRight:-2},wX(n))),Nme=re.forwardRef(function(e,a){const o=re.useContext(Ime),s=re.useContext(Rme),c=dD(o,e),d=br({props:c,name:"MuiButton"}),{children:f,color:m="primary",component:y="button",className:_,disabled:x=!1,disableElevation:S=!1,disableFocusRipple:T=!1,endIcon:I,focusVisibleClassName:k,fullWidth:D=!1,size:L="medium",startIcon:O,type:F,variant:B="text"}=d,G=ya(d,kme),q=rt({},d,{color:m,component:y,disabled:x,disableElevation:S,disableFocusRipple:T,fullWidth:D,size:L,type:F,variant:B}),X=Dme(q),te=O&&ee(zme,{className:X.startIcon,ownerState:q,children:O}),V=I&&ee(Fme,{className:X.endIcon,ownerState:q,children:I}),Q=s||"";return Je(Ome,rt({ownerState:q,className:Va(o.className,X.root,_,Q),component:y,disabled:x,focusRipple:!T,focusVisibleClassName:Va(X.focusVisible,k),ref:a,type:F},G,{classes:X,children:[te,f,V]}))}),Or=Nme;function Bme(n){return nr("PrivateSwitchBase",n)}Bi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Ume=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Wme=n=>{const{classes:e,checked:a,disabled:o,edge:s}=n,c={root:["root",a&&"checked",o&&"disabled",s&&`edge${xa(s)}`],input:["input"]};return hr(c,Bme,e)},Vme=ca(wT)(({ownerState:n})=>rt({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),Gme=ca("input",{shouldForwardProp:El})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Hme=re.forwardRef(function(e,a){const{autoFocus:o,checked:s,checkedIcon:c,className:d,defaultChecked:f,disabled:m,disableFocusRipple:y=!1,edge:_=!1,icon:x,id:S,inputProps:T,inputRef:I,name:k,onBlur:D,onChange:L,onFocus:O,readOnly:F,required:B=!1,tabIndex:G,type:q,value:X}=e,te=ya(e,Ume),[V,Q]=WE({controlled:s,default:!!f,name:"SwitchBase",state:"checked"}),ge=m_(),me=pe=>{O&&O(pe),ge&&ge.onFocus&&ge.onFocus(pe)},be=pe=>{D&&D(pe),ge&&ge.onBlur&&ge.onBlur(pe)},fe=pe=>{if(pe.nativeEvent.defaultPrevented)return;const Ae=pe.target.checked;Q(Ae),L&&L(pe,Ae)};let Ce=m;ge&&typeof Ce>"u"&&(Ce=ge.disabled);const Le=q==="checkbox"||q==="radio",Ge=rt({},e,{checked:V,disabled:Ce,disableFocusRipple:y,edge:_}),le=Wme(Ge);return Je(Vme,rt({component:"span",className:Va(le.root,d),centerRipple:!0,focusRipple:!y,disabled:Ce,tabIndex:null,role:void 0,onFocus:me,onBlur:be,ownerState:Ge,ref:a},te,{children:[ee(Gme,rt({autoFocus:o,checked:s,defaultChecked:f,className:le.input,disabled:Ce,id:Le?S:void 0,name:k,onChange:fe,readOnly:F,ref:I,required:B,ownerState:Ge,tabIndex:G,type:q},q==="checkbox"&&X===void 0?{}:{value:X},T)),V?c:x]}))}),SX=Hme,jme=Cw(ee("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),$me=Cw(ee("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),qme=Cw(ee("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Xme(n){return nr("MuiCheckbox",n)}const Yme=Bi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),m4=Yme,Zme=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Kme=n=>{const{classes:e,indeterminate:a,color:o,size:s}=n,c={root:["root",a&&"indeterminate",`color${xa(o)}`,`size${xa(s)}`]},d=hr(c,Xme,e);return rt({},e,d)},Jme=ca(SX,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.indeterminate&&e.indeterminate,e[`size${xa(a.size)}`],a.color!=="default"&&e[`color${xa(a.color)}`]]}})(({theme:n,ownerState:e})=>rt({color:(n.vars||n).palette.text.secondary},!e.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${e.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(e.color==="default"?n.palette.action.active:n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${m4.checked}, &.${m4.indeterminate}`]:{color:(n.vars||n).palette[e.color].main},[`&.${m4.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),Qme=ee($me,{}),ege=ee(jme,{}),tge=ee(qme,{}),nge=re.forwardRef(function(e,a){var o,s;const c=br({props:e,name:"MuiCheckbox"}),{checkedIcon:d=Qme,color:f="primary",icon:m=ege,indeterminate:y=!1,indeterminateIcon:_=tge,inputProps:x,size:S="medium",className:T}=c,I=ya(c,Zme),k=y?_:m,D=y?_:d,L=rt({},c,{color:f,indeterminate:y,size:S}),O=Kme(L);return ee(Jme,rt({type:"checkbox",inputProps:rt({"data-indeterminate":y},x),icon:re.cloneElement(k,{fontSize:(o=k.props.fontSize)!=null?o:S}),checkedIcon:re.cloneElement(D,{fontSize:(s=D.props.fontSize)!=null?s:S}),ownerState:L,ref:a,className:Va(O.root,T)},I,{classes:O}))}),age=nge;function ige(n){return nr("MuiModal",n)}Bi("MuiModal",["root","hidden","backdrop"]);const rge=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],oge=n=>{const{open:e,exited:a,classes:o}=n;return hr({root:["root",!e&&a&&"hidden"],backdrop:["backdrop"]},ige,o)},sge=ca("div",{name:"MuiModal",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,!a.open&&a.exited&&e.hidden]}})(({theme:n,ownerState:e})=>rt({position:"fixed",zIndex:(n.vars||n).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),lge=ca(Mme,{name:"MuiModal",slot:"Backdrop",overridesResolver:(n,e)=>e.backdrop})({zIndex:-1}),cge=re.forwardRef(function(e,a){var o,s,c,d,f,m;const y=br({name:"MuiModal",props:e}),{BackdropComponent:_=lge,BackdropProps:x,className:S,closeAfterTransition:T=!1,children:I,container:k,component:D,components:L={},componentsProps:O={},disableAutoFocus:F=!1,disableEnforceFocus:B=!1,disableEscapeKeyDown:G=!1,disablePortal:q=!1,disableRestoreFocus:X=!1,disableScrollLock:te=!1,hideBackdrop:V=!1,keepMounted:Q=!1,onBackdropClick:ge,open:me,slotProps:be,slots:fe}=y,Ce=ya(y,rge),Le=rt({},y,{closeAfterTransition:T,disableAutoFocus:F,disableEnforceFocus:B,disableEscapeKeyDown:G,disablePortal:q,disableRestoreFocus:X,disableScrollLock:te,hideBackdrop:V,keepMounted:Q}),{getRootProps:Ge,getBackdropProps:le,getTransitionProps:pe,portalRef:Ae,isTopModal:ae,exited:Ee,hasTransition:Ze}=Kpe(rt({},Le,{rootRef:a})),Xe=rt({},Le,{exited:Ee}),Ke=oge(Xe),Ue={};if(I.props.tabIndex===void 0&&(Ue.tabIndex="-1"),Ze){const{onEnter:pt,onExited:yt}=pe();Ue.onEnter=pt,Ue.onExited=yt}const ft=(o=(s=fe==null?void 0:fe.root)!=null?s:L.Root)!=null?o:sge,Rt=(c=(d=fe==null?void 0:fe.backdrop)!=null?d:L.Backdrop)!=null?c:_,kt=(f=be==null?void 0:be.root)!=null?f:O.root,Jt=(m=be==null?void 0:be.backdrop)!=null?m:O.backdrop,It=Z0({elementType:ft,externalSlotProps:kt,externalForwardedProps:Ce,getSlotProps:Ge,additionalProps:{ref:a,as:D},ownerState:Xe,className:Va(S,kt==null?void 0:kt.className,Ke==null?void 0:Ke.root,!Xe.open&&Xe.exited&&(Ke==null?void 0:Ke.hidden))}),Pe=Z0({elementType:Rt,externalSlotProps:Jt,additionalProps:x,getSlotProps:pt=>le(rt({},pt,{onClick:yt=>{ge&&ge(yt),pt!=null&&pt.onClick&&pt.onClick(yt)}})),className:Va(Jt==null?void 0:Jt.className,x==null?void 0:x.className,Ke==null?void 0:Ke.backdrop),ownerState:Xe});return!Q&&!me&&(!Ze||Ee)?null:ee(Vpe,{ref:Ae,container:k,disablePortal:q,children:Je(ft,rt({},It,{children:[!V&&_?ee(Rt,rt({},Pe)):null,ee(Upe,{disableEnforceFocus:B,disableAutoFocus:F,disableRestoreFocus:X,isEnabled:ae,open:me,children:re.cloneElement(I,Ue)})]}))})}),uge=cge,dge=Bi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),j7=dge,hge=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function fge(n,e,a){const o=e.getBoundingClientRect(),s=a&&a.getBoundingClientRect(),c=gd(e);let d;if(e.fakeTransform)d=e.fakeTransform;else{const y=c.getComputedStyle(e);d=y.getPropertyValue("-webkit-transform")||y.getPropertyValue("transform")}let f=0,m=0;if(d&&d!=="none"&&typeof d=="string"){const y=d.split("(")[1].split(")")[0].split(",");f=parseInt(y[4],10),m=parseInt(y[5],10)}return n==="left"?s?`translateX(${s.right+f-o.left}px)`:`translateX(${c.innerWidth+f-o.left}px)`:n==="right"?s?`translateX(-${o.right-s.left-f}px)`:`translateX(-${o.left+o.width-f}px)`:n==="up"?s?`translateY(${s.bottom+m-o.top}px)`:`translateY(${c.innerHeight+m-o.top}px)`:s?`translateY(-${o.top-s.top+o.height-m}px)`:`translateY(-${o.top+o.height-m}px)`}function pge(n){return typeof n=="function"?n():n}function uS(n,e,a){const o=pge(a),s=fge(n,e,o);s&&(e.style.webkitTransform=s,e.style.transform=s)}const mge=re.forwardRef(function(e,a){const o=p_(),s={enter:o.transitions.easing.easeOut,exit:o.transitions.easing.sharp},c={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:d,appear:f=!0,children:m,container:y,direction:_="down",easing:x=s,in:S,onEnter:T,onEntered:I,onEntering:k,onExit:D,onExited:L,onExiting:O,style:F,timeout:B=c,TransitionComponent:G=ID}=e,q=ya(e,hge),X=re.useRef(null),te=ns(m.ref,X,a),V=le=>pe=>{le&&(pe===void 0?le(X.current):le(X.current,pe))},Q=V((le,pe)=>{uS(_,le,y),kD(le),T&&T(le,pe)}),ge=V((le,pe)=>{const Ae=Y0({timeout:B,style:F,easing:x},{mode:"enter"});le.style.webkitTransition=o.transitions.create("-webkit-transform",rt({},Ae)),le.style.transition=o.transitions.create("transform",rt({},Ae)),le.style.webkitTransform="none",le.style.transform="none",k&&k(le,pe)}),me=V(I),be=V(O),fe=V(le=>{const pe=Y0({timeout:B,style:F,easing:x},{mode:"exit"});le.style.webkitTransition=o.transitions.create("-webkit-transform",pe),le.style.transition=o.transitions.create("transform",pe),uS(_,le,y),D&&D(le)}),Ce=V(le=>{le.style.webkitTransition="",le.style.transition="",L&&L(le)}),Le=le=>{d&&d(X.current,le)},Ge=re.useCallback(()=>{X.current&&uS(_,X.current,y)},[_,y]);return re.useEffect(()=>{if(S||_==="down"||_==="right")return;const le=XM(()=>{X.current&&uS(_,X.current,y)}),pe=gd(X.current);return pe.addEventListener("resize",le),()=>{le.clear(),pe.removeEventListener("resize",le)}},[_,S,y]),re.useEffect(()=>{S||Ge()},[S,Ge]),ee(G,rt({nodeRef:X,onEnter:Q,onEntered:me,onEntering:ge,onExit:fe,onExited:Ce,onExiting:be,addEndListener:Le,appear:f,in:S,timeout:B},q,{children:(le,pe)=>re.cloneElement(m,rt({ref:te,style:rt({visibility:le==="exited"&&!S?"hidden":void 0},F,m.props.style)},pe))}))}),gge=mge,yge=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],vge=n=>{const{classes:e,disableUnderline:a}=n,s=hr({root:["root",!a&&"underline"],input:["input"]},pme,e);return rt({},e,s)},_ge=ca(ET,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[...ST(n,e),!a.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{var a;const o=n.palette.mode==="light",s=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",c=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",d=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",f=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return rt({position:"relative",backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:d,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c}},[`&.${Lm.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:c},[`&.${Lm.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:f}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(a=(n.vars||n).palette[e.color||"primary"])==null?void 0:a.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Lm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Lm.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Lm.disabled}, .${Lm.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${Lm.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&rt({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),bge=ca(MT,{name:"MuiFilledInput",slot:"Input",overridesResolver:AT})(({theme:n,ownerState:e})=>rt({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),AX=re.forwardRef(function(e,a){var o,s,c,d;const f=br({props:e,name:"MuiFilledInput"}),{components:m={},componentsProps:y,fullWidth:_=!1,inputComponent:x="input",multiline:S=!1,slotProps:T,slots:I={},type:k="text"}=f,D=ya(f,yge),L=rt({},f,{fullWidth:_,inputComponent:x,multiline:S,type:k}),O=vge(f),F={root:{ownerState:L},input:{ownerState:L}},B=T??y?wl(T??y,F):F,G=(o=(s=I.root)!=null?s:m.Root)!=null?o:_ge,q=(c=(d=I.input)!=null?d:m.Input)!=null?c:bge;return ee(OD,rt({slots:{root:G,input:q},componentsProps:B,fullWidth:_,inputComponent:x,multiline:S,ref:a,type:k},D,{classes:O}))});AX.muiName="Input";const xge=AX;function wge(n){return nr("MuiFormControl",n)}Bi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Sge=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Age=n=>{const{classes:e,margin:a,fullWidth:o}=n,s={root:["root",a!=="none"&&`margin${xa(a)}`,o&&"fullWidth"]};return hr(s,wge,e)},Ege=ca("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:n},e)=>rt({},e.root,e[`margin${xa(n.margin)}`],n.fullWidth&&e.fullWidth)})(({ownerState:n})=>rt({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},n.margin==="normal"&&{marginTop:16,marginBottom:8},n.margin==="dense"&&{marginTop:8,marginBottom:4},n.fullWidth&&{width:"100%"})),Mge=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiFormControl"}),{children:s,className:c,color:d="primary",component:f="div",disabled:m=!1,error:y=!1,focused:_,fullWidth:x=!1,hiddenLabel:S=!1,margin:T="none",required:I=!1,size:k="medium",variant:D="outlined"}=o,L=ya(o,Sge),O=rt({},o,{color:d,component:f,disabled:m,error:y,fullWidth:x,hiddenLabel:S,margin:T,required:I,size:k,variant:D}),F=Age(O),[B,G]=re.useState(()=>{let be=!1;return s&&re.Children.forEach(s,fe=>{if(!VA(fe,["Input","Select"]))return;const Ce=VA(fe,["Select"])?fe.props.input:fe;Ce&&ame(Ce.props)&&(be=!0)}),be}),[q,X]=re.useState(()=>{let be=!1;return s&&re.Children.forEach(s,fe=>{VA(fe,["Input","Select"])&&(XE(fe.props,!0)||XE(fe.props.inputProps,!0))&&(be=!0)}),be}),[te,V]=re.useState(!1);m&&te&&V(!1);const Q=_!==void 0&&!m?_:te;let ge;const me=re.useMemo(()=>({adornedStart:B,setAdornedStart:G,color:d,disabled:m,error:y,filled:q,focused:Q,fullWidth:x,hiddenLabel:S,size:k,onBlur:()=>{V(!1)},onEmpty:()=>{X(!1)},onFilled:()=>{X(!0)},onFocus:()=>{V(!0)},registerEffect:ge,required:I,variant:D}),[B,d,m,y,q,Q,x,S,ge,I,k,D]);return ee(DD.Provider,{value:me,children:ee(Ege,rt({as:f,ownerState:O,className:Va(F.root,c),ref:a},L,{children:s}))})}),Tge=Mge;function Cge(n){return nr("MuiFormLabel",n)}const Pge=Bi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Kb=Pge,Ige=["children","className","color","component","disabled","error","filled","focused","required"],Lge=n=>{const{classes:e,color:a,focused:o,disabled:s,error:c,filled:d,required:f}=n,m={root:["root",`color${xa(a)}`,s&&"disabled",c&&"error",d&&"filled",o&&"focused",f&&"required"],asterisk:["asterisk",c&&"error"]};return hr(m,Cge,e)},Rge=ca("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:n},e)=>rt({},e.root,n.color==="secondary"&&e.colorSecondary,n.filled&&e.filled)})(({theme:n,ownerState:e})=>rt({color:(n.vars||n).palette.text.secondary},n.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Kb.focused}`]:{color:(n.vars||n).palette[e.color].main},[`&.${Kb.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${Kb.error}`]:{color:(n.vars||n).palette.error.main}})),kge=ca("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(n,e)=>e.asterisk})(({theme:n})=>({[`&.${Kb.error}`]:{color:(n.vars||n).palette.error.main}})),Dge=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiFormLabel"}),{children:s,className:c,component:d="label"}=o,f=ya(o,Ige),m=m_(),y=Pw({props:o,muiFormControl:m,states:["color","required","focused","disabled","error","filled"]}),_=rt({},o,{color:y.color||"primary",component:d,disabled:y.disabled,error:y.error,filled:y.filled,focused:y.focused,required:y.required}),x=Lge(_);return Je(Rge,rt({as:d,ownerState:_,className:Va(x.root,c),ref:a},f,{children:[s,y.required&&Je(kge,{ownerState:_,"aria-hidden":!0,className:x.asterisk,children:["","*"]})]}))}),Oge=Dge,zge=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function HL(n){return`scale(${n}, ${n**2})`}const Fge={entering:{opacity:1,transform:HL(1)},entered:{opacity:1,transform:"none"}},g4=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),EX=re.forwardRef(function(e,a){const{addEndListener:o,appear:s=!0,children:c,easing:d,in:f,onEnter:m,onEntered:y,onEntering:_,onExit:x,onExited:S,onExiting:T,style:I,timeout:k="auto",TransitionComponent:D=ID}=e,L=ya(e,zge),O=re.useRef(),F=re.useRef(),B=p_(),G=re.useRef(null),q=ns(G,c.ref,a),X=Ce=>Le=>{if(Ce){const Ge=G.current;Le===void 0?Ce(Ge):Ce(Ge,Le)}},te=X(_),V=X((Ce,Le)=>{kD(Ce);const{duration:Ge,delay:le,easing:pe}=Y0({style:I,timeout:k,easing:d},{mode:"enter"});let Ae;k==="auto"?(Ae=B.transitions.getAutoHeightDuration(Ce.clientHeight),F.current=Ae):Ae=Ge,Ce.style.transition=[B.transitions.create("opacity",{duration:Ae,delay:le}),B.transitions.create("transform",{duration:g4?Ae:Ae*.666,delay:le,easing:pe})].join(","),m&&m(Ce,Le)}),Q=X(y),ge=X(T),me=X(Ce=>{const{duration:Le,delay:Ge,easing:le}=Y0({style:I,timeout:k,easing:d},{mode:"exit"});let pe;k==="auto"?(pe=B.transitions.getAutoHeightDuration(Ce.clientHeight),F.current=pe):pe=Le,Ce.style.transition=[B.transitions.create("opacity",{duration:pe,delay:Ge}),B.transitions.create("transform",{duration:g4?pe:pe*.666,delay:g4?Ge:Ge||pe*.333,easing:le})].join(","),Ce.style.opacity=0,Ce.style.transform=HL(.75),x&&x(Ce)}),be=X(S),fe=Ce=>{k==="auto"&&(O.current=setTimeout(Ce,F.current||0)),o&&o(G.current,Ce)};return re.useEffect(()=>()=>{clearTimeout(O.current)},[]),ee(D,rt({appear:s,in:f,nodeRef:G,onEnter:V,onEntered:Q,onEntering:te,onExit:me,onExited:be,onExiting:ge,addEndListener:fe,timeout:k==="auto"?null:k},L,{children:(Ce,Le)=>re.cloneElement(c,rt({style:rt({opacity:0,transform:HL(.75),visibility:Ce==="exited"&&!f?"hidden":void 0},Fge[Ce],I,c.props.style),ref:q},Le))}))});EX.muiSupportAuto=!0;const Nge=EX,Bge=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Uge=n=>{const{classes:e,disableUnderline:a}=n,s=hr({root:["root",!a&&"underline"],input:["input"]},ume,e);return rt({},e,s)},Wge=ca(ET,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[...ST(n,e),!a.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{let o=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(o=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),rt({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n.vars||n).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${J1.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${J1.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${o}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${J1.disabled}, .${J1.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${o}`}},[`&.${J1.disabled}:before`]:{borderBottomStyle:"dotted"}})}),Vge=ca(MT,{name:"MuiInput",slot:"Input",overridesResolver:AT})({}),MX=re.forwardRef(function(e,a){var o,s,c,d;const f=br({props:e,name:"MuiInput"}),{disableUnderline:m,components:y={},componentsProps:_,fullWidth:x=!1,inputComponent:S="input",multiline:T=!1,slotProps:I,slots:k={},type:D="text"}=f,L=ya(f,Bge),O=Uge(f),B={root:{ownerState:{disableUnderline:m}}},G=I??_?wl(I??_,B):B,q=(o=(s=k.root)!=null?s:y.Root)!=null?o:Wge,X=(c=(d=k.input)!=null?d:y.Input)!=null?c:Vge;return ee(OD,rt({slots:{root:q,input:X},slotProps:G,fullWidth:x,inputComponent:S,multiline:T,ref:a,type:D},L,{classes:O}))});MX.muiName="Input";const Gge=MX;function Hge(n){return nr("MuiInputLabel",n)}Bi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const jge=["disableAnimation","margin","shrink","variant","className"],$ge=n=>{const{classes:e,formControl:a,size:o,shrink:s,disableAnimation:c,variant:d,required:f}=n,m={root:["root",a&&"formControl",!c&&"animated",s&&"shrink",o&&o!=="normal"&&`size${xa(o)}`,d],asterisk:[f&&"asterisk"]},y=hr(m,Hge,e);return rt({},e,y)},qge=ca(Oge,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`& .${Kb.asterisk}`]:e.asterisk},e.root,a.formControl&&e.formControl,a.size==="small"&&e.sizeSmall,a.shrink&&e.shrink,!a.disableAnimation&&e.animated,a.focused&&e.focused,e[a.variant]]}})(({theme:n,ownerState:e})=>rt({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:n.transitions.create(["color","transform","max-width"],{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut})},e.variant==="filled"&&rt({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&rt({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&rt({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Xge=re.forwardRef(function(e,a){const o=br({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:c,className:d}=o,f=ya(o,jge),m=m_();let y=c;typeof y>"u"&&m&&(y=m.filled||m.focused||m.adornedStart);const _=Pw({props:o,muiFormControl:m,states:["size","variant","required","focused"]}),x=rt({},o,{disableAnimation:s,formControl:m,shrink:y,size:_.size,variant:_.variant,required:_.required,focused:_.focused}),S=$ge(x);return ee(qge,rt({"data-shrink":y,ownerState:x,ref:a,className:Va(S.root,d)},f,{classes:S}))}),Yge=Xge,Zge=re.createContext({}),jL=Zge;function Kge(n){return nr("MuiList",n)}Bi("MuiList",["root","padding","dense","subheader"]);const Jge=["children","className","component","dense","disablePadding","subheader"],Qge=n=>{const{classes:e,disablePadding:a,dense:o,subheader:s}=n;return hr({root:["root",!a&&"padding",o&&"dense",s&&"subheader"]},Kge,e)},eye=ca("ul",{name:"MuiList",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,!a.disablePadding&&e.padding,a.dense&&e.dense,a.subheader&&e.subheader]}})(({ownerState:n})=>rt({listStyle:"none",margin:0,padding:0,position:"relative"},!n.disablePadding&&{paddingTop:8,paddingBottom:8},n.subheader&&{paddingTop:0})),tye=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiList"}),{children:s,className:c,component:d="ul",dense:f=!1,disablePadding:m=!1,subheader:y}=o,_=ya(o,Jge),x=re.useMemo(()=>({dense:f}),[f]),S=rt({},o,{component:d,dense:f,disablePadding:m}),T=Qge(S);return ee(jL.Provider,{value:x,children:Je(eye,rt({as:d,className:Va(T.root,c),ref:a,ownerState:S},_,{children:[y,s]}))})}),nye=tye,aye=Bi("MuiListItemIcon",["root","alignItemsFlexStart"]),$7=aye,iye=Bi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),q7=iye,rye=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function y4(n,e,a){return n===e?n.firstChild:e&&e.nextElementSibling?e.nextElementSibling:a?null:n.firstChild}function X7(n,e,a){return n===e?a?n.firstChild:n.lastChild:e&&e.previousElementSibling?e.previousElementSibling:a?null:n.lastChild}function TX(n,e){if(e===void 0)return!0;let a=n.innerText;return a===void 0&&(a=n.textContent),a=a.trim().toLowerCase(),a.length===0?!1:e.repeating?a[0]===e.keys[0]:a.indexOf(e.keys.join(""))===0}function Q1(n,e,a,o,s,c){let d=!1,f=s(n,e,e?a:!1);for(;f;){if(f===n.firstChild){if(d)return!1;d=!0}const m=o?!1:f.disabled||f.getAttribute("aria-disabled")==="true";if(!f.hasAttribute("tabindex")||!TX(f,c)||m)f=s(n,f,a);else return f.focus(),!0}return!1}const oye=re.forwardRef(function(e,a){const{actions:o,autoFocus:s=!1,autoFocusItem:c=!1,children:d,className:f,disabledItemsFocusable:m=!1,disableListWrap:y=!1,onKeyDown:_,variant:x="selectedMenu"}=e,S=ya(e,rye),T=re.useRef(null),I=re.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});zh(()=>{s&&T.current.focus()},[s]),re.useImperativeHandle(o,()=>({adjustStyleForScrollbar:(F,B)=>{const G=!T.current.style.width;if(F.clientHeight<T.current.clientHeight&&G){const q=`${Wq(Sl(F))}px`;T.current.style[B.direction==="rtl"?"paddingLeft":"paddingRight"]=q,T.current.style.width=`calc(100% + ${q})`}return T.current}}),[]);const k=F=>{const B=T.current,G=F.key,q=Sl(B).activeElement;if(G==="ArrowDown")F.preventDefault(),Q1(B,q,y,m,y4);else if(G==="ArrowUp")F.preventDefault(),Q1(B,q,y,m,X7);else if(G==="Home")F.preventDefault(),Q1(B,null,y,m,y4);else if(G==="End")F.preventDefault(),Q1(B,null,y,m,X7);else if(G.length===1){const X=I.current,te=G.toLowerCase(),V=performance.now();X.keys.length>0&&(V-X.lastTime>500?(X.keys=[],X.repeating=!0,X.previousKeyMatched=!0):X.repeating&&te!==X.keys[0]&&(X.repeating=!1)),X.lastTime=V,X.keys.push(te);const Q=q&&!X.repeating&&TX(q,X);X.previousKeyMatched&&(Q||Q1(B,q,!1,m,y4,X))?F.preventDefault():X.previousKeyMatched=!1}_&&_(F)},D=ns(T,a);let L=-1;re.Children.forEach(d,(F,B)=>{if(!re.isValidElement(F)){L===B&&(L+=1,L>=d.length&&(L=-1));return}F.props.disabled||(x==="selectedMenu"&&F.props.selected||L===-1)&&(L=B),L===B&&(F.props.disabled||F.props.muiSkipListHighlight||F.type.muiSkipListHighlight)&&(L+=1,L>=d.length&&(L=-1))});const O=re.Children.map(d,(F,B)=>{if(B===L){const G={};return c&&(G.autoFocus=!0),F.props.tabIndex===void 0&&x==="selectedMenu"&&(G.tabIndex=0),re.cloneElement(F,G)}return F});return ee(nye,rt({role:"menu",ref:D,className:f,onKeyDown:k,tabIndex:s?0:-1},S,{children:O}))}),sye=oye;function lye(n){return nr("MuiPopover",n)}Bi("MuiPopover",["root","paper"]);const cye=["onEntering"],uye=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],dye=["slotProps"];function Y7(n,e){let a=0;return typeof e=="number"?a=e:e==="center"?a=n.height/2:e==="bottom"&&(a=n.height),a}function Z7(n,e){let a=0;return typeof e=="number"?a=e:e==="center"?a=n.width/2:e==="right"&&(a=n.width),a}function K7(n){return[n.horizontal,n.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function v4(n){return typeof n=="function"?n():n}const hye=n=>{const{classes:e}=n;return hr({root:["root"],paper:["paper"]},lye,e)},fye=ca(uge,{name:"MuiPopover",slot:"Root",overridesResolver:(n,e)=>e.root})({}),CX=ca(ipe,{name:"MuiPopover",slot:"Paper",overridesResolver:(n,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),pye=re.forwardRef(function(e,a){var o,s,c;const d=br({props:e,name:"MuiPopover"}),{action:f,anchorEl:m,anchorOrigin:y={vertical:"top",horizontal:"left"},anchorPosition:_,anchorReference:x="anchorEl",children:S,className:T,container:I,elevation:k=8,marginThreshold:D=16,open:L,PaperProps:O={},slots:F,slotProps:B,transformOrigin:G={vertical:"top",horizontal:"left"},TransitionComponent:q=Nge,transitionDuration:X="auto",TransitionProps:{onEntering:te}={},disableScrollLock:V=!1}=d,Q=ya(d.TransitionProps,cye),ge=ya(d,uye),me=(o=B==null?void 0:B.paper)!=null?o:O,be=re.useRef(),fe=ns(be,me.ref),Ce=rt({},d,{anchorOrigin:y,anchorReference:x,elevation:k,marginThreshold:D,externalPaperSlotProps:me,transformOrigin:G,TransitionComponent:q,transitionDuration:X,TransitionProps:Q}),Le=hye(Ce),Ge=re.useCallback(()=>{if(x==="anchorPosition")return _;const pt=v4(m),At=(pt&&pt.nodeType===1?pt:Sl(be.current).body).getBoundingClientRect();return{top:At.top+Y7(At,y.vertical),left:At.left+Z7(At,y.horizontal)}},[m,y.horizontal,y.vertical,_,x]),le=re.useCallback(pt=>({vertical:Y7(pt,G.vertical),horizontal:Z7(pt,G.horizontal)}),[G.horizontal,G.vertical]),pe=re.useCallback(pt=>{const yt={width:pt.offsetWidth,height:pt.offsetHeight},At=le(yt);if(x==="none")return{top:null,left:null,transformOrigin:K7(At)};const Be=Ge();let ue=Be.top-At.vertical,se=Be.left-At.horizontal;const ve=ue+yt.height,$e=se+yt.width,De=gd(v4(m)),st=De.innerHeight-D,de=De.innerWidth-D;if(D!==null&&ue<D){const ne=ue-D;ue-=ne,At.vertical+=ne}else if(D!==null&&ve>st){const ne=ve-st;ue-=ne,At.vertical+=ne}if(D!==null&&se<D){const ne=se-D;se-=ne,At.horizontal+=ne}else if($e>de){const ne=$e-de;se-=ne,At.horizontal+=ne}return{top:`${Math.round(ue)}px`,left:`${Math.round(se)}px`,transformOrigin:K7(At)}},[m,x,Ge,le,D]),[Ae,ae]=re.useState(L),Ee=re.useCallback(()=>{const pt=be.current;if(!pt)return;const yt=pe(pt);yt.top!==null&&(pt.style.top=yt.top),yt.left!==null&&(pt.style.left=yt.left),pt.style.transformOrigin=yt.transformOrigin,ae(!0)},[pe]);re.useEffect(()=>(V&&window.addEventListener("scroll",Ee),()=>window.removeEventListener("scroll",Ee)),[m,V,Ee]);const Ze=(pt,yt)=>{te&&te(pt,yt),Ee()},Xe=()=>{ae(!1)};re.useEffect(()=>{L&&Ee()}),re.useImperativeHandle(f,()=>L?{updatePosition:()=>{Ee()}}:null,[L,Ee]),re.useEffect(()=>{if(!L)return;const pt=XM(()=>{Ee()}),yt=gd(m);return yt.addEventListener("resize",pt),()=>{pt.clear(),yt.removeEventListener("resize",pt)}},[m,L,Ee]);let Ke=X;X==="auto"&&!q.muiSupportAuto&&(Ke=void 0);const Ue=I||(m?Sl(v4(m)).body:void 0),ft=(s=F==null?void 0:F.root)!=null?s:fye,Rt=(c=F==null?void 0:F.paper)!=null?c:CX,kt=Z0({elementType:Rt,externalSlotProps:rt({},me,{style:Ae?me.style:rt({},me.style,{opacity:0})}),additionalProps:{elevation:k,ref:fe},ownerState:Ce,className:Va(Le.paper,me==null?void 0:me.className)}),Jt=Z0({elementType:ft,externalSlotProps:(B==null?void 0:B.root)||{},externalForwardedProps:ge,additionalProps:{ref:a,slotProps:{backdrop:{invisible:!0}},container:Ue,open:L},ownerState:Ce,className:Va(Le.root,T)}),{slotProps:It}=Jt,Pe=ya(Jt,dye);return ee(ft,rt({},Pe,!qE(ft)&&{slotProps:It,disableScrollLock:V},{children:ee(q,rt({appear:!0,in:L,onEntering:Ze,onExited:Xe,timeout:Ke},Q,{children:ee(Rt,rt({},kt,{children:S}))}))}))}),mye=pye;function gye(n){return nr("MuiMenu",n)}Bi("MuiMenu",["root","paper","list"]);const yye=["onEntering"],vye=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],_ye={vertical:"top",horizontal:"right"},bye={vertical:"top",horizontal:"left"},xye=n=>{const{classes:e}=n;return hr({root:["root"],paper:["paper"],list:["list"]},gye,e)},wye=ca(mye,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(n,e)=>e.root})({}),Sye=ca(CX,{name:"MuiMenu",slot:"Paper",overridesResolver:(n,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Aye=ca(sye,{name:"MuiMenu",slot:"List",overridesResolver:(n,e)=>e.list})({outline:0}),Eye=re.forwardRef(function(e,a){var o,s;const c=br({props:e,name:"MuiMenu"}),{autoFocus:d=!0,children:f,className:m,disableAutoFocusItem:y=!1,MenuListProps:_={},onClose:x,open:S,PaperProps:T={},PopoverClasses:I,transitionDuration:k="auto",TransitionProps:{onEntering:D}={},variant:L="selectedMenu",slots:O={},slotProps:F={}}=c,B=ya(c.TransitionProps,yye),G=ya(c,vye),q=p_(),X=q.direction==="rtl",te=rt({},c,{autoFocus:d,disableAutoFocusItem:y,MenuListProps:_,onEntering:D,PaperProps:T,transitionDuration:k,TransitionProps:B,variant:L}),V=xye(te),Q=d&&!y&&S,ge=re.useRef(null),me=(pe,Ae)=>{ge.current&&ge.current.adjustStyleForScrollbar(pe,q),D&&D(pe,Ae)},be=pe=>{pe.key==="Tab"&&(pe.preventDefault(),x&&x(pe,"tabKeyDown"))};let fe=-1;re.Children.map(f,(pe,Ae)=>{re.isValidElement(pe)&&(pe.props.disabled||(L==="selectedMenu"&&pe.props.selected||fe===-1)&&(fe=Ae))});const Ce=(o=O.paper)!=null?o:Sye,Le=(s=F.paper)!=null?s:T,Ge=Z0({elementType:O.root,externalSlotProps:F.root,ownerState:te,className:[V.root,m]}),le=Z0({elementType:Ce,externalSlotProps:Le,ownerState:te,className:V.paper});return ee(wye,rt({onClose:x,anchorOrigin:{vertical:"bottom",horizontal:X?"right":"left"},transformOrigin:X?_ye:bye,slots:{paper:Ce,root:O.root},slotProps:{root:Ge,paper:le},open:S,ref:a,transitionDuration:k,TransitionProps:rt({onEntering:me},B),ownerState:te},G,{classes:I,children:ee(Aye,rt({onKeyDown:be,actions:ge,autoFocus:d&&(fe===-1||y),autoFocusItem:Q,variant:L},_,{className:Va(V.list,_.className),children:f}))}))}),Iw=Eye;function Mye(n){return nr("MuiMenuItem",n)}const Tye=Bi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),eb=Tye,Cye=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Pye=(n,e)=>{const{ownerState:a}=n;return[e.root,a.dense&&e.dense,a.divider&&e.divider,!a.disableGutters&&e.gutters]},Iye=n=>{const{disabled:e,dense:a,divider:o,disableGutters:s,selected:c,classes:d}=n,m=hr({root:["root",a&&"dense",e&&"disabled",!s&&"gutters",o&&"divider",c&&"selected"]},Mye,d);return rt({},d,m)},Lye=ca(wT,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Pye})(({theme:n,ownerState:e})=>rt({},n.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(n.vars||n).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${eb.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Qo(n.palette.primary.main,n.palette.action.selectedOpacity),[`&.${eb.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:Qo(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}},[`&.${eb.selected}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Qo(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Qo(n.palette.primary.main,n.palette.action.selectedOpacity)}},[`&.${eb.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${eb.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`& + .${j7.root}`]:{marginTop:n.spacing(1),marginBottom:n.spacing(1)},[`& + .${j7.inset}`]:{marginLeft:52},[`& .${q7.root}`]:{marginTop:0,marginBottom:0},[`& .${q7.inset}`]:{paddingLeft:36},[`& .${$7.root}`]:{minWidth:36}},!e.dense&&{[n.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&rt({minHeight:32,paddingTop:4,paddingBottom:4},n.typography.body2,{[`& .${$7.root} svg`]:{fontSize:"1.25rem"}}))),Rye=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiMenuItem"}),{autoFocus:s=!1,component:c="li",dense:d=!1,divider:f=!1,disableGutters:m=!1,focusVisibleClassName:y,role:_="menuitem",tabIndex:x,className:S}=o,T=ya(o,Cye),I=re.useContext(jL),k=re.useMemo(()=>({dense:d||I.dense||!1,disableGutters:m}),[I.dense,d,m]),D=re.useRef(null);zh(()=>{s&&D.current&&D.current.focus()},[s]);const L=rt({},o,{dense:k.dense,divider:f,disableGutters:m}),O=Iye(o),F=ns(D,a);let B;return o.disabled||(B=x!==void 0?x:-1),ee(jL.Provider,{value:k,children:ee(Lye,rt({ref:F,role:_,tabIndex:B,component:c,focusVisibleClassName:Va(O.focusVisible,y),className:Va(O.root,S)},T,{ownerState:L,classes:O}))})}),J0=Rye;function kye(n){return nr("MuiNativeSelect",n)}const Dye=Bi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),zD=Dye,Oye=["className","disabled","error","IconComponent","inputRef","variant"],zye=n=>{const{classes:e,variant:a,disabled:o,multiple:s,open:c,error:d}=n,f={select:["select",a,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${xa(a)}`,c&&"iconOpen",o&&"disabled"]};return hr(f,kye,e)},PX=({ownerState:n,theme:e})=>rt({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":rt({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${zD.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},n.variant==="filled"&&{"&&&":{paddingRight:32}},n.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Fye=ca("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:El,overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.select,e[a.variant],a.error&&e.error,{[`&.${zD.multiple}`]:e.multiple}]}})(PX),IX=({ownerState:n,theme:e})=>rt({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${zD.disabled}`]:{color:(e.vars||e).palette.action.disabled}},n.open&&{transform:"rotate(180deg)"},n.variant==="filled"&&{right:7},n.variant==="outlined"&&{right:7}),Nye=ca("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.icon,a.variant&&e[`icon${xa(a.variant)}`],a.open&&e.iconOpen]}})(IX),Bye=re.forwardRef(function(e,a){const{className:o,disabled:s,error:c,IconComponent:d,inputRef:f,variant:m="standard"}=e,y=ya(e,Oye),_=rt({},e,{disabled:s,variant:m,error:c}),x=zye(_);return Je(re.Fragment,{children:[ee(Fye,rt({ownerState:_,className:Va(x.select,o),disabled:s,ref:f||a},y)),e.multiple?null:ee(Nye,{as:d,ownerState:_,className:x.icon})]})}),Uye=Bye;var J7;const Wye=["children","classes","className","label","notched"],Vye=ca("fieldset",{shouldForwardProp:El})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),Gye=ca("legend",{shouldForwardProp:El})(({ownerState:n,theme:e})=>rt({float:"unset",width:"auto",overflow:"hidden"},!n.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},n.withLabel&&rt({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},n.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function Hye(n){const{className:e,label:a,notched:o}=n,s=ya(n,Wye),c=a!=null&&a!=="",d=rt({},n,{notched:o,withLabel:c});return ee(Vye,rt({"aria-hidden":!0,className:e,ownerState:d},s,{children:ee(Gye,{ownerState:d,children:c?ee("span",{children:a}):J7||(J7=ee("span",{className:"notranslate",children:""}))})}))}const jye=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],$ye=n=>{const{classes:e}=n,o=hr({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},hme,e);return rt({},e,o)},qye=ca(ET,{shouldForwardProp:n=>El(n)||n==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:ST})(({theme:n,ownerState:e})=>{const a=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return rt({position:"relative",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${kf.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${kf.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:a}},[`&.${kf.focused} .${kf.notchedOutline}`]:{borderColor:(n.vars||n).palette[e.color].main,borderWidth:2},[`&.${kf.error} .${kf.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},[`&.${kf.disabled} .${kf.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&rt({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Xye=ca(Hye,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(n,e)=>e.notchedOutline})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),Yye=ca(MT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:AT})(({theme:n,ownerState:e})=>rt({padding:"16.5px 14px"},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),LX=re.forwardRef(function(e,a){var o,s,c,d,f;const m=br({props:e,name:"MuiOutlinedInput"}),{components:y={},fullWidth:_=!1,inputComponent:x="input",label:S,multiline:T=!1,notched:I,slots:k={},type:D="text"}=m,L=ya(m,jye),O=$ye(m),F=m_(),B=Pw({props:m,muiFormControl:F,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),G=rt({},m,{color:B.color||"primary",disabled:B.disabled,error:B.error,focused:B.focused,formControl:F,fullWidth:_,hiddenLabel:B.hiddenLabel,multiline:T,size:B.size,type:D}),q=(o=(s=k.root)!=null?s:y.Root)!=null?o:qye,X=(c=(d=k.input)!=null?d:y.Input)!=null?c:Yye;return ee(OD,rt({slots:{root:q,input:X},renderSuffix:te=>ee(Xye,{ownerState:G,className:O.notchedOutline,label:S!=null&&S!==""&&B.required?f||(f=Je(re.Fragment,{children:[S,"","*"]})):S,notched:typeof I<"u"?I:!!(te.startAdornment||te.filled||te.focused)}),fullWidth:_,inputComponent:x,multiline:T,ref:a,type:D},L,{classes:rt({},O,{notchedOutline:null})}))});LX.muiName="Input";const Zye=LX;function Kye(n){return nr("MuiSelect",n)}const Jye=Bi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),tb=Jye;var Q7;const Qye=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],eve=ca("div",{name:"MuiSelect",slot:"Select",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`&.${tb.select}`]:e.select},{[`&.${tb.select}`]:e[a.variant]},{[`&.${tb.error}`]:e.error},{[`&.${tb.multiple}`]:e.multiple}]}})(PX,{[`&.${tb.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),tve=ca("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.icon,a.variant&&e[`icon${xa(a.variant)}`],a.open&&e.iconOpen]}})(IX),nve=ca("input",{shouldForwardProp:n=>Dfe(n)&&n!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(n,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function eW(n,e){return typeof e=="object"&&e!==null?n===e:String(n)===String(e)}function ave(n){return n==null||typeof n=="string"&&!n.trim()}const ive=n=>{const{classes:e,variant:a,disabled:o,multiple:s,open:c,error:d}=n,f={select:["select",a,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${xa(a)}`,c&&"iconOpen",o&&"disabled"],nativeInput:["nativeInput"]};return hr(f,Kye,e)},rve=re.forwardRef(function(e,a){var o;const{"aria-describedby":s,"aria-label":c,autoFocus:d,autoWidth:f,children:m,className:y,defaultOpen:_,defaultValue:x,disabled:S,displayEmpty:T,error:I=!1,IconComponent:k,inputRef:D,labelId:L,MenuProps:O={},multiple:F,name:B,onBlur:G,onChange:q,onClose:X,onFocus:te,onOpen:V,open:Q,readOnly:ge,renderValue:me,SelectDisplayProps:be={},tabIndex:fe,value:Ce,variant:Le="standard"}=e,Ge=ya(e,Qye),[le,pe]=WE({controlled:Ce,default:x,name:"Select"}),[Ae,ae]=WE({controlled:Q,default:_,name:"Select"}),Ee=re.useRef(null),Ze=re.useRef(null),[Xe,Ke]=re.useState(null),{current:Ue}=re.useRef(Q!=null),[ft,Rt]=re.useState(),kt=ns(a,D),Jt=re.useCallback(Nt=>{Ze.current=Nt,Nt&&Ke(Nt)},[]),It=Xe==null?void 0:Xe.parentNode;re.useImperativeHandle(kt,()=>({focus:()=>{Ze.current.focus()},node:Ee.current,value:le}),[le]),re.useEffect(()=>{_&&Ae&&Xe&&!Ue&&(Rt(f?null:It.clientWidth),Ze.current.focus())},[Xe,f]),re.useEffect(()=>{d&&Ze.current.focus()},[d]),re.useEffect(()=>{if(!L)return;const Nt=Sl(Ze.current).getElementById(L);if(Nt){const St=()=>{getSelection().isCollapsed&&Ze.current.focus()};return Nt.addEventListener("click",St),()=>{Nt.removeEventListener("click",St)}}},[L]);const Pe=(Nt,St)=>{Nt?V&&V(St):X&&X(St),Ue||(Rt(f?null:It.clientWidth),ae(Nt))},pt=Nt=>{Nt.button===0&&(Nt.preventDefault(),Ze.current.focus(),Pe(!0,Nt))},yt=Nt=>{Pe(!1,Nt)},At=re.Children.toArray(m),Be=Nt=>{const St=At.find(Zt=>Zt.props.value===Nt.target.value);St!==void 0&&(pe(St.props.value),q&&q(Nt,St))},ue=Nt=>St=>{let Zt;if(St.currentTarget.hasAttribute("tabindex")){if(F){Zt=Array.isArray(le)?le.slice():[];const He=le.indexOf(Nt.props.value);He===-1?Zt.push(Nt.props.value):Zt.splice(He,1)}else Zt=Nt.props.value;if(Nt.props.onClick&&Nt.props.onClick(St),le!==Zt&&(pe(Zt),q)){const He=St.nativeEvent||St,Lt=new He.constructor(He.type,He);Object.defineProperty(Lt,"target",{writable:!0,value:{value:Zt,name:B}}),q(Lt,Nt)}F||Pe(!1,St)}},se=Nt=>{ge||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Nt.key)!==-1&&(Nt.preventDefault(),Pe(!0,Nt))},ve=Xe!==null&&Ae,$e=Nt=>{!ve&&G&&(Object.defineProperty(Nt,"target",{writable:!0,value:{value:le,name:B}}),G(Nt))};delete Ge["aria-invalid"];let De,st;const de=[];let ne=!1;(XE({value:le})||T)&&(me?De=me(le):ne=!0);const Oe=At.map(Nt=>{if(!re.isValidElement(Nt))return null;let St;if(F){if(!Array.isArray(le))throw new Error(yp(2));St=le.some(Zt=>eW(Zt,Nt.props.value)),St&&ne&&de.push(Nt.props.children)}else St=eW(le,Nt.props.value),St&&ne&&(st=Nt.props.children);return re.cloneElement(Nt,{"aria-selected":St?"true":"false",onClick:ue(Nt),onKeyUp:Zt=>{Zt.key===" "&&Zt.preventDefault(),Nt.props.onKeyUp&&Nt.props.onKeyUp(Zt)},role:"option",selected:St,value:void 0,"data-value":Nt.props.value})});ne&&(F?de.length===0?De=null:De=de.reduce((Nt,St,Zt)=>(Nt.push(St),Zt<de.length-1&&Nt.push(", "),Nt),[]):De=st);let mt=ft;!f&&Ue&&Xe&&(mt=It.clientWidth);let ot;typeof fe<"u"?ot=fe:ot=S?null:0;const lt=be.id||(B?`mui-component-select-${B}`:void 0),Et=rt({},e,{variant:Le,value:le,open:ve,error:I}),Ut=ive(Et),Vt=rt({},O.PaperProps,(o=O.slotProps)==null?void 0:o.paper),$t=Bq();return Je(re.Fragment,{children:[ee(eve,rt({ref:Jt,tabIndex:ot,role:"combobox","aria-controls":$t,"aria-disabled":S?"true":void 0,"aria-expanded":ve?"true":"false","aria-haspopup":"listbox","aria-label":c,"aria-labelledby":[L,lt].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:se,onMouseDown:S||ge?null:pt,onBlur:$e,onFocus:te},be,{ownerState:Et,className:Va(be.className,Ut.select,y),id:lt,children:ave(De)?Q7||(Q7=ee("span",{className:"notranslate",children:""})):De})),ee(nve,rt({"aria-invalid":I,value:Array.isArray(le)?le.join(","):le,name:B,ref:Ee,"aria-hidden":!0,onChange:Be,tabIndex:-1,disabled:S,className:Ut.nativeInput,autoFocus:d,ownerState:Et},Ge)),ee(tve,{as:k,className:Ut.icon,ownerState:Et}),ee(Iw,rt({id:`menu-${B||""}`,anchorEl:It,open:ve,onClose:yt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},O,{MenuListProps:rt({"aria-labelledby":L,role:"listbox","aria-multiselectable":F?"true":void 0,disableListWrap:!0,id:$t},O.MenuListProps),slotProps:rt({},O.slotProps,{paper:rt({},Vt,{style:rt({minWidth:mt},Vt!=null?Vt.style:null)})}),children:Oe}))]})}),ove=rve,sve=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],lve=["root"],cve=n=>{const{classes:e}=n;return e},FD={name:"MuiSelect",overridesResolver:(n,e)=>e.root,shouldForwardProp:n=>El(n)&&n!=="variant",slot:"Root"},uve=ca(Gge,FD)(""),dve=ca(Zye,FD)(""),hve=ca(xge,FD)(""),RX=re.forwardRef(function(e,a){const o=br({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:c,classes:d={},className:f,defaultOpen:m=!1,displayEmpty:y=!1,IconComponent:_=gme,id:x,input:S,inputProps:T,label:I,labelId:k,MenuProps:D,multiple:L=!1,native:O=!1,onClose:F,onOpen:B,open:G,renderValue:q,SelectDisplayProps:X,variant:te="outlined"}=o,V=ya(o,sve),Q=O?Uye:ove,ge=m_(),me=Pw({props:o,muiFormControl:ge,states:["variant","error"]}),be=me.variant||te,fe=rt({},o,{variant:be,classes:d}),Ce=cve(fe),Le=ya(Ce,lve),Ge=S||{standard:ee(uve,{ownerState:fe}),outlined:ee(dve,{label:I,ownerState:fe}),filled:ee(hve,{ownerState:fe})}[be],le=ns(a,Ge.ref);return ee(re.Fragment,{children:re.cloneElement(Ge,rt({inputComponent:Q,inputProps:rt({children:c,error:me.error,IconComponent:_,variant:be,type:void 0,multiple:L},O?{id:x}:{autoWidth:s,defaultOpen:m,displayEmpty:y,labelId:k,MenuProps:D,onClose:F,onOpen:B,open:G,renderValue:q,SelectDisplayProps:rt({id:x},X)},T,{classes:T?wl(Le,T.classes):Le},S?S.props.inputProps:{})},L&&O&&be==="outlined"?{notched:!0}:{},{ref:le,className:Va(Ge.props.className,f,Ce.root)},!S&&{variant:be},V))})});RX.muiName="Select";const fve=RX;function pve(n){return nr("MuiSwitch",n)}const mve=Bi("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Vs=mve,gve=["className","color","edge","size","sx"],yve=n=>{const{classes:e,edge:a,size:o,color:s,checked:c,disabled:d}=n,f={root:["root",a&&`edge${xa(a)}`,`size${xa(o)}`],switchBase:["switchBase",`color${xa(s)}`,c&&"checked",d&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=hr(f,pve,e);return rt({},e,m)},vve=ca("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,a.edge&&e[`edge${xa(a.edge)}`],e[`size${xa(a.size)}`]]}})(({ownerState:n})=>rt({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},n.edge==="start"&&{marginLeft:-8},n.edge==="end"&&{marginRight:-8},n.size==="small"&&{width:40,height:24,padding:7,[`& .${Vs.thumb}`]:{width:16,height:16},[`& .${Vs.switchBase}`]:{padding:4,[`&.${Vs.checked}`]:{transform:"translateX(16px)"}}})),_ve=ca(SX,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.switchBase,{[`& .${Vs.input}`]:e.input},a.color!=="default"&&e[`color${xa(a.color)}`]]}})(({theme:n})=>({position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:`${n.palette.mode==="light"?n.palette.common.white:n.palette.grey[300]}`,transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),[`&.${Vs.checked}`]:{transform:"translateX(20px)"},[`&.${Vs.disabled}`]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:`${n.palette.mode==="light"?n.palette.grey[100]:n.palette.grey[600]}`},[`&.${Vs.checked} + .${Vs.track}`]:{opacity:.5},[`&.${Vs.disabled} + .${Vs.track}`]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:`${n.palette.mode==="light"?.12:.2}`},[`& .${Vs.input}`]:{left:"-100%",width:"300%"}}),({theme:n,ownerState:e})=>rt({"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${Vs.checked}`]:{color:(n.vars||n).palette[e.color].main,"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Vs.disabled}`]:{color:n.vars?n.vars.palette.Switch[`${e.color}DisabledColor`]:`${n.palette.mode==="light"?mX(n.palette[e.color].main,.62):pX(n.palette[e.color].main,.55)}`}},[`&.${Vs.checked} + .${Vs.track}`]:{backgroundColor:(n.vars||n).palette[e.color].main}})),bve=ca("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(n,e)=>e.track})(({theme:n})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:`${n.palette.mode==="light"?n.palette.common.black:n.palette.common.white}`,opacity:n.vars?n.vars.opacity.switchTrack:`${n.palette.mode==="light"?.38:.3}`})),xve=ca("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(n,e)=>e.thumb})(({theme:n})=>({boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),wve=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiSwitch"}),{className:s,color:c="primary",edge:d=!1,size:f="medium",sx:m}=o,y=ya(o,gve),_=rt({},o,{color:c,edge:d,size:f}),x=yve(_),S=ee(xve,{className:x.thumb,ownerState:_});return Je(vve,{className:Va(x.root,s),sx:m,ownerState:_,children:[ee(_ve,rt({type:"checkbox",icon:S,checkedIcon:S,ref:a,ownerState:_},y,{classes:rt({},x,{root:x.switchBase})})),ee(bve,{className:x.track,ownerState:_})]})}),Sve=wve;function Ave(n){return nr("MuiToggleButton",n)}const Eve=Bi("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),tW=Eve,Mve=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],Tve=n=>{const{classes:e,fullWidth:a,selected:o,disabled:s,size:c,color:d}=n,f={root:["root",o&&"selected",s&&"disabled",a&&"fullWidth",`size${xa(c)}`,d]};return hr(f,Ave,e)},Cve=ca(wT,{name:"MuiToggleButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[e.root,e[`size${xa(a.size)}`]]}})(({theme:n,ownerState:e})=>{let a=e.color==="standard"?n.palette.text.primary:n.palette[e.color].main,o;return n.vars&&(a=e.color==="standard"?n.vars.palette.text.primary:n.vars.palette[e.color].main,o=e.color==="standard"?n.vars.palette.text.primaryChannel:n.vars.palette[e.color].mainChannel),rt({},n.typography.button,{borderRadius:(n.vars||n).shape.borderRadius,padding:11,border:`1px solid ${(n.vars||n).palette.divider}`,color:(n.vars||n).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${tW.disabled}`]:{color:(n.vars||n).palette.action.disabled,border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Qo(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${tW.selected}`]:{color:a,backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:Qo(a,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${o} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Qo(a,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:Qo(a,n.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:n.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:n.typography.pxToRem(15)})}),Pve=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiToggleButton"}),{children:s,className:c,color:d="standard",disabled:f=!1,disableFocusRipple:m=!1,fullWidth:y=!1,onChange:_,onClick:x,selected:S,size:T="medium",value:I}=o,k=ya(o,Mve),D=rt({},o,{color:d,disabled:f,disableFocusRipple:m,fullWidth:y,size:T}),L=Tve(D),O=F=>{x&&(x(F,I),F.defaultPrevented)||_&&_(F,I)};return ee(Cve,rt({className:Va(L.root,c),disabled:f,focusRipple:!m,ref:a,onClick:O,onChange:_,value:I,ownerState:D,"aria-pressed":S},k,{children:s}))}),Ive=Pve;function Lve(n,e){return e===void 0||n===void 0?!1:Array.isArray(e)?e.indexOf(n)>=0:n===e}function Rve(n){return nr("MuiToggleButtonGroup",n)}const kve=Bi("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),rh=kve,Dve=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Ove=n=>{const{classes:e,orientation:a,fullWidth:o,disabled:s}=n,c={root:["root",a==="vertical"&&"vertical",o&&"fullWidth"],grouped:["grouped",`grouped${xa(a)}`,s&&"disabled"]};return hr(c,Rve,e)},zve=ca("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:a}=n;return[{[`& .${rh.grouped}`]:e.grouped},{[`& .${rh.grouped}`]:e[`grouped${xa(a.orientation)}`]},e.root,a.orientation==="vertical"&&e.vertical,a.fullWidth&&e.fullWidth]}})(({ownerState:n,theme:e})=>rt({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},n.orientation==="vertical"&&{flexDirection:"column"},n.fullWidth&&{width:"100%"},{[`& .${rh.grouped}`]:rt({},n.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${rh.selected} + .${rh.grouped}.${rh.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${rh.selected} + .${rh.grouped}.${rh.selected}`]:{borderTop:0,marginTop:0}})})),Fve=re.forwardRef(function(e,a){const o=br({props:e,name:"MuiToggleButtonGroup"}),{children:s,className:c,color:d="standard",disabled:f=!1,exclusive:m=!1,fullWidth:y=!1,onChange:_,orientation:x="horizontal",size:S="medium",value:T}=o,I=ya(o,Dve),k=rt({},o,{disabled:f,fullWidth:y,orientation:x,size:S}),D=Ove(k),L=(F,B)=>{if(!_)return;const G=T&&T.indexOf(B);let q;T&&G>=0?(q=T.slice(),q.splice(G,1)):q=T?T.concat(B):[B],_(F,q)},O=(F,B)=>{_&&_(F,T===B?null:B)};return ee(zve,rt({role:"group",className:Va(D.root,c),ref:a,ownerState:k},I,{children:re.Children.map(s,F=>re.isValidElement(F)?re.cloneElement(F,{className:Va(D.grouped,F.props.className),onChange:m?O:L,selected:F.props.selected===void 0?Lve(F.props.value,T):F.props.selected,size:F.props.size||S,fullWidth:y,color:F.props.color||d,disabled:F.props.disabled||f}):null)}))}),Nve=Fve,Bve=vX({palette:{primary:{main:"#007378"},secondary:{main:"#959595"}},components:{MuiSwitch:{styleOverrides:{root:{"& .MuiSwitch-switchBase":{"&.Mui-checked":{color:"#fff","& + .MuiSwitch-track":{opacity:1,backgroundColor:"#2D67FF",borderColor:"#007378"}}}}}},MuiDialog:{styleOverrides:{paper:{maxWidth:"none",borderRadius:40,marginTop:96}}},MuiDialogContent:{styleOverrides:{root:{padding:0}}},MuiCheckbox:{styleOverrides:{root:{color:"#D9D9D9","&.Mui-checked":{color:"#2D67FF"}}}}}}),kX=Object.fromEntries?Object.fromEntries:n=>{if(!n||!n[Symbol.iterator])throw new Error("Object.fromEntries() requires a single iterable argument");const e={};return Object.keys(n).forEach(a=>{const[o,s]=n[a];e[o]=s}),e};function Q0(n){return Object.keys(n)}function ND(n,e){if(!n)throw new Error(e)}function BD(n,e){return e}const UD=n=>{const e=n.length;let a=0,o="";for(;a<e;a++){const s=n[a];if(s==null)continue;let c;switch(typeof s){case"boolean":break;case"object":{if(Array.isArray(s))c=UD(s);else{ND(!BD(s,!1)),c="";for(const d in s)s[d]&&d&&(c&&(c+=" "),c+=d)}break}default:c=s}c&&(o&&(o+=" "),o+=c)}return o};function Uve(n,e){const a=re.useRef();return(!a.current||e.length!==a.current.prevDeps.length||a.current.prevDeps.map((o,s)=>o===e[s]).indexOf(!1)>=0)&&(a.current={v:n(),prevDeps:[...e]}),a.current.v}function Wve(n){return n instanceof Object&&!("styles"in n)&&!("length"in n)&&!("__emotion_styles"in n)}const{createCssAndCx:Vve}=(()=>{function n(a,o,s){const c=[],d=tX(a,c,s);return c.length<2?s:d+o(c)}function e(a){const{cache:o}=a,s=(...d)=>{const f=cT(d,o.registered);vD(o,f,!1);const m=`${o.key}-${f.name}`;e:{const y=d[0];if(!Wve(y))break e;nW.saveClassNameCSSObjectMapping(o,m,y)}return m};return{css:s,cx:(...d)=>{const f=UD(d),m=nW.fixClassName(o,f,s);return n(o.registered,s,m)}}}return{createCssAndCx:e}})();function DX(n){const{useCache:e}=n;function a(){const o=e(),{css:s,cx:c}=Uve(()=>Vve({cache:o}),[o]);return{css:s,cx:c}}return{useCssAndCx:a}}const nW=(()=>{const n=new WeakMap;return{saveClassNameCSSObjectMapping:(e,a,o)=>{let s=n.get(e);s===void 0&&(s=new Map,n.set(e,s)),s.set(a,o)},fixClassName:(()=>{function e(a){let o=!1;return a.map(([s,c])=>{if(c===void 0)return s;let d;if(o)d={"&&":c};else{d=s;for(const f in c)if(f.startsWith("@media")){o=!0;break}}return d})}return(a,o,s)=>{const c=n.get(a);return UD(e(o.split(" ").map(d=>[d,c==null?void 0:c.get(d)])).map(d=>typeof d=="string"?d:s(d)))}})()}})();function e_(n){if(!(n instanceof Object)||typeof n=="function")return n;const e=[];for(const a in n){const o=n[a],s=typeof o;if(!(s==="string"||s==="number"&&!isNaN(o)||s==="boolean"||o===void 0||o===null))return n;e.push(`${a}:${s}_${o}`)}return"xSqLiJdLMd9s"+e.join("|")}function WD(n,e,a){if(!(e instanceof Object))return n;const o={};return Q0(n).forEach(s=>o[s]=a(n[s],e[s])),Q0(e).forEach(s=>{if(s in n)return;const c=e[s];typeof c=="string"&&(o[s]=c)}),o}const OX=({classes:n,theme:e,muiStyleOverridesParams:a,css:o,cx:s,name:c})=>{var d,f;e:{if(c==="makeStyle no name"){c=void 0;break e}if(a!==void 0&&c===void 0)throw new Error("To use muiStyleOverridesParams, you must specify a name using .withName('MyComponent')")}let m;try{m=c===void 0?void 0:((f=(d=e.components)===null||d===void 0?void 0:d[c])===null||f===void 0?void 0:f.styleOverrides)||void 0}catch{}const y=re.useMemo(()=>{if(m===void 0)return;const _={};for(const x in m){const S=m[x];S instanceof Object&&(_[x]=o(typeof S=="function"?S(Object.assign({theme:e,ownerState:a==null?void 0:a.ownerState},a==null?void 0:a.props)):S))}return _},[m,e_(a==null?void 0:a.props),e_(a==null?void 0:a.ownerState),o]);return n=re.useMemo(()=>WD(n,y,s),[n,y,s]),{classes:n}};let Gve=0;function zX(n){const{useTheme:e,cache:a}=n,{useCache:o}=FX({cacheProvidedAtInception:a}),{useCssAndCx:s}=DX({useCache:o});function c(f){const{name:m,uniqId:y=`${Gve++}`}=f??{},_=typeof m!="object"?m:Object.keys(m)[0];return function(x){const S=typeof x=="function"?x:()=>x;return function(I,k){const D=e();let{css:L,cx:O}=s();const F=o();let B=re.useMemo(()=>{const G={},q=typeof Proxy<"u"&&new Proxy({},{get:(V,Q)=>(typeof Q=="symbol"&&ND(!1),G[Q]=`${F.key}-${y}${_!==void 0?`-${_}`:""}-${Q}-ref`)}),X=S(D,I,q||{}),te=kX(Q0(X).map(V=>{const Q=X[V];return Q.label||(Q.label=`${_!==void 0?`${_}-`:""}${V}`),[V,`${L(Q)}${BD(V,V in G)?` ${G[V]}`:""}`]}));return Q0(G).forEach(V=>{V in te||(te[V]=G[V])}),te},[F,L,O,D,e_(I)]);{const G=k==null?void 0:k.props.classes;B=re.useMemo(()=>WD(B,G,O),[B,e_(G),O])}{const G=OX({classes:B,css:L,cx:O,name:_??"makeStyle no name",idOfUseStyles:y,muiStyleOverridesParams:k,theme:D});G.classes!==void 0&&(B=G.classes),G.css!==void 0&&(L=G.css),G.cx!==void 0&&(O=G.cx)}return{classes:B,theme:D,css:L,cx:O}}}}function d(){const f=e(),{css:m,cx:y}=s();return{theme:f,css:m,cx:y}}return{makeStyles:c,useStyles:d}}const Hve=re.createContext(void 0),{createUseCache:FX}=(()=>{function n(){return re.useContext(Hve)}function e(a){const{cacheProvidedAtInception:o}=a;function s(){var c;const d=wde(),f=n(),m=(c=o??f)!==null&&c!==void 0?c:d;if(m===null)throw new Error(["In order to get SSR working with tss-react you need to explicitly provide an Emotion cache.","MUI users be aware: This is not an error strictly related to tss-react, with or without tss-react,","MUI needs an Emotion cache to be provided for SSR to work.","Here is the MUI documentation related to SSR setup: https://mui.com/material-ui/guides/server-rendering/","TSS provides helper that makes the process of setting up SSR easier: https://docs.tss-react.dev/ssr"].join(`
`));return m}return{useCache:s}}return{createUseCache:e}})();function aW(n){return n.charAt(0).toUpperCase()+n.slice(1)}var iW=globalThis&&globalThis.__rest||function(n,e){var a={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(a[o[s]]=n[o[s]]);return a};function jve(n){const{useTheme:e,cache:a}=n,{makeStyles:o}=zX({useTheme:e,cache:a});function s(c,d,f){const m=typeof c=="string"?(()=>{const T=c,I=function(k){var{children:D}=k,L=iW(k,["children"]);return re.createElement(T,L,D)};return Object.defineProperty(I,"name",{value:aW(T)}),I})():c,y=(()=>{{const{name:T}=f??{};if(T!==void 0)return typeof T!="object"?T:Object.keys(T)[0]}{const T=m.displayName;if(typeof T=="string"&&T!=="")return T}{const{name:T}=m;if(T)return T.replace(/\$/g,"usd")}})(),_=o(Object.assign(Object.assign({},f),{name:y}))(typeof d=="function"?(T,I,k)=>oW(d(T,I,k)):oW(d));function x(T){for(const I in T)if(I!=="root")return!0;return!1}const S=re.forwardRef(function(T,I){const{className:k,classes:D}=T,L=iW(T,["className","classes"]),{classes:O,cx:F}=_(T,{props:T}),B=F(O.root,k);return NX.set(O,Object.assign(Object.assign({},O),{root:B})),ee(m,{...Object.assign({ref:I,className:x(O)?k:B},typeof c=="string"?{}:{classes:O},L)})});return y!==void 0&&(S.displayName=`${aW(y)}WithStyles`,Object.defineProperty(S,"name",{value:S.displayName})),S}return s.getClasses=$ve,{withStyles:s}}const NX=new WeakMap,rW="getClasses should only be used in conjunction with withStyles";function $ve(n){const e=n.classes;if(e===void 0)throw new Error(rW);const a=NX.get(e);if(a===void 0)throw new Error(rW);return a}function oW(n){const e={},a={};return Object.keys(n).forEach(o=>(o.startsWith("@media")?a:e)[o]=n[o]),Object.keys(a).forEach(o=>{const s=a[o];Object.keys(s).forEach(c=>{var d;return e[c]=Object.assign(Object.assign({},(d=e[c])!==null&&d!==void 0?d:{}),{[o]:s[c]})})}),e}const qve=(()=>!(typeof document=="object"&&typeof(document==null?void 0:document.getElementById)=="function")&&!(typeof jest<"u")&&!(typeof mocha<"u")&&!(typeof __vitest_worker__<"u"))();var Xve=globalThis&&globalThis.__rest||function(n,e){var a={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(a[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(a[o[s]]=n[o[s]]);return a};function BX(n){const{useContext:e,usePlugin:a,cache:o}=n,{useCache:s}=FX({cacheProvidedAtInception:o}),{useCssAndCx:c}=DX({useCache:s});return{tss:qA({useContext:e,useCache:s,useCssAndCx:c,usePlugin:a??(({classes:m,cx:y,css:_})=>({classes:m,cx:y,css:_})),name:void 0,doesUseNestedSelectors:!1})}}let Yve=0;const _4=[];function qA(n){const{useContext:e,useCache:a,useCssAndCx:o,usePlugin:s,name:c,doesUseNestedSelectors:d}=n;return{withParams:()=>qA(Object.assign({},n)),withName:f=>qA(Object.assign(Object.assign({},n),{name:typeof f!="object"?f:Object.keys(f)[0]})),withNestedSelectors:()=>qA(Object.assign(Object.assign({},n),{doesUseNestedSelectors:!0})),create:f=>{const m=`x${Yve++}`,y=typeof f=="function"?f:()=>f;return function(x){var S,T,I;const k=x??{},{classesOverrides:D}=k,L=Xve(k,["classesOverrides"]),O=e(),{css:F,cx:B}=o(),G=a();let q=re.useMemo(()=>{const te={},V=y(Object.assign(Object.assign(Object.assign({},x),O),d?{classes:typeof Proxy>"u"?{}:new Proxy({},{get:(ge,me)=>{if(typeof me=="symbol"&&ND(!1),qve){{let be=_4.find(fe=>fe.name===c&&fe.idOfUseStyles===m);be===void 0&&(be={name:c,idOfUseStyles:m,nestedSelectorRuleNames:new Set},_4.push(be)),be.nestedSelectorRuleNames.add(me)}if(_4.find(be=>be.name===c&&be.idOfUseStyles!==m&&be.nestedSelectorRuleNames.has(me))!==void 0)throw new Error([`tss-react: Duplicate nested selector "${me}" detected in ${c===void 0?`useStyles named "${c}"`:"anonymous useStyles function"}.`,"In SSR setups, this may lead to CSS class name collisions, causing nested selectors to target elements outside of the intended scope.",'Solution: Ensure each useStyles using nested selectors has a unique name. Use tss.withName("UniqueName").withNestedSelectors<...>()... to set a name.'].join(`
`))}return te[me]=`${G.key}-${m}${c!==void 0?`-${c}`:""}-${me}-ref`}})}:{})),Q=kX(Q0(V).map(ge=>{const me=V[ge];return me.label||(me.label=`${c!==void 0?`${c}-`:""}${ge}`),[ge,`${F(me)}${BD(ge,ge in te)?` ${te[ge]}`:""}`]}));return Q0(te).forEach(ge=>{ge in Q||(Q[ge]=te[ge])}),Q},[G,F,B,e_(x),...Object.values(O)]);q=re.useMemo(()=>WD(q,D,B),[q,e_(D),B]);const X=s(Object.assign(Object.assign({classes:q,css:F,cx:B,idOfUseStyles:m,name:c},O),L));return Object.assign({classes:(S=X.classes)!==null&&S!==void 0?S:q,css:(T=X.css)!==null&&T!==void 0?T:F,cx:(I=X.cx)!==null&&I!==void 0?I:B},O)}}}}function Zve(n){return Object.assign(Object.assign({},zX(n)),jve(n))}const{tss:Kve}=BX({useContext:()=>({})});Kve.create({});const{makeStyles:Kr,withStyles:GIe}=Zve({useTheme:p_}),{tss:Jve}=BX({useContext:function(){return{theme:p_()}},usePlugin:OX});Jve.create({});const VD=Kr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{maxWidth:"100%",margin:"0 auto",padding:"0 5%"},gradient:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:1,backgroundImage:"radial-gradient(53.6% 37.94% at 49.21% 62.06%, rgba(33, 63, 178, 0) 0%, #1424A2 100%)"},graph3dWrapper:{backgroundColor:"transparent",zIndex:1,position:"absolute",top:"-30%",left:"8%",width:"100%",height:"130%"}}),TT=Kr()({root:{position:"absolute",marginTop:"1.5vh",zIndex:1},titleWrapper:{display:"flex",flexDirection:"row",gap:"5vh",alignItems:"center",justifyContent:"flex-start"},cityNameAndCountryNameWrapper:{display:"flex",flexDirection:"column"},cityName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"10.8vh",marginLeft:"-1vh"},cityDescription:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.6vh",opacity:"0.5"},countryName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",marginTop:"-0.95vh"},statWrapper:{display:"flex",flexDirection:"row",gap:"3.5vh",alignItems:"center",justifyContent:"flex-start",marginTop:"2vh"},statItem:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},statTitle:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statValue:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.95vh",marginTop:"-0.40vh"},statStatus:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"1.4vh",color:"#2D67FF",border:"1px solid #2D67FF",borderRadius:"50px",padding:"0.6rem .9rem",marginTop:"0vh"},statsContainer:{width:"63.5vh",marginTop:"5.5vh",marginLeft:"-2vh",padding:0,paddingLeft:"2vh",borderLeft:"1px solid #fff"},statStatusBig:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"2vh",borderRadius:"50px",marginTop:"0vh"},statItemBigWrapper:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},smallRowWrapper:{position:"relative",width:"auto"},lowOpacityLabel:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statsBigText:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"2.5vh",width:"22vh"},statsSmallText:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.5vh"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"29vh",pointerEvents:"none",height:"5vh",marginLeft:"0vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),GD=Kr()({root:{zIndex:2,position:"relative",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),HD=Kr()({root:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"90vh"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{position:"absolute",top:"48%",width:"40%",paddingTop:"18px",fontFamily:"SuisseIntl-Thin",lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",pointerEvents:"none"},bigTextBlue:{paddingTop:"18px",fontFamily:"SuisseIntl-Medium",fontWeight:500,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#2D67FF"},textAndToggleWrapper:{zIndex:2,display:"flex",flexDirection:"column",gap:"30px",pointerEvents:"none"},filterButtonAndScaleWrapper:{zIndex:1,minWidth:"100px",display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"space-between"},filterSelect:{zIndex:2,borderRadius:"50px",background:"white",minWidth:"unset",minHeight:"unset",height:"4.6vh",fontSize:"1.8vh",padding:"0px 0px 0px 5px","& .MuiSelect-select":{padding:"0px 0px 0px 15px","&:focus":{backgroundColor:"transparent"}}},filterButton:{minWidth:"unset",minHeight:"unset",height:"4.6vh",fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#000000",textTransform:"none",fontSize:"1.8vh",zIndex:2,backgroundColor:"rgba(255, 255, 255, 1)",borderRadius:"50px",padding:"0.5rem 1rem",opacity:"1","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.85)"}},topLineWrapper:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:"row"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"40px",pointerEvents:"none",height:"10vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"17px",color:"#7386CA",cursor:"pointer"},legendLine:{position:"absolute",height:"51.5vh",top:"50%",right:"5%",transform:"translate(0, -45%)",pointerEvents:"none",zIndex:"1"},filterButtonsWrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"-92vh",alignSelf:"end"},blurAll:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:2,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)"}}),Qve=ca(Nve)(()=>({"& .MuiToggleButtonGroup-grouped":{borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",textTransform:"none",pointerEvents:"all"}})),sW=ca(Ive)({"&.MuiToggleButton-root":{fontFamily:"SuisseIntl-Regular",fontSize:"4vh",textTransform:"none",borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",backgroundColor:"transparent",padding:"0.2rem 1.5rem","&:hover":{backgroundColor:"#fff",color:"#000"}},"&.Mui-selected":{backgroundColor:"#fff",color:"#000"}}),e0e=({children:n,backgroundColor:e})=>{const{classes:a}=VD(),o="#1433AE";return ee("div",{className:a.root,style:{backgroundColor:e||o},children:ee("div",{className:a.contentWrapper,children:n})})},t0e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},n0e=({isCitySelected:n,setSelectedCity:e,setMenuVisible:a})=>{const o=c=>t0e[c],{classes:s}=GD();return Je("div",{className:s.root,children:[Je("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[n&&Je("div",{onClick:()=>{e(null)},className:s.menuIconWrapper,children:[ee("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:s.whiteText,children:o("back")})]}),Je("div",{onClick:()=>a(!0),className:s.menuIconWrapper,children:[ee("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:s.whiteText,children:o("menu")})]})]}),ee("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Je("div",{className:s.buttonsWrapper,children:[ee(Or,{className:s.whiteText,children:o("login")}),ee(Or,{className:s.signUpButton,style:{backgroundColor:n?"#FFFFFF":"#2D67FF",color:n?"#1433AE":"#FFFFFF"},children:o("signup")})]})]})},a0e=({map:n})=>Je("div",{style:{position:"relative",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[ee("div",{onClick:()=>{n&&n.zoomIn()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:ee("img",{src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),ee("div",{onClick:()=>{n&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:ee("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const CT="158",Zm={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Km={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},UX=0,$L=1,WX=2,i0e=3,VX=0,PT=1,Jb=2,tu=3,yd=0,Ss=1,Hl=2,r0e=2,Ih=0,_g=1,qL=2,XL=3,YL=4,GX=5,$f=100,HX=101,jX=102,ZL=103,KL=104,$X=200,qX=201,XX=202,YX=203,YE=204,ZE=205,ZX=206,KX=207,JX=208,QX=209,eY=210,tY=211,nY=212,aY=213,iY=214,rY=0,oY=1,sY=2,Fx=3,lY=4,cY=5,uY=6,dY=7,Lw=0,hY=1,fY=2,hd=0,pY=1,mY=2,gY=3,jD=4,yY=5,JL="attached",vY="detached",IT=300,Nh=301,vp=302,Nx=303,Bx=304,g_=306,Ux=1e3,xs=1001,Wx=1002,lo=1003,KE=1004,o0e=1004,Qb=1005,s0e=1005,Ir=1006,$D=1007,l0e=1007,_p=1008,c0e=1008,fd=1009,_Y=1010,bY=1011,LT=1012,qD=1013,Ah=1014,sd=1015,t_=1016,XD=1017,YD=1018,up=1020,xY=1021,pl=1023,wY=1024,SY=1025,dp=1026,kg=1027,AY=1028,ZD=1029,EY=1030,KD=1031,JD=1033,XA=33776,YA=33777,ZA=33778,KA=33779,QL=35840,eR=35841,tR=35842,nR=35843,MY=36196,aR=37492,iR=37496,rR=37808,oR=37809,sR=37810,lR=37811,cR=37812,uR=37813,dR=37814,hR=37815,fR=37816,pR=37817,mR=37818,gR=37819,yR=37820,vR=37821,JA=36492,_R=36494,bR=36495,TY=36283,xR=36284,wR=36285,SR=36286,CY=2200,PY=2201,IY=2202,Vx=2300,Gx=2301,QA=2302,ug=2400,dg=2401,Hx=2402,RT=2500,QD=2501,u0e=0,d0e=1,h0e=2,e6=3e3,hp=3001,LY=3200,t6=3201,Mp=0,RY=1,jl="",Io="srgb",vd="srgb-linear",kT="display-p3",Rw="display-p3-linear",jx="linear",Qi="srgb",$x="rec709",qx="p3",f0e=0,Jm=7680,p0e=7681,m0e=7682,g0e=7683,y0e=34055,v0e=34056,_0e=5386,b0e=512,x0e=513,w0e=514,S0e=515,A0e=516,E0e=517,M0e=518,AR=519,kY=512,DY=513,OY=514,zY=515,FY=516,NY=517,BY=518,UY=519,Xx=35044,T0e=35048,C0e=35040,P0e=35045,I0e=35049,L0e=35041,R0e=35046,k0e=35050,D0e=35042,O0e="100",ER="300 es",JE=1035,ld=2e3,Yx=2001;class xd{addEventListener(e,a){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(a)===-1&&o[e].push(a)}hasEventListener(e,a){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(a)!==-1}removeEventListener(e,a){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const c=s.indexOf(a);c!==-1&&s.splice(c,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const o=this._listeners[e.type];if(o!==void 0){e.target=this;const s=o.slice(0);for(let c=0,d=s.length;c<d;c++)s[c].call(this,e);e.target=null}}}const gs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let lW=1234567;const bg=Math.PI/180,n_=180/Math.PI;function Zl(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(gs[n&255]+gs[n>>8&255]+gs[n>>16&255]+gs[n>>24&255]+"-"+gs[e&255]+gs[e>>8&255]+"-"+gs[e>>16&15|64]+gs[e>>24&255]+"-"+gs[a&63|128]+gs[a>>8&255]+"-"+gs[a>>16&255]+gs[a>>24&255]+gs[o&255]+gs[o>>8&255]+gs[o>>16&255]+gs[o>>24&255]).toLowerCase()}function $r(n,e,a){return Math.max(e,Math.min(a,n))}function n6(n,e){return(n%e+e)%e}function z0e(n,e,a,o,s){return o+(n-e)*(s-o)/(a-e)}function F0e(n,e,a){return n!==e?(a-n)/(e-n):0}function ex(n,e,a){return(1-a)*n+a*e}function N0e(n,e,a,o){return ex(n,e,1-Math.exp(-a*o))}function B0e(n,e=1){return e-Math.abs(n6(n,e*2)-e)}function U0e(n,e,a){return n<=e?0:n>=a?1:(n=(n-e)/(a-e),n*n*(3-2*n))}function W0e(n,e,a){return n<=e?0:n>=a?1:(n=(n-e)/(a-e),n*n*n*(n*(n*6-15)+10))}function V0e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function G0e(n,e){return n+Math.random()*(e-n)}function H0e(n){return n*(.5-Math.random())}function j0e(n){n!==void 0&&(lW=n);let e=lW+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function $0e(n){return n*bg}function q0e(n){return n*n_}function MR(n){return(n&n-1)===0&&n!==0}function WY(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function QE(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function X0e(n,e,a,o,s){const c=Math.cos,d=Math.sin,f=c(a/2),m=d(a/2),y=c((e+o)/2),_=d((e+o)/2),x=c((e-o)/2),S=d((e-o)/2),T=c((o-e)/2),I=d((o-e)/2);switch(s){case"XYX":n.set(f*_,m*x,m*S,f*y);break;case"YZY":n.set(m*S,f*_,m*x,f*y);break;case"ZXZ":n.set(m*x,m*S,f*_,f*y);break;case"XZX":n.set(f*_,m*I,m*T,f*y);break;case"YXY":n.set(m*T,f*_,m*I,f*y);break;case"ZYZ":n.set(m*I,m*T,f*_,f*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function ml(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ba(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Y0e={DEG2RAD:bg,RAD2DEG:n_,generateUUID:Zl,clamp:$r,euclideanModulo:n6,mapLinear:z0e,inverseLerp:F0e,lerp:ex,damp:N0e,pingpong:B0e,smoothstep:U0e,smootherstep:W0e,randInt:V0e,randFloat:G0e,randFloatSpread:H0e,seededRandom:j0e,degToRad:$0e,radToDeg:q0e,isPowerOfTwo:MR,ceilPowerOfTwo:WY,floorPowerOfTwo:QE,setQuaternionFromProperEuler:X0e,normalize:Ba,denormalize:ml};class Kt{constructor(e=0,a=0){Kt.prototype.isVector2=!0,this.x=e,this.y=a}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,a){return this.x=e,this.y=a,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const a=this.x,o=this.y,s=e.elements;return this.x=s[0]*a+s[3]*o+s[6],this.y=s[1]*a+s[4]*o+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const a=Math.sqrt(this.lengthSq()*e.lengthSq());if(a===0)return Math.PI/2;const o=this.dot(e)/a;return Math.acos($r(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const a=this.x-e.x,o=this.y-e.y;return a*a+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this}rotateAround(e,a){const o=Math.cos(a),s=Math.sin(a),c=this.x-e.x,d=this.y-e.y;return this.x=c*o-d*s+e.x,this.y=c*s+d*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Na{constructor(e,a,o,s,c,d,f,m,y){Na.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,a,o,s,c,d,f,m,y)}set(e,a,o,s,c,d,f,m,y){const _=this.elements;return _[0]=e,_[1]=s,_[2]=f,_[3]=a,_[4]=c,_[5]=m,_[6]=o,_[7]=d,_[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const a=this.elements,o=e.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],this}extractBasis(e,a,o){return e.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const a=e.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,a){const o=e.elements,s=a.elements,c=this.elements,d=o[0],f=o[3],m=o[6],y=o[1],_=o[4],x=o[7],S=o[2],T=o[5],I=o[8],k=s[0],D=s[3],L=s[6],O=s[1],F=s[4],B=s[7],G=s[2],q=s[5],X=s[8];return c[0]=d*k+f*O+m*G,c[3]=d*D+f*F+m*q,c[6]=d*L+f*B+m*X,c[1]=y*k+_*O+x*G,c[4]=y*D+_*F+x*q,c[7]=y*L+_*B+x*X,c[2]=S*k+T*O+I*G,c[5]=S*D+T*F+I*q,c[8]=S*L+T*B+I*X,this}multiplyScalar(e){const a=this.elements;return a[0]*=e,a[3]*=e,a[6]*=e,a[1]*=e,a[4]*=e,a[7]*=e,a[2]*=e,a[5]*=e,a[8]*=e,this}determinant(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8];return a*d*_-a*f*y-o*c*_+o*f*m+s*c*y-s*d*m}invert(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8],x=_*d-f*y,S=f*m-_*c,T=y*c-d*m,I=a*x+o*S+s*T;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const k=1/I;return e[0]=x*k,e[1]=(s*y-_*o)*k,e[2]=(f*o-s*d)*k,e[3]=S*k,e[4]=(_*a-s*m)*k,e[5]=(s*c-f*a)*k,e[6]=T*k,e[7]=(o*m-y*a)*k,e[8]=(d*a-o*c)*k,this}transpose(){let e;const a=this.elements;return e=a[1],a[1]=a[3],a[3]=e,e=a[2],a[2]=a[6],a[6]=e,e=a[5],a[5]=a[7],a[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const a=this.elements;return e[0]=a[0],e[1]=a[3],e[2]=a[6],e[3]=a[1],e[4]=a[4],e[5]=a[7],e[6]=a[2],e[7]=a[5],e[8]=a[8],this}setUvTransform(e,a,o,s,c,d,f){const m=Math.cos(c),y=Math.sin(c);return this.set(o*m,o*y,-o*(m*d+y*f)+d+e,-s*y,s*m,-s*(-y*d+m*f)+f+a,0,0,1),this}scale(e,a){return this.premultiply(b4.makeScale(e,a)),this}rotate(e){return this.premultiply(b4.makeRotation(-e)),this}translate(e,a){return this.premultiply(b4.makeTranslation(e,a)),this}makeTranslation(e,a){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,a,0,0,1),this}makeRotation(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,-o,0,o,a,0,0,0,1),this}makeScale(e,a){return this.set(e,0,0,0,a,0,0,0,1),this}equals(e){const a=this.elements,o=e.elements;for(let s=0;s<9;s++)if(a[s]!==o[s])return!1;return!0}fromArray(e,a=0){for(let o=0;o<9;o++)this.elements[o]=e[o+a];return this}toArray(e=[],a=0){const o=this.elements;return e[a]=o[0],e[a+1]=o[1],e[a+2]=o[2],e[a+3]=o[3],e[a+4]=o[4],e[a+5]=o[5],e[a+6]=o[6],e[a+7]=o[7],e[a+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const b4=new Na;function VY(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const Z0e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function b0(n,e){return new Z0e[n](e)}function Zx(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function GY(){const n=Zx("canvas");return n.style.display="block",n}const cW={};function tx(n){n in cW||(cW[n]=!0,console.warn(n))}const uW=new Na().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),dW=new Na().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),dS={[vd]:{transfer:jx,primaries:$x,toReference:n=>n,fromReference:n=>n},[Io]:{transfer:Qi,primaries:$x,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Rw]:{transfer:jx,primaries:qx,toReference:n=>n.applyMatrix3(dW),fromReference:n=>n.applyMatrix3(uW)},[kT]:{transfer:Qi,primaries:qx,toReference:n=>n.convertSRGBToLinear().applyMatrix3(dW),fromReference:n=>n.applyMatrix3(uW).convertLinearToSRGB()}},K0e=new Set([vd,Rw]),zi={enabled:!0,_workingColorSpace:vd,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!K0e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,a){if(this.enabled===!1||e===a||!e||!a)return n;const o=dS[e].toReference,s=dS[a].fromReference;return s(o(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return dS[n].primaries},getTransfer:function(n){return n===jl?jx:dS[n].transfer}};function O0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function x4(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Iv;class a6{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let a;if(e instanceof HTMLCanvasElement)a=e;else{Iv===void 0&&(Iv=Zx("canvas")),Iv.width=e.width,Iv.height=e.height;const o=Iv.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),a=Iv}return a.width>2048||a.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),a.toDataURL("image/jpeg",.6)):a.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const a=Zx("canvas");a.width=e.width,a.height=e.height;const o=a.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const s=o.getImageData(0,0,e.width,e.height),c=s.data;for(let d=0;d<c.length;d++)c[d]=O0(c[d]/255)*255;return o.putImageData(s,0,0),a}else if(e.data){const a=e.data.slice(0);for(let o=0;o<a.length;o++)a instanceof Uint8Array||a instanceof Uint8ClampedArray?a[o]=Math.floor(O0(a[o]/255)*255):a[o]=O0(a[o]);return{data:a,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let J0e=0;class hg{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:J0e++}),this.uuid=Zl(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const a=e===void 0||typeof e=="string";if(!a&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const o={uuid:this.uuid,url:""},s=this.data;if(s!==null){let c;if(Array.isArray(s)){c=[];for(let d=0,f=s.length;d<f;d++)s[d].isDataTexture?c.push(w4(s[d].image)):c.push(w4(s[d]))}else c=w4(s);o.url=c}return a||(e.images[this.uuid]=o),o}}function w4(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?a6.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Q0e=0;class kr extends xd{constructor(e=kr.DEFAULT_IMAGE,a=kr.DEFAULT_MAPPING,o=xs,s=xs,c=Ir,d=_p,f=pl,m=fd,y=kr.DEFAULT_ANISOTROPY,_=jl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Q0e++}),this.uuid=Zl(),this.name="",this.source=new hg(e),this.mipmaps=[],this.mapping=a,this.channel=0,this.wrapS=o,this.wrapT=s,this.magFilter=c,this.minFilter=d,this.anisotropy=y,this.format=f,this.internalFormat=null,this.type=m,this.offset=new Kt(0,0),this.repeat=new Kt(1,1),this.center=new Kt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Na,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof _=="string"?this.colorSpace=_:(tx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_===hp?Io:jl),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const a=e===void 0||typeof e=="string";if(!a&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),a||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==IT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ux:e.x=e.x-Math.floor(e.x);break;case xs:e.x=e.x<0?0:1;break;case Wx:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ux:e.y=e.y-Math.floor(e.y);break;case xs:e.y=e.y<0?0:1;break;case Wx:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return tx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Io?hp:e6}set encoding(e){tx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===hp?Io:jl}}kr.DEFAULT_IMAGE=null;kr.DEFAULT_MAPPING=IT;kr.DEFAULT_ANISOTROPY=1;class Ei{constructor(e=0,a=0,o=0,s=1){Ei.prototype.isVector4=!0,this.x=e,this.y=a,this.z=o,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,a,o,s){return this.x=e,this.y=a,this.z=o,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this.w=e.w+a.w,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this.w+=e.w*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this.w=e.w-a.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const a=this.x,o=this.y,s=this.z,c=this.w,d=e.elements;return this.x=d[0]*a+d[4]*o+d[8]*s+d[12]*c,this.y=d[1]*a+d[5]*o+d[9]*s+d[13]*c,this.z=d[2]*a+d[6]*o+d[10]*s+d[14]*c,this.w=d[3]*a+d[7]*o+d[11]*s+d[15]*c,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const a=Math.sqrt(1-e.w*e.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/a,this.y=e.y/a,this.z=e.z/a),this}setAxisAngleFromRotationMatrix(e){let a,o,s,c;const m=e.elements,y=m[0],_=m[4],x=m[8],S=m[1],T=m[5],I=m[9],k=m[2],D=m[6],L=m[10];if(Math.abs(_-S)<.01&&Math.abs(x-k)<.01&&Math.abs(I-D)<.01){if(Math.abs(_+S)<.1&&Math.abs(x+k)<.1&&Math.abs(I+D)<.1&&Math.abs(y+T+L-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;const F=(y+1)/2,B=(T+1)/2,G=(L+1)/2,q=(_+S)/4,X=(x+k)/4,te=(I+D)/4;return F>B&&F>G?F<.01?(o=0,s=.707106781,c=.707106781):(o=Math.sqrt(F),s=q/o,c=X/o):B>G?B<.01?(o=.707106781,s=0,c=.707106781):(s=Math.sqrt(B),o=q/s,c=te/s):G<.01?(o=.707106781,s=.707106781,c=0):(c=Math.sqrt(G),o=X/c,s=te/c),this.set(o,s,c,a),this}let O=Math.sqrt((D-I)*(D-I)+(x-k)*(x-k)+(S-_)*(S-_));return Math.abs(O)<.001&&(O=1),this.x=(D-I)/O,this.y=(x-k)/O,this.z=(S-_)/O,this.w=Math.acos((y+T+L-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this.w=Math.max(e.w,Math.min(a.w,this.w)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this.w=Math.max(e,Math.min(a,this.w)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this.w+=(e.w-this.w)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this.z=e.z+(a.z-e.z)*o,this.w=e.w+(a.w-e.w)*o,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this.z=e[a+2],this.w=e[a+3],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e[a+3]=this.w,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this.w=e.getW(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class HY extends xd{constructor(e=1,a=1,o={}){super(),this.isRenderTarget=!0,this.width=e,this.height=a,this.depth=1,this.scissor=new Ei(0,0,e,a),this.scissorTest=!1,this.viewport=new Ei(0,0,e,a);const s={width:e,height:a,depth:1};o.encoding!==void 0&&(tx("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),o.colorSpace=o.encoding===hp?Io:jl),o=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ir,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},o),this.texture=new kr(s,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps,this.texture.internalFormat=o.internalFormat,this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this.samples=o.samples}setSize(e,a,o=1){(this.width!==e||this.height!==a||this.depth!==o)&&(this.width=e,this.height=a,this.depth=o,this.texture.image.width=e,this.texture.image.height=a,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const a=Object.assign({},e.texture.image);return this.texture.source=new hg(a),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class pu extends HY{constructor(e=1,a=1,o={}){super(e,a,o),this.isWebGLRenderTarget=!0}}class DT extends kr{constructor(e=null,a=1,o=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:a,height:o,depth:s},this.magFilter=lo,this.minFilter=lo,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class e_e extends pu{constructor(e=1,a=1,o=1){super(e,a),this.isWebGLArrayRenderTarget=!0,this.depth=o,this.texture=new DT(null,e,a,o),this.texture.isRenderTargetTexture=!0}}class i6 extends kr{constructor(e=null,a=1,o=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:a,height:o,depth:s},this.magFilter=lo,this.minFilter=lo,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class t_e extends pu{constructor(e=1,a=1,o=1){super(e,a),this.isWebGL3DRenderTarget=!0,this.depth=o,this.texture=new i6(null,e,a,o),this.texture.isRenderTargetTexture=!0}}class n_e extends pu{constructor(e=1,a=1,o=1,s={}){super(e,a,s),this.isWebGLMultipleRenderTargets=!0;const c=this.texture;this.texture=[];for(let d=0;d<o;d++)this.texture[d]=c.clone(),this.texture[d].isRenderTargetTexture=!0}setSize(e,a,o=1){if(this.width!==e||this.height!==a||this.depth!==o){this.width=e,this.height=a,this.depth=o;for(let s=0,c=this.texture.length;s<c;s++)this.texture[s].image.width=e,this.texture[s].image.height=a,this.texture[s].image.depth=o;this.dispose()}this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let a=0,o=e.texture.length;a<o;a++)this.texture[a]=e.texture[a].clone(),this.texture[a].isRenderTargetTexture=!0;return this}}class As{constructor(e=0,a=0,o=0,s=1){this.isQuaternion=!0,this._x=e,this._y=a,this._z=o,this._w=s}static slerpFlat(e,a,o,s,c,d,f){let m=o[s+0],y=o[s+1],_=o[s+2],x=o[s+3];const S=c[d+0],T=c[d+1],I=c[d+2],k=c[d+3];if(f===0){e[a+0]=m,e[a+1]=y,e[a+2]=_,e[a+3]=x;return}if(f===1){e[a+0]=S,e[a+1]=T,e[a+2]=I,e[a+3]=k;return}if(x!==k||m!==S||y!==T||_!==I){let D=1-f;const L=m*S+y*T+_*I+x*k,O=L>=0?1:-1,F=1-L*L;if(F>Number.EPSILON){const G=Math.sqrt(F),q=Math.atan2(G,L*O);D=Math.sin(D*q)/G,f=Math.sin(f*q)/G}const B=f*O;if(m=m*D+S*B,y=y*D+T*B,_=_*D+I*B,x=x*D+k*B,D===1-f){const G=1/Math.sqrt(m*m+y*y+_*_+x*x);m*=G,y*=G,_*=G,x*=G}}e[a]=m,e[a+1]=y,e[a+2]=_,e[a+3]=x}static multiplyQuaternionsFlat(e,a,o,s,c,d){const f=o[s],m=o[s+1],y=o[s+2],_=o[s+3],x=c[d],S=c[d+1],T=c[d+2],I=c[d+3];return e[a]=f*I+_*x+m*T-y*S,e[a+1]=m*I+_*S+y*x-f*T,e[a+2]=y*I+_*T+f*S-m*x,e[a+3]=_*I-f*x-m*S-y*T,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,a,o,s){return this._x=e,this._y=a,this._z=o,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,a){const o=e._x,s=e._y,c=e._z,d=e._order,f=Math.cos,m=Math.sin,y=f(o/2),_=f(s/2),x=f(c/2),S=m(o/2),T=m(s/2),I=m(c/2);switch(d){case"XYZ":this._x=S*_*x+y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x-S*T*I;break;case"YXZ":this._x=S*_*x+y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x+S*T*I;break;case"ZXY":this._x=S*_*x-y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x-S*T*I;break;case"ZYX":this._x=S*_*x-y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x+S*T*I;break;case"YZX":this._x=S*_*x+y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x-S*T*I;break;case"XZY":this._x=S*_*x-y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x+S*T*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return a!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,a){const o=a/2,s=Math.sin(o);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const a=e.elements,o=a[0],s=a[4],c=a[8],d=a[1],f=a[5],m=a[9],y=a[2],_=a[6],x=a[10],S=o+f+x;if(S>0){const T=.5/Math.sqrt(S+1);this._w=.25/T,this._x=(_-m)*T,this._y=(c-y)*T,this._z=(d-s)*T}else if(o>f&&o>x){const T=2*Math.sqrt(1+o-f-x);this._w=(_-m)/T,this._x=.25*T,this._y=(s+d)/T,this._z=(c+y)/T}else if(f>x){const T=2*Math.sqrt(1+f-o-x);this._w=(c-y)/T,this._x=(s+d)/T,this._y=.25*T,this._z=(m+_)/T}else{const T=2*Math.sqrt(1+x-o-f);this._w=(d-s)/T,this._x=(c+y)/T,this._y=(m+_)/T,this._z=.25*T}return this._onChangeCallback(),this}setFromUnitVectors(e,a){let o=e.dot(a)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*a.z-e.z*a.y,this._y=e.z*a.x-e.x*a.z,this._z=e.x*a.y-e.y*a.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs($r(this.dot(e),-1,1)))}rotateTowards(e,a){const o=this.angleTo(e);if(o===0)return this;const s=Math.min(1,a/o);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,a){const o=e._x,s=e._y,c=e._z,d=e._w,f=a._x,m=a._y,y=a._z,_=a._w;return this._x=o*_+d*f+s*y-c*m,this._y=s*_+d*m+c*f-o*y,this._z=c*_+d*y+o*m-s*f,this._w=d*_-o*f-s*m-c*y,this._onChangeCallback(),this}slerp(e,a){if(a===0)return this;if(a===1)return this.copy(e);const o=this._x,s=this._y,c=this._z,d=this._w;let f=d*e._w+o*e._x+s*e._y+c*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=d,this._x=o,this._y=s,this._z=c,this;const m=1-f*f;if(m<=Number.EPSILON){const T=1-a;return this._w=T*d+a*this._w,this._x=T*o+a*this._x,this._y=T*s+a*this._y,this._z=T*c+a*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(m),_=Math.atan2(y,f),x=Math.sin((1-a)*_)/y,S=Math.sin(a*_)/y;return this._w=d*x+this._w*S,this._x=o*x+this._x*S,this._y=s*x+this._y*S,this._z=c*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,a,o){return this.copy(e).slerp(a,o)}random(){const e=Math.random(),a=Math.sqrt(1-e),o=Math.sqrt(e),s=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();return this.set(a*Math.cos(s),o*Math.sin(c),o*Math.cos(c),a*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,a=0){return this._x=e[a],this._y=e[a+1],this._z=e[a+2],this._w=e[a+3],this._onChangeCallback(),this}toArray(e=[],a=0){return e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._w,e}fromBufferAttribute(e,a){return this._x=e.getX(a),this._y=e.getY(a),this._z=e.getZ(a),this._w=e.getW(a),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Fe{constructor(e=0,a=0,o=0){Fe.prototype.isVector3=!0,this.x=e,this.y=a,this.z=o}set(e,a,o){return o===void 0&&(o=this.z),this.x=e,this.y=a,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this}addScaledVector(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,a){return this.x=e.x*a.x,this.y=e.y*a.y,this.z=e.z*a.z,this}applyEuler(e){return this.applyQuaternion(hW.setFromEuler(e))}applyAxisAngle(e,a){return this.applyQuaternion(hW.setFromAxisAngle(e,a))}applyMatrix3(e){const a=this.x,o=this.y,s=this.z,c=e.elements;return this.x=c[0]*a+c[3]*o+c[6]*s,this.y=c[1]*a+c[4]*o+c[7]*s,this.z=c[2]*a+c[5]*o+c[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const a=this.x,o=this.y,s=this.z,c=e.elements,d=1/(c[3]*a+c[7]*o+c[11]*s+c[15]);return this.x=(c[0]*a+c[4]*o+c[8]*s+c[12])*d,this.y=(c[1]*a+c[5]*o+c[9]*s+c[13])*d,this.z=(c[2]*a+c[6]*o+c[10]*s+c[14])*d,this}applyQuaternion(e){const a=this.x,o=this.y,s=this.z,c=e.x,d=e.y,f=e.z,m=e.w,y=2*(d*s-f*o),_=2*(f*a-c*s),x=2*(c*o-d*a);return this.x=a+m*y+d*x-f*_,this.y=o+m*_+f*y-c*x,this.z=s+m*x+c*_-d*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const a=this.x,o=this.y,s=this.z,c=e.elements;return this.x=c[0]*a+c[4]*o+c[8]*s,this.y=c[1]*a+c[5]*o+c[9]*s,this.z=c[2]*a+c[6]*o+c[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this}clampScalar(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this}clampLength(e,a){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(a,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this}lerpVectors(e,a,o){return this.x=e.x+(a.x-e.x)*o,this.y=e.y+(a.y-e.y)*o,this.z=e.z+(a.z-e.z)*o,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,a){const o=e.x,s=e.y,c=e.z,d=a.x,f=a.y,m=a.z;return this.x=s*m-c*f,this.y=c*d-o*m,this.z=o*f-s*d,this}projectOnVector(e){const a=e.lengthSq();if(a===0)return this.set(0,0,0);const o=e.dot(this)/a;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return S4.copy(this).projectOnVector(e),this.sub(S4)}reflect(e){return this.sub(S4.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const a=Math.sqrt(this.lengthSq()*e.lengthSq());if(a===0)return Math.PI/2;const o=this.dot(e)/a;return Math.acos($r(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const a=this.x-e.x,o=this.y-e.y,s=this.z-e.z;return a*a+o*o+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,a,o){const s=Math.sin(a)*e;return this.x=s*Math.sin(o),this.y=Math.cos(a)*e,this.z=s*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,a,o){return this.x=e*Math.sin(a),this.y=o,this.z=e*Math.cos(a),this}setFromMatrixPosition(e){const a=e.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this}setFromMatrixScale(e){const a=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=a,this.y=o,this.z=s,this}setFromMatrixColumn(e,a){return this.fromArray(e.elements,a*4)}setFromMatrix3Column(e,a){return this.fromArray(e.elements,a*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,a=0){return this.x=e[a],this.y=e[a+1],this.z=e[a+2],this}toArray(e=[],a=0){return e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e}fromBufferAttribute(e,a){return this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,a=Math.random()*Math.PI*2,o=Math.sqrt(1-e**2);return this.x=o*Math.cos(a),this.y=o*Math.sin(a),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const S4=new Fe,hW=new As;class gu{constructor(e=new Fe(1/0,1/0,1/0),a=new Fe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=a}set(e,a){return this.min.copy(e),this.max.copy(a),this}setFromArray(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a+=3)this.expandByPoint(Kc.fromArray(e,a));return this}setFromBufferAttribute(e){this.makeEmpty();for(let a=0,o=e.count;a<o;a++)this.expandByPoint(Kc.fromBufferAttribute(e,a));return this}setFromPoints(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a++)this.expandByPoint(e[a]);return this}setFromCenterAndSize(e,a){const o=Kc.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}setFromObject(e,a=!1){return this.makeEmpty(),this.expandByObject(e,a)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,a=!1){e.updateWorldMatrix(!1,!1);const o=e.geometry;if(o!==void 0){const c=o.getAttribute("position");if(a===!0&&c!==void 0&&e.isInstancedMesh!==!0)for(let d=0,f=c.count;d<f;d++)e.isMesh===!0?e.getVertexPosition(d,Kc):Kc.fromBufferAttribute(c,d),Kc.applyMatrix4(e.matrixWorld),this.expandByPoint(Kc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),hS.copy(e.boundingBox)):(o.boundingBox===null&&o.computeBoundingBox(),hS.copy(o.boundingBox)),hS.applyMatrix4(e.matrixWorld),this.union(hS)}const s=e.children;for(let c=0,d=s.length;c<d;c++)this.expandByObject(s[c],a);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,a){return a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Kc),Kc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let a,o;return e.normal.x>0?(a=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(a=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(a+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(a+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(a+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(a+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),a<=-e.constant&&o>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(nb),fS.subVectors(this.max,nb),Lv.subVectors(e.a,nb),Rv.subVectors(e.b,nb),kv.subVectors(e.c,nb),Df.subVectors(Rv,Lv),Of.subVectors(kv,Rv),Rm.subVectors(Lv,kv);let a=[0,-Df.z,Df.y,0,-Of.z,Of.y,0,-Rm.z,Rm.y,Df.z,0,-Df.x,Of.z,0,-Of.x,Rm.z,0,-Rm.x,-Df.y,Df.x,0,-Of.y,Of.x,0,-Rm.y,Rm.x,0];return!A4(a,Lv,Rv,kv,fS)||(a=[1,0,0,0,1,0,0,0,1],!A4(a,Lv,Rv,kv,fS))?!1:(pS.crossVectors(Df,Of),a=[pS.x,pS.y,pS.z],A4(a,Lv,Rv,kv,fS))}clampPoint(e,a){return a.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Kc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Kc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(oh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),oh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),oh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),oh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),oh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),oh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),oh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),oh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(oh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const oh=[new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe],Kc=new Fe,hS=new gu,Lv=new Fe,Rv=new Fe,kv=new Fe,Df=new Fe,Of=new Fe,Rm=new Fe,nb=new Fe,fS=new Fe,pS=new Fe,km=new Fe;function A4(n,e,a,o,s){for(let c=0,d=n.length-3;c<=d;c+=3){km.fromArray(n,c);const f=s.x*Math.abs(km.x)+s.y*Math.abs(km.y)+s.z*Math.abs(km.z),m=e.dot(km),y=a.dot(km),_=o.dot(km);if(Math.max(-Math.max(m,y,_),Math.min(m,y,_))>f)return!1}return!0}const a_e=new gu,ab=new Fe,E4=new Fe;class Pc{constructor(e=new Fe,a=-1){this.center=e,this.radius=a}set(e,a){return this.center.copy(e),this.radius=a,this}setFromPoints(e,a){const o=this.center;a!==void 0?o.copy(a):a_e.setFromPoints(e).getCenter(o);let s=0;for(let c=0,d=e.length;c<d;c++)s=Math.max(s,o.distanceToSquared(e[c]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const a=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=a*a}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,a){const o=this.center.distanceToSquared(e);return a.copy(e),o>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ab.subVectors(e,this.center);const a=ab.lengthSq();if(a>this.radius*this.radius){const o=Math.sqrt(a),s=(o-this.radius)*.5;this.center.addScaledVector(ab,s/o),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(E4.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ab.copy(e.center).add(E4)),this.expandByPoint(ab.copy(e.center).sub(E4))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const sh=new Fe,M4=new Fe,mS=new Fe,zf=new Fe,T4=new Fe,gS=new Fe,C4=new Fe;class Hg{constructor(e=new Fe,a=new Fe(0,0,-1)){this.origin=e,this.direction=a}set(e,a){return this.origin.copy(e),this.direction.copy(a),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,a){return a.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,sh)),this}closestPointToPoint(e,a){a.subVectors(e,this.origin);const o=a.dot(this.direction);return o<0?a.copy(this.origin):a.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const a=sh.subVectors(e,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(e):(sh.copy(this.origin).addScaledVector(this.direction,a),sh.distanceToSquared(e))}distanceSqToSegment(e,a,o,s){M4.copy(e).add(a).multiplyScalar(.5),mS.copy(a).sub(e).normalize(),zf.copy(this.origin).sub(M4);const c=e.distanceTo(a)*.5,d=-this.direction.dot(mS),f=zf.dot(this.direction),m=-zf.dot(mS),y=zf.lengthSq(),_=Math.abs(1-d*d);let x,S,T,I;if(_>0)if(x=d*m-f,S=d*f-m,I=c*_,x>=0)if(S>=-I)if(S<=I){const k=1/_;x*=k,S*=k,T=x*(x+d*S+2*f)+S*(d*x+S+2*m)+y}else S=c,x=Math.max(0,-(d*S+f)),T=-x*x+S*(S+2*m)+y;else S=-c,x=Math.max(0,-(d*S+f)),T=-x*x+S*(S+2*m)+y;else S<=-I?(x=Math.max(0,-(-d*c+f)),S=x>0?-c:Math.min(Math.max(-c,-m),c),T=-x*x+S*(S+2*m)+y):S<=I?(x=0,S=Math.min(Math.max(-c,-m),c),T=S*(S+2*m)+y):(x=Math.max(0,-(d*c+f)),S=x>0?c:Math.min(Math.max(-c,-m),c),T=-x*x+S*(S+2*m)+y);else S=d>0?-c:c,x=Math.max(0,-(d*S+f)),T=-x*x+S*(S+2*m)+y;return o&&o.copy(this.origin).addScaledVector(this.direction,x),s&&s.copy(M4).addScaledVector(mS,S),T}intersectSphere(e,a){sh.subVectors(e.center,this.origin);const o=sh.dot(this.direction),s=sh.dot(sh)-o*o,c=e.radius*e.radius;if(s>c)return null;const d=Math.sqrt(c-s),f=o-d,m=o+d;return m<0?null:f<0?this.at(m,a):this.at(f,a)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const a=e.normal.dot(this.direction);if(a===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/a;return o>=0?o:null}intersectPlane(e,a){const o=this.distanceToPlane(e);return o===null?null:this.at(o,a)}intersectsPlane(e){const a=e.distanceToPoint(this.origin);return a===0||e.normal.dot(this.direction)*a<0}intersectBox(e,a){let o,s,c,d,f,m;const y=1/this.direction.x,_=1/this.direction.y,x=1/this.direction.z,S=this.origin;return y>=0?(o=(e.min.x-S.x)*y,s=(e.max.x-S.x)*y):(o=(e.max.x-S.x)*y,s=(e.min.x-S.x)*y),_>=0?(c=(e.min.y-S.y)*_,d=(e.max.y-S.y)*_):(c=(e.max.y-S.y)*_,d=(e.min.y-S.y)*_),o>d||c>s||((c>o||isNaN(o))&&(o=c),(d<s||isNaN(s))&&(s=d),x>=0?(f=(e.min.z-S.z)*x,m=(e.max.z-S.z)*x):(f=(e.max.z-S.z)*x,m=(e.min.z-S.z)*x),o>m||f>s)||((f>o||o!==o)&&(o=f),(m<s||s!==s)&&(s=m),s<0)?null:this.at(o>=0?o:s,a)}intersectsBox(e){return this.intersectBox(e,sh)!==null}intersectTriangle(e,a,o,s,c){T4.subVectors(a,e),gS.subVectors(o,e),C4.crossVectors(T4,gS);let d=this.direction.dot(C4),f;if(d>0){if(s)return null;f=1}else if(d<0)f=-1,d=-d;else return null;zf.subVectors(this.origin,e);const m=f*this.direction.dot(gS.crossVectors(zf,gS));if(m<0)return null;const y=f*this.direction.dot(T4.cross(zf));if(y<0||m+y>d)return null;const _=-f*zf.dot(C4);return _<0?null:this.at(_/d,c)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ia{constructor(e,a,o,s,c,d,f,m,y,_,x,S,T,I,k,D){Ia.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,a,o,s,c,d,f,m,y,_,x,S,T,I,k,D)}set(e,a,o,s,c,d,f,m,y,_,x,S,T,I,k,D){const L=this.elements;return L[0]=e,L[4]=a,L[8]=o,L[12]=s,L[1]=c,L[5]=d,L[9]=f,L[13]=m,L[2]=y,L[6]=_,L[10]=x,L[14]=S,L[3]=T,L[7]=I,L[11]=k,L[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ia().fromArray(this.elements)}copy(e){const a=this.elements,o=e.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],this}copyPosition(e){const a=this.elements,o=e.elements;return a[12]=o[12],a[13]=o[13],a[14]=o[14],this}setFromMatrix3(e){const a=e.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this}extractBasis(e,a,o){return e.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,a,o){return this.set(e.x,a.x,o.x,0,e.y,a.y,o.y,0,e.z,a.z,o.z,0,0,0,0,1),this}extractRotation(e){const a=this.elements,o=e.elements,s=1/Dv.setFromMatrixColumn(e,0).length(),c=1/Dv.setFromMatrixColumn(e,1).length(),d=1/Dv.setFromMatrixColumn(e,2).length();return a[0]=o[0]*s,a[1]=o[1]*s,a[2]=o[2]*s,a[3]=0,a[4]=o[4]*c,a[5]=o[5]*c,a[6]=o[6]*c,a[7]=0,a[8]=o[8]*d,a[9]=o[9]*d,a[10]=o[10]*d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromEuler(e){const a=this.elements,o=e.x,s=e.y,c=e.z,d=Math.cos(o),f=Math.sin(o),m=Math.cos(s),y=Math.sin(s),_=Math.cos(c),x=Math.sin(c);if(e.order==="XYZ"){const S=d*_,T=d*x,I=f*_,k=f*x;a[0]=m*_,a[4]=-m*x,a[8]=y,a[1]=T+I*y,a[5]=S-k*y,a[9]=-f*m,a[2]=k-S*y,a[6]=I+T*y,a[10]=d*m}else if(e.order==="YXZ"){const S=m*_,T=m*x,I=y*_,k=y*x;a[0]=S+k*f,a[4]=I*f-T,a[8]=d*y,a[1]=d*x,a[5]=d*_,a[9]=-f,a[2]=T*f-I,a[6]=k+S*f,a[10]=d*m}else if(e.order==="ZXY"){const S=m*_,T=m*x,I=y*_,k=y*x;a[0]=S-k*f,a[4]=-d*x,a[8]=I+T*f,a[1]=T+I*f,a[5]=d*_,a[9]=k-S*f,a[2]=-d*y,a[6]=f,a[10]=d*m}else if(e.order==="ZYX"){const S=d*_,T=d*x,I=f*_,k=f*x;a[0]=m*_,a[4]=I*y-T,a[8]=S*y+k,a[1]=m*x,a[5]=k*y+S,a[9]=T*y-I,a[2]=-y,a[6]=f*m,a[10]=d*m}else if(e.order==="YZX"){const S=d*m,T=d*y,I=f*m,k=f*y;a[0]=m*_,a[4]=k-S*x,a[8]=I*x+T,a[1]=x,a[5]=d*_,a[9]=-f*_,a[2]=-y*_,a[6]=T*x+I,a[10]=S-k*x}else if(e.order==="XZY"){const S=d*m,T=d*y,I=f*m,k=f*y;a[0]=m*_,a[4]=-x,a[8]=y*_,a[1]=S*x+k,a[5]=d*_,a[9]=T*x-I,a[2]=I*x-T,a[6]=f*_,a[10]=k*x+S}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(e){return this.compose(i_e,e,r_e)}lookAt(e,a,o){const s=this.elements;return Nl.subVectors(e,a),Nl.lengthSq()===0&&(Nl.z=1),Nl.normalize(),Ff.crossVectors(o,Nl),Ff.lengthSq()===0&&(Math.abs(o.z)===1?Nl.x+=1e-4:Nl.z+=1e-4,Nl.normalize(),Ff.crossVectors(o,Nl)),Ff.normalize(),yS.crossVectors(Nl,Ff),s[0]=Ff.x,s[4]=yS.x,s[8]=Nl.x,s[1]=Ff.y,s[5]=yS.y,s[9]=Nl.y,s[2]=Ff.z,s[6]=yS.z,s[10]=Nl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,a){const o=e.elements,s=a.elements,c=this.elements,d=o[0],f=o[4],m=o[8],y=o[12],_=o[1],x=o[5],S=o[9],T=o[13],I=o[2],k=o[6],D=o[10],L=o[14],O=o[3],F=o[7],B=o[11],G=o[15],q=s[0],X=s[4],te=s[8],V=s[12],Q=s[1],ge=s[5],me=s[9],be=s[13],fe=s[2],Ce=s[6],Le=s[10],Ge=s[14],le=s[3],pe=s[7],Ae=s[11],ae=s[15];return c[0]=d*q+f*Q+m*fe+y*le,c[4]=d*X+f*ge+m*Ce+y*pe,c[8]=d*te+f*me+m*Le+y*Ae,c[12]=d*V+f*be+m*Ge+y*ae,c[1]=_*q+x*Q+S*fe+T*le,c[5]=_*X+x*ge+S*Ce+T*pe,c[9]=_*te+x*me+S*Le+T*Ae,c[13]=_*V+x*be+S*Ge+T*ae,c[2]=I*q+k*Q+D*fe+L*le,c[6]=I*X+k*ge+D*Ce+L*pe,c[10]=I*te+k*me+D*Le+L*Ae,c[14]=I*V+k*be+D*Ge+L*ae,c[3]=O*q+F*Q+B*fe+G*le,c[7]=O*X+F*ge+B*Ce+G*pe,c[11]=O*te+F*me+B*Le+G*Ae,c[15]=O*V+F*be+B*Ge+G*ae,this}multiplyScalar(e){const a=this.elements;return a[0]*=e,a[4]*=e,a[8]*=e,a[12]*=e,a[1]*=e,a[5]*=e,a[9]*=e,a[13]*=e,a[2]*=e,a[6]*=e,a[10]*=e,a[14]*=e,a[3]*=e,a[7]*=e,a[11]*=e,a[15]*=e,this}determinant(){const e=this.elements,a=e[0],o=e[4],s=e[8],c=e[12],d=e[1],f=e[5],m=e[9],y=e[13],_=e[2],x=e[6],S=e[10],T=e[14],I=e[3],k=e[7],D=e[11],L=e[15];return I*(+c*m*x-s*y*x-c*f*S+o*y*S+s*f*T-o*m*T)+k*(+a*m*T-a*y*S+c*d*S-s*d*T+s*y*_-c*m*_)+D*(+a*y*x-a*f*T-c*d*x+o*d*T+c*f*_-o*y*_)+L*(-s*f*_-a*m*x+a*f*S+s*d*x-o*d*S+o*m*_)}transpose(){const e=this.elements;let a;return a=e[1],e[1]=e[4],e[4]=a,a=e[2],e[2]=e[8],e[8]=a,a=e[6],e[6]=e[9],e[9]=a,a=e[3],e[3]=e[12],e[12]=a,a=e[7],e[7]=e[13],e[13]=a,a=e[11],e[11]=e[14],e[14]=a,this}setPosition(e,a,o){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=a,s[14]=o),this}invert(){const e=this.elements,a=e[0],o=e[1],s=e[2],c=e[3],d=e[4],f=e[5],m=e[6],y=e[7],_=e[8],x=e[9],S=e[10],T=e[11],I=e[12],k=e[13],D=e[14],L=e[15],O=x*D*y-k*S*y+k*m*T-f*D*T-x*m*L+f*S*L,F=I*S*y-_*D*y-I*m*T+d*D*T+_*m*L-d*S*L,B=_*k*y-I*x*y+I*f*T-d*k*T-_*f*L+d*x*L,G=I*x*m-_*k*m-I*f*S+d*k*S+_*f*D-d*x*D,q=a*O+o*F+s*B+c*G;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const X=1/q;return e[0]=O*X,e[1]=(k*S*c-x*D*c-k*s*T+o*D*T+x*s*L-o*S*L)*X,e[2]=(f*D*c-k*m*c+k*s*y-o*D*y-f*s*L+o*m*L)*X,e[3]=(x*m*c-f*S*c-x*s*y+o*S*y+f*s*T-o*m*T)*X,e[4]=F*X,e[5]=(_*D*c-I*S*c+I*s*T-a*D*T-_*s*L+a*S*L)*X,e[6]=(I*m*c-d*D*c-I*s*y+a*D*y+d*s*L-a*m*L)*X,e[7]=(d*S*c-_*m*c+_*s*y-a*S*y-d*s*T+a*m*T)*X,e[8]=B*X,e[9]=(I*x*c-_*k*c-I*o*T+a*k*T+_*o*L-a*x*L)*X,e[10]=(d*k*c-I*f*c+I*o*y-a*k*y-d*o*L+a*f*L)*X,e[11]=(_*f*c-d*x*c-_*o*y+a*x*y+d*o*T-a*f*T)*X,e[12]=G*X,e[13]=(_*k*s-I*x*s+I*o*S-a*k*S-_*o*D+a*x*D)*X,e[14]=(I*f*s-d*k*s-I*o*m+a*k*m+d*o*D-a*f*D)*X,e[15]=(d*x*s-_*f*s+_*o*m-a*x*m-d*o*S+a*f*S)*X,this}scale(e){const a=this.elements,o=e.x,s=e.y,c=e.z;return a[0]*=o,a[4]*=s,a[8]*=c,a[1]*=o,a[5]*=s,a[9]*=c,a[2]*=o,a[6]*=s,a[10]*=c,a[3]*=o,a[7]*=s,a[11]*=c,this}getMaxScaleOnAxis(){const e=this.elements,a=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(a,o,s))}makeTranslation(e,a,o){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,a,0,0,1,o,0,0,0,1),this}makeRotationX(e){const a=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,a,-o,0,0,o,a,0,0,0,0,1),this}makeRotationY(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,0,o,0,0,1,0,0,-o,0,a,0,0,0,0,1),this}makeRotationZ(e){const a=Math.cos(e),o=Math.sin(e);return this.set(a,-o,0,0,o,a,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,a){const o=Math.cos(a),s=Math.sin(a),c=1-o,d=e.x,f=e.y,m=e.z,y=c*d,_=c*f;return this.set(y*d+o,y*f-s*m,y*m+s*f,0,y*f+s*m,_*f+o,_*m-s*d,0,y*m-s*f,_*m+s*d,c*m*m+o,0,0,0,0,1),this}makeScale(e,a,o){return this.set(e,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,a,o,s,c,d){return this.set(1,o,c,0,e,1,d,0,a,s,1,0,0,0,0,1),this}compose(e,a,o){const s=this.elements,c=a._x,d=a._y,f=a._z,m=a._w,y=c+c,_=d+d,x=f+f,S=c*y,T=c*_,I=c*x,k=d*_,D=d*x,L=f*x,O=m*y,F=m*_,B=m*x,G=o.x,q=o.y,X=o.z;return s[0]=(1-(k+L))*G,s[1]=(T+B)*G,s[2]=(I-F)*G,s[3]=0,s[4]=(T-B)*q,s[5]=(1-(S+L))*q,s[6]=(D+O)*q,s[7]=0,s[8]=(I+F)*X,s[9]=(D-O)*X,s[10]=(1-(S+k))*X,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,a,o){const s=this.elements;let c=Dv.set(s[0],s[1],s[2]).length();const d=Dv.set(s[4],s[5],s[6]).length(),f=Dv.set(s[8],s[9],s[10]).length();this.determinant()<0&&(c=-c),e.x=s[12],e.y=s[13],e.z=s[14],Jc.copy(this);const y=1/c,_=1/d,x=1/f;return Jc.elements[0]*=y,Jc.elements[1]*=y,Jc.elements[2]*=y,Jc.elements[4]*=_,Jc.elements[5]*=_,Jc.elements[6]*=_,Jc.elements[8]*=x,Jc.elements[9]*=x,Jc.elements[10]*=x,a.setFromRotationMatrix(Jc),o.x=c,o.y=d,o.z=f,this}makePerspective(e,a,o,s,c,d,f=ld){const m=this.elements,y=2*c/(a-e),_=2*c/(o-s),x=(a+e)/(a-e),S=(o+s)/(o-s);let T,I;if(f===ld)T=-(d+c)/(d-c),I=-2*d*c/(d-c);else if(f===Yx)T=-d/(d-c),I=-d*c/(d-c);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return m[0]=y,m[4]=0,m[8]=x,m[12]=0,m[1]=0,m[5]=_,m[9]=S,m[13]=0,m[2]=0,m[6]=0,m[10]=T,m[14]=I,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(e,a,o,s,c,d,f=ld){const m=this.elements,y=1/(a-e),_=1/(o-s),x=1/(d-c),S=(a+e)*y,T=(o+s)*_;let I,k;if(f===ld)I=(d+c)*x,k=-2*x;else if(f===Yx)I=c*x,k=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-S,m[1]=0,m[5]=2*_,m[9]=0,m[13]=-T,m[2]=0,m[6]=0,m[10]=k,m[14]=-I,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(e){const a=this.elements,o=e.elements;for(let s=0;s<16;s++)if(a[s]!==o[s])return!1;return!0}fromArray(e,a=0){for(let o=0;o<16;o++)this.elements[o]=e[o+a];return this}toArray(e=[],a=0){const o=this.elements;return e[a]=o[0],e[a+1]=o[1],e[a+2]=o[2],e[a+3]=o[3],e[a+4]=o[4],e[a+5]=o[5],e[a+6]=o[6],e[a+7]=o[7],e[a+8]=o[8],e[a+9]=o[9],e[a+10]=o[10],e[a+11]=o[11],e[a+12]=o[12],e[a+13]=o[13],e[a+14]=o[14],e[a+15]=o[15],e}}const Dv=new Fe,Jc=new Ia,i_e=new Fe(0,0,0),r_e=new Fe(1,1,1),Ff=new Fe,yS=new Fe,Nl=new Fe,fW=new Ia,pW=new As;class kw{constructor(e=0,a=0,o=0,s=kw.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=a,this._z=o,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,a,o,s=this._order){return this._x=e,this._y=a,this._z=o,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,a=this._order,o=!0){const s=e.elements,c=s[0],d=s[4],f=s[8],m=s[1],y=s[5],_=s[9],x=s[2],S=s[6],T=s[10];switch(a){case"XYZ":this._y=Math.asin($r(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,T),this._z=Math.atan2(-d,c)):(this._x=Math.atan2(S,y),this._z=0);break;case"YXZ":this._x=Math.asin(-$r(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(f,T),this._z=Math.atan2(m,y)):(this._y=Math.atan2(-x,c),this._z=0);break;case"ZXY":this._x=Math.asin($r(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,T),this._z=Math.atan2(-d,y)):(this._y=0,this._z=Math.atan2(m,c));break;case"ZYX":this._y=Math.asin(-$r(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,T),this._z=Math.atan2(m,c)):(this._x=0,this._z=Math.atan2(-d,y));break;case"YZX":this._z=Math.asin($r(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-_,y),this._y=Math.atan2(-x,c)):(this._x=0,this._y=Math.atan2(f,T));break;case"XZY":this._z=Math.asin(-$r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(S,y),this._y=Math.atan2(f,c)):(this._x=Math.atan2(-_,T),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,a,o){return fW.makeRotationFromQuaternion(e),this.setFromRotationMatrix(fW,a,o)}setFromVector3(e,a=this._order){return this.set(e.x,e.y,e.z,a)}reorder(e){return pW.setFromEuler(this),this.setFromQuaternion(pW,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],a=0){return e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}kw.DEFAULT_ORDER="XYZ";class xg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let o_e=0;const mW=new Fe,Ov=new As,lh=new Ia,vS=new Fe,ib=new Fe,s_e=new Fe,l_e=new As,gW=new Fe(1,0,0),yW=new Fe(0,1,0),vW=new Fe(0,0,1),c_e={type:"added"},u_e={type:"removed"};class pi extends xd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:o_e++}),this.uuid=Zl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pi.DEFAULT_UP.clone();const e=new Fe,a=new kw,o=new As,s=new Fe(1,1,1);function c(){o.setFromEuler(a,!1)}function d(){a.setFromQuaternion(o,void 0,!1)}a._onChange(c),o._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:a},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ia},normalMatrix:{value:new Na}}),this.matrix=new Ia,this.matrixWorld=new Ia,this.matrixAutoUpdate=pi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=pi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new xg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,a){this.quaternion.setFromAxisAngle(e,a)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,a){return Ov.setFromAxisAngle(e,a),this.quaternion.multiply(Ov),this}rotateOnWorldAxis(e,a){return Ov.setFromAxisAngle(e,a),this.quaternion.premultiply(Ov),this}rotateX(e){return this.rotateOnAxis(gW,e)}rotateY(e){return this.rotateOnAxis(yW,e)}rotateZ(e){return this.rotateOnAxis(vW,e)}translateOnAxis(e,a){return mW.copy(e).applyQuaternion(this.quaternion),this.position.add(mW.multiplyScalar(a)),this}translateX(e){return this.translateOnAxis(gW,e)}translateY(e){return this.translateOnAxis(yW,e)}translateZ(e){return this.translateOnAxis(vW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(lh.copy(this.matrixWorld).invert())}lookAt(e,a,o){e.isVector3?vS.copy(e):vS.set(e,a,o);const s=this.parent;this.updateWorldMatrix(!0,!1),ib.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?lh.lookAt(ib,vS,this.up):lh.lookAt(vS,ib,this.up),this.quaternion.setFromRotationMatrix(lh),s&&(lh.extractRotation(s.matrixWorld),Ov.setFromRotationMatrix(lh),this.quaternion.premultiply(Ov.invert()))}add(e){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(c_e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const a=this.children.indexOf(e);return a!==-1&&(e.parent=null,this.children.splice(a,1),e.dispatchEvent(u_e)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),lh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),lh.multiply(e.parent.matrixWorld)),e.applyMatrix4(lh),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,a){if(this[e]===a)return this;for(let o=0,s=this.children.length;o<s;o++){const d=this.children[o].getObjectByProperty(e,a);if(d!==void 0)return d}}getObjectsByProperty(e,a){let o=[];this[e]===a&&o.push(this);for(let s=0,c=this.children.length;s<c;s++){const d=this.children[s].getObjectsByProperty(e,a);d.length>0&&(o=o.concat(d))}return o}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ib,e,s_e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ib,l_e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const a=this.matrixWorld.elements;return e.set(a[8],a[9],a[10]).normalize()}raycast(){}traverse(e){e(this);const a=this.children;for(let o=0,s=a.length;o<s;o++)a[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const a=this.children;for(let o=0,s=a.length;o<s;o++)a[o].traverseVisible(e)}traverseAncestors(e){const a=this.parent;a!==null&&(e(a),a.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const a=this.children;for(let o=0,s=a.length;o<s;o++){const c=a[o];(c.matrixWorldAutoUpdate===!0||e===!0)&&c.updateMatrixWorld(e)}}updateWorldMatrix(e,a){const o=this.parent;if(e===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),a===!0){const s=this.children;for(let c=0,d=s.length;c<d;c++){const f=s[c];f.matrixWorldAutoUpdate===!0&&f.updateWorldMatrix(!1,!0)}}}toJSON(e){const a=e===void 0||typeof e=="string",o={};a&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function c(f,m){return f[m.uuid]===void 0&&(f[m.uuid]=m.toJSON(e)),m.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=c(e.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const m=f.shapes;if(Array.isArray(m))for(let y=0,_=m.length;y<_;y++){const x=m[y];c(e.shapes,x)}else c(e.shapes,m)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let m=0,y=this.material.length;m<y;m++)f.push(c(e.materials,this.material[m]));s.material=f}else s.material=c(e.materials,this.material);if(this.children.length>0){s.children=[];for(let f=0;f<this.children.length;f++)s.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let f=0;f<this.animations.length;f++){const m=this.animations[f];s.animations.push(c(e.animations,m))}}if(a){const f=d(e.geometries),m=d(e.materials),y=d(e.textures),_=d(e.images),x=d(e.shapes),S=d(e.skeletons),T=d(e.animations),I=d(e.nodes);f.length>0&&(o.geometries=f),m.length>0&&(o.materials=m),y.length>0&&(o.textures=y),_.length>0&&(o.images=_),x.length>0&&(o.shapes=x),S.length>0&&(o.skeletons=S),T.length>0&&(o.animations=T),I.length>0&&(o.nodes=I)}return o.object=s,o;function d(f){const m=[];for(const y in f){const _=f[y];delete _.metadata,m.push(_)}return m}}clone(e){return new this.constructor().copy(this,e)}copy(e,a=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),a===!0)for(let o=0;o<e.children.length;o++){const s=e.children[o];this.add(s.clone())}return this}}pi.DEFAULT_UP=new Fe(0,1,0);pi.DEFAULT_MATRIX_AUTO_UPDATE=!0;pi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Qc=new Fe,ch=new Fe,P4=new Fe,uh=new Fe,zv=new Fe,Fv=new Fe,_W=new Fe,I4=new Fe,L4=new Fe,R4=new Fe;let _S=!1;class fl{constructor(e=new Fe,a=new Fe,o=new Fe){this.a=e,this.b=a,this.c=o}static getNormal(e,a,o,s){s.subVectors(o,a),Qc.subVectors(e,a),s.cross(Qc);const c=s.lengthSq();return c>0?s.multiplyScalar(1/Math.sqrt(c)):s.set(0,0,0)}static getBarycoord(e,a,o,s,c){Qc.subVectors(s,a),ch.subVectors(o,a),P4.subVectors(e,a);const d=Qc.dot(Qc),f=Qc.dot(ch),m=Qc.dot(P4),y=ch.dot(ch),_=ch.dot(P4),x=d*y-f*f;if(x===0)return c.set(-2,-1,-1);const S=1/x,T=(y*m-f*_)*S,I=(d*_-f*m)*S;return c.set(1-T-I,I,T)}static containsPoint(e,a,o,s){return this.getBarycoord(e,a,o,s,uh),uh.x>=0&&uh.y>=0&&uh.x+uh.y<=1}static getUV(e,a,o,s,c,d,f,m){return _S===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_S=!0),this.getInterpolation(e,a,o,s,c,d,f,m)}static getInterpolation(e,a,o,s,c,d,f,m){return this.getBarycoord(e,a,o,s,uh),m.setScalar(0),m.addScaledVector(c,uh.x),m.addScaledVector(d,uh.y),m.addScaledVector(f,uh.z),m}static isFrontFacing(e,a,o,s){return Qc.subVectors(o,a),ch.subVectors(e,a),Qc.cross(ch).dot(s)<0}set(e,a,o){return this.a.copy(e),this.b.copy(a),this.c.copy(o),this}setFromPointsAndIndices(e,a,o,s){return this.a.copy(e[a]),this.b.copy(e[o]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,a,o,s){return this.a.fromBufferAttribute(e,a),this.b.fromBufferAttribute(e,o),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qc.subVectors(this.c,this.b),ch.subVectors(this.a,this.b),Qc.cross(ch).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,a){return fl.getBarycoord(e,this.a,this.b,this.c,a)}getUV(e,a,o,s,c){return _S===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),_S=!0),fl.getInterpolation(e,this.a,this.b,this.c,a,o,s,c)}getInterpolation(e,a,o,s,c){return fl.getInterpolation(e,this.a,this.b,this.c,a,o,s,c)}containsPoint(e){return fl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,a){const o=this.a,s=this.b,c=this.c;let d,f;zv.subVectors(s,o),Fv.subVectors(c,o),I4.subVectors(e,o);const m=zv.dot(I4),y=Fv.dot(I4);if(m<=0&&y<=0)return a.copy(o);L4.subVectors(e,s);const _=zv.dot(L4),x=Fv.dot(L4);if(_>=0&&x<=_)return a.copy(s);const S=m*x-_*y;if(S<=0&&m>=0&&_<=0)return d=m/(m-_),a.copy(o).addScaledVector(zv,d);R4.subVectors(e,c);const T=zv.dot(R4),I=Fv.dot(R4);if(I>=0&&T<=I)return a.copy(c);const k=T*y-m*I;if(k<=0&&y>=0&&I<=0)return f=y/(y-I),a.copy(o).addScaledVector(Fv,f);const D=_*I-T*x;if(D<=0&&x-_>=0&&T-I>=0)return _W.subVectors(c,s),f=(x-_)/(x-_+(T-I)),a.copy(s).addScaledVector(_W,f);const L=1/(D+k+S);return d=k*L,f=S*L,a.copy(o).addScaledVector(zv,d).addScaledVector(Fv,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const jY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Nf={h:0,s:0,l:0},bS={h:0,s:0,l:0};function k4(n,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?n+(e-n)*6*a:a<1/2?e:a<2/3?n+(e-n)*6*(2/3-a):n}let Pn=class{constructor(e,a,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,a,o)}set(e,a,o){if(a===void 0&&o===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,a,o);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,a=Io){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,zi.toWorkingColorSpace(this,a),this}setRGB(e,a,o,s=zi.workingColorSpace){return this.r=e,this.g=a,this.b=o,zi.toWorkingColorSpace(this,s),this}setHSL(e,a,o,s=zi.workingColorSpace){if(e=n6(e,1),a=$r(a,0,1),o=$r(o,0,1),a===0)this.r=this.g=this.b=o;else{const c=o<=.5?o*(1+a):o+a-o*a,d=2*o-c;this.r=k4(d,c,e+1/3),this.g=k4(d,c,e),this.b=k4(d,c,e-1/3)}return zi.toWorkingColorSpace(this,s),this}setStyle(e,a=Io){function o(c){c!==void 0&&parseFloat(c)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let c;const d=s[1],f=s[2];switch(d){case"rgb":case"rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setRGB(Math.min(255,parseInt(c[1],10))/255,Math.min(255,parseInt(c[2],10))/255,Math.min(255,parseInt(c[3],10))/255,a);if(c=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setRGB(Math.min(100,parseInt(c[1],10))/100,Math.min(100,parseInt(c[2],10))/100,Math.min(100,parseInt(c[3],10))/100,a);break;case"hsl":case"hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return o(c[4]),this.setHSL(parseFloat(c[1])/360,parseFloat(c[2])/100,parseFloat(c[3])/100,a);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const c=s[1],d=c.length;if(d===3)return this.setRGB(parseInt(c.charAt(0),16)/15,parseInt(c.charAt(1),16)/15,parseInt(c.charAt(2),16)/15,a);if(d===6)return this.setHex(parseInt(c,16),a);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,a);return this}setColorName(e,a=Io){const o=jY[e.toLowerCase()];return o!==void 0?this.setHex(o,a):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=O0(e.r),this.g=O0(e.g),this.b=O0(e.b),this}copyLinearToSRGB(e){return this.r=x4(e.r),this.g=x4(e.g),this.b=x4(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Io){return zi.fromWorkingColorSpace(ys.copy(this),e),Math.round($r(ys.r*255,0,255))*65536+Math.round($r(ys.g*255,0,255))*256+Math.round($r(ys.b*255,0,255))}getHexString(e=Io){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,a=zi.workingColorSpace){zi.fromWorkingColorSpace(ys.copy(this),a);const o=ys.r,s=ys.g,c=ys.b,d=Math.max(o,s,c),f=Math.min(o,s,c);let m,y;const _=(f+d)/2;if(f===d)m=0,y=0;else{const x=d-f;switch(y=_<=.5?x/(d+f):x/(2-d-f),d){case o:m=(s-c)/x+(s<c?6:0);break;case s:m=(c-o)/x+2;break;case c:m=(o-s)/x+4;break}m/=6}return e.h=m,e.s=y,e.l=_,e}getRGB(e,a=zi.workingColorSpace){return zi.fromWorkingColorSpace(ys.copy(this),a),e.r=ys.r,e.g=ys.g,e.b=ys.b,e}getStyle(e=Io){zi.fromWorkingColorSpace(ys.copy(this),e);const a=ys.r,o=ys.g,s=ys.b;return e!==Io?`color(${e} ${a.toFixed(3)} ${o.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(a*255)},${Math.round(o*255)},${Math.round(s*255)})`}offsetHSL(e,a,o){return this.getHSL(Nf),this.setHSL(Nf.h+e,Nf.s+a,Nf.l+o)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,a){return this.r=e.r+a.r,this.g=e.g+a.g,this.b=e.b+a.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,a){return this.r+=(e.r-this.r)*a,this.g+=(e.g-this.g)*a,this.b+=(e.b-this.b)*a,this}lerpColors(e,a,o){return this.r=e.r+(a.r-e.r)*o,this.g=e.g+(a.g-e.g)*o,this.b=e.b+(a.b-e.b)*o,this}lerpHSL(e,a){this.getHSL(Nf),e.getHSL(bS);const o=ex(Nf.h,bS.h,a),s=ex(Nf.s,bS.s,a),c=ex(Nf.l,bS.l,a);return this.setHSL(o,s,c),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const a=this.r,o=this.g,s=this.b,c=e.elements;return this.r=c[0]*a+c[3]*o+c[6]*s,this.g=c[1]*a+c[4]*o+c[7]*s,this.b=c[2]*a+c[5]*o+c[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,a=0){return this.r=e[a],this.g=e[a+1],this.b=e[a+2],this}toArray(e=[],a=0){return e[a]=this.r,e[a+1]=this.g,e[a+2]=this.b,e}fromBufferAttribute(e,a){return this.r=e.getX(a),this.g=e.getY(a),this.b=e.getZ(a),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ys=new Pn;Pn.NAMES=jY;let d_e=0;class as extends xd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:d_e++}),this.uuid=Zl(),this.name="",this.type="Material",this.blending=_g,this.side=yd,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=YE,this.blendDst=ZE,this.blendEquation=$f,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pn(0,0,0),this.blendAlpha=0,this.depthFunc=Fx,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Jm,this.stencilZFail=Jm,this.stencilZPass=Jm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const a in e){const o=e[a];if(o===void 0){console.warn(`THREE.Material: parameter '${a}' has value of undefined.`);continue}const s=this[a];if(s===void 0){console.warn(`THREE.Material: '${a}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(o):s&&s.isVector3&&o&&o.isVector3?s.copy(o):this[a]=o}}toJSON(e){const a=e===void 0||typeof e=="string";a&&(e={textures:{},images:{}});const o={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(o.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(o.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(o.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==_g&&(o.blending=this.blending),this.side!==yd&&(o.side=this.side),this.vertexColors===!0&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=!0),this.blendSrc!==YE&&(o.blendSrc=this.blendSrc),this.blendDst!==ZE&&(o.blendDst=this.blendDst),this.blendEquation!==$f&&(o.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(o.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(o.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(o.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(o.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(o.blendAlpha=this.blendAlpha),this.depthFunc!==Fx&&(o.depthFunc=this.depthFunc),this.depthTest===!1&&(o.depthTest=this.depthTest),this.depthWrite===!1&&(o.depthWrite=this.depthWrite),this.colorWrite===!1&&(o.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(o.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AR&&(o.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(o.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(o.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Jm&&(o.stencilFail=this.stencilFail),this.stencilZFail!==Jm&&(o.stencilZFail=this.stencilZFail),this.stencilZPass!==Jm&&(o.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(o.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaHash===!0&&(o.alphaHash=!0),this.alphaToCoverage===!0&&(o.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=!0),this.forceSinglePass===!0&&(o.forceSinglePass=!0),this.wireframe===!0&&(o.wireframe=!0),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=!0),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function s(c){const d=[];for(const f in c){const m=c[f];delete m.metadata,d.push(m)}return d}if(a){const c=s(e.textures),d=s(e.images);c.length>0&&(o.textures=c),d.length>0&&(o.images=d)}return o}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const a=e.clippingPlanes;let o=null;if(a!==null){const s=a.length;o=new Array(s);for(let c=0;c!==s;++c)o[c]=a[c].clone()}return this.clippingPlanes=o,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Hh extends as{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const xh=h_e();function h_e(){const n=new ArrayBuffer(4),e=new Float32Array(n),a=new Uint32Array(n),o=new Uint32Array(512),s=new Uint32Array(512);for(let m=0;m<256;++m){const y=m-127;y<-27?(o[m]=0,o[m|256]=32768,s[m]=24,s[m|256]=24):y<-14?(o[m]=1024>>-y-14,o[m|256]=1024>>-y-14|32768,s[m]=-y-1,s[m|256]=-y-1):y<=15?(o[m]=y+15<<10,o[m|256]=y+15<<10|32768,s[m]=13,s[m|256]=13):y<128?(o[m]=31744,o[m|256]=64512,s[m]=24,s[m|256]=24):(o[m]=31744,o[m|256]=64512,s[m]=13,s[m|256]=13)}const c=new Uint32Array(2048),d=new Uint32Array(64),f=new Uint32Array(64);for(let m=1;m<1024;++m){let y=m<<13,_=0;for(;!(y&8388608);)y<<=1,_-=8388608;y&=-8388609,_+=947912704,c[m]=y|_}for(let m=1024;m<2048;++m)c[m]=939524096+(m-1024<<13);for(let m=1;m<31;++m)d[m]=m<<23;d[31]=1199570944,d[32]=2147483648;for(let m=33;m<63;++m)d[m]=2147483648+(m-32<<23);d[63]=3347054592;for(let m=1;m<64;++m)m!==32&&(f[m]=1024);return{floatView:e,uint32View:a,baseTable:o,shiftTable:s,mantissaTable:c,exponentTable:d,offsetTable:f}}function dl(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=$r(n,-65504,65504),xh.floatView[0]=n;const e=xh.uint32View[0],a=e>>23&511;return xh.baseTable[a]+((e&8388607)>>xh.shiftTable[a])}function Pb(n){const e=n>>10;return xh.uint32View[0]=xh.mantissaTable[xh.offsetTable[e]+(n&1023)]+xh.exponentTable[e],xh.floatView[0]}const f_e={toHalfFloat:dl,fromHalfFloat:Pb},bo=new Fe,xS=new Kt;class Xi{constructor(e,a,o=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=a,this.count=e!==void 0?e.length/a:0,this.normalized=o,this.usage=Xx,this.updateRange={offset:0,count:-1},this.gpuType=sd,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,a,o){e*=this.itemSize,o*=a.itemSize;for(let s=0,c=this.itemSize;s<c;s++)this.array[e+s]=a.array[o+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let a=0,o=this.count;a<o;a++)xS.fromBufferAttribute(this,a),xS.applyMatrix3(e),this.setXY(a,xS.x,xS.y);else if(this.itemSize===3)for(let a=0,o=this.count;a<o;a++)bo.fromBufferAttribute(this,a),bo.applyMatrix3(e),this.setXYZ(a,bo.x,bo.y,bo.z);return this}applyMatrix4(e){for(let a=0,o=this.count;a<o;a++)bo.fromBufferAttribute(this,a),bo.applyMatrix4(e),this.setXYZ(a,bo.x,bo.y,bo.z);return this}applyNormalMatrix(e){for(let a=0,o=this.count;a<o;a++)bo.fromBufferAttribute(this,a),bo.applyNormalMatrix(e),this.setXYZ(a,bo.x,bo.y,bo.z);return this}transformDirection(e){for(let a=0,o=this.count;a<o;a++)bo.fromBufferAttribute(this,a),bo.transformDirection(e),this.setXYZ(a,bo.x,bo.y,bo.z);return this}set(e,a=0){return this.array.set(e,a),this}getComponent(e,a){let o=this.array[e*this.itemSize+a];return this.normalized&&(o=ml(o,this.array)),o}setComponent(e,a,o){return this.normalized&&(o=Ba(o,this.array)),this.array[e*this.itemSize+a]=o,this}getX(e){let a=this.array[e*this.itemSize];return this.normalized&&(a=ml(a,this.array)),a}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize]=a,this}getY(e){let a=this.array[e*this.itemSize+1];return this.normalized&&(a=ml(a,this.array)),a}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+1]=a,this}getZ(e){let a=this.array[e*this.itemSize+2];return this.normalized&&(a=ml(a,this.array)),a}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+2]=a,this}getW(e){let a=this.array[e*this.itemSize+3];return this.normalized&&(a=ml(a,this.array)),a}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+3]=a,this}setXY(e,a,o){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.array[e+0]=a,this.array[e+1]=o,this}setXYZ(e,a,o,s){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.array[e+0]=a,this.array[e+1]=o,this.array[e+2]=s,this}setXYZW(e,a,o,s,c){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.array[e+0]=a,this.array[e+1]=o,this.array[e+2]=s,this.array[e+3]=c,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Xx&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class p_e extends Xi{constructor(e,a,o){super(new Int8Array(e),a,o)}}class m_e extends Xi{constructor(e,a,o){super(new Uint8Array(e),a,o)}}class g_e extends Xi{constructor(e,a,o){super(new Uint8ClampedArray(e),a,o)}}class y_e extends Xi{constructor(e,a,o){super(new Int16Array(e),a,o)}}class r6 extends Xi{constructor(e,a,o){super(new Uint16Array(e),a,o)}}class v_e extends Xi{constructor(e,a,o){super(new Int32Array(e),a,o)}}class o6 extends Xi{constructor(e,a,o){super(new Uint32Array(e),a,o)}}class __e extends Xi{constructor(e,a,o){super(new Uint16Array(e),a,o),this.isFloat16BufferAttribute=!0}getX(e){let a=Pb(this.array[e*this.itemSize]);return this.normalized&&(a=ml(a,this.array)),a}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize]=dl(a),this}getY(e){let a=Pb(this.array[e*this.itemSize+1]);return this.normalized&&(a=ml(a,this.array)),a}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+1]=dl(a),this}getZ(e){let a=Pb(this.array[e*this.itemSize+2]);return this.normalized&&(a=ml(a,this.array)),a}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+2]=dl(a),this}getW(e){let a=Pb(this.array[e*this.itemSize+3]);return this.normalized&&(a=ml(a,this.array)),a}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.array[e*this.itemSize+3]=dl(a),this}setXY(e,a,o){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.array[e+0]=dl(a),this.array[e+1]=dl(o),this}setXYZ(e,a,o,s){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.array[e+0]=dl(a),this.array[e+1]=dl(o),this.array[e+2]=dl(s),this}setXYZW(e,a,o,s,c){return e*=this.itemSize,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.array[e+0]=dl(a),this.array[e+1]=dl(o),this.array[e+2]=dl(s),this.array[e+3]=dl(c),this}}class Wn extends Xi{constructor(e,a,o){super(new Float32Array(e),a,o)}}class b_e extends Xi{constructor(e,a,o){super(new Float64Array(e),a,o)}}let x_e=0;const gc=new Ia,D4=new pi,Nv=new Fe,Bl=new gu,rb=new gu,No=new Fe;class La extends xd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:x_e++}),this.uuid=Zl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(VY(e)?o6:r6)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,a){return this.attributes[e]=a,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,a,o=0){this.groups.push({start:e,count:a,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(e,a){this.drawRange.start=e,this.drawRange.count=a}applyMatrix4(e){const a=this.attributes.position;a!==void 0&&(a.applyMatrix4(e),a.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const c=new Na().getNormalMatrix(e);o.applyNormalMatrix(c),o.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return gc.makeRotationFromQuaternion(e),this.applyMatrix4(gc),this}rotateX(e){return gc.makeRotationX(e),this.applyMatrix4(gc),this}rotateY(e){return gc.makeRotationY(e),this.applyMatrix4(gc),this}rotateZ(e){return gc.makeRotationZ(e),this.applyMatrix4(gc),this}translate(e,a,o){return gc.makeTranslation(e,a,o),this.applyMatrix4(gc),this}scale(e,a,o){return gc.makeScale(e,a,o),this.applyMatrix4(gc),this}lookAt(e){return D4.lookAt(e),D4.updateMatrix(),this.applyMatrix4(D4.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Nv).negate(),this.translate(Nv.x,Nv.y,Nv.z),this}setFromPoints(e){const a=[];for(let o=0,s=e.length;o<s;o++){const c=e[o];a.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new Wn(a,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gu);const e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Fe(-1/0,-1/0,-1/0),new Fe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),a)for(let o=0,s=a.length;o<s;o++){const c=a[o];Bl.setFromBufferAttribute(c),this.morphTargetsRelative?(No.addVectors(this.boundingBox.min,Bl.min),this.boundingBox.expandByPoint(No),No.addVectors(this.boundingBox.max,Bl.max),this.boundingBox.expandByPoint(No)):(this.boundingBox.expandByPoint(Bl.min),this.boundingBox.expandByPoint(Bl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Pc);const e=this.attributes.position,a=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Fe,1/0);return}if(e){const o=this.boundingSphere.center;if(Bl.setFromBufferAttribute(e),a)for(let c=0,d=a.length;c<d;c++){const f=a[c];rb.setFromBufferAttribute(f),this.morphTargetsRelative?(No.addVectors(Bl.min,rb.min),Bl.expandByPoint(No),No.addVectors(Bl.max,rb.max),Bl.expandByPoint(No)):(Bl.expandByPoint(rb.min),Bl.expandByPoint(rb.max))}Bl.getCenter(o);let s=0;for(let c=0,d=e.count;c<d;c++)No.fromBufferAttribute(e,c),s=Math.max(s,o.distanceToSquared(No));if(a)for(let c=0,d=a.length;c<d;c++){const f=a[c],m=this.morphTargetsRelative;for(let y=0,_=f.count;y<_;y++)No.fromBufferAttribute(f,y),m&&(Nv.fromBufferAttribute(e,y),No.add(Nv)),s=Math.max(s,o.distanceToSquared(No))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,a=this.attributes;if(e===null||a.position===void 0||a.normal===void 0||a.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=e.array,s=a.position.array,c=a.normal.array,d=a.uv.array,f=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Xi(new Float32Array(4*f),4));const m=this.getAttribute("tangent").array,y=[],_=[];for(let Q=0;Q<f;Q++)y[Q]=new Fe,_[Q]=new Fe;const x=new Fe,S=new Fe,T=new Fe,I=new Kt,k=new Kt,D=new Kt,L=new Fe,O=new Fe;function F(Q,ge,me){x.fromArray(s,Q*3),S.fromArray(s,ge*3),T.fromArray(s,me*3),I.fromArray(d,Q*2),k.fromArray(d,ge*2),D.fromArray(d,me*2),S.sub(x),T.sub(x),k.sub(I),D.sub(I);const be=1/(k.x*D.y-D.x*k.y);isFinite(be)&&(L.copy(S).multiplyScalar(D.y).addScaledVector(T,-k.y).multiplyScalar(be),O.copy(T).multiplyScalar(k.x).addScaledVector(S,-D.x).multiplyScalar(be),y[Q].add(L),y[ge].add(L),y[me].add(L),_[Q].add(O),_[ge].add(O),_[me].add(O))}let B=this.groups;B.length===0&&(B=[{start:0,count:o.length}]);for(let Q=0,ge=B.length;Q<ge;++Q){const me=B[Q],be=me.start,fe=me.count;for(let Ce=be,Le=be+fe;Ce<Le;Ce+=3)F(o[Ce+0],o[Ce+1],o[Ce+2])}const G=new Fe,q=new Fe,X=new Fe,te=new Fe;function V(Q){X.fromArray(c,Q*3),te.copy(X);const ge=y[Q];G.copy(ge),G.sub(X.multiplyScalar(X.dot(ge))).normalize(),q.crossVectors(te,ge);const be=q.dot(_[Q])<0?-1:1;m[Q*4]=G.x,m[Q*4+1]=G.y,m[Q*4+2]=G.z,m[Q*4+3]=be}for(let Q=0,ge=B.length;Q<ge;++Q){const me=B[Q],be=me.start,fe=me.count;for(let Ce=be,Le=be+fe;Ce<Le;Ce+=3)V(o[Ce+0]),V(o[Ce+1]),V(o[Ce+2])}}computeVertexNormals(){const e=this.index,a=this.getAttribute("position");if(a!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new Xi(new Float32Array(a.count*3),3),this.setAttribute("normal",o);else for(let S=0,T=o.count;S<T;S++)o.setXYZ(S,0,0,0);const s=new Fe,c=new Fe,d=new Fe,f=new Fe,m=new Fe,y=new Fe,_=new Fe,x=new Fe;if(e)for(let S=0,T=e.count;S<T;S+=3){const I=e.getX(S+0),k=e.getX(S+1),D=e.getX(S+2);s.fromBufferAttribute(a,I),c.fromBufferAttribute(a,k),d.fromBufferAttribute(a,D),_.subVectors(d,c),x.subVectors(s,c),_.cross(x),f.fromBufferAttribute(o,I),m.fromBufferAttribute(o,k),y.fromBufferAttribute(o,D),f.add(_),m.add(_),y.add(_),o.setXYZ(I,f.x,f.y,f.z),o.setXYZ(k,m.x,m.y,m.z),o.setXYZ(D,y.x,y.y,y.z)}else for(let S=0,T=a.count;S<T;S+=3)s.fromBufferAttribute(a,S+0),c.fromBufferAttribute(a,S+1),d.fromBufferAttribute(a,S+2),_.subVectors(d,c),x.subVectors(s,c),_.cross(x),o.setXYZ(S+0,_.x,_.y,_.z),o.setXYZ(S+1,_.x,_.y,_.z),o.setXYZ(S+2,_.x,_.y,_.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let a=0,o=e.count;a<o;a++)No.fromBufferAttribute(e,a),No.normalize(),e.setXYZ(a,No.x,No.y,No.z)}toNonIndexed(){function e(f,m){const y=f.array,_=f.itemSize,x=f.normalized,S=new y.constructor(m.length*_);let T=0,I=0;for(let k=0,D=m.length;k<D;k++){f.isInterleavedBufferAttribute?T=m[k]*f.data.stride+f.offset:T=m[k]*_;for(let L=0;L<_;L++)S[I++]=y[T++]}return new Xi(S,_,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const a=new La,o=this.index.array,s=this.attributes;for(const f in s){const m=s[f],y=e(m,o);a.setAttribute(f,y)}const c=this.morphAttributes;for(const f in c){const m=[],y=c[f];for(let _=0,x=y.length;_<x;_++){const S=y[_],T=e(S,o);m.push(T)}a.morphAttributes[f]=m}a.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let f=0,m=d.length;f<m;f++){const y=d[f];a.addGroup(y.start,y.count,y.materialIndex)}return a}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const m=this.parameters;for(const y in m)m[y]!==void 0&&(e[y]=m[y]);return e}e.data={attributes:{}};const a=this.index;a!==null&&(e.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});const o=this.attributes;for(const m in o){const y=o[m];e.data.attributes[m]=y.toJSON(e.data)}const s={};let c=!1;for(const m in this.morphAttributes){const y=this.morphAttributes[m],_=[];for(let x=0,S=y.length;x<S;x++){const T=y[x];_.push(T.toJSON(e.data))}_.length>0&&(s[m]=_,c=!0)}c&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const f=this.boundingSphere;return f!==null&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const a={};this.name=e.name;const o=e.index;o!==null&&this.setIndex(o.clone(a));const s=e.attributes;for(const y in s){const _=s[y];this.setAttribute(y,_.clone(a))}const c=e.morphAttributes;for(const y in c){const _=[],x=c[y];for(let S=0,T=x.length;S<T;S++)_.push(x[S].clone(a));this.morphAttributes[y]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let y=0,_=d.length;y<_;y++){const x=d[y];this.addGroup(x.start,x.count,x.materialIndex)}const f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());const m=e.boundingSphere;return m!==null&&(this.boundingSphere=m.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const bW=new Ia,Dm=new Hg,wS=new Pc,xW=new Fe,Bv=new Fe,Uv=new Fe,Wv=new Fe,O4=new Fe,SS=new Fe,AS=new Kt,ES=new Kt,MS=new Kt,wW=new Fe,SW=new Fe,AW=new Fe,TS=new Fe,CS=new Fe;class So extends pi{constructor(e=new La,a=new Hh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}getVertexPosition(e,a){const o=this.geometry,s=o.attributes.position,c=o.morphAttributes.position,d=o.morphTargetsRelative;a.fromBufferAttribute(s,e);const f=this.morphTargetInfluences;if(c&&f){SS.set(0,0,0);for(let m=0,y=c.length;m<y;m++){const _=f[m],x=c[m];_!==0&&(O4.fromBufferAttribute(x,e),d?SS.addScaledVector(O4,_):SS.addScaledVector(O4.sub(a),_))}a.add(SS)}return a}raycast(e,a){const o=this.geometry,s=this.material,c=this.matrixWorld;s!==void 0&&(o.boundingSphere===null&&o.computeBoundingSphere(),wS.copy(o.boundingSphere),wS.applyMatrix4(c),Dm.copy(e.ray).recast(e.near),!(wS.containsPoint(Dm.origin)===!1&&(Dm.intersectSphere(wS,xW)===null||Dm.origin.distanceToSquared(xW)>(e.far-e.near)**2))&&(bW.copy(c).invert(),Dm.copy(e.ray).applyMatrix4(bW),!(o.boundingBox!==null&&Dm.intersectsBox(o.boundingBox)===!1)&&this._computeIntersections(e,a,Dm)))}_computeIntersections(e,a,o){let s;const c=this.geometry,d=this.material,f=c.index,m=c.attributes.position,y=c.attributes.uv,_=c.attributes.uv1,x=c.attributes.normal,S=c.groups,T=c.drawRange;if(f!==null)if(Array.isArray(d))for(let I=0,k=S.length;I<k;I++){const D=S[I],L=d[D.materialIndex],O=Math.max(D.start,T.start),F=Math.min(f.count,Math.min(D.start+D.count,T.start+T.count));for(let B=O,G=F;B<G;B+=3){const q=f.getX(B),X=f.getX(B+1),te=f.getX(B+2);s=PS(this,L,e,o,y,_,x,q,X,te),s&&(s.faceIndex=Math.floor(B/3),s.face.materialIndex=D.materialIndex,a.push(s))}}else{const I=Math.max(0,T.start),k=Math.min(f.count,T.start+T.count);for(let D=I,L=k;D<L;D+=3){const O=f.getX(D),F=f.getX(D+1),B=f.getX(D+2);s=PS(this,d,e,o,y,_,x,O,F,B),s&&(s.faceIndex=Math.floor(D/3),a.push(s))}}else if(m!==void 0)if(Array.isArray(d))for(let I=0,k=S.length;I<k;I++){const D=S[I],L=d[D.materialIndex],O=Math.max(D.start,T.start),F=Math.min(m.count,Math.min(D.start+D.count,T.start+T.count));for(let B=O,G=F;B<G;B+=3){const q=B,X=B+1,te=B+2;s=PS(this,L,e,o,y,_,x,q,X,te),s&&(s.faceIndex=Math.floor(B/3),s.face.materialIndex=D.materialIndex,a.push(s))}}else{const I=Math.max(0,T.start),k=Math.min(m.count,T.start+T.count);for(let D=I,L=k;D<L;D+=3){const O=D,F=D+1,B=D+2;s=PS(this,d,e,o,y,_,x,O,F,B),s&&(s.faceIndex=Math.floor(D/3),a.push(s))}}}}function w_e(n,e,a,o,s,c,d,f){let m;if(e.side===Ss?m=o.intersectTriangle(d,c,s,!0,f):m=o.intersectTriangle(s,c,d,e.side===yd,f),m===null)return null;CS.copy(f),CS.applyMatrix4(n.matrixWorld);const y=a.ray.origin.distanceTo(CS);return y<a.near||y>a.far?null:{distance:y,point:CS.clone(),object:n}}function PS(n,e,a,o,s,c,d,f,m,y){n.getVertexPosition(f,Bv),n.getVertexPosition(m,Uv),n.getVertexPosition(y,Wv);const _=w_e(n,e,a,o,Bv,Uv,Wv,TS);if(_){s&&(AS.fromBufferAttribute(s,f),ES.fromBufferAttribute(s,m),MS.fromBufferAttribute(s,y),_.uv=fl.getInterpolation(TS,Bv,Uv,Wv,AS,ES,MS,new Kt)),c&&(AS.fromBufferAttribute(c,f),ES.fromBufferAttribute(c,m),MS.fromBufferAttribute(c,y),_.uv1=fl.getInterpolation(TS,Bv,Uv,Wv,AS,ES,MS,new Kt),_.uv2=_.uv1),d&&(wW.fromBufferAttribute(d,f),SW.fromBufferAttribute(d,m),AW.fromBufferAttribute(d,y),_.normal=fl.getInterpolation(TS,Bv,Uv,Wv,wW,SW,AW,new Fe),_.normal.dot(o.direction)>0&&_.normal.multiplyScalar(-1));const x={a:f,b:m,c:y,normal:new Fe,materialIndex:0};fl.getNormal(Bv,Uv,Wv,x.normal),_.face=x}return _}class jg extends La{constructor(e=1,a=1,o=1,s=1,c=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:a,depth:o,widthSegments:s,heightSegments:c,depthSegments:d};const f=this;s=Math.floor(s),c=Math.floor(c),d=Math.floor(d);const m=[],y=[],_=[],x=[];let S=0,T=0;I("z","y","x",-1,-1,o,a,e,d,c,0),I("z","y","x",1,-1,o,a,-e,d,c,1),I("x","z","y",1,1,e,o,a,s,d,2),I("x","z","y",1,-1,e,o,-a,s,d,3),I("x","y","z",1,-1,e,a,o,s,c,4),I("x","y","z",-1,-1,e,a,-o,s,c,5),this.setIndex(m),this.setAttribute("position",new Wn(y,3)),this.setAttribute("normal",new Wn(_,3)),this.setAttribute("uv",new Wn(x,2));function I(k,D,L,O,F,B,G,q,X,te,V){const Q=B/X,ge=G/te,me=B/2,be=G/2,fe=q/2,Ce=X+1,Le=te+1;let Ge=0,le=0;const pe=new Fe;for(let Ae=0;Ae<Le;Ae++){const ae=Ae*ge-be;for(let Ee=0;Ee<Ce;Ee++){const Ze=Ee*Q-me;pe[k]=Ze*O,pe[D]=ae*F,pe[L]=fe,y.push(pe.x,pe.y,pe.z),pe[k]=0,pe[D]=0,pe[L]=q>0?1:-1,_.push(pe.x,pe.y,pe.z),x.push(Ee/X),x.push(1-Ae/te),Ge+=1}}for(let Ae=0;Ae<te;Ae++)for(let ae=0;ae<X;ae++){const Ee=S+ae+Ce*Ae,Ze=S+ae+Ce*(Ae+1),Xe=S+(ae+1)+Ce*(Ae+1),Ke=S+(ae+1)+Ce*Ae;m.push(Ee,Ze,Ke),m.push(Ze,Xe,Ke),le+=6}f.addGroup(T,le,V),T+=le,S+=Ge}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function a_(n){const e={};for(const a in n){e[a]={};for(const o in n[a]){const s=n[a][o];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[a][o]=null):e[a][o]=s.clone():Array.isArray(s)?e[a][o]=s.slice():e[a][o]=s}}return e}function Ws(n){const e={};for(let a=0;a<n.length;a++){const o=a_(n[a]);for(const s in o)e[s]=o[s]}return e}function S_e(n){const e=[];for(let a=0;a<n.length;a++)e.push(n[a].clone());return e}function $Y(n){return n.getRenderTarget()===null?n.outputColorSpace:zi.workingColorSpace}const s6={clone:a_,merge:Ws};var A_e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,E_e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class _d extends as{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=A_e,this.fragmentShader=E_e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=a_(e.uniforms),this.uniformsGroups=S_e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const a=super.toJSON(e);a.glslVersion=this.glslVersion,a.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;d&&d.isTexture?a.uniforms[s]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?a.uniforms[s]={type:"c",value:d.getHex()}:d&&d.isVector2?a.uniforms[s]={type:"v2",value:d.toArray()}:d&&d.isVector3?a.uniforms[s]={type:"v3",value:d.toArray()}:d&&d.isVector4?a.uniforms[s]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?a.uniforms[s]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?a.uniforms[s]={type:"m4",value:d.toArray()}:a.uniforms[s]={value:d}}Object.keys(this.defines).length>0&&(a.defines=this.defines),a.vertexShader=this.vertexShader,a.fragmentShader=this.fragmentShader,a.lights=this.lights,a.clipping=this.clipping;const o={};for(const s in this.extensions)this.extensions[s]===!0&&(o[s]=!0);return Object.keys(o).length>0&&(a.extensions=o),a}}class Dw extends pi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ia,this.projectionMatrix=new Ia,this.projectionMatrixInverse=new Ia,this.coordinateSystem=ld}copy(e,a){return super.copy(e,a),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,a){super.updateWorldMatrix(e,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class qr extends Dw{constructor(e=50,a=1,o=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=s,this.focus=10,this.aspect=a,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,a){return super.copy(e,a),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const a=.5*this.getFilmHeight()/e;this.fov=n_*2*Math.atan(a),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(bg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return n_*2*Math.atan(Math.tan(bg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,a,o,s,c,d){this.aspect=e/a,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=o,this.view.offsetY=s,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let a=e*Math.tan(bg*.5*this.fov)/this.zoom,o=2*a,s=this.aspect*o,c=-.5*s;const d=this.view;if(this.view!==null&&this.view.enabled){const m=d.fullWidth,y=d.fullHeight;c+=d.offsetX*s/m,a-=d.offsetY*o/y,s*=d.width/m,o*=d.height/y}const f=this.filmOffset;f!==0&&(c+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+s,a,a-o,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const a=super.toJSON(e);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,this.view!==null&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}}const Vv=-90,Gv=1;class qY extends pi{constructor(e,a,o){super(),this.type="CubeCamera",this.renderTarget=o,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new qr(Vv,Gv,e,a);s.layers=this.layers,this.add(s);const c=new qr(Vv,Gv,e,a);c.layers=this.layers,this.add(c);const d=new qr(Vv,Gv,e,a);d.layers=this.layers,this.add(d);const f=new qr(Vv,Gv,e,a);f.layers=this.layers,this.add(f);const m=new qr(Vv,Gv,e,a);m.layers=this.layers,this.add(m);const y=new qr(Vv,Gv,e,a);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,a=this.children.concat(),[o,s,c,d,f,m]=a;for(const y of a)this.remove(y);if(e===ld)o.up.set(0,1,0),o.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),c.up.set(0,0,-1),c.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),m.up.set(0,1,0),m.lookAt(0,0,-1);else if(e===Yx)o.up.set(0,-1,0),o.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),c.up.set(0,0,1),c.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),m.up.set(0,-1,0),m.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of a)this.add(y),y.updateMatrixWorld()}update(e,a){this.parent===null&&this.updateMatrixWorld();const{renderTarget:o,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[c,d,f,m,y,_]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),T=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const k=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,e.setRenderTarget(o,0,s),e.render(a,c),e.setRenderTarget(o,1,s),e.render(a,d),e.setRenderTarget(o,2,s),e.render(a,f),e.setRenderTarget(o,3,s),e.render(a,m),e.setRenderTarget(o,4,s),e.render(a,y),o.texture.generateMipmaps=k,e.setRenderTarget(o,5,s),e.render(a,_),e.setRenderTarget(x,S,T),e.xr.enabled=I,o.texture.needsPMREMUpdate=!0}}class Ow extends kr{constructor(e,a,o,s,c,d,f,m,y,_){e=e!==void 0?e:[],a=a!==void 0?a:Nh,super(e,a,o,s,c,d,f,m,y,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class XY extends pu{constructor(e=1,a={}){super(e,e,a),this.isWebGLCubeRenderTarget=!0;const o={width:e,height:e,depth:1},s=[o,o,o,o,o,o];a.encoding!==void 0&&(tx("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=a.encoding===hp?Io:jl),this.texture=new Ow(s,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=a.generateMipmaps!==void 0?a.generateMipmaps:!1,this.texture.minFilter=a.minFilter!==void 0?a.minFilter:Ir}fromEquirectangularTexture(e,a){this.texture.type=a.type,this.texture.colorSpace=a.colorSpace,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new jg(5,5,5),c=new _d({name:"CubemapFromEquirect",uniforms:a_(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:Ss,blending:Ih});c.uniforms.tEquirect.value=a;const d=new So(s,c),f=a.minFilter;return a.minFilter===_p&&(a.minFilter=Ir),new qY(1,10,this).update(e,d),a.minFilter=f,d.geometry.dispose(),d.material.dispose(),this}clear(e,a,o,s){const c=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(a,o,s);e.setRenderTarget(c)}}const z4=new Fe,M_e=new Fe,T_e=new Na;class vh{constructor(e=new Fe(1,0,0),a=0){this.isPlane=!0,this.normal=e,this.constant=a}set(e,a){return this.normal.copy(e),this.constant=a,this}setComponents(e,a,o,s){return this.normal.set(e,a,o),this.constant=s,this}setFromNormalAndCoplanarPoint(e,a){return this.normal.copy(e),this.constant=-a.dot(this.normal),this}setFromCoplanarPoints(e,a,o){const s=z4.subVectors(o,a).cross(M_e.subVectors(e,a)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,a){return a.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,a){const o=e.delta(z4),s=this.normal.dot(o);if(s===0)return this.distanceToPoint(e.start)===0?a.copy(e.start):null;const c=-(e.start.dot(this.normal)+this.constant)/s;return c<0||c>1?null:a.copy(e.start).addScaledVector(o,c)}intersectsLine(e){const a=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return a<0&&o>0||o<0&&a>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,a){const o=a||T_e.getNormalMatrix(e),s=this.coplanarPoint(z4).applyMatrix4(e),c=this.normal.applyMatrix3(o).normalize();return this.constant=-s.dot(c),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Om=new Pc,IS=new Fe;class OT{constructor(e=new vh,a=new vh,o=new vh,s=new vh,c=new vh,d=new vh){this.planes=[e,a,o,s,c,d]}set(e,a,o,s,c,d){const f=this.planes;return f[0].copy(e),f[1].copy(a),f[2].copy(o),f[3].copy(s),f[4].copy(c),f[5].copy(d),this}copy(e){const a=this.planes;for(let o=0;o<6;o++)a[o].copy(e.planes[o]);return this}setFromProjectionMatrix(e,a=ld){const o=this.planes,s=e.elements,c=s[0],d=s[1],f=s[2],m=s[3],y=s[4],_=s[5],x=s[6],S=s[7],T=s[8],I=s[9],k=s[10],D=s[11],L=s[12],O=s[13],F=s[14],B=s[15];if(o[0].setComponents(m-c,S-y,D-T,B-L).normalize(),o[1].setComponents(m+c,S+y,D+T,B+L).normalize(),o[2].setComponents(m+d,S+_,D+I,B+O).normalize(),o[3].setComponents(m-d,S-_,D-I,B-O).normalize(),o[4].setComponents(m-f,S-x,D-k,B-F).normalize(),a===ld)o[5].setComponents(m+f,S+x,D+k,B+F).normalize();else if(a===Yx)o[5].setComponents(f,x,k,F).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+a);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Om.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const a=e.geometry;a.boundingSphere===null&&a.computeBoundingSphere(),Om.copy(a.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Om)}intersectsSprite(e){return Om.center.set(0,0,0),Om.radius=.7071067811865476,Om.applyMatrix4(e.matrixWorld),this.intersectsSphere(Om)}intersectsSphere(e){const a=this.planes,o=e.center,s=-e.radius;for(let c=0;c<6;c++)if(a[c].distanceToPoint(o)<s)return!1;return!0}intersectsBox(e){const a=this.planes;for(let o=0;o<6;o++){const s=a[o];if(IS.x=s.normal.x>0?e.max.x:e.min.x,IS.y=s.normal.y>0?e.max.y:e.min.y,IS.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(IS)<0)return!1}return!0}containsPoint(e){const a=this.planes;for(let o=0;o<6;o++)if(a[o].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function YY(){let n=null,e=!1,a=null,o=null;function s(c,d){a(c,d),o=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&a!==null&&(o=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(o),e=!1},setAnimationLoop:function(c){a=c},setContext:function(c){n=c}}}function C_e(n,e){const a=e.isWebGL2,o=new WeakMap;function s(y,_){const x=y.array,S=y.usage,T=n.createBuffer();n.bindBuffer(_,T),n.bufferData(_,x,S),y.onUploadCallback();let I;if(x instanceof Float32Array)I=n.FLOAT;else if(x instanceof Uint16Array)if(y.isFloat16BufferAttribute)if(a)I=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else I=n.UNSIGNED_SHORT;else if(x instanceof Int16Array)I=n.SHORT;else if(x instanceof Uint32Array)I=n.UNSIGNED_INT;else if(x instanceof Int32Array)I=n.INT;else if(x instanceof Int8Array)I=n.BYTE;else if(x instanceof Uint8Array)I=n.UNSIGNED_BYTE;else if(x instanceof Uint8ClampedArray)I=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+x);return{buffer:T,type:I,bytesPerElement:x.BYTES_PER_ELEMENT,version:y.version}}function c(y,_,x){const S=_.array,T=_.updateRange;n.bindBuffer(x,y),T.count===-1?n.bufferSubData(x,0,S):(a?n.bufferSubData(x,T.offset*S.BYTES_PER_ELEMENT,S,T.offset,T.count):n.bufferSubData(x,T.offset*S.BYTES_PER_ELEMENT,S.subarray(T.offset,T.offset+T.count)),T.count=-1),_.onUploadCallback()}function d(y){return y.isInterleavedBufferAttribute&&(y=y.data),o.get(y)}function f(y){y.isInterleavedBufferAttribute&&(y=y.data);const _=o.get(y);_&&(n.deleteBuffer(_.buffer),o.delete(y))}function m(y,_){if(y.isGLBufferAttribute){const S=o.get(y);(!S||S.version<y.version)&&o.set(y,{buffer:y.buffer,type:y.type,bytesPerElement:y.elementSize,version:y.version});return}y.isInterleavedBufferAttribute&&(y=y.data);const x=o.get(y);x===void 0?o.set(y,s(y,_)):x.version<y.version&&(c(x.buffer,y,_),x.version=y.version)}return{get:d,remove:f,update:m}}class Tp extends La{constructor(e=1,a=1,o=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:a,widthSegments:o,heightSegments:s};const c=e/2,d=a/2,f=Math.floor(o),m=Math.floor(s),y=f+1,_=m+1,x=e/f,S=a/m,T=[],I=[],k=[],D=[];for(let L=0;L<_;L++){const O=L*S-d;for(let F=0;F<y;F++){const B=F*x-c;I.push(B,-O,0),k.push(0,0,1),D.push(F/f),D.push(1-L/m)}}for(let L=0;L<m;L++)for(let O=0;O<f;O++){const F=O+y*L,B=O+y*(L+1),G=O+1+y*(L+1),q=O+1+y*L;T.push(F,B,q),T.push(B,G,q)}this.setIndex(T),this.setAttribute("position",new Wn(I,3)),this.setAttribute("normal",new Wn(k,3)),this.setAttribute("uv",new Wn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Tp(e.width,e.height,e.widthSegments,e.heightSegments)}}var P_e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,I_e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,L_e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,R_e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,k_e=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,D_e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,O_e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,z_e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,F_e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,N_e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,B_e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,U_e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,W_e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,V_e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,G_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,H_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,j_e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,$_e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,q_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,X_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Y_e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Z_e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,K_e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,J_e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Q_e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,e1e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,t1e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,n1e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,a1e="gl_FragColor = linearToOutputTexel( gl_FragColor );",i1e=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,r1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,o1e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,s1e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,l1e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,c1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,u1e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,d1e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,h1e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,f1e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,p1e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,m1e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,g1e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,y1e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,v1e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,_1e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,b1e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,x1e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,w1e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,S1e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,A1e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,E1e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,M1e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,T1e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,C1e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,P1e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,I1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,L1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,R1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,k1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,D1e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,O1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,z1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,F1e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,N1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,B1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,U1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,W1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,V1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,G1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,H1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,j1e=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,$1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,q1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,X1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Y1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Z1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,K1e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,J1e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Q1e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,ebe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,tbe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,nbe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,abe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,ibe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,rbe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,obe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,sbe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,lbe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,cbe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,ube=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,dbe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,hbe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,fbe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,pbe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,mbe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,gbe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ybe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,vbe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,_be=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,bbe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,xbe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,wbe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Sbe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Abe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Ebe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Mbe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Tbe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Cbe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Pbe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Ibe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Lbe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Rbe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,kbe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Dbe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Obe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,zbe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Fbe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Nbe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Bbe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ube=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Wbe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vbe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Gbe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hbe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,jbe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$be=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,qbe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Xbe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ybe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zbe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Kbe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Jbe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Qbe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,exe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,txe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,nxe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,axe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ixe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,rxe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Oa={alphahash_fragment:P_e,alphahash_pars_fragment:I_e,alphamap_fragment:L_e,alphamap_pars_fragment:R_e,alphatest_fragment:k_e,alphatest_pars_fragment:D_e,aomap_fragment:O_e,aomap_pars_fragment:z_e,begin_vertex:F_e,beginnormal_vertex:N_e,bsdfs:B_e,iridescence_fragment:U_e,bumpmap_pars_fragment:W_e,clipping_planes_fragment:V_e,clipping_planes_pars_fragment:G_e,clipping_planes_pars_vertex:H_e,clipping_planes_vertex:j_e,color_fragment:$_e,color_pars_fragment:q_e,color_pars_vertex:X_e,color_vertex:Y_e,common:Z_e,cube_uv_reflection_fragment:K_e,defaultnormal_vertex:J_e,displacementmap_pars_vertex:Q_e,displacementmap_vertex:e1e,emissivemap_fragment:t1e,emissivemap_pars_fragment:n1e,colorspace_fragment:a1e,colorspace_pars_fragment:i1e,envmap_fragment:r1e,envmap_common_pars_fragment:o1e,envmap_pars_fragment:s1e,envmap_pars_vertex:l1e,envmap_physical_pars_fragment:b1e,envmap_vertex:c1e,fog_vertex:u1e,fog_pars_vertex:d1e,fog_fragment:h1e,fog_pars_fragment:f1e,gradientmap_pars_fragment:p1e,lightmap_fragment:m1e,lightmap_pars_fragment:g1e,lights_lambert_fragment:y1e,lights_lambert_pars_fragment:v1e,lights_pars_begin:_1e,lights_toon_fragment:x1e,lights_toon_pars_fragment:w1e,lights_phong_fragment:S1e,lights_phong_pars_fragment:A1e,lights_physical_fragment:E1e,lights_physical_pars_fragment:M1e,lights_fragment_begin:T1e,lights_fragment_maps:C1e,lights_fragment_end:P1e,logdepthbuf_fragment:I1e,logdepthbuf_pars_fragment:L1e,logdepthbuf_pars_vertex:R1e,logdepthbuf_vertex:k1e,map_fragment:D1e,map_pars_fragment:O1e,map_particle_fragment:z1e,map_particle_pars_fragment:F1e,metalnessmap_fragment:N1e,metalnessmap_pars_fragment:B1e,morphcolor_vertex:U1e,morphnormal_vertex:W1e,morphtarget_pars_vertex:V1e,morphtarget_vertex:G1e,normal_fragment_begin:H1e,normal_fragment_maps:j1e,normal_pars_fragment:$1e,normal_pars_vertex:q1e,normal_vertex:X1e,normalmap_pars_fragment:Y1e,clearcoat_normal_fragment_begin:Z1e,clearcoat_normal_fragment_maps:K1e,clearcoat_pars_fragment:J1e,iridescence_pars_fragment:Q1e,opaque_fragment:ebe,packing:tbe,premultiplied_alpha_fragment:nbe,project_vertex:abe,dithering_fragment:ibe,dithering_pars_fragment:rbe,roughnessmap_fragment:obe,roughnessmap_pars_fragment:sbe,shadowmap_pars_fragment:lbe,shadowmap_pars_vertex:cbe,shadowmap_vertex:ube,shadowmask_pars_fragment:dbe,skinbase_vertex:hbe,skinning_pars_vertex:fbe,skinning_vertex:pbe,skinnormal_vertex:mbe,specularmap_fragment:gbe,specularmap_pars_fragment:ybe,tonemapping_fragment:vbe,tonemapping_pars_fragment:_be,transmission_fragment:bbe,transmission_pars_fragment:xbe,uv_pars_fragment:wbe,uv_pars_vertex:Sbe,uv_vertex:Abe,worldpos_vertex:Ebe,background_vert:Mbe,background_frag:Tbe,backgroundCube_vert:Cbe,backgroundCube_frag:Pbe,cube_vert:Ibe,cube_frag:Lbe,depth_vert:Rbe,depth_frag:kbe,distanceRGBA_vert:Dbe,distanceRGBA_frag:Obe,equirect_vert:zbe,equirect_frag:Fbe,linedashed_vert:Nbe,linedashed_frag:Bbe,meshbasic_vert:Ube,meshbasic_frag:Wbe,meshlambert_vert:Vbe,meshlambert_frag:Gbe,meshmatcap_vert:Hbe,meshmatcap_frag:jbe,meshnormal_vert:$be,meshnormal_frag:qbe,meshphong_vert:Xbe,meshphong_frag:Ybe,meshphysical_vert:Zbe,meshphysical_frag:Kbe,meshtoon_vert:Jbe,meshtoon_frag:Qbe,points_vert:exe,points_frag:txe,shadow_vert:nxe,shadow_frag:axe,sprite_vert:ixe,sprite_frag:rxe},bn={common:{diffuse:{value:new Pn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Na},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Na}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Na}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Na}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Na},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Na},normalScale:{value:new Kt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Na},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Na}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Na}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Na}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0},uvTransform:{value:new Na}},sprite:{diffuse:{value:new Pn(16777215)},opacity:{value:1},center:{value:new Kt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Na},alphaMap:{value:null},alphaMapTransform:{value:new Na},alphaTest:{value:0}}},ru={basic:{uniforms:Ws([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.fog]),vertexShader:Oa.meshbasic_vert,fragmentShader:Oa.meshbasic_frag},lambert:{uniforms:Ws([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:Oa.meshlambert_vert,fragmentShader:Oa.meshlambert_frag},phong:{uniforms:Ws([bn.common,bn.specularmap,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)},specular:{value:new Pn(1118481)},shininess:{value:30}}]),vertexShader:Oa.meshphong_vert,fragmentShader:Oa.meshphong_frag},standard:{uniforms:Ws([bn.common,bn.envmap,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.roughnessmap,bn.metalnessmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag},toon:{uniforms:Ws([bn.common,bn.aomap,bn.lightmap,bn.emissivemap,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.gradientmap,bn.fog,bn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:Oa.meshtoon_vert,fragmentShader:Oa.meshtoon_frag},matcap:{uniforms:Ws([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,bn.fog,{matcap:{value:null}}]),vertexShader:Oa.meshmatcap_vert,fragmentShader:Oa.meshmatcap_frag},points:{uniforms:Ws([bn.points,bn.fog]),vertexShader:Oa.points_vert,fragmentShader:Oa.points_frag},dashed:{uniforms:Ws([bn.common,bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Oa.linedashed_vert,fragmentShader:Oa.linedashed_frag},depth:{uniforms:Ws([bn.common,bn.displacementmap]),vertexShader:Oa.depth_vert,fragmentShader:Oa.depth_frag},normal:{uniforms:Ws([bn.common,bn.bumpmap,bn.normalmap,bn.displacementmap,{opacity:{value:1}}]),vertexShader:Oa.meshnormal_vert,fragmentShader:Oa.meshnormal_frag},sprite:{uniforms:Ws([bn.sprite,bn.fog]),vertexShader:Oa.sprite_vert,fragmentShader:Oa.sprite_frag},background:{uniforms:{uvTransform:{value:new Na},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Oa.background_vert,fragmentShader:Oa.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Oa.backgroundCube_vert,fragmentShader:Oa.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Oa.cube_vert,fragmentShader:Oa.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Oa.equirect_vert,fragmentShader:Oa.equirect_frag},distanceRGBA:{uniforms:Ws([bn.common,bn.displacementmap,{referencePosition:{value:new Fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Oa.distanceRGBA_vert,fragmentShader:Oa.distanceRGBA_frag},shadow:{uniforms:Ws([bn.lights,bn.fog,{color:{value:new Pn(0)},opacity:{value:1}}]),vertexShader:Oa.shadow_vert,fragmentShader:Oa.shadow_frag}};ru.physical={uniforms:Ws([ru.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Na},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Na},clearcoatNormalScale:{value:new Kt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Na},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Na},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Na},sheen:{value:0},sheenColor:{value:new Pn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Na},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Na},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Na},transmissionSamplerSize:{value:new Kt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Na},attenuationDistance:{value:0},attenuationColor:{value:new Pn(0)},specularColor:{value:new Pn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Na},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Na},anisotropyVector:{value:new Kt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Na}}]),vertexShader:Oa.meshphysical_vert,fragmentShader:Oa.meshphysical_frag};const LS={r:0,b:0,g:0};function oxe(n,e,a,o,s,c,d){const f=new Pn(0);let m=c===!0?0:1,y,_,x=null,S=0,T=null;function I(D,L){let O=!1,F=L.isScene===!0?L.background:null;F&&F.isTexture&&(F=(L.backgroundBlurriness>0?a:e).get(F)),F===null?k(f,m):F&&F.isColor&&(k(F,1),O=!0);const B=n.xr.getEnvironmentBlendMode();B==="additive"?o.buffers.color.setClear(0,0,0,1,d):B==="alpha-blend"&&o.buffers.color.setClear(0,0,0,0,d),(n.autoClear||O)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),F&&(F.isCubeTexture||F.mapping===g_)?(_===void 0&&(_=new So(new jg(1,1,1),new _d({name:"BackgroundCubeMaterial",uniforms:a_(ru.backgroundCube.uniforms),vertexShader:ru.backgroundCube.vertexShader,fragmentShader:ru.backgroundCube.fragmentShader,side:Ss,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(G,q,X){this.matrixWorld.copyPosition(X.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(_)),_.material.uniforms.envMap.value=F,_.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,_.material.toneMapped=zi.getTransfer(F.colorSpace)!==Qi,(x!==F||S!==F.version||T!==n.toneMapping)&&(_.material.needsUpdate=!0,x=F,S=F.version,T=n.toneMapping),_.layers.enableAll(),D.unshift(_,_.geometry,_.material,0,0,null)):F&&F.isTexture&&(y===void 0&&(y=new So(new Tp(2,2),new _d({name:"BackgroundMaterial",uniforms:a_(ru.background.uniforms),vertexShader:ru.background.vertexShader,fragmentShader:ru.background.fragmentShader,side:yd,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(y)),y.material.uniforms.t2D.value=F,y.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,y.material.toneMapped=zi.getTransfer(F.colorSpace)!==Qi,F.matrixAutoUpdate===!0&&F.updateMatrix(),y.material.uniforms.uvTransform.value.copy(F.matrix),(x!==F||S!==F.version||T!==n.toneMapping)&&(y.material.needsUpdate=!0,x=F,S=F.version,T=n.toneMapping),y.layers.enableAll(),D.unshift(y,y.geometry,y.material,0,0,null))}function k(D,L){D.getRGB(LS,$Y(n)),o.buffers.color.setClear(LS.r,LS.g,LS.b,L,d)}return{getClearColor:function(){return f},setClearColor:function(D,L=1){f.set(D),m=L,k(f,m)},getClearAlpha:function(){return m},setClearAlpha:function(D){m=D,k(f,m)},render:I}}function sxe(n,e,a,o){const s=n.getParameter(n.MAX_VERTEX_ATTRIBS),c=o.isWebGL2?null:e.get("OES_vertex_array_object"),d=o.isWebGL2||c!==null,f={},m=D(null);let y=m,_=!1;function x(fe,Ce,Le,Ge,le){let pe=!1;if(d){const Ae=k(Ge,Le,Ce);y!==Ae&&(y=Ae,T(y.object)),pe=L(fe,Ge,Le,le),pe&&O(fe,Ge,Le,le)}else{const Ae=Ce.wireframe===!0;(y.geometry!==Ge.id||y.program!==Le.id||y.wireframe!==Ae)&&(y.geometry=Ge.id,y.program=Le.id,y.wireframe=Ae,pe=!0)}le!==null&&a.update(le,n.ELEMENT_ARRAY_BUFFER),(pe||_)&&(_=!1,te(fe,Ce,Le,Ge),le!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,a.get(le).buffer))}function S(){return o.isWebGL2?n.createVertexArray():c.createVertexArrayOES()}function T(fe){return o.isWebGL2?n.bindVertexArray(fe):c.bindVertexArrayOES(fe)}function I(fe){return o.isWebGL2?n.deleteVertexArray(fe):c.deleteVertexArrayOES(fe)}function k(fe,Ce,Le){const Ge=Le.wireframe===!0;let le=f[fe.id];le===void 0&&(le={},f[fe.id]=le);let pe=le[Ce.id];pe===void 0&&(pe={},le[Ce.id]=pe);let Ae=pe[Ge];return Ae===void 0&&(Ae=D(S()),pe[Ge]=Ae),Ae}function D(fe){const Ce=[],Le=[],Ge=[];for(let le=0;le<s;le++)Ce[le]=0,Le[le]=0,Ge[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ce,enabledAttributes:Le,attributeDivisors:Ge,object:fe,attributes:{},index:null}}function L(fe,Ce,Le,Ge){const le=y.attributes,pe=Ce.attributes;let Ae=0;const ae=Le.getAttributes();for(const Ee in ae)if(ae[Ee].location>=0){const Xe=le[Ee];let Ke=pe[Ee];if(Ke===void 0&&(Ee==="instanceMatrix"&&fe.instanceMatrix&&(Ke=fe.instanceMatrix),Ee==="instanceColor"&&fe.instanceColor&&(Ke=fe.instanceColor)),Xe===void 0||Xe.attribute!==Ke||Ke&&Xe.data!==Ke.data)return!0;Ae++}return y.attributesNum!==Ae||y.index!==Ge}function O(fe,Ce,Le,Ge){const le={},pe=Ce.attributes;let Ae=0;const ae=Le.getAttributes();for(const Ee in ae)if(ae[Ee].location>=0){let Xe=pe[Ee];Xe===void 0&&(Ee==="instanceMatrix"&&fe.instanceMatrix&&(Xe=fe.instanceMatrix),Ee==="instanceColor"&&fe.instanceColor&&(Xe=fe.instanceColor));const Ke={};Ke.attribute=Xe,Xe&&Xe.data&&(Ke.data=Xe.data),le[Ee]=Ke,Ae++}y.attributes=le,y.attributesNum=Ae,y.index=Ge}function F(){const fe=y.newAttributes;for(let Ce=0,Le=fe.length;Ce<Le;Ce++)fe[Ce]=0}function B(fe){G(fe,0)}function G(fe,Ce){const Le=y.newAttributes,Ge=y.enabledAttributes,le=y.attributeDivisors;Le[fe]=1,Ge[fe]===0&&(n.enableVertexAttribArray(fe),Ge[fe]=1),le[fe]!==Ce&&((o.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](fe,Ce),le[fe]=Ce)}function q(){const fe=y.newAttributes,Ce=y.enabledAttributes;for(let Le=0,Ge=Ce.length;Le<Ge;Le++)Ce[Le]!==fe[Le]&&(n.disableVertexAttribArray(Le),Ce[Le]=0)}function X(fe,Ce,Le,Ge,le,pe,Ae){Ae===!0?n.vertexAttribIPointer(fe,Ce,Le,le,pe):n.vertexAttribPointer(fe,Ce,Le,Ge,le,pe)}function te(fe,Ce,Le,Ge){if(o.isWebGL2===!1&&(fe.isInstancedMesh||Ge.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;F();const le=Ge.attributes,pe=Le.getAttributes(),Ae=Ce.defaultAttributeValues;for(const ae in pe){const Ee=pe[ae];if(Ee.location>=0){let Ze=le[ae];if(Ze===void 0&&(ae==="instanceMatrix"&&fe.instanceMatrix&&(Ze=fe.instanceMatrix),ae==="instanceColor"&&fe.instanceColor&&(Ze=fe.instanceColor)),Ze!==void 0){const Xe=Ze.normalized,Ke=Ze.itemSize,Ue=a.get(Ze);if(Ue===void 0)continue;const ft=Ue.buffer,Rt=Ue.type,kt=Ue.bytesPerElement,Jt=o.isWebGL2===!0&&(Rt===n.INT||Rt===n.UNSIGNED_INT||Ze.gpuType===qD);if(Ze.isInterleavedBufferAttribute){const It=Ze.data,Pe=It.stride,pt=Ze.offset;if(It.isInstancedInterleavedBuffer){for(let yt=0;yt<Ee.locationSize;yt++)G(Ee.location+yt,It.meshPerAttribute);fe.isInstancedMesh!==!0&&Ge._maxInstanceCount===void 0&&(Ge._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let yt=0;yt<Ee.locationSize;yt++)B(Ee.location+yt);n.bindBuffer(n.ARRAY_BUFFER,ft);for(let yt=0;yt<Ee.locationSize;yt++)X(Ee.location+yt,Ke/Ee.locationSize,Rt,Xe,Pe*kt,(pt+Ke/Ee.locationSize*yt)*kt,Jt)}else{if(Ze.isInstancedBufferAttribute){for(let It=0;It<Ee.locationSize;It++)G(Ee.location+It,Ze.meshPerAttribute);fe.isInstancedMesh!==!0&&Ge._maxInstanceCount===void 0&&(Ge._maxInstanceCount=Ze.meshPerAttribute*Ze.count)}else for(let It=0;It<Ee.locationSize;It++)B(Ee.location+It);n.bindBuffer(n.ARRAY_BUFFER,ft);for(let It=0;It<Ee.locationSize;It++)X(Ee.location+It,Ke/Ee.locationSize,Rt,Xe,Ke*kt,Ke/Ee.locationSize*It*kt,Jt)}}else if(Ae!==void 0){const Xe=Ae[ae];if(Xe!==void 0)switch(Xe.length){case 2:n.vertexAttrib2fv(Ee.location,Xe);break;case 3:n.vertexAttrib3fv(Ee.location,Xe);break;case 4:n.vertexAttrib4fv(Ee.location,Xe);break;default:n.vertexAttrib1fv(Ee.location,Xe)}}}}q()}function V(){me();for(const fe in f){const Ce=f[fe];for(const Le in Ce){const Ge=Ce[Le];for(const le in Ge)I(Ge[le].object),delete Ge[le];delete Ce[Le]}delete f[fe]}}function Q(fe){if(f[fe.id]===void 0)return;const Ce=f[fe.id];for(const Le in Ce){const Ge=Ce[Le];for(const le in Ge)I(Ge[le].object),delete Ge[le];delete Ce[Le]}delete f[fe.id]}function ge(fe){for(const Ce in f){const Le=f[Ce];if(Le[fe.id]===void 0)continue;const Ge=Le[fe.id];for(const le in Ge)I(Ge[le].object),delete Ge[le];delete Le[fe.id]}}function me(){be(),_=!0,y!==m&&(y=m,T(y.object))}function be(){m.geometry=null,m.program=null,m.wireframe=!1}return{setup:x,reset:me,resetDefaultState:be,dispose:V,releaseStatesOfGeometry:Q,releaseStatesOfProgram:ge,initAttributes:F,enableAttribute:B,disableUnusedAttributes:q}}function lxe(n,e,a,o){const s=o.isWebGL2;let c;function d(y){c=y}function f(y,_){n.drawArrays(c,y,_),a.update(_,c,1)}function m(y,_,x){if(x===0)return;let S,T;if(s)S=n,T="drawArraysInstanced";else if(S=e.get("ANGLE_instanced_arrays"),T="drawArraysInstancedANGLE",S===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}S[T](c,y,_,x),a.update(_,c,x)}this.setMode=d,this.render=f,this.renderInstances=m}function cxe(n,e,a){let o;function s(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const X=e.get("EXT_texture_filter_anisotropic");o=n.getParameter(X.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function c(X){if(X==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";X="mediump"}return X==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let f=a.precision!==void 0?a.precision:"highp";const m=c(f);m!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",m,"instead."),f=m);const y=d||e.has("WEBGL_draw_buffers"),_=a.logarithmicDepthBuffer===!0,x=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),T=n.getParameter(n.MAX_TEXTURE_SIZE),I=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),k=n.getParameter(n.MAX_VERTEX_ATTRIBS),D=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),O=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),F=S>0,B=d||e.has("OES_texture_float"),G=F&&B,q=d?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:d,drawBuffers:y,getMaxAnisotropy:s,getMaxPrecision:c,precision:f,logarithmicDepthBuffer:_,maxTextures:x,maxVertexTextures:S,maxTextureSize:T,maxCubemapSize:I,maxAttributes:k,maxVertexUniforms:D,maxVaryings:L,maxFragmentUniforms:O,vertexTextures:F,floatFragmentTextures:B,floatVertexTextures:G,maxSamples:q}}function uxe(n){const e=this;let a=null,o=0,s=!1,c=!1;const d=new vh,f=new Na,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S){const T=x.length!==0||S||o!==0||s;return s=S,o=x.length,T},this.beginShadows=function(){c=!0,_(null)},this.endShadows=function(){c=!1},this.setGlobalState=function(x,S){a=_(x,S,0)},this.setState=function(x,S,T){const I=x.clippingPlanes,k=x.clipIntersection,D=x.clipShadows,L=n.get(x);if(!s||I===null||I.length===0||c&&!D)c?_(null):y();else{const O=c?0:o,F=O*4;let B=L.clippingState||null;m.value=B,B=_(I,S,F,T);for(let G=0;G!==F;++G)B[G]=a[G];L.clippingState=B,this.numIntersection=k?this.numPlanes:0,this.numPlanes+=O}};function y(){m.value!==a&&(m.value=a,m.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function _(x,S,T,I){const k=x!==null?x.length:0;let D=null;if(k!==0){if(D=m.value,I!==!0||D===null){const L=T+k*4,O=S.matrixWorldInverse;f.getNormalMatrix(O),(D===null||D.length<L)&&(D=new Float32Array(L));for(let F=0,B=T;F!==k;++F,B+=4)d.copy(x[F]).applyMatrix4(O,f),d.normal.toArray(D,B),D[B+3]=d.constant}m.value=D,m.needsUpdate=!0}return e.numPlanes=k,e.numIntersection=0,D}}function dxe(n){let e=new WeakMap;function a(d,f){return f===Nx?d.mapping=Nh:f===Bx&&(d.mapping=vp),d}function o(d){if(d&&d.isTexture&&d.isRenderTargetTexture===!1){const f=d.mapping;if(f===Nx||f===Bx)if(e.has(d)){const m=e.get(d).texture;return a(m,d.mapping)}else{const m=d.image;if(m&&m.height>0){const y=new XY(m.height/2);return y.fromEquirectangularTexture(n,d),e.set(d,y),d.addEventListener("dispose",s),a(y.texture,d.mapping)}else return null}}return d}function s(d){const f=d.target;f.removeEventListener("dispose",s);const m=e.get(f);m!==void 0&&(e.delete(f),m.dispose())}function c(){e=new WeakMap}return{get:o,dispose:c}}class Eh extends Dw{constructor(e=-1,a=1,o=1,s=-1,c=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=a,this.top=o,this.bottom=s,this.near=c,this.far=d,this.updateProjectionMatrix()}copy(e,a){return super.copy(e,a),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,a,o,s,c,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=o,this.view.offsetY=s,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let c=o-e,d=o+e,f=s+a,m=s-a;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=y*this.view.offsetX,d=c+y*this.view.width,f-=_*this.view.offsetY,m=f-_*this.view.height}this.projectionMatrix.makeOrthographic(c,d,f,m,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const a=super.toJSON(e);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,this.view!==null&&(a.object.view=Object.assign({},this.view)),a}}const x0=4,EW=[.125,.215,.35,.446,.526,.582],ag=20,F4=new Eh,MW=new Pn;let N4=null,B4=0,U4=0;const Qm=(1+Math.sqrt(5))/2,Hv=1/Qm,TW=[new Fe(1,1,1),new Fe(-1,1,1),new Fe(1,1,-1),new Fe(-1,1,-1),new Fe(0,Qm,Hv),new Fe(0,Qm,-Hv),new Fe(Hv,0,Qm),new Fe(-Hv,0,Qm),new Fe(Qm,Hv,0),new Fe(-Qm,Hv,0)];class TR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,a=0,o=.1,s=100){N4=this._renderer.getRenderTarget(),B4=this._renderer.getActiveCubeFace(),U4=this._renderer.getActiveMipmapLevel(),this._setSize(256);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,o,s,c),a>0&&this._blur(c,0,0,a),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,a=null){return this._fromTexture(e,a)}fromCubemap(e,a=null){return this._fromTexture(e,a)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=IW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=PW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(N4,B4,U4),e.scissorTest=!1,RS(e,0,0,e.width,e.height)}_fromTexture(e,a){e.mapping===Nh||e.mapping===vp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),N4=this._renderer.getRenderTarget(),B4=this._renderer.getActiveCubeFace(),U4=this._renderer.getActiveMipmapLevel();const o=a||this._allocateTargets();return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),a=4*this._cubeSize,o={magFilter:Ir,minFilter:Ir,generateMipmaps:!1,type:t_,format:pl,colorSpace:vd,depthBuffer:!1},s=CW(e,a,o);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==a){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=CW(e,a,o);const{_lodMax:c}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=hxe(c)),this._blurMaterial=fxe(c,e,a)}return s}_compileMaterial(e){const a=new So(this._lodPlanes[0],e);this._renderer.compile(a,F4)}_sceneToCubeUV(e,a,o,s){const f=new qr(90,1,a,o),m=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],_=this._renderer,x=_.autoClear,S=_.toneMapping;_.getClearColor(MW),_.toneMapping=hd,_.autoClear=!1;const T=new Hh({name:"PMREM.Background",side:Ss,depthWrite:!1,depthTest:!1}),I=new So(new jg,T);let k=!1;const D=e.background;D?D.isColor&&(T.color.copy(D),e.background=null,k=!0):(T.color.copy(MW),k=!0);for(let L=0;L<6;L++){const O=L%3;O===0?(f.up.set(0,m[L],0),f.lookAt(y[L],0,0)):O===1?(f.up.set(0,0,m[L]),f.lookAt(0,y[L],0)):(f.up.set(0,m[L],0),f.lookAt(0,0,y[L]));const F=this._cubeSize;RS(s,O*F,L>2?F:0,F,F),_.setRenderTarget(s),k&&_.render(I,f),_.render(e,f)}I.geometry.dispose(),I.material.dispose(),_.toneMapping=S,_.autoClear=x,e.background=D}_textureToCubeUV(e,a){const o=this._renderer,s=e.mapping===Nh||e.mapping===vp;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=IW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=PW());const c=s?this._cubemapMaterial:this._equirectMaterial,d=new So(this._lodPlanes[0],c),f=c.uniforms;f.envMap.value=e;const m=this._cubeSize;RS(a,0,0,3*m,2*m),o.setRenderTarget(a),o.render(d,F4)}_applyPMREM(e){const a=this._renderer,o=a.autoClear;a.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const c=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),d=TW[(s-1)%TW.length];this._blur(e,s-1,s,c,d)}a.autoClear=o}_blur(e,a,o,s,c){const d=this._pingPongRenderTarget;this._halfBlur(e,d,a,o,s,"latitudinal",c),this._halfBlur(d,e,o,o,s,"longitudinal",c)}_halfBlur(e,a,o,s,c,d,f){const m=this._renderer,y=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,x=new So(this._lodPlanes[s],y),S=y.uniforms,T=this._sizeLods[o]-1,I=isFinite(c)?Math.PI/(2*T):2*Math.PI/(2*ag-1),k=c/I,D=isFinite(c)?1+Math.floor(_*k):ag;D>ag&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${D} samples when the maximum is set to ${ag}`);const L=[];let O=0;for(let X=0;X<ag;++X){const te=X/k,V=Math.exp(-te*te/2);L.push(V),X===0?O+=V:X<D&&(O+=2*V)}for(let X=0;X<L.length;X++)L[X]=L[X]/O;S.envMap.value=e.texture,S.samples.value=D,S.weights.value=L,S.latitudinal.value=d==="latitudinal",f&&(S.poleAxis.value=f);const{_lodMax:F}=this;S.dTheta.value=I,S.mipInt.value=F-o;const B=this._sizeLods[s],G=3*B*(s>F-x0?s-F+x0:0),q=4*(this._cubeSize-B);RS(a,G,q,3*B,2*B),m.setRenderTarget(a),m.render(x,F4)}}function hxe(n){const e=[],a=[],o=[];let s=n;const c=n-x0+1+EW.length;for(let d=0;d<c;d++){const f=Math.pow(2,s);a.push(f);let m=1/f;d>n-x0?m=EW[d-n+x0-1]:d===0&&(m=0),o.push(m);const y=1/(f-2),_=-y,x=1+y,S=[_,_,x,_,x,x,_,_,x,x,_,x],T=6,I=6,k=3,D=2,L=1,O=new Float32Array(k*I*T),F=new Float32Array(D*I*T),B=new Float32Array(L*I*T);for(let q=0;q<T;q++){const X=q%3*2/3-1,te=q>2?0:-1,V=[X,te,0,X+2/3,te,0,X+2/3,te+1,0,X,te,0,X+2/3,te+1,0,X,te+1,0];O.set(V,k*I*q),F.set(S,D*I*q);const Q=[q,q,q,q,q,q];B.set(Q,L*I*q)}const G=new La;G.setAttribute("position",new Xi(O,k)),G.setAttribute("uv",new Xi(F,D)),G.setAttribute("faceIndex",new Xi(B,L)),e.push(G),s>x0&&s--}return{lodPlanes:e,sizeLods:a,sigmas:o}}function CW(n,e,a){const o=new pu(n,e,a);return o.texture.mapping=g_,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function RS(n,e,a,o,s){n.viewport.set(e,a,o,s),n.scissor.set(e,a,o,s)}function fxe(n,e,a){const o=new Float32Array(ag),s=new Fe(0,1,0);return new _d({name:"SphericalGaussianBlur",defines:{n:ag,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/a,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:l6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function PW(){return new _d({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:l6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function IW(){return new _d({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:l6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ih,depthTest:!1,depthWrite:!1})}function l6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function pxe(n){let e=new WeakMap,a=null;function o(f){if(f&&f.isTexture){const m=f.mapping,y=m===Nx||m===Bx,_=m===Nh||m===vp;if(y||_)if(f.isRenderTargetTexture&&f.needsPMREMUpdate===!0){f.needsPMREMUpdate=!1;let x=e.get(f);return a===null&&(a=new TR(n)),x=y?a.fromEquirectangular(f,x):a.fromCubemap(f,x),e.set(f,x),x.texture}else{if(e.has(f))return e.get(f).texture;{const x=f.image;if(y&&x&&x.height>0||_&&x&&s(x)){a===null&&(a=new TR(n));const S=y?a.fromEquirectangular(f):a.fromCubemap(f);return e.set(f,S),f.addEventListener("dispose",c),S.texture}else return null}}}return f}function s(f){let m=0;const y=6;for(let _=0;_<y;_++)f[_]!==void 0&&m++;return m===y}function c(f){const m=f.target;m.removeEventListener("dispose",c);const y=e.get(m);y!==void 0&&(e.delete(m),y.dispose())}function d(){e=new WeakMap,a!==null&&(a.dispose(),a=null)}return{get:o,dispose:d}}function mxe(n){const e={};function a(o){if(e[o]!==void 0)return e[o];let s;switch(o){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(o)}return e[o]=s,s}return{has:function(o){return a(o)!==null},init:function(o){o.isWebGL2?a("EXT_color_buffer_float"):(a("WEBGL_depth_texture"),a("OES_texture_float"),a("OES_texture_half_float"),a("OES_texture_half_float_linear"),a("OES_standard_derivatives"),a("OES_element_index_uint"),a("OES_vertex_array_object"),a("ANGLE_instanced_arrays")),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float"),a("WEBGL_multisampled_render_to_texture")},get:function(o){const s=a(o);return s===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),s}}}function gxe(n,e,a,o){const s={},c=new WeakMap;function d(x){const S=x.target;S.index!==null&&e.remove(S.index);for(const I in S.attributes)e.remove(S.attributes[I]);for(const I in S.morphAttributes){const k=S.morphAttributes[I];for(let D=0,L=k.length;D<L;D++)e.remove(k[D])}S.removeEventListener("dispose",d),delete s[S.id];const T=c.get(S);T&&(e.remove(T),c.delete(S)),o.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,a.memory.geometries--}function f(x,S){return s[S.id]===!0||(S.addEventListener("dispose",d),s[S.id]=!0,a.memory.geometries++),S}function m(x){const S=x.attributes;for(const I in S)e.update(S[I],n.ARRAY_BUFFER);const T=x.morphAttributes;for(const I in T){const k=T[I];for(let D=0,L=k.length;D<L;D++)e.update(k[D],n.ARRAY_BUFFER)}}function y(x){const S=[],T=x.index,I=x.attributes.position;let k=0;if(T!==null){const O=T.array;k=T.version;for(let F=0,B=O.length;F<B;F+=3){const G=O[F+0],q=O[F+1],X=O[F+2];S.push(G,q,q,X,X,G)}}else if(I!==void 0){const O=I.array;k=I.version;for(let F=0,B=O.length/3-1;F<B;F+=3){const G=F+0,q=F+1,X=F+2;S.push(G,q,q,X,X,G)}}else return;const D=new(VY(S)?o6:r6)(S,1);D.version=k;const L=c.get(x);L&&e.remove(L),c.set(x,D)}function _(x){const S=c.get(x);if(S){const T=x.index;T!==null&&S.version<T.version&&y(x)}else y(x);return c.get(x)}return{get:f,update:m,getWireframeAttribute:_}}function yxe(n,e,a,o){const s=o.isWebGL2;let c;function d(S){c=S}let f,m;function y(S){f=S.type,m=S.bytesPerElement}function _(S,T){n.drawElements(c,T,f,S*m),a.update(T,c,1)}function x(S,T,I){if(I===0)return;let k,D;if(s)k=n,D="drawElementsInstanced";else if(k=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",k===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[D](c,T,f,S*m,I),a.update(T,c,I)}this.setMode=d,this.setIndex=y,this.render=_,this.renderInstances=x}function vxe(n){const e={geometries:0,textures:0},a={frame:0,calls:0,triangles:0,points:0,lines:0};function o(c,d,f){switch(a.calls++,d){case n.TRIANGLES:a.triangles+=f*(c/3);break;case n.LINES:a.lines+=f*(c/2);break;case n.LINE_STRIP:a.lines+=f*(c-1);break;case n.LINE_LOOP:a.lines+=f*c;break;case n.POINTS:a.points+=f*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function s(){a.calls=0,a.triangles=0,a.points=0,a.lines=0}return{memory:e,render:a,programs:null,autoReset:!0,reset:s,update:o}}function _xe(n,e){return n[0]-e[0]}function bxe(n,e){return Math.abs(e[1])-Math.abs(n[1])}function xxe(n,e,a){const o={},s=new Float32Array(8),c=new WeakMap,d=new Ei,f=[];for(let y=0;y<8;y++)f[y]=[y,0];function m(y,_,x){const S=y.morphTargetInfluences;if(e.isWebGL2===!0){const I=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,k=I!==void 0?I.length:0;let D=c.get(_);if(D===void 0||D.count!==k){let Ce=function(){be.dispose(),c.delete(_),_.removeEventListener("dispose",Ce)};var T=Ce;D!==void 0&&D.texture.dispose();const F=_.morphAttributes.position!==void 0,B=_.morphAttributes.normal!==void 0,G=_.morphAttributes.color!==void 0,q=_.morphAttributes.position||[],X=_.morphAttributes.normal||[],te=_.morphAttributes.color||[];let V=0;F===!0&&(V=1),B===!0&&(V=2),G===!0&&(V=3);let Q=_.attributes.position.count*V,ge=1;Q>e.maxTextureSize&&(ge=Math.ceil(Q/e.maxTextureSize),Q=e.maxTextureSize);const me=new Float32Array(Q*ge*4*k),be=new DT(me,Q,ge,k);be.type=sd,be.needsUpdate=!0;const fe=V*4;for(let Le=0;Le<k;Le++){const Ge=q[Le],le=X[Le],pe=te[Le],Ae=Q*ge*4*Le;for(let ae=0;ae<Ge.count;ae++){const Ee=ae*fe;F===!0&&(d.fromBufferAttribute(Ge,ae),me[Ae+Ee+0]=d.x,me[Ae+Ee+1]=d.y,me[Ae+Ee+2]=d.z,me[Ae+Ee+3]=0),B===!0&&(d.fromBufferAttribute(le,ae),me[Ae+Ee+4]=d.x,me[Ae+Ee+5]=d.y,me[Ae+Ee+6]=d.z,me[Ae+Ee+7]=0),G===!0&&(d.fromBufferAttribute(pe,ae),me[Ae+Ee+8]=d.x,me[Ae+Ee+9]=d.y,me[Ae+Ee+10]=d.z,me[Ae+Ee+11]=pe.itemSize===4?d.w:1)}}D={count:k,texture:be,size:new Kt(Q,ge)},c.set(_,D),_.addEventListener("dispose",Ce)}let L=0;for(let F=0;F<S.length;F++)L+=S[F];const O=_.morphTargetsRelative?1:1-L;x.getUniforms().setValue(n,"morphTargetBaseInfluence",O),x.getUniforms().setValue(n,"morphTargetInfluences",S),x.getUniforms().setValue(n,"morphTargetsTexture",D.texture,a),x.getUniforms().setValue(n,"morphTargetsTextureSize",D.size)}else{const I=S===void 0?0:S.length;let k=o[_.id];if(k===void 0||k.length!==I){k=[];for(let B=0;B<I;B++)k[B]=[B,0];o[_.id]=k}for(let B=0;B<I;B++){const G=k[B];G[0]=B,G[1]=S[B]}k.sort(bxe);for(let B=0;B<8;B++)B<I&&k[B][1]?(f[B][0]=k[B][0],f[B][1]=k[B][1]):(f[B][0]=Number.MAX_SAFE_INTEGER,f[B][1]=0);f.sort(_xe);const D=_.morphAttributes.position,L=_.morphAttributes.normal;let O=0;for(let B=0;B<8;B++){const G=f[B],q=G[0],X=G[1];q!==Number.MAX_SAFE_INTEGER&&X?(D&&_.getAttribute("morphTarget"+B)!==D[q]&&_.setAttribute("morphTarget"+B,D[q]),L&&_.getAttribute("morphNormal"+B)!==L[q]&&_.setAttribute("morphNormal"+B,L[q]),s[B]=X,O+=X):(D&&_.hasAttribute("morphTarget"+B)===!0&&_.deleteAttribute("morphTarget"+B),L&&_.hasAttribute("morphNormal"+B)===!0&&_.deleteAttribute("morphNormal"+B),s[B]=0)}const F=_.morphTargetsRelative?1:1-O;x.getUniforms().setValue(n,"morphTargetBaseInfluence",F),x.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:m}}function wxe(n,e,a,o){let s=new WeakMap;function c(m){const y=o.render.frame,_=m.geometry,x=e.get(m,_);if(s.get(x)!==y&&(e.update(x),s.set(x,y)),m.isInstancedMesh&&(m.hasEventListener("dispose",f)===!1&&m.addEventListener("dispose",f),s.get(m)!==y&&(a.update(m.instanceMatrix,n.ARRAY_BUFFER),m.instanceColor!==null&&a.update(m.instanceColor,n.ARRAY_BUFFER),s.set(m,y))),m.isSkinnedMesh){const S=m.skeleton;s.get(S)!==y&&(S.update(),s.set(S,y))}return x}function d(){s=new WeakMap}function f(m){const y=m.target;y.removeEventListener("dispose",f),a.remove(y.instanceMatrix),y.instanceColor!==null&&a.remove(y.instanceColor)}return{update:c,dispose:d}}const ZY=new kr,KY=new DT,JY=new i6,QY=new Ow,LW=[],RW=[],kW=new Float32Array(16),DW=new Float32Array(9),OW=new Float32Array(4);function y_(n,e,a){const o=n[0];if(o<=0||o>0)return n;const s=e*a;let c=LW[s];if(c===void 0&&(c=new Float32Array(s),LW[s]=c),e!==0){o.toArray(c,0);for(let d=1,f=0;d!==e;++d)f+=a,n[d].toArray(c,f)}return c}function ko(n,e){if(n.length!==e.length)return!1;for(let a=0,o=n.length;a<o;a++)if(n[a]!==e[a])return!1;return!0}function Do(n,e){for(let a=0,o=e.length;a<o;a++)n[a]=e[a]}function zT(n,e){let a=RW[e];a===void 0&&(a=new Int32Array(e),RW[e]=a);for(let o=0;o!==e;++o)a[o]=n.allocateTextureUnit();return a}function Sxe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1f(this.addr,e),a[0]=e)}function Axe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(ko(a,e))return;n.uniform2fv(this.addr,e),Do(a,e)}}function Exe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else if(e.r!==void 0)(a[0]!==e.r||a[1]!==e.g||a[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),a[0]=e.r,a[1]=e.g,a[2]=e.b);else{if(ko(a,e))return;n.uniform3fv(this.addr,e),Do(a,e)}}function Mxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(ko(a,e))return;n.uniform4fv(this.addr,e),Do(a,e)}}function Txe(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(ko(a,e))return;n.uniformMatrix2fv(this.addr,!1,e),Do(a,e)}else{if(ko(a,o))return;OW.set(o),n.uniformMatrix2fv(this.addr,!1,OW),Do(a,o)}}function Cxe(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(ko(a,e))return;n.uniformMatrix3fv(this.addr,!1,e),Do(a,e)}else{if(ko(a,o))return;DW.set(o),n.uniformMatrix3fv(this.addr,!1,DW),Do(a,o)}}function Pxe(n,e){const a=this.cache,o=e.elements;if(o===void 0){if(ko(a,e))return;n.uniformMatrix4fv(this.addr,!1,e),Do(a,e)}else{if(ko(a,o))return;kW.set(o),n.uniformMatrix4fv(this.addr,!1,kW),Do(a,o)}}function Ixe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1i(this.addr,e),a[0]=e)}function Lxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(ko(a,e))return;n.uniform2iv(this.addr,e),Do(a,e)}}function Rxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else{if(ko(a,e))return;n.uniform3iv(this.addr,e),Do(a,e)}}function kxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(ko(a,e))return;n.uniform4iv(this.addr,e),Do(a,e)}}function Dxe(n,e){const a=this.cache;a[0]!==e&&(n.uniform1ui(this.addr,e),a[0]=e)}function Oxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(ko(a,e))return;n.uniform2uiv(this.addr,e),Do(a,e)}}function zxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else{if(ko(a,e))return;n.uniform3uiv(this.addr,e),Do(a,e)}}function Fxe(n,e){const a=this.cache;if(e.x!==void 0)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(ko(a,e))return;n.uniform4uiv(this.addr,e),Do(a,e)}}function Nxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture2D(e||ZY,s)}function Bxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture3D(e||JY,s)}function Uxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTextureCube(e||QY,s)}function Wxe(n,e,a){const o=this.cache,s=a.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),a.setTexture2DArray(e||KY,s)}function Vxe(n){switch(n){case 5126:return Sxe;case 35664:return Axe;case 35665:return Exe;case 35666:return Mxe;case 35674:return Txe;case 35675:return Cxe;case 35676:return Pxe;case 5124:case 35670:return Ixe;case 35667:case 35671:return Lxe;case 35668:case 35672:return Rxe;case 35669:case 35673:return kxe;case 5125:return Dxe;case 36294:return Oxe;case 36295:return zxe;case 36296:return Fxe;case 35678:case 36198:case 36298:case 36306:case 35682:return Nxe;case 35679:case 36299:case 36307:return Bxe;case 35680:case 36300:case 36308:case 36293:return Uxe;case 36289:case 36303:case 36311:case 36292:return Wxe}}function Gxe(n,e){n.uniform1fv(this.addr,e)}function Hxe(n,e){const a=y_(e,this.size,2);n.uniform2fv(this.addr,a)}function jxe(n,e){const a=y_(e,this.size,3);n.uniform3fv(this.addr,a)}function $xe(n,e){const a=y_(e,this.size,4);n.uniform4fv(this.addr,a)}function qxe(n,e){const a=y_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,a)}function Xxe(n,e){const a=y_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,a)}function Yxe(n,e){const a=y_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,a)}function Zxe(n,e){n.uniform1iv(this.addr,e)}function Kxe(n,e){n.uniform2iv(this.addr,e)}function Jxe(n,e){n.uniform3iv(this.addr,e)}function Qxe(n,e){n.uniform4iv(this.addr,e)}function ewe(n,e){n.uniform1uiv(this.addr,e)}function twe(n,e){n.uniform2uiv(this.addr,e)}function nwe(n,e){n.uniform3uiv(this.addr,e)}function awe(n,e){n.uniform4uiv(this.addr,e)}function iwe(n,e,a){const o=this.cache,s=e.length,c=zT(a,s);ko(o,c)||(n.uniform1iv(this.addr,c),Do(o,c));for(let d=0;d!==s;++d)a.setTexture2D(e[d]||ZY,c[d])}function rwe(n,e,a){const o=this.cache,s=e.length,c=zT(a,s);ko(o,c)||(n.uniform1iv(this.addr,c),Do(o,c));for(let d=0;d!==s;++d)a.setTexture3D(e[d]||JY,c[d])}function owe(n,e,a){const o=this.cache,s=e.length,c=zT(a,s);ko(o,c)||(n.uniform1iv(this.addr,c),Do(o,c));for(let d=0;d!==s;++d)a.setTextureCube(e[d]||QY,c[d])}function swe(n,e,a){const o=this.cache,s=e.length,c=zT(a,s);ko(o,c)||(n.uniform1iv(this.addr,c),Do(o,c));for(let d=0;d!==s;++d)a.setTexture2DArray(e[d]||KY,c[d])}function lwe(n){switch(n){case 5126:return Gxe;case 35664:return Hxe;case 35665:return jxe;case 35666:return $xe;case 35674:return qxe;case 35675:return Xxe;case 35676:return Yxe;case 5124:case 35670:return Zxe;case 35667:case 35671:return Kxe;case 35668:case 35672:return Jxe;case 35669:case 35673:return Qxe;case 5125:return ewe;case 36294:return twe;case 36295:return nwe;case 36296:return awe;case 35678:case 36198:case 36298:case 36306:case 35682:return iwe;case 35679:case 36299:case 36307:return rwe;case 35680:case 36300:case 36308:case 36293:return owe;case 36289:case 36303:case 36311:case 36292:return swe}}class cwe{constructor(e,a,o){this.id=e,this.addr=o,this.cache=[],this.setValue=Vxe(a.type)}}class uwe{constructor(e,a,o){this.id=e,this.addr=o,this.cache=[],this.size=a.size,this.setValue=lwe(a.type)}}class dwe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,a,o){const s=this.seq;for(let c=0,d=s.length;c!==d;++c){const f=s[c];f.setValue(e,a[f.id],o)}}}const W4=/(\w+)(\])?(\[|\.)?/g;function zW(n,e){n.seq.push(e),n.map[e.id]=e}function hwe(n,e,a){const o=n.name,s=o.length;for(W4.lastIndex=0;;){const c=W4.exec(o),d=W4.lastIndex;let f=c[1];const m=c[2]==="]",y=c[3];if(m&&(f=f|0),y===void 0||y==="["&&d+2===s){zW(a,y===void 0?new cwe(f,n,e):new uwe(f,n,e));break}else{let x=a.map[f];x===void 0&&(x=new dwe(f),zW(a,x)),a=x}}}class eE{constructor(e,a){this.seq=[],this.map={};const o=e.getProgramParameter(a,e.ACTIVE_UNIFORMS);for(let s=0;s<o;++s){const c=e.getActiveUniform(a,s),d=e.getUniformLocation(a,c.name);hwe(c,d,this)}}setValue(e,a,o,s){const c=this.map[a];c!==void 0&&c.setValue(e,o,s)}setOptional(e,a,o){const s=a[o];s!==void 0&&this.setValue(e,o,s)}static upload(e,a,o,s){for(let c=0,d=a.length;c!==d;++c){const f=a[c],m=o[f.id];m.needsUpdate!==!1&&f.setValue(e,m.value,s)}}static seqWithValue(e,a){const o=[];for(let s=0,c=e.length;s!==c;++s){const d=e[s];d.id in a&&o.push(d)}return o}}function FW(n,e,a){const o=n.createShader(e);return n.shaderSource(o,a),n.compileShader(o),o}const fwe=37297;let pwe=0;function mwe(n,e){const a=n.split(`
`),o=[],s=Math.max(e-6,0),c=Math.min(e+6,a.length);for(let d=s;d<c;d++){const f=d+1;o.push(`${f===e?">":" "} ${f}: ${a[d]}`)}return o.join(`
`)}function gwe(n){const e=zi.getPrimaries(zi.workingColorSpace),a=zi.getPrimaries(n);let o;switch(e===a?o="":e===qx&&a===$x?o="LinearDisplayP3ToLinearSRGB":e===$x&&a===qx&&(o="LinearSRGBToLinearDisplayP3"),n){case vd:case Rw:return[o,"LinearTransferOETF"];case Io:case kT:return[o,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[o,"LinearTransferOETF"]}}function NW(n,e,a){const o=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(o&&s==="")return"";const c=/ERROR: 0:(\d+)/.exec(s);if(c){const d=parseInt(c[1]);return a.toUpperCase()+`

`+s+`

`+mwe(n.getShaderSource(e),d)}else return s}function ywe(n,e){const a=gwe(e);return`vec4 ${n}( vec4 value ) { return ${a[0]}( ${a[1]}( value ) ); }`}function vwe(n,e){let a;switch(e){case pY:a="Linear";break;case mY:a="Reinhard";break;case gY:a="OptimizedCineon";break;case jD:a="ACESFilmic";break;case yY:a="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),a="Linear"}return"vec3 "+n+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function _we(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ib).join(`
`)}function bwe(n){const e=[];for(const a in n){const o=n[a];o!==!1&&e.push("#define "+a+" "+o)}return e.join(`
`)}function xwe(n,e){const a={},o=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<o;s++){const c=n.getActiveAttrib(e,s),d=c.name;let f=1;c.type===n.FLOAT_MAT2&&(f=2),c.type===n.FLOAT_MAT3&&(f=3),c.type===n.FLOAT_MAT4&&(f=4),a[d]={type:c.type,location:n.getAttribLocation(e,d),locationSize:f}}return a}function Ib(n){return n!==""}function BW(n,e){const a=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,a).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function UW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const wwe=/^[ \t]*#include +<([\w\d./]+)>/gm;function CR(n){return n.replace(wwe,Awe)}const Swe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Awe(n,e){let a=Oa[e];if(a===void 0){const o=Swe.get(e);if(o!==void 0)a=Oa[o],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,o);else throw new Error("Can not resolve #include <"+e+">")}return CR(a)}const Ewe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function WW(n){return n.replace(Ewe,Mwe)}function Mwe(n,e,a,o){let s="";for(let c=parseInt(e);c<parseInt(a);c++)s+=o.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return s}function VW(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Twe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===PT?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Jb?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===tu&&(e="SHADOWMAP_TYPE_VSM"),e}function Cwe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Nh:case vp:e="ENVMAP_TYPE_CUBE";break;case g_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function Pwe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case vp:e="ENVMAP_MODE_REFRACTION";break}return e}function Iwe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Lw:e="ENVMAP_BLENDING_MULTIPLY";break;case hY:e="ENVMAP_BLENDING_MIX";break;case fY:e="ENVMAP_BLENDING_ADD";break}return e}function Lwe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const a=Math.log2(e)-2,o=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,a),7*16)),texelHeight:o,maxMip:a}}function Rwe(n,e,a,o){const s=n.getContext(),c=a.defines;let d=a.vertexShader,f=a.fragmentShader;const m=Twe(a),y=Cwe(a),_=Pwe(a),x=Iwe(a),S=Lwe(a),T=a.isWebGL2?"":_we(a),I=bwe(c),k=s.createProgram();let D,L,O=a.glslVersion?"#version "+a.glslVersion+`
`:"";a.isRawShaderMaterial?(D=["#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I].filter(Ib).join(`
`),D.length>0&&(D+=`
`),L=[T,"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I].filter(Ib).join(`
`),L.length>0&&(L+=`
`)):(D=[VW(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I,a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+_:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.displacementMap?"#define USE_DISPLACEMENTMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.mapUv?"#define MAP_UV "+a.mapUv:"",a.alphaMapUv?"#define ALPHAMAP_UV "+a.alphaMapUv:"",a.lightMapUv?"#define LIGHTMAP_UV "+a.lightMapUv:"",a.aoMapUv?"#define AOMAP_UV "+a.aoMapUv:"",a.emissiveMapUv?"#define EMISSIVEMAP_UV "+a.emissiveMapUv:"",a.bumpMapUv?"#define BUMPMAP_UV "+a.bumpMapUv:"",a.normalMapUv?"#define NORMALMAP_UV "+a.normalMapUv:"",a.displacementMapUv?"#define DISPLACEMENTMAP_UV "+a.displacementMapUv:"",a.metalnessMapUv?"#define METALNESSMAP_UV "+a.metalnessMapUv:"",a.roughnessMapUv?"#define ROUGHNESSMAP_UV "+a.roughnessMapUv:"",a.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+a.anisotropyMapUv:"",a.clearcoatMapUv?"#define CLEARCOATMAP_UV "+a.clearcoatMapUv:"",a.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+a.clearcoatNormalMapUv:"",a.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+a.clearcoatRoughnessMapUv:"",a.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+a.iridescenceMapUv:"",a.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+a.iridescenceThicknessMapUv:"",a.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+a.sheenColorMapUv:"",a.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+a.sheenRoughnessMapUv:"",a.specularMapUv?"#define SPECULARMAP_UV "+a.specularMapUv:"",a.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+a.specularColorMapUv:"",a.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+a.specularIntensityMapUv:"",a.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+a.transmissionMapUv:"",a.thicknessMapUv?"#define THICKNESSMAP_UV "+a.thicknessMapUv:"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&a.flatShading===!1?"#define USE_MORPHNORMALS":"",a.morphColors&&a.isWebGL2?"#define USE_MORPHCOLORS":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+a.morphTextureStride:"",a.morphTargetsCount>0&&a.isWebGL2?"#define MORPHTARGETS_COUNT "+a.morphTargetsCount:"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ib).join(`
`),L=[T,VW(a),"#define SHADER_TYPE "+a.shaderType,"#define SHADER_NAME "+a.shaderName,I,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+y:"",a.envMap?"#define "+_:"",a.envMap?"#define "+x:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",a.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.anisotropy?"#define USE_ANISOTROPY":"",a.anisotropyMap?"#define USE_ANISOTROPYMAP":"",a.clearcoat?"#define USE_CLEARCOAT":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.iridescence?"#define USE_IRIDESCENCE":"",a.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",a.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",a.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.alphaTest?"#define USE_ALPHATEST":"",a.alphaHash?"#define USE_ALPHAHASH":"",a.sheen?"#define USE_SHEEN":"",a.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",a.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",a.transmission?"#define USE_TRANSMISSION":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.thicknessMap?"#define USE_THICKNESSMAP":"",a.vertexTangents&&a.flatShading===!1?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor?"#define USE_COLOR":"",a.vertexAlphas?"#define USE_COLOR_ALPHA":"",a.vertexUv1s?"#define USE_UV1":"",a.vertexUv2s?"#define USE_UV2":"",a.vertexUv3s?"#define USE_UV3":"",a.pointsUvs?"#define USE_POINTS_UV":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+m:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.numLightProbes>0?"#define USE_LIGHT_PROBES":"",a.useLegacyLights?"#define LEGACY_LIGHTS":"",a.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==hd?"#define TONE_MAPPING":"",a.toneMapping!==hd?Oa.tonemapping_pars_fragment:"",a.toneMapping!==hd?vwe("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.opaque?"#define OPAQUE":"",Oa.colorspace_pars_fragment,ywe("linearToOutputTexel",a.outputColorSpace),a.useDepthPacking?"#define DEPTH_PACKING "+a.depthPacking:"",`
`].filter(Ib).join(`
`)),d=CR(d),d=BW(d,a),d=UW(d,a),f=CR(f),f=BW(f,a),f=UW(f,a),d=WW(d),f=WW(f),a.isWebGL2&&a.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,L=["precision mediump sampler2DArray;","#define varying in",a.glslVersion===ER?"":"layout(location = 0) out highp vec4 pc_fragColor;",a.glslVersion===ER?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+L);const F=O+D+d,B=O+L+f,G=FW(s,s.VERTEX_SHADER,F),q=FW(s,s.FRAGMENT_SHADER,B);s.attachShader(k,G),s.attachShader(k,q),a.index0AttributeName!==void 0?s.bindAttribLocation(k,0,a.index0AttributeName):a.morphTargets===!0&&s.bindAttribLocation(k,0,"position"),s.linkProgram(k);function X(ge){if(n.debug.checkShaderErrors){const me=s.getProgramInfoLog(k).trim(),be=s.getShaderInfoLog(G).trim(),fe=s.getShaderInfoLog(q).trim();let Ce=!0,Le=!0;if(s.getProgramParameter(k,s.LINK_STATUS)===!1)if(Ce=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,k,G,q);else{const Ge=NW(s,G,"vertex"),le=NW(s,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(k,s.VALIDATE_STATUS)+`

Program Info Log: `+me+`
`+Ge+`
`+le)}else me!==""?console.warn("THREE.WebGLProgram: Program Info Log:",me):(be===""||fe==="")&&(Le=!1);Le&&(ge.diagnostics={runnable:Ce,programLog:me,vertexShader:{log:be,prefix:D},fragmentShader:{log:fe,prefix:L}})}s.deleteShader(G),s.deleteShader(q),te=new eE(s,k),V=xwe(s,k)}let te;this.getUniforms=function(){return te===void 0&&X(this),te};let V;this.getAttributes=function(){return V===void 0&&X(this),V};let Q=a.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Q===!1&&(Q=s.getProgramParameter(k,fwe)),Q},this.destroy=function(){o.releaseStatesOfProgram(this),s.deleteProgram(k),this.program=void 0},this.type=a.shaderType,this.name=a.shaderName,this.id=pwe++,this.cacheKey=e,this.usedTimes=1,this.program=k,this.vertexShader=G,this.fragmentShader=q,this}let kwe=0;class Dwe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const a=e.vertexShader,o=e.fragmentShader,s=this._getShaderStage(a),c=this._getShaderStage(o),d=this._getShaderCacheForMaterial(e);return d.has(s)===!1&&(d.add(s),s.usedTimes++),d.has(c)===!1&&(d.add(c),c.usedTimes++),this}remove(e){const a=this.materialCache.get(e);for(const o of a)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const a=this.materialCache;let o=a.get(e);return o===void 0&&(o=new Set,a.set(e,o)),o}_getShaderStage(e){const a=this.shaderCache;let o=a.get(e);return o===void 0&&(o=new Owe(e),a.set(e,o)),o}}class Owe{constructor(e){this.id=kwe++,this.code=e,this.usedTimes=0}}function zwe(n,e,a,o,s,c,d){const f=new xg,m=new Dwe,y=[],_=s.isWebGL2,x=s.logarithmicDepthBuffer,S=s.vertexTextures;let T=s.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function k(V){return V===0?"uv":`uv${V}`}function D(V,Q,ge,me,be){const fe=me.fog,Ce=be.geometry,Le=V.isMeshStandardMaterial?me.environment:null,Ge=(V.isMeshStandardMaterial?a:e).get(V.envMap||Le),le=Ge&&Ge.mapping===g_?Ge.image.height:null,pe=I[V.type];V.precision!==null&&(T=s.getMaxPrecision(V.precision),T!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",T,"instead."));const Ae=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,ae=Ae!==void 0?Ae.length:0;let Ee=0;Ce.morphAttributes.position!==void 0&&(Ee=1),Ce.morphAttributes.normal!==void 0&&(Ee=2),Ce.morphAttributes.color!==void 0&&(Ee=3);let Ze,Xe,Ke,Ue;if(pe){const vt=ru[pe];Ze=vt.vertexShader,Xe=vt.fragmentShader}else Ze=V.vertexShader,Xe=V.fragmentShader,m.update(V),Ke=m.getVertexShaderID(V),Ue=m.getFragmentShaderID(V);const ft=n.getRenderTarget(),Rt=be.isInstancedMesh===!0,kt=!!V.map,Jt=!!V.matcap,It=!!Ge,Pe=!!V.aoMap,pt=!!V.lightMap,yt=!!V.bumpMap,At=!!V.normalMap,Be=!!V.displacementMap,ue=!!V.emissiveMap,se=!!V.metalnessMap,ve=!!V.roughnessMap,$e=V.anisotropy>0,De=V.clearcoat>0,st=V.iridescence>0,de=V.sheen>0,ne=V.transmission>0,Oe=$e&&!!V.anisotropyMap,mt=De&&!!V.clearcoatMap,ot=De&&!!V.clearcoatNormalMap,lt=De&&!!V.clearcoatRoughnessMap,Et=st&&!!V.iridescenceMap,Ut=st&&!!V.iridescenceThicknessMap,Vt=de&&!!V.sheenColorMap,$t=de&&!!V.sheenRoughnessMap,Nt=!!V.specularMap,St=!!V.specularColorMap,Zt=!!V.specularIntensityMap,He=ne&&!!V.transmissionMap,Lt=ne&&!!V.thicknessMap,qt=!!V.gradientMap,Ot=!!V.alphaMap,fn=V.alphaTest>0,_e=!!V.alphaHash,Ye=!!V.extensions,Se=!!Ce.attributes.uv1,Me=!!Ce.attributes.uv2,ze=!!Ce.attributes.uv3;let Qe=hd;return V.toneMapped&&(ft===null||ft.isXRRenderTarget===!0)&&(Qe=n.toneMapping),{isWebGL2:_,shaderID:pe,shaderType:V.type,shaderName:V.name,vertexShader:Ze,fragmentShader:Xe,defines:V.defines,customVertexShaderID:Ke,customFragmentShaderID:Ue,isRawShaderMaterial:V.isRawShaderMaterial===!0,glslVersion:V.glslVersion,precision:T,instancing:Rt,instancingColor:Rt&&be.instanceColor!==null,supportsVertexTextures:S,outputColorSpace:ft===null?n.outputColorSpace:ft.isXRRenderTarget===!0?ft.texture.colorSpace:vd,map:kt,matcap:Jt,envMap:It,envMapMode:It&&Ge.mapping,envMapCubeUVHeight:le,aoMap:Pe,lightMap:pt,bumpMap:yt,normalMap:At,displacementMap:S&&Be,emissiveMap:ue,normalMapObjectSpace:At&&V.normalMapType===RY,normalMapTangentSpace:At&&V.normalMapType===Mp,metalnessMap:se,roughnessMap:ve,anisotropy:$e,anisotropyMap:Oe,clearcoat:De,clearcoatMap:mt,clearcoatNormalMap:ot,clearcoatRoughnessMap:lt,iridescence:st,iridescenceMap:Et,iridescenceThicknessMap:Ut,sheen:de,sheenColorMap:Vt,sheenRoughnessMap:$t,specularMap:Nt,specularColorMap:St,specularIntensityMap:Zt,transmission:ne,transmissionMap:He,thicknessMap:Lt,gradientMap:qt,opaque:V.transparent===!1&&V.blending===_g,alphaMap:Ot,alphaTest:fn,alphaHash:_e,combine:V.combine,mapUv:kt&&k(V.map.channel),aoMapUv:Pe&&k(V.aoMap.channel),lightMapUv:pt&&k(V.lightMap.channel),bumpMapUv:yt&&k(V.bumpMap.channel),normalMapUv:At&&k(V.normalMap.channel),displacementMapUv:Be&&k(V.displacementMap.channel),emissiveMapUv:ue&&k(V.emissiveMap.channel),metalnessMapUv:se&&k(V.metalnessMap.channel),roughnessMapUv:ve&&k(V.roughnessMap.channel),anisotropyMapUv:Oe&&k(V.anisotropyMap.channel),clearcoatMapUv:mt&&k(V.clearcoatMap.channel),clearcoatNormalMapUv:ot&&k(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:lt&&k(V.clearcoatRoughnessMap.channel),iridescenceMapUv:Et&&k(V.iridescenceMap.channel),iridescenceThicknessMapUv:Ut&&k(V.iridescenceThicknessMap.channel),sheenColorMapUv:Vt&&k(V.sheenColorMap.channel),sheenRoughnessMapUv:$t&&k(V.sheenRoughnessMap.channel),specularMapUv:Nt&&k(V.specularMap.channel),specularColorMapUv:St&&k(V.specularColorMap.channel),specularIntensityMapUv:Zt&&k(V.specularIntensityMap.channel),transmissionMapUv:He&&k(V.transmissionMap.channel),thicknessMapUv:Lt&&k(V.thicknessMap.channel),alphaMapUv:Ot&&k(V.alphaMap.channel),vertexTangents:!!Ce.attributes.tangent&&(At||$e),vertexColors:V.vertexColors,vertexAlphas:V.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,vertexUv1s:Se,vertexUv2s:Me,vertexUv3s:ze,pointsUvs:be.isPoints===!0&&!!Ce.attributes.uv&&(kt||Ot),fog:!!fe,useFog:V.fog===!0,fogExp2:fe&&fe.isFogExp2,flatShading:V.flatShading===!0,sizeAttenuation:V.sizeAttenuation===!0,logarithmicDepthBuffer:x,skinning:be.isSkinnedMesh===!0,morphTargets:Ce.morphAttributes.position!==void 0,morphNormals:Ce.morphAttributes.normal!==void 0,morphColors:Ce.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:Ee,numDirLights:Q.directional.length,numPointLights:Q.point.length,numSpotLights:Q.spot.length,numSpotLightMaps:Q.spotLightMap.length,numRectAreaLights:Q.rectArea.length,numHemiLights:Q.hemi.length,numDirLightShadows:Q.directionalShadowMap.length,numPointLightShadows:Q.pointShadowMap.length,numSpotLightShadows:Q.spotShadowMap.length,numSpotLightShadowsWithMaps:Q.numSpotLightShadowsWithMaps,numLightProbes:Q.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:V.dithering,shadowMapEnabled:n.shadowMap.enabled&&ge.length>0,shadowMapType:n.shadowMap.type,toneMapping:Qe,useLegacyLights:n._useLegacyLights,decodeVideoTexture:kt&&V.map.isVideoTexture===!0&&zi.getTransfer(V.map.colorSpace)===Qi,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===Hl,flipSided:V.side===Ss,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionDerivatives:Ye&&V.extensions.derivatives===!0,extensionFragDepth:Ye&&V.extensions.fragDepth===!0,extensionDrawBuffers:Ye&&V.extensions.drawBuffers===!0,extensionShaderTextureLOD:Ye&&V.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:_||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||o.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:o.has("KHR_parallel_shader_compile"),customProgramCacheKey:V.customProgramCacheKey()}}function L(V){const Q=[];if(V.shaderID?Q.push(V.shaderID):(Q.push(V.customVertexShaderID),Q.push(V.customFragmentShaderID)),V.defines!==void 0)for(const ge in V.defines)Q.push(ge),Q.push(V.defines[ge]);return V.isRawShaderMaterial===!1&&(O(Q,V),F(Q,V),Q.push(n.outputColorSpace)),Q.push(V.customProgramCacheKey),Q.join()}function O(V,Q){V.push(Q.precision),V.push(Q.outputColorSpace),V.push(Q.envMapMode),V.push(Q.envMapCubeUVHeight),V.push(Q.mapUv),V.push(Q.alphaMapUv),V.push(Q.lightMapUv),V.push(Q.aoMapUv),V.push(Q.bumpMapUv),V.push(Q.normalMapUv),V.push(Q.displacementMapUv),V.push(Q.emissiveMapUv),V.push(Q.metalnessMapUv),V.push(Q.roughnessMapUv),V.push(Q.anisotropyMapUv),V.push(Q.clearcoatMapUv),V.push(Q.clearcoatNormalMapUv),V.push(Q.clearcoatRoughnessMapUv),V.push(Q.iridescenceMapUv),V.push(Q.iridescenceThicknessMapUv),V.push(Q.sheenColorMapUv),V.push(Q.sheenRoughnessMapUv),V.push(Q.specularMapUv),V.push(Q.specularColorMapUv),V.push(Q.specularIntensityMapUv),V.push(Q.transmissionMapUv),V.push(Q.thicknessMapUv),V.push(Q.combine),V.push(Q.fogExp2),V.push(Q.sizeAttenuation),V.push(Q.morphTargetsCount),V.push(Q.morphAttributeCount),V.push(Q.numDirLights),V.push(Q.numPointLights),V.push(Q.numSpotLights),V.push(Q.numSpotLightMaps),V.push(Q.numHemiLights),V.push(Q.numRectAreaLights),V.push(Q.numDirLightShadows),V.push(Q.numPointLightShadows),V.push(Q.numSpotLightShadows),V.push(Q.numSpotLightShadowsWithMaps),V.push(Q.numLightProbes),V.push(Q.shadowMapType),V.push(Q.toneMapping),V.push(Q.numClippingPlanes),V.push(Q.numClipIntersection),V.push(Q.depthPacking)}function F(V,Q){f.disableAll(),Q.isWebGL2&&f.enable(0),Q.supportsVertexTextures&&f.enable(1),Q.instancing&&f.enable(2),Q.instancingColor&&f.enable(3),Q.matcap&&f.enable(4),Q.envMap&&f.enable(5),Q.normalMapObjectSpace&&f.enable(6),Q.normalMapTangentSpace&&f.enable(7),Q.clearcoat&&f.enable(8),Q.iridescence&&f.enable(9),Q.alphaTest&&f.enable(10),Q.vertexColors&&f.enable(11),Q.vertexAlphas&&f.enable(12),Q.vertexUv1s&&f.enable(13),Q.vertexUv2s&&f.enable(14),Q.vertexUv3s&&f.enable(15),Q.vertexTangents&&f.enable(16),Q.anisotropy&&f.enable(17),Q.alphaHash&&f.enable(18),V.push(f.mask),f.disableAll(),Q.fog&&f.enable(0),Q.useFog&&f.enable(1),Q.flatShading&&f.enable(2),Q.logarithmicDepthBuffer&&f.enable(3),Q.skinning&&f.enable(4),Q.morphTargets&&f.enable(5),Q.morphNormals&&f.enable(6),Q.morphColors&&f.enable(7),Q.premultipliedAlpha&&f.enable(8),Q.shadowMapEnabled&&f.enable(9),Q.useLegacyLights&&f.enable(10),Q.doubleSided&&f.enable(11),Q.flipSided&&f.enable(12),Q.useDepthPacking&&f.enable(13),Q.dithering&&f.enable(14),Q.transmission&&f.enable(15),Q.sheen&&f.enable(16),Q.opaque&&f.enable(17),Q.pointsUvs&&f.enable(18),Q.decodeVideoTexture&&f.enable(19),V.push(f.mask)}function B(V){const Q=I[V.type];let ge;if(Q){const me=ru[Q];ge=s6.clone(me.uniforms)}else ge=V.uniforms;return ge}function G(V,Q){let ge;for(let me=0,be=y.length;me<be;me++){const fe=y[me];if(fe.cacheKey===Q){ge=fe,++ge.usedTimes;break}}return ge===void 0&&(ge=new Rwe(n,Q,V,c),y.push(ge)),ge}function q(V){if(--V.usedTimes===0){const Q=y.indexOf(V);y[Q]=y[y.length-1],y.pop(),V.destroy()}}function X(V){m.remove(V)}function te(){m.dispose()}return{getParameters:D,getProgramCacheKey:L,getUniforms:B,acquireProgram:G,releaseProgram:q,releaseShaderCache:X,programs:y,dispose:te}}function Fwe(){let n=new WeakMap;function e(c){let d=n.get(c);return d===void 0&&(d={},n.set(c,d)),d}function a(c){n.delete(c)}function o(c,d,f){n.get(c)[d]=f}function s(){n=new WeakMap}return{get:e,remove:a,update:o,dispose:s}}function Nwe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function GW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function HW(){const n=[];let e=0;const a=[],o=[],s=[];function c(){e=0,a.length=0,o.length=0,s.length=0}function d(x,S,T,I,k,D){let L=n[e];return L===void 0?(L={id:x.id,object:x,geometry:S,material:T,groupOrder:I,renderOrder:x.renderOrder,z:k,group:D},n[e]=L):(L.id=x.id,L.object=x,L.geometry=S,L.material=T,L.groupOrder=I,L.renderOrder=x.renderOrder,L.z=k,L.group=D),e++,L}function f(x,S,T,I,k,D){const L=d(x,S,T,I,k,D);T.transmission>0?o.push(L):T.transparent===!0?s.push(L):a.push(L)}function m(x,S,T,I,k,D){const L=d(x,S,T,I,k,D);T.transmission>0?o.unshift(L):T.transparent===!0?s.unshift(L):a.unshift(L)}function y(x,S){a.length>1&&a.sort(x||Nwe),o.length>1&&o.sort(S||GW),s.length>1&&s.sort(S||GW)}function _(){for(let x=e,S=n.length;x<S;x++){const T=n[x];if(T.id===null)break;T.id=null,T.object=null,T.geometry=null,T.material=null,T.group=null}}return{opaque:a,transmissive:o,transparent:s,init:c,push:f,unshift:m,finish:_,sort:y}}function Bwe(){let n=new WeakMap;function e(o,s){const c=n.get(o);let d;return c===void 0?(d=new HW,n.set(o,[d])):s>=c.length?(d=new HW,c.push(d)):d=c[s],d}function a(){n=new WeakMap}return{get:e,dispose:a}}function Uwe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let a;switch(e.type){case"DirectionalLight":a={direction:new Fe,color:new Pn};break;case"SpotLight":a={position:new Fe,direction:new Fe,color:new Pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":a={position:new Fe,color:new Pn,distance:0,decay:0};break;case"HemisphereLight":a={direction:new Fe,skyColor:new Pn,groundColor:new Pn};break;case"RectAreaLight":a={color:new Pn,position:new Fe,halfWidth:new Fe,halfHeight:new Fe};break}return n[e.id]=a,a}}}function Wwe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let a;switch(e.type){case"DirectionalLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt};break;case"SpotLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt};break;case"PointLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Kt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=a,a}}}let Vwe=0;function Gwe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Hwe(n,e){const a=new Uwe,o=Wwe(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let _=0;_<9;_++)s.probe.push(new Fe);const c=new Fe,d=new Ia,f=new Ia;function m(_,x){let S=0,T=0,I=0;for(let me=0;me<9;me++)s.probe[me].set(0,0,0);let k=0,D=0,L=0,O=0,F=0,B=0,G=0,q=0,X=0,te=0,V=0;_.sort(Gwe);const Q=x===!0?Math.PI:1;for(let me=0,be=_.length;me<be;me++){const fe=_[me],Ce=fe.color,Le=fe.intensity,Ge=fe.distance,le=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)S+=Ce.r*Le*Q,T+=Ce.g*Le*Q,I+=Ce.b*Le*Q;else if(fe.isLightProbe){for(let pe=0;pe<9;pe++)s.probe[pe].addScaledVector(fe.sh.coefficients[pe],Le);V++}else if(fe.isDirectionalLight){const pe=a.get(fe);if(pe.color.copy(fe.color).multiplyScalar(fe.intensity*Q),fe.castShadow){const Ae=fe.shadow,ae=o.get(fe);ae.shadowBias=Ae.bias,ae.shadowNormalBias=Ae.normalBias,ae.shadowRadius=Ae.radius,ae.shadowMapSize=Ae.mapSize,s.directionalShadow[k]=ae,s.directionalShadowMap[k]=le,s.directionalShadowMatrix[k]=fe.shadow.matrix,B++}s.directional[k]=pe,k++}else if(fe.isSpotLight){const pe=a.get(fe);pe.position.setFromMatrixPosition(fe.matrixWorld),pe.color.copy(Ce).multiplyScalar(Le*Q),pe.distance=Ge,pe.coneCos=Math.cos(fe.angle),pe.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),pe.decay=fe.decay,s.spot[L]=pe;const Ae=fe.shadow;if(fe.map&&(s.spotLightMap[X]=fe.map,X++,Ae.updateMatrices(fe),fe.castShadow&&te++),s.spotLightMatrix[L]=Ae.matrix,fe.castShadow){const ae=o.get(fe);ae.shadowBias=Ae.bias,ae.shadowNormalBias=Ae.normalBias,ae.shadowRadius=Ae.radius,ae.shadowMapSize=Ae.mapSize,s.spotShadow[L]=ae,s.spotShadowMap[L]=le,q++}L++}else if(fe.isRectAreaLight){const pe=a.get(fe);pe.color.copy(Ce).multiplyScalar(Le),pe.halfWidth.set(fe.width*.5,0,0),pe.halfHeight.set(0,fe.height*.5,0),s.rectArea[O]=pe,O++}else if(fe.isPointLight){const pe=a.get(fe);if(pe.color.copy(fe.color).multiplyScalar(fe.intensity*Q),pe.distance=fe.distance,pe.decay=fe.decay,fe.castShadow){const Ae=fe.shadow,ae=o.get(fe);ae.shadowBias=Ae.bias,ae.shadowNormalBias=Ae.normalBias,ae.shadowRadius=Ae.radius,ae.shadowMapSize=Ae.mapSize,ae.shadowCameraNear=Ae.camera.near,ae.shadowCameraFar=Ae.camera.far,s.pointShadow[D]=ae,s.pointShadowMap[D]=le,s.pointShadowMatrix[D]=fe.shadow.matrix,G++}s.point[D]=pe,D++}else if(fe.isHemisphereLight){const pe=a.get(fe);pe.skyColor.copy(fe.color).multiplyScalar(Le*Q),pe.groundColor.copy(fe.groundColor).multiplyScalar(Le*Q),s.hemi[F]=pe,F++}}O>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=bn.LTC_FLOAT_1,s.rectAreaLTC2=bn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=bn.LTC_HALF_1,s.rectAreaLTC2=bn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=S,s.ambient[1]=T,s.ambient[2]=I;const ge=s.hash;(ge.directionalLength!==k||ge.pointLength!==D||ge.spotLength!==L||ge.rectAreaLength!==O||ge.hemiLength!==F||ge.numDirectionalShadows!==B||ge.numPointShadows!==G||ge.numSpotShadows!==q||ge.numSpotMaps!==X||ge.numLightProbes!==V)&&(s.directional.length=k,s.spot.length=L,s.rectArea.length=O,s.point.length=D,s.hemi.length=F,s.directionalShadow.length=B,s.directionalShadowMap.length=B,s.pointShadow.length=G,s.pointShadowMap.length=G,s.spotShadow.length=q,s.spotShadowMap.length=q,s.directionalShadowMatrix.length=B,s.pointShadowMatrix.length=G,s.spotLightMatrix.length=q+X-te,s.spotLightMap.length=X,s.numSpotLightShadowsWithMaps=te,s.numLightProbes=V,ge.directionalLength=k,ge.pointLength=D,ge.spotLength=L,ge.rectAreaLength=O,ge.hemiLength=F,ge.numDirectionalShadows=B,ge.numPointShadows=G,ge.numSpotShadows=q,ge.numSpotMaps=X,ge.numLightProbes=V,s.version=Vwe++)}function y(_,x){let S=0,T=0,I=0,k=0,D=0;const L=x.matrixWorldInverse;for(let O=0,F=_.length;O<F;O++){const B=_[O];if(B.isDirectionalLight){const G=s.directional[S];G.direction.setFromMatrixPosition(B.matrixWorld),c.setFromMatrixPosition(B.target.matrixWorld),G.direction.sub(c),G.direction.transformDirection(L),S++}else if(B.isSpotLight){const G=s.spot[I];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),G.direction.setFromMatrixPosition(B.matrixWorld),c.setFromMatrixPosition(B.target.matrixWorld),G.direction.sub(c),G.direction.transformDirection(L),I++}else if(B.isRectAreaLight){const G=s.rectArea[k];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),f.identity(),d.copy(B.matrixWorld),d.premultiply(L),f.extractRotation(d),G.halfWidth.set(B.width*.5,0,0),G.halfHeight.set(0,B.height*.5,0),G.halfWidth.applyMatrix4(f),G.halfHeight.applyMatrix4(f),k++}else if(B.isPointLight){const G=s.point[T];G.position.setFromMatrixPosition(B.matrixWorld),G.position.applyMatrix4(L),T++}else if(B.isHemisphereLight){const G=s.hemi[D];G.direction.setFromMatrixPosition(B.matrixWorld),G.direction.transformDirection(L),D++}}}return{setup:m,setupView:y,state:s}}function jW(n,e){const a=new Hwe(n,e),o=[],s=[];function c(){o.length=0,s.length=0}function d(x){o.push(x)}function f(x){s.push(x)}function m(x){a.setup(o,x)}function y(x){a.setupView(o,x)}return{init:c,state:{lightsArray:o,shadowsArray:s,lights:a},setupLights:m,setupLightsView:y,pushLight:d,pushShadow:f}}function jwe(n,e){let a=new WeakMap;function o(c,d=0){const f=a.get(c);let m;return f===void 0?(m=new jW(n,e),a.set(c,[m])):d>=f.length?(m=new jW(n,e),f.push(m)):m=f[d],m}function s(){a=new WeakMap}return{get:o,dispose:s}}class FT extends as{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=LY,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class NT extends as{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const $we=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,qwe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Xwe(n,e,a){let o=new OT;const s=new Kt,c=new Kt,d=new Ei,f=new FT({depthPacking:t6}),m=new NT,y={},_=a.maxTextureSize,x={[yd]:Ss,[Ss]:yd,[Hl]:Hl},S=new _d({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Kt},radius:{value:4}},vertexShader:$we,fragmentShader:qwe}),T=S.clone();T.defines.HORIZONTAL_PASS=1;const I=new La;I.setAttribute("position",new Xi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const k=new So(I,S),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PT;let L=this.type;this.render=function(G,q,X){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||G.length===0)return;const te=n.getRenderTarget(),V=n.getActiveCubeFace(),Q=n.getActiveMipmapLevel(),ge=n.state;ge.setBlending(Ih),ge.buffers.color.setClear(1,1,1,1),ge.buffers.depth.setTest(!0),ge.setScissorTest(!1);const me=L!==tu&&this.type===tu,be=L===tu&&this.type!==tu;for(let fe=0,Ce=G.length;fe<Ce;fe++){const Le=G[fe],Ge=Le.shadow;if(Ge===void 0){console.warn("THREE.WebGLShadowMap:",Le,"has no shadow.");continue}if(Ge.autoUpdate===!1&&Ge.needsUpdate===!1)continue;s.copy(Ge.mapSize);const le=Ge.getFrameExtents();if(s.multiply(le),c.copy(Ge.mapSize),(s.x>_||s.y>_)&&(s.x>_&&(c.x=Math.floor(_/le.x),s.x=c.x*le.x,Ge.mapSize.x=c.x),s.y>_&&(c.y=Math.floor(_/le.y),s.y=c.y*le.y,Ge.mapSize.y=c.y)),Ge.map===null||me===!0||be===!0){const Ae=this.type!==tu?{minFilter:lo,magFilter:lo}:{};Ge.map!==null&&Ge.map.dispose(),Ge.map=new pu(s.x,s.y,Ae),Ge.map.texture.name=Le.name+".shadowMap",Ge.camera.updateProjectionMatrix()}n.setRenderTarget(Ge.map),n.clear();const pe=Ge.getViewportCount();for(let Ae=0;Ae<pe;Ae++){const ae=Ge.getViewport(Ae);d.set(c.x*ae.x,c.y*ae.y,c.x*ae.z,c.y*ae.w),ge.viewport(d),Ge.updateMatrices(Le,Ae),o=Ge.getFrustum(),B(q,X,Ge.camera,Le,this.type)}Ge.isPointLightShadow!==!0&&this.type===tu&&O(Ge,X),Ge.needsUpdate=!1}L=this.type,D.needsUpdate=!1,n.setRenderTarget(te,V,Q)};function O(G,q){const X=e.update(k);S.defines.VSM_SAMPLES!==G.blurSamples&&(S.defines.VSM_SAMPLES=G.blurSamples,T.defines.VSM_SAMPLES=G.blurSamples,S.needsUpdate=!0,T.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new pu(s.x,s.y)),S.uniforms.shadow_pass.value=G.map.texture,S.uniforms.resolution.value=G.mapSize,S.uniforms.radius.value=G.radius,n.setRenderTarget(G.mapPass),n.clear(),n.renderBufferDirect(q,null,X,S,k,null),T.uniforms.shadow_pass.value=G.mapPass.texture,T.uniforms.resolution.value=G.mapSize,T.uniforms.radius.value=G.radius,n.setRenderTarget(G.map),n.clear(),n.renderBufferDirect(q,null,X,T,k,null)}function F(G,q,X,te){let V=null;const Q=X.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(Q!==void 0)V=Q;else if(V=X.isPointLight===!0?m:f,n.localClippingEnabled&&q.clipShadows===!0&&Array.isArray(q.clippingPlanes)&&q.clippingPlanes.length!==0||q.displacementMap&&q.displacementScale!==0||q.alphaMap&&q.alphaTest>0||q.map&&q.alphaTest>0){const ge=V.uuid,me=q.uuid;let be=y[ge];be===void 0&&(be={},y[ge]=be);let fe=be[me];fe===void 0&&(fe=V.clone(),be[me]=fe),V=fe}if(V.visible=q.visible,V.wireframe=q.wireframe,te===tu?V.side=q.shadowSide!==null?q.shadowSide:q.side:V.side=q.shadowSide!==null?q.shadowSide:x[q.side],V.alphaMap=q.alphaMap,V.alphaTest=q.alphaTest,V.map=q.map,V.clipShadows=q.clipShadows,V.clippingPlanes=q.clippingPlanes,V.clipIntersection=q.clipIntersection,V.displacementMap=q.displacementMap,V.displacementScale=q.displacementScale,V.displacementBias=q.displacementBias,V.wireframeLinewidth=q.wireframeLinewidth,V.linewidth=q.linewidth,X.isPointLight===!0&&V.isMeshDistanceMaterial===!0){const ge=n.properties.get(V);ge.light=X}return V}function B(G,q,X,te,V){if(G.visible===!1)return;if(G.layers.test(q.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&V===tu)&&(!G.frustumCulled||o.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(X.matrixWorldInverse,G.matrixWorld);const me=e.update(G),be=G.material;if(Array.isArray(be)){const fe=me.groups;for(let Ce=0,Le=fe.length;Ce<Le;Ce++){const Ge=fe[Ce],le=be[Ge.materialIndex];if(le&&le.visible){const pe=F(G,le,te,V);n.renderBufferDirect(X,null,me,pe,G,Ge)}}}else if(be.visible){const fe=F(G,be,te,V);n.renderBufferDirect(X,null,me,fe,G,null)}}const ge=G.children;for(let me=0,be=ge.length;me<be;me++)B(ge[me],q,X,te,V)}}function Ywe(n,e,a){const o=a.isWebGL2;function s(){let _e=!1;const Ye=new Ei;let Se=null;const Me=new Ei(0,0,0,0);return{setMask:function(ze){Se!==ze&&!_e&&(n.colorMask(ze,ze,ze,ze),Se=ze)},setLocked:function(ze){_e=ze},setClear:function(ze,Qe,tt,vt,dt){dt===!0&&(ze*=vt,Qe*=vt,tt*=vt),Ye.set(ze,Qe,tt,vt),Me.equals(Ye)===!1&&(n.clearColor(ze,Qe,tt,vt),Me.copy(Ye))},reset:function(){_e=!1,Se=null,Me.set(-1,0,0,0)}}}function c(){let _e=!1,Ye=null,Se=null,Me=null;return{setTest:function(ze){ze?kt(n.DEPTH_TEST):Jt(n.DEPTH_TEST)},setMask:function(ze){Ye!==ze&&!_e&&(n.depthMask(ze),Ye=ze)},setFunc:function(ze){if(Se!==ze){switch(ze){case rY:n.depthFunc(n.NEVER);break;case oY:n.depthFunc(n.ALWAYS);break;case sY:n.depthFunc(n.LESS);break;case Fx:n.depthFunc(n.LEQUAL);break;case lY:n.depthFunc(n.EQUAL);break;case cY:n.depthFunc(n.GEQUAL);break;case uY:n.depthFunc(n.GREATER);break;case dY:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Se=ze}},setLocked:function(ze){_e=ze},setClear:function(ze){Me!==ze&&(n.clearDepth(ze),Me=ze)},reset:function(){_e=!1,Ye=null,Se=null,Me=null}}}function d(){let _e=!1,Ye=null,Se=null,Me=null,ze=null,Qe=null,tt=null,vt=null,dt=null;return{setTest:function(ut){_e||(ut?kt(n.STENCIL_TEST):Jt(n.STENCIL_TEST))},setMask:function(ut){Ye!==ut&&!_e&&(n.stencilMask(ut),Ye=ut)},setFunc:function(ut,Gt,Tt){(Se!==ut||Me!==Gt||ze!==Tt)&&(n.stencilFunc(ut,Gt,Tt),Se=ut,Me=Gt,ze=Tt)},setOp:function(ut,Gt,Tt){(Qe!==ut||tt!==Gt||vt!==Tt)&&(n.stencilOp(ut,Gt,Tt),Qe=ut,tt=Gt,vt=Tt)},setLocked:function(ut){_e=ut},setClear:function(ut){dt!==ut&&(n.clearStencil(ut),dt=ut)},reset:function(){_e=!1,Ye=null,Se=null,Me=null,ze=null,Qe=null,tt=null,vt=null,dt=null}}}const f=new s,m=new c,y=new d,_=new WeakMap,x=new WeakMap;let S={},T={},I=new WeakMap,k=[],D=null,L=!1,O=null,F=null,B=null,G=null,q=null,X=null,te=null,V=new Pn(0,0,0),Q=0,ge=!1,me=null,be=null,fe=null,Ce=null,Le=null;const Ge=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let le=!1,pe=0;const Ae=n.getParameter(n.VERSION);Ae.indexOf("WebGL")!==-1?(pe=parseFloat(/^WebGL (\d)/.exec(Ae)[1]),le=pe>=1):Ae.indexOf("OpenGL ES")!==-1&&(pe=parseFloat(/^OpenGL ES (\d)/.exec(Ae)[1]),le=pe>=2);let ae=null,Ee={};const Ze=n.getParameter(n.SCISSOR_BOX),Xe=n.getParameter(n.VIEWPORT),Ke=new Ei().fromArray(Ze),Ue=new Ei().fromArray(Xe);function ft(_e,Ye,Se,Me){const ze=new Uint8Array(4),Qe=n.createTexture();n.bindTexture(_e,Qe),n.texParameteri(_e,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(_e,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let tt=0;tt<Se;tt++)o&&(_e===n.TEXTURE_3D||_e===n.TEXTURE_2D_ARRAY)?n.texImage3D(Ye,0,n.RGBA,1,1,Me,0,n.RGBA,n.UNSIGNED_BYTE,ze):n.texImage2D(Ye+tt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ze);return Qe}const Rt={};Rt[n.TEXTURE_2D]=ft(n.TEXTURE_2D,n.TEXTURE_2D,1),Rt[n.TEXTURE_CUBE_MAP]=ft(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),o&&(Rt[n.TEXTURE_2D_ARRAY]=ft(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Rt[n.TEXTURE_3D]=ft(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),f.setClear(0,0,0,1),m.setClear(1),y.setClear(0),kt(n.DEPTH_TEST),m.setFunc(Fx),se(!1),ve($L),kt(n.CULL_FACE),Be(Ih);function kt(_e){S[_e]!==!0&&(n.enable(_e),S[_e]=!0)}function Jt(_e){S[_e]!==!1&&(n.disable(_e),S[_e]=!1)}function It(_e,Ye){return T[_e]!==Ye?(n.bindFramebuffer(_e,Ye),T[_e]=Ye,o&&(_e===n.DRAW_FRAMEBUFFER&&(T[n.FRAMEBUFFER]=Ye),_e===n.FRAMEBUFFER&&(T[n.DRAW_FRAMEBUFFER]=Ye)),!0):!1}function Pe(_e,Ye){let Se=k,Me=!1;if(_e)if(Se=I.get(Ye),Se===void 0&&(Se=[],I.set(Ye,Se)),_e.isWebGLMultipleRenderTargets){const ze=_e.texture;if(Se.length!==ze.length||Se[0]!==n.COLOR_ATTACHMENT0){for(let Qe=0,tt=ze.length;Qe<tt;Qe++)Se[Qe]=n.COLOR_ATTACHMENT0+Qe;Se.length=ze.length,Me=!0}}else Se[0]!==n.COLOR_ATTACHMENT0&&(Se[0]=n.COLOR_ATTACHMENT0,Me=!0);else Se[0]!==n.BACK&&(Se[0]=n.BACK,Me=!0);Me&&(a.isWebGL2?n.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function pt(_e){return D!==_e?(n.useProgram(_e),D=_e,!0):!1}const yt={[$f]:n.FUNC_ADD,[HX]:n.FUNC_SUBTRACT,[jX]:n.FUNC_REVERSE_SUBTRACT};if(o)yt[ZL]=n.MIN,yt[KL]=n.MAX;else{const _e=e.get("EXT_blend_minmax");_e!==null&&(yt[ZL]=_e.MIN_EXT,yt[KL]=_e.MAX_EXT)}const At={[$X]:n.ZERO,[qX]:n.ONE,[XX]:n.SRC_COLOR,[YE]:n.SRC_ALPHA,[eY]:n.SRC_ALPHA_SATURATE,[JX]:n.DST_COLOR,[ZX]:n.DST_ALPHA,[YX]:n.ONE_MINUS_SRC_COLOR,[ZE]:n.ONE_MINUS_SRC_ALPHA,[QX]:n.ONE_MINUS_DST_COLOR,[KX]:n.ONE_MINUS_DST_ALPHA,[tY]:n.CONSTANT_COLOR,[nY]:n.ONE_MINUS_CONSTANT_COLOR,[aY]:n.CONSTANT_ALPHA,[iY]:n.ONE_MINUS_CONSTANT_ALPHA};function Be(_e,Ye,Se,Me,ze,Qe,tt,vt,dt,ut){if(_e===Ih){L===!0&&(Jt(n.BLEND),L=!1);return}if(L===!1&&(kt(n.BLEND),L=!0),_e!==GX){if(_e!==O||ut!==ge){if((F!==$f||q!==$f)&&(n.blendEquation(n.FUNC_ADD),F=$f,q=$f),ut)switch(_e){case _g:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case qL:n.blendFunc(n.ONE,n.ONE);break;case XL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case YL:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}else switch(_e){case _g:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case qL:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case XL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case YL:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e);break}B=null,G=null,X=null,te=null,V.set(0,0,0),Q=0,O=_e,ge=ut}return}ze=ze||Ye,Qe=Qe||Se,tt=tt||Me,(Ye!==F||ze!==q)&&(n.blendEquationSeparate(yt[Ye],yt[ze]),F=Ye,q=ze),(Se!==B||Me!==G||Qe!==X||tt!==te)&&(n.blendFuncSeparate(At[Se],At[Me],At[Qe],At[tt]),B=Se,G=Me,X=Qe,te=tt),(vt.equals(V)===!1||dt!==Q)&&(n.blendColor(vt.r,vt.g,vt.b,dt),V.copy(vt),Q=dt),O=_e,ge=!1}function ue(_e,Ye){_e.side===Hl?Jt(n.CULL_FACE):kt(n.CULL_FACE);let Se=_e.side===Ss;Ye&&(Se=!Se),se(Se),_e.blending===_g&&_e.transparent===!1?Be(Ih):Be(_e.blending,_e.blendEquation,_e.blendSrc,_e.blendDst,_e.blendEquationAlpha,_e.blendSrcAlpha,_e.blendDstAlpha,_e.blendColor,_e.blendAlpha,_e.premultipliedAlpha),m.setFunc(_e.depthFunc),m.setTest(_e.depthTest),m.setMask(_e.depthWrite),f.setMask(_e.colorWrite);const Me=_e.stencilWrite;y.setTest(Me),Me&&(y.setMask(_e.stencilWriteMask),y.setFunc(_e.stencilFunc,_e.stencilRef,_e.stencilFuncMask),y.setOp(_e.stencilFail,_e.stencilZFail,_e.stencilZPass)),De(_e.polygonOffset,_e.polygonOffsetFactor,_e.polygonOffsetUnits),_e.alphaToCoverage===!0?kt(n.SAMPLE_ALPHA_TO_COVERAGE):Jt(n.SAMPLE_ALPHA_TO_COVERAGE)}function se(_e){me!==_e&&(_e?n.frontFace(n.CW):n.frontFace(n.CCW),me=_e)}function ve(_e){_e!==UX?(kt(n.CULL_FACE),_e!==be&&(_e===$L?n.cullFace(n.BACK):_e===WX?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Jt(n.CULL_FACE),be=_e}function $e(_e){_e!==fe&&(le&&n.lineWidth(_e),fe=_e)}function De(_e,Ye,Se){_e?(kt(n.POLYGON_OFFSET_FILL),(Ce!==Ye||Le!==Se)&&(n.polygonOffset(Ye,Se),Ce=Ye,Le=Se)):Jt(n.POLYGON_OFFSET_FILL)}function st(_e){_e?kt(n.SCISSOR_TEST):Jt(n.SCISSOR_TEST)}function de(_e){_e===void 0&&(_e=n.TEXTURE0+Ge-1),ae!==_e&&(n.activeTexture(_e),ae=_e)}function ne(_e,Ye,Se){Se===void 0&&(ae===null?Se=n.TEXTURE0+Ge-1:Se=ae);let Me=Ee[Se];Me===void 0&&(Me={type:void 0,texture:void 0},Ee[Se]=Me),(Me.type!==_e||Me.texture!==Ye)&&(ae!==Se&&(n.activeTexture(Se),ae=Se),n.bindTexture(_e,Ye||Rt[_e]),Me.type=_e,Me.texture=Ye)}function Oe(){const _e=Ee[ae];_e!==void 0&&_e.type!==void 0&&(n.bindTexture(_e.type,null),_e.type=void 0,_e.texture=void 0)}function mt(){try{n.compressedTexImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function ot(){try{n.compressedTexImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function lt(){try{n.texSubImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Et(){try{n.texSubImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Ut(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Vt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function $t(){try{n.texStorage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Nt(){try{n.texStorage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function St(){try{n.texImage2D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function Zt(){try{n.texImage3D.apply(n,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}}function He(_e){Ke.equals(_e)===!1&&(n.scissor(_e.x,_e.y,_e.z,_e.w),Ke.copy(_e))}function Lt(_e){Ue.equals(_e)===!1&&(n.viewport(_e.x,_e.y,_e.z,_e.w),Ue.copy(_e))}function qt(_e,Ye){let Se=x.get(Ye);Se===void 0&&(Se=new WeakMap,x.set(Ye,Se));let Me=Se.get(_e);Me===void 0&&(Me=n.getUniformBlockIndex(Ye,_e.name),Se.set(_e,Me))}function Ot(_e,Ye){const Me=x.get(Ye).get(_e);_.get(Ye)!==Me&&(n.uniformBlockBinding(Ye,Me,_e.__bindingPointIndex),_.set(Ye,Me))}function fn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),o===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),S={},ae=null,Ee={},T={},I=new WeakMap,k=[],D=null,L=!1,O=null,F=null,B=null,G=null,q=null,X=null,te=null,V=new Pn(0,0,0),Q=0,ge=!1,me=null,be=null,fe=null,Ce=null,Le=null,Ke.set(0,0,n.canvas.width,n.canvas.height),Ue.set(0,0,n.canvas.width,n.canvas.height),f.reset(),m.reset(),y.reset()}return{buffers:{color:f,depth:m,stencil:y},enable:kt,disable:Jt,bindFramebuffer:It,drawBuffers:Pe,useProgram:pt,setBlending:Be,setMaterial:ue,setFlipSided:se,setCullFace:ve,setLineWidth:$e,setPolygonOffset:De,setScissorTest:st,activeTexture:de,bindTexture:ne,unbindTexture:Oe,compressedTexImage2D:mt,compressedTexImage3D:ot,texImage2D:St,texImage3D:Zt,updateUBOMapping:qt,uniformBlockBinding:Ot,texStorage2D:$t,texStorage3D:Nt,texSubImage2D:lt,texSubImage3D:Et,compressedTexSubImage2D:Ut,compressedTexSubImage3D:Vt,scissor:He,viewport:Lt,reset:fn}}function Zwe(n,e,a,o,s,c,d){const f=s.isWebGL2,m=s.maxTextures,y=s.maxCubemapSize,_=s.maxTextureSize,x=s.maxSamples,S=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,T=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),I=new WeakMap;let k;const D=new WeakMap;let L=!1;try{L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function O(de,ne){return L?new OffscreenCanvas(de,ne):Zx("canvas")}function F(de,ne,Oe,mt){let ot=1;if((de.width>mt||de.height>mt)&&(ot=mt/Math.max(de.width,de.height)),ot<1||ne===!0)if(typeof HTMLImageElement<"u"&&de instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&de instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&de instanceof ImageBitmap){const lt=ne?QE:Math.floor,Et=lt(ot*de.width),Ut=lt(ot*de.height);k===void 0&&(k=O(Et,Ut));const Vt=Oe?O(Et,Ut):k;return Vt.width=Et,Vt.height=Ut,Vt.getContext("2d").drawImage(de,0,0,Et,Ut),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+de.width+"x"+de.height+") to ("+Et+"x"+Ut+")."),Vt}else return"data"in de&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+de.width+"x"+de.height+")."),de;return de}function B(de){return MR(de.width)&&MR(de.height)}function G(de){return f?!1:de.wrapS!==xs||de.wrapT!==xs||de.minFilter!==lo&&de.minFilter!==Ir}function q(de,ne){return de.generateMipmaps&&ne&&de.minFilter!==lo&&de.minFilter!==Ir}function X(de){n.generateMipmap(de)}function te(de,ne,Oe,mt,ot=!1){if(f===!1)return ne;if(de!==null){if(n[de]!==void 0)return n[de];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+de+"'")}let lt=ne;if(ne===n.RED&&(Oe===n.FLOAT&&(lt=n.R32F),Oe===n.HALF_FLOAT&&(lt=n.R16F),Oe===n.UNSIGNED_BYTE&&(lt=n.R8)),ne===n.RED_INTEGER&&(Oe===n.UNSIGNED_BYTE&&(lt=n.R8UI),Oe===n.UNSIGNED_SHORT&&(lt=n.R16UI),Oe===n.UNSIGNED_INT&&(lt=n.R32UI),Oe===n.BYTE&&(lt=n.R8I),Oe===n.SHORT&&(lt=n.R16I),Oe===n.INT&&(lt=n.R32I)),ne===n.RG&&(Oe===n.FLOAT&&(lt=n.RG32F),Oe===n.HALF_FLOAT&&(lt=n.RG16F),Oe===n.UNSIGNED_BYTE&&(lt=n.RG8)),ne===n.RGBA){const Et=ot?jx:zi.getTransfer(mt);Oe===n.FLOAT&&(lt=n.RGBA32F),Oe===n.HALF_FLOAT&&(lt=n.RGBA16F),Oe===n.UNSIGNED_BYTE&&(lt=Et===Qi?n.SRGB8_ALPHA8:n.RGBA8),Oe===n.UNSIGNED_SHORT_4_4_4_4&&(lt=n.RGBA4),Oe===n.UNSIGNED_SHORT_5_5_5_1&&(lt=n.RGB5_A1)}return(lt===n.R16F||lt===n.R32F||lt===n.RG16F||lt===n.RG32F||lt===n.RGBA16F||lt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),lt}function V(de,ne,Oe){return q(de,Oe)===!0||de.isFramebufferTexture&&de.minFilter!==lo&&de.minFilter!==Ir?Math.log2(Math.max(ne.width,ne.height))+1:de.mipmaps!==void 0&&de.mipmaps.length>0?de.mipmaps.length:de.isCompressedTexture&&Array.isArray(de.image)?ne.mipmaps.length:1}function Q(de){return de===lo||de===KE||de===Qb?n.NEAREST:n.LINEAR}function ge(de){const ne=de.target;ne.removeEventListener("dispose",ge),be(ne),ne.isVideoTexture&&I.delete(ne)}function me(de){const ne=de.target;ne.removeEventListener("dispose",me),Ce(ne)}function be(de){const ne=o.get(de);if(ne.__webglInit===void 0)return;const Oe=de.source,mt=D.get(Oe);if(mt){const ot=mt[ne.__cacheKey];ot.usedTimes--,ot.usedTimes===0&&fe(de),Object.keys(mt).length===0&&D.delete(Oe)}o.remove(de)}function fe(de){const ne=o.get(de);n.deleteTexture(ne.__webglTexture);const Oe=de.source,mt=D.get(Oe);delete mt[ne.__cacheKey],d.memory.textures--}function Ce(de){const ne=de.texture,Oe=o.get(de),mt=o.get(ne);if(mt.__webglTexture!==void 0&&(n.deleteTexture(mt.__webglTexture),d.memory.textures--),de.depthTexture&&de.depthTexture.dispose(),de.isWebGLCubeRenderTarget)for(let ot=0;ot<6;ot++){if(Array.isArray(Oe.__webglFramebuffer[ot]))for(let lt=0;lt<Oe.__webglFramebuffer[ot].length;lt++)n.deleteFramebuffer(Oe.__webglFramebuffer[ot][lt]);else n.deleteFramebuffer(Oe.__webglFramebuffer[ot]);Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer[ot])}else{if(Array.isArray(Oe.__webglFramebuffer))for(let ot=0;ot<Oe.__webglFramebuffer.length;ot++)n.deleteFramebuffer(Oe.__webglFramebuffer[ot]);else n.deleteFramebuffer(Oe.__webglFramebuffer);if(Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer),Oe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Oe.__webglMultisampledFramebuffer),Oe.__webglColorRenderbuffer)for(let ot=0;ot<Oe.__webglColorRenderbuffer.length;ot++)Oe.__webglColorRenderbuffer[ot]&&n.deleteRenderbuffer(Oe.__webglColorRenderbuffer[ot]);Oe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Oe.__webglDepthRenderbuffer)}if(de.isWebGLMultipleRenderTargets)for(let ot=0,lt=ne.length;ot<lt;ot++){const Et=o.get(ne[ot]);Et.__webglTexture&&(n.deleteTexture(Et.__webglTexture),d.memory.textures--),o.remove(ne[ot])}o.remove(ne),o.remove(de)}let Le=0;function Ge(){Le=0}function le(){const de=Le;return de>=m&&console.warn("THREE.WebGLTextures: Trying to use "+de+" texture units while this GPU supports only "+m),Le+=1,de}function pe(de){const ne=[];return ne.push(de.wrapS),ne.push(de.wrapT),ne.push(de.wrapR||0),ne.push(de.magFilter),ne.push(de.minFilter),ne.push(de.anisotropy),ne.push(de.internalFormat),ne.push(de.format),ne.push(de.type),ne.push(de.generateMipmaps),ne.push(de.premultiplyAlpha),ne.push(de.flipY),ne.push(de.unpackAlignment),ne.push(de.colorSpace),ne.join()}function Ae(de,ne){const Oe=o.get(de);if(de.isVideoTexture&&De(de),de.isRenderTargetTexture===!1&&de.version>0&&Oe.__version!==de.version){const mt=de.image;if(mt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(mt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{kt(Oe,de,ne);return}}a.bindTexture(n.TEXTURE_2D,Oe.__webglTexture,n.TEXTURE0+ne)}function ae(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ne);return}a.bindTexture(n.TEXTURE_2D_ARRAY,Oe.__webglTexture,n.TEXTURE0+ne)}function Ee(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ne);return}a.bindTexture(n.TEXTURE_3D,Oe.__webglTexture,n.TEXTURE0+ne)}function Ze(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){Jt(Oe,de,ne);return}a.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture,n.TEXTURE0+ne)}const Xe={[Ux]:n.REPEAT,[xs]:n.CLAMP_TO_EDGE,[Wx]:n.MIRRORED_REPEAT},Ke={[lo]:n.NEAREST,[KE]:n.NEAREST_MIPMAP_NEAREST,[Qb]:n.NEAREST_MIPMAP_LINEAR,[Ir]:n.LINEAR,[$D]:n.LINEAR_MIPMAP_NEAREST,[_p]:n.LINEAR_MIPMAP_LINEAR},Ue={[kY]:n.NEVER,[UY]:n.ALWAYS,[DY]:n.LESS,[zY]:n.LEQUAL,[OY]:n.EQUAL,[BY]:n.GEQUAL,[FY]:n.GREATER,[NY]:n.NOTEQUAL};function ft(de,ne,Oe){if(Oe?(n.texParameteri(de,n.TEXTURE_WRAP_S,Xe[ne.wrapS]),n.texParameteri(de,n.TEXTURE_WRAP_T,Xe[ne.wrapT]),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,Xe[ne.wrapR]),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Ke[ne.magFilter]),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Ke[ne.minFilter])):(n.texParameteri(de,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(de,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(ne.wrapS!==xs||ne.wrapT!==xs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Q(ne.magFilter)),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Q(ne.minFilter)),ne.minFilter!==lo&&ne.minFilter!==Ir&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ne.compareFunction&&(n.texParameteri(de,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(de,n.TEXTURE_COMPARE_FUNC,Ue[ne.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const mt=e.get("EXT_texture_filter_anisotropic");if(ne.magFilter===lo||ne.minFilter!==Qb&&ne.minFilter!==_p||ne.type===sd&&e.has("OES_texture_float_linear")===!1||f===!1&&ne.type===t_&&e.has("OES_texture_half_float_linear")===!1)return;(ne.anisotropy>1||o.get(ne).__currentAnisotropy)&&(n.texParameterf(de,mt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ne.anisotropy,s.getMaxAnisotropy())),o.get(ne).__currentAnisotropy=ne.anisotropy)}}function Rt(de,ne){let Oe=!1;de.__webglInit===void 0&&(de.__webglInit=!0,ne.addEventListener("dispose",ge));const mt=ne.source;let ot=D.get(mt);ot===void 0&&(ot={},D.set(mt,ot));const lt=pe(ne);if(lt!==de.__cacheKey){ot[lt]===void 0&&(ot[lt]={texture:n.createTexture(),usedTimes:0},d.memory.textures++,Oe=!0),ot[lt].usedTimes++;const Et=ot[de.__cacheKey];Et!==void 0&&(ot[de.__cacheKey].usedTimes--,Et.usedTimes===0&&fe(ne)),de.__cacheKey=lt,de.__webglTexture=ot[lt].texture}return Oe}function kt(de,ne,Oe){let mt=n.TEXTURE_2D;(ne.isDataArrayTexture||ne.isCompressedArrayTexture)&&(mt=n.TEXTURE_2D_ARRAY),ne.isData3DTexture&&(mt=n.TEXTURE_3D);const ot=Rt(de,ne),lt=ne.source;a.bindTexture(mt,de.__webglTexture,n.TEXTURE0+Oe);const Et=o.get(lt);if(lt.version!==Et.__version||ot===!0){a.activeTexture(n.TEXTURE0+Oe);const Ut=zi.getPrimaries(zi.workingColorSpace),Vt=ne.colorSpace===jl?null:zi.getPrimaries(ne.colorSpace),$t=ne.colorSpace===jl||Ut===Vt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ne.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ne.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);const Nt=G(ne)&&B(ne.image)===!1;let St=F(ne.image,Nt,!1,_);St=st(ne,St);const Zt=B(St)||f,He=c.convert(ne.format,ne.colorSpace);let Lt=c.convert(ne.type),qt=te(ne.internalFormat,He,Lt,ne.colorSpace,ne.isVideoTexture);ft(mt,ne,Zt);let Ot;const fn=ne.mipmaps,_e=f&&ne.isVideoTexture!==!0,Ye=Et.__version===void 0||ot===!0,Se=V(ne,St,Zt);if(ne.isDepthTexture)qt=n.DEPTH_COMPONENT,f?ne.type===sd?qt=n.DEPTH_COMPONENT32F:ne.type===Ah?qt=n.DEPTH_COMPONENT24:ne.type===up?qt=n.DEPTH24_STENCIL8:qt=n.DEPTH_COMPONENT16:ne.type===sd&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ne.format===dp&&qt===n.DEPTH_COMPONENT&&ne.type!==LT&&ne.type!==Ah&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ne.type=Ah,Lt=c.convert(ne.type)),ne.format===kg&&qt===n.DEPTH_COMPONENT&&(qt=n.DEPTH_STENCIL,ne.type!==up&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ne.type=up,Lt=c.convert(ne.type))),Ye&&(_e?a.texStorage2D(n.TEXTURE_2D,1,qt,St.width,St.height):a.texImage2D(n.TEXTURE_2D,0,qt,St.width,St.height,0,He,Lt,null));else if(ne.isDataTexture)if(fn.length>0&&Zt){_e&&Ye&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Ot=fn[Me],_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,Ot.width,Ot.height,He,Lt,Ot.data):a.texImage2D(n.TEXTURE_2D,Me,qt,Ot.width,Ot.height,0,He,Lt,Ot.data);ne.generateMipmaps=!1}else _e?(Ye&&a.texStorage2D(n.TEXTURE_2D,Se,qt,St.width,St.height),a.texSubImage2D(n.TEXTURE_2D,0,0,0,St.width,St.height,He,Lt,St.data)):a.texImage2D(n.TEXTURE_2D,0,qt,St.width,St.height,0,He,Lt,St.data);else if(ne.isCompressedTexture)if(ne.isCompressedArrayTexture){_e&&Ye&&a.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,fn[0].width,fn[0].height,St.depth);for(let Me=0,ze=fn.length;Me<ze;Me++)Ot=fn[Me],ne.format!==pl?He!==null?_e?a.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,Ot.width,Ot.height,St.depth,He,Ot.data,0,0):a.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Me,qt,Ot.width,Ot.height,St.depth,0,Ot.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_e?a.texSubImage3D(n.TEXTURE_2D_ARRAY,Me,0,0,0,Ot.width,Ot.height,St.depth,He,Lt,Ot.data):a.texImage3D(n.TEXTURE_2D_ARRAY,Me,qt,Ot.width,Ot.height,St.depth,0,He,Lt,Ot.data)}else{_e&&Ye&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Ot=fn[Me],ne.format!==pl?He!==null?_e?a.compressedTexSubImage2D(n.TEXTURE_2D,Me,0,0,Ot.width,Ot.height,He,Ot.data):a.compressedTexImage2D(n.TEXTURE_2D,Me,qt,Ot.width,Ot.height,0,Ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,Ot.width,Ot.height,He,Lt,Ot.data):a.texImage2D(n.TEXTURE_2D,Me,qt,Ot.width,Ot.height,0,He,Lt,Ot.data)}else if(ne.isDataArrayTexture)_e?(Ye&&a.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,St.width,St.height,St.depth),a.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,St.width,St.height,St.depth,He,Lt,St.data)):a.texImage3D(n.TEXTURE_2D_ARRAY,0,qt,St.width,St.height,St.depth,0,He,Lt,St.data);else if(ne.isData3DTexture)_e?(Ye&&a.texStorage3D(n.TEXTURE_3D,Se,qt,St.width,St.height,St.depth),a.texSubImage3D(n.TEXTURE_3D,0,0,0,0,St.width,St.height,St.depth,He,Lt,St.data)):a.texImage3D(n.TEXTURE_3D,0,qt,St.width,St.height,St.depth,0,He,Lt,St.data);else if(ne.isFramebufferTexture){if(Ye)if(_e)a.texStorage2D(n.TEXTURE_2D,Se,qt,St.width,St.height);else{let Me=St.width,ze=St.height;for(let Qe=0;Qe<Se;Qe++)a.texImage2D(n.TEXTURE_2D,Qe,qt,Me,ze,0,He,Lt,null),Me>>=1,ze>>=1}}else if(fn.length>0&&Zt){_e&&Ye&&a.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Me=0,ze=fn.length;Me<ze;Me++)Ot=fn[Me],_e?a.texSubImage2D(n.TEXTURE_2D,Me,0,0,He,Lt,Ot):a.texImage2D(n.TEXTURE_2D,Me,qt,He,Lt,Ot);ne.generateMipmaps=!1}else _e?(Ye&&a.texStorage2D(n.TEXTURE_2D,Se,qt,St.width,St.height),a.texSubImage2D(n.TEXTURE_2D,0,0,0,He,Lt,St)):a.texImage2D(n.TEXTURE_2D,0,qt,He,Lt,St);q(ne,Zt)&&X(mt),Et.__version=lt.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function Jt(de,ne,Oe){if(ne.image.length!==6)return;const mt=Rt(de,ne),ot=ne.source;a.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture,n.TEXTURE0+Oe);const lt=o.get(ot);if(ot.version!==lt.__version||mt===!0){a.activeTexture(n.TEXTURE0+Oe);const Et=zi.getPrimaries(zi.workingColorSpace),Ut=ne.colorSpace===jl?null:zi.getPrimaries(ne.colorSpace),Vt=ne.colorSpace===jl||Et===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ne.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ne.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Vt);const $t=ne.isCompressedTexture||ne.image[0].isCompressedTexture,Nt=ne.image[0]&&ne.image[0].isDataTexture,St=[];for(let Me=0;Me<6;Me++)!$t&&!Nt?St[Me]=F(ne.image[Me],!1,!0,y):St[Me]=Nt?ne.image[Me].image:ne.image[Me],St[Me]=st(ne,St[Me]);const Zt=St[0],He=B(Zt)||f,Lt=c.convert(ne.format,ne.colorSpace),qt=c.convert(ne.type),Ot=te(ne.internalFormat,Lt,qt,ne.colorSpace),fn=f&&ne.isVideoTexture!==!0,_e=lt.__version===void 0||mt===!0;let Ye=V(ne,Zt,He);ft(n.TEXTURE_CUBE_MAP,ne,He);let Se;if($t){fn&&_e&&a.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,Ot,Zt.width,Zt.height);for(let Me=0;Me<6;Me++){Se=St[Me].mipmaps;for(let ze=0;ze<Se.length;ze++){const Qe=Se[ze];ne.format!==pl?Lt!==null?fn?a.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,0,0,Qe.width,Qe.height,Lt,Qe.data):a.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,Ot,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,0,0,Qe.width,Qe.height,Lt,qt,Qe.data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze,Ot,Qe.width,Qe.height,0,Lt,qt,Qe.data)}}}else{Se=ne.mipmaps,fn&&_e&&(Se.length>0&&Ye++,a.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,Ot,St[0].width,St[0].height));for(let Me=0;Me<6;Me++)if(Nt){fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,St[Me].width,St[Me].height,Lt,qt,St[Me].data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Ot,St[Me].width,St[Me].height,0,Lt,qt,St[Me].data);for(let ze=0;ze<Se.length;ze++){const tt=Se[ze].image[Me].image;fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,0,0,tt.width,tt.height,Lt,qt,tt.data):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,Ot,tt.width,tt.height,0,Lt,qt,tt.data)}}else{fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,Lt,qt,St[Me]):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,Ot,Lt,qt,St[Me]);for(let ze=0;ze<Se.length;ze++){const Qe=Se[ze];fn?a.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,0,0,Lt,qt,Qe.image[Me]):a.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,ze+1,Ot,Lt,qt,Qe.image[Me])}}}q(ne,He)&&X(n.TEXTURE_CUBE_MAP),lt.__version=ot.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function It(de,ne,Oe,mt,ot,lt){const Et=c.convert(Oe.format,Oe.colorSpace),Ut=c.convert(Oe.type),Vt=te(Oe.internalFormat,Et,Ut,Oe.colorSpace);if(!o.get(ne).__hasExternalTextures){const Nt=Math.max(1,ne.width>>lt),St=Math.max(1,ne.height>>lt);ot===n.TEXTURE_3D||ot===n.TEXTURE_2D_ARRAY?a.texImage3D(ot,lt,Vt,Nt,St,ne.depth,0,Et,Ut,null):a.texImage2D(ot,lt,Vt,Nt,St,0,Et,Ut,null)}a.bindFramebuffer(n.FRAMEBUFFER,de),$e(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,mt,ot,o.get(Oe).__webglTexture,0,ve(ne)):(ot===n.TEXTURE_2D||ot>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&ot<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,mt,ot,o.get(Oe).__webglTexture,lt),a.bindFramebuffer(n.FRAMEBUFFER,null)}function Pe(de,ne,Oe){if(n.bindRenderbuffer(n.RENDERBUFFER,de),ne.depthBuffer&&!ne.stencilBuffer){let mt=f===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Oe||$e(ne)){const ot=ne.depthTexture;ot&&ot.isDepthTexture&&(ot.type===sd?mt=n.DEPTH_COMPONENT32F:ot.type===Ah&&(mt=n.DEPTH_COMPONENT24));const lt=ve(ne);$e(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,lt,mt,ne.width,ne.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,mt,ne.width,ne.height)}else n.renderbufferStorage(n.RENDERBUFFER,mt,ne.width,ne.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,de)}else if(ne.depthBuffer&&ne.stencilBuffer){const mt=ve(ne);Oe&&$e(ne)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,mt,n.DEPTH24_STENCIL8,ne.width,ne.height):$e(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,mt,n.DEPTH24_STENCIL8,ne.width,ne.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,ne.width,ne.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,de)}else{const mt=ne.isWebGLMultipleRenderTargets===!0?ne.texture:[ne.texture];for(let ot=0;ot<mt.length;ot++){const lt=mt[ot],Et=c.convert(lt.format,lt.colorSpace),Ut=c.convert(lt.type),Vt=te(lt.internalFormat,Et,Ut,lt.colorSpace),$t=ve(ne);Oe&&$e(ne)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,$t,Vt,ne.width,ne.height):$e(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,$t,Vt,ne.width,ne.height):n.renderbufferStorage(n.RENDERBUFFER,Vt,ne.width,ne.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function pt(de,ne){if(ne&&ne.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(n.FRAMEBUFFER,de),!(ne.depthTexture&&ne.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(ne.depthTexture).__webglTexture||ne.depthTexture.image.width!==ne.width||ne.depthTexture.image.height!==ne.height)&&(ne.depthTexture.image.width=ne.width,ne.depthTexture.image.height=ne.height,ne.depthTexture.needsUpdate=!0),Ae(ne.depthTexture,0);const mt=o.get(ne.depthTexture).__webglTexture,ot=ve(ne);if(ne.depthTexture.format===dp)$e(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,mt,0,ot):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,mt,0);else if(ne.depthTexture.format===kg)$e(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,mt,0,ot):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,mt,0);else throw new Error("Unknown depthTexture format")}function yt(de){const ne=o.get(de),Oe=de.isWebGLCubeRenderTarget===!0;if(de.depthTexture&&!ne.__autoAllocateDepthBuffer){if(Oe)throw new Error("target.depthTexture not supported in Cube render targets");pt(ne.__webglFramebuffer,de)}else if(Oe){ne.__webglDepthbuffer=[];for(let mt=0;mt<6;mt++)a.bindFramebuffer(n.FRAMEBUFFER,ne.__webglFramebuffer[mt]),ne.__webglDepthbuffer[mt]=n.createRenderbuffer(),Pe(ne.__webglDepthbuffer[mt],de,!1)}else a.bindFramebuffer(n.FRAMEBUFFER,ne.__webglFramebuffer),ne.__webglDepthbuffer=n.createRenderbuffer(),Pe(ne.__webglDepthbuffer,de,!1);a.bindFramebuffer(n.FRAMEBUFFER,null)}function At(de,ne,Oe){const mt=o.get(de);ne!==void 0&&It(mt.__webglFramebuffer,de,de.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Oe!==void 0&&yt(de)}function Be(de){const ne=de.texture,Oe=o.get(de),mt=o.get(ne);de.addEventListener("dispose",me),de.isWebGLMultipleRenderTargets!==!0&&(mt.__webglTexture===void 0&&(mt.__webglTexture=n.createTexture()),mt.__version=ne.version,d.memory.textures++);const ot=de.isWebGLCubeRenderTarget===!0,lt=de.isWebGLMultipleRenderTargets===!0,Et=B(de)||f;if(ot){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<6;Ut++)if(f&&ne.mipmaps&&ne.mipmaps.length>0){Oe.__webglFramebuffer[Ut]=[];for(let Vt=0;Vt<ne.mipmaps.length;Vt++)Oe.__webglFramebuffer[Ut][Vt]=n.createFramebuffer()}else Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else{if(f&&ne.mipmaps&&ne.mipmaps.length>0){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<ne.mipmaps.length;Ut++)Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else Oe.__webglFramebuffer=n.createFramebuffer();if(lt)if(s.drawBuffers){const Ut=de.texture;for(let Vt=0,$t=Ut.length;Vt<$t;Vt++){const Nt=o.get(Ut[Vt]);Nt.__webglTexture===void 0&&(Nt.__webglTexture=n.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(f&&de.samples>0&&$e(de)===!1){const Ut=lt?ne:[ne];Oe.__webglMultisampledFramebuffer=n.createFramebuffer(),Oe.__webglColorRenderbuffer=[],a.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer);for(let Vt=0;Vt<Ut.length;Vt++){const $t=Ut[Vt];Oe.__webglColorRenderbuffer[Vt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Vt]);const Nt=c.convert($t.format,$t.colorSpace),St=c.convert($t.type),Zt=te($t.internalFormat,Nt,St,$t.colorSpace,de.isXRRenderTarget===!0),He=ve(de);n.renderbufferStorageMultisample(n.RENDERBUFFER,He,Zt,de.width,de.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Vt,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Vt])}n.bindRenderbuffer(n.RENDERBUFFER,null),de.depthBuffer&&(Oe.__webglDepthRenderbuffer=n.createRenderbuffer(),Pe(Oe.__webglDepthRenderbuffer,de,!0)),a.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ot){a.bindTexture(n.TEXTURE_CUBE_MAP,mt.__webglTexture),ft(n.TEXTURE_CUBE_MAP,ne,Et);for(let Ut=0;Ut<6;Ut++)if(f&&ne.mipmaps&&ne.mipmaps.length>0)for(let Vt=0;Vt<ne.mipmaps.length;Vt++)It(Oe.__webglFramebuffer[Ut][Vt],de,ne,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,Vt);else It(Oe.__webglFramebuffer[Ut],de,ne,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0);q(ne,Et)&&X(n.TEXTURE_CUBE_MAP),a.unbindTexture()}else if(lt){const Ut=de.texture;for(let Vt=0,$t=Ut.length;Vt<$t;Vt++){const Nt=Ut[Vt],St=o.get(Nt);a.bindTexture(n.TEXTURE_2D,St.__webglTexture),ft(n.TEXTURE_2D,Nt,Et),It(Oe.__webglFramebuffer,de,Nt,n.COLOR_ATTACHMENT0+Vt,n.TEXTURE_2D,0),q(Nt,Et)&&X(n.TEXTURE_2D)}a.unbindTexture()}else{let Ut=n.TEXTURE_2D;if((de.isWebGL3DRenderTarget||de.isWebGLArrayRenderTarget)&&(f?Ut=de.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),a.bindTexture(Ut,mt.__webglTexture),ft(Ut,ne,Et),f&&ne.mipmaps&&ne.mipmaps.length>0)for(let Vt=0;Vt<ne.mipmaps.length;Vt++)It(Oe.__webglFramebuffer[Vt],de,ne,n.COLOR_ATTACHMENT0,Ut,Vt);else It(Oe.__webglFramebuffer,de,ne,n.COLOR_ATTACHMENT0,Ut,0);q(ne,Et)&&X(Ut),a.unbindTexture()}de.depthBuffer&&yt(de)}function ue(de){const ne=B(de)||f,Oe=de.isWebGLMultipleRenderTargets===!0?de.texture:[de.texture];for(let mt=0,ot=Oe.length;mt<ot;mt++){const lt=Oe[mt];if(q(lt,ne)){const Et=de.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ut=o.get(lt).__webglTexture;a.bindTexture(Et,Ut),X(Et),a.unbindTexture()}}}function se(de){if(f&&de.samples>0&&$e(de)===!1){const ne=de.isWebGLMultipleRenderTargets?de.texture:[de.texture],Oe=de.width,mt=de.height;let ot=n.COLOR_BUFFER_BIT;const lt=[],Et=de.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ut=o.get(de),Vt=de.isWebGLMultipleRenderTargets===!0;if(Vt)for(let $t=0;$t<ne.length;$t++)a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.RENDERBUFFER,null),a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.TEXTURE_2D,null,0);a.bindFramebuffer(n.READ_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),a.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer);for(let $t=0;$t<ne.length;$t++){lt.push(n.COLOR_ATTACHMENT0+$t),de.depthBuffer&&lt.push(Et);const Nt=Ut.__ignoreDepthValues!==void 0?Ut.__ignoreDepthValues:!1;if(Nt===!1&&(de.depthBuffer&&(ot|=n.DEPTH_BUFFER_BIT),de.stencilBuffer&&(ot|=n.STENCIL_BUFFER_BIT)),Vt&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]),Nt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Et]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Et])),Vt){const St=o.get(ne[$t]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,St,0)}n.blitFramebuffer(0,0,Oe,mt,0,0,Oe,mt,ot,n.NEAREST),T&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,lt)}if(a.bindFramebuffer(n.READ_FRAMEBUFFER,null),a.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Vt)for(let $t=0;$t<ne.length;$t++){a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[$t]);const Nt=o.get(ne[$t]).__webglTexture;a.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+$t,n.TEXTURE_2D,Nt,0)}a.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer)}}function ve(de){return Math.min(x,de.samples)}function $e(de){const ne=o.get(de);return f&&de.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ne.__useRenderToTexture!==!1}function De(de){const ne=d.render.frame;I.get(de)!==ne&&(I.set(de,ne),de.update())}function st(de,ne){const Oe=de.colorSpace,mt=de.format,ot=de.type;return de.isCompressedTexture===!0||de.isVideoTexture===!0||de.format===JE||Oe!==vd&&Oe!==jl&&(zi.getTransfer(Oe)===Qi?f===!1?e.has("EXT_sRGB")===!0&&mt===pl?(de.format=JE,de.minFilter=Ir,de.generateMipmaps=!1):ne=a6.sRGBToLinear(ne):(mt!==pl||ot!==fd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Oe)),ne}this.allocateTextureUnit=le,this.resetTextureUnits=Ge,this.setTexture2D=Ae,this.setTexture2DArray=ae,this.setTexture3D=Ee,this.setTextureCube=Ze,this.rebindTextures=At,this.setupRenderTarget=Be,this.updateRenderTargetMipmap=ue,this.updateMultisampleRenderTarget=se,this.setupDepthRenderbuffer=yt,this.setupFrameBufferTexture=It,this.useMultisampledRTT=$e}function eZ(n,e,a){const o=a.isWebGL2;function s(c,d=jl){let f;const m=zi.getTransfer(d);if(c===fd)return n.UNSIGNED_BYTE;if(c===XD)return n.UNSIGNED_SHORT_4_4_4_4;if(c===YD)return n.UNSIGNED_SHORT_5_5_5_1;if(c===_Y)return n.BYTE;if(c===bY)return n.SHORT;if(c===LT)return n.UNSIGNED_SHORT;if(c===qD)return n.INT;if(c===Ah)return n.UNSIGNED_INT;if(c===sd)return n.FLOAT;if(c===t_)return o?n.HALF_FLOAT:(f=e.get("OES_texture_half_float"),f!==null?f.HALF_FLOAT_OES:null);if(c===xY)return n.ALPHA;if(c===pl)return n.RGBA;if(c===wY)return n.LUMINANCE;if(c===SY)return n.LUMINANCE_ALPHA;if(c===dp)return n.DEPTH_COMPONENT;if(c===kg)return n.DEPTH_STENCIL;if(c===JE)return f=e.get("EXT_sRGB"),f!==null?f.SRGB_ALPHA_EXT:null;if(c===AY)return n.RED;if(c===ZD)return n.RED_INTEGER;if(c===EY)return n.RG;if(c===KD)return n.RG_INTEGER;if(c===JD)return n.RGBA_INTEGER;if(c===XA||c===YA||c===ZA||c===KA)if(m===Qi)if(f=e.get("WEBGL_compressed_texture_s3tc_srgb"),f!==null){if(c===XA)return f.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(c===YA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(c===ZA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(c===KA)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(f=e.get("WEBGL_compressed_texture_s3tc"),f!==null){if(c===XA)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===YA)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===ZA)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===KA)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(c===QL||c===eR||c===tR||c===nR)if(f=e.get("WEBGL_compressed_texture_pvrtc"),f!==null){if(c===QL)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===eR)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===tR)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===nR)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(c===MY)return f=e.get("WEBGL_compressed_texture_etc1"),f!==null?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(c===aR||c===iR)if(f=e.get("WEBGL_compressed_texture_etc"),f!==null){if(c===aR)return m===Qi?f.COMPRESSED_SRGB8_ETC2:f.COMPRESSED_RGB8_ETC2;if(c===iR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:f.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(c===rR||c===oR||c===sR||c===lR||c===cR||c===uR||c===dR||c===hR||c===fR||c===pR||c===mR||c===gR||c===yR||c===vR)if(f=e.get("WEBGL_compressed_texture_astc"),f!==null){if(c===rR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:f.COMPRESSED_RGBA_ASTC_4x4_KHR;if(c===oR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:f.COMPRESSED_RGBA_ASTC_5x4_KHR;if(c===sR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:f.COMPRESSED_RGBA_ASTC_5x5_KHR;if(c===lR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:f.COMPRESSED_RGBA_ASTC_6x5_KHR;if(c===cR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:f.COMPRESSED_RGBA_ASTC_6x6_KHR;if(c===uR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:f.COMPRESSED_RGBA_ASTC_8x5_KHR;if(c===dR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:f.COMPRESSED_RGBA_ASTC_8x6_KHR;if(c===hR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:f.COMPRESSED_RGBA_ASTC_8x8_KHR;if(c===fR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:f.COMPRESSED_RGBA_ASTC_10x5_KHR;if(c===pR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:f.COMPRESSED_RGBA_ASTC_10x6_KHR;if(c===mR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:f.COMPRESSED_RGBA_ASTC_10x8_KHR;if(c===gR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:f.COMPRESSED_RGBA_ASTC_10x10_KHR;if(c===yR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:f.COMPRESSED_RGBA_ASTC_12x10_KHR;if(c===vR)return m===Qi?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:f.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(c===JA||c===_R||c===bR)if(f=e.get("EXT_texture_compression_bptc"),f!==null){if(c===JA)return m===Qi?f.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:f.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(c===_R)return f.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(c===bR)return f.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(c===TY||c===xR||c===wR||c===SR)if(f=e.get("EXT_texture_compression_rgtc"),f!==null){if(c===JA)return f.COMPRESSED_RED_RGTC1_EXT;if(c===xR)return f.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(c===wR)return f.COMPRESSED_RED_GREEN_RGTC2_EXT;if(c===SR)return f.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return c===up?o?n.UNSIGNED_INT_24_8:(f=e.get("WEBGL_depth_texture"),f!==null?f.UNSIGNED_INT_24_8_WEBGL:null):n[c]!==void 0?n[c]:null}return{convert:s}}class tZ extends qr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class w0 extends pi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Kwe={type:"move"};class V4{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new w0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new w0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Fe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Fe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new w0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Fe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Fe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const a=this._hand;if(a)for(const o of e.hand.values())this._getHandJoint(a,o)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,a,o){let s=null,c=null,d=null;const f=this._targetRay,m=this._grip,y=this._hand;if(e&&a.session.visibilityState!=="visible-blurred"){if(y&&e.hand){d=!0;for(const k of e.hand.values()){const D=a.getJointPose(k,o),L=this._getHandJoint(y,k);D!==null&&(L.matrix.fromArray(D.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.matrixWorldNeedsUpdate=!0,L.jointRadius=D.radius),L.visible=D!==null}const _=y.joints["index-finger-tip"],x=y.joints["thumb-tip"],S=_.position.distanceTo(x.position),T=.02,I=.005;y.inputState.pinching&&S>T+I?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&S<=T-I&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else m!==null&&e.gripSpace&&(c=a.getPose(e.gripSpace,o),c!==null&&(m.matrix.fromArray(c.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,c.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(c.linearVelocity)):m.hasLinearVelocity=!1,c.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(c.angularVelocity)):m.hasAngularVelocity=!1));f!==null&&(s=a.getPose(e.targetRaySpace,o),s===null&&c!==null&&(s=c),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(Kwe)))}return f!==null&&(f.visible=s!==null),m!==null&&(m.visible=c!==null),y!==null&&(y.visible=d!==null),this}_getHandJoint(e,a){if(e.joints[a.jointName]===void 0){const o=new w0;o.matrixAutoUpdate=!1,o.visible=!1,e.joints[a.jointName]=o,e.add(o)}return e.joints[a.jointName]}}class nZ extends kr{constructor(e,a,o,s,c,d,f,m,y,_){if(_=_!==void 0?_:dp,_!==dp&&_!==kg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&_===dp&&(o=Ah),o===void 0&&_===kg&&(o=up),super(null,s,c,d,f,m,_,o,y),this.isDepthTexture=!0,this.image={width:e,height:a},this.magFilter=f!==void 0?f:lo,this.minFilter=m!==void 0?m:lo,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const a=super.toJSON(e);return this.compareFunction!==null&&(a.compareFunction=this.compareFunction),a}}class Jwe extends xd{constructor(e,a){super();const o=this;let s=null,c=1,d=null,f="local-floor",m=1,y=null,_=null,x=null,S=null,T=null,I=null;const k=a.getContextAttributes();let D=null,L=null;const O=[],F=[],B=new qr;B.layers.enable(1),B.viewport=new Ei;const G=new qr;G.layers.enable(2),G.viewport=new Ei;const q=[B,G],X=new tZ;X.layers.enable(1),X.layers.enable(2);let te=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new V4,O[ae]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new V4,O[ae]=Ee),Ee.getGripSpace()},this.getHand=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new V4,O[ae]=Ee),Ee.getHandSpace()};function Q(ae){const Ee=F.indexOf(ae.inputSource);if(Ee===-1)return;const Ze=O[Ee];Ze!==void 0&&(Ze.update(ae.inputSource,ae.frame,y||d),Ze.dispatchEvent({type:ae.type,data:ae.inputSource}))}function ge(){s.removeEventListener("select",Q),s.removeEventListener("selectstart",Q),s.removeEventListener("selectend",Q),s.removeEventListener("squeeze",Q),s.removeEventListener("squeezestart",Q),s.removeEventListener("squeezeend",Q),s.removeEventListener("end",ge),s.removeEventListener("inputsourceschange",me);for(let ae=0;ae<O.length;ae++){const Ee=F[ae];Ee!==null&&(F[ae]=null,O[ae].disconnect(Ee))}te=null,V=null,e.setRenderTarget(D),T=null,S=null,x=null,s=null,L=null,Ae.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ae){c=ae,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ae){f=ae,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||d},this.setReferenceSpace=function(ae){y=ae},this.getBaseLayer=function(){return S!==null?S:T},this.getBinding=function(){return x},this.getFrame=function(){return I},this.getSession=function(){return s},this.setSession=async function(ae){if(s=ae,s!==null){if(D=e.getRenderTarget(),s.addEventListener("select",Q),s.addEventListener("selectstart",Q),s.addEventListener("selectend",Q),s.addEventListener("squeeze",Q),s.addEventListener("squeezestart",Q),s.addEventListener("squeezeend",Q),s.addEventListener("end",ge),s.addEventListener("inputsourceschange",me),k.xrCompatible!==!0&&await a.makeXRCompatible(),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ee={antialias:s.renderState.layers===void 0?k.antialias:!0,alpha:!0,depth:k.depth,stencil:k.stencil,framebufferScaleFactor:c};T=new XRWebGLLayer(s,a,Ee),s.updateRenderState({baseLayer:T}),L=new pu(T.framebufferWidth,T.framebufferHeight,{format:pl,type:fd,colorSpace:e.outputColorSpace,stencilBuffer:k.stencil})}else{let Ee=null,Ze=null,Xe=null;k.depth&&(Xe=k.stencil?a.DEPTH24_STENCIL8:a.DEPTH_COMPONENT24,Ee=k.stencil?kg:dp,Ze=k.stencil?up:Ah);const Ke={colorFormat:a.RGBA8,depthFormat:Xe,scaleFactor:c};x=new XRWebGLBinding(s,a),S=x.createProjectionLayer(Ke),s.updateRenderState({layers:[S]}),L=new pu(S.textureWidth,S.textureHeight,{format:pl,type:fd,depthTexture:new nZ(S.textureWidth,S.textureHeight,Ze,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:k.stencil,colorSpace:e.outputColorSpace,samples:k.antialias?4:0});const Ue=e.properties.get(L);Ue.__ignoreDepthValues=S.ignoreDepthValues}L.isXRRenderTarget=!0,this.setFoveation(m),y=null,d=await s.requestReferenceSpace(f),Ae.setContext(s),Ae.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function me(ae){for(let Ee=0;Ee<ae.removed.length;Ee++){const Ze=ae.removed[Ee],Xe=F.indexOf(Ze);Xe>=0&&(F[Xe]=null,O[Xe].disconnect(Ze))}for(let Ee=0;Ee<ae.added.length;Ee++){const Ze=ae.added[Ee];let Xe=F.indexOf(Ze);if(Xe===-1){for(let Ue=0;Ue<O.length;Ue++)if(Ue>=F.length){F.push(Ze),Xe=Ue;break}else if(F[Ue]===null){F[Ue]=Ze,Xe=Ue;break}if(Xe===-1)break}const Ke=O[Xe];Ke&&Ke.connect(Ze)}}const be=new Fe,fe=new Fe;function Ce(ae,Ee,Ze){be.setFromMatrixPosition(Ee.matrixWorld),fe.setFromMatrixPosition(Ze.matrixWorld);const Xe=be.distanceTo(fe),Ke=Ee.projectionMatrix.elements,Ue=Ze.projectionMatrix.elements,ft=Ke[14]/(Ke[10]-1),Rt=Ke[14]/(Ke[10]+1),kt=(Ke[9]+1)/Ke[5],Jt=(Ke[9]-1)/Ke[5],It=(Ke[8]-1)/Ke[0],Pe=(Ue[8]+1)/Ue[0],pt=ft*It,yt=ft*Pe,At=Xe/(-It+Pe),Be=At*-It;Ee.matrixWorld.decompose(ae.position,ae.quaternion,ae.scale),ae.translateX(Be),ae.translateZ(At),ae.matrixWorld.compose(ae.position,ae.quaternion,ae.scale),ae.matrixWorldInverse.copy(ae.matrixWorld).invert();const ue=ft+At,se=Rt+At,ve=pt-Be,$e=yt+(Xe-Be),De=kt*Rt/se*ue,st=Jt*Rt/se*ue;ae.projectionMatrix.makePerspective(ve,$e,De,st,ue,se),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert()}function Le(ae,Ee){Ee===null?ae.matrixWorld.copy(ae.matrix):ae.matrixWorld.multiplyMatrices(Ee.matrixWorld,ae.matrix),ae.matrixWorldInverse.copy(ae.matrixWorld).invert()}this.updateCamera=function(ae){if(s===null)return;X.near=G.near=B.near=ae.near,X.far=G.far=B.far=ae.far,(te!==X.near||V!==X.far)&&(s.updateRenderState({depthNear:X.near,depthFar:X.far}),te=X.near,V=X.far);const Ee=ae.parent,Ze=X.cameras;Le(X,Ee);for(let Xe=0;Xe<Ze.length;Xe++)Le(Ze[Xe],Ee);Ze.length===2?Ce(X,B,G):X.projectionMatrix.copy(B.projectionMatrix),Ge(ae,X,Ee)};function Ge(ae,Ee,Ze){Ze===null?ae.matrix.copy(Ee.matrixWorld):(ae.matrix.copy(Ze.matrixWorld),ae.matrix.invert(),ae.matrix.multiply(Ee.matrixWorld)),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.updateMatrixWorld(!0),ae.projectionMatrix.copy(Ee.projectionMatrix),ae.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ae.isPerspectiveCamera&&(ae.fov=n_*2*Math.atan(1/ae.projectionMatrix.elements[5]),ae.zoom=1)}this.getCamera=function(){return X},this.getFoveation=function(){if(!(S===null&&T===null))return m},this.setFoveation=function(ae){m=ae,S!==null&&(S.fixedFoveation=ae),T!==null&&T.fixedFoveation!==void 0&&(T.fixedFoveation=ae)};let le=null;function pe(ae,Ee){if(_=Ee.getViewerPose(y||d),I=Ee,_!==null){const Ze=_.views;T!==null&&(e.setRenderTargetFramebuffer(L,T.framebuffer),e.setRenderTarget(L));let Xe=!1;Ze.length!==X.cameras.length&&(X.cameras.length=0,Xe=!0);for(let Ke=0;Ke<Ze.length;Ke++){const Ue=Ze[Ke];let ft=null;if(T!==null)ft=T.getViewport(Ue);else{const kt=x.getViewSubImage(S,Ue);ft=kt.viewport,Ke===0&&(e.setRenderTargetTextures(L,kt.colorTexture,S.ignoreDepthValues?void 0:kt.depthStencilTexture),e.setRenderTarget(L))}let Rt=q[Ke];Rt===void 0&&(Rt=new qr,Rt.layers.enable(Ke),Rt.viewport=new Ei,q[Ke]=Rt),Rt.matrix.fromArray(Ue.transform.matrix),Rt.matrix.decompose(Rt.position,Rt.quaternion,Rt.scale),Rt.projectionMatrix.fromArray(Ue.projectionMatrix),Rt.projectionMatrixInverse.copy(Rt.projectionMatrix).invert(),Rt.viewport.set(ft.x,ft.y,ft.width,ft.height),Ke===0&&(X.matrix.copy(Rt.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale)),Xe===!0&&X.cameras.push(Rt)}}for(let Ze=0;Ze<O.length;Ze++){const Xe=F[Ze],Ke=O[Ze];Xe!==null&&Ke!==void 0&&Ke.update(Xe,Ee,y||d)}le&&le(ae,Ee),Ee.detectedPlanes&&o.dispatchEvent({type:"planesdetected",data:Ee}),I=null}const Ae=new YY;Ae.setAnimationLoop(pe),this.setAnimationLoop=function(ae){le=ae},this.dispose=function(){}}}function Qwe(n,e){function a(D,L){D.matrixAutoUpdate===!0&&D.updateMatrix(),L.value.copy(D.matrix)}function o(D,L){L.color.getRGB(D.fogColor.value,$Y(n)),L.isFog?(D.fogNear.value=L.near,D.fogFar.value=L.far):L.isFogExp2&&(D.fogDensity.value=L.density)}function s(D,L,O,F,B){L.isMeshBasicMaterial||L.isMeshLambertMaterial?c(D,L):L.isMeshToonMaterial?(c(D,L),x(D,L)):L.isMeshPhongMaterial?(c(D,L),_(D,L)):L.isMeshStandardMaterial?(c(D,L),S(D,L),L.isMeshPhysicalMaterial&&T(D,L,B)):L.isMeshMatcapMaterial?(c(D,L),I(D,L)):L.isMeshDepthMaterial?c(D,L):L.isMeshDistanceMaterial?(c(D,L),k(D,L)):L.isMeshNormalMaterial?c(D,L):L.isLineBasicMaterial?(d(D,L),L.isLineDashedMaterial&&f(D,L)):L.isPointsMaterial?m(D,L,O,F):L.isSpriteMaterial?y(D,L):L.isShadowMaterial?(D.color.value.copy(L.color),D.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}function c(D,L){D.opacity.value=L.opacity,L.color&&D.diffuse.value.copy(L.color),L.emissive&&D.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(D.map.value=L.map,a(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.bumpMap&&(D.bumpMap.value=L.bumpMap,a(L.bumpMap,D.bumpMapTransform),D.bumpScale.value=L.bumpScale,L.side===Ss&&(D.bumpScale.value*=-1)),L.normalMap&&(D.normalMap.value=L.normalMap,a(L.normalMap,D.normalMapTransform),D.normalScale.value.copy(L.normalScale),L.side===Ss&&D.normalScale.value.negate()),L.displacementMap&&(D.displacementMap.value=L.displacementMap,a(L.displacementMap,D.displacementMapTransform),D.displacementScale.value=L.displacementScale,D.displacementBias.value=L.displacementBias),L.emissiveMap&&(D.emissiveMap.value=L.emissiveMap,a(L.emissiveMap,D.emissiveMapTransform)),L.specularMap&&(D.specularMap.value=L.specularMap,a(L.specularMap,D.specularMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest);const O=e.get(L).envMap;if(O&&(D.envMap.value=O,D.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,D.reflectivity.value=L.reflectivity,D.ior.value=L.ior,D.refractionRatio.value=L.refractionRatio),L.lightMap){D.lightMap.value=L.lightMap;const F=n._useLegacyLights===!0?Math.PI:1;D.lightMapIntensity.value=L.lightMapIntensity*F,a(L.lightMap,D.lightMapTransform)}L.aoMap&&(D.aoMap.value=L.aoMap,D.aoMapIntensity.value=L.aoMapIntensity,a(L.aoMap,D.aoMapTransform))}function d(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,L.map&&(D.map.value=L.map,a(L.map,D.mapTransform))}function f(D,L){D.dashSize.value=L.dashSize,D.totalSize.value=L.dashSize+L.gapSize,D.scale.value=L.scale}function m(D,L,O,F){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.size.value=L.size*O,D.scale.value=F*.5,L.map&&(D.map.value=L.map,a(L.map,D.uvTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function y(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.rotation.value=L.rotation,L.map&&(D.map.value=L.map,a(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,a(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function _(D,L){D.specular.value.copy(L.specular),D.shininess.value=Math.max(L.shininess,1e-4)}function x(D,L){L.gradientMap&&(D.gradientMap.value=L.gradientMap)}function S(D,L){D.metalness.value=L.metalness,L.metalnessMap&&(D.metalnessMap.value=L.metalnessMap,a(L.metalnessMap,D.metalnessMapTransform)),D.roughness.value=L.roughness,L.roughnessMap&&(D.roughnessMap.value=L.roughnessMap,a(L.roughnessMap,D.roughnessMapTransform)),e.get(L).envMap&&(D.envMapIntensity.value=L.envMapIntensity)}function T(D,L,O){D.ior.value=L.ior,L.sheen>0&&(D.sheenColor.value.copy(L.sheenColor).multiplyScalar(L.sheen),D.sheenRoughness.value=L.sheenRoughness,L.sheenColorMap&&(D.sheenColorMap.value=L.sheenColorMap,a(L.sheenColorMap,D.sheenColorMapTransform)),L.sheenRoughnessMap&&(D.sheenRoughnessMap.value=L.sheenRoughnessMap,a(L.sheenRoughnessMap,D.sheenRoughnessMapTransform))),L.clearcoat>0&&(D.clearcoat.value=L.clearcoat,D.clearcoatRoughness.value=L.clearcoatRoughness,L.clearcoatMap&&(D.clearcoatMap.value=L.clearcoatMap,a(L.clearcoatMap,D.clearcoatMapTransform)),L.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap,a(L.clearcoatRoughnessMap,D.clearcoatRoughnessMapTransform)),L.clearcoatNormalMap&&(D.clearcoatNormalMap.value=L.clearcoatNormalMap,a(L.clearcoatNormalMap,D.clearcoatNormalMapTransform),D.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),L.side===Ss&&D.clearcoatNormalScale.value.negate())),L.iridescence>0&&(D.iridescence.value=L.iridescence,D.iridescenceIOR.value=L.iridescenceIOR,D.iridescenceThicknessMinimum.value=L.iridescenceThicknessRange[0],D.iridescenceThicknessMaximum.value=L.iridescenceThicknessRange[1],L.iridescenceMap&&(D.iridescenceMap.value=L.iridescenceMap,a(L.iridescenceMap,D.iridescenceMapTransform)),L.iridescenceThicknessMap&&(D.iridescenceThicknessMap.value=L.iridescenceThicknessMap,a(L.iridescenceThicknessMap,D.iridescenceThicknessMapTransform))),L.transmission>0&&(D.transmission.value=L.transmission,D.transmissionSamplerMap.value=O.texture,D.transmissionSamplerSize.value.set(O.width,O.height),L.transmissionMap&&(D.transmissionMap.value=L.transmissionMap,a(L.transmissionMap,D.transmissionMapTransform)),D.thickness.value=L.thickness,L.thicknessMap&&(D.thicknessMap.value=L.thicknessMap,a(L.thicknessMap,D.thicknessMapTransform)),D.attenuationDistance.value=L.attenuationDistance,D.attenuationColor.value.copy(L.attenuationColor)),L.anisotropy>0&&(D.anisotropyVector.value.set(L.anisotropy*Math.cos(L.anisotropyRotation),L.anisotropy*Math.sin(L.anisotropyRotation)),L.anisotropyMap&&(D.anisotropyMap.value=L.anisotropyMap,a(L.anisotropyMap,D.anisotropyMapTransform))),D.specularIntensity.value=L.specularIntensity,D.specularColor.value.copy(L.specularColor),L.specularColorMap&&(D.specularColorMap.value=L.specularColorMap,a(L.specularColorMap,D.specularColorMapTransform)),L.specularIntensityMap&&(D.specularIntensityMap.value=L.specularIntensityMap,a(L.specularIntensityMap,D.specularIntensityMapTransform))}function I(D,L){L.matcap&&(D.matcap.value=L.matcap)}function k(D,L){const O=e.get(L).light;D.referencePosition.value.setFromMatrixPosition(O.matrixWorld),D.nearDistance.value=O.shadow.camera.near,D.farDistance.value=O.shadow.camera.far}return{refreshFogUniforms:o,refreshMaterialUniforms:s}}function e2e(n,e,a,o){let s={},c={},d=[];const f=a.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function m(O,F){const B=F.program;o.uniformBlockBinding(O,B)}function y(O,F){let B=s[O.id];B===void 0&&(I(O),B=_(O),s[O.id]=B,O.addEventListener("dispose",D));const G=F.program;o.updateUBOMapping(O,G);const q=e.render.frame;c[O.id]!==q&&(S(O),c[O.id]=q)}function _(O){const F=x();O.__bindingPointIndex=F;const B=n.createBuffer(),G=O.__size,q=O.usage;return n.bindBuffer(n.UNIFORM_BUFFER,B),n.bufferData(n.UNIFORM_BUFFER,G,q),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,F,B),B}function x(){for(let O=0;O<f;O++)if(d.indexOf(O)===-1)return d.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S(O){const F=s[O.id],B=O.uniforms,G=O.__cache;n.bindBuffer(n.UNIFORM_BUFFER,F);for(let q=0,X=B.length;q<X;q++){const te=B[q];if(T(te,q,G)===!0){const V=te.__offset,Q=Array.isArray(te.value)?te.value:[te.value];let ge=0;for(let me=0;me<Q.length;me++){const be=Q[me],fe=k(be);typeof be=="number"?(te.__data[0]=be,n.bufferSubData(n.UNIFORM_BUFFER,V+ge,te.__data)):be.isMatrix3?(te.__data[0]=be.elements[0],te.__data[1]=be.elements[1],te.__data[2]=be.elements[2],te.__data[3]=be.elements[0],te.__data[4]=be.elements[3],te.__data[5]=be.elements[4],te.__data[6]=be.elements[5],te.__data[7]=be.elements[0],te.__data[8]=be.elements[6],te.__data[9]=be.elements[7],te.__data[10]=be.elements[8],te.__data[11]=be.elements[0]):(be.toArray(te.__data,ge),ge+=fe.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,V,te.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function T(O,F,B){const G=O.value;if(B[F]===void 0){if(typeof G=="number")B[F]=G;else{const q=Array.isArray(G)?G:[G],X=[];for(let te=0;te<q.length;te++)X.push(q[te].clone());B[F]=X}return!0}else if(typeof G=="number"){if(B[F]!==G)return B[F]=G,!0}else{const q=Array.isArray(B[F])?B[F]:[B[F]],X=Array.isArray(G)?G:[G];for(let te=0;te<q.length;te++){const V=q[te];if(V.equals(X[te])===!1)return V.copy(X[te]),!0}}return!1}function I(O){const F=O.uniforms;let B=0;const G=16;let q=0;for(let X=0,te=F.length;X<te;X++){const V=F[X],Q={boundary:0,storage:0},ge=Array.isArray(V.value)?V.value:[V.value];for(let me=0,be=ge.length;me<be;me++){const fe=ge[me],Ce=k(fe);Q.boundary+=Ce.boundary,Q.storage+=Ce.storage}if(V.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=B,X>0){q=B%G;const me=G-q;q!==0&&me-Q.boundary<0&&(B+=G-q,V.__offset=B)}B+=Q.storage}return q=B%G,q>0&&(B+=G-q),O.__size=B,O.__cache={},this}function k(O){const F={boundary:0,storage:0};return typeof O=="number"?(F.boundary=4,F.storage=4):O.isVector2?(F.boundary=8,F.storage=8):O.isVector3||O.isColor?(F.boundary=16,F.storage=12):O.isVector4?(F.boundary=16,F.storage=16):O.isMatrix3?(F.boundary=48,F.storage=48):O.isMatrix4?(F.boundary=64,F.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),F}function D(O){const F=O.target;F.removeEventListener("dispose",D);const B=d.indexOf(F.__bindingPointIndex);d.splice(B,1),n.deleteBuffer(s[F.id]),delete s[F.id],delete c[F.id]}function L(){for(const O in s)n.deleteBuffer(s[O]);d=[],s={},c={}}return{bind:m,update:y,dispose:L}}class c6{constructor(e={}){const{canvas:a=GY(),context:o=null,depth:s=!0,stencil:c=!0,alpha:d=!1,antialias:f=!1,premultipliedAlpha:m=!0,preserveDrawingBuffer:y=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:x=!1}=e;this.isWebGLRenderer=!0;let S;o!==null?S=o.getContextAttributes().alpha:S=d;const T=new Uint32Array(4),I=new Int32Array(4);let k=null,D=null;const L=[],O=[];this.domElement=a,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Io,this._useLegacyLights=!1,this.toneMapping=hd,this.toneMappingExposure=1;const F=this;let B=!1,G=0,q=0,X=null,te=-1,V=null;const Q=new Ei,ge=new Ei;let me=null;const be=new Pn(0);let fe=0,Ce=a.width,Le=a.height,Ge=1,le=null,pe=null;const Ae=new Ei(0,0,Ce,Le),ae=new Ei(0,0,Ce,Le);let Ee=!1;const Ze=new OT;let Xe=!1,Ke=!1,Ue=null;const ft=new Ia,Rt=new Kt,kt=new Fe,Jt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function It(){return X===null?Ge:1}let Pe=o;function pt(Re,bt){for(let Dt=0;Dt<Re.length;Dt++){const Ct=Re[Dt],zt=a.getContext(Ct,bt);if(zt!==null)return zt}return null}try{const Re={alpha:!0,depth:s,stencil:c,antialias:f,premultipliedAlpha:m,preserveDrawingBuffer:y,powerPreference:_,failIfMajorPerformanceCaveat:x};if("setAttribute"in a&&a.setAttribute("data-engine",`three.js r${CT}`),a.addEventListener("webglcontextlost",fn,!1),a.addEventListener("webglcontextrestored",_e,!1),a.addEventListener("webglcontextcreationerror",Ye,!1),Pe===null){const bt=["webgl2","webgl","experimental-webgl"];if(F.isWebGL1Renderer===!0&&bt.shift(),Pe=pt(bt,Re),Pe===null)throw pt(bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Pe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Pe.getShaderPrecisionFormat===void 0&&(Pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Re){throw console.error("THREE.WebGLRenderer: "+Re.message),Re}let yt,At,Be,ue,se,ve,$e,De,st,de,ne,Oe,mt,ot,lt,Et,Ut,Vt,$t,Nt,St,Zt,He,Lt;function qt(){yt=new mxe(Pe),At=new cxe(Pe,yt,e),yt.init(At),Zt=new eZ(Pe,yt,At),Be=new Ywe(Pe,yt,At),ue=new vxe(Pe),se=new Fwe,ve=new Zwe(Pe,yt,Be,se,At,Zt,ue),$e=new dxe(F),De=new pxe(F),st=new C_e(Pe,At),He=new sxe(Pe,yt,st,At),de=new gxe(Pe,st,ue,He),ne=new wxe(Pe,de,st,ue),$t=new xxe(Pe,At,ve),Et=new uxe(se),Oe=new zwe(F,$e,De,yt,At,He,Et),mt=new Qwe(F,se),ot=new Bwe,lt=new jwe(yt,At),Vt=new oxe(F,$e,De,Be,ne,S,m),Ut=new Xwe(F,ne,At),Lt=new e2e(Pe,ue,At,Be),Nt=new lxe(Pe,yt,ue,At),St=new yxe(Pe,yt,ue,At),ue.programs=Oe.programs,F.capabilities=At,F.extensions=yt,F.properties=se,F.renderLists=ot,F.shadowMap=Ut,F.state=Be,F.info=ue}qt();const Ot=new Jwe(F,Pe);this.xr=Ot,this.getContext=function(){return Pe},this.getContextAttributes=function(){return Pe.getContextAttributes()},this.forceContextLoss=function(){const Re=yt.get("WEBGL_lose_context");Re&&Re.loseContext()},this.forceContextRestore=function(){const Re=yt.get("WEBGL_lose_context");Re&&Re.restoreContext()},this.getPixelRatio=function(){return Ge},this.setPixelRatio=function(Re){Re!==void 0&&(Ge=Re,this.setSize(Ce,Le,!1))},this.getSize=function(Re){return Re.set(Ce,Le)},this.setSize=function(Re,bt,Dt=!0){if(Ot.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ce=Re,Le=bt,a.width=Math.floor(Re*Ge),a.height=Math.floor(bt*Ge),Dt===!0&&(a.style.width=Re+"px",a.style.height=bt+"px"),this.setViewport(0,0,Re,bt)},this.getDrawingBufferSize=function(Re){return Re.set(Ce*Ge,Le*Ge).floor()},this.setDrawingBufferSize=function(Re,bt,Dt){Ce=Re,Le=bt,Ge=Dt,a.width=Math.floor(Re*Dt),a.height=Math.floor(bt*Dt),this.setViewport(0,0,Re,bt)},this.getCurrentViewport=function(Re){return Re.copy(Q)},this.getViewport=function(Re){return Re.copy(Ae)},this.setViewport=function(Re,bt,Dt,Ct){Re.isVector4?Ae.set(Re.x,Re.y,Re.z,Re.w):Ae.set(Re,bt,Dt,Ct),Be.viewport(Q.copy(Ae).multiplyScalar(Ge).floor())},this.getScissor=function(Re){return Re.copy(ae)},this.setScissor=function(Re,bt,Dt,Ct){Re.isVector4?ae.set(Re.x,Re.y,Re.z,Re.w):ae.set(Re,bt,Dt,Ct),Be.scissor(ge.copy(ae).multiplyScalar(Ge).floor())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(Re){Be.setScissorTest(Ee=Re)},this.setOpaqueSort=function(Re){le=Re},this.setTransparentSort=function(Re){pe=Re},this.getClearColor=function(Re){return Re.copy(Vt.getClearColor())},this.setClearColor=function(){Vt.setClearColor.apply(Vt,arguments)},this.getClearAlpha=function(){return Vt.getClearAlpha()},this.setClearAlpha=function(){Vt.setClearAlpha.apply(Vt,arguments)},this.clear=function(Re=!0,bt=!0,Dt=!0){let Ct=0;if(Re){let zt=!1;if(X!==null){const ln=X.texture.format;zt=ln===JD||ln===KD||ln===ZD}if(zt){const ln=X.texture.type,Tn=ln===fd||ln===Ah||ln===LT||ln===up||ln===XD||ln===YD,qn=Vt.getClearColor(),an=Vt.getClearAlpha(),sa=qn.r,pa=qn.g,ia=qn.b;Tn?(T[0]=sa,T[1]=pa,T[2]=ia,T[3]=an,Pe.clearBufferuiv(Pe.COLOR,0,T)):(I[0]=sa,I[1]=pa,I[2]=ia,I[3]=an,Pe.clearBufferiv(Pe.COLOR,0,I))}else Ct|=Pe.COLOR_BUFFER_BIT}bt&&(Ct|=Pe.DEPTH_BUFFER_BIT),Dt&&(Ct|=Pe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Pe.clear(Ct)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){a.removeEventListener("webglcontextlost",fn,!1),a.removeEventListener("webglcontextrestored",_e,!1),a.removeEventListener("webglcontextcreationerror",Ye,!1),ot.dispose(),lt.dispose(),se.dispose(),$e.dispose(),De.dispose(),ne.dispose(),He.dispose(),Lt.dispose(),Oe.dispose(),Ot.dispose(),Ot.removeEventListener("sessionstart",dt),Ot.removeEventListener("sessionend",ut),Ue&&(Ue.dispose(),Ue=null),Gt.stop()};function fn(Re){Re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),B=!0}function _e(){console.log("THREE.WebGLRenderer: Context Restored."),B=!1;const Re=ue.autoReset,bt=Ut.enabled,Dt=Ut.autoUpdate,Ct=Ut.needsUpdate,zt=Ut.type;qt(),ue.autoReset=Re,Ut.enabled=bt,Ut.autoUpdate=Dt,Ut.needsUpdate=Ct,Ut.type=zt}function Ye(Re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Re.statusMessage)}function Se(Re){const bt=Re.target;bt.removeEventListener("dispose",Se),Me(bt)}function Me(Re){ze(Re),se.remove(Re)}function ze(Re){const bt=se.get(Re).programs;bt!==void 0&&(bt.forEach(function(Dt){Oe.releaseProgram(Dt)}),Re.isShaderMaterial&&Oe.releaseShaderCache(Re))}this.renderBufferDirect=function(Re,bt,Dt,Ct,zt,ln){bt===null&&(bt=Jt);const Tn=zt.isMesh&&zt.matrixWorld.determinant()<0,qn=Ta(Re,bt,Dt,Ct,zt);Be.setMaterial(Ct,Tn);let an=Dt.index,sa=1;if(Ct.wireframe===!0){if(an=de.getWireframeAttribute(Dt),an===void 0)return;sa=2}const pa=Dt.drawRange,ia=Dt.attributes.position;let ai=pa.start*sa,xr=(pa.start+pa.count)*sa;ln!==null&&(ai=Math.max(ai,ln.start*sa),xr=Math.min(xr,(ln.start+ln.count)*sa)),an!==null?(ai=Math.max(ai,0),xr=Math.min(xr,an.count)):ia!=null&&(ai=Math.max(ai,0),xr=Math.min(xr,ia.count));const ti=xr-ai;if(ti<0||ti===1/0)return;He.setup(zt,Ct,qn,Dt,an);let Yi,ta=Nt;if(an!==null&&(Yi=st.get(an),ta=St,ta.setIndex(Yi)),zt.isMesh)Ct.wireframe===!0?(Be.setLineWidth(Ct.wireframeLinewidth*It()),ta.setMode(Pe.LINES)):ta.setMode(Pe.TRIANGLES);else if(zt.isLine){let Rn=Ct.linewidth;Rn===void 0&&(Rn=1),Be.setLineWidth(Rn*It()),zt.isLineSegments?ta.setMode(Pe.LINES):zt.isLineLoop?ta.setMode(Pe.LINE_LOOP):ta.setMode(Pe.LINE_STRIP)}else zt.isPoints?ta.setMode(Pe.POINTS):zt.isSprite&&ta.setMode(Pe.TRIANGLES);if(zt.isInstancedMesh)ta.renderInstances(ai,ti,zt.count);else if(Dt.isInstancedBufferGeometry){const Rn=Dt._maxInstanceCount!==void 0?Dt._maxInstanceCount:1/0,ho=Math.min(Dt.instanceCount,Rn);ta.renderInstances(ai,ti,ho)}else ta.render(ai,ti)};function Qe(Re,bt,Dt){Re.transparent===!0&&Re.side===Hl&&Re.forceSinglePass===!1?(Re.side=Ss,Re.needsUpdate=!0,Hn(Re,bt,Dt),Re.side=yd,Re.needsUpdate=!0,Hn(Re,bt,Dt),Re.side=Hl):Hn(Re,bt,Dt)}this.compile=function(Re,bt,Dt=null){Dt===null&&(Dt=Re),D=lt.get(Dt),D.init(),O.push(D),Dt.traverseVisible(function(zt){zt.isLight&&zt.layers.test(bt.layers)&&(D.pushLight(zt),zt.castShadow&&D.pushShadow(zt))}),Re!==Dt&&Re.traverseVisible(function(zt){zt.isLight&&zt.layers.test(bt.layers)&&(D.pushLight(zt),zt.castShadow&&D.pushShadow(zt))}),D.setupLights(F._useLegacyLights);const Ct=new Set;return Re.traverse(function(zt){const ln=zt.material;if(ln)if(Array.isArray(ln))for(let Tn=0;Tn<ln.length;Tn++){const qn=ln[Tn];Qe(qn,Dt,zt),Ct.add(qn)}else Qe(ln,Dt,zt),Ct.add(ln)}),O.pop(),D=null,Ct},this.compileAsync=function(Re,bt,Dt=null){const Ct=this.compile(Re,bt,Dt);return new Promise(zt=>{function ln(){if(Ct.forEach(function(Tn){se.get(Tn).currentProgram.isReady()&&Ct.delete(Tn)}),Ct.size===0){zt(Re);return}setTimeout(ln,10)}yt.get("KHR_parallel_shader_compile")!==null?ln():setTimeout(ln,10)})};let tt=null;function vt(Re){tt&&tt(Re)}function dt(){Gt.stop()}function ut(){Gt.start()}const Gt=new YY;Gt.setAnimationLoop(vt),typeof self<"u"&&Gt.setContext(self),this.setAnimationLoop=function(Re){tt=Re,Ot.setAnimationLoop(Re),Re===null?Gt.stop():Gt.start()},Ot.addEventListener("sessionstart",dt),Ot.addEventListener("sessionend",ut),this.render=function(Re,bt){if(bt!==void 0&&bt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;Re.matrixWorldAutoUpdate===!0&&Re.updateMatrixWorld(),bt.parent===null&&bt.matrixWorldAutoUpdate===!0&&bt.updateMatrixWorld(),Ot.enabled===!0&&Ot.isPresenting===!0&&(Ot.cameraAutoUpdate===!0&&Ot.updateCamera(bt),bt=Ot.getCamera()),Re.isScene===!0&&Re.onBeforeRender(F,Re,bt,X),D=lt.get(Re,O.length),D.init(),O.push(D),ft.multiplyMatrices(bt.projectionMatrix,bt.matrixWorldInverse),Ze.setFromProjectionMatrix(ft),Ke=this.localClippingEnabled,Xe=Et.init(this.clippingPlanes,Ke),k=ot.get(Re,L.length),k.init(),L.push(k),Tt(Re,bt,0,F.sortObjects),k.finish(),F.sortObjects===!0&&k.sort(le,pe),this.info.render.frame++,Xe===!0&&Et.beginShadows();const Dt=D.state.shadowsArray;if(Ut.render(Dt,Re,bt),Xe===!0&&Et.endShadows(),this.info.autoReset===!0&&this.info.reset(),Vt.render(k,Re),D.setupLights(F._useLegacyLights),bt.isArrayCamera){const Ct=bt.cameras;for(let zt=0,ln=Ct.length;zt<ln;zt++){const Tn=Ct[zt];Qt(k,Re,Tn,Tn.viewport)}}else Qt(k,Re,bt);X!==null&&(ve.updateMultisampleRenderTarget(X),ve.updateRenderTargetMipmap(X)),Re.isScene===!0&&Re.onAfterRender(F,Re,bt),He.resetDefaultState(),te=-1,V=null,O.pop(),O.length>0?D=O[O.length-1]:D=null,L.pop(),L.length>0?k=L[L.length-1]:k=null};function Tt(Re,bt,Dt,Ct){if(Re.visible===!1)return;if(Re.layers.test(bt.layers)){if(Re.isGroup)Dt=Re.renderOrder;else if(Re.isLOD)Re.autoUpdate===!0&&Re.update(bt);else if(Re.isLight)D.pushLight(Re),Re.castShadow&&D.pushShadow(Re);else if(Re.isSprite){if(!Re.frustumCulled||Ze.intersectsSprite(Re)){Ct&&kt.setFromMatrixPosition(Re.matrixWorld).applyMatrix4(ft);const Tn=ne.update(Re),qn=Re.material;qn.visible&&k.push(Re,Tn,qn,Dt,kt.z,null)}}else if((Re.isMesh||Re.isLine||Re.isPoints)&&(!Re.frustumCulled||Ze.intersectsObject(Re))){const Tn=ne.update(Re),qn=Re.material;if(Ct&&(Re.boundingSphere!==void 0?(Re.boundingSphere===null&&Re.computeBoundingSphere(),kt.copy(Re.boundingSphere.center)):(Tn.boundingSphere===null&&Tn.computeBoundingSphere(),kt.copy(Tn.boundingSphere.center)),kt.applyMatrix4(Re.matrixWorld).applyMatrix4(ft)),Array.isArray(qn)){const an=Tn.groups;for(let sa=0,pa=an.length;sa<pa;sa++){const ia=an[sa],ai=qn[ia.materialIndex];ai&&ai.visible&&k.push(Re,Tn,ai,Dt,kt.z,ia)}}else qn.visible&&k.push(Re,Tn,qn,Dt,kt.z,null)}}const ln=Re.children;for(let Tn=0,qn=ln.length;Tn<qn;Tn++)Tt(ln[Tn],bt,Dt,Ct)}function Qt(Re,bt,Dt,Ct){const zt=Re.opaque,ln=Re.transmissive,Tn=Re.transparent;D.setupLightsView(Dt),Xe===!0&&Et.setGlobalState(F.clippingPlanes,Dt),ln.length>0&&mn(zt,ln,bt,Dt),Ct&&Be.viewport(Q.copy(Ct)),zt.length>0&&nn(zt,bt,Dt),ln.length>0&&nn(ln,bt,Dt),Tn.length>0&&nn(Tn,bt,Dt),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1)}function mn(Re,bt,Dt,Ct){if((Dt.isScene===!0?Dt.overrideMaterial:null)!==null)return;const ln=At.isWebGL2;Ue===null&&(Ue=new pu(1,1,{generateMipmaps:!0,type:yt.has("EXT_color_buffer_half_float")?t_:fd,minFilter:_p,samples:ln?4:0})),F.getDrawingBufferSize(Rt),ln?Ue.setSize(Rt.x,Rt.y):Ue.setSize(QE(Rt.x),QE(Rt.y));const Tn=F.getRenderTarget();F.setRenderTarget(Ue),F.getClearColor(be),fe=F.getClearAlpha(),fe<1&&F.setClearColor(16777215,.5),F.clear();const qn=F.toneMapping;F.toneMapping=hd,nn(Re,Dt,Ct),ve.updateMultisampleRenderTarget(Ue),ve.updateRenderTargetMipmap(Ue);let an=!1;for(let sa=0,pa=bt.length;sa<pa;sa++){const ia=bt[sa],ai=ia.object,xr=ia.geometry,ti=ia.material,Yi=ia.group;if(ti.side===Hl&&ai.layers.test(Ct.layers)){const ta=ti.side;ti.side=Ss,ti.needsUpdate=!0,wn(ai,Dt,Ct,xr,ti,Yi),ti.side=ta,ti.needsUpdate=!0,an=!0}}an===!0&&(ve.updateMultisampleRenderTarget(Ue),ve.updateRenderTargetMipmap(Ue)),F.setRenderTarget(Tn),F.setClearColor(be,fe),F.toneMapping=qn}function nn(Re,bt,Dt){const Ct=bt.isScene===!0?bt.overrideMaterial:null;for(let zt=0,ln=Re.length;zt<ln;zt++){const Tn=Re[zt],qn=Tn.object,an=Tn.geometry,sa=Ct===null?Tn.material:Ct,pa=Tn.group;qn.layers.test(Dt.layers)&&wn(qn,bt,Dt,an,sa,pa)}}function wn(Re,bt,Dt,Ct,zt,ln){Re.onBeforeRender(F,bt,Dt,Ct,zt,ln),Re.modelViewMatrix.multiplyMatrices(Dt.matrixWorldInverse,Re.matrixWorld),Re.normalMatrix.getNormalMatrix(Re.modelViewMatrix),zt.onBeforeRender(F,bt,Dt,Ct,Re,ln),zt.transparent===!0&&zt.side===Hl&&zt.forceSinglePass===!1?(zt.side=Ss,zt.needsUpdate=!0,F.renderBufferDirect(Dt,bt,Ct,zt,Re,ln),zt.side=yd,zt.needsUpdate=!0,F.renderBufferDirect(Dt,bt,Ct,zt,Re,ln),zt.side=Hl):F.renderBufferDirect(Dt,bt,Ct,zt,Re,ln),Re.onAfterRender(F,bt,Dt,Ct,zt,ln)}function Hn(Re,bt,Dt){bt.isScene!==!0&&(bt=Jt);const Ct=se.get(Re),zt=D.state.lights,ln=D.state.shadowsArray,Tn=zt.state.version,qn=Oe.getParameters(Re,zt.state,ln,bt,Dt),an=Oe.getProgramCacheKey(qn);let sa=Ct.programs;Ct.environment=Re.isMeshStandardMaterial?bt.environment:null,Ct.fog=bt.fog,Ct.envMap=(Re.isMeshStandardMaterial?De:$e).get(Re.envMap||Ct.environment),sa===void 0&&(Re.addEventListener("dispose",Se),sa=new Map,Ct.programs=sa);let pa=sa.get(an);if(pa!==void 0){if(Ct.currentProgram===pa&&Ct.lightsStateVersion===Tn)return Pa(Re,qn),pa}else qn.uniforms=Oe.getUniforms(Re),Re.onBuild(Dt,qn,F),Re.onBeforeCompile(qn,F),pa=Oe.acquireProgram(qn,an),sa.set(an,pa),Ct.uniforms=qn.uniforms;const ia=Ct.uniforms;return(!Re.isShaderMaterial&&!Re.isRawShaderMaterial||Re.clipping===!0)&&(ia.clippingPlanes=Et.uniform),Pa(Re,qn),Ct.needsLights=mi(Re),Ct.lightsStateVersion=Tn,Ct.needsLights&&(ia.ambientLightColor.value=zt.state.ambient,ia.lightProbe.value=zt.state.probe,ia.directionalLights.value=zt.state.directional,ia.directionalLightShadows.value=zt.state.directionalShadow,ia.spotLights.value=zt.state.spot,ia.spotLightShadows.value=zt.state.spotShadow,ia.rectAreaLights.value=zt.state.rectArea,ia.ltc_1.value=zt.state.rectAreaLTC1,ia.ltc_2.value=zt.state.rectAreaLTC2,ia.pointLights.value=zt.state.point,ia.pointLightShadows.value=zt.state.pointShadow,ia.hemisphereLights.value=zt.state.hemi,ia.directionalShadowMap.value=zt.state.directionalShadowMap,ia.directionalShadowMatrix.value=zt.state.directionalShadowMatrix,ia.spotShadowMap.value=zt.state.spotShadowMap,ia.spotLightMatrix.value=zt.state.spotLightMatrix,ia.spotLightMap.value=zt.state.spotLightMap,ia.pointShadowMap.value=zt.state.pointShadowMap,ia.pointShadowMatrix.value=zt.state.pointShadowMatrix),Ct.currentProgram=pa,Ct.uniformsList=null,pa}function fa(Re){if(Re.uniformsList===null){const bt=Re.currentProgram.getUniforms();Re.uniformsList=eE.seqWithValue(bt.seq,Re.uniforms)}return Re.uniformsList}function Pa(Re,bt){const Dt=se.get(Re);Dt.outputColorSpace=bt.outputColorSpace,Dt.instancing=bt.instancing,Dt.instancingColor=bt.instancingColor,Dt.skinning=bt.skinning,Dt.morphTargets=bt.morphTargets,Dt.morphNormals=bt.morphNormals,Dt.morphColors=bt.morphColors,Dt.morphTargetsCount=bt.morphTargetsCount,Dt.numClippingPlanes=bt.numClippingPlanes,Dt.numIntersection=bt.numClipIntersection,Dt.vertexAlphas=bt.vertexAlphas,Dt.vertexTangents=bt.vertexTangents,Dt.toneMapping=bt.toneMapping}function Ta(Re,bt,Dt,Ct,zt){bt.isScene!==!0&&(bt=Jt),ve.resetTextureUnits();const ln=bt.fog,Tn=Ct.isMeshStandardMaterial?bt.environment:null,qn=X===null?F.outputColorSpace:X.isXRRenderTarget===!0?X.texture.colorSpace:vd,an=(Ct.isMeshStandardMaterial?De:$e).get(Ct.envMap||Tn),sa=Ct.vertexColors===!0&&!!Dt.attributes.color&&Dt.attributes.color.itemSize===4,pa=!!Dt.attributes.tangent&&(!!Ct.normalMap||Ct.anisotropy>0),ia=!!Dt.morphAttributes.position,ai=!!Dt.morphAttributes.normal,xr=!!Dt.morphAttributes.color;let ti=hd;Ct.toneMapped&&(X===null||X.isXRRenderTarget===!0)&&(ti=F.toneMapping);const Yi=Dt.morphAttributes.position||Dt.morphAttributes.normal||Dt.morphAttributes.color,ta=Yi!==void 0?Yi.length:0,Rn=se.get(Ct),ho=D.state.lights;if(Xe===!0&&(Ke===!0||Re!==V)){const Zn=Re===V&&Ct.id===te;Et.setState(Ct,Re,Zn)}let Ra=!1;Ct.version===Rn.__version?(Rn.needsLights&&Rn.lightsStateVersion!==ho.state.version||Rn.outputColorSpace!==qn||zt.isInstancedMesh&&Rn.instancing===!1||!zt.isInstancedMesh&&Rn.instancing===!0||zt.isSkinnedMesh&&Rn.skinning===!1||!zt.isSkinnedMesh&&Rn.skinning===!0||zt.isInstancedMesh&&Rn.instancingColor===!0&&zt.instanceColor===null||zt.isInstancedMesh&&Rn.instancingColor===!1&&zt.instanceColor!==null||Rn.envMap!==an||Ct.fog===!0&&Rn.fog!==ln||Rn.numClippingPlanes!==void 0&&(Rn.numClippingPlanes!==Et.numPlanes||Rn.numIntersection!==Et.numIntersection)||Rn.vertexAlphas!==sa||Rn.vertexTangents!==pa||Rn.morphTargets!==ia||Rn.morphNormals!==ai||Rn.morphColors!==xr||Rn.toneMapping!==ti||At.isWebGL2===!0&&Rn.morphTargetsCount!==ta)&&(Ra=!0):(Ra=!0,Rn.__version=Ct.version);let Mi=Rn.currentProgram;Ra===!0&&(Mi=Hn(Ct,bt,zt));let Ho=!1,wr=!1,Zi=!1;const ui=Mi.getUniforms(),zr=Rn.uniforms;if(Be.useProgram(Mi.program)&&(Ho=!0,wr=!0,Zi=!0),Ct.id!==te&&(te=Ct.id,wr=!0),Ho||V!==Re){ui.setValue(Pe,"projectionMatrix",Re.projectionMatrix),ui.setValue(Pe,"viewMatrix",Re.matrixWorldInverse);const Zn=ui.map.cameraPosition;Zn!==void 0&&Zn.setValue(Pe,kt.setFromMatrixPosition(Re.matrixWorld)),At.logarithmicDepthBuffer&&ui.setValue(Pe,"logDepthBufFC",2/(Math.log(Re.far+1)/Math.LN2)),(Ct.isMeshPhongMaterial||Ct.isMeshToonMaterial||Ct.isMeshLambertMaterial||Ct.isMeshBasicMaterial||Ct.isMeshStandardMaterial||Ct.isShaderMaterial)&&ui.setValue(Pe,"isOrthographic",Re.isOrthographicCamera===!0),V!==Re&&(V=Re,wr=!0,Zi=!0)}if(zt.isSkinnedMesh){ui.setOptional(Pe,zt,"bindMatrix"),ui.setOptional(Pe,zt,"bindMatrixInverse");const Zn=zt.skeleton;Zn&&(At.floatVertexTextures?(Zn.boneTexture===null&&Zn.computeBoneTexture(),ui.setValue(Pe,"boneTexture",Zn.boneTexture,ve),ui.setValue(Pe,"boneTextureSize",Zn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Cn=Dt.morphAttributes;if((Cn.position!==void 0||Cn.normal!==void 0||Cn.color!==void 0&&At.isWebGL2===!0)&&$t.update(zt,Dt,Mi),(wr||Rn.receiveShadow!==zt.receiveShadow)&&(Rn.receiveShadow=zt.receiveShadow,ui.setValue(Pe,"receiveShadow",zt.receiveShadow)),Ct.isMeshGouraudMaterial&&Ct.envMap!==null&&(zr.envMap.value=an,zr.flipEnvMap.value=an.isCubeTexture&&an.isRenderTargetTexture===!1?-1:1),wr&&(ui.setValue(Pe,"toneMappingExposure",F.toneMappingExposure),Rn.needsLights&&Li(zr,Zi),ln&&Ct.fog===!0&&mt.refreshFogUniforms(zr,ln),mt.refreshMaterialUniforms(zr,Ct,Ge,Le,Ue),eE.upload(Pe,fa(Rn),zr,ve)),Ct.isShaderMaterial&&Ct.uniformsNeedUpdate===!0&&(eE.upload(Pe,fa(Rn),zr,ve),Ct.uniformsNeedUpdate=!1),Ct.isSpriteMaterial&&ui.setValue(Pe,"center",zt.center),ui.setValue(Pe,"modelViewMatrix",zt.modelViewMatrix),ui.setValue(Pe,"normalMatrix",zt.normalMatrix),ui.setValue(Pe,"modelMatrix",zt.matrixWorld),Ct.isShaderMaterial||Ct.isRawShaderMaterial){const Zn=Ct.uniformsGroups;for(let Gi=0,Sr=Zn.length;Gi<Sr;Gi++)if(At.isWebGL2){const Ts=Zn[Gi];Lt.update(Ts,Mi),Lt.bind(Ts,Mi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Mi}function Li(Re,bt){Re.ambientLightColor.needsUpdate=bt,Re.lightProbe.needsUpdate=bt,Re.directionalLights.needsUpdate=bt,Re.directionalLightShadows.needsUpdate=bt,Re.pointLights.needsUpdate=bt,Re.pointLightShadows.needsUpdate=bt,Re.spotLights.needsUpdate=bt,Re.spotLightShadows.needsUpdate=bt,Re.rectAreaLights.needsUpdate=bt,Re.hemisphereLights.needsUpdate=bt}function mi(Re){return Re.isMeshLambertMaterial||Re.isMeshToonMaterial||Re.isMeshPhongMaterial||Re.isMeshStandardMaterial||Re.isShadowMaterial||Re.isShaderMaterial&&Re.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return q},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(Re,bt,Dt){se.get(Re.texture).__webglTexture=bt,se.get(Re.depthTexture).__webglTexture=Dt;const Ct=se.get(Re);Ct.__hasExternalTextures=!0,Ct.__hasExternalTextures&&(Ct.__autoAllocateDepthBuffer=Dt===void 0,Ct.__autoAllocateDepthBuffer||yt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Ct.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Re,bt){const Dt=se.get(Re);Dt.__webglFramebuffer=bt,Dt.__useDefaultFramebuffer=bt===void 0},this.setRenderTarget=function(Re,bt=0,Dt=0){X=Re,G=bt,q=Dt;let Ct=!0,zt=null,ln=!1,Tn=!1;if(Re){const an=se.get(Re);an.__useDefaultFramebuffer!==void 0?(Be.bindFramebuffer(Pe.FRAMEBUFFER,null),Ct=!1):an.__webglFramebuffer===void 0?ve.setupRenderTarget(Re):an.__hasExternalTextures&&ve.rebindTextures(Re,se.get(Re.texture).__webglTexture,se.get(Re.depthTexture).__webglTexture);const sa=Re.texture;(sa.isData3DTexture||sa.isDataArrayTexture||sa.isCompressedArrayTexture)&&(Tn=!0);const pa=se.get(Re).__webglFramebuffer;Re.isWebGLCubeRenderTarget?(Array.isArray(pa[bt])?zt=pa[bt][Dt]:zt=pa[bt],ln=!0):At.isWebGL2&&Re.samples>0&&ve.useMultisampledRTT(Re)===!1?zt=se.get(Re).__webglMultisampledFramebuffer:Array.isArray(pa)?zt=pa[Dt]:zt=pa,Q.copy(Re.viewport),ge.copy(Re.scissor),me=Re.scissorTest}else Q.copy(Ae).multiplyScalar(Ge).floor(),ge.copy(ae).multiplyScalar(Ge).floor(),me=Ee;if(Be.bindFramebuffer(Pe.FRAMEBUFFER,zt)&&At.drawBuffers&&Ct&&Be.drawBuffers(Re,zt),Be.viewport(Q),Be.scissor(ge),Be.setScissorTest(me),ln){const an=se.get(Re.texture);Pe.framebufferTexture2D(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,Pe.TEXTURE_CUBE_MAP_POSITIVE_X+bt,an.__webglTexture,Dt)}else if(Tn){const an=se.get(Re.texture),sa=bt||0;Pe.framebufferTextureLayer(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,an.__webglTexture,Dt||0,sa)}te=-1},this.readRenderTargetPixels=function(Re,bt,Dt,Ct,zt,ln,Tn){if(!(Re&&Re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qn=se.get(Re).__webglFramebuffer;if(Re.isWebGLCubeRenderTarget&&Tn!==void 0&&(qn=qn[Tn]),qn){Be.bindFramebuffer(Pe.FRAMEBUFFER,qn);try{const an=Re.texture,sa=an.format,pa=an.type;if(sa!==pl&&Zt.convert(sa)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ia=pa===t_&&(yt.has("EXT_color_buffer_half_float")||At.isWebGL2&&yt.has("EXT_color_buffer_float"));if(pa!==fd&&Zt.convert(pa)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_TYPE)&&!(pa===sd&&(At.isWebGL2||yt.has("OES_texture_float")||yt.has("WEBGL_color_buffer_float")))&&!ia){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}bt>=0&&bt<=Re.width-Ct&&Dt>=0&&Dt<=Re.height-zt&&Pe.readPixels(bt,Dt,Ct,zt,Zt.convert(sa),Zt.convert(pa),ln)}finally{const an=X!==null?se.get(X).__webglFramebuffer:null;Be.bindFramebuffer(Pe.FRAMEBUFFER,an)}}},this.copyFramebufferToTexture=function(Re,bt,Dt=0){const Ct=Math.pow(2,-Dt),zt=Math.floor(bt.image.width*Ct),ln=Math.floor(bt.image.height*Ct);ve.setTexture2D(bt,0),Pe.copyTexSubImage2D(Pe.TEXTURE_2D,Dt,0,0,Re.x,Re.y,zt,ln),Be.unbindTexture()},this.copyTextureToTexture=function(Re,bt,Dt,Ct=0){const zt=bt.image.width,ln=bt.image.height,Tn=Zt.convert(Dt.format),qn=Zt.convert(Dt.type);ve.setTexture2D(Dt,0),Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,Dt.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Dt.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,Dt.unpackAlignment),bt.isDataTexture?Pe.texSubImage2D(Pe.TEXTURE_2D,Ct,Re.x,Re.y,zt,ln,Tn,qn,bt.image.data):bt.isCompressedTexture?Pe.compressedTexSubImage2D(Pe.TEXTURE_2D,Ct,Re.x,Re.y,bt.mipmaps[0].width,bt.mipmaps[0].height,Tn,bt.mipmaps[0].data):Pe.texSubImage2D(Pe.TEXTURE_2D,Ct,Re.x,Re.y,Tn,qn,bt.image),Ct===0&&Dt.generateMipmaps&&Pe.generateMipmap(Pe.TEXTURE_2D),Be.unbindTexture()},this.copyTextureToTexture3D=function(Re,bt,Dt,Ct,zt=0){if(F.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const ln=Re.max.x-Re.min.x+1,Tn=Re.max.y-Re.min.y+1,qn=Re.max.z-Re.min.z+1,an=Zt.convert(Ct.format),sa=Zt.convert(Ct.type);let pa;if(Ct.isData3DTexture)ve.setTexture3D(Ct,0),pa=Pe.TEXTURE_3D;else if(Ct.isDataArrayTexture)ve.setTexture2DArray(Ct,0),pa=Pe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,Ct.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ct.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,Ct.unpackAlignment);const ia=Pe.getParameter(Pe.UNPACK_ROW_LENGTH),ai=Pe.getParameter(Pe.UNPACK_IMAGE_HEIGHT),xr=Pe.getParameter(Pe.UNPACK_SKIP_PIXELS),ti=Pe.getParameter(Pe.UNPACK_SKIP_ROWS),Yi=Pe.getParameter(Pe.UNPACK_SKIP_IMAGES),ta=Dt.isCompressedTexture?Dt.mipmaps[0]:Dt.image;Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,ta.width),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ta.height),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,Re.min.x),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,Re.min.y),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Re.min.z),Dt.isDataTexture||Dt.isData3DTexture?Pe.texSubImage3D(pa,zt,bt.x,bt.y,bt.z,ln,Tn,qn,an,sa,ta.data):Dt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Pe.compressedTexSubImage3D(pa,zt,bt.x,bt.y,bt.z,ln,Tn,qn,an,ta.data)):Pe.texSubImage3D(pa,zt,bt.x,bt.y,bt.z,ln,Tn,qn,an,sa,ta),Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,ia),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ai),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,xr),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,ti),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Yi),zt===0&&Ct.generateMipmaps&&Pe.generateMipmap(pa),Be.unbindTexture()},this.initTexture=function(Re){Re.isCubeTexture?ve.setTextureCube(Re,0):Re.isData3DTexture?ve.setTexture3D(Re,0):Re.isDataArrayTexture||Re.isCompressedArrayTexture?ve.setTexture2DArray(Re,0):ve.setTexture2D(Re,0),Be.unbindTexture()},this.resetState=function(){G=0,q=0,X=null,Be.reset(),He.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ld}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const a=this.getContext();a.drawingBufferColorSpace=e===kT?"display-p3":"srgb",a.unpackColorSpace=zi.workingColorSpace===Rw?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Io?hp:e6}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===hp?Io:vd}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class aZ extends c6{}aZ.prototype.isWebGL1Renderer=!0;class BT{constructor(e,a=25e-5){this.isFogExp2=!0,this.name="",this.color=new Pn(e),this.density=a}clone(){return new BT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class UT{constructor(e,a=1,o=1e3){this.isFog=!0,this.name="",this.color=new Pn(e),this.near=a,this.far=o}clone(){return new UT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class eM extends pi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,a){return super.copy(e,a),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const a=super.toJSON(e);return this.fog!==null&&(a.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(a.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(a.object.backgroundIntensity=this.backgroundIntensity),a}}class WT{constructor(e,a){this.isInterleavedBuffer=!0,this.array=e,this.stride=a,this.count=e!==void 0?e.length/a:0,this.usage=Xx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,a,o){e*=this.stride,o*=a.stride;for(let s=0,c=this.stride;s<c;s++)this.array[e+s]=a.array[o+s];return this}set(e,a=0){return this.array.set(e,a),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const a=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),o=new this.constructor(a,this.stride);return o.setUsage(this.usage),o}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Bs=new Fe;class Dg{constructor(e,a,o,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=a,this.offset=o,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let a=0,o=this.data.count;a<o;a++)Bs.fromBufferAttribute(this,a),Bs.applyMatrix4(e),this.setXYZ(a,Bs.x,Bs.y,Bs.z);return this}applyNormalMatrix(e){for(let a=0,o=this.count;a<o;a++)Bs.fromBufferAttribute(this,a),Bs.applyNormalMatrix(e),this.setXYZ(a,Bs.x,Bs.y,Bs.z);return this}transformDirection(e){for(let a=0,o=this.count;a<o;a++)Bs.fromBufferAttribute(this,a),Bs.transformDirection(e),this.setXYZ(a,Bs.x,Bs.y,Bs.z);return this}setX(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset]=a,this}setY(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+1]=a,this}setZ(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+2]=a,this}setW(e,a){return this.normalized&&(a=Ba(a,this.array)),this.data.array[e*this.data.stride+this.offset+3]=a,this}getX(e){let a=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(a=ml(a,this.array)),a}getY(e){let a=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(a=ml(a,this.array)),a}getZ(e){let a=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(a=ml(a,this.array)),a}getW(e){let a=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(a=ml(a,this.array)),a}setXY(e,a,o){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this}setXYZ(e,a,o,s){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this.data.array[e+2]=s,this}setXYZW(e,a,o,s,c){return e=e*this.data.stride+this.offset,this.normalized&&(a=Ba(a,this.array),o=Ba(o,this.array),s=Ba(s,this.array),c=Ba(c,this.array)),this.data.array[e+0]=a,this.data.array[e+1]=o,this.data.array[e+2]=s,this.data.array[e+3]=c,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const a=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)a.push(this.data.array[s+c])}return new Xi(new this.array.constructor(a),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Dg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const a=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let c=0;c<this.itemSize;c++)a.push(this.data.array[s+c])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:a,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class u6 extends as{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let jv;const ob=new Fe,$v=new Fe,qv=new Fe,Xv=new Kt,sb=new Kt,iZ=new Ia,kS=new Fe,lb=new Fe,DS=new Fe,$W=new Kt,G4=new Kt,qW=new Kt;class rZ extends pi{constructor(e=new u6){if(super(),this.isSprite=!0,this.type="Sprite",jv===void 0){jv=new La;const a=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new WT(a,5);jv.setIndex([0,1,2,0,2,3]),jv.setAttribute("position",new Dg(o,3,0,!1)),jv.setAttribute("uv",new Dg(o,2,3,!1))}this.geometry=jv,this.material=e,this.center=new Kt(.5,.5)}raycast(e,a){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$v.setFromMatrixScale(this.matrixWorld),iZ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),qv.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&$v.multiplyScalar(-qv.z);const o=this.material.rotation;let s,c;o!==0&&(c=Math.cos(o),s=Math.sin(o));const d=this.center;OS(kS.set(-.5,-.5,0),qv,d,$v,s,c),OS(lb.set(.5,-.5,0),qv,d,$v,s,c),OS(DS.set(.5,.5,0),qv,d,$v,s,c),$W.set(0,0),G4.set(1,0),qW.set(1,1);let f=e.ray.intersectTriangle(kS,lb,DS,!1,ob);if(f===null&&(OS(lb.set(-.5,.5,0),qv,d,$v,s,c),G4.set(0,1),f=e.ray.intersectTriangle(kS,DS,lb,!1,ob),f===null))return;const m=e.ray.origin.distanceTo(ob);m<e.near||m>e.far||a.push({distance:m,point:ob.clone(),uv:fl.getInterpolation(ob,kS,lb,DS,$W,G4,qW,new Kt),face:null,object:this})}copy(e,a){return super.copy(e,a),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function OS(n,e,a,o,s,c){Xv.subVectors(n,a).addScalar(.5).multiply(o),s!==void 0?(sb.x=c*Xv.x-s*Xv.y,sb.y=s*Xv.x+c*Xv.y):sb.copy(Xv),n.copy(e),n.x+=sb.x,n.y+=sb.y,n.applyMatrix4(iZ)}const zS=new Fe,XW=new Fe;class oZ extends pi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const a=e.levels;for(let o=0,s=a.length;o<s;o++){const c=a[o];this.addLevel(c.object.clone(),c.distance,c.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,a=0,o=0){a=Math.abs(a);const s=this.levels;let c;for(c=0;c<s.length&&!(a<s[c].distance);c++);return s.splice(c,0,{distance:a,hysteresis:o,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const a=this.levels;if(a.length>0){let o,s;for(o=1,s=a.length;o<s;o++){let c=a[o].distance;if(a[o].object.visible&&(c-=c*a[o].hysteresis),e<c)break}return a[o-1].object}return null}raycast(e,a){if(this.levels.length>0){zS.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(zS);this.getObjectForDistance(s).raycast(e,a)}}update(e){const a=this.levels;if(a.length>1){zS.setFromMatrixPosition(e.matrixWorld),XW.setFromMatrixPosition(this.matrixWorld);const o=zS.distanceTo(XW)/e.zoom;a[0].object.visible=!0;let s,c;for(s=1,c=a.length;s<c;s++){let d=a[s].distance;if(a[s].object.visible&&(d-=d*a[s].hysteresis),o>=d)a[s-1].object.visible=!1,a[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<c;s++)a[s].object.visible=!1}}toJSON(e){const a=super.toJSON(e);this.autoUpdate===!1&&(a.object.autoUpdate=!1),a.object.levels=[];const o=this.levels;for(let s=0,c=o.length;s<c;s++){const d=o[s];a.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return a}}const YW=new Fe,ZW=new Ei,KW=new Ei,t2e=new Fe,JW=new Ia,FS=new Fe,H4=new Pc,QW=new Ia,j4=new Hg;class sZ extends So{constructor(e,a){super(e,a),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=JL,this.bindMatrix=new Ia,this.bindMatrixInverse=new Ia,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new gu),this.boundingBox.makeEmpty();const a=e.getAttribute("position");for(let o=0;o<a.count;o++)this.getVertexPosition(o,FS),this.boundingBox.expandByPoint(FS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Pc),this.boundingSphere.makeEmpty();const a=e.getAttribute("position");for(let o=0;o<a.count;o++)this.getVertexPosition(o,FS),this.boundingSphere.expandByPoint(FS)}copy(e,a){return super.copy(e,a),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,a){const o=this.material,s=this.matrixWorld;o!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),H4.copy(this.boundingSphere),H4.applyMatrix4(s),e.ray.intersectsSphere(H4)!==!1&&(QW.copy(s).invert(),j4.copy(e.ray).applyMatrix4(QW),!(this.boundingBox!==null&&j4.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,a,j4)))}getVertexPosition(e,a){return super.getVertexPosition(e,a),this.applyBoneTransform(e,a),a}bind(e,a){this.skeleton=e,a===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.copy(a).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ei,a=this.geometry.attributes.skinWeight;for(let o=0,s=a.count;o<s;o++){e.fromBufferAttribute(a,o);const c=1/e.manhattanLength();c!==1/0?e.multiplyScalar(c):e.set(1,0,0,0),a.setXYZW(o,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===JL?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===vY?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,a){const o=this.skeleton,s=this.geometry;ZW.fromBufferAttribute(s.attributes.skinIndex,e),KW.fromBufferAttribute(s.attributes.skinWeight,e),YW.copy(a).applyMatrix4(this.bindMatrix),a.set(0,0,0);for(let c=0;c<4;c++){const d=KW.getComponent(c);if(d!==0){const f=ZW.getComponent(c);JW.multiplyMatrices(o.bones[f].matrixWorld,o.boneInverses[f]),a.addScaledVector(t2e.copy(YW).applyMatrix4(JW),d)}}return a.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,a){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,a)}}class d6 extends pi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class z0 extends kr{constructor(e=null,a=1,o=1,s,c,d,f,m,y=lo,_=lo,x,S){super(null,d,f,m,y,_,s,c,x,S),this.isDataTexture=!0,this.image={data:e,width:a,height:o},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const eV=new Ia,n2e=new Ia;class VT{constructor(e=[],a=[]){this.uuid=Zl(),this.bones=e.slice(0),this.boneInverses=a,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,a=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),a.length===0)this.calculateInverses();else if(e.length!==a.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let o=0,s=this.bones.length;o<s;o++)this.boneInverses.push(new Ia)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,a=this.bones.length;e<a;e++){const o=new Ia;this.bones[e]&&o.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(o)}}pose(){for(let e=0,a=this.bones.length;e<a;e++){const o=this.bones[e];o&&o.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,a=this.bones.length;e<a;e++){const o=this.bones[e];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}update(){const e=this.bones,a=this.boneInverses,o=this.boneMatrices,s=this.boneTexture;for(let c=0,d=e.length;c<d;c++){const f=e[c]?e[c].matrixWorld:n2e;eV.multiplyMatrices(f,a[c]),eV.toArray(o,c*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new VT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=WY(e),e=Math.max(e,4);const a=new Float32Array(e*e*4);a.set(this.boneMatrices);const o=new z0(a,e,e,pl,sd);return o.needsUpdate=!0,this.boneMatrices=a,this.boneTexture=o,this.boneTextureSize=e,this}getBoneByName(e){for(let a=0,o=this.bones.length;a<o;a++){const s=this.bones[a];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,a){this.uuid=e.uuid;for(let o=0,s=e.bones.length;o<s;o++){const c=e.bones[o];let d=a[c];d===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",c),d=new d6),this.bones.push(d),this.boneInverses.push(new Ia().fromArray(e.boneInverses[o]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const a=this.bones,o=this.boneInverses;for(let s=0,c=a.length;s<c;s++){const d=a[s];e.bones.push(d.uuid);const f=o[s];e.boneInverses.push(f.toArray())}return e}}class Og extends Xi{constructor(e,a,o,s=1){super(e,a,o),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Yv=new Ia,tV=new Ia,NS=[],nV=new gu,a2e=new Ia,cb=new So,ub=new Pc;class lZ extends So{constructor(e,a,o){super(e,a),this.isInstancedMesh=!0,this.instanceMatrix=new Og(new Float32Array(o*16),16),this.instanceColor=null,this.count=o,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<o;s++)this.setMatrixAt(s,a2e)}computeBoundingBox(){const e=this.geometry,a=this.count;this.boundingBox===null&&(this.boundingBox=new gu),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let o=0;o<a;o++)this.getMatrixAt(o,Yv),nV.copy(e.boundingBox).applyMatrix4(Yv),this.boundingBox.union(nV)}computeBoundingSphere(){const e=this.geometry,a=this.count;this.boundingSphere===null&&(this.boundingSphere=new Pc),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let o=0;o<a;o++)this.getMatrixAt(o,Yv),ub.copy(e.boundingSphere).applyMatrix4(Yv),this.boundingSphere.union(ub)}copy(e,a){return super.copy(e,a),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,a){a.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,a){a.fromArray(this.instanceMatrix.array,e*16)}raycast(e,a){const o=this.matrixWorld,s=this.count;if(cb.geometry=this.geometry,cb.material=this.material,cb.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),ub.copy(this.boundingSphere),ub.applyMatrix4(o),e.ray.intersectsSphere(ub)!==!1))for(let c=0;c<s;c++){this.getMatrixAt(c,Yv),tV.multiplyMatrices(o,Yv),cb.matrixWorld=tV,cb.raycast(e,NS);for(let d=0,f=NS.length;d<f;d++){const m=NS[d];m.instanceId=c,m.object=this,a.push(m)}NS.length=0}}setColorAt(e,a){this.instanceColor===null&&(this.instanceColor=new Og(new Float32Array(this.instanceMatrix.count*3),3)),a.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,a){a.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class qs extends as{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const aV=new Fe,iV=new Fe,rV=new Ia,$4=new Hg,BS=new Pc;let bp=class extends pi{constructor(e=new La,a=new qs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const a=e.attributes.position,o=[0];for(let s=1,c=a.count;s<c;s++)aV.fromBufferAttribute(a,s-1),iV.fromBufferAttribute(a,s),o[s]=o[s-1],o[s]+=aV.distanceTo(iV);e.setAttribute("lineDistance",new Wn(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,a){const o=this.geometry,s=this.matrixWorld,c=e.params.Line.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),BS.copy(o.boundingSphere),BS.applyMatrix4(s),BS.radius+=c,e.ray.intersectsSphere(BS)===!1)return;rV.copy(s).invert(),$4.copy(e.ray).applyMatrix4(rV);const f=c/((this.scale.x+this.scale.y+this.scale.z)/3),m=f*f,y=new Fe,_=new Fe,x=new Fe,S=new Fe,T=this.isLineSegments?2:1,I=o.index,D=o.attributes.position;if(I!==null){const L=Math.max(0,d.start),O=Math.min(I.count,d.start+d.count);for(let F=L,B=O-1;F<B;F+=T){const G=I.getX(F),q=I.getX(F+1);if(y.fromBufferAttribute(D,G),_.fromBufferAttribute(D,q),$4.distanceSqToSegment(y,_,S,x)>m)continue;S.applyMatrix4(this.matrixWorld);const te=e.ray.origin.distanceTo(S);te<e.near||te>e.far||a.push({distance:te,point:x.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}else{const L=Math.max(0,d.start),O=Math.min(D.count,d.start+d.count);for(let F=L,B=O-1;F<B;F+=T){if(y.fromBufferAttribute(D,F),_.fromBufferAttribute(D,F+1),$4.distanceSqToSegment(y,_,S,x)>m)continue;S.applyMatrix4(this.matrixWorld);const q=e.ray.origin.distanceTo(S);q<e.near||q>e.far||a.push({distance:q,point:x.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}};const oV=new Fe,sV=new Fe;class wd extends bp{constructor(e,a){super(e,a),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const a=e.attributes.position,o=[];for(let s=0,c=a.count;s<c;s+=2)oV.fromBufferAttribute(a,s),sV.fromBufferAttribute(a,s+1),o[s]=s===0?0:o[s-1],o[s+1]=o[s]+oV.distanceTo(sV);e.setAttribute("lineDistance",new Wn(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class cZ extends bp{constructor(e,a){super(e,a),this.isLineLoop=!0,this.type="LineLoop"}}class h6 extends as{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const lV=new Ia,PR=new Hg,US=new Pc,WS=new Fe;class uZ extends pi{constructor(e=new La,a=new h6){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=a,this.updateMorphTargets()}copy(e,a){return super.copy(e,a),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,a){const o=this.geometry,s=this.matrixWorld,c=e.params.Points.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),US.copy(o.boundingSphere),US.applyMatrix4(s),US.radius+=c,e.ray.intersectsSphere(US)===!1)return;lV.copy(s).invert(),PR.copy(e.ray).applyMatrix4(lV);const f=c/((this.scale.x+this.scale.y+this.scale.z)/3),m=f*f,y=o.index,x=o.attributes.position;if(y!==null){const S=Math.max(0,d.start),T=Math.min(y.count,d.start+d.count);for(let I=S,k=T;I<k;I++){const D=y.getX(I);WS.fromBufferAttribute(x,D),cV(WS,D,m,s,e,a,this)}}else{const S=Math.max(0,d.start),T=Math.min(x.count,d.start+d.count);for(let I=S,k=T;I<k;I++)WS.fromBufferAttribute(x,I),cV(WS,I,m,s,e,a,this)}}updateMorphTargets(){const a=this.geometry.morphAttributes,o=Object.keys(a);if(o.length>0){const s=a[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=s.length;c<d;c++){const f=s[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=c}}}}}function cV(n,e,a,o,s,c,d){const f=PR.distanceSqToPoint(n);if(f<a){const m=new Fe;PR.closestPointToPoint(n,m),m.applyMatrix4(o);const y=s.ray.origin.distanceTo(m);if(y<s.near||y>s.far)return;c.push({distance:y,distanceToRay:Math.sqrt(f),point:m,index:e,face:null,object:d})}}class i2e extends kr{constructor(e,a,o,s,c,d,f,m,y){super(e,a,o,s,c,d,f,m,y),this.isVideoTexture=!0,this.minFilter=d!==void 0?d:Ir,this.magFilter=c!==void 0?c:Ir,this.generateMipmaps=!1;const _=this;function x(){_.needsUpdate=!0,e.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(x)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class r2e extends kr{constructor(e,a){super({width:e,height:a}),this.isFramebufferTexture=!0,this.magFilter=lo,this.minFilter=lo,this.generateMipmaps=!1,this.needsUpdate=!0}}class GT extends kr{constructor(e,a,o,s,c,d,f,m,y,_,x,S){super(null,d,f,m,y,_,s,c,x,S),this.isCompressedTexture=!0,this.image={width:a,height:o},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class o2e extends GT{constructor(e,a,o,s,c,d){super(e,a,o,c,d),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=xs}}class s2e extends GT{constructor(e,a,o){super(void 0,e[0].width,e[0].height,a,o,Nh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class l2e extends kr{constructor(e,a,o,s,c,d,f,m,y){super(e,a,o,s,c,d,f,m,y),this.isCanvasTexture=!0,this.needsUpdate=!0}}class yu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,a){const o=this.getUtoTmapping(e);return this.getPoint(o,a)}getPoints(e=5){const a=[];for(let o=0;o<=e;o++)a.push(this.getPoint(o/e));return a}getSpacedPoints(e=5){const a=[];for(let o=0;o<=e;o++)a.push(this.getPointAt(o/e));return a}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const a=[];let o,s=this.getPoint(0),c=0;a.push(0);for(let d=1;d<=e;d++)o=this.getPoint(d/e),c+=o.distanceTo(s),a.push(c),s=o;return this.cacheArcLengths=a,a}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,a){const o=this.getLengths();let s=0;const c=o.length;let d;a?d=a:d=e*o[c-1];let f=0,m=c-1,y;for(;f<=m;)if(s=Math.floor(f+(m-f)/2),y=o[s]-d,y<0)f=s+1;else if(y>0)m=s-1;else{m=s;break}if(s=m,o[s]===d)return s/(c-1);const _=o[s],S=o[s+1]-_,T=(d-_)/S;return(s+T)/(c-1)}getTangent(e,a){let s=e-1e-4,c=e+1e-4;s<0&&(s=0),c>1&&(c=1);const d=this.getPoint(s),f=this.getPoint(c),m=a||(d.isVector2?new Kt:new Fe);return m.copy(f).sub(d).normalize(),m}getTangentAt(e,a){const o=this.getUtoTmapping(e);return this.getTangent(o,a)}computeFrenetFrames(e,a){const o=new Fe,s=[],c=[],d=[],f=new Fe,m=new Ia;for(let T=0;T<=e;T++){const I=T/e;s[T]=this.getTangentAt(I,new Fe)}c[0]=new Fe,d[0]=new Fe;let y=Number.MAX_VALUE;const _=Math.abs(s[0].x),x=Math.abs(s[0].y),S=Math.abs(s[0].z);_<=y&&(y=_,o.set(1,0,0)),x<=y&&(y=x,o.set(0,1,0)),S<=y&&o.set(0,0,1),f.crossVectors(s[0],o).normalize(),c[0].crossVectors(s[0],f),d[0].crossVectors(s[0],c[0]);for(let T=1;T<=e;T++){if(c[T]=c[T-1].clone(),d[T]=d[T-1].clone(),f.crossVectors(s[T-1],s[T]),f.length()>Number.EPSILON){f.normalize();const I=Math.acos($r(s[T-1].dot(s[T]),-1,1));c[T].applyMatrix4(m.makeRotationAxis(f,I))}d[T].crossVectors(s[T],c[T])}if(a===!0){let T=Math.acos($r(c[0].dot(c[e]),-1,1));T/=e,s[0].dot(f.crossVectors(c[0],c[e]))>0&&(T=-T);for(let I=1;I<=e;I++)c[I].applyMatrix4(m.makeRotationAxis(s[I],T*I)),d[I].crossVectors(s[I],c[I])}return{tangents:s,normals:c,binormals:d}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class HT extends yu{constructor(e=0,a=0,o=1,s=1,c=0,d=Math.PI*2,f=!1,m=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=a,this.xRadius=o,this.yRadius=s,this.aStartAngle=c,this.aEndAngle=d,this.aClockwise=f,this.aRotation=m}getPoint(e,a){const o=a||new Kt,s=Math.PI*2;let c=this.aEndAngle-this.aStartAngle;const d=Math.abs(c)<Number.EPSILON;for(;c<0;)c+=s;for(;c>s;)c-=s;c<Number.EPSILON&&(d?c=0:c=s),this.aClockwise===!0&&!d&&(c===s?c=-s:c=c-s);const f=this.aStartAngle+e*c;let m=this.aX+this.xRadius*Math.cos(f),y=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const _=Math.cos(this.aRotation),x=Math.sin(this.aRotation),S=m-this.aX,T=y-this.aY;m=S*_-T*x+this.aX,y=S*x+T*_+this.aY}return o.set(m,y)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class dZ extends HT{constructor(e,a,o,s,c,d){super(e,a,o,o,s,c,d),this.isArcCurve=!0,this.type="ArcCurve"}}function f6(){let n=0,e=0,a=0,o=0;function s(c,d,f,m){n=c,e=f,a=-3*c+3*d-2*f-m,o=2*c-2*d+f+m}return{initCatmullRom:function(c,d,f,m,y){s(d,f,y*(f-c),y*(m-d))},initNonuniformCatmullRom:function(c,d,f,m,y,_,x){let S=(d-c)/y-(f-c)/(y+_)+(f-d)/_,T=(f-d)/_-(m-d)/(_+x)+(m-f)/x;S*=_,T*=_,s(d,f,S,T)},calc:function(c){const d=c*c,f=d*c;return n+e*c+a*d+o*f}}}const VS=new Fe,q4=new f6,X4=new f6,Y4=new f6;class hZ extends yu{constructor(e=[],a=!1,o="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=a,this.curveType=o,this.tension=s}getPoint(e,a=new Fe){const o=a,s=this.points,c=s.length,d=(c-(this.closed?0:1))*e;let f=Math.floor(d),m=d-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/c)+1)*c:m===0&&f===c-1&&(f=c-2,m=1);let y,_;this.closed||f>0?y=s[(f-1)%c]:(VS.subVectors(s[0],s[1]).add(s[0]),y=VS);const x=s[f%c],S=s[(f+1)%c];if(this.closed||f+2<c?_=s[(f+2)%c]:(VS.subVectors(s[c-1],s[c-2]).add(s[c-1]),_=VS),this.curveType==="centripetal"||this.curveType==="chordal"){const T=this.curveType==="chordal"?.5:.25;let I=Math.pow(y.distanceToSquared(x),T),k=Math.pow(x.distanceToSquared(S),T),D=Math.pow(S.distanceToSquared(_),T);k<1e-4&&(k=1),I<1e-4&&(I=k),D<1e-4&&(D=k),q4.initNonuniformCatmullRom(y.x,x.x,S.x,_.x,I,k,D),X4.initNonuniformCatmullRom(y.y,x.y,S.y,_.y,I,k,D),Y4.initNonuniformCatmullRom(y.z,x.z,S.z,_.z,I,k,D)}else this.curveType==="catmullrom"&&(q4.initCatmullRom(y.x,x.x,S.x,_.x,this.tension),X4.initCatmullRom(y.y,x.y,S.y,_.y,this.tension),Y4.initCatmullRom(y.z,x.z,S.z,_.z,this.tension));return o.set(q4.calc(m),X4.calc(m),Y4.calc(m)),o}copy(e){super.copy(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let a=0,o=this.points.length;a<o;a++){const s=this.points[a];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(new Fe().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function uV(n,e,a,o,s){const c=(o-e)*.5,d=(s-a)*.5,f=n*n,m=n*f;return(2*a-2*o+c+d)*m+(-3*a+3*o-2*c-d)*f+c*n+a}function c2e(n,e){const a=1-n;return a*a*e}function u2e(n,e){return 2*(1-n)*n*e}function d2e(n,e){return n*n*e}function nx(n,e,a,o){return c2e(n,e)+u2e(n,a)+d2e(n,o)}function h2e(n,e){const a=1-n;return a*a*a*e}function f2e(n,e){const a=1-n;return 3*a*a*n*e}function p2e(n,e){return 3*(1-n)*n*n*e}function m2e(n,e){return n*n*n*e}function ax(n,e,a,o,s){return h2e(n,e)+f2e(n,a)+p2e(n,o)+m2e(n,s)}class p6 extends yu{constructor(e=new Kt,a=new Kt,o=new Kt,s=new Kt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=a,this.v2=o,this.v3=s}getPoint(e,a=new Kt){const o=a,s=this.v0,c=this.v1,d=this.v2,f=this.v3;return o.set(ax(e,s.x,c.x,d.x,f.x),ax(e,s.y,c.y,d.y,f.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fZ extends yu{constructor(e=new Fe,a=new Fe,o=new Fe,s=new Fe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=a,this.v2=o,this.v3=s}getPoint(e,a=new Fe){const o=a,s=this.v0,c=this.v1,d=this.v2,f=this.v3;return o.set(ax(e,s.x,c.x,d.x,f.x),ax(e,s.y,c.y,d.y,f.y),ax(e,s.z,c.z,d.z,f.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class m6 extends yu{constructor(e=new Kt,a=new Kt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=a}getPoint(e,a=new Kt){const o=a;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,a){return this.getPoint(e,a)}getTangent(e,a=new Kt){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,a){return this.getTangent(e,a)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class pZ extends yu{constructor(e=new Fe,a=new Fe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=a}getPoint(e,a=new Fe){const o=a;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,a){return this.getPoint(e,a)}getTangent(e,a=new Fe){return a.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,a){return this.getTangent(e,a)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class g6 extends yu{constructor(e=new Kt,a=new Kt,o=new Kt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=a,this.v2=o}getPoint(e,a=new Kt){const o=a,s=this.v0,c=this.v1,d=this.v2;return o.set(nx(e,s.x,c.x,d.x),nx(e,s.y,c.y,d.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y6 extends yu{constructor(e=new Fe,a=new Fe,o=new Fe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=a,this.v2=o}getPoint(e,a=new Fe){const o=a,s=this.v0,c=this.v1,d=this.v2;return o.set(nx(e,s.x,c.x,d.x),nx(e,s.y,c.y,d.y),nx(e,s.z,c.z,d.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class v6 extends yu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,a=new Kt){const o=a,s=this.points,c=(s.length-1)*e,d=Math.floor(c),f=c-d,m=s[d===0?d:d-1],y=s[d],_=s[d>s.length-2?s.length-1:d+1],x=s[d>s.length-3?s.length-1:d+2];return o.set(uV(f,m.x,y.x,_.x,x.x),uV(f,m.y,y.y,_.y,x.y)),o}copy(e){super.copy(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let a=0,o=this.points.length;a<o;a++){const s=this.points[a];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let a=0,o=e.points.length;a<o;a++){const s=e.points[a];this.points.push(new Kt().fromArray(s))}return this}}var tM=Object.freeze({__proto__:null,ArcCurve:dZ,CatmullRomCurve3:hZ,CubicBezierCurve:p6,CubicBezierCurve3:fZ,EllipseCurve:HT,LineCurve:m6,LineCurve3:pZ,QuadraticBezierCurve:g6,QuadraticBezierCurve3:y6,SplineCurve:v6});class mZ extends yu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(a)){const o=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new tM[o](a,e))}return this}getPoint(e,a){const o=e*this.getLength(),s=this.getCurveLengths();let c=0;for(;c<s.length;){if(s[c]>=o){const d=s[c]-o,f=this.curves[c],m=f.getLength(),y=m===0?0:1-d/m;return f.getPointAt(y,a)}c++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let a=0;for(let o=0,s=this.curves.length;o<s;o++)a+=this.curves[o].getLength(),e.push(a);return this.cacheLengths=e,e}getSpacedPoints(e=40){const a=[];for(let o=0;o<=e;o++)a.push(this.getPoint(o/e));return this.autoClose&&a.push(a[0]),a}getPoints(e=12){const a=[];let o;for(let s=0,c=this.curves;s<c.length;s++){const d=c[s],f=d.isEllipseCurve?e*2:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?e*d.points.length:e,m=d.getPoints(f);for(let y=0;y<m.length;y++){const _=m[y];o&&o.equals(_)||(a.push(_),o=_)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}copy(e){super.copy(e),this.curves=[];for(let a=0,o=e.curves.length;a<o;a++){const s=e.curves[a];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let a=0,o=this.curves.length;a<o;a++){const s=this.curves[a];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let a=0,o=e.curves.length;a<o;a++){const s=e.curves[a];this.curves.push(new tM[s.type]().fromJSON(s))}return this}}class Kx extends mZ{constructor(e){super(),this.type="Path",this.currentPoint=new Kt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let a=1,o=e.length;a<o;a++)this.lineTo(e[a].x,e[a].y);return this}moveTo(e,a){return this.currentPoint.set(e,a),this}lineTo(e,a){const o=new m6(this.currentPoint.clone(),new Kt(e,a));return this.curves.push(o),this.currentPoint.set(e,a),this}quadraticCurveTo(e,a,o,s){const c=new g6(this.currentPoint.clone(),new Kt(e,a),new Kt(o,s));return this.curves.push(c),this.currentPoint.set(o,s),this}bezierCurveTo(e,a,o,s,c,d){const f=new p6(this.currentPoint.clone(),new Kt(e,a),new Kt(o,s),new Kt(c,d));return this.curves.push(f),this.currentPoint.set(c,d),this}splineThru(e){const a=[this.currentPoint.clone()].concat(e),o=new v6(a);return this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this}arc(e,a,o,s,c,d){const f=this.currentPoint.x,m=this.currentPoint.y;return this.absarc(e+f,a+m,o,s,c,d),this}absarc(e,a,o,s,c,d){return this.absellipse(e,a,o,o,s,c,d),this}ellipse(e,a,o,s,c,d,f,m){const y=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+y,a+_,o,s,c,d,f,m),this}absellipse(e,a,o,s,c,d,f,m){const y=new HT(e,a,o,s,c,d,f,m);if(this.curves.length>0){const x=y.getPoint(0);x.equals(this.currentPoint)||this.lineTo(x.x,x.y)}this.curves.push(y);const _=y.getPoint(1);return this.currentPoint.copy(_),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class zw extends La{constructor(e=[new Kt(0,-.5),new Kt(.5,0),new Kt(0,.5)],a=12,o=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:a,phiStart:o,phiLength:s},a=Math.floor(a),s=$r(s,0,Math.PI*2);const c=[],d=[],f=[],m=[],y=[],_=1/a,x=new Fe,S=new Kt,T=new Fe,I=new Fe,k=new Fe;let D=0,L=0;for(let O=0;O<=e.length-1;O++)switch(O){case 0:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,T.x=L*1,T.y=-D,T.z=L*0,k.copy(T),T.normalize(),m.push(T.x,T.y,T.z);break;case e.length-1:m.push(k.x,k.y,k.z);break;default:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,T.x=L*1,T.y=-D,T.z=L*0,I.copy(T),T.x+=k.x,T.y+=k.y,T.z+=k.z,T.normalize(),m.push(T.x,T.y,T.z),k.copy(I)}for(let O=0;O<=a;O++){const F=o+O*_*s,B=Math.sin(F),G=Math.cos(F);for(let q=0;q<=e.length-1;q++){x.x=e[q].x*B,x.y=e[q].y,x.z=e[q].x*G,d.push(x.x,x.y,x.z),S.x=O/a,S.y=q/(e.length-1),f.push(S.x,S.y);const X=m[3*q+0]*B,te=m[3*q+1],V=m[3*q+0]*G;y.push(X,te,V)}}for(let O=0;O<a;O++)for(let F=0;F<e.length-1;F++){const B=F+O*e.length,G=B,q=B+e.length,X=B+e.length+1,te=B+1;c.push(G,q,te),c.push(X,te,q)}this.setIndex(c),this.setAttribute("position",new Wn(d,3)),this.setAttribute("uv",new Wn(f,2)),this.setAttribute("normal",new Wn(y,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zw(e.points,e.segments,e.phiStart,e.phiLength)}}class jT extends zw{constructor(e=1,a=1,o=4,s=8){const c=new Kx;c.absarc(0,-a/2,e,Math.PI*1.5,0),c.absarc(0,a/2,e,0,Math.PI*.5),super(c.getPoints(o),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:a,capSegments:o,radialSegments:s}}static fromJSON(e){return new jT(e.radius,e.length,e.capSegments,e.radialSegments)}}class $T extends La{constructor(e=1,a=32,o=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:a,thetaStart:o,thetaLength:s},a=Math.max(3,a);const c=[],d=[],f=[],m=[],y=new Fe,_=new Kt;d.push(0,0,0),f.push(0,0,1),m.push(.5,.5);for(let x=0,S=3;x<=a;x++,S+=3){const T=o+x/a*s;y.x=e*Math.cos(T),y.y=e*Math.sin(T),d.push(y.x,y.y,y.z),f.push(0,0,1),_.x=(d[S]/e+1)/2,_.y=(d[S+1]/e+1)/2,m.push(_.x,_.y)}for(let x=1;x<=a;x++)c.push(x,x+1,0);this.setIndex(c),this.setAttribute("position",new Wn(d,3)),this.setAttribute("normal",new Wn(f,3)),this.setAttribute("uv",new Wn(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $T(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class v_ extends La{constructor(e=1,a=1,o=1,s=32,c=1,d=!1,f=0,m=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:a,height:o,radialSegments:s,heightSegments:c,openEnded:d,thetaStart:f,thetaLength:m};const y=this;s=Math.floor(s),c=Math.floor(c);const _=[],x=[],S=[],T=[];let I=0;const k=[],D=o/2;let L=0;O(),d===!1&&(e>0&&F(!0),a>0&&F(!1)),this.setIndex(_),this.setAttribute("position",new Wn(x,3)),this.setAttribute("normal",new Wn(S,3)),this.setAttribute("uv",new Wn(T,2));function O(){const B=new Fe,G=new Fe;let q=0;const X=(a-e)/o;for(let te=0;te<=c;te++){const V=[],Q=te/c,ge=Q*(a-e)+e;for(let me=0;me<=s;me++){const be=me/s,fe=be*m+f,Ce=Math.sin(fe),Le=Math.cos(fe);G.x=ge*Ce,G.y=-Q*o+D,G.z=ge*Le,x.push(G.x,G.y,G.z),B.set(Ce,X,Le).normalize(),S.push(B.x,B.y,B.z),T.push(be,1-Q),V.push(I++)}k.push(V)}for(let te=0;te<s;te++)for(let V=0;V<c;V++){const Q=k[V][te],ge=k[V+1][te],me=k[V+1][te+1],be=k[V][te+1];_.push(Q,ge,be),_.push(ge,me,be),q+=6}y.addGroup(L,q,0),L+=q}function F(B){const G=I,q=new Kt,X=new Fe;let te=0;const V=B===!0?e:a,Q=B===!0?1:-1;for(let me=1;me<=s;me++)x.push(0,D*Q,0),S.push(0,Q,0),T.push(.5,.5),I++;const ge=I;for(let me=0;me<=s;me++){const fe=me/s*m+f,Ce=Math.cos(fe),Le=Math.sin(fe);X.x=V*Le,X.y=D*Q,X.z=V*Ce,x.push(X.x,X.y,X.z),S.push(0,Q,0),q.x=Ce*.5+.5,q.y=Le*.5*Q+.5,T.push(q.x,q.y),I++}for(let me=0;me<s;me++){const be=G+me,fe=ge+me;B===!0?_.push(fe,fe+1,be):_.push(fe+1,fe,be),te+=3}y.addGroup(L,te,B===!0?1:2),L+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new v_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class qT extends v_{constructor(e=1,a=1,o=32,s=1,c=!1,d=0,f=Math.PI*2){super(0,e,a,o,s,c,d,f),this.type="ConeGeometry",this.parameters={radius:e,height:a,radialSegments:o,heightSegments:s,openEnded:c,thetaStart:d,thetaLength:f}}static fromJSON(e){return new qT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cp extends La{constructor(e=[],a=[],o=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:a,radius:o,detail:s};const c=[],d=[];f(s),y(o),_(),this.setAttribute("position",new Wn(c,3)),this.setAttribute("normal",new Wn(c.slice(),3)),this.setAttribute("uv",new Wn(d,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function f(O){const F=new Fe,B=new Fe,G=new Fe;for(let q=0;q<a.length;q+=3)T(a[q+0],F),T(a[q+1],B),T(a[q+2],G),m(F,B,G,O)}function m(O,F,B,G){const q=G+1,X=[];for(let te=0;te<=q;te++){X[te]=[];const V=O.clone().lerp(B,te/q),Q=F.clone().lerp(B,te/q),ge=q-te;for(let me=0;me<=ge;me++)me===0&&te===q?X[te][me]=V:X[te][me]=V.clone().lerp(Q,me/ge)}for(let te=0;te<q;te++)for(let V=0;V<2*(q-te)-1;V++){const Q=Math.floor(V/2);V%2===0?(S(X[te][Q+1]),S(X[te+1][Q]),S(X[te][Q])):(S(X[te][Q+1]),S(X[te+1][Q+1]),S(X[te+1][Q]))}}function y(O){const F=new Fe;for(let B=0;B<c.length;B+=3)F.x=c[B+0],F.y=c[B+1],F.z=c[B+2],F.normalize().multiplyScalar(O),c[B+0]=F.x,c[B+1]=F.y,c[B+2]=F.z}function _(){const O=new Fe;for(let F=0;F<c.length;F+=3){O.x=c[F+0],O.y=c[F+1],O.z=c[F+2];const B=D(O)/2/Math.PI+.5,G=L(O)/Math.PI+.5;d.push(B,1-G)}I(),x()}function x(){for(let O=0;O<d.length;O+=6){const F=d[O+0],B=d[O+2],G=d[O+4],q=Math.max(F,B,G),X=Math.min(F,B,G);q>.9&&X<.1&&(F<.2&&(d[O+0]+=1),B<.2&&(d[O+2]+=1),G<.2&&(d[O+4]+=1))}}function S(O){c.push(O.x,O.y,O.z)}function T(O,F){const B=O*3;F.x=e[B+0],F.y=e[B+1],F.z=e[B+2]}function I(){const O=new Fe,F=new Fe,B=new Fe,G=new Fe,q=new Kt,X=new Kt,te=new Kt;for(let V=0,Q=0;V<c.length;V+=9,Q+=6){O.set(c[V+0],c[V+1],c[V+2]),F.set(c[V+3],c[V+4],c[V+5]),B.set(c[V+6],c[V+7],c[V+8]),q.set(d[Q+0],d[Q+1]),X.set(d[Q+2],d[Q+3]),te.set(d[Q+4],d[Q+5]),G.copy(O).add(F).add(B).divideScalar(3);const ge=D(G);k(q,Q+0,O,ge),k(X,Q+2,F,ge),k(te,Q+4,B,ge)}}function k(O,F,B,G){G<0&&O.x===1&&(d[F]=O.x-1),B.x===0&&B.z===0&&(d[F]=G/2/Math.PI+.5)}function D(O){return Math.atan2(O.z,-O.x)}function L(O){return Math.atan2(-O.y,Math.sqrt(O.x*O.x+O.z*O.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cp(e.vertices,e.indices,e.radius,e.details)}}class XT extends Cp{constructor(e=1,a=0){const o=(1+Math.sqrt(5))/2,s=1/o,c=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-o,0,-s,o,0,s,-o,0,s,o,-s,-o,0,-s,o,0,s,-o,0,s,o,0,-o,0,-s,o,0,-s,-o,0,s,o,0,s],d=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(c,d,e,a),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new XT(e.radius,e.detail)}}const GS=new Fe,HS=new Fe,Z4=new Fe,jS=new fl;class gZ extends La{constructor(e=null,a=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:a},e!==null){const s=Math.pow(10,4),c=Math.cos(bg*a),d=e.getIndex(),f=e.getAttribute("position"),m=d?d.count:f.count,y=[0,0,0],_=["a","b","c"],x=new Array(3),S={},T=[];for(let I=0;I<m;I+=3){d?(y[0]=d.getX(I),y[1]=d.getX(I+1),y[2]=d.getX(I+2)):(y[0]=I,y[1]=I+1,y[2]=I+2);const{a:k,b:D,c:L}=jS;if(k.fromBufferAttribute(f,y[0]),D.fromBufferAttribute(f,y[1]),L.fromBufferAttribute(f,y[2]),jS.getNormal(Z4),x[0]=`${Math.round(k.x*s)},${Math.round(k.y*s)},${Math.round(k.z*s)}`,x[1]=`${Math.round(D.x*s)},${Math.round(D.y*s)},${Math.round(D.z*s)}`,x[2]=`${Math.round(L.x*s)},${Math.round(L.y*s)},${Math.round(L.z*s)}`,!(x[0]===x[1]||x[1]===x[2]||x[2]===x[0]))for(let O=0;O<3;O++){const F=(O+1)%3,B=x[O],G=x[F],q=jS[_[O]],X=jS[_[F]],te=`${B}_${G}`,V=`${G}_${B}`;V in S&&S[V]?(Z4.dot(S[V].normal)<=c&&(T.push(q.x,q.y,q.z),T.push(X.x,X.y,X.z)),S[V]=null):te in S||(S[te]={index0:y[O],index1:y[F],normal:Z4.clone()})}}for(const I in S)if(S[I]){const{index0:k,index1:D}=S[I];GS.fromBufferAttribute(f,k),HS.fromBufferAttribute(f,D),T.push(GS.x,GS.y,GS.z),T.push(HS.x,HS.y,HS.z)}this.setAttribute("position",new Wn(T,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class wg extends Kx{constructor(e){super(e),this.uuid=Zl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const a=[];for(let o=0,s=this.holes.length;o<s;o++)a[o]=this.holes[o].getPoints(e);return a}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let a=0,o=e.holes.length;a<o;a++){const s=e.holes[a];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let a=0,o=this.holes.length;a<o;a++){const s=this.holes[a];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let a=0,o=e.holes.length;a<o;a++){const s=e.holes[a];this.holes.push(new Kx().fromJSON(s))}return this}}const g2e={triangulate:function(n,e,a=2){const o=e&&e.length,s=o?e[0]*a:n.length;let c=yZ(n,0,s,a,!0);const d=[];if(!c||c.next===c.prev)return d;let f,m,y,_,x,S,T;if(o&&(c=x2e(n,e,c,a)),n.length>80*a){f=y=n[0],m=_=n[1];for(let I=a;I<s;I+=a)x=n[I],S=n[I+1],x<f&&(f=x),S<m&&(m=S),x>y&&(y=x),S>_&&(_=S);T=Math.max(y-f,_-m),T=T!==0?32767/T:0}return Jx(c,d,a,f,m,T,0),d}};function yZ(n,e,a,o,s){let c,d;if(s===R2e(n,e,a,o)>0)for(c=e;c<a;c+=o)d=dV(c,n[c],n[c+1],d);else for(c=a-o;c>=e;c-=o)d=dV(c,n[c],n[c+1],d);return d&&YT(d,d.next)&&(ew(d),d=d.next),d}function zg(n,e){if(!n)return n;e||(e=n);let a=n,o;do if(o=!1,!a.steiner&&(YT(a,a.next)||Lr(a.prev,a,a.next)===0)){if(ew(a),a=e=a.prev,a===a.next)break;o=!0}else a=a.next;while(o||a!==e);return e}function Jx(n,e,a,o,s,c,d){if(!n)return;!d&&c&&M2e(n,o,s,c);let f=n,m,y;for(;n.prev!==n.next;){if(m=n.prev,y=n.next,c?v2e(n,o,s,c):y2e(n)){e.push(m.i/a|0),e.push(n.i/a|0),e.push(y.i/a|0),ew(n),n=y.next,f=y.next;continue}if(n=y,n===f){d?d===1?(n=_2e(zg(n),e,a),Jx(n,e,a,o,s,c,2)):d===2&&b2e(n,e,a,o,s,c):Jx(zg(n),e,a,o,s,c,1);break}}}function y2e(n){const e=n.prev,a=n,o=n.next;if(Lr(e,a,o)>=0)return!1;const s=e.x,c=a.x,d=o.x,f=e.y,m=a.y,y=o.y,_=s<c?s<d?s:d:c<d?c:d,x=f<m?f<y?f:y:m<y?m:y,S=s>c?s>d?s:d:c>d?c:d,T=f>m?f>y?f:y:m>y?m:y;let I=o.next;for(;I!==e;){if(I.x>=_&&I.x<=S&&I.y>=x&&I.y<=T&&S0(s,f,c,m,d,y,I.x,I.y)&&Lr(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function v2e(n,e,a,o){const s=n.prev,c=n,d=n.next;if(Lr(s,c,d)>=0)return!1;const f=s.x,m=c.x,y=d.x,_=s.y,x=c.y,S=d.y,T=f<m?f<y?f:y:m<y?m:y,I=_<x?_<S?_:S:x<S?x:S,k=f>m?f>y?f:y:m>y?m:y,D=_>x?_>S?_:S:x>S?x:S,L=IR(T,I,e,a,o),O=IR(k,D,e,a,o);let F=n.prevZ,B=n.nextZ;for(;F&&F.z>=L&&B&&B.z<=O;){if(F.x>=T&&F.x<=k&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&S0(f,_,m,x,y,S,F.x,F.y)&&Lr(F.prev,F,F.next)>=0||(F=F.prevZ,B.x>=T&&B.x<=k&&B.y>=I&&B.y<=D&&B!==s&&B!==d&&S0(f,_,m,x,y,S,B.x,B.y)&&Lr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;F&&F.z>=L;){if(F.x>=T&&F.x<=k&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&S0(f,_,m,x,y,S,F.x,F.y)&&Lr(F.prev,F,F.next)>=0)return!1;F=F.prevZ}for(;B&&B.z<=O;){if(B.x>=T&&B.x<=k&&B.y>=I&&B.y<=D&&B!==s&&B!==d&&S0(f,_,m,x,y,S,B.x,B.y)&&Lr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function _2e(n,e,a){let o=n;do{const s=o.prev,c=o.next.next;!YT(s,c)&&vZ(s,o,o.next,c)&&Qx(s,c)&&Qx(c,s)&&(e.push(s.i/a|0),e.push(o.i/a|0),e.push(c.i/a|0),ew(o),ew(o.next),o=n=c),o=o.next}while(o!==n);return zg(o)}function b2e(n,e,a,o,s,c){let d=n;do{let f=d.next.next;for(;f!==d.prev;){if(d.i!==f.i&&P2e(d,f)){let m=_Z(d,f);d=zg(d,d.next),m=zg(m,m.next),Jx(d,e,a,o,s,c,0),Jx(m,e,a,o,s,c,0);return}f=f.next}d=d.next}while(d!==n)}function x2e(n,e,a,o){const s=[];let c,d,f,m,y;for(c=0,d=e.length;c<d;c++)f=e[c]*o,m=c<d-1?e[c+1]*o:n.length,y=yZ(n,f,m,o,!1),y===y.next&&(y.steiner=!0),s.push(C2e(y));for(s.sort(w2e),c=0;c<s.length;c++)a=S2e(s[c],a);return a}function w2e(n,e){return n.x-e.x}function S2e(n,e){const a=A2e(n,e);if(!a)return e;const o=_Z(a,n);return zg(o,o.next),zg(a,a.next)}function A2e(n,e){let a=e,o=-1/0,s;const c=n.x,d=n.y;do{if(d<=a.y&&d>=a.next.y&&a.next.y!==a.y){const S=a.x+(d-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(S<=c&&S>o&&(o=S,s=a.x<a.next.x?a:a.next,S===c))return s}a=a.next}while(a!==e);if(!s)return null;const f=s,m=s.x,y=s.y;let _=1/0,x;a=s;do c>=a.x&&a.x>=m&&c!==a.x&&S0(d<y?c:o,d,m,y,d<y?o:c,d,a.x,a.y)&&(x=Math.abs(d-a.y)/(c-a.x),Qx(a,n)&&(x<_||x===_&&(a.x>s.x||a.x===s.x&&E2e(s,a)))&&(s=a,_=x)),a=a.next;while(a!==f);return s}function E2e(n,e){return Lr(n.prev,n,e.prev)<0&&Lr(e.next,n,n.next)<0}function M2e(n,e,a,o){let s=n;do s.z===0&&(s.z=IR(s.x,s.y,e,a,o)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,T2e(s)}function T2e(n){let e,a,o,s,c,d,f,m,y=1;do{for(a=n,n=null,c=null,d=0;a;){for(d++,o=a,f=0,e=0;e<y&&(f++,o=o.nextZ,!!o);e++);for(m=y;f>0||m>0&&o;)f!==0&&(m===0||!o||a.z<=o.z)?(s=a,a=a.nextZ,f--):(s=o,o=o.nextZ,m--),c?c.nextZ=s:n=s,s.prevZ=c,c=s;a=o}c.nextZ=null,y*=2}while(d>1);return n}function IR(n,e,a,o,s){return n=(n-a)*s|0,e=(e-o)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function C2e(n){let e=n,a=n;do(e.x<a.x||e.x===a.x&&e.y<a.y)&&(a=e),e=e.next;while(e!==n);return a}function S0(n,e,a,o,s,c,d,f){return(s-d)*(e-f)>=(n-d)*(c-f)&&(n-d)*(o-f)>=(a-d)*(e-f)&&(a-d)*(c-f)>=(s-d)*(o-f)}function P2e(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!I2e(n,e)&&(Qx(n,e)&&Qx(e,n)&&L2e(n,e)&&(Lr(n.prev,n,e.prev)||Lr(n,e.prev,e))||YT(n,e)&&Lr(n.prev,n,n.next)>0&&Lr(e.prev,e,e.next)>0)}function Lr(n,e,a){return(e.y-n.y)*(a.x-e.x)-(e.x-n.x)*(a.y-e.y)}function YT(n,e){return n.x===e.x&&n.y===e.y}function vZ(n,e,a,o){const s=qS(Lr(n,e,a)),c=qS(Lr(n,e,o)),d=qS(Lr(a,o,n)),f=qS(Lr(a,o,e));return!!(s!==c&&d!==f||s===0&&$S(n,a,e)||c===0&&$S(n,o,e)||d===0&&$S(a,n,o)||f===0&&$S(a,e,o))}function $S(n,e,a){return e.x<=Math.max(n.x,a.x)&&e.x>=Math.min(n.x,a.x)&&e.y<=Math.max(n.y,a.y)&&e.y>=Math.min(n.y,a.y)}function qS(n){return n>0?1:n<0?-1:0}function I2e(n,e){let a=n;do{if(a.i!==n.i&&a.next.i!==n.i&&a.i!==e.i&&a.next.i!==e.i&&vZ(a,a.next,n,e))return!0;a=a.next}while(a!==n);return!1}function Qx(n,e){return Lr(n.prev,n,n.next)<0?Lr(n,e,n.next)>=0&&Lr(n,n.prev,e)>=0:Lr(n,e,n.prev)<0||Lr(n,n.next,e)<0}function L2e(n,e){let a=n,o=!1;const s=(n.x+e.x)/2,c=(n.y+e.y)/2;do a.y>c!=a.next.y>c&&a.next.y!==a.y&&s<(a.next.x-a.x)*(c-a.y)/(a.next.y-a.y)+a.x&&(o=!o),a=a.next;while(a!==n);return o}function _Z(n,e){const a=new LR(n.i,n.x,n.y),o=new LR(e.i,e.x,e.y),s=n.next,c=e.prev;return n.next=e,e.prev=n,a.next=s,s.prev=a,o.next=a,a.prev=o,c.next=o,o.prev=c,o}function dV(n,e,a,o){const s=new LR(n,e,a);return o?(s.next=o.next,s.prev=o,o.next.prev=s,o.next=s):(s.prev=s,s.next=s),s}function ew(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function LR(n,e,a){this.i=n,this.x=e,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R2e(n,e,a,o){let s=0;for(let c=e,d=a-o;c<a;c+=o)s+=(n[d]-n[c])*(n[c+1]+n[d+1]),d=c;return s}class pd{static area(e){const a=e.length;let o=0;for(let s=a-1,c=0;c<a;s=c++)o+=e[s].x*e[c].y-e[c].x*e[s].y;return o*.5}static isClockWise(e){return pd.area(e)<0}static triangulateShape(e,a){const o=[],s=[],c=[];hV(e),fV(o,e);let d=e.length;a.forEach(hV);for(let m=0;m<a.length;m++)s.push(d),d+=a[m].length,fV(o,a[m]);const f=g2e.triangulate(o,s);for(let m=0;m<f.length;m+=3)c.push(f.slice(m,m+3));return c}}function hV(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function fV(n,e){for(let a=0;a<e.length;a++)n.push(e[a].x),n.push(e[a].y)}class ZT extends La{constructor(e=new wg([new Kt(.5,.5),new Kt(-.5,.5),new Kt(-.5,-.5),new Kt(.5,-.5)]),a={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:a},e=Array.isArray(e)?e:[e];const o=this,s=[],c=[];for(let f=0,m=e.length;f<m;f++){const y=e[f];d(y)}this.setAttribute("position",new Wn(s,3)),this.setAttribute("uv",new Wn(c,2)),this.computeVertexNormals();function d(f){const m=[],y=a.curveSegments!==void 0?a.curveSegments:12,_=a.steps!==void 0?a.steps:1,x=a.depth!==void 0?a.depth:1;let S=a.bevelEnabled!==void 0?a.bevelEnabled:!0,T=a.bevelThickness!==void 0?a.bevelThickness:.2,I=a.bevelSize!==void 0?a.bevelSize:T-.1,k=a.bevelOffset!==void 0?a.bevelOffset:0,D=a.bevelSegments!==void 0?a.bevelSegments:3;const L=a.extrudePath,O=a.UVGenerator!==void 0?a.UVGenerator:k2e;let F,B=!1,G,q,X,te;L&&(F=L.getSpacedPoints(_),B=!0,S=!1,G=L.computeFrenetFrames(_,!1),q=new Fe,X=new Fe,te=new Fe),S||(D=0,T=0,I=0,k=0);const V=f.extractPoints(y);let Q=V.shape;const ge=V.holes;if(!pd.isClockWise(Q)){Q=Q.reverse();for(let Pe=0,pt=ge.length;Pe<pt;Pe++){const yt=ge[Pe];pd.isClockWise(yt)&&(ge[Pe]=yt.reverse())}}const be=pd.triangulateShape(Q,ge),fe=Q;for(let Pe=0,pt=ge.length;Pe<pt;Pe++){const yt=ge[Pe];Q=Q.concat(yt)}function Ce(Pe,pt,yt){return pt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().addScaledVector(pt,yt)}const Le=Q.length,Ge=be.length;function le(Pe,pt,yt){let At,Be,ue;const se=Pe.x-pt.x,ve=Pe.y-pt.y,$e=yt.x-Pe.x,De=yt.y-Pe.y,st=se*se+ve*ve,de=se*De-ve*$e;if(Math.abs(de)>Number.EPSILON){const ne=Math.sqrt(st),Oe=Math.sqrt($e*$e+De*De),mt=pt.x-ve/ne,ot=pt.y+se/ne,lt=yt.x-De/Oe,Et=yt.y+$e/Oe,Ut=((lt-mt)*De-(Et-ot)*$e)/(se*De-ve*$e);At=mt+se*Ut-Pe.x,Be=ot+ve*Ut-Pe.y;const Vt=At*At+Be*Be;if(Vt<=2)return new Kt(At,Be);ue=Math.sqrt(Vt/2)}else{let ne=!1;se>Number.EPSILON?$e>Number.EPSILON&&(ne=!0):se<-Number.EPSILON?$e<-Number.EPSILON&&(ne=!0):Math.sign(ve)===Math.sign(De)&&(ne=!0),ne?(At=-ve,Be=se,ue=Math.sqrt(st)):(At=se,Be=ve,ue=Math.sqrt(st/2))}return new Kt(At/ue,Be/ue)}const pe=[];for(let Pe=0,pt=fe.length,yt=pt-1,At=Pe+1;Pe<pt;Pe++,yt++,At++)yt===pt&&(yt=0),At===pt&&(At=0),pe[Pe]=le(fe[Pe],fe[yt],fe[At]);const Ae=[];let ae,Ee=pe.concat();for(let Pe=0,pt=ge.length;Pe<pt;Pe++){const yt=ge[Pe];ae=[];for(let At=0,Be=yt.length,ue=Be-1,se=At+1;At<Be;At++,ue++,se++)ue===Be&&(ue=0),se===Be&&(se=0),ae[At]=le(yt[At],yt[ue],yt[se]);Ae.push(ae),Ee=Ee.concat(ae)}for(let Pe=0;Pe<D;Pe++){const pt=Pe/D,yt=T*Math.cos(pt*Math.PI/2),At=I*Math.sin(pt*Math.PI/2)+k;for(let Be=0,ue=fe.length;Be<ue;Be++){const se=Ce(fe[Be],pe[Be],At);ft(se.x,se.y,-yt)}for(let Be=0,ue=ge.length;Be<ue;Be++){const se=ge[Be];ae=Ae[Be];for(let ve=0,$e=se.length;ve<$e;ve++){const De=Ce(se[ve],ae[ve],At);ft(De.x,De.y,-yt)}}}const Ze=I+k;for(let Pe=0;Pe<Le;Pe++){const pt=S?Ce(Q[Pe],Ee[Pe],Ze):Q[Pe];B?(X.copy(G.normals[0]).multiplyScalar(pt.x),q.copy(G.binormals[0]).multiplyScalar(pt.y),te.copy(F[0]).add(X).add(q),ft(te.x,te.y,te.z)):ft(pt.x,pt.y,0)}for(let Pe=1;Pe<=_;Pe++)for(let pt=0;pt<Le;pt++){const yt=S?Ce(Q[pt],Ee[pt],Ze):Q[pt];B?(X.copy(G.normals[Pe]).multiplyScalar(yt.x),q.copy(G.binormals[Pe]).multiplyScalar(yt.y),te.copy(F[Pe]).add(X).add(q),ft(te.x,te.y,te.z)):ft(yt.x,yt.y,x/_*Pe)}for(let Pe=D-1;Pe>=0;Pe--){const pt=Pe/D,yt=T*Math.cos(pt*Math.PI/2),At=I*Math.sin(pt*Math.PI/2)+k;for(let Be=0,ue=fe.length;Be<ue;Be++){const se=Ce(fe[Be],pe[Be],At);ft(se.x,se.y,x+yt)}for(let Be=0,ue=ge.length;Be<ue;Be++){const se=ge[Be];ae=Ae[Be];for(let ve=0,$e=se.length;ve<$e;ve++){const De=Ce(se[ve],ae[ve],At);B?ft(De.x,De.y+F[_-1].y,F[_-1].x+yt):ft(De.x,De.y,x+yt)}}}Xe(),Ke();function Xe(){const Pe=s.length/3;if(S){let pt=0,yt=Le*pt;for(let At=0;At<Ge;At++){const Be=be[At];Rt(Be[2]+yt,Be[1]+yt,Be[0]+yt)}pt=_+D*2,yt=Le*pt;for(let At=0;At<Ge;At++){const Be=be[At];Rt(Be[0]+yt,Be[1]+yt,Be[2]+yt)}}else{for(let pt=0;pt<Ge;pt++){const yt=be[pt];Rt(yt[2],yt[1],yt[0])}for(let pt=0;pt<Ge;pt++){const yt=be[pt];Rt(yt[0]+Le*_,yt[1]+Le*_,yt[2]+Le*_)}}o.addGroup(Pe,s.length/3-Pe,0)}function Ke(){const Pe=s.length/3;let pt=0;Ue(fe,pt),pt+=fe.length;for(let yt=0,At=ge.length;yt<At;yt++){const Be=ge[yt];Ue(Be,pt),pt+=Be.length}o.addGroup(Pe,s.length/3-Pe,1)}function Ue(Pe,pt){let yt=Pe.length;for(;--yt>=0;){const At=yt;let Be=yt-1;Be<0&&(Be=Pe.length-1);for(let ue=0,se=_+D*2;ue<se;ue++){const ve=Le*ue,$e=Le*(ue+1),De=pt+At+ve,st=pt+Be+ve,de=pt+Be+$e,ne=pt+At+$e;kt(De,st,de,ne)}}}function ft(Pe,pt,yt){m.push(Pe),m.push(pt),m.push(yt)}function Rt(Pe,pt,yt){Jt(Pe),Jt(pt),Jt(yt);const At=s.length/3,Be=O.generateTopUV(o,s,At-3,At-2,At-1);It(Be[0]),It(Be[1]),It(Be[2])}function kt(Pe,pt,yt,At){Jt(Pe),Jt(pt),Jt(At),Jt(pt),Jt(yt),Jt(At);const Be=s.length/3,ue=O.generateSideWallUV(o,s,Be-6,Be-3,Be-2,Be-1);It(ue[0]),It(ue[1]),It(ue[3]),It(ue[1]),It(ue[2]),It(ue[3])}function Jt(Pe){s.push(m[Pe*3+0]),s.push(m[Pe*3+1]),s.push(m[Pe*3+2])}function It(Pe){c.push(Pe.x),c.push(Pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),a=this.parameters.shapes,o=this.parameters.options;return D2e(a,o,e)}static fromJSON(e,a){const o=[];for(let c=0,d=e.shapes.length;c<d;c++){const f=a[e.shapes[c]];o.push(f)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new tM[s.type]().fromJSON(s)),new ZT(o,e.options)}}const k2e={generateTopUV:function(n,e,a,o,s){const c=e[a*3],d=e[a*3+1],f=e[o*3],m=e[o*3+1],y=e[s*3],_=e[s*3+1];return[new Kt(c,d),new Kt(f,m),new Kt(y,_)]},generateSideWallUV:function(n,e,a,o,s,c){const d=e[a*3],f=e[a*3+1],m=e[a*3+2],y=e[o*3],_=e[o*3+1],x=e[o*3+2],S=e[s*3],T=e[s*3+1],I=e[s*3+2],k=e[c*3],D=e[c*3+1],L=e[c*3+2];return Math.abs(f-_)<Math.abs(d-y)?[new Kt(d,1-m),new Kt(y,1-x),new Kt(S,1-I),new Kt(k,1-L)]:[new Kt(f,1-m),new Kt(_,1-x),new Kt(T,1-I),new Kt(D,1-L)]}};function D2e(n,e,a){if(a.shapes=[],Array.isArray(n))for(let o=0,s=n.length;o<s;o++){const c=n[o];a.shapes.push(c.uuid)}else a.shapes.push(n.uuid);return a.options=Object.assign({},e),e.extrudePath!==void 0&&(a.options.extrudePath=e.extrudePath.toJSON()),a}class KT extends Cp{constructor(e=1,a=0){const o=(1+Math.sqrt(5))/2,s=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],c=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,c,e,a),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new KT(e.radius,e.detail)}}class Fw extends Cp{constructor(e=1,a=0){const o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(o,s,e,a),this.type="OctahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new Fw(e.radius,e.detail)}}class JT extends La{constructor(e=.5,a=1,o=32,s=1,c=0,d=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:a,thetaSegments:o,phiSegments:s,thetaStart:c,thetaLength:d},o=Math.max(3,o),s=Math.max(1,s);const f=[],m=[],y=[],_=[];let x=e;const S=(a-e)/s,T=new Fe,I=new Kt;for(let k=0;k<=s;k++){for(let D=0;D<=o;D++){const L=c+D/o*d;T.x=x*Math.cos(L),T.y=x*Math.sin(L),m.push(T.x,T.y,T.z),y.push(0,0,1),I.x=(T.x/a+1)/2,I.y=(T.y/a+1)/2,_.push(I.x,I.y)}x+=S}for(let k=0;k<s;k++){const D=k*(o+1);for(let L=0;L<o;L++){const O=L+D,F=O,B=O+o+1,G=O+o+2,q=O+1;f.push(F,B,q),f.push(B,G,q)}}this.setIndex(f),this.setAttribute("position",new Wn(m,3)),this.setAttribute("normal",new Wn(y,3)),this.setAttribute("uv",new Wn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new JT(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class QT extends La{constructor(e=new wg([new Kt(0,.5),new Kt(-.5,-.5),new Kt(.5,-.5)]),a=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:a};const o=[],s=[],c=[],d=[];let f=0,m=0;if(Array.isArray(e)===!1)y(e);else for(let _=0;_<e.length;_++)y(e[_]),this.addGroup(f,m,_),f+=m,m=0;this.setIndex(o),this.setAttribute("position",new Wn(s,3)),this.setAttribute("normal",new Wn(c,3)),this.setAttribute("uv",new Wn(d,2));function y(_){const x=s.length/3,S=_.extractPoints(a);let T=S.shape;const I=S.holes;pd.isClockWise(T)===!1&&(T=T.reverse());for(let D=0,L=I.length;D<L;D++){const O=I[D];pd.isClockWise(O)===!0&&(I[D]=O.reverse())}const k=pd.triangulateShape(T,I);for(let D=0,L=I.length;D<L;D++){const O=I[D];T=T.concat(O)}for(let D=0,L=T.length;D<L;D++){const O=T[D];s.push(O.x,O.y,0),c.push(0,0,1),d.push(O.x,O.y)}for(let D=0,L=k.length;D<L;D++){const O=k[D],F=O[0]+x,B=O[1]+x,G=O[2]+x;o.push(F,B,G),m+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),a=this.parameters.shapes;return O2e(a,e)}static fromJSON(e,a){const o=[];for(let s=0,c=e.shapes.length;s<c;s++){const d=a[e.shapes[s]];o.push(d)}return new QT(o,e.curveSegments)}}function O2e(n,e){if(e.shapes=[],Array.isArray(n))for(let a=0,o=n.length;a<o;a++){const s=n[a];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class Nw extends La{constructor(e=1,a=32,o=16,s=0,c=Math.PI*2,d=0,f=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:a,heightSegments:o,phiStart:s,phiLength:c,thetaStart:d,thetaLength:f},a=Math.max(3,Math.floor(a)),o=Math.max(2,Math.floor(o));const m=Math.min(d+f,Math.PI);let y=0;const _=[],x=new Fe,S=new Fe,T=[],I=[],k=[],D=[];for(let L=0;L<=o;L++){const O=[],F=L/o;let B=0;L===0&&d===0?B=.5/a:L===o&&m===Math.PI&&(B=-.5/a);for(let G=0;G<=a;G++){const q=G/a;x.x=-e*Math.cos(s+q*c)*Math.sin(d+F*f),x.y=e*Math.cos(d+F*f),x.z=e*Math.sin(s+q*c)*Math.sin(d+F*f),I.push(x.x,x.y,x.z),S.copy(x).normalize(),k.push(S.x,S.y,S.z),D.push(q+B,1-F),O.push(y++)}_.push(O)}for(let L=0;L<o;L++)for(let O=0;O<a;O++){const F=_[L][O+1],B=_[L][O],G=_[L+1][O],q=_[L+1][O+1];(L!==0||d>0)&&T.push(F,B,q),(L!==o-1||m<Math.PI)&&T.push(B,G,q)}this.setIndex(T),this.setAttribute("position",new Wn(I,3)),this.setAttribute("normal",new Wn(k,3)),this.setAttribute("uv",new Wn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nw(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class eC extends Cp{constructor(e=1,a=0){const o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(o,s,e,a),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:a}}static fromJSON(e){return new eC(e.radius,e.detail)}}class tC extends La{constructor(e=1,a=.4,o=12,s=48,c=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:a,radialSegments:o,tubularSegments:s,arc:c},o=Math.floor(o),s=Math.floor(s);const d=[],f=[],m=[],y=[],_=new Fe,x=new Fe,S=new Fe;for(let T=0;T<=o;T++)for(let I=0;I<=s;I++){const k=I/s*c,D=T/o*Math.PI*2;x.x=(e+a*Math.cos(D))*Math.cos(k),x.y=(e+a*Math.cos(D))*Math.sin(k),x.z=a*Math.sin(D),f.push(x.x,x.y,x.z),_.x=e*Math.cos(k),_.y=e*Math.sin(k),S.subVectors(x,_).normalize(),m.push(S.x,S.y,S.z),y.push(I/s),y.push(T/o)}for(let T=1;T<=o;T++)for(let I=1;I<=s;I++){const k=(s+1)*T+I-1,D=(s+1)*(T-1)+I-1,L=(s+1)*(T-1)+I,O=(s+1)*T+I;d.push(k,D,O),d.push(D,L,O)}this.setIndex(d),this.setAttribute("position",new Wn(f,3)),this.setAttribute("normal",new Wn(m,3)),this.setAttribute("uv",new Wn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class nC extends La{constructor(e=1,a=.4,o=64,s=8,c=2,d=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:a,tubularSegments:o,radialSegments:s,p:c,q:d},o=Math.floor(o),s=Math.floor(s);const f=[],m=[],y=[],_=[],x=new Fe,S=new Fe,T=new Fe,I=new Fe,k=new Fe,D=new Fe,L=new Fe;for(let F=0;F<=o;++F){const B=F/o*c*Math.PI*2;O(B,c,d,e,T),O(B+.01,c,d,e,I),D.subVectors(I,T),L.addVectors(I,T),k.crossVectors(D,L),L.crossVectors(k,D),k.normalize(),L.normalize();for(let G=0;G<=s;++G){const q=G/s*Math.PI*2,X=-a*Math.cos(q),te=a*Math.sin(q);x.x=T.x+(X*L.x+te*k.x),x.y=T.y+(X*L.y+te*k.y),x.z=T.z+(X*L.z+te*k.z),m.push(x.x,x.y,x.z),S.subVectors(x,T).normalize(),y.push(S.x,S.y,S.z),_.push(F/o),_.push(G/s)}}for(let F=1;F<=o;F++)for(let B=1;B<=s;B++){const G=(s+1)*(F-1)+(B-1),q=(s+1)*F+(B-1),X=(s+1)*F+B,te=(s+1)*(F-1)+B;f.push(G,q,te),f.push(q,X,te)}this.setIndex(f),this.setAttribute("position",new Wn(m,3)),this.setAttribute("normal",new Wn(y,3)),this.setAttribute("uv",new Wn(_,2));function O(F,B,G,q,X){const te=Math.cos(F),V=Math.sin(F),Q=G/B*F,ge=Math.cos(Q);X.x=q*(2+ge)*.5*te,X.y=q*(2+ge)*V*.5,X.z=q*Math.sin(Q)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nC(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class aC extends La{constructor(e=new y6(new Fe(-1,-1,0),new Fe(-1,1,0),new Fe(1,1,0)),a=64,o=1,s=8,c=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:a,radius:o,radialSegments:s,closed:c};const d=e.computeFrenetFrames(a,c);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;const f=new Fe,m=new Fe,y=new Kt;let _=new Fe;const x=[],S=[],T=[],I=[];k(),this.setIndex(I),this.setAttribute("position",new Wn(x,3)),this.setAttribute("normal",new Wn(S,3)),this.setAttribute("uv",new Wn(T,2));function k(){for(let F=0;F<a;F++)D(F);D(c===!1?a:0),O(),L()}function D(F){_=e.getPointAt(F/a,_);const B=d.normals[F],G=d.binormals[F];for(let q=0;q<=s;q++){const X=q/s*Math.PI*2,te=Math.sin(X),V=-Math.cos(X);m.x=V*B.x+te*G.x,m.y=V*B.y+te*G.y,m.z=V*B.z+te*G.z,m.normalize(),S.push(m.x,m.y,m.z),f.x=_.x+o*m.x,f.y=_.y+o*m.y,f.z=_.z+o*m.z,x.push(f.x,f.y,f.z)}}function L(){for(let F=1;F<=a;F++)for(let B=1;B<=s;B++){const G=(s+1)*(F-1)+(B-1),q=(s+1)*F+(B-1),X=(s+1)*F+B,te=(s+1)*(F-1)+B;I.push(G,q,te),I.push(q,X,te)}}function O(){for(let F=0;F<=a;F++)for(let B=0;B<=s;B++)y.x=F/a,y.y=B/s,T.push(y.x,y.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new aC(new tM[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class bZ extends La{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const a=[],o=new Set,s=new Fe,c=new Fe;if(e.index!==null){const d=e.attributes.position,f=e.index;let m=e.groups;m.length===0&&(m=[{start:0,count:f.count,materialIndex:0}]);for(let y=0,_=m.length;y<_;++y){const x=m[y],S=x.start,T=x.count;for(let I=S,k=S+T;I<k;I+=3)for(let D=0;D<3;D++){const L=f.getX(I+D),O=f.getX(I+(D+1)%3);s.fromBufferAttribute(d,L),c.fromBufferAttribute(d,O),pV(s,c,o)===!0&&(a.push(s.x,s.y,s.z),a.push(c.x,c.y,c.z))}}}else{const d=e.attributes.position;for(let f=0,m=d.count/3;f<m;f++)for(let y=0;y<3;y++){const _=3*f+y,x=3*f+(y+1)%3;s.fromBufferAttribute(d,_),c.fromBufferAttribute(d,x),pV(s,c,o)===!0&&(a.push(s.x,s.y,s.z),a.push(c.x,c.y,c.z))}}this.setAttribute("position",new Wn(a,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function pV(n,e,a){const o=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return a.has(o)===!0||a.has(s)===!0?!1:(a.add(o),a.add(s),!0)}var mV=Object.freeze({__proto__:null,BoxGeometry:jg,CapsuleGeometry:jT,CircleGeometry:$T,ConeGeometry:qT,CylinderGeometry:v_,DodecahedronGeometry:XT,EdgesGeometry:gZ,ExtrudeGeometry:ZT,IcosahedronGeometry:KT,LatheGeometry:zw,OctahedronGeometry:Fw,PlaneGeometry:Tp,PolyhedronGeometry:Cp,RingGeometry:JT,ShapeGeometry:QT,SphereGeometry:Nw,TetrahedronGeometry:eC,TorusGeometry:tC,TorusKnotGeometry:nC,TubeGeometry:aC,WireframeGeometry:bZ});class xZ extends as{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Pn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class wZ extends _d{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class _6 extends as{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class SZ extends _6{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Kt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return $r(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(a){this.ior=(1+.4*a)/(1-.4*a)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class AZ extends as{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pn(16777215),this.specular=new Pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class EZ extends as{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class MZ extends as{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class TZ extends as{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Lw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CZ extends as{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Mp,this.normalScale=new Kt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class PZ extends qs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function fg(n,e,a){return!n||!a&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function IZ(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function LZ(n){function e(s,c){return n[s]-n[c]}const a=n.length,o=new Array(a);for(let s=0;s!==a;++s)o[s]=s;return o.sort(e),o}function RR(n,e,a){const o=n.length,s=new n.constructor(o);for(let c=0,d=0;d!==o;++c){const f=a[c]*e;for(let m=0;m!==e;++m)s[d++]=n[f+m]}return s}function b6(n,e,a,o){let s=1,c=n[0];for(;c!==void 0&&c[o]===void 0;)c=n[s++];if(c===void 0)return;let d=c[o];if(d!==void 0)if(Array.isArray(d))do d=c[o],d!==void 0&&(e.push(c.time),a.push.apply(a,d)),c=n[s++];while(c!==void 0);else if(d.toArray!==void 0)do d=c[o],d!==void 0&&(e.push(c.time),d.toArray(a,a.length)),c=n[s++];while(c!==void 0);else do d=c[o],d!==void 0&&(e.push(c.time),a.push(d)),c=n[s++];while(c!==void 0)}function z2e(n,e,a,o,s=30){const c=n.clone();c.name=e;const d=[];for(let m=0;m<c.tracks.length;++m){const y=c.tracks[m],_=y.getValueSize(),x=[],S=[];for(let T=0;T<y.times.length;++T){const I=y.times[T]*s;if(!(I<a||I>=o)){x.push(y.times[T]);for(let k=0;k<_;++k)S.push(y.values[T*_+k])}}x.length!==0&&(y.times=fg(x,y.times.constructor),y.values=fg(S,y.values.constructor),d.push(y))}c.tracks=d;let f=1/0;for(let m=0;m<c.tracks.length;++m)f>c.tracks[m].times[0]&&(f=c.tracks[m].times[0]);for(let m=0;m<c.tracks.length;++m)c.tracks[m].shift(-1*f);return c.resetDuration(),c}function F2e(n,e=0,a=n,o=30){o<=0&&(o=30);const s=a.tracks.length,c=e/o;for(let d=0;d<s;++d){const f=a.tracks[d],m=f.ValueTypeName;if(m==="bool"||m==="string")continue;const y=n.tracks.find(function(L){return L.name===f.name&&L.ValueTypeName===m});if(y===void 0)continue;let _=0;const x=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);let S=0;const T=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(S=T/3);const I=f.times.length-1;let k;if(c<=f.times[0]){const L=_,O=x-_;k=f.values.slice(L,O)}else if(c>=f.times[I]){const L=I*x+_,O=L+x-_;k=f.values.slice(L,O)}else{const L=f.createInterpolant(),O=_,F=x-_;L.evaluate(c),k=L.resultBuffer.slice(O,F)}m==="quaternion"&&new As().fromArray(k).normalize().conjugate().toArray(k);const D=y.times.length;for(let L=0;L<D;++L){const O=L*T+S;if(m==="quaternion")As.multiplyQuaternionsFlat(y.values,O,k,0,y.values,O);else{const F=T-S*2;for(let B=0;B<F;++B)y.values[O+B]-=k[B]}}}return n.blendMode=QD,n}const N2e={convertArray:fg,isTypedArray:IZ,getKeyframeOrder:LZ,sortedArray:RR,flattenJSON:b6,subclip:z2e,makeClipAdditive:F2e};class Bw{constructor(e,a,o,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new a.constructor(o),this.sampleValues=a,this.valueSize=o,this.settings=null,this.DefaultSettings_={}}evaluate(e){const a=this.parameterPositions;let o=this._cachedIndex,s=a[o],c=a[o-1];e:{t:{let d;n:{a:if(!(e<s)){for(let f=o+2;;){if(s===void 0){if(e<c)break a;return o=a.length,this._cachedIndex=o,this.copySampleValue_(o-1)}if(o===f)break;if(c=s,s=a[++o],e<s)break t}d=a.length;break n}if(!(e>=c)){const f=a[1];e<f&&(o=2,c=f);for(let m=o-2;;){if(c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===m)break;if(s=c,c=a[--o-1],e>=c)break t}d=o,o=0;break n}break e}for(;o<d;){const f=o+d>>>1;e<a[f]?d=f:o=f+1}if(s=a[o],c=a[o-1],c===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return o=a.length,this._cachedIndex=o,this.copySampleValue_(o-1)}this._cachedIndex=o,this.intervalChanged_(o,c,s)}return this.interpolate_(o,c,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,c=e*s;for(let d=0;d!==s;++d)a[d]=o[c+d];return a}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class RZ extends Bw{constructor(e,a,o,s){super(e,a,o,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:ug,endingEnd:ug}}intervalChanged_(e,a,o){const s=this.parameterPositions;let c=e-2,d=e+1,f=s[c],m=s[d];if(f===void 0)switch(this.getSettings_().endingStart){case dg:c=e,f=2*a-o;break;case Hx:c=s.length-2,f=a+s[c]-s[c+1];break;default:c=e,f=o}if(m===void 0)switch(this.getSettings_().endingEnd){case dg:d=e,m=2*o-a;break;case Hx:d=1,m=o+s[1]-s[0];break;default:d=e-1,m=a}const y=(o-a)*.5,_=this.valueSize;this._weightPrev=y/(a-f),this._weightNext=y/(m-o),this._offsetPrev=c*_,this._offsetNext=d*_}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=e*f,y=m-f,_=this._offsetPrev,x=this._offsetNext,S=this._weightPrev,T=this._weightNext,I=(o-a)/(s-a),k=I*I,D=k*I,L=-S*D+2*S*k-S*I,O=(1+S)*D+(-1.5-2*S)*k+(-.5+S)*I+1,F=(-1-T)*D+(1.5+T)*k+.5*I,B=T*D-T*k;for(let G=0;G!==f;++G)c[G]=L*d[_+G]+O*d[y+G]+F*d[m+G]+B*d[x+G];return c}}class x6 extends Bw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=e*f,y=m-f,_=(o-a)/(s-a),x=1-_;for(let S=0;S!==f;++S)c[S]=d[y+S]*x+d[m+S]*_;return c}}class kZ extends Bw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class vu{constructor(e,a,o,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(a===void 0||a.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fg(a,this.TimeBufferType),this.values=fg(o,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const a=e.constructor;let o;if(a.toJSON!==this.toJSON)o=a.toJSON(e);else{o={name:e.name,times:fg(e.times,Array),values:fg(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(o.interpolation=s)}return o.type=e.ValueTypeName,o}InterpolantFactoryMethodDiscrete(e){return new kZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new x6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new RZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let a;switch(e){case Vx:a=this.InterpolantFactoryMethodDiscrete;break;case Gx:a=this.InterpolantFactoryMethodLinear;break;case QA:a=this.InterpolantFactoryMethodSmooth;break}if(a===void 0){const o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=a,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vx;case this.InterpolantFactoryMethodLinear:return Gx;case this.InterpolantFactoryMethodSmooth:return QA}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const a=this.times;for(let o=0,s=a.length;o!==s;++o)a[o]+=e}return this}scale(e){if(e!==1){const a=this.times;for(let o=0,s=a.length;o!==s;++o)a[o]*=e}return this}trim(e,a){const o=this.times,s=o.length;let c=0,d=s-1;for(;c!==s&&o[c]<e;)++c;for(;d!==-1&&o[d]>a;)--d;if(++d,c!==0||d!==s){c>=d&&(d=Math.max(d,1),c=d-1);const f=this.getValueSize();this.times=o.slice(c,d),this.values=this.values.slice(c*f,d*f)}return this}validate(){let e=!0;const a=this.getValueSize();a-Math.floor(a)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const o=this.times,s=this.values,c=o.length;c===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let f=0;f!==c;f++){const m=o[f];if(typeof m=="number"&&isNaN(m)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,m),e=!1;break}if(d!==null&&d>m){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,m,d),e=!1;break}d=m}if(s!==void 0&&IZ(s))for(let f=0,m=s.length;f!==m;++f){const y=s[f];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,y),e=!1;break}}return e}optimize(){const e=this.times.slice(),a=this.values.slice(),o=this.getValueSize(),s=this.getInterpolation()===QA,c=e.length-1;let d=1;for(let f=1;f<c;++f){let m=!1;const y=e[f],_=e[f+1];if(y!==_&&(f!==1||y!==e[0]))if(s)m=!0;else{const x=f*o,S=x-o,T=x+o;for(let I=0;I!==o;++I){const k=a[x+I];if(k!==a[S+I]||k!==a[T+I]){m=!0;break}}}if(m){if(f!==d){e[d]=e[f];const x=f*o,S=d*o;for(let T=0;T!==o;++T)a[S+T]=a[x+T]}++d}}if(c>0){e[d]=e[c];for(let f=c*o,m=d*o,y=0;y!==o;++y)a[m+y]=a[f+y];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=a.slice(0,d*o)):(this.times=e,this.values=a),this}clone(){const e=this.times.slice(),a=this.values.slice(),o=this.constructor,s=new o(this.name,e,a);return s.createInterpolant=this.createInterpolant,s}}vu.prototype.TimeBufferType=Float32Array;vu.prototype.ValueBufferType=Float32Array;vu.prototype.DefaultInterpolation=Gx;class $g extends vu{}$g.prototype.ValueTypeName="bool";$g.prototype.ValueBufferType=Array;$g.prototype.DefaultInterpolation=Vx;$g.prototype.InterpolantFactoryMethodLinear=void 0;$g.prototype.InterpolantFactoryMethodSmooth=void 0;class w6 extends vu{}w6.prototype.ValueTypeName="color";class tw extends vu{}tw.prototype.ValueTypeName="number";class DZ extends Bw{constructor(e,a,o,s){super(e,a,o,s)}interpolate_(e,a,o,s){const c=this.resultBuffer,d=this.sampleValues,f=this.valueSize,m=(o-a)/(s-a);let y=e*f;for(let _=y+f;y!==_;y+=4)As.slerpFlat(c,0,d,y-f,d,y,m);return c}}class __ extends vu{InterpolantFactoryMethodLinear(e){return new DZ(this.times,this.values,this.getValueSize(),e)}}__.prototype.ValueTypeName="quaternion";__.prototype.DefaultInterpolation=Gx;__.prototype.InterpolantFactoryMethodSmooth=void 0;class qg extends vu{}qg.prototype.ValueTypeName="string";qg.prototype.ValueBufferType=Array;qg.prototype.DefaultInterpolation=Vx;qg.prototype.InterpolantFactoryMethodLinear=void 0;qg.prototype.InterpolantFactoryMethodSmooth=void 0;class nw extends vu{}nw.prototype.ValueTypeName="vector";class aw{constructor(e,a=-1,o,s=RT){this.name=e,this.tracks=o,this.duration=a,this.blendMode=s,this.uuid=Zl(),this.duration<0&&this.resetDuration()}static parse(e){const a=[],o=e.tracks,s=1/(e.fps||1);for(let d=0,f=o.length;d!==f;++d)a.push(U2e(o[d]).scale(s));const c=new this(e.name,e.duration,a,e.blendMode);return c.uuid=e.uuid,c}static toJSON(e){const a=[],o=e.tracks,s={name:e.name,duration:e.duration,tracks:a,uuid:e.uuid,blendMode:e.blendMode};for(let c=0,d=o.length;c!==d;++c)a.push(vu.toJSON(o[c]));return s}static CreateFromMorphTargetSequence(e,a,o,s){const c=a.length,d=[];for(let f=0;f<c;f++){let m=[],y=[];m.push((f+c-1)%c,f,(f+1)%c),y.push(0,1,0);const _=LZ(m);m=RR(m,1,_),y=RR(y,1,_),!s&&m[0]===0&&(m.push(c),y.push(y[0])),d.push(new tw(".morphTargetInfluences["+a[f].name+"]",m,y).scale(1/o))}return new this(e,-1,d)}static findByName(e,a){let o=e;if(!Array.isArray(e)){const s=e;o=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<o.length;s++)if(o[s].name===a)return o[s];return null}static CreateClipsFromMorphTargetSequences(e,a,o){const s={},c=/^([\w-]*?)([\d]+)$/;for(let f=0,m=e.length;f<m;f++){const y=e[f],_=y.name.match(c);if(_&&_.length>1){const x=_[1];let S=s[x];S||(s[x]=S=[]),S.push(y)}}const d=[];for(const f in s)d.push(this.CreateFromMorphTargetSequence(f,s[f],a,o));return d}static parseAnimation(e,a){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const o=function(x,S,T,I,k){if(T.length!==0){const D=[],L=[];b6(T,D,L,I),D.length!==0&&k.push(new x(S,D,L))}},s=[],c=e.name||"default",d=e.fps||30,f=e.blendMode;let m=e.length||-1;const y=e.hierarchy||[];for(let x=0;x<y.length;x++){const S=y[x].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const T={};let I;for(I=0;I<S.length;I++)if(S[I].morphTargets)for(let k=0;k<S[I].morphTargets.length;k++)T[S[I].morphTargets[k]]=-1;for(const k in T){const D=[],L=[];for(let O=0;O!==S[I].morphTargets.length;++O){const F=S[I];D.push(F.time),L.push(F.morphTarget===k?1:0)}s.push(new tw(".morphTargetInfluence["+k+"]",D,L))}m=T.length*d}else{const T=".bones["+a[x].name+"]";o(nw,T+".position",S,"pos",s),o(__,T+".quaternion",S,"rot",s),o(nw,T+".scale",S,"scl",s)}}return s.length===0?null:new this(c,m,s,f)}resetDuration(){const e=this.tracks;let a=0;for(let o=0,s=e.length;o!==s;++o){const c=this.tracks[o];a=Math.max(a,c.times[c.times.length-1])}return this.duration=a,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let a=0;a<this.tracks.length;a++)e=e&&this.tracks[a].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let a=0;a<this.tracks.length;a++)e.push(this.tracks[a].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function B2e(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return tw;case"vector":case"vector2":case"vector3":case"vector4":return nw;case"color":return w6;case"quaternion":return __;case"bool":case"boolean":return $g;case"string":return qg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function U2e(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=B2e(n.type);if(n.times===void 0){const a=[],o=[];b6(n.keys,a,o,"value"),n.times=a,n.values=o}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Fg={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class S6{constructor(e,a,o){const s=this;let c=!1,d=0,f=0,m;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=a,this.onError=o,this.itemStart=function(_){f++,c===!1&&s.onStart!==void 0&&s.onStart(_,d,f),c=!0},this.itemEnd=function(_){d++,s.onProgress!==void 0&&s.onProgress(_,d,f),d===f&&(c=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(_){s.onError!==void 0&&s.onError(_)},this.resolveURL=function(_){return m?m(_):_},this.setURLModifier=function(_){return m=_,this},this.addHandler=function(_,x){return y.push(_,x),this},this.removeHandler=function(_){const x=y.indexOf(_);return x!==-1&&y.splice(x,2),this},this.getHandler=function(_){for(let x=0,S=y.length;x<S;x+=2){const T=y[x],I=y[x+1];if(T.global&&(T.lastIndex=0),T.test(_))return I}return null}}}const OZ=new S6;class Ml{constructor(e){this.manager=e!==void 0?e:OZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,a){const o=this;return new Promise(function(s,c){o.load(e,s,a,c)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Ml.DEFAULT_MATERIAL_NAME="__DEFAULT";const dh={};class W2e extends Error{constructor(e,a){super(e),this.response=a}}class Bh extends Ml{constructor(e){super(e)}load(e,a,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=Fg.get(e);if(c!==void 0)return this.manager.itemStart(e),setTimeout(()=>{a&&a(c),this.manager.itemEnd(e)},0),c;if(dh[e]!==void 0){dh[e].push({onLoad:a,onProgress:o,onError:s});return}dh[e]=[],dh[e].push({onLoad:a,onProgress:o,onError:s});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,m=this.responseType;fetch(d).then(y=>{if(y.status===200||y.status===0){if(y.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||y.body===void 0||y.body.getReader===void 0)return y;const _=dh[e],x=y.body.getReader(),S=y.headers.get("Content-Length")||y.headers.get("X-File-Size"),T=S?parseInt(S):0,I=T!==0;let k=0;const D=new ReadableStream({start(L){O();function O(){x.read().then(({done:F,value:B})=>{if(F)L.close();else{k+=B.byteLength;const G=new ProgressEvent("progress",{lengthComputable:I,loaded:k,total:T});for(let q=0,X=_.length;q<X;q++){const te=_[q];te.onProgress&&te.onProgress(G)}L.enqueue(B),O()}})}}});return new Response(D)}else throw new W2e(`fetch for "${y.url}" responded with ${y.status}: ${y.statusText}`,y)}).then(y=>{switch(m){case"arraybuffer":return y.arrayBuffer();case"blob":return y.blob();case"document":return y.text().then(_=>new DOMParser().parseFromString(_,f));case"json":return y.json();default:if(f===void 0)return y.text();{const x=/charset="?([^;"\s]*)"?/i.exec(f),S=x&&x[1]?x[1].toLowerCase():void 0,T=new TextDecoder(S);return y.arrayBuffer().then(I=>T.decode(I))}}}).then(y=>{Fg.add(e,y);const _=dh[e];delete dh[e];for(let x=0,S=_.length;x<S;x++){const T=_[x];T.onLoad&&T.onLoad(y)}}).catch(y=>{const _=dh[e];if(_===void 0)throw this.manager.itemError(e),y;delete dh[e];for(let x=0,S=_.length;x<S;x++){const T=_[x];T.onError&&T.onError(y)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class V2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Bh(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a=[];for(let o=0;o<e.length;o++){const s=aw.parse(e[o]);a.push(s)}return a}}class G2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=[],f=new GT,m=new Bh(this.manager);m.setPath(this.path),m.setResponseType("arraybuffer"),m.setRequestHeader(this.requestHeader),m.setWithCredentials(c.withCredentials);let y=0;function _(x){m.load(e[x],function(S){const T=c.parse(S,!0);d[x]={width:T.width,height:T.height,format:T.format,mipmaps:T.mipmaps},y+=1,y===6&&(T.mipmapCount===1&&(f.minFilter=Ir),f.image=d,f.format=T.format,f.needsUpdate=!0,a&&a(f))},o,s)}if(Array.isArray(e))for(let x=0,S=e.length;x<S;++x)_(x);else m.load(e,function(x){const S=c.parse(x,!0);if(S.isCubemap){const T=S.mipmaps.length/S.mipmapCount;for(let I=0;I<T;I++){d[I]={mipmaps:[]};for(let k=0;k<S.mipmapCount;k++)d[I].mipmaps.push(S.mipmaps[I*S.mipmapCount+k]),d[I].format=S.format,d[I].width=S.width,d[I].height=S.height}f.image=d}else f.image.width=S.width,f.image.height=S.height,f.mipmaps=S.mipmaps;S.mipmapCount===1&&(f.minFilter=Ir),f.format=S.format,f.needsUpdate=!0,a&&a(f)},o,s);return f}}class iw extends Ml{constructor(e){super(e)}load(e,a,o,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,d=Fg.get(e);if(d!==void 0)return c.manager.itemStart(e),setTimeout(function(){a&&a(d),c.manager.itemEnd(e)},0),d;const f=Zx("img");function m(){_(),Fg.add(e,this),a&&a(this),c.manager.itemEnd(e)}function y(x){_(),s&&s(x),c.manager.itemError(e),c.manager.itemEnd(e)}function _(){f.removeEventListener("load",m,!1),f.removeEventListener("error",y,!1)}return f.addEventListener("load",m,!1),f.addEventListener("error",y,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),c.manager.itemStart(e),f.src=e,f}}class H2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=new Ow;c.colorSpace=Io;const d=new iw(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);let f=0;function m(y){d.load(e[y],function(_){c.images[y]=_,f++,f===6&&(c.needsUpdate=!0,a&&a(c))},void 0,s)}for(let y=0;y<e.length;++y)m(y);return c}}class j2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new z0,f=new Bh(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(c.withCredentials),f.load(e,function(m){let y;try{y=c.parse(m)}catch(_){if(s!==void 0)s(_);else{console.error(_);return}}y.image!==void 0?d.image=y.image:y.data!==void 0&&(d.image.width=y.width,d.image.height=y.height,d.image.data=y.data),d.wrapS=y.wrapS!==void 0?y.wrapS:xs,d.wrapT=y.wrapT!==void 0?y.wrapT:xs,d.magFilter=y.magFilter!==void 0?y.magFilter:Ir,d.minFilter=y.minFilter!==void 0?y.minFilter:Ir,d.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.colorSpace!==void 0?d.colorSpace=y.colorSpace:y.encoding!==void 0&&(d.encoding=y.encoding),y.flipY!==void 0&&(d.flipY=y.flipY),y.format!==void 0&&(d.format=y.format),y.type!==void 0&&(d.type=y.type),y.mipmaps!==void 0&&(d.mipmaps=y.mipmaps,d.minFilter=_p),y.mipmapCount===1&&(d.minFilter=Ir),y.generateMipmaps!==void 0&&(d.generateMipmaps=y.generateMipmaps),d.needsUpdate=!0,a&&a(d,y)},o,s),d}}class zZ extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=new kr,d=new iw(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(f){c.image=f,c.needsUpdate=!0,a!==void 0&&a(c)},o,s),c}}class Pp extends pi{constructor(e,a=1){super(),this.isLight=!0,this.type="Light",this.color=new Pn(e),this.intensity=a}dispose(){}copy(e,a){return super.copy(e,a),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const a=super.toJSON(e);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,this.groundColor!==void 0&&(a.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(a.object.distance=this.distance),this.angle!==void 0&&(a.object.angle=this.angle),this.decay!==void 0&&(a.object.decay=this.decay),this.penumbra!==void 0&&(a.object.penumbra=this.penumbra),this.shadow!==void 0&&(a.object.shadow=this.shadow.toJSON()),a}}class FZ extends Pp{constructor(e,a,o){super(e,o),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(pi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pn(a)}copy(e,a){return super.copy(e,a),this.groundColor.copy(e.groundColor),this}}const K4=new Ia,gV=new Fe,yV=new Fe;class A6{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Kt(512,512),this.map=null,this.mapPass=null,this.matrix=new Ia,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new OT,this._frameExtents=new Kt(1,1),this._viewportCount=1,this._viewports=[new Ei(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const a=this.camera,o=this.matrix;gV.setFromMatrixPosition(e.matrixWorld),a.position.copy(gV),yV.setFromMatrixPosition(e.target.matrixWorld),a.lookAt(yV),a.updateMatrixWorld(),K4.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(K4),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(K4)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class $2e extends A6{constructor(){super(new qr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const a=this.camera,o=n_*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,c=e.distance||a.far;(o!==a.fov||s!==a.aspect||c!==a.far)&&(a.fov=o,a.aspect=s,a.far=c,a.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class NZ extends Pp{constructor(e,a,o=0,s=Math.PI/3,c=0,d=2){super(e,a),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(pi.DEFAULT_UP),this.updateMatrix(),this.target=new pi,this.distance=o,this.angle=s,this.penumbra=c,this.decay=d,this.map=null,this.shadow=new $2e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,a){return super.copy(e,a),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const vV=new Ia,db=new Fe,J4=new Fe;class q2e extends A6{constructor(){super(new qr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Kt(4,2),this._viewportCount=6,this._viewports=[new Ei(2,1,1,1),new Ei(0,1,1,1),new Ei(3,1,1,1),new Ei(1,1,1,1),new Ei(3,0,1,1),new Ei(1,0,1,1)],this._cubeDirections=[new Fe(1,0,0),new Fe(-1,0,0),new Fe(0,0,1),new Fe(0,0,-1),new Fe(0,1,0),new Fe(0,-1,0)],this._cubeUps=[new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,0,1),new Fe(0,0,-1)]}updateMatrices(e,a=0){const o=this.camera,s=this.matrix,c=e.distance||o.far;c!==o.far&&(o.far=c,o.updateProjectionMatrix()),db.setFromMatrixPosition(e.matrixWorld),o.position.copy(db),J4.copy(o.position),J4.add(this._cubeDirections[a]),o.up.copy(this._cubeUps[a]),o.lookAt(J4),o.updateMatrixWorld(),s.makeTranslation(-db.x,-db.y,-db.z),vV.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vV)}}class BZ extends Pp{constructor(e,a,o=0,s=2){super(e,a),this.isPointLight=!0,this.type="PointLight",this.distance=o,this.decay=s,this.shadow=new q2e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,a){return super.copy(e,a),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class X2e extends A6{constructor(){super(new Eh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class UZ extends Pp{constructor(e,a){super(e,a),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(pi.DEFAULT_UP),this.updateMatrix(),this.target=new pi,this.shadow=new X2e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class WZ extends Pp{constructor(e,a){super(e,a),this.isAmbientLight=!0,this.type="AmbientLight"}}class VZ extends Pp{constructor(e,a,o=10,s=10){super(e,a),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=o,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const a=super.toJSON(e);return a.object.width=this.width,a.object.height=this.height,a}}class GZ{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Fe)}set(e){for(let a=0;a<9;a++)this.coefficients[a].copy(e[a]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,a){const o=e.x,s=e.y,c=e.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.282095),a.addScaledVector(d[1],.488603*s),a.addScaledVector(d[2],.488603*c),a.addScaledVector(d[3],.488603*o),a.addScaledVector(d[4],1.092548*(o*s)),a.addScaledVector(d[5],1.092548*(s*c)),a.addScaledVector(d[6],.315392*(3*c*c-1)),a.addScaledVector(d[7],1.092548*(o*c)),a.addScaledVector(d[8],.546274*(o*o-s*s)),a}getIrradianceAt(e,a){const o=e.x,s=e.y,c=e.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.886227),a.addScaledVector(d[1],2*.511664*s),a.addScaledVector(d[2],2*.511664*c),a.addScaledVector(d[3],2*.511664*o),a.addScaledVector(d[4],2*.429043*o*s),a.addScaledVector(d[5],2*.429043*s*c),a.addScaledVector(d[6],.743125*c*c-.247708),a.addScaledVector(d[7],2*.429043*o*c),a.addScaledVector(d[8],.429043*(o*o-s*s)),a}add(e){for(let a=0;a<9;a++)this.coefficients[a].add(e.coefficients[a]);return this}addScaledSH(e,a){for(let o=0;o<9;o++)this.coefficients[o].addScaledVector(e.coefficients[o],a);return this}scale(e){for(let a=0;a<9;a++)this.coefficients[a].multiplyScalar(e);return this}lerp(e,a){for(let o=0;o<9;o++)this.coefficients[o].lerp(e.coefficients[o],a);return this}equals(e){for(let a=0;a<9;a++)if(!this.coefficients[a].equals(e.coefficients[a]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,a=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].fromArray(e,a+s*3);return this}toArray(e=[],a=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].toArray(e,a+s*3);return e}static getBasisAt(e,a){const o=e.x,s=e.y,c=e.z;a[0]=.282095,a[1]=.488603*s,a[2]=.488603*c,a[3]=.488603*o,a[4]=1.092548*o*s,a[5]=1.092548*s*c,a[6]=.315392*(3*c*c-1),a[7]=1.092548*o*c,a[8]=.546274*(o*o-s*s)}}class HZ extends Pp{constructor(e=new GZ,a=1){super(void 0,a),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const a=super.toJSON(e);return a.object.sh=this.sh.toArray(),a}}class iC extends Ml{constructor(e){super(e),this.textures={}}load(e,a,o,s){const c=this,d=new Bh(c.manager);d.setPath(c.path),d.setRequestHeader(c.requestHeader),d.setWithCredentials(c.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a=this.textures;function o(c){return a[c]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",c),a[c]}const s=iC.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Pn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const c in e.uniforms){const d=e.uniforms[c];switch(s.uniforms[c]={},d.type){case"t":s.uniforms[c].value=o(d.value);break;case"c":s.uniforms[c].value=new Pn().setHex(d.value);break;case"v2":s.uniforms[c].value=new Kt().fromArray(d.value);break;case"v3":s.uniforms[c].value=new Fe().fromArray(d.value);break;case"v4":s.uniforms[c].value=new Ei().fromArray(d.value);break;case"m3":s.uniforms[c].value=new Na().fromArray(d.value);break;case"m4":s.uniforms[c].value=new Ia().fromArray(d.value);break;default:s.uniforms[c].value=d.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const c in e.extensions)s.extensions[c]=e.extensions[c];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=o(e.map)),e.matcap!==void 0&&(s.matcap=o(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let c=e.normalScale;Array.isArray(c)===!1&&(c=[c,c]),s.normalScale=new Kt().fromArray(c)}return e.displacementMap!==void 0&&(s.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=o(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=o(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=o(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new Kt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=o(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=o(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=o(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=o(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=o(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=o(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=o(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const a={ShadowMaterial:xZ,SpriteMaterial:u6,RawShaderMaterial:wZ,ShaderMaterial:_d,PointsMaterial:h6,MeshPhysicalMaterial:SZ,MeshStandardMaterial:_6,MeshPhongMaterial:AZ,MeshToonMaterial:EZ,MeshNormalMaterial:MZ,MeshLambertMaterial:TZ,MeshDepthMaterial:FT,MeshDistanceMaterial:NT,MeshBasicMaterial:Hh,MeshMatcapMaterial:CZ,LineDashedMaterial:PZ,LineBasicMaterial:qs,Material:as};return new a[e]}}class kR{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let a="";for(let o=0,s=e.length;o<s;o++)a+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(a))}catch{return a}}static extractUrlBase(e){const a=e.lastIndexOf("/");return a===-1?"./":e.slice(0,a+1)}static resolveURL(e,a){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(a)&&/^\//.test(e)&&(a=a.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:a+e)}}class E6 extends La{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class jZ extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Bh(c.manager);d.setPath(c.path),d.setRequestHeader(c.requestHeader),d.setWithCredentials(c.withCredentials),d.load(e,function(f){try{a(c.parse(JSON.parse(f)))}catch(m){s?s(m):console.error(m),c.manager.itemError(e)}},o,s)}parse(e){const a={},o={};function s(T,I){if(a[I]!==void 0)return a[I];const D=T.interleavedBuffers[I],L=c(T,D.buffer),O=b0(D.type,L),F=new WT(O,D.stride);return F.uuid=D.uuid,a[I]=F,F}function c(T,I){if(o[I]!==void 0)return o[I];const D=T.arrayBuffers[I],L=new Uint32Array(D).buffer;return o[I]=L,L}const d=e.isInstancedBufferGeometry?new E6:new La,f=e.data.index;if(f!==void 0){const T=b0(f.type,f.array);d.setIndex(new Xi(T,1))}const m=e.data.attributes;for(const T in m){const I=m[T];let k;if(I.isInterleavedBufferAttribute){const D=s(e.data,I.data);k=new Dg(D,I.itemSize,I.offset,I.normalized)}else{const D=b0(I.type,I.array),L=I.isInstancedBufferAttribute?Og:Xi;k=new L(D,I.itemSize,I.normalized)}I.name!==void 0&&(k.name=I.name),I.usage!==void 0&&k.setUsage(I.usage),I.updateRange!==void 0&&(k.updateRange.offset=I.updateRange.offset,k.updateRange.count=I.updateRange.count),d.setAttribute(T,k)}const y=e.data.morphAttributes;if(y)for(const T in y){const I=y[T],k=[];for(let D=0,L=I.length;D<L;D++){const O=I[D];let F;if(O.isInterleavedBufferAttribute){const B=s(e.data,O.data);F=new Dg(B,O.itemSize,O.offset,O.normalized)}else{const B=b0(O.type,O.array);F=new Xi(B,O.itemSize,O.normalized)}O.name!==void 0&&(F.name=O.name),k.push(F)}d.morphAttributes[T]=k}e.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const x=e.data.groups||e.data.drawcalls||e.data.offsets;if(x!==void 0)for(let T=0,I=x.length;T!==I;++T){const k=x[T];d.addGroup(k.start,k.count,k.materialIndex)}const S=e.data.boundingSphere;if(S!==void 0){const T=new Fe;S.center!==void 0&&T.fromArray(S.center),d.boundingSphere=new Pc(T,S.radius)}return e.name&&(d.name=e.name),e.userData&&(d.userData=e.userData),d}}class Y2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=this.path===""?kR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const f=new Bh(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(m){let y=null;try{y=JSON.parse(m)}catch(x){s!==void 0&&s(x),console.error("THREE:ObjectLoader: Can't parse "+e+".",x.message);return}const _=y.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}c.parse(y,a)},o,s)}async loadAsync(e,a){const o=this,s=this.path===""?kR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const c=new Bh(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials);const d=await c.loadAsync(e,a),f=JSON.parse(d),m=f.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await o.parseAsync(f)}parse(e,a){const o=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),c=this.parseGeometries(e.geometries,s),d=this.parseImages(e.images,function(){a!==void 0&&a(y)}),f=this.parseTextures(e.textures,d),m=this.parseMaterials(e.materials,f),y=this.parseObject(e.object,c,m,f,o),_=this.parseSkeletons(e.skeletons,y);if(this.bindSkeletons(y,_),a!==void 0){let x=!1;for(const S in d)if(d[S].data instanceof HTMLImageElement){x=!0;break}x===!1&&a(y)}return y}async parseAsync(e){const a=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,o),c=await this.parseImagesAsync(e.images),d=this.parseTextures(e.textures,c),f=this.parseMaterials(e.materials,d),m=this.parseObject(e.object,s,f,d,a),y=this.parseSkeletons(e.skeletons,m);return this.bindSkeletons(m,y),m}parseShapes(e){const a={};if(e!==void 0)for(let o=0,s=e.length;o<s;o++){const c=new wg().fromJSON(e[o]);a[c.uuid]=c}return a}parseSkeletons(e,a){const o={},s={};if(a.traverse(function(c){c.isBone&&(s[c.uuid]=c)}),e!==void 0)for(let c=0,d=e.length;c<d;c++){const f=new VT().fromJSON(e[c],s);o[f.uuid]=f}return o}parseGeometries(e,a){const o={};if(e!==void 0){const s=new jZ;for(let c=0,d=e.length;c<d;c++){let f;const m=e[c];switch(m.type){case"BufferGeometry":case"InstancedBufferGeometry":f=s.parse(m);break;default:m.type in mV?f=mV[m.type].fromJSON(m,a):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${m.type}"`)}f.uuid=m.uuid,m.name!==void 0&&(f.name=m.name),m.userData!==void 0&&(f.userData=m.userData),o[m.uuid]=f}}return o}parseMaterials(e,a){const o={},s={};if(e!==void 0){const c=new iC;c.setTextures(a);for(let d=0,f=e.length;d<f;d++){const m=e[d];o[m.uuid]===void 0&&(o[m.uuid]=c.parse(m)),s[m.uuid]=o[m.uuid]}}return s}parseAnimations(e){const a={};if(e!==void 0)for(let o=0;o<e.length;o++){const s=e[o],c=aw.parse(s);a[c.uuid]=c}return a}parseImages(e,a){const o=this,s={};let c;function d(m){return o.manager.itemStart(m),c.load(m,function(){o.manager.itemEnd(m)},void 0,function(){o.manager.itemError(m),o.manager.itemEnd(m)})}function f(m){if(typeof m=="string"){const y=m,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:o.resourcePath+y;return d(_)}else return m.data?{data:b0(m.type,m.data),width:m.width,height:m.height}:null}if(e!==void 0&&e.length>0){const m=new S6(a);c=new iw(m),c.setCrossOrigin(this.crossOrigin);for(let y=0,_=e.length;y<_;y++){const x=e[y],S=x.url;if(Array.isArray(S)){const T=[];for(let I=0,k=S.length;I<k;I++){const D=S[I],L=f(D);L!==null&&(L instanceof HTMLImageElement?T.push(L):T.push(new z0(L.data,L.width,L.height)))}s[x.uuid]=new hg(T)}else{const T=f(x.url);s[x.uuid]=new hg(T)}}}return s}async parseImagesAsync(e){const a=this,o={};let s;async function c(d){if(typeof d=="string"){const f=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:a.resourcePath+f;return await s.loadAsync(m)}else return d.data?{data:b0(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){s=new iw(this.manager),s.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const m=e[d],y=m.url;if(Array.isArray(y)){const _=[];for(let x=0,S=y.length;x<S;x++){const T=y[x],I=await c(T);I!==null&&(I instanceof HTMLImageElement?_.push(I):_.push(new z0(I.data,I.width,I.height)))}o[m.uuid]=new hg(_)}else{const _=await c(m.url);o[m.uuid]=new hg(_)}}}return o}parseTextures(e,a){function o(c,d){return typeof c=="number"?c:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",c),d[c])}const s={};if(e!==void 0)for(let c=0,d=e.length;c<d;c++){const f=e[c];f.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid),a[f.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",f.image);const m=a[f.image],y=m.data;let _;Array.isArray(y)?(_=new Ow,y.length===6&&(_.needsUpdate=!0)):(y&&y.data?_=new z0:_=new kr,y&&(_.needsUpdate=!0)),_.source=m,_.uuid=f.uuid,f.name!==void 0&&(_.name=f.name),f.mapping!==void 0&&(_.mapping=o(f.mapping,Z2e)),f.channel!==void 0&&(_.channel=f.channel),f.offset!==void 0&&_.offset.fromArray(f.offset),f.repeat!==void 0&&_.repeat.fromArray(f.repeat),f.center!==void 0&&_.center.fromArray(f.center),f.rotation!==void 0&&(_.rotation=f.rotation),f.wrap!==void 0&&(_.wrapS=o(f.wrap[0],_V),_.wrapT=o(f.wrap[1],_V)),f.format!==void 0&&(_.format=f.format),f.internalFormat!==void 0&&(_.internalFormat=f.internalFormat),f.type!==void 0&&(_.type=f.type),f.colorSpace!==void 0&&(_.colorSpace=f.colorSpace),f.encoding!==void 0&&(_.encoding=f.encoding),f.minFilter!==void 0&&(_.minFilter=o(f.minFilter,bV)),f.magFilter!==void 0&&(_.magFilter=o(f.magFilter,bV)),f.anisotropy!==void 0&&(_.anisotropy=f.anisotropy),f.flipY!==void 0&&(_.flipY=f.flipY),f.generateMipmaps!==void 0&&(_.generateMipmaps=f.generateMipmaps),f.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(_.unpackAlignment=f.unpackAlignment),f.compareFunction!==void 0&&(_.compareFunction=f.compareFunction),f.userData!==void 0&&(_.userData=f.userData),s[f.uuid]=_}return s}parseObject(e,a,o,s,c){let d;function f(S){return a[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),a[S]}function m(S){if(S!==void 0){if(Array.isArray(S)){const T=[];for(let I=0,k=S.length;I<k;I++){const D=S[I];o[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),T.push(o[D])}return T}return o[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),o[S]}}function y(S){return s[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",S),s[S]}let _,x;switch(e.type){case"Scene":d=new eM,e.background!==void 0&&(Number.isInteger(e.background)?d.background=new Pn(e.background):d.background=y(e.background)),e.environment!==void 0&&(d.environment=y(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?d.fog=new UT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(d.fog=new BT(e.fog.color,e.fog.density)),e.fog.name!==""&&(d.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(d.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(d.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":d=new qr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(d.focus=e.focus),e.zoom!==void 0&&(d.zoom=e.zoom),e.filmGauge!==void 0&&(d.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(d.filmOffset=e.filmOffset),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"OrthographicCamera":d=new Eh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(d.zoom=e.zoom),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"AmbientLight":d=new WZ(e.color,e.intensity);break;case"DirectionalLight":d=new UZ(e.color,e.intensity);break;case"PointLight":d=new BZ(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":d=new VZ(e.color,e.intensity,e.width,e.height);break;case"SpotLight":d=new NZ(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":d=new FZ(e.color,e.groundColor,e.intensity);break;case"LightProbe":d=new HZ().fromJSON(e);break;case"SkinnedMesh":_=f(e.geometry),x=m(e.material),d=new sZ(_,x),e.bindMode!==void 0&&(d.bindMode=e.bindMode),e.bindMatrix!==void 0&&d.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(d.skeleton=e.skeleton);break;case"Mesh":_=f(e.geometry),x=m(e.material),d=new So(_,x);break;case"InstancedMesh":_=f(e.geometry),x=m(e.material);const S=e.count,T=e.instanceMatrix,I=e.instanceColor;d=new lZ(_,x,S),d.instanceMatrix=new Og(new Float32Array(T.array),16),I!==void 0&&(d.instanceColor=new Og(new Float32Array(I.array),I.itemSize));break;case"LOD":d=new oZ;break;case"Line":d=new bp(f(e.geometry),m(e.material));break;case"LineLoop":d=new cZ(f(e.geometry),m(e.material));break;case"LineSegments":d=new wd(f(e.geometry),m(e.material));break;case"PointCloud":case"Points":d=new uZ(f(e.geometry),m(e.material));break;case"Sprite":d=new rZ(m(e.material));break;case"Group":d=new w0;break;case"Bone":d=new d6;break;default:d=new pi}if(d.uuid=e.uuid,e.name!==void 0&&(d.name=e.name),e.matrix!==void 0?(d.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(d.matrixAutoUpdate=e.matrixAutoUpdate),d.matrixAutoUpdate&&d.matrix.decompose(d.position,d.quaternion,d.scale)):(e.position!==void 0&&d.position.fromArray(e.position),e.rotation!==void 0&&d.rotation.fromArray(e.rotation),e.quaternion!==void 0&&d.quaternion.fromArray(e.quaternion),e.scale!==void 0&&d.scale.fromArray(e.scale)),e.up!==void 0&&d.up.fromArray(e.up),e.castShadow!==void 0&&(d.castShadow=e.castShadow),e.receiveShadow!==void 0&&(d.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(d.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(d.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(d.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&d.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(d.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(d.visible=e.visible),e.frustumCulled!==void 0&&(d.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(d.renderOrder=e.renderOrder),e.userData!==void 0&&(d.userData=e.userData),e.layers!==void 0&&(d.layers.mask=e.layers),e.children!==void 0){const S=e.children;for(let T=0;T<S.length;T++)d.add(this.parseObject(S[T],a,o,s,c))}if(e.animations!==void 0){const S=e.animations;for(let T=0;T<S.length;T++){const I=S[T];d.animations.push(c[I])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(d.autoUpdate=e.autoUpdate);const S=e.levels;for(let T=0;T<S.length;T++){const I=S[T],k=d.getObjectByProperty("uuid",I.object);k!==void 0&&d.addLevel(k,I.distance,I.hysteresis)}}return d}bindSkeletons(e,a){Object.keys(a).length!==0&&e.traverse(function(o){if(o.isSkinnedMesh===!0&&o.skeleton!==void 0){const s=a[o.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",o.skeleton):o.bind(s,o.bindMatrix)}})}}const Z2e={UVMapping:IT,CubeReflectionMapping:Nh,CubeRefractionMapping:vp,EquirectangularReflectionMapping:Nx,EquirectangularRefractionMapping:Bx,CubeUVReflectionMapping:g_},_V={RepeatWrapping:Ux,ClampToEdgeWrapping:xs,MirroredRepeatWrapping:Wx},bV={NearestFilter:lo,NearestMipmapNearestFilter:KE,NearestMipmapLinearFilter:Qb,LinearFilter:Ir,LinearMipmapNearestFilter:$D,LinearMipmapLinearFilter:_p};class K2e extends Ml{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,a,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const c=this,d=Fg.get(e);if(d!==void 0)return c.manager.itemStart(e),setTimeout(function(){a&&a(d),c.manager.itemEnd(e)},0),d;const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader,fetch(e,f).then(function(m){return m.blob()}).then(function(m){return createImageBitmap(m,Object.assign(c.options,{colorSpaceConversion:"none"}))}).then(function(m){Fg.add(e,m),a&&a(m),c.manager.itemEnd(e)}).catch(function(m){s&&s(m),c.manager.itemError(e),c.manager.itemEnd(e)}),c.manager.itemStart(e)}}let XS;class M6{static getContext(){return XS===void 0&&(XS=new(window.AudioContext||window.webkitAudioContext)),XS}static setContext(e){XS=e}}class J2e extends Ml{constructor(e){super(e)}load(e,a,o,s){const c=this,d=new Bh(this.manager);d.setResponseType("arraybuffer"),d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(m){try{const y=m.slice(0);M6.getContext().decodeAudioData(y,function(x){a(x)},f)}catch(y){f(y)}},o,s);function f(m){s?s(m):console.error(m),c.manager.itemError(e)}}}const xV=new Ia,wV=new Ia,zm=new Ia;class Q2e{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const a=this._cache;if(a.focus!==e.focus||a.fov!==e.fov||a.aspect!==e.aspect*this.aspect||a.near!==e.near||a.far!==e.far||a.zoom!==e.zoom||a.eyeSep!==this.eyeSep){a.focus=e.focus,a.fov=e.fov,a.aspect=e.aspect*this.aspect,a.near=e.near,a.far=e.far,a.zoom=e.zoom,a.eyeSep=this.eyeSep,zm.copy(e.projectionMatrix);const s=a.eyeSep/2,c=s*a.near/a.focus,d=a.near*Math.tan(bg*a.fov*.5)/a.zoom;let f,m;wV.elements[12]=-s,xV.elements[12]=s,f=-d*a.aspect+c,m=d*a.aspect+c,zm.elements[0]=2*a.near/(m-f),zm.elements[8]=(m+f)/(m-f),this.cameraL.projectionMatrix.copy(zm),f=-d*a.aspect-c,m=d*a.aspect-c,zm.elements[0]=2*a.near/(m-f),zm.elements[8]=(m+f)/(m-f),this.cameraR.projectionMatrix.copy(zm)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(wV),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(xV)}}class T6{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=SV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const a=SV();e=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=e}return e}}function SV(){return(typeof performance>"u"?Date:performance).now()}const Fm=new Fe,AV=new As,e3e=new Fe,Nm=new Fe;class t3e extends pi{constructor(){super(),this.type="AudioListener",this.context=M6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new T6}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const a=this.context.listener,o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Fm,AV,e3e),Nm.set(0,0,-1).applyQuaternion(AV),a.positionX){const s=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(Fm.x,s),a.positionY.linearRampToValueAtTime(Fm.y,s),a.positionZ.linearRampToValueAtTime(Fm.z,s),a.forwardX.linearRampToValueAtTime(Nm.x,s),a.forwardY.linearRampToValueAtTime(Nm.y,s),a.forwardZ.linearRampToValueAtTime(Nm.z,s),a.upX.linearRampToValueAtTime(o.x,s),a.upY.linearRampToValueAtTime(o.y,s),a.upZ.linearRampToValueAtTime(o.z,s)}else a.setPosition(Fm.x,Fm.y,Fm.z),a.setOrientation(Nm.x,Nm.y,Nm.z,o.x,o.y,o.z)}}class $Z extends pi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,a=this.filters.length;e<a;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,a=this.filters.length;e<a;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Bm=new Fe,EV=new As,n3e=new Fe,Um=new Fe;class a3e extends $Z{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,a,o){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=a,this.panner.coneOuterGain=o,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Bm,EV,n3e),Um.set(0,0,1).applyQuaternion(EV);const a=this.panner;if(a.positionX){const o=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(Bm.x,o),a.positionY.linearRampToValueAtTime(Bm.y,o),a.positionZ.linearRampToValueAtTime(Bm.z,o),a.orientationX.linearRampToValueAtTime(Um.x,o),a.orientationY.linearRampToValueAtTime(Um.y,o),a.orientationZ.linearRampToValueAtTime(Um.z,o)}else a.setPosition(Bm.x,Bm.y,Bm.z),a.setOrientation(Um.x,Um.y,Um.z)}}class i3e{constructor(e,a=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=a,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const a=this.getFrequencyData();for(let o=0;o<a.length;o++)e+=a[o];return e/a.length}}class qZ{constructor(e,a,o){this.binding=e,this.valueSize=o;let s,c,d;switch(a){case"quaternion":s=this._slerp,c=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(o*6),this._workIndex=5;break;case"string":case"bool":s=this._select,c=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(o*5);break;default:s=this._lerp,c=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(o*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=c,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,a){const o=this.buffer,s=this.valueSize,c=e*s+s;let d=this.cumulativeWeight;if(d===0){for(let f=0;f!==s;++f)o[c+f]=o[f];d=a}else{d+=a;const f=a/d;this._mixBufferRegion(o,c,0,f,s)}this.cumulativeWeight=d}accumulateAdditive(e){const a=this.buffer,o=this.valueSize,s=o*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(a,s,0,e,o),this.cumulativeWeightAdditive+=e}apply(e){const a=this.valueSize,o=this.buffer,s=e*a+a,c=this.cumulativeWeight,d=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,c<1){const m=a*this._origIndex;this._mixBufferRegion(o,s,m,1-c,a)}d>0&&this._mixBufferRegionAdditive(o,s,this._addIndex*a,1,a);for(let m=a,y=a+a;m!==y;++m)if(o[m]!==o[m+a]){f.setValue(o,s);break}}saveOriginalState(){const e=this.binding,a=this.buffer,o=this.valueSize,s=o*this._origIndex;e.getValue(a,s);for(let c=o,d=s;c!==d;++c)a[c]=a[s+c%o];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,a=e+this.valueSize;for(let o=e;o<a;o++)this.buffer[o]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,a=this._addIndex*this.valueSize;for(let o=0;o<this.valueSize;o++)this.buffer[a+o]=this.buffer[e+o]}_select(e,a,o,s,c){if(s>=.5)for(let d=0;d!==c;++d)e[a+d]=e[o+d]}_slerp(e,a,o,s){As.slerpFlat(e,a,e,a,e,o,s)}_slerpAdditive(e,a,o,s,c){const d=this._workIndex*c;As.multiplyQuaternionsFlat(e,d,e,a,e,o),As.slerpFlat(e,a,e,a,e,d,s)}_lerp(e,a,o,s,c){const d=1-s;for(let f=0;f!==c;++f){const m=a+f;e[m]=e[m]*d+e[o+f]*s}}_lerpAdditive(e,a,o,s,c){for(let d=0;d!==c;++d){const f=a+d;e[f]=e[f]+e[o+d]*s}}}const C6="\\[\\]\\.:\\/",r3e=new RegExp("["+C6+"]","g"),P6="[^"+C6+"]",o3e="[^"+C6.replace("\\.","")+"]",s3e=/((?:WC+[\/:])*)/.source.replace("WC",P6),l3e=/(WCOD+)?/.source.replace("WCOD",o3e),c3e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",P6),u3e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",P6),d3e=new RegExp("^"+s3e+l3e+c3e+u3e+"$"),h3e=["material","materials","bones","map"];class f3e{constructor(e,a,o){const s=o||si.parseTrackName(a);this._targetGroup=e,this._bindings=e.subscribe_(a,s)}getValue(e,a){this.bind();const o=this._targetGroup.nCachedObjects_,s=this._bindings[o];s!==void 0&&s.getValue(e,a)}setValue(e,a){const o=this._bindings;for(let s=this._targetGroup.nCachedObjects_,c=o.length;s!==c;++s)o[s].setValue(e,a)}bind(){const e=this._bindings;for(let a=this._targetGroup.nCachedObjects_,o=e.length;a!==o;++a)e[a].bind()}unbind(){const e=this._bindings;for(let a=this._targetGroup.nCachedObjects_,o=e.length;a!==o;++a)e[a].unbind()}}class si{constructor(e,a,o){this.path=a,this.parsedPath=o||si.parseTrackName(a),this.node=si.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,a,o){return e&&e.isAnimationObjectGroup?new si.Composite(e,a,o):new si(e,a,o)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(r3e,"")}static parseTrackName(e){const a=d3e.exec(e);if(a===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const o={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]},s=o.nodeName&&o.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const c=o.nodeName.substring(s+1);h3e.indexOf(c)!==-1&&(o.nodeName=o.nodeName.substring(0,s),o.objectName=c)}if(o.propertyName===null||o.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o}static findNode(e,a){if(a===void 0||a===""||a==="."||a===-1||a===e.name||a===e.uuid)return e;if(e.skeleton){const o=e.skeleton.getBoneByName(a);if(o!==void 0)return o}if(e.children){const o=function(c){for(let d=0;d<c.length;d++){const f=c[d];if(f.name===a||f.uuid===a)return f;const m=o(f.children);if(m)return m}return null},s=o(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,a){e[a]=this.targetObject[this.propertyName]}_getValue_array(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)e[a++]=o[s]}_getValue_arrayElement(e,a){e[a]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,a){this.resolvedProperty.toArray(e,a)}_setValue_direct(e,a){this.targetObject[this.propertyName]=e[a]}_setValue_direct_setNeedsUpdate(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++]}_setValue_array_setNeedsUpdate(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,a){const o=this.resolvedProperty;for(let s=0,c=o.length;s!==c;++s)o[s]=e[a++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,a){this.resolvedProperty[this.propertyIndex]=e[a]}_setValue_arrayElement_setNeedsUpdate(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,a){this.resolvedProperty.fromArray(e,a)}_setValue_fromArray_setNeedsUpdate(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,a){this.bind(),this.getValue(e,a)}_setValue_unbound(e,a){this.bind(),this.setValue(e,a)}bind(){let e=this.node;const a=this.parsedPath,o=a.objectName,s=a.propertyName;let c=a.propertyIndex;if(e||(e=si.findNode(this.rootNode,a.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(o){let y=a.objectIndex;switch(o){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===y){y=_;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[o]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[o]}if(y!==void 0){if(e[y]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[y]}}const d=e[s];if(d===void 0){const y=a.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+s+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let m=this.BindingType.Direct;if(c!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[c]!==void 0&&(c=e.morphTargetDictionary[c])}m=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=c}else d.fromArray!==void 0&&d.toArray!==void 0?(m=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(m=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=s;this.getValue=this.GetterByBindingType[m],this.setValue=this.SetterByBindingTypeAndVersioning[m][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}si.Composite=f3e;si.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};si.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};si.prototype.GetterByBindingType=[si.prototype._getValue_direct,si.prototype._getValue_array,si.prototype._getValue_arrayElement,si.prototype._getValue_toArray];si.prototype.SetterByBindingTypeAndVersioning=[[si.prototype._setValue_direct,si.prototype._setValue_direct_setNeedsUpdate,si.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[si.prototype._setValue_array,si.prototype._setValue_array_setNeedsUpdate,si.prototype._setValue_array_setMatrixWorldNeedsUpdate],[si.prototype._setValue_arrayElement,si.prototype._setValue_arrayElement_setNeedsUpdate,si.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[si.prototype._setValue_fromArray,si.prototype._setValue_fromArray_setNeedsUpdate,si.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class p3e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zl(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let o=0,s=arguments.length;o!==s;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}add(){const e=this._objects,a=this._indicesByUUID,o=this._paths,s=this._parsedPaths,c=this._bindings,d=c.length;let f,m=e.length,y=this.nCachedObjects_;for(let _=0,x=arguments.length;_!==x;++_){const S=arguments[_],T=S.uuid;let I=a[T];if(I===void 0){I=m++,a[T]=I,e.push(S);for(let k=0,D=d;k!==D;++k)c[k].push(new si(S,o[k],s[k]))}else if(I<y){f=e[I];const k=--y,D=e[k];a[D.uuid]=I,e[I]=D,a[T]=k,e[k]=S;for(let L=0,O=d;L!==O;++L){const F=c[L],B=F[k];let G=F[I];F[I]=B,G===void 0&&(G=new si(S,o[L],s[L])),F[k]=G}}else e[I]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const e=this._objects,a=this._indicesByUUID,o=this._bindings,s=o.length;let c=this.nCachedObjects_;for(let d=0,f=arguments.length;d!==f;++d){const m=arguments[d],y=m.uuid,_=a[y];if(_!==void 0&&_>=c){const x=c++,S=e[x];a[S.uuid]=_,e[_]=S,a[y]=x,e[x]=m;for(let T=0,I=s;T!==I;++T){const k=o[T],D=k[x],L=k[_];k[_]=D,k[x]=L}}}this.nCachedObjects_=c}uncache(){const e=this._objects,a=this._indicesByUUID,o=this._bindings,s=o.length;let c=this.nCachedObjects_,d=e.length;for(let f=0,m=arguments.length;f!==m;++f){const y=arguments[f],_=y.uuid,x=a[_];if(x!==void 0)if(delete a[_],x<c){const S=--c,T=e[S],I=--d,k=e[I];a[T.uuid]=x,e[x]=T,a[k.uuid]=S,e[S]=k,e.pop();for(let D=0,L=s;D!==L;++D){const O=o[D],F=O[S],B=O[I];O[x]=F,O[S]=B,O.pop()}}else{const S=--d,T=e[S];S>0&&(a[T.uuid]=x),e[x]=T,e.pop();for(let I=0,k=s;I!==k;++I){const D=o[I];D[x]=D[S],D.pop()}}}this.nCachedObjects_=c}subscribe_(e,a){const o=this._bindingsIndicesByPath;let s=o[e];const c=this._bindings;if(s!==void 0)return c[s];const d=this._paths,f=this._parsedPaths,m=this._objects,y=m.length,_=this.nCachedObjects_,x=new Array(y);s=c.length,o[e]=s,d.push(e),f.push(a),c.push(x);for(let S=_,T=m.length;S!==T;++S){const I=m[S];x[S]=new si(I,e,a)}return x}unsubscribe_(e){const a=this._bindingsIndicesByPath,o=a[e];if(o!==void 0){const s=this._paths,c=this._parsedPaths,d=this._bindings,f=d.length-1,m=d[f],y=e[f];a[y]=o,d[o]=m,d.pop(),c[o]=c[f],c.pop(),s[o]=s[f],s.pop()}}}class XZ{constructor(e,a,o=null,s=a.blendMode){this._mixer=e,this._clip=a,this._localRoot=o,this.blendMode=s;const c=a.tracks,d=c.length,f=new Array(d),m={endingStart:ug,endingEnd:ug};for(let y=0;y!==d;++y){const _=c[y].createInterpolant(null);f[y]=_,_.settings=m}this._interpolantSettings=m,this._interpolants=f,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=PY,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,a){return this.loop=e,this.repetitions=a,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,a,o){if(e.fadeOut(a),this.fadeIn(a),o){const s=this._clip.duration,c=e._clip.duration,d=c/s,f=s/c;e.warp(1,d,a),this.warp(f,1,a)}return this}crossFadeTo(e,a,o){return e.crossFadeFrom(this,a,o)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,a,o){const s=this._mixer,c=s.time,d=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=s._lendControlInterpolant(),this._timeScaleInterpolant=f);const m=f.parameterPositions,y=f.sampleValues;return m[0]=c,m[1]=c+o,y[0]=e/d,y[1]=a/d,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,a,o,s){if(!this.enabled){this._updateWeight(e);return}const c=this._startTime;if(c!==null){const m=(e-c)*o;m<0||o===0?a=0:(this._startTime=null,a=o*m)}a*=this._updateTimeScale(e);const d=this._updateTime(a),f=this._updateWeight(e);if(f>0){const m=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case QD:for(let _=0,x=m.length;_!==x;++_)m[_].evaluate(d),y[_].accumulateAdditive(f);break;case RT:default:for(let _=0,x=m.length;_!==x;++_)m[_].evaluate(d),y[_].accumulate(s,f)}}}_updateWeight(e){let a=0;if(this.enabled){a=this.weight;const o=this._weightInterpolant;if(o!==null){const s=o.evaluate(e)[0];a*=s,e>o.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=a,a}_updateTimeScale(e){let a=0;if(!this.paused){a=this.timeScale;const o=this._timeScaleInterpolant;if(o!==null){const s=o.evaluate(e)[0];a*=s,e>o.parameterPositions[1]&&(this.stopWarping(),a===0?this.paused=!0:this.timeScale=a)}}return this._effectiveTimeScale=a,a}_updateTime(e){const a=this._clip.duration,o=this.loop;let s=this.time+e,c=this._loopCount;const d=o===IY;if(e===0)return c===-1?s:d&&(c&1)===1?a-s:s;if(o===CY){c===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=a)s=a;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(c===-1&&(e>=0?(c=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),s>=a||s<0){const f=Math.floor(s/a);s-=a*f,c+=Math.abs(f);const m=this.repetitions-c;if(m<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?a:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(m===1){const y=e<0;this._setEndings(y,!y,d)}else this._setEndings(!1,!1,d);this._loopCount=c,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=s;if(d&&(c&1)===1)return a-s}return s}_setEndings(e,a,o){const s=this._interpolantSettings;o?(s.endingStart=dg,s.endingEnd=dg):(e?s.endingStart=this.zeroSlopeAtStart?dg:ug:s.endingStart=Hx,a?s.endingEnd=this.zeroSlopeAtEnd?dg:ug:s.endingEnd=Hx)}_scheduleFading(e,a,o){const s=this._mixer,c=s.time;let d=this._weightInterpolant;d===null&&(d=s._lendControlInterpolant(),this._weightInterpolant=d);const f=d.parameterPositions,m=d.sampleValues;return f[0]=c,m[0]=a,f[1]=c+e,m[1]=o,this}}const m3e=new Float32Array(1);class g3e extends xd{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,a){const o=e._localRoot||this._root,s=e._clip.tracks,c=s.length,d=e._propertyBindings,f=e._interpolants,m=o.uuid,y=this._bindingsByRootAndName;let _=y[m];_===void 0&&(_={},y[m]=_);for(let x=0;x!==c;++x){const S=s[x],T=S.name;let I=_[T];if(I!==void 0)++I.referenceCount,d[x]=I;else{if(I=d[x],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,m,T));continue}const k=a&&a._propertyBindings[x].binding.parsedPath;I=new qZ(si.create(o,T,k),S.ValueTypeName,S.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,m,T),d[x]=I}f[x].resultBuffer=I.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const o=(e._localRoot||this._root).uuid,s=e._clip.uuid,c=this._actionsByClip[s];this._bindAction(e,c&&c.knownActions[0]),this._addInactiveAction(e,s,o)}const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];c.useCount++===0&&(this._lendBinding(c),c.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];--c.useCount===0&&(c.restoreOriginalState(),this._takeBackBinding(c))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const a=e._cacheIndex;return a!==null&&a<this._nActiveActions}_addInactiveAction(e,a,o){const s=this._actions,c=this._actionsByClip;let d=c[a];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,c[a]=d;else{const f=d.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=s.length,s.push(e),d.actionByRoot[o]=e}_removeInactiveAction(e){const a=this._actions,o=a[a.length-1],s=e._cacheIndex;o._cacheIndex=s,a[s]=o,a.pop(),e._cacheIndex=null;const c=e._clip.uuid,d=this._actionsByClip,f=d[c],m=f.knownActions,y=m[m.length-1],_=e._byClipCacheIndex;y._byClipCacheIndex=_,m[_]=y,m.pop(),e._byClipCacheIndex=null;const x=f.actionByRoot,S=(e._localRoot||this._root).uuid;delete x[S],m.length===0&&delete d[c],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const a=e._propertyBindings;for(let o=0,s=a.length;o!==s;++o){const c=a[o];--c.referenceCount===0&&this._removeInactiveBinding(c)}}_lendAction(e){const a=this._actions,o=e._cacheIndex,s=this._nActiveActions++,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_takeBackAction(e){const a=this._actions,o=e._cacheIndex,s=--this._nActiveActions,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_addInactiveBinding(e,a,o){const s=this._bindingsByRootAndName,c=this._bindings;let d=s[a];d===void 0&&(d={},s[a]=d),d[o]=e,e._cacheIndex=c.length,c.push(e)}_removeInactiveBinding(e){const a=this._bindings,o=e.binding,s=o.rootNode.uuid,c=o.path,d=this._bindingsByRootAndName,f=d[s],m=a[a.length-1],y=e._cacheIndex;m._cacheIndex=y,a[y]=m,a.pop(),delete f[c],Object.keys(f).length===0&&delete d[s]}_lendBinding(e){const a=this._bindings,o=e._cacheIndex,s=this._nActiveBindings++,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_takeBackBinding(e){const a=this._bindings,o=e._cacheIndex,s=--this._nActiveBindings,c=a[s];e._cacheIndex=s,a[s]=e,c._cacheIndex=o,a[o]=c}_lendControlInterpolant(){const e=this._controlInterpolants,a=this._nActiveControlInterpolants++;let o=e[a];return o===void 0&&(o=new x6(new Float32Array(2),new Float32Array(2),1,m3e),o.__cacheIndex=a,e[a]=o),o}_takeBackControlInterpolant(e){const a=this._controlInterpolants,o=e.__cacheIndex,s=--this._nActiveControlInterpolants,c=a[s];e.__cacheIndex=s,a[s]=e,c.__cacheIndex=o,a[o]=c}clipAction(e,a,o){const s=a||this._root,c=s.uuid;let d=typeof e=="string"?aw.findByName(s,e):e;const f=d!==null?d.uuid:e,m=this._actionsByClip[f];let y=null;if(o===void 0&&(d!==null?o=d.blendMode:o=RT),m!==void 0){const x=m.actionByRoot[c];if(x!==void 0&&x.blendMode===o)return x;y=m.knownActions[0],d===null&&(d=y._clip)}if(d===null)return null;const _=new XZ(this,d,a,o);return this._bindAction(_,y),this._addInactiveAction(_,f,c),_}existingAction(e,a){const o=a||this._root,s=o.uuid,c=typeof e=="string"?aw.findByName(o,e):e,d=c?c.uuid:e,f=this._actionsByClip[d];return f!==void 0&&f.actionByRoot[s]||null}stopAllAction(){const e=this._actions,a=this._nActiveActions;for(let o=a-1;o>=0;--o)e[o].stop();return this}update(e){e*=this.timeScale;const a=this._actions,o=this._nActiveActions,s=this.time+=e,c=Math.sign(e),d=this._accuIndex^=1;for(let y=0;y!==o;++y)a[y]._update(s,e,c,d);const f=this._bindings,m=this._nActiveBindings;for(let y=0;y!==m;++y)f[y].apply(d);return this}setTime(e){this.time=0;for(let a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const a=this._actions,o=e.uuid,s=this._actionsByClip,c=s[o];if(c!==void 0){const d=c.knownActions;for(let f=0,m=d.length;f!==m;++f){const y=d[f];this._deactivateAction(y);const _=y._cacheIndex,x=a[a.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,x._cacheIndex=_,a[_]=x,a.pop(),this._removeInactiveBindingsForAction(y)}delete s[o]}}uncacheRoot(e){const a=e.uuid,o=this._actionsByClip;for(const d in o){const f=o[d].actionByRoot,m=f[a];m!==void 0&&(this._deactivateAction(m),this._removeInactiveAction(m))}const s=this._bindingsByRootAndName,c=s[a];if(c!==void 0)for(const d in c){const f=c[d];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(e,a){const o=this.existingAction(e,a);o!==null&&(this._deactivateAction(o),this._removeInactiveAction(o))}}class I6{constructor(e){this.value=e}clone(){return new I6(this.value.clone===void 0?this.value:this.value.clone())}}let y3e=0;class v3e extends xd{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:y3e++}),this.name="",this.usage=Xx,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const a=this.uniforms.indexOf(e);return a!==-1&&this.uniforms.splice(a,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const a=e.uniforms;this.uniforms.length=0;for(let o=0,s=a.length;o<s;o++)this.uniforms.push(a[o].clone());return this}clone(){return new this.constructor().copy(this)}}class _3e extends WT{constructor(e,a,o=1){super(e,a),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const a=super.clone(e);return a.meshPerAttribute=this.meshPerAttribute,a}toJSON(e){const a=super.toJSON(e);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a}}class b3e{constructor(e,a,o,s,c){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=a,this.itemSize=o,this.elementSize=s,this.count=c,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,a){return this.type=e,this.elementSize=a,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class YZ{constructor(e,a,o=0,s=1/0){this.ray=new Hg(e,a),this.near=o,this.far=s,this.camera=null,this.layers=new xg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,a){this.ray.set(e,a)}setFromCamera(e,a){a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type: "+a.type)}intersectObject(e,a=!0,o=[]){return DR(e,this,o,a),o.sort(MV),o}intersectObjects(e,a=!0,o=[]){for(let s=0,c=e.length;s<c;s++)DR(e[s],this,o,a);return o.sort(MV),o}}function MV(n,e){return n.distance-e.distance}function DR(n,e,a,o){if(n.layers.test(e.layers)&&n.raycast(e,a),o===!0){const s=n.children;for(let c=0,d=s.length;c<d;c++)DR(s[c],e,a,!0)}}class OR{constructor(e=1,a=0,o=0){return this.radius=e,this.phi=a,this.theta=o,this}set(e,a,o){return this.radius=e,this.phi=a,this.theta=o,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,a,o){return this.radius=Math.sqrt(e*e+a*a+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,o),this.phi=Math.acos($r(a/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class x3e{constructor(e=1,a=0,o=0){return this.radius=e,this.theta=a,this.y=o,this}set(e,a,o){return this.radius=e,this.theta=a,this.y=o,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,a,o){return this.radius=Math.sqrt(e*e+o*o),this.theta=Math.atan2(e,o),this.y=a,this}clone(){return new this.constructor().copy(this)}}const TV=new Kt;class w3e{constructor(e=new Kt(1/0,1/0),a=new Kt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=a}set(e,a){return this.min.copy(e),this.max.copy(a),this}setFromPoints(e){this.makeEmpty();for(let a=0,o=e.length;a<o;a++)this.expandByPoint(e[a]);return this}setFromCenterAndSize(e,a){const o=TV.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,a){return a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,a){return a.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,TV).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const CV=new Fe,YS=new Fe;class S3e{constructor(e=new Fe,a=new Fe){this.start=e,this.end=a}set(e,a){return this.start.copy(e),this.end.copy(a),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,a){return this.delta(a).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,a){CV.subVectors(e,this.start),YS.subVectors(this.end,this.start);const o=YS.dot(YS);let c=YS.dot(CV)/o;return a&&(c=$r(c,0,1)),c}closestPointToPoint(e,a,o){const s=this.closestPointToPointParameter(e,a);return this.delta(o).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const PV=new Fe;class A3e extends pi{constructor(e,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="SpotLightHelper";const o=new La,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,f=1,m=32;d<m;d++,f++){const y=d/m*Math.PI*2,_=f/m*Math.PI*2;s.push(Math.cos(y),Math.sin(y),1,Math.cos(_),Math.sin(_),1)}o.setAttribute("position",new Wn(s,3));const c=new qs({fog:!1,toneMapped:!1});this.cone=new wd(o,c),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,a=e*Math.tan(this.light.angle);this.cone.scale.set(a,a,e),PV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(PV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Bf=new Fe,ZS=new Ia,Q4=new Ia;class E3e extends wd{constructor(e){const a=ZZ(e),o=new La,s=[],c=[],d=new Pn(0,0,1),f=new Pn(0,1,0);for(let y=0;y<a.length;y++){const _=a[y];_.parent&&_.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),c.push(d.r,d.g,d.b),c.push(f.r,f.g,f.b))}o.setAttribute("position",new Wn(s,3)),o.setAttribute("color",new Wn(c,3));const m=new qs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(o,m),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=a,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const a=this.bones,o=this.geometry,s=o.getAttribute("position");Q4.copy(this.root.matrixWorld).invert();for(let c=0,d=0;c<a.length;c++){const f=a[c];f.parent&&f.parent.isBone&&(ZS.multiplyMatrices(Q4,f.matrixWorld),Bf.setFromMatrixPosition(ZS),s.setXYZ(d,Bf.x,Bf.y,Bf.z),ZS.multiplyMatrices(Q4,f.parent.matrixWorld),Bf.setFromMatrixPosition(ZS),s.setXYZ(d+1,Bf.x,Bf.y,Bf.z),d+=2)}o.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function ZZ(n){const e=[];n.isBone===!0&&e.push(n);for(let a=0;a<n.children.length;a++)e.push.apply(e,ZZ(n.children[a]));return e}class M3e extends So{constructor(e,a,o){const s=new Nw(a,4,2),c=new Hh({wireframe:!0,fog:!1,toneMapped:!1});super(s,c),this.light=e,this.color=o,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const T3e=new Fe,IV=new Pn,LV=new Pn;class C3e extends pi{constructor(e,a,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="HemisphereLightHelper";const s=new Fw(a);s.rotateY(Math.PI*.5),this.material=new Hh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const c=s.getAttribute("position"),d=new Float32Array(c.count*3);s.setAttribute("color",new Xi(d,3)),this.add(new So(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const a=e.geometry.getAttribute("color");IV.copy(this.light.color),LV.copy(this.light.groundColor);for(let o=0,s=a.count;o<s;o++){const c=o<s/2?IV:LV;a.setXYZ(o,c.r,c.g,c.b)}a.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(T3e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class P3e extends wd{constructor(e=10,a=10,o=4473924,s=8947848){o=new Pn(o),s=new Pn(s);const c=a/2,d=e/a,f=e/2,m=[],y=[];for(let S=0,T=0,I=-f;S<=a;S++,I+=d){m.push(-f,0,I,f,0,I),m.push(I,0,-f,I,0,f);const k=S===c?o:s;k.toArray(y,T),T+=3,k.toArray(y,T),T+=3,k.toArray(y,T),T+=3,k.toArray(y,T),T+=3}const _=new La;_.setAttribute("position",new Wn(m,3)),_.setAttribute("color",new Wn(y,3));const x=new qs({vertexColors:!0,toneMapped:!1});super(_,x),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class I3e extends wd{constructor(e=10,a=16,o=8,s=64,c=4473924,d=8947848){c=new Pn(c),d=new Pn(d);const f=[],m=[];if(a>1)for(let x=0;x<a;x++){const S=x/a*(Math.PI*2),T=Math.sin(S)*e,I=Math.cos(S)*e;f.push(0,0,0),f.push(T,0,I);const k=x&1?c:d;m.push(k.r,k.g,k.b),m.push(k.r,k.g,k.b)}for(let x=0;x<o;x++){const S=x&1?c:d,T=e-e/o*x;for(let I=0;I<s;I++){let k=I/s*(Math.PI*2),D=Math.sin(k)*T,L=Math.cos(k)*T;f.push(D,0,L),m.push(S.r,S.g,S.b),k=(I+1)/s*(Math.PI*2),D=Math.sin(k)*T,L=Math.cos(k)*T,f.push(D,0,L),m.push(S.r,S.g,S.b)}}const y=new La;y.setAttribute("position",new Wn(f,3)),y.setAttribute("color",new Wn(m,3));const _=new qs({vertexColors:!0,toneMapped:!1});super(y,_),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const RV=new Fe,KS=new Fe,kV=new Fe;class L3e extends pi{constructor(e,a,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="DirectionalLightHelper",a===void 0&&(a=1);let s=new La;s.setAttribute("position",new Wn([-a,a,0,a,a,0,a,-a,0,-a,-a,0,-a,a,0],3));const c=new qs({fog:!1,toneMapped:!1});this.lightPlane=new bp(s,c),this.add(this.lightPlane),s=new La,s.setAttribute("position",new Wn([0,0,0,0,0,1],3)),this.targetLine=new bp(s,c),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),RV.setFromMatrixPosition(this.light.matrixWorld),KS.setFromMatrixPosition(this.light.target.matrixWorld),kV.subVectors(KS,RV),this.lightPlane.lookAt(KS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(KS),this.targetLine.scale.z=kV.length()}}const JS=new Fe,Wr=new Dw;class R3e extends wd{constructor(e){const a=new La,o=new qs({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],c=[],d={};f("n1","n2"),f("n2","n4"),f("n4","n3"),f("n3","n1"),f("f1","f2"),f("f2","f4"),f("f4","f3"),f("f3","f1"),f("n1","f1"),f("n2","f2"),f("n3","f3"),f("n4","f4"),f("p","n1"),f("p","n2"),f("p","n3"),f("p","n4"),f("u1","u2"),f("u2","u3"),f("u3","u1"),f("c","t"),f("p","c"),f("cn1","cn2"),f("cn3","cn4"),f("cf1","cf2"),f("cf3","cf4");function f(I,k){m(I),m(k)}function m(I){s.push(0,0,0),c.push(0,0,0),d[I]===void 0&&(d[I]=[]),d[I].push(s.length/3-1)}a.setAttribute("position",new Wn(s,3)),a.setAttribute("color",new Wn(c,3)),super(a,o),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update();const y=new Pn(16755200),_=new Pn(16711680),x=new Pn(43775),S=new Pn(16777215),T=new Pn(3355443);this.setColors(y,_,x,S,T)}setColors(e,a,o,s,c){const f=this.geometry.getAttribute("color");f.setXYZ(0,e.r,e.g,e.b),f.setXYZ(1,e.r,e.g,e.b),f.setXYZ(2,e.r,e.g,e.b),f.setXYZ(3,e.r,e.g,e.b),f.setXYZ(4,e.r,e.g,e.b),f.setXYZ(5,e.r,e.g,e.b),f.setXYZ(6,e.r,e.g,e.b),f.setXYZ(7,e.r,e.g,e.b),f.setXYZ(8,e.r,e.g,e.b),f.setXYZ(9,e.r,e.g,e.b),f.setXYZ(10,e.r,e.g,e.b),f.setXYZ(11,e.r,e.g,e.b),f.setXYZ(12,e.r,e.g,e.b),f.setXYZ(13,e.r,e.g,e.b),f.setXYZ(14,e.r,e.g,e.b),f.setXYZ(15,e.r,e.g,e.b),f.setXYZ(16,e.r,e.g,e.b),f.setXYZ(17,e.r,e.g,e.b),f.setXYZ(18,e.r,e.g,e.b),f.setXYZ(19,e.r,e.g,e.b),f.setXYZ(20,e.r,e.g,e.b),f.setXYZ(21,e.r,e.g,e.b),f.setXYZ(22,e.r,e.g,e.b),f.setXYZ(23,e.r,e.g,e.b),f.setXYZ(24,a.r,a.g,a.b),f.setXYZ(25,a.r,a.g,a.b),f.setXYZ(26,a.r,a.g,a.b),f.setXYZ(27,a.r,a.g,a.b),f.setXYZ(28,a.r,a.g,a.b),f.setXYZ(29,a.r,a.g,a.b),f.setXYZ(30,a.r,a.g,a.b),f.setXYZ(31,a.r,a.g,a.b),f.setXYZ(32,o.r,o.g,o.b),f.setXYZ(33,o.r,o.g,o.b),f.setXYZ(34,o.r,o.g,o.b),f.setXYZ(35,o.r,o.g,o.b),f.setXYZ(36,o.r,o.g,o.b),f.setXYZ(37,o.r,o.g,o.b),f.setXYZ(38,s.r,s.g,s.b),f.setXYZ(39,s.r,s.g,s.b),f.setXYZ(40,c.r,c.g,c.b),f.setXYZ(41,c.r,c.g,c.b),f.setXYZ(42,c.r,c.g,c.b),f.setXYZ(43,c.r,c.g,c.b),f.setXYZ(44,c.r,c.g,c.b),f.setXYZ(45,c.r,c.g,c.b),f.setXYZ(46,c.r,c.g,c.b),f.setXYZ(47,c.r,c.g,c.b),f.setXYZ(48,c.r,c.g,c.b),f.setXYZ(49,c.r,c.g,c.b),f.needsUpdate=!0}update(){const e=this.geometry,a=this.pointMap,o=1,s=1;Wr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ro("c",a,e,Wr,0,0,-1),ro("t",a,e,Wr,0,0,1),ro("n1",a,e,Wr,-o,-s,-1),ro("n2",a,e,Wr,o,-s,-1),ro("n3",a,e,Wr,-o,s,-1),ro("n4",a,e,Wr,o,s,-1),ro("f1",a,e,Wr,-o,-s,1),ro("f2",a,e,Wr,o,-s,1),ro("f3",a,e,Wr,-o,s,1),ro("f4",a,e,Wr,o,s,1),ro("u1",a,e,Wr,o*.7,s*1.1,-1),ro("u2",a,e,Wr,-o*.7,s*1.1,-1),ro("u3",a,e,Wr,0,s*2,-1),ro("cf1",a,e,Wr,-o,0,1),ro("cf2",a,e,Wr,o,0,1),ro("cf3",a,e,Wr,0,-s,1),ro("cf4",a,e,Wr,0,s,1),ro("cn1",a,e,Wr,-o,0,-1),ro("cn2",a,e,Wr,o,0,-1),ro("cn3",a,e,Wr,0,-s,-1),ro("cn4",a,e,Wr,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ro(n,e,a,o,s,c,d){JS.set(s,c,d).unproject(o);const f=e[n];if(f!==void 0){const m=a.getAttribute("position");for(let y=0,_=f.length;y<_;y++)m.setXYZ(f[y],JS.x,JS.y,JS.z)}}const QS=new gu;class k3e extends wd{constructor(e,a=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),c=new La;c.setIndex(new Xi(o,1)),c.setAttribute("position",new Xi(s,3)),super(c,new qs({color:a,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&QS.setFromObject(this.object),QS.isEmpty())return;const a=QS.min,o=QS.max,s=this.geometry.attributes.position,c=s.array;c[0]=o.x,c[1]=o.y,c[2]=o.z,c[3]=a.x,c[4]=o.y,c[5]=o.z,c[6]=a.x,c[7]=a.y,c[8]=o.z,c[9]=o.x,c[10]=a.y,c[11]=o.z,c[12]=o.x,c[13]=o.y,c[14]=a.z,c[15]=a.x,c[16]=o.y,c[17]=a.z,c[18]=a.x,c[19]=a.y,c[20]=a.z,c[21]=o.x,c[22]=a.y,c[23]=a.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,a){return super.copy(e,a),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class D3e extends wd{constructor(e,a=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],c=new La;c.setIndex(new Xi(o,1)),c.setAttribute("position",new Wn(s,3)),super(c,new qs({color:a,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const a=this.box;a.isEmpty()||(a.getCenter(this.position),a.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class O3e extends bp{constructor(e,a=1,o=16776960){const s=o,c=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],d=new La;d.setAttribute("position",new Wn(c,3)),d.computeBoundingSphere(),super(d,new qs({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=a;const f=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],m=new La;m.setAttribute("position",new Wn(f,3)),m.computeBoundingSphere(),this.add(new So(m,new Hh({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const DV=new Fe;let eA,eI;class z3e extends pi{constructor(e=new Fe(0,0,1),a=new Fe(0,0,0),o=1,s=16776960,c=o*.2,d=c*.2){super(),this.type="ArrowHelper",eA===void 0&&(eA=new La,eA.setAttribute("position",new Wn([0,0,0,0,1,0],3)),eI=new v_(0,.5,1,5,1),eI.translate(0,-.5,0)),this.position.copy(a),this.line=new bp(eA,new qs({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new So(eI,new Hh({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(o,c,d)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{DV.set(e.z,0,-e.x).normalize();const a=Math.acos(e.y);this.quaternion.setFromAxisAngle(DV,a)}}setLength(e,a=e*.2,o=a*.2){this.line.scale.set(1,Math.max(1e-4,e-a),1),this.line.updateMatrix(),this.cone.scale.set(o,a,o),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class F3e extends wd{constructor(e=1){const a=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new La;s.setAttribute("position",new Wn(a,3)),s.setAttribute("color",new Wn(o,3));const c=new qs({vertexColors:!0,toneMapped:!1});super(s,c),this.type="AxesHelper"}setColors(e,a,o){const s=new Pn,c=this.geometry.attributes.color.array;return s.set(e),s.toArray(c,0),s.toArray(c,3),s.set(a),s.toArray(c,6),s.toArray(c,9),s.set(o),s.toArray(c,12),s.toArray(c,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class N3e{constructor(){this.type="ShapePath",this.color=new Pn,this.subPaths=[],this.currentPath=null}moveTo(e,a){return this.currentPath=new Kx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,a),this}lineTo(e,a){return this.currentPath.lineTo(e,a),this}quadraticCurveTo(e,a,o,s){return this.currentPath.quadraticCurveTo(e,a,o,s),this}bezierCurveTo(e,a,o,s,c,d){return this.currentPath.bezierCurveTo(e,a,o,s,c,d),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function a(L){const O=[];for(let F=0,B=L.length;F<B;F++){const G=L[F],q=new wg;q.curves=G.curves,O.push(q)}return O}function o(L,O){const F=O.length;let B=!1;for(let G=F-1,q=0;q<F;G=q++){let X=O[G],te=O[q],V=te.x-X.x,Q=te.y-X.y;if(Math.abs(Q)>Number.EPSILON){if(Q<0&&(X=O[q],V=-V,te=O[G],Q=-Q),L.y<X.y||L.y>te.y)continue;if(L.y===X.y){if(L.x===X.x)return!0}else{const ge=Q*(L.x-X.x)-V*(L.y-X.y);if(ge===0)return!0;if(ge<0)continue;B=!B}}else{if(L.y!==X.y)continue;if(te.x<=L.x&&L.x<=X.x||X.x<=L.x&&L.x<=te.x)return!0}}return B}const s=pd.isClockWise,c=this.subPaths;if(c.length===0)return[];let d,f,m;const y=[];if(c.length===1)return f=c[0],m=new wg,m.curves=f.curves,y.push(m),y;let _=!s(c[0].getPoints());_=e?!_:_;const x=[],S=[];let T=[],I=0,k;S[I]=void 0,T[I]=[];for(let L=0,O=c.length;L<O;L++)f=c[L],k=f.getPoints(),d=s(k),d=e?!d:d,d?(!_&&S[I]&&I++,S[I]={s:new wg,p:k},S[I].s.curves=f.curves,_&&I++,T[I]=[]):T[I].push({h:f,p:k[0]});if(!S[0])return a(c);if(S.length>1){let L=!1,O=0;for(let F=0,B=S.length;F<B;F++)x[F]=[];for(let F=0,B=S.length;F<B;F++){const G=T[F];for(let q=0;q<G.length;q++){const X=G[q];let te=!0;for(let V=0;V<S.length;V++)o(X.p,S[V].p)&&(F!==V&&O++,te?(te=!1,x[V].push(X)):L=!0);te&&x[F].push(X)}}O>0&&L===!1&&(T=x)}let D;for(let L=0,O=S.length;L<O;L++){m=S[L].s,y.push(m),D=T[L];for(let F=0,B=D.length;F<B;F++)m.holes.push(D[F].h)}return y}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:CT}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=CT);const KZ=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:jD,AddEquation:$f,AddOperation:fY,AdditiveAnimationBlendMode:QD,AdditiveBlending:qL,AlphaFormat:xY,AlwaysCompare:UY,AlwaysDepth:oY,AlwaysStencilFunc:AR,AmbientLight:WZ,AnimationAction:XZ,AnimationClip:aw,AnimationLoader:V2e,AnimationMixer:g3e,AnimationObjectGroup:p3e,AnimationUtils:N2e,ArcCurve:dZ,ArrayCamera:tZ,ArrowHelper:z3e,AttachedBindMode:JL,Audio:$Z,AudioAnalyser:i3e,AudioContext:M6,AudioListener:t3e,AudioLoader:J2e,AxesHelper:F3e,BackSide:Ss,BasicDepthPacking:LY,BasicShadowMap:VX,Bone:d6,BooleanKeyframeTrack:$g,Box2:w3e,Box3:gu,Box3Helper:D3e,BoxGeometry:jg,BoxHelper:k3e,BufferAttribute:Xi,BufferGeometry:La,BufferGeometryLoader:jZ,ByteType:_Y,Cache:Fg,Camera:Dw,CameraHelper:R3e,CanvasTexture:l2e,CapsuleGeometry:jT,CatmullRomCurve3:hZ,CineonToneMapping:gY,CircleGeometry:$T,ClampToEdgeWrapping:xs,Clock:T6,Color:Pn,ColorKeyframeTrack:w6,ColorManagement:zi,CompressedArrayTexture:o2e,CompressedCubeTexture:s2e,CompressedTexture:GT,CompressedTextureLoader:G2e,ConeGeometry:qT,ConstantAlphaFactor:aY,ConstantColorFactor:tY,CubeCamera:qY,CubeReflectionMapping:Nh,CubeRefractionMapping:vp,CubeTexture:Ow,CubeTextureLoader:H2e,CubeUVReflectionMapping:g_,CubicBezierCurve:p6,CubicBezierCurve3:fZ,CubicInterpolant:RZ,CullFaceBack:$L,CullFaceFront:WX,CullFaceFrontBack:i0e,CullFaceNone:UX,Curve:yu,CurvePath:mZ,CustomBlending:GX,CustomToneMapping:yY,CylinderGeometry:v_,Cylindrical:x3e,Data3DTexture:i6,DataArrayTexture:DT,DataTexture:z0,DataTextureLoader:j2e,DataUtils:f_e,DecrementStencilOp:g0e,DecrementWrapStencilOp:v0e,DefaultLoadingManager:OZ,DepthFormat:dp,DepthStencilFormat:kg,DepthTexture:nZ,DetachedBindMode:vY,DirectionalLight:UZ,DirectionalLightHelper:L3e,DiscreteInterpolant:kZ,DisplayP3ColorSpace:kT,DodecahedronGeometry:XT,DoubleSide:Hl,DstAlphaFactor:ZX,DstColorFactor:JX,DynamicCopyUsage:k0e,DynamicDrawUsage:T0e,DynamicReadUsage:I0e,EdgesGeometry:gZ,EllipseCurve:HT,EqualCompare:OY,EqualDepth:lY,EqualStencilFunc:w0e,EquirectangularReflectionMapping:Nx,EquirectangularRefractionMapping:Bx,Euler:kw,EventDispatcher:xd,ExtrudeGeometry:ZT,FileLoader:Bh,Float16BufferAttribute:__e,Float32BufferAttribute:Wn,Float64BufferAttribute:b_e,FloatType:sd,Fog:UT,FogExp2:BT,FramebufferTexture:r2e,FrontSide:yd,Frustum:OT,GLBufferAttribute:b3e,GLSL1:O0e,GLSL3:ER,GreaterCompare:FY,GreaterDepth:uY,GreaterEqualCompare:BY,GreaterEqualDepth:cY,GreaterEqualStencilFunc:M0e,GreaterStencilFunc:A0e,GridHelper:P3e,Group:w0,HalfFloatType:t_,HemisphereLight:FZ,HemisphereLightHelper:C3e,IcosahedronGeometry:KT,ImageBitmapLoader:K2e,ImageLoader:iw,ImageUtils:a6,IncrementStencilOp:m0e,IncrementWrapStencilOp:y0e,InstancedBufferAttribute:Og,InstancedBufferGeometry:E6,InstancedInterleavedBuffer:_3e,InstancedMesh:lZ,Int16BufferAttribute:y_e,Int32BufferAttribute:v_e,Int8BufferAttribute:p_e,IntType:qD,InterleavedBuffer:WT,InterleavedBufferAttribute:Dg,Interpolant:Bw,InterpolateDiscrete:Vx,InterpolateLinear:Gx,InterpolateSmooth:QA,InvertStencilOp:_0e,KeepStencilOp:Jm,KeyframeTrack:vu,LOD:oZ,LatheGeometry:zw,Layers:xg,LessCompare:DY,LessDepth:sY,LessEqualCompare:zY,LessEqualDepth:Fx,LessEqualStencilFunc:S0e,LessStencilFunc:x0e,Light:Pp,LightProbe:HZ,Line:bp,Line3:S3e,LineBasicMaterial:qs,LineCurve:m6,LineCurve3:pZ,LineDashedMaterial:PZ,LineLoop:cZ,LineSegments:wd,LinearDisplayP3ColorSpace:Rw,LinearEncoding:e6,LinearFilter:Ir,LinearInterpolant:x6,LinearMipMapLinearFilter:c0e,LinearMipMapNearestFilter:l0e,LinearMipmapLinearFilter:_p,LinearMipmapNearestFilter:$D,LinearSRGBColorSpace:vd,LinearToneMapping:pY,LinearTransfer:jx,Loader:Ml,LoaderUtils:kR,LoadingManager:S6,LoopOnce:CY,LoopPingPong:IY,LoopRepeat:PY,LuminanceAlphaFormat:SY,LuminanceFormat:wY,MOUSE:Zm,Material:as,MaterialLoader:iC,MathUtils:Y0e,Matrix3:Na,Matrix4:Ia,MaxEquation:KL,Mesh:So,MeshBasicMaterial:Hh,MeshDepthMaterial:FT,MeshDistanceMaterial:NT,MeshLambertMaterial:TZ,MeshMatcapMaterial:CZ,MeshNormalMaterial:MZ,MeshPhongMaterial:AZ,MeshPhysicalMaterial:SZ,MeshStandardMaterial:_6,MeshToonMaterial:EZ,MinEquation:ZL,MirroredRepeatWrapping:Wx,MixOperation:hY,MultiplyBlending:YL,MultiplyOperation:Lw,NearestFilter:lo,NearestMipMapLinearFilter:s0e,NearestMipMapNearestFilter:o0e,NearestMipmapLinearFilter:Qb,NearestMipmapNearestFilter:KE,NeverCompare:kY,NeverDepth:rY,NeverStencilFunc:b0e,NoBlending:Ih,NoColorSpace:jl,NoToneMapping:hd,NormalAnimationBlendMode:RT,NormalBlending:_g,NotEqualCompare:NY,NotEqualDepth:dY,NotEqualStencilFunc:E0e,NumberKeyframeTrack:tw,Object3D:pi,ObjectLoader:Y2e,ObjectSpaceNormalMap:RY,OctahedronGeometry:Fw,OneFactor:qX,OneMinusConstantAlphaFactor:iY,OneMinusConstantColorFactor:nY,OneMinusDstAlphaFactor:KX,OneMinusDstColorFactor:QX,OneMinusSrcAlphaFactor:ZE,OneMinusSrcColorFactor:YX,OrthographicCamera:Eh,P3Primaries:qx,PCFShadowMap:PT,PCFSoftShadowMap:Jb,PMREMGenerator:TR,Path:Kx,PerspectiveCamera:qr,Plane:vh,PlaneGeometry:Tp,PlaneHelper:O3e,PointLight:BZ,PointLightHelper:M3e,Points:uZ,PointsMaterial:h6,PolarGridHelper:I3e,PolyhedronGeometry:Cp,PositionalAudio:a3e,PropertyBinding:si,PropertyMixer:qZ,QuadraticBezierCurve:g6,QuadraticBezierCurve3:y6,Quaternion:As,QuaternionKeyframeTrack:__,QuaternionLinearInterpolant:DZ,RED_GREEN_RGTC2_Format:wR,RED_RGTC1_Format:TY,REVISION:CT,RGBADepthPacking:t6,RGBAFormat:pl,RGBAIntegerFormat:JD,RGBA_ASTC_10x10_Format:gR,RGBA_ASTC_10x5_Format:fR,RGBA_ASTC_10x6_Format:pR,RGBA_ASTC_10x8_Format:mR,RGBA_ASTC_12x10_Format:yR,RGBA_ASTC_12x12_Format:vR,RGBA_ASTC_4x4_Format:rR,RGBA_ASTC_5x4_Format:oR,RGBA_ASTC_5x5_Format:sR,RGBA_ASTC_6x5_Format:lR,RGBA_ASTC_6x6_Format:cR,RGBA_ASTC_8x5_Format:uR,RGBA_ASTC_8x6_Format:dR,RGBA_ASTC_8x8_Format:hR,RGBA_BPTC_Format:JA,RGBA_ETC2_EAC_Format:iR,RGBA_PVRTC_2BPPV1_Format:nR,RGBA_PVRTC_4BPPV1_Format:tR,RGBA_S3TC_DXT1_Format:YA,RGBA_S3TC_DXT3_Format:ZA,RGBA_S3TC_DXT5_Format:KA,RGB_BPTC_SIGNED_Format:_R,RGB_BPTC_UNSIGNED_Format:bR,RGB_ETC1_Format:MY,RGB_ETC2_Format:aR,RGB_PVRTC_2BPPV1_Format:eR,RGB_PVRTC_4BPPV1_Format:QL,RGB_S3TC_DXT1_Format:XA,RGFormat:EY,RGIntegerFormat:KD,RawShaderMaterial:wZ,Ray:Hg,Raycaster:YZ,Rec709Primaries:$x,RectAreaLight:VZ,RedFormat:AY,RedIntegerFormat:ZD,ReinhardToneMapping:mY,RenderTarget:HY,RepeatWrapping:Ux,ReplaceStencilOp:p0e,ReverseSubtractEquation:jX,RingGeometry:JT,SIGNED_RED_GREEN_RGTC2_Format:SR,SIGNED_RED_RGTC1_Format:xR,SRGBColorSpace:Io,SRGBTransfer:Qi,Scene:eM,ShaderChunk:Oa,ShaderLib:ru,ShaderMaterial:_d,ShadowMaterial:xZ,Shape:wg,ShapeGeometry:QT,ShapePath:N3e,ShapeUtils:pd,ShortType:bY,Skeleton:VT,SkeletonHelper:E3e,SkinnedMesh:sZ,Source:hg,Sphere:Pc,SphereGeometry:Nw,Spherical:OR,SphericalHarmonics3:GZ,SplineCurve:v6,SpotLight:NZ,SpotLightHelper:A3e,Sprite:rZ,SpriteMaterial:u6,SrcAlphaFactor:YE,SrcAlphaSaturateFactor:eY,SrcColorFactor:XX,StaticCopyUsage:R0e,StaticDrawUsage:Xx,StaticReadUsage:P0e,StereoCamera:Q2e,StreamCopyUsage:D0e,StreamDrawUsage:C0e,StreamReadUsage:L0e,StringKeyframeTrack:qg,SubtractEquation:HX,SubtractiveBlending:XL,TOUCH:Km,TangentSpaceNormalMap:Mp,TetrahedronGeometry:eC,Texture:kr,TextureLoader:zZ,TorusGeometry:tC,TorusKnotGeometry:nC,Triangle:fl,TriangleFanDrawMode:h0e,TriangleStripDrawMode:d0e,TrianglesDrawMode:u0e,TubeGeometry:aC,TwoPassDoubleSide:r0e,UVMapping:IT,Uint16BufferAttribute:r6,Uint32BufferAttribute:o6,Uint8BufferAttribute:m_e,Uint8ClampedBufferAttribute:g_e,Uniform:I6,UniformsGroup:v3e,UniformsLib:bn,UniformsUtils:s6,UnsignedByteType:fd,UnsignedInt248Type:up,UnsignedIntType:Ah,UnsignedShort4444Type:XD,UnsignedShort5551Type:YD,UnsignedShortType:LT,VSMShadowMap:tu,Vector2:Kt,Vector3:Fe,Vector4:Ei,VectorKeyframeTrack:nw,VideoTexture:i2e,WebGL1Renderer:aZ,WebGL3DRenderTarget:t_e,WebGLArrayRenderTarget:e_e,WebGLCoordinateSystem:ld,WebGLCubeRenderTarget:XY,WebGLMultipleRenderTargets:n_e,WebGLRenderTarget:pu,WebGLRenderer:c6,WebGLUtils:eZ,WebGPUCoordinateSystem:Yx,WireframeGeometry:bZ,WrapAroundEnding:Hx,ZeroCurvatureEnding:ug,ZeroFactor:$X,ZeroSlopeEnding:dg,ZeroStencilOp:f0e,_SRGBAFormat:JE,createCanvasElement:GY,sRGBEncoding:hp},Symbol.toStringTag,{value:"Module"}));var JZ={exports:{}},Xg={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Xg.ConcurrentRoot=1;Xg.ContinuousEventPriority=4;Xg.DefaultEventPriority=16;Xg.DiscreteEventPriority=1;Xg.IdleEventPriority=536870912;Xg.LegacyRoot=0;JZ.exports=Xg;var A0=JZ.exports;function B3e(n){let e;const a=new Set,o=(y,_)=>{const x=typeof y=="function"?y(e):y;if(x!==e){const S=e;e=_?x:Object.assign({},e,x),a.forEach(T=>T(e,S))}},s=()=>e,c=(y,_=s,x=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let S=_(e);function T(){const I=_(e);if(!x(S,I)){const k=S;y(S=I,k)}}return a.add(T),()=>a.delete(T)},m={setState:o,getState:s,subscribe:(y,_,x)=>_||x?c(y,_,x):(a.add(y),()=>a.delete(y)),destroy:()=>a.clear()};return e=n(o,s,m),m}const U3e=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),OV=U3e?re.useEffect:re.useLayoutEffect;function W3e(n){const e=typeof n=="function"?B3e(n):n,a=(o=e.getState,s=Object.is)=>{const[,c]=re.useReducer(D=>D+1,0),d=e.getState(),f=re.useRef(d),m=re.useRef(o),y=re.useRef(s),_=re.useRef(!1),x=re.useRef();x.current===void 0&&(x.current=o(d));let S,T=!1;(f.current!==d||m.current!==o||y.current!==s||_.current)&&(S=o(d),T=!s(x.current,S)),OV(()=>{T&&(x.current=S),f.current=d,m.current=o,y.current=s,_.current=!1});const I=re.useRef(d);OV(()=>{const D=()=>{try{const O=e.getState(),F=m.current(O);y.current(x.current,F)||(f.current=O,x.current=F,c())}catch{_.current=!0,c()}},L=e.subscribe(D);return e.getState()!==I.current&&D(),L},[]);const k=T?S:x.current;return re.useDebugValue(k),k};return Object.assign(a,e),a[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const o=[a,e];return{next(){const s=o.length<=0;return{value:o.shift(),done:s}}}},a}var QZ={exports:{}},tI={exports:{}},nI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zV;function V3e(){return zV||(zV=1,function(n){function e(le,pe){var Ae=le.length;le.push(pe);e:for(;0<Ae;){var ae=Ae-1>>>1,Ee=le[ae];if(0<s(Ee,pe))le[ae]=pe,le[Ae]=Ee,Ae=ae;else break e}}function a(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var pe=le[0],Ae=le.pop();if(Ae!==pe){le[0]=Ae;e:for(var ae=0,Ee=le.length,Ze=Ee>>>1;ae<Ze;){var Xe=2*(ae+1)-1,Ke=le[Xe],Ue=Xe+1,ft=le[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ft,Ke)?(le[ae]=ft,le[Ue]=Ae,ae=Ue):(le[ae]=Ke,le[Xe]=Ae,ae=Xe);else if(Ue<Ee&&0>s(ft,Ae))le[ae]=ft,le[Ue]=Ae,ae=Ue;else break e}}return pe}function s(le,pe){var Ae=le.sortIndex-pe.sortIndex;return Ae!==0?Ae:le.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,x=null,S=3,T=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(le){for(var pe=a(y);pe!==null;){if(pe.callback===null)o(y);else if(pe.startTime<=le)o(y),pe.sortIndex=pe.expirationTime,e(m,pe);else break;pe=a(y)}}function B(le){if(k=!1,F(le),!I)if(a(m)!==null)I=!0,Le(G);else{var pe=a(y);pe!==null&&Ge(B,pe.startTime-le)}}function G(le,pe){I=!1,k&&(k=!1,L(te),te=-1),T=!0;var Ae=S;try{for(F(pe),x=a(m);x!==null&&(!(x.expirationTime>pe)||le&&!ge());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=pe);pe=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===a(m)&&o(m),F(pe)}else o(m);x=a(m)}if(x!==null)var Ze=!0;else{var Xe=a(y);Xe!==null&&Ge(B,Xe.startTime-pe),Ze=!1}return Ze}finally{x=null,S=Ae,T=!1}}var q=!1,X=null,te=-1,V=5,Q=-1;function ge(){return!(n.unstable_now()-Q<V)}function me(){if(X!==null){var le=n.unstable_now();Q=le;var pe=!0;try{pe=X(!0,le)}finally{pe?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(me)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=me,be=function(){Ce.postMessage(null)}}else be=function(){D(me,0)};function Le(le){X=le,q||(q=!0,be())}function Ge(le,pe){te=D(function(){le(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Le(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var pe=3;break;default:pe=S}var Ae=S;S=pe;try{return le()}finally{S=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,pe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Ae=S;S=le;try{return pe()}finally{S=Ae}},n.unstable_scheduleCallback=function(le,pe,Ae){var ae=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ae+Ae:ae):Ae=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,le={id:_++,callback:pe,priorityLevel:le,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ae?(le.sortIndex=Ae,e(y,le),a(m)===null&&le===a(y)&&(k?(L(te),te=-1):k=!0,Ge(B,Ae-ae))):(le.sortIndex=Ee,e(m,le),I||T||(I=!0,Le(G))),le},n.unstable_shouldYield=ge,n.unstable_wrapCallback=function(le){var pe=S;return function(){var Ae=S;S=pe;try{return le.apply(this,arguments)}finally{S=Ae}}}}(nI)),nI}var FV;function G3e(){return FV||(FV=1,tI.exports=V3e()),tI.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H3e=function(e){var a={},o=re,s=G3e(),c=Object.assign;function d(E){for(var M="https://reactjs.org/docs/error-decoder.html?invariant="+E,N=1;N<arguments.length;N++)M+="&args[]="+encodeURIComponent(arguments[N]);return"Minified React error #"+E+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,m=Symbol.for("react.element"),y=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),G=Symbol.iterator;function q(E){return E===null||typeof E!="object"?null:(E=G&&E[G]||E["@@iterator"],typeof E=="function"?E:null)}function X(E){if(E==null)return null;if(typeof E=="function")return E.displayName||E.name||null;if(typeof E=="string")return E;switch(E){case _:return"Fragment";case y:return"Portal";case S:return"Profiler";case x:return"StrictMode";case D:return"Suspense";case L:return"SuspenseList"}if(typeof E=="object")switch(E.$$typeof){case I:return(E.displayName||"Context")+".Consumer";case T:return(E._context.displayName||"Context")+".Provider";case k:var M=E.render;return E=E.displayName,E||(E=M.displayName||M.name||"",E=E!==""?"ForwardRef("+E+")":"ForwardRef"),E;case O:return M=E.displayName||null,M!==null?M:X(E.type)||"Memo";case F:M=E._payload,E=E._init;try{return X(E(M))}catch{}}return null}function te(E){var M=E.type;switch(E.tag){case 24:return"Cache";case 9:return(M.displayName||"Context")+".Consumer";case 10:return(M._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return E=M.render,E=E.displayName||E.name||"",M.displayName||(E!==""?"ForwardRef("+E+")":"ForwardRef");case 7:return"Fragment";case 5:return M;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(M);case 8:return M===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof M=="function")return M.displayName||M.name||null;if(typeof M=="string")return M}return null}function V(E){var M=E,N=E;if(E.alternate)for(;M.return;)M=M.return;else{E=M;do M=E,M.flags&4098&&(N=M.return),E=M.return;while(E)}return M.tag===3?N:null}function Q(E){if(V(E)!==E)throw Error(d(188))}function ge(E){var M=E.alternate;if(!M){if(M=V(E),M===null)throw Error(d(188));return M!==E?null:E}for(var N=E,H=M;;){var J=N.return;if(J===null)break;var oe=J.alternate;if(oe===null){if(H=J.return,H!==null){N=H;continue}break}if(J.child===oe.child){for(oe=J.child;oe;){if(oe===N)return Q(J),E;if(oe===H)return Q(J),M;oe=oe.sibling}throw Error(d(188))}if(N.return!==H.return)N=J,H=oe;else{for(var je=!1,_t=J.child;_t;){if(_t===N){je=!0,N=J,H=oe;break}if(_t===H){je=!0,H=J,N=oe;break}_t=_t.sibling}if(!je){for(_t=oe.child;_t;){if(_t===N){je=!0,N=oe,H=J;break}if(_t===H){je=!0,H=oe,N=J;break}_t=_t.sibling}if(!je)throw Error(d(189))}}if(N.alternate!==H)throw Error(d(190))}if(N.tag!==3)throw Error(d(188));return N.stateNode.current===N?E:M}function me(E){return E=ge(E),E!==null?be(E):null}function be(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){var M=be(E);if(M!==null)return M;E=E.sibling}return null}function fe(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){if(E.tag!==4){var M=fe(E);if(M!==null)return M}E=E.sibling}return null}var Ce=Array.isArray,Le=e.getPublicInstance,Ge=e.getRootHostContext,le=e.getChildHostContext,pe=e.prepareForCommit,Ae=e.resetAfterCommit,ae=e.createInstance,Ee=e.appendInitialChild,Ze=e.finalizeInitialChildren,Xe=e.prepareUpdate,Ke=e.shouldSetTextContent,Ue=e.createTextInstance,ft=e.scheduleTimeout,Rt=e.cancelTimeout,kt=e.noTimeout,Jt=e.isPrimaryRenderer,It=e.supportsMutation,Pe=e.supportsPersistence,pt=e.supportsHydration,yt=e.getInstanceFromNode,At=e.preparePortalMount,Be=e.getCurrentEventPriority,ue=e.detachDeletedInstance,se=e.supportsMicrotasks,ve=e.scheduleMicrotask,$e=e.supportsTestSelectors,De=e.findFiberRoot,st=e.getBoundingRect,de=e.getTextContent,ne=e.isHiddenSubtree,Oe=e.matchAccessibilityRole,mt=e.setFocusIfFocusable,ot=e.setupIntersectionObserver,lt=e.appendChild,Et=e.appendChildToContainer,Ut=e.commitTextUpdate,Vt=e.commitMount,$t=e.commitUpdate,Nt=e.insertBefore,St=e.insertInContainerBefore,Zt=e.removeChild,He=e.removeChildFromContainer,Lt=e.resetTextContent,qt=e.hideInstance,Ot=e.hideTextInstance,fn=e.unhideInstance,_e=e.unhideTextInstance,Ye=e.clearContainer,Se=e.cloneInstance,Me=e.createContainerChildSet,ze=e.appendChildToContainerChildSet,Qe=e.finalizeContainerChildren,tt=e.replaceContainerChildren,vt=e.cloneHiddenInstance,dt=e.cloneHiddenTextInstance,ut=e.canHydrateInstance,Gt=e.canHydrateTextInstance,Tt=e.canHydrateSuspenseInstance,Qt=e.isSuspenseInstancePending,mn=e.isSuspenseInstanceFallback,nn=e.registerSuspenseInstanceRetry,wn=e.getNextHydratableSibling,Hn=e.getFirstHydratableChild,fa=e.getFirstHydratableChildWithinContainer,Pa=e.getFirstHydratableChildWithinSuspenseInstance,Ta=e.hydrateInstance,Li=e.hydrateTextInstance,mi=e.hydrateSuspenseInstance,Re=e.getNextHydratableInstanceAfterSuspenseInstance,bt=e.commitHydratedContainer,Dt=e.commitHydratedSuspenseInstance,Ct=e.clearSuspenseBoundary,zt=e.clearSuspenseBoundaryFromContainer,ln=e.shouldDeleteUnhydratedTailInstances,Tn=e.didNotMatchHydratedContainerTextInstance,qn=e.didNotMatchHydratedTextInstance,an;function sa(E){if(an===void 0)try{throw Error()}catch(N){var M=N.stack.trim().match(/\n( *(at )?)/);an=M&&M[1]||""}return`
`+an+E}var pa=!1;function ia(E,M){if(!E||pa)return"";pa=!0;var N=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(M)if(M=function(){throw Error()},Object.defineProperty(M.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(M,[])}catch(dn){var H=dn}Reflect.construct(E,[],M)}else{try{M.call()}catch(dn){H=dn}E.call(M.prototype)}else{try{throw Error()}catch(dn){H=dn}E()}}catch(dn){if(dn&&H&&typeof dn.stack=="string"){for(var J=dn.stack.split(`
`),oe=H.stack.split(`
`),je=J.length-1,_t=oe.length-1;1<=je&&0<=_t&&J[je]!==oe[_t];)_t--;for(;1<=je&&0<=_t;je--,_t--)if(J[je]!==oe[_t]){if(je!==1||_t!==1)do if(je--,_t--,0>_t||J[je]!==oe[_t]){var jt=`
`+J[je].replace(" at new "," at ");return E.displayName&&jt.includes("<anonymous>")&&(jt=jt.replace("<anonymous>",E.displayName)),jt}while(1<=je&&0<=_t);break}}}finally{pa=!1,Error.prepareStackTrace=N}return(E=E?E.displayName||E.name:"")?sa(E):""}var ai=Object.prototype.hasOwnProperty,xr=[],ti=-1;function Yi(E){return{current:E}}function ta(E){0>ti||(E.current=xr[ti],xr[ti]=null,ti--)}function Rn(E,M){ti++,xr[ti]=E.current,E.current=M}var ho={},Ra=Yi(ho),Mi=Yi(!1),Ho=ho;function wr(E,M){var N=E.type.contextTypes;if(!N)return ho;var H=E.stateNode;if(H&&H.__reactInternalMemoizedUnmaskedChildContext===M)return H.__reactInternalMemoizedMaskedChildContext;var J={},oe;for(oe in N)J[oe]=M[oe];return H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=M,E.__reactInternalMemoizedMaskedChildContext=J),J}function Zi(E){return E=E.childContextTypes,E!=null}function ui(){ta(Mi),ta(Ra)}function zr(E,M,N){if(Ra.current!==ho)throw Error(d(168));Rn(Ra,M),Rn(Mi,N)}function Cn(E,M,N){var H=E.stateNode;if(M=M.childContextTypes,typeof H.getChildContext!="function")return N;H=H.getChildContext();for(var J in H)if(!(J in M))throw Error(d(108,te(E)||"Unknown",J));return c({},N,H)}function Zn(E){return E=(E=E.stateNode)&&E.__reactInternalMemoizedMergedChildContext||ho,Ho=Ra.current,Rn(Ra,E),Rn(Mi,Mi.current),!0}function Gi(E,M,N){var H=E.stateNode;if(!H)throw Error(d(169));N?(E=Cn(E,M,Ho),H.__reactInternalMemoizedMergedChildContext=E,ta(Mi),ta(Ra),Rn(Ra,E)):ta(Mi),Rn(Mi,N)}var Sr=Math.clz32?Math.clz32:Lp,Ts=Math.log,_u=Math.LN2;function Lp(E){return E>>>=0,E===0?32:31-(Ts(E)/_u|0)|0}var tc=64,Tl=4194304;function Cl(E){switch(E&-E){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return E&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return E&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return E}}function Pl(E,M){var N=E.pendingLanes;if(N===0)return 0;var H=0,J=E.suspendedLanes,oe=E.pingedLanes,je=N&268435455;if(je!==0){var _t=je&~J;_t!==0?H=Cl(_t):(oe&=je,oe!==0&&(H=Cl(oe)))}else je=N&~J,je!==0?H=Cl(je):oe!==0&&(H=Cl(oe));if(H===0)return 0;if(M!==0&&M!==H&&!(M&J)&&(J=H&-H,oe=M&-M,J>=oe||J===16&&(oe&4194240)!==0))return M;if(H&4&&(H|=N&16),M=E.entangledLanes,M!==0)for(E=E.entanglements,M&=H;0<M;)N=31-Sr(M),J=1<<N,H|=E[N],M&=~J;return H}function Sd(E,M){switch(E){case 1:case 2:case 4:return M+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return M+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jh(E,M){for(var N=E.suspendedLanes,H=E.pingedLanes,J=E.expirationTimes,oe=E.pendingLanes;0<oe;){var je=31-Sr(oe),_t=1<<je,jt=J[je];jt===-1?(!(_t&N)||_t&H)&&(J[je]=Sd(_t,M)):jt<=M&&(E.expiredLanes|=_t),oe&=~_t}}function nc(E){return E=E.pendingLanes&-1073741825,E!==0?E:E&1073741824?1073741824:0}function Ad(E){for(var M=[],N=0;31>N;N++)M.push(E);return M}function Xs(E,M,N){E.pendingLanes|=M,M!==536870912&&(E.suspendedLanes=0,E.pingedLanes=0),E=E.eventTimes,M=31-Sr(M),E[M]=N}function Ht(E,M){var N=E.pendingLanes&~M;E.pendingLanes=M,E.suspendedLanes=0,E.pingedLanes=0,E.expiredLanes&=M,E.mutableReadLanes&=M,E.entangledLanes&=M,M=E.entanglements;var H=E.eventTimes;for(E=E.expirationTimes;0<N;){var J=31-Sr(N),oe=1<<J;M[J]=0,H[J]=-1,E[J]=-1,N&=~oe}}function vn(E,M){var N=E.entangledLanes|=M;for(E=E.entanglements;N;){var H=31-Sr(N),J=1<<H;J&M|E[H]&M&&(E[H]|=M),N&=~J}}var Bn=0;function nt(E){return E&=-E,1<E?4<E?E&268435455?16:536870912:4:1}var sn=s.unstable_scheduleCallback,Ys=s.unstable_cancelCallback,Cs=s.unstable_shouldYield,Wi=s.unstable_requestPaint,ii=s.unstable_now,Ed=s.unstable_ImmediatePriority,Ps=s.unstable_UserBlockingPriority,Ao=s.unstable_NormalPriority,Rp=s.unstable_IdlePriority,Zs=null,tn=null;function ma(E){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Zs,E,void 0,(E.current.flags&128)===128)}catch{}}function wa(E,M){return E===M&&(E!==0||1/E===1/M)||E!==E&&M!==M}var Ki=typeof Object.is=="function"?Object.is:wa,Fr=null,na=!1,jo=!1;function Ic(E){Fr===null?Fr=[E]:Fr.push(E)}function Lc(E){na=!0,Ic(E)}function Ri(){if(!jo&&Fr!==null){jo=!0;var E=0,M=Bn;try{var N=Fr;for(Bn=1;E<N.length;E++){var H=N[E];do H=H(!0);while(H!==null)}Fr=null,na=!1}catch(J){throw Fr!==null&&(Fr=Fr.slice(E+1)),sn(Ed,Ri),J}finally{Bn=M,jo=!1}}return null}var di=f.ReactCurrentBatchConfig;function Md(E,M){if(Ki(E,M))return!0;if(typeof E!="object"||E===null||typeof M!="object"||M===null)return!1;var N=Object.keys(E),H=Object.keys(M);if(N.length!==H.length)return!1;for(H=0;H<N.length;H++){var J=N[H];if(!ai.call(M,J)||!Ki(E[J],M[J]))return!1}return!0}function Il(E){switch(E.tag){case 5:return sa(E.type);case 16:return sa("Lazy");case 13:return sa("Suspense");case 19:return sa("SuspenseList");case 0:case 2:case 15:return E=ia(E.type,!1),E;case 11:return E=ia(E.type.render,!1),E;case 1:return E=ia(E.type,!0),E;default:return""}}function Eo(E,M){if(E&&E.defaultProps){M=c({},M),E=E.defaultProps;for(var N in E)M[N]===void 0&&(M[N]=E[N]);return M}return M}var fr=Yi(null),bu=null,Ks=null,Ll=null;function xu(){Ll=Ks=bu=null}function Td(E,M,N){Jt?(Rn(fr,M._currentValue),M._currentValue=N):(Rn(fr,M._currentValue2),M._currentValue2=N)}function Nr(E){var M=fr.current;ta(fr),Jt?E._currentValue=M:E._currentValue2=M}function Ti(E,M,N){for(;E!==null;){var H=E.alternate;if((E.childLanes&M)!==M?(E.childLanes|=M,H!==null&&(H.childLanes|=M)):H!==null&&(H.childLanes&M)!==M&&(H.childLanes|=M),E===N)break;E=E.return}}function xn(E,M){bu=E,Ll=Ks=null,E=E.dependencies,E!==null&&E.firstContext!==null&&(E.lanes&M&&(ss=!0),E.firstContext=null)}function ar(E){var M=Jt?E._currentValue:E._currentValue2;if(Ll!==E)if(E={context:E,memoizedValue:M,next:null},Ks===null){if(bu===null)throw Error(d(308));Ks=E,bu.dependencies={lanes:0,firstContext:E}}else Ks=Ks.next=E;return M}var $o=null,Ar=!1;function is(E){E.updateQueue={baseState:E.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b_(E,M){E=E.updateQueue,M.updateQueue===E&&(M.updateQueue={baseState:E.baseState,firstBaseUpdate:E.firstBaseUpdate,lastBaseUpdate:E.lastBaseUpdate,shared:E.shared,effects:E.effects})}function rs(E,M){return{eventTime:E,lane:M,tag:0,payload:null,callback:null,next:null}}function Ci(E,M){var N=E.updateQueue;N!==null&&(N=N.shared,Hi!==null&&E.mode&1&&!(Da&2)?(E=N.interleaved,E===null?(M.next=M,$o===null?$o=[N]:$o.push(N)):(M.next=E.next,E.next=M),N.interleaved=M):(E=N.pending,E===null?M.next=M:(M.next=E.next,E.next=M),N.pending=M))}function wu(E,M,N){if(M=M.updateQueue,M!==null&&(M=M.shared,(N&4194240)!==0)){var H=M.lanes;H&=E.pendingLanes,N|=H,M.lanes=N,vn(E,N)}}function Zg(E,M){var N=E.updateQueue,H=E.alternate;if(H!==null&&(H=H.updateQueue,N===H)){var J=null,oe=null;if(N=N.firstBaseUpdate,N!==null){do{var je={eventTime:N.eventTime,lane:N.lane,tag:N.tag,payload:N.payload,callback:N.callback,next:null};oe===null?J=oe=je:oe=oe.next=je,N=N.next}while(N!==null);oe===null?J=oe=M:oe=oe.next=M}else J=oe=M;N={baseState:H.baseState,firstBaseUpdate:J,lastBaseUpdate:oe,shared:H.shared,effects:H.effects},E.updateQueue=N;return}E=N.lastBaseUpdate,E===null?N.firstBaseUpdate=M:E.next=M,N.lastBaseUpdate=M}function Su(E,M,N,H){var J=E.updateQueue;Ar=!1;var oe=J.firstBaseUpdate,je=J.lastBaseUpdate,_t=J.shared.pending;if(_t!==null){J.shared.pending=null;var jt=_t,dn=jt.next;jt.next=null,je===null?oe=dn:je.next=dn,je=jt;var Mn=E.alternate;Mn!==null&&(Mn=Mn.updateQueue,_t=Mn.lastBaseUpdate,_t!==je&&(_t===null?Mn.firstBaseUpdate=dn:_t.next=dn,Mn.lastBaseUpdate=jt))}if(oe!==null){var _a=J.baseState;je=0,Mn=dn=jt=null,_t=oe;do{var Jn=_t.lane,vi=_t.eventTime;if((H&Jn)===Jn){Mn!==null&&(Mn=Mn.next={eventTime:vi,lane:0,tag:_t.tag,payload:_t.payload,callback:_t.callback,next:null});e:{var Vn=E,yo=_t;switch(Jn=M,vi=N,yo.tag){case 1:if(Vn=yo.payload,typeof Vn=="function"){_a=Vn.call(vi,_a,Jn);break e}_a=Vn;break e;case 3:Vn.flags=Vn.flags&-65537|128;case 0:if(Vn=yo.payload,Jn=typeof Vn=="function"?Vn.call(vi,_a,Jn):Vn,Jn==null)break e;_a=c({},_a,Jn);break e;case 2:Ar=!0}}_t.callback!==null&&_t.lane!==0&&(E.flags|=64,Jn=J.effects,Jn===null?J.effects=[_t]:Jn.push(_t))}else vi={eventTime:vi,lane:Jn,tag:_t.tag,payload:_t.payload,callback:_t.callback,next:null},Mn===null?(dn=Mn=vi,jt=_a):Mn=Mn.next=vi,je|=Jn;if(_t=_t.next,_t===null){if(_t=J.shared.pending,_t===null)break;Jn=_t,_t=Jn.next,Jn.next=null,J.lastBaseUpdate=Jn,J.shared.pending=null}}while(1);if(Mn===null&&(jt=_a),J.baseState=jt,J.firstBaseUpdate=dn,J.lastBaseUpdate=Mn,M=J.shared.interleaved,M!==null){J=M;do je|=J.lane,J=J.next;while(J!==M)}else oe===null&&(J.shared.lanes=0);Vd|=je,E.lanes=je,E.memoizedState=_a}}function Er(E,M,N){if(E=M.effects,M.effects=null,E!==null)for(M=0;M<E.length;M++){var H=E[M],J=H.callback;if(J!==null){if(H.callback=null,H=N,typeof J!="function")throw Error(d(191,J));J.call(H)}}}var Kg=new o.Component().refs;function kp(E,M,N,H){M=E.memoizedState,N=N(H,M),N=N==null?M:c({},M,N),E.memoizedState=N,E.lanes===0&&(E.updateQueue.baseState=N)}var Js={isMounted:function(E){return(E=E._reactInternals)?V(E)===E:!1},enqueueSetState:function(E,M,N){E=E._reactInternals;var H=go(),J=Nu(E),oe=rs(H,J);oe.payload=M,N!=null&&(oe.callback=N),Ci(E,oe),M=Qr(E,J,H),M!==null&&wu(M,E,J)},enqueueReplaceState:function(E,M,N){E=E._reactInternals;var H=go(),J=Nu(E),oe=rs(H,J);oe.tag=1,oe.payload=M,N!=null&&(oe.callback=N),Ci(E,oe),M=Qr(E,J,H),M!==null&&wu(M,E,J)},enqueueForceUpdate:function(E,M){E=E._reactInternals;var N=go(),H=Nu(E),J=rs(N,H);J.tag=2,M!=null&&(J.callback=M),Ci(E,J),M=Qr(E,H,N),M!==null&&wu(M,E,H)}};function $h(E,M,N,H,J,oe,je){return E=E.stateNode,typeof E.shouldComponentUpdate=="function"?E.shouldComponentUpdate(H,oe,je):M.prototype&&M.prototype.isPureReactComponent?!Md(N,H)||!Md(J,oe):!0}function qh(E,M,N){var H=!1,J=ho,oe=M.contextType;return typeof oe=="object"&&oe!==null?oe=ar(oe):(J=Zi(M)?Ho:Ra.current,H=M.contextTypes,oe=(H=H!=null)?wr(E,J):ho),M=new M(N,oe),E.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Js,E.stateNode=M,M._reactInternals=E,H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=J,E.__reactInternalMemoizedMaskedChildContext=oe),M}function ka(E,M,N,H){E=M.state,typeof M.componentWillReceiveProps=="function"&&M.componentWillReceiveProps(N,H),typeof M.UNSAFE_componentWillReceiveProps=="function"&&M.UNSAFE_componentWillReceiveProps(N,H),M.state!==E&&Js.enqueueReplaceState(M,M.state,null)}function x_(E,M,N,H){var J=E.stateNode;J.props=N,J.state=E.memoizedState,J.refs=Kg,is(E);var oe=M.contextType;typeof oe=="object"&&oe!==null?J.context=ar(oe):(oe=Zi(M)?Ho:Ra.current,J.context=wr(E,oe)),J.state=E.memoizedState,oe=M.getDerivedStateFromProps,typeof oe=="function"&&(kp(E,M,oe,N),J.state=E.memoizedState),typeof M.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(M=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),M!==J.state&&Js.enqueueReplaceState(J,J.state,null),Su(E,N,J,H),J.state=E.memoizedState),typeof J.componentDidMount=="function"&&(E.flags|=4194308)}var Au=[],Qs=0,Jg=null,Dp=0,Mo=[],Mr=0,ac=null,ic=1,Rc="";function Cd(E,M){Au[Qs++]=Dp,Au[Qs++]=Jg,Jg=E,Dp=M}function Xh(E,M,N){Mo[Mr++]=ic,Mo[Mr++]=Rc,Mo[Mr++]=ac,ac=E;var H=ic;E=Rc;var J=32-Sr(H)-1;H&=~(1<<J),N+=1;var oe=32-Sr(M)+J;if(30<oe){var je=J-J%5;oe=(H&(1<<je)-1).toString(32),H>>=je,J-=je,ic=1<<32-Sr(M)+J|N<<J|H,Rc=oe+E}else ic=1<<oe|N<<J|H,Rc=E}function Pd(E){E.return!==null&&(Cd(E,1),Xh(E,1,0))}function w_(E){for(;E===Jg;)Jg=Au[--Qs],Au[Qs]=null,Dp=Au[--Qs],Au[Qs]=null;for(;E===ac;)ac=Mo[--Mr],Mo[Mr]=null,Rc=Mo[--Mr],Mo[Mr]=null,ic=Mo[--Mr],Mo[Mr]=null}var fo=null,os=null,ki=!1,el=!1,Rl=null;function Kw(E,M){var N=ds(5,null,null,0);N.elementType="DELETED",N.stateNode=M,N.return=E,M=E.deletions,M===null?(E.deletions=[N],E.flags|=16):M.push(N)}function Jw(E,M){switch(E.tag){case 5:return M=ut(M,E.type,E.pendingProps),M!==null?(E.stateNode=M,fo=E,os=Hn(M),!0):!1;case 6:return M=Gt(M,E.pendingProps),M!==null?(E.stateNode=M,fo=E,os=null,!0):!1;case 13:if(M=Tt(M),M!==null){var N=ac!==null?{id:ic,overflow:Rc}:null;return E.memoizedState={dehydrated:M,treeContext:N,retryLane:1073741824},N=ds(18,null,null,0),N.stateNode=M,N.return=E,E.child=N,fo=E,os=null,!0}return!1;default:return!1}}function Qg(E){return(E.mode&1)!==0&&(E.flags&128)===0}function S_(E){if(ki){var M=os;if(M){var N=M;if(!Jw(E,M)){if(Qg(E))throw Error(d(418));M=wn(N);var H=fo;M&&Jw(E,M)?Kw(H,N):(E.flags=E.flags&-4097|2,ki=!1,fo=E)}}else{if(Qg(E))throw Error(d(418));E.flags=E.flags&-4097|2,ki=!1,fo=E}}}function ey(E){for(E=E.return;E!==null&&E.tag!==5&&E.tag!==3&&E.tag!==13;)E=E.return;fo=E}function Yh(E){if(!pt||E!==fo)return!1;if(!ki)return ey(E),ki=!0,!1;if(E.tag!==3&&(E.tag!==5||ln(E.type)&&!Ke(E.type,E.memoizedProps))){var M=os;if(M){if(Qg(E)){for(E=os;E;)E=wn(E);throw Error(d(418))}for(;M;)Kw(E,M),M=wn(M)}}if(ey(E),E.tag===13){if(!pt)throw Error(d(316));if(E=E.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));os=Re(E)}else os=fo?wn(E.stateNode):null;return!0}function Id(){pt&&(os=fo=null,el=ki=!1)}function ty(E){Rl===null?Rl=[E]:Rl.push(E)}function Zh(E,M,N){if(E=N.ref,E!==null&&typeof E!="function"&&typeof E!="object"){if(N._owner){if(N=N._owner,N){if(N.tag!==1)throw Error(d(309));var H=N.stateNode}if(!H)throw Error(d(147,E));var J=H,oe=""+E;return M!==null&&M.ref!==null&&typeof M.ref=="function"&&M.ref._stringRef===oe?M.ref:(M=function(je){var _t=J.refs;_t===Kg&&(_t=J.refs={}),je===null?delete _t[oe]:_t[oe]=je},M._stringRef=oe,M)}if(typeof E!="string")throw Error(d(284));if(!N._owner)throw Error(d(290,E))}return E}function Eu(E,M){throw E=Object.prototype.toString.call(M),Error(d(31,E==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":E))}function ny(E){var M=E._init;return M(E._payload)}function A_(E){function M(Bt,wt){if(E){var Wt=Bt.deletions;Wt===null?(Bt.deletions=[wt],Bt.flags|=16):Wt.push(wt)}}function N(Bt,wt){if(!E)return null;for(;wt!==null;)M(Bt,wt),wt=wt.sibling;return null}function H(Bt,wt){for(Bt=new Map;wt!==null;)wt.key!==null?Bt.set(wt.key,wt):Bt.set(wt.index,wt),wt=wt.sibling;return Bt}function J(Bt,wt){return Bt=Uc(Bt,wt),Bt.index=0,Bt.sibling=null,Bt}function oe(Bt,wt,Wt){return Bt.index=Wt,E?(Wt=Bt.alternate,Wt!==null?(Wt=Wt.index,Wt<wt?(Bt.flags|=2,wt):Wt):(Bt.flags|=2,wt)):(Bt.flags|=1048576,wt)}function je(Bt){return E&&Bt.alternate===null&&(Bt.flags|=2),Bt}function _t(Bt,wt,Wt,An){return wt===null||wt.tag!==6?(wt=Xt(Wt,Bt.mode,An),wt.return=Bt,wt):(wt=J(wt,Wt),wt.return=Bt,wt)}function jt(Bt,wt,Wt,An){var Dn=Wt.type;return Dn===_?Mn(Bt,wt,Wt.props.children,An,Wt.key):wt!==null&&(wt.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===F&&ny(Dn)===wt.type)?(An=J(wt,Wt.props),An.ref=Zh(Bt,wt,Wt),An.return=Bt,An):(An=qy(Wt.type,Wt.key,Wt.props,null,Bt.mode,An),An.ref=Zh(Bt,wt,Wt),An.return=Bt,An)}function dn(Bt,wt,Wt,An){return wt===null||wt.tag!==4||wt.stateNode.containerInfo!==Wt.containerInfo||wt.stateNode.implementation!==Wt.implementation?(wt=yn(Wt,Bt.mode,An),wt.return=Bt,wt):(wt=J(wt,Wt.children||[]),wt.return=Bt,wt)}function Mn(Bt,wt,Wt,An,Dn){return wt===null||wt.tag!==7?(wt=il(Wt,Bt.mode,An,Dn),wt.return=Bt,wt):(wt=J(wt,Wt),wt.return=Bt,wt)}function _a(Bt,wt,Wt){if(typeof wt=="string"&&wt!==""||typeof wt=="number")return wt=Xt(""+wt,Bt.mode,Wt),wt.return=Bt,wt;if(typeof wt=="object"&&wt!==null){switch(wt.$$typeof){case m:return Wt=qy(wt.type,wt.key,wt.props,null,Bt.mode,Wt),Wt.ref=Zh(Bt,null,wt),Wt.return=Bt,Wt;case y:return wt=yn(wt,Bt.mode,Wt),wt.return=Bt,wt;case F:var An=wt._init;return _a(Bt,An(wt._payload),Wt)}if(Ce(wt)||q(wt))return wt=il(wt,Bt.mode,Wt,null),wt.return=Bt,wt;Eu(Bt,wt)}return null}function Jn(Bt,wt,Wt,An){var Dn=wt!==null?wt.key:null;if(typeof Wt=="string"&&Wt!==""||typeof Wt=="number")return Dn!==null?null:_t(Bt,wt,""+Wt,An);if(typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case m:return Wt.key===Dn?jt(Bt,wt,Wt,An):null;case y:return Wt.key===Dn?dn(Bt,wt,Wt,An):null;case F:return Dn=Wt._init,Jn(Bt,wt,Dn(Wt._payload),An)}if(Ce(Wt)||q(Wt))return Dn!==null?null:Mn(Bt,wt,Wt,An,null);Eu(Bt,Wt)}return null}function vi(Bt,wt,Wt,An,Dn){if(typeof An=="string"&&An!==""||typeof An=="number")return Bt=Bt.get(Wt)||null,_t(wt,Bt,""+An,Dn);if(typeof An=="object"&&An!==null){switch(An.$$typeof){case m:return Bt=Bt.get(An.key===null?Wt:An.key)||null,jt(wt,Bt,An,Dn);case y:return Bt=Bt.get(An.key===null?Wt:An.key)||null,dn(wt,Bt,An,Dn);case F:var Nn=An._init;return vi(Bt,wt,Wt,Nn(An._payload),Dn)}if(Ce(An)||q(An))return Bt=Bt.get(Wt)||null,Mn(wt,Bt,An,Dn,null);Eu(wt,An)}return null}function Vn(Bt,wt,Wt,An){for(var Dn=null,Nn=null,Sa=wt,Za=wt=0,mr=null;Sa!==null&&Za<Wt.length;Za++){Sa.index>Za?(mr=Sa,Sa=null):mr=Sa.sibling;var Ua=Jn(Bt,Sa,Wt[Za],An);if(Ua===null){Sa===null&&(Sa=mr);break}E&&Sa&&Ua.alternate===null&&M(Bt,Sa),wt=oe(Ua,wt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua,Sa=mr}if(Za===Wt.length)return N(Bt,Sa),ki&&Cd(Bt,Za),Dn;if(Sa===null){for(;Za<Wt.length;Za++)Sa=_a(Bt,Wt[Za],An),Sa!==null&&(wt=oe(Sa,wt,Za),Nn===null?Dn=Sa:Nn.sibling=Sa,Nn=Sa);return ki&&Cd(Bt,Za),Dn}for(Sa=H(Bt,Sa);Za<Wt.length;Za++)mr=vi(Sa,Bt,Za,Wt[Za],An),mr!==null&&(E&&mr.alternate!==null&&Sa.delete(mr.key===null?Za:mr.key),wt=oe(mr,wt,Za),Nn===null?Dn=mr:Nn.sibling=mr,Nn=mr);return E&&Sa.forEach(function(uc){return M(Bt,uc)}),ki&&Cd(Bt,Za),Dn}function yo(Bt,wt,Wt,An){var Dn=q(Wt);if(typeof Dn!="function")throw Error(d(150));if(Wt=Dn.call(Wt),Wt==null)throw Error(d(151));for(var Nn=Dn=null,Sa=wt,Za=wt=0,mr=null,Ua=Wt.next();Sa!==null&&!Ua.done;Za++,Ua=Wt.next()){Sa.index>Za?(mr=Sa,Sa=null):mr=Sa.sibling;var uc=Jn(Bt,Sa,Ua.value,An);if(uc===null){Sa===null&&(Sa=mr);break}E&&Sa&&uc.alternate===null&&M(Bt,Sa),wt=oe(uc,wt,Za),Nn===null?Dn=uc:Nn.sibling=uc,Nn=uc,Sa=mr}if(Ua.done)return N(Bt,Sa),ki&&Cd(Bt,Za),Dn;if(Sa===null){for(;!Ua.done;Za++,Ua=Wt.next())Ua=_a(Bt,Ua.value,An),Ua!==null&&(wt=oe(Ua,wt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua);return ki&&Cd(Bt,Za),Dn}for(Sa=H(Bt,Sa);!Ua.done;Za++,Ua=Wt.next())Ua=vi(Sa,Bt,Za,Ua.value,An),Ua!==null&&(E&&Ua.alternate!==null&&Sa.delete(Ua.key===null?Za:Ua.key),wt=oe(Ua,wt,Za),Nn===null?Dn=Ua:Nn.sibling=Ua,Nn=Ua);return E&&Sa.forEach(function(Y_){return M(Bt,Y_)}),ki&&Cd(Bt,Za),Dn}function to(Bt,wt,Wt,An){if(typeof Wt=="object"&&Wt!==null&&Wt.type===_&&Wt.key===null&&(Wt=Wt.props.children),typeof Wt=="object"&&Wt!==null){switch(Wt.$$typeof){case m:e:{for(var Dn=Wt.key,Nn=wt;Nn!==null;){if(Nn.key===Dn){if(Dn=Wt.type,Dn===_){if(Nn.tag===7){N(Bt,Nn.sibling),wt=J(Nn,Wt.props.children),wt.return=Bt,Bt=wt;break e}}else if(Nn.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===F&&ny(Dn)===Nn.type){N(Bt,Nn.sibling),wt=J(Nn,Wt.props),wt.ref=Zh(Bt,Nn,Wt),wt.return=Bt,Bt=wt;break e}N(Bt,Nn);break}else M(Bt,Nn);Nn=Nn.sibling}Wt.type===_?(wt=il(Wt.props.children,Bt.mode,An,Wt.key),wt.return=Bt,Bt=wt):(An=qy(Wt.type,Wt.key,Wt.props,null,Bt.mode,An),An.ref=Zh(Bt,wt,Wt),An.return=Bt,Bt=An)}return je(Bt);case y:e:{for(Nn=Wt.key;wt!==null;){if(wt.key===Nn)if(wt.tag===4&&wt.stateNode.containerInfo===Wt.containerInfo&&wt.stateNode.implementation===Wt.implementation){N(Bt,wt.sibling),wt=J(wt,Wt.children||[]),wt.return=Bt,Bt=wt;break e}else{N(Bt,wt);break}else M(Bt,wt);wt=wt.sibling}wt=yn(Wt,Bt.mode,An),wt.return=Bt,Bt=wt}return je(Bt);case F:return Nn=Wt._init,to(Bt,wt,Nn(Wt._payload),An)}if(Ce(Wt))return Vn(Bt,wt,Wt,An);if(q(Wt))return yo(Bt,wt,Wt,An);Eu(Bt,Wt)}return typeof Wt=="string"&&Wt!==""||typeof Wt=="number"?(Wt=""+Wt,wt!==null&&wt.tag===6?(N(Bt,wt.sibling),wt=J(wt,Wt),wt.return=Bt,Bt=wt):(N(Bt,wt),wt=Xt(Wt,Bt.mode,An),wt.return=Bt,Bt=wt),je(Bt)):N(Bt,wt)}return to}var Mu=A_(!0),E_=A_(!1),Ld={},ht=Yi(Ld),Kh=Yi(Ld),Tu=Yi(Ld);function tl(E){if(E===Ld)throw Error(d(174));return E}function ay(E,M){Rn(Tu,M),Rn(Kh,E),Rn(ht,Ld),E=Ge(M),ta(ht),Rn(ht,E)}function kc(){ta(ht),ta(Kh),ta(Tu)}function rc(E){var M=tl(Tu.current),N=tl(ht.current);M=le(N,E.type,M),N!==M&&(Rn(Kh,E),Rn(ht,M))}function Op(E){Kh.current===E&&(ta(ht),ta(Kh))}var gi=Yi(0);function Rd(E){for(var M=E;M!==null;){if(M.tag===13){var N=M.memoizedState;if(N!==null&&(N=N.dehydrated,N===null||Qt(N)||mn(N)))return M}else if(M.tag===19&&M.memoizedProps.revealOrder!==void 0){if(M.flags&128)return M}else if(M.child!==null){M.child.return=M,M=M.child;continue}if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return null;M=M.return}M.sibling.return=M.return,M=M.sibling}return null}var Cu=[];function zp(){for(var E=0;E<Cu.length;E++){var M=Cu[E];Jt?M._workInProgressVersionPrimary=null:M._workInProgressVersionSecondary=null}Cu.length=0}var iy=f.ReactCurrentDispatcher,Is=f.ReactCurrentBatchConfig,kd=0,Ji=null,Oo=null,po=null,ry=!1,Fp=!1,Jh=0,yC=0;function Jr(){throw Error(d(321))}function M_(E,M){if(M===null)return!1;for(var N=0;N<M.length&&N<E.length;N++)if(!Ki(E[N],M[N]))return!1;return!0}function oy(E,M,N,H,J,oe){if(kd=oe,Ji=M,M.memoizedState=null,M.updateQueue=null,M.lanes=0,iy.current=E===null||E.memoizedState===null?Vp:Gp,E=N(H,J),Fp){oe=0;do{if(Fp=!1,Jh=0,25<=oe)throw Error(d(301));oe+=1,po=Oo=null,M.updateQueue=null,iy.current=t2,E=N(H,J)}while(Fp)}if(iy.current=fy,M=Oo!==null&&Oo.next!==null,kd=0,po=Oo=Ji=null,ry=!1,M)throw Error(d(300));return E}function Np(){var E=Jh!==0;return Jh=0,E}function nl(){var E={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return po===null?Ji.memoizedState=po=E:po=po.next=E,po}function al(){if(Oo===null){var E=Ji.alternate;E=E!==null?E.memoizedState:null}else E=Oo.next;var M=po===null?Ji.memoizedState:po.next;if(M!==null)po=M,Oo=E;else{if(E===null)throw Error(d(310));Oo=E,E={memoizedState:Oo.memoizedState,baseState:Oo.baseState,baseQueue:Oo.baseQueue,queue:Oo.queue,next:null},po===null?Ji.memoizedState=po=E:po=po.next=E}return po}function kl(E,M){return typeof M=="function"?M(E):M}function Qh(E){var M=al(),N=M.queue;if(N===null)throw Error(d(311));N.lastRenderedReducer=E;var H=Oo,J=H.baseQueue,oe=N.pending;if(oe!==null){if(J!==null){var je=J.next;J.next=oe.next,oe.next=je}H.baseQueue=J=oe,N.pending=null}if(J!==null){oe=J.next,H=H.baseState;var _t=je=null,jt=null,dn=oe;do{var Mn=dn.lane;if((kd&Mn)===Mn)jt!==null&&(jt=jt.next={lane:0,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null}),H=dn.hasEagerState?dn.eagerState:E(H,dn.action);else{var _a={lane:Mn,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null};jt===null?(_t=jt=_a,je=H):jt=jt.next=_a,Ji.lanes|=Mn,Vd|=Mn}dn=dn.next}while(dn!==null&&dn!==oe);jt===null?je=H:jt.next=_t,Ki(H,M.memoizedState)||(ss=!0),M.memoizedState=H,M.baseState=je,M.baseQueue=jt,N.lastRenderedState=H}if(E=N.interleaved,E!==null){J=E;do oe=J.lane,Ji.lanes|=oe,Vd|=oe,J=J.next;while(J!==E)}else J===null&&(N.lanes=0);return[M.memoizedState,N.dispatch]}function Pu(E){var M=al(),N=M.queue;if(N===null)throw Error(d(311));N.lastRenderedReducer=E;var H=N.dispatch,J=N.pending,oe=M.memoizedState;if(J!==null){N.pending=null;var je=J=J.next;do oe=E(oe,je.action),je=je.next;while(je!==J);Ki(oe,M.memoizedState)||(ss=!0),M.memoizedState=oe,M.baseQueue===null&&(M.baseState=oe),N.lastRenderedState=oe}return[oe,H]}function Bp(){}function sy(E,M){var N=Ji,H=al(),J=M(),oe=!Ki(H.memoizedState,J);if(oe&&(H.memoizedState=J,ss=!0),H=H.queue,nf(T_.bind(null,N,H,E),[E]),H.getSnapshot!==M||oe||po!==null&&po.memoizedState.tag&1){if(N.flags|=2048,Od(9,ly.bind(null,N,H,J,M),void 0,null),Hi===null)throw Error(d(349));kd&30||Dd(N,M,J)}return J}function Dd(E,M,N){E.flags|=16384,E={getSnapshot:M,value:N},M=Ji.updateQueue,M===null?(M={lastEffect:null,stores:null},Ji.updateQueue=M,M.stores=[E]):(N=M.stores,N===null?M.stores=[E]:N.push(E))}function ly(E,M,N,H){M.value=N,M.getSnapshot=H,cy(M)&&Qr(E,1,-1)}function T_(E,M,N){return N(function(){cy(M)&&Qr(E,1,-1)})}function cy(E){var M=E.getSnapshot;E=E.value;try{var N=M();return!Ki(E,N)}catch{return!0}}function uy(E){var M=nl();return typeof E=="function"&&(E=E()),M.memoizedState=M.baseState=E,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:kl,lastRenderedState:E},M.queue=E,E=E.dispatch=k_.bind(null,Ji,E),[M.memoizedState,E]}function Od(E,M,N,H){return E={tag:E,create:M,destroy:N,deps:H,next:null},M=Ji.updateQueue,M===null?(M={lastEffect:null,stores:null},Ji.updateQueue=M,M.lastEffect=E.next=E):(N=M.lastEffect,N===null?M.lastEffect=E.next=E:(H=N.next,N.next=E,E.next=H,M.lastEffect=E)),E}function Up(){return al().memoizedState}function ef(E,M,N,H){var J=nl();Ji.flags|=E,J.memoizedState=Od(1|M,N,void 0,H===void 0?null:H)}function tf(E,M,N,H){var J=al();H=H===void 0?null:H;var oe=void 0;if(Oo!==null){var je=Oo.memoizedState;if(oe=je.destroy,H!==null&&M_(H,je.deps)){J.memoizedState=Od(M,N,oe,H);return}}Ji.flags|=E,J.memoizedState=Od(1|M,N,oe,H)}function Ln(E,M){return ef(8390656,8,E,M)}function nf(E,M){return tf(2048,8,E,M)}function Wp(E,M){return tf(4,2,E,M)}function C_(E,M){return tf(4,4,E,M)}function P_(E,M){if(typeof M=="function")return E=E(),M(E),function(){M(null)};if(M!=null)return E=E(),M.current=E,function(){M.current=null}}function I_(E,M,N){return N=N!=null?N.concat([E]):null,tf(4,4,P_.bind(null,M,E),N)}function Iu(){}function L_(E,M){var N=al();M=M===void 0?null:M;var H=N.memoizedState;return H!==null&&M!==null&&M_(M,H[1])?H[0]:(N.memoizedState=[E,M],E)}function Qw(E,M){var N=al();M=M===void 0?null:M;var H=N.memoizedState;return H!==null&&M!==null&&M_(M,H[1])?H[0]:(E=E(),N.memoizedState=[E,M],E)}function vC(E,M){var N=Bn;Bn=N!==0&&4>N?N:4,E(!0);var H=Is.transition;Is.transition={};try{E(!1),M()}finally{Bn=N,Is.transition=H}}function e2(){return al().memoizedState}function R_(E,M,N){var H=Nu(E);N={lane:H,action:N,hasEagerState:!1,eagerState:null,next:null},dy(E)?hy(M,N):(D_(E,M,N),N=go(),E=Qr(E,H,N),E!==null&&O_(E,M,H))}function k_(E,M,N){var H=Nu(E),J={lane:H,action:N,hasEagerState:!1,eagerState:null,next:null};if(dy(E))hy(M,J);else{D_(E,M,J);var oe=E.alternate;if(E.lanes===0&&(oe===null||oe.lanes===0)&&(oe=M.lastRenderedReducer,oe!==null))try{var je=M.lastRenderedState,_t=oe(je,N);if(J.hasEagerState=!0,J.eagerState=_t,Ki(_t,je))return}catch{}finally{}N=go(),E=Qr(E,H,N),E!==null&&O_(E,M,H)}}function dy(E){var M=E.alternate;return E===Ji||M!==null&&M===Ji}function hy(E,M){Fp=ry=!0;var N=E.pending;N===null?M.next=M:(M.next=N.next,N.next=M),E.pending=M}function D_(E,M,N){Hi!==null&&E.mode&1&&!(Da&2)?(E=M.interleaved,E===null?(N.next=N,$o===null?$o=[M]:$o.push(M)):(N.next=E.next,E.next=N),M.interleaved=N):(E=M.pending,E===null?N.next=N:(N.next=E.next,E.next=N),M.pending=N)}function O_(E,M,N){if(N&4194240){var H=M.lanes;H&=E.pendingLanes,N|=H,M.lanes=N,vn(E,N)}}var fy={readContext:ar,useCallback:Jr,useContext:Jr,useEffect:Jr,useImperativeHandle:Jr,useInsertionEffect:Jr,useLayoutEffect:Jr,useMemo:Jr,useReducer:Jr,useRef:Jr,useState:Jr,useDebugValue:Jr,useDeferredValue:Jr,useTransition:Jr,useMutableSource:Jr,useSyncExternalStore:Jr,useId:Jr,unstable_isNewReconciler:!1},Vp={readContext:ar,useCallback:function(E,M){return nl().memoizedState=[E,M===void 0?null:M],E},useContext:ar,useEffect:Ln,useImperativeHandle:function(E,M,N){return N=N!=null?N.concat([E]):null,ef(4194308,4,P_.bind(null,M,E),N)},useLayoutEffect:function(E,M){return ef(4194308,4,E,M)},useInsertionEffect:function(E,M){return ef(4,2,E,M)},useMemo:function(E,M){var N=nl();return M=M===void 0?null:M,E=E(),N.memoizedState=[E,M],E},useReducer:function(E,M,N){var H=nl();return M=N!==void 0?N(M):M,H.memoizedState=H.baseState=M,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:E,lastRenderedState:M},H.queue=E,E=E.dispatch=R_.bind(null,Ji,E),[H.memoizedState,E]},useRef:function(E){var M=nl();return E={current:E},M.memoizedState=E},useState:uy,useDebugValue:Iu,useDeferredValue:function(E){var M=uy(E),N=M[0],H=M[1];return Ln(function(){var J=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=J}},[E]),N},useTransition:function(){var E=uy(!1),M=E[0];return E=vC.bind(null,E[1]),nl().memoizedState=E,[M,E]},useMutableSource:function(){},useSyncExternalStore:function(E,M,N){var H=Ji,J=nl();if(ki){if(N===void 0)throw Error(d(407));N=N()}else{if(N=M(),Hi===null)throw Error(d(349));kd&30||Dd(H,M,N)}J.memoizedState=N;var oe={value:N,getSnapshot:M};return J.queue=oe,Ln(T_.bind(null,H,oe,E),[E]),H.flags|=2048,Od(9,ly.bind(null,H,oe,N,M),void 0,null),N},useId:function(){var E=nl(),M=Hi.identifierPrefix;if(ki){var N=Rc,H=ic;N=(H&~(1<<32-Sr(H)-1)).toString(32)+N,M=":"+M+"R"+N,N=Jh++,0<N&&(M+="H"+N.toString(32)),M+=":"}else N=yC++,M=":"+M+"r"+N.toString(32)+":";return E.memoizedState=M},unstable_isNewReconciler:!1},Gp={readContext:ar,useCallback:L_,useContext:ar,useEffect:nf,useImperativeHandle:I_,useInsertionEffect:Wp,useLayoutEffect:C_,useMemo:Qw,useReducer:Qh,useRef:Up,useState:function(){return Qh(kl)},useDebugValue:Iu,useDeferredValue:function(E){var M=Qh(kl),N=M[0],H=M[1];return nf(function(){var J=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=J}},[E]),N},useTransition:function(){var E=Qh(kl)[0],M=al().memoizedState;return[E,M]},useMutableSource:Bp,useSyncExternalStore:sy,useId:e2,unstable_isNewReconciler:!1},t2={readContext:ar,useCallback:L_,useContext:ar,useEffect:nf,useImperativeHandle:I_,useInsertionEffect:Wp,useLayoutEffect:C_,useMemo:Qw,useReducer:Pu,useRef:Up,useState:function(){return Pu(kl)},useDebugValue:Iu,useDeferredValue:function(E){var M=Pu(kl),N=M[0],H=M[1];return nf(function(){var J=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=J}},[E]),N},useTransition:function(){var E=Pu(kl)[0],M=al().memoizedState;return[E,M]},useMutableSource:Bp,useSyncExternalStore:sy,useId:e2,unstable_isNewReconciler:!1};function af(E,M){try{var N="",H=M;do N+=Il(H),H=H.return;while(H);var J=N}catch(oe){J=`
Error generating stack: `+oe.message+`
`+oe.stack}return{value:E,source:M,stack:J}}function Hp(E,M){try{console.error(M.value)}catch(N){setTimeout(function(){throw N})}}var oc=typeof WeakMap=="function"?WeakMap:Map;function py(E,M,N){N=rs(-1,N),N.tag=3,N.payload={element:null};var H=M.value;return N.callback=function(){Fy||(Fy=!0,G_=H),Hp(E,M)},N}function z_(E,M,N){N=rs(-1,N),N.tag=3;var H=E.type.getDerivedStateFromError;if(typeof H=="function"){var J=M.value;N.payload=function(){return H(J)},N.callback=function(){Hp(E,M)}}var oe=E.stateNode;return oe!==null&&typeof oe.componentDidCatch=="function"&&(N.callback=function(){Hp(E,M),typeof H!="function"&&(zu===null?zu=new Set([this]):zu.add(this));var je=M.stack;this.componentDidCatch(M.value,{componentStack:je!==null?je:""})}),N}function my(E,M,N){var H=E.pingCache;if(H===null){H=E.pingCache=new oc;var J=new Set;H.set(M,J)}else J=H.get(M),J===void 0&&(J=new Set,H.set(M,J));J.has(N)||(J.add(N),E=$_.bind(null,E,M,N),M.then(E,E))}function F_(E){do{var M;if((M=E.tag===13)&&(M=E.memoizedState,M=M!==null?M.dehydrated!==null:!0),M)return E;E=E.return}while(E!==null);return null}function gy(E,M,N,H,J){return E.mode&1?(E.flags|=65536,E.lanes=J,E):(E===M?E.flags|=65536:(E.flags|=128,N.flags|=131072,N.flags&=-52805,N.tag===1&&(N.alternate===null?N.tag=17:(M=rs(-1,1),M.tag=2,Ci(N,M))),N.lanes|=1),E)}function sc(E){E.flags|=4}function yy(E,M){if(E!==null&&E.child===M.child)return!0;if(M.flags&16)return!1;for(E=M.child;E!==null;){if(E.flags&12854||E.subtreeFlags&12854)return!1;E=E.sibling}return!0}var jp,Lu,vy,rf;if(It)jp=function(E,M){for(var N=M.child;N!==null;){if(N.tag===5||N.tag===6)Ee(E,N.stateNode);else if(N.tag!==4&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===M)break;for(;N.sibling===null;){if(N.return===null||N.return===M)return;N=N.return}N.sibling.return=N.return,N=N.sibling}},Lu=function(){},vy=function(E,M,N,H,J){if(E=E.memoizedProps,E!==H){var oe=M.stateNode,je=tl(ht.current);N=Xe(oe,N,E,H,J,je),(M.updateQueue=N)&&sc(M)}},rf=function(E,M,N,H){N!==H&&sc(M)};else if(Pe){jp=function(E,M,N,H){for(var J=M.child;J!==null;){if(J.tag===5){var oe=J.stateNode;N&&H&&(oe=vt(oe,J.type,J.memoizedProps,J)),Ee(E,oe)}else if(J.tag===6)oe=J.stateNode,N&&H&&(oe=dt(oe,J.memoizedProps,J)),Ee(E,oe);else if(J.tag!==4){if(J.tag===22&&J.memoizedState!==null)oe=J.child,oe!==null&&(oe.return=J),jp(E,J,!0,!0);else if(J.child!==null){J.child.return=J,J=J.child;continue}}if(J===M)break;for(;J.sibling===null;){if(J.return===null||J.return===M)return;J=J.return}J.sibling.return=J.return,J=J.sibling}};var n2=function(E,M,N,H){for(var J=M.child;J!==null;){if(J.tag===5){var oe=J.stateNode;N&&H&&(oe=vt(oe,J.type,J.memoizedProps,J)),ze(E,oe)}else if(J.tag===6)oe=J.stateNode,N&&H&&(oe=dt(oe,J.memoizedProps,J)),ze(E,oe);else if(J.tag!==4){if(J.tag===22&&J.memoizedState!==null)oe=J.child,oe!==null&&(oe.return=J),n2(E,J,!0,!0);else if(J.child!==null){J.child.return=J,J=J.child;continue}}if(J===M)break;for(;J.sibling===null;){if(J.return===null||J.return===M)return;J=J.return}J.sibling.return=J.return,J=J.sibling}};Lu=function(E,M){var N=M.stateNode;if(!yy(E,M)){E=N.containerInfo;var H=Me(E);n2(H,M,!1,!1),N.pendingChildren=H,sc(M),Qe(E,H)}},vy=function(E,M,N,H,J){var oe=E.stateNode,je=E.memoizedProps;if((E=yy(E,M))&&je===H)M.stateNode=oe;else{var _t=M.stateNode,jt=tl(ht.current),dn=null;je!==H&&(dn=Xe(_t,N,je,H,J,jt)),E&&dn===null?M.stateNode=oe:(oe=Se(oe,dn,N,je,H,M,E,_t),Ze(oe,N,H,J,jt)&&sc(M),M.stateNode=oe,E?sc(M):jp(oe,M,!1,!1))}},rf=function(E,M,N,H){N!==H?(E=tl(Tu.current),N=tl(ht.current),M.stateNode=Ue(H,E,N,M),sc(M)):M.stateNode=E.stateNode}}else Lu=function(){},vy=function(){},rf=function(){};function zd(E,M){if(!ki)switch(E.tailMode){case"hidden":M=E.tail;for(var N=null;M!==null;)M.alternate!==null&&(N=M),M=M.sibling;N===null?E.tail=null:N.sibling=null;break;case"collapsed":N=E.tail;for(var H=null;N!==null;)N.alternate!==null&&(H=N),N=N.sibling;H===null?M||E.tail===null?E.tail=null:E.tail.sibling=null:H.sibling=null}}function zo(E){var M=E.alternate!==null&&E.alternate.child===E.child,N=0,H=0;if(M)for(var J=E.child;J!==null;)N|=J.lanes|J.childLanes,H|=J.subtreeFlags&14680064,H|=J.flags&14680064,J.return=E,J=J.sibling;else for(J=E.child;J!==null;)N|=J.lanes|J.childLanes,H|=J.subtreeFlags,H|=J.flags,J.return=E,J=J.sibling;return E.subtreeFlags|=H,E.childLanes=N,M}function _y(E,M,N){var H=M.pendingProps;switch(w_(M),M.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zo(M),null;case 1:return Zi(M.type)&&ui(),zo(M),null;case 3:return H=M.stateNode,kc(),ta(Mi),ta(Ra),zp(),H.pendingContext&&(H.context=H.pendingContext,H.pendingContext=null),(E===null||E.child===null)&&(Yh(M)?sc(M):E===null||E.memoizedState.isDehydrated&&!(M.flags&256)||(M.flags|=1024,Rl!==null&&(Uy(Rl),Rl=null))),Lu(E,M),zo(M),null;case 5:Op(M),N=tl(Tu.current);var J=M.type;if(E!==null&&M.stateNode!=null)vy(E,M,J,H,N),E.ref!==M.ref&&(M.flags|=512,M.flags|=2097152);else{if(!H){if(M.stateNode===null)throw Error(d(166));return zo(M),null}if(E=tl(ht.current),Yh(M)){if(!pt)throw Error(d(175));E=Ta(M.stateNode,M.type,M.memoizedProps,N,E,M,!el),M.updateQueue=E,E!==null&&sc(M)}else{var oe=ae(J,H,N,E,M);jp(oe,M,!1,!1),M.stateNode=oe,Ze(oe,J,H,N,E)&&sc(M)}M.ref!==null&&(M.flags|=512,M.flags|=2097152)}return zo(M),null;case 6:if(E&&M.stateNode!=null)rf(E,M,E.memoizedProps,H);else{if(typeof H!="string"&&M.stateNode===null)throw Error(d(166));if(E=tl(Tu.current),N=tl(ht.current),Yh(M)){if(!pt)throw Error(d(176));if(E=M.stateNode,H=M.memoizedProps,(N=Li(E,H,M,!el))&&(J=fo,J!==null))switch(oe=(J.mode&1)!==0,J.tag){case 3:Tn(J.stateNode.containerInfo,E,H,oe);break;case 5:qn(J.type,J.memoizedProps,J.stateNode,E,H,oe)}N&&sc(M)}else M.stateNode=Ue(H,E,N,M)}return zo(M),null;case 13:if(ta(gi),H=M.memoizedState,ki&&os!==null&&M.mode&1&&!(M.flags&128)){for(E=os;E;)E=wn(E);return Id(),M.flags|=98560,M}if(H!==null&&H.dehydrated!==null){if(H=Yh(M),E===null){if(!H)throw Error(d(318));if(!pt)throw Error(d(344));if(E=M.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));mi(E,M)}else Id(),!(M.flags&128)&&(M.memoizedState=null),M.flags|=4;return zo(M),null}return Rl!==null&&(Uy(Rl),Rl=null),M.flags&128?(M.lanes=N,M):(H=H!==null,N=!1,E===null?Yh(M):N=E.memoizedState!==null,H&&!N&&(M.child.flags|=8192,M.mode&1&&(E===null||gi.current&1?Br===0&&(Br=3):Vy())),M.updateQueue!==null&&(M.flags|=4),zo(M),null);case 4:return kc(),Lu(E,M),E===null&&At(M.stateNode.containerInfo),zo(M),null;case 10:return Nr(M.type._context),zo(M),null;case 17:return Zi(M.type)&&ui(),zo(M),null;case 19:if(ta(gi),J=M.memoizedState,J===null)return zo(M),null;if(H=(M.flags&128)!==0,oe=J.rendering,oe===null)if(H)zd(J,!1);else{if(Br!==0||E!==null&&E.flags&128)for(E=M.child;E!==null;){if(oe=Rd(E),oe!==null){for(M.flags|=128,zd(J,!1),E=oe.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),M.subtreeFlags=0,E=N,H=M.child;H!==null;)N=H,J=E,N.flags&=14680066,oe=N.alternate,oe===null?(N.childLanes=0,N.lanes=J,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=oe.childLanes,N.lanes=oe.lanes,N.child=oe.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=oe.memoizedProps,N.memoizedState=oe.memoizedState,N.updateQueue=oe.updateQueue,N.type=oe.type,J=oe.dependencies,N.dependencies=J===null?null:{lanes:J.lanes,firstContext:J.firstContext}),H=H.sibling;return Rn(gi,gi.current&1|2),M.child}E=E.sibling}J.tail!==null&&ii()>Ou&&(M.flags|=128,H=!0,zd(J,!1),M.lanes=4194304)}else{if(!H)if(E=Rd(oe),E!==null){if(M.flags|=128,H=!0,E=E.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),zd(J,!0),J.tail===null&&J.tailMode==="hidden"&&!oe.alternate&&!ki)return zo(M),null}else 2*ii()-J.renderingStartTime>Ou&&N!==1073741824&&(M.flags|=128,H=!0,zd(J,!1),M.lanes=4194304);J.isBackwards?(oe.sibling=M.child,M.child=oe):(E=J.last,E!==null?E.sibling=oe:M.child=oe,J.last=oe)}return J.tail!==null?(M=J.tail,J.rendering=M,J.tail=M.sibling,J.renderingStartTime=ii(),M.sibling=null,E=gi.current,Rn(gi,H?E&1|2:E&1),M):(zo(M),null);case 22:case 23:return hm(),H=M.memoizedState!==null,E!==null&&E.memoizedState!==null!==H&&(M.flags|=8192),H&&M.mode&1?Ls&1073741824&&(zo(M),It&&M.subtreeFlags&6&&(M.flags|=8192)):zo(M),null;case 24:return null;case 25:return null}throw Error(d(156,M.tag))}var _C=f.ReactCurrentOwner,ss=!1;function Fo(E,M,N,H){M.child=E===null?E_(M,null,N,H):Mu(M,E.child,N,H)}function Fd(E,M,N,H,J){N=N.render;var oe=M.ref;return xn(M,J),H=oy(E,M,N,H,oe,J),N=Np(),E!==null&&!ss?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~J,cc(E,M,J)):(ki&&N&&Pd(M),M.flags|=1,Fo(E,M,H,J),M.child)}function a2(E,M,N,H,J){if(E===null){var oe=N.type;return typeof oe=="function"&&!jd(oe)&&oe.defaultProps===void 0&&N.compare===null&&N.defaultProps===void 0?(M.tag=15,M.type=oe,i2(E,M,oe,H,J)):(E=qy(N.type,null,H,M,M.mode,J),E.ref=M.ref,E.return=M,M.child=E)}if(oe=E.child,!(E.lanes&J)){var je=oe.memoizedProps;if(N=N.compare,N=N!==null?N:Md,N(je,H)&&E.ref===M.ref)return cc(E,M,J)}return M.flags|=1,E=Uc(oe,H),E.ref=M.ref,E.return=M,M.child=E}function i2(E,M,N,H,J){if(E!==null&&Md(E.memoizedProps,H)&&E.ref===M.ref)if(ss=!1,(E.lanes&J)!==0)E.flags&131072&&(ss=!0);else return M.lanes=E.lanes,cc(E,M,J);return N_(E,M,N,H,J)}function r2(E,M,N){var H=M.pendingProps,J=H.children,oe=E!==null?E.memoizedState:null;if(H.mode==="hidden")if(!(M.mode&1))M.memoizedState={baseLanes:0,cachePool:null},Rn(Wd,Ls),Ls|=N;else if(N&1073741824)M.memoizedState={baseLanes:0,cachePool:null},H=oe!==null?oe.baseLanes:N,Rn(Wd,Ls),Ls|=H;else return E=oe!==null?oe.baseLanes|N:N,M.lanes=M.childLanes=1073741824,M.memoizedState={baseLanes:E,cachePool:null},M.updateQueue=null,Rn(Wd,Ls),Ls|=E,null;else oe!==null?(H=oe.baseLanes|N,M.memoizedState=null):H=N,Rn(Wd,Ls),Ls|=H;return Fo(E,M,J,N),M.child}function o2(E,M){var N=M.ref;(E===null&&N!==null||E!==null&&E.ref!==N)&&(M.flags|=512,M.flags|=2097152)}function N_(E,M,N,H,J){var oe=Zi(N)?Ho:Ra.current;return oe=wr(M,oe),xn(M,J),N=oy(E,M,N,H,oe,J),H=Np(),E!==null&&!ss?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~J,cc(E,M,J)):(ki&&H&&Pd(M),M.flags|=1,Fo(E,M,N,J),M.child)}function s2(E,M,N,H,J){if(Zi(N)){var oe=!0;Zn(M)}else oe=!1;if(xn(M,J),M.stateNode===null)E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),qh(M,N,H),x_(M,N,H,J),H=!0;else if(E===null){var je=M.stateNode,_t=M.memoizedProps;je.props=_t;var jt=je.context,dn=N.contextType;typeof dn=="object"&&dn!==null?dn=ar(dn):(dn=Zi(N)?Ho:Ra.current,dn=wr(M,dn));var Mn=N.getDerivedStateFromProps,_a=typeof Mn=="function"||typeof je.getSnapshotBeforeUpdate=="function";_a||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(_t!==H||jt!==dn)&&ka(M,je,H,dn),Ar=!1;var Jn=M.memoizedState;je.state=Jn,Su(M,H,je,J),jt=M.memoizedState,_t!==H||Jn!==jt||Mi.current||Ar?(typeof Mn=="function"&&(kp(M,N,Mn,H),jt=M.memoizedState),(_t=Ar||$h(M,N,_t,H,Jn,jt,dn))?(_a||typeof je.UNSAFE_componentWillMount!="function"&&typeof je.componentWillMount!="function"||(typeof je.componentWillMount=="function"&&je.componentWillMount(),typeof je.UNSAFE_componentWillMount=="function"&&je.UNSAFE_componentWillMount()),typeof je.componentDidMount=="function"&&(M.flags|=4194308)):(typeof je.componentDidMount=="function"&&(M.flags|=4194308),M.memoizedProps=H,M.memoizedState=jt),je.props=H,je.state=jt,je.context=dn,H=_t):(typeof je.componentDidMount=="function"&&(M.flags|=4194308),H=!1)}else{je=M.stateNode,b_(E,M),_t=M.memoizedProps,dn=M.type===M.elementType?_t:Eo(M.type,_t),je.props=dn,_a=M.pendingProps,Jn=je.context,jt=N.contextType,typeof jt=="object"&&jt!==null?jt=ar(jt):(jt=Zi(N)?Ho:Ra.current,jt=wr(M,jt));var vi=N.getDerivedStateFromProps;(Mn=typeof vi=="function"||typeof je.getSnapshotBeforeUpdate=="function")||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(_t!==_a||Jn!==jt)&&ka(M,je,H,jt),Ar=!1,Jn=M.memoizedState,je.state=Jn,Su(M,H,je,J);var Vn=M.memoizedState;_t!==_a||Jn!==Vn||Mi.current||Ar?(typeof vi=="function"&&(kp(M,N,vi,H),Vn=M.memoizedState),(dn=Ar||$h(M,N,dn,H,Jn,Vn,jt)||!1)?(Mn||typeof je.UNSAFE_componentWillUpdate!="function"&&typeof je.componentWillUpdate!="function"||(typeof je.componentWillUpdate=="function"&&je.componentWillUpdate(H,Vn,jt),typeof je.UNSAFE_componentWillUpdate=="function"&&je.UNSAFE_componentWillUpdate(H,Vn,jt)),typeof je.componentDidUpdate=="function"&&(M.flags|=4),typeof je.getSnapshotBeforeUpdate=="function"&&(M.flags|=1024)):(typeof je.componentDidUpdate!="function"||_t===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||_t===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=1024),M.memoizedProps=H,M.memoizedState=Vn),je.props=H,je.state=Vn,je.context=jt,H=dn):(typeof je.componentDidUpdate!="function"||_t===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||_t===E.memoizedProps&&Jn===E.memoizedState||(M.flags|=1024),H=!1)}return $p(E,M,N,H,oe,J)}function $p(E,M,N,H,J,oe){o2(E,M);var je=(M.flags&128)!==0;if(!H&&!je)return J&&Gi(M,N,!1),cc(E,M,oe);H=M.stateNode,_C.current=M;var _t=je&&typeof N.getDerivedStateFromError!="function"?null:H.render();return M.flags|=1,E!==null&&je?(M.child=Mu(M,E.child,null,oe),M.child=Mu(M,null,_t,oe)):Fo(E,M,_t,oe),M.memoizedState=H.state,J&&Gi(M,N,!0),M.child}function by(E){var M=E.stateNode;M.pendingContext?zr(E,M.pendingContext,M.pendingContext!==M.context):M.context&&zr(E,M.context,!1),ay(E,M.containerInfo)}function xy(E,M,N,H,J){return Id(),ty(J),M.flags|=256,Fo(E,M,N,H),M.child}var qp={dehydrated:null,treeContext:null,retryLane:0};function Xp(E){return{baseLanes:E,cachePool:null}}function B_(E,M,N){var H=M.pendingProps,J=gi.current,oe=!1,je=(M.flags&128)!==0,_t;if((_t=je)||(_t=E!==null&&E.memoizedState===null?!1:(J&2)!==0),_t?(oe=!0,M.flags&=-129):(E===null||E.memoizedState!==null)&&(J|=1),Rn(gi,J&1),E===null)return S_(M),E=M.memoizedState,E!==null&&(E=E.dehydrated,E!==null)?(M.mode&1?mn(E)?M.lanes=8:M.lanes=1073741824:M.lanes=1,null):(J=H.children,E=H.fallback,oe?(H=M.mode,oe=M.child,J={mode:"hidden",children:J},!(H&1)&&oe!==null?(oe.childLanes=0,oe.pendingProps=J):oe=Bu(J,H,0,null),E=il(E,H,N,null),oe.return=M,E.return=M,oe.sibling=E,M.child=oe,M.child.memoizedState=Xp(N),M.memoizedState=qp,E):wy(M,J));if(J=E.memoizedState,J!==null){if(_t=J.dehydrated,_t!==null){if(je)return M.flags&256?(M.flags&=-257,lc(E,M,N,Error(d(422)))):M.memoizedState!==null?(M.child=E.child,M.flags|=128,null):(oe=H.fallback,J=M.mode,H=Bu({mode:"visible",children:H.children},J,0,null),oe=il(oe,J,N,null),oe.flags|=2,H.return=M,oe.return=M,H.sibling=oe,M.child=H,M.mode&1&&Mu(M,E.child,null,N),M.child.memoizedState=Xp(N),M.memoizedState=qp,oe);if(!(M.mode&1))M=lc(E,M,N,null);else if(mn(_t))M=lc(E,M,N,Error(d(419)));else if(H=(N&E.childLanes)!==0,ss||H){if(H=Hi,H!==null){switch(N&-N){case 4:oe=2;break;case 16:oe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:oe=32;break;case 536870912:oe=268435456;break;default:oe=0}H=oe&(H.suspendedLanes|N)?0:oe,H!==0&&H!==J.retryLane&&(J.retryLane=H,Qr(E,H,-1))}Vy(),M=lc(E,M,N,Error(d(421)))}else Qt(_t)?(M.flags|=128,M.child=E.child,M=q_.bind(null,E),nn(_t,M),M=null):(N=J.treeContext,pt&&(os=Pa(_t),fo=M,ki=!0,Rl=null,el=!1,N!==null&&(Mo[Mr++]=ic,Mo[Mr++]=Rc,Mo[Mr++]=ac,ic=N.id,Rc=N.overflow,ac=M)),M=wy(M,M.pendingProps.children),M.flags|=4096);return M}return oe?(H=U_(E,M,H.children,H.fallback,N),oe=M.child,J=E.child.memoizedState,oe.memoizedState=J===null?Xp(N):{baseLanes:J.baseLanes|N,cachePool:null},oe.childLanes=E.childLanes&~N,M.memoizedState=qp,H):(N=Sy(E,M,H.children,N),M.memoizedState=null,N)}return oe?(H=U_(E,M,H.children,H.fallback,N),oe=M.child,J=E.child.memoizedState,oe.memoizedState=J===null?Xp(N):{baseLanes:J.baseLanes|N,cachePool:null},oe.childLanes=E.childLanes&~N,M.memoizedState=qp,H):(N=Sy(E,M,H.children,N),M.memoizedState=null,N)}function wy(E,M){return M=Bu({mode:"visible",children:M},E.mode,0,null),M.return=E,E.child=M}function Sy(E,M,N,H){var J=E.child;return E=J.sibling,N=Uc(J,{mode:"visible",children:N}),!(M.mode&1)&&(N.lanes=H),N.return=M,N.sibling=null,E!==null&&(H=M.deletions,H===null?(M.deletions=[E],M.flags|=16):H.push(E)),M.child=N}function U_(E,M,N,H,J){var oe=M.mode;E=E.child;var je=E.sibling,_t={mode:"hidden",children:N};return!(oe&1)&&M.child!==E?(N=M.child,N.childLanes=0,N.pendingProps=_t,M.deletions=null):(N=Uc(E,_t),N.subtreeFlags=E.subtreeFlags&14680064),je!==null?H=Uc(je,H):(H=il(H,oe,J,null),H.flags|=2),H.return=M,N.return=M,N.sibling=H,M.child=N,H}function lc(E,M,N,H){return H!==null&&ty(H),Mu(M,E.child,null,N),E=wy(M,M.pendingProps.children),E.flags|=2,M.memoizedState=null,E}function of(E,M,N){E.lanes|=M;var H=E.alternate;H!==null&&(H.lanes|=M),Ti(E.return,M,N)}function Ay(E,M,N,H,J){var oe=E.memoizedState;oe===null?E.memoizedState={isBackwards:M,rendering:null,renderingStartTime:0,last:H,tail:N,tailMode:J}:(oe.isBackwards=M,oe.rendering=null,oe.renderingStartTime=0,oe.last=H,oe.tail=N,oe.tailMode=J)}function Ru(E,M,N){var H=M.pendingProps,J=H.revealOrder,oe=H.tail;if(Fo(E,M,H.children,N),H=gi.current,H&2)H=H&1|2,M.flags|=128;else{if(E!==null&&E.flags&128)e:for(E=M.child;E!==null;){if(E.tag===13)E.memoizedState!==null&&of(E,N,M);else if(E.tag===19)of(E,N,M);else if(E.child!==null){E.child.return=E,E=E.child;continue}if(E===M)break e;for(;E.sibling===null;){if(E.return===null||E.return===M)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}H&=1}if(Rn(gi,H),!(M.mode&1))M.memoizedState=null;else switch(J){case"forwards":for(N=M.child,J=null;N!==null;)E=N.alternate,E!==null&&Rd(E)===null&&(J=N),N=N.sibling;N=J,N===null?(J=M.child,M.child=null):(J=N.sibling,N.sibling=null),Ay(M,!1,J,N,oe);break;case"backwards":for(N=null,J=M.child,M.child=null;J!==null;){if(E=J.alternate,E!==null&&Rd(E)===null){M.child=J;break}E=J.sibling,J.sibling=N,N=J,J=E}Ay(M,!0,N,null,oe);break;case"together":Ay(M,!1,null,null,void 0);break;default:M.memoizedState=null}return M.child}function cc(E,M,N){if(E!==null&&(M.dependencies=E.dependencies),Vd|=M.lanes,!(N&M.childLanes))return null;if(E!==null&&M.child!==E.child)throw Error(d(153));if(M.child!==null){for(E=M.child,N=Uc(E,E.pendingProps),M.child=N,N.return=M;E.sibling!==null;)E=E.sibling,N=N.sibling=Uc(E,E.pendingProps),N.return=M;N.sibling=null}return M.child}function Nd(E,M,N){switch(M.tag){case 3:by(M),Id();break;case 5:rc(M);break;case 1:Zi(M.type)&&Zn(M);break;case 4:ay(M,M.stateNode.containerInfo);break;case 10:Td(M,M.type._context,M.memoizedProps.value);break;case 13:var H=M.memoizedState;if(H!==null)return H.dehydrated!==null?(Rn(gi,gi.current&1),M.flags|=128,null):N&M.child.childLanes?B_(E,M,N):(Rn(gi,gi.current&1),E=cc(E,M,N),E!==null?E.sibling:null);Rn(gi,gi.current&1);break;case 19:if(H=(N&M.childLanes)!==0,E.flags&128){if(H)return Ru(E,M,N);M.flags|=128}var J=M.memoizedState;if(J!==null&&(J.rendering=null,J.tail=null,J.lastEffect=null),Rn(gi,gi.current),H)break;return null;case 22:case 23:return M.lanes=0,r2(E,M,N)}return cc(E,M,N)}function l2(E,M){switch(w_(M),M.tag){case 1:return Zi(M.type)&&ui(),E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 3:return kc(),ta(Mi),ta(Ra),zp(),E=M.flags,E&65536&&!(E&128)?(M.flags=E&-65537|128,M):null;case 5:return Op(M),null;case 13:if(ta(gi),E=M.memoizedState,E!==null&&E.dehydrated!==null){if(M.alternate===null)throw Error(d(340));Id()}return E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 19:return ta(gi),null;case 4:return kc(),null;case 10:return Nr(M.type._context),null;case 22:case 23:return hm(),null;case 24:return null;default:return null}}var sf=!1,Dc=!1,Ey=typeof WeakSet=="function"?WeakSet:Set,Sn=null;function Yp(E,M){var N=E.ref;if(N!==null)if(typeof N=="function")try{N(null)}catch(H){qo(E,M,H)}else N.current=null}function Bd(E,M,N){try{N()}catch(H){qo(E,M,H)}}var c2=!1;function bC(E,M){for(pe(E.containerInfo),Sn=M;Sn!==null;)if(E=Sn,M=E.child,(E.subtreeFlags&1028)!==0&&M!==null)M.return=E,Sn=M;else for(;Sn!==null;){E=Sn;try{var N=E.alternate;if(E.flags&1024)switch(E.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var H=N.memoizedProps,J=N.memoizedState,oe=E.stateNode,je=oe.getSnapshotBeforeUpdate(E.elementType===E.type?H:Eo(E.type,H),J);oe.__reactInternalSnapshotBeforeUpdate=je}break;case 3:It&&Ye(E.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(d(163))}}catch(_t){qo(E,E.return,_t)}if(M=E.sibling,M!==null){M.return=E.return,Sn=M;break}Sn=E.return}return N=c2,c2=!1,N}function ku(E,M,N){var H=M.updateQueue;if(H=H!==null?H.lastEffect:null,H!==null){var J=H=H.next;do{if((J.tag&E)===E){var oe=J.destroy;J.destroy=void 0,oe!==void 0&&Bd(M,N,oe)}J=J.next}while(J!==H)}}function Zp(E,M){if(M=M.updateQueue,M=M!==null?M.lastEffect:null,M!==null){var N=M=M.next;do{if((N.tag&E)===E){var H=N.create;N.destroy=H()}N=N.next}while(N!==M)}}function Kp(E){var M=E.ref;if(M!==null){var N=E.stateNode;switch(E.tag){case 5:E=Le(N);break;default:E=N}typeof M=="function"?M(E):M.current=E}}function Jp(E,M,N){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Zs,M)}catch{}switch(M.tag){case 0:case 11:case 14:case 15:if(E=M.updateQueue,E!==null&&(E=E.lastEffect,E!==null)){var H=E=E.next;do{var J=H,oe=J.destroy;J=J.tag,oe!==void 0&&(J&2||J&4)&&Bd(M,N,oe),H=H.next}while(H!==E)}break;case 1:if(Yp(M,N),E=M.stateNode,typeof E.componentWillUnmount=="function")try{E.props=M.memoizedProps,E.state=M.memoizedState,E.componentWillUnmount()}catch(je){qo(M,N,je)}break;case 5:Yp(M,N);break;case 4:It?W_(E,M,N):Pe&&Pe&&(M=M.stateNode.containerInfo,N=Me(M),tt(M,N))}}function Oc(E,M,N){for(var H=M;;)if(Jp(E,H,N),H.child===null||It&&H.tag===4){if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return}H.sibling.return=H.return,H=H.sibling}else H.child.return=H,H=H.child}function My(E){var M=E.alternate;M!==null&&(E.alternate=null,My(M)),E.child=null,E.deletions=null,E.sibling=null,E.tag===5&&(M=E.stateNode,M!==null&&ue(M)),E.stateNode=null,E.return=null,E.dependencies=null,E.memoizedProps=null,E.memoizedState=null,E.pendingProps=null,E.stateNode=null,E.updateQueue=null}function zc(E){return E.tag===5||E.tag===3||E.tag===4}function Ty(E){e:for(;;){for(;E.sibling===null;){if(E.return===null||zc(E.return))return null;E=E.return}for(E.sibling.return=E.return,E=E.sibling;E.tag!==5&&E.tag!==6&&E.tag!==18;){if(E.flags&2||E.child===null||E.tag===4)continue e;E.child.return=E,E=E.child}if(!(E.flags&2))return E.stateNode}}function Qp(E){if(It){e:{for(var M=E.return;M!==null;){if(zc(M))break e;M=M.return}throw Error(d(160))}var N=M;switch(N.tag){case 5:M=N.stateNode,N.flags&32&&(Lt(M),N.flags&=-33),N=Ty(E),ls(E,N,M);break;case 3:case 4:M=N.stateNode.containerInfo,N=Ty(E),lf(E,N,M);break;default:throw Error(d(161))}}}function lf(E,M,N){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?St(N,E,M):Et(N,E);else if(H!==4&&(E=E.child,E!==null))for(lf(E,M,N),E=E.sibling;E!==null;)lf(E,M,N),E=E.sibling}function ls(E,M,N){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?Nt(N,E,M):lt(N,E);else if(H!==4&&(E=E.child,E!==null))for(ls(E,M,N),E=E.sibling;E!==null;)ls(E,M,N),E=E.sibling}function W_(E,M,N){for(var H=M,J=!1,oe,je;;){if(!J){J=H.return;e:for(;;){if(J===null)throw Error(d(160));switch(oe=J.stateNode,J.tag){case 5:je=!1;break e;case 3:oe=oe.containerInfo,je=!0;break e;case 4:oe=oe.containerInfo,je=!0;break e}J=J.return}J=!0}if(H.tag===5||H.tag===6)Oc(E,H,N),je?He(oe,H.stateNode):Zt(oe,H.stateNode);else if(H.tag===18)je?zt(oe,H.stateNode):Ct(oe,H.stateNode);else if(H.tag===4){if(H.child!==null){oe=H.stateNode.containerInfo,je=!0,H.child.return=H,H=H.child;continue}}else if(Jp(E,H,N),H.child!==null){H.child.return=H,H=H.child;continue}if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return,H.tag===4&&(J=!1)}H.sibling.return=H.return,H=H.sibling}}function Cy(E,M){if(It){switch(M.tag){case 0:case 11:case 14:case 15:ku(3,M,M.return),Zp(3,M),ku(5,M,M.return);return;case 1:return;case 5:var N=M.stateNode;if(N!=null){var H=M.memoizedProps;E=E!==null?E.memoizedProps:H;var J=M.type,oe=M.updateQueue;M.updateQueue=null,oe!==null&&$t(N,oe,J,E,H,M)}return;case 6:if(M.stateNode===null)throw Error(d(162));N=M.memoizedProps,Ut(M.stateNode,E!==null?E.memoizedProps:N,N);return;case 3:pt&&E!==null&&E.memoizedState.isDehydrated&&bt(M.stateNode.containerInfo);return;case 12:return;case 13:em(M);return;case 19:em(M);return;case 17:return}throw Error(d(163))}switch(M.tag){case 0:case 11:case 14:case 15:ku(3,M,M.return),Zp(3,M),ku(5,M,M.return);return;case 12:return;case 13:em(M);return;case 19:em(M);return;case 3:pt&&E!==null&&E.memoizedState.isDehydrated&&bt(M.stateNode.containerInfo);break;case 22:case 23:return}e:if(Pe){switch(M.tag){case 1:case 5:case 6:break e;case 3:case 4:M=M.stateNode,tt(M.containerInfo,M.pendingChildren);break e}throw Error(d(163))}}function em(E){var M=E.updateQueue;if(M!==null){E.updateQueue=null;var N=E.stateNode;N===null&&(N=E.stateNode=new Ey),M.forEach(function(H){var J=p2.bind(null,E,H);N.has(H)||(N.add(H),H.then(J,J))})}}function Ud(E,M){for(Sn=M;Sn!==null;){M=Sn;var N=M.deletions;if(N!==null)for(var H=0;H<N.length;H++){var J=N[H];try{var oe=E;It?W_(oe,J,M):Oc(oe,J,M);var je=J.alternate;je!==null&&(je.return=null),J.return=null}catch(Dn){qo(J,M,Dn)}}if(N=M.child,M.subtreeFlags&12854&&N!==null)N.return=M,Sn=N;else for(;Sn!==null;){M=Sn;try{var _t=M.flags;if(_t&32&&It&&Lt(M.stateNode),_t&512){var jt=M.alternate;if(jt!==null){var dn=jt.ref;dn!==null&&(typeof dn=="function"?dn(null):dn.current=null)}}if(_t&8192)switch(M.tag){case 13:if(M.memoizedState!==null){var Mn=M.alternate;(Mn===null||Mn.memoizedState===null)&&(zy=ii())}break;case 22:var _a=M.memoizedState!==null,Jn=M.alternate,vi=Jn!==null&&Jn.memoizedState!==null;if(N=M,It){e:if(H=N,J=_a,oe=null,It)for(var Vn=H;;){if(Vn.tag===5){if(oe===null){oe=Vn;var yo=Vn.stateNode;J?qt(yo):fn(Vn.stateNode,Vn.memoizedProps)}}else if(Vn.tag===6){if(oe===null){var to=Vn.stateNode;J?Ot(to):_e(to,Vn.memoizedProps)}}else if((Vn.tag!==22&&Vn.tag!==23||Vn.memoizedState===null||Vn===H)&&Vn.child!==null){Vn.child.return=Vn,Vn=Vn.child;continue}if(Vn===H)break;for(;Vn.sibling===null;){if(Vn.return===null||Vn.return===H)break e;oe===Vn&&(oe=null),Vn=Vn.return}oe===Vn&&(oe=null),Vn.sibling.return=Vn.return,Vn=Vn.sibling}}if(_a&&!vi&&N.mode&1){Sn=N;for(var Bt=N.child;Bt!==null;){for(N=Sn=Bt;Sn!==null;){H=Sn;var wt=H.child;switch(H.tag){case 0:case 11:case 14:case 15:ku(4,H,H.return);break;case 1:Yp(H,H.return);var Wt=H.stateNode;if(typeof Wt.componentWillUnmount=="function"){var An=H.return;try{Wt.props=H.memoizedProps,Wt.state=H.memoizedState,Wt.componentWillUnmount()}catch(Dn){qo(H,An,Dn)}}break;case 5:Yp(H,H.return);break;case 22:if(H.memoizedState!==null){nm(N);continue}}wt!==null?(wt.return=H,Sn=wt):nm(N)}Bt=Bt.sibling}}}switch(_t&4102){case 2:Qp(M),M.flags&=-3;break;case 6:Qp(M),M.flags&=-3,Cy(M.alternate,M);break;case 4096:M.flags&=-4097;break;case 4100:M.flags&=-4097,Cy(M.alternate,M);break;case 4:Cy(M.alternate,M)}}catch(Dn){qo(M,M.return,Dn)}if(N=M.sibling,N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}}function u2(E,M,N){Sn=E,tm(E)}function tm(E,M,N){for(var H=(E.mode&1)!==0;Sn!==null;){var J=Sn,oe=J.child;if(J.tag===22&&H){var je=J.memoizedState!==null||sf;if(!je){var _t=J.alternate,jt=_t!==null&&_t.memoizedState!==null||Dc;_t=sf;var dn=Dc;if(sf=je,(Dc=jt)&&!dn)for(Sn=J;Sn!==null;)je=Sn,jt=je.child,je.tag===22&&je.memoizedState!==null?V_(J):jt!==null?(jt.return=je,Sn=jt):V_(J);for(;oe!==null;)Sn=oe,tm(oe),oe=oe.sibling;Sn=J,sf=_t,Dc=dn}Py(E)}else J.subtreeFlags&8772&&oe!==null?(oe.return=J,Sn=oe):Py(E)}}function Py(E){for(;Sn!==null;){var M=Sn;if(M.flags&8772){var N=M.alternate;try{if(M.flags&8772)switch(M.tag){case 0:case 11:case 15:Dc||Zp(5,M);break;case 1:var H=M.stateNode;if(M.flags&4&&!Dc)if(N===null)H.componentDidMount();else{var J=M.elementType===M.type?N.memoizedProps:Eo(M.type,N.memoizedProps);H.componentDidUpdate(J,N.memoizedState,H.__reactInternalSnapshotBeforeUpdate)}var oe=M.updateQueue;oe!==null&&Er(M,oe,H);break;case 3:var je=M.updateQueue;if(je!==null){if(N=null,M.child!==null)switch(M.child.tag){case 5:N=Le(M.child.stateNode);break;case 1:N=M.child.stateNode}Er(M,je,N)}break;case 5:var _t=M.stateNode;N===null&&M.flags&4&&Vt(_t,M.type,M.memoizedProps,M);break;case 6:break;case 4:break;case 12:break;case 13:if(pt&&M.memoizedState===null){var jt=M.alternate;if(jt!==null){var dn=jt.memoizedState;if(dn!==null){var Mn=dn.dehydrated;Mn!==null&&Dt(Mn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(d(163))}Dc||M.flags&512&&Kp(M)}catch(_a){qo(M,M.return,_a)}}if(M===E){Sn=null;break}if(N=M.sibling,N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}function nm(E){for(;Sn!==null;){var M=Sn;if(M===E){Sn=null;break}var N=M.sibling;if(N!==null){N.return=M.return,Sn=N;break}Sn=M.return}}function V_(E){for(;Sn!==null;){var M=Sn;try{switch(M.tag){case 0:case 11:case 15:var N=M.return;try{Zp(4,M)}catch(jt){qo(M,N,jt)}break;case 1:var H=M.stateNode;if(typeof H.componentDidMount=="function"){var J=M.return;try{H.componentDidMount()}catch(jt){qo(M,J,jt)}}var oe=M.return;try{Kp(M)}catch(jt){qo(M,oe,jt)}break;case 5:var je=M.return;try{Kp(M)}catch(jt){qo(M,je,jt)}}}catch(jt){qo(M,M.return,jt)}if(M===E){Sn=null;break}var _t=M.sibling;if(_t!==null){_t.return=M.return,Sn=_t;break}Sn=M.return}}var am=0,Fc=1,Iy=2,Ly=3,im=4;if(typeof Symbol=="function"&&Symbol.for){var Du=Symbol.for;am=Du("selector.component"),Fc=Du("selector.has_pseudo_class"),Iy=Du("selector.role"),Ly=Du("selector.test_id"),im=Du("selector.text")}function rm(E){var M=yt(E);if(M!=null){if(typeof M.memoizedProps["data-testname"]!="string")throw Error(d(364));return M}if(E=De(E),E===null)throw Error(d(362));return E.stateNode.current}function Ry(E,M){switch(M.$$typeof){case am:if(E.type===M.value)return!0;break;case Fc:e:{M=M.value,E=[E,0];for(var N=0;N<E.length;){var H=E[N++],J=E[N++],oe=M[J];if(H.tag!==5||!ne(H)){for(;oe!=null&&Ry(H,oe);)J++,oe=M[J];if(J===M.length){M=!0;break e}else for(H=H.child;H!==null;)E.push(H,J),H=H.sibling}}M=!1}return M;case Iy:if(E.tag===5&&Oe(E.stateNode,M.value))return!0;break;case im:if((E.tag===5||E.tag===6)&&(E=de(E),E!==null&&0<=E.indexOf(M.value)))return!0;break;case Ly:if(E.tag===5&&(E=E.memoizedProps["data-testname"],typeof E=="string"&&E.toLowerCase()===M.value.toLowerCase()))return!0;break;default:throw Error(d(365))}return!1}function ky(E){switch(E.$$typeof){case am:return"<"+(X(E.value)||"Unknown")+">";case Fc:return":has("+(ky(E)||"")+")";case Iy:return'[role="'+E.value+'"]';case im:return'"'+E.value+'"';case Ly:return'[data-testname="'+E.value+'"]';default:throw Error(d(365))}}function om(E,M){var N=[];E=[E,0];for(var H=0;H<E.length;){var J=E[H++],oe=E[H++],je=M[oe];if(J.tag!==5||!ne(J)){for(;je!=null&&Ry(J,je);)oe++,je=M[oe];if(oe===M.length)N.push(J);else for(J=J.child;J!==null;)E.push(J,oe),J=J.sibling}}return N}function sm(E,M){if(!$e)throw Error(d(363));E=rm(E),E=om(E,M),M=[],E=Array.from(E);for(var N=0;N<E.length;){var H=E[N++];if(H.tag===5)ne(H)||M.push(H.stateNode);else for(H=H.child;H!==null;)E.push(H),H=H.sibling}return M}var d2=Math.ceil,lm=f.ReactCurrentDispatcher,Dy=f.ReactCurrentOwner,pr=f.ReactCurrentBatchConfig,Da=0,Hi=null,Tr=null,mo=0,Ls=0,Wd=Yi(0),Br=0,cf=null,Vd=0,cm=0,Oy=0,ir=null,cs=null,zy=0,Ou=1/0;function uf(){Ou=ii()+500}var Fy=!1,G_=null,zu=null,Ny=!1,Fu=null,df=0,um=0,H_=null,By=-1,us=0;function go(){return Da&6?ii():By!==-1?By:By=ii()}function Nu(E){return E.mode&1?Da&2&&mo!==0?mo&-mo:di.transition!==null?(us===0&&(E=tc,tc<<=1,!(tc&4194240)&&(tc=64),us=E),us):(E=Bn,E!==0?E:Be()):1}function Qr(E,M,N){if(50<um)throw um=0,H_=null,Error(d(185));var H=Rs(E,M);return H===null?null:(Xs(H,M,N),(!(Da&2)||H!==Hi)&&(H===Hi&&(!(Da&2)&&(cm|=M),Br===4&&ks(H,mo)),eo(H,N),M===1&&Da===0&&!(E.mode&1)&&(uf(),na&&Ri())),H)}function Rs(E,M){E.lanes|=M;var N=E.alternate;for(N!==null&&(N.lanes|=M),N=E,E=E.return;E!==null;)E.childLanes|=M,N=E.alternate,N!==null&&(N.childLanes|=M),N=E,E=E.return;return N.tag===3?N.stateNode:null}function eo(E,M){var N=E.callbackNode;jh(E,M);var H=Pl(E,E===Hi?mo:0);if(H===0)N!==null&&Ys(N),E.callbackNode=null,E.callbackPriority=0;else if(M=H&-H,E.callbackPriority!==M){if(N!=null&&Ys(N),M===1)E.tag===0?Lc(Gd.bind(null,E)):Ic(Gd.bind(null,E)),se?ve(function(){Da===0&&Ri()}):sn(Ed,Ri),N=null;else{switch(nt(H)){case 1:N=Ed;break;case 4:N=Ps;break;case 16:N=Ao;break;case 536870912:N=Rp;break;default:N=Ao}N=ri(N,dm.bind(null,E))}E.callbackPriority=M,E.callbackNode=N}}function dm(E,M){if(By=-1,us=0,Da&6)throw Error(d(327));var N=E.callbackNode;if(Ur()&&E.callbackNode!==N)return null;var H=Pl(E,E===Hi?mo:0);if(H===0)return null;if(H&30||H&E.expiredLanes||M)M=fm(E,H);else{M=H;var J=Da;Da|=2;var oe=Wy();(Hi!==E||mo!==M)&&(uf(),Hd(E,M));do try{wC();break}catch(_t){f2(E,_t)}while(1);xu(),lm.current=oe,Da=J,Tr!==null?M=0:(Hi=null,mo=0,M=Br)}if(M!==0){if(M===2&&(J=nc(E),J!==0&&(H=J,M=un(E,J))),M===1)throw N=cf,Hd(E,0),ks(E,H),eo(E,ii()),N;if(M===6)ks(E,H);else{if(J=E.current.alternate,!(H&30)&&!h2(J)&&(M=fm(E,H),M===2&&(oe=nc(E),oe!==0&&(H=oe,M=un(E,oe))),M===1))throw N=cf,Hd(E,0),ks(E,H),eo(E,ii()),N;switch(E.finishedWork=J,E.finishedLanes=H,M){case 0:case 1:throw Error(d(345));case 2:Nc(E,cs);break;case 3:if(ks(E,H),(H&130023424)===H&&(M=zy+500-ii(),10<M)){if(Pl(E,0)!==0)break;if(J=E.suspendedLanes,(J&H)!==H){go(),E.pingedLanes|=E.suspendedLanes&J;break}E.timeoutHandle=ft(Nc.bind(null,E,cs),M);break}Nc(E,cs);break;case 4:if(ks(E,H),(H&4194240)===H)break;for(M=E.eventTimes,J=-1;0<H;){var je=31-Sr(H);oe=1<<je,je=M[je],je>J&&(J=je),H&=~oe}if(H=J,H=ii()-H,H=(120>H?120:480>H?480:1080>H?1080:1920>H?1920:3e3>H?3e3:4320>H?4320:1960*d2(H/1960))-H,10<H){E.timeoutHandle=ft(Nc.bind(null,E,cs),H);break}Nc(E,cs);break;case 5:Nc(E,cs);break;default:throw Error(d(329))}}}return eo(E,ii()),E.callbackNode===N?dm.bind(null,E):null}function un(E,M){var N=ir;return E.current.memoizedState.isDehydrated&&(Hd(E,M).flags|=256),E=fm(E,M),E!==2&&(M=cs,cs=N,M!==null&&Uy(M)),E}function Uy(E){cs===null?cs=E:cs.push.apply(cs,E)}function h2(E){for(var M=E;;){if(M.flags&16384){var N=M.updateQueue;if(N!==null&&(N=N.stores,N!==null))for(var H=0;H<N.length;H++){var J=N[H],oe=J.getSnapshot;J=J.value;try{if(!Ki(oe(),J))return!1}catch{return!1}}}if(N=M.child,M.subtreeFlags&16384&&N!==null)N.return=M,M=N;else{if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return!0;M=M.return}M.sibling.return=M.return,M=M.sibling}}return!0}function ks(E,M){for(M&=~Oy,M&=~cm,E.suspendedLanes|=M,E.pingedLanes&=~M,E=E.expirationTimes;0<M;){var N=31-Sr(M),H=1<<N;E[N]=-1,M&=~H}}function Gd(E){if(Da&6)throw Error(d(327));Ur();var M=Pl(E,0);if(!(M&1))return eo(E,ii()),null;var N=fm(E,M);if(E.tag!==0&&N===2){var H=nc(E);H!==0&&(M=H,N=un(E,H))}if(N===1)throw N=cf,Hd(E,0),ks(E,M),eo(E,ii()),N;if(N===6)throw Error(d(345));return E.finishedWork=E.current.alternate,E.finishedLanes=M,Nc(E,cs),eo(E,ii()),null}function pn(E){Fu!==null&&Fu.tag===0&&!(Da&6)&&Ur();var M=Da;Da|=1;var N=pr.transition,H=Bn;try{if(pr.transition=null,Bn=1,E)return E()}finally{Bn=H,pr.transition=N,Da=M,!(Da&6)&&Ri()}}function hm(){Ls=Wd.current,ta(Wd)}function Hd(E,M){E.finishedWork=null,E.finishedLanes=0;var N=E.timeoutHandle;if(N!==kt&&(E.timeoutHandle=kt,Rt(N)),Tr!==null)for(N=Tr.return;N!==null;){var H=N;switch(w_(H),H.tag){case 1:H=H.type.childContextTypes,H!=null&&ui();break;case 3:kc(),ta(Mi),ta(Ra),zp();break;case 5:Op(H);break;case 4:kc();break;case 13:ta(gi);break;case 19:ta(gi);break;case 10:Nr(H.type._context);break;case 22:case 23:hm()}N=N.return}if(Hi=E,Tr=E=Uc(E.current,null),mo=Ls=M,Br=0,cf=null,Oy=cm=Vd=0,cs=ir=null,$o!==null){for(M=0;M<$o.length;M++)if(N=$o[M],H=N.interleaved,H!==null){N.interleaved=null;var J=H.next,oe=N.pending;if(oe!==null){var je=oe.next;oe.next=J,H.next=je}N.pending=H}$o=null}return E}function f2(E,M){do{var N=Tr;try{if(xu(),iy.current=fy,ry){for(var H=Ji.memoizedState;H!==null;){var J=H.queue;J!==null&&(J.pending=null),H=H.next}ry=!1}if(kd=0,po=Oo=Ji=null,Fp=!1,Jh=0,Dy.current=null,N===null||N.return===null){Br=1,cf=M,Tr=null;break}e:{var oe=E,je=N.return,_t=N,jt=M;if(M=mo,_t.flags|=32768,jt!==null&&typeof jt=="object"&&typeof jt.then=="function"){var dn=jt,Mn=_t,_a=Mn.tag;if(!(Mn.mode&1)&&(_a===0||_a===11||_a===15)){var Jn=Mn.alternate;Jn?(Mn.updateQueue=Jn.updateQueue,Mn.memoizedState=Jn.memoizedState,Mn.lanes=Jn.lanes):(Mn.updateQueue=null,Mn.memoizedState=null)}var vi=F_(je);if(vi!==null){vi.flags&=-257,gy(vi,je,_t,oe,M),vi.mode&1&&my(oe,dn,M),M=vi,jt=dn;var Vn=M.updateQueue;if(Vn===null){var yo=new Set;yo.add(jt),M.updateQueue=yo}else Vn.add(jt);break e}else{if(!(M&1)){my(oe,dn,M),Vy();break e}jt=Error(d(426))}}else if(ki&&_t.mode&1){var to=F_(je);if(to!==null){!(to.flags&65536)&&(to.flags|=256),gy(to,je,_t,oe,M),ty(jt);break e}}oe=jt,Br!==4&&(Br=2),ir===null?ir=[oe]:ir.push(oe),jt=af(jt,_t),_t=je;do{switch(_t.tag){case 3:_t.flags|=65536,M&=-M,_t.lanes|=M;var Bt=py(_t,jt,M);Zg(_t,Bt);break e;case 1:oe=jt;var wt=_t.type,Wt=_t.stateNode;if(!(_t.flags&128)&&(typeof wt.getDerivedStateFromError=="function"||Wt!==null&&typeof Wt.componentDidCatch=="function"&&(zu===null||!zu.has(Wt)))){_t.flags|=65536,M&=-M,_t.lanes|=M;var An=z_(_t,oe,M);Zg(_t,An);break e}}_t=_t.return}while(_t!==null)}Hy(N)}catch(Dn){M=Dn,Tr===N&&N!==null&&(Tr=N=N.return);continue}break}while(1)}function Wy(){var E=lm.current;return lm.current=fy,E===null?fy:E}function Vy(){(Br===0||Br===3||Br===2)&&(Br=4),Hi===null||!(Vd&268435455)&&!(cm&268435455)||ks(Hi,mo)}function fm(E,M){var N=Da;Da|=2;var H=Wy();Hi===E&&mo===M||Hd(E,M);do try{xC();break}catch(J){f2(E,J)}while(1);if(xu(),Da=N,lm.current=H,Tr!==null)throw Error(d(261));return Hi=null,mo=0,Br}function xC(){for(;Tr!==null;)Gy(Tr)}function wC(){for(;Tr!==null&&!Cs();)Gy(Tr)}function Gy(E){var M=Ds(E.alternate,E,Ls);E.memoizedProps=E.pendingProps,M===null?Hy(E):Tr=M,Dy.current=null}function Hy(E){var M=E;do{var N=M.alternate;if(E=M.return,M.flags&32768){if(N=l2(N,M),N!==null){N.flags&=32767,Tr=N;return}if(E!==null)E.flags|=32768,E.subtreeFlags=0,E.deletions=null;else{Br=6,Tr=null;return}}else if(N=_y(N,M,Ls),N!==null){Tr=N;return}if(M=M.sibling,M!==null){Tr=M;return}Tr=M=E}while(M!==null);Br===0&&(Br=5)}function Nc(E,M){var N=Bn,H=pr.transition;try{pr.transition=null,Bn=1,j_(E,M,N)}finally{pr.transition=H,Bn=N}return null}function j_(E,M,N){do Ur();while(Fu!==null);if(Da&6)throw Error(d(327));var H=E.finishedWork,J=E.finishedLanes;if(H===null)return null;if(E.finishedWork=null,E.finishedLanes=0,H===E.current)throw Error(d(177));E.callbackNode=null,E.callbackPriority=0;var oe=H.lanes|H.childLanes;if(Ht(E,oe),E===Hi&&(Tr=Hi=null,mo=0),!(H.subtreeFlags&2064)&&!(H.flags&2064)||Ny||(Ny=!0,ri(Ao,function(){return Ur(),null})),oe=(H.flags&15990)!==0,H.subtreeFlags&15990||oe){oe=pr.transition,pr.transition=null;var je=Bn;Bn=1;var _t=Da;Da|=4,Dy.current=null,bC(E,H),Ud(E,H),Ae(E.containerInfo),E.current=H,u2(H),Wi(),Da=_t,Bn=je,pr.transition=oe}else E.current=H;if(Ny&&(Ny=!1,Fu=E,df=J),oe=E.pendingLanes,oe===0&&(zu=null),ma(H.stateNode),eo(E,ii()),M!==null)for(N=E.onRecoverableError,H=0;H<M.length;H++)N(M[H]);if(Fy)throw Fy=!1,E=G_,G_=null,E;return df&1&&E.tag!==0&&Ur(),oe=E.pendingLanes,oe&1?E===H_?um++:(um=0,H_=E):um=0,Ri(),null}function Ur(){if(Fu!==null){var E=nt(df),M=pr.transition,N=Bn;try{if(pr.transition=null,Bn=16>E?16:E,Fu===null)var H=!1;else{if(E=Fu,Fu=null,df=0,Da&6)throw Error(d(331));var J=Da;for(Da|=4,Sn=E.current;Sn!==null;){var oe=Sn,je=oe.child;if(Sn.flags&16){var _t=oe.deletions;if(_t!==null){for(var jt=0;jt<_t.length;jt++){var dn=_t[jt];for(Sn=dn;Sn!==null;){var Mn=Sn;switch(Mn.tag){case 0:case 11:case 15:ku(8,Mn,oe)}var _a=Mn.child;if(_a!==null)_a.return=Mn,Sn=_a;else for(;Sn!==null;){Mn=Sn;var Jn=Mn.sibling,vi=Mn.return;if(My(Mn),Mn===dn){Sn=null;break}if(Jn!==null){Jn.return=vi,Sn=Jn;break}Sn=vi}}}var Vn=oe.alternate;if(Vn!==null){var yo=Vn.child;if(yo!==null){Vn.child=null;do{var to=yo.sibling;yo.sibling=null,yo=to}while(yo!==null)}}Sn=oe}}if(oe.subtreeFlags&2064&&je!==null)je.return=oe,Sn=je;else e:for(;Sn!==null;){if(oe=Sn,oe.flags&2048)switch(oe.tag){case 0:case 11:case 15:ku(9,oe,oe.return)}var Bt=oe.sibling;if(Bt!==null){Bt.return=oe.return,Sn=Bt;break e}Sn=oe.return}}var wt=E.current;for(Sn=wt;Sn!==null;){je=Sn;var Wt=je.child;if(je.subtreeFlags&2064&&Wt!==null)Wt.return=je,Sn=Wt;else e:for(je=wt;Sn!==null;){if(_t=Sn,_t.flags&2048)try{switch(_t.tag){case 0:case 11:case 15:Zp(9,_t)}}catch(Dn){qo(_t,_t.return,Dn)}if(_t===je){Sn=null;break e}var An=_t.sibling;if(An!==null){An.return=_t.return,Sn=An;break e}Sn=_t.return}}if(Da=J,Ri(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Zs,E)}catch{}H=!0}return H}finally{Bn=N,pr.transition=M}}return!1}function Bc(E,M,N){M=af(N,M),M=py(E,M,1),Ci(E,M),M=go(),E=Rs(E,1),E!==null&&(Xs(E,1,M),eo(E,M))}function qo(E,M,N){if(E.tag===3)Bc(E,E,N);else for(;M!==null;){if(M.tag===3){Bc(M,E,N);break}else if(M.tag===1){var H=M.stateNode;if(typeof M.type.getDerivedStateFromError=="function"||typeof H.componentDidCatch=="function"&&(zu===null||!zu.has(H))){E=af(N,E),E=z_(M,E,1),Ci(M,E),E=go(),M=Rs(M,1),M!==null&&(Xs(M,1,E),eo(M,E));break}}M=M.return}}function $_(E,M,N){var H=E.pingCache;H!==null&&H.delete(M),M=go(),E.pingedLanes|=E.suspendedLanes&N,Hi===E&&(mo&N)===N&&(Br===4||Br===3&&(mo&130023424)===mo&&500>ii()-zy?Hd(E,0):Oy|=N),eo(E,M)}function jy(E,M){M===0&&(E.mode&1?(M=Tl,Tl<<=1,!(Tl&130023424)&&(Tl=4194304)):M=1);var N=go();E=Rs(E,M),E!==null&&(Xs(E,M,N),eo(E,N))}function q_(E){var M=E.memoizedState,N=0;M!==null&&(N=M.retryLane),jy(E,N)}function p2(E,M){var N=0;switch(E.tag){case 13:var H=E.stateNode,J=E.memoizedState;J!==null&&(N=J.retryLane);break;case 19:H=E.stateNode;break;default:throw Error(d(314))}H!==null&&H.delete(M),jy(E,N)}var Ds;Ds=function(E,M,N){if(E!==null)if(E.memoizedProps!==M.pendingProps||Mi.current)ss=!0;else{if(!(E.lanes&N)&&!(M.flags&128))return ss=!1,Nd(E,M,N);ss=!!(E.flags&131072)}else ss=!1,ki&&M.flags&1048576&&Xh(M,Dp,M.index);switch(M.lanes=0,M.tag){case 2:var H=M.type;E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps;var J=wr(M,Ra.current);xn(M,N),J=oy(null,M,H,E,J,N);var oe=Np();return M.flags|=1,typeof J=="object"&&J!==null&&typeof J.render=="function"&&J.$$typeof===void 0?(M.tag=1,M.memoizedState=null,M.updateQueue=null,Zi(H)?(oe=!0,Zn(M)):oe=!1,M.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,is(M),J.updater=Js,M.stateNode=J,J._reactInternals=M,x_(M,H,E,N),M=$p(null,M,H,!0,oe,N)):(M.tag=0,ki&&oe&&Pd(M),Fo(null,M,J,N),M=M.child),M;case 16:H=M.elementType;e:{switch(E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps,J=H._init,H=J(H._payload),M.type=H,J=M.tag=m2(H),E=Eo(H,E),J){case 0:M=N_(null,M,H,E,N);break e;case 1:M=s2(null,M,H,E,N);break e;case 11:M=Fd(null,M,H,E,N);break e;case 14:M=a2(null,M,H,Eo(H.type,E),N);break e}throw Error(d(306,H,""))}return M;case 0:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:Eo(H,J),N_(E,M,H,J,N);case 1:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:Eo(H,J),s2(E,M,H,J,N);case 3:e:{if(by(M),E===null)throw Error(d(387));H=M.pendingProps,oe=M.memoizedState,J=oe.element,b_(E,M),Su(M,H,null,N);var je=M.memoizedState;if(H=je.element,pt&&oe.isDehydrated)if(oe={element:H,isDehydrated:!1,cache:je.cache,transitions:je.transitions},M.updateQueue.baseState=oe,M.memoizedState=oe,M.flags&256){J=Error(d(423)),M=xy(E,M,H,N,J);break e}else if(H!==J){J=Error(d(424)),M=xy(E,M,H,N,J);break e}else for(pt&&(os=fa(M.stateNode.containerInfo),fo=M,ki=!0,Rl=null,el=!1),N=E_(M,null,H,N),M.child=N;N;)N.flags=N.flags&-3|4096,N=N.sibling;else{if(Id(),H===J){M=cc(E,M,N);break e}Fo(E,M,H,N)}M=M.child}return M;case 5:return rc(M),E===null&&S_(M),H=M.type,J=M.pendingProps,oe=E!==null?E.memoizedProps:null,je=J.children,Ke(H,J)?je=null:oe!==null&&Ke(H,oe)&&(M.flags|=32),o2(E,M),Fo(E,M,je,N),M.child;case 6:return E===null&&S_(M),null;case 13:return B_(E,M,N);case 4:return ay(M,M.stateNode.containerInfo),H=M.pendingProps,E===null?M.child=Mu(M,null,H,N):Fo(E,M,H,N),M.child;case 11:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:Eo(H,J),Fd(E,M,H,J,N);case 7:return Fo(E,M,M.pendingProps,N),M.child;case 8:return Fo(E,M,M.pendingProps.children,N),M.child;case 12:return Fo(E,M,M.pendingProps.children,N),M.child;case 10:e:{if(H=M.type._context,J=M.pendingProps,oe=M.memoizedProps,je=J.value,Td(M,H,je),oe!==null)if(Ki(oe.value,je)){if(oe.children===J.children&&!Mi.current){M=cc(E,M,N);break e}}else for(oe=M.child,oe!==null&&(oe.return=M);oe!==null;){var _t=oe.dependencies;if(_t!==null){je=oe.child;for(var jt=_t.firstContext;jt!==null;){if(jt.context===H){if(oe.tag===1){jt=rs(-1,N&-N),jt.tag=2;var dn=oe.updateQueue;if(dn!==null){dn=dn.shared;var Mn=dn.pending;Mn===null?jt.next=jt:(jt.next=Mn.next,Mn.next=jt),dn.pending=jt}}oe.lanes|=N,jt=oe.alternate,jt!==null&&(jt.lanes|=N),Ti(oe.return,N,M),_t.lanes|=N;break}jt=jt.next}}else if(oe.tag===10)je=oe.type===M.type?null:oe.child;else if(oe.tag===18){if(je=oe.return,je===null)throw Error(d(341));je.lanes|=N,_t=je.alternate,_t!==null&&(_t.lanes|=N),Ti(je,N,M),je=oe.sibling}else je=oe.child;if(je!==null)je.return=oe;else for(je=oe;je!==null;){if(je===M){je=null;break}if(oe=je.sibling,oe!==null){oe.return=je.return,je=oe;break}je=je.return}oe=je}Fo(E,M,J.children,N),M=M.child}return M;case 9:return J=M.type,H=M.pendingProps.children,xn(M,N),J=ar(J),H=H(J),M.flags|=1,Fo(E,M,H,N),M.child;case 14:return H=M.type,J=Eo(H,M.pendingProps),J=Eo(H.type,J),a2(E,M,H,J,N);case 15:return i2(E,M,M.type,M.pendingProps,N);case 17:return H=M.type,J=M.pendingProps,J=M.elementType===H?J:Eo(H,J),E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),M.tag=1,Zi(H)?(E=!0,Zn(M)):E=!1,xn(M,N),qh(M,H,J),x_(M,H,J,N),$p(null,M,H,!0,E,N);case 19:return Ru(E,M,N);case 22:return r2(E,M,N)}throw Error(d(156,M.tag))};function ri(E,M){return sn(E,M)}function $y(E,M,N,H){this.tag=E,this.key=N,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=M,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=H,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(E,M,N,H){return new $y(E,M,N,H)}function jd(E){return E=E.prototype,!(!E||!E.isReactComponent)}function m2(E){if(typeof E=="function")return jd(E)?1:0;if(E!=null){if(E=E.$$typeof,E===k)return 11;if(E===O)return 14}return 2}function Uc(E,M){var N=E.alternate;return N===null?(N=ds(E.tag,M,E.key,E.mode),N.elementType=E.elementType,N.type=E.type,N.stateNode=E.stateNode,N.alternate=E,E.alternate=N):(N.pendingProps=M,N.type=E.type,N.flags=0,N.subtreeFlags=0,N.deletions=null),N.flags=E.flags&14680064,N.childLanes=E.childLanes,N.lanes=E.lanes,N.child=E.child,N.memoizedProps=E.memoizedProps,N.memoizedState=E.memoizedState,N.updateQueue=E.updateQueue,M=E.dependencies,N.dependencies=M===null?null:{lanes:M.lanes,firstContext:M.firstContext},N.sibling=E.sibling,N.index=E.index,N.ref=E.ref,N}function qy(E,M,N,H,J,oe){var je=2;if(H=E,typeof E=="function")jd(E)&&(je=1);else if(typeof E=="string")je=5;else e:switch(E){case _:return il(N.children,J,oe,M);case x:je=8,J|=8;break;case S:return E=ds(12,N,M,J|2),E.elementType=S,E.lanes=oe,E;case D:return E=ds(13,N,M,J),E.elementType=D,E.lanes=oe,E;case L:return E=ds(19,N,M,J),E.elementType=L,E.lanes=oe,E;case B:return Bu(N,J,oe,M);default:if(typeof E=="object"&&E!==null)switch(E.$$typeof){case T:je=10;break e;case I:je=9;break e;case k:je=11;break e;case O:je=14;break e;case F:je=16,H=null;break e}throw Error(d(130,E==null?E:typeof E,""))}return M=ds(je,N,M,J),M.elementType=E,M.type=H,M.lanes=oe,M}function il(E,M,N,H){return E=ds(7,E,H,M),E.lanes=N,E}function Bu(E,M,N,H){return E=ds(22,E,H,M),E.elementType=B,E.lanes=N,E.stateNode={},E}function Xt(E,M,N){return E=ds(6,E,null,M),E.lanes=N,E}function yn(E,M,N){return M=ds(4,E.children!==null?E.children:[],E.key,M),M.lanes=N,M.stateNode={containerInfo:E.containerInfo,pendingChildren:null,implementation:E.implementation},M}function pm(E,M,N,H,J){this.tag=M,this.containerInfo=E,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=kt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ad(0),this.expirationTimes=Ad(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ad(0),this.identifierPrefix=H,this.onRecoverableError=J,pt&&(this.mutableSourceEagerHydrationData=null)}function yi(E,M,N,H,J,oe,je,_t,jt){return E=new pm(E,M,N,_t,jt),M===1?(M=1,oe===!0&&(M|=8)):M=0,oe=ds(3,null,null,M),E.current=oe,oe.stateNode=E,oe.memoizedState={element:H,isDehydrated:N,cache:null,transitions:null},is(oe),E}function Xo(E){if(!E)return ho;E=E._reactInternals;e:{if(V(E)!==E||E.tag!==1)throw Error(d(170));var M=E;do{switch(M.tag){case 3:M=M.stateNode.context;break e;case 1:if(Zi(M.type)){M=M.stateNode.__reactInternalMemoizedMergedChildContext;break e}}M=M.return}while(M!==null);throw Error(d(171))}if(E.tag===1){var N=E.type;if(Zi(N))return Cn(E,N,M)}return M}function Xy(E){var M=E._reactInternals;if(M===void 0)throw typeof E.render=="function"?Error(d(188)):(E=Object.keys(E).join(","),Error(d(268,E)));return E=me(M),E===null?null:E.stateNode}function X_(E,M){if(E=E.memoizedState,E!==null&&E.dehydrated!==null){var N=E.retryLane;E.retryLane=N!==0&&N<M?N:M}}function Yo(E,M){X_(E,M),(E=E.alternate)&&X_(E,M)}function SC(E){return E=me(E),E===null?null:E.stateNode}function AC(){return null}return a.attemptContinuousHydration=function(E){if(E.tag===13){var M=go();Qr(E,134217728,M),Yo(E,134217728)}},a.attemptHydrationAtCurrentPriority=function(E){if(E.tag===13){var M=go(),N=Nu(E);Qr(E,N,M),Yo(E,N)}},a.attemptSynchronousHydration=function(E){switch(E.tag){case 3:var M=E.stateNode;if(M.current.memoizedState.isDehydrated){var N=Cl(M.pendingLanes);N!==0&&(vn(M,N|1),eo(M,ii()),!(Da&6)&&(uf(),Ri()))}break;case 13:var H=go();pn(function(){return Qr(E,1,H)}),Yo(E,1)}},a.batchedUpdates=function(E,M){var N=Da;Da|=1;try{return E(M)}finally{Da=N,Da===0&&(uf(),na&&Ri())}},a.createComponentSelector=function(E){return{$$typeof:am,value:E}},a.createContainer=function(E,M,N,H,J,oe,je){return yi(E,M,!1,null,N,H,J,oe,je)},a.createHasPseudoClassSelector=function(E){return{$$typeof:Fc,value:E}},a.createHydrationContainer=function(E,M,N,H,J,oe,je,_t,jt){return E=yi(N,H,!0,E,J,oe,je,_t,jt),E.context=Xo(null),N=E.current,H=go(),J=Nu(N),oe=rs(H,J),oe.callback=M??null,Ci(N,oe),E.current.lanes=J,Xs(E,J,H),eo(E,H),E},a.createPortal=function(E,M,N){var H=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:H==null?null:""+H,children:E,containerInfo:M,implementation:N}},a.createRoleSelector=function(E){return{$$typeof:Iy,value:E}},a.createTestNameSelector=function(E){return{$$typeof:Ly,value:E}},a.createTextSelector=function(E){return{$$typeof:im,value:E}},a.deferredUpdates=function(E){var M=Bn,N=pr.transition;try{return pr.transition=null,Bn=16,E()}finally{Bn=M,pr.transition=N}},a.discreteUpdates=function(E,M,N,H,J){var oe=Bn,je=pr.transition;try{return pr.transition=null,Bn=1,E(M,N,H,J)}finally{Bn=oe,pr.transition=je,Da===0&&uf()}},a.findAllNodes=sm,a.findBoundingRects=function(E,M){if(!$e)throw Error(d(363));M=sm(E,M),E=[];for(var N=0;N<M.length;N++)E.push(st(M[N]));for(M=E.length-1;0<M;M--){N=E[M];for(var H=N.x,J=H+N.width,oe=N.y,je=oe+N.height,_t=M-1;0<=_t;_t--)if(M!==_t){var jt=E[_t],dn=jt.x,Mn=dn+jt.width,_a=jt.y,Jn=_a+jt.height;if(H>=dn&&oe>=_a&&J<=Mn&&je<=Jn){E.splice(M,1);break}else if(H!==dn||N.width!==jt.width||Jn<oe||_a>je){if(!(oe!==_a||N.height!==jt.height||Mn<H||dn>J)){dn>H&&(jt.width+=dn-H,jt.x=H),Mn<J&&(jt.width=J-dn),E.splice(M,1);break}}else{_a>oe&&(jt.height+=_a-oe,jt.y=oe),Jn<je&&(jt.height=je-_a),E.splice(M,1);break}}}return E},a.findHostInstance=Xy,a.findHostInstanceWithNoPortals=function(E){return E=ge(E),E=E!==null?fe(E):null,E===null?null:E.stateNode},a.findHostInstanceWithWarning=function(E){return Xy(E)},a.flushControlled=function(E){var M=Da;Da|=1;var N=pr.transition,H=Bn;try{pr.transition=null,Bn=1,E()}finally{Bn=H,pr.transition=N,Da=M,Da===0&&(uf(),Ri())}},a.flushPassiveEffects=Ur,a.flushSync=pn,a.focusWithin=function(E,M){if(!$e)throw Error(d(363));for(E=rm(E),M=om(E,M),M=Array.from(M),E=0;E<M.length;){var N=M[E++];if(!ne(N)){if(N.tag===5&&mt(N.stateNode))return!0;for(N=N.child;N!==null;)M.push(N),N=N.sibling}}return!1},a.getCurrentUpdatePriority=function(){return Bn},a.getFindAllNodesFailureDescription=function(E,M){if(!$e)throw Error(d(363));var N=0,H=[];E=[rm(E),0];for(var J=0;J<E.length;){var oe=E[J++],je=E[J++],_t=M[je];if((oe.tag!==5||!ne(oe))&&(Ry(oe,_t)&&(H.push(ky(_t)),je++,je>N&&(N=je)),je<M.length))for(oe=oe.child;oe!==null;)E.push(oe,je),oe=oe.sibling}if(N<M.length){for(E=[];N<M.length;N++)E.push(ky(M[N]));return`findAllNodes was able to match part of the selector:
  `+(H.join(" > ")+`

No matching component was found for:
  `)+E.join(" > ")}return null},a.getPublicRootInstance=function(E){if(E=E.current,!E.child)return null;switch(E.child.tag){case 5:return Le(E.child.stateNode);default:return E.child.stateNode}},a.injectIntoDevTools=function(E){if(E={bundleType:E.bundleType,version:E.version,rendererPackageName:E.rendererPackageName,rendererConfig:E.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:f.ReactCurrentDispatcher,findHostInstanceByFiber:SC,findFiberByHostInstance:E.findFiberByHostInstance||AC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")E=!1;else{var M=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(M.isDisabled||!M.supportsFiber)E=!0;else{try{Zs=M.inject(E),tn=M}catch{}E=!!M.checkDCE}}return E},a.isAlreadyRendering=function(){return!1},a.observeVisibleRects=function(E,M,N,H){if(!$e)throw Error(d(363));E=sm(E,M);var J=ot(E,N,H).disconnect;return{disconnect:function(){J()}}},a.registerMutableSourceForHydration=function(E,M){var N=M._getVersion;N=N(M._source),E.mutableSourceEagerHydrationData==null?E.mutableSourceEagerHydrationData=[M,N]:E.mutableSourceEagerHydrationData.push(M,N)},a.runWithPriority=function(E,M){var N=Bn;try{return Bn=E,M()}finally{Bn=N}},a.shouldError=function(){return null},a.shouldSuspend=function(){return!1},a.updateContainer=function(E,M,N,H){var J=M.current,oe=go(),je=Nu(J);return N=Xo(N),M.context===null?M.context=N:M.pendingContext=N,M=rs(oe,je),M.payload={element:E},H=H===void 0?null:H,H!==null&&(M.callback=H),Ci(J,M),E=Qr(J,je,oe),E!==null&&wu(E,J,je),je},a};QZ.exports=H3e;var j3e=QZ.exports;const $3e=gw(j3e);var eK={exports:{}},tK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,pe){var Ae=le.length;le.push(pe);e:for(;0<Ae;){var ae=Ae-1>>>1,Ee=le[ae];if(0<s(Ee,pe))le[ae]=pe,le[Ae]=Ee,Ae=ae;else break e}}function a(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var pe=le[0],Ae=le.pop();if(Ae!==pe){le[0]=Ae;e:for(var ae=0,Ee=le.length,Ze=Ee>>>1;ae<Ze;){var Xe=2*(ae+1)-1,Ke=le[Xe],Ue=Xe+1,ft=le[Ue];if(0>s(Ke,Ae))Ue<Ee&&0>s(ft,Ke)?(le[ae]=ft,le[Ue]=Ae,ae=Ue):(le[ae]=Ke,le[Xe]=Ae,ae=Xe);else if(Ue<Ee&&0>s(ft,Ae))le[ae]=ft,le[Ue]=Ae,ae=Ue;else break e}}return pe}function s(le,pe){var Ae=le.sortIndex-pe.sortIndex;return Ae!==0?Ae:le.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],_=1,x=null,S=3,T=!1,I=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(le){for(var pe=a(y);pe!==null;){if(pe.callback===null)o(y);else if(pe.startTime<=le)o(y),pe.sortIndex=pe.expirationTime,e(m,pe);else break;pe=a(y)}}function B(le){if(k=!1,F(le),!I)if(a(m)!==null)I=!0,Le(G);else{var pe=a(y);pe!==null&&Ge(B,pe.startTime-le)}}function G(le,pe){I=!1,k&&(k=!1,L(te),te=-1),T=!0;var Ae=S;try{for(F(pe),x=a(m);x!==null&&(!(x.expirationTime>pe)||le&&!ge());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=pe);pe=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===a(m)&&o(m),F(pe)}else o(m);x=a(m)}if(x!==null)var Ze=!0;else{var Xe=a(y);Xe!==null&&Ge(B,Xe.startTime-pe),Ze=!1}return Ze}finally{x=null,S=Ae,T=!1}}var q=!1,X=null,te=-1,V=5,Q=-1;function ge(){return!(n.unstable_now()-Q<V)}function me(){if(X!==null){var le=n.unstable_now();Q=le;var pe=!0;try{pe=X(!0,le)}finally{pe?be():(q=!1,X=null)}}else q=!1}var be;if(typeof O=="function")be=function(){O(me)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ce=fe.port2;fe.port1.onmessage=me,be=function(){Ce.postMessage(null)}}else be=function(){D(me,0)};function Le(le){X=le,q||(q=!0,be())}function Ge(le,pe){te=D(function(){le(n.unstable_now())},pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Le(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return a(m)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var pe=3;break;default:pe=S}var Ae=S;S=pe;try{return le()}finally{S=Ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,pe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var Ae=S;S=le;try{return pe()}finally{S=Ae}},n.unstable_scheduleCallback=function(le,pe,Ae){var ae=n.unstable_now();switch(typeof Ae=="object"&&Ae!==null?(Ae=Ae.delay,Ae=typeof Ae=="number"&&0<Ae?ae+Ae:ae):Ae=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Ae+Ee,le={id:_++,callback:pe,priorityLevel:le,startTime:Ae,expirationTime:Ee,sortIndex:-1},Ae>ae?(le.sortIndex=Ae,e(y,le),a(m)===null&&le===a(y)&&(k?(L(te),te=-1):k=!0,Ge(B,Ae-ae))):(le.sortIndex=Ee,e(m,le),I||T||(I=!0,Le(G))),le},n.unstable_shouldYield=ge,n.unstable_wrapCallback=function(le){var pe=S;return function(){var Ae=S;S=pe;try{return le.apply(this,arguments)}finally{S=Ae}}}})(tK);eK.exports=tK;var NV=eK.exports;const q3e=n=>typeof n=="object"&&typeof n.then=="function",pg=[];function nK(n,e,a=(o,s)=>o===s){if(n===e)return!0;if(!n||!e)return!1;const o=n.length;if(e.length!==o)return!1;for(let s=0;s<o;s++)if(!a(n[s],e[s]))return!1;return!0}function aK(n,e=null,a=!1,o={}){e===null&&(e=[n]);for(const c of pg)if(nK(e,c.keys,c.equal)){if(a)return;if(Object.prototype.hasOwnProperty.call(c,"error"))throw c.error;if(Object.prototype.hasOwnProperty.call(c,"response"))return o.lifespan&&o.lifespan>0&&(c.timeout&&clearTimeout(c.timeout),c.timeout=setTimeout(c.remove,o.lifespan)),c.response;if(!a)throw c.promise}const s={keys:e,equal:o.equal,remove:()=>{const c=pg.indexOf(s);c!==-1&&pg.splice(c,1)},promise:(q3e(n)?n:n(...e)).then(c=>{s.response=c,o.lifespan&&o.lifespan>0&&(s.timeout=setTimeout(s.remove,o.lifespan))}).catch(c=>s.error=c)};if(pg.push(s),!a)throw s.promise}const iK=(n,e,a)=>aK(n,e,!1,a),X3e=(n,e,a)=>void aK(n,e,!0,a),Y3e=n=>{if(n===void 0||n.length===0)pg.splice(0,pg.length);else{const e=pg.find(a=>nK(n,a.keys,a.equal));e&&e.remove()}},L6={},Z3e=n=>void Object.assign(L6,n);function K3e(n,e){function a(_,{args:x=[],attach:S,...T},I){let k=`${_[0].toUpperCase()}${_.slice(1)}`,D;if(_==="primitive"){if(T.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const L=T.object;D=i0(L,{type:_,root:I,attach:S,primitive:!0})}else{const L=L6[k];if(!L)throw new Error(`R3F: ${k} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(x))throw new Error("R3F: The args prop must be an array!");D=i0(new L(...x),{type:_,root:I,attach:S,memoizedProps:{args:x}})}return D.__r3f.attach===void 0&&(D instanceof La?D.__r3f.attach="geometry":D instanceof as&&(D.__r3f.attach="material")),k!=="inject"&&rI(D,T),D}function o(_,x){let S=!1;if(x){var T,I;(T=x.__r3f)!=null&&T.attach?iI(_,x,x.__r3f.attach):x.isObject3D&&_.isObject3D&&(_.add(x),S=!0),S||(I=_.__r3f)==null||I.objects.push(x),x.__r3f||i0(x,{}),x.__r3f.parent=_,FR(x),r0(x)}}function s(_,x,S){let T=!1;if(x){var I,k;if((I=x.__r3f)!=null&&I.attach)iI(_,x,x.__r3f.attach);else if(x.isObject3D&&_.isObject3D){x.parent=_,x.dispatchEvent({type:"added"});const D=_.children.filter(O=>O!==x),L=D.indexOf(S);_.children=[...D.slice(0,L),x,...D.slice(L)],T=!0}T||(k=_.__r3f)==null||k.objects.push(x),x.__r3f||i0(x,{}),x.__r3f.parent=_,FR(x),r0(x)}}function c(_,x,S=!1){_&&[..._].forEach(T=>d(x,T,S))}function d(_,x,S){if(x){var T,I,k;if(x.__r3f&&(x.__r3f.parent=null),(T=_.__r3f)!=null&&T.objects&&(_.__r3f.objects=_.__r3f.objects.filter(B=>B!==x)),(I=x.__r3f)!=null&&I.attach)GV(_,x,x.__r3f.attach);else if(x.isObject3D&&_.isObject3D){var D;_.remove(x),(D=x.__r3f)!=null&&D.root&&oSe(x.__r3f.root,x)}const O=(k=x.__r3f)==null?void 0:k.primitive,F=!O&&(S===void 0?x.dispose!==null:S);if(!O){var L;c((L=x.__r3f)==null?void 0:L.objects,x,F),c(x.children,x,F)}delete x.__r3f,F&&x.dispose&&x.type!=="Scene"&&NV.unstable_scheduleCallback(NV.unstable_IdlePriority,()=>{try{x.dispose()}catch{}}),r0(_)}}function f(_,x,S,T){var I;const k=(I=_.__r3f)==null?void 0:I.parent;if(!k)return;const D=a(x,S,_.__r3f.root);if(_.children){for(const L of _.children)L.__r3f&&o(D,L);_.children=_.children.filter(L=>!L.__r3f)}_.__r3f.objects.forEach(L=>o(D,L)),_.__r3f.objects=[],_.__r3f.autoRemovedBeforeAppend||d(k,_),D.parent&&(D.__r3f.autoRemovedBeforeAppend=!0),o(k,D),D.raycast&&D.__r3f.eventCount&&D.__r3f.root.getState().internal.interaction.push(D),[T,T.alternate].forEach(L=>{L!==null&&(L.stateNode=D,L.ref&&(typeof L.ref=="function"?L.ref(D):L.ref.current=D))})}const m=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:$3e({createInstance:a,removeChild:d,appendChild:o,appendInitialChild:o,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(_,x)=>{if(!x)return;const S=_.getState().scene;S.__r3f&&(S.__r3f.root=_,o(S,x))},removeChildFromContainer:(_,x)=>{x&&d(_.getState().scene,x)},insertInContainerBefore:(_,x,S)=>{if(!x||!S)return;const T=_.getState().scene;T.__r3f&&s(T,x,S)},getRootHostContext:()=>null,getChildHostContext:_=>_,finalizeInitialChildren(_){var x;return!!((x=_==null?void 0:_.__r3f)!=null?x:{}).handlers},prepareUpdate(_,x,S,T){var I;if(((I=_==null?void 0:_.__r3f)!=null?I:{}).primitive&&T.object&&T.object!==_)return[!0];{const{args:D=[],children:L,...O}=T,{args:F=[],children:B,...G}=S;if(!Array.isArray(D))throw new Error("R3F: the args prop must be an array!");if(D.some((X,te)=>X!==F[te]))return[!0];const q=dK(_,O,G,!0);return q.changes.length?[!1,q]:null}},commitUpdate(_,[x,S],T,I,k,D){x?f(_,T,k,D):rI(_,S)},commitMount(_,x,S,T){var I;const k=(I=_.__r3f)!=null?I:{};_.raycast&&k.handlers&&k.eventCount&&_.__r3f.root.getState().internal.interaction.push(_)},getPublicInstance:_=>_,prepareForCommit:()=>null,preparePortalMount:_=>i0(_.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(_){var x;const{attach:S,parent:T}=(x=_.__r3f)!=null?x:{};S&&T&&GV(T,_,S),_.isObject3D&&(_.visible=!1),r0(_)},unhideInstance(_,x){var S;const{attach:T,parent:I}=(S=_.__r3f)!=null?S:{};T&&I&&iI(I,_,T),(_.isObject3D&&x.visible==null||x.visible)&&(_.visible=!0),r0(_)},createTextInstance:m,hideTextInstance:m,unhideTextInstance:m,getCurrentEventPriority:()=>e?e():A0.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&sr.fun(performance.now)?performance.now:sr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:sr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:sr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:rI}}var BV,UV;const aI=n=>"colorSpace"in n||"outputColorSpace"in n,rK=()=>{var n;return(n=L6.ColorManagement)!=null?n:null},oK=n=>n&&n.isOrthographicCamera,J3e=n=>n&&n.hasOwnProperty("current"),Uw=typeof window<"u"&&((BV=window.document)!=null&&BV.createElement||((UV=window.navigator)==null?void 0:UV.product)==="ReactNative")?re.useLayoutEffect:re.useEffect;function sK(n){const e=re.useRef(n);return Uw(()=>void(e.current=n),[n]),e}function Q3e({set:n}){return Uw(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class lK extends re.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}lK.getDerivedStateFromError=()=>({error:!0});const cK="__default",WV=new Map,eSe=n=>n&&!!n.memoized&&!!n.changes;function uK(n){var e;const a=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],a),n[1]):n}const hb=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},sr={obj:n=>n===Object(n)&&!sr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:a="shallow",objects:o="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(sr.str(n)||sr.num(n))return n===e;const c=sr.obj(n);if(c&&o==="reference")return n===e;const d=sr.arr(n);if(d&&a==="reference")return n===e;if((d||c)&&n===e)return!0;let f;for(f in n)if(!(f in e))return!1;if(c&&a==="shallow"&&o==="shallow"){for(f in s?e:n)if(!sr.equ(n[f],e[f],{strict:s,objects:"reference"}))return!1}else for(f in s?e:n)if(n[f]!==e[f])return!1;if(sr.und(f)){if(d&&n.length===0&&e.length===0||c&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function tSe(n){const e={nodes:{},materials:{}};return n&&n.traverse(a=>{a.name&&(e.nodes[a.name]=a),a.material&&!e.materials[a.material.name]&&(e.materials[a.material.name]=a.material)}),e}function nSe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function i0(n,e){const a=n;return a.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function zR(n,e){let a=n;if(e.includes("-")){const o=e.split("-"),s=o.pop();return a=o.reduce((c,d)=>c[d],n),{target:a,key:s}}else return{target:a,key:e}}const VV=/-\d+$/;function iI(n,e,a){if(sr.str(a)){if(VV.test(a)){const c=a.replace(VV,""),{target:d,key:f}=zR(n,c);Array.isArray(d[f])||(d[f]=[])}const{target:o,key:s}=zR(n,a);e.__r3f.previousAttach=o[s],o[s]=e}else e.__r3f.previousAttach=a(n,e)}function GV(n,e,a){var o,s;if(sr.str(a)){const{target:c,key:d}=zR(n,a),f=e.__r3f.previousAttach;f===void 0?delete c[d]:c[d]=f}else(o=e.__r3f)==null||o.previousAttach==null||o.previousAttach(n,e);(s=e.__r3f)==null||delete s.previousAttach}function dK(n,{children:e,key:a,ref:o,...s},{children:c,key:d,ref:f,...m}={},y=!1){var _;const x=(_=n==null?void 0:n.__r3f)!=null?_:{},S=Object.entries(s),T=[];if(y){const k=Object.keys(m);for(let D=0;D<k.length;D++)s.hasOwnProperty(k[D])||S.unshift([k[D],cK+"remove"])}S.forEach(([k,D])=>{var L;if((L=n.__r3f)!=null&&L.primitive&&k==="object"||sr.equ(D,m[k]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(k))return T.push([k,D,!0,[]]);let O=[];k.includes("-")&&(O=k.split("-")),T.push([k,D,!1,O]);for(const F in s){const B=s[F];F.startsWith(`${k}-`)&&T.push([F,B,!1,F.split("-")])}});const I={...s};return x.memoizedProps&&x.memoizedProps.args&&(I.args=x.memoizedProps.args),x.memoizedProps&&x.memoizedProps.attach&&(I.attach=x.memoizedProps.attach),{memoized:I,changes:T}}const aSe=typeof process<"u"&&!1;function rI(n,e){var a,o,s;const c=(a=n.__r3f)!=null?a:{},d=c.root,f=(o=d==null||d.getState==null?void 0:d.getState())!=null?o:{},{memoized:m,changes:y}=eSe(e)?e:dK(n,e),_=c.eventCount;n.__r3f&&(n.__r3f.memoizedProps=m);for(let S=0;S<y.length;S++){let[T,I,k,D]=y[S];if(aI(n)){const B="srgb",G="srgb-linear";T==="encoding"?(T="colorSpace",I=I===3001?B:G):T==="outputEncoding"&&(T="outputColorSpace",I=I===3001?B:G)}let L=n,O=L[T];if(D.length&&(O=D.reduce((F,B)=>F[B],n),!(O&&O.set))){const[F,...B]=D.reverse();L=B.reverse().reduce((G,q)=>G[q],n),T=F}if(I===cK+"remove")if(L.constructor){let F=WV.get(L.constructor);F||(F=new L.constructor,WV.set(L.constructor,F)),I=F[T]}else I=0;if(k)I?c.handlers[T]=I:delete c.handlers[T],c.eventCount=Object.keys(c.handlers).length;else if(O&&O.set&&(O.copy||O instanceof xg)){if(Array.isArray(I))O.fromArray?O.fromArray(I):O.set(...I);else if(O.copy&&I&&I.constructor&&(aSe?O.constructor.name===I.constructor.name:O.constructor===I.constructor))O.copy(I);else if(I!==void 0){const F=O instanceof Pn;!F&&O.setScalar?O.setScalar(I):O instanceof xg&&I instanceof xg?O.mask=I.mask:O.set(I),!rK()&&!f.linear&&F&&O.convertSRGBToLinear()}}else if(L[T]=I,L[T]instanceof kr&&L[T].format===pl&&L[T].type===fd){const F=L[T];aI(F)&&aI(f.gl)?F.colorSpace=f.gl.outputColorSpace:F.encoding=f.gl.outputEncoding}r0(n)}if(c.parent&&f.internal&&n.raycast&&_!==c.eventCount){const S=f.internal.interaction.indexOf(n);S>-1&&f.internal.interaction.splice(S,1),c.eventCount&&f.internal.interaction.push(n)}return!(y.length===1&&y[0][0]==="onUpdate")&&y.length&&(s=n.__r3f)!=null&&s.parent&&FR(n),n}function r0(n){var e,a;const o=(e=n.__r3f)==null||(a=e.root)==null||a.getState==null?void 0:a.getState();o&&o.internal.frames===0&&o.invalidate()}function FR(n){n.onUpdate==null||n.onUpdate(n)}function iSe(n,e){n.manual||(oK(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function tA(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function rSe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return A0.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return A0.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return A0.ContinuousEventPriority;default:return A0.DefaultEventPriority}}function hK(n,e,a,o){const s=a.get(e);s&&(a.delete(e),a.size===0&&(n.delete(o),s.target.releasePointerCapture(o)))}function oSe(n,e){const{internal:a}=n.getState();a.interaction=a.interaction.filter(o=>o!==e),a.initialHits=a.initialHits.filter(o=>o!==e),a.hovered.forEach((o,s)=>{(o.eventObject===e||o.object===e)&&a.hovered.delete(s)}),a.capturedMap.forEach((o,s)=>{hK(a.capturedMap,e,o,s)})}function sSe(n){function e(m){const{internal:y}=n.getState(),_=m.offsetX-y.initialClick[0],x=m.offsetY-y.initialClick[1];return Math.round(Math.sqrt(_*_+x*x))}function a(m){return m.filter(y=>["Move","Over","Enter","Out","Leave"].some(_=>{var x;return(x=y.__r3f)==null?void 0:x.handlers["onPointer"+_]}))}function o(m,y){const _=n.getState(),x=new Set,S=[],T=y?y(_.internal.interaction):_.internal.interaction;for(let L=0;L<T.length;L++){const O=hb(T[L]);O&&(O.raycaster.camera=void 0)}_.previousRoot||_.events.compute==null||_.events.compute(m,_);function I(L){const O=hb(L);if(!O||!O.events.enabled||O.raycaster.camera===null)return[];if(O.raycaster.camera===void 0){var F;O.events.compute==null||O.events.compute(m,O,(F=O.previousRoot)==null?void 0:F.getState()),O.raycaster.camera===void 0&&(O.raycaster.camera=null)}return O.raycaster.camera?O.raycaster.intersectObject(L,!0):[]}let k=T.flatMap(I).sort((L,O)=>{const F=hb(L.object),B=hb(O.object);return!F||!B?L.distance-O.distance:B.events.priority-F.events.priority||L.distance-O.distance}).filter(L=>{const O=tA(L);return x.has(O)?!1:(x.add(O),!0)});_.events.filter&&(k=_.events.filter(k,_));for(const L of k){let O=L.object;for(;O;){var D;(D=O.__r3f)!=null&&D.eventCount&&S.push({...L,eventObject:O}),O=O.parent}}if("pointerId"in m&&_.internal.capturedMap.has(m.pointerId))for(let L of _.internal.capturedMap.get(m.pointerId).values())x.has(tA(L.intersection))||S.push(L.intersection);return S}function s(m,y,_,x){const S=n.getState();if(m.length){const T={stopped:!1};for(const I of m){const k=hb(I.object)||S,{raycaster:D,pointer:L,camera:O,internal:F}=k,B=new Fe(L.x,L.y,0).unproject(O),G=Q=>{var ge,me;return(ge=(me=F.capturedMap.get(Q))==null?void 0:me.has(I.eventObject))!=null?ge:!1},q=Q=>{const ge={intersection:I,target:y.target};F.capturedMap.has(Q)?F.capturedMap.get(Q).set(I.eventObject,ge):F.capturedMap.set(Q,new Map([[I.eventObject,ge]])),y.target.setPointerCapture(Q)},X=Q=>{const ge=F.capturedMap.get(Q);ge&&hK(F.capturedMap,I.eventObject,ge,Q)};let te={};for(let Q in y){let ge=y[Q];typeof ge!="function"&&(te[Q]=ge)}let V={...I,...te,pointer:L,intersections:m,stopped:T.stopped,delta:_,unprojectedPoint:B,ray:D.ray,camera:O,stopPropagation(){const Q="pointerId"in y&&F.capturedMap.get(y.pointerId);if((!Q||Q.has(I.eventObject))&&(V.stopped=T.stopped=!0,F.hovered.size&&Array.from(F.hovered.values()).find(ge=>ge.eventObject===I.eventObject))){const ge=m.slice(0,m.indexOf(I));c([...ge,I])}},target:{hasPointerCapture:G,setPointerCapture:q,releasePointerCapture:X},currentTarget:{hasPointerCapture:G,setPointerCapture:q,releasePointerCapture:X},nativeEvent:y};if(x(V),T.stopped===!0)break}}return m}function c(m){const{internal:y}=n.getState();for(const _ of y.hovered.values())if(!m.length||!m.find(x=>x.object===_.object&&x.index===_.index&&x.instanceId===_.instanceId)){const S=_.eventObject.__r3f,T=S==null?void 0:S.handlers;if(y.hovered.delete(tA(_)),S!=null&&S.eventCount){const I={..._,intersections:m};T.onPointerOut==null||T.onPointerOut(I),T.onPointerLeave==null||T.onPointerLeave(I)}}}function d(m,y){for(let _=0;_<y.length;_++){const x=y[_].__r3f;x==null||x.handlers.onPointerMissed==null||x.handlers.onPointerMissed(m)}}function f(m){switch(m){case"onPointerLeave":case"onPointerCancel":return()=>c([]);case"onLostPointerCapture":return y=>{const{internal:_}=n.getState();"pointerId"in y&&_.capturedMap.has(y.pointerId)&&requestAnimationFrame(()=>{_.capturedMap.has(y.pointerId)&&(_.capturedMap.delete(y.pointerId),c([]))})}}return function(_){const{onPointerMissed:x,internal:S}=n.getState();S.lastEvent.current=_;const T=m==="onPointerMove",I=m==="onClick"||m==="onContextMenu"||m==="onDoubleClick",D=o(_,T?a:void 0),L=I?e(_):0;m==="onPointerDown"&&(S.initialClick=[_.offsetX,_.offsetY],S.initialHits=D.map(F=>F.eventObject)),I&&!D.length&&L<=2&&(d(_,S.interaction),x&&x(_)),T&&c(D);function O(F){const B=F.eventObject,G=B.__r3f,q=G==null?void 0:G.handlers;if(G!=null&&G.eventCount)if(T){if(q.onPointerOver||q.onPointerEnter||q.onPointerOut||q.onPointerLeave){const X=tA(F),te=S.hovered.get(X);te?te.stopped&&F.stopPropagation():(S.hovered.set(X,F),q.onPointerOver==null||q.onPointerOver(F),q.onPointerEnter==null||q.onPointerEnter(F))}q.onPointerMove==null||q.onPointerMove(F)}else{const X=q[m];X?(!I||S.initialHits.includes(B))&&(d(_,S.interaction.filter(te=>!S.initialHits.includes(te))),X(F)):I&&S.initialHits.includes(B)&&d(_,S.interaction.filter(te=>!S.initialHits.includes(te)))}}s(D,_,L,O)}}return{handlePointer:f}}const fK=n=>!!(n!=null&&n.render),pK=re.createContext(null),lSe=(n,e)=>{const a=W3e((f,m)=>{const y=new Fe,_=new Fe,x=new Fe;function S(L=m().camera,O=_,F=m().size){const{width:B,height:G,top:q,left:X}=F,te=B/G;O instanceof Fe?x.copy(O):x.set(...O);const V=L.getWorldPosition(y).distanceTo(x);if(oK(L))return{width:B/L.zoom,height:G/L.zoom,top:q,left:X,factor:1,distance:V,aspect:te};{const Q=L.fov*Math.PI/180,ge=2*Math.tan(Q/2)*V,me=ge*(B/G);return{width:me,height:ge,top:q,left:X,factor:B/me,distance:V,aspect:te}}}let T;const I=L=>f(O=>({performance:{...O.performance,current:L}})),k=new Kt;return{set:f,get:m,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(L=1)=>n(m(),L),advance:(L,O)=>e(L,O,m()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new T6,pointer:k,mouse:k,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const L=m();T&&clearTimeout(T),L.performance.current!==L.performance.min&&I(L.performance.min),T=setTimeout(()=>I(m().performance.max),L.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:S},setEvents:L=>f(O=>({...O,events:{...O.events,...L}})),setSize:(L,O,F,B,G)=>{const q=m().camera,X={width:L,height:O,top:B||0,left:G||0,updateStyle:F};f(te=>({size:X,viewport:{...te.viewport,...S(q,_,X)}}))},setDpr:L=>f(O=>{const F=uK(L);return{viewport:{...O.viewport,dpr:F,initialDpr:O.viewport.initialDpr||F}}}),setFrameloop:(L="always")=>{const O=m().clock;O.stop(),O.elapsedTime=0,L!=="never"&&(O.start(),O.elapsedTime=0),f(()=>({frameloop:L}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:re.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(L,O,F)=>{const B=m().internal;return B.priority=B.priority+(O>0?1:0),B.subscribers.push({ref:L,priority:O,store:F}),B.subscribers=B.subscribers.sort((G,q)=>G.priority-q.priority),()=>{const G=m().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(O>0?1:0),G.subscribers=G.subscribers.filter(q=>q.ref!==L))}}}}}),o=a.getState();let s=o.size,c=o.viewport.dpr,d=o.camera;return a.subscribe(()=>{const{camera:f,size:m,viewport:y,gl:_,set:x}=a.getState();if(m.width!==s.width||m.height!==s.height||y.dpr!==c){var S;s=m,c=y.dpr,iSe(f,m),_.setPixelRatio(y.dpr);const T=(S=m.updateStyle)!=null?S:typeof HTMLCanvasElement<"u"&&_.domElement instanceof HTMLCanvasElement;_.setSize(m.width,m.height,T)}f!==d&&(d=f,x(T=>({viewport:{...T.viewport,...T.viewport.getCurrentViewport(f)}})))}),a.subscribe(f=>n(f)),a};function cSe(n,e){const a={callback:n};return e.add(a),()=>void e.delete(a)}let nA,mK=new Set,uSe=new Set,dSe=new Set;const hSe=n=>cSe(n,mK);function oI(n,e){if(n.size)for(const{callback:a}of n.values())a(e)}function fb(n,e){switch(n){case"before":return oI(mK,e);case"after":return oI(uSe,e);case"tail":return oI(dSe,e)}}let sI,lI;function cI(n,e,a){let o=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(o=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),sI=e.internal.subscribers,nA=0;nA<sI.length;nA++)lI=sI[nA],lI.ref.current(lI.store.getState(),o,a);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function fSe(n){let e=!1,a,o,s;function c(m){o=requestAnimationFrame(c),e=!0,a=0,fb("before",m);for(const _ of n.values()){var y;s=_.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((y=s.gl.xr)!=null&&y.isPresenting)&&(a+=cI(m,s))}if(fb("after",m),a===0)return fb("tail",m),e=!1,cancelAnimationFrame(o)}function d(m,y=1){var _;if(!m)return n.forEach(x=>d(x.store.getState()),y);(_=m.gl.xr)!=null&&_.isPresenting||!m.internal.active||m.frameloop==="never"||(m.internal.frames=Math.min(60,m.internal.frames+y),e||(e=!0,requestAnimationFrame(c)))}function f(m,y=!0,_,x){if(y&&fb("before",m),_)cI(m,_,x);else for(const S of n.values())cI(m,S.store.getState());y&&fb("after",m)}return{loop:c,invalidate:d,advance:f}}function gK(){const n=re.useContext(pK);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function fh(n=a=>a,e){return gK()(n,e)}function R6(n,e=0){const a=gK(),o=a.getState().internal.subscribe,s=sK(n);return Uw(()=>o(s,e,a),[e,o,a]),null}const HV=new WeakMap;function yK(n,e){return function(a,...o){let s=HV.get(a);return s||(s=new a,HV.set(a,s)),n&&n(s),Promise.all(o.map(c=>new Promise((d,f)=>s.load(c,m=>{m.scene&&Object.assign(m,tSe(m.scene)),d(m)},e,m=>f(new Error(`Could not load ${c}: ${m==null?void 0:m.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function k6(n,e,a,o){const s=Array.isArray(e)?e:[e],c=iK(yK(a,o),[n,...s],{equal:sr.equ});return Array.isArray(e)?c:c[0]}k6.preload=function(n,e,a){const o=Array.isArray(e)?e:[e];return X3e(yK(a),[n,...o])};k6.clear=function(n,e){const a=Array.isArray(e)?e:[e];return Y3e([n,...a])};const i_=new Map,{invalidate:jV,advance:$V}=fSe(i_),{reconciler:nM,applyProps:eg}=K3e(i_,rSe),Zv={objects:"shallow",strict:!1},pSe=(n,e)=>{const a=typeof n=="function"?n(e):n;return fK(a)?a:new c6({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function mSe(n,e){const a=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:o,height:s,top:c,left:d,updateStyle:f=a}=e;return{width:o,height:s,top:c,left:d,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:o,height:s,top:c,left:d}=n.parentElement.getBoundingClientRect();return{width:o,height:s,top:c,left:d,updateStyle:a}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:a};return{width:0,height:0,top:0,left:0}}function gSe(n){const e=i_.get(n),a=e==null?void 0:e.fiber,o=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,c=o||lSe(jV,$V),d=a||nM.createContainer(c,A0.ConcurrentRoot,null,!1,null,"",s,null);e||i_.set(n,{fiber:d,store:c});let f,m=!1,y;return{configure(_={}){let{gl:x,size:S,scene:T,events:I,onCreated:k,shadows:D=!1,linear:L=!1,flat:O=!1,legacy:F=!1,orthographic:B=!1,frameloop:G="always",dpr:q=[1,2],performance:X,raycaster:te,camera:V,onPointerMissed:Q}=_,ge=c.getState(),me=ge.gl;ge.gl||ge.set({gl:me=pSe(x,n)});let be=ge.raycaster;be||ge.set({raycaster:be=new YZ});const{params:fe,...Ce}=te||{};if(sr.equ(Ce,be,Zv)||eg(be,{...Ce}),sr.equ(fe,be.params,Zv)||eg(be,{params:{...be.params,...fe}}),!ge.camera||ge.camera===y&&!sr.equ(y,V,Zv)){y=V;const Ee=V instanceof Dw,Ze=Ee?V:B?new Eh(0,0,0,0,.1,1e3):new qr(75,0,.1,1e3);Ee||(Ze.position.z=5,V&&eg(Ze,V),!ge.camera&&!(V!=null&&V.rotation)&&Ze.lookAt(0,0,0)),ge.set({camera:Ze}),be.camera=Ze}if(!ge.scene){let Ee;T instanceof eM?Ee=T:(Ee=new eM,T&&eg(Ee,T)),ge.set({scene:i0(Ee)})}if(!ge.xr){var Le;const Ee=(Ke,Ue)=>{const ft=c.getState();ft.frameloop!=="never"&&$V(Ke,!0,ft,Ue)},Ze=()=>{const Ke=c.getState();Ke.gl.xr.enabled=Ke.gl.xr.isPresenting,Ke.gl.xr.setAnimationLoop(Ke.gl.xr.isPresenting?Ee:null),Ke.gl.xr.isPresenting||jV(Ke)},Xe={connect(){const Ke=c.getState().gl;Ke.xr.addEventListener("sessionstart",Ze),Ke.xr.addEventListener("sessionend",Ze)},disconnect(){const Ke=c.getState().gl;Ke.xr.removeEventListener("sessionstart",Ze),Ke.xr.removeEventListener("sessionend",Ze)}};typeof((Le=me.xr)==null?void 0:Le.addEventListener)=="function"&&Xe.connect(),ge.set({xr:Xe})}if(me.shadowMap){const Ee=me.shadowMap.enabled,Ze=me.shadowMap.type;if(me.shadowMap.enabled=!!D,sr.boo(D))me.shadowMap.type=Jb;else if(sr.str(D)){var Ge;const Xe={basic:VX,percentage:PT,soft:Jb,variance:tu};me.shadowMap.type=(Ge=Xe[D])!=null?Ge:Jb}else sr.obj(D)&&Object.assign(me.shadowMap,D);(Ee!==me.shadowMap.enabled||Ze!==me.shadowMap.type)&&(me.shadowMap.needsUpdate=!0)}const le=rK();le&&("enabled"in le?le.enabled=!F:"legacyMode"in le&&(le.legacyMode=F)),eg(me,{outputEncoding:L?3e3:3001,toneMapping:O?hd:jD}),ge.legacy!==F&&ge.set(()=>({legacy:F})),ge.linear!==L&&ge.set(()=>({linear:L})),ge.flat!==O&&ge.set(()=>({flat:O})),x&&!sr.fun(x)&&!fK(x)&&!sr.equ(x,me,Zv)&&eg(me,x),I&&!ge.events.handlers&&ge.set({events:I(c)});const ae=mSe(n,S);return sr.equ(ae,ge.size,Zv)||ge.setSize(ae.width,ae.height,ae.updateStyle,ae.top,ae.left),q&&ge.viewport.dpr!==uK(q)&&ge.setDpr(q),ge.frameloop!==G&&ge.setFrameloop(G),ge.onPointerMissed||ge.set({onPointerMissed:Q}),X&&!sr.equ(X,ge.performance,Zv)&&ge.set(Ee=>({performance:{...Ee.performance,...X}})),f=k,m=!0,this},render(_){return m||this.configure(),nM.updateContainer(re.createElement(ySe,{store:c,children:_,onCreated:f,rootElement:n}),d,null,()=>{}),c},unmount(){vK(n)}}}function ySe({store:n,children:e,onCreated:a,rootElement:o}){return Uw(()=>{const s=n.getState();s.set(c=>({internal:{...c.internal,active:!0}})),a&&a(s),n.getState().events.connected||s.events.connect==null||s.events.connect(o)},[]),re.createElement(pK.Provider,{value:n},e)}function vK(n,e){const a=i_.get(n),o=a==null?void 0:a.fiber;if(o){const s=a==null?void 0:a.store.getState();s&&(s.internal.active=!1),nM.updateContainer(null,o,null,()=>{s&&setTimeout(()=>{try{var c,d,f,m;s.events.disconnect==null||s.events.disconnect(),(c=s.gl)==null||(d=c.renderLists)==null||d.dispose==null||d.dispose(),(f=s.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(m=s.gl)!=null&&m.xr&&s.xr.disconnect(),nSe(s),i_.delete(n),e&&e(n)}catch{}},500)})}}nM.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:re.version});function NR(n,e,a){var o,s,c,d,f;e==null&&(e=100);function m(){var _=Date.now()-d;_<e&&_>=0?o=setTimeout(m,e-_):(o=null,a||(f=n.apply(c,s),c=s=null))}var y=function(){c=this,s=arguments,d=Date.now();var _=a&&!o;return o||(o=setTimeout(m,e)),_&&(f=n.apply(c,s),c=s=null),f};return y.clear=function(){o&&(clearTimeout(o),o=null)},y.flush=function(){o&&(f=n.apply(c,s),c=s=null,clearTimeout(o),o=null)},y}NR.debounce=NR;var vSe=NR;const qV=gw(vSe);function _Se(n){let{debounce:e,scroll:a,polyfill:o,offsetSize:s}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const c=o||(typeof window>"u"?class{}:window.ResizeObserver);if(!c)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[d,f]=re.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),m=re.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d}),y=e?typeof e=="number"?e:e.scroll:null,_=e?typeof e=="number"?e:e.resize:null,x=re.useRef(!1);re.useEffect(()=>(x.current=!0,()=>void(x.current=!1)));const[S,T,I]=re.useMemo(()=>{const O=()=>{if(!m.current.element)return;const{left:F,top:B,width:G,height:q,bottom:X,right:te,x:V,y:Q}=m.current.element.getBoundingClientRect(),ge={left:F,top:B,width:G,height:q,bottom:X,right:te,x:V,y:Q};m.current.element instanceof HTMLElement&&s&&(ge.height=m.current.element.offsetHeight,ge.width=m.current.element.offsetWidth),Object.freeze(ge),x.current&&!SSe(m.current.lastBounds,ge)&&f(m.current.lastBounds=ge)};return[O,_?qV(O,_):O,y?qV(O,y):O]},[f,s,y,_]);function k(){m.current.scrollContainers&&(m.current.scrollContainers.forEach(O=>O.removeEventListener("scroll",I,!0)),m.current.scrollContainers=null),m.current.resizeObserver&&(m.current.resizeObserver.disconnect(),m.current.resizeObserver=null)}function D(){m.current.element&&(m.current.resizeObserver=new c(I),m.current.resizeObserver.observe(m.current.element),a&&m.current.scrollContainers&&m.current.scrollContainers.forEach(O=>O.addEventListener("scroll",I,{capture:!0,passive:!0})))}const L=O=>{!O||O===m.current.element||(k(),m.current.element=O,m.current.scrollContainers=_K(O),D())};return xSe(I,!!a),bSe(T),re.useEffect(()=>{k(),D()},[a,I,T]),re.useEffect(()=>k,[]),[L,d,S]}function bSe(n){re.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function xSe(n,e){re.useEffect(()=>{if(e){const a=n;return window.addEventListener("scroll",a,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",a,!0)}},[n,e])}function _K(n){const e=[];if(!n||n===document.body)return e;const{overflow:a,overflowX:o,overflowY:s}=window.getComputedStyle(n);return[a,o,s].some(c=>c==="auto"||c==="scroll")&&e.push(n),[...e,..._K(n.parentElement)]}const wSe=["x","y","top","bottom","left","right","width","height"],SSe=(n,e)=>wSe.every(a=>n[a]===e[a]);var ASe=Object.defineProperty,ESe=Object.defineProperties,MSe=Object.getOwnPropertyDescriptors,XV=Object.getOwnPropertySymbols,TSe=Object.prototype.hasOwnProperty,CSe=Object.prototype.propertyIsEnumerable,YV=(n,e,a)=>e in n?ASe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,ZV=(n,e)=>{for(var a in e||(e={}))TSe.call(e,a)&&YV(n,a,e[a]);if(XV)for(var a of XV(e))CSe.call(e,a)&&YV(n,a,e[a]);return n},PSe=(n,e)=>ESe(n,MSe(e));function bK(n,e,a){if(!n)return;if(a(n)===!0)return n;let o=e?n.return:n.child;for(;o;){const s=bK(o,e,a);if(s)return s;o=e?null:o.sibling}}function xK(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const D6=xK(re.createContext(null));class wK extends re.Component{render(){return re.createElement(D6.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:KV,ReactCurrentDispatcher:JV}=re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function ISe(){const n=re.useContext(D6);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=re.useId();return re.useMemo(()=>{for(const o of[KV==null?void 0:KV.current,n,n==null?void 0:n.alternate]){if(!o)continue;const s=bK(o,!1,c=>{let d=c.memoizedState;for(;d;){if(d.memoizedState===e)return!0;d=d.next}});if(s)return s}},[n,e])}function LSe(){var n,e;const a=ISe(),[o]=re.useState(()=>new Map);o.clear();let s=a;for(;s;){const c=(n=s.type)==null?void 0:n._context;c&&c!==D6&&!o.has(c)&&o.set(c,(e=JV==null?void 0:JV.current)==null?void 0:e.readContext(xK(c))),s=s.return}return o}function RSe(){const n=LSe();return re.useMemo(()=>Array.from(n.keys()).reduce((e,a)=>o=>re.createElement(e,null,re.createElement(a.Provider,PSe(ZV({},o),{value:n.get(a)}))),e=>re.createElement(wK,ZV({},e))),[n])}const uI={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function kSe(n){const{handlePointer:e}=sSe(n);return{priority:1,enabled:!0,compute(a,o,s){o.pointer.set(a.offsetX/o.size.width*2-1,-(a.offsetY/o.size.height)*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)},connected:void 0,handlers:Object.keys(uI).reduce((a,o)=>({...a,[o]:e(o)}),{}),update:()=>{var a;const{events:o,internal:s}=n.getState();(a=s.lastEvent)!=null&&a.current&&o.handlers&&o.handlers.onPointerMove(s.lastEvent.current)},connect:a=>{var o;const{set:s,events:c}=n.getState();c.disconnect==null||c.disconnect(),s(d=>({events:{...d.events,connected:a}})),Object.entries((o=c.handlers)!=null?o:[]).forEach(([d,f])=>{const[m,y]=uI[d];a.addEventListener(m,f,{passive:y})})},disconnect:()=>{const{set:a,events:o}=n.getState();if(o.connected){var s;Object.entries((s=o.handlers)!=null?s:[]).forEach(([c,d])=>{if(o&&o.connected instanceof HTMLElement){const[f]=uI[c];o.connected.removeEventListener(f,d)}}),a(c=>({events:{...c.events,connected:void 0}}))}}}}const DSe=re.forwardRef(function({children:e,fallback:a,resize:o,style:s,gl:c,events:d=kSe,eventSource:f,eventPrefix:m,shadows:y,linear:_,flat:x,legacy:S,orthographic:T,frameloop:I,dpr:k,performance:D,raycaster:L,camera:O,scene:F,onPointerMissed:B,onCreated:G,...q},X){re.useMemo(()=>Z3e(KZ),[]);const te=RSe(),[V,Q]=_Se({scroll:!0,debounce:{scroll:50,resize:0},...o}),ge=re.useRef(null),me=re.useRef(null);re.useImperativeHandle(X,()=>ge.current);const be=sK(B),[fe,Ce]=re.useState(!1),[Le,Ge]=re.useState(!1);if(fe)throw fe;if(Le)throw Le;const le=re.useRef(null);Uw(()=>{const Ae=ge.current;Q.width>0&&Q.height>0&&Ae&&(le.current||(le.current=gSe(Ae)),le.current.configure({gl:c,events:d,shadows:y,linear:_,flat:x,legacy:S,orthographic:T,frameloop:I,dpr:k,performance:D,raycaster:L,camera:O,scene:F,size:Q,onPointerMissed:(...ae)=>be.current==null?void 0:be.current(...ae),onCreated:ae=>{ae.events.connect==null||ae.events.connect(f?J3e(f)?f.current:f:me.current),m&&ae.setEvents({compute:(Ee,Ze)=>{const Xe=Ee[m+"X"],Ke=Ee[m+"Y"];Ze.pointer.set(Xe/Ze.size.width*2-1,-(Ke/Ze.size.height)*2+1),Ze.raycaster.setFromCamera(Ze.pointer,Ze.camera)}}),G==null||G(ae)}}),le.current.render(re.createElement(te,null,re.createElement(lK,{set:Ge},re.createElement(re.Suspense,{fallback:re.createElement(Q3e,{set:Ce})},e)))))}),re.useEffect(()=>{const Ae=ge.current;if(Ae)return()=>vK(Ae)},[]);const pe=f?"none":"auto";return re.createElement("div",rt({ref:me,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:pe,...s}},q),re.createElement("div",{ref:V,style:{width:"100%",height:"100%"}},re.createElement("canvas",{ref:ge,style:{display:"block"}},a)))}),OSe=re.forwardRef(function(e,a){return re.createElement(wK,null,re.createElement(DSe,rt({},e,{ref:a})))});let O6=Vw();const ni=n=>Ww(n,O6);let z6=Vw();ni.write=n=>Ww(n,z6);let rC=Vw();ni.onStart=n=>Ww(n,rC);let F6=Vw();ni.onFrame=n=>Ww(n,F6);let N6=Vw();ni.onFinish=n=>Ww(n,N6);let F0=[];ni.setTimeout=(n,e)=>{let a=ni.now()+e,o=()=>{let c=F0.findIndex(d=>d.cancel==o);~c&&F0.splice(c,1),Zf-=~c?1:0},s={time:a,handler:n,cancel:o};return F0.splice(SK(a),0,s),Zf+=1,AK(),s};let SK=n=>~(~F0.findIndex(e=>e.time>n)||~F0.length);ni.cancel=n=>{rC.delete(n),F6.delete(n),N6.delete(n),O6.delete(n),z6.delete(n)};ni.sync=n=>{BR=!0,ni.batchedUpdates(n),BR=!1};ni.throttle=n=>{let e;function a(){try{n(...e)}finally{e=null}}function o(...s){e=s,ni.onStart(a)}return o.handler=n,o.cancel=()=>{rC.delete(a),e=null},o};let B6=typeof window<"u"?window.requestAnimationFrame:()=>{};ni.use=n=>B6=n;ni.now=typeof performance<"u"?()=>performance.now():Date.now;ni.batchedUpdates=n=>n();ni.catch=console.error;ni.frameLoop="always";ni.advance=()=>{ni.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):MK()};let Yf=-1,Zf=0,BR=!1;function Ww(n,e){BR?(e.delete(n),n(0)):(e.add(n),AK())}function AK(){Yf<0&&(Yf=0,ni.frameLoop!=="demand"&&B6(EK))}function zSe(){Yf=-1}function EK(){~Yf&&(B6(EK),ni.batchedUpdates(MK))}function MK(){let n=Yf;Yf=ni.now();let e=SK(Yf);if(e&&(TK(F0.splice(0,e),a=>a.handler()),Zf-=e),!Zf){zSe();return}rC.flush(),O6.flush(n?Math.min(64,Yf-n):16.667),F6.flush(),z6.flush(),N6.flush()}function Vw(){let n=new Set,e=n;return{add(a){Zf+=e==n&&!n.has(a)?1:0,n.add(a)},delete(a){return Zf-=e==n&&n.has(a)?1:0,n.delete(a)},flush(a){e.size&&(n=new Set,Zf-=e.size,TK(e,o=>o(a)&&n.add(o)),Zf+=n.size,e=n)}}}function TK(n,e){n.forEach(a=>{try{e(a)}catch(o){ni.catch(o)}})}function FSe(){}const NSe=(n,e,a)=>Object.defineProperty(n,e,{value:a,writable:!0,configurable:!0}),Zr={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function BSe(n,e){if(Zr.arr(n)){if(!Zr.arr(e)||n.length!==e.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==e[a])return!1;return!0}return n===e}const Lh=(n,e)=>n.forEach(e);function UR(n,e,a){if(Zr.arr(n)){for(let o=0;o<n.length;o++)e.call(a,n[o],`${o}`);return}for(const o in n)n.hasOwnProperty(o)&&e.call(a,n[o],o)}const aA=n=>Zr.und(n)?[]:Zr.arr(n)?n:[n],U6=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent);let W6,CK,fp=null,PK=!1,V6=FSe;const USe=n=>{n.to&&(CK=n.to),n.now&&(ni.now=n.now),n.colors!==void 0&&(fp=n.colors),n.skipAnimation!=null&&(PK=n.skipAnimation),n.createStringInterpolator&&(W6=n.createStringInterpolator),n.requestAnimationFrame&&ni.use(n.requestAnimationFrame),n.batchedUpdates&&(ni.batchedUpdates=n.batchedUpdates),n.willAdvance&&(V6=n.willAdvance),n.frameLoop&&(ni.frameLoop=n.frameLoop)};var rw=Object.freeze({__proto__:null,get createStringInterpolator(){return W6},get to(){return CK},get colors(){return fp},get skipAnimation(){return PK},get willAdvance(){return V6},assign:USe});const ix=new Set;let wc=[],dI=[],aM=0;const G6={get idle(){return!ix.size&&!wc.length},start(n){aM>n.priority?(ix.add(n),ni.onStart(WSe)):(IK(n),ni(WR))},advance:WR,sort(n){if(aM)ni.onFrame(()=>G6.sort(n));else{const e=wc.indexOf(n);~e&&(wc.splice(e,1),LK(n))}},clear(){wc=[],ix.clear()}};function WSe(){ix.forEach(IK),ix.clear(),ni(WR)}function IK(n){wc.includes(n)||LK(n)}function LK(n){wc.splice(VSe(wc,e=>e.priority>n.priority),0,n)}function WR(n){const e=dI;for(let a=0;a<wc.length;a++){const o=wc[a];aM=o.priority,o.idle||(V6(o),o.advance(n),o.idle||e.push(o))}return aM=0,dI=wc,dI.length=0,wc=e,wc.length>0}function VSe(n,e){const a=n.findIndex(e);return a<0?n.length:a}const GSe=(n,e,a)=>Math.min(Math.max(a,n),e),HSe={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},ou="[-+]?\\d*\\.?\\d+",iM=ou+"%";function oC(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}const jSe=new RegExp("rgb"+oC(ou,ou,ou)),$Se=new RegExp("rgba"+oC(ou,ou,ou,ou)),qSe=new RegExp("hsl"+oC(ou,iM,iM)),XSe=new RegExp("hsla"+oC(ou,iM,iM,ou)),YSe=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ZSe=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,KSe=/^#([0-9a-fA-F]{6})$/,JSe=/^#([0-9a-fA-F]{8})$/;function QSe(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=KSe.exec(n))?parseInt(e[1]+"ff",16)>>>0:fp&&fp[n]!==void 0?fp[n]:(e=jSe.exec(n))?(Kv(e[1])<<24|Kv(e[2])<<16|Kv(e[3])<<8|255)>>>0:(e=$Se.exec(n))?(Kv(e[1])<<24|Kv(e[2])<<16|Kv(e[3])<<8|tG(e[4]))>>>0:(e=YSe.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=JSe.exec(n))?parseInt(e[1],16)>>>0:(e=ZSe.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=qSe.exec(n))?(QV(eG(e[1]),iA(e[2]),iA(e[3]))|255)>>>0:(e=XSe.exec(n))?(QV(eG(e[1]),iA(e[2]),iA(e[3]))|tG(e[4]))>>>0:null}function hI(n,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?n+(e-n)*6*a:a<1/2?e:a<2/3?n+(e-n)*(2/3-a)*6:n}function QV(n,e,a){const o=a<.5?a*(1+e):a+e-a*e,s=2*a-o,c=hI(s,o,n+1/3),d=hI(s,o,n),f=hI(s,o,n-1/3);return Math.round(c*255)<<24|Math.round(d*255)<<16|Math.round(f*255)<<8}function Kv(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function eG(n){return(parseFloat(n)%360+360)%360/360}function tG(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function iA(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function nG(n){let e=QSe(n);if(e===null)return n;e=e||0;let a=(e&4278190080)>>>24,o=(e&16711680)>>>16,s=(e&65280)>>>8,c=(e&255)/255;return`rgba(${a}, ${o}, ${s}, ${c})`}const ow=(n,e,a)=>{if(Zr.fun(n))return n;if(Zr.arr(n))return ow({range:n,output:e,extrapolate:a});if(Zr.str(n.output[0]))return W6(n);const o=n,s=o.output,c=o.range||[0,1],d=o.extrapolateLeft||o.extrapolate||"extend",f=o.extrapolateRight||o.extrapolate||"extend",m=o.easing||(y=>y);return y=>{const _=tAe(y,c);return eAe(y,c[_],c[_+1],s[_],s[_+1],m,d,f,o.map)}};function eAe(n,e,a,o,s,c,d,f,m){let y=m?m(n):n;if(y<e){if(d==="identity")return y;d==="clamp"&&(y=e)}if(y>a){if(f==="identity")return y;f==="clamp"&&(y=a)}return o===s?o:e===a?n<=e?o:s:(e===-1/0?y=-y:a===1/0?y=y-e:y=(y-e)/(a-e),y=c(y),o===-1/0?y=-y:s===1/0?y=y+o:y=y*(s-o)+o,y)}function tAe(n,e){for(var a=1;a<e.length-1&&!(e[a]>=n);++a);return a-1}const nAe=(n,e="end")=>a=>{a=e==="end"?Math.min(a,.999):Math.max(a,.001);const o=a*n,s=e==="end"?Math.floor(o):Math.ceil(o);return GSe(0,1,s/n)},rM=1.70158,rA=rM*1.525,aG=rM+1,iG=2*Math.PI/3,rG=2*Math.PI/4.5,oA=n=>n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375,aAe={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>1-(1-n)*(1-n),easeInOutQuad:n=>n<.5?2*n*n:1-Math.pow(-2*n+2,2)/2,easeInCubic:n=>n*n*n,easeOutCubic:n=>1-Math.pow(1-n,3),easeInOutCubic:n=>n<.5?4*n*n*n:1-Math.pow(-2*n+2,3)/2,easeInQuart:n=>n*n*n*n,easeOutQuart:n=>1-Math.pow(1-n,4),easeInOutQuart:n=>n<.5?8*n*n*n*n:1-Math.pow(-2*n+2,4)/2,easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>1-Math.pow(1-n,5),easeInOutQuint:n=>n<.5?16*n*n*n*n*n:1-Math.pow(-2*n+2,5)/2,easeInSine:n=>1-Math.cos(n*Math.PI/2),easeOutSine:n=>Math.sin(n*Math.PI/2),easeInOutSine:n=>-(Math.cos(Math.PI*n)-1)/2,easeInExpo:n=>n===0?0:Math.pow(2,10*n-10),easeOutExpo:n=>n===1?1:1-Math.pow(2,-10*n),easeInOutExpo:n=>n===0?0:n===1?1:n<.5?Math.pow(2,20*n-10)/2:(2-Math.pow(2,-20*n+10))/2,easeInCirc:n=>1-Math.sqrt(1-Math.pow(n,2)),easeOutCirc:n=>Math.sqrt(1-Math.pow(n-1,2)),easeInOutCirc:n=>n<.5?(1-Math.sqrt(1-Math.pow(2*n,2)))/2:(Math.sqrt(1-Math.pow(-2*n+2,2))+1)/2,easeInBack:n=>aG*n*n*n-rM*n*n,easeOutBack:n=>1+aG*Math.pow(n-1,3)+rM*Math.pow(n-1,2),easeInOutBack:n=>n<.5?Math.pow(2*n,2)*((rA+1)*2*n-rA)/2:(Math.pow(2*n-2,2)*((rA+1)*(n*2-2)+rA)+2)/2,easeInElastic:n=>n===0?0:n===1?1:-Math.pow(2,10*n-10)*Math.sin((n*10-10.75)*iG),easeOutElastic:n=>n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n*10-.75)*iG)+1,easeInOutElastic:n=>n===0?0:n===1?1:n<.5?-(Math.pow(2,20*n-10)*Math.sin((20*n-11.125)*rG))/2:Math.pow(2,-20*n+10)*Math.sin((20*n-11.125)*rG)/2+1,easeInBounce:n=>1-oA(1-n),easeOutBounce:oA,easeInOutBounce:n=>n<.5?(1-oA(1-2*n))/2:(1+oA(2*n-1))/2,steps:nAe};function VR(){return VR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},VR.apply(this,arguments)}const r_=Symbol.for("FluidValue.get"),o_=Symbol.for("FluidValue.observers"),oM=n=>!!(n&&n[r_]),sM=n=>n&&n[r_]?n[r_]():n;function iAe(n,e){n.eventObserved?n.eventObserved(e):n(e)}function GR(n,e){let a=n[o_];a&&a.forEach(o=>{iAe(o,e)})}class rAe{constructor(e){if(this[r_]=void 0,this[o_]=void 0,!e&&!(e=this.get))throw Error("Unknown getter");oAe(this,e)}}const oAe=(n,e)=>kK(n,r_,e);function RK(n,e){if(n[r_]){let a=n[o_];a||kK(n,o_,a=new Set),a.has(e)||(a.add(e),n.observerAdded&&n.observerAdded(a.size,e))}return e}function HR(n,e){let a=n[o_];if(a&&a.has(e)){const o=a.size-1;o?a.delete(e):n[o_]=null,n.observerRemoved&&n.observerRemoved(o,e)}}const kK=(n,e,a)=>Object.defineProperty(n,e,{value:a,writable:!0,configurable:!0}),tE=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,sAe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,oG=new RegExp(`(${tE.source})(%|[a-z]+)`,"i"),lAe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,sC=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,DK=n=>{const[e,a]=cAe(n);if(!e||U6())return n;const o=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(o)return o.trim();if(a&&a.startsWith("--")){const s=window.getComputedStyle(document.documentElement).getPropertyValue(a);return s||n}else{if(a&&sC.test(a))return DK(a);if(a)return a}return n},cAe=n=>{const e=sC.exec(n);if(!e)return[,];const[,a,o]=e;return[a,o]};let fI;const uAe=(n,e,a,o,s)=>`rgba(${Math.round(e)}, ${Math.round(a)}, ${Math.round(o)}, ${s})`,OK=n=>{fI||(fI=fp?new RegExp(`(${Object.keys(fp).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(c=>sM(c).replace(sC,DK).replace(sAe,nG).replace(fI,nG)),a=e.map(c=>c.match(tE).map(Number)),s=a[0].map((c,d)=>a.map(f=>{if(!(d in f))throw Error('The arity of each "output" value must be equal');return f[d]})).map(c=>ow(VR({},n,{output:c})));return c=>{var d;const f=!oG.test(e[0])&&((d=e.find(y=>oG.test(y)))==null?void 0:d.replace(tE,""));let m=0;return e[0].replace(tE,()=>`${s[m++](c)}${f||""}`).replace(lAe,uAe)}},zK="react-spring: ",FK=n=>{const e=n;let a=!1;if(typeof e!="function")throw new TypeError(`${zK}once requires a function parameter`);return(...o)=>{a||(e(...o),a=!0)}},dAe=FK(console.warn);function hAe(){dAe(`${zK}The "interpolate" function is deprecated in v9 (use "to" instead)`)}FK(console.warn);function NK(n){return Zr.str(n)&&(n[0]=="#"||/\d/.test(n)||!U6()&&sC.test(n)||n in(fp||{}))}const BK=U6()?re.useEffect:re.useLayoutEffect,fAe=()=>{const n=re.useRef(!1);return BK(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function pAe(){const n=re.useState()[1],e=fAe();return()=>{e.current&&n(Math.random())}}function mAe(n,e){const[a]=re.useState(()=>({inputs:e,result:n()})),o=re.useRef(),s=o.current;let c=s;return c?e&&c.inputs&&gAe(e,c.inputs)||(c={inputs:e,result:n()}):c=a,re.useEffect(()=>{o.current=c,s==a&&(a.inputs=a.result=void 0)},[c]),c.result}function gAe(n,e){if(n.length!==e.length)return!1;for(let a=0;a<n.length;a++)if(n[a]!==e[a])return!1;return!0}const yAe=n=>re.useEffect(n,vAe),vAe=[],sw=Symbol.for("Animated:node"),_Ae=n=>!!n&&n[sw]===n,H6=n=>n&&n[sw],UK=(n,e)=>NSe(n,sw,e),j6=n=>n&&n[sw]&&n[sw].getPayload();class WK{constructor(){this.payload=void 0,UK(this,this)}getPayload(){return this.payload||[]}}class Gw extends WK{constructor(e){super(),this.done=!0,this.elapsedTime=void 0,this.lastPosition=void 0,this.lastVelocity=void 0,this.v0=void 0,this.durationProgress=0,this._value=e,Zr.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new Gw(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,a){return Zr.num(e)&&(this.lastPosition=e,a&&(e=Math.round(e/a)*a,this.done&&(this.lastPosition=e))),this._value===e?!1:(this._value=e,!0)}reset(){const{done:e}=this;this.done=!1,Zr.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}class lC extends Gw{constructor(e){super(0),this._string=null,this._toString=void 0,this._toString=ow({output:[e,e]})}static create(e){return new lC(e)}getValue(){let e=this._string;return e??(this._string=this._toString(this._value))}setValue(e){if(Zr.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else if(super.setValue(e))this._string=null;else return!1;return!0}reset(e){e&&(this._toString=ow({output:[this.getValue(),e]})),this._value=0,super.reset()}}const lM={dependencies:null};class $6 extends WK{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){const a={};return UR(this.source,(o,s)=>{_Ae(o)?a[s]=o.getValue(e):oM(o)?a[s]=sM(o):e||(a[s]=o)}),a}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&Lh(this.payload,e=>e.reset())}_makePayload(e){if(e){const a=new Set;return UR(e,this._addToPayload,a),Array.from(a)}}_addToPayload(e){lM.dependencies&&oM(e)&&lM.dependencies.add(e);const a=j6(e);a&&Lh(a,o=>this.add(o))}}class q6 extends $6{constructor(e){super(e)}static create(e){return new q6(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){const a=this.getPayload();return e.length==a.length?a.map((o,s)=>o.setValue(e[s])).some(Boolean):(super.setValue(e.map(bAe)),!0)}}function bAe(n){return(NK(n)?lC:Gw).create(n)}function xAe(n){const e=H6(n);return e?e.constructor:Zr.arr(n)?q6:NK(n)?lC:Gw}function cM(){return cM=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},cM.apply(this,arguments)}const sG=(n,e)=>{const a=!Zr.fun(n)||n.prototype&&n.prototype.isReactComponent;return re.forwardRef((o,s)=>{const c=re.useRef(null),d=a&&re.useCallback(I=>{c.current=AAe(s,I)},[s]),[f,m]=SAe(o,e),y=pAe(),_=()=>{const I=c.current;if(a&&!I)return;(I?e.applyAnimatedValues(I,f.getValue(!0)):!1)===!1&&y()},x=new wAe(_,m),S=re.useRef();BK(()=>(S.current=x,Lh(m,I=>RK(I,x)),()=>{S.current&&(Lh(S.current.deps,I=>HR(I,S.current)),ni.cancel(S.current.update))})),re.useEffect(_,[]),yAe(()=>()=>{const I=S.current;Lh(I.deps,k=>HR(k,I))});const T=e.getComponentProps(f.getValue());return re.createElement(n,cM({},T,{ref:d}))})};class wAe{constructor(e,a){this.update=e,this.deps=a}eventObserved(e){e.type=="change"&&ni.write(this.update)}}function SAe(n,e){const a=new Set;return lM.dependencies=a,n.style&&(n=cM({},n,{style:e.createAnimatedStyle(n.style)})),n=new $6(n),lM.dependencies=null,[n,a]}function AAe(n,e){return n&&(Zr.fun(n)?n(e):n.current=e),e}const lG=Symbol.for("AnimatedComponent"),EAe=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:a=s=>new $6(s),getComponentProps:o=s=>s}={})=>{const s={applyAnimatedValues:e,createAnimatedStyle:a,getComponentProps:o},c=d=>{const f=cG(d)||"Anonymous";return Zr.str(d)?d=c[d]||(c[d]=sG(d,s)):d=d[lG]||(d[lG]=sG(d,s)),d.displayName=`Animated(${f})`,d};return UR(n,(d,f)=>{Zr.arr(n)&&(f=cG(d)),c[f]=c(d)}),{animated:c}},cG=n=>Zr.str(n)?n:n&&Zr.str(n.displayName)?n.displayName:Zr.fun(n)&&n.name||null;function jR(){return jR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},jR.apply(this,arguments)}const MAe={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}};jR({},MAe.default,{mass:1,damping:1,easing:aAe.linear,clamp:!1});const uG=n=>n instanceof VK;let TAe=1;class VK extends rAe{constructor(...e){super(...e),this.id=TAe++,this.key=void 0,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){const e=H6(this);return e&&e.getValue()}to(...e){return rw.to(this,e)}interpolate(...e){return hAe(),rw.to(this,e)}toJSON(){return this.get()}observerAdded(e){e==1&&this._attach()}observerRemoved(e){e==0&&this._detach()}_attach(){}_detach(){}_onChange(e,a=!1){GR(this,{type:"change",parent:this,value:e,idle:a})}_onPriorityChange(e){this.idle||G6.sort(this),GR(this,{type:"priority",parent:this,priority:e})}}function CAe(n,e){if(n==null)return{};var a={},o=Object.keys(n),s,c;for(c=0;c<o.length;c++)s=o[c],!(e.indexOf(s)>=0)&&(a[s]=n[s]);return a}const PAe=["children"],X6=n=>{let{children:e}=n,a=CAe(n,PAe);const o=re.useContext(uM),s=a.pause||!!o.pause,c=a.immediate||!!o.immediate;a=mAe(()=>({pause:s,immediate:c}),[s,c]);const{Provider:d}=uM;return re.createElement(d,{value:a},e)},uM=IAe(X6,{});X6.Provider=uM.Provider;X6.Consumer=uM.Consumer;function IAe(n,e){return Object.assign(n,re.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}let dG;(function(n){n.MOUNT="mount",n.ENTER="enter",n.UPDATE="update",n.LEAVE="leave"})(dG||(dG={}));class LAe extends VK{constructor(e,a){super(),this.key=void 0,this.idle=!0,this.calc=void 0,this._active=new Set,this.source=e,this.calc=ow(...a);const o=this._get(),s=xAe(o);UK(this,s.create(o))}advance(e){const a=this._get(),o=this.get();BSe(a,o)||(H6(this).setValue(a),this._onChange(a,this.idle)),!this.idle&&hG(this._active)&&pI(this)}_get(){const e=Zr.arr(this.source)?this.source.map(sM):aA(sM(this.source));return this.calc(...e)}_start(){this.idle&&!hG(this._active)&&(this.idle=!1,Lh(j6(this),e=>{e.done=!1}),rw.skipAnimation?(ni.batchedUpdates(()=>this.advance()),pI(this)):G6.start(this))}_attach(){let e=1;Lh(aA(this.source),a=>{oM(a)&&RK(a,this),uG(a)&&(a.idle||this._active.add(a),e=Math.max(e,a.priority+1))}),this.priority=e,this._start()}_detach(){Lh(aA(this.source),e=>{oM(e)&&HR(e,this)}),this._active.clear(),pI(this)}eventObserved(e){e.type=="change"?e.idle?this.advance():(this._active.add(e.parent),this._start()):e.type=="idle"?this._active.delete(e.parent):e.type=="priority"&&(this.priority=aA(this.source).reduce((a,o)=>Math.max(a,(uG(o)?o.priority:0)+1),0))}}function RAe(n){return n.idle!==!1}function hG(n){return!n.size||Array.from(n).every(RAe)}function pI(n){n.idle||(n.idle=!0,Lh(j6(n),e=>{e.done=!0}),GR(n,{type:"idle",parent:n}))}rw.assign({createStringInterpolator:OK,to:(n,e)=>new LAe(n,e)});const kAe=["primitive"].concat(Object.keys(KZ).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));rw.assign({createStringInterpolator:OK,colors:HSe,frameLoop:"demand"});hSe(()=>{ni.advance()});EAe(kAe,{applyAnimatedValues:eg});var DAe=Object.defineProperty,OAe=(n,e,a)=>e in n?DAe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a,Aa=(n,e,a)=>(OAe(n,typeof e!="symbol"?e+"":e,a),a);const sA=new Hg,fG=new vh,zAe=Math.cos(70*(Math.PI/180)),pG=(n,e)=>(n%e+e)%e;let FAe=class extends xd{constructor(e,a){super(),Aa(this,"object"),Aa(this,"domElement"),Aa(this,"enabled",!0),Aa(this,"target",new Fe),Aa(this,"minDistance",0),Aa(this,"maxDistance",1/0),Aa(this,"minZoom",0),Aa(this,"maxZoom",1/0),Aa(this,"minPolarAngle",0),Aa(this,"maxPolarAngle",Math.PI),Aa(this,"minAzimuthAngle",-1/0),Aa(this,"maxAzimuthAngle",1/0),Aa(this,"enableDamping",!1),Aa(this,"dampingFactor",.05),Aa(this,"enableZoom",!0),Aa(this,"zoomSpeed",1),Aa(this,"enableRotate",!0),Aa(this,"rotateSpeed",1),Aa(this,"enablePan",!0),Aa(this,"panSpeed",1),Aa(this,"screenSpacePanning",!0),Aa(this,"keyPanSpeed",7),Aa(this,"zoomToCursor",!1),Aa(this,"autoRotate",!1),Aa(this,"autoRotateSpeed",2),Aa(this,"reverseOrbit",!1),Aa(this,"reverseHorizontalOrbit",!1),Aa(this,"reverseVerticalOrbit",!1),Aa(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Aa(this,"mouseButtons",{LEFT:Zm.ROTATE,MIDDLE:Zm.DOLLY,RIGHT:Zm.PAN}),Aa(this,"touches",{ONE:Km.ROTATE,TWO:Km.DOLLY_PAN}),Aa(this,"target0"),Aa(this,"position0"),Aa(this,"zoom0"),Aa(this,"_domElementKeyEvents",null),Aa(this,"getPolarAngle"),Aa(this,"getAzimuthalAngle"),Aa(this,"setPolarAngle"),Aa(this,"setAzimuthalAngle"),Aa(this,"getDistance"),Aa(this,"listenToKeyEvents"),Aa(this,"stopListenToKeyEvents"),Aa(this,"saveState"),Aa(this,"reset"),Aa(this,"update"),Aa(this,"connect"),Aa(this,"dispose"),this.object=e,this.domElement=a,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=He=>{let Lt=pG(He,2*Math.PI),qt=_.phi;qt<0&&(qt+=2*Math.PI),Lt<0&&(Lt+=2*Math.PI);let Ot=Math.abs(Lt-qt);2*Math.PI-Ot<Ot&&(Lt<qt?Lt+=2*Math.PI:qt+=2*Math.PI),x.phi=Lt-qt,o.update()},this.setAzimuthalAngle=He=>{let Lt=pG(He,2*Math.PI),qt=_.theta;qt<0&&(qt+=2*Math.PI),Lt<0&&(Lt+=2*Math.PI);let Ot=Math.abs(Lt-qt);2*Math.PI-Ot<Ot&&(Lt<qt?Lt+=2*Math.PI:qt+=2*Math.PI),x.theta=Lt-qt,o.update()},this.getDistance=()=>o.object.position.distanceTo(o.target),this.listenToKeyEvents=He=>{He.addEventListener("keydown",lt),this._domElementKeyEvents=He},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",lt),this._domElementKeyEvents=null},this.saveState=()=>{o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=()=>{o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(s),o.update(),m=f.NONE},this.update=(()=>{const He=new Fe,Lt=new Fe(0,1,0),qt=new As().setFromUnitVectors(e.up,Lt),Ot=qt.clone().invert(),fn=new Fe,_e=new As,Ye=2*Math.PI;return function(){const Me=o.object.position;qt.setFromUnitVectors(e.up,Lt),Ot.copy(qt).invert(),He.copy(Me).sub(o.target),He.applyQuaternion(qt),_.setFromVector3(He),o.autoRotate&&m===f.NONE&&fe(me()),o.enableDamping?(_.theta+=x.theta*o.dampingFactor,_.phi+=x.phi*o.dampingFactor):(_.theta+=x.theta,_.phi+=x.phi);let ze=o.minAzimuthAngle,Qe=o.maxAzimuthAngle;isFinite(ze)&&isFinite(Qe)&&(ze<-Math.PI?ze+=Ye:ze>Math.PI&&(ze-=Ye),Qe<-Math.PI?Qe+=Ye:Qe>Math.PI&&(Qe-=Ye),ze<=Qe?_.theta=Math.max(ze,Math.min(Qe,_.theta)):_.theta=_.theta>(ze+Qe)/2?Math.max(ze,_.theta):Math.min(Qe,_.theta)),_.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,_.phi)),_.makeSafe(),o.enableDamping===!0?o.target.addScaledVector(T,o.dampingFactor):o.target.add(T),o.zoomToCursor&&V||o.object.isOrthographicCamera?_.radius=Ee(_.radius):_.radius=Ee(_.radius*S),He.setFromSpherical(_),He.applyQuaternion(Ot),Me.copy(o.target).add(He),o.object.lookAt(o.target),o.enableDamping===!0?(x.theta*=1-o.dampingFactor,x.phi*=1-o.dampingFactor,T.multiplyScalar(1-o.dampingFactor)):(x.set(0,0,0),T.set(0,0,0));let tt=!1;if(o.zoomToCursor&&V){let vt=null;if(o.object instanceof qr&&o.object.isPerspectiveCamera){const dt=He.length();vt=Ee(dt*S);const ut=dt-vt;o.object.position.addScaledVector(X,ut),o.object.updateMatrixWorld()}else if(o.object.isOrthographicCamera){const dt=new Fe(te.x,te.y,0);dt.unproject(o.object),o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/S)),o.object.updateProjectionMatrix(),tt=!0;const ut=new Fe(te.x,te.y,0);ut.unproject(o.object),o.object.position.sub(ut).add(dt),o.object.updateMatrixWorld(),vt=He.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),o.zoomToCursor=!1;vt!==null&&(o.screenSpacePanning?o.target.set(0,0,-1).transformDirection(o.object.matrix).multiplyScalar(vt).add(o.object.position):(sA.origin.copy(o.object.position),sA.direction.set(0,0,-1).transformDirection(o.object.matrix),Math.abs(o.object.up.dot(sA.direction))<zAe?e.lookAt(o.target):(fG.setFromNormalAndCoplanarPoint(o.object.up,o.target),sA.intersectPlane(fG,o.target))))}else o.object instanceof Eh&&o.object.isOrthographicCamera&&(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/S)),o.object.updateProjectionMatrix(),tt=!0);return S=1,V=!1,tt||fn.distanceToSquared(o.object.position)>y||8*(1-_e.dot(o.object.quaternion))>y?(o.dispatchEvent(s),fn.copy(o.object.position),_e.copy(o.object.quaternion),tt=!1,!0):!1}})(),this.connect=He=>{He===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),o.domElement=He,o.domElement.style.touchAction="none",o.domElement.addEventListener("contextmenu",Vt),o.domElement.addEventListener("pointerdown",De),o.domElement.addEventListener("pointercancel",ne),o.domElement.addEventListener("wheel",ot)},this.dispose=()=>{var He,Lt,qt,Ot,fn,_e;(He=o.domElement)==null||He.removeEventListener("contextmenu",Vt),(Lt=o.domElement)==null||Lt.removeEventListener("pointerdown",De),(qt=o.domElement)==null||qt.removeEventListener("pointercancel",ne),(Ot=o.domElement)==null||Ot.removeEventListener("wheel",ot),(fn=o.domElement)==null||fn.ownerDocument.removeEventListener("pointermove",st),(_e=o.domElement)==null||_e.ownerDocument.removeEventListener("pointerup",de),o._domElementKeyEvents!==null&&o._domElementKeyEvents.removeEventListener("keydown",lt)};const o=this,s={type:"change"},c={type:"start"},d={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let m=f.NONE;const y=1e-6,_=new OR,x=new OR;let S=1;const T=new Fe,I=new Kt,k=new Kt,D=new Kt,L=new Kt,O=new Kt,F=new Kt,B=new Kt,G=new Kt,q=new Kt,X=new Fe,te=new Kt;let V=!1;const Q=[],ge={};function me(){return 2*Math.PI/60/60*o.autoRotateSpeed}function be(){return Math.pow(.95,o.zoomSpeed)}function fe(He){o.reverseOrbit||o.reverseHorizontalOrbit?x.theta+=He:x.theta-=He}function Ce(He){o.reverseOrbit||o.reverseVerticalOrbit?x.phi+=He:x.phi-=He}const Le=(()=>{const He=new Fe;return function(qt,Ot){He.setFromMatrixColumn(Ot,0),He.multiplyScalar(-qt),T.add(He)}})(),Ge=(()=>{const He=new Fe;return function(qt,Ot){o.screenSpacePanning===!0?He.setFromMatrixColumn(Ot,1):(He.setFromMatrixColumn(Ot,0),He.crossVectors(o.object.up,He)),He.multiplyScalar(qt),T.add(He)}})(),le=(()=>{const He=new Fe;return function(qt,Ot){const fn=o.domElement;if(fn&&o.object instanceof qr&&o.object.isPerspectiveCamera){const _e=o.object.position;He.copy(_e).sub(o.target);let Ye=He.length();Ye*=Math.tan(o.object.fov/2*Math.PI/180),Le(2*qt*Ye/fn.clientHeight,o.object.matrix),Ge(2*Ot*Ye/fn.clientHeight,o.object.matrix)}else fn&&o.object instanceof Eh&&o.object.isOrthographicCamera?(Le(qt*(o.object.right-o.object.left)/o.object.zoom/fn.clientWidth,o.object.matrix),Ge(Ot*(o.object.top-o.object.bottom)/o.object.zoom/fn.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}})();function pe(He){o.object instanceof qr&&o.object.isPerspectiveCamera||o.object instanceof Eh&&o.object.isOrthographicCamera?S/=He:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function Ae(He){o.object instanceof qr&&o.object.isPerspectiveCamera||o.object instanceof Eh&&o.object.isOrthographicCamera?S*=He:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function ae(He){if(!o.zoomToCursor||!o.domElement)return;V=!0;const Lt=o.domElement.getBoundingClientRect(),qt=He.clientX-Lt.left,Ot=He.clientY-Lt.top,fn=Lt.width,_e=Lt.height;te.x=qt/fn*2-1,te.y=-(Ot/_e)*2+1,X.set(te.x,te.y,1).unproject(o.object).sub(o.object.position).normalize()}function Ee(He){return Math.max(o.minDistance,Math.min(o.maxDistance,He))}function Ze(He){I.set(He.clientX,He.clientY)}function Xe(He){ae(He),B.set(He.clientX,He.clientY)}function Ke(He){L.set(He.clientX,He.clientY)}function Ue(He){k.set(He.clientX,He.clientY),D.subVectors(k,I).multiplyScalar(o.rotateSpeed);const Lt=o.domElement;Lt&&(fe(2*Math.PI*D.x/Lt.clientHeight),Ce(2*Math.PI*D.y/Lt.clientHeight)),I.copy(k),o.update()}function ft(He){G.set(He.clientX,He.clientY),q.subVectors(G,B),q.y>0?pe(be()):q.y<0&&Ae(be()),B.copy(G),o.update()}function Rt(He){O.set(He.clientX,He.clientY),F.subVectors(O,L).multiplyScalar(o.panSpeed),le(F.x,F.y),L.copy(O),o.update()}function kt(He){ae(He),He.deltaY<0?Ae(be()):He.deltaY>0&&pe(be()),o.update()}function Jt(He){let Lt=!1;switch(He.code){case o.keys.UP:le(0,o.keyPanSpeed),Lt=!0;break;case o.keys.BOTTOM:le(0,-o.keyPanSpeed),Lt=!0;break;case o.keys.LEFT:le(o.keyPanSpeed,0),Lt=!0;break;case o.keys.RIGHT:le(-o.keyPanSpeed,0),Lt=!0;break}Lt&&(He.preventDefault(),o.update())}function It(){if(Q.length==1)I.set(Q[0].pageX,Q[0].pageY);else{const He=.5*(Q[0].pageX+Q[1].pageX),Lt=.5*(Q[0].pageY+Q[1].pageY);I.set(He,Lt)}}function Pe(){if(Q.length==1)L.set(Q[0].pageX,Q[0].pageY);else{const He=.5*(Q[0].pageX+Q[1].pageX),Lt=.5*(Q[0].pageY+Q[1].pageY);L.set(He,Lt)}}function pt(){const He=Q[0].pageX-Q[1].pageX,Lt=Q[0].pageY-Q[1].pageY,qt=Math.sqrt(He*He+Lt*Lt);B.set(0,qt)}function yt(){o.enableZoom&&pt(),o.enablePan&&Pe()}function At(){o.enableZoom&&pt(),o.enableRotate&&It()}function Be(He){if(Q.length==1)k.set(He.pageX,He.pageY);else{const qt=Zt(He),Ot=.5*(He.pageX+qt.x),fn=.5*(He.pageY+qt.y);k.set(Ot,fn)}D.subVectors(k,I).multiplyScalar(o.rotateSpeed);const Lt=o.domElement;Lt&&(fe(2*Math.PI*D.x/Lt.clientHeight),Ce(2*Math.PI*D.y/Lt.clientHeight)),I.copy(k)}function ue(He){if(Q.length==1)O.set(He.pageX,He.pageY);else{const Lt=Zt(He),qt=.5*(He.pageX+Lt.x),Ot=.5*(He.pageY+Lt.y);O.set(qt,Ot)}F.subVectors(O,L).multiplyScalar(o.panSpeed),le(F.x,F.y),L.copy(O)}function se(He){const Lt=Zt(He),qt=He.pageX-Lt.x,Ot=He.pageY-Lt.y,fn=Math.sqrt(qt*qt+Ot*Ot);G.set(0,fn),q.set(0,Math.pow(G.y/B.y,o.zoomSpeed)),pe(q.y),B.copy(G)}function ve(He){o.enableZoom&&se(He),o.enablePan&&ue(He)}function $e(He){o.enableZoom&&se(He),o.enableRotate&&Be(He)}function De(He){var Lt,qt;o.enabled!==!1&&(Q.length===0&&((Lt=o.domElement)==null||Lt.ownerDocument.addEventListener("pointermove",st),(qt=o.domElement)==null||qt.ownerDocument.addEventListener("pointerup",de)),$t(He),He.pointerType==="touch"?Et(He):Oe(He))}function st(He){o.enabled!==!1&&(He.pointerType==="touch"?Ut(He):mt(He))}function de(He){var Lt,qt,Ot;Nt(He),Q.length===0&&((Lt=o.domElement)==null||Lt.releasePointerCapture(He.pointerId),(qt=o.domElement)==null||qt.ownerDocument.removeEventListener("pointermove",st),(Ot=o.domElement)==null||Ot.ownerDocument.removeEventListener("pointerup",de)),o.dispatchEvent(d),m=f.NONE}function ne(He){Nt(He)}function Oe(He){let Lt;switch(He.button){case 0:Lt=o.mouseButtons.LEFT;break;case 1:Lt=o.mouseButtons.MIDDLE;break;case 2:Lt=o.mouseButtons.RIGHT;break;default:Lt=-1}switch(Lt){case Zm.DOLLY:if(o.enableZoom===!1)return;Xe(He),m=f.DOLLY;break;case Zm.ROTATE:if(He.ctrlKey||He.metaKey||He.shiftKey){if(o.enablePan===!1)return;Ke(He),m=f.PAN}else{if(o.enableRotate===!1)return;Ze(He),m=f.ROTATE}break;case Zm.PAN:if(He.ctrlKey||He.metaKey||He.shiftKey){if(o.enableRotate===!1)return;Ze(He),m=f.ROTATE}else{if(o.enablePan===!1)return;Ke(He),m=f.PAN}break;default:m=f.NONE}m!==f.NONE&&o.dispatchEvent(c)}function mt(He){if(o.enabled!==!1)switch(m){case f.ROTATE:if(o.enableRotate===!1)return;Ue(He);break;case f.DOLLY:if(o.enableZoom===!1)return;ft(He);break;case f.PAN:if(o.enablePan===!1)return;Rt(He);break}}function ot(He){o.enabled===!1||o.enableZoom===!1||m!==f.NONE&&m!==f.ROTATE||(He.preventDefault(),o.dispatchEvent(c),kt(He),o.dispatchEvent(d))}function lt(He){o.enabled===!1||o.enablePan===!1||Jt(He)}function Et(He){switch(St(He),Q.length){case 1:switch(o.touches.ONE){case Km.ROTATE:if(o.enableRotate===!1)return;It(),m=f.TOUCH_ROTATE;break;case Km.PAN:if(o.enablePan===!1)return;Pe(),m=f.TOUCH_PAN;break;default:m=f.NONE}break;case 2:switch(o.touches.TWO){case Km.DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;yt(),m=f.TOUCH_DOLLY_PAN;break;case Km.DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;At(),m=f.TOUCH_DOLLY_ROTATE;break;default:m=f.NONE}break;default:m=f.NONE}m!==f.NONE&&o.dispatchEvent(c)}function Ut(He){switch(St(He),m){case f.TOUCH_ROTATE:if(o.enableRotate===!1)return;Be(He),o.update();break;case f.TOUCH_PAN:if(o.enablePan===!1)return;ue(He),o.update();break;case f.TOUCH_DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;ve(He),o.update();break;case f.TOUCH_DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;$e(He),o.update();break;default:m=f.NONE}}function Vt(He){o.enabled!==!1&&He.preventDefault()}function $t(He){Q.push(He)}function Nt(He){delete ge[He.pointerId];for(let Lt=0;Lt<Q.length;Lt++)if(Q[Lt].pointerId==He.pointerId){Q.splice(Lt,1);return}}function St(He){let Lt=ge[He.pointerId];Lt===void 0&&(Lt=new Kt,ge[He.pointerId]=Lt),Lt.set(He.pageX,He.pageY)}function Zt(He){const Lt=He.pointerId===Q[0].pointerId?Q[1]:Q[0];return ge[Lt.pointerId]}a!==void 0&&this.connect(a),this.update()}};function NAe(){var n=Object.create(null);function e(s,c){var d=s.id,f=s.name,m=s.dependencies;m===void 0&&(m=[]);var y=s.init;y===void 0&&(y=function(){});var _=s.getTransferables;if(_===void 0&&(_=null),!n[d])try{m=m.map(function(S){return S&&S.isWorkerModule&&(e(S,function(T){if(T instanceof Error)throw T}),S=n[S.id].value),S}),y=o("<"+f+">.init",y),_&&(_=o("<"+f+">.getTransferables",_));var x=null;typeof y=="function"?x=y.apply(void 0,m):console.error("worker module init function failed to rehydrate"),n[d]={id:d,value:x,getTransferables:_},c(x)}catch(S){S&&S.noLog||console.error(S),c(S)}}function a(s,c){var d,f=s.id,m=s.args;(!n[f]||typeof n[f].value!="function")&&c(new Error("Worker module "+f+": not found or its 'init' did not return a function"));try{var y=(d=n[f]).value.apply(d,m);y&&typeof y.then=="function"?y.then(_,function(x){return c(x instanceof Error?x:new Error(""+x))}):_(y)}catch(x){c(x)}function _(x){try{var S=n[f].getTransferables&&n[f].getTransferables(x);(!S||!Array.isArray(S)||!S.length)&&(S=void 0),c(x,S)}catch(T){console.error(T),c(T)}}}function o(s,c){var d=void 0;self.troikaDefine=function(m){return d=m};var f=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+c+`
)`],{type:"application/javascript"}));try{importScripts(f)}catch(m){console.error(m)}return URL.revokeObjectURL(f),delete self.troikaDefine,d}self.addEventListener("message",function(s){var c=s.data,d=c.messageId,f=c.action,m=c.data;try{f==="registerModule"&&e(m,function(y){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:{isCallable:typeof y=="function"}})}),f==="callModule"&&a(m,function(y,_){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:y},_||void 0)})}catch(y){postMessage({messageId:d,success:!1,error:y.stack})}})}function BAe(n){var e=function(){for(var a=[],o=arguments.length;o--;)a[o]=arguments[o];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,a);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var a=n.dependencies,o=n.init;a=Array.isArray(a)?a.map(function(c){return c&&c._getInitResult?c._getInitResult():c}):[];var s=Promise.all(a).then(function(c){return o.apply(null,c)});return e._getInitResult=function(){return s},s},e}var GK=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(a){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+a.message+"]")}return GK=function(){return n},n},UAe=0,WAe=0,mI=!1,rx=Object.create(null),ox=Object.create(null),$R=Object.create(null);function Hw(n){if((!n||typeof n.init!="function")&&!mI)throw new Error("requires `options.init` function");var e=n.dependencies,a=n.init,o=n.getTransferables,s=n.workerId;if(!GK())return BAe(n);s==null&&(s="#default");var c="workerModule"+ ++UAe,d=n.name||c,f=null;e=e&&e.map(function(y){return typeof y=="function"&&!y.workerModuleData&&(mI=!0,y=Hw({workerId:s,name:"<"+d+"> function dependency: "+y.name,init:`function(){return (
`+nE(y)+`
)}`}),mI=!1),y&&y.workerModuleData&&(y=y.workerModuleData),y});function m(){for(var y=[],_=arguments.length;_--;)y[_]=arguments[_];if(!f){f=mG(s,"registerModule",m.workerModuleData);var x=function(){f=null,ox[s].delete(x)};(ox[s]||(ox[s]=new Set)).add(x)}return f.then(function(S){var T=S.isCallable;if(T)return mG(s,"callModule",{id:c,args:y});throw new Error("Worker module function was called but `init` did not return a callable function")})}return m.workerModuleData={isWorkerModule:!0,id:c,name:d,dependencies:e,init:nE(a),getTransferables:o&&nE(o)},m}function VAe(n){ox[n]&&ox[n].forEach(function(e){e()}),rx[n]&&(rx[n].terminate(),delete rx[n])}function nE(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function GAe(n){var e=rx[n];if(!e){var a=nE(NAe);e=rx[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+a+")()"],{type:"application/javascript"}))),e.onmessage=function(o){var s=o.data,c=s.messageId,d=$R[c];if(!d)throw new Error("WorkerModule response with empty or unknown messageId");delete $R[c],d(s)}}return e}function mG(n,e,a){return new Promise(function(o,s){var c=++WAe;$R[c]=function(d){d.success?o(d.result):s(new Error("Error in worker "+e+" call: "+d.error))},GAe(n).postMessage({messageId:c,action:e,data:a})})}function HK(){var n=function(e){function a(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue){var ft=1-Ke;Ue.x=ft*ft*pe+2*ft*Ke*ae+Ke*Ke*Ze,Ue.y=ft*ft*Ae+2*ft*Ke*Ee+Ke*Ke*Xe}function o(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt){var kt=1-ft;Rt.x=kt*kt*kt*pe+3*kt*kt*ft*ae+3*kt*ft*ft*Ze+ft*ft*ft*Ke,Rt.y=kt*kt*kt*Ae+3*kt*kt*ft*Ee+3*kt*ft*ft*Xe+ft*ft*ft*Ue}function s(pe,Ae){for(var ae=/([MLQCZ])([^MLQCZ]*)/g,Ee,Ze,Xe,Ke,Ue;Ee=ae.exec(pe);){var ft=Ee[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Rt){return parseFloat(Rt)});switch(Ee[1]){case"M":Ke=Ze=ft[0],Ue=Xe=ft[1];break;case"L":(ft[0]!==Ke||ft[1]!==Ue)&&Ae("L",Ke,Ue,Ke=ft[0],Ue=ft[1]);break;case"Q":{Ae("Q",Ke,Ue,Ke=ft[2],Ue=ft[3],ft[0],ft[1]);break}case"C":{Ae("C",Ke,Ue,Ke=ft[4],Ue=ft[5],ft[0],ft[1],ft[2],ft[3]);break}case"Z":(Ke!==Ze||Ue!==Xe)&&Ae("L",Ke,Ue,Ze,Xe);break}}}function c(pe,Ae,ae){ae===void 0&&(ae=16);var Ee={x:0,y:0};s(pe,function(Ze,Xe,Ke,Ue,ft,Rt,kt,Jt,It){switch(Ze){case"L":Ae(Xe,Ke,Ue,ft);break;case"Q":{for(var Pe=Xe,pt=Ke,yt=1;yt<ae;yt++)a(Xe,Ke,Rt,kt,Ue,ft,yt/(ae-1),Ee),Ae(Pe,pt,Ee.x,Ee.y),Pe=Ee.x,pt=Ee.y;break}case"C":{for(var At=Xe,Be=Ke,ue=1;ue<ae;ue++)o(Xe,Ke,Rt,kt,Jt,It,Ue,ft,ue/(ae-1),Ee),Ae(At,Be,Ee.x,Ee.y),At=Ee.x,Be=Ee.y;break}}})}var d="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",f="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",m=new WeakMap,y={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function _(pe,Ae){var ae=pe.getContext?pe.getContext("webgl",y):pe,Ee=m.get(ae);if(!Ee){let At=function(De){var st=Xe[De];if(!st&&(st=Xe[De]=ae.getExtension(De),!st))throw new Error(De+" not supported");return st},Be=function(De,st){var de=ae.createShader(st);return ae.shaderSource(de,De),ae.compileShader(de),de},ue=function(De,st,de,ne){if(!Ke[De]){var Oe={},mt={},ot=ae.createProgram();ae.attachShader(ot,Be(st,ae.VERTEX_SHADER)),ae.attachShader(ot,Be(de,ae.FRAGMENT_SHADER)),ae.linkProgram(ot),Ke[De]={program:ot,transaction:function(Et){ae.useProgram(ot),Et({setUniform:function(Vt,$t){for(var Nt=[],St=arguments.length-2;St-- >0;)Nt[St]=arguments[St+2];var Zt=mt[$t]||(mt[$t]=ae.getUniformLocation(ot,$t));ae["uniform"+Vt].apply(ae,[Zt].concat(Nt))},setAttribute:function(Vt,$t,Nt,St,Zt){var He=Oe[Vt];He||(He=Oe[Vt]={buf:ae.createBuffer(),loc:ae.getAttribLocation(ot,Vt),data:null}),ae.bindBuffer(ae.ARRAY_BUFFER,He.buf),ae.vertexAttribPointer(He.loc,$t,ae.FLOAT,!1,0,0),ae.enableVertexAttribArray(He.loc),Ze?ae.vertexAttribDivisor(He.loc,St):At("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(He.loc,St),Zt!==He.data&&(ae.bufferData(ae.ARRAY_BUFFER,Zt,Nt),He.data=Zt)}})}}}Ke[De].transaction(ne)},se=function(De,st){ft++;try{ae.activeTexture(ae.TEXTURE0+ft);var de=Ue[De];de||(de=Ue[De]=ae.createTexture(),ae.bindTexture(ae.TEXTURE_2D,de),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.NEAREST),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.NEAREST)),ae.bindTexture(ae.TEXTURE_2D,de),st(de,ft)}finally{ft--}},ve=function(De,st,de){var ne=ae.createFramebuffer();Rt.push(ne),ae.bindFramebuffer(ae.FRAMEBUFFER,ne),ae.activeTexture(ae.TEXTURE0+st),ae.bindTexture(ae.TEXTURE_2D,De),ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,De,0);try{de(ne)}finally{ae.deleteFramebuffer(ne),ae.bindFramebuffer(ae.FRAMEBUFFER,Rt[--Rt.length-1]||null)}},$e=function(){Xe={},Ke={},Ue={},ft=-1,Rt.length=0};var kt=At,Jt=Be,It=ue,Pe=se,pt=ve,yt=$e,Ze=typeof WebGL2RenderingContext<"u"&&ae instanceof WebGL2RenderingContext,Xe={},Ke={},Ue={},ft=-1,Rt=[];ae.canvas.addEventListener("webglcontextlost",function(De){$e(),De.preventDefault()},!1),m.set(ae,Ee={gl:ae,isWebGL2:Ze,getExtension:At,withProgram:ue,withTexture:se,withTextureFramebuffer:ve,handleContextLoss:$e})}Ae(Ee)}function x(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue){Ke===void 0&&(Ke=15),Ue===void 0&&(Ue=null),_(pe,function(ft){var Rt=ft.gl,kt=ft.withProgram,Jt=ft.withTexture;Jt("copy",function(It,Pe){Rt.texImage2D(Rt.TEXTURE_2D,0,Rt.RGBA,Ze,Xe,0,Rt.RGBA,Rt.UNSIGNED_BYTE,Ae),kt("copy",d,f,function(pt){var yt=pt.setUniform,At=pt.setAttribute;At("aUV",2,Rt.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),yt("1i","image",Pe),Rt.bindFramebuffer(Rt.FRAMEBUFFER,Ue||null),Rt.disable(Rt.BLEND),Rt.colorMask(Ke&8,Ke&4,Ke&2,Ke&1),Rt.viewport(ae,Ee,Ze,Xe),Rt.scissor(ae,Ee,Ze,Xe),Rt.drawArrays(Rt.TRIANGLES,0,3)})})})}function S(pe,Ae,ae){var Ee=pe.width,Ze=pe.height;_(pe,function(Xe){var Ke=Xe.gl,Ue=new Uint8Array(Ee*Ze*4);Ke.readPixels(0,0,Ee,Ze,Ke.RGBA,Ke.UNSIGNED_BYTE,Ue),pe.width=Ae,pe.height=ae,x(Ke,Ue,0,0,Ee,Ze)})}var T=Object.freeze({__proto__:null,withWebGLContext:_,renderImageData:x,resizeWebGLCanvasWithoutClearing:S});function I(pe,Ae,ae,Ee,Ze,Xe){Xe===void 0&&(Xe=1);var Ke=new Uint8Array(pe*Ae),Ue=Ee[2]-Ee[0],ft=Ee[3]-Ee[1],Rt=[];c(ae,function(At,Be,ue,se){Rt.push({x1:At,y1:Be,x2:ue,y2:se,minX:Math.min(At,ue),minY:Math.min(Be,se),maxX:Math.max(At,ue),maxY:Math.max(Be,se)})}),Rt.sort(function(At,Be){return At.maxX-Be.maxX});for(var kt=0;kt<pe;kt++)for(var Jt=0;Jt<Ae;Jt++){var It=pt(Ee[0]+Ue*(kt+.5)/pe,Ee[1]+ft*(Jt+.5)/Ae),Pe=Math.pow(1-Math.abs(It)/Ze,Xe)/2;It<0&&(Pe=1-Pe),Pe=Math.max(0,Math.min(255,Math.round(Pe*255))),Ke[Jt*pe+kt]=Pe}return Ke;function pt(At,Be){for(var ue=1/0,se=1/0,ve=Rt.length;ve--;){var $e=Rt[ve];if($e.maxX+se<=At)break;if(At+se>$e.minX&&Be-se<$e.maxY&&Be+se>$e.minY){var De=L(At,Be,$e.x1,$e.y1,$e.x2,$e.y2);De<ue&&(ue=De,se=Math.sqrt(ue))}}return yt(At,Be)&&(se=-se),se}function yt(At,Be){for(var ue=0,se=Rt.length;se--;){var ve=Rt[se];if(ve.maxX<=At)break;var $e=ve.y1>Be!=ve.y2>Be&&At<(ve.x2-ve.x1)*(Be-ve.y1)/(ve.y2-ve.y1)+ve.x1;$e&&(ue+=ve.y1<ve.y2?1:-1)}return ue!==0}}function k(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt){Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ft===void 0&&(ft=0),Rt===void 0&&(Rt=0),D(pe,Ae,ae,Ee,Ze,Xe,Ke,null,Ue,ft,Rt)}function D(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt,kt){Xe===void 0&&(Xe=1),ft===void 0&&(ft=0),Rt===void 0&&(Rt=0),kt===void 0&&(kt=0);for(var Jt=I(pe,Ae,ae,Ee,Ze,Xe),It=new Uint8Array(Jt.length*4),Pe=0;Pe<Jt.length;Pe++)It[Pe*4+kt]=Jt[Pe];x(Ke,It,ft,Rt,pe,Ae,1<<3-kt,Ue)}function L(pe,Ae,ae,Ee,Ze,Xe){var Ke=Ze-ae,Ue=Xe-Ee,ft=Ke*Ke+Ue*Ue,Rt=ft?Math.max(0,Math.min(1,((pe-ae)*Ke+(Ae-Ee)*Ue)/ft)):0,kt=pe-(ae+Rt*Ke),Jt=Ae-(Ee+Rt*Ue);return kt*kt+Jt*Jt}var O=Object.freeze({__proto__:null,generate:I,generateIntoCanvas:k,generateIntoFramebuffer:D}),F="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",B="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",G="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",q=new Float32Array([0,0,2,0,0,2]),X=null,te=!1,V={},Q=new WeakMap;function ge(pe){if(!te&&!Ce(pe))throw new Error("WebGL generation not supported")}function me(pe,Ae,ae,Ee,Ze,Xe,Ke){if(Xe===void 0&&(Xe=1),Ke===void 0&&(Ke=null),!Ke&&(Ke=X,!Ke)){var Ue=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Ue)throw new Error("OffscreenCanvas or DOM canvas not supported");Ke=X=Ue.getContext("webgl",{depth:!1})}ge(Ke);var ft=new Uint8Array(pe*Ae*4);_(Ke,function(It){var Pe=It.gl,pt=It.withTexture,yt=It.withTextureFramebuffer;pt("readable",function(At,Be){Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,pe,Ae,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),yt(At,Be,function(ue){fe(pe,Ae,ae,Ee,Ze,Xe,Pe,ue,0,0,0),Pe.readPixels(0,0,pe,Ae,Pe.RGBA,Pe.UNSIGNED_BYTE,ft)})})});for(var Rt=new Uint8Array(pe*Ae),kt=0,Jt=0;kt<ft.length;kt+=4)Rt[Jt++]=ft[kt];return Rt}function be(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt){Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ft===void 0&&(ft=0),Rt===void 0&&(Rt=0),fe(pe,Ae,ae,Ee,Ze,Xe,Ke,null,Ue,ft,Rt)}function fe(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt,kt){Xe===void 0&&(Xe=1),ft===void 0&&(ft=0),Rt===void 0&&(Rt=0),kt===void 0&&(kt=0),ge(Ke);var Jt=[];c(ae,function(It,Pe,pt,yt){Jt.push(It,Pe,pt,yt)}),Jt=new Float32Array(Jt),_(Ke,function(It){var Pe=It.gl,pt=It.isWebGL2,yt=It.getExtension,At=It.withProgram,Be=It.withTexture,ue=It.withTextureFramebuffer,se=It.handleContextLoss;if(Be("rawDistances",function(ve,$e){(pe!==ve._lastWidth||Ae!==ve._lastHeight)&&Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,ve._lastWidth=pe,ve._lastHeight=Ae,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),At("main",F,B,function(De){var st=De.setAttribute,de=De.setUniform,ne=!pt&&yt("ANGLE_instanced_arrays"),Oe=!pt&&yt("EXT_blend_minmax");st("aUV",2,Pe.STATIC_DRAW,0,q),st("aLineSegment",4,Pe.DYNAMIC_DRAW,1,Jt),de.apply(void 0,["4f","uGlyphBounds"].concat(Ee)),de("1f","uMaxDistance",Ze),de("1f","uExponent",Xe),ue(ve,$e,function(mt){Pe.enable(Pe.BLEND),Pe.colorMask(!0,!0,!0,!0),Pe.viewport(0,0,pe,Ae),Pe.scissor(0,0,pe,Ae),Pe.blendFunc(Pe.ONE,Pe.ONE),Pe.blendEquationSeparate(Pe.FUNC_ADD,pt?Pe.MAX:Oe.MAX_EXT),Pe.clear(Pe.COLOR_BUFFER_BIT),pt?Pe.drawArraysInstanced(Pe.TRIANGLES,0,3,Jt.length/4):ne.drawArraysInstancedANGLE(Pe.TRIANGLES,0,3,Jt.length/4)})}),At("post",d,G,function(De){De.setAttribute("aUV",2,Pe.STATIC_DRAW,0,q),De.setUniform("1i","tex",$e),Pe.bindFramebuffer(Pe.FRAMEBUFFER,Ue),Pe.disable(Pe.BLEND),Pe.colorMask(kt===0,kt===1,kt===2,kt===3),Pe.viewport(ft,Rt,pe,Ae),Pe.scissor(ft,Rt,pe,Ae),Pe.drawArrays(Pe.TRIANGLES,0,3)})}),Pe.isContextLost())throw se(),new Error("webgl context lost")})}function Ce(pe){var Ae=!pe||pe===X?V:pe.canvas||pe,ae=Q.get(Ae);if(ae===void 0){te=!0;var Ee=null;try{var Ze=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Xe=me(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,pe);ae=Xe&&Ze.length===Xe.length&&Xe.every(function(Ke,Ue){return Ke===Ze[Ue]}),ae||(Ee="bad trial run results",console.info(Ze,Xe))}catch(Ke){ae=!1,Ee=Ke.message}Ee&&console.warn("WebGL SDF generation not supported:",Ee),te=!1,Q.set(Ae,ae)}return ae}var Le=Object.freeze({__proto__:null,generate:me,generateIntoCanvas:be,generateIntoFramebuffer:fe,isSupported:Ce});function Ge(pe,Ae,ae,Ee,Ze,Xe){Ze===void 0&&(Ze=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Xe===void 0&&(Xe=1);try{return me.apply(Le,arguments)}catch(Ke){return console.info("WebGL SDF generation failed, falling back to JS",Ke),I.apply(O,arguments)}}function le(pe,Ae,ae,Ee,Ze,Xe,Ke,Ue,ft,Rt){Ze===void 0&&(Ze=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Xe===void 0&&(Xe=1),Ue===void 0&&(Ue=0),ft===void 0&&(ft=0),Rt===void 0&&(Rt=0);try{return be.apply(Le,arguments)}catch(kt){return console.info("WebGL SDF generation failed, falling back to JS",kt),k.apply(O,arguments)}}return e.forEachPathCommand=s,e.generate=Ge,e.generateIntoCanvas=le,e.javascript=O,e.pathToLineSegments=c,e.webgl=Le,e.webglUtils=T,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function HAe(){var n=function(e){var a={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},o={},s={};o.L=1,s[1]="L",Object.keys(a).forEach(function(se,ve){o[se]=1<<ve+1,s[o[se]]=se}),Object.freeze(o);var c=o.LRI|o.RLI|o.FSI,d=o.L|o.R|o.AL,f=o.B|o.S|o.WS|o.ON|o.FSI|o.LRI|o.RLI|o.PDI,m=o.BN|o.RLE|o.LRE|o.RLO|o.LRO|o.PDF,y=o.S|o.WS|o.B|c|o.PDI|m,_=null;function x(){if(!_){_=new Map;var se=function($e){if(a.hasOwnProperty($e)){var De=0;a[$e].split(",").forEach(function(st){var de=st.split("+"),ne=de[0],Oe=de[1];ne=parseInt(ne,36),Oe=Oe?parseInt(Oe,36):0,_.set(De+=ne,o[$e]);for(var mt=0;mt<Oe;mt++)_.set(++De,o[$e])})}};for(var ve in a)se(ve)}}function S(se){return x(),_.get(se.codePointAt(0))||o.L}function T(se){return s[S(se)]}var I={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function k(se,ve){var $e=36,De=0,st=new Map,de=ve&&new Map,ne;return se.split(",").forEach(function Oe(mt){if(mt.indexOf("+")!==-1)for(var ot=+mt;ot--;)Oe(ne);else{ne=mt;var lt=mt.split(">"),Et=lt[0],Ut=lt[1];Et=String.fromCodePoint(De+=parseInt(Et,$e)),Ut=String.fromCodePoint(De+=parseInt(Ut,$e)),st.set(Et,Ut),ve&&de.set(Ut,Et)}}),{map:st,reverseMap:de}}var D,L,O;function F(){if(!D){var se=k(I.pairs,!0),ve=se.map,$e=se.reverseMap;D=ve,L=$e,O=k(I.canonical,!1).map}}function B(se){return F(),D.get(se)||null}function G(se){return F(),L.get(se)||null}function q(se){return F(),O.get(se)||null}var X=o.L,te=o.R,V=o.EN,Q=o.ES,ge=o.ET,me=o.AN,be=o.CS,fe=o.B,Ce=o.S,Le=o.ON,Ge=o.BN,le=o.NSM,pe=o.AL,Ae=o.LRO,ae=o.RLO,Ee=o.LRE,Ze=o.RLE,Xe=o.PDF,Ke=o.LRI,Ue=o.RLI,ft=o.FSI,Rt=o.PDI;function kt(se,ve){for(var $e=125,De=new Uint32Array(se.length),st=0;st<se.length;st++)De[st]=S(se[st]);var de=new Map;function ne(Nr,Ti){var xn=De[Nr];De[Nr]=Ti,de.set(xn,de.get(xn)-1),xn&f&&de.set(f,de.get(f)-1),de.set(Ti,(de.get(Ti)||0)+1),Ti&f&&de.set(f,(de.get(f)||0)+1)}for(var Oe=new Uint8Array(se.length),mt=new Map,ot=[],lt=null,Et=0;Et<se.length;Et++)lt||ot.push(lt={start:Et,end:se.length-1,level:ve==="rtl"?1:ve==="ltr"?0:xu(Et,!1)}),De[Et]&fe&&(lt.end=Et,lt=null);for(var Ut=Ze|Ee|ae|Ae|c|Rt|Xe|fe,Vt=function(Nr){return Nr+(Nr&1?1:2)},$t=function(Nr){return Nr+(Nr&1?2:1)},Nt=0;Nt<ot.length;Nt++){lt=ot[Nt];var St=[{_level:lt.level,_override:0,_isolate:0}],Zt=void 0,He=0,Lt=0,qt=0;de.clear();for(var Ot=lt.start;Ot<=lt.end;Ot++){var fn=De[Ot];if(Zt=St[St.length-1],de.set(fn,(de.get(fn)||0)+1),fn&f&&de.set(f,(de.get(f)||0)+1),fn&Ut)if(fn&(Ze|Ee)){Oe[Ot]=Zt._level;var _e=(fn===Ze?$t:Vt)(Zt._level);_e<=$e&&!He&&!Lt?St.push({_level:_e,_override:0,_isolate:0}):He||Lt++}else if(fn&(ae|Ae)){Oe[Ot]=Zt._level;var Ye=(fn===ae?$t:Vt)(Zt._level);Ye<=$e&&!He&&!Lt?St.push({_level:Ye,_override:fn&ae?te:X,_isolate:0}):He||Lt++}else if(fn&c){fn&ft&&(fn=xu(Ot+1,!0)===1?Ue:Ke),Oe[Ot]=Zt._level,Zt._override&&ne(Ot,Zt._override);var Se=(fn===Ue?$t:Vt)(Zt._level);Se<=$e&&He===0&&Lt===0?(qt++,St.push({_level:Se,_override:0,_isolate:1,_isolInitIndex:Ot})):He++}else if(fn&Rt){if(He>0)He--;else if(qt>0){for(Lt=0;!St[St.length-1]._isolate;)St.pop();var Me=St[St.length-1]._isolInitIndex;Me!=null&&(mt.set(Me,Ot),mt.set(Ot,Me)),St.pop(),qt--}Zt=St[St.length-1],Oe[Ot]=Zt._level,Zt._override&&ne(Ot,Zt._override)}else fn&Xe?(He===0&&(Lt>0?Lt--:!Zt._isolate&&St.length>1&&(St.pop(),Zt=St[St.length-1])),Oe[Ot]=Zt._level):fn&fe&&(Oe[Ot]=lt.level);else Oe[Ot]=Zt._level,Zt._override&&fn!==Ge&&ne(Ot,Zt._override)}for(var ze=[],Qe=null,tt=lt.start;tt<=lt.end;tt++){var vt=De[tt];if(!(vt&m)){var dt=Oe[tt],ut=vt&c,Gt=vt===Rt;Qe&&dt===Qe._level?(Qe._end=tt,Qe._endsWithIsolInit=ut):ze.push(Qe={_start:tt,_end:tt,_level:dt,_startsWithPDI:Gt,_endsWithIsolInit:ut})}}for(var Tt=[],Qt=0;Qt<ze.length;Qt++){var mn=ze[Qt];if(!mn._startsWithPDI||mn._startsWithPDI&&!mt.has(mn._start)){for(var nn=[Qe=mn],wn=void 0;Qe&&Qe._endsWithIsolInit&&(wn=mt.get(Qe._end))!=null;)for(var Hn=Qt+1;Hn<ze.length;Hn++)if(ze[Hn]._start===wn){nn.push(Qe=ze[Hn]);break}for(var fa=[],Pa=0;Pa<nn.length;Pa++)for(var Ta=nn[Pa],Li=Ta._start;Li<=Ta._end;Li++)fa.push(Li);for(var mi=Oe[fa[0]],Re=lt.level,bt=fa[0]-1;bt>=0;bt--)if(!(De[bt]&m)){Re=Oe[bt];break}var Dt=fa[fa.length-1],Ct=Oe[Dt],zt=lt.level;if(!(De[Dt]&c)){for(var ln=Dt+1;ln<=lt.end;ln++)if(!(De[ln]&m)){zt=Oe[ln];break}}Tt.push({_seqIndices:fa,_sosType:Math.max(Re,mi)%2?te:X,_eosType:Math.max(zt,Ct)%2?te:X})}}for(var Tn=0;Tn<Tt.length;Tn++){var qn=Tt[Tn],an=qn._seqIndices,sa=qn._sosType,pa=qn._eosType,ia=Oe[an[0]]&1?te:X;if(de.get(le))for(var ai=0;ai<an.length;ai++){var xr=an[ai];if(De[xr]&le){for(var ti=sa,Yi=ai-1;Yi>=0;Yi--)if(!(De[an[Yi]]&m)){ti=De[an[Yi]];break}ne(xr,ti&(c|Rt)?Le:ti)}}if(de.get(V))for(var ta=0;ta<an.length;ta++){var Rn=an[ta];if(De[Rn]&V)for(var ho=ta-1;ho>=-1;ho--){var Ra=ho===-1?sa:De[an[ho]];if(Ra&d){Ra===pe&&ne(Rn,me);break}}}if(de.get(pe))for(var Mi=0;Mi<an.length;Mi++){var Ho=an[Mi];De[Ho]&pe&&ne(Ho,te)}if(de.get(Q)||de.get(be))for(var wr=1;wr<an.length-1;wr++){var Zi=an[wr];if(De[Zi]&(Q|be)){for(var ui=0,zr=0,Cn=wr-1;Cn>=0&&(ui=De[an[Cn]],!!(ui&m));Cn--);for(var Zn=wr+1;Zn<an.length&&(zr=De[an[Zn]],!!(zr&m));Zn++);ui===zr&&(De[Zi]===Q?ui===V:ui&(V|me))&&ne(Zi,ui)}}if(de.get(V))for(var Gi=0;Gi<an.length;Gi++){var Sr=an[Gi];if(De[Sr]&V){for(var Ts=Gi-1;Ts>=0&&De[an[Ts]]&(ge|m);Ts--)ne(an[Ts],V);for(Gi++;Gi<an.length&&De[an[Gi]]&(ge|m|V);Gi++)De[an[Gi]]!==V&&ne(an[Gi],V)}}if(de.get(ge)||de.get(Q)||de.get(be))for(var _u=0;_u<an.length;_u++){var Lp=an[_u];if(De[Lp]&(ge|Q|be)){ne(Lp,Le);for(var tc=_u-1;tc>=0&&De[an[tc]]&m;tc--)ne(an[tc],Le);for(var Tl=_u+1;Tl<an.length&&De[an[Tl]]&m;Tl++)ne(an[Tl],Le)}}if(de.get(V))for(var Cl=0,Pl=sa;Cl<an.length;Cl++){var Sd=an[Cl],jh=De[Sd];jh&V?Pl===X&&ne(Sd,X):jh&d&&(Pl=jh)}if(de.get(f)){var nc=te|V|me,Ad=nc|X,Xs=[];{for(var Ht=[],vn=0;vn<an.length;vn++)if(De[an[vn]]&f){var Bn=se[an[vn]],nt=void 0;if(B(Bn)!==null)if(Ht.length<63)Ht.push({char:Bn,seqIndex:vn});else break;else if((nt=G(Bn))!==null)for(var sn=Ht.length-1;sn>=0;sn--){var Ys=Ht[sn].char;if(Ys===nt||Ys===G(q(Bn))||B(q(Ys))===Bn){Xs.push([Ht[sn].seqIndex,vn]),Ht.length=sn;break}}}Xs.sort(function(Nr,Ti){return Nr[0]-Ti[0]})}for(var Cs=0;Cs<Xs.length;Cs++){for(var Wi=Xs[Cs],ii=Wi[0],Ed=Wi[1],Ps=!1,Ao=0,Rp=ii+1;Rp<Ed;Rp++){var Zs=an[Rp];if(De[Zs]&Ad){Ps=!0;var tn=De[Zs]&nc?te:X;if(tn===ia){Ao=tn;break}}}if(Ps&&!Ao){Ao=sa;for(var ma=ii-1;ma>=0;ma--){var wa=an[ma];if(De[wa]&Ad){var Ki=De[wa]&nc?te:X;Ki!==ia?Ao=Ki:Ao=ia;break}}}if(Ao){if(De[an[ii]]=De[an[Ed]]=Ao,Ao!==ia){for(var Fr=ii+1;Fr<an.length;Fr++)if(!(De[an[Fr]]&m)){S(se[an[Fr]])&le&&(De[an[Fr]]=Ao);break}}if(Ao!==ia){for(var na=Ed+1;na<an.length;na++)if(!(De[an[na]]&m)){S(se[an[na]])&le&&(De[an[na]]=Ao);break}}}}for(var jo=0;jo<an.length;jo++)if(De[an[jo]]&f){for(var Ic=jo,Lc=jo,Ri=sa,di=jo-1;di>=0;di--)if(De[an[di]]&m)Ic=di;else{Ri=De[an[di]]&nc?te:X;break}for(var Md=pa,Il=jo+1;Il<an.length;Il++)if(De[an[Il]]&(f|m))Lc=Il;else{Md=De[an[Il]]&nc?te:X;break}for(var Eo=Ic;Eo<=Lc;Eo++)De[an[Eo]]=Ri===Md?Ri:ia;jo=Lc}}}for(var fr=lt.start;fr<=lt.end;fr++){var bu=Oe[fr],Ks=De[fr];if(bu&1?Ks&(X|V|me)&&Oe[fr]++:Ks&te?Oe[fr]++:Ks&(me|V)&&(Oe[fr]+=2),Ks&m&&(Oe[fr]=fr===0?lt.level:Oe[fr-1]),fr===lt.end||S(se[fr])&(Ce|fe))for(var Ll=fr;Ll>=0&&S(se[Ll])&y;Ll--)Oe[Ll]=lt.level}}return{levels:Oe,paragraphs:ot};function xu(Nr,Ti){for(var xn=Nr;xn<se.length;xn++){var ar=De[xn];if(ar&(te|pe))return 1;if(ar&(fe|X)||Ti&&ar===Rt)return 0;if(ar&c){var $o=Td(xn);xn=$o===-1?se.length:$o}}return 0}function Td(Nr){for(var Ti=1,xn=Nr+1;xn<se.length;xn++){var ar=De[xn];if(ar&fe)break;if(ar&Rt){if(--Ti===0)return xn}else ar&c&&Ti++}return-1}}var Jt="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",It;function Pe(){if(!It){var se=k(Jt,!0),ve=se.map,$e=se.reverseMap;$e.forEach(function(De,st){ve.set(st,De)}),It=ve}}function pt(se){return Pe(),It.get(se)||null}function yt(se,ve,$e,De){var st=se.length;$e=Math.max(0,$e==null?0:+$e),De=Math.min(st-1,De==null?st-1:+De);for(var de=new Map,ne=$e;ne<=De;ne++)if(ve[ne]&1){var Oe=pt(se[ne]);Oe!==null&&de.set(ne,Oe)}return de}function At(se,ve,$e,De){var st=se.length;$e=Math.max(0,$e==null?0:+$e),De=Math.min(st-1,De==null?st-1:+De);var de=[];return ve.paragraphs.forEach(function(ne){var Oe=Math.max($e,ne.start),mt=Math.min(De,ne.end);if(Oe<mt){for(var ot=ve.levels.slice(Oe,mt+1),lt=mt;lt>=Oe&&S(se[lt])&y;lt--)ot[lt]=ne.level;for(var Et=ne.level,Ut=1/0,Vt=0;Vt<ot.length;Vt++){var $t=ot[Vt];$t>Et&&(Et=$t),$t<Ut&&(Ut=$t|1)}for(var Nt=Et;Nt>=Ut;Nt--)for(var St=0;St<ot.length;St++)if(ot[St]>=Nt){for(var Zt=St;St+1<ot.length&&ot[St+1]>=Nt;)St++;St>Zt&&de.push([Zt+Oe,St+Oe])}}}),de}function Be(se,ve,$e,De){var st=ue(se,ve,$e,De),de=[].concat(se);return st.forEach(function(ne,Oe){de[Oe]=(ve.levels[ne]&1?pt(se[ne]):null)||se[ne]}),de.join("")}function ue(se,ve,$e,De){for(var st=At(se,ve,$e,De),de=[],ne=0;ne<se.length;ne++)de[ne]=ne;return st.forEach(function(Oe){for(var mt=Oe[0],ot=Oe[1],lt=de.slice(mt,ot+1),Et=lt.length;Et--;)de[ot-Et]=lt[Et]}),de}return e.closingToOpeningBracket=G,e.getBidiCharType=S,e.getBidiCharTypeName=T,e.getCanonicalBracket=q,e.getEmbeddingLevels=kt,e.getMirroredCharacter=pt,e.getMirroredCharactersMap=yt,e.getReorderSegments=At,e.getReorderedIndices=ue,e.getReorderedString=Be,e.openingToClosingBracket=B,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const jK=/\bvoid\s+main\s*\(\s*\)\s*{/g;function qR(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function a(o,s){let c=Oa[s];return c?qR(c):o}return n.replace(e,a)}const Zo=[];for(let n=0;n<256;n++)Zo[n]=(n<16?"0":"")+n.toString(16);function jAe(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(Zo[n&255]+Zo[n>>8&255]+Zo[n>>16&255]+Zo[n>>24&255]+"-"+Zo[e&255]+Zo[e>>8&255]+"-"+Zo[e>>16&15|64]+Zo[e>>24&255]+"-"+Zo[a&63|128]+Zo[a>>8&255]+"-"+Zo[a>>16&255]+Zo[a>>24&255]+Zo[o&255]+Zo[o>>8&255]+Zo[o>>16&255]+Zo[o>>24&255]).toUpperCase()}const Wm=Object.assign||function(){let n=arguments[0];for(let e=1,a=arguments.length;e<a;e++){let o=arguments[e];if(o)for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n},$Ae=Date.now(),gG=new WeakMap,yG=new Map;let qAe=1e10;function XR(n,e){const a=KAe(e);let o=gG.get(n);if(o||gG.set(n,o=Object.create(null)),o[a])return new o[a];const s=`_onBeforeCompile${a}`,c=function(y,_){n.onBeforeCompile.call(this,y,_);const x=this.customProgramCacheKey()+"|"+y.vertexShader+"|"+y.fragmentShader;let S=yG[x];if(!S){const T=XAe(this,y,e,a);S=yG[x]=T}y.vertexShader=S.vertexShader,y.fragmentShader=S.fragmentShader,Wm(y.uniforms,this.uniforms),e.timeUniform&&(y.uniforms[e.timeUniform]={get value(){return Date.now()-$Ae}}),this[s]&&this[s](y)},d=function(){return f(e.chained?n:n.clone())},f=function(y){const _=Object.create(y,m);return Object.defineProperty(_,"baseMaterial",{value:n}),Object.defineProperty(_,"id",{value:qAe++}),_.uuid=jAe(),_.uniforms=Wm({},y.uniforms,e.uniforms),_.defines=Wm({},y.defines,e.defines),_.defines[`TROIKA_DERIVED_MATERIAL_${a}`]="",_.extensions=Wm({},y.extensions,e.extensions),_._listeners=void 0,_},m={constructor:{value:d},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+a}},onBeforeCompile:{get(){return c},set(y){this[s]=y}},copy:{writable:!0,configurable:!0,value:function(y){return n.copy.call(this,y),!n.isShaderMaterial&&!n.isDerivedMaterial&&(Wm(this.extensions,y.extensions),Wm(this.defines,y.defines),Wm(this.uniforms,s6.clone(y.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const y=new n.constructor;return f(y).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let y=this._depthMaterial;return y||(y=this._depthMaterial=XR(n.isDerivedMaterial?n.getDepthMaterial():new FT({depthPacking:t6}),e),y.defines.IS_DEPTH_MATERIAL="",y.uniforms=this.uniforms),y}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let y=this._distanceMaterial;return y||(y=this._distanceMaterial=XR(n.isDerivedMaterial?n.getDistanceMaterial():new NT,e),y.defines.IS_DISTANCE_MATERIAL="",y.uniforms=this.uniforms),y}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:y,_distanceMaterial:_}=this;y&&y.dispose(),_&&_.dispose(),n.dispose.call(this)}}};return o[a]=d,new d}function XAe(n,{vertexShader:e,fragmentShader:a},o,s){let{vertexDefs:c,vertexMainIntro:d,vertexMainOutro:f,vertexTransform:m,fragmentDefs:y,fragmentMainIntro:_,fragmentMainOutro:x,fragmentColorTransform:S,customRewriter:T,timeUniform:I}=o;if(c=c||"",d=d||"",f=f||"",y=y||"",_=_||"",x=x||"",(m||T)&&(e=qR(e)),(S||T)&&(a=a.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),a=qR(a)),T){let k=T({vertexShader:e,fragmentShader:a});e=k.vertexShader,a=k.fragmentShader}if(S){let k=[];a=a.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,D=>(k.push(D),"")),x=`${S}
${k.join(`
`)}
${x}`}if(I){const k=`
uniform float ${I};
`;c=k+c,y=k+y}return m&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,c=`${c}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${m}
}
`,d=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${d}
`,e=e.replace(/\b(position|normal|uv)\b/g,(k,D,L,O)=>/\battribute\s+vec[23]\s+$/.test(O.substr(0,L))?D:`troika_${D}_${s}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=vG(e,s,c,d,f),a=vG(a,s,y,_,x),{vertexShader:e,fragmentShader:a}}function vG(n,e,a,o,s){return(o||s||a)&&(n=n.replace(jK,`
${a}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${o}
  troikaOrigMain${e}();
  ${s}
}`),n}function YAe(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let ZAe=0;const _G=new Map;function KAe(n){const e=JSON.stringify(n,YAe);let a=_G.get(e);return a==null&&_G.set(e,a=++ZAe),a}function JAe(n,e,a){const{defaultFontURL:o}=a,s=Object.create(null),c=1/0,d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,f="[^\\S\\u00A0]",m=new RegExp(`${f}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function y(O,F){function B(){const G=q=>{console.error(`Failure loading font ${O}${O===o?"":"; trying fallback"}`,q),O!==o&&(O=o,B())};try{const q=new XMLHttpRequest;q.open("get",O,!0),q.responseType="arraybuffer",q.onload=function(){if(q.status>=400)G(new Error(q.statusText));else if(q.status>0)try{const X=n(q.response);F(X)}catch(X){G(X)}},q.onerror=G,q.send()}catch(q){G(q)}}B()}function _(O,F){O||(O=o);let B=s[O];B?B.pending?B.pending.push(F):F(B):(s[O]={pending:[F]},y(O,G=>{let q=s[O].pending;s[O]=G,q.forEach(X=>X(G))}))}function x({text:O="",font:F=o,sdfGlyphSize:B=64,fontSize:G=1,letterSpacing:q=0,lineHeight:X="normal",maxWidth:te=c,direction:V,textAlign:Q="left",textIndent:ge=0,whiteSpace:me="normal",overflowWrap:be="normal",anchorX:fe=0,anchorY:Ce=0,includeCaretPositions:Le=!1,chunkedBoundsSize:Ge=8192,colorRanges:le=null},pe,Ae=!1){const ae=k(),Ee={fontLoad:0,typesetting:0};O.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),O=O.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),G=+G,q=+q,te=+te,X=X||"normal",ge=+ge,_(F,Ze=>{const Xe=isFinite(te);let Ke=null,Ue=null,ft=null,Rt=null,kt=null,Jt=null,It=null,Pe=0,pt=0,yt=me!=="nowrap";const{ascender:At,descender:Be,unitsPerEm:ue,lineGap:se,capHeight:ve,xHeight:$e}=Ze;Ee.fontLoad=k()-ae;const De=k(),st=G/ue;X==="normal"&&(X=(At-Be+se)/ue),X=X*G;const de=(X-(At-Be)*st)/2,ne=-(At*st+de),Oe=Math.min(X,(At-Be)*st),mt=(At+Be)/2*st-Oe/2;let ot=ge,lt=new D;const Et=[lt];Ze.forEachGlyph(O,G,q,($t,Nt,St)=>{const Zt=O.charAt(St),He=$t.advanceWidth*st,Lt=lt.count;let qt;if("isEmpty"in $t||($t.isWhitespace=!!Zt&&new RegExp(f).test(Zt),$t.canBreakAfter=!!Zt&&m.test(Zt),$t.isEmpty=$t.xMin===$t.xMax||$t.yMin===$t.yMax||d.test(Zt)),!$t.isWhitespace&&!$t.isEmpty&&pt++,yt&&Xe&&!$t.isWhitespace&&Nt+He+ot>te&&Lt){if(lt.glyphAt(Lt-1).glyphObj.canBreakAfter)qt=new D,ot=-Nt;else for(let fn=Lt;fn--;)if(fn===0&&be==="break-word"){qt=new D,ot=-Nt;break}else if(lt.glyphAt(fn).glyphObj.canBreakAfter){qt=lt.splitAt(fn+1);const _e=qt.glyphAt(0).x;ot-=_e;for(let Ye=qt.count;Ye--;)qt.glyphAt(Ye).x-=_e;break}qt&&(lt.isSoftWrapped=!0,lt=qt,Et.push(lt),Pe=te)}let Ot=lt.glyphAt(lt.count);Ot.glyphObj=$t,Ot.x=Nt+ot,Ot.width=He,Ot.charIndex=St,Zt===`
`&&(lt=new D,Et.push(lt),ot=-(Nt+He+q*G)+ge)}),Et.forEach($t=>{for(let Nt=$t.count;Nt--;){let{glyphObj:St,x:Zt,width:He}=$t.glyphAt(Nt);if(!St.isWhitespace){$t.width=Zt+He,$t.width>Pe&&(Pe=$t.width);return}}});let Ut=0,Vt=0;if(fe&&(typeof fe=="number"?Ut=-fe:typeof fe=="string"&&(Ut=-Pe*(fe==="left"?0:fe==="center"?.5:fe==="right"?1:T(fe)))),Ce){if(typeof Ce=="number")Vt=-Ce;else if(typeof Ce=="string"){let $t=Et.length*X;Vt=Ce==="top"?0:Ce==="top-baseline"?-ne:Ce==="top-cap"?-ne-ve*st:Ce==="top-ex"?-ne-$e*st:Ce==="middle"?$t/2:Ce==="bottom"?$t:Ce==="bottom-baseline"?$t-de+Be*st:T(Ce)*$t}}if(!Ae){const $t=e.getEmbeddingLevels(O,V);Ke=new Uint16Array(pt),Ue=new Float32Array(pt*2),ft={},Jt=[c,c,-c,-c],It=[];let Nt=ne;Le&&(kt=new Float32Array(O.length*3)),le&&(Rt=new Uint8Array(pt*3));let St=0,Zt=-1,He=-1,Lt,qt;if(Et.forEach((Ot,fn)=>{let{count:_e,width:Ye}=Ot;if(_e>0){let Se=0;for(let dt=_e;dt--&&Ot.glyphAt(dt).glyphObj.isWhitespace;)Se++;let Me=0,ze=0;if(Q==="center")Me=(Pe-Ye)/2;else if(Q==="right")Me=Pe-Ye;else if(Q==="justify"&&Ot.isSoftWrapped){let dt=0;for(let ut=_e-Se;ut--;)Ot.glyphAt(ut).glyphObj.isWhitespace&&dt++;ze=(Pe-Ye)/dt}if(ze||Me){let dt=0;for(let ut=0;ut<_e;ut++){let Gt=Ot.glyphAt(ut);const Tt=Gt.glyphObj;Gt.x+=Me+dt,ze!==0&&Tt.isWhitespace&&ut<_e-Se&&(dt+=ze,Gt.width+=ze)}}const Qe=e.getReorderSegments(O,$t,Ot.glyphAt(0).charIndex,Ot.glyphAt(Ot.count-1).charIndex);for(let dt=0;dt<Qe.length;dt++){const[ut,Gt]=Qe[dt];let Tt=1/0,Qt=-1/0;for(let mn=0;mn<_e;mn++)if(Ot.glyphAt(mn).charIndex>=ut){let nn=mn,wn=mn;for(;wn<_e;wn++){let Hn=Ot.glyphAt(wn);if(Hn.charIndex>Gt)break;wn<_e-Se&&(Tt=Math.min(Tt,Hn.x),Qt=Math.max(Qt,Hn.x+Hn.width))}for(let Hn=nn;Hn<wn;Hn++){const fa=Ot.glyphAt(Hn);fa.x=Qt-(fa.x+fa.width-Tt)}break}}let tt;const vt=dt=>tt=dt;for(let dt=0;dt<_e;dt++){let ut=Ot.glyphAt(dt);tt=ut.glyphObj;const Gt=tt.index,Tt=$t.levels[ut.charIndex]&1;if(Tt){const Qt=e.getMirroredCharacter(O[ut.charIndex]);Qt&&Ze.forEachGlyph(Qt,0,0,vt)}if(Le){const{charIndex:Qt}=ut,mn=ut.x+Ut,nn=ut.x+ut.width+Ut;kt[Qt*3]=Tt?nn:mn,kt[Qt*3+1]=Tt?mn:nn,kt[Qt*3+2]=Nt+mt+Vt;const wn=Qt-Zt;wn>1&&I(kt,Zt,wn),Zt=Qt}if(le){const{charIndex:Qt}=ut;for(;Qt>He;)He++,le.hasOwnProperty(He)&&(qt=le[He])}if(!tt.isWhitespace&&!tt.isEmpty){const Qt=St++;ft[Gt]||(ft[Gt]={path:tt.path,pathBounds:[tt.xMin,tt.yMin,tt.xMax,tt.yMax]});const mn=ut.x+Ut,nn=Nt+Vt;Ue[Qt*2]=mn,Ue[Qt*2+1]=nn;const wn=mn+tt.xMin*st,Hn=nn+tt.yMin*st,fa=mn+tt.xMax*st,Pa=nn+tt.yMax*st;wn<Jt[0]&&(Jt[0]=wn),Hn<Jt[1]&&(Jt[1]=Hn),fa>Jt[2]&&(Jt[2]=fa),Pa>Jt[3]&&(Jt[3]=Pa),Qt%Ge===0&&(Lt={start:Qt,end:Qt,rect:[c,c,-c,-c]},It.push(Lt)),Lt.end++;const Ta=Lt.rect;if(wn<Ta[0]&&(Ta[0]=wn),Hn<Ta[1]&&(Ta[1]=Hn),fa>Ta[2]&&(Ta[2]=fa),Pa>Ta[3]&&(Ta[3]=Pa),Ke[Qt]=Gt,le){const Li=Qt*3;Rt[Li]=qt>>16&255,Rt[Li+1]=qt>>8&255,Rt[Li+2]=qt&255}}}}Nt-=X}),kt){const Ot=O.length-Zt;Ot>1&&I(kt,Zt,Ot)}}Ee.typesetting=k()-De,pe({glyphIds:Ke,glyphPositions:Ue,glyphData:ft,caretPositions:kt,caretHeight:Oe,glyphColors:Rt,chunkedBounds:It,fontSize:G,unitsPerEm:ue,ascender:At*st,descender:Be*st,capHeight:ve*st,xHeight:$e*st,lineHeight:X,topBaseline:ne,blockBounds:[Ut,Vt-Et.length*X,Ut+Pe,Vt],visibleBounds:Jt,timings:Ee})})}function S(O,F){x(O,B=>{const[G,q,X,te]=B.blockBounds;F({width:X-G,height:te-q})},{metricsOnly:!0})}function T(O){let F=O.match(/^([\d.]+)%$/),B=F?parseFloat(F[1]):NaN;return isNaN(B)?0:B/100}function I(O,F,B){const G=O[F*3],q=O[F*3+1],X=O[F*3+2],te=(q-G)/B;for(let V=0;V<B;V++){const Q=(F+V)*3;O[Q]=G+te*V,O[Q+1]=G+te*(V+1),O[Q+2]=X}}function k(){return(self.performance||Date).now()}function D(){this.data=[]}const L=["glyphObj","x","width","charIndex"];return D.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/L.length)},glyphAt(O){let F=D.flyweight;return F.data=this.data,F.index=O,F},splitAt(O){let F=new D;return F.data=this.data.splice(O*L.length),F}},D.flyweight=L.reduce((O,F,B,G)=>(Object.defineProperty(O,F,{get(){return this.data[this.index*L.length+B]},set(q){this.data[this.index*L.length+B]=q}}),O),{data:null,index:0}),{typeset:x,measure:S,loadFont:_}}const Sg=()=>(self.performance||Date).now(),cC=HK();let bG;function QAe(n,e,a,o,s,c,d,f,m,y,_=!0){return _?tEe(n,e,a,o,s,c,d,f,m,y).then(null,x=>(bG||(console.warn("WebGL SDF generation failed, falling back to JS",x),bG=!0),wG(n,e,a,o,s,c,d,f,m,y))):wG(n,e,a,o,s,c,d,f,m,y)}const aE=[],eEe=5;let YR=0;function $K(){const n=Sg();for(;aE.length&&Sg()-n<eEe;)aE.shift()();YR=aE.length?setTimeout($K,0):0}const tEe=(...n)=>new Promise((e,a)=>{aE.push(()=>{const o=Sg();try{cC.webgl.generateIntoCanvas(...n),e({timing:Sg()-o})}catch(s){a(s)}}),YR||(YR=setTimeout($K,0))}),nEe=4,aEe=2e3,xG={};let iEe=0;function wG(n,e,a,o,s,c,d,f,m,y){const _="TroikaTextSDFGenerator_JS_"+iEe++%nEe;let x=xG[_];return x||(x=xG[_]={workerModule:Hw({name:_,workerId:_,dependencies:[HK,Sg],init(S,T){const I=S().javascript.generate;return function(...k){const D=T();return{textureData:I(...k),timing:T()-D}}},getTransferables(S){return[S.textureData.buffer]}}),requests:0,idleTimer:null}),x.requests++,clearTimeout(x.idleTimer),x.workerModule(n,e,a,o,s,c).then(({textureData:S,timing:T})=>{const I=Sg(),k=new Uint8Array(S.length*4);for(let D=0;D<S.length;D++)k[D*4+y]=S[D];return cC.webglUtils.renderImageData(d,k,f,m,n,e,1<<3-y),T+=Sg()-I,--x.requests===0&&(x.idleTimer=setTimeout(()=>{VAe(_)},aEe)),{timing:T}})}function rEe(n){n._warm||(cC.webgl.isSupported(n),n._warm=!0)}const oEe=cC.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function sEe(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(s){var c=e._bin,d=new Uint8Array(s);if(c.readASCII(d,0,4)=="ttcf"){var f=4;c.readUshort(d,f),f+=2,c.readUshort(d,f),f+=2;var m=c.readUint(d,f);f+=4;for(var y=[],_=0;_<m;_++){var x=c.readUint(d,f);f+=4,y.push(e._readFont(d,x))}return y}return[e._readFont(d,0)]},_readFont:function(s,c){var d=e._bin,f=c;d.readFixed(s,c),c+=4;var m=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2;for(var y=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],_={_data:s,_offset:f},x={},S=0;S<m;S++){var T=d.readASCII(s,c,4);c+=4,d.readUint(s,c),c+=4;var I=d.readUint(s,c);c+=4;var k=d.readUint(s,c);c+=4,x[T]={offset:I,length:k}}for(S=0;S<y.length;S++){var D=y[S];x[D]&&(_[D.trim()]=e[D.trim()].parse(s,x[D].offset,x[D].length,_))}return _},_tabOffset:function(s,c,d){for(var f=e._bin,m=f.readUshort(s,d+4),y=d+12,_=0;_<m;_++){var x=f.readASCII(s,y,4);y+=4,f.readUint(s,y),y+=4;var S=f.readUint(s,y);if(y+=4,f.readUint(s,y),y+=4,x==c)return S}return 0}};e._bin={readFixed:function(s,c){return(s[c]<<8|s[c+1])+(s[c+2]<<8|s[c+3])/65540},readF2dot14:function(s,c){return e._bin.readShort(s,c)/16384},readInt:function(s,c){return e._bin._view(s).getInt32(c)},readInt8:function(s,c){return e._bin._view(s).getInt8(c)},readShort:function(s,c){return e._bin._view(s).getInt16(c)},readUshort:function(s,c){return e._bin._view(s).getUint16(c)},readUshorts:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(e._bin.readUshort(s,c+2*m));return f},readUint:function(s,c){return e._bin._view(s).getUint32(c)},readUint64:function(s,c){return 4294967296*e._bin.readUint(s,c)+e._bin.readUint(s,c+4)},readASCII:function(s,c,d){for(var f="",m=0;m<d;m++)f+=String.fromCharCode(s[c+m]);return f},readUnicode:function(s,c,d){for(var f="",m=0;m<d;m++){var y=s[c++]<<8|s[c++];f+=String.fromCharCode(y)}return f},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,c,d){var f=e._bin._tdec;return f&&c==0&&d==s.length?f.decode(s):e._bin.readASCII(s,c,d)},readBytes:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(s[c+m]);return f},readASCIIArray:function(s,c,d){for(var f=[],m=0;m<d;m++)f.push(String.fromCharCode(s[c+m]));return f},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,c,d,f,m){var y=e._bin,_={},x=c;y.readFixed(s,c),c+=4;var S=y.readUshort(s,c);c+=2;var T=y.readUshort(s,c);c+=2;var I=y.readUshort(s,c);return c+=2,_.scriptList=e._lctf.readScriptList(s,x+S),_.featureList=e._lctf.readFeatureList(s,x+T),_.lookupList=e._lctf.readLookupList(s,x+I,m),_},e._lctf.readLookupList=function(s,c,d){var f=e._bin,m=c,y=[],_=f.readUshort(s,c);c+=2;for(var x=0;x<_;x++){var S=f.readUshort(s,c);c+=2;var T=e._lctf.readLookupTable(s,m+S,d);y.push(T)}return y},e._lctf.readLookupTable=function(s,c,d){var f=e._bin,m=c,y={tabs:[]};y.ltype=f.readUshort(s,c),c+=2,y.flag=f.readUshort(s,c),c+=2;var _=f.readUshort(s,c);c+=2;for(var x=y.ltype,S=0;S<_;S++){var T=f.readUshort(s,c);c+=2;var I=d(s,x,m+T,y);y.tabs.push(I)}return y},e._lctf.numOfOnes=function(s){for(var c=0,d=0;d<32;d++)s>>>d&1&&c++;return c},e._lctf.readClassDef=function(s,c){var d=e._bin,f=[],m=d.readUshort(s,c);if(c+=2,m==1){var y=d.readUshort(s,c);c+=2;var _=d.readUshort(s,c);c+=2;for(var x=0;x<_;x++)f.push(y+x),f.push(y+x),f.push(d.readUshort(s,c)),c+=2}if(m==2){var S=d.readUshort(s,c);for(c+=2,x=0;x<S;x++)f.push(d.readUshort(s,c)),c+=2,f.push(d.readUshort(s,c)),c+=2,f.push(d.readUshort(s,c)),c+=2}return f},e._lctf.getInterval=function(s,c){for(var d=0;d<s.length;d+=3){var f=s[d],m=s[d+1];if(s[d+2],f<=c&&c<=m)return d}return-1},e._lctf.readCoverage=function(s,c){var d=e._bin,f={};f.fmt=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);return c+=2,f.fmt==1&&(f.tab=d.readUshorts(s,c,m)),f.fmt==2&&(f.tab=d.readUshorts(s,c,3*m)),f},e._lctf.coverageIndex=function(s,c){var d=s.tab;if(s.fmt==1)return d.indexOf(c);if(s.fmt==2){var f=e._lctf.getInterval(d,c);if(f!=-1)return d[f+2]+(c-d[f])}return-1},e._lctf.readFeatureList=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var x=d.readASCII(s,c,4);c+=4;var S=d.readUshort(s,c);c+=2;var T=e._lctf.readFeatureTable(s,f+S);T.tag=x.trim(),m.push(T)}return m},e._lctf.readFeatureTable=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2,y>0&&(m.featureParams=f+y);var _=d.readUshort(s,c);c+=2,m.tab=[];for(var x=0;x<_;x++)m.tab.push(d.readUshort(s,c+2*x));return m},e._lctf.readScriptList=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var x=d.readASCII(s,c,4);c+=4;var S=d.readUshort(s,c);c+=2,m[x.trim()]=e._lctf.readScriptTable(s,f+S)}return m},e._lctf.readScriptTable=function(s,c){var d=e._bin,f=c,m={},y=d.readUshort(s,c);c+=2,m.default=e._lctf.readLangSysTable(s,f+y);var _=d.readUshort(s,c);c+=2;for(var x=0;x<_;x++){var S=d.readASCII(s,c,4);c+=4;var T=d.readUshort(s,c);c+=2,m[S.trim()]=e._lctf.readLangSysTable(s,f+T)}return m},e._lctf.readLangSysTable=function(s,c){var d=e._bin,f={};d.readUshort(s,c),c+=2,f.reqFeature=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);return c+=2,f.features=d.readUshorts(s,c,m),f},e.CFF={},e.CFF.parse=function(s,c,d){var f=e._bin;(s=new Uint8Array(s.buffer,c,d))[c=0],s[++c],s[++c],s[++c],c++;var m=[];c=e.CFF.readIndex(s,c,m);for(var y=[],_=0;_<m.length-1;_++)y.push(f.readASCII(s,c+m[_],m[_+1]-m[_]));c+=m[m.length-1];var x=[];c=e.CFF.readIndex(s,c,x);var S=[];for(_=0;_<x.length-1;_++)S.push(e.CFF.readDict(s,c+x[_],c+x[_+1]));c+=x[x.length-1];var T=S[0],I=[];c=e.CFF.readIndex(s,c,I);var k=[];for(_=0;_<I.length-1;_++)k.push(f.readASCII(s,c+I[_],I[_+1]-I[_]));if(c+=I[I.length-1],e.CFF.readSubrs(s,c,T),T.CharStrings){c=T.CharStrings,I=[],c=e.CFF.readIndex(s,c,I);var D=[];for(_=0;_<I.length-1;_++)D.push(f.readBytes(s,c+I[_],I[_+1]-I[_]));T.CharStrings=D}if(T.ROS){c=T.FDArray;var L=[];for(c=e.CFF.readIndex(s,c,L),T.FDArray=[],_=0;_<L.length-1;_++){var O=e.CFF.readDict(s,c+L[_],c+L[_+1]);e.CFF._readFDict(s,O,k),T.FDArray.push(O)}c+=L[L.length-1],c=T.FDSelect,T.FDSelect=[];var F=s[c];if(c++,F!=3)throw F;var B=f.readUshort(s,c);for(c+=2,_=0;_<B+1;_++)T.FDSelect.push(f.readUshort(s,c),s[c+2]),c+=3}return T.Encoding&&(T.Encoding=e.CFF.readEncoding(s,T.Encoding,T.CharStrings.length)),T.charset&&(T.charset=e.CFF.readCharset(s,T.charset,T.CharStrings.length)),e.CFF._readFDict(s,T,k),T},e.CFF._readFDict=function(s,c,d){var f;for(var m in c.Private&&(f=c.Private[1],c.Private=e.CFF.readDict(s,f,f+c.Private[0]),c.Private.Subrs&&e.CFF.readSubrs(s,f+c.Private.Subrs,c.Private)),c)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(m)!=-1&&(c[m]=d[c[m]-426+35])},e.CFF.readSubrs=function(s,c,d){var f=e._bin,m=[];c=e.CFF.readIndex(s,c,m);var y,_=m.length;y=_<1240?107:_<33900?1131:32768,d.Bias=y,d.Subrs=[];for(var x=0;x<m.length-1;x++)d.Subrs.push(f.readBytes(s,c+m[x],m[x+1]-m[x]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,c){for(var d=0;d<s.charset.length;d++)if(s.charset[d]==c)return d;return-1},e.CFF.glyphBySE=function(s,c){return c<0||c>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[c])},e.CFF.readEncoding=function(s,c,d){e._bin;var f=[".notdef"],m=s[c];if(c++,m!=0)throw"error: unknown encoding format: "+m;var y=s[c];c++;for(var _=0;_<y;_++)f.push(s[c+_]);return f},e.CFF.readCharset=function(s,c,d){var f=e._bin,m=[".notdef"],y=s[c];if(c++,y==0)for(var _=0;_<d;_++){var x=f.readUshort(s,c);c+=2,m.push(x)}else{if(y!=1&&y!=2)throw"error: format: "+y;for(;m.length<d;){x=f.readUshort(s,c),c+=2;var S=0;for(y==1?(S=s[c],c++):(S=f.readUshort(s,c),c+=2),_=0;_<=S;_++)m.push(x),x++}}return m},e.CFF.readIndex=function(s,c,d){var f=e._bin,m=f.readUshort(s,c)+1,y=s[c+=2];if(c++,y==1)for(var _=0;_<m;_++)d.push(s[c+_]);else if(y==2)for(_=0;_<m;_++)d.push(f.readUshort(s,c+2*_));else if(y==3)for(_=0;_<m;_++)d.push(16777215&f.readUint(s,c+3*_-1));else if(m!=1)throw"unsupported offset size: "+y+", count: "+m;return(c+=m*y)-1},e.CFF.getCharString=function(s,c,d){var f=e._bin,m=s[c],y=s[c+1];s[c+2],s[c+3],s[c+4];var _=1,x=null,S=null;m<=20&&(x=m,_=1),m==12&&(x=100*m+y,_=2),21<=m&&m<=27&&(x=m,_=1),m==28&&(S=f.readShort(s,c+1),_=3),29<=m&&m<=31&&(x=m,_=1),32<=m&&m<=246&&(S=m-139,_=1),247<=m&&m<=250&&(S=256*(m-247)+y+108,_=2),251<=m&&m<=254&&(S=256*-(m-251)-y-108,_=2),m==255&&(S=f.readInt(s,c+1)/65535,_=5),d.val=S??"o"+x,d.size=_},e.CFF.readCharString=function(s,c,d){for(var f=c+d,m=e._bin,y=[];c<f;){var _=s[c],x=s[c+1];s[c+2],s[c+3],s[c+4];var S=1,T=null,I=null;_<=20&&(T=_,S=1),_==12&&(T=100*_+x,S=2),_!=19&&_!=20||(T=_,S=2),21<=_&&_<=27&&(T=_,S=1),_==28&&(I=m.readShort(s,c+1),S=3),29<=_&&_<=31&&(T=_,S=1),32<=_&&_<=246&&(I=_-139,S=1),247<=_&&_<=250&&(I=256*(_-247)+x+108,S=2),251<=_&&_<=254&&(I=256*-(_-251)-x-108,S=2),_==255&&(I=m.readInt(s,c+1)/65535,S=5),y.push(I??"o"+T),c+=S}return y},e.CFF.readDict=function(s,c,d){for(var f=e._bin,m={},y=[];c<d;){var _=s[c],x=s[c+1];s[c+2],s[c+3],s[c+4];var S=1,T=null,I=null;if(_==28&&(I=f.readShort(s,c+1),S=3),_==29&&(I=f.readInt(s,c+1),S=5),32<=_&&_<=246&&(I=_-139,S=1),247<=_&&_<=250&&(I=256*(_-247)+x+108,S=2),251<=_&&_<=254&&(I=256*-(_-251)-x-108,S=2),_==255)throw I=f.readInt(s,c+1)/65535,S=5,"unknown number";if(_==30){var k=[];for(S=1;;){var D=s[c+S];S++;var L=D>>4,O=15&D;if(L!=15&&k.push(L),O!=15&&k.push(O),O==15)break}for(var F="",B=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],G=0;G<k.length;G++)F+=B[k[G]];I=parseFloat(F)}_<=21&&(T=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][_],S=1,_==12&&(T=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][x],S=2)),T!=null?(m[T]=y.length==1?y[0]:y,y=[]):y.push(I),c+=S}return m},e.cmap={},e.cmap.parse=function(s,c,d){s=new Uint8Array(s.buffer,c,d),c=0;var f=e._bin,m={};f.readUshort(s,c),c+=2;var y=f.readUshort(s,c);c+=2;var _=[];m.tables=[];for(var x=0;x<y;x++){var S=f.readUshort(s,c);c+=2;var T=f.readUshort(s,c);c+=2;var I=f.readUint(s,c);c+=4;var k="p"+S+"e"+T,D=_.indexOf(I);if(D==-1){var L;D=m.tables.length,_.push(I);var O=f.readUshort(s,I);O==0?L=e.cmap.parse0(s,I):O==4?L=e.cmap.parse4(s,I):O==6?L=e.cmap.parse6(s,I):O==12?L=e.cmap.parse12(s,I):console.debug("unknown format: "+O,S,T,I),m.tables.push(L)}if(m[k]!=null)throw"multiple tables for one platform+encoding";m[k]=D}return m},e.cmap.parse0=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2,f.map=[];for(var y=0;y<m-6;y++)f.map.push(s[c+y]);return f},e.cmap.parse4=function(s,c){var d=e._bin,f=c,m={};m.format=d.readUshort(s,c),c+=2;var y=d.readUshort(s,c);c+=2,d.readUshort(s,c),c+=2;var _=d.readUshort(s,c);c+=2;var x=_/2;m.searchRange=d.readUshort(s,c),c+=2,m.entrySelector=d.readUshort(s,c),c+=2,m.rangeShift=d.readUshort(s,c),c+=2,m.endCount=d.readUshorts(s,c,x),c+=2*x,c+=2,m.startCount=d.readUshorts(s,c,x),c+=2*x,m.idDelta=[];for(var S=0;S<x;S++)m.idDelta.push(d.readShort(s,c)),c+=2;for(m.idRangeOffset=d.readUshorts(s,c,x),c+=2*x,m.glyphIdArray=[];c<f+y;)m.glyphIdArray.push(d.readUshort(s,c)),c+=2;return m},e.cmap.parse6=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,d.readUshort(s,c),c+=2,f.firstCode=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2,f.glyphIdArray=[];for(var y=0;y<m;y++)f.glyphIdArray.push(d.readUshort(s,c)),c+=2;return f},e.cmap.parse12=function(s,c){var d=e._bin,f={};f.format=d.readUshort(s,c),c+=2,c+=2,d.readUint(s,c),c+=4,d.readUint(s,c),c+=4;var m=d.readUint(s,c);c+=4,f.groups=[];for(var y=0;y<m;y++){var _=c+12*y,x=d.readUint(s,_+0),S=d.readUint(s,_+4),T=d.readUint(s,_+8);f.groups.push([x,S,T])}return f},e.glyf={},e.glyf.parse=function(s,c,d,f){for(var m=[],y=0;y<f.maxp.numGlyphs;y++)m.push(null);return m},e.glyf._parseGlyf=function(s,c){var d=e._bin,f=s._data,m=e._tabOffset(f,"glyf",s._offset)+s.loca[c];if(s.loca[c]==s.loca[c+1])return null;var y={};if(y.noc=d.readShort(f,m),m+=2,y.xMin=d.readShort(f,m),m+=2,y.yMin=d.readShort(f,m),m+=2,y.xMax=d.readShort(f,m),m+=2,y.yMax=d.readShort(f,m),m+=2,y.xMin>=y.xMax||y.yMin>=y.yMax)return null;if(y.noc>0){y.endPts=[];for(var _=0;_<y.noc;_++)y.endPts.push(d.readUshort(f,m)),m+=2;var x=d.readUshort(f,m);if(m+=2,f.length-m<x)return null;y.instructions=d.readBytes(f,m,x),m+=x;var S=y.endPts[y.noc-1]+1;for(y.flags=[],_=0;_<S;_++){var T=f[m];if(m++,y.flags.push(T),(8&T)!=0){var I=f[m];m++;for(var k=0;k<I;k++)y.flags.push(T),_++}}for(y.xs=[],_=0;_<S;_++){var D=(2&y.flags[_])!=0,L=(16&y.flags[_])!=0;D?(y.xs.push(L?f[m]:-f[m]),m++):L?y.xs.push(0):(y.xs.push(d.readShort(f,m)),m+=2)}for(y.ys=[],_=0;_<S;_++)D=(4&y.flags[_])!=0,L=(32&y.flags[_])!=0,D?(y.ys.push(L?f[m]:-f[m]),m++):L?y.ys.push(0):(y.ys.push(d.readShort(f,m)),m+=2);var O=0,F=0;for(_=0;_<S;_++)O+=y.xs[_],F+=y.ys[_],y.xs[_]=O,y.ys[_]=F}else{var B;y.parts=[];do{B=d.readUshort(f,m),m+=2;var G={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(y.parts.push(G),G.glyphIndex=d.readUshort(f,m),m+=2,1&B){var q=d.readShort(f,m);m+=2;var X=d.readShort(f,m);m+=2}else q=d.readInt8(f,m),m++,X=d.readInt8(f,m),m++;2&B?(G.m.tx=q,G.m.ty=X):(G.p1=q,G.p2=X),8&B?(G.m.a=G.m.d=d.readF2dot14(f,m),m+=2):64&B?(G.m.a=d.readF2dot14(f,m),m+=2,G.m.d=d.readF2dot14(f,m),m+=2):128&B&&(G.m.a=d.readF2dot14(f,m),m+=2,G.m.b=d.readF2dot14(f,m),m+=2,G.m.c=d.readF2dot14(f,m),m+=2,G.m.d=d.readF2dot14(f,m),m+=2)}while(32&B);if(256&B){var te=d.readUshort(f,m);for(m+=2,y.instr=[],_=0;_<te;_++)y.instr.push(f[m]),m++}}return y},e.GPOS={},e.GPOS.parse=function(s,c,d,f){return e._lctf.parse(s,c,d,f,e.GPOS.subt)},e.GPOS.subt=function(s,c,d,f){var m=e._bin,y=d,_={};if(_.fmt=m.readUshort(s,d),d+=2,c==1||c==2||c==3||c==7||c==8&&_.fmt<=2){var x=m.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,x+y)}if(c==1&&_.fmt==1){var S=m.readUshort(s,d);d+=2;var T=e._lctf.numOfOnes(S);S!=0&&(_.pos=e.GPOS.readValueRecord(s,d,S))}else if(c==2&&_.fmt>=1&&_.fmt<=2){S=m.readUshort(s,d),d+=2;var I=m.readUshort(s,d);d+=2,T=e._lctf.numOfOnes(S);var k=e._lctf.numOfOnes(I);if(_.fmt==1){_.pairsets=[];var D=m.readUshort(s,d);d+=2;for(var L=0;L<D;L++){var O=y+m.readUshort(s,d);d+=2;var F=m.readUshort(s,O);O+=2;for(var B=[],G=0;G<F;G++){var q=m.readUshort(s,O);O+=2,S!=0&&(me=e.GPOS.readValueRecord(s,O,S),O+=2*T),I!=0&&(be=e.GPOS.readValueRecord(s,O,I),O+=2*k),B.push({gid2:q,val1:me,val2:be})}_.pairsets.push(B)}}if(_.fmt==2){var X=m.readUshort(s,d);d+=2;var te=m.readUshort(s,d);d+=2;var V=m.readUshort(s,d);d+=2;var Q=m.readUshort(s,d);for(d+=2,_.classDef1=e._lctf.readClassDef(s,y+X),_.classDef2=e._lctf.readClassDef(s,y+te),_.matrix=[],L=0;L<V;L++){var ge=[];for(G=0;G<Q;G++){var me=null,be=null;S!=0&&(me=e.GPOS.readValueRecord(s,d,S),d+=2*T),I!=0&&(be=e.GPOS.readValueRecord(s,d,I),d+=2*k),ge.push({val1:me,val2:be})}_.matrix.push(ge)}}}else{if(c==9&&_.fmt==1){var fe=m.readUshort(s,d);d+=2;var Ce=m.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=fe;else if(f.ltype!=fe)throw"invalid extension substitution";return e.GPOS.subt(s,f.ltype,y+Ce)}console.debug("unsupported GPOS table LookupType",c,"format",_.fmt)}return _},e.GPOS.readValueRecord=function(s,c,d){var f=e._bin,m=[];return m.push(1&d?f.readShort(s,c):0),c+=1&d?2:0,m.push(2&d?f.readShort(s,c):0),c+=2&d?2:0,m.push(4&d?f.readShort(s,c):0),c+=4&d?2:0,m.push(8&d?f.readShort(s,c):0),c+=8&d?2:0,m},e.GSUB={},e.GSUB.parse=function(s,c,d,f){return e._lctf.parse(s,c,d,f,e.GSUB.subt)},e.GSUB.subt=function(s,c,d,f){var m=e._bin,y=d,_={};if(_.fmt=m.readUshort(s,d),d+=2,c!=1&&c!=4&&c!=5&&c!=6)return null;if(c==1||c==4||c==5&&_.fmt<=2||c==6&&_.fmt<=2){var x=m.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,y+x)}if(c==1&&_.fmt>=1&&_.fmt<=2){if(_.fmt==1)_.delta=m.readShort(s,d),d+=2;else if(_.fmt==2){var S=m.readUshort(s,d);d+=2,_.newg=m.readUshorts(s,d,S),d+=2*_.newg.length}}else if(c==4){_.vals=[],S=m.readUshort(s,d),d+=2;for(var T=0;T<S;T++){var I=m.readUshort(s,d);d+=2,_.vals.push(e.GSUB.readLigatureSet(s,y+I))}}else if(c==5&&_.fmt==2){if(_.fmt==2){var k=m.readUshort(s,d);d+=2,_.cDef=e._lctf.readClassDef(s,y+k),_.scset=[];var D=m.readUshort(s,d);for(d+=2,T=0;T<D;T++){var L=m.readUshort(s,d);d+=2,_.scset.push(L==0?null:e.GSUB.readSubClassSet(s,y+L))}}}else if(c==6&&_.fmt==3){if(_.fmt==3){for(T=0;T<3;T++){S=m.readUshort(s,d),d+=2;for(var O=[],F=0;F<S;F++)O.push(e._lctf.readCoverage(s,y+m.readUshort(s,d+2*F)));d+=2*S,T==0&&(_.backCvg=O),T==1&&(_.inptCvg=O),T==2&&(_.ahedCvg=O)}S=m.readUshort(s,d),d+=2,_.lookupRec=e.GSUB.readSubstLookupRecords(s,d,S)}}else{if(c==7&&_.fmt==1){var B=m.readUshort(s,d);d+=2;var G=m.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=B;else if(f.ltype!=B)throw"invalid extension substitution";return e.GSUB.subt(s,f.ltype,y+G)}console.debug("unsupported GSUB table LookupType",c,"format",_.fmt)}return _},e.GSUB.readSubClassSet=function(s,c){var d=e._bin.readUshort,f=c,m=[],y=d(s,c);c+=2;for(var _=0;_<y;_++){var x=d(s,c);c+=2,m.push(e.GSUB.readSubClassRule(s,f+x))}return m},e.GSUB.readSubClassRule=function(s,c){var d=e._bin.readUshort,f={},m=d(s,c),y=d(s,c+=2);c+=2,f.input=[];for(var _=0;_<m-1;_++)f.input.push(d(s,c)),c+=2;return f.substLookupRecords=e.GSUB.readSubstLookupRecords(s,c,y),f},e.GSUB.readSubstLookupRecords=function(s,c,d){for(var f=e._bin.readUshort,m=[],y=0;y<d;y++)m.push(f(s,c),f(s,c+2)),c+=4;return m},e.GSUB.readChainSubClassSet=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var x=d.readUshort(s,c);c+=2,m.push(e.GSUB.readChainSubClassRule(s,f+x))}return m},e.GSUB.readChainSubClassRule=function(s,c){for(var d=e._bin,f={},m=["backtrack","input","lookahead"],y=0;y<m.length;y++){var _=d.readUshort(s,c);c+=2,y==1&&_--,f[m[y]]=d.readUshorts(s,c,_),c+=2*f[m[y]].length}return _=d.readUshort(s,c),c+=2,f.subst=d.readUshorts(s,c,2*_),c+=2*f.subst.length,f},e.GSUB.readLigatureSet=function(s,c){var d=e._bin,f=c,m=[],y=d.readUshort(s,c);c+=2;for(var _=0;_<y;_++){var x=d.readUshort(s,c);c+=2,m.push(e.GSUB.readLigature(s,f+x))}return m},e.GSUB.readLigature=function(s,c){var d=e._bin,f={chain:[]};f.nglyph=d.readUshort(s,c),c+=2;var m=d.readUshort(s,c);c+=2;for(var y=0;y<m-1;y++)f.chain.push(d.readUshort(s,c)),c+=2;return f},e.head={},e.head.parse=function(s,c,d){var f=e._bin,m={};return f.readFixed(s,c),c+=4,m.fontRevision=f.readFixed(s,c),c+=4,f.readUint(s,c),c+=4,f.readUint(s,c),c+=4,m.flags=f.readUshort(s,c),c+=2,m.unitsPerEm=f.readUshort(s,c),c+=2,m.created=f.readUint64(s,c),c+=8,m.modified=f.readUint64(s,c),c+=8,m.xMin=f.readShort(s,c),c+=2,m.yMin=f.readShort(s,c),c+=2,m.xMax=f.readShort(s,c),c+=2,m.yMax=f.readShort(s,c),c+=2,m.macStyle=f.readUshort(s,c),c+=2,m.lowestRecPPEM=f.readUshort(s,c),c+=2,m.fontDirectionHint=f.readShort(s,c),c+=2,m.indexToLocFormat=f.readShort(s,c),c+=2,m.glyphDataFormat=f.readShort(s,c),c+=2,m},e.hhea={},e.hhea.parse=function(s,c,d){var f=e._bin,m={};return f.readFixed(s,c),c+=4,m.ascender=f.readShort(s,c),c+=2,m.descender=f.readShort(s,c),c+=2,m.lineGap=f.readShort(s,c),c+=2,m.advanceWidthMax=f.readUshort(s,c),c+=2,m.minLeftSideBearing=f.readShort(s,c),c+=2,m.minRightSideBearing=f.readShort(s,c),c+=2,m.xMaxExtent=f.readShort(s,c),c+=2,m.caretSlopeRise=f.readShort(s,c),c+=2,m.caretSlopeRun=f.readShort(s,c),c+=2,m.caretOffset=f.readShort(s,c),c+=2,c+=8,m.metricDataFormat=f.readShort(s,c),c+=2,m.numberOfHMetrics=f.readUshort(s,c),c+=2,m},e.hmtx={},e.hmtx.parse=function(s,c,d,f){for(var m=e._bin,y={aWidth:[],lsBearing:[]},_=0,x=0,S=0;S<f.maxp.numGlyphs;S++)S<f.hhea.numberOfHMetrics&&(_=m.readUshort(s,c),c+=2,x=m.readShort(s,c),c+=2),y.aWidth.push(_),y.lsBearing.push(x);return y},e.kern={},e.kern.parse=function(s,c,d,f){var m=e._bin,y=m.readUshort(s,c);if(c+=2,y==1)return e.kern.parseV1(s,c-2,d,f);var _=m.readUshort(s,c);c+=2;for(var x={glyph1:[],rval:[]},S=0;S<_;S++){c+=2,d=m.readUshort(s,c),c+=2;var T=m.readUshort(s,c);c+=2;var I=T>>>8;if((I&=15)!=0)throw"unknown kern table format: "+I;c=e.kern.readFormat0(s,c,x)}return x},e.kern.parseV1=function(s,c,d,f){var m=e._bin;m.readFixed(s,c),c+=4;var y=m.readUint(s,c);c+=4;for(var _={glyph1:[],rval:[]},x=0;x<y;x++){m.readUint(s,c),c+=4;var S=m.readUshort(s,c);c+=2,m.readUshort(s,c),c+=2;var T=S>>>8;if((T&=15)!=0)throw"unknown kern table format: "+T;c=e.kern.readFormat0(s,c,_)}return _},e.kern.readFormat0=function(s,c,d){var f=e._bin,m=-1,y=f.readUshort(s,c);c+=2,f.readUshort(s,c),c+=2,f.readUshort(s,c),c+=2,f.readUshort(s,c),c+=2;for(var _=0;_<y;_++){var x=f.readUshort(s,c);c+=2;var S=f.readUshort(s,c);c+=2;var T=f.readShort(s,c);c+=2,x!=m&&(d.glyph1.push(x),d.rval.push({glyph2:[],vals:[]}));var I=d.rval[d.rval.length-1];I.glyph2.push(S),I.vals.push(T),m=x}return c},e.loca={},e.loca.parse=function(s,c,d,f){var m=e._bin,y=[],_=f.head.indexToLocFormat,x=f.maxp.numGlyphs+1;if(_==0)for(var S=0;S<x;S++)y.push(m.readUshort(s,c+(S<<1))<<1);if(_==1)for(S=0;S<x;S++)y.push(m.readUint(s,c+(S<<2)));return y},e.maxp={},e.maxp.parse=function(s,c,d){var f=e._bin,m={},y=f.readUint(s,c);return c+=4,m.numGlyphs=f.readUshort(s,c),c+=2,y==65536&&(m.maxPoints=f.readUshort(s,c),c+=2,m.maxContours=f.readUshort(s,c),c+=2,m.maxCompositePoints=f.readUshort(s,c),c+=2,m.maxCompositeContours=f.readUshort(s,c),c+=2,m.maxZones=f.readUshort(s,c),c+=2,m.maxTwilightPoints=f.readUshort(s,c),c+=2,m.maxStorage=f.readUshort(s,c),c+=2,m.maxFunctionDefs=f.readUshort(s,c),c+=2,m.maxInstructionDefs=f.readUshort(s,c),c+=2,m.maxStackElements=f.readUshort(s,c),c+=2,m.maxSizeOfInstructions=f.readUshort(s,c),c+=2,m.maxComponentElements=f.readUshort(s,c),c+=2,m.maxComponentDepth=f.readUshort(s,c),c+=2),m},e.name={},e.name.parse=function(s,c,d){var f=e._bin,m={};f.readUshort(s,c),c+=2;var y=f.readUshort(s,c);c+=2,f.readUshort(s,c);for(var _,x=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],S=c+=2,T=0;T<y;T++){var I=f.readUshort(s,c);c+=2;var k=f.readUshort(s,c);c+=2;var D=f.readUshort(s,c);c+=2;var L=f.readUshort(s,c);c+=2;var O=f.readUshort(s,c);c+=2;var F=f.readUshort(s,c);c+=2;var B,G=x[L],q=S+12*y+F;if(I==0)B=f.readUnicode(s,q,O/2);else if(I==3&&k==0)B=f.readUnicode(s,q,O/2);else if(k==0)B=f.readASCII(s,q,O);else if(k==1)B=f.readUnicode(s,q,O/2);else if(k==3)B=f.readUnicode(s,q,O/2);else{if(I!=1)throw"unknown encoding "+k+", platformID: "+I;B=f.readASCII(s,q,O),console.debug("reading unknown MAC encoding "+k+" as ASCII")}var X="p"+I+","+D.toString(16);m[X]==null&&(m[X]={}),m[X][G!==void 0?G:L]=B,m[X]._lang=D}for(var te in m)if(m[te].postScriptName!=null&&m[te]._lang==1033)return m[te];for(var te in m)if(m[te].postScriptName!=null&&m[te]._lang==0)return m[te];for(var te in m)if(m[te].postScriptName!=null&&m[te]._lang==3084)return m[te];for(var te in m)if(m[te].postScriptName!=null)return m[te];for(var te in m){_=te;break}return console.debug("returning name table with languageID "+m[_]._lang),m[_]},e["OS/2"]={},e["OS/2"].parse=function(s,c,d){var f=e._bin.readUshort(s,c);c+=2;var m={};if(f==0)e["OS/2"].version0(s,c,m);else if(f==1)e["OS/2"].version1(s,c,m);else if(f==2||f==3||f==4)e["OS/2"].version2(s,c,m);else{if(f!=5)throw"unknown OS/2 table version: "+f;e["OS/2"].version5(s,c,m)}return m},e["OS/2"].version0=function(s,c,d){var f=e._bin;return d.xAvgCharWidth=f.readShort(s,c),c+=2,d.usWeightClass=f.readUshort(s,c),c+=2,d.usWidthClass=f.readUshort(s,c),c+=2,d.fsType=f.readUshort(s,c),c+=2,d.ySubscriptXSize=f.readShort(s,c),c+=2,d.ySubscriptYSize=f.readShort(s,c),c+=2,d.ySubscriptXOffset=f.readShort(s,c),c+=2,d.ySubscriptYOffset=f.readShort(s,c),c+=2,d.ySuperscriptXSize=f.readShort(s,c),c+=2,d.ySuperscriptYSize=f.readShort(s,c),c+=2,d.ySuperscriptXOffset=f.readShort(s,c),c+=2,d.ySuperscriptYOffset=f.readShort(s,c),c+=2,d.yStrikeoutSize=f.readShort(s,c),c+=2,d.yStrikeoutPosition=f.readShort(s,c),c+=2,d.sFamilyClass=f.readShort(s,c),c+=2,d.panose=f.readBytes(s,c,10),c+=10,d.ulUnicodeRange1=f.readUint(s,c),c+=4,d.ulUnicodeRange2=f.readUint(s,c),c+=4,d.ulUnicodeRange3=f.readUint(s,c),c+=4,d.ulUnicodeRange4=f.readUint(s,c),c+=4,d.achVendID=[f.readInt8(s,c),f.readInt8(s,c+1),f.readInt8(s,c+2),f.readInt8(s,c+3)],c+=4,d.fsSelection=f.readUshort(s,c),c+=2,d.usFirstCharIndex=f.readUshort(s,c),c+=2,d.usLastCharIndex=f.readUshort(s,c),c+=2,d.sTypoAscender=f.readShort(s,c),c+=2,d.sTypoDescender=f.readShort(s,c),c+=2,d.sTypoLineGap=f.readShort(s,c),c+=2,d.usWinAscent=f.readUshort(s,c),c+=2,d.usWinDescent=f.readUshort(s,c),c+=2},e["OS/2"].version1=function(s,c,d){var f=e._bin;return c=e["OS/2"].version0(s,c,d),d.ulCodePageRange1=f.readUint(s,c),c+=4,d.ulCodePageRange2=f.readUint(s,c),c+=4},e["OS/2"].version2=function(s,c,d){var f=e._bin;return c=e["OS/2"].version1(s,c,d),d.sxHeight=f.readShort(s,c),c+=2,d.sCapHeight=f.readShort(s,c),c+=2,d.usDefault=f.readUshort(s,c),c+=2,d.usBreak=f.readUshort(s,c),c+=2,d.usMaxContext=f.readUshort(s,c),c+=2},e["OS/2"].version5=function(s,c,d){var f=e._bin;return c=e["OS/2"].version2(s,c,d),d.usLowerOpticalPointSize=f.readUshort(s,c),c+=2,d.usUpperOpticalPointSize=f.readUshort(s,c),c+=2},e.post={},e.post.parse=function(s,c,d){var f=e._bin,m={};return m.version=f.readFixed(s,c),c+=4,m.italicAngle=f.readFixed(s,c),c+=4,m.underlinePosition=f.readShort(s,c),c+=2,m.underlineThickness=f.readShort(s,c),c+=2,m},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,c){var d=s.cmap,f=-1;if(d.p0e4!=null?f=d.p0e4:d.p3e1!=null?f=d.p3e1:d.p1e0!=null?f=d.p1e0:d.p0e3!=null&&(f=d.p0e3),f==-1)throw"no familiar platform and encoding!";var m=d.tables[f];if(m.format==0)return c>=m.map.length?0:m.map[c];if(m.format==4){for(var y=-1,_=0;_<m.endCount.length;_++)if(c<=m.endCount[_]){y=_;break}return y==-1||m.startCount[y]>c?0:65535&(m.idRangeOffset[y]!=0?m.glyphIdArray[c-m.startCount[y]+(m.idRangeOffset[y]>>1)-(m.idRangeOffset.length-y)]:c+m.idDelta[y])}if(m.format==12){if(c>m.groups[m.groups.length-1][1])return 0;for(_=0;_<m.groups.length;_++){var x=m.groups[_];if(x[0]<=c&&c<=x[1])return x[2]+(c-x[0])}return 0}throw"unknown cmap table format "+m.format},e.U.glyphToPath=function(s,c){var d={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[c]){var f=s.SVG.entries[c];return f==null?d:(typeof f=="string"&&(f=e.SVG.toPath(f),s.SVG.entries[c]=f),f)}if(s.CFF){var m={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},y=s.CFF,_=s.CFF.Private;if(y.ROS){for(var x=0;y.FDSelect[x+2]<=c;)x+=2;_=y.FDArray[y.FDSelect[x+1]].Private}e.U._drawCFF(s.CFF.CharStrings[c],m,y,_,d)}else s.glyf&&e.U._drawGlyf(c,s,d);return d},e.U._drawGlyf=function(s,c,d){var f=c.glyf[s];f==null&&(f=c.glyf[s]=e.glyf._parseGlyf(c,s)),f!=null&&(f.noc>-1?e.U._simpleGlyph(f,d):e.U._compoGlyph(f,c,d))},e.U._simpleGlyph=function(s,c){for(var d=0;d<s.noc;d++){for(var f=d==0?0:s.endPts[d-1]+1,m=s.endPts[d],y=f;y<=m;y++){var _=y==f?m:y-1,x=y==m?f:y+1,S=1&s.flags[y],T=1&s.flags[_],I=1&s.flags[x],k=s.xs[y],D=s.ys[y];if(y==f)if(S){if(!T){e.U.P.moveTo(c,k,D);continue}e.U.P.moveTo(c,s.xs[_],s.ys[_])}else T?e.U.P.moveTo(c,s.xs[_],s.ys[_]):e.U.P.moveTo(c,(s.xs[_]+k)/2,(s.ys[_]+D)/2);S?T&&e.U.P.lineTo(c,k,D):I?e.U.P.qcurveTo(c,k,D,s.xs[x],s.ys[x]):e.U.P.qcurveTo(c,k,D,(k+s.xs[x])/2,(D+s.ys[x])/2)}e.U.P.closePath(c)}},e.U._compoGlyph=function(s,c,d){for(var f=0;f<s.parts.length;f++){var m={cmds:[],crds:[]},y=s.parts[f];e.U._drawGlyf(y.glyphIndex,c,m);for(var _=y.m,x=0;x<m.crds.length;x+=2){var S=m.crds[x],T=m.crds[x+1];d.crds.push(S*_.a+T*_.b+_.tx),d.crds.push(S*_.c+T*_.d+_.ty)}for(x=0;x<m.cmds.length;x++)d.cmds.push(m.cmds[x])}},e.U._getGlyphClass=function(s,c){var d=e._lctf.getInterval(c,s);return d==-1?0:c[d+2]},e.U.getPairAdjustment=function(s,c,d){var f=!1;if(s.GPOS)for(var m=s.GPOS,y=m.lookupList,_=m.featureList,x=[],S=0;S<_.length;S++){var T=_[S];if(T.tag=="kern"){f=!0;for(var I=0;I<T.tab.length;I++)if(!x[T.tab[I]]){x[T.tab[I]]=!0;for(var k=y[T.tab[I]],D=0;D<k.tabs.length;D++)if(k.tabs[D]!=null){var L,O=k.tabs[D];if((!O.coverage||(L=e._lctf.coverageIndex(O.coverage,c))!=-1)&&k.ltype!=1){if(k.ltype==2){var F=null;if(O.fmt==1){var B=O.pairsets[L];for(S=0;S<B.length;S++)B[S].gid2==d&&(F=B[S])}else if(O.fmt==2){var G=e.U._getGlyphClass(c,O.classDef1),q=e.U._getGlyphClass(d,O.classDef2);F=O.matrix[G][q]}if(F){var X=0;return F.val1&&F.val1[2]&&(X+=F.val1[2]),F.val2&&F.val2[0]&&(X+=F.val2[0]),X}}}}}}}if(s.kern&&!f){var te=s.kern.glyph1.indexOf(c);if(te!=-1){var V=s.kern.rval[te].glyph2.indexOf(d);if(V!=-1)return s.kern.rval[te].vals[V]}}return 0},e.U._applySubs=function(s,c,d,f){for(var m=s.length-c-1,y=0;y<d.tabs.length;y++)if(d.tabs[y]!=null){var _,x=d.tabs[y];if(!x.coverage||(_=e._lctf.coverageIndex(x.coverage,s[c]))!=-1){if(d.ltype==1)s[c],x.fmt==1?s[c]=s[c]+x.delta:s[c]=x.newg[_];else if(d.ltype==4)for(var S=x.vals[_],T=0;T<S.length;T++){var I=S[T],k=I.chain.length;if(!(k>m)){for(var D=!0,L=0,O=0;O<k;O++){for(;s[c+L+(1+O)]==-1;)L++;I.chain[O]!=s[c+L+(1+O)]&&(D=!1)}if(D){for(s[c]=I.nglyph,O=0;O<k+L;O++)s[c+O+1]=-1;break}}}else if(d.ltype==5&&x.fmt==2)for(var F=e._lctf.getInterval(x.cDef,s[c]),B=x.cDef[F+2],G=x.scset[B],q=0;q<G.length;q++){var X=G[q],te=X.input;if(!(te.length>m)){for(D=!0,O=0;O<te.length;O++){var V=e._lctf.getInterval(x.cDef,s[c+1+O]);if(F==-1&&x.cDef[V+2]!=te[O]){D=!1;break}}if(D){var Q=X.substLookupRecords;for(T=0;T<Q.length;T+=2)Q[T],Q[T+1]}}}else if(d.ltype==6&&x.fmt==3){if(!e.U._glsCovered(s,x.backCvg,c-x.backCvg.length)||!e.U._glsCovered(s,x.inptCvg,c)||!e.U._glsCovered(s,x.ahedCvg,c+x.inptCvg.length))continue;var ge=x.lookupRec;for(q=0;q<ge.length;q+=2){F=ge[q];var me=f[ge[q+1]];e.U._applySubs(s,c+F,me,f)}}}}},e.U._glsCovered=function(s,c,d){for(var f=0;f<c.length;f++)if(e._lctf.coverageIndex(c[f],s[d+f])==-1)return!1;return!0},e.U.glyphsToPath=function(s,c,d){for(var f={cmds:[],crds:[]},m=0,y=0;y<c.length;y++){var _=c[y];if(_!=-1){for(var x=y<c.length-1&&c[y+1]!=-1?c[y+1]:0,S=e.U.glyphToPath(s,_),T=0;T<S.crds.length;T+=2)f.crds.push(S.crds[T]+m),f.crds.push(S.crds[T+1]);for(d&&f.cmds.push(d),T=0;T<S.cmds.length;T++)f.cmds.push(S.cmds[T]);d&&f.cmds.push("X"),m+=s.hmtx.aWidth[_],y<c.length-1&&(m+=e.U.getPairAdjustment(s,_,x))}}return f},e.U.P={},e.U.P.moveTo=function(s,c,d){s.cmds.push("M"),s.crds.push(c,d)},e.U.P.lineTo=function(s,c,d){s.cmds.push("L"),s.crds.push(c,d)},e.U.P.curveTo=function(s,c,d,f,m,y,_){s.cmds.push("C"),s.crds.push(c,d,f,m,y,_)},e.U.P.qcurveTo=function(s,c,d,f,m){s.cmds.push("Q"),s.crds.push(c,d,f,m)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,c,d,f,m){for(var y=c.stack,_=c.nStems,x=c.haveWidth,S=c.width,T=c.open,I=0,k=c.x,D=c.y,L=0,O=0,F=0,B=0,G=0,q=0,X=0,te=0,V=0,Q=0,ge={val:0,size:0};I<s.length;){e.CFF.getCharString(s,I,ge);var me=ge.val;if(I+=ge.size,me=="o1"||me=="o18")y.length%2!=0&&!x&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,x=!0;else if(me=="o3"||me=="o23")y.length%2!=0&&!x&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,x=!0;else if(me=="o4")y.length>1&&!x&&(S=y.shift()+f.nominalWidthX,x=!0),T&&e.U.P.closePath(m),D+=y.pop(),e.U.P.moveTo(m,k,D),T=!0;else if(me=="o5")for(;y.length>0;)k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D);else if(me=="o6"||me=="o7")for(var be=y.length,fe=me=="o6",Ce=0;Ce<be;Ce++){var Le=y.shift();fe?k+=Le:D+=Le,fe=!fe,e.U.P.lineTo(m,k,D)}else if(me=="o8"||me=="o24"){be=y.length;for(var Ge=0;Ge+6<=be;)L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D),Ge+=6;me=="o24"&&(k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D))}else{if(me=="o11")break;if(me=="o1234"||me=="o1235"||me=="o1236"||me=="o1237")me=="o1234"&&(O=D,F=(L=k+y.shift())+y.shift(),Q=B=O+y.shift(),q=B,te=D,k=(X=(G=(V=F+y.shift())+y.shift())+y.shift())+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,te,k,D)),me=="o1235"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),V=F+y.shift(),Q=B+y.shift(),G=V+y.shift(),q=Q+y.shift(),X=G+y.shift(),te=q+y.shift(),k=X+y.shift(),D=te+y.shift(),y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,te,k,D)),me=="o1236"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),Q=B=O+y.shift(),q=B,X=(G=(V=F+y.shift())+y.shift())+y.shift(),te=q+y.shift(),k=X+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,te,k,D)),me=="o1237"&&(L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),V=F+y.shift(),Q=B+y.shift(),G=V+y.shift(),q=Q+y.shift(),X=G+y.shift(),te=q+y.shift(),Math.abs(X-k)>Math.abs(te-D)?k=X+y.shift():D=te+y.shift(),e.U.P.curveTo(m,L,O,F,B,V,Q),e.U.P.curveTo(m,G,q,X,te,k,D));else if(me=="o14"){if(y.length>0&&!x&&(S=y.shift()+d.nominalWidthX,x=!0),y.length==4){var le=y.shift(),pe=y.shift(),Ae=y.shift(),ae=y.shift(),Ee=e.CFF.glyphBySE(d,Ae),Ze=e.CFF.glyphBySE(d,ae);e.U._drawCFF(d.CharStrings[Ee],c,d,f,m),c.x=le,c.y=pe,e.U._drawCFF(d.CharStrings[Ze],c,d,f,m)}T&&(e.U.P.closePath(m),T=!1)}else if(me=="o19"||me=="o20")y.length%2!=0&&!x&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,x=!0,I+=_+7>>3;else if(me=="o21")y.length>2&&!x&&(S=y.shift()+f.nominalWidthX,x=!0),D+=y.pop(),k+=y.pop(),T&&e.U.P.closePath(m),e.U.P.moveTo(m,k,D),T=!0;else if(me=="o22")y.length>1&&!x&&(S=y.shift()+f.nominalWidthX,x=!0),k+=y.pop(),T&&e.U.P.closePath(m),e.U.P.moveTo(m,k,D),T=!0;else if(me=="o25"){for(;y.length>6;)k+=y.shift(),D+=y.shift(),e.U.P.lineTo(m,k,D);L=k+y.shift(),O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D)}else if(me=="o26")for(y.length%2&&(k+=y.shift());y.length>0;)L=k,O=D+y.shift(),k=F=L+y.shift(),D=(B=O+y.shift())+y.shift(),e.U.P.curveTo(m,L,O,F,B,k,D);else if(me=="o27")for(y.length%2&&(D+=y.shift());y.length>0;)O=D,F=(L=k+y.shift())+y.shift(),B=O+y.shift(),k=F+y.shift(),D=B,e.U.P.curveTo(m,L,O,F,B,k,D);else if(me=="o10"||me=="o29"){var Xe=me=="o10"?f:d;if(y.length==0)console.debug("error: empty stack");else{var Ke=y.pop(),Ue=Xe.Subrs[Ke+Xe.Bias];c.x=k,c.y=D,c.nStems=_,c.haveWidth=x,c.width=S,c.open=T,e.U._drawCFF(Ue,c,d,f,m),k=c.x,D=c.y,_=c.nStems,x=c.haveWidth,S=c.width,T=c.open}}else if(me=="o30"||me=="o31"){var ft=y.length,Rt=(Ge=0,me=="o31");for(Ge+=ft-(be=-3&ft);Ge<be;)Rt?(O=D,F=(L=k+y.shift())+y.shift(),D=(B=O+y.shift())+y.shift(),be-Ge==5?(k=F+y.shift(),Ge++):k=F,Rt=!1):(L=k,O=D+y.shift(),F=L+y.shift(),B=O+y.shift(),k=F+y.shift(),be-Ge==5?(D=B+y.shift(),Ge++):D=B,Rt=!0),e.U.P.curveTo(m,L,O,F,B,k,D),Ge+=4}else{if((me+"").charAt(0)=="o")throw console.debug("Unknown operation: "+me,s),me;y.push(me)}}}c.x=k,c.y=D,c.nStems=_,c.haveWidth=x,c.width=S,c.open=T};var a=e,o={Typr:a};return n.Typr=a,n.default=o,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function lEe(){return function(n){var e=Uint8Array,a=Uint16Array,o=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=function(me,be){for(var fe=new a(31),Ce=0;Ce<31;++Ce)fe[Ce]=be+=1<<me[Ce-1];var Le=new o(fe[30]);for(Ce=1;Ce<30;++Ce)for(var Ge=fe[Ce];Ge<fe[Ce+1];++Ge)Le[Ge]=Ge-fe[Ce]<<5|Ce;return[fe,Le]},m=f(s,2),y=m[0],_=m[1];y[28]=258,_[258]=28;for(var x=f(c,0)[0],S=new a(32768),T=0;T<32768;++T){var I=(43690&T)>>>1|(21845&T)<<1;I=(61680&(I=(52428&I)>>>2|(13107&I)<<2))>>>4|(3855&I)<<4,S[T]=((65280&I)>>>8|(255&I)<<8)>>>1}var k=function(me,be,fe){for(var Ce=me.length,Le=0,Ge=new a(be);Le<Ce;++Le)++Ge[me[Le]-1];var le,pe=new a(be);for(Le=0;Le<be;++Le)pe[Le]=pe[Le-1]+Ge[Le-1]<<1;if(fe){le=new a(1<<be);var Ae=15-be;for(Le=0;Le<Ce;++Le)if(me[Le])for(var ae=Le<<4|me[Le],Ee=be-me[Le],Ze=pe[me[Le]-1]++<<Ee,Xe=Ze|(1<<Ee)-1;Ze<=Xe;++Ze)le[S[Ze]>>>Ae]=ae}else for(le=new a(Ce),Le=0;Le<Ce;++Le)me[Le]&&(le[Le]=S[pe[me[Le]-1]++]>>>15-me[Le]);return le},D=new e(288);for(T=0;T<144;++T)D[T]=8;for(T=144;T<256;++T)D[T]=9;for(T=256;T<280;++T)D[T]=7;for(T=280;T<288;++T)D[T]=8;var L=new e(32);for(T=0;T<32;++T)L[T]=5;var O=k(D,9,1),F=k(L,5,1),B=function(me){for(var be=me[0],fe=1;fe<me.length;++fe)me[fe]>be&&(be=me[fe]);return be},G=function(me,be,fe){var Ce=be/8|0;return(me[Ce]|me[Ce+1]<<8)>>(7&be)&fe},q=function(me,be){var fe=be/8|0;return(me[fe]|me[fe+1]<<8|me[fe+2]<<16)>>(7&be)},X=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],te=function(me,be,fe){var Ce=new Error(be||X[me]);if(Ce.code=me,Error.captureStackTrace&&Error.captureStackTrace(Ce,te),!fe)throw Ce;return Ce},V=function(me,be,fe){var Ce=me.length;if(!Ce||fe&&!fe.l&&Ce<5)return be||new e(0);var Le=!be||fe,Ge=!fe||fe.i;fe||(fe={}),be||(be=new e(3*Ce));var le,pe=function(Zt){var He=be.length;if(Zt>He){var Lt=new e(Math.max(2*He,Zt));Lt.set(be),be=Lt}},Ae=fe.f||0,ae=fe.p||0,Ee=fe.b||0,Ze=fe.l,Xe=fe.d,Ke=fe.m,Ue=fe.n,ft=8*Ce;do{if(!Ze){fe.f=Ae=G(me,ae,1);var Rt=G(me,ae+1,3);if(ae+=3,!Rt){var kt=me[($e=((le=ae)/8|0)+(7&le&&1)+4)-4]|me[$e-3]<<8,Jt=$e+kt;if(Jt>Ce){Ge&&te(0);break}Le&&pe(Ee+kt),be.set(me.subarray($e,Jt),Ee),fe.b=Ee+=kt,fe.p=ae=8*Jt;continue}if(Rt==1)Ze=O,Xe=F,Ke=9,Ue=5;else if(Rt==2){var It=G(me,ae,31)+257,Pe=G(me,ae+10,15)+4,pt=It+G(me,ae+5,31)+1;ae+=14;for(var yt=new e(pt),At=new e(19),Be=0;Be<Pe;++Be)At[d[Be]]=G(me,ae+3*Be,7);ae+=3*Pe;var ue=B(At),se=(1<<ue)-1,ve=k(At,ue,1);for(Be=0;Be<pt;){var $e,De=ve[G(me,ae,se)];if(ae+=15&De,($e=De>>>4)<16)yt[Be++]=$e;else{var st=0,de=0;for($e==16?(de=3+G(me,ae,3),ae+=2,st=yt[Be-1]):$e==17?(de=3+G(me,ae,7),ae+=3):$e==18&&(de=11+G(me,ae,127),ae+=7);de--;)yt[Be++]=st}}var ne=yt.subarray(0,It),Oe=yt.subarray(It);Ke=B(ne),Ue=B(Oe),Ze=k(ne,Ke,1),Xe=k(Oe,Ue,1)}else te(1);if(ae>ft){Ge&&te(0);break}}Le&&pe(Ee+131072);for(var mt=(1<<Ke)-1,ot=(1<<Ue)-1,lt=ae;;lt=ae){var Et=(st=Ze[q(me,ae)&mt])>>>4;if((ae+=15&st)>ft){Ge&&te(0);break}if(st||te(2),Et<256)be[Ee++]=Et;else{if(Et==256){lt=ae,Ze=null;break}var Ut=Et-254;if(Et>264){var Vt=s[Be=Et-257];Ut=G(me,ae,(1<<Vt)-1)+y[Be],ae+=Vt}var $t=Xe[q(me,ae)&ot],Nt=$t>>>4;if($t||te(3),ae+=15&$t,Oe=x[Nt],Nt>3&&(Vt=c[Nt],Oe+=q(me,ae)&(1<<Vt)-1,ae+=Vt),ae>ft){Ge&&te(0);break}Le&&pe(Ee+131072);for(var St=Ee+Ut;Ee<St;Ee+=4)be[Ee]=be[Ee-Oe],be[Ee+1]=be[Ee+1-Oe],be[Ee+2]=be[Ee+2-Oe],be[Ee+3]=be[Ee+3-Oe];Ee=St}}fe.l=Ze,fe.p=lt,fe.b=Ee,Ze&&(Ae=1,fe.m=Ke,fe.d=Xe,fe.n=Ue)}while(!Ae);return Ee==be.length?be:function(Zt,He,Lt){(He==null||He<0)&&(He=0),(Lt==null||Lt>Zt.length)&&(Lt=Zt.length);var qt=new(Zt instanceof a?a:Zt instanceof o?o:e)(Lt-He);return qt.set(Zt.subarray(He,Lt)),qt}(be,0,Ee)},Q=new e(0),ge=typeof TextDecoder<"u"&&new TextDecoder;try{ge.decode(Q,{stream:!0})}catch{}return n.convert_streams=function(me){var be=new DataView(me),fe=0;function Ce(){var It=be.getUint16(fe);return fe+=2,It}function Le(){var It=be.getUint32(fe);return fe+=4,It}function Ge(It){kt.setUint16(Jt,It),Jt+=2}function le(It){kt.setUint32(Jt,It),Jt+=4}for(var pe={signature:Le(),flavor:Le(),length:Le(),numTables:Ce(),reserved:Ce(),totalSfntSize:Le(),majorVersion:Ce(),minorVersion:Ce(),metaOffset:Le(),metaLength:Le(),metaOrigLength:Le(),privOffset:Le(),privLength:Le()},Ae=0;Math.pow(2,Ae)<=pe.numTables;)Ae++;Ae--;for(var ae=16*Math.pow(2,Ae),Ee=16*pe.numTables-ae,Ze=12,Xe=[],Ke=0;Ke<pe.numTables;Ke++)Xe.push({tag:Le(),offset:Le(),compLength:Le(),origLength:Le(),origChecksum:Le()}),Ze+=16;var Ue,ft=new Uint8Array(12+16*Xe.length+Xe.reduce(function(It,Pe){return It+Pe.origLength+4},0)),Rt=ft.buffer,kt=new DataView(Rt),Jt=0;return le(pe.flavor),Ge(pe.numTables),Ge(ae),Ge(Ae),Ge(Ee),Xe.forEach(function(It){le(It.tag),le(It.origChecksum),le(Ze),le(It.origLength),It.outOffset=Ze,(Ze+=It.origLength)%4!=0&&(Ze+=4-Ze%4)}),Xe.forEach(function(It){var Pe,pt=me.slice(It.offset,It.offset+It.compLength);if(It.compLength!=It.origLength){var yt=new Uint8Array(It.origLength);Pe=new Uint8Array(pt,2),V(Pe,yt)}else yt=new Uint8Array(pt);ft.set(yt,It.outOffset);var At=0;(Ze=It.outOffset+It.origLength)%4!=0&&(At=4-Ze%4),ft.set(new Uint8Array(At).buffer,It.outOffset+It.origLength),Ue=Ze+At}),Rt.slice(0,Ue)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function cEe(n,e){const a={M:2,L:2,Q:4,C:6,Z:0},o={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,c=2,d=4,f=8,m=16,y=32;let _;function x(G){if(!_){const q={R:c,L:s,D:d,C:m,U:y,T:f};_=new Map;for(let X in o){let te=0;o[X].split(",").forEach(V=>{let[Q,ge]=V.split("+");Q=parseInt(Q,36),ge=ge?parseInt(ge,36):0,_.set(te+=Q,q[X]);for(let me=ge;me--;)_.set(++te,q[X])})}}return _.get(G)||y}const S=1,T=2,I=3,k=4,D=[null,"isol","init","fina","medi"];function L(G){const q=new Uint8Array(G.length);let X=y,te=S,V=-1;for(let Q=0;Q<G.length;Q++){const ge=G.codePointAt(Q);let me=x(ge)|0,be=S;me&f||(X&(s|d|m)?me&(c|d|m)?(be=I,(te===S||te===I)&&q[V]++):me&(s|y)&&(te===T||te===k)&&q[V]--:X&(c|y)&&(te===T||te===k)&&q[V]--,te=q[Q]=be,X=me,V=Q,ge>65535&&Q++)}return q}function O(G,q){const X=[];for(let V=0;V<q.length;V++){const Q=q.codePointAt(V);Q>65535&&V++,X.push(n.U.codeToGlyph(G,Q))}const te=G.GSUB;if(te){const{lookupList:V,featureList:Q}=te;let ge;const me=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,be=[];Q.forEach(fe=>{if(me.test(fe.tag))for(let Ce=0;Ce<fe.tab.length;Ce++){if(be[fe.tab[Ce]])continue;be[fe.tab[Ce]]=!0;const Le=V[fe.tab[Ce]],Ge=/^(isol|init|fina|medi)$/.test(fe.tag);Ge&&!ge&&(ge=L(q));for(let le=0;le<X.length;le++)(!ge||!Ge||D[ge[le]]===fe.tag)&&n.U._applySubs(X,le,Le,V)}})}return X}function F(...G){for(let q=0;q<G.length;q++)if(typeof G[q]=="number")return G[q]}function B(G){const q=Object.create(null),X=G["OS/2"],te=G.hhea,V=G.head.unitsPerEm,Q=F(X&&X.sTypoAscender,te&&te.ascender,V),ge={unitsPerEm:V,ascender:Q,descender:F(X&&X.sTypoDescender,te&&te.descender,0),capHeight:F(X&&X.sCapHeight,Q),xHeight:F(X&&X.sxHeight,Q),lineGap:F(X&&X.sTypoLineGap,te&&te.lineGap),forEachGlyph(me,be,fe,Ce){let Le=0;const Ge=1/ge.unitsPerEm*be,le=O(G,me);let pe=0,Ae=-1;return le.forEach((ae,Ee)=>{if(ae!==-1){let Ze=q[ae];if(!Ze){const{cmds:Xe,crds:Ke}=n.U.glyphToPath(G,ae);let Ue="",ft=0;for(let Pe=0,pt=Xe.length;Pe<pt;Pe++){const yt=a[Xe[Pe]];Ue+=Xe[Pe];for(let At=1;At<=yt;At++)Ue+=(At>1?",":"")+Ke[ft++]}let Rt,kt,Jt,It;if(Ke.length){Rt=kt=1/0,Jt=It=-1/0;for(let Pe=0,pt=Ke.length;Pe<pt;Pe+=2){let yt=Ke[Pe],At=Ke[Pe+1];yt<Rt&&(Rt=yt),At<kt&&(kt=At),yt>Jt&&(Jt=yt),At>It&&(It=At)}}else Rt=Jt=kt=It=0;Ze=q[ae]={index:ae,advanceWidth:G.hmtx.aWidth[ae],xMin:Rt,yMin:kt,xMax:Jt,yMax:It,path:Ue,pathCommandCount:Xe.length}}Ae!==-1&&(Le+=n.U.getPairAdjustment(G,Ae,ae)*Ge),Ce.call(null,Ze,Le,pe),Ze.advanceWidth&&(Le+=Ze.advanceWidth*Ge),fe&&(Le+=fe*be),Ae=ae}pe+=me.codePointAt(pe)>65535?2:1}),Le}};return ge}return function(q){const X=new Uint8Array(q,0,4),te=n._bin.readASCII(X,0,4);if(te==="wOFF")q=e(q);else if(te==="wOF2")throw new Error("woff2 fonts not supported");return B(n.parse(q)[0])}}const uEe=Hw({name:"Typr Font Parser",dependencies:[sEe,lEe,cEe],init(n,e,a){const o=n(),s=e();return a(o,s)}}),E0={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},dEe=new Pn;function Jv(){return(self.performance||Date).now()}const SG=Object.create(null);function qK(n,e){n=pEe({},n);const a=Jv();if(n.font=mEe(n.font||E0.defaultFontURL),n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||E0.sdfGlyphSize,n.colorRanges!=null){let x={};for(let S in n.colorRanges)if(n.colorRanges.hasOwnProperty(S)){let T=n.colorRanges[S];typeof T!="number"&&(T=dEe.set(T).getHex()),x[S]=T}n.colorRanges=x}Object.freeze(n);const{textureWidth:o,sdfExponent:s}=E0,{sdfGlyphSize:c}=n,d=o/c*4;let f=SG[c];if(!f){const x=document.createElement("canvas");x.width=o,x.height=c*256/d,f=SG[c]={glyphCount:0,sdfGlyphSize:c,sdfCanvas:x,sdfTexture:new kr(x,void 0,void 0,void 0,Ir,Ir),contextLost:!1,glyphsByFont:new Map},f.sdfTexture.generateMipmaps=!1,hEe(f)}const{sdfTexture:m,sdfCanvas:y}=f;let _=f.glyphsByFont.get(n.font);_||f.glyphsByFont.set(n.font,_=new Map),yEe(n).then(x=>{const{glyphIds:S,glyphPositions:T,fontSize:I,unitsPerEm:k,timings:D}=x,L=[],O=new Float32Array(S.length*4),F=I/k;let B=0,G=0;const q=Jv();S.forEach((ge,me)=>{let be=_.get(ge);if(!be){const{path:Ge,pathBounds:le}=x.glyphData[ge],pe=Math.max(le[2]-le[0],le[3]-le[1])/c*(E0.sdfMargin*c+.5),Ae=f.glyphCount++,ae=[le[0]-pe,le[1]-pe,le[2]+pe,le[3]+pe];_.set(ge,be={path:Ge,atlasIndex:Ae,sdfViewBox:ae}),L.push(be)}const{sdfViewBox:fe}=be,Ce=T[G++],Le=T[G++];O[B++]=Ce+fe[0]*F,O[B++]=Le+fe[1]*F,O[B++]=Ce+fe[2]*F,O[B++]=Le+fe[3]*F,S[me]=be.atlasIndex}),D.quads=(D.quads||0)+(Jv()-q);const X=Jv();D.sdf={};const te=y.height,V=Math.ceil(f.glyphCount/d),Q=Math.pow(2,Math.ceil(Math.log2(V*c)));Q>te&&(console.info(`Increasing SDF texture size ${te}->${Q}`),oEe(y,o,Q),m.dispose()),Promise.all(L.map(ge=>XK(ge,f,n.gpuAccelerateSDF).then(({timing:me})=>{D.sdf[ge.atlasIndex]=me}))).then(()=>{L.length&&!f.contextLost&&(YK(f),m.needsUpdate=!0),D.sdfTotal=Jv()-X,D.total=Jv()-a,e(Object.freeze({parameters:n,sdfTexture:m,sdfGlyphSize:c,sdfExponent:s,glyphBounds:O,glyphAtlasIndices:S,glyphColors:x.glyphColors,caretPositions:x.caretPositions,caretHeight:x.caretHeight,chunkedBounds:x.chunkedBounds,ascender:x.ascender,descender:x.descender,lineHeight:x.lineHeight,capHeight:x.capHeight,xHeight:x.xHeight,topBaseline:x.topBaseline,blockBounds:x.blockBounds,visibleBounds:x.visibleBounds,timings:x.timings}))})}),Promise.resolve().then(()=>{f.contextLost||rEe(y)})}function XK({path:n,atlasIndex:e,sdfViewBox:a},{sdfGlyphSize:o,sdfCanvas:s,contextLost:c},d){if(c)return Promise.resolve({timing:-1});const{textureWidth:f,sdfExponent:m}=E0,y=Math.max(a[2]-a[0],a[3]-a[1]),_=Math.floor(e/4),x=_%(f/o)*o,S=Math.floor(_/(f/o))*o,T=e%4;return QAe(o,o,n,a,y,m,s,x,S,T,d)}function hEe(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",a=>{console.log("Context Lost",a),a.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",a=>{console.log("Context Restored",a),n.contextLost=!1;const o=[];n.glyphsByFont.forEach(s=>{s.forEach(c=>{o.push(XK(c,n,!0))})}),Promise.all(o).then(()=>{YK(n),n.sdfTexture.needsUpdate=!0})})}function fEe({font:n,characters:e,sdfGlyphSize:a},o){let s=Array.isArray(e)?e.join(`
`):""+e;qK({font:n,sdfGlyphSize:a,text:s},o)}function pEe(n,e){for(let a in e)e.hasOwnProperty(a)&&(n[a]=e[a]);return n}let lA;function mEe(n){return lA||(lA=typeof document>"u"?{}:document.createElement("a")),lA.href=n,lA.href}function YK(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:a}=n,{width:o,height:s}=e,c=n.sdfCanvas.getContext("webgl");let d=a.image.data;(!d||d.length!==o*s*4)&&(d=new Uint8Array(o*s*4),a.image={width:o,height:s,data:d},a.flipY=!1,a.isDataTexture=!0),c.readPixels(0,0,o,s,c.RGBA,c.UNSIGNED_BYTE,d)}}const gEe=Hw({name:"Typesetter",dependencies:[E0,uEe,JAe,HAe],init(n,e,a,o){const{defaultFontURL:s}=n;return a(e,o(),{defaultFontURL:s})}}),yEe=Hw({name:"Typesetter",dependencies:[gEe],init(n){return function(e){return new Promise(a=>{n.typeset(e,a)})}},getTransferables(n){const e=[n.glyphPositions.buffer,n.glyphIds.buffer];return n.caretPositions&&e.push(n.caretPositions.buffer),n.glyphColors&&e.push(n.glyphColors.buffer),e}}),AG={};function vEe(n){let e=AG[n];if(!e){const a=new Tp(1,1,n,n),o=a.clone(),s=a.attributes,c=o.attributes,d=new La,f=s.uv.count;for(let m=0;m<f;m++)c.position.array[m*3]*=-1,c.normal.array[m*3+2]*=-1;["position","normal","uv"].forEach(m=>{d.setAttribute(m,new Wn([...s[m].array,...c[m].array],s[m].itemSize))}),d.setIndex([...a.index.array,...o.index.array.map(m=>m+f)]),d.translate(.5,.5,0),e=AG[n]=d}return e}const _Ee="aTroikaGlyphBounds",EG="aTroikaGlyphIndex",bEe="aTroikaGlyphColor";class xEe extends E6{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Pc,this.boundingBox=new gu}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const a=this.getIndex().count;this.setDrawRange(e===Ss?a/2:0,e===Hl?a:a/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let a=vEe(e);["position","normal","uv"].forEach(o=>{this.attributes[o]=a.attributes[o].clone()}),this.setIndex(a.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,a,o,s,c){gI(this,_Ee,e,4),gI(this,EG,a,1),gI(this,bEe,c,3),this._blockBounds=o,this._chunkedBounds=s,this.instanceCount=a.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:a,boundingBox:o}=this;if(a){const{PI:s,floor:c,min:d,max:f,sin:m,cos:y}=Math,_=s/2,x=s*2,S=Math.abs(a),T=e[0]/S,I=e[2]/S,k=c((T+_)/x)!==c((I+_)/x)?-S:d(m(T)*S,m(I)*S),D=c((T-_)/x)!==c((I-_)/x)?S:f(m(T)*S,m(I)*S),L=c((T+s)/x)!==c((I+s)/x)?S*2:f(S-y(T)*S,S-y(I)*S);o.min.set(k,e[1],a<0?-L:0),o.max.set(D,e[3],a<0?0:L)}else o.min.set(e[0],e[1],0),o.max.set(e[2],e[3],0);o.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let a=this.getAttribute(EG).count,o=this._chunkedBounds;if(o)for(let s=o.length;s--;){a=o[s].end;let c=o[s].rect;if(c[1]<e.w&&c[3]>e.y&&c[0]<e.z&&c[2]>e.x)break}this.instanceCount=a}}function gI(n,e,a,o){const s=n.getAttribute(e);a?s&&s.array.length===a.length?(s.array.set(a),s.needsUpdate=!0):(n.setAttribute(e,new Og(a,o)),delete n._maxInstanceCount,n.dispose()):s&&n.deleteAttribute(e)}const wEe=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,SEe=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,AEe=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,EEe=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function MEe(n){const e=XR(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Kt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ei(0,0,0,0)},uTroikaClipRect:{value:new Ei(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Kt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Pn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Na},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:wEe,vertexTransform:SEe,fragmentDefs:AEe,fragmentColorTransform:EEe,customRewriter({vertexShader:a,fragmentShader:o}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(o)&&(o=o.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(a)||(a=a.replace(jK,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:a,fragmentShader:o}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Y6=new Hh({color:16777215,side:Hl,transparent:!0}),MG=8421504,TG=new Ia,cA=new Fe,yI=new Fe,pb=[],TEe=new Fe,vI="+x+y";function CG(n){return Array.isArray(n)?n[0]:n}let ZK=()=>{const n=new So(new Tp(1,1),Y6);return ZK=()=>n,n},KK=()=>{const n=new So(new Tp(1,1,32,1),Y6);return KK=()=>n,n};const CEe={type:"syncstart"},PEe={type:"synccomplete"},JK=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],IEe=JK.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let QK=class extends So{constructor(){const e=new xEe;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=MG,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=vI,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(CEe),qK({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},a=>{this._isSyncing=!1,this._textRenderInfo=a,this.geometry.updateGlyphs(a.glyphBounds,a.glyphAtlasIndices,a.blockBounds,a.chunkedBounds,a.glyphColors);const o=this._queuedSyncs;o&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{o.forEach(s=>s&&s())})),this.dispatchEvent(PEe),e&&e()})))}onBeforeRender(e,a,o,s,c,d){this.sync(),c.isTroikaTextMaterial&&this._prepareForRender(c),c._hadOwnSide=c.hasOwnProperty("side"),this.geometry.setSide(c._actualSide=c.side),c.side=yd}onAfterRender(e,a,o,s,c,d){c._hadOwnSide?c.side=c._actualSide:delete c.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const a=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Y6.clone());if((!e||e.baseMaterial!==a)&&(e=this._derivedMaterial=MEe(a),a.addEventListener("dispose",function o(){a.removeEventListener("dispose",o),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let o=e._outlineMtl;return o||(o=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),o.isTextOutlineMaterial=!0,o.depthWrite=!1,o.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),o.dispose()})),[o,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return CG(this.material).getDepthMaterial()}get customDistanceMaterial(){return CG(this.material).getDistanceMaterial()}_prepareForRender(e){const a=e.isTextOutlineMaterial,o=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:f,blockBounds:m}=s;o.uTroikaSDFTexture.value=f,o.uTroikaSDFTextureSize.value.set(f.image.width,f.image.height),o.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,o.uTroikaSDFExponent.value=s.sdfExponent,o.uTroikaTotalBounds.value.fromArray(m),o.uTroikaUseGlyphColors.value=!a&&!!s.glyphColors;let y=0,_=0,x=0,S,T,I,k=0,D=0;if(a){let{outlineWidth:O,outlineOffsetX:F,outlineOffsetY:B,outlineBlur:G,outlineOpacity:q}=this;y=this._parsePercent(O)||0,_=Math.max(0,this._parsePercent(G)||0),S=q,k=this._parsePercent(F)||0,D=this._parsePercent(B)||0}else x=Math.max(0,this._parsePercent(this.strokeWidth)||0),x&&(I=this.strokeColor,o.uTroikaStrokeColor.value.set(I??MG),T=this.strokeOpacity,T==null&&(T=1)),S=this.fillOpacity;o.uTroikaDistanceOffset.value=y,o.uTroikaPositionOffset.value.set(k,D),o.uTroikaBlurRadius.value=_,o.uTroikaStrokeWidth.value=x,o.uTroikaStrokeOpacity.value=T,o.uTroikaFillOpacity.value=S??1,o.uTroikaCurveRadius.value=this.curveRadius||0;let L=this.clipRect;if(L&&Array.isArray(L)&&L.length===4)o.uTroikaClipRect.value.fromArray(L);else{const O=(this.fontSize||.1)*100;o.uTroikaClipRect.value.set(m[0]-O,m[1]-O,m[2]+O,m[3]+O)}this.geometry.applyClipRect(o.uTroikaClipRect.value)}o.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const c=a?this.outlineColor||0:this.color;if(c==null)delete e.color;else{const f=e.hasOwnProperty("color")?e.color:e.color=new Pn;(c!==f._input||typeof c=="object")&&f.set(f._input=c)}let d=this.orientation||vI;if(d!==e._orientation){let f=o.uTroikaOrient.value;d=d.replace(/[^-+xyz]/g,"");let m=d!==vI&&d.match(/^([-+])([xyz])([-+])([xyz])$/);if(m){let[,y,_,x,S]=m;cA.set(0,0,0)[_]=y==="-"?1:-1,yI.set(0,0,0)[S]=x==="-"?-1:1,TG.lookAt(TEe,cA.cross(yI),yI),f.setFromMatrix4(TG)}else f.identity();e._orientation=d}}_parsePercent(e){if(typeof e=="string"){let a=e.match(/^(-?[\d.]+)%$/),o=a?parseFloat(a[1]):NaN;e=(isNaN(o)?0:o/100)*this.fontSize}return e}localPositionToTextCoords(e,a=new Kt){a.copy(e);const o=this.curveRadius;return o&&(a.x=Math.atan2(e.x,Math.abs(o)-Math.abs(e.z))*Math.abs(o)),a}worldPositionToTextCoords(e,a=new Kt){return cA.copy(e),this.localPositionToTextCoords(this.worldToLocal(cA),a)}raycast(e,a){const{textRenderInfo:o,curveRadius:s}=this;if(o){const c=o.blockBounds,d=s?KK():ZK(),f=d.geometry,{position:m,uv:y}=f.attributes;for(let _=0;_<y.count;_++){let x=c[0]+y.getX(_)*(c[2]-c[0]);const S=c[1]+y.getY(_)*(c[3]-c[1]);let T=0;s&&(T=s-Math.cos(x/s)*s,x=Math.sin(x/s)*s),m.setXYZ(_,x,S,T)}f.boundingSphere=this.geometry.boundingSphere,f.boundingBox=this.geometry.boundingBox,d.matrixWorld=this.matrixWorld,d.material.side=this.material.side,pb.length=0,d.raycast(e,pb);for(let _=0;_<pb.length;_++)pb[_].object=this,a.push(pb[_])}}copy(e){const a=this.geometry;return super.copy(e),this.geometry=a,IEe.forEach(o=>{this[o]=e[o]}),this}clone(){return new this.constructor().copy(this)}};JK.forEach(n=>{const e="_private_"+n;Object.defineProperty(QK.prototype,n,{get(){return this[e]},set(a){a!==this[e]&&(this[e]=a,this._needsSync=!0)}})});const sx=re.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:a="middle",font:o,fontSize:s=1,children:c,characters:d,onSync:f,...m},y)=>{const _=fh(({invalidate:I})=>I),[x]=re.useState(()=>new QK),[S,T]=re.useMemo(()=>{const I=[];let k="";return re.Children.forEach(c,D=>{typeof D=="string"||typeof D=="number"?k+=D:I.push(D)}),[I,k]},[c]);return iK(()=>new Promise(I=>fEe({font:o,characters:d},I)),["troika-text",o,d]),re.useLayoutEffect(()=>void x.sync(()=>{_(),f&&f(x)})),re.useEffect(()=>()=>x.dispose(),[x]),re.createElement("primitive",rt({object:x,ref:y,font:o,text:T,anchorX:e,anchorY:a,fontSize:s,sdfGlyphSize:n},m),S)}),LEe=re.forwardRef(({makeDefault:n,camera:e,regress:a,domElement:o,enableDamping:s=!0,keyEvents:c=!1,onChange:d,onStart:f,onEnd:m,...y},_)=>{const x=fh(q=>q.invalidate),S=fh(q=>q.camera),T=fh(q=>q.gl),I=fh(q=>q.events),k=fh(q=>q.setEvents),D=fh(q=>q.set),L=fh(q=>q.get),O=fh(q=>q.performance),F=e||S,B=o||I.connected||T.domElement,G=re.useMemo(()=>new FAe(F),[F]);return R6(()=>{G.enabled&&G.update()},-1),re.useEffect(()=>(c&&G.connect(c===!0?B:c),G.connect(B),()=>void G.dispose()),[c,B,a,G,x]),re.useEffect(()=>{const q=V=>{x(),a&&O.regress(),d&&d(V)},X=V=>{f&&f(V)},te=V=>{m&&m(V)};return G.addEventListener("change",q),G.addEventListener("start",X),G.addEventListener("end",te),()=>{G.removeEventListener("start",X),G.removeEventListener("end",te),G.removeEventListener("change",q)}},[d,f,m,G,x,k]),re.useEffect(()=>{if(n){const q=L().controls;return D({controls:G}),()=>D({controls:q})}},[n,G]),re.createElement("primitive",rt({ref:_,object:G,enableDamping:s},y))}),Qv=({value:n,label:e,options:a,onChange:o})=>{const{classes:s}=HD(),[c,d]=re.useState(!1),f=()=>{d(!1)};return Je(Tge,{children:[ee(Yge,{children:e}),Je(fve,{className:s.filterSelect,open:c,value:n,onOpen:f,onChange:o,variant:"outlined",label:e,sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},"&.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:0}},renderValue:m=>m.length===0?ee("em",{children:e}):m,children:[ee(J0,{disabled:!0,value:"",children:ee("em",{children:e})}),a.map(m=>ee(J0,{value:m,children:m},m))]})]})},REe=()=>{const{classes:n}=HD(),[e,a]=re.useState(!1),[o,s]=re.useState("Country"),[c,d]=re.useState("Climate"),[f,m]=re.useState("Risk exposure"),[y,_]=re.useState("Income group"),[x,S]=re.useState("Population group"),[T,I]=re.useState("Rating"),k=re.useCallback(G=>{s(G.target.value)},[]),D=re.useCallback(G=>{d(G.target.value)},[]),L=re.useCallback(G=>{m(G.target.value)},[]),O=re.useCallback(G=>{_(G.target.value)},[]),F=re.useCallback(G=>{S(G.target.value)},[]),B=re.useCallback(G=>{I(G.target.value)},[]);return ee("div",{className:n.filterButtonsWrapper,children:e?Je("div",{children:[ee("div",{onClick:()=>a(!1),className:n.blurAll}),ee(Qv,{value:o,label:"Country",options:["Country","Canada"],onChange:k}),ee(Qv,{value:c,label:"Climate",options:["Climate","Tropical"],onChange:D}),ee(Qv,{value:f,label:"Risk exposure",options:["Risk exposure","Low"],onChange:L}),ee(Qv,{value:y,label:"Income group",options:["Income group","High"],onChange:O}),ee(Qv,{value:x,label:"Population group",options:["Population group","High"],onChange:F}),ee(Qv,{value:T,label:"Rating",options:["Rating","High"],onChange:B}),Je(Or,{style:{color:"white",background:"#2D67FF",gap:"10px"},className:n.filterButton,variant:"outlined",onClick:()=>a(!1),children:["Close",ee("img",{style:{height:"1.1vh"},src:"assets/closeIcon.svg",alt:"close"})]})]}):ee(Or,{className:n.filterButton,variant:"outlined",onClick:()=>{a(!0)},children:"Filter by"})})},kEe={firstRow:"Choose a city and ",secondRow:"view its ",score:"score",howRatingWorks:"How rating works",map:"Map",graph:"Graph",filterBy:"Filter by",smallTextGraph1:"Urban Resilience Index (URI) is a tool to measure environmental (E), social (S), and governmental (G) performance of urban areas as well as their ability & willingness to achieve better practices.",smallTextGraph2:"URI shows whether the basic needs of residents are satisfied, how vulnerable the place is to crises and how it impacts the world around.",smallTextGraph3:"At the graph color represents the cities' overall ratings (see right scale) while position against E, S and G axes reflects respective component scoring."},DEe=({map:n,currentView:e,setCurrentView:a,isZoomButtonsVisible:o})=>{const s=m=>kEe[m],{classes:c}=HD(),d=re.useCallback(()=>{a("map")},[]),f=re.useCallback(()=>{a("graph")},[]);return Je("div",{className:c.root,children:[ee("div",{className:c.topLineWrapper,children:Je("div",{className:c.textAndToggleWrapper,children:[Je(Ha,{className:c.bigText,children:[s("firstRow")," ",ee("br",{}),s("secondRow"),ee("span",{className:c.bigTextBlue,children:s("score")})]}),Je(Qve,{children:[ee(sW,{value:"map",selected:e==="map",onClick:d,children:s("map")}),ee(sW,{value:"graph",selected:e==="graph",onClick:f,children:s("graph")})]}),!o&&Je(Ha,{className:c.bigTextSubtitle,children:[s("smallTextGraph1")," ",ee("br",{}),ee("br",{}),s("smallTextGraph2")," ",ee("br",{}),ee("br",{}),s("smallTextGraph3")]})]})}),ee(REe,{}),ee("img",{className:c.legendLine,src:"/assets/legendLine.svg",alt:"legend"}),Je("div",{className:c.bottomWrapper,children:[Je("div",{className:c.smallTextWrapper,children:[ee(Ha,{className:c.smallText,children:s("howRatingWorks")}),ee("img",{src:"/assets/hintQuestionIcon.svg",alt:"hint"})]}),o&&ee(a0e,{map:n})]})]})},OEe=()=>{const n=[new Fe(0,0,0),new Fe(6,0,0)],e=[new Fe(0,0,0),new Fe(0,6,0)],a=[new Fe(0,0,0),new Fe(0,0,6)],o=new La().setFromPoints(n),s=new La().setFromPoints(e),c=new La().setFromPoints(a),d=k6(zZ,"/textures/texture_cage_radial_fade_2.svg");return Je("group",{children:[ee("mesh",{position:[4.5,.5,0],children:ee(sx,{fontSize:.5,color:"white",children:"Environmental"})}),ee("mesh",{position:[.5,5,0],rotation:[0,0,Math.PI/2],children:ee(sx,{fontSize:.5,color:"white",children:"Social"})}),ee("mesh",{position:[0,.5,4.5],rotation:[0,-Math.PI/2,0],children:ee(sx,{fontSize:.5,color:"white",children:"Governmental"})}),Je("group",{children:[ee("line",{geometry:o,children:ee("lineBasicMaterial",{color:"white"})}),Je("mesh",{position:[6,0,0],rotation:[0,0,-Math.PI/2],children:[ee("coneGeometry",{args:[.1,.3,10]}),ee("meshBasicMaterial",{color:"white"})]})]}),Je("group",{children:[ee("line",{geometry:s,children:ee("lineBasicMaterial",{color:"white"})}),Je("mesh",{position:[0,6,0],rotation:[0,0,0],children:[ee("coneGeometry",{args:[.1,.3,10]}),ee("meshBasicMaterial",{color:"white"})]})]}),Je("group",{children:[ee("line",{geometry:c,children:ee("lineBasicMaterial",{color:"white"})}),Je("mesh",{position:[0,0,6],rotation:[Math.PI/2,0,0],children:[ee("coneGeometry",{args:[.1,.3,10]}),ee("meshBasicMaterial",{color:"white"})]})]}),Je("mesh",{position:[0,-.02,0],rotation:[-Math.PI/2,0,0],children:[ee("planeGeometry",{args:[16,16]}),ee("meshStandardMaterial",{map:d,transparent:!0,opacity:.5,side:Hl})]})]})},zEe=([n,e,a])=>{const o=[],s=[],c=[],d=[];for(let m=0;m<=e;m+=.5)o.push({x:n,y:m,z:a});for(let m=0;m<=n;m+=.5)s.push({x:m,y:0,z:a});for(let m=0;m<=a;m+=.5)c.push({x:n,y:0,z:m});for(let m=0;m<=e;m+=.5)d.push({x:n-n/e*m,y:e,z:a-a/e*m});return Je(vl,{children:[o.map(m=>Je("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[ee("boxGeometry",{args:[.02,.2,.02]}),ee("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.y)),s.map(m=>Je("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[ee("boxGeometry",{args:[.2,.02,.02]}),ee("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.x)),c.map(m=>Je("mesh",{position:[m.x-n,m.y-e,m.z-a],children:[ee("boxGeometry",{args:[.02,.02,.2]}),ee("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.z)),d.map(m=>Je("mesh",{rotation:[0,Math.atan2(m.x-n,m.z-a),0],position:[m.x-n,m.y-e,m.z-a],children:[ee("boxGeometry",{args:[.02,.02,.2]}),ee("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},m.z))]})},FEe=({item:n,color:e,setSelectedCity:a})=>{const o=re.useRef(),s=re.useRef(),c=re.useRef(),[d,f]=re.useState(!1),[m,y]=re.useState(!1);return R6(_=>{s.current.lookAt(_.camera.position),c.current.lookAt(_.camera.position)}),Je("group",{ref:o,position:n.position,children:[Je("mesh",{ref:c,children:[ee("torusGeometry",{args:m?[.32,.015,100,100]:[.35,.015,100,100]}),ee("meshStandardMaterial",{color:e,transparent:!0,opacity:1})]}),Je("mesh",{onClick:()=>{f(!0),a(n.label)},onPointerMissed:()=>{f(!1)},onPointerOver:()=>{y(!0)},onPointerOut:()=>{y(!1)},children:[ee("sphereGeometry",{args:[.2,100,100]}),ee("meshStandardMaterial",{color:e})]}),Je("mesh",{ref:s,position:[0,1.5,0],children:[ee(sx,{fontSize:.45,color:"white",anchorX:"center",anchorY:"middle",children:m&&n.label}),ee(sx,{fontSize:.45,color:e,anchorX:"center",anchorY:"middle",position:[0,-.5,0],children:m&&n.status}),ee("meshStandardMaterial",{color:"black"})]}),m&&zEe(n.position)]},n.label)},NEe=({data:n,color:e,setSelectedCity:a})=>{const o=re.useRef();return R6(({camera:s})=>{s.lookAt(2,-6,0)}),Je("group",{ref:o,position:[2,-10,1],rotation:[0,1,0],children:[ee(OEe,{}),n.map(s=>ee(FEe,{item:s,color:s.color,setSelectedCity:a},s.label))]})},BEe=[{position:[3,5,5],label:"Dubai",color:"#B7DE86",status:"A-3"},{position:[4,5,5],label:"Expo City Dubai",color:"#75D652",status:"A-2"},{position:[2,2,1],label:"Valparaiso",color:"#FF9B3F",status:"C-1"},{position:[1,1,1],label:"Dar es Salaam",color:"#FF632F",status:"C-2"},{position:[4,1,4],label:"Adoni",color:"#FF632F",status:"C-2"},{position:[4,3,3],label:"Natal",color:"#FFD748",status:"B-2"},{position:[3,1,3],label:"Brazzaville",color:"#FF9B3F",status:"C-1"},{position:[3,2,2],label:"Almaty",color:"#D6E15A",status:"B-1"},{position:[3,3,4],label:"Cape Town",color:"#FFD748",status:"B-2"},{position:[2,2,2],label:"Mexico City",color:"#FF632F",status:"C-2"},{position:[2,3,3],label:"Jakarta",color:"#FFD748",status:"B-3"},{position:[3,4,3],label:"Panama City",color:"#ECE38E",status:"B-1"},{position:[2,4,4],label:"Amman",color:"#ECE38E",status:"B-1"},{position:[2,3,2],label:"Bangkok",color:"#FFD748",status:"B-3"},{position:[3,3,3],label:"Colombo",color:"#FFD748",status:"B-2"}],UEe=({setSelectedCity:n})=>{const{classes:e}=VD();return ee("div",{className:e.graph3dWrapper,children:ee(re.Suspense,{fallback:null,children:Je(OSe,{style:{background:"transparent "},camera:{position:[11,11,11],fov:50},children:[ee("ambientLight",{intensity:1,castShadow:!0}),ee("directionalLight",{intensity:1,position:[10,10,0],castShadow:!0}),ee(NEe,{data:BEe,setSelectedCity:n}),ee(LEe,{enableZoom:!1,makeDefault:!0,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI/2,minAzimuthAngle:Math.PI/4,maxAzimuthAngle:Math.PI/2})]})})})};var eJ={exports:{}};(function(n,e){(function(a,o){n.exports=o()})(xoe,function(){var a,o,s;function c(f,m){if(!a)a=m;else if(!o)o=m;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",_={};a(_),s=m(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}c(["exports"],function(f){var m=typeof self<"u"?self:{},y="3.0.0-rc.2";let _;const x={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):i}catch{_=i}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!x.API_URL)return null;try{const i=new URL(x.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},S={supported:!1,testSupport:function(i){!k&&I&&(D?L(i):T=i)}};let T,I,k=!1,D=!1;function L(i){const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,I),i.isContextLost())return;S.supported=!0}catch{}i.deleteTexture(t),k=!0}m.document&&(I=m.document.createElement("img"),I.onload=function(){T&&L(T),T=null,D=!0},I.onerror=function(){k=!0,T=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function F(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var B=G;function G(i,t,r,l){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=r,this.p2y=l}G.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,l=0;l<8;l++){var u=this.sampleCurveX(r)-i;if(Math.abs(u)<t)return r;var h=this.sampleCurveDerivativeX(r);if(Math.abs(h)<1e-6)break;r-=u/h}var p=0,g=1;for(r=i,l=0;l<20&&(u=this.sampleCurveX(r),!(Math.abs(u-i)<t));l++)i>u?p=r:g=r,r=.5*(g-p)+p;return r},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var q=F(B),X=te;function te(i,t){this.x=i,this.y=t}te.prototype={clone:function(){return new te(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,r=i.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),r=Math.sin(i),l=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=l,this},_rotateAround:function(i,t){var r=Math.cos(i),l=Math.sin(i),u=t.y+l*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-l*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},te.convert=function(i){return i instanceof te?i:Array.isArray(i)?new te(i[0],i[1]):i};var V=F(X);function Q(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(!Q(i[r],t[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const r in i)if(!Q(i[r],t[r]))return!1;return!0}return i===t}const ge=Math.PI/180,me=180/Math.PI;function be(i){return i*ge}function fe(i){return i*me}const Ce=[[0,0],[1,0],[1,1],[0,1]];function Le(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,r=t*i;return 4*(i<.5?r:3*(i-t)+r-.75)}function Ge(i){let t=1/0,r=1/0,l=-1/0,u=-1/0;for(const h of i)t=Math.min(t,h.x),r=Math.min(r,h.y),l=Math.max(l,h.x),u=Math.max(u,h.y);return{min:new V(t,r),max:new V(l,u)}}function le(i,t,r=0,l=!0){const u=new V(r,r),h=i.sub(u),p=t.add(u),g=[h,new V(p.x,h.y),p,new V(h.x,p.y)];return l&&g.push(h.clone()),g}function pe(i,t,r,l){const u=new q(i,t,r,l);return function(h){return u.solve(h)}}const Ae=pe(.25,.1,.25,1);function ae(i,t,r){return Math.min(r,Math.max(t,i))}function Ee(i,t,r){return(r=ae((r-i)/(t-i),0,1))*r*(3-2*r)}function Ze(i,t,r){const l=r-t,u=((i-t)%l+l)%l+t;return u===t?r:u}function Xe(i,t,r){if(!i.length)return r(null,[]);let l=i.length;const u=new Array(i.length);let h=null;i.forEach((p,g)=>{t(p,(v,b)=>{v&&(h=v),u[g]=b,--l==0&&r(h,u)})})}function Ke(i){const t=[];for(const r in i)t.push(i[r]);return t}function Ue(i,...t){for(const r of t)for(const l in r)i[l]=r[l];return i}function ft(i,t){const r={};for(let l=0;l<t.length;l++){const u=t[l];u in i&&(r[u]=i[u])}return r}let Rt=1;function kt(){return Rt++}function Jt(){return function i(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)}()}function It(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Pe(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function pt(i,t){i.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function yt(i,t){return i.indexOf(t,i.length-t.length)!==-1}function At(i,t,r){const l={};for(const u in i)l[u]=t.call(r||this,i[u],u,i);return l}function Be(i,t,r){const l={};for(const u in i)t.call(r||this,i[u],u,i)&&(l[u]=i[u]);return l}function ue(i){return Array.isArray(i)?i.map(ue):typeof i=="object"&&i?At(i,ue):i}const se={};function ve(i){se[i]||(typeof console<"u"&&console.warn(i),se[i]=!0)}function $e(i,t,r){return(r.y-i.y)*(t.x-i.x)>(t.y-i.y)*(r.x-i.x)}function De(i){let t=0;for(let r,l,u=0,h=i.length,p=h-1;u<h;p=u++)r=i[u],l=i[p],t+=(l.x-r.x)*(r.y+l.y);return t}function st([i,t,r]){const l=be(t+90),u=be(r);return{x:i*Math.cos(l)*Math.sin(u),y:i*Math.sin(l)*Math.sin(u),z:i*Math.cos(u),azimuthal:t,polar:r}}function de(i,t,r){const l=Math.sqrt(i*i+t*t+r*r),u=l>0?Math.acos(r/l)*me:0;let h=i!==0||t!==0?Math.atan2(-t,-i)*me+90:0;return h<0&&(h+=360),[l,h,u]}function ne(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Oe(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,l,u,h)=>{const p=u||h;return t[l]=!p||p.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}let mt=null;function ot(){return!!m.document.fullscreenElement||!!m.document.webkitFullscreenElement}function lt(i){try{const t=m[i];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Et(i,t){return[i[4*t],i[4*t+1],i[4*t+2],i[4*t+3]]}function Ut(i,t,r){i[4*t+0]=r[0],i[4*t+1]=r[1],i[4*t+2]=r[2],i[4*t+3]=r[3]}function Vt(i,t){return[Math.pow(i[0],2.2)*t,Math.pow(i[1],2.2)*t,Math.pow(i[2],2.2)*t]}function $t(i){return[Math.pow(i[0],1/2.2),Math.pow(i[1],1/2.2),Math.pow(i[2],1/2.2)]}const Nt="mapbox-tiles";let St=500,Zt=50,He,Lt;function qt(){try{return m.caches}catch{}}function Ot(){qt()&&!He&&(He=m.caches.open(Nt))}function fn(i){const t=i.indexOf("?");if(t<0)return i;const r=function(u){const h=u.indexOf("?");return h>0?u.slice(h+1).split("&"):[]}(i),l=r.filter(u=>{const h=u.split("=");return h[0]==="language"||h[0]==="worldview"});return l.length?`${i.slice(0,t)}?${l.join("&")}`:i.slice(0,t)}let _e=1/0;function Ye(i){_e++,_e>Zt&&(i.getActor().send("enforceCacheSizeLimit",St),_e=0)}const Se={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Se);class Me extends Error{constructor(t,r,l){r===401&&Hn(l)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=r,this.url=l}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ze=ne()?()=>self.worker&&self.worker.referrer:()=>(m.location.protocol==="blob:"?m.parent:m).location.href,Qe=function(i,t){if(!(/^file:/.test(r=i.url)||/^file:/.test(ze())&&!/^\w+:/.test(r))){if(m.fetch&&m.Request&&m.AbortController&&m.Request.prototype.hasOwnProperty("signal"))return function(l,u){const h=new m.AbortController,p=new m.Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,referrer:ze(),referrerPolicy:l.referrerPolicy,signal:h.signal});let g=!1,v=!1;const b=(w=p.url).indexOf("sku=")>0&&Hn(w);var w;l.type==="json"&&p.headers.set("Accept","application/json");const A=(P,R,z)=>{if(v)return;if(P&&P.message!=="SecurityError"&&ve(P.toString()),R&&z)return C(R);const U=Date.now();m.fetch(p).then(W=>{if(W.ok){const j=b?W.clone():null;return C(W,j,U)}return u(new Me(W.statusText,W.status,l.url))}).catch(W=>{W.name!=="AbortError"&&u(new Error(`${W.message} ${l.url}`))})},C=(P,R,z)=>{(l.type==="arrayBuffer"?P.arrayBuffer():l.type==="json"?P.json():P.text()).then(U=>{v||(R&&z&&function(W,j,Y){if(Ot(),!He)return;const Z={status:j.status,statusText:j.statusText,headers:new m.Headers};j.headers.forEach((ie,ce)=>Z.headers.set(ce,ie));const $=Oe(j.headers.get("Cache-Control")||"");if($["no-store"])return;$["max-age"]&&Z.headers.set("Expires",new Date(Y+1e3*$["max-age"]).toUTCString());const K=Z.headers.get("Expires");K&&(new Date(K).getTime()-Y<42e4||function(ie,ce){if(Lt===void 0)try{new Response(new ReadableStream),Lt=!0}catch{Lt=!1}Lt?ce(ie.body):ie.blob().then(ce)}(j,ie=>{const ce=new m.Response(ie,Z);Ot(),He&&He.then(he=>he.put(fn(W.url),ce)).catch(he=>ve(he.message))}))}(p,R,z),g=!0,u(null,U,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(U=>{v||u(new Error(U.message))})};return b?function(P,R){if(Ot(),!He)return R(null);const z=fn(P.url);He.then(U=>{U.match(z).then(W=>{const j=function(Y){if(!Y)return!1;const Z=new Date(Y.headers.get("Expires")||0),$=Oe(Y.headers.get("Cache-Control")||"");return Z>Date.now()&&!$["no-cache"]}(W);U.delete(z),j&&U.put(z,W.clone()),R(null,W,j)}).catch(R)}).catch(R)}(p,A):A(null,null),{cancel:()=>{v=!0,g||h.abort()}}}(i,t);if(ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,t,void 0,!0)}var r;return function(l,u){const h=new m.XMLHttpRequest;h.open(l.method||"GET",l.url,!0),l.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const p in l.headers)h.setRequestHeader(p,l.headers[p]);return l.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=l.credentials==="include",h.onerror=()=>{u(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let p=h.response;if(l.type==="json")try{p=JSON.parse(h.response)}catch(g){return u(g)}u(null,p,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else u(new Me(h.statusText,h.status,l.url))},h.send(l.body),{cancel:()=>h.abort()}}(i,t)},tt=function(i,t){return Qe(Ue(i,{type:"json"}),t)},vt=function(i,t){return Qe(Ue(i,{type:"arrayBuffer"}),t)};function dt(i){const t=m.document.createElement("a");return t.href=i,t.protocol===m.document.location.protocol&&t.host===m.document.location.host}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Gt,Tt;Gt=[],Tt=0;const Qt=function(i,t){if(S.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),Tt>=x.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:i,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Gt.push(h),h}Tt++;let r=!1;const l=()=>{if(!r)for(r=!0,Tt--;Gt.length&&Tt<x.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Gt.shift(),{requestParameters:p,callback:g,cancelled:v}=h;v||(h.cancel=Qt(p,g).cancel)}},u=vt(i,(h,p,g,v)=>{l(),h?t(h):p&&(m.createImageBitmap?function(b,w){const A=new m.Blob([new Uint8Array(b)],{type:"image/png"});m.createImageBitmap(A).then(C=>{w(null,C)}).catch(C=>{w(new Error(`Could not load image because of ${C.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(p,(b,w)=>t(b,w,g,v)):function(b,w){const A=new m.Image,C=m.URL;A.onload=()=>{w(null,A),C.revokeObjectURL(A.src),A.onload=null,m.requestAnimationFrame(()=>{A.src=ut})},A.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new m.Blob([new Uint8Array(b)],{type:"image/png"});A.src=b.byteLength?C.createObjectURL(P):ut}(p,(b,w)=>t(b,w,g,v)))});return{cancel:()=>{u.cancel(),l()}}},mn="NO_ACCESS_TOKEN";class nn{constructor(t,r,l){this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!l,this._createSkuToken()}_createSkuToken(){const t=function(){let r="";for(let l=0;l<10;l++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}normalizeStyleURL(t,r){if(!wn(t))return t;const l=mi(t);return l.params.push(`sdk=js-${y}`),l.path=`/styles/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeGlyphsURL(t,r){if(!wn(t))return t;const l=mi(t);return l.path=`/fonts/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeModelURL(t,r){if(!wn(t))return t;const l=mi(t);return l.path=`/models/v1${l.path}`,this._makeAPIURL(l,this._customAccessToken||r)}normalizeSourceURL(t,r,l,u){if(!wn(t))return t;const h=mi(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),l&&h.params.push(`language=${l}`),u&&h.params.push(`worldview=${u}`),this._makeAPIURL(h,this._customAccessToken||r)}normalizeSpriteURL(t,r,l,u){const h=mi(t);return wn(t)?(h.path=`/styles/v1${h.path}/sprite${r}${l}`,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=`${r}${l}`,Re(h))}normalizeTileURL(t,r,l){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!wn(t))return t;const u=mi(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||l&&u.authority!=="raster"&&l===512?"@2x":""}${S.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${x.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${x.TILE_URL_VERSION}${u.path}`);const h=this._customAccessToken||function(p){for(const g of p){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(u.params)||x.ACCESS_TOKEN;return x.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,h)}canonicalizeTileURL(t,r){const l=mi(t);if(!l.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!l.path.match(/\.[\w]+$/))return t;let u="mapbox://";l.path.match(/^\/raster\/v1\//)?u+=`raster/${l.path.replace(`/${x.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${l.path.replace(`/${x.TILE_URL_VERSION}/`,"")}`;let h=l.params;return r&&(h=h.filter(p=>!p.match(/^access_token=/))),h.length&&(u+=`?${h.join("&")}`),u}canonicalizeTileset(t,r){const l=!!r&&wn(r),u=[];for(const h of t.tiles||[])Hn(h)?u.push(this.canonicalizeTileURL(h,l)):u.push(h);return u}_makeAPIURL(t,r){const l="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=mi(x.API_URL);if(t.protocol=u.protocol,t.authority=u.authority,t.protocol==="http"){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(u.path!=="/"&&(t.path=`${u.path}${t.path}`),!x.REQUIRE_ACCESS_TOKEN)return Re(t);if(r=r||x.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${l}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${l}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${r||""}`),Re(t)}}function wn(i){return i.indexOf("mapbox:")===0}function Hn(i){return x.API_URL_REGEX.test(i)}function fa(i){return x.API_CDN_URL_REGEX.test(i)}function Pa(i){return x.API_STYLE_REGEX.test(i)&&!Ta(i)}function Ta(i){return x.API_SPRITE_REGEX.test(i)}const Li=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mi(i){const t=i.match(Li);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Re(i){const t=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${t}`}const bt="mapbox.eventData";function Dt(i){if(!i)return null;const t=i.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(m.atob(t[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ct{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const r=Dt(x.ACCESS_TOKEN);let l="";return l=r&&r.u?m.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,h)=>String.fromCharCode(+("0x"+h)))):x.ACCESS_TOKEN||"",t?`${bt}.${t}:${l}`:`${bt}:${l}`}fetchEventData(){const t=lt("localStorage"),r=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{const u=m.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const h=m.localStorage.getItem(l);h&&(this.anonId=h)}catch{ve("Unable to read from LocalStorage")}}saveEventData(){const t=lt("localStorage"),r=this.getStorageKey(),l=this.getStorageKey("uuid");if(t)try{m.localStorage.setItem(l,this.anonId),Object.keys(this.eventData).length>=1&&m.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{ve("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,r,l,u){if(!x.EVENTS_URL)return;const h=mi(x.EVENTS_URL);h.params.push(`access_token=${u||x.ACCESS_TOKEN||""}`);const p={event:this.type,created:new Date(t).toISOString()},g=r?Ue(p,r):p,v={url:Re(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(b,w){return Qe(Ue(b,{method:"POST"}),w)}(v,b=>{this.pendingRequest=null,l(b),this.saveEventData(),this.processRequests(u)})}queueRequest(t,r){this.queue.push(t),this.processRequests(r)}}const zt=new class extends Ct{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,t){x.EVENTS_URL&&x.ACCESS_TOKEN&&Array.isArray(i)&&i.some(r=>wn(r)||Hn(r))&&this.queueRequest(Date.now(),t)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Dt(x.ACCESS_TOKEN),r=t?t.u:x.ACCESS_TOKEN;let l=r!==this.eventData.tokenU;Pe(this.anonId)||(this.anonId=Jt(),l=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const h=new Date(this.eventData.lastSuccess),p=new Date(u),g=(u-this.eventData.lastSuccess)/864e5;l=l||g>=1||g<-1||h.getDate()!==p.getDate()}else l=!0;l?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,"enabled.telemetry":!1,userId:this.anonId},h=>{h||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},i):this.processRequests()}},ln=zt.postTurnstileEvent.bind(zt),Tn=new class extends Ct{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,t,r,l){this.skuToken=t,this.errorCb=l,x.EVENTS_URL&&(r||x.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(mn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Pe(this.anonId)||(this.anonId=Jt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,skuToken:this.skuToken,userId:this.anonId},l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},i))}},qn=Tn.postMapLoadEvent.bind(Tn),an=new class extends Ct{constructor(){super("gljs.performance")}postPerformanceEvent(i,t){x.EVENTS_URL&&(i||x.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:r}=this.queue.shift(),l=function(u){const h=m.performance.getEntriesByType("resource"),p=m.performance.getEntriesByType("mark"),g=function(C){const P={};if(C){for(const R in C)if(R!=="other")for(const z of C[R]){const U=`${R}ResolveRangeMin`,W=`${R}ResolveRangeMax`,j=`${R}RequestCount`,Y=`${R}RequestCachedCount`;P[U]=Math.min(P[U]||1/0,z.startTime),P[W]=Math.max(P[W]||-1/0,z.responseEnd);const Z=$=>{P[$]===void 0&&(P[$]=0),++P[$]};z.transferSize!==void 0&&z.transferSize===0&&Z(Y),Z(j)}}return P}(function(C,P){const R={};if(C)for(const z of C){const U=P(z);R[U]===void 0&&(R[U]=[]),R[U].push(z)}return R}(h,ta)),v=m.devicePixelRatio,b=m.navigator.connection||m.navigator.mozConnection||m.navigator.webkitConnection,w={counters:[],metadata:[],attributes:[]},A=(C,P,R)=>{R!=null&&C.push({name:P,value:R.toString()})};for(const C in g)A(w.counters,C,g[C]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(A(w.counters,"interactionRangeMin",u.interactionRange[0]),A(w.counters,"interactionRangeMax",u.interactionRange[1])),p)for(const C of Object.keys(ti)){const P=ti[C],R=p.find(z=>z.name===P);R&&A(w.counters,P,R.startTime)}return A(w.counters,"visibilityHidden",u.visibilityHidden),A(w.attributes,"style",function(C){if(C)for(const P of C){const R=P.name.split("?")[0];if(Pa(R)){const z=R.split("/").slice(-2);if(z.length===2)return`mapbox://styles/${z[0]}/${z[1]}`}}}(h)),A(w.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),A(w.attributes,"fogEnabled",u.fogEnabled?"true":"false"),A(w.attributes,"projection",u.projection),A(w.attributes,"zoom",u.zoom),A(w.metadata,"devicePixelRatio",v),A(w.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),A(w.metadata,"navigatorUserAgent",m.navigator.userAgent),A(w.metadata,"screenWidth",m.screen.width),A(w.metadata,"screenHeight",m.screen.height),A(w.metadata,"windowWidth",m.innerWidth),A(w.metadata,"windowHeight",m.innerHeight),A(w.metadata,"mapWidth",u.width/v),A(w.metadata,"mapHeight",u.height/v),A(w.metadata,"webglRenderer",u.renderer),A(w.metadata,"webglVendor",u.vendor),A(w.metadata,"sdkVersion",y),A(w.metadata,"sdkIdentifier","mapbox-gl-js"),w}(r);for(const u of l.metadata);for(const u of l.counters);for(const u of l.attributes);this.postEvent(t,l,()=>{},i)}},sa=an.postPerformanceEvent.bind(an),pa=new class extends Ct{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,t,r,l){if(!x.API_URL||!x.SESSION_PATH)return;const u=mi(x.API_URL+x.SESSION_PATH);u.params.push(`sku=${t||""}`),u.params.push(`access_token=${l||x.ACCESS_TOKEN||""}`);const h={url:Re(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(p,g){return Qe(Ue(p,{method:"GET"}),g)}(h,p=>{this.pendingRequest=null,r(p),this.saveEventData(),this.processRequests(l)})}getSessionAPI(i,t,r,l){this.skuToken=t,this.errorCb=l,x.SESSION_PATH&&x.API_URL&&(r||x.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},r):this.errorCb(new Error(mn)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,l=>{l?this.errorCb(l):t&&(this.success[t]=!0)},i)}},ia=pa.getSessionAPI.bind(pa),ai=new Set;function xr(i,t){t?ai.add(i):ai.delete(i)}const ti={create:"create",load:"load",fullLoad:"fullLoad"},Yi={mark(i){m.performance.mark(i)},measure(i,t,r){m.performance.measure(i,t,r)}};function ta(i){const t=i.name.split("?")[0];return fa(t)&&t.includes("mapbox-gl.js")?"javascript":fa(t)&&t.includes("mapbox-gl.css")?"css":function(r){return x.API_FONTS_REGEX.test(r)}(t)?"fontRange":Ta(t)?"sprite":Pa(t)?"style":function(r){return x.API_TILEJSON_REGEX.test(r)}(t)?"tilejson":"other"}const Rn=m.performance;function ho(i){const t=i?i.url.toString():void 0;return Rn.getEntriesByName(t)}var Ra=Mi;function Mi(i){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var l,u,h=new Blob([""],{type:"text/javascript"}),p=URL.createObjectURL(h);try{u=new Worker(p),l=!0}catch{l=!1}return u&&u.terminate(),URL.revokeObjectURL(p),l}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var l=document.createElement("canvas");l.width=l.height=1;var u=l.getContext("2d");if(!u)return!1;var h=u.getImageData(0,0,1,1);return h&&h.width===l.width}()?(Ho[r=t&&t.failIfMajorPerformanceCaveat]===void 0&&(Ho[r]=function(l){var u,h=function(p){var g=document.createElement("canvas"),v=Object.create(Mi.webGLContextAttributes);return v.failIfMajorPerformanceCaveat=p,g.getContext("webgl",v)||g.getContext("experimental-webgl",v)}(l);if(!h)return!1;try{u=h.createShader(h.VERTEX_SHADER)}catch{return!1}return!(!u||h.isContextLost())&&(h.shaderSource(u,"void main() {}"),h.compileShader(u),h.getShaderParameter(u,h.COMPILE_STATUS)===!0)}(r)),Ho[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}(i)}var Ho={};let wr,Zi,ui,zr;Mi.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Cn={now:()=>ui!==void 0?ui:m.performance.now(),setNow(i){ui=i},restoreNow(){ui=void 0},frame(i){const t=m.requestAnimationFrame(i);return{cancel:()=>m.cancelAnimationFrame(t)}},getImageData(i,t=0){const{width:r,height:l}=i;zr||(zr=m.document.createElement("canvas"));const u=zr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>zr.width||l>zr.height)&&(zr.width=r,zr.height=l),u.clearRect(-t,-t,r+2*t,l+2*t),u.drawImage(i,0,0,r,l),u.getImageData(-t,-t,r+2*t,l+2*t)},resolveURL:i=>(wr||(wr=m.document.createElement("a")),wr.href=i,wr.href),get devicePixelRatio(){return m.devicePixelRatio},get prefersReducedMotion(){return!!m.matchMedia&&(Zi==null&&(Zi=m.matchMedia("(prefers-reduced-motion: reduce)")),Zi.matches)}};function Zn(i,t,r){const l=m.document.createElement(i);return t!==void 0&&(l.className=t),r&&r.appendChild(l),l}function Gi(i,t,r){const l=m.document.createElementNS("http://www.w3.org/2000/svg",i);for(const u of Object.keys(t))l.setAttributeNS(null,u,t[u]);return r&&r.appendChild(l),l}const Sr=m.document&&m.document.documentElement.style,Ts=Sr&&Sr.userSelect!==void 0?"userSelect":"WebkitUserSelect";let _u;function Lp(){Sr&&Ts&&(_u=Sr[Ts],Sr[Ts]="none")}function tc(){Sr&&Ts&&(Sr[Ts]=_u)}function Tl(i){i.preventDefault(),i.stopPropagation(),m.removeEventListener("click",Tl,!0)}function Cl(){m.addEventListener("click",Tl,!0),m.setTimeout(()=>{m.removeEventListener("click",Tl,!0)},0)}function Pl(i,t){const r=i.getBoundingClientRect();return nc(i,r,t)}function Sd(i,t){const r=i.getBoundingClientRect(),l=[];for(let u=0;u<t.length;u++)l.push(nc(i,r,t[u]));return l}function jh(i){return m.InstallTrigger!==void 0&&i.button===2&&i.ctrlKey&&m.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:i.button}function nc(i,t,r){const l=i.offsetWidth===t.width?1:i.offsetWidth/t.width;return new V((r.clientX-t.left)*l,(r.clientY-t.top)*l)}function Ad(i,t,r){r[i]&&r[i].indexOf(t)!==-1||(r[i]=r[i]||[],r[i].push(t))}function Xs(i,t,r){if(r&&r[i]){const l=r[i].indexOf(t);l!==-1&&r[i].splice(l,1)}}class Ht{constructor(t,r={}){Ue(this,r),this.type=t}}class vn extends Ht{constructor(t,r={}){super("error",Ue({error:t},r))}}class Bn{on(t,r){return this._listeners=this._listeners||{},Ad(t,r,this._listeners),this}off(t,r){return Xs(t,r,this._listeners),Xs(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ad(t,r,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,r){typeof t=="string"&&(t=new Ht(t,r||{}));const l=t.type;if(this.listens(l)){t.target=this;const u=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const g of u)g.call(this,t);const h=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const g of h)Xs(l,g,this._oneTimeListeners),g.call(this,t);const p=this._eventedParent;p&&(Ue(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),p.fire(t))}else t instanceof vn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var nt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class sn{constructor(t,r,l,u){this.message=(t?`${t}: `:"")+l,u&&(this.identifier=u),r!=null&&r.__line__&&(this.line=r.__line__)}}class Ys extends sn{}function Cs(i,...t){for(const r of t)for(const l in r)i[l]=r[l];return i}function Wi(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function ii(i){if(Array.isArray(i))return i.map(ii);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const r in i)t[r]=ii(i[r]);return t}return Wi(i)}class Ed extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}var Ps=Ed;class Ao{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[l,u]of r)this.bindings[l]=u}concat(t){return new Ao(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Rp=Ao;const Zs={kind:"null"},tn={kind:"number"},ma={kind:"string"},wa={kind:"boolean"},Ki={kind:"color"},Fr={kind:"object"},na={kind:"value"},jo={kind:"collator"},Ic={kind:"formatted"},Lc={kind:"resolvedImage"};function Ri(i,t){return{kind:"array",itemType:i,N:t}}function di(i){if(i.kind==="array"){const t=di(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Md=[Zs,tn,ma,wa,Ki,Ic,Fr,Ri(na),Lc];function Il(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Il(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const r of Md)if(!Il(r,t))return null}}return`Expected ${di(i)} but found ${di(t)} instead.`}function Eo(i,t){return t.some(r=>r.kind===i.kind)}function fr(i,t){return t.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}var bu,Ks={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ll(i){return(i=Math.round(i))<0?0:i>255?255:i}function xu(i){return Ll(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function Td(i){return(t=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:t>1?1:t;var t}function Nr(i,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?i+(t-i)*r*6:2*r<1?t:3*r<2?i+(t-i)*(2/3-r)*6:i}try{bu={}.parseCSSColor=function(i){var t,r=i.replace(/ /g,"").toLowerCase();if(r in Ks)return Ks[r].slice();if(r[0]==="#")return r.length===4?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:r.length===7&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=r.indexOf("("),u=r.indexOf(")");if(l!==-1&&u+1===r.length){var h=r.substr(0,l),p=r.substr(l+1,u-(l+1)).split(","),g=1;switch(h){case"rgba":if(p.length!==4)return null;g=Td(p.pop());case"rgb":return p.length!==3?null:[xu(p[0]),xu(p[1]),xu(p[2]),g];case"hsla":if(p.length!==4)return null;g=Td(p.pop());case"hsl":if(p.length!==3)return null;var v=(parseFloat(p[0])%360+360)%360/360,b=Td(p[1]),w=Td(p[2]),A=w<=.5?w*(b+1):w+b-w*b,C=2*w-A;return[Ll(255*Nr(C,A,v+1/3)),Ll(255*Nr(C,A,v)),Ll(255*Nr(C,A,v-1/3)),g];default:return null}}return null}}catch{}class Ti{constructor(t,r,l,u=1){this.r=t,this.g=r,this.b=l,this.a=u}static parse(t){if(!t)return;if(t instanceof Ti)return t;if(typeof t!="string")return;const r=bu(t);return r?new Ti(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,r,l,u]=this.toArray();return`rgba(${Math.round(t)},${Math.round(r)},${Math.round(l)},${u})`}toArray(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[255*t/u,255*r/u,255*l/u,u]}toArray01(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[t/u,r/u,l/u,u]}toArray01Scaled(t){const{r,g:l,b:u,a:h}=this;return h===0?[0,0,0]:[r/h*t,l/h*t,u/h*t]}toArray01PremultipliedAlpha(){const{r:t,g:r,b:l,a:u}=this;return[t,r,l,u]}toArray01Linear(){const{r:t,g:r,b:l,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(t/u,2.2),Math.pow(r/u,2.2),Math.pow(l/u,2.2),u]}}Ti.black=new Ti(0,0,0,1),Ti.white=new Ti(1,1,1,1),Ti.transparent=new Ti(0,0,0,0),Ti.red=new Ti(1,0,0,1),Ti.blue=new Ti(0,0,1,1);var xn=Ti;class ar{constructor(t,r,l){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $o{constructor(t,r,l,u,h){this.text=t.normalize?t.normalize():t,this.image=r,this.scale=l,this.fontStack=u,this.textColor=h}}class Ar{constructor(t){this.sections=t}static fromString(t){return new Ar([new $o(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof Ar?t:Ar.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const r of this.sections){if(r.image){t.push(["image",r.image.namePrimary]);continue}t.push(r.text);const l={};r.fontStack&&(l["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(l["font-scale"]=r.scale),r.textColor&&(l["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(l)}return t}}class is{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,r){return t?new is({namePrimary:t,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function b_(i,t,r,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,r,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,r,l]:[i,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof xn||i instanceof ar||i instanceof Ar||i instanceof is)return!0;if(Array.isArray(i)){for(const t of i)if(!rs(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!rs(i[t]))return!1;return!0}return!1}function Ci(i){if(i===null)return Zs;if(typeof i=="string")return ma;if(typeof i=="boolean")return wa;if(typeof i=="number")return tn;if(i instanceof xn)return Ki;if(i instanceof ar)return jo;if(i instanceof Ar)return Ic;if(i instanceof is)return Lc;if(Array.isArray(i)){const t=i.length;let r;for(const l of i){const u=Ci(l);if(r){if(r===u)continue;r=na;break}r=u}return Ri(r||na,t)}return Fr}function wu(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof xn||i instanceof Ar||i instanceof is?i.toString():JSON.stringify(i)}class Zg{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!rs(t[1]))return r.error("invalid value");const l=t[1];let u=Ci(l);const h=r.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new Zg(u,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof xn?["rgba"].concat(this.value.toArray()):this.value instanceof Ar?this.value.serialize():this.value}}var Su=Zg,Er=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Kg={string:ma,number:tn,boolean:wa,object:Fr};class kp{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let l,u=1;const h=t[0];if(h==="array"){let g,v;if(t.length>2){const b=t[1];if(typeof b!="string"||!(b in Kg)||b==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);g=Kg[b],u++}else g=na;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);v=t[2],u++}l=Ri(g,v)}else l=Kg[h];const p=[];for(;u<t.length;u++){const g=r.parse(t[u],u,na);if(!g)return null;p.push(g)}return new kp(l,p)}evaluate(t){for(let r=0;r<this.args.length;r++){const l=this.args[r].evaluate(t);if(!Il(this.type,Ci(l)))return l;if(r===this.args.length-1)throw new Er(`Expected value to be of type ${di(this.type)}, but found ${di(Ci(l))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,r=[t.kind];if(t.kind==="array"){const l=t.itemType;if(l.kind==="string"||l.kind==="number"||l.kind==="boolean"){r.push(l.kind);const u=t.N;(typeof u=="number"||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(l=>l.serialize()))}}var Js=kp;class $h{constructor(t){this.type=Ic,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return r.error("First argument must be an image or text section.");const u=[];let h=!1;for(let p=1;p<=t.length-1;++p){const g=t[p];if(h&&typeof g=="object"&&!Array.isArray(g)){h=!1;let v=null;if(g["font-scale"]&&(v=r.parse(g["font-scale"],1,tn),!v))return null;let b=null;if(g["text-font"]&&(b=r.parse(g["text-font"],1,Ri(ma)),!b))return null;let w=null;if(g["text-color"]&&(w=r.parse(g["text-color"],1,Ki),!w))return null;const A=u[u.length-1];A.scale=v,A.font=b,A.textColor=w}else{const v=r.parse(t[p],1,na);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new $h(u)}evaluate(t){return new Ar(this.sections.map(r=>{const l=r.content.evaluate(t);return Ci(l)===Lc?new $o("",l,null,null,null):new $o(wu(l),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const r of this.sections){t.push(r.content.serialize());const l={};r.scale&&(l["font-scale"]=r.scale.serialize()),r.font&&(l["text-font"]=r.font.serialize()),r.textColor&&(l["text-color"]=r.textColor.serialize()),t.push(l)}return t}}class qh{constructor(t,r){this.type=Lc,this.inputPrimary=t,this.inputSecondary=r}static parse(t,r){if(t.length<2)return r.error("Expected two or more arguments.");const l=r.parse(t[1],1,ma);if(!l)return r.error("No image name provided.");if(t.length===2)return new qh(l);const u=r.parse(t[2],1,ma);return u?new qh(l,u):r.error("Secondary image variant is not a string.")}evaluate(t){const r=is.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&t.availableImages&&(r.available=t.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function ka(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}const x_={"to-boolean":wa,"to-color":Ki,"to-number":tn,"to-string":ma};class Au{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const l=t[0],u=[];let h=Zs;if(l==="to-array"){if(!Array.isArray(t[1]))return null;const p=t[1].length;if(r.expectedType){if(r.expectedType.kind!=="array")return r.error(`Expected ${r.expectedType.kind} but found array.`);h=Ri(r.expectedType.itemType,p)}else{if(!(p>0&&rs(t[1][0])))return null;h=Ri(Ci(t[1][0]),p)}for(let g=0;g<p;g++){const v=t[1][g];let b;if(ka(v)==="array")b=r.parse(v,void 0,h.itemType);else{const w=ka(v);if(w!==h.itemType.kind)return r.error(`Expected ${h.itemType.kind} but found ${w}.`);b=r.registry.literal.parse(["literal",v===void 0?null:v],r)}if(!b)return null;u.push(b)}}else{if((l==="to-boolean"||l==="to-string")&&t.length!==2)return r.error("Expected one argument.");h=x_[l];for(let p=1;p<t.length;p++){const g=r.parse(t[p],p,na);if(!g)return null;u.push(g)}}return new Au(h,u)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let r,l;for(const u of this.args){if(r=u.evaluate(t),l=null,r instanceof xn)return r;if(typeof r=="string"){const h=t.parseColor(r);if(h)return h}else if(Array.isArray(r)&&(l=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:b_(r[0],r[1],r[2],r[3]),!l))return new xn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Er(l||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const l of this.args){if(r=l.evaluate(t),r===null)return 0;const u=Number(r);if(!isNaN(u))return u}throw new Er(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Ar.fromString(wu(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?is.fromString(wu(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(r=>r.evaluate(t)):wu(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new $h([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new qh(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{t.push(r.serialize())}),t}}var Qs=Au;const Jg=["Unknown","Point","LineString","Polygon"];var Dp=class{constructor(i){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=i}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Jg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:l}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-i[0])+this.featureDistanceData.bearing[1]*(l*t-i[1])}return 0}parseColor(i){let t=this._parseColorCache[i];return t||(t=this._parseColorCache[i]=xn.parse(i)),t}getConfig(i){return this.options?this.options.get(i):null}};class Mo{constructor(t,r,l,u){this.name=t,this.type=r,this._evaluate=l,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,r){const l=t[0],u=Mo.definitions[l];if(!u)return r.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(u)?u[0]:u.type,p=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=p.filter(([b])=>!Array.isArray(b)||b.length===t.length-1);let v=null;for(const[b,w]of g){v=new uy(r.registry,r.path,null,r.scope,void 0,r.options);const A=[];let C=!1;for(let P=1;P<t.length;P++){const R=t[P],z=Array.isArray(b)?b[P-1]:b.type,U=v.parse(R,1+A.length,z);if(!U){C=!0;break}A.push(U)}if(!C)if(Array.isArray(b)&&b.length!==A.length)v.error(`Expected ${b.length} arguments, but found ${A.length} instead.`);else{for(let P=0;P<A.length;P++){const R=Array.isArray(b)?b[P]:b.type,z=A[P];v.concat(P+1).checkSubtype(R,z.type)}if(v.errors.length===0)return new Mo(l,h,w,A)}}if(g.length===1)r.errors.push(...v.errors);else{const b=(g.length?g:p).map(([A])=>{return C=A,Array.isArray(C)?`(${C.map(di).join(", ")})`:`(${di(C.type)}...)`;var C}).join(" | "),w=[];for(let A=1;A<t.length;A++){const C=r.parse(t[A],1+w.length);if(!C)return null;w.push(di(C.type))}r.error(`Expected arguments of type ${b}, but found (${w.join(", ")}) instead.`)}return null}static register(t,r){Mo.definitions=r;for(const l in r)t[l]=Mo}}var Mr=Mo;class ac{constructor(t,r,l){this.type=jo,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return r.error("Collator options argument must be an object.");const u=r.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,wa);if(!u)return null;const h=r.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,wa);if(!h)return null;let p=null;return l.locale&&(p=r.parse(l.locale,1,ma),!p)?null:new ac(u,h,p)}evaluate(t){return new ar(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var ic={exports:{}};ic.exports=function(){function i(l,u,h,p,g){for(;p>h;){if(p-h>600){var v=p-h+1,b=u-h+1,w=Math.log(v),A=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*A*(v-A)/v)*(b-v/2<0?-1:1);i(l,u,Math.max(h,Math.floor(u-b*A/v+C)),Math.min(p,Math.floor(u+(v-b)*A/v+C)),g)}var P=l[u],R=h,z=p;for(t(l,h,u),g(l[p],P)>0&&t(l,h,p);R<z;){for(t(l,R,z),R++,z--;g(l[R],P)<0;)R++;for(;g(l[z],P)>0;)z--}g(l[h],P)===0?t(l,h,z):t(l,++z,p),z<=u&&(h=z+1),u<=z&&(p=z-1)}}function t(l,u,h){var p=l[u];l[u]=l[h],l[h]=p}function r(l,u){return l<u?-1:l>u?1:0}return function(l,u,h,p,g){i(l,u,h||0,p||l.length-1,g||r)}}();var Rc=F(ic.exports);function Cd(i){let t=0;for(let r,l,u=0,h=i.length,p=h-1;u<h;p=u++)r=i[u],l=i[p],t+=(l.x-r.x)*(r.y+l.y);return t}function Xh(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Pd(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function w_(i,t,r){const l=i[0]-t[0],u=i[1]-t[1],h=i[0]-r[0],p=i[1]-r[1];return l*p-h*u==0&&l*h<=0&&u*p<=0}function fo(i,t,r=!1){let l=!1;for(let g=0,v=t.length;g<v;g++){const b=t[g];for(let w=0,A=b.length,C=A-1;w<A;C=w++){const P=b[C],R=b[w];if(w_(i,P,R))return r;(h=P)[1]>(u=i)[1]!=(p=R)[1]>u[1]&&u[0]<(p[0]-h[0])*(u[1]-h[1])/(p[1]-h[1])+h[0]&&(l=!l)}}var u,h,p;return l}function os(i,t,r,l){const u=l[0]-r[0],h=l[1]-r[1],p=(i[0]-r[0])*h-u*(i[1]-r[1]),g=(t[0]-r[0])*h-u*(t[1]-r[1]);return p>0&&g<0||p<0&&g>0}function ki(i,t,r,l){return(u=[l[0]-r[0],l[1]-r[1]])[0]*(h=[t[0]-i[0],t[1]-i[1]])[1]-u[1]*h[0]!=0&&!(!os(i,t,r,l)||!os(r,l,i,t));var u,h}const el=8192;function Rl(i,t){const r=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(r*u*el),Math.round(l*u*el)]}function Kw(i,t){for(let r=0;r<t.length;r++)if(fo(i,t[r]))return!0;return!1}function Jw(i,t,r){for(const l of r)for(let u=0,h=l.length,p=h-1;u<h;p=u++)if(ki(i,t,l[p],l[u]))return!0;return!1}function Qg(i,t){for(let r=0;r<i.length;++r)if(!fo(i[r],t))return!1;for(let r=0;r<i.length-1;++r)if(Jw(i[r],i[r+1],t))return!1;return!0}function S_(i,t){for(let r=0;r<t.length;r++)if(Qg(i,t[r]))return!0;return!1}function ey(i,t,r){const l=[];for(let u=0;u<i.length;u++){const h=[];for(let p=0;p<i[u].length;p++){const g=Rl(i[u][p],r);Xh(t,g),h.push(g)}l.push(h)}return l}function Yh(i,t,r){const l=[];for(let u=0;u<i.length;u++){const h=ey(i[u],t,r);l.push(h)}return l}function Id(i,t,r,l){if(i[0]<r[0]||i[0]>r[2]){const u=.5*l;let h=i[0]-r[0]>u?-l:r[0]-i[0]>u?l:0;h===0&&(h=i[0]-r[2]>u?-l:r[2]-i[0]>u?l:0),i[0]+=h}Xh(t,i)}function ty(i,t,r,l){const u=Math.pow(2,l.z)*el,h=[l.x*el,l.y*el],p=[];if(!i)return p;for(const g of i)for(const v of g){const b=[v.x+h[0],v.y+h[1]];Id(b,t,r,u),p.push(b)}return p}function Zh(i,t,r,l){const u=Math.pow(2,l.z)*el,h=[l.x*el,l.y*el],p=[];if(!i)return p;for(const v of i){const b=[];for(const w of v){const A=[w.x+h[0],w.y+h[1]];Xh(t,A),b.push(A)}p.push(b)}if(t[2]-t[0]<=u/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of p)for(const b of v)Id(b,t,r,u)}var g;return p}class Eu{constructor(t,r){this.type=wa,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(rs(t[1])){const l=t[1];if(l.type==="FeatureCollection")for(let u=0;u<l.features.length;++u){const h=l.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Eu(l,l.features[u].geometry)}else if(l.type==="Feature"){const u=l.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Eu(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Eu(l,l)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,l){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(l.type==="Polygon"){const g=ey(l.coordinates,h,p),v=ty(r.geometry(),u,h,p);if(!Pd(u,h))return!1;for(const b of v)if(!fo(b,g))return!1}if(l.type==="MultiPolygon"){const g=Yh(l.coordinates,h,p),v=ty(r.geometry(),u,h,p);if(!Pd(u,h))return!1;for(const b of v)if(!Kw(b,g))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,l){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],p=r.canonicalID();if(!p)return!1;if(l.type==="Polygon"){const g=ey(l.coordinates,h,p),v=Zh(r.geometry(),u,h,p);if(!Pd(u,h))return!1;for(const b of v)if(!Qg(b,g))return!1}if(l.type==="MultiPolygon"){const g=Yh(l.coordinates,h,p),v=Zh(r.geometry(),u,h,p);if(!Pd(u,h))return!1;for(const b of v)if(!S_(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ny=Eu,A_={exports:{}};A_.exports=function(){var i={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,r=t*(2-t),l=Math.PI/180,u=function(b,w){if(b===void 0)throw new Error("No latitude given.");if(w&&!i[w])throw new Error("Unknown unit "+w+". Use one of: "+Object.keys(i).join(", "));var A=6378.137*l*(w?i[w]:1),C=Math.cos(b*l),P=1/(1-r*(1-C*C)),R=Math.sqrt(P);this.kx=A*R*C,this.ky=A*R*P*(1-r)},h={units:{configurable:!0}};function p(b,w){return b[0]===w[0]&&b[1]===w[1]}function g(b,w,A){var C=v(w[0]-b[0]);return[b[0]+C*A,b[1]+(w[1]-b[1])*A]}function v(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return u.fromTile=function(b,w,A){var C=Math.PI*(1-2*(b+.5)/Math.pow(2,w)),P=Math.atan(.5*(Math.exp(C)-Math.exp(-C)))/l;return new u(P,A)},h.units.get=function(){return i},u.prototype.distance=function(b,w){var A=v(b[0]-w[0])*this.kx,C=(b[1]-w[1])*this.ky;return Math.sqrt(A*A+C*C)},u.prototype.bearing=function(b,w){var A=v(w[0]-b[0])*this.kx;return Math.atan2(A,(w[1]-b[1])*this.ky)/l},u.prototype.destination=function(b,w,A){var C=A*l;return this.offset(b,Math.sin(C)*w,Math.cos(C)*w)},u.prototype.offset=function(b,w,A){return[b[0]+w/this.kx,b[1]+A/this.ky]},u.prototype.lineDistance=function(b){for(var w=0,A=0;A<b.length-1;A++)w+=this.distance(b[A],b[A+1]);return w},u.prototype.area=function(b){for(var w=0,A=0;A<b.length;A++)for(var C=b[A],P=0,R=C.length,z=R-1;P<R;z=P++)w+=v(C[P][0]-C[z][0])*(C[P][1]+C[z][1])*(A?-1:1);return Math.abs(w)/2*this.kx*this.ky},u.prototype.along=function(b,w){var A=0;if(w<=0)return b[0];for(var C=0;C<b.length-1;C++){var P=b[C],R=b[C+1],z=this.distance(P,R);if((A+=z)>w)return g(P,R,(w-(A-z))/z)}return b[b.length-1]},u.prototype.pointToSegmentDistance=function(b,w,A){var C=w[0],P=w[1],R=v(A[0]-C)*this.kx,z=(A[1]-P)*this.ky,U=0;return R===0&&z===0||((U=(v(b[0]-C)*this.kx*R+(b[1]-P)*this.ky*z)/(R*R+z*z))>1?(C=A[0],P=A[1]):U>0&&(C+=R/this.kx*U,P+=z/this.ky*U)),R=v(b[0]-C)*this.kx,z=(b[1]-P)*this.ky,Math.sqrt(R*R+z*z)},u.prototype.pointOnLine=function(b,w){for(var A,C,P,R,z=1/0,U=0;U<b.length-1;U++){var W=b[U][0],j=b[U][1],Y=v(b[U+1][0]-W)*this.kx,Z=(b[U+1][1]-j)*this.ky,$=0;Y===0&&Z===0||(($=(v(w[0]-W)*this.kx*Y+(w[1]-j)*this.ky*Z)/(Y*Y+Z*Z))>1?(W=b[U+1][0],j=b[U+1][1]):$>0&&(W+=Y/this.kx*$,j+=Z/this.ky*$));var K=(Y=v(w[0]-W)*this.kx)*Y+(Z=(w[1]-j)*this.ky)*Z;K<z&&(z=K,A=W,C=j,P=U,R=$)}return{point:[A,C],index:P,t:Math.max(0,Math.min(1,R))}},u.prototype.lineSlice=function(b,w,A){var C=this.pointOnLine(A,b),P=this.pointOnLine(A,w);if(C.index>P.index||C.index===P.index&&C.t>P.t){var R=C;C=P,P=R}var z=[C.point],U=C.index+1,W=P.index;!p(A[U],z[0])&&U<=W&&z.push(A[U]);for(var j=U+1;j<=W;j++)z.push(A[j]);return p(A[W],P.point)||z.push(P.point),z},u.prototype.lineSliceAlong=function(b,w,A){for(var C=0,P=[],R=0;R<A.length-1;R++){var z=A[R],U=A[R+1],W=this.distance(z,U);if((C+=W)>b&&P.length===0&&P.push(g(z,U,(b-(C-W))/W)),C>=w)return P.push(g(z,U,(w-(C-W))/W)),P;C>b&&P.push(U)}return P},u.prototype.bufferPoint=function(b,w){var A=w/this.ky,C=w/this.kx;return[b[0]-C,b[1]-A,b[0]+C,b[1]+A]},u.prototype.bufferBBox=function(b,w){var A=w/this.ky,C=w/this.kx;return[b[0]-C,b[1]-A,b[2]+C,b[3]+A]},u.prototype.insideBBox=function(b,w){return v(b[0]-w[0])>=0&&v(b[0]-w[2])<=0&&b[1]>=w[1]&&b[1]<=w[3]},Object.defineProperties(u,h),u}();var Mu=F(A_.exports),E_={exports:{}};E_.exports=function(){var i=function(r,l){if(r===void 0&&(r=[]),l===void 0&&(l=t),this.data=r,this.length=this.data.length,this.compare=l,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function t(r,l){return r<l?-1:r>l?1:0}return i.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var r=this.data[0],l=this.data.pop();return this.length--,this.length>0&&(this.data[0]=l,this._down(0)),r}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(r){for(var l=this.data,u=this.compare,h=l[r];r>0;){var p=r-1>>1,g=l[p];if(u(h,g)>=0)break;l[r]=g,r=p}l[r]=h},i.prototype._down=function(r){for(var l=this.data,u=this.compare,h=this.length>>1,p=l[r];r<h;){var g=1+(r<<1),v=l[g],b=g+1;if(b<this.length&&u(l[b],v)<0&&(g=b,v=l[b]),u(v,p)>=0)break;l[r]=v,r=g}l[r]=p},i}();var Ld=F(E_.exports),ht=8192;function Kh(i,t){return t.dist-i.dist}const Tu=100,tl=50;function ay(i){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==i[r])return!1;return!0}function kc(i){return i[1]-i[0]+1}function rc(i,t){const r=i[1]>=i[0]&&i[1]<t;return r||console.warn("Distance Expression: Index is out of range"),r}function Op(i,t){if(i[0]>i[1])return[null,null];const r=kc(i);if(t){if(r===2)return[i,null];const l=Math.floor(r/2);return[[i[0],i[0]+l],[i[0]+l,i[1]]]}{if(r===1)return[i,null];const l=Math.floor(r/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}}function gi(i,t){const r=[1/0,1/0,-1/0,-1/0];if(!rc(t,i.length))return r;for(let l=t[0];l<=t[1];++l)Xh(r,i[l]);return r}function Rd(i){const t=[1/0,1/0,-1/0,-1/0];for(let r=0;r<i.length;++r)for(let l=0;l<i[r].length;++l)Xh(t,i[r][l]);return t}function Cu(i,t,r){if(ay(i)||ay(t))return NaN;let l=0,u=0;return i[2]<t[0]&&(l=t[0]-i[2]),i[0]>t[2]&&(l=i[0]-t[2]),i[1]>t[3]&&(u=i[1]-t[3]),i[3]<t[1]&&(u=t[1]-i[3]),r.distance([0,0],[l,u])}function zp(i,t){const r=Math.pow(2,t.z);return[(u=(i.x/ht+t.x)/r,360*u-180),(l=(i.y/ht+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,u}function iy(i,t){const r=[];for(let l=0;l<i.length;++l)r.push(zp(i[l],t));return r}function Is(i,t,r){const l=r.pointOnLine(t,i).point;return r.distance(i,l)}function kd(i,t,r,l,u){const h=r.slice(l[0],l[1]+1);let p=1/0;for(let g=t[0];g<=t[1];++g)if((p=Math.min(p,Is(i[g],h,u)))===0)return 0;return p}function Ji(i,t,r,l,u){const h=Math.min(u.pointToSegmentDistance(i,r,l),u.pointToSegmentDistance(t,r,l)),p=Math.min(u.pointToSegmentDistance(r,i,t),u.pointToSegmentDistance(l,i,t));return Math.min(h,p)}function Oo(i,t,r,l,u){if(!rc(t,i.length)||!rc(l,r.length))return NaN;let h=1/0;for(let p=t[0];p<t[1];++p)for(let g=l[0];g<l[1];++g){if(ki(i[p],i[p+1],r[g],r[g+1]))return 0;h=Math.min(h,Ji(i[p],i[p+1],r[g],r[g+1],u))}return h}function po(i,t,r,l,u){if(!rc(t,i.length)||!rc(l,r.length))return NaN;let h=1/0;for(let p=t[0];p<=t[1];++p)for(let g=l[0];g<=l[1];++g)if((h=Math.min(h,u.distance(i[p],r[g])))===0)return h;return h}function ry(i,t,r){if(fo(i,t,!0))return 0;let l=1/0;for(const u of t){const h=u.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[h-1]&&(l=Math.min(l,r.pointToSegmentDistance(i,u[h-1],u[0])))===0||(l=Math.min(l,Is(i,u,r)))===0)return l}return l}function Fp(i,t,r,l){if(!rc(t,i.length))return NaN;for(let h=t[0];h<=t[1];++h)if(fo(i[h],r,!0))return 0;let u=1/0;for(let h=t[0];h<t[1];++h)for(const p of r)for(let g=0,v=p.length,b=v-1;g<v;b=g++){if(ki(i[h],i[h+1],p[b],p[g]))return 0;u=Math.min(u,Ji(i[h],i[h+1],p[b],p[g],l))}return u}function Jh(i,t){for(const r of i)for(let l=0;l<=r.length-1;++l)if(fo(r[l],t,!0))return!0;return!1}function yC(i,t,r,l=1/0){const u=Rd(i),h=Rd(t);if(l!==1/0&&Cu(u,h,r)>=l)return l;if(Pd(u,h)){if(Jh(i,t))return 0}else if(Jh(t,i))return 0;let p=l;for(const g of i)for(let v=0,b=g.length,w=b-1;v<b;w=v++)for(const A of t)for(let C=0,P=A.length,R=P-1;C<P;R=C++){if(ki(g[w],g[v],A[R],A[C]))return 0;p=Math.min(p,Ji(g[w],g[v],A[R],A[C],r))}return p}function Jr(i,t,r,l,u,h,p){if(h===null||p===null)return;const g=Cu(gi(l,h),gi(u,p),r);g<t&&i.push({dist:g,range1:h,range2:p})}function M_(i,t,r,l,u=1/0){let h=Math.min(l.distance(i[0],r[0][0]),u);if(h===0)return h;const p=new Ld([{dist:0,range1:[0,i.length-1],range2:[0,0]}],Kh),g=t?tl:Tu,v=Rd(r);for(;p.length;){const b=p.pop();if(b.dist>=h)continue;const w=b.range1;if(kc(w)<=g){if(!rc(w,i.length))return NaN;if(t){const A=Fp(i,w,r,l);if((h=Math.min(h,A))===0)return h}else for(let A=w[0];A<=w[1];++A){const C=ry(i[A],r,l);if((h=Math.min(h,C))===0)return h}}else{const A=Op(w,t);if(A[0]!==null){const C=Cu(gi(i,A[0]),v,l);C<h&&p.push({dist:C,range1:A[0],range2:[0,0]})}if(A[1]!==null){const C=Cu(gi(i,A[1]),v,l);C<h&&p.push({dist:C,range1:A[1],range2:[0,0]})}}}return h}function oy(i,t,r,l,u,h=1/0){let p=Math.min(h,u.distance(i[0],r[0]));if(p===0)return p;const g=new Ld([{dist:0,range1:[0,i.length-1],range2:[0,r.length-1]}],Kh),v=t?tl:Tu,b=l?tl:Tu;for(;g.length;){const w=g.pop();if(w.dist>=p)continue;const A=w.range1,C=w.range2;if(kc(A)<=v&&kc(C)<=b){if(!rc(A,i.length)||!rc(C,r.length))return NaN;if(t&&l?p=Math.min(p,Oo(i,A,r,C,u)):t||l?t&&!l?p=Math.min(p,kd(r,C,i,A,u)):!t&&l&&(p=Math.min(p,kd(i,A,r,C,u))):p=Math.min(p,po(i,A,r,C,u)),p===0)return p}else{const P=Op(A,t),R=Op(C,l);Jr(g,p,u,i,r,P[0],R[0]),Jr(g,p,u,i,r,P[0],R[1]),Jr(g,p,u,i,r,P[1],R[0]),Jr(g,p,u,i,r,P[1],R[1])}}return p}function Np(i,t,r,l,u=1/0){let h=u;const p=gi(i,[0,i.length-1]);for(const g of r)if(!(h!==1/0&&Cu(p,gi(g,[0,g.length-1]),l)>=h)&&(h=Math.min(h,oy(i,t,g,!0,l,h)),h===0))return h;return h}function nl(i,t,r,l,u=1/0){let h=u;const p=gi(i,[0,i.length-1]);for(const g of r){if(h!==1/0&&Cu(p,Rd(g),l)>=h)continue;const v=M_(i,t,g,l,h);if(isNaN(v))return v;if((h=Math.min(h,v))===0)return h}return h}function al(i){return i==="Point"||i==="MultiPoint"||i==="LineString"||i==="MultiLineString"||i==="Polygon"||i==="MultiPolygon"}class kl{constructor(t,r){this.type=tn,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(rs(t[1])){const l=t[1];if(l.type==="FeatureCollection"){for(let u=0;u<l.features.length;++u)if(al(l.features[u].geometry.type))return new kl(l,l.features[u].geometry)}else if(l.type==="Feature"){if(al(l.geometry.type))return new kl(l,l.geometry)}else if(al(l.type))return new kl(l,l)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const r=t.geometry(),l=t.canonicalID();if(r!=null&&l!=null){if(t.geometryType()==="Point")return function(u,h,p){const g=[];for(const b of u)for(const w of b)g.push(zp(w,h));const v=new Mu(g[0][1],"meters");return p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString"?oy(g,!1,p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",v):p.type==="MultiLineString"?Np(g,!1,p.coordinates,v):p.type==="Polygon"||p.type==="MultiPolygon"?nl(g,!1,p.type==="Polygon"?[p.coordinates]:p.coordinates,v):null}(r,l,this.geometries);if(t.geometryType()==="LineString")return function(u,h,p){const g=[];for(const b of u){const w=[];for(const A of b)w.push(zp(A,h));g.push(w)}const v=new Mu(g[0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return Np(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",g,v);if(p.type==="MultiLineString"){let b=1/0;for(let w=0;w<p.coordinates.length;w++){const A=Np(p.coordinates[w],!0,g,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}if(p.type==="Polygon"||p.type==="MultiPolygon"){let b=1/0;for(let w=0;w<g.length;w++){const A=nl(g[w],!0,p.type==="Polygon"?[p.coordinates]:p.coordinates,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}return null}(r,l,this.geometries);if(t.geometryType()==="Polygon")return function(u,h,p){const g=[];for(const b of function(w,A){const C=w.length;if(C<=1)return[w];const P=[];let R,z;for(let U=0;U<C;U++){const W=Cd(w[U]);W!==0&&(w[U].area=Math.abs(W),z===void 0&&(z=W<0),z===W<0?(R&&P.push(R),R=[w[U]]):R.push(w[U]))}return R&&P.push(R),P}(u)){const w=[];for(let A=0;A<b.length;++A)w.push(iy(b[A],h));g.push(w)}const v=new Mu(g[0][0][0][1],"meters");if(p.type==="Point"||p.type==="MultiPoint"||p.type==="LineString")return nl(p.type==="Point"?[p.coordinates]:p.coordinates,p.type==="LineString",g,v);if(p.type==="MultiLineString"){let b=1/0;for(let w=0;w<p.coordinates.length;w++){const A=nl(p.coordinates[w],!0,g,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}return p.type==="Polygon"||p.type==="MultiPolygon"?function(b,w,A){let C=1/0;for(const P of b)for(const R of w){const z=yC(P,R,A,C);if(isNaN(z))return z;if((C=Math.min(C,z))===0)return C}return C}(p.type==="Polygon"?[p.coordinates]:p.coordinates,g,v):null}(r,l,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Qh=kl;function Pu(i){if(i instanceof Mr&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ny||i instanceof Qh)return!1;let t=!0;return i.eachChild(r=>{t&&!Pu(r)&&(t=!1)}),t}function Bp(i){if(i instanceof Mr&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(r=>{t&&!Bp(r)&&(t=!1)}),t}function sy(i){if(i instanceof Mr&&i.name==="config")return!1;let t=!0;return i.eachChild(r=>{t&&!sy(r)&&(t=!1)}),t}function Dd(i,t){if(i instanceof Mr&&t.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(l=>{r&&!Dd(l,t)&&(r=!1)}),r}class ly{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const l=t[1];return r.scope.has(l)?new ly(l,r.scope.get(l)):r.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var T_=ly;class cy{constructor(t,r=[],l,u=new Rp,h=[],p){this.registry=t,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=h,this.expectedType=l,this.options=p}parse(t,r,l,u,h={}){return r||l?this.concat(r,l,u)._parse(t,h):this._parse(t,h)}_parse(t,r){function l(u,h,p){return p==="assert"?new Js(h,[u]):p==="coerce"?new Qs(h,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(u){let h=u.parse(t,this);if(!h)return null;if(this.expectedType){const p=this.expectedType,g=h.type;if(p.kind!=="string"&&p.kind!=="number"&&p.kind!=="boolean"&&p.kind!=="object"&&p.kind!=="array"||g.kind!=="value")if(p.kind!=="color"&&p.kind!=="formatted"&&p.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(p,g))return null}else h=l(h,p,r.typeAnnotation||"coerce");else h=l(h,p,r.typeAnnotation||"assert")}if(!(h instanceof Su)&&h.type.kind!=="resolvedImage"&&Od(h)){const p=new Dp(this.options);try{h=new Su(h.type,h.evaluate(p))}catch(g){return this.error(g.message),null}}return h}return Qs.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,l){const u=typeof t=="number"?this.path.concat(t):this.path,h=l?this.scope.concat(l):this.scope;return new cy(this.registry,u,r||null,h,this.errors,this.options)}error(t,...r){const l=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Ps(l,t))}checkSubtype(t,r){const l=Il(t,r);return l&&this.error(l),l}}var uy=cy;function Od(i){if(i instanceof T_)return Od(i.boundExpression);if(i instanceof Mr&&i.name==="error"||i instanceof Mr&&i.name==="config"||i instanceof ac||i instanceof ny||i instanceof Qh)return!1;const t=i instanceof Qs||i instanceof Js;let r=!0;return i.eachChild(l=>{r=t?r&&Od(l):r&&l instanceof Su}),!!r&&Pu(i)&&Dd(i,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Up(i,t){const r=i.length-1;let l,u,h=0,p=r,g=0;for(;h<=p;)if(g=Math.floor((h+p)/2),l=i[g],u=i[g+1],l<=t){if(g===r||t<u)return g;h=g+1}else{if(!(l>t))throw new Er("Input is not a number.");p=g-1}return 0}class ef{constructor(t,r,l){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[u,h]of l)this.labels.push(u),this.outputs.push(h)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const l=r.parse(t[1],1,tn);if(!l)return null;const u=[];let h=null;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);for(let p=1;p<t.length;p+=2){const g=p===1?-1/0:t[p],v=t[p+1],b=p,w=p+1;if(typeof g!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(u.length&&u[u.length-1][0]>=g)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const A=r.parse(v,w,h);if(!A)return null;h=h||A.type,u.push([g,A])}return new ef(h,l,u)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return l[0].evaluate(t);const h=r.length;return u>=r[h-1]?l[h-1].evaluate(t):l[Up(r,u)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t}}var tf=ef;function Ln(i,t,r){return i*(1-r)+t*r}function nf(i,t,r){return i.map((l,u)=>Ln(l,t[u],r))}var Wp=Object.freeze({__proto__:null,array:nf,color:function(i,t,r){return new xn(Ln(i.r,t.r,r),Ln(i.g,t.g,r),Ln(i.b,t.b,r),Ln(i.a,t.a,r))},number:Ln});const C_=.95047,P_=1.08883,I_=4/29,Iu=6/29,L_=3*Iu*Iu,Qw=Iu*Iu*Iu,vC=Math.PI/180,e2=180/Math.PI;function R_(i){return i>Qw?Math.pow(i,1/3):i/L_+I_}function k_(i){return i>Iu?i*i*i:L_*(i-I_)}function dy(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function hy(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function D_(i){const t=hy(i.r),r=hy(i.g),l=hy(i.b),u=R_((.4124564*t+.3575761*r+.1804375*l)/C_),h=R_((.2126729*t+.7151522*r+.072175*l)/1);return{l:116*h-16,a:500*(u-h),b:200*(h-R_((.0193339*t+.119192*r+.9503041*l)/P_)),alpha:i.a}}function O_(i){let t=(i.l+16)/116,r=isNaN(i.a)?t:t+i.a/500,l=isNaN(i.b)?t:t-i.b/200;return t=1*k_(t),r=C_*k_(r),l=P_*k_(l),new xn(dy(3.2404542*r-1.5371385*t-.4985314*l),dy(-.969266*r+1.8760108*t+.041556*l),dy(.0556434*r-.2040259*t+1.0572252*l),i.alpha)}function fy(i,t,r){const l=t-i;return i+r*(l>180||l<-180?l-360*Math.round(l/360):l)}const Vp={forward:D_,reverse:O_,interpolate:function(i,t,r){return{l:Ln(i.l,t.l,r),a:Ln(i.a,t.a,r),b:Ln(i.b,t.b,r),alpha:Ln(i.alpha,t.alpha,r)}}},Gp={forward:function(i){const{l:t,a:r,b:l}=D_(i),u=Math.atan2(l,r)*e2;return{h:u<0?u+360:u,c:Math.sqrt(r*r+l*l),l:t,alpha:i.a}},reverse:function(i){const t=i.h*vC,r=i.c;return O_({l:i.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:i.alpha})},interpolate:function(i,t,r){return{h:fy(i.h,t.h,r),c:Ln(i.c,t.c,r),l:Ln(i.l,t.l,r),alpha:Ln(i.alpha,t.alpha,r)}}};var t2=Object.freeze({__proto__:null,hcl:Gp,lab:Vp});class af{constructor(t,r,l,u,h){this.type=t,this.operator=r,this.interpolation=l,this.input=u,this.labels=[],this.outputs=[];for(const[p,g]of h)this.labels.push(p),this.outputs.push(g)}static interpolationFactor(t,r,l,u){let h=0;if(t.name==="exponential")h=Hp(r,t.base,l,u);else if(t.name==="linear")h=Hp(r,1,l,u);else if(t.name==="cubic-bezier"){const p=t.controlPoints;h=new q(p[0],p[1],p[2],p[3]).solve(Hp(r,1,l,u))}return h}static parse(t,r){let[l,u,h,...p]=t;if(!Array.isArray(u)||u.length===0)return r.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const b=u[1];if(typeof b!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:b}}else{if(u[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const b=u.slice(1);if(b.length!==4||b.some(w=>typeof w!="number"||w<0||w>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(h=r.parse(h,2,tn),!h)return null;const g=[];let v=null;l==="interpolate-hcl"||l==="interpolate-lab"?v=Ki:r.expectedType&&r.expectedType.kind!=="value"&&(v=r.expectedType);for(let b=0;b<p.length;b+=2){const w=p[b],A=p[b+1],C=b+3,P=b+4;if(typeof w!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(g.length&&g[g.length-1][0]>=w)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',C);const R=r.parse(A,P,v);if(!R)return null;v=v||R.type,g.push([w,R])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new af(v,l,u,h,g):r.error(`Type ${di(v)} is not interpolatable.`)}evaluate(t){const r=this.labels,l=this.outputs;if(r.length===1)return l[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return l[0].evaluate(t);const h=r.length;if(u>=r[h-1])return l[h-1].evaluate(t);const p=Up(r,u),g=af.interpolationFactor(this.interpolation,u,r[p],r[p+1]),v=l[p].evaluate(t),b=l[p+1].evaluate(t);return this.operator==="interpolate"?Wp[this.type.kind.toLowerCase()](v,b,g):this.operator==="interpolate-hcl"?Gp.reverse(Gp.interpolate(Gp.forward(v),Gp.forward(b),g)):Vp.reverse(Vp.interpolate(Vp.forward(v),Vp.forward(b),g))}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,t,this.input.serialize()];for(let l=0;l<this.labels.length;l++)r.push(this.labels[l],this.outputs[l].serialize());return r}}function Hp(i,t,r,l){const u=l-r,h=i-r;return u===0?0:t===1?h/u:(Math.pow(t,h)-1)/(Math.pow(t,u)-1)}var oc=af;class py{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let l=null;const u=r.expectedType;u&&u.kind!=="value"&&(l=u);const h=[];for(const g of t.slice(1)){const v=r.parse(g,1+h.length,l,void 0,{typeAnnotation:"omit"});if(!v)return null;l=l||v.type,h.push(v)}const p=u&&h.some(g=>Il(u,g.type));return new py(p?na:l,h)}evaluate(t){let r,l=null,u=0;for(const h of this.args){if(u++,l=h.evaluate(t),l&&l instanceof is&&!l.available&&(r||(r=l),l=null,u===this.args.length))return r;if(l!==null)break}return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var z_=py;class my{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let h=1;h<t.length-1;h+=2){const p=t[h];if(typeof p!="string")return r.error(`Expected string, but found ${typeof p} instead.`,h);if(/[^a-zA-Z0-9_]/.test(p))return r.error("Variable names must contain only alphanumeric characters or '_'.",h);const g=r.parse(t[h+1],h+1);if(!g)return null;l.push([p,g])}const u=r.parse(t[t.length-1],t.length-1,r.expectedType,l);return u?new my(l,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[r,l]of this.bindings)t.push(r,l.serialize());return t.push(this.result.serialize()),t}}var F_=my;class gy{constructor(t,r,l){this.type=t,this.index=r,this.input=l}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,tn),u=r.parse(t[2],2,Ri(r.expectedType||na));return l&&u?new gy(u.type.itemType,l,u):null}evaluate(t){const r=this.index.evaluate(t),l=this.input.evaluate(t);if(r<0)throw new Er(`Array index out of bounds: ${r} < 0.`);if(r>=l.length)throw new Er(`Array index out of bounds: ${r} > ${l.length-1}.`);if(r!==Math.floor(r))throw new Er(`Array index must be an integer, but found ${r} instead.`);return l[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var sc=gy;class yy{constructor(t,r){this.type=wa,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,na);return l&&u?Eo(l.type,[wa,ma,tn,Zs,na])?new yy(l,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(l.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(l==null)return!1;if(!fr(r,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${di(Ci(r))} instead.`);if(!fr(l,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${di(Ci(l))} instead.`);return l.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var jp=yy;class Lu{constructor(t,r,l){this.type=tn,this.needle=t,this.haystack=r,this.fromIndex=l}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,na);if(!l||!u)return null;if(!Eo(l.type,[wa,ma,tn,Zs,na]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${di(l.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,tn);return h?new Lu(l,u,h):null}return new Lu(l,u)}evaluate(t){const r=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!fr(r,["boolean","string","number","null"]))throw new Er(`Expected first argument to be of type boolean, string, number or null, but found ${di(Ci(r))} instead.`);if(!fr(l,["string","array"]))throw new Er(`Expected second argument to be of type array or string, but found ${di(Ci(l))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(t);return l.indexOf(r,u)}return l.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var vy=Lu;class rf{constructor(t,r,l,u,h,p){this.inputType=t,this.type=r,this.input=l,this.cases=u,this.outputs=h,this.otherwise=p}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let l,u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const h={},p=[];for(let b=2;b<t.length-1;b+=2){let w=t[b];const A=t[b+1];Array.isArray(w)||(w=[w]);const C=r.concat(b);if(w.length===0)return C.error("Expected at least one branch label.");for(const R of w){if(typeof R!="number"&&typeof R!="string")return C.error("Branch labels must be numbers or strings.");if(typeof R=="number"&&Math.abs(R)>Number.MAX_SAFE_INTEGER)return C.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof R=="number"&&Math.floor(R)!==R)return C.error("Numeric branch labels must be integer values.");if(l){if(C.checkSubtype(l,Ci(R)))return null}else l=Ci(R);if(h[String(R)]!==void 0)return C.error("Branch labels must be unique.");h[String(R)]=p.length}const P=r.parse(A,b,u);if(!P)return null;u=u||P.type,p.push(P)}const g=r.parse(t[1],1,na);if(!g)return null;const v=r.parse(t[t.length-1],t.length-1,u);return v?g.type.kind!=="value"&&r.concat(1).checkSubtype(l,g.type)?null:new rf(l,u,g,h,p,v):null}evaluate(t){const r=this.input.evaluate(t);return(Ci(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),l=[],u={};for(const p of r){const g=u[this.cases[p]];g===void 0?(u[this.cases[p]]=l.length,l.push([this.cases[p],[p]])):l[g][1].push(p)}const h=p=>this.inputType.kind==="number"?Number(p):p;for(const[p,g]of l)t.push(g.length===1?h(g[0]):g.map(h)),t.push(this.outputs[p].serialize());return t.push(this.otherwise.serialize()),t}}var n2=rf;class zd{constructor(t,r,l){this.type=t,this.branches=r,this.otherwise=l}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let l;r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);const u=[];for(let p=1;p<t.length-1;p+=2){const g=r.parse(t[p],p,wa);if(!g)return null;const v=r.parse(t[p+1],p+1,l);if(!v)return null;u.push([g,v]),l=l||v.type}const h=r.parse(t[t.length-1],t.length-1,l);return h?new zd(l,u,h):null}evaluate(t){for(const[r,l]of this.branches)if(r.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,l]of this.branches)t(r),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var zo=zd;class _y{constructor(t,r,l,u){this.type=t,this.input=r,this.beginIndex=l,this.endIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=r.parse(t[1],1,na),u=r.parse(t[2],2,tn);if(!l||!u)return null;if(!Eo(l.type,[Ri(na),ma,na]))return r.error(`Expected first argument to be of type array or string, but found ${di(l.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,tn);return h?new _y(l.type,l,u,h):null}return new _y(l.type,l,u)}evaluate(t){const r=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!fr(r,["string","array"]))throw new Er(`Expected first argument to be of type array or string, but found ${di(Ci(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(t);return r.slice(l,u)}return r.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var _C=_y;function ss(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Fo(i,t,r,l){return l.compare(t,r)===0}function Fd(i,t,r){const l=i!=="=="&&i!=="!=";return class tJ{constructor(h,p,g){this.type=wa,this.lhs=h,this.rhs=p,this.collator=g,this.hasUntypedArgument=h.type.kind==="value"||p.type.kind==="value"}static parse(h,p){if(h.length!==3&&h.length!==4)return p.error("Expected two or three arguments.");const g=h[0];let v=p.parse(h[1],1,na);if(!v)return null;if(!ss(g,v.type))return p.concat(1).error(`"${g}" comparisons are not supported for type '${di(v.type)}'.`);let b=p.parse(h[2],2,na);if(!b)return null;if(!ss(g,b.type))return p.concat(2).error(`"${g}" comparisons are not supported for type '${di(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return p.error(`Cannot compare types '${di(v.type)}' and '${di(b.type)}'.`);l&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new Js(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new Js(v.type,[b])));let w=null;if(h.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return p.error("Cannot use collator to compare non-string types.");if(w=p.parse(h[3],3,jo),!w)return null}return new tJ(v,b,w)}evaluate(h){const p=this.lhs.evaluate(h),g=this.rhs.evaluate(h);if(l&&this.hasUntypedArgument){const v=Ci(p),b=Ci(g);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new Er(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const v=Ci(p),b=Ci(g);if(v.kind!=="string"||b.kind!=="string")return t(h,p,g)}return this.collator?r(h,p,g,this.collator.evaluate(h)):t(h,p,g)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[i];return this.eachChild(p=>{h.push(p.serialize())}),h}}}const a2=Fd("==",function(i,t,r){return t===r},Fo),i2=Fd("!=",function(i,t,r){return t!==r},function(i,t,r,l){return!Fo(0,t,r,l)}),r2=Fd("<",function(i,t,r){return t<r},function(i,t,r,l){return l.compare(t,r)<0}),o2=Fd(">",function(i,t,r){return t>r},function(i,t,r,l){return l.compare(t,r)>0}),N_=Fd("<=",function(i,t,r){return t<=r},function(i,t,r,l){return l.compare(t,r)<=0}),s2=Fd(">=",function(i,t,r){return t>=r},function(i,t,r,l){return l.compare(t,r)>=0});class $p{constructor(t,r,l,u,h,p){this.type=ma,this.number=t,this.locale=r,this.currency=l,this.unit=u,this.minFractionDigits=h,this.maxFractionDigits=p}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const l=r.parse(t[1],1,tn);if(!l)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let h=null;if(u.locale&&(h=r.parse(u.locale,1,ma),!h))return null;let p=null;if(u.currency&&(p=r.parse(u.currency,1,ma),!p))return null;let g=null;if(u.unit&&(g=r.parse(u.unit,1,ma),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=r.parse(u["min-fraction-digits"],1,tn),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=r.parse(u["max-fraction-digits"],1,tn),!b)?null:new $p(l,h,p,g,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class by{constructor(t){this.type=tn,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=r.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${di(l.type)} instead.`):new by(l):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Er(`Expected value to be of type string or array, but found ${di(Ci(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(r=>{t.push(r.serialize())}),t}}function xy(i){return function(){i=1831565813+(i|=0)|0;let t=Math.imul(i^i>>>15,1|i);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const qp={"==":a2,"!=":i2,">":o2,"<":r2,">=":s2,"<=":N_,array:Js,at:sc,boolean:Js,case:zo,coalesce:z_,collator:ac,format:$h,image:qh,in:jp,"index-of":vy,interpolate:oc,"interpolate-hcl":oc,"interpolate-lab":oc,length:by,let:F_,literal:Su,match:n2,number:Js,"number-format":$p,object:Js,slice:_C,step:tf,string:Js,"to-boolean":Qs,"to-color":Qs,"to-number":Qs,"to-string":Qs,var:T_,within:ny,distance:Qh};function Xp(i,[t,r,l,u]){t=t.evaluate(i),r=r.evaluate(i),l=l.evaluate(i);const h=u?u.evaluate(i):1,p=b_(t,r,l,h);if(p)throw new Er(p);return new xn(t/255*h,r/255*h,l/255*h,h)}function B_(i,[t,r,l,u]){t=t.evaluate(i),r=r.evaluate(i),l=l.evaluate(i);const h=u?u.evaluate(i):1,p=function(b,w,A,C){return typeof b=="number"&&b>=0&&b<=360?typeof w=="number"&&w>=0&&w<=100&&typeof A=="number"&&A>=0&&A<=100?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:`Invalid hsla value [${[b,w,A,C].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof C=="number"?[b,w,A,C]:[b,w,A]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof C=="number"?[b,w,A,C]:[b,w,A]).join(", ")}]: 'h' must be between 0 and 360.`}(t,r,l,h);if(p)throw new Er(p);const g=`hsla(${t}, ${r}%, ${l}%, ${h})`,v=xn.parse(g);if(!v)throw new Er(`Failed to parse HSLA color: ${g}`);return v}function wy(i,t){return i in t}function Sy(i,t){const r=t[i];return r===void 0?null:r}function U_(i,t,r){r.length&&(t+=`${r}`);const l=i.getConfig(t);return l?l.evaluate(i):null}function lc(i){return{type:i}}Mr.register(qp,{error:[{kind:"error"},[ma],(i,[t])=>{throw new Er(t.evaluate(i))}],typeof:[ma,[na],(i,[t])=>di(Ci(t.evaluate(i)))],"to-rgba":[Ri(tn,4),[Ki],(i,[t])=>t.evaluate(i).toArray()],rgb:[Ki,[tn,tn,tn],Xp],rgba:[Ki,[tn,tn,tn,tn],Xp],hsl:[Ki,[tn,tn,tn],B_],hsla:[Ki,[tn,tn,tn,tn],B_],has:{type:wa,overloads:[[[ma],(i,[t])=>wy(t.evaluate(i),i.properties())],[[ma,Fr],(i,[t,r])=>wy(t.evaluate(i),r.evaluate(i))]]},get:{type:na,overloads:[[[ma],(i,[t])=>Sy(t.evaluate(i),i.properties())],[[ma,Fr],(i,[t,r])=>Sy(t.evaluate(i),r.evaluate(i))]]},config:{type:na,overloads:[[[ma],(i,[t])=>U_(i,t.evaluate(i),"")],[[ma,ma],(i,[t,r])=>U_(i,t.evaluate(i),r.evaluate(i))]]},"feature-state":[na,[ma],(i,[t])=>Sy(t.evaluate(i),i.featureState||{})],properties:[Fr,[],i=>i.properties()],"geometry-type":[ma,[],i=>i.geometryType()],id:[na,[],i=>i.id()],zoom:[tn,[],i=>i.globals.zoom],pitch:[tn,[],i=>i.globals.pitch||0],"distance-from-center":[tn,[],i=>i.distanceFromCenter()],"measure-light":[tn,[ma],(i,[t])=>i.measureLight(t.evaluate(i))],"heatmap-density":[tn,[],i=>i.globals.heatmapDensity||0],"line-progress":[tn,[],i=>i.globals.lineProgress||0],"raster-value":[tn,[],i=>i.globals.rasterValue||0],"sky-radial-progress":[tn,[],i=>i.globals.skyRadialProgress||0],accumulated:[na,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[tn,lc(tn),(i,t)=>{let r=0;for(const l of t)r+=l.evaluate(i);return r}],"*":[tn,lc(tn),(i,t)=>{let r=1;for(const l of t)r*=l.evaluate(i);return r}],"-":{type:tn,overloads:[[[tn,tn],(i,[t,r])=>t.evaluate(i)-r.evaluate(i)],[[tn],(i,[t])=>-t.evaluate(i)]]},"/":[tn,[tn,tn],(i,[t,r])=>t.evaluate(i)/r.evaluate(i)],"%":[tn,[tn,tn],(i,[t,r])=>t.evaluate(i)%r.evaluate(i)],ln2:[tn,[],()=>Math.LN2],pi:[tn,[],()=>Math.PI],e:[tn,[],()=>Math.E],"^":[tn,[tn,tn],(i,[t,r])=>Math.pow(t.evaluate(i),r.evaluate(i))],sqrt:[tn,[tn],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))],log2:[tn,[tn],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[tn,[tn],(i,[t])=>Math.sin(t.evaluate(i))],cos:[tn,[tn],(i,[t])=>Math.cos(t.evaluate(i))],tan:[tn,[tn],(i,[t])=>Math.tan(t.evaluate(i))],asin:[tn,[tn],(i,[t])=>Math.asin(t.evaluate(i))],acos:[tn,[tn],(i,[t])=>Math.acos(t.evaluate(i))],atan:[tn,[tn],(i,[t])=>Math.atan(t.evaluate(i))],min:[tn,lc(tn),(i,t)=>Math.min(...t.map(r=>r.evaluate(i)))],max:[tn,lc(tn),(i,t)=>Math.max(...t.map(r=>r.evaluate(i)))],abs:[tn,[tn],(i,[t])=>Math.abs(t.evaluate(i))],round:[tn,[tn],(i,[t])=>{const r=t.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[tn,[tn],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[tn,[tn],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[wa,[ma,na],(i,[t,r])=>i.properties()[t.value]===r.value],"filter-id-==":[wa,[na],(i,[t])=>i.id()===t.value],"filter-type-==":[wa,[ma],(i,[t])=>i.geometryType()===t.value],"filter-<":[wa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l<u}],"filter-id-<":[wa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r<l}],"filter->":[wa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l>u}],"filter-id->":[wa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r>l}],"filter-<=":[wa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l<=u}],"filter-id-<=":[wa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r<=l}],"filter->=":[wa,[ma,na],(i,[t,r])=>{const l=i.properties()[t.value],u=r.value;return typeof l==typeof u&&l>=u}],"filter-id->=":[wa,[na],(i,[t])=>{const r=i.id(),l=t.value;return typeof r==typeof l&&r>=l}],"filter-has":[wa,[na],(i,[t])=>t.value in i.properties()],"filter-has-id":[wa,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[wa,[Ri(ma)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[wa,[Ri(na)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[wa,[ma,Ri(na)],(i,[t,r])=>r.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[wa,[ma,Ri(na)],(i,[t,r])=>function(l,u,h,p){for(;h<=p;){const g=h+p>>1;if(u[g]===l)return!0;u[g]>l?p=g-1:h=g+1}return!1}(i.properties()[t.value],r.value,0,r.value.length-1)],all:{type:wa,overloads:[[[wa,wa],(i,[t,r])=>t.evaluate(i)&&r.evaluate(i)],[lc(wa),(i,t)=>{for(const r of t)if(!r.evaluate(i))return!1;return!0}]]},any:{type:wa,overloads:[[[wa,wa],(i,[t,r])=>t.evaluate(i)||r.evaluate(i)],[lc(wa),(i,t)=>{for(const r of t)if(r.evaluate(i))return!0;return!1}]]},"!":[wa,[wa],(i,[t])=>!t.evaluate(i)],"is-supported-script":[wa,[ma],(i,[t])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(t.evaluate(i))}],upcase:[ma,[ma],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[ma,[ma],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[ma,lc(na),(i,t)=>t.map(r=>wu(r.evaluate(i))).join("")],"resolved-locale":[ma,[jo],(i,[t])=>t.evaluate(i).resolvedLocale()],random:[tn,[tn,tn,na],(i,t)=>{const[r,l,u]=t.map(p=>p.evaluate(i));if(r>l||r===l)return r;let h;if(typeof u=="string")h=function(p){let g=0;if(p.length===0)return g;for(let v=0;v<p.length;v++)g=(g<<5)-g+p.charCodeAt(v),g&=g;return g}(u);else{if(typeof u!="number")throw new Er(`Invalid seed input: ${u}`);h=u}return r+xy(h)()*(l-r)}]});var of=qp;function Ay(i){return{result:"success",value:i}}function Ru(i){return{result:"error",value:i}}function cc(i,t){return!!i&&!!i.parameters&&i.parameters.indexOf(t)>-1}function Nd(i){return i["property-type"]==="data-driven"}function l2(i){return cc(i.expression,"measure-light")}function sf(i){return cc(i.expression,"zoom")}function Dc(i){return!!i.expression&&i.expression.interpolated}function Ey(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Sn(i){return i}function Yp(i,t){const r=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",u=l||!(l||i.property!==void 0),h=i.type||(Dc(t)?"exponential":"interval");if(r&&((i=Cs({},i)).stops&&(i.stops=i.stops.map(b=>[b[0],xn.parse(b[1])])),i.default=xn.parse(i.default?i.default:t.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!t2[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let p,g,v;if(h==="exponential")p=ku;else if(h==="interval")p=bC;else if(h==="categorical"){p=c2,g=Object.create(null);for(const b of i.stops)g[b[0]]=b[1];v=typeof i.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);p=Zp}if(l){const b={},w=[];for(let P=0;P<i.stops.length;P++){const R=i.stops[P],z=R[0].zoom;b[z]===void 0&&(b[z]={zoom:z,type:i.type,property:i.property,default:i.default,stops:[]},w.push(z)),b[z].stops.push([R[0].value,R[1]])}const A=[];for(const P of w)A.push([b[P].zoom,Yp(b[P],t)]);const C={name:"linear"};return{kind:"composite",interpolationType:C,interpolationFactor:oc.interpolationFactor.bind(void 0,C),zoomStops:A.map(P=>P[0]),evaluate:({zoom:P},R)=>ku({stops:A,base:i.base},t,P).evaluate(P,R)}}if(u){const b=h==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:oc.interpolationFactor.bind(void 0,b),zoomStops:i.stops.map(w=>w[0]),evaluate:({zoom:w})=>p(i,t,w,g,v)}}return{kind:"source",evaluate(b,w){const A=w&&w.properties?w.properties[i.property]:void 0;return A===void 0?Bd(i.default,t.default):p(i,t,A,g,v)}}}function Bd(i,t,r){return i!==void 0?i:t!==void 0?t:r!==void 0?r:void 0}function c2(i,t,r,l,u){return Bd(typeof r===u?l[r]:void 0,i.default,t.default)}function bC(i,t,r){if(ka(r)!=="number")return Bd(i.default,t.default);const l=i.stops.length;if(l===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[l-1][0])return i.stops[l-1][1];const u=Up(i.stops.map(h=>h[0]),r);return i.stops[u][1]}function ku(i,t,r){const l=i.base!==void 0?i.base:1;if(ka(r)!=="number")return Bd(i.default,t.default);const u=i.stops.length;if(u===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[u-1][0])return i.stops[u-1][1];const h=Up(i.stops.map(w=>w[0]),r),p=function(w,A,C,P){const R=P-C,z=w-C;return R===0?0:A===1?z/R:(Math.pow(A,z)-1)/(Math.pow(A,R)-1)}(r,l,i.stops[h][0],i.stops[h+1][0]),g=i.stops[h][1],v=i.stops[h+1][1];let b=Wp[t.type]||Sn;if(i.colorSpace&&i.colorSpace!=="rgb"){const w=t2[i.colorSpace];b=(A,C)=>w.reverse(w.interpolate(w.forward(A),w.forward(C),p))}return typeof g.evaluate=="function"?{evaluate(...w){const A=g.evaluate.apply(void 0,w),C=v.evaluate.apply(void 0,w);if(A!==void 0&&C!==void 0)return b(A,C,p)}}:b(g,v,p)}function Zp(i,t,r){return t.type==="color"?r=xn.parse(r):t.type==="formatted"?r=Ar.fromString(r.toString()):t.type==="resolvedImage"?r=is.fromString(r.toString()):ka(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),Bd(r,i.default,t.default)}class Kp{constructor(t,r,l){this.expression=t,this._warningHistory={},this._evaluator=new Dp(l),this._defaultValue=r?function(u){return u.type==="color"&&(Ey(u.default)||Array.isArray(u.default))?new xn(0,0,0,0):u.type==="color"?xn.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,l,u,h,p,g,v){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=l,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(t,r,l,u,h,p,g,v){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=l||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=p||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Er(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Jp(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in of}function Oc(i,t,r){const l=new uy(of,[],t?function(h){const p={color:Ki,string:ma,number:tn,enum:ma,boolean:wa,formatted:Ic,resolvedImage:Lc};return h.type==="array"?Ri(p[h.value]||na,h.length):p[h.type]}(t):void 0,void 0,void 0,r),u=l.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Ay(new Kp(u,t,r)):Ru(l.errors)}class My{constructor(t,r,l){this.kind=t,this._styleExpression=r,this.isLightConstant=l,this.isStateDependent=t!=="constant"&&!Bp(r.expression),this.isConfigDependent=!sy(r.expression)}evaluateWithoutErrorHandling(t,r,l,u,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,u,h,p)}evaluate(t,r,l,u,h,p){return this._styleExpression.evaluate(t,r,l,u,h,p)}}class zc{constructor(t,r,l,u,h){this.kind=t,this.zoomStops=l,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Bp(r.expression),this.isLightConstant=h,this.isConfigDependent=!sy(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,r,l,u,h,p){return this._styleExpression.evaluateWithoutErrorHandling(t,r,l,u,h,p)}evaluate(t,r,l,u,h,p){return this._styleExpression.evaluate(t,r,l,u,h,p)}interpolationFactor(t,r,l){return this.interpolationType?oc.interpolationFactor(this.interpolationType,t,r,l):0}}function Ty(i,t,r){if((i=Oc(i,t,r)).result==="error")return i;const l=i.value.expression,u=Pu(l);if(!u&&!Nd(t))return Ru([new Ps("","data expressions not supported")]);const h=Dd(l,["zoom","pitch","distance-from-center"]);if(!h&&!sf(t))return Ru([new Ps("","zoom expressions not supported")]);const p=Dd(l,["measure-light"]);if(!p&&!l2(t))return Ru([new Ps("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,v=lf(l);return v||h||g?v instanceof Ps?Ru([v]):v instanceof oc&&!Dc(t)?Ru([new Ps("",'"interpolate" expressions cannot be used with this property')]):Ay(v?new zc(u?"camera":"composite",i.value,v.labels,v instanceof oc?v.interpolation:void 0,p):new My(u?"constant":"source",i.value,p)):Ru([new Ps("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Qp{constructor(t,r){this._parameters=t,this._specification=r,Cs(this,Yp(this._parameters,this._specification))}static deserialize(t){return new Qp(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function lf(i){let t=null;if(i instanceof F_)t=lf(i.result);else if(i instanceof z_){for(const r of i.args)if(t=lf(r),t)break}else(i instanceof tf||i instanceof oc)&&i.input instanceof Mr&&i.input.name==="zoom"&&(t=i);return t instanceof Ps||i.eachChild(r=>{const l=lf(r);l instanceof Ps?t=l:t&&l&&t!==l&&(t=new Ps("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ls(i){const t=i.key,r=i.value,l=i.valueSpec||{},u=i.objectElementValidators||{},h=i.style,p=i.styleSpec;let g=[];const v=ka(r);if(v!=="object")return[new sn(t,r,`object expected, ${v} found`)];for(const b in r){const w=b.split(".")[0];let A;u[w]?A=u[w]:l[w]?A=ir:u["*"]?A=u["*"]:l["*"]&&(A=ir),A?g=g.concat(A({key:(t&&`${t}.`)+b,value:r[b],valueSpec:l[w]||l["*"],style:h,styleSpec:p,object:r,objectKey:b},r)):g.push(new Ys(t,r[b],`unknown property "${b}"`))}for(const b in l)u[b]||l[b].required&&l[b].default===void 0&&r[b]===void 0&&g.push(new sn(t,r,`missing required property "${b}"`));return g}function W_(i){const t=i.value,r=i.valueSpec,l=i.style,u=i.styleSpec,h=i.key,p=i.arrayElementValidator||ir;if(ka(t)!=="array")return[new sn(h,t,`array expected, ${ka(t)} found`)];if(r.length&&t.length!==r.length)return[new sn(h,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new sn(h,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let g={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(g.function=r.function),ka(r.value)==="object"&&(g=r.value);let v=[];for(let b=0;b<t.length;b++)v=v.concat(p({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:l,styleSpec:u,key:`${h}[${b}]`},!0));return v}function Cy(i){const t=i.key,r=i.value,l=i.valueSpec;let u=ka(r);if(u==="number"&&r!=r&&(u="NaN"),u!=="number")return[new sn(t,r,`number expected, ${u} found`)];if("minimum"in l){let h=l.minimum;if(ka(l.minimum)==="array"&&(h=l.minimum[i.arrayIndex]),r<h)return[new sn(t,r,`${r} is less than the minimum value ${h}`)]}if("maximum"in l){let h=l.maximum;if(ka(l.maximum)==="array"&&(h=l.maximum[i.arrayIndex]),r>h)return[new sn(t,r,`${r} is greater than the maximum value ${h}`)]}return[]}function em(i){const t=i.valueSpec,r=Wi(i.value.type);let l,u,h,p={};const g=r!=="categorical"&&i.value.property===void 0,v=!g,b=ka(i.value.stops)==="array"&&ka(i.value.stops[0])==="array"&&ka(i.value.stops[0][0])==="object",w=ls({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(P){if(r==="identity")return[new sn(P.key,P.value,'identity function may not have a "stops" property')];let R=[];const z=P.value;return R=R.concat(W_({key:P.key,value:z,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:A})),ka(z)==="array"&&z.length===0&&R.push(new sn(P.key,z,"array must have at least one stop")),R},default:function(P){return ir({key:P.key,value:P.value,valueSpec:t,style:P.style,styleSpec:P.styleSpec})}}});return r==="identity"&&g&&w.push(new sn(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||w.push(new sn(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!Dc(i.valueSpec)&&w.push(new sn(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(v&&!Nd(i.valueSpec)?w.push(new sn(i.key,i.value,"property functions not supported")):g&&!sf(i.valueSpec)&&w.push(new sn(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!b||i.value.property!==void 0||w.push(new sn(i.key,i.value,'"property" property is required')),w;function A(P){let R=[];const z=P.value,U=P.key;if(ka(z)!=="array")return[new sn(U,z,`array expected, ${ka(z)} found`)];if(z.length!==2)return[new sn(U,z,`array length 2 expected, length ${z.length} found`)];if(b){if(ka(z[0])!=="object")return[new sn(U,z,`object expected, ${ka(z[0])} found`)];if(z[0].zoom===void 0)return[new sn(U,z,"object stop key must have zoom")];if(z[0].value===void 0)return[new sn(U,z,"object stop key must have value")];const W=Wi(z[0].zoom);if(typeof W!="number")return[new sn(U,z[0].zoom,"stop zoom values must be numbers")];if(h&&h>W)return[new sn(U,z[0].zoom,"stop zoom values must appear in ascending order")];W!==h&&(h=W,u=void 0,p={}),R=R.concat(ls({key:`${U}[0]`,value:z[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:Cy,value:C}}))}else R=R.concat(C({key:`${U}[0]`,value:z[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},z));return Jp(ii(z[1]))?R.concat([new sn(`${U}[1]`,z[1],"expressions are not allowed in function stops.")]):R.concat(ir({key:`${U}[1]`,value:z[1],valueSpec:t,style:P.style,styleSpec:P.styleSpec}))}function C(P,R){const z=ka(P.value),U=Wi(P.value),W=P.value!==null?P.value:R;if(l){if(z!==l)return[new sn(P.key,W,`${z} stop domain type must match previous stop domain type ${l}`)]}else l=z;if(z!=="number"&&z!=="string"&&z!=="boolean"&&typeof U!="number"&&typeof U!="string"&&typeof U!="boolean")return[new sn(P.key,W,"stop domain value must be a number, string, or boolean")];if(z!=="number"&&r!=="categorical"){let j=`number expected, ${z} found`;return Nd(t)&&r===void 0&&(j+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new sn(P.key,W,j)]}return r!=="categorical"||z!=="number"||typeof U=="number"&&isFinite(U)&&Math.floor(U)===U?r!=="categorical"&&z==="number"&&typeof U=="number"&&typeof u=="number"&&u!==void 0&&U<u?[new sn(P.key,W,"stop domain values must appear in ascending order")]:(u=U,r==="categorical"&&U in p?[new sn(P.key,W,"stop domain values must be unique")]:(p[U]=!0,[])):[new sn(P.key,W,`integer expected, found ${String(U)}`)]}}function Ud(i){const t=(i.expressionContext==="property"?Ty:Oc)(ii(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new sn(`${i.key}${l.key}`,i.value,l.message));const r=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new sn(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Bp(r))return[new sn(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return u2(r,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Dd(r,["zoom","feature-state"]))return[new sn(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!Pu(r))return[new sn(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function u2(i,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const u of t.valueSpec.expression.parameters)r.delete(u);if(r.size===0)return[];const l=[];return i instanceof Mr&&r.has(i.name)?[new sn(t.key,t.value,`["${i.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(i.eachChild(u=>{l.push(...u2(u,t))}),l)}function tm(i){const t=i.key,r=i.value,l=i.valueSpec,u=[];return Array.isArray(l.values)?l.values.indexOf(Wi(r))===-1&&u.push(new sn(t,r,`expected one of [${l.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(l.values).indexOf(Wi(r))===-1&&u.push(new sn(t,r,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function Py(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Py(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function nm(i,t="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Py(i)||(i=Du(i));const r=i;let l=!0;try{l=function(b){if(!Fc(b))return b;let w=ii(b);return am(w),w=V_(w),w}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const u=nt[`filter_${t}`],h=Oc(l,u);let p=null;if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));p=(b,w,A)=>h.value.evaluate(b,w,{},A);let g=null,v=null;if(l!==r){const b=Oc(r,u);if(b.result==="error")throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));g=(w,A,C,P,R)=>b.value.evaluate(w,A,{},C,void 0,void 0,P,R),v=!Pu(b.value.expression)}return{filter:p,dynamicFilter:g||void 0,needGeometry:im(l),needFeature:!!v}}function V_(i){if(!Array.isArray(i))return i;const t=function(r){if(Iy.has(r[0])){for(let l=1;l<r.length;l++)if(Fc(r[l]))return!0}return r}(i);return t===!0?t:t.map(r=>V_(r))}function am(i){let t=!1;const r=[];if(i[0]==="case"){for(let l=1;l<i.length-1;l+=2)t=t||Fc(i[l]),r.push(i[l+1]);r.push(i[i.length-1])}else if(i[0]==="match"){t=t||Fc(i[1]);for(let l=2;l<i.length-1;l+=2)r.push(i[l+1]);r.push(i[i.length-1])}else if(i[0]==="step"){t=t||Fc(i[1]);for(let l=1;l<i.length-1;l+=2)r.push(i[l+1])}t&&(i.length=0,i.push("any",...r));for(let l=1;l<i.length;l++)am(i[l])}function Fc(i){if(!Array.isArray(i))return!1;if((t=i[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let r=1;r<i.length;r++)if(Fc(i[r]))return!0;return!1}const Iy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ly(i,t){return i<t?-1:i>t?1:0}function im(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(im(i[t]))return!0;return!1}function Du(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?rm(i[1],i[2],"=="):t==="!="?om(rm(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?rm(i[1],i[2],t):t==="any"?(r=i.slice(1),["any"].concat(r.map(Du))):t==="all"?["all"].concat(i.slice(1).map(Du)):t==="none"?["all"].concat(i.slice(1).map(Du).map(om)):t==="in"?Ry(i[1],i.slice(2)):t==="!in"?om(Ry(i[1],i.slice(2))):t==="has"?ky(i[1]):t!=="!has"||om(ky(i[1]));var r}function rm(i,t,r){switch(i){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,i,t]}}function Ry(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",i,["literal",t.sort(Ly)]]:["filter-in-small",i,["literal",t]]}}function ky(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function om(i){return["!",i]}function sm(i){return Py(ii(i.value))?Ud(Cs({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):d2(i)}function d2(i){const t=i.value,r=i.key;if(ka(t)!=="array")return[new sn(r,t,`array expected, ${ka(t)} found`)];const l=i.styleSpec;let u,h=[];if(t.length<1)return[new sn(r,t,"filter array must have at least 1 element")];switch(h=h.concat(tm({key:`${r}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),Wi(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Wi(t[1])==="$type"&&h.push(new sn(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&h.push(new sn(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=ka(t[1]),u!=="string"&&h.push(new sn(`${r}[1]`,t[1],`string expected, ${u} found`)));for(let p=2;p<t.length;p++)u=ka(t[p]),Wi(t[1])==="$type"?h=h.concat(tm({key:`${r}[${p}]`,value:t[p],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&h.push(new sn(`${r}[${p}]`,t[p],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let p=1;p<t.length;p++)h=h.concat(d2({key:`${r}[${p}]`,value:t[p],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":u=ka(t[1]),t.length!==2?h.push(new sn(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&h.push(new sn(`${r}[1]`,t[1],`string expected, ${u} found`))}return h}function lm(i,t){const r=i.key,l=i.style,u=i.layer,h=i.styleSpec,p=i.value,g=i.objectKey,v=h[`${t}_${i.layerType}`];if(!v)return[];const b=g.match(/^(.*)-transition$/);if(t==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return ir({key:r,value:p,valueSpec:h.transition,style:l,styleSpec:h});const w=i.valueSpec||v[g];if(!w)return[new Ys(r,p,`unknown property "${g}"`)];let A;if(ka(p)==="string"&&Nd(w)&&!w.tokens&&(A=/^{([^}]+)}$/.exec(p))){const P=`\`{ "type": "identity", "property": ${A?JSON.stringify(A[1]):'"_"'} }\``;return[new sn(r,p,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${P}.`)]}const C=[];if(i.layerType==="symbol")g!=="text-field"||!l||l.glyphs||l.imports||C.push(new sn(r,p,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Ey(ii(p))&&Wi(p.type)==="identity"&&C.push(new sn(r,p,'"text-font" does not support identity functions'));else if(i.layerType==="model"&&t==="paint"&&u&&u.layout&&u.layout.hasOwnProperty("model-id")&&Nd(w)&&(l2(w)||sf(w))){const P=Ty(ii(p),w),R=P.value.expression||P.value._styleExpression.expression;R&&!Dd(R,["measure-light"])&&C.push(new sn(r,p,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return C.concat(ir({key:i.key,value:p,valueSpec:w,style:l,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:g}))}function Dy(i){return lm(i,"paint")}function pr(i){return lm(i,"layout")}function Da(i){let t=[];const r=i.value,l=i.key,u=i.style,h=i.styleSpec;r.type||r.ref||t.push(new sn(l,r,'either "type" or "ref" is required'));let p=Wi(r.type);const g=Wi(r.ref);if(r.id){const v=Wi(r.id);for(let b=0;b<i.arrayIndex;b++){const w=u.layers[b];Wi(w.id)===v&&t.push(new sn(l,r.id,`duplicate layer id "${r.id}", previously used at line ${w.id.__line__}`))}}if("ref"in r){let v;["type","source","source-layer","filter","layout"].forEach(b=>{b in r&&t.push(new sn(l,r[b],`"${b}" is prohibited for ref layers`))}),u.layers.forEach(b=>{Wi(b.id)===g&&(v=b)}),v?v.ref?t.push(new sn(l,r.ref,"ref cannot reference another ref layer")):p=Wi(v.type):typeof g=="string"&&t.push(new sn(l,r.ref,`ref layer "${g}" not found`))}else if(p!=="background"&&p!=="sky"&&p!=="slot")if(r.source){const v=u.sources&&u.sources[r.source],b=v&&Wi(v.type);v?b==="vector"&&p==="raster"?t.push(new sn(l,r.source,`layer "${r.id}" requires a raster source`)):b==="raster"&&p!=="raster"?t.push(new sn(l,r.source,`layer "${r.id}" requires a vector source`)):b!=="vector"||r["source-layer"]?b==="raster-dem"&&p!=="hillshade"?t.push(new sn(l,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):p!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||b==="geojson"&&v.lineMetrics||t.push(new sn(l,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new sn(l,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new sn(l,r.source,`source "${r.source}" not found`))}else t.push(new sn(l,r,'missing required property "source"'));return t=t.concat(ls({key:l,value:r,valueSpec:h.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ir({key:`${l}.type`,value:r.type,valueSpec:h.layer.type,style:i.style,styleSpec:i.styleSpec,object:r,objectKey:"type"}),filter:v=>sm(Cs({layerType:p},v)),layout:v=>ls({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>pr(Cs({layerType:p},b))}}),paint:v=>ls({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>Dy(Cs({layerType:p,layer:r},b))}})}})),t}function Hi(i){const t=i.value,r=i.key,l=ka(t);return l!=="string"?[new sn(r,t,`string expected, ${l} found`)]:[]}const Tr={promoteId:function({key:i,value:t}){if(ka(t)==="string")return Hi({key:i,value:t});{const r=[];for(const l in t)r.push(...Hi({key:`${i}.${l}`,value:t[l]}));return r}}};function mo(i){const t=i.value,r=i.key,l=i.styleSpec,u=i.style;if(!t.type)return[new sn(r,t,'"type" is required')];const h=Wi(t.type);let p;switch(h){case"vector":case"raster":case"raster-dem":return p=ls({key:r,value:t,valueSpec:l[`source_${h.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Tr}),p;case"geojson":if(p=ls({key:r,value:t,valueSpec:l.source_geojson,style:u,styleSpec:l,objectElementValidators:Tr}),t.cluster)for(const g in t.clusterProperties){const[v,b]=t.clusterProperties[g],w=typeof v=="string"?[v,["accumulated"],["get",g]]:v;p.push(...Ud({key:`${r}.${g}.map`,value:b,expressionContext:"cluster-map"})),p.push(...Ud({key:`${r}.${g}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return p;case"video":return ls({key:r,value:t,valueSpec:l.source_video,style:u,styleSpec:l});case"image":return ls({key:r,value:t,valueSpec:l.source_image,style:u,styleSpec:l});case"canvas":return[new sn(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tm({key:`${r}.type`,value:t.type,valueSpec:{values:Ls(l)},style:u,styleSpec:l})}}function Ls(i){return i.source.reduce((t,r)=>{const l=i[r];return l.type.type==="enum"&&(t=t.concat(Object.keys(l.type.values))),t},[])}function Wd(i){const t=i.value;let r=[];if(!t)return r;const l=ka(t);return l!=="string"?(r=r.concat([new sn(i.key,t,`string expected, "${l}" found`)]),r):(function(u){const h=u.indexOf("://")===-1;try{return new URL(u,h?"http://example.com":void 0),!0}catch{return!1}}(t)||(r=r.concat([new sn(i.key,t,`invalid url "${t}"`)])),r)}function Br(i){const t=i.value,r=i.styleSpec,l=r.light,u=i.style;let h=[];const p=ka(t);if(t===void 0)return h;if(p!=="object")return h=h.concat([new sn("light",t,`object expected, ${p} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&l[v[1]]&&l[v[1]].transition?ir({key:g,value:t[g],valueSpec:r.transition,style:u,styleSpec:r}):l[g]?ir({key:g,value:t[g],valueSpec:l[g],style:u,styleSpec:r}):[new sn(g,t[g],`unknown property "${g}"`)])}return h}function cf(i){const t=i.value;let r=[];if(!t)return r;const l=ka(t);if(l!=="object")return r=r.concat([new sn("light-3d",t,`object expected, ${l} found`)]),r;const u=i.styleSpec,h=u["light-3d"],p=i.key,g=i.style,v=i.style.lights;for(const A of["type","id"])if(!(A in t))return r=r.concat([new sn("light-3d",t,`missing property ${A} on light`)]),r;if(t.type&&v)for(let A=0;A<i.arrayIndex;A++){const C=Wi(t.type),P=v[A];Wi(P.type)===C&&r.push(new sn(p,t.id,`duplicate light type "${t.type}", previously defined at line ${P.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in u))return r=r.concat([new sn("light-3d",t,`Invalid light type ${t.type}`)]),r;const w=u[b];for(const A in t)if(A==="properties"){const C=t[A],P=ka(C);if(P!=="object")return r=r.concat([new sn("properties",C,`object expected, ${P} found`)]),r;for(const R in C)r=r.concat(w[R]?ir({key:R,value:C[R],valueSpec:w[R],style:g,styleSpec:u}):[new Ys(i.key,C[R],`unknown property "${R}"`)])}else{const C=A.match(/^(.*)-transition$/);r=r.concat(C&&h[C[1]]&&h[C[1]].transition?ir({key:A,value:t[A],valueSpec:u.transition,style:g,styleSpec:u}):h[A]?ir({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:u}):[new Ys(A,t[A],`unknown property "${A}"`)])}return r}function Vd(i){const t=i.value,r=i.key,l=i.style,u=i.styleSpec,h=u.terrain;let p=[];const g=ka(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new sn("terrain",t,`object expected, ${g} found`)]),p;for(const v in t){const b=v.match(/^(.*)-transition$/);p=p.concat(b&&h[b[1]]&&h[b[1]].transition?ir({key:v,value:t[v],valueSpec:u.transition,style:l,styleSpec:u}):h[v]?ir({key:v,value:t[v],valueSpec:h[v],style:l,styleSpec:u}):[new Ys(v,t[v],`unknown property "${v}"`)])}if(t.source){const v=l.sources&&l.sources[t.source],b=v&&Wi(v.type);v?b!=="raster-dem"&&p.push(new sn(r,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):p.push(new sn(r,t.source,`source "${t.source}" not found`))}else p.push(new sn(r,t,'terrain is missing required property "source"'));return p}function cm(i){const t=i.value,r=i.style,l=i.styleSpec,u=l.fog;let h=[];const p=ka(t);if(t===void 0)return h;if(p!=="object")return h=h.concat([new sn("fog",t,`object expected, ${p} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&u[v[1]]&&u[v[1]].transition?ir({key:g,value:t[g],valueSpec:l.transition,style:r,styleSpec:l}):u[g]?ir({key:g,value:t[g],valueSpec:u[g],style:r,styleSpec:l}):[new Ys(g,t[g],`unknown property "${g}"`)])}return h}const Oy={"*":()=>[],array:W_,boolean:function(i){const t=i.value,r=i.key,l=ka(t);return l!=="boolean"?[new sn(r,t,`boolean expected, ${l} found`)]:[]},number:Cy,color:function(i){const t=i.key,r=i.value,l=ka(r);return l!=="string"?[new sn(t,r,`color expected, ${l} found`)]:bu(r)===null?[new sn(t,r,`color expected, "${r}" found`)]:[]},enum:tm,filter:sm,function:em,layer:Da,object:ls,source:mo,model:Wd,light:Br,"light-3d":cf,terrain:Vd,fog:cm,string:Hi,formatted:function(i){return Hi(i).length===0?[]:Ud(i)},resolvedImage:function(i){return Hi(i).length===0?[]:Ud(i)},projection:function(i){const t=i.value,r=i.styleSpec,l=r.projection,u=i.style;let h=[];const p=ka(t);if(p==="object")for(const g in t)h=h.concat(ir({key:g,value:t[g],valueSpec:l[g],style:u,styleSpec:r}));else p!=="string"&&(h=h.concat([new sn("projection",t,`object or string expected, ${p} found`)]));return h},import:function(i){const{value:t,styleSpec:r}=i,{data:l,...u}=t;Object.defineProperty(u,"__line__",{value:t.__line__,enumerable:!1});let h=ls(Cs({},i,{value:u,valueSpec:r.import}));return Wi(u.id)===""&&h.push(new sn(`${i.key}.id`,u,"import id can't be an empty string")),l&&(h=h.concat(zy(l,r,{key:`${i.key}.data`}))),h}};function ir(i,t=!1){const r=i.value,l=i.valueSpec,u=i.styleSpec;if(l.expression&&Ey(Wi(r)))return em(i);if(l.expression&&Jp(ii(r)))return Ud(i);if(l.type&&Oy[l.type]){const h=Oy[l.type](i);return t===!0&&h.length>0&&ka(i.value)==="array"?Ud(i):h}return ls(Cs({},i,{valueSpec:l.type?u[l.type]:l}))}function cs(i){const t=i.value,r=i.key,l=Hi(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new sn(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new sn(r,t,'"glyphs" url must include a "{range}" token'))),l}function zy(i,t=nt,r={}){return ir({key:r.key||"",value:i,valueSpec:t.$root,styleSpec:t,style:i,objectElementValidators:{glyphs:cs,"*":()=>[]}})}function Ou(i,t=nt){return us(zy(i,t))}const uf=i=>us(mo(i)),Fy=i=>us(Br(i)),G_=i=>us(cf(i)),zu=i=>us(Vd(i)),Ny=i=>us(cm(i)),Fu=i=>us(Da(i)),df=i=>us(sm(i)),um=i=>us(Dy(i)),H_=i=>us(pr(i)),By=i=>us(Wd(i));function us(i){return i.slice().sort((t,r)=>t.line&&r.line?t.line-r.line:0)}function go(i,t){let r=!1;if(t&&t.length)for(const l of t)l instanceof Ys?ve(l.message):(i.fire(new vn(new Error(l.message))),r=!0);return r}var Nu=Rs,Qr=3;function Rs(i,t,r){var l=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var u=new Int32Array(this.arrayBuffer);i=u[0],this.d=(t=u[1])+2*(r=u[2]);for(var h=0;h<this.d*this.d;h++){var p=u[Qr+h],g=u[Qr+h+1];l.push(p===g?null:u.subarray(p,g))}var v=u[Qr+l.length+1];this.keys=u.subarray(u[Qr+l.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var b=0;b<this.d*this.d;b++)l.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=i,this.padding=r,this.scale=t/i,this.uid=0;var w=r/t*i;this.min=-w,this.max=i+w}Rs.prototype.insert=function(i,t,r,l,u){this._forEachCell(t,r,l,u,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u)},Rs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Rs.prototype._insertCell=function(i,t,r,l,u,h){this.cells[u].push(h)},Rs.prototype.query=function(i,t,r,l,u){var h=this.min,p=this.max;if(i<=h&&t<=h&&p<=r&&p<=l&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(i,t,r,l,this._queryCell,g,{},u),g},Rs.prototype._queryCell=function(i,t,r,l,u,h,p,g){var v=this.cells[u];if(v!==null)for(var b=this.keys,w=this.bboxes,A=0;A<v.length;A++){var C=v[A];if(p[C]===void 0){var P=4*C;(g?g(w[P+0],w[P+1],w[P+2],w[P+3]):i<=w[P+2]&&t<=w[P+3]&&r>=w[P+0]&&l>=w[P+1])?(p[C]=!0,h.push(b[C])):p[C]=!1}}},Rs.prototype._forEachCell=function(i,t,r,l,u,h,p,g){for(var v=this._convertToCellCoord(i),b=this._convertToCellCoord(t),w=this._convertToCellCoord(r),A=this._convertToCellCoord(l),C=v;C<=w;C++)for(var P=b;P<=A;P++){var R=this.d*P+C;if((!g||g(this._convertFromCellCoord(C),this._convertFromCellCoord(P),this._convertFromCellCoord(C+1),this._convertFromCellCoord(P+1)))&&u.call(this,i,t,r,l,R,h,p,g))return}},Rs.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Rs.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Rs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,t=Qr+this.cells.length+1+1,r=0,l=0;l<this.cells.length;l++)r+=this.cells[l].length;var u=new Int32Array(t+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var h=t,p=0;p<i.length;p++){var g=i[p];u[Qr+p]=h,u.set(g,h),h+=g.length}return u[Qr+i.length]=h,u.set(this.keys,h),u[Qr+i.length+1]=h+=this.keys.length,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer};var eo=F(Nu);const dm={};function un(i,t,r={}){Object.defineProperty(i,"_classRegistryKey",{value:t,writeable:!1}),dm[t]={klass:i,omit:r.omit||[]}}un(Object,"Object"),eo.serialize=function(i,t){const r=i.toArrayBuffer();return t&&t.add(r),{buffer:r}},eo.deserialize=function(i){return new eo(i.buffer)},Object.defineProperty(eo,"name",{value:"Grid"}),un(eo,"Grid"),un(xn,"Color"),un(Error,"Error"),un(Me,"AJAXError"),un(is,"ResolvedImage"),un(Qp,"StylePropertyFunction"),un(Kp,"StyleExpression",{omit:["_evaluator"]}),un(zc,"ZoomDependentExpression"),un(My,"ZoomConstantExpression"),un(Mr,"CompoundExpression",{omit:["_evaluate"]});for(const i in of)dm[of[i]._classRegistryKey]||un(of[i],`Expression${i}`);function Uy(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function h2(i){return m.ImageBitmap&&i instanceof m.ImageBitmap}function ks(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(Uy(i)||h2(i))return t&&t.add(i),i;if(ArrayBuffer.isView(i)){const r=i;return t&&t.add(r.buffer),r}if(i instanceof m.ImageData)return t&&t.add(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const l of i)r.push(ks(l,t));return r}if(i instanceof Map){const r={$name:"Map"};for(const[l,u]of i.entries())r[l]=ks(u);return r}if(typeof i=="object"){const r=i.constructor,l=r._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${l}`);const u=r.serialize?r.serialize(i,t):{};if(!r.serialize){for(const h in i)i.hasOwnProperty(h)&&(dm[l].omit.indexOf(h)>=0||(u[h]=ks(i[h],t)));i instanceof Error&&(u.message=i.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(u.$name=l),u}throw new Error("can't serialize object of type "+typeof i)}function Gd(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||Uy(i)||h2(i)||ArrayBuffer.isView(i)||i instanceof m.ImageData)return i;if(Array.isArray(i))return i.map(Gd);if(typeof i=="object"){const t=i.$name||"Object";if(t==="Map"){const u=new Map;for(const h of Object.keys(i))h!=="$name"&&u.set(h,Gd(i[h]));return u}const{klass:r}=dm[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(i);const l=Object.create(r.prototype);for(const u of Object.keys(i))u!=="$name"&&(l[u]=Gd(i[u]));return l}throw new Error("can't deserialize object of type "+typeof i)}const pn={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519,"CJK Unified Ideographs Extension B":i=>i>=131072&&i<=173791};function hm(i){for(const t of i)if(Wy(t.charCodeAt(0)))return!0;return!1}function Hd(i){for(const t of i)if(!f2(t.charCodeAt(0)))return!1;return!0}function f2(i){return!(pn.Arabic(i)||pn["Arabic Supplement"](i)||pn["Arabic Extended-A"](i)||pn["Arabic Presentation Forms-A"](i)||pn["Arabic Presentation Forms-B"](i))}function Wy(i){return!(i!==746&&i!==747&&(i<4352||!(pn["Bopomofo Extended"](i)||pn.Bopomofo(i)||pn["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||pn["CJK Compatibility Ideographs"](i)||pn["CJK Compatibility"](i)||pn["CJK Radicals Supplement"](i)||pn["CJK Strokes"](i)||!(!pn["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||pn["CJK Unified Ideographs Extension A"](i)||pn["CJK Unified Ideographs"](i)||pn["Enclosed CJK Letters and Months"](i)||pn["Hangul Compatibility Jamo"](i)||pn["Hangul Jamo Extended-A"](i)||pn["Hangul Jamo Extended-B"](i)||pn["Hangul Jamo"](i)||pn["Hangul Syllables"](i)||pn.Hiragana(i)||pn["Ideographic Description Characters"](i)||pn.Kanbun(i)||pn["Kangxi Radicals"](i)||pn["Katakana Phonetic Extensions"](i)||pn.Katakana(i)&&i!==12540||!(!pn["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!pn["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||pn["Unified Canadian Aboriginal Syllabics"](i)||pn["Unified Canadian Aboriginal Syllabics Extended"](i)||pn["Vertical Forms"](i)||pn["Yijing Hexagram Symbols"](i)||pn["Yi Syllables"](i)||pn["Yi Radicals"](i))))}function Vy(i){return!(Wy(i)||function(t){return!!(pn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||pn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||pn["Letterlike Symbols"](t)||pn["Number Forms"](t)||pn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||pn["Control Pictures"](t)&&t!==9251||pn["Optical Character Recognition"](t)||pn["Enclosed Alphanumerics"](t)||pn["Geometric Shapes"](t)||pn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||pn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||pn["CJK Symbols and Punctuation"](t)||pn.Katakana(t)||pn["Private Use Area"](t)||pn["CJK Compatibility Forms"](t)||pn["Small Form Variants"](t)||pn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function fm(i){return i>=1424&&i<=2303||pn["Arabic Presentation Forms-A"](i)||pn["Arabic Presentation Forms-B"](i)}function xC(i,t){return!(!t&&fm(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||pn.Khmer(i))}function wC(i){for(const t of i)if(fm(t.charCodeAt(0)))return!0;return!1}const Gy="deferred",Hy="loading",Nc="loaded";let j_=null,Ur="unavailable",Bc=null;const qo=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Ur="error"),j_&&j_(i)};function $_(){jy.fire(new Ht("pluginStateChange",{pluginStatus:Ur,pluginURL:Bc}))}const jy=new Bn,q_=function(){return Ur},p2=function(){if(Ur!==Gy||!Bc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ur=Hy,$_(),Bc&&vt({url:Bc},i=>{i?qo(i):(Ur=Nc,$_())})},Ds={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ur===Nc||Ds.applyArabicShaping!=null,isLoading:()=>Ur===Hy,setState(i){Ur=i.pluginStatus,Bc=i.pluginURL},isParsed:()=>Ds.applyArabicShaping!=null&&Ds.processBidirectionalText!=null&&Ds.processStyledBidirectionalText!=null,getPluginURL:()=>Bc};class ri{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(r,l){for(const u of r)if(!xC(u.charCodeAt(0),l))return!1;return!0}(t,Ds.isLoaded())}}class $y{constructor(t,r,l){this.property=t,this.value=r,this.expression=function(u,h,p){if(Ey(u))return new Qp(u,h);if(Jp(u)||Array.isArray(u)&&u.length>0){const g=Ty(u,h,p);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&h.type==="color"&&(g=xn.parse(u)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(r===void 0?t.specification.default:r,t.specification,l)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,l){return this.property.possiblyEvaluate(this,t,r,l)}}class ds{constructor(t,r){this.property=t,this.value=new $y(t,void 0,r)}transitioned(t,r){return new m2(this.property,this.value,r,Ue({},t.transition,this.transition),t.now)}untransitioned(){return new m2(this.property,this.value,null,{},0)}}class jd{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value.value)}setValue(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new ds(this._values[t].property,this._options)),this._values[t].value=new $y(this._values[t].property,r===null?void 0:ue(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,r){r&&(this._options=r);const l=this._properties.properties;if(t)for(const u in t){const h=t[u];if(yt(u,"-transition")){const p=u.slice(0,-11);l[p]&&this.setTransition(p,h)}else l[u]&&this.setValue(u,h)}}getTransition(t){return ue(this._values[t].transition)}setTransition(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new ds(this._values[t].property)),this._values[t].transition=ue(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l);const u=this.getTransition(r);u!==void 0&&(t[`${r}-transition`]=u)}return t}transitioned(t,r){const l=new Uc(this._properties);for(const u of Object.keys(this._values))l._values[u]=this._values[u].transitioned(t,r._values[u]);return l}untransitioned(){const t=new Uc(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class m2{constructor(t,r,l,u,h){const p=u.delay||0,g=u.duration||0;h=h||0,this.property=t,this.value=r,this.begin=h+p,this.end=this.begin+g,t.specification.transition&&(u.delay||u.duration)&&(this.prior=l)}possiblyEvaluate(t,r,l){const u=t.now||0,h=this.value.possiblyEvaluate(t,r,l),p=this.prior;if(p){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return p.possiblyEvaluate(t,r,l);{const g=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,r,l),h,Le(g))}}return h}}class Uc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,l){const u=new Bu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,l);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class qy{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value)}setValue(t,r){this._values[t]=new $y(this._values[t].property,r===null?void 0:ue(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const r of Object.keys(this._values)){const l=this.getValue(r);l!==void 0&&(t[r]=l)}return t}possiblyEvaluate(t,r,l){const u=new Bu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,l);return u}}class il{constructor(t,r,l){this.property=t,this.value=r,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,l,u){return this.property.evaluate(this.value,this.parameters,t,r,l,u)}}class Bu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Xt{constructor(t){this.specification=t}possiblyEvaluate(t,r){return t.expression.evaluate(r)}interpolate(t,r,l){const u=Wp[this.specification.type];return u?u(t,r,l):t}}class yn{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,l,u){return new il(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},l,u)}:t.expression,r)}interpolate(t,r,l){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new il(this,{kind:"constant",value:void 0},t.parameters);const u=Wp[this.specification.type];return u?new il(this,{kind:"constant",value:u(t.value.value,r.value.value,l)},t.parameters):t}evaluate(t,r,l,u,h,p){return t.kind==="constant"?t.value:t.evaluate(r,l,u,h,p)}}class pm{constructor(t){this.specification=t}possiblyEvaluate(t,r,l,u){return!!t.expression.evaluate(r,null,{},l,u)}interpolate(){return!1}}class yi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new ri(0,{});for(const l in t){const u=t[l];u.specification.overridable&&this.overridableProperties.push(l);const h=this.defaultPropertyValues[l]=new $y(u,void 0),p=this.defaultTransitionablePropertyValues[l]=new ds(u);this.defaultTransitioningPropertyValues[l]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[l]=h.possiblyEvaluate(r)}}}function Xo(i,t){return t?`${i}${t}`:i}function Xy(i){const t=i.indexOf("");return t>=0?i.slice(0,t):i}un(yn,"DataDrivenProperty"),un(Xt,"DataConstantProperty"),un(pm,"ColorRampProperty");const X_="-transition";class Yo extends Bn{constructor(t,r,l){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=l,t.slot&&(this.slot=t.slot),r.layout&&(this._unevaluatedLayout=new qy(r.layout,l),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new jd(r.paint,l);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bu(r.paint)}}setScope(t){this.scope=t,this.fqid=Xo(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,l={}){if(r!=null&&this._validate(H_,`layers.${this.id}.layout.${t}`,t,r,l))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=r);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return yt(t,X_)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,l={}){if(r!=null&&this._validate(um,`layers.${this.id}.paint.${t}`,t,r,l))return!1;const u=this._transitionablePaint,h=u._properties.properties;if(yt(t,X_)){const C=t.slice(0,-11);return h[C]&&u.setTransition(C,r||void 0),!1}if(!h[t])return!1;const p=u._values[t],g=p.value.isDataDriven(),v=p.value;u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=u._values[t].value,w=b.isDataDriven(),A=yt(t,"pattern")||t==="line-dasharray";return w||g||A||this._handleOverridablePaintPropertyUpdate(t,v,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,r){return null}_handleOverridablePaintPropertyUpdate(t,r,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){return Be({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,r)=>!(t===void 0||r==="layout"&&!Object.keys(t).length||r==="paint"&&!Object.keys(t).length))}_validate(t,r,l,u,h={}){return(!h||h.validate!==!1)&&go(this,t.call(Ou,{key:r,layerType:this.type,objectKey:l,value:u,styleSpec:nt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof il&&Nd(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=nm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}class SC{constructor(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps=new Set,this.changedImages=new Set}updateLayer(t){const r=t.scope;this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._updatedLayers[r].add(t.id)}removeLayer(t){const r=t.scope;this._removedLayers[r]=this._removedLayers[r]||{},this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._removedLayers[r][t.id]=t,this._updatedLayers[r].delete(t.id),this.updatedPaintProps.delete(t.fqid)}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const r in this._updatedLayers)t[r]=t[r]||{},t[r].updatedIds=Array.from(this._updatedLayers[r].values());for(const r in this._removedLayers)t[r]=t[r]||{},t[r].removedIds=Object.keys(this._removedLayers[r]);return t}reset(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps.clear(),this.changedImages.clear()}}const AC={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class E{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class M{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function N(i,t=1){let r=0,l=0;return{members:i.map(u=>{const h=AC[u.type].BYTES_PER_ELEMENT,p=r=H(r,Math.max(t,h)),g=u.components||1;return l=Math.max(l,h),r+=h*g,{name:u.name,type:u.type,components:g,offset:p}}),size:H(r,Math.max(l,t)),alignment:t}}function H(i,t){return Math.ceil(i/t)*t}class J extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.int16[u+0]=r,this.int16[u+1]=l,t}}J.prototype.bytesPerElement=4,un(J,"StructArrayLayout2i4");class oe extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.int16[h+0]=r,this.int16[h+1]=l,this.int16[h+2]=u,t}}oe.prototype.bytesPerElement=6,un(oe,"StructArrayLayout3i6");class je extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.int16[p+0]=r,this.int16[p+1]=l,this.int16[p+2]=u,this.int16[p+3]=h,t}}je.prototype.bytesPerElement=8,un(je,"StructArrayLayout4i8");class _t extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=5*t;return this.int16[g+0]=r,this.int16[g+1]=l,this.int16[g+2]=u,this.int16[g+3]=h,this.int16[g+4]=p,t}}_t.prototype.bytesPerElement=10,un(_t,"StructArrayLayout5i10");class jt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=6*t,w=12*t,A=3*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.uint8[w+4]=u,this.uint8[w+5]=h,this.uint8[w+6]=p,this.uint8[w+7]=g,this.float32[A+2]=v,t}}jt.prototype.bytesPerElement=12,un(jt,"StructArrayLayout2i4ub1f12");class dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.float32[p+0]=r,this.float32[p+1]=l,this.float32[p+2]=u,this.float32[p+3]=h,t}}dn.prototype.bytesPerElement=16,un(dn,"StructArrayLayout4f16");class Mn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=6*t,v=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=l,this.uint16[g+2]=u,this.uint16[g+3]=h,this.float32[v+2]=p,t}}Mn.prototype.bytesPerElement=12,un(Mn,"StructArrayLayout4ui1f12");class _a extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=4*t;return this.uint16[p+0]=r,this.uint16[p+1]=l,this.uint16[p+2]=u,this.uint16[p+3]=h,t}}_a.prototype.bytesPerElement=8,un(_a,"StructArrayLayout4ui8");class Jn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,l,u,h,p)}emplace(t,r,l,u,h,p,g){const v=6*t;return this.int16[v+0]=r,this.int16[v+1]=l,this.int16[v+2]=u,this.int16[v+3]=h,this.int16[v+4]=p,this.int16[v+5]=g,t}}Jn.prototype.bytesPerElement=12,un(Jn,"StructArrayLayout6i12");class vi extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,w,A,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,r,l,u,h,p,g,v,b,w,A,C)}emplace(t,r,l,u,h,p,g,v,b,w,A,C,P){const R=12*t;return this.int16[R+0]=r,this.int16[R+1]=l,this.int16[R+2]=u,this.int16[R+3]=h,this.uint16[R+4]=p,this.uint16[R+5]=g,this.uint16[R+6]=v,this.uint16[R+7]=b,this.int16[R+8]=w,this.int16[R+9]=A,this.int16[R+10]=C,this.int16[R+11]=P,t}}vi.prototype.bytesPerElement=24,un(vi,"StructArrayLayout4i4ui4i24");class Vn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,l,u,h,p)}emplace(t,r,l,u,h,p,g){const v=10*t,b=5*t;return this.int16[v+0]=r,this.int16[v+1]=l,this.int16[v+2]=u,this.float32[b+2]=h,this.float32[b+3]=p,this.float32[b+4]=g,t}}Vn.prototype.bytesPerElement=20,un(Vn,"StructArrayLayout3i3f20");class yo extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}yo.prototype.bytesPerElement=4,un(yo,"StructArrayLayout1ul4");class to extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.uint16[u+0]=r,this.uint16[u+1]=l,t}}to.prototype.bytesPerElement=4,un(to,"StructArrayLayout2ui4");class Bt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,w,A,C,P){const R=this.length;return this.resize(R+1),this.emplace(R,t,r,l,u,h,p,g,v,b,w,A,C,P)}emplace(t,r,l,u,h,p,g,v,b,w,A,C,P,R){const z=20*t,U=10*t;return this.int16[z+0]=r,this.int16[z+1]=l,this.int16[z+2]=u,this.int16[z+3]=h,this.int16[z+4]=p,this.float32[U+3]=g,this.float32[U+4]=v,this.float32[U+5]=b,this.float32[U+6]=w,this.int16[z+14]=A,this.uint32[U+8]=C,this.uint16[z+18]=P,this.uint16[z+19]=R,t}}Bt.prototype.bytesPerElement=40,un(Bt,"StructArrayLayout5i4f1i1ul2ui40");class wt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=8*t;return this.int16[b+0]=r,this.int16[b+1]=l,this.int16[b+2]=u,this.int16[b+4]=h,this.int16[b+5]=p,this.int16[b+6]=g,this.int16[b+7]=v,t}}wt.prototype.bytesPerElement=16,un(wt,"StructArrayLayout3i2i2i16");class Wt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=4*t,v=8*t;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=u,this.int16[v+6]=h,this.int16[v+7]=p,t}}Wt.prototype.bytesPerElement=16,un(Wt,"StructArrayLayout2f1f2i16");class An extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=12*t,g=3*t;return this.uint8[p+0]=r,this.uint8[p+1]=l,this.float32[g+1]=u,this.float32[g+2]=h,t}}An.prototype.bytesPerElement=12,un(An,"StructArrayLayout2ub2f12");class Dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.float32[h+0]=r,this.float32[h+1]=l,this.float32[h+2]=u,t}}Dn.prototype.bytesPerElement=12,un(Dn,"StructArrayLayout3f12");class Nn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,l)}emplace(t,r,l,u){const h=3*t;return this.uint16[h+0]=r,this.uint16[h+1]=l,this.uint16[h+2]=u,t}}Nn.prototype.bytesPerElement=6,un(Nn,"StructArrayLayout3ui6");class Sa extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$){const K=this.length;return this.resize(K+1),this.emplace(K,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$)}emplace(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$,K){const ie=30*t,ce=15*t,he=60*t;return this.int16[ie+0]=r,this.int16[ie+1]=l,this.int16[ie+2]=u,this.float32[ce+2]=h,this.float32[ce+3]=p,this.uint16[ie+8]=g,this.uint16[ie+9]=v,this.uint32[ce+5]=b,this.uint32[ce+6]=w,this.uint32[ce+7]=A,this.uint16[ie+16]=C,this.uint16[ie+17]=P,this.uint16[ie+18]=R,this.float32[ce+10]=z,this.float32[ce+11]=U,this.uint8[he+48]=W,this.uint8[he+49]=j,this.uint8[he+50]=Y,this.uint32[ce+13]=Z,this.int16[ie+28]=$,this.uint8[he+58]=K,t}}Sa.prototype.bytesPerElement=60,un(Sa,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Za extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$,K,ie,ce,he,ye,Te,we,Ie,xe,We,qe){const et=this.length;return this.resize(et+1),this.emplace(et,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$,K,ie,ce,he,ye,Te,we,Ie,xe,We,qe)}emplace(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$,K,ie,ce,he,ye,Te,we,Ie,xe,We,qe,et){const Ne=20*t,Ve=40*t,it=80*t;return this.float32[Ne+0]=r,this.float32[Ne+1]=l,this.int16[Ve+4]=u,this.int16[Ve+5]=h,this.int16[Ve+6]=p,this.int16[Ve+7]=g,this.int16[Ve+8]=v,this.int16[Ve+9]=b,this.int16[Ve+10]=w,this.int16[Ve+11]=A,this.int16[Ve+12]=C,this.uint16[Ve+13]=P,this.uint16[Ve+14]=R,this.uint16[Ve+15]=z,this.uint16[Ve+16]=U,this.uint16[Ve+17]=W,this.uint16[Ve+18]=j,this.uint16[Ve+19]=Y,this.uint16[Ve+20]=Z,this.uint16[Ve+21]=$,this.uint16[Ve+22]=K,this.uint16[Ve+23]=ie,this.uint16[Ve+24]=ce,this.uint16[Ve+25]=he,this.uint16[Ve+26]=ye,this.uint16[Ve+27]=Te,this.uint32[Ne+14]=we,this.float32[Ne+15]=Ie,this.float32[Ne+16]=xe,this.float32[Ne+17]=We,this.float32[Ne+18]=qe,this.uint8[it+76]=et,t}}Za.prototype.bytesPerElement=80,un(Za,"StructArrayLayout2f9i15ui1ul4f1ub80");class mr extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}mr.prototype.bytesPerElement=4,un(mr,"StructArrayLayout1f4");class Ua extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h){const p=this.length;return this.resize(p+1),this.emplace(p,t,r,l,u,h)}emplace(t,r,l,u,h,p){const g=5*t;return this.float32[g+0]=r,this.float32[g+1]=l,this.float32[g+2]=u,this.float32[g+3]=h,this.float32[g+4]=p,t}}Ua.prototype.bytesPerElement=20,un(Ua,"StructArrayLayout5f20");class uc extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=7*t;return this.float32[b+0]=r,this.float32[b+1]=l,this.float32[b+2]=u,this.float32[b+3]=h,this.float32[b+4]=p,this.float32[b+5]=g,this.float32[b+6]=v,t}}uc.prototype.bytesPerElement=28,un(uc,"StructArrayLayout7f28");class Y_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,l,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,l,u)}emplace(t,r,l,u,h){const p=6*t;return this.uint32[3*t+0]=r,this.uint16[p+2]=l,this.uint16[p+3]=u,this.uint16[p+4]=h,t}}Y_.prototype.bytesPerElement=12,un(Y_,"StructArrayLayout1ul3ui12");class Z_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}Z_.prototype.bytesPerElement=2,un(Z_,"StructArrayLayout1ui2");class K_ extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const l=this.length;return this.resize(l+1),this.emplace(l,t,r)}emplace(t,r,l){const u=2*t;return this.float32[u+0]=r,this.float32[u+1]=l,t}}K_.prototype.bytesPerElement=8,un(K_,"StructArrayLayout2f8");class EC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U){const W=this.length;return this.resize(W+1),this.emplace(W,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U)}emplace(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W){const j=16*t;return this.float32[j+0]=r,this.float32[j+1]=l,this.float32[j+2]=u,this.float32[j+3]=h,this.float32[j+4]=p,this.float32[j+5]=g,this.float32[j+6]=v,this.float32[j+7]=b,this.float32[j+8]=w,this.float32[j+9]=A,this.float32[j+10]=C,this.float32[j+11]=P,this.float32[j+12]=R,this.float32[j+13]=z,this.float32[j+14]=U,this.float32[j+15]=W,t}}EC.prototype.bytesPerElement=64,un(EC,"StructArrayLayout16f64");class g2 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,l,u,h,p,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,l,u,h,p,g)}emplace(t,r,l,u,h,p,g,v){const b=10*t,w=5*t;return this.uint16[b+0]=r,this.uint16[b+1]=l,this.uint16[b+2]=u,this.uint16[b+3]=h,this.float32[w+2]=p,this.float32[w+3]=g,this.float32[w+4]=v,t}}g2.prototype.bytesPerElement=20,un(g2,"StructArrayLayout4ui3f20");class MC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint8[1*t+0]=r,t}}MC.prototype.bytesPerElement=1,un(MC,"StructArrayLayout1ub1");class vO extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}vO.prototype.size=40;class TC extends Bt{get(t){return new vO(this,t)}}un(TC,"CollisionBoxArray");class _O extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}_O.prototype.size=60;class bO extends Sa{get(t){return new _O(this,t)}}un(bO,"PlacedSymbolArray");class xO extends E{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}xO.prototype.size=80;class wO extends Za{get(t){return new xO(this,t)}}un(wO,"SymbolInstanceArray");class SO extends mr{getoffsetX(t){return this.float32[1*t+0]}}un(SO,"GlyphOffsetArray");class AO extends J{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}un(AO,"SymbolLineVertexArray");class EO extends E{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}EO.prototype.size=12;class MO extends Y_{get(t){return new EO(this,t)}}un(MO,"FeatureIndexArray");class TO extends to{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}un(TO,"FillExtrusionCentroidArray");const yQ=N([{name:"a_pos",components:2,type:"Int16"}],4),vQ=N([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ja{constructor(t=[]){this.segments=t}_prepareSegment(t,r,l,u){let h=this.segments[this.segments.length-1];return t>ja.MAX_VERTEX_ARRAY_LENGTH&&ve(`Max vertices per segment is ${ja.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!h||h.vertexLength+t>ja.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:r,primitiveOffset:l,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h}prepareSegment(t,r,l,u){return this._prepareSegment(t,r.length,l.length,u)}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,l,u){return new ja([{vertexOffset:t,primitiveOffset:r,vertexLength:l,primitiveLength:u,vaos:{},sortKey:0}])}}function CO(i,t){return 256*(i=ae(Math.floor(i),0,255))+ae(Math.floor(t),0,255)}ja.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,un(ja,"SegmentVector");const _Q=N([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),bQ=N([{name:"a_dash",components:4,type:"Uint16"}]);var y2={exports:{}},PO={exports:{}};(function(i){i.exports=function(t,r){var l,u,h,p,g,v,b,w;for(u=t.length-(l=3&t.length),h=r,g=3432918353,v=461845907,w=0;w<u;)b=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,h=27492+(65535&(p=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(p>>>16)&65535)<<16);switch(b=0,l){case 3:b^=(255&t.charCodeAt(w+2))<<16;case 2:b^=(255&t.charCodeAt(w+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(w)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}})(PO);var xQ=PO.exports,IO={exports:{}};(function(i){i.exports=function(t,r){for(var l,u=t.length,h=r^u,p=0;u>=4;)l=1540483477*(65535&(l=255&t.charCodeAt(p)|(255&t.charCodeAt(++p))<<8|(255&t.charCodeAt(++p))<<16|(255&t.charCodeAt(++p))<<24))+((1540483477*(l>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(l=1540483477*(65535&(l^=l>>>24))+((1540483477*(l>>>16)&65535)<<16)),u-=4,++p;switch(u){case 3:h^=(255&t.charCodeAt(p+2))<<16;case 2:h^=(255&t.charCodeAt(p+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(p)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}})(IO);var LO=xQ,wQ=IO.exports;y2.exports=LO,y2.exports.murmur3=LO,y2.exports.murmur2=wQ;var CC=F(y2.exports);class J_{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,r,l,u){this.ids.push(RO(t)),this.positions.push(r,l,u)}eachPosition(t,r){const l=RO(t);let u=0,h=this.ids.length-1;for(;u<h;){const p=u+h>>1;this.ids[p]>=l?h=p:u=p+1}for(;this.ids[u]===l;)r(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(t,r){const l=new Float64Array(t.ids),u=new Uint32Array(t.positions);return PC(l,u,0,l.length-1),r&&(r.add(l.buffer),r.add(u.buffer)),{ids:l,positions:u}}static deserialize(t){const r=new J_;let l;r.ids=t.ids,r.positions=t.positions;for(const u of r.ids)u!==l&&r.uniqueIds.push(u),l=u;return r.indexed=!0,r}}function RO(i){const t=+i;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:CC(String(i))}function PC(i,t,r,l){for(;r<l;){const u=i[r+l>>1];let h=r-1,p=l+1;for(;;){do h++;while(i[h]<u);do p--;while(i[p]>u);if(h>=p)break;v2(i,h,p),v2(t,3*h,3*p),v2(t,3*h+1,3*p+1),v2(t,3*h+2,3*p+2)}p-r<l-p?(PC(i,t,r,p),r=p+1):(PC(i,t,p+1,l),l=p)}}function v2(i,t,r){const l=i[t];i[t]=i[r],i[r]=l}un(J_,"FeaturePositionMap");class $d{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,r),this.initialized=!0),!!this.location}}class ra extends $d{constructor(t){super(t),this.current=0}set(t,r,l){this.fetchUniformLocation(t,r)&&this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}}class Yt extends $d{constructor(t){super(t),this.current=0}set(t,r,l){this.fetchUniformLocation(t,r)&&this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class ua extends $d{constructor(t){super(t),this.current=[0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1])))}}class Xn extends $d{constructor(t){super(t),this.current=[0,0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2])))}}class rl extends $d{constructor(t){super(t),this.current=[0,0,0,0]}set(t,r,l){this.fetchUniformLocation(t,r)&&(l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3])))}}class Yy extends $d{constructor(t){super(t),this.current=xn.transparent}set(t,r,l){this.fetchUniformLocation(t,r)&&(l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a)))}}const SQ=new Float32Array(16);class jn extends $d{constructor(t){super(t),this.current=SQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let u=1;u<16;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}}}const AQ=new Float32Array(9);class kO extends $d{constructor(t){super(t),this.current=AQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){for(let u=0;u<9;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}}const EQ=new Float32Array(4);class IC extends $d{constructor(t){super(t),this.current=EQ}set(t,r,l){if(this.fetchUniformLocation(t,r)){for(let u=0;u<4;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix2fv(this.location,!1,l);break}}}}function LC(i){return[CO(255*i.r,255*i.g),CO(255*i.b,255*i.a)]}class Q_{constructor(t,r,l){this.value=t,this.uniformNames=r.map(u=>`u_${u}`),this.type=l}setUniform(t,r,l,u,h){r.set(t,h,u.constantOr(this.value))}getBinding(t,r){return this.type==="color"?new Yy(t):new Yt(t)}}class Zy{constructor(t,r){this.uniformNames=r.map(l=>`u_${l}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,r,l,u,h){const p=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;p&&r.set(t,h,p)}getBinding(t,r){return r==="u_pattern"||r==="u_dash"?new rl(t):new Yt(t)}}class qd{constructor(t,r,l,u){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=r.map(h=>({name:`a_${h}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,r,l,u,h,p,g){const v=this.paintVertexArray.length,b=this.expression.evaluate(new ri(0,{brightness:p}),r,{},h,u,g);this.paintVertexArray.resize(t),this._setPaintValue(v,t,b)}updatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate({zoom:0,brightness:g},l,u,void 0,h);this._setPaintValue(t,r,v)}_setPaintValue(t,r,l){if(this.type==="color"){const u=LC(l);for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,u[0],u[1])}else{for(let u=t;u<r;u++)this.paintVertexArray.emplace(u,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Wc{constructor(t,r,l,u,h,p){this.expression=t,this.uniformNames=r.map(g=>`u_${g}_t`),this.type=l,this.useIntegerZoom=u,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new p}populatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate(new ri(this.zoom,{brightness:p}),r,{},h,u,g),b=this.expression.evaluate(new ri(this.zoom+1,{brightness:p}),r,{},h,u,g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,v,b)}updatePaintArray(t,r,l,u,h,p,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},l,u,void 0,h),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},l,u,void 0,h);this._setPaintValue(t,r,v,b)}_setPaintValue(t,r,l,u){if(this.type==="color"){const h=LC(l),p=LC(u);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,h[0],h[1],p[0],p[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,l,u);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r,l,u,h){const p=this.useIntegerZoom?Math.floor(l.zoom):l.zoom,g=ae(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);r.set(t,h,g)}getBinding(t,r){return new Yt(t)}}class hf{constructor(t,r,l,u,h){this.expression=t,this.layerId=h,this.paintVertexAttributes=(l==="array"?bQ:_Q).members;for(let p=0;p<r.length;++p);this.paintVertexArray=new u}populatePaintArray(t,r,l){const u=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(u,t,r.patterns&&r.patterns[this.layerId],l)}updatePaintArray(t,r,l,u,h,p,g){this._setPaintValues(t,r,l.patterns&&l.patterns[this.layerId],p)}_setPaintValues(t,r,l,u){if(!u||!l)return;const h=u[l];if(!h)return;const{tl:p,br:g,pixelRatio:v}=h;for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,p[0],p[1],g[0],g[1],v)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class mm{constructor(t,r,l=()=>!0){this.binders={},this._buffers=[];const u=[];for(const h in t.paint._values){const p=t.paint.get(h);if(!l(h)||!(p instanceof il&&Nd(p.property.specification)))continue;const g=TQ(h,t.type),v=p.value,b=p.property.specification.type,w=!!p.property.useIntegerZoom,A=h==="line-dasharray"||h.endsWith("pattern"),C=h==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||C)if(v.kind==="source"||C||A){const P=DO(h,b,"source");this.binders[h]=A?new hf(v,g,b,P,t.id):new qd(v,g,b,P),u.push(`/a_${h}`)}else{const P=DO(h,b,"composite");this.binders[h]=new Wc(v,g,b,w,r,P),u.push(`/z_${h}`)}else this.binders[h]=A?new Zy(v.value,g):new Q_(v.value,g,b),u.push(`/u_${h}`)}this.cacheKey=u.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof qd||r instanceof Wc?r.maxValue:0}populatePaintArrays(t,r,l,u,h,p,g){for(const v in this.binders){const b=this.binders[v];(b instanceof qd||b instanceof Wc||b instanceof hf)&&b.populatePaintArray(t,r,l,u,h,p,g)}}setConstantPatternPositions(t){for(const r in this.binders){const l=this.binders[r];l instanceof Zy&&l.setConstantPatternPositions(t)}}updatePaintArrays(t,r,l,u,h,p,g,v){let b=!1;const w=Object.keys(t),A=w.length!==0,C=A?w:r.uniqueIds;for(const P in this.binders){const R=this.binders[P];if((R instanceof qd||R instanceof Wc||R instanceof hf)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const z=h.paint.get(P);R.expression=z.value;for(const U of C){const W=t[U.toString()];r.eachPosition(U,(j,Y,Z)=>{const $=u.feature(j);R.updatePaintArray(Y,Z,$,W,p,g,v)})}if(!A)for(const U of l.uniqueIds){const W=t[U.toString()];l.eachPosition(U,(j,Y,Z)=>{const $=u.feature(j);R.updatePaintArray(Y,Z,$,W,p,g,v)})}b=!0}}return b}defines(){const t=[];for(const r in this.binders){const l=this.binders[r];(l instanceof Q_||l instanceof Zy)&&t.push(...l.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof qd||l instanceof Wc||l instanceof hf)for(let u=0;u<l.paintVertexAttributes.length;u++)t.push(l.paintVertexAttributes[u].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const l=this.binders[r];if(l instanceof Q_||l instanceof Zy||l instanceof Wc)for(const u of l.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const r=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof Q_||u instanceof Zy||u instanceof Wc)for(const h of u.uniformNames)r.push({name:h,property:l,binding:u.getBinding(t,h)})}return r}setUniforms(t,r,l,u,h){for(const{name:p,property:g,binding:v}of l)this.binders[g].setUniform(t,v,h,u.get(g),p)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const r=this.binders[t];(r instanceof qd||r instanceof Wc||r instanceof hf)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(t){for(const r in this.binders){const l=this.binders[r];(l instanceof qd||l instanceof Wc||l instanceof hf)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof qd||r instanceof Wc||r instanceof hf)&&r.destroy()}}}class ff{constructor(t,r,l=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new mm(u,r,l);this.needsUpload=!1,this._featureMap=new J_,this._featureMapWithoutIds=new J_,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,r,l,u,h,p,g,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,u,h,p,g,v);r.id!==void 0?this._featureMap.add(r.id,l,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,l,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,l,u,h,p){for(const g of l)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,r,g,u,h,p||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const MQ={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function TQ(i,t){return MQ[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}const CQ={"line-pattern":{source:Mn,composite:Mn},"fill-pattern":{source:Mn,composite:Mn},"fill-extrusion-pattern":{source:Mn,composite:Mn},"line-dasharray":{source:_a,composite:_a}},PQ={color:{source:K_,composite:dn},number:{source:mr,composite:K_}};function DO(i,t,r){const l=CQ[i];return l&&l[r]||PQ[t][r]}un(Q_,"ConstantBinder"),un(Zy,"PatternConstantBinder"),un(qd,"SourceExpressionBinder"),un(hf,"PatternCompositeBinder"),un(Wc,"CompositeExpressionBinder"),un(mm,"ProgramConfiguration",{omit:["_buffers"]}),un(ff,"ProgramConfigurationSet");class Dl{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}setSouthWest(t){return this._sw=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}extend(t){const r=this._sw,l=this._ne;let u,h;if(t instanceof On)u=t,h=t;else{if(!(t instanceof Dl))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Dl.convert(t)):this.extend(On.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(On.convert(t)):this;if(u=t._sw,h=t._ne,!u||!h)return this}return r||l?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),l.lng=Math.max(h.lng,l.lng),l.lat=Math.max(h.lat,l.lat)):(this._sw=new On(u.lng,u.lat),this._ne=new On(h.lng,h.lat)),this}getCenter(){return new On((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new On(this.getWest(),this.getNorth())}getSouthEast(){return new On(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:l}=On.convert(t);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(t){return!t||t instanceof Dl?t:new Dl(t)}}var no={},ao={};Object.defineProperty(ao,"__esModule",{value:!0}),ao.setMatrixArrayType=function(i){ao.ARRAY_TYPE=zO=i},ao.toRadian=function(i){return i*LQ},ao.equals=function(i,t){return Math.abs(i-t)<=OO*Math.max(1,Math.abs(i),Math.abs(t))},ao.RANDOM=ao.ARRAY_TYPE=ao.EPSILON=void 0;var OO=1e-6;ao.EPSILON=OO;var zO=typeof Float32Array<"u"?Float32Array:Array;ao.ARRAY_TYPE=zO;var IQ=Math.random;ao.RANDOM=IQ;var LQ=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var Pi={};function RC(i){return RC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RC(i)}Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.create=function(){var i=new pf.ARRAY_TYPE(4);return pf.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i},Pi.clone=function(i){var t=new pf.ARRAY_TYPE(4);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t},Pi.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},Pi.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i},Pi.fromValues=function(i,t,r,l){var u=new pf.ARRAY_TYPE(4);return u[0]=i,u[1]=t,u[2]=r,u[3]=l,u},Pi.set=function(i,t,r,l,u){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i},Pi.transpose=function(i,t){if(i===t){var r=t[1];i[1]=t[2],i[2]=r}else i[0]=t[0],i[1]=t[2],i[2]=t[1],i[3]=t[3];return i},Pi.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*h-u*l;return p?(i[0]=h*(p=1/p),i[1]=-l*p,i[2]=-u*p,i[3]=r*p,i):null},Pi.adjoint=function(i,t){var r=t[0];return i[0]=t[3],i[1]=-t[1],i[2]=-t[2],i[3]=r,i},Pi.determinant=function(i){return i[0]*i[3]-i[2]*i[1]},Pi.multiply=NO,Pi.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+h*g,i[1]=u*v+p*g,i[2]=l*-g+h*v,i[3]=u*-g+p*v,i},Pi.scale=function(i,t,r){var l=t[1],u=t[2],h=t[3],p=r[0],g=r[1];return i[0]=t[0]*p,i[1]=l*p,i[2]=u*g,i[3]=h*g,i},Pi.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=-r,i[3]=l,i},Pi.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=t[1],i},Pi.str=function(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Pi.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},Pi.LDU=function(i,t,r,l){return i[2]=l[2]/l[0],r[0]=l[0],r[1]=l[1],r[3]=l[3]-i[2]*r[1],[i,t,r]},Pi.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i},Pi.subtract=BO,Pi.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]},Pi.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-p)<=pf.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(l-g)<=pf.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=pf.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=pf.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},Pi.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},Pi.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i},Pi.sub=Pi.mul=void 0;var pf=function(i,t){if(i&&i.__esModule)return i;if(i===null||RC(i)!=="object"&&typeof i!="function")return{default:i};var r=FO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function FO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(FO=function(l){return l?r:t})(i)}function NO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return i[0]=l*g+h*v,i[1]=u*g+p*v,i[2]=l*b+h*w,i[3]=u*b+p*w,i}function BO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i}Pi.mul=NO,Pi.sub=BO;var Di={};function kC(i){return kC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kC(i)}Object.defineProperty(Di,"__esModule",{value:!0}),Di.create=function(){var i=new Uu.ARRAY_TYPE(6);return Uu.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[4]=0,i[5]=0),i[0]=1,i[3]=1,i},Di.clone=function(i){var t=new Uu.ARRAY_TYPE(6);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t},Di.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i},Di.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i},Di.fromValues=function(i,t,r,l,u,h){var p=new Uu.ARRAY_TYPE(6);return p[0]=i,p[1]=t,p[2]=r,p[3]=l,p[4]=u,p[5]=h,p},Di.set=function(i,t,r,l,u,h,p){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i},Di.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=r*h-l*u;return v?(i[0]=h*(v=1/v),i[1]=-l*v,i[2]=-u*v,i[3]=r*v,i[4]=(u*g-h*p)*v,i[5]=(l*p-r*g)*v,i):null},Di.determinant=function(i){return i[0]*i[3]-i[1]*i[2]},Di.multiply=WO,Di.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=Math.sin(r),w=Math.cos(r);return i[0]=l*w+h*b,i[1]=u*w+p*b,i[2]=l*-b+h*w,i[3]=u*-b+p*w,i[4]=g,i[5]=v,i},Di.scale=function(i,t,r){var l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=r[0],b=r[1];return i[0]=t[0]*v,i[1]=l*v,i[2]=u*b,i[3]=h*b,i[4]=p,i[5]=g,i},Di.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=r[0],w=r[1];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=l*b+h*w+g,i[5]=u*b+p*w+v,i},Di.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=-r,i[3]=l,i[4]=0,i[5]=0,i},Di.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=t[1],i[4]=0,i[5]=0,i},Di.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i[4]=t[0],i[5]=t[1],i},Di.str=function(i){return"mat2d("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+")"},Di.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],1)},Di.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i},Di.subtract=VO,Di.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i},Di.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i},Di.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]},Di.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=t[0],b=t[1],w=t[2],A=t[3],C=t[4],P=t[5];return Math.abs(r-v)<=Uu.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(l-b)<=Uu.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(u-w)<=Uu.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-A)<=Uu.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(p-C)<=Uu.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-P)<=Uu.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},Di.sub=Di.mul=void 0;var Uu=function(i,t){if(i&&i.__esModule)return i;if(i===null||kC(i)!=="object"&&typeof i!="function")return{default:i};var r=UO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function UO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(UO=function(l){return l?r:t})(i)}function WO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=r[0],w=r[1],A=r[2],C=r[3],P=r[4],R=r[5];return i[0]=l*b+h*w,i[1]=u*b+p*w,i[2]=l*A+h*C,i[3]=u*A+p*C,i[4]=l*P+h*R+g,i[5]=u*P+p*R+v,i}function VO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i}Di.mul=WO,Di.sub=VO;var qa={};function DC(i){return DC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},DC(i)}Object.defineProperty(qa,"__esModule",{value:!0}),qa.create=function(){var i=new Ol.ARRAY_TYPE(9);return Ol.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i},qa.fromMat4=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[4],i[4]=t[5],i[5]=t[6],i[6]=t[8],i[7]=t[9],i[8]=t[10],i},qa.clone=function(i){var t=new Ol.ARRAY_TYPE(9);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t},qa.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},qa.fromValues=function(i,t,r,l,u,h,p,g,v){var b=new Ol.ARRAY_TYPE(9);return b[0]=i,b[1]=t,b[2]=r,b[3]=l,b[4]=u,b[5]=h,b[6]=p,b[7]=g,b[8]=v,b},qa.set=function(i,t,r,l,u,h,p,g,v,b){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i[8]=b,i},qa.identity=function(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},qa.transpose=function(i,t){if(i===t){var r=t[1],l=t[2],u=t[5];i[1]=t[3],i[2]=t[6],i[3]=r,i[5]=t[7],i[6]=l,i[7]=u}else i[0]=t[0],i[1]=t[3],i[2]=t[6],i[3]=t[1],i[4]=t[4],i[5]=t[7],i[6]=t[2],i[7]=t[5],i[8]=t[8];return i},qa.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=w*p-g*b,C=-w*h+g*v,P=b*h-p*v,R=r*A+l*C+u*P;return R?(i[0]=A*(R=1/R),i[1]=(-w*l+u*b)*R,i[2]=(g*l-u*p)*R,i[3]=C*R,i[4]=(w*r-u*v)*R,i[5]=(-g*r+u*h)*R,i[6]=P*R,i[7]=(-b*r+l*v)*R,i[8]=(p*r-l*h)*R,i):null},qa.adjoint=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],w=t[8];return i[0]=p*w-g*b,i[1]=u*b-l*w,i[2]=l*g-u*p,i[3]=g*v-h*w,i[4]=r*w-u*v,i[5]=u*h-r*g,i[6]=h*b-p*v,i[7]=l*v-r*b,i[8]=r*p-l*h,i},qa.determinant=function(i){var t=i[3],r=i[4],l=i[5],u=i[6],h=i[7],p=i[8];return i[0]*(p*r-l*h)+i[1]*(-p*t+l*u)+i[2]*(h*t-r*u)},qa.multiply=HO,qa.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=r[0],P=r[1];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=g,i[5]=v,i[6]=C*l+P*p+b,i[7]=C*u+P*g+w,i[8]=C*h+P*v+A,i},qa.rotate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=Math.sin(r),P=Math.cos(r);return i[0]=P*l+C*p,i[1]=P*u+C*g,i[2]=P*h+C*v,i[3]=P*p-C*l,i[4]=P*g-C*u,i[5]=P*v-C*h,i[6]=b,i[7]=w,i[8]=A,i},qa.scale=function(i,t,r){var l=r[0],u=r[1];return i[0]=l*t[0],i[1]=l*t[1],i[2]=l*t[2],i[3]=u*t[3],i[4]=u*t[4],i[5]=u*t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i},qa.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=t[0],i[7]=t[1],i[8]=1,i},qa.fromRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=0,i[3]=-r,i[4]=l,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},qa.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=t[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},qa.fromMat2d=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=0,i[3]=t[2],i[4]=t[3],i[5]=0,i[6]=t[4],i[7]=t[5],i[8]=1,i},qa.fromQuat=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r+r,g=l+l,v=u+u,b=r*p,w=l*p,A=l*g,C=u*p,P=u*g,R=u*v,z=h*p,U=h*g,W=h*v;return i[0]=1-A-R,i[3]=w-W,i[6]=C+U,i[1]=w+W,i[4]=1-b-R,i[7]=P-z,i[2]=C-U,i[5]=P+z,i[8]=1-b-A,i},qa.normalFromMat4=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15],j=r*g-l*p,Y=r*v-u*p,Z=r*b-h*p,$=l*v-u*g,K=l*b-h*g,ie=u*b-h*v,ce=w*z-A*R,he=w*U-C*R,ye=w*W-P*R,Te=A*U-C*z,we=A*W-P*z,Ie=C*W-P*U,xe=j*Ie-Y*we+Z*Te+$*ye-K*he+ie*ce;return xe?(i[0]=(g*Ie-v*we+b*Te)*(xe=1/xe),i[1]=(v*ye-p*Ie-b*he)*xe,i[2]=(p*we-g*ye+b*ce)*xe,i[3]=(u*we-l*Ie-h*Te)*xe,i[4]=(r*Ie-u*ye+h*he)*xe,i[5]=(l*ye-r*we-h*ce)*xe,i[6]=(z*ie-U*K+W*$)*xe,i[7]=(U*Z-R*ie-W*Y)*xe,i[8]=(R*K-z*Z+W*j)*xe,i):null},qa.projection=function(i,t,r){return i[0]=2/t,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/r,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i},qa.str=function(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"},qa.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},qa.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i[8]=t[8]+r[8],i},qa.subtract=jO,qa.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*r,i},qa.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i[6]=t[6]+r[6]*l,i[7]=t[7]+r[7]*l,i[8]=t[8]+r[8]*l,i},qa.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]},qa.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],w=i[8],A=t[0],C=t[1],P=t[2],R=t[3],z=t[4],U=t[5],W=t[6],j=t[7],Y=t[8];return Math.abs(r-A)<=Ol.EPSILON*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(l-C)<=Ol.EPSILON*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(u-P)<=Ol.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-R)<=Ol.EPSILON*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(p-z)<=Ol.EPSILON*Math.max(1,Math.abs(p),Math.abs(z))&&Math.abs(g-U)<=Ol.EPSILON*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(v-W)<=Ol.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(b-j)<=Ol.EPSILON*Math.max(1,Math.abs(b),Math.abs(j))&&Math.abs(w-Y)<=Ol.EPSILON*Math.max(1,Math.abs(w),Math.abs(Y))},qa.sub=qa.mul=void 0;var Ol=function(i,t){if(i&&i.__esModule)return i;if(i===null||DC(i)!=="object"&&typeof i!="function")return{default:i};var r=GO(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function GO(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(GO=function(l){return l?r:t})(i)}function HO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=r[0],P=r[1],R=r[2],z=r[3],U=r[4],W=r[5],j=r[6],Y=r[7],Z=r[8];return i[0]=C*l+P*p+R*b,i[1]=C*u+P*g+R*w,i[2]=C*h+P*v+R*A,i[3]=z*l+U*p+W*b,i[4]=z*u+U*g+W*w,i[5]=z*h+U*v+W*A,i[6]=j*l+Y*p+Z*b,i[7]=j*u+Y*g+Z*w,i[8]=j*h+Y*v+Z*A,i}function jO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i[6]=t[6]-r[6],i[7]=t[7]-r[7],i[8]=t[8]-r[8],i}qa.mul=HO,qa.sub=jO;var Kn={};function OC(i){return OC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OC(i)}Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.create=function(){var i=new ji.ARRAY_TYPE(16);return ji.ARRAY_TYPE!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},Kn.clone=function(i){var t=new ji.ARRAY_TYPE(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},Kn.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},Kn.fromValues=function(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z){var U=new ji.ARRAY_TYPE(16);return U[0]=i,U[1]=t,U[2]=r,U[3]=l,U[4]=u,U[5]=h,U[6]=p,U[7]=g,U[8]=v,U[9]=b,U[10]=w,U[11]=A,U[12]=C,U[13]=P,U[14]=R,U[15]=z,U},Kn.set=function(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i[8]=b,i[9]=w,i[10]=A,i[11]=C,i[12]=P,i[13]=R,i[14]=z,i[15]=U,i},Kn.identity=qO,Kn.transpose=function(i,t){if(i===t){var r=t[1],l=t[2],u=t[3],h=t[6],p=t[7],g=t[11];i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=r,i[6]=t[9],i[7]=t[13],i[8]=l,i[9]=h,i[11]=t[14],i[12]=u,i[13]=p,i[14]=g}else i[0]=t[0],i[1]=t[4],i[2]=t[8],i[3]=t[12],i[4]=t[1],i[5]=t[5],i[6]=t[9],i[7]=t[13],i[8]=t[2],i[9]=t[6],i[10]=t[10],i[11]=t[14],i[12]=t[3],i[13]=t[7],i[14]=t[11],i[15]=t[15];return i},Kn.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15],j=r*g-l*p,Y=r*v-u*p,Z=r*b-h*p,$=l*v-u*g,K=l*b-h*g,ie=u*b-h*v,ce=w*z-A*R,he=w*U-C*R,ye=w*W-P*R,Te=A*U-C*z,we=A*W-P*z,Ie=C*W-P*U,xe=j*Ie-Y*we+Z*Te+$*ye-K*he+ie*ce;return xe?(i[0]=(g*Ie-v*we+b*Te)*(xe=1/xe),i[1]=(u*we-l*Ie-h*Te)*xe,i[2]=(z*ie-U*K+W*$)*xe,i[3]=(C*K-A*ie-P*$)*xe,i[4]=(v*ye-p*Ie-b*he)*xe,i[5]=(r*Ie-u*ye+h*he)*xe,i[6]=(U*Z-R*ie-W*Y)*xe,i[7]=(w*ie-C*Z+P*Y)*xe,i[8]=(p*we-g*ye+b*ce)*xe,i[9]=(l*ye-r*we-h*ce)*xe,i[10]=(R*K-z*Z+W*j)*xe,i[11]=(A*Z-w*K-P*j)*xe,i[12]=(g*he-p*Te-v*ce)*xe,i[13]=(r*Te-l*he+u*ce)*xe,i[14]=(z*Y-R*$-U*j)*xe,i[15]=(w*$-A*Y+C*j)*xe,i):null},Kn.adjoint=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],R=t[12],z=t[13],U=t[14],W=t[15];return i[0]=g*(C*W-P*U)-A*(v*W-b*U)+z*(v*P-b*C),i[1]=-(l*(C*W-P*U)-A*(u*W-h*U)+z*(u*P-h*C)),i[2]=l*(v*W-b*U)-g*(u*W-h*U)+z*(u*b-h*v),i[3]=-(l*(v*P-b*C)-g*(u*P-h*C)+A*(u*b-h*v)),i[4]=-(p*(C*W-P*U)-w*(v*W-b*U)+R*(v*P-b*C)),i[5]=r*(C*W-P*U)-w*(u*W-h*U)+R*(u*P-h*C),i[6]=-(r*(v*W-b*U)-p*(u*W-h*U)+R*(u*b-h*v)),i[7]=r*(v*P-b*C)-p*(u*P-h*C)+w*(u*b-h*v),i[8]=p*(A*W-P*z)-w*(g*W-b*z)+R*(g*P-b*A),i[9]=-(r*(A*W-P*z)-w*(l*W-h*z)+R*(l*P-h*A)),i[10]=r*(g*W-b*z)-p*(l*W-h*z)+R*(l*b-h*g),i[11]=-(r*(g*P-b*A)-p*(l*P-h*A)+w*(l*b-h*g)),i[12]=-(p*(A*U-C*z)-w*(g*U-v*z)+R*(g*C-v*A)),i[13]=r*(A*U-C*z)-w*(l*U-u*z)+R*(l*C-u*A),i[14]=-(r*(g*U-v*z)-p*(l*U-u*z)+R*(l*v-u*g)),i[15]=r*(g*C-v*A)-p*(l*C-u*A)+w*(l*v-u*g),i},Kn.determinant=function(i){var t=i[0],r=i[1],l=i[2],u=i[3],h=i[4],p=i[5],g=i[6],v=i[7],b=i[8],w=i[9],A=i[10],C=i[11],P=i[12],R=i[13],z=i[14],U=i[15];return(t*p-r*h)*(A*U-C*z)-(t*g-l*h)*(w*U-C*R)+(t*v-u*h)*(w*z-A*R)+(r*g-l*p)*(b*U-C*P)-(r*v-u*p)*(b*z-A*P)+(l*v-u*g)*(b*R-w*P)},Kn.multiply=XO,Kn.translate=function(i,t,r){var l,u,h,p,g,v,b,w,A,C,P,R,z=r[0],U=r[1],W=r[2];return t===i?(i[12]=t[0]*z+t[4]*U+t[8]*W+t[12],i[13]=t[1]*z+t[5]*U+t[9]*W+t[13],i[14]=t[2]*z+t[6]*U+t[10]*W+t[14],i[15]=t[3]*z+t[7]*U+t[11]*W+t[15]):(u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=t[9],P=t[10],R=t[11],i[0]=l=t[0],i[1]=u,i[2]=h,i[3]=p,i[4]=g,i[5]=v,i[6]=b,i[7]=w,i[8]=A,i[9]=C,i[10]=P,i[11]=R,i[12]=l*z+g*U+A*W+t[12],i[13]=u*z+v*U+C*W+t[13],i[14]=h*z+b*U+P*W+t[14],i[15]=p*z+w*U+R*W+t[15]),i},Kn.scale=function(i,t,r){var l=r[0],u=r[1],h=r[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*u,i[5]=t[5]*u,i[6]=t[6]*u,i[7]=t[7]*u,i[8]=t[8]*h,i[9]=t[9]*h,i[10]=t[10]*h,i[11]=t[11]*h,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},Kn.rotate=function(i,t,r,l){var u,h,p,g,v,b,w,A,C,P,R,z,U,W,j,Y,Z,$,K,ie,ce,he,ye,Te,we=l[0],Ie=l[1],xe=l[2],We=Math.hypot(we,Ie,xe);return We<ji.EPSILON?null:(we*=We=1/We,Ie*=We,xe*=We,u=Math.sin(r),h=Math.cos(r),v=t[1],b=t[2],w=t[3],C=t[5],P=t[6],R=t[7],U=t[9],W=t[10],j=t[11],K=we*Ie*(p=1-h)-xe*u,ie=Ie*Ie*p+h,ce=xe*Ie*p+we*u,he=we*xe*p+Ie*u,ye=Ie*xe*p-we*u,Te=xe*xe*p+h,i[0]=(g=t[0])*(Y=we*we*p+h)+(A=t[4])*(Z=Ie*we*p+xe*u)+(z=t[8])*($=xe*we*p-Ie*u),i[1]=v*Y+C*Z+U*$,i[2]=b*Y+P*Z+W*$,i[3]=w*Y+R*Z+j*$,i[4]=g*K+A*ie+z*ce,i[5]=v*K+C*ie+U*ce,i[6]=b*K+P*ie+W*ce,i[7]=w*K+R*ie+j*ce,i[8]=g*he+A*ye+z*Te,i[9]=v*he+C*ye+U*Te,i[10]=b*he+P*ye+W*Te,i[11]=w*he+R*ye+j*Te,t!==i&&(i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i)},Kn.rotateX=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[4],p=t[5],g=t[6],v=t[7],b=t[8],w=t[9],A=t[10],C=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=h*u+b*l,i[5]=p*u+w*l,i[6]=g*u+A*l,i[7]=v*u+C*l,i[8]=b*u-h*l,i[9]=w*u-p*l,i[10]=A*u-g*l,i[11]=C*u-v*l,i},Kn.rotateY=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],g=t[2],v=t[3],b=t[8],w=t[9],A=t[10],C=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=h*u-b*l,i[1]=p*u-w*l,i[2]=g*u-A*l,i[3]=v*u-C*l,i[8]=h*l+b*u,i[9]=p*l+w*u,i[10]=g*l+A*u,i[11]=v*l+C*u,i},Kn.rotateZ=function(i,t,r){var l=Math.sin(r),u=Math.cos(r),h=t[0],p=t[1],g=t[2],v=t[3],b=t[4],w=t[5],A=t[6],C=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=h*u+b*l,i[1]=p*u+w*l,i[2]=g*u+A*l,i[3]=v*u+C*l,i[4]=b*u-h*l,i[5]=w*u-p*l,i[6]=A*u-g*l,i[7]=C*u-v*l,i},Kn.fromTranslation=function(i,t){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i},Kn.fromScaling=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromRotation=function(i,t,r){var l,u,h,p=r[0],g=r[1],v=r[2],b=Math.hypot(p,g,v);return b<ji.EPSILON?null:(p*=b=1/b,g*=b,v*=b,l=Math.sin(t),u=Math.cos(t),i[0]=p*p*(h=1-u)+u,i[1]=g*p*h+v*l,i[2]=v*p*h-g*l,i[3]=0,i[4]=p*g*h-v*l,i[5]=g*g*h+u,i[6]=v*g*h+p*l,i[7]=0,i[8]=p*v*h+g*l,i[9]=g*v*h-p*l,i[10]=v*v*h+u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)},Kn.fromXRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=l,i[6]=r,i[7]=0,i[8]=0,i[9]=-r,i[10]=l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromYRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=0,i[2]=-r,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=r,i[9]=0,i[10]=l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromZRotation=function(i,t){var r=Math.sin(t),l=Math.cos(t);return i[0]=l,i[1]=r,i[2]=0,i[3]=0,i[4]=-r,i[5]=l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.fromRotationTranslation=YO,Kn.fromQuat2=function(i,t){var r=new ji.ARRAY_TYPE(3),l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=l*l+u*u+h*h+p*p;return A>0?(r[0]=2*(g*p+w*l+v*h-b*u)/A,r[1]=2*(v*p+w*u+b*l-g*h)/A,r[2]=2*(b*p+w*h+g*u-v*l)/A):(r[0]=2*(g*p+w*l+v*h-b*u),r[1]=2*(v*p+w*u+b*l-g*h),r[2]=2*(b*p+w*h+g*u-v*l)),YO(i,t,r),i},Kn.getTranslation=function(i,t){return i[0]=t[12],i[1]=t[13],i[2]=t[14],i},Kn.getScaling=ZO,Kn.getRotation=function(i,t){var r=new ji.ARRAY_TYPE(3);ZO(r,t);var l=1/r[0],u=1/r[1],h=1/r[2],p=t[0]*l,g=t[1]*u,v=t[2]*h,b=t[4]*l,w=t[5]*u,A=t[6]*h,C=t[8]*l,P=t[9]*u,R=t[10]*h,z=p+w+R,U=0;return z>0?(U=2*Math.sqrt(z+1),i[3]=.25*U,i[0]=(A-P)/U,i[1]=(C-v)/U,i[2]=(g-b)/U):p>w&&p>R?(U=2*Math.sqrt(1+p-w-R),i[3]=(A-P)/U,i[0]=.25*U,i[1]=(g+b)/U,i[2]=(C+v)/U):w>R?(U=2*Math.sqrt(1+w-p-R),i[3]=(C-v)/U,i[0]=(g+b)/U,i[1]=.25*U,i[2]=(A+P)/U):(U=2*Math.sqrt(1+R-p-w),i[3]=(g-b)/U,i[0]=(C+v)/U,i[1]=(A+P)/U,i[2]=.25*U),i},Kn.fromRotationTranslationScale=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=t[3],v=u+u,b=h+h,w=p+p,A=u*v,C=u*b,P=u*w,R=h*b,z=h*w,U=p*w,W=g*v,j=g*b,Y=g*w,Z=l[0],$=l[1],K=l[2];return i[0]=(1-(R+U))*Z,i[1]=(C+Y)*Z,i[2]=(P-j)*Z,i[3]=0,i[4]=(C-Y)*$,i[5]=(1-(A+U))*$,i[6]=(z+W)*$,i[7]=0,i[8]=(P+j)*K,i[9]=(z-W)*K,i[10]=(1-(A+R))*K,i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i},Kn.fromRotationTranslationScaleOrigin=function(i,t,r,l,u){var h=t[0],p=t[1],g=t[2],v=t[3],b=h+h,w=p+p,A=g+g,C=h*b,P=h*w,R=h*A,z=p*w,U=p*A,W=g*A,j=v*b,Y=v*w,Z=v*A,$=l[0],K=l[1],ie=l[2],ce=u[0],he=u[1],ye=u[2],Te=(1-(z+W))*$,we=(P+Z)*$,Ie=(R-Y)*$,xe=(P-Z)*K,We=(1-(C+W))*K,qe=(U+j)*K,et=(R+Y)*ie,Ne=(U-j)*ie,Ve=(1-(C+z))*ie;return i[0]=Te,i[1]=we,i[2]=Ie,i[3]=0,i[4]=xe,i[5]=We,i[6]=qe,i[7]=0,i[8]=et,i[9]=Ne,i[10]=Ve,i[11]=0,i[12]=r[0]+ce-(Te*ce+xe*he+et*ye),i[13]=r[1]+he-(we*ce+We*he+Ne*ye),i[14]=r[2]+ye-(Ie*ce+qe*he+Ve*ye),i[15]=1,i},Kn.fromQuat=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r+r,g=l+l,v=u+u,b=r*p,w=l*p,A=l*g,C=u*p,P=u*g,R=u*v,z=h*p,U=h*g,W=h*v;return i[0]=1-A-R,i[1]=w+W,i[2]=C-U,i[3]=0,i[4]=w-W,i[5]=1-b-R,i[6]=P+z,i[7]=0,i[8]=C+U,i[9]=P-z,i[10]=1-b-A,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},Kn.frustum=function(i,t,r,l,u,h,p){var g=1/(r-t),v=1/(u-l),b=1/(h-p);return i[0]=2*h*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*h*v,i[6]=0,i[7]=0,i[8]=(r+t)*g,i[9]=(u+l)*v,i[10]=(p+h)*b,i[11]=-1,i[12]=0,i[13]=0,i[14]=p*h*2*b,i[15]=0,i},Kn.perspectiveNO=KO,Kn.perspectiveZO=function(i,t,r,l,u){var h,p=1/Math.tan(t/2);return i[0]=p/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=u*(h=1/(l-u)),i[14]=u*l*h):(i[10]=-1,i[14]=-l),i},Kn.perspectiveFromFieldOfView=function(i,t,r,l){var u=Math.tan(t.upDegrees*Math.PI/180),h=Math.tan(t.downDegrees*Math.PI/180),p=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),v=2/(p+g),b=2/(u+h);return i[0]=v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=b,i[6]=0,i[7]=0,i[8]=-(p-g)*v*.5,i[9]=(u-h)*b*.5,i[10]=l/(r-l),i[11]=-1,i[12]=0,i[13]=0,i[14]=l*r/(r-l),i[15]=0,i},Kn.orthoNO=JO,Kn.orthoZO=function(i,t,r,l,u,h,p){var g=1/(t-r),v=1/(l-u),b=1/(h-p);return i[0]=-2*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=b,i[11]=0,i[12]=(t+r)*g,i[13]=(u+l)*v,i[14]=h*b,i[15]=1,i},Kn.lookAt=function(i,t,r,l){var u,h,p,g,v,b,w,A,C,P,R=t[0],z=t[1],U=t[2],W=l[0],j=l[1],Y=l[2],Z=r[0],$=r[1],K=r[2];return Math.abs(R-Z)<ji.EPSILON&&Math.abs(z-$)<ji.EPSILON&&Math.abs(U-K)<ji.EPSILON?qO(i):(w=R-Z,A=z-$,C=U-K,u=j*(C*=P=1/Math.hypot(w,A,C))-Y*(A*=P),h=Y*(w*=P)-W*C,p=W*A-j*w,(P=Math.hypot(u,h,p))?(u*=P=1/P,h*=P,p*=P):(u=0,h=0,p=0),g=A*p-C*h,v=C*u-w*p,b=w*h-A*u,(P=Math.hypot(g,v,b))?(g*=P=1/P,v*=P,b*=P):(g=0,v=0,b=0),i[0]=u,i[1]=g,i[2]=w,i[3]=0,i[4]=h,i[5]=v,i[6]=A,i[7]=0,i[8]=p,i[9]=b,i[10]=C,i[11]=0,i[12]=-(u*R+h*z+p*U),i[13]=-(g*R+v*z+b*U),i[14]=-(w*R+A*z+C*U),i[15]=1,i)},Kn.targetTo=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=l[0],v=l[1],b=l[2],w=u-r[0],A=h-r[1],C=p-r[2],P=w*w+A*A+C*C;P>0&&(w*=P=1/Math.sqrt(P),A*=P,C*=P);var R=v*C-b*A,z=b*w-g*C,U=g*A-v*w;return(P=R*R+z*z+U*U)>0&&(R*=P=1/Math.sqrt(P),z*=P,U*=P),i[0]=R,i[1]=z,i[2]=U,i[3]=0,i[4]=A*U-C*z,i[5]=C*R-w*U,i[6]=w*z-A*R,i[7]=0,i[8]=w,i[9]=A,i[10]=C,i[11]=0,i[12]=u,i[13]=h,i[14]=p,i[15]=1,i},Kn.str=function(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"},Kn.frob=function(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])},Kn.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i[8]=t[8]+r[8],i[9]=t[9]+r[9],i[10]=t[10]+r[10],i[11]=t[11]+r[11],i[12]=t[12]+r[12],i[13]=t[13]+r[13],i[14]=t[14]+r[14],i[15]=t[15]+r[15],i},Kn.subtract=QO,Kn.multiplyScalar=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i[8]=t[8]*r,i[9]=t[9]*r,i[10]=t[10]*r,i[11]=t[11]*r,i[12]=t[12]*r,i[13]=t[13]*r,i[14]=t[14]*r,i[15]=t[15]*r,i},Kn.multiplyScalarAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i[4]=t[4]+r[4]*l,i[5]=t[5]+r[5]*l,i[6]=t[6]+r[6]*l,i[7]=t[7]+r[7]*l,i[8]=t[8]+r[8]*l,i[9]=t[9]+r[9]*l,i[10]=t[10]+r[10]*l,i[11]=t[11]+r[11]*l,i[12]=t[12]+r[12]*l,i[13]=t[13]+r[13]*l,i[14]=t[14]+r[14]*l,i[15]=t[15]+r[15]*l,i},Kn.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},Kn.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],w=i[8],A=i[9],C=i[10],P=i[11],R=i[12],z=i[13],U=i[14],W=i[15],j=t[0],Y=t[1],Z=t[2],$=t[3],K=t[4],ie=t[5],ce=t[6],he=t[7],ye=t[8],Te=t[9],we=t[10],Ie=t[11],xe=t[12],We=t[13],qe=t[14],et=t[15];return Math.abs(r-j)<=ji.EPSILON*Math.max(1,Math.abs(r),Math.abs(j))&&Math.abs(l-Y)<=ji.EPSILON*Math.max(1,Math.abs(l),Math.abs(Y))&&Math.abs(u-Z)<=ji.EPSILON*Math.max(1,Math.abs(u),Math.abs(Z))&&Math.abs(h-$)<=ji.EPSILON*Math.max(1,Math.abs(h),Math.abs($))&&Math.abs(p-K)<=ji.EPSILON*Math.max(1,Math.abs(p),Math.abs(K))&&Math.abs(g-ie)<=ji.EPSILON*Math.max(1,Math.abs(g),Math.abs(ie))&&Math.abs(v-ce)<=ji.EPSILON*Math.max(1,Math.abs(v),Math.abs(ce))&&Math.abs(b-he)<=ji.EPSILON*Math.max(1,Math.abs(b),Math.abs(he))&&Math.abs(w-ye)<=ji.EPSILON*Math.max(1,Math.abs(w),Math.abs(ye))&&Math.abs(A-Te)<=ji.EPSILON*Math.max(1,Math.abs(A),Math.abs(Te))&&Math.abs(C-we)<=ji.EPSILON*Math.max(1,Math.abs(C),Math.abs(we))&&Math.abs(P-Ie)<=ji.EPSILON*Math.max(1,Math.abs(P),Math.abs(Ie))&&Math.abs(R-xe)<=ji.EPSILON*Math.max(1,Math.abs(R),Math.abs(xe))&&Math.abs(z-We)<=ji.EPSILON*Math.max(1,Math.abs(z),Math.abs(We))&&Math.abs(U-qe)<=ji.EPSILON*Math.max(1,Math.abs(U),Math.abs(qe))&&Math.abs(W-et)<=ji.EPSILON*Math.max(1,Math.abs(W),Math.abs(et))},Kn.sub=Kn.mul=Kn.ortho=Kn.perspective=void 0;var ji=function(i,t){if(i&&i.__esModule)return i;if(i===null||OC(i)!=="object"&&typeof i!="function")return{default:i};var r=$O(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function $O(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return($O=function(l){return l?r:t})(i)}function qO(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function XO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=t[9],P=t[10],R=t[11],z=t[12],U=t[13],W=t[14],j=t[15],Y=r[0],Z=r[1],$=r[2],K=r[3];return i[0]=Y*l+Z*g+$*A+K*z,i[1]=Y*u+Z*v+$*C+K*U,i[2]=Y*h+Z*b+$*P+K*W,i[3]=Y*p+Z*w+$*R+K*j,i[4]=(Y=r[4])*l+(Z=r[5])*g+($=r[6])*A+(K=r[7])*z,i[5]=Y*u+Z*v+$*C+K*U,i[6]=Y*h+Z*b+$*P+K*W,i[7]=Y*p+Z*w+$*R+K*j,i[8]=(Y=r[8])*l+(Z=r[9])*g+($=r[10])*A+(K=r[11])*z,i[9]=Y*u+Z*v+$*C+K*U,i[10]=Y*h+Z*b+$*P+K*W,i[11]=Y*p+Z*w+$*R+K*j,i[12]=(Y=r[12])*l+(Z=r[13])*g+($=r[14])*A+(K=r[15])*z,i[13]=Y*u+Z*v+$*C+K*U,i[14]=Y*h+Z*b+$*P+K*W,i[15]=Y*p+Z*w+$*R+K*j,i}function YO(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=l+l,v=u+u,b=h+h,w=l*g,A=l*v,C=l*b,P=u*v,R=u*b,z=h*b,U=p*g,W=p*v,j=p*b;return i[0]=1-(P+z),i[1]=A+j,i[2]=C-W,i[3]=0,i[4]=A-j,i[5]=1-(w+z),i[6]=R+U,i[7]=0,i[8]=C+W,i[9]=R-U,i[10]=1-(w+P),i[11]=0,i[12]=r[0],i[13]=r[1],i[14]=r[2],i[15]=1,i}function ZO(i,t){var r=t[4],l=t[5],u=t[6],h=t[8],p=t[9],g=t[10];return i[0]=Math.hypot(t[0],t[1],t[2]),i[1]=Math.hypot(r,l,u),i[2]=Math.hypot(h,p,g),i}function KO(i,t,r,l,u){var h,p=1/Math.tan(t/2);return i[0]=p/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=p,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,u!=null&&u!==1/0?(i[10]=(u+l)*(h=1/(l-u)),i[14]=2*u*l*h):(i[10]=-1,i[14]=-2*l),i}function JO(i,t,r,l,u,h,p){var g=1/(t-r),v=1/(l-u),b=1/(h-p);return i[0]=-2*g,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*b,i[11]=0,i[12]=(t+r)*g,i[13]=(u+l)*v,i[14]=(p+h)*b,i[15]=1,i}function QO(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i[4]=t[4]-r[4],i[5]=t[5]-r[5],i[6]=t[6]-r[6],i[7]=t[7]-r[7],i[8]=t[8]-r[8],i[9]=t[9]-r[9],i[10]=t[10]-r[10],i[11]=t[11]-r[11],i[12]=t[12]-r[12],i[13]=t[13]-r[13],i[14]=t[14]-r[14],i[15]=t[15]-r[15],i}Kn.perspective=KO,Kn.ortho=JO,Kn.mul=XO,Kn.sub=QO;var Gn={},Yn={};function zC(i){return zC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zC(i)}Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.create=tz,Yn.clone=function(i){var t=new Xd.ARRAY_TYPE(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},Yn.length=nz,Yn.fromValues=function(i,t,r){var l=new Xd.ARRAY_TYPE(3);return l[0]=i,l[1]=t,l[2]=r,l},Yn.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i},Yn.set=function(i,t,r,l){return i[0]=t,i[1]=r,i[2]=l,i},Yn.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i},Yn.subtract=az,Yn.multiply=iz,Yn.divide=rz,Yn.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i[2]=Math.ceil(t[2]),i},Yn.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i[2]=Math.floor(t[2]),i},Yn.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i[2]=Math.min(t[2],r[2]),i},Yn.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i[2]=Math.max(t[2],r[2]),i},Yn.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i[2]=Math.round(t[2]),i},Yn.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i},Yn.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i},Yn.distance=oz,Yn.squaredDistance=sz,Yn.squaredLength=lz,Yn.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i},Yn.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i[2]=1/t[2],i},Yn.normalize=function(i,t){var r=t[0],l=t[1],u=t[2],h=r*r+l*l+u*u;return h>0&&(h=1/Math.sqrt(h)),i[0]=t[0]*h,i[1]=t[1]*h,i[2]=t[2]*h,i},Yn.dot=cz,Yn.cross=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[0],g=r[1],v=r[2];return i[0]=u*v-h*g,i[1]=h*p-l*v,i[2]=l*g-u*p,i},Yn.lerp=function(i,t,r,l){var u=t[0],h=t[1],p=t[2];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i[2]=p+l*(r[2]-p),i},Yn.hermite=function(i,t,r,l,u,h){var p=h*h,g=p*(2*h-3)+1,v=p*(h-2)+h,b=p*(h-1),w=p*(3-2*h);return i[0]=t[0]*g+r[0]*v+l[0]*b+u[0]*w,i[1]=t[1]*g+r[1]*v+l[1]*b+u[1]*w,i[2]=t[2]*g+r[2]*v+l[2]*b+u[2]*w,i},Yn.bezier=function(i,t,r,l,u,h){var p=1-h,g=p*p,v=h*h,b=g*p,w=3*h*g,A=3*v*p,C=v*h;return i[0]=t[0]*b+r[0]*w+l[0]*A+u[0]*C,i[1]=t[1]*b+r[1]*w+l[1]*A+u[1]*C,i[2]=t[2]*b+r[2]*w+l[2]*A+u[2]*C,i},Yn.random=function(i,t){t=t||1;var r=2*Xd.RANDOM()*Math.PI,l=2*Xd.RANDOM()-1,u=Math.sqrt(1-l*l)*t;return i[0]=Math.cos(r)*u,i[1]=Math.sin(r)*u,i[2]=l*t,i},Yn.transformMat4=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[3]*l+r[7]*u+r[11]*h+r[15];return i[0]=(r[0]*l+r[4]*u+r[8]*h+r[12])/(p=p||1),i[1]=(r[1]*l+r[5]*u+r[9]*h+r[13])/p,i[2]=(r[2]*l+r[6]*u+r[10]*h+r[14])/p,i},Yn.transformMat3=function(i,t,r){var l=t[0],u=t[1],h=t[2];return i[0]=l*r[0]+u*r[3]+h*r[6],i[1]=l*r[1]+u*r[4]+h*r[7],i[2]=l*r[2]+u*r[5]+h*r[8],i},Yn.transformQuat=function(i,t,r){var l=r[0],u=r[1],h=r[2],p=t[0],g=t[1],v=t[2],b=u*v-h*g,w=h*p-l*v,A=l*g-u*p,C=u*A-h*w,P=h*b-l*A,R=l*w-u*b,z=2*r[3];return w*=z,A*=z,P*=2,R*=2,i[0]=p+(b*=z)+(C*=2),i[1]=g+w+P,i[2]=v+A+R,i},Yn.rotateX=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0],h[1]=u[1]*Math.cos(l)-u[2]*Math.sin(l),h[2]=u[1]*Math.sin(l)+u[2]*Math.cos(l),i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Yn.rotateY=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[2]*Math.sin(l)+u[0]*Math.cos(l),h[1]=u[1],h[2]=u[2]*Math.cos(l)-u[0]*Math.sin(l),i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Yn.rotateZ=function(i,t,r,l){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0]*Math.cos(l)-u[1]*Math.sin(l),h[1]=u[0]*Math.sin(l)+u[1]*Math.cos(l),h[2]=u[2],i[0]=h[0]+r[0],i[1]=h[1]+r[1],i[2]=h[2]+r[2],i},Yn.angle=function(i,t){var r=i[0],l=i[1],u=i[2],h=t[0],p=t[1],g=t[2],v=Math.sqrt(r*r+l*l+u*u)*Math.sqrt(h*h+p*p+g*g),b=v&&cz(i,t)/v;return Math.acos(Math.min(Math.max(b,-1),1))},Yn.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i},Yn.str=function(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"},Yn.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]},Yn.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=t[0],p=t[1],g=t[2];return Math.abs(r-h)<=Xd.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(l-p)<=Xd.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(u-g)<=Xd.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},Yn.forEach=Yn.sqrLen=Yn.len=Yn.sqrDist=Yn.dist=Yn.div=Yn.mul=Yn.sub=void 0;var Xd=function(i,t){if(i&&i.__esModule)return i;if(i===null||zC(i)!=="object"&&typeof i!="function")return{default:i};var r=ez(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function ez(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(ez=function(l){return l?r:t})(i)}function tz(){var i=new Xd.ARRAY_TYPE(3);return Xd.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function nz(i){return Math.hypot(i[0],i[1],i[2])}function az(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i}function iz(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i}function rz(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i[2]=t[2]/r[2],i}function oz(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1],t[2]-i[2])}function sz(i,t){var r=t[0]-i[0],l=t[1]-i[1],u=t[2]-i[2];return r*r+l*l+u*u}function lz(i){var t=i[0],r=i[1],l=i[2];return t*t+r*r+l*l}function cz(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]}Yn.sub=az,Yn.mul=iz,Yn.div=rz,Yn.dist=oz,Yn.sqrDist=sz,Yn.len=nz,Yn.sqrLen=lz;var Yd,RQ=(Yd=tz(),function(i,t,r,l,u,h){var p,g;for(t||(t=3),r||(r=0),g=l?Math.min(l*t+r,i.length):i.length,p=r;p<g;p+=t)Yd[0]=i[p],Yd[1]=i[p+1],Yd[2]=i[p+2],u(Yd,Yd,h),i[p]=Yd[0],i[p+1]=Yd[1],i[p+2]=Yd[2];return i});Yn.forEach=RQ;var da={};function FC(i){return FC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FC(i)}Object.defineProperty(da,"__esModule",{value:!0}),da.create=dz,da.clone=function(i){var t=new dc.ARRAY_TYPE(4);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t},da.fromValues=function(i,t,r,l){var u=new dc.ARRAY_TYPE(4);return u[0]=i,u[1]=t,u[2]=r,u[3]=l,u},da.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i},da.set=function(i,t,r,l,u){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i},da.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i},da.subtract=hz,da.multiply=fz,da.divide=pz,da.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i[2]=Math.ceil(t[2]),i[3]=Math.ceil(t[3]),i},da.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i[2]=Math.floor(t[2]),i[3]=Math.floor(t[3]),i},da.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i[2]=Math.min(t[2],r[2]),i[3]=Math.min(t[3],r[3]),i},da.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i[2]=Math.max(t[2],r[2]),i[3]=Math.max(t[3],r[3]),i},da.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i[2]=Math.round(t[2]),i[3]=Math.round(t[3]),i},da.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},da.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i[2]=t[2]+r[2]*l,i[3]=t[3]+r[3]*l,i},da.distance=mz,da.squaredDistance=gz,da.length=yz,da.squaredLength=vz,da.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=-t[3],i},da.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i[2]=1/t[2],i[3]=1/t[3],i},da.normalize=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*r+l*l+u*u+h*h;return p>0&&(p=1/Math.sqrt(p)),i[0]=r*p,i[1]=l*p,i[2]=u*p,i[3]=h*p,i},da.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},da.cross=function(i,t,r,l){var u=r[0]*l[1]-r[1]*l[0],h=r[0]*l[2]-r[2]*l[0],p=r[0]*l[3]-r[3]*l[0],g=r[1]*l[2]-r[2]*l[1],v=r[1]*l[3]-r[3]*l[1],b=r[2]*l[3]-r[3]*l[2],w=t[0],A=t[1],C=t[2],P=t[3];return i[0]=A*b-C*v+P*g,i[1]=-w*b+C*p-P*h,i[2]=w*v-A*p+P*u,i[3]=-w*g+A*h-C*u,i},da.lerp=function(i,t,r,l){var u=t[0],h=t[1],p=t[2],g=t[3];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i[2]=p+l*(r[2]-p),i[3]=g+l*(r[3]-g),i},da.random=function(i,t){var r,l,u,h,p,g;t=t||1;do p=(r=2*dc.RANDOM()-1)*r+(l=2*dc.RANDOM()-1)*l;while(p>=1);do g=(u=2*dc.RANDOM()-1)*u+(h=2*dc.RANDOM()-1)*h;while(g>=1);var v=Math.sqrt((1-p)/g);return i[0]=t*r,i[1]=t*l,i[2]=t*u*v,i[3]=t*h*v,i},da.transformMat4=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3];return i[0]=r[0]*l+r[4]*u+r[8]*h+r[12]*p,i[1]=r[1]*l+r[5]*u+r[9]*h+r[13]*p,i[2]=r[2]*l+r[6]*u+r[10]*h+r[14]*p,i[3]=r[3]*l+r[7]*u+r[11]*h+r[15]*p,i},da.transformQuat=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=r[0],g=r[1],v=r[2],b=r[3],w=b*l+g*h-v*u,A=b*u+v*l-p*h,C=b*h+p*u-g*l,P=-p*l-g*u-v*h;return i[0]=w*b+P*-p+A*-v-C*-g,i[1]=A*b+P*-g+C*-p-w*-v,i[2]=C*b+P*-v+w*-g-A*-p,i[3]=t[3],i},da.zero=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i},da.str=function(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},da.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]},da.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-p)<=dc.EPSILON*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(l-g)<=dc.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=dc.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=dc.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},da.forEach=da.sqrLen=da.len=da.sqrDist=da.dist=da.div=da.mul=da.sub=void 0;var dc=function(i,t){if(i&&i.__esModule)return i;if(i===null||FC(i)!=="object"&&typeof i!="function")return{default:i};var r=uz(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function uz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(uz=function(l){return l?r:t})(i)}function dz(){var i=new dc.ARRAY_TYPE(4);return dc.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function hz(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i[3]=t[3]-r[3],i}function fz(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i[3]=t[3]*r[3],i}function pz(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i[2]=t[2]/r[2],i[3]=t[3]/r[3],i}function mz(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1],t[2]-i[2],t[3]-i[3])}function gz(i,t){var r=t[0]-i[0],l=t[1]-i[1],u=t[2]-i[2],h=t[3]-i[3];return r*r+l*l+u*u+h*h}function yz(i){return Math.hypot(i[0],i[1],i[2],i[3])}function vz(i){var t=i[0],r=i[1],l=i[2],u=i[3];return t*t+r*r+l*l+u*u}da.sub=hz,da.mul=fz,da.div=pz,da.dist=mz,da.sqrDist=gz,da.len=yz,da.sqrLen=vz;var kQ=function(){var i=dz();return function(t,r,l,u,h,p){var g,v;for(r||(r=4),l||(l=0),v=u?Math.min(u*r+l,t.length):t.length,g=l;g<v;g+=r)i[0]=t[g],i[1]=t[g+1],i[2]=t[g+2],i[3]=t[g+3],h(i,i,p),t[g]=i[0],t[g+1]=i[1],t[g+2]=i[2],t[g+3]=i[3];return t}}();function NC(i){return NC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NC(i)}da.forEach=kQ,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.create=BC,Gn.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i},Gn.setAxisAngle=bz,Gn.getAxisAngle=function(i,t){var r=2*Math.acos(t[3]),l=Math.sin(r/2);return l>gm.EPSILON?(i[0]=t[0]/l,i[1]=t[1]/l,i[2]=t[2]/l):(i[0]=1,i[1]=0,i[2]=0),r},Gn.getAngle=function(i,t){var r=Mz(i,t);return Math.acos(2*r*r-1)},Gn.multiply=xz,Gn.rotateX=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+p*g,i[1]=u*v+h*g,i[2]=h*v-u*g,i[3]=p*v-l*g,i},Gn.rotateY=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v-h*g,i[1]=u*v+p*g,i[2]=h*v+l*g,i[3]=p*v-u*g,i},Gn.rotateZ=function(i,t,r){r*=.5;var l=t[0],u=t[1],h=t[2],p=t[3],g=Math.sin(r),v=Math.cos(r);return i[0]=l*v+u*g,i[1]=u*v-l*g,i[2]=h*v+p*g,i[3]=p*v-h*g,i},Gn.calculateW=function(i,t){var r=t[0],l=t[1],u=t[2];return i[0]=r,i[1]=l,i[2]=u,i[3]=Math.sqrt(Math.abs(1-r*r-l*l-u*u)),i},Gn.exp=wz,Gn.ln=Sz,Gn.pow=function(i,t,r){return Sz(i,t),Ez(i,i,r),wz(i,i),i},Gn.slerp=b2,Gn.random=function(i){var t=gm.RANDOM(),r=gm.RANDOM(),l=gm.RANDOM(),u=Math.sqrt(1-t),h=Math.sqrt(t);return i[0]=u*Math.sin(2*Math.PI*r),i[1]=u*Math.cos(2*Math.PI*r),i[2]=h*Math.sin(2*Math.PI*l),i[3]=h*Math.cos(2*Math.PI*l),i},Gn.invert=function(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=r*r+l*l+u*u+h*h,g=p?1/p:0;return i[0]=-r*g,i[1]=-l*g,i[2]=-u*g,i[3]=h*g,i},Gn.conjugate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=t[3],i},Gn.fromMat3=Az,Gn.fromEuler=function(i,t,r,l){var u=.5*Math.PI/180;t*=u,r*=u,l*=u;var h=Math.sin(t),p=Math.cos(t),g=Math.sin(r),v=Math.cos(r),b=Math.sin(l),w=Math.cos(l);return i[0]=h*v*w-p*g*b,i[1]=p*g*w+h*v*b,i[2]=p*v*b-h*g*w,i[3]=p*v*w+h*g*b,i},Gn.str=function(i){return"quat("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"},Gn.setAxes=Gn.sqlerp=Gn.rotationTo=Gn.equals=Gn.exactEquals=Gn.normalize=Gn.sqrLen=Gn.squaredLength=Gn.len=Gn.length=Gn.lerp=Gn.dot=Gn.scale=Gn.mul=Gn.add=Gn.set=Gn.copy=Gn.fromValues=Gn.clone=void 0;var gm=_2(ao),DQ=_2(qa),Zd=_2(Yn),zl=_2(da);function _z(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(_z=function(l){return l?r:t})(i)}function _2(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||NC(i)!=="object"&&typeof i!="function")return{default:i};var r=_z(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}function BC(){var i=new gm.ARRAY_TYPE(4);return gm.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function bz(i,t,r){r*=.5;var l=Math.sin(r);return i[0]=l*t[0],i[1]=l*t[1],i[2]=l*t[2],i[3]=Math.cos(r),i}function xz(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return i[0]=l*w+p*g+u*b-h*v,i[1]=u*w+p*v+h*g-l*b,i[2]=h*w+p*b+l*v-u*g,i[3]=p*w-l*g-u*v-h*b,i}function wz(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=Math.sqrt(r*r+l*l+u*u),g=Math.exp(h),v=p>0?g*Math.sin(p)/p:0;return i[0]=r*v,i[1]=l*v,i[2]=u*v,i[3]=g*Math.cos(p),i}function Sz(i,t){var r=t[0],l=t[1],u=t[2],h=t[3],p=Math.sqrt(r*r+l*l+u*u),g=p>0?Math.atan2(p,h)/p:0;return i[0]=r*g,i[1]=l*g,i[2]=u*g,i[3]=.5*Math.log(r*r+l*l+u*u+h*h),i}function b2(i,t,r,l){var u,h,p,g,v,b=t[0],w=t[1],A=t[2],C=t[3],P=r[0],R=r[1],z=r[2],U=r[3];return(h=b*P+w*R+A*z+C*U)<0&&(h=-h,P=-P,R=-R,z=-z,U=-U),1-h>gm.EPSILON?(u=Math.acos(h),p=Math.sin(u),g=Math.sin((1-l)*u)/p,v=Math.sin(l*u)/p):(g=1-l,v=l),i[0]=g*b+v*P,i[1]=g*w+v*R,i[2]=g*A+v*z,i[3]=g*C+v*U,i}function Az(i,t){var r,l=t[0]+t[4]+t[8];if(l>0)r=Math.sqrt(l+1),i[3]=.5*r,i[0]=(t[5]-t[7])*(r=.5/r),i[1]=(t[6]-t[2])*r,i[2]=(t[1]-t[3])*r;else{var u=0;t[4]>t[0]&&(u=1),t[8]>t[3*u+u]&&(u=2);var h=(u+1)%3,p=(u+2)%3;r=Math.sqrt(t[3*u+u]-t[3*h+h]-t[3*p+p]+1),i[u]=.5*r,i[3]=(t[3*h+p]-t[3*p+h])*(r=.5/r),i[h]=(t[3*h+u]+t[3*u+h])*r,i[p]=(t[3*p+u]+t[3*u+p])*r}return i}Gn.clone=zl.clone,Gn.fromValues=zl.fromValues,Gn.copy=zl.copy,Gn.set=zl.set,Gn.add=zl.add,Gn.mul=xz;var Ez=zl.scale;Gn.scale=Ez;var Mz=zl.dot;Gn.dot=Mz,Gn.lerp=zl.lerp;var Tz=zl.length;Gn.length=Tz,Gn.len=Tz;var Cz=zl.squaredLength;Gn.squaredLength=Cz,Gn.sqrLen=Cz;var UC=zl.normalize;Gn.normalize=UC,Gn.exactEquals=zl.exactEquals,Gn.equals=zl.equals;var Vc,Pz,Iz,OQ=(Vc=Zd.create(),Pz=Zd.fromValues(1,0,0),Iz=Zd.fromValues(0,1,0),function(i,t,r){var l=Zd.dot(t,r);return l<-.999999?(Zd.cross(Vc,Pz,t),Zd.len(Vc)<1e-6&&Zd.cross(Vc,Iz,t),Zd.normalize(Vc,Vc),bz(i,Vc,Math.PI),i):l>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Zd.cross(Vc,t,r),i[0]=Vc[0],i[1]=Vc[1],i[2]=Vc[2],i[3]=1+l,UC(i,i))});Gn.rotationTo=OQ;var WC,VC,zQ=(WC=BC(),VC=BC(),function(i,t,r,l,u,h){return b2(WC,t,u,h),b2(VC,r,l,h),b2(i,WC,VC,2*h*(1-h)),i});Gn.sqlerp=zQ;var Gc,FQ=(Gc=DQ.create(),function(i,t,r,l){return Gc[0]=r[0],Gc[3]=r[1],Gc[6]=r[2],Gc[1]=l[0],Gc[4]=l[1],Gc[7]=l[2],Gc[2]=-t[0],Gc[5]=-t[1],Gc[8]=-t[2],UC(i,Az(i,Gc))});Gn.setAxes=FQ;var va={};function GC(i){return GC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},GC(i)}Object.defineProperty(va,"__esModule",{value:!0}),va.create=function(){var i=new Os.ARRAY_TYPE(8);return Os.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[4]=0,i[5]=0,i[6]=0,i[7]=0),i[3]=1,i},va.clone=function(i){var t=new Os.ARRAY_TYPE(8);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t},va.fromValues=function(i,t,r,l,u,h,p,g){var v=new Os.ARRAY_TYPE(8);return v[0]=i,v[1]=t,v[2]=r,v[3]=l,v[4]=u,v[5]=h,v[6]=p,v[7]=g,v},va.fromRotationTranslationValues=function(i,t,r,l,u,h,p){var g=new Os.ARRAY_TYPE(8);g[0]=i,g[1]=t,g[2]=r,g[3]=l;var v=.5*u,b=.5*h,w=.5*p;return g[4]=v*l+b*r-w*t,g[5]=b*l+w*i-v*r,g[6]=w*l+v*t-b*i,g[7]=-v*i-b*t-w*r,g},va.fromRotationTranslation=kz,va.fromTranslation=function(i,t){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=.5*t[0],i[5]=.5*t[1],i[6]=.5*t[2],i[7]=0,i},va.fromRotation=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},va.fromMat4=function(i,t){var r=Kd.create();Lz.getRotation(r,t);var l=new Os.ARRAY_TYPE(3);return Lz.getTranslation(l,t),kz(i,r,l),i},va.copy=Dz,va.identity=function(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i[6]=0,i[7]=0,i},va.set=function(i,t,r,l,u,h,p,g,v){return i[0]=t,i[1]=r,i[2]=l,i[3]=u,i[4]=h,i[5]=p,i[6]=g,i[7]=v,i},va.getDual=function(i,t){return i[0]=t[4],i[1]=t[5],i[2]=t[6],i[3]=t[7],i},va.setDual=function(i,t){return i[4]=t[0],i[5]=t[1],i[6]=t[2],i[7]=t[3],i},va.getTranslation=function(i,t){var r=t[4],l=t[5],u=t[6],h=t[7],p=-t[0],g=-t[1],v=-t[2],b=t[3];return i[0]=2*(r*b+h*p+l*v-u*g),i[1]=2*(l*b+h*g+u*p-r*v),i[2]=2*(u*b+h*v+r*g-l*p),i},va.translate=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=.5*r[0],v=.5*r[1],b=.5*r[2],w=t[4],A=t[5],C=t[6],P=t[7];return i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=p*g+u*b-h*v+w,i[5]=p*v+h*g-l*b+A,i[6]=p*b+l*v-u*g+C,i[7]=-l*g-u*v-h*b+P,i},va.rotateX=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*p+w*l+v*h-b*u,C=v*p+w*u+b*l-g*h,P=b*p+w*h+g*u-v*l,R=w*p-g*l-v*u-b*h;return Kd.rotateX(i,t,r),i[4]=A*(p=i[3])+R*(l=i[0])+C*(h=i[2])-P*(u=i[1]),i[5]=C*p+R*u+P*l-A*h,i[6]=P*p+R*h+A*u-C*l,i[7]=R*p-A*l-C*u-P*h,i},va.rotateY=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*p+w*l+v*h-b*u,C=v*p+w*u+b*l-g*h,P=b*p+w*h+g*u-v*l,R=w*p-g*l-v*u-b*h;return Kd.rotateY(i,t,r),i[4]=A*(p=i[3])+R*(l=i[0])+C*(h=i[2])-P*(u=i[1]),i[5]=C*p+R*u+P*l-A*h,i[6]=P*p+R*h+A*u-C*l,i[7]=R*p-A*l-C*u-P*h,i},va.rotateZ=function(i,t,r){var l=-t[0],u=-t[1],h=-t[2],p=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*p+w*l+v*h-b*u,C=v*p+w*u+b*l-g*h,P=b*p+w*h+g*u-v*l,R=w*p-g*l-v*u-b*h;return Kd.rotateZ(i,t,r),i[4]=A*(p=i[3])+R*(l=i[0])+C*(h=i[2])-P*(u=i[1]),i[5]=C*p+R*u+P*l-A*h,i[6]=P*p+R*h+A*u-C*l,i[7]=R*p-A*l-C*u-P*h,i},va.rotateByQuatAppend=function(i,t,r){var l=r[0],u=r[1],h=r[2],p=r[3],g=t[0],v=t[1],b=t[2],w=t[3];return i[0]=g*p+w*l+v*h-b*u,i[1]=v*p+w*u+b*l-g*h,i[2]=b*p+w*h+g*u-v*l,i[3]=w*p-g*l-v*u-b*h,i[4]=(g=t[4])*p+(w=t[7])*l+(v=t[5])*h-(b=t[6])*u,i[5]=v*p+w*u+b*l-g*h,i[6]=b*p+w*h+g*u-v*l,i[7]=w*p-g*l-v*u-b*h,i},va.rotateByQuatPrepend=function(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return i[0]=l*w+p*g+u*b-h*v,i[1]=u*w+p*v+h*g-l*b,i[2]=h*w+p*b+l*v-u*g,i[3]=p*w-l*g-u*v-h*b,i[4]=l*(w=r[7])+p*(g=r[4])+u*(b=r[6])-h*(v=r[5]),i[5]=u*w+p*v+h*g-l*b,i[6]=h*w+p*b+l*v-u*g,i[7]=p*w-l*g-u*v-h*b,i},va.rotateAroundAxis=function(i,t,r,l){if(Math.abs(l)<Os.EPSILON)return Dz(i,t);var u=Math.hypot(r[0],r[1],r[2]);l*=.5;var h=Math.sin(l),p=h*r[0]/u,g=h*r[1]/u,v=h*r[2]/u,b=Math.cos(l),w=t[0],A=t[1],C=t[2],P=t[3];i[0]=w*b+P*p+A*v-C*g,i[1]=A*b+P*g+C*p-w*v,i[2]=C*b+P*v+w*g-A*p,i[3]=P*b-w*p-A*g-C*v;var R=t[4],z=t[5],U=t[6],W=t[7];return i[4]=R*b+W*p+z*v-U*g,i[5]=z*b+W*g+U*p-R*v,i[6]=U*b+W*v+R*g-z*p,i[7]=W*b-R*p-z*g-U*v,i},va.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i[3]=t[3]+r[3],i[4]=t[4]+r[4],i[5]=t[5]+r[5],i[6]=t[6]+r[6],i[7]=t[7]+r[7],i},va.multiply=Oz,va.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i[4]=t[4]*r,i[5]=t[5]*r,i[6]=t[6]*r,i[7]=t[7]*r,i},va.lerp=function(i,t,r,l){var u=1-l;return zz(t,r)<0&&(l=-l),i[0]=t[0]*u+r[0]*l,i[1]=t[1]*u+r[1]*l,i[2]=t[2]*u+r[2]*l,i[3]=t[3]*u+r[3]*l,i[4]=t[4]*u+r[4]*l,i[5]=t[5]*u+r[5]*l,i[6]=t[6]*u+r[6]*l,i[7]=t[7]*u+r[7]*l,i},va.invert=function(i,t){var r=x2(t);return i[0]=-t[0]/r,i[1]=-t[1]/r,i[2]=-t[2]/r,i[3]=t[3]/r,i[4]=-t[4]/r,i[5]=-t[5]/r,i[6]=-t[6]/r,i[7]=t[7]/r,i},va.conjugate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i[2]=-t[2],i[3]=t[3],i[4]=-t[4],i[5]=-t[5],i[6]=-t[6],i[7]=t[7],i},va.normalize=function(i,t){var r=x2(t);if(r>0){r=Math.sqrt(r);var l=t[0]/r,u=t[1]/r,h=t[2]/r,p=t[3]/r,g=t[4],v=t[5],b=t[6],w=t[7],A=l*g+u*v+h*b+p*w;i[0]=l,i[1]=u,i[2]=h,i[3]=p,i[4]=(g-l*A)/r,i[5]=(v-u*A)/r,i[6]=(b-h*A)/r,i[7]=(w-p*A)/r}return i},va.str=function(i){return"quat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+")"},va.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]},va.equals=function(i,t){var r=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],v=i[6],b=i[7],w=t[0],A=t[1],C=t[2],P=t[3],R=t[4],z=t[5],U=t[6],W=t[7];return Math.abs(r-w)<=Os.EPSILON*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(l-A)<=Os.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(u-C)<=Os.EPSILON*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-P)<=Os.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(p-R)<=Os.EPSILON*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(g-z)<=Os.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(v-U)<=Os.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(b-W)<=Os.EPSILON*Math.max(1,Math.abs(b),Math.abs(W))},va.sqrLen=va.squaredLength=va.len=va.length=va.dot=va.mul=va.setReal=va.getReal=void 0;var Os=HC(ao),Kd=HC(Gn),Lz=HC(Kn);function Rz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(Rz=function(l){return l?r:t})(i)}function HC(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||GC(i)!=="object"&&typeof i!="function")return{default:i};var r=Rz(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}function kz(i,t,r){var l=.5*r[0],u=.5*r[1],h=.5*r[2],p=t[0],g=t[1],v=t[2],b=t[3];return i[0]=p,i[1]=g,i[2]=v,i[3]=b,i[4]=l*b+u*v-h*g,i[5]=u*b+h*p-l*v,i[6]=h*b+l*g-u*p,i[7]=-l*p-u*g-h*v,i}function Dz(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i}function Oz(i,t,r){var l=t[0],u=t[1],h=t[2],p=t[3],g=r[4],v=r[5],b=r[6],w=r[7],A=t[4],C=t[5],P=t[6],R=t[7],z=r[0],U=r[1],W=r[2],j=r[3];return i[0]=l*j+p*z+u*W-h*U,i[1]=u*j+p*U+h*z-l*W,i[2]=h*j+p*W+l*U-u*z,i[3]=p*j-l*z-u*U-h*W,i[4]=l*w+p*g+u*b-h*v+A*j+R*z+C*W-P*U,i[5]=u*w+p*v+h*g-l*b+C*j+R*U+P*z-A*W,i[6]=h*w+p*b+l*v-u*g+P*j+R*W+A*U-C*z,i[7]=p*w-l*g-u*v-h*b+R*j-A*z-C*U-P*W,i}va.getReal=Kd.copy,va.setReal=Kd.copy,va.mul=Oz;var zz=Kd.dot;va.dot=zz;var Fz=Kd.length;va.length=Fz,va.len=Fz;var x2=Kd.squaredLength;va.squaredLength=x2,va.sqrLen=x2;var aa={};function jC(i){return jC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jC(i)}Object.defineProperty(aa,"__esModule",{value:!0}),aa.create=Bz,aa.clone=function(i){var t=new ym.ARRAY_TYPE(2);return t[0]=i[0],t[1]=i[1],t},aa.fromValues=function(i,t){var r=new ym.ARRAY_TYPE(2);return r[0]=i,r[1]=t,r},aa.copy=function(i,t){return i[0]=t[0],i[1]=t[1],i},aa.set=function(i,t,r){return i[0]=t,i[1]=r,i},aa.add=function(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i},aa.subtract=Uz,aa.multiply=Wz,aa.divide=Vz,aa.ceil=function(i,t){return i[0]=Math.ceil(t[0]),i[1]=Math.ceil(t[1]),i},aa.floor=function(i,t){return i[0]=Math.floor(t[0]),i[1]=Math.floor(t[1]),i},aa.min=function(i,t,r){return i[0]=Math.min(t[0],r[0]),i[1]=Math.min(t[1],r[1]),i},aa.max=function(i,t,r){return i[0]=Math.max(t[0],r[0]),i[1]=Math.max(t[1],r[1]),i},aa.round=function(i,t){return i[0]=Math.round(t[0]),i[1]=Math.round(t[1]),i},aa.scale=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i},aa.scaleAndAdd=function(i,t,r,l){return i[0]=t[0]+r[0]*l,i[1]=t[1]+r[1]*l,i},aa.distance=Gz,aa.squaredDistance=Hz,aa.length=jz,aa.squaredLength=$z,aa.negate=function(i,t){return i[0]=-t[0],i[1]=-t[1],i},aa.inverse=function(i,t){return i[0]=1/t[0],i[1]=1/t[1],i},aa.normalize=function(i,t){var r=t[0],l=t[1],u=r*r+l*l;return u>0&&(u=1/Math.sqrt(u)),i[0]=t[0]*u,i[1]=t[1]*u,i},aa.dot=function(i,t){return i[0]*t[0]+i[1]*t[1]},aa.cross=function(i,t,r){var l=t[0]*r[1]-t[1]*r[0];return i[0]=i[1]=0,i[2]=l,i},aa.lerp=function(i,t,r,l){var u=t[0],h=t[1];return i[0]=u+l*(r[0]-u),i[1]=h+l*(r[1]-h),i},aa.random=function(i,t){t=t||1;var r=2*ym.RANDOM()*Math.PI;return i[0]=Math.cos(r)*t,i[1]=Math.sin(r)*t,i},aa.transformMat2=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[2]*u,i[1]=r[1]*l+r[3]*u,i},aa.transformMat2d=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[2]*u+r[4],i[1]=r[1]*l+r[3]*u+r[5],i},aa.transformMat3=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[3]*u+r[6],i[1]=r[1]*l+r[4]*u+r[7],i},aa.transformMat4=function(i,t,r){var l=t[0],u=t[1];return i[0]=r[0]*l+r[4]*u+r[12],i[1]=r[1]*l+r[5]*u+r[13],i},aa.rotate=function(i,t,r,l){var u=t[0]-r[0],h=t[1]-r[1],p=Math.sin(l),g=Math.cos(l);return i[0]=u*g-h*p+r[0],i[1]=u*p+h*g+r[1],i},aa.angle=function(i,t){var r=i[0],l=i[1],u=t[0],h=t[1],p=Math.sqrt(r*r+l*l)*Math.sqrt(u*u+h*h);return Math.acos(Math.min(Math.max(p&&(r*u+l*h)/p,-1),1))},aa.zero=function(i){return i[0]=0,i[1]=0,i},aa.str=function(i){return"vec2("+i[0]+", "+i[1]+")"},aa.exactEquals=function(i,t){return i[0]===t[0]&&i[1]===t[1]},aa.equals=function(i,t){var r=i[0],l=i[1],u=t[0],h=t[1];return Math.abs(r-u)<=ym.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(l-h)<=ym.EPSILON*Math.max(1,Math.abs(l),Math.abs(h))},aa.forEach=aa.sqrLen=aa.sqrDist=aa.dist=aa.div=aa.mul=aa.sub=aa.len=void 0;var ym=function(i,t){if(i&&i.__esModule)return i;if(i===null||jC(i)!=="object"&&typeof i!="function")return{default:i};var r=Nz(void 0);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}(ao);function Nz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(Nz=function(l){return l?r:t})(i)}function Bz(){var i=new ym.ARRAY_TYPE(2);return ym.ARRAY_TYPE!=Float32Array&&(i[0]=0,i[1]=0),i}function Uz(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i}function Wz(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i}function Vz(i,t,r){return i[0]=t[0]/r[0],i[1]=t[1]/r[1],i}function Gz(i,t){return Math.hypot(t[0]-i[0],t[1]-i[1])}function Hz(i,t){var r=t[0]-i[0],l=t[1]-i[1];return r*r+l*l}function jz(i){return Math.hypot(i[0],i[1])}function $z(i){var t=i[0],r=i[1];return t*t+r*r}aa.len=jz,aa.sub=Uz,aa.mul=Wz,aa.div=Vz,aa.dist=Gz,aa.sqrDist=Hz,aa.sqrLen=$z;var NQ=function(){var i=Bz();return function(t,r,l,u,h,p){var g,v;for(r||(r=2),l||(l=0),v=u?Math.min(u*r+l,t.length):t.length,g=l;g<v;g+=r)i[0]=t[g],i[1]=t[g+1],h(i,i,p),t[g]=i[0],t[g+1]=i[1];return t}}();function $C(i){return $C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$C(i)}aa.forEach=NQ,Object.defineProperty(no,"__esModule",{value:!0});var Ga=no.vec4=ke=no.vec3=no.vec2=no.quat2=To=no.quat=at=no.mat4=zs=no.mat3=no.mat2d=Ky=no.mat2=no.glMatrix=void 0,BQ=Wu(ao);no.glMatrix=BQ;var UQ=Wu(Pi),Ky=no.mat2=UQ,WQ=Wu(Di);no.mat2d=WQ;var VQ=Wu(qa),zs=no.mat3=VQ,GQ=Wu(Kn),at=no.mat4=GQ,HQ=Wu(Gn),To=no.quat=HQ,jQ=Wu(va);no.quat2=jQ;var $Q=Wu(aa);no.vec2=$Q;var qQ=Wu(Yn),ke=no.vec3=qQ,XQ=Wu(da);function qz(i){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(qz=function(l){return l?r:t})(i)}function Wu(i,t){if(!t&&i&&i.__esModule)return i;if(i===null||$C(i)!=="object"&&typeof i!="function")return{default:i};var r=qz(t);if(r&&r.has(i))return r.get(i);var l={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in i)if(h!=="default"&&Object.prototype.hasOwnProperty.call(i,h)){var p=u?Object.getOwnPropertyDescriptor(i,h):null;p&&(p.get||p.set)?Object.defineProperty(l,h,p):l[h]=i[h]}return l.default=i,r&&r.set(i,l),l}Ga=no.vec4=XQ;const YQ=N([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:w2}=YQ,Xz=N([{name:"a_pos_3",components:3,type:"Int16"}]);var mf=N([{name:"a_pos",type:"Int16",components:2}]),Yz={};(function(i,t){(function(r){function l(h,p,g){var v=u(256*h,256*(p=Math.pow(2,g)-p-1),g),b=u(256*(h+1),256*(p+1),g);return v[0]+","+v[1]+","+b[0]+","+b[1]}function u(h,p,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[h*v-2*Math.PI*6378137/2,p*v-2*Math.PI*6378137/2]}r.getURL=function(h,p,g,v,b,w){return w=w||{},h+"?"+["bbox="+l(g,v,b),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+p].join("&")},r.getTileBBox=l,r.getMercCoords=u,Object.defineProperty(r,"__esModule",{value:!0})})(t)})(0,Yz);var ZQ=Yz;class Vu{constructor(t,r,l){this.z=t,this.x=r,this.y=l,this.key=e1(0,t,t,r,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r){const l=ZQ.getTileBBox(this.x,this.y,this.z),u=function(h,p,g){let v,b="";for(let w=h;w>0;w--)v=1<<w-1,b+=(p&v?1:0)+(g&v?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",l)}toString(){return`${this.z}/${this.x}/${this.y}`}}class qC{constructor(t,r){this.wrap=t,this.canonical=r,this.key=e1(t,r.z,r.z,r.x,r.y)}}class Ca{constructor(t,r,l,u,h){this.overscaledZ=t,this.wrap=r,this.canonical=new Vu(l,+u,+h),this.key=r===0&&t===l?this.canonical.key:e1(r,t,l,u,h)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const r=this.canonical.z-t;return t>this.canonical.z?new Ca(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ca(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r=!0){if(this.overscaledZ===t&&r)return this.key;if(t>this.canonical.z)return e1(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y);{const l=this.canonical.z-t;return e1(this.wrap*+r,t,t,this.canonical.x>>l,this.canonical.y>>l)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Ca(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,l=2*this.canonical.x,u=2*this.canonical.y;return[new Ca(r,this.wrap,r,l,u),new Ca(r,this.wrap,r,l+1,u),new Ca(r,this.wrap,r,l,u+1),new Ca(r,this.wrap,r,l+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ca(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ca(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new qC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function e1(i,t,r,l,u){const h=1<<Math.min(r,22);let p=h*(u%h)+l%h;return i&&r<22&&(p+=h*h*((i<0?-2*i-1:2*i)%(1<<2*(22-r)))),16*(32*p+r)+(t-r)}const Zz=[i=>{let t=i.canonical.x-1,r=i.wrap;return t<0&&(t=(1<<i.canonical.z)-1,r--),new Ca(i.overscaledZ,r,i.canonical.z,t,i.canonical.y)},i=>{let t=i.canonical.x+1,r=i.wrap;return t===1<<i.canonical.z&&(t=0,r++),new Ca(i.overscaledZ,r,i.canonical.z,t,i.canonical.y)},i=>new Ca(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,(i.canonical.y===0?1<<i.canonical.z:i.canonical.y)-1),i=>new Ca(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y===(1<<i.canonical.z)-1?0:i.canonical.y+1)];un(Vu,"CanonicalTileID"),un(Ca,"OverscaledTileID",{omit:["projMatrix"]});class S2{constructor(t,r){this.pos=t,this.dir=r}intersectsPlane(t,r,l){const u=ke.dot(r,this.dir);if(Math.abs(u)<1e-6)return!1;const h=((t[0]-this.pos[0])*r[0]+(t[1]-this.pos[1])*r[1]+(t[2]-this.pos[2])*r[2])/u;return l[0]=this.pos[0]+this.dir[0]*h,l[1]=this.pos[1]+this.dir[1]*h,l[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,r,l){if(ke.equals(this.pos,t)||r===0)return l[0]=l[1]=l[2]=0,!1;const[u,h,p]=this.dir,g=this.pos[0]-t[0],v=this.pos[1]-t[1],b=this.pos[2]-t[2],w=u*u+h*h+p*p,A=2*(g*u+v*h+b*p),C=A*A-4*w*(g*g+v*v+b*b-r*r);if(C<0){const P=Math.max(-A/2,0),R=g+u*P,z=v+h*P,U=b+p*P,W=Math.hypot(R,z,U);return l[0]=R*r/W,l[1]=z*r/W,l[2]=U*r/W,!1}{const P=(-A-Math.sqrt(C))/(2*w);if(P<0){const R=Math.hypot(g,v,b);return l[0]=g*r/R,l[1]=v*r/R,l[2]=b*r/R,!1}return l[0]=g+u*P,l[1]=v+h*P,l[2]=b+p*P,!0}}}class XC{constructor(t,r,l,u,h){this.TL=t,this.TR=r,this.BR=l,this.BL=u,this.horizon=h}static fromInvProjectionMatrix(t,r,l){const u=[-1,1,1],h=[1,1,1],p=[1,-1,1],g=[-1,-1,1],v=ke.transformMat4(u,u,t),b=ke.transformMat4(h,h,t),w=ke.transformMat4(p,p,t),A=ke.transformMat4(g,g,t);return new XC(v,b,w,A,r/l)}}function t1(i,t,r){let l=1/0,u=-1/0;const h=[];for(const p of i){ke.sub(h,p,t);const g=ke.dot(h,r);l=Math.min(l,g),u=Math.max(u,g)}return[l,u]}function Kz(i,t){let r=!0;for(let l=0;l<i.planes.length;l++){const u=i.planes[l];let h=0;for(let p=0;p<t.length;p++)h+=ke.dot(u,t[p])+u[3]>=0;if(h===0)return 0;h!==t.length&&(r=!1)}return r?2:1}function Jz(i,t){for(const r of i.projections){const l=t1(t,i.points[0],r.axis);if(r.projection[1]<l[0]||r.projection[0]>l[1])return 0}return 1}function Qz(i,t){let r=0;const l=[0,0,0,0];for(let u=0;u<i.length;u++)l[0]=i[u][0],l[1]=i[u][1],l[2]=i[u][2],l[3]=1,Ga.dot(l,t)>=0&&r++;return r}class Jd{constructor(t,r){this.points=t||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=hi.fromPoints(this.points),this.projections=[],this.frustumEdges=[ke.sub([],this.points[2],this.points[3]),ke.sub([],this.points[0],this.points[3]),ke.sub([],this.points[4],this.points[0]),ke.sub([],this.points[5],this.points[1]),ke.sub([],this.points[6],this.points[2]),ke.sub([],this.points[7],this.points[3])];for(const l of this.frustumEdges){const u=[0,-l[2],l[1]],h=[l[2],0,-l[0]];this.projections.push({axis:u,projection:t1(this.points,this.points[0],u)}),this.projections.push({axis:h,projection:t1(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(t,r,l,u){const h=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const w=Ga.transformMat4([],b,t),A=1/w[3]/r*h;return Ga.mul(w,w,[A,A,u?1/w[3]:A,A])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const w=ke.sub([],p[b[0]],p[b[1]]),A=ke.sub([],p[b[2]],p[b[1]]),C=ke.normalize([],ke.cross([],w,A)),P=-ke.dot(C,p[b[1]]);return C.concat(P)}),v=[];for(let b=0;b<p.length;b++)v.push([p[b][0],p[b][1],p[b][2]]);return new Jd(v,g)}intersectsPrecise(t,r,l){for(let u=0;u<r.length;u++)if(!Qz(t,r[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!Qz(t,this.planes[u]))return 0;for(const u of l)for(const h of this.frustumEdges){const p=ke.cross([],u,h),g=ke.length(p);if(g===0)continue;ke.scale(p,p,1/g);const v=t1(this.points,this.points[0],p),b=t1(t,this.points[0],p);if(v[0]>b[1]||b[0]>v[1])return 0}return 1}}class hi{static fromPoints(t){const r=[1/0,1/0,1/0],l=[-1/0,-1/0,-1/0];for(const u of t)ke.min(r,r,u),ke.max(l,l,u);return new hi(r,l)}static fromTileIdAndHeight(t,r,l){const u=1<<t.canonical.z,h=t.canonical.x,p=t.canonical.y;return new hi([h/u,p/u,r],[(h+1)/u,(p+1)/u,l])}static applyTransform(t,r){const l=t.getCorners();for(let u=0;u<l.length;++u)ke.transformMat4(l[u],l[u],r);return hi.fromPoints(l)}static projectAabbCorners(t,r){const l=t.getCorners();for(let u=0;u<l.length;++u)ke.transformMat4(l[u],l[u],r);return l}constructor(t,r){this.min=t,this.max=r,this.center=ke.scale([],ke.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],l=ke.clone(this.min),u=ke.clone(this.max);for(let h=0;h<r.length;h++)l[h]=r[h]?this.min[h]:this.center[h],u[h]=r[h]?this.center[h]:this.max[h];return u[2]=this.max[2],new hi(l,u)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,r=this.max;return[[t[0],t[1],t[2]],[r[0],t[1],t[2]],[r[0],r[1],t[2]],[t[0],r[1],t[2]],[t[0],t[1],r[2]],[r[0],t[1],r[2]],[r[0],r[1],r[2]],[t[0],r[1],r[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Kz(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Kz(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,r){return r||this.intersects(t)?Jz(t,this.getCorners()):0}intersectsPreciseFlat(t,r){return r||this.intersectsFlat(t)?Jz(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let r=0;r<3;++r)if(this.min[r]>t.max[r]||t.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t.min[r]),this.max[r]=Math.max(this.max[r],t.max[r])}encapsulatePoint(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t[r]),this.max[r]=Math.max(this.max[r],t[r])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}un(hi,"Aabb");const n1=5,gf=6,hs=ht/Math.PI/2,KQ=16383,Jy=64,YC=[Jy,32,16],hc=-hs,fc=hs,JQ=[new hi([hc,hc,hc],[fc,fc,fc]),new hi([hc,hc,hc],[0,0,fc]),new hi([0,hc,hc],[fc,0,fc]),new hi([hc,0,hc],[0,fc,fc]),new hi([0,0,hc],[fc,fc,fc])];function A2(i){return i*hs/ev}function eF(i,t,r,l=!0){const u=ke.scale([],i._camera.position,i.worldSize),h=[t,r,1,1];Ga.transformMat4(h,h,i.pixelMatrixInverse),Ga.scale(h,h,1/h[3]);const p=ke.sub([],h,u),g=ke.normalize([],p),v=i.globeMatrix,b=[v[12],v[13],v[14]],w=ke.sub([],b,u),A=ke.length(w),C=ke.normalize([],w),P=i.worldSize/(2*Math.PI),R=ke.dot(C,g),z=Math.asin(P/A);if(z<Math.acos(R)){if(!l)return null;const Te=[],we=[];ke.scale(Te,g,A/R),ke.normalize(we,ke.sub(we,Te,w)),ke.normalize(g,ke.add(g,w,ke.scale(g,we,Math.tan(z)*A)))}const U=[];new S2(u,g).closestPointOnSphere(b,P,U);const W=ke.normalize([],Et(v,0)),j=ke.normalize([],Et(v,1)),Y=ke.normalize([],Et(v,2)),Z=ke.dot(W,U),$=ke.dot(j,U),K=ke.dot(Y,U),ie=fe(Math.asin(-$/P));let ce=fe(Math.atan2(Z,K));ce=i.center.lng+function(Te,we){const Ie=(we-Te+180)%360-180;return Ie<-180?Ie+360:Ie}(i.center.lng,ce);const he=_o(ce),ye=ae(Co(ie),0,1);return new ga(he,ye)}class QQ{constructor(t,r,l){this.a=ke.sub([],t,l),this.b=ke.sub([],r,l),this.center=l;const u=ke.normalize([],this.a),h=ke.normalize([],this.b);this.angle=Math.acos(ke.dot(u,h))}}function ZC(i,t){if(i.angle===0)return null;let r;return r=i.a[t]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[t]/i.a[t]/Math.sin(i.angle)-1/Math.tan(i.angle)),r<0||r>1?null:function(l,u,h,p){const g=Math.sin(h);return l*(Math.sin((1-p)*h)/g)+u*(Math.sin(p*h)/g)}(i.a[t],i.b[t],i.angle,ae(r,0,1))+i.center[t]}function pc(i){if(i.z<=1)return JQ[i.z+2*i.y+i.x];const t=JC(E2(i));return hi.fromPoints(t)}function Qd(i,t,r){return ke.scale(i,i,1-r),ke.scaleAndAdd(i,i,t,r)}function tF(i,t){const r=vo(t.zoom);if(r===0)return pc(i);const l=E2(i),u=JC(l),h=_o(l.getWest())*t.worldSize,p=_o(l.getEast())*t.worldSize,g=Co(l.getNorth())*t.worldSize,v=Co(l.getSouth())*t.worldSize,b=[h,g,0],w=[p,g,0],A=[h,v,0],C=[p,v,0],P=at.invert([],t.globeMatrix);return ke.transformMat4(b,b,P),ke.transformMat4(w,w,P),ke.transformMat4(A,A,P),ke.transformMat4(C,C,P),u[0]=Qd(u[0],A,r),u[1]=Qd(u[1],C,r),u[2]=Qd(u[2],w,r),u[3]=Qd(u[3],b,r),hi.fromPoints(u)}function nF(i,t,r){for(const l of i)ke.transformMat4(l,l,t),ke.scale(l,l,r)}function KC(i,t,r,l){const u=t/i.worldSize,h=i.globeMatrix;if(r.z<=1){const he=pc(r).getCorners();return nF(he,h,u),hi.fromPoints(he)}const p=E2(r,l),g=JC(p);nF(g,h,u);const v=Number.MAX_VALUE,b=[-v,-v,-v],w=[v,v,v];if(p.contains(i.center)){for(const Te of g)ke.min(w,w,Te),ke.max(b,b,Te);b[2]=0;const he=i.point,ye=[he.x*u,he.y*u,0];return ke.min(w,w,ye),ke.max(b,b,ye),new hi(w,b)}const A=[h[12]*u,h[13]*u,h[14]*u],C=p.getCenter(),P=ae(i.center.lat,-$i,$i),R=ae(C.lat,-$i,$i),z=_o(i.center.lng),U=Co(P);let W=z-_o(C.lng);const j=U-Co(R);W>.5?W-=1:W<-.5&&(W+=1);let Y=0;if(Math.abs(W)>Math.abs(j))Y=W>=0?1:3;else{Y=j>=0?0:2;const he=[h[4]*u,h[5]*u,h[6]*u],ye=-Math.sin(be(j>=0?p.getSouth():p.getNorth()))*hs;ke.scaleAndAdd(A,A,he,ye)}const Z=g[Y],$=g[(Y+1)%4],K=new QQ(Z,$,A),ie=[ZC(K,0)||Z[0],ZC(K,1)||Z[1],ZC(K,2)||Z[2]],ce=vo(i.zoom);if(ce>0){const he=function({x:Te,y:we,z:Ie},xe,We,qe,et){const Ne=1/(1<<Ie);let Ve=Te*Ne,it=Ve+Ne,gt=we*Ne,ct=gt+Ne,Pt=0;const Ft=(Ve+it)/2-qe;return Ft>.5?Pt=-1:Ft<-.5&&(Pt=1),Ve=((Ve+Pt)*xe-(qe*=xe))*We+qe,it=((it+Pt)*xe-qe)*We+qe,gt=(gt*xe-(et*=xe))*We+et,ct=(ct*xe-et)*We+et,[[Ve,ct,0],[it,ct,0],[it,gt,0],[Ve,gt,0]]}(r,t,i._pixelsPerMercatorPixel,z,U);for(let Te=0;Te<g.length;Te++)Qd(g[Te],he[Te],ce);const ye=ke.add([],he[Y],he[(Y+1)%4]);ke.scale(ye,ye,.5),Qd(ie,ye,ce)}for(const he of g)ke.min(w,w,he),ke.max(b,b,he);return w[2]=Math.min(Z[2],$[2]),ke.min(w,w,ie),ke.max(b,b,ie),new hi(w,b)}function E2({x:i,y:t,z:r},l=!1){const u=1/(1<<r),h=new On(ol(i*u),t===(1<<r)-1&&l?-90:gr((t+1)*u)),p=new On(ol((i+1)*u),t===0&&l?90:gr(t*u));return new Dl(h,p)}function JC(i){const t=be(i.getNorth()),r=be(i.getSouth()),l=Math.cos(t),u=Math.cos(r),h=Math.sin(t),p=Math.sin(r),g=i.getWest(),v=i.getEast();return[Qy(u,p,g),Qy(u,p,v),Qy(l,h,v),Qy(l,h,g)]}function Qy(i,t,r,l=hs){return r=be(r),[i*Math.sin(r)*l,-t*l,i*Math.cos(r)*l]}function Fs(i,t,r){return Qy(Math.cos(be(i)),Math.sin(be(i)),t,r)}function a1(i,t,r,l){const u=1<<r.z,h=(i/ht+r.x)/u;return Fs(gr((t/ht+r.y)/u),ol(h),l)}function M2({min:i,max:t}){return KQ/Math.max(t[0]-i[0],t[1]-i[1],t[2]-i[2])}const aF=new Float64Array(16);function vm(i){const t=M2(i),r=at.fromScaling(aF,[t,t,t]);return at.translate(r,r,ke.negate([],i.min))}function QC(i){const t=at.fromTranslation(aF,i.min),r=1/M2(i);return at.scale(t,t,[r,r,r])}function eP(i){const t=ht/(2*Math.PI);return i/(2*Math.PI)/t}function iF(i,t){return ht/(512*Math.pow(2,i))*M2(pc(t))}function rF(i,t,r,l,u){const h=eP(r),p=[i,t,-r/(2*Math.PI)],g=at.identity(new Float64Array(16));return at.translate(g,g,p),at.scale(g,g,[h,h,h]),at.rotateX(g,g,be(-u)),at.rotateY(g,g,be(-l)),g}function vo(i){return Ee(n1,gf,i)}function oF(i,t,r){const l=at.identity(new Float64Array(16)),u=(t/(1<<i)-.5)*Math.PI*2;return at.rotateY(l,r.globeMatrix,u),Float32Array.from(l)}function sF(i,t,r){const l=vo(r.zoom),u=i.style.map._antialias,h=t.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return l===0&&!u&&!h}function eee(i,t,r,l){const u=t.getNorth(),h=t.getSouth(),p=t.getWest(),g=t.getEast(),v=1<<i.z,b=g-p,w=u-h,A=b/Jy,C=-w/YC[r],P=[0,A,0,C,0,0,u,p,0];if(i.z>0){const R=180/l;zs.multiply(P,P,[R/b+1,0,0,0,R/w+1,0,-.5*R/A,.5*R/C,1])}return P[2]=v,P[5]=i.x,P[8]=i.y,P}function tee(i){const t=$i-5;i=ae(i,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(be(i))),3);return Math.round(r*(YC.length-1))}function lF(i){const t=[0,0,0],r=at.identity(new Float64Array(16));return at.multiply(r,i.pixelMatrix,i.globeMatrix),ke.transformMat4(t,t,r),new V(t[0],t[1])}function cF(i,t){const r=Fs(t.lat,t.lng),l=function(h){const p=Fs(h._center.lat,h._center.lng),g=ke.fromValues(0,1,0);let v=ke.cross([],g,p);const b=at.fromRotation([],-h.angle,p);v=ke.transformMat4(v,v,b),at.fromRotation(b,-h._pitch,v);const w=ke.normalize([],p);return ke.scale(w,w,A2(h.cameraToCenterDistance/h.pixelsPerMeter)),ke.transformMat4(w,w,b),ke.add([],p,w)}(i),u=ke.subtract([],l,r);return ke.angle(u,r)}function T2(i,t){return cF(i,t)>Math.PI/2*1.01}const uF=be(85),nee=Math.cos(uF),aee=Math.sin(uF);class iee{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,r){const l=new J,u=new Nn,h=[],p=t+1+2,g=r[0]+1,v=r[0]+1+(1+r.length),b=(w,A,C)=>{let P=w===p-1?w-2:w===0?w:w-1;return P+=C?24575:0,[P,A]};for(let w=0;w<p;++w)l.emplaceBack(...b(w,0,!0));for(let w=0;w<g;++w)for(let A=0;A<p;++A)l.emplaceBack(...b(A,w,(A===0||A===p-1)&&!0));for(let w=0;w<r.length;++w){const A=r[w];for(let C=0;C<p;++C)l.emplaceBack(...b(C,A,!0))}for(let w=0;w<r.length;++w){const A=u.length,C=r[w]+1+2,P=new Nn;for(let U=0;U<C-1;U++){const W=U===C-2,j=W?p*(v-r.length+w-U):p;for(let Y=0;Y<p-1;Y++){const Z=U*p+Y;U===0||W||Y===0||Y===p-2?(P.emplaceBack(Z+1,Z,Z+j),P.emplaceBack(Z+j,Z+j+1,Z+1)):(u.emplaceBack(Z+1,Z,Z+j),u.emplaceBack(Z+j,Z+j+1,Z+1))}}const R=ja.simpleSegment(0,A,l.length,u.length-A);for(let U=0;U<P.uint16.length;U+=3)u.emplaceBack(P.uint16[U],P.uint16[U+1],P.uint16[U+2]);const z=ja.simpleSegment(0,A,l.length,u.length-A);h.push({withoutSkirts:R,withSkirts:z})}return{vertices:l,indices:u,segments:h}}_createGrid(t){const r=this._fillGridMeshWithLods(Jy,YC);this._gridSegments=r.segments,this._gridBuffer=t.createVertexBuffer(r.vertices,mf.members),this._gridIndexBuffer=t.createIndexBuffer(r.indices,!0)}_createPoles(t){const r=new Nn;for(let g=0;g<=Jy;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(r,!0);const l=new Ua,u=new Ua,h=new Ua,p=new Ua;this._poleSegments=[];for(let g=0,v=0;g<n1;g++){const b=360/(1<<g);l.emplaceBack(0,-hs,0,.5,0),u.emplaceBack(0,-hs,0,.5,1),h.emplaceBack(0,-hs,0,.5,.5),p.emplaceBack(0,-hs,0,.5,.5);for(let w=0;w<=Jy;w++){let A=w/Jy,C=0;const P=Ln(0,b,A),[R,z,U]=Qy(nee,aee,P,hs);l.emplaceBack(R,z,U,A,C),u.emplaceBack(R,z,U,A,1-C);const W=be(P);A=.5+.5*Math.sin(W),C=.5+.5*Math.cos(W),h.emplaceBack(R,z,U,A,C),p.emplaceBack(R,z,U,A,1-C)}this._poleSegments.push(ja.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(l,w2,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(u,w2,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(h,w2,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(p,w2,!1)}getGridBuffers(t,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const ev=63710088e-1,tP=2*Math.PI*ev;class yf{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new yf(Ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,l=this.lat*r,u=t.lat*r,h=Math.sin(l)*Math.sin(u)+Math.cos(l)*Math.cos(u)*Math.cos((t.lng-this.lng)*r);return ev*Math.acos(Math.min(h,1))}toBounds(t=0){const r=360*t/40075017,l=r/Math.cos(Math.PI/180*this.lat);return new Dl(new yf(this.lng-l,this.lat-r),new yf(this.lng+l,this.lat+r))}toEcef(t){const r=A2(t);return Fs(this.lat,this.lng,hs+r)}static convert(t){if(t instanceof yf)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new yf(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new yf(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var On=yf;const ree=0,oee=25.5;function C2(i){return tP*Math.cos(i*Math.PI/180)}function _o(i){return(180+i)/360}function Co(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function $a(i,t){return i/C2(t)}function ol(i){return 360*i-180}function gr(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function dF(i,t){return i*C2(gr(t))}const $i=85.051129;function hF(i){return Math.cos(be(ae(i,-$i,$i)))}function vf(i,t){const r=ae(t,ree,oee),l=Math.pow(2,r);return hF(i)*tP/(512*l)}function nP(i){return 1/Math.cos(i*Math.PI/180)}function i1(i,t=0){const r=Math.exp(Math.PI*(1-(i.y+t/ht)/(1<<i.z)*2));return 80150034*r/(r*r+1)/ht/(1<<i.z)}class ga{constructor(t,r,l=0){this.x=+t,this.y=+r,this.z=+l}static fromLngLat(t,r=0){const l=On.convert(t);return new ga(_o(l.lng),Co(l.lat),$a(r,l.lat))}toLngLat(){return new On(ol(this.x),gr(this.y))}toAltitude(){return dF(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/tP*nP(gr(this.y))}}function aP(i,t,r,l,u,h,p,g,v){const b=(t+l)/2,w=(r+u)/2,A=new V(b,w);g(A),function(C,P,R,z,U,W){const j=R-U,Y=z-W;return Math.abs((z-P)*j-(R-C)*Y)/Math.hypot(j,Y)}(A.x,A.y,h.x,h.y,p.x,p.y)>=v?(aP(i,t,r,b,w,h,A,g,v),aP(i,b,w,l,u,A,p,g,v)):i.push(p)}function fF(i,t,r){let l=i[0],u=l.x,h=l.y;t(l);const p=[l];for(let g=1;g<i.length;g++){const v=i[g],{x:b,y:w}=v;t(v),aP(p,u,h,b,w,l,v,t,r),u=b,h=w,l=v}return p}function iP(i,t,r,l){if(l(t,r)){const u=t.add(r)._mult(.5);iP(i,t,u,l),iP(i,u,r,l)}else i.push(r)}function see(i,t){let r=i[0];const l=[r];for(let u=1;u<i.length;u++){const h=i[u];iP(l,r,h,t),r=h}return l}const rP=Math.pow(2,14)-1,pF=-rP-1;function lee(i,t){const r=Math.round(i.x*t),l=Math.round(i.y*t);return i.x=ae(r,pF,rP),i.y=ae(l,pF,rP),(r<i.x||r>i.x+1||l<i.y||l>i.y+1)&&ve("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Gu(i,t,r){const l=i.loadGeometry(),u=i.extent,h=ht/u;if(t&&r&&r.projection.isReprojectedInTileSpace){const p=1<<t.z,{scale:g,x:v,y:b,projection:w}=r,A=C=>{const P=ol((t.x+C.x/u)/p),R=gr((t.y+C.y/u)/p),z=w.project(P,R);C.x=(z.x*g-v)*u,C.y=(z.y*g-b)*u};for(let C=0;C<l.length;C++)if(i.type!==1)l[C]=fF(l[C],A,1);else{const P=[];for(const R of l[C])R.x<0||R.x>=u||R.y<0||R.y>=u||(A(R),P.push(R));l[C]=P}}for(const p of l)for(const g of p)lee(g,h);return l}function _f(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Gu(i):[]}}function P2(i,t,r,l,u){i.emplaceBack(2*t+(l+1)/2,2*r+(u+1)/2)}function I2(i,t,r){i.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class oP{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new J,this.indexArray=new Nn,this.segments=new ja,this.programConfigurations=new ff(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l,u){const h=this.layers[0],p=[];let g=null;h.type==="circle"&&(g=h.layout.get("circle-sort-key"));for(const{feature:b,id:w,index:A,sourceLayerIndex:C}of t){const P=this.layers[0]._featureFilter.needGeometry,R=_f(b,P);if(!this.layers[0]._featureFilter.filter(new ri(this.zoom),R,l))continue;const z=g?g.evaluate(R,{},l):void 0,U={id:w,properties:b.properties,type:b.type,sourceLayerIndex:C,index:A,geometry:P?R.geometry:Gu(b,l,u),patterns:{},sortKey:z};p.push(U)}g&&p.sort((b,w)=>b.sortKey-w.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new Jn,v=u.projection);for(const b of p){const{geometry:w,index:A,sourceLayerIndex:C}=b,P=t[A].feature;this.addFeature(b,w,A,r.availableImages,l,v,r.brightness),r.featureIndex.insert(P,w,A,C,this.index)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yQ.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,vQ.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,r,l,u,h,p,g){for(const v of r)for(const b of v){const w=b.x,A=b.y;if(w<0||w>=ht||A<0||A>=ht)continue;if(p){const R=p.projectTilePoint(w,A,h),z=p.upVector(h,w,A),U=this.globeExtVertexArray;I2(U,R,z),I2(U,R,z),I2(U,R,z),I2(U,R,z)}const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=C.vertexLength;P2(this.layoutVertexArray,w,A,-1,-1),P2(this.layoutVertexArray,w,A,1,-1),P2(this.layoutVertexArray,w,A,1,1),P2(this.layoutVertexArray,w,A,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},u,h,g)}}function mF(i,t){for(let r=0;r<i.length;r++)if(bf(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(bf(i,t[r]))return!0;return!!sP(i,t)}function cee(i,t,r){return!!bf(i,t)||!!lP(t,i,r)}function gF(i,t){if(i.length===1)return vF(t,i[0]);for(let r=0;r<t.length;r++){const l=t[r];for(let u=0;u<l.length;u++)if(bf(i,l[u]))return!0}for(let r=0;r<i.length;r++)if(vF(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(sP(i,t[r]))return!0;return!1}function uee(i,t,r){if(i.length>1){if(sP(i,t))return!0;for(let l=0;l<t.length;l++)if(lP(t[l],i,r))return!0}for(let l=0;l<i.length;l++)if(lP(i[l],t,r))return!0;return!1}function sP(i,t){if(i.length===0||t.length===0)return!1;for(let r=0;r<i.length-1;r++){const l=i[r],u=i[r+1];for(let h=0;h<t.length-1;h++)if(dee(l,u,t[h],t[h+1]))return!0}return!1}function dee(i,t,r,l){return $e(i,r,l)!==$e(t,r,l)&&$e(i,t,r)!==$e(i,t,l)}function lP(i,t,r){const l=r*r;if(t.length===1)return i.distSqr(t[0])<l;for(let u=1;u<t.length;u++)if(yF(i,t[u-1],t[u])<l)return!0;return!1}function yF(i,t,r){const l=t.distSqr(r);if(l===0)return i.distSqr(t);const u=((i.x-t.x)*(r.x-t.x)+(i.y-t.y)*(r.y-t.y))/l;return i.distSqr(u<0?t:u>1?r:r.sub(t)._mult(u)._add(t))}function vF(i,t){let r,l,u,h=!1;for(let p=0;p<i.length;p++){r=i[p];for(let g=0,v=r.length-1;g<r.length;v=g++)l=r[g],u=r[v],l.y>t.y!=u.y>t.y&&t.x<(u.x-l.x)*(t.y-l.y)/(u.y-l.y)+l.x&&(h=!h)}return h}function bf(i,t){let r=!1;for(let l=0,u=i.length-1;l<i.length;u=l++){const h=i[l],p=i[u];h.y>t.y!=p.y>t.y&&t.x<(p.x-h.x)*(t.y-h.y)/(p.y-h.y)+h.x&&(r=!r)}return r}function _F(i,t,r,l,u){for(const p of i)if(t<=p.x&&r<=p.y&&l>=p.x&&u>=p.y)return!0;const h=[new V(t,r),new V(t,u),new V(l,u),new V(l,r)];if(i.length>2){for(const p of h)if(bf(i,p))return!0}for(let p=0;p<i.length-1;p++)if(hee(i[p],i[p+1],h))return!0;return!1}function hee(i,t,r){const l=r[0],u=r[2];if(i.x<l.x&&t.x<l.x||i.x>u.x&&t.x>u.x||i.y<l.y&&t.y<l.y||i.y>u.y&&t.y>u.y)return!1;const h=$e(i,t,r[0]);return h!==$e(i,t,r[1])||h!==$e(i,t,r[2])||h!==$e(i,t,r[3])}function tv(i,t,r,l,u,h){let p=t.y-i.y,g=i.x-t.x;if(h=h||0){const v=p*p+g*g;if(v===0)return!0;const b=Math.sqrt(v);p/=b,g/=b}return!((r.x-i.x)*p+(r.y-i.y)*g-h<0||(l.x-i.x)*p+(l.y-i.y)*g-h<0||(u.x-i.x)*p+(u.y-i.y)*g-h<0)}function cP(i,t,r,l,u,h,p){return!(tv(i,t,l,u,h,p)||tv(t,r,l,u,h,p)||tv(r,i,l,u,h,p)||tv(l,u,i,t,r,p)||tv(u,h,i,t,r,p)||tv(h,l,i,t,r,p))}function nv(i,t,r){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:r.programConfigurations.get(t.id).getMaxValue(i)}function L2(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function bF(i,t,r,l,u){if(!t[0]&&!t[1])return i;const h=V.convert(t)._mult(u);r==="viewport"&&h._rotate(-l);const p=[];for(let g=0;g<i.length;g++)p.push(i[g].sub(h));return p}function xF(i,t,r,l){const u=V.convert(i)._mult(l);return t==="viewport"&&u._rotate(-r),u}un(oP,"CircleBucket",{omit:["layers"]});const fee=new yi({"circle-sort-key":new yn(nt.layout_circle["circle-sort-key"]),visibility:new Xt(nt.layout_circle.visibility)});var pee={paint:new yi({"circle-radius":new yn(nt.paint_circle["circle-radius"]),"circle-color":new yn(nt.paint_circle["circle-color"]),"circle-blur":new yn(nt.paint_circle["circle-blur"]),"circle-opacity":new yn(nt.paint_circle["circle-opacity"]),"circle-translate":new Xt(nt.paint_circle["circle-translate"]),"circle-translate-anchor":new Xt(nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xt(nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xt(nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yn(nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yn(nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yn(nt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Xt(nt.paint_circle["circle-emissive-strength"])}),layout:fee};const mee=at.create(),gee=(i,t,r,l,u,h)=>{const p=i.transform,g=p.projection.name==="globe";let v;if(h.paint.get("circle-pitch-alignment")==="map")if(g){const w=iF(p.zoom,t.canonical)*p._pixelsPerMercatorPixel;v=Float32Array.from([w,0,0,w])}else v=p.calculatePixelsToTileUnitsMatrix(r);else v=new Float32Array([p.pixelsToGLUnits[0],0,0,p.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:i.transform.getCameraToCenterDistance(p.projection),u_matrix:i.translatePosMatrix(t.projMatrix,r,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Cn.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:mee,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=l,b.u_merc_center=u,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=vo(p.zoom);const w=u[0]*ht,A=u[1]*ht;b.u_up_dir=p.projection.upVector(new Vu(0,0,0),w,A)}return b},wF=i=>{const t=[];return i.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),i.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function SF(i,t,r,l,u,h,p,g,v){if(h&&i.queryGeometry.isAboveHorizon)return!1;h&&(v*=i.pixelToTileUnitsFactor);const b=i.tileID.canonical,w=r.projection.upVectorScale(b,r.center.lat,r.worldSize).metersToTile;for(const A of t)for(const C of A){const P=C.add(g),R=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(P.x,P.y,!0):0,z=r.projection.projectTilePoint(P.x,P.y,b);if(R>0){const Y=r.projection.upVector(b,P.x,P.y);z.x+=Y[0]*w*R,z.y+=Y[1]*w*R,z.z+=Y[2]*w*R}const U=h?P:yee(z.x,z.y,z.z,l),W=h?i.tilespaceRays.map(Y=>_ee(Y,R)):i.queryGeometry.screenGeometry,j=Ga.transformMat4([],[z.x,z.y,z.z,1],l);if(!p&&h?v*=j[3]/r.cameraToCenterDistance:p&&!h&&(v*=r.cameraToCenterDistance/j[3]),h){const Y=gr((C.y/ht+b.y)/(1<<b.z));v/=r.projection.pixelsPerMeter(Y,1)/$a(1,Y)}if(cee(W,U,v))return!0}return!1}function yee(i,t,r,l){const u=Ga.transformMat4([],[i,t,r,1],l);return new V(u[0]/u[3],u[1]/u[3])}const AF=ke.fromValues(0,0,0),vee=ke.fromValues(0,0,1);function _ee(i,t){const r=ke.create();return AF[2]=t,i.intersectsPlane(AF,vee,r),new V(r[0],r[1])}class EF extends oP{}function MF(i,{width:t,height:r},l,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*r*l)throw new RangeError("mismatched image size")}else u=new Uint8Array(t*r*l);return i.width=t,i.height=r,i.data=u,i}function TF(i,t,r){const{width:l,height:u}=t;l===i.width&&u===i.height||(uP(i,t,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,l),height:Math.min(i.height,u)},r),i.width=l,i.height=u,i.data=t.data)}function uP(i,t,r,l,u,h){if(u.width===0||u.height===0)return t;if(u.width>i.width||u.height>i.height||r.x>i.width-u.width||r.y>i.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||l.x>t.width-u.width||l.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const p=i.data,g=t.data;for(let v=0;v<u.height;v++){const b=((r.y+v)*i.width+r.x)*h,w=((l.y+v)*t.width+l.x)*h;for(let A=0;A<u.width*h;A++)g[w+A]=p[b+A]}return t}un(EF,"HeatmapBucket",{omit:["layers"]});class eh{constructor(t,r){MF(this,t,1,r)}resize(t){TF(this,new eh(t),1)}clone(){return new eh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,u,h){uP(t,r,l,u,h,1)}}class qi{constructor(t,r){MF(this,t,4,r)}resize(t){TF(this,new qi(t),4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new qi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,l,u,h){uP(t,r,l,u,h,4)}}class CF{constructor(t,r){this.width=t.width,this.height=t.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}un(eh,"AlphaImage"),un(qi,"RGBAImage");const bee=new yi({visibility:new Xt(nt.layout_heatmap.visibility)});var xee={paint:new yi({"heatmap-radius":new yn(nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yn(nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xt(nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new pm(nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xt(nt.paint_heatmap["heatmap-opacity"])}),layout:bee};function R2(i){const t={},r=i.resolution||256,l=i.clips?i.clips.length:1,u=i.image||new qi({width:r,height:l}),h=(p,g,v)=>{t[i.evaluationKey]=v;const b=i.expression.evaluate(t);b&&(u.data[p+g+0]=Math.floor(255*b.r/b.a),u.data[p+g+1]=Math.floor(255*b.g/b.a),u.data[p+g+2]=Math.floor(255*b.b/b.a),u.data[p+g+3]=Math.floor(255*b.a))};if(i.clips)for(let p=0,g=0;p<l;++p,g+=4*r)for(let v=0,b=0;v<r;v++,b+=4){const w=v/(r-1),{start:A,end:C}=i.clips[p];h(g,b,A*(1-w)+C*w)}else for(let p=0,g=0;p<r;p++,g+=4)h(0,g,p/(r-1));return u}const wee=new yi({visibility:new Xt(nt.layout_hillshade.visibility)});var See={paint:new yi({"hillshade-illumination-direction":new Xt(nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xt(nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xt(nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xt(nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xt(nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xt(nt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Xt(nt.paint_hillshade["hillshade-emissive-strength"])}),layout:wee};const Aee=N([{name:"a_pos",components:2,type:"Int16"}],4),{members:Eee}=Aee;var dP={exports:{}};function k2(i,t,r){r=r||2;var l,u,h,p,g,v,b,w=t&&t.length,A=w?t[0]*r:i.length,C=PF(i,0,A,r,!0),P=[];if(!C||C.next===C.prev)return P;if(w&&(C=function(z,U,W,j){var Y,Z,$,K=[];for(Y=0,Z=U.length;Y<Z;Y++)($=PF(z,U[Y]*j,Y<Z-1?U[Y+1]*j:z.length,j,!1))===$.next&&($.steiner=!0),K.push(kee($));for(K.sort(Iee),Y=0;Y<K.length;Y++)W=Lee(K[Y],W);return W}(i,t,C,r)),i.length>80*r){l=h=i[0],u=p=i[1];for(var R=r;R<A;R+=r)(g=i[R])<l&&(l=g),(v=i[R+1])<u&&(u=v),g>h&&(h=g),v>p&&(p=v);b=(b=Math.max(h-l,p-u))!==0?32767/b:0}return r1(C,P,r,l,u,b,0),P}function PF(i,t,r,l,u){var h,p;if(u===pP(i,t,r,l)>0)for(h=t;h<r;h+=l)p=RF(h,i[h],i[h+1],p);else for(h=r-l;h>=t;h-=l)p=RF(h,i[h],i[h+1],p);return p&&D2(p,p.next)&&(s1(p),p=p.next),p}function _m(i,t){if(!i)return i;t||(t=i);var r,l=i;do if(r=!1,l.steiner||!D2(l,l.next)&&Cr(l.prev,l,l.next)!==0)l=l.next;else{if(s1(l),(l=t=l.prev)===l.next)break;r=!0}while(r||l!==t);return t}function r1(i,t,r,l,u,h,p){if(i){!p&&h&&function(w,A,C,P){var R=w;do R.z===0&&(R.z=hP(R.x,R.y,A,C,P)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==w);R.prevZ.nextZ=null,R.prevZ=null,function(z){var U,W,j,Y,Z,$,K,ie,ce=1;do{for(W=z,z=null,Z=null,$=0;W;){for($++,j=W,K=0,U=0;U<ce&&(K++,j=j.nextZ);U++);for(ie=ce;K>0||ie>0&&j;)K!==0&&(ie===0||!j||W.z<=j.z)?(Y=W,W=W.nextZ,K--):(Y=j,j=j.nextZ,ie--),Z?Z.nextZ=Y:z=Y,Y.prevZ=Z,Z=Y;W=j}Z.nextZ=null,ce*=2}while($>1)}(R)}(i,l,u,h);for(var g,v,b=i;i.prev!==i.next;)if(g=i.prev,v=i.next,h?Tee(i,l,u,h):Mee(i))t.push(g.i/r|0),t.push(i.i/r|0),t.push(v.i/r|0),s1(i),i=v.next,b=v.next;else if((i=v)===b){p?p===1?r1(i=Cee(_m(i),t,r),t,r,l,u,h,2):p===2&&Pee(i,t,r,l,u,h):r1(_m(i),t,r,l,u,h,1);break}}}function Mee(i){var t=i.prev,r=i,l=i.next;if(Cr(t,r,l)>=0)return!1;for(var u=t.x,h=r.x,p=l.x,g=t.y,v=r.y,b=l.y,w=u<h?u<p?u:p:h<p?h:p,A=g<v?g<b?g:b:v<b?v:b,C=u>h?u>p?u:p:h>p?h:p,P=g>v?g>b?g:b:v>b?v:b,R=l.next;R!==t;){if(R.x>=w&&R.x<=C&&R.y>=A&&R.y<=P&&av(u,g,h,v,p,b,R.x,R.y)&&Cr(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function Tee(i,t,r,l){var u=i.prev,h=i,p=i.next;if(Cr(u,h,p)>=0)return!1;for(var g=u.x,v=h.x,b=p.x,w=u.y,A=h.y,C=p.y,P=g<v?g<b?g:b:v<b?v:b,R=w<A?w<C?w:C:A<C?A:C,z=g>v?g>b?g:b:v>b?v:b,U=w>A?w>C?w:C:A>C?A:C,W=hP(P,R,t,r,l),j=hP(z,U,t,r,l),Y=i.prevZ,Z=i.nextZ;Y&&Y.z>=W&&Z&&Z.z<=j;){if(Y.x>=P&&Y.x<=z&&Y.y>=R&&Y.y<=U&&Y!==u&&Y!==p&&av(g,w,v,A,b,C,Y.x,Y.y)&&Cr(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,Z.x>=P&&Z.x<=z&&Z.y>=R&&Z.y<=U&&Z!==u&&Z!==p&&av(g,w,v,A,b,C,Z.x,Z.y)&&Cr(Z.prev,Z,Z.next)>=0))return!1;Z=Z.nextZ}for(;Y&&Y.z>=W;){if(Y.x>=P&&Y.x<=z&&Y.y>=R&&Y.y<=U&&Y!==u&&Y!==p&&av(g,w,v,A,b,C,Y.x,Y.y)&&Cr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;Z&&Z.z<=j;){if(Z.x>=P&&Z.x<=z&&Z.y>=R&&Z.y<=U&&Z!==u&&Z!==p&&av(g,w,v,A,b,C,Z.x,Z.y)&&Cr(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function Cee(i,t,r){var l=i;do{var u=l.prev,h=l.next.next;!D2(u,h)&&IF(u,l,l.next,h)&&o1(u,h)&&o1(h,u)&&(t.push(u.i/r|0),t.push(l.i/r|0),t.push(h.i/r|0),s1(l),s1(l.next),l=i=h),l=l.next}while(l!==i);return _m(l)}function Pee(i,t,r,l,u,h){var p=i;do{for(var g=p.next.next;g!==p.prev;){if(p.i!==g.i&&Dee(p,g)){var v=LF(p,g);return p=_m(p,p.next),v=_m(v,v.next),r1(p,t,r,l,u,h,0),void r1(v,t,r,l,u,h,0)}g=g.next}p=p.next}while(p!==i)}function Iee(i,t){return i.x-t.x}function Lee(i,t){var r=function(u,h){var p,g=h,v=u.x,b=u.y,w=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var A=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(A<=v&&A>w&&(w=A,p=g.x<g.next.x?g:g.next,A===v))return p}g=g.next}while(g!==h);if(!p)return null;var C,P=p,R=p.x,z=p.y,U=1/0;g=p;do v>=g.x&&g.x>=R&&v!==g.x&&av(b<z?v:w,b,R,z,b<z?w:v,b,g.x,g.y)&&(C=Math.abs(b-g.y)/(v-g.x),o1(g,u)&&(C<U||C===U&&(g.x>p.x||g.x===p.x&&Ree(p,g)))&&(p=g,U=C)),g=g.next;while(g!==P);return p}(i,t);if(!r)return t;var l=LF(r,i);return _m(l,l.next),_m(r,r.next)}function Ree(i,t){return Cr(i.prev,i,t.prev)<0&&Cr(t.next,i,i.next)<0}function hP(i,t,r,l,u){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*u|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function kee(i){var t=i,r=i;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==i);return r}function av(i,t,r,l,u,h,p,g){return(u-p)*(t-g)>=(i-p)*(h-g)&&(i-p)*(l-g)>=(r-p)*(t-g)&&(r-p)*(h-g)>=(u-p)*(l-g)}function Dee(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(r,l){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==l.i&&u.next.i!==l.i&&IF(u,u.next,r,l))return!0;u=u.next}while(u!==r);return!1}(i,t)&&(o1(i,t)&&o1(t,i)&&function(r,l){var u=r,h=!1,p=(r.x+l.x)/2,g=(r.y+l.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&p<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==r);return h}(i,t)&&(Cr(i.prev,i,t.prev)||Cr(i,t.prev,t))||D2(i,t)&&Cr(i.prev,i,i.next)>0&&Cr(t.prev,t,t.next)>0)}function Cr(i,t,r){return(t.y-i.y)*(r.x-t.x)-(t.x-i.x)*(r.y-t.y)}function D2(i,t){return i.x===t.x&&i.y===t.y}function IF(i,t,r,l){var u=z2(Cr(i,t,r)),h=z2(Cr(i,t,l)),p=z2(Cr(r,l,i)),g=z2(Cr(r,l,t));return u!==h&&p!==g||!(u!==0||!O2(i,r,t))||!(h!==0||!O2(i,l,t))||!(p!==0||!O2(r,i,l))||!(g!==0||!O2(r,t,l))}function O2(i,t,r){return t.x<=Math.max(i.x,r.x)&&t.x>=Math.min(i.x,r.x)&&t.y<=Math.max(i.y,r.y)&&t.y>=Math.min(i.y,r.y)}function z2(i){return i>0?1:i<0?-1:0}function o1(i,t){return Cr(i.prev,i,i.next)<0?Cr(i,t,i.next)>=0&&Cr(i,i.prev,t)>=0:Cr(i,t,i.prev)<0||Cr(i,i.next,t)<0}function LF(i,t){var r=new fP(i.i,i.x,i.y),l=new fP(t.i,t.x,t.y),u=i.next,h=t.prev;return i.next=t,t.prev=i,r.next=u,u.prev=r,l.next=r,r.prev=l,h.next=l,l.prev=h,l}function RF(i,t,r,l){var u=new fP(i,t,r);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function s1(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function fP(i,t,r){this.i=i,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function pP(i,t,r,l){for(var u=0,h=t,p=r-l;h<r;h+=l)u+=(i[p]-i[h])*(i[h+1]+i[p+1]),p=h;return u}dP.exports=k2,dP.exports.default=k2,k2.deviation=function(i,t,r,l){var u=t&&t.length,h=Math.abs(pP(i,0,u?t[0]*r:i.length,r));if(u)for(var p=0,g=t.length;p<g;p++)h-=Math.abs(pP(i,t[p]*r,p<g-1?t[p+1]*r:i.length,r));var v=0;for(p=0;p<l.length;p+=3){var b=l[p]*r,w=l[p+1]*r,A=l[p+2]*r;v+=Math.abs((i[b]-i[A])*(i[w+1]-i[b+1])-(i[b]-i[w])*(i[A+1]-i[b+1]))}return h===0&&v===0?0:Math.abs((v-h)/h)},k2.flatten=function(i){for(var t=i[0][0].length,r={vertices:[],holes:[],dimensions:t},l=0,u=0;u<i.length;u++){for(var h=0;h<i[u].length;h++)for(var p=0;p<t;p++)r.vertices.push(i[u][h][p]);u>0&&r.holes.push(l+=i[u-1].length)}return r};var F2=F(dP.exports);function mP(i,t){const r=i.length;if(r<=1)return[i];const l=[];let u,h;for(let p=0;p<r;p++){const g=De(i[p]);g!==0&&(i[p].area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(u&&l.push(u),u=[i[p]]):u.push(i[p]))}if(u&&l.push(u),t>1)for(let p=0;p<l.length;p++)l[p].length<=t||(Rc(l[p],t,1,l[p].length-1,Oee),l[p]=l[p].slice(0,t));return l}function Oee(i,t){return t.area-i.area}function gP(i,t,r){const l=r.patternDependencies;let u=!1;for(const h of t){const p=h.paint.get(`${i}-pattern`);p.isConstant()||(u=!0);const g=p.constantOr(null);g&&(u=!0,l[g]=!0)}return u}function yP(i,t,r,l,u){const h=u.patternDependencies;for(const p of t){const g=p.paint.get(`${i}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:l},r,{},u.availableImages);v=v&&v.name?v.name:v,h[v]=!0,r.patterns[p.id]=v}}return r}class N2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new J,this.indexArray=new Nn,this.indexArray2=new to,this.programConfigurations=new ff(t.layers,t.zoom),this.segments=new ja,this.segments2=new ja,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=t.projection}populate(t,r,l,u){this.hasPattern=gP("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),p=[];for(const{feature:g,id:v,index:b,sourceLayerIndex:w}of t){const A=this.layers[0]._featureFilter.needGeometry,C=_f(g,A);if(!this.layers[0]._featureFilter.filter(new ri(this.zoom),C,l))continue;const P=h?h.evaluate(C,{},l,r.availableImages):void 0,R={id:v,properties:g.properties,type:g.type,sourceLayerIndex:w,index:b,geometry:A?C.geometry:Gu(g,l,u),patterns:{},sortKey:P};p.push(R)}h&&p.sort((g,v)=>g.sortKey-v.sortKey);for(const g of p){const{geometry:v,index:b,sourceLayerIndex:w}=g;if(this.hasPattern){const A=yP("fill",this.layers,g,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(g,v,b,l,{},r.availableImages,r.brightness);r.featureIndex.insert(t[b].feature,v,b,w,this.index)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}addFeatures(t,r,l,u,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,l,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Eee),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,l,u,h,p=[],g){for(const v of mP(r,500)){let b=0;for(const z of v)b+=z.length;const w=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),A=w.vertexLength,C=[],P=[];for(const z of v){if(z.length===0)continue;z!==v[0]&&P.push(C.length/2);const U=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),W=U.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(W+z.length-1,W),C.push(z[0].x),C.push(z[0].y);for(let j=1;j<z.length;j++)this.layoutVertexArray.emplaceBack(z[j].x,z[j].y),this.indexArray2.emplaceBack(W+j-1,W+j),C.push(z[j].x),C.push(z[j].y);U.vertexLength+=z.length,U.primitiveLength+=z.length}const R=F2(C,P);for(let z=0;z<R.length;z+=3)this.indexArray.emplaceBack(A+R[z],A+R[z+1],A+R[z+2]);w.vertexLength+=b,w.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,g)}}un(N2,"FillBucket",{omit:["layers","patternFeatures"]});const zee=new yi({"fill-sort-key":new yn(nt.layout_fill["fill-sort-key"]),visibility:new Xt(nt.layout_fill.visibility)});var Fee={paint:new yi({"fill-antialias":new Xt(nt.paint_fill["fill-antialias"]),"fill-opacity":new yn(nt.paint_fill["fill-opacity"]),"fill-color":new yn(nt.paint_fill["fill-color"]),"fill-outline-color":new yn(nt.paint_fill["fill-outline-color"]),"fill-translate":new Xt(nt.paint_fill["fill-translate"]),"fill-translate-anchor":new Xt(nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new yn(nt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Xt(nt.paint_fill["fill-emissive-strength"])}),layout:zee};const Nee=N([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Bee=N([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Uee=N([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Wee=N([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Vee=N([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Gee}=Nee;var B2={},Hee=X,kF=iv;function iv(i,t,r,l,u){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=u,i.readFields(jee,this,t)}function jee(i,t,r){i==1?t.id=r.readVarint():i==2?function(l,u){for(var h=l.readVarint()+l.pos;l.pos<h;){var p=u._keys[l.readVarint()],g=u._values[l.readVarint()];u.properties[p]=g}}(r,t):i==3?t.type=r.readVarint():i==4&&(t._geometry=r.pos)}function $ee(i){for(var t,r,l=0,u=0,h=i.length,p=h-1;u<h;p=u++)l+=((r=i[p]).x-(t=i[u]).x)*(t.y+r.y);return l}iv.types=["Unknown","Point","LineString","Polygon"],iv.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,r=i.readVarint()+i.pos,l=1,u=0,h=0,p=0,g=[];i.pos<r;){if(u<=0){var v=i.readVarint();l=7&v,u=v>>3}if(u--,l===1||l===2)h+=i.readSVarint(),p+=i.readSVarint(),l===1&&(t&&g.push(t),t=[]),t.push(new Hee(h,p));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&g.push(t),g},iv.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,r=1,l=0,u=0,h=0,p=1/0,g=-1/0,v=1/0,b=-1/0;i.pos<t;){if(l<=0){var w=i.readVarint();r=7&w,l=w>>3}if(l--,r===1||r===2)(u+=i.readSVarint())<p&&(p=u),u>g&&(g=u),(h+=i.readSVarint())<v&&(v=h),h>b&&(b=h);else if(r!==7)throw new Error("unknown command "+r)}return[p,v,g,b]},iv.prototype.toGeoJSON=function(i,t,r){var l,u,h=this.extent*Math.pow(2,r),p=this.extent*i,g=this.extent*t,v=this.loadGeometry(),b=iv.types[this.type];function w(P){for(var R=0;R<P.length;R++){var z=P[R];P[R]=[360*(z.x+p)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(z.y+g)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(l=0;l<v.length;l++)A[l]=v[l][0];w(v=A);break;case 2:for(l=0;l<v.length;l++)w(v[l]);break;case 3:for(v=function(P){var R=P.length;if(R<=1)return[P];for(var z,U,W=[],j=0;j<R;j++){var Y=$ee(P[j]);Y!==0&&(U===void 0&&(U=Y<0),U===Y<0?(z&&W.push(z),z=[P[j]]):z.push(P[j]))}return z&&W.push(z),W}(v),l=0;l<v.length;l++)for(u=0;u<v[l].length;u++)w(v[l][u])}v.length===1?v=v[0]:b="Multi"+b;var C={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(C.id=this.id),C};var qee=kF,DF=OF;function OF(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Xee,this,t),this.length=this._features.length}function Xee(i,t,r){i===15?t.version=r.readVarint():i===1?t.name=r.readString():i===5?t.extent=r.readVarint():i===2?t._features.push(r.pos):i===3?t._keys.push(r.readString()):i===4&&t._values.push(function(l){for(var u=null,h=l.readVarint()+l.pos;l.pos<h;){var p=l.readVarint()>>3;u=p===1?l.readString():p===2?l.readFloat():p===3?l.readDouble():p===4?l.readVarint64():p===5?l.readVarint():p===6?l.readSVarint():p===7?l.readBoolean():null}return u}(r))}OF.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new qee(this._pbf,t,this.extent,this._keys,this._values)};var Yee=DF;function Zee(i,t,r){if(i===3){var l=new Yee(r,r.readVarint()+r.pos);l.length&&(t[l.name]=l)}}var vP=B2.VectorTile=function(i,t){this.layers=i.readFields(Zee,{},t)},U2=B2.VectorTileFeature=kF;function W2(i,t,r,l){const u=[],h=l===0?(p,g,v,b,w,A)=>{p.push(new V(A,v+(A-g)/(b-g)*(w-v)))}:(p,g,v,b,w,A)=>{p.push(new V(g+(A-v)/(w-v)*(b-g),A))};for(const p of i){const g=[];for(const v of p){if(v.length<=2)continue;const b=[];for(let C=0;C<v.length-1;C++){const P=v[C].x,R=v[C].y,z=v[C+1].x,U=v[C+1].y,W=l===0?P:R,j=l===0?z:U;W<t?j>t&&h(b,P,R,z,U,t):W>r?j<r&&h(b,P,R,z,U,r):b.push(v[C]),j<t&&W>=t&&h(b,P,R,z,U,t),j>r&&W<=r&&h(b,P,R,z,U,r)}let w=v[v.length-1];const A=l===0?w.x:w.y;A>=t&&A<=r&&b.push(w),b.length&&(w=b[b.length-1],b[0].x===w.x&&b[0].y===w.y||b.push(b[0]),g.push(b))}g.length&&u.push(g)}return u}B2.VectorTileLayer=DF;class zF{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const l=t[r];this._stringToNumber[l]=r,this._numberToString[r]=l}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var Kee={read:function(i,t,r,l,u){var h,p,g=8*u-l-1,v=(1<<g)-1,b=v>>1,w=-7,A=r?u-1:0,C=r?-1:1,P=i[t+A];for(A+=C,h=P&(1<<-w)-1,P>>=-w,w+=g;w>0;h=256*h+i[t+A],A+=C,w-=8);for(p=h&(1<<-w)-1,h>>=-w,w+=l;w>0;p=256*p+i[t+A],A+=C,w-=8);if(h===0)h=1-b;else{if(h===v)return p?NaN:1/0*(P?-1:1);p+=Math.pow(2,l),h-=b}return(P?-1:1)*p*Math.pow(2,h-l)},write:function(i,t,r,l,u,h){var p,g,v,b=8*h-u-1,w=(1<<b)-1,A=w>>1,C=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=l?0:h-1,R=l?1:-1,z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,p=w):(p=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-p))<1&&(p--,v*=2),(t+=p+A>=1?C/v:C*Math.pow(2,1-A))*v>=2&&(p++,v/=2),p+A>=w?(g=0,p=w):p+A>=1?(g=(t*v-1)*Math.pow(2,u),p+=A):(g=t*Math.pow(2,A-1)*Math.pow(2,u),p=0));u>=8;i[r+P]=255&g,P+=R,g/=256,u-=8);for(p=p<<u|g,b+=u;b>0;i[r+P]=255&p,P+=R,p/=256,b-=8);i[r+P-R]|=128*z}},FF=_i,V2=Kee;function _i(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}_i.Varint=0,_i.Fixed64=1,_i.Bytes=2,_i.Fixed32=5;var _P=4294967296,NF=1/_P,BF=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function th(i){return i.type===_i.Bytes?i.readVarint()+i.pos:i.pos+1}function rv(i,t,r){return r?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function UF(i,t,r){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(l);for(var u=r.pos-1;u>=i;u--)r.buf[u+l]=r.buf[u]}function Jee(i,t){for(var r=0;r<i.length;r++)t.writeVarint(i[r])}function Qee(i,t){for(var r=0;r<i.length;r++)t.writeSVarint(i[r])}function ete(i,t){for(var r=0;r<i.length;r++)t.writeFloat(i[r])}function tte(i,t){for(var r=0;r<i.length;r++)t.writeDouble(i[r])}function nte(i,t){for(var r=0;r<i.length;r++)t.writeBoolean(i[r])}function ate(i,t){for(var r=0;r<i.length;r++)t.writeFixed32(i[r])}function ite(i,t){for(var r=0;r<i.length;r++)t.writeSFixed32(i[r])}function rte(i,t){for(var r=0;r<i.length;r++)t.writeFixed64(i[r])}function ote(i,t){for(var r=0;r<i.length;r++)t.writeSFixed64(i[r])}function G2(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function ov(i,t,r){i[r]=t,i[r+1]=t>>>8,i[r+2]=t>>>16,i[r+3]=t>>>24}function WF(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}_i.prototype={destroy:function(){this.buf=null},readFields:function(i,t,r){for(r=r||this.length;this.pos<r;){var l=this.readVarint(),u=l>>3,h=this.pos;this.type=7&l,i(u,t,this),this.pos===h&&this.skip(l)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=G2(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=WF(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=G2(this.buf,this.pos)+G2(this.buf,this.pos+4)*_P;return this.pos+=8,i},readSFixed64:function(){var i=G2(this.buf,this.pos)+WF(this.buf,this.pos+4)*_P;return this.pos+=8,i},readFloat:function(){var i=V2.read(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=V2.read(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,r,l=this.buf;return t=127&(r=l[this.pos++]),r<128?t:(t|=(127&(r=l[this.pos++]))<<7,r<128?t:(t|=(127&(r=l[this.pos++]))<<14,r<128?t:(t|=(127&(r=l[this.pos++]))<<21,r<128?t:function(u,h,p){var g,v,b=p.buf;if(g=(112&(v=b[p.pos++]))>>4,v<128||(g|=(127&(v=b[p.pos++]))<<3,v<128)||(g|=(127&(v=b[p.pos++]))<<10,v<128)||(g|=(127&(v=b[p.pos++]))<<17,v<128)||(g|=(127&(v=b[p.pos++]))<<24,v<128)||(g|=(1&(v=b[p.pos++]))<<31,v<128))return rv(u,g,h);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&BF?function(r,l,u){return BF.decode(r.subarray(l,u))}(this.buf,t,i):function(r,l,u){for(var h="",p=l;p<u;){var g,v,b,w=r[p],A=null,C=w>239?4:w>223?3:w>191?2:1;if(p+C>u)break;C===1?w<128&&(A=w):C===2?(192&(g=r[p+1]))==128&&(A=(31&w)<<6|63&g)<=127&&(A=null):C===3?(v=r[p+2],(192&(g=r[p+1]))==128&&(192&v)==128&&((A=(15&w)<<12|(63&g)<<6|63&v)<=2047||A>=55296&&A<=57343)&&(A=null)):C===4&&(v=r[p+2],b=r[p+3],(192&(g=r[p+1]))==128&&(192&v)==128&&(192&b)==128&&((A=(15&w)<<18|(63&g)<<12|(63&v)<<6|63&b)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,C=1):A>65535&&(A-=65536,h+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),h+=String.fromCharCode(A),p+=C}return h}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==_i.Bytes)return i.push(this.readVarint(t));var r=th(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==_i.Bytes)return i.push(this.readSVarint());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==_i.Bytes)return i.push(this.readBoolean());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==_i.Bytes)return i.push(this.readFloat());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==_i.Bytes)return i.push(this.readDouble());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==_i.Bytes)return i.push(this.readFixed32());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==_i.Bytes)return i.push(this.readSFixed32());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==_i.Bytes)return i.push(this.readFixed64());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==_i.Bytes)return i.push(this.readSFixed64());var t=th(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===_i.Varint)for(;this.buf[this.pos++]>127;);else if(t===_i.Bytes)this.pos=this.readVarint()+this.pos;else if(t===_i.Fixed32)this.pos+=4;else{if(t!==_i.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),ov(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),ov(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),ov(this.buf,-1&i,this.pos),ov(this.buf,Math.floor(i*NF),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),ov(this.buf,-1&i,this.pos),ov(this.buf,Math.floor(i*NF),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,r){var l,u;if(t>=0?(l=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(h,p,g){g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,g.buf[g.pos]=127&(h>>>=7)}(l,0,r),function(h,p){var g=(7&h)<<4;p.buf[p.pos++]|=g|((h>>>=3)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h|((h>>>=7)?128:0),h&&(p.buf[p.pos++]=127&h)))))}(u,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(l,u,h){for(var p,g,v=0;v<u.length;v++){if((p=u.charCodeAt(v))>55295&&p<57344){if(!g){p>56319||v+1===u.length?(l[h++]=239,l[h++]=191,l[h++]=189):g=p;continue}if(p<56320){l[h++]=239,l[h++]=191,l[h++]=189,g=p;continue}p=g-55296<<10|p-56320|65536,g=null}else g&&(l[h++]=239,l[h++]=191,l[h++]=189,g=null);p<128?l[h++]=p:(p<2048?l[h++]=p>>6|192:(p<65536?l[h++]=p>>12|224:(l[h++]=p>>18|240,l[h++]=p>>12&63|128),l[h++]=p>>6&63|128),l[h++]=63&p|128)}return h}(this.buf,i,this.pos);var r=this.pos-t;r>=128&&UF(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),V2.write(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),V2.write(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,t){this.pos++;var r=this.pos;i(t,this);var l=this.pos-r;l>=128&&UF(r,l,this),this.pos=r-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,t,r){this.writeTag(i,_i.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,Jee,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,Qee,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,nte,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,ete,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,tte,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,ate,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,ite,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,rte,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,ote,t)},writeBytesField:function(i,t){this.writeTag(i,_i.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,_i.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,_i.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,_i.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,_i.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,_i.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,_i.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,_i.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,_i.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,_i.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var H2=F(FF);const ste=["tile","layer","source","sourceLayer","state"];class VF{constructor(t,r,l,u,h){this.type="Feature",this._vectorTileFeature=t,this._z=r,this._x=l,this._y=u,this.properties=t.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const r of ste)this[r]!==void 0&&(t[r]=this[r]);return t}}class lte{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,l){const u=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][u]=this.stateChanges[t][u]||{},Ue(this.stateChanges[t][u],l),this.deletedStates[t]===null){this.deletedStates[t]={};for(const h in this.state[t])h!==u&&(this.deletedStates[t][h]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][u]===null){this.deletedStates[t][u]={};for(const h in this.state[t][u])l[h]||(this.deletedStates[t][u][h]=null)}else for(const h in l)this.deletedStates[t]&&this.deletedStates[t][u]&&this.deletedStates[t][u][h]===null&&delete this.deletedStates[t][u][h]}removeFeatureState(t,r,l){if(this.deletedStates[t]===null)return;const u=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},l&&r!==void 0)this.deletedStates[t][u]!==null&&(this.deletedStates[t][u]=this.deletedStates[t][u]||{},this.deletedStates[t][u][l]=null);else if(r!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][u])for(l in this.deletedStates[t][u]={},this.stateChanges[t][u])this.deletedStates[t][u][l]=null;else this.deletedStates[t][u]=null;else this.deletedStates[t]=null}getState(t,r){const l=String(r),u=Ue({},(this.state[t]||{})[l],(this.stateChanges[t]||{})[l]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const h=this.deletedStates[t][r];if(h===null)return{};for(const p in h)delete u[p]}return u}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const h={};for(const p in this.stateChanges[u])this.state[u][p]||(this.state[u][p]={}),Ue(this.state[u][p],this.stateChanges[u][p]),h[p]=this.state[u][p];l[u]=h}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const h={};if(this.deletedStates[u]===null)for(const p in this.state[u])h[p]={},this.state[u][p]={};else for(const p in this.deletedStates[u]){if(this.deletedStates[u][p]===null)this.state[u][p]={};else if(this.state[u][p])for(const g of Object.keys(this.deletedStates[u][p]))delete this.state[u][p][g];h[p]=this.state[u][p]}l[u]=l[u]||{},Ue(l[u],h)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in t)t[u].setFeatureState(l,r)}}class GF{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,r){const l=this.toIdx(t,r);return{min:this.minimums[l],max:this.maximums[l]}}isLeaf(t,r){return this.leaves[this.toIdx(t,r)]}toIdx(t,r){return r*this.size+t}}function HF(i,t,r,l){let u=0,h=Number.MAX_VALUE;for(let p=0;p<3;p++)if(Math.abs(l[p])<1e-15){if(r[p]<i[p]||r[p]>t[p])return null}else{const g=1/l[p];let v=(i[p]-r[p])*g,b=(t[p]-r[p])*g;if(v>b){const w=v;v=b,b=w}if(v>u&&(u=v),b<h&&(h=b),u>h)return null}return u}function jF(i,t,r,l,u,h,p,g,v,b,w){const A=l-i,C=u-t,P=h-r,R=p-i,z=g-t,U=v-r,W=w[1]*U-w[2]*z,j=w[2]*R-w[0]*U,Y=w[0]*z-w[1]*R,Z=A*W+C*j+P*Y;if(Math.abs(Z)<1e-15)return null;const $=1/Z,K=b[0]-i,ie=b[1]-t,ce=b[2]-r,he=(K*W+ie*j+ce*Y)*$;if(he<0||he>1)return null;const ye=ie*P-ce*C,Te=ce*A-K*P,we=K*C-ie*A,Ie=(w[0]*ye+w[1]*Te+w[2]*we)*$;return Ie<0||he+Ie>1?null:(R*ye+z*Te+U*we)*$}function $F(i,t,r){return(i-t)/(r-t)}function qF(i,t,r,l,u,h,p,g,v){const b=1<<r,w=h-l,A=p-u,C=(i+1)/b*w+l,P=(t+0)/b*A+u,R=(t+1)/b*A+u;g[0]=(i+0)/b*w+l,g[1]=P,v[0]=C,v[1]=R}class XF{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(h){const p=Math.ceil(Math.log2(h.dim/8)),g=[];let v=Math.ceil(Math.pow(2,p));const b=1/v,w=(P,R,z,U,W)=>{const j=U?1:0,Y=(P+1)*z-j,Z=R*z,$=(R+1)*z-j;W[0]=P*z,W[1]=Z,W[2]=Y,W[3]=$};let A=new GF(v);const C=[];for(let P=0;P<v*v;P++){w(P%v,Math.floor(P/v),b,!1,C);const R=xf(C[0],C[1],h),z=xf(C[2],C[1],h),U=xf(C[2],C[3],h),W=xf(C[0],C[3],h);A.minimums.push(Math.min(R,z,U,W)),A.maximums.push(Math.max(R,z,U,W)),A.leaves.push(1)}for(g.push(A),v/=2;v>=1;v/=2){const P=g[g.length-1];A=new GF(v);for(let R=0;R<v*v;R++){w(R%v,Math.floor(R/v),2,!0,C);const z=P.getElevation(C[0],C[1]),U=P.getElevation(C[2],C[1]),W=P.getElevation(C[2],C[3]),j=P.getElevation(C[0],C[3]),Y=P.isLeaf(C[0],C[1]),Z=P.isLeaf(C[2],C[1]),$=P.isLeaf(C[2],C[3]),K=P.isLeaf(C[0],C[3]),ie=Math.min(z.min,U.min,W.min,j.min),ce=Math.max(z.max,U.max,W.max,j.max),he=Y&&Z&&$&&K;A.maximums.push(ce),A.minimums.push(ie),A.leaves.push(ce-ie<=5&&he?1:0)}g.push(A)}return g}(this.dem),l=r.length-1,u=r[l];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,l,0)}raycastRoot(t,r,l,u,h,p,g=1){return HF([t,r,-100],[l,u,this.maximums[0]*g],h,p)}raycast(t,r,l,u,h,p,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(t,r,l,u,h,p,g);if(v==null)return null;const b=[],w=[],A=[],C=[],P=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:R,t:z,nodex:U,nodey:W,depth:j}=P.pop();if(this.leaves[R]){qF(U,W,j,t,r,l,u,A,C);const Z=1<<j,$=(U+0)/Z,K=(U+1)/Z,ie=(W+0)/Z,ce=(W+1)/Z,he=xf($,ie,this.dem)*g,ye=xf(K,ie,this.dem)*g,Te=xf(K,ce,this.dem)*g,we=xf($,ce,this.dem)*g,Ie=jF(A[0],A[1],he,C[0],A[1],ye,C[0],C[1],Te,h,p),xe=jF(C[0],C[1],Te,A[0],C[1],we,A[0],A[1],he,h,p),We=Math.min(Ie!==null?Ie:Number.MAX_VALUE,xe!==null?xe:Number.MAX_VALUE);if(We!==Number.MAX_VALUE)return We;{const qe=ke.scaleAndAdd([],h,p,z);if(YF(he,ye,we,Te,$F(qe[0],A[0],C[0]),$F(qe[1],A[1],C[1]))>=qe[2])return z}continue}let Y=0;for(let Z=0;Z<this._siblingOffset.length;Z++){qF((U<<1)+this._siblingOffset[Z][0],(W<<1)+this._siblingOffset[Z][1],j+1,t,r,l,u,A,C),A[2]=-100,C[2]=this.maximums[this.childOffsets[R]+Z]*g;const $=HF(A,C,h,p);if($!=null){const K=$;b[Z]=K;let ie=!1;for(let ce=0;ce<Y&&!ie;ce++)K>=b[w[ce]]&&(w.splice(ce,0,Z),ie=!0);ie||(w[Y]=Z),Y++}}for(let Z=0;Z<Y;Z++){const $=w[Z];P.push({idx:this.childOffsets[R]+$,t:b[$],nodex:(U<<1)+this._siblingOffset[$][0],nodey:(W<<1)+this._siblingOffset[$][1],depth:j+1})}}return null}_addNode(t,r,l){return this.minimums.push(t),this.maximums.push(r),this.leaves.push(l),this.childOffsets.push(0),this.nodeCount++}_construct(t,r,l,u,h){if(t[u].isLeaf(r,l)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const p=u-1,g=t[p];let v=0,b=0;for(let w=0;w<this._siblingOffset.length;w++){const A=2*r+this._siblingOffset[w][0],C=2*l+this._siblingOffset[w][1],P=g.getElevation(A,C),R=g.isLeaf(A,C),z=this._addNode(P.min,P.max,R);R&&(v|=1<<w),b||(b=z)}for(let w=0;w<this._siblingOffset.length;w++)v&1<<w||this._construct(t,2*r+this._siblingOffset[w][0],2*l+this._siblingOffset[w][1],p,b+w)}}function YF(i,t,r,l,u,h){return Ln(Ln(i,r,h),Ln(t,l,h),u)}function xf(i,t,r){const l=r.dim,u=ae(i*l-.5,0,l-1),h=ae(t*l-.5,0,l-1),p=Math.floor(u),g=Math.floor(h),v=Math.min(p+1,l-1),b=Math.min(g+1,l-1);return YF(r.get(p,g),r.get(v,g),r.get(p,b),r.get(v,b),u-p,h-g)}const ZF={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768],float:[1,1,1,1]};function bP(i,t,r){return(256*i*256+256*t+r)/10-1e4}function xP(i,t,r){return 256*i+t+r/256-32768}class bm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,r,l,u,h=!1){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(l&&l!=="mapbox"&&l!=="terrarium")return ve(`"${l}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const p=this.dim=r.height-2,g=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=l||"mapbox",this.borderReady=h,this._modifiedForSources={},!h){for(let v=0;v<p;v++)g[this._idx(-1,v)]=g[this._idx(0,v)],g[this._idx(p,v)]=g[this._idx(p-1,v)],g[this._idx(v,-1)]=g[this._idx(v,0)],g[this._idx(v,p)]=g[this._idx(v,p-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(p,-1)]=g[this._idx(p-1,0)],g[this._idx(-1,p)]=g[this._idx(0,p-1)],g[this._idx(p,p)]=g[this._idx(p-1,p-1)]}if(u){const v=new Float32Array(r.data.buffer),b=this.encoding==="terrarium"?xP:bP;for(let w=0;w<g.length;++w){const A=4*w;v[w]=b(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}this.encoding="float"}this._timestamp=Cn.now()}_buildQuadTree(){this._tree=new XF(this)}get(t,r,l=!1){l&&(t=ae(t,-1,this.dim),r=ae(r,-1,this.dim));const u=this._idx(t,r);if(this.encoding==="float")return this.floatView||(this.floatView=new Float32Array(this.pixels.buffer)),this.floatView[u];const h=4*u;return(this.encoding==="terrarium"?xP:bP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}set(t,r,l){const u=this._idx(t,r);if(this.encoding==="float"){this.floatView||(this.floatView=new Float32Array(this.pixels.buffer));const v=this.floatView[u];return this.floatView[u]=l,l-v}const h=4*u,p=(this.encoding==="terrarium"?xP:bP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2]),g=bm.pack(l,this.encoding==="terrarium"?"terrarium":"mapbox");return this.pixels[h]=g[0],this.pixels[h+1]=g[1],this.pixels[h+2]=g[2],l-p}static getUnpackVector(t){return ZF[t]}get unpackVector(){return ZF[this.encoding]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}static pack(t,r){const l=[0,0,0,0],u=bm.getUnpackVector(r);let h=Math.floor((t+u[3])/u[2]);return l[2]=h%256,h=Math.floor(h/256),l[1]=h%256,h=Math.floor(h/256),l[0]=h,l}getPixels(){return this.encoding==="float"?new CF({width:this.stride,height:this.stride},this.pixels):new qi({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,r,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,h=r*this.dim+this.dim,p=l*this.dim,g=l*this.dim+this.dim;switch(r){case-1:u=h-1;break;case 1:h=u+1}switch(l){case-1:p=g-1;break;case 1:g=p+1}const v=-r*this.dim,b=-l*this.dim;for(let w=p;w<g;w++)for(let A=u;A<h;A++){const C=4*this._idx(A,w),P=4*this._idx(A+v,w+b);this.pixels[C+0]=t.pixels[P+0],this.pixels[C+1]=t.pixels[P+1],this.pixels[C+2]=t.pixels[P+2],this.pixels[C+3]=t.pixels[P+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}un(bm,"DEMData"),un(XF,"DemMinMaxQuadTree",{omit:["dem"]});class cte{isDataAvailableAtPoint(t){const r=this._source();if(this.isUsingMockSource()||!r||t.y<0||t.y>1)return!1;const l=r.getSource().maxzoom,u=1<<l,h=Math.floor(t.x),p=Math.floor((t.x-h)*u),g=Math.floor(t.y*u),v=this.findDEMTileFor(new Ca(l,h,l,p,g));return!(!v||!v.dem)}getAtPointOrZero(t,r=0){return this.getAtPoint(t,r)||0}getAtPoint(t,r,l=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const u=this._source();if(!u||t.y<0||t.y>1)return r;const h=u.getSource().maxzoom,p=1<<h,g=Math.floor(t.x),v=t.x-g,b=new Ca(h,g,h,Math.floor(v*p),Math.floor(t.y*p)),w=this.findDEMTileFor(b);if(!w||!w.dem)return r;const A=w.dem,C=1<<w.tileID.canonical.z,P=(v*C-w.tileID.canonical.x)*A.dim,R=(t.y*C-w.tileID.canonical.y)*A.dim,z=Math.floor(P),U=Math.floor(R);return(l?this.exaggeration():1)*Ln(Ln(A.get(z,U),A.get(z,U+1),R-U),Ln(A.get(z+1,U),A.get(z+1,U+1),R-U),P-z)}getAtTileOffset(t,r,l){const u=1<<t.canonical.z;return this.getAtPointOrZero(new ga(t.wrap+(t.canonical.x+r/ht)/u,(t.canonical.y+l/ht)/u))}getAtTileOffsetFunc(t,r,l,u){return h=>{const p=this.getAtTileOffset(t,h.x,h.y),g=u.upVector(t.canonical,h.x,h.y),v=u.upVectorScale(t.canonical,r,l).metersToTile;return ke.scale(g,g,p*v),g}}getForTilePoints(t,r,l,u){if(this.isUsingMockSource())return!1;const h=sv.create(this,t,u);return!!h&&(r.forEach(p=>{p[2]=this.exaggeration()*h.getElevationAt(p[0],p[1],l)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(t);if(!r||!r.dem)return null;const l=r.dem.tree,u=r.tileID,h=1<<t.canonical.z-u.canonical.z;let p=t.canonical.x/h-u.canonical.x,g=t.canonical.y/h-u.canonical.y,v=0;for(let b=0;b<t.canonical.z-u.canonical.z&&!l.leaves[v];b++){p*=2,g*=2;const w=2*Math.floor(g)+Math.floor(p);v=l.childOffsets[v]+w,p%=1,g%=1}return{min:this.exaggeration()*l.minimums[v],max:this.exaggeration()*l.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,r,l){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class sv{constructor(t,r,l){this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=l}static create(t,r,l){const u=l||t.findDEMTileFor(r);if(!u||!u.dem)return;const h=u.dem,p=u.tileID,g=1<<r.canonical.z-p.canonical.z;return new sv(u,h.dim/ht/g,[(r.canonical.x/g-p.canonical.x)*h.dim,(r.canonical.y/g-p.canonical.y)*h.dim])}tileCoordToPixel(t,r){const l=r*this._scale+this._offset[1],u=Math.floor(t*this._scale+this._offset[0]),h=Math.floor(l);return new V(u,h)}getElevationAt(t,r,l,u){const h=t*this._scale+this._offset[0],p=r*this._scale+this._offset[1],g=Math.floor(h),v=Math.floor(p),b=this._dem;return u=!!u,l?Ln(Ln(b.get(g,v,u),b.get(g,v+1,u),p-v),Ln(b.get(g+1,v,u),b.get(g+1,v+1,u),p-v),h-g):b.get(g,v,u)}getElevationAtPixel(t,r,l){return this._dem.get(t,r,!!l)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*$a(1,t)*this._dem.stride}}class wP{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new eo(ht,16,0),this.featureIndexArray=new MO,this.promoteId=r}insert(t,r,l,u,h,p=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,u,h,p);const v=this.grid;for(let b=0;b<r.length;b++){const w=r[b],A=[1/0,1/0,-1/0,-1/0];for(let C=0;C<w.length;C++){const P=w[C];A[0]=Math.min(A[0],P.x),A[1]=Math.min(A[1],P.y),A[2]=Math.max(A[2],P.x),A[3]=Math.max(A[3],P.y)}A[0]<ht&&A[1]<ht&&A[2]>=0&&A[3]>=0&&v.insert(g,A[0],A[1],A[2],A[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new vP(new H2(this.rawTileData)).layers,this.sourceLayerCoder=new zF(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,r,l,u){this.loadVTLayers();const h=t.params||{},p=nm(h.filter),g=t.tileResult,v=t.transform,b=g.bufferedTilespaceBounds,w=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(R,z,U,W)=>_F(g.bufferedTilespaceGeometry,R,z,U,W));w.sort(ute);let A=null;v.elevation&&w.length>0&&(A=sv.create(v.elevation,this.tileID));const C={};let P;for(let R=0;R<w.length;R++){const z=w[R];if(z===P)continue;P=z;const U=this.featureIndexArray.get(z);let W=null;this.loadMatchingFeature(C,U,p,h.layers,h.availableImages,r,l,u,(j,Y,Z,$=0)=>(W||(W=Gu(j,this.tileID.canonical,t.tileTransform)),Y.queryIntersectsFeature(g,j,Z,W,this.z,t.transform,t.pixelPosMatrix,A,$)))}return C}loadMatchingFeature(t,r,l,u,h,p,g,v,b){const{featureIndex:w,bucketIndex:A,sourceLayerIndex:C,layoutVertexArrayOffset:P}=r,R=this.bucketLayerIDs[A];if(u&&!function(j,Y){for(let Z=0;Z<j.length;Z++)if(Y.indexOf(j[Z])>=0)return!0;return!1}(u,R))return;const z=this.sourceLayerCoder.decode(C),U=this.vtLayers[z].feature(w);if(l.needGeometry){const j=_f(U,!0);if(!l.filter(new ri(this.tileID.overscaledZ),j,this.tileID.canonical))return}else if(!l.filter(new ri(this.tileID.overscaledZ),U))return;const W=this.getId(U,z);for(let j=0;j<R.length;j++){const Y=R[j];if(u&&u.indexOf(Y)<0)continue;const Z=p[Y];if(!Z)continue;let $={};W!==void 0&&v&&($=v.getState(Z.sourceLayer||"_geojsonTileLayer",W));const K=Ue({},g[Y]);K.paint=KF(K.paint,Z.paint,U,$,h),K.layout=KF(K.layout,Z.layout,U,$,h);const ie=!b||b(U,Z,$,P);if(!ie)continue;const ce=new VF(U,this.z,this.x,this.y,W);ce.layer=K;let he=t[Y];he===void 0&&(he=t[Y]=[]),he.push({featureIndex:w,feature:ce,intersectionZ:ie})}}lookupSymbolFeatures(t,r,l,u,h,p,g,v){const b={};this.loadVTLayers();const w=nm(h);for(const A of t)this.loadMatchingFeature(b,{bucketIndex:l,sourceLayerIndex:u,featureIndex:A,layoutVertexArrayOffset:0},w,p,g,v,r);return b}loadFeature(t){const{featureIndex:r,sourceLayerIndex:l}=t;this.loadVTLayers();const u=this.sourceLayerCoder.decode(l),h=this.vtFeatures[u];if(h[r])return h[r];const p=this.vtLayers[u].feature(r);return h[r]=p,p}hasLayer(t){for(const r of this.bucketLayerIDs)for(const l of r)if(t===l)return!0;return!1}getId(t,r){let l=t.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];u!=null&&(l=t.properties[u]),typeof l=="boolean"&&(l=Number(l))}return l}}function KF(i,t,r,l,u){return At(i,(h,p)=>{const g=t instanceof Bu?t.get(p):null;return g&&g.evaluate?g.evaluate(r,l,u):g})}function ute(i,t){return t-i}un(wP,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const dte=N([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hte=N([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),fte=N([{name:"a_projected_pos",components:4,type:"Float32"}],4);N([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const pte=N([{name:"a_z_offset",components:1,type:"Float32"}],4),mte=N([{name:"a_texb",components:2,type:"Uint16"}]),gte=N([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),yte=N([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);N([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const JF=N([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),vte=N([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);N([{name:"triangle",components:3,type:"Uint16"}]),N([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),N([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),N([{type:"Float32",name:"offsetX"}]),N([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var io=24;const Hc=128;function SP(i,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new ri(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:u}=r;let h=0;for(;h<l.length&&l[h]<=i;)h++;h=Math.max(0,h-1);let p=h;for(;p<l.length&&l[p]<i+1;)p++;p=Math.min(l.length-1,p);const g=l[h],v=l[p];return r.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:v,minSize:r.evaluate(new ri(g)),maxSize:r.evaluate(new ri(v)),interpolationType:u}}}function l1(i,{uSize:t,uSizeT:r},{lowerSize:l,upperSize:u}){return i.kind==="source"?l/Hc:i.kind==="composite"?Ln(l/Hc,u/Hc,r):t}function Hu(i,t){let r=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:u,minZoom:h,maxZoom:p}=i,g=u?ae(oc.interpolationFactor(u,t,h,p),0,1):0;i.kind==="camera"?l=Ln(i.minSize,i.maxSize,g):r=g}return{uSizeT:r,uSize:l}}var _te=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Hc,evaluateSizeForFeature:l1,evaluateSizeForZoom:Hu,getSizeData:SP});function bte(i,t,r){return i.sections.forEach(l=>{l.text=function(u,h,p){const g=h.layout.get("text-transform").evaluate(p,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),Ds.applyArabicShaping&&(u=Ds.applyArabicShaping(u)),u}(l.text,t,r)}),i}const c1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function xte(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function wte(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}const AP=3;function Ste(i,t,r){t.glyphs=[],i===1&&r.readMessage(Ate,t)}function Ate(i,t,r){if(i===3){const{id:l,bitmap:u,width:h,height:p,left:g,top:v,advance:b}=r.readMessage(Ete,{});t.glyphs.push({id:l,bitmap:new eh({width:h+2*AP,height:p+2*AP},u),metrics:{width:h,height:p,left:g,top:v,advance:b}})}else i===4?t.ascender=r.readSVarint():i===5&&(t.descender=r.readSVarint())}function Ete(i,t,r){i===1?t.id=r.readVarint():i===2?t.bitmap=r.readBytes():i===3?t.width=r.readVarint():i===4?t.height=r.readVarint():i===5?t.left=r.readSVarint():i===6?t.top=r.readSVarint():i===7&&(t.advance=r.readVarint())}const QF=AP;function EP(i){let t=0,r=0;for(const p of i)t+=p.w*p.h,r=Math.max(r,p.w);i.sort((p,g)=>g.h-p.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let u=0,h=0;for(const p of i)for(let g=l.length-1;g>=0;g--){const v=l[g];if(!(p.w>v.w||p.h>v.h)){if(p.x=v.x,p.y=v.y,h=Math.max(h,p.y+p.h),u=Math.max(u,p.x+p.w),p.w===v.w&&p.h===v.h){const b=l.pop();g<l.length&&(l[g]=b)}else p.h===v.h?(v.x+=p.w,v.w-=p.w):p.w===v.w?(v.y+=p.h,v.h-=p.h):(l.push({x:v.x+p.w,y:v.y,w:v.w-p.w,h:p.h}),v.y+=p.h,v.h-=p.h);break}}return{w:u,h,fill:t/(u*h)||0}}const Ns=1;class MP{constructor(t,{pixelRatio:r,version:l,stretchX:u,stretchY:h,content:p}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=u,this.stretchY=h,this.content=p,this.version=l}get tl(){return[this.paddedRect.x+Ns,this.paddedRect.y+Ns]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ns,this.paddedRect.y+this.paddedRect.h-Ns]}get displaySize(){return[(this.paddedRect.w-2*Ns)/this.pixelRatio,(this.paddedRect.h-2*Ns)/this.pixelRatio]}}class eN{constructor(t,r){const l={},u={};this.haveRenderCallbacks=[];const h=[];this.addImages(t,l,h),this.addImages(r,u,h);const{w:p,h:g}=EP(h),v=new qi({width:p||1,height:g||1});for(const b in t){const w=t[b],A=l[b].paddedRect;qi.copy(w.data,v,{x:0,y:0},{x:A.x+Ns,y:A.y+Ns},w.data)}for(const b in r){const w=r[b],A=u[b].paddedRect,C=A.x+Ns,P=A.y+Ns,R=w.data.width,z=w.data.height;qi.copy(w.data,v,{x:0,y:0},{x:C,y:P},w.data),qi.copy(w.data,v,{x:0,y:z-1},{x:C,y:P-1},{width:R,height:1}),qi.copy(w.data,v,{x:0,y:0},{x:C,y:P+z},{width:R,height:1}),qi.copy(w.data,v,{x:R-1,y:0},{x:C-1,y:P},{width:1,height:z}),qi.copy(w.data,v,{x:0,y:0},{x:C+R,y:P},{width:1,height:z})}this.image=v,this.iconPositions=l,this.patternPositions=u}addImages(t,r,l){for(const u in t){const h=t[u],p={x:0,y:0,w:h.data.width+2*Ns,h:h.data.height+2*Ns};l.push(p),r[u]=new MP(p,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,r,l){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>t.hasImage(u,l)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,l);for(const u in t.getUpdatedImages(l))this.patchUpdatedImage(this.iconPositions[u],t.getImage(u,l),r),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u,l),r)}patchUpdatedImage(t,r,l){if(!t||!r||t.version===r.version)return;t.version=r.version;const[u,h]=t.tl;l.update(r.data,void 0,{x:u,y:h})}}un(MP,"ImagePosition"),un(eN,"ImageAtlas");const bi={horizontal:1,vertical:2,horizontalOnly:3},tN=-17;class u1{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const l=new u1;return l.scale=t||1,l.fontStack=r,l}static forImage(t){const r=new u1;return r.imageName=t,r}}class lv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const l=new lv;for(let u=0;u<t.sections.length;u++){const h=t.sections[u];h.image?l.addImageSection(h):l.addTextSection(h,r)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(r,l){let u="";for(let h=0;h<r.length;h++){const p=r.charCodeAt(h+1)||null,g=r.charCodeAt(h-1)||null;u+=!l&&(p&&Vy(p)&&!c1[r[h+1]]||g&&Vy(g)&&!c1[r[h-1]])||!c1[r[h]]?r[h]:c1[r[h]]}return u}(this.text,t)}trim(){let t=0;for(let l=0;l<this.text.length&&j2[this.text.charCodeAt(l)];l++)t++;let r=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&j2[this.text.charCodeAt(l)];l--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const l=new lv;return l.text=this.text.substring(t,r),l.sectionIndex=this.sectionIndex.slice(t,r),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(u1.forText(t.scale,t.fontStack||r));const l=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(l)}addImageSection(t){const r=t.image?t.image.namePrimary:"";if(r.length===0)return void ve("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCodePoint(l),this.sections.push(u1.forImage(r)),this.sectionIndex.push(this.sections.length-1)):ve("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function TP(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R){const z=lv.fromFeature(i,u);A===bi.vertical&&z.verticalizePunctuation(C);let U=[];const W=function(K,ie,ce,he,ye,Te){if(!K)return[];const we=[],Ie=function(et,Ne,Ve,it,gt,ct){let Pt=0;for(let Ft=0;Ft<et.length();Ft++){const xt=et.getSection(Ft);Pt+=nN(et.getCodePoint(Ft),xt,it,gt,Ne,ct)}return Pt/Math.max(1,Math.ceil(Pt/Ve))}(K,ie,ce,he,ye,Te),xe=K.text.indexOf("")>=0;let We=0;for(let et=0;et<K.length();et++){const Ne=K.getSection(et),Ve=K.getCodePoint(et);if(j2[Ve]||(We+=nN(Ve,Ne,he,ye,ie,Te)),et<K.length()-1){const it=!((qe=Ve)<11904||!(pn["Bopomofo Extended"](qe)||pn.Bopomofo(qe)||pn["CJK Compatibility Forms"](qe)||pn["CJK Compatibility Ideographs"](qe)||pn["CJK Compatibility"](qe)||pn["CJK Radicals Supplement"](qe)||pn["CJK Strokes"](qe)||pn["CJK Symbols and Punctuation"](qe)||pn["CJK Unified Ideographs Extension A"](qe)||pn["CJK Unified Ideographs"](qe)||pn["Enclosed CJK Letters and Months"](qe)||pn["Halfwidth and Fullwidth Forms"](qe)||pn.Hiragana(qe)||pn["Ideographic Description Characters"](qe)||pn["Kangxi Radicals"](qe)||pn["Katakana Phonetic Extensions"](qe)||pn.Katakana(qe)||pn["Vertical Forms"](qe)||pn["Yi Radicals"](qe)||pn["Yi Syllables"](qe)));(Mte[Ve]||it||Ne.imageName)&&we.push(iN(et+1,We,Ie,we,Tte(Ve,K.getCodePoint(et+1),it&&xe),!1))}}var qe;return rN(iN(K.length(),We,Ie,we,0,!0))}(z,b,h,t,l,P),{processBidirectionalText:j,processStyledBidirectionalText:Y}=Ds;if(j&&z.sections.length===1){const K=j(z.toString(),W);for(const ie of K){const ce=new lv;ce.text=ie,ce.sections=z.sections;for(let he=0;he<ie.length;he++)ce.sectionIndex.push(0);U.push(ce)}}else if(Y){const K=Y(z.text,z.sectionIndex,W);for(const ie of K){const ce=new lv;ce.text=ie[0],ce.sectionIndex=ie[1],ce.sections=z.sections,U.push(ce)}}else U=function(K,ie){const ce=[],he=K.text;let ye=0;for(const Te of ie)ce.push(K.substring(ye,Te)),ye=Te;return ye<he.length&&ce.push(K.substring(ye,he.length)),ce}(z,W);const Z=[],$={positionedLines:Z,text:z.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:A,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(K,ie,ce,he,ye,Te,we,Ie,xe,We,qe,et){let Ne=0,Ve=0,it=0;const gt=Ie==="right"?1:Ie==="left"?0:.5;let ct=!1;for(const on of ye){const rn=on.getSections();for(const cn of rn){if(cn.imageName)continue;const gn=ie[cn.fontStack];if(gn&&(ct=gn.ascender!==void 0&&gn.descender!==void 0,!ct))break}if(!ct)break}let Pt=0;for(const on of ye){on.trim();const rn=on.getMaxScale(),cn=(rn-1)*io,gn={positionedGlyphs:[],lineOffset:0};K.positionedLines[Pt]=gn;const kn=gn.positionedGlyphs;let ea=0;if(!on.length()){Ve+=Te,++Pt;continue}let ba=0,$n=0;for(let In=0;In<on.length();In++){const En=on.getSection(In),ha=on.getSectionIndex(In),Ma=on.getCodePoint(In);let Qn=En.scale,Xa=null,xi=null,oi=null,ei=io,rr=0;const wi=!(xe===bi.horizontal||!qe&&!Wy(Ma)||qe&&(j2[Ma]||(Ft=Ma,pn.Arabic(Ft)||pn["Arabic Supplement"](Ft)||pn["Arabic Extended-A"](Ft)||pn["Arabic Presentation Forms-A"](Ft)||pn["Arabic Presentation Forms-B"](Ft))));if(En.imageName){const Oi=he[En.imageName];if(!Oi)continue;oi=En.imageName,K.iconsInText=K.iconsInText||!0,xi=Oi.paddedRect;const Ya=Oi.displaySize;Qn=Qn*io/et,Xa={width:Ya[0],height:Ya[1],left:Ns,top:-QF,advance:wi?Ya[1]:Ya[0],localGlyph:!1},rr=ct?-Xa.height*Qn:tN+rn*io-Ya[1]*Qn,ei=Xa.advance;const fs=(wi?Ya[0]:Ya[1])*Qn-io*rn;fs>0&&fs>ea&&(ea=fs)}else{const Oi=ce[En.fontStack];if(!Oi)continue;Oi[Ma]&&(xi=Oi[Ma]);const Ya=ie[En.fontStack];if(!Ya)continue;const fs=Ya.glyphs[Ma];if(!fs)continue;if(Xa=fs.metrics,ei=Ma!==8203?io:0,ct){const Ku=Ya.ascender!==void 0?Math.abs(Ya.ascender):0,ah=Ya.descender!==void 0?Math.abs(Ya.descender):0,ih=(Ku+ah)*Qn;ba<ih&&(ba=ih,$n=(Ku-ah)/2*Qn),rr=-Ku*Qn}else rr=tN+(rn-Qn)*io}wi?(K.verticalizable=!0,kn.push({glyph:Ma,imageName:oi,x:Ne,y:Ve+rr,vertical:wi,scale:Qn,localGlyph:Xa.localGlyph,fontStack:En.fontStack,sectionIndex:ha,metrics:Xa,rect:xi}),Ne+=ei*Qn+We):(kn.push({glyph:Ma,imageName:oi,x:Ne,y:Ve+rr,vertical:wi,scale:Qn,localGlyph:Xa.localGlyph,fontStack:En.fontStack,sectionIndex:ha,metrics:Xa,rect:xi}),Ne+=Xa.advance*Qn+We)}kn.length!==0&&(it=Math.max(Ne-We,it),ct?oN(kn,gt,ea,$n,Te*rn/2):oN(kn,gt,ea,0,Te/2)),Ne=0;const Un=Te*rn+ea;gn.lineOffset=Math.max(ea,cn),Ve+=Un,++Pt}var Ft;const xt=Ve,{horizontalAlign:Mt,verticalAlign:en}=$2(we);(function(on,rn,cn,gn,kn,ea){const ba=(rn-cn)*kn,$n=-ea*gn;for(const Un of on)for(const In of Un.positionedGlyphs)In.x+=ba,In.y+=$n})(K.positionedLines,gt,Mt,en,it,xt),K.top+=-en*xt,K.bottom=K.top+xt,K.left+=-Mt*it,K.right=K.left+it,K.hasBaseline=ct}($,t,r,l,U,p,g,v,A,b,C,R),!function(K){for(const ie of K)if(ie.positionedGlyphs.length!==0)return!1;return!0}(Z)&&$}const j2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Mte={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function nN(i,t,r,l,u,h){if(t.imageName){const p=l[t.imageName];return p?p.displaySize[0]*t.scale*io/h+u:0}{const p=r[t.fontStack],g=p&&p.glyphs[i];return g?g.metrics.advance*t.scale+u:0}}function aN(i,t,r,l){const u=Math.pow(i-t,2);return l?i<t?u/2:2*u:u+Math.abs(r)*r}function Tte(i,t,r){let l=0;return i===10&&(l-=1e4),r&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function iN(i,t,r,l,u,h){let p=null,g=aN(t,r,u,h);for(const v of l){const b=aN(t-v.x,r,u,h)+v.badness;b<=g&&(p=v,g=b)}return{index:i,x:t,priorBreak:p,badness:g}}function rN(i){return i?rN(i.priorBreak).concat(i.index):[]}function $2(i){let t=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function oN(i,t,r,l,u){if(!(t||r||l||u))return;const h=i.length-1,p=i[h],g=(p.x+p.metrics.advance*p.scale)*t;for(let v=0;v<=h;v++)i[v].x-=g,i[v].y+=r+l+u}function Cte(i,t,r,l){const{horizontalAlign:u,verticalAlign:h}=$2(l),p=r[0]-i.displaySize[0]*u,g=r[1]-i.displaySize[1]*h;return{imagePrimary:i,imageSecondary:t,top:g,bottom:g+i.displaySize[1],left:p,right:p+i.displaySize[0]}}function sN(i,t,r,l,u,h){const p=i.imagePrimary;let g;if(p.content){const U=p.content,W=p.pixelRatio||1;g=[U[0]/W,U[1]/W,p.displaySize[0]-U[2]/W,p.displaySize[1]-U[3]/W]}const v=t.left*h,b=t.right*h;let w,A,C,P;r==="width"||r==="both"?(P=u[0]+v-l[3],A=u[0]+b+l[1]):(P=u[0]+(v+b-p.displaySize[0])/2,A=P+p.displaySize[0]);const R=t.top*h,z=t.bottom*h;return r==="height"||r==="both"?(w=u[1]+R-l[0],C=u[1]+z+l[2]):(w=u[1]+(R+z-p.displaySize[1])/2,C=w+p.displaySize[1]),{imagePrimary:p,imageSecondary:void 0,top:w,right:A,bottom:C,left:P,collisionPadding:g}}class nh extends V{constructor(t,r,l,u,h){super(t,r),this.angle=u,this.z=l,h!==void 0&&(this.segment=h)}clone(){return new nh(this.x,this.y,this.z,this.angle,this.segment)}}function lN(i,t,r,l,u){if(t.segment===void 0)return!0;let h=t,p=t.segment+1,g=0;for(;g>-r/2;){if(p--,p<0)return!1;g-=i[p].dist(h),h=i[p]}g+=i[p].dist(i[p+1]),p++;const v=[];let b=0;for(;g<r/2;){const w=i[p],A=i[p+1];if(!A)return!1;let C=i[p-1].angleTo(w)-w.angleTo(A);for(C=Math.abs((C+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:C}),b+=C;g-v[0].distance>l;)b-=v.shift().angleDelta;if(b>u)return!1;p++,g+=w.dist(A)}return!0}function cN(i){let t=0;for(let r=0;r<i.length-1;r++)t+=i[r].dist(i[r+1]);return t}function uN(i,t,r){return i?.6*t*r:0}function dN(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function Pte(i,t,r,l,u,h){const p=uN(r,u,h),g=dN(r,l)*h;let v=0;const b=cN(i)/2;for(let w=0;w<i.length-1;w++){const A=i[w],C=i[w+1],P=A.dist(C);if(v+P>b){const R=(b-v)/P,z=Ln(A.x,C.x,R),U=Ln(A.y,C.y,R),W=new nh(z,U,0,C.angleTo(A),w);return!p||lN(i,W,g,p,t)?W:void 0}v+=P}}function Ite(i,t,r,l,u,h,p,g,v){const b=uN(l,h,p),w=dN(l,u),A=w*p,C=i[0].x===0||i[0].x===v||i[0].y===0||i[0].y===v;return t-A<t/4&&(t=A+t/4),hN(i,C?t/2*g%t:(w/2+2*h)*p*g%t,t,b,r,A,C,!1,v)}function hN(i,t,r,l,u,h,p,g,v){const b=h/2,w=cN(i);let A=0,C=t-r,P=[];for(let R=0;R<i.length-1;R++){const z=i[R],U=i[R+1],W=z.dist(U),j=U.angleTo(z);for(;C+r<A+W;){C+=r;const Y=(C-A)/W,Z=Ln(z.x,U.x,Y),$=Ln(z.y,U.y,Y);if(Z>=0&&Z<v&&$>=0&&$<v&&C-b>=0&&C+b<=w){const K=new nh(Z,$,0,j,R);l&&!lN(i,K,h,l,u)||P.push(K)}}A+=W}return g||P.length||p||(P=hN(i,A/2,r,l,u,h,p,!0,v)),P}function fN(i,t,r,l,u){const h=[];for(let p=0;p<i.length;p++){const g=i[p];let v;for(let b=0;b<g.length-1;b++){let w=g[b],A=g[b+1];w.x<t&&A.x<t||(w.x<t?w=new V(t,w.y+(t-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x<t&&(A=new V(t,w.y+(t-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y<r&&A.y<r||(w.y<r?w=new V(w.x+(r-w.y)/(A.y-w.y)*(A.x-w.x),r)._round():A.y<r&&(A=new V(w.x+(r-w.y)/(A.y-w.y)*(A.x-w.x),r)._round()),w.x>=l&&A.x>=l||(w.x>=l?w=new V(l,w.y+(l-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x>=l&&(A=new V(l,w.y+(l-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y>=u&&A.y>=u||(w.y>=u?w=new V(w.x+(u-w.y)/(A.y-w.y)*(A.x-w.x),u)._round():A.y>=u&&(A=new V(w.x+(u-w.y)/(A.y-w.y)*(A.x-w.x),u)._round()),v&&w.equals(v[v.length-1])||(v=[w],h.push(v)),v.push(A)))))}}return h}un(nh,"Anchor");const d1=1e20;function pN(i,t,r,l,u,h,p,g,v){for(let b=t;b<t+l;b++)mN(i,r*h+b,h,u,p,g,v);for(let b=r;b<r+u;b++)mN(i,b*h+t,1,l,p,g,v)}function mN(i,t,r,l,u,h,p){h[0]=0,p[0]=-d1,p[1]=d1,u[0]=i[t];for(let g=1,v=0,b=0;g<l;g++){u[g]=i[t+g*r];const w=g*g;do{const A=h[v];b=(u[g]-u[A]+w-A*A)/(g-A)/2}while(b<=p[v]&&--v>-1);v++,h[v]=g,p[v]=b,p[v+1]=d1}for(let g=0,v=0;g<l;g++){for(;p[v+1]<g;)v++;const b=h[v],w=g-b;i[t+g*r]=u[b]+w*w}}const jc=2;class cv{constructor(t,r,l){this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=l,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,r){this.urls[r]=t}getGlyphs(t,r,l){const u=[],h=this.urls[r]||x.GLYPHS_URL;for(const p in t)for(const g of t[p])u.push({stack:p,id:g});Xe(u,({stack:p,id:g},v)=>{let b=this.entries[p];b||(b=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=b.glyphs[g];if(w!==void 0)return void v(null,{stack:p,id:g,glyph:w});if(w=this._tinySDF(b,p,g),w)return b.glyphs[g]=w,void v(null,{stack:p,id:g,glyph:w});const A=Math.floor(g/256);if(256*A>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[A])return void v(null,{stack:p,id:g,glyph:w});let C=b.requests[A];C||(C=b.requests[A]=[],cv.loadGlyphRange(p,A,h,this.requestManager,(P,R)=>{if(R){b.ascender=R.ascender,b.descender=R.descender;for(const z in R.glyphs)this._doesCharSupportLocalGlyph(+z)||(b.glyphs[+z]=R.glyphs[+z]);b.ranges[A]=!0}for(const z of C)z(P,R);delete b.requests[A]})),C.push((P,R)=>{P?v(P):R&&v(null,{stack:p,id:g,glyph:R.glyphs[g]||null})})},(p,g)=>{if(p)l(p);else if(g){const v={};for(const{stack:b,id:w,glyph:A}of g)v[b]===void 0&&(v[b]={}),v[b].glyphs===void 0&&(v[b].glyphs={}),v[b].glyphs[w]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;l(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(pn["CJK Unified Ideographs"](t)||pn["Hangul Syllables"](t)||pn.Hiragana(t)||pn.Katakana(t)||pn["CJK Symbols and Punctuation"](t)||pn["CJK Unified Ideographs Extension A"](t)||pn["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,r,l){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let h=t.tinySDF;if(!h){let z="400";/bold/i.test(r)?z="900":/medium/i.test(r)?z="500":/light/i.test(r)&&(z="200"),h=t.tinySDF=new cv.TinySDF({fontFamily:u,fontWeight:z,fontSize:24*jc,buffer:3*jc,radius:8*jc}),h.fontWeight=z}if(this.localGlyphs[h.fontWeight][l])return this.localGlyphs[h.fontWeight][l];const p=String.fromCodePoint(l),{data:g,width:v,height:b,glyphWidth:w,glyphHeight:A,glyphLeft:C,glyphTop:P,glyphAdvance:R}=h.draw(p);return this.localGlyphs[h.fontWeight][l]={id:l,bitmap:new eh({width:v,height:b},g),metrics:{width:w/jc,height:A/jc,left:C/jc,top:P/jc-27,advance:R/jc,localGlyph:!0}}}}cv.loadGlyphRange=function(i,t,r,l,u){const h=256*t,p=h+255,g=l.transformRequest(l.normalizeGlyphsURL(r).replace("{fontstack}",i).replace("{range}",`${h}-${p}`),Se.Glyphs);vt(g,(v,b)=>{if(v)u(v);else if(b){const w={},A=function(C){return new H2(C).readFields(Ste,{})}(b);for(const C of A.glyphs)w[C.id]=C;u(null,{glyphs:w,ascender:A.ascender,descender:A.descender})}})},cv.TinySDF=class{constructor({fontSize:i=24,buffer:t=3,radius:r=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:h="normal",fontStyle:p="normal"}={}){this.buffer=t,this.cutoff=l,this.radius=r;const g=this.size=i+4*t,v=this._createCanvas(g),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${p} ${h} ${i}px ${u}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(i){const t=document.createElement("canvas");return t.width=t.height=i,t}draw(i){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:h}=this.ctx.measureText(i),p=Math.ceil(r),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-u))),v=Math.min(this.size-this.buffer,p+Math.ceil(l)),b=g+2*this.buffer,w=v+2*this.buffer,A=Math.max(b*w,0),C=new Uint8ClampedArray(A),P={data:C,width:b,height:w,glyphWidth:g,glyphHeight:v,glyphTop:p,glyphLeft:0,glyphAdvance:t};if(g===0||v===0)return P;const{ctx:R,buffer:z,gridInner:U,gridOuter:W}=this;R.clearRect(z,z,g,v),R.fillText(i,z,z+p);const j=R.getImageData(z,z,g,v);W.fill(d1,0,A),U.fill(0,0,A);for(let Y=0;Y<v;Y++)for(let Z=0;Z<g;Z++){const $=j.data[4*(Y*g+Z)+3]/255;if($===0)continue;const K=(Y+z)*b+Z+z;if($===1)W[K]=0,U[K]=d1;else{const ie=.5-$;W[K]=ie>0?ie*ie:0,U[K]=ie<0?ie*ie:0}}pN(W,0,0,b,w,b,this.f,this.v,this.z),pN(U,z,z,g,v,b,this.f,this.v,this.z);for(let Y=0;Y<A;Y++){const Z=Math.sqrt(W[Y])-Math.sqrt(U[Y]);C[Y]=Math.round(255-255*(Z/this.radius+this.cutoff))}return P}};const wf=Ns;function gN(i,t,r,l){const u=[],h=i.imagePrimary,p=h.pixelRatio,g=h.paddedRect.w-2*wf,v=h.paddedRect.h-2*wf,b=i.right-i.left,w=i.bottom-i.top,A=h.stretchX||[[0,g]],C=h.stretchY||[[0,v]],P=(Te,we)=>Te+we[1]-we[0],R=A.reduce(P,0),z=C.reduce(P,0),U=g-R,W=v-z;let j=0,Y=R,Z=0,$=z,K=0,ie=U,ce=0,he=W;if(h.content&&l){const Te=h.content;j=q2(A,0,Te[0]),Z=q2(C,0,Te[1]),Y=q2(A,Te[0],Te[2]),$=q2(C,Te[1],Te[3]),K=Te[0]-j,ce=Te[1]-Z,ie=Te[2]-Te[0]-Y,he=Te[3]-Te[1]-$}const ye=(Te,we,Ie,xe)=>{const We=X2(Te.stretch-j,Y,b,i.left),qe=Y2(Te.fixed-K,ie,Te.stretch,R),et=X2(we.stretch-Z,$,w,i.top),Ne=Y2(we.fixed-ce,he,we.stretch,z),Ve=X2(Ie.stretch-j,Y,b,i.left),it=Y2(Ie.fixed-K,ie,Ie.stretch,R),gt=X2(xe.stretch-Z,$,w,i.top),ct=Y2(xe.fixed-ce,he,xe.stretch,z),Pt=new V(We,et),Ft=new V(Ve,et),xt=new V(Ve,gt),Mt=new V(We,gt),en=new V(qe/p,Ne/p),on=new V(it/p,ct/p),rn=t*Math.PI/180;if(rn){const $n=Math.sin(rn),Un=Math.cos(rn),In=[Un,-$n,$n,Un];Pt._matMult(In),Ft._matMult(In),Mt._matMult(In),xt._matMult(In)}const cn=Te.stretch+Te.fixed,gn=Ie.stretch+Ie.fixed,kn=we.stretch+we.fixed,ea=xe.stretch+xe.fixed,ba=i.imageSecondary;return{tl:Pt,tr:Ft,bl:Mt,br:xt,texPrimary:{x:h.paddedRect.x+wf+cn,y:h.paddedRect.y+wf+kn,w:gn-cn,h:ea-kn},texSecondary:ba?{x:ba.paddedRect.x+wf+cn,y:ba.paddedRect.y+wf+kn,w:gn-cn,h:ea-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:en,pixelOffsetBR:on,minFontScaleX:ie/p/b,minFontScaleY:he/p/w,isSDF:r}};if(l&&(h.stretchX||h.stretchY)){const Te=yN(A,U,R),we=yN(C,W,z);for(let Ie=0;Ie<Te.length-1;Ie++){const xe=Te[Ie],We=Te[Ie+1];for(let qe=0;qe<we.length-1;qe++)u.push(ye(xe,we[qe],We,we[qe+1]))}}else u.push(ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return u}function q2(i,t,r){let l=0;for(const u of i)l+=Math.max(t,Math.min(r,u[1]))-Math.max(t,Math.min(r,u[0]));return l}function yN(i,t,r){const l=[{fixed:-wf,stretch:0}];for(const[u,h]of i){const p=l[l.length-1];l.push({fixed:u-p.stretch,stretch:p.stretch}),l.push({fixed:u-p.stretch,stretch:p.stretch+(h-u)})}return l.push({fixed:t+wf,stretch:r}),l}function X2(i,t,r,l){return i/t*r+l}function Y2(i,t,r,l){return i-t*r/l}function Lte(i,t,r,l){const u=t+i.positionedLines[l].lineOffset;return l===0?r+u/2:r+(u+(t+i.positionedLines[l-1].lineOffset))/2}function Rte(i,t=1,r=!1){let l=1/0,u=1/0,h=-1/0,p=-1/0;const g=i[0];for(let P=0;P<g.length;P++){const R=g[P];(!P||R.x<l)&&(l=R.x),(!P||R.y<u)&&(u=R.y),(!P||R.x>h)&&(h=R.x),(!P||R.y>p)&&(p=R.y)}const v=Math.min(h-l,p-u);let b=v/2;const w=new Ld([],kte);if(v===0)return new V(l,u);for(let P=l;P<h;P+=v)for(let R=u;R<p;R+=v)w.push(new uv(P+b,R+b,b,i));let A=function(P){let R=0,z=0,U=0;const W=P[0];for(let j=0,Y=W.length,Z=Y-1;j<Y;Z=j++){const $=W[j],K=W[Z],ie=$.x*K.y-K.x*$.y;z+=($.x+K.x)*ie,U+=($.y+K.y)*ie,R+=3*ie}return new uv(z/R,U/R,0,P)}(i),C=w.length;for(;w.length;){const P=w.pop();(P.d>A.d||!A.d)&&(A=P,r&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,C)),P.max-A.d<=t||(b=P.h/2,w.push(new uv(P.p.x-b,P.p.y-b,b,i)),w.push(new uv(P.p.x+b,P.p.y-b,b,i)),w.push(new uv(P.p.x-b,P.p.y+b,b,i)),w.push(new uv(P.p.x+b,P.p.y+b,b,i)),C+=4)}return r&&(console.log(`num probes: ${C}`),console.log(`best distance: ${A.d}`)),A.p}function kte(i,t){return t.max-i.max}class uv{constructor(t,r,l,u){this.p=new V(t,r),this.h=l,this.d=function(h,p){let g=!1,v=1/0;for(let b=0;b<p.length;b++){const w=p[b];for(let A=0,C=w.length,P=C-1;A<C;P=A++){const R=w[A],z=w[P];R.y>h.y!=z.y>h.y&&h.x<(z.x-R.x)*(h.y-R.y)/(z.y-R.y)+R.x&&(g=!g),v=Math.min(v,yF(h,R,z))}}return(g?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const dv=7,CP=Number.POSITIVE_INFINITY,Dte=Math.sqrt(2);function PP(i,[t,r]){let l=0,u=0;if(r===CP){t<0&&(t=0);const h=t/Dte;switch(i){case"top-right":case"top-left":u=h-dv;break;case"bottom-right":case"bottom-left":u=-h+dv;break;case"bottom":u=-t+dv;break;case"top":u=t-dv}switch(i){case"top-right":case"bottom-right":l=-h;break;case"top-left":case"bottom-left":l=h;break;case"left":l=t;break;case"right":l=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),i){case"top-right":case"top-left":case"top":u=r-dv;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+dv}switch(i){case"top-right":case"bottom-right":case"right":l=-t;break;case"top-left":case"bottom-left":case"left":l=t}}return[l,u]}function Ote(i,t,r,l,u,h,p,g,v,b,w){i.createArrays(),i.tilePixelRatio=ht/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const A=i.layers[0].layout,C=i.layers[0]._unevaluatedLayout._values,P={};if(i.textSizeData.kind==="composite"){const{minZoom:W,maxZoom:j}=i.textSizeData;P.compositeTextSizes=[C["text-size"].possiblyEvaluate(new ri(W),g),C["text-size"].possiblyEvaluate(new ri(j),g)]}if(i.iconSizeData.kind==="composite"){const{minZoom:W,maxZoom:j}=i.iconSizeData;P.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new ri(W),g),C["icon-size"].possiblyEvaluate(new ri(j),g)]}P.layoutTextSize=C["text-size"].possiblyEvaluate(new ri(v+1),g),P.layoutIconSize=C["icon-size"].possiblyEvaluate(new ri(v+1),g),P.textMaxSize=C["text-size"].possiblyEvaluate(new ri(18),g);const R=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",z=A.get("text-size");let U=!1;for(const W of i.features)if(W.icon&&W.icon.nameSecondary){U=!0;break}for(const W of i.features){const j=A.get("text-font").evaluate(W,{},g).join(","),Y=z.evaluate(W,{},g),Z=P.layoutTextSize.evaluate(W,{},g),$=(P.layoutIconSize.evaluate(W,{},g),{horizontal:{},vertical:void 0}),K=W.text;let ie,ce=[0,0];if(K){const Te=K.toString(),we=A.get("text-letter-spacing").evaluate(W,{},g)*io,Ie=A.get("text-line-height").evaluate(W,{},g)*io,xe=Hd(Te)?we:0,We=A.get("text-anchor").evaluate(W,{},g),qe=A.get("text-variable-anchor");if(!qe){const gt=A.get("text-radial-offset").evaluate(W,{},g);ce=gt?PP(We,[gt*io,CP]):A.get("text-offset").evaluate(W,{},g).map(ct=>ct*io)}let et=R?"center":A.get("text-justify").evaluate(W,{},g);const Ne=A.get("symbol-placement")==="point",Ve=Ne?A.get("text-max-width").evaluate(W,{},g)*io:1/0,it=gt=>{i.allowVerticalPlacement&&hm(Te)&&($.vertical=TP(K,t,r,u,j,Ve,Ie,We,gt,xe,ce,bi.vertical,!0,Z,Y))};if(!R&&qe){const gt=et==="auto"?qe.map(Pt=>IP(Pt)):[et];let ct=!1;for(let Pt=0;Pt<gt.length;Pt++){const Ft=gt[Pt];if(!$.horizontal[Ft])if(ct)$.horizontal[Ft]=$.horizontal[0];else{const xt=TP(K,t,r,u,j,Ve,Ie,"center",Ft,xe,ce,bi.horizontal,!1,Z,Y);xt&&($.horizontal[Ft]=xt,ct=xt.positionedLines.length===1)}}it("left")}else{if(et==="auto"&&(et=IP(We)),Ne||A.get("text-writing-mode").indexOf("horizontal")>=0||!hm(Te)){const gt=TP(K,t,r,u,j,Ve,Ie,We,et,xe,ce,bi.horizontal,!1,Z,Y);gt&&($.horizontal[et]=gt)}it(Ne?"left":et)}}let he=!1;if(W.icon&&W.icon.namePrimary){const Te=l[W.icon.namePrimary];Te&&(ie=Cte(u[W.icon.namePrimary],W.icon.nameSecondary?u[W.icon.nameSecondary]:void 0,A.get("icon-offset").evaluate(W,{},g),A.get("icon-anchor").evaluate(W,{},g)),he=Te.sdf,i.sdfIcons===void 0?i.sdfIcons=Te.sdf:i.sdfIcons!==Te.sdf&&ve("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Te.pixelRatio!==i.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const ye=_N($.horizontal)||$.vertical;i.iconsInText||(i.iconsInText=!!ye&&ye.iconsInText),(ye||ie)&&zte(i,W,$,ie,l,P,Z,0,ce,he,p,g,b,w,U)}h&&i.generateCollisionDebugBuffers(v,i.collisionBoxArray)}function IP(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function zte(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R){let z=h.textMaxSize.evaluate(t,{},A);z===void 0&&(z=p);const U=i.layers[0].layout,W=U.get("icon-offset").evaluate(t,{},A),j=_N(r.horizontal)||r.vertical,Y=C.name==="globe",Z=io,$=p/Z,K=i.tilePixelRatio*z/Z,ie=(We=i.overscaling,i.zoom>18&&We>2&&(We>>=1),Math.max(ht/(512*We),1)*U.get("symbol-spacing")),ce=U.get("text-padding")*i.tilePixelRatio,he=U.get("icon-padding")*i.tilePixelRatio,ye=be(U.get("text-max-angle")),Te=U.get("text-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",we=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Ie=U.get("symbol-placement"),xe=ie/2;var We;const qe=U.get("icon-text-fit").evaluate(t,{},A),et=U.get("icon-text-fit-padding").evaluate(t,{},A),Ne=qe!=="none";let Ve;i.hasAnyIconTextFit===!1&&Ne&&(i.hasAnyIconTextFit=!0),l&&Ne&&(i.allowVerticalPlacement&&r.vertical&&(Ve=sN(l,r.vertical,qe,et,W,$)),j&&(l=sN(l,j,qe,et,W,$)));const it=(gt,ct,Pt)=>{if(ct.x<0||ct.x>=ht||ct.y<0||ct.y>=ht)return;let Ft=null;if(Y){const{x:xt,y:Mt,z:en}=C.projectTilePoint(ct.x,ct.y,Pt);Ft={anchor:new nh(xt,Mt,en,0,void 0),up:C.upVector(Pt,ct.x,ct.y)}}(function(xt,Mt,en,on,rn,cn,gn,kn,ea,ba,$n,Un,In,En,ha,Ma,Qn,Xa,xi,oi,ei,rr,wi,Oi,Ya,fs,Ku){const ah=xt.addToLineVertexArray(Mt,on);let ih,O1,z1,G3,E9,M9,T9,C9=0,P9=0,I9=0,L9=0,I5=-1,L5=-1;const Ju={};let R9=CC("");const Pm=en?en.anchor:Mt,R5=ea.layout.get("icon-text-fit").evaluate(ei,{},Ya)!=="none";let k5=0,D5=0;if(ea._unevaluatedLayout.getValue("text-radial-offset")===void 0?[k5,D5]=ea.layout.get("text-offset").evaluate(ei,{},Ya).map(ll=>ll*io):(k5=ea.layout.get("text-radial-offset").evaluate(ei,{},Ya)*io,D5=CP),xt.allowVerticalPlacement&&rn.vertical){const ll=rn.vertical;if(ha)M9=LP(ll),kn&&(T9=LP(kn));else{const cl=ea.layout.get("text-rotate").evaluate(ei,{},Ya)+90;z1=Z2(ba,Pm,Mt,$n,Un,In,ll,En,cl,Ma),kn&&(G3=Z2(ba,Pm,Mt,$n,Un,In,kn,Xa,cl))}}if(cn){const ll=ea.layout.get("icon-rotate").evaluate(ei,{},Ya),cl=gN(cn,ll,wi,R5),wv=kn?gN(kn,ll,wi,R5):void 0;O1=Z2(ba,Pm,Mt,$n,Un,In,cn,Xa,ll),C9=4*cl.length;const k9=xt.iconSizeData;let Im=null;k9.kind==="source"?(Im=[Hc*ea.layout.get("icon-size").evaluate(ei,{},Ya)],Im[0]>Sf&&ve(`${xt.layerIds[0]}: Value for "icon-size" is >= ${h1}. Reduce your "icon-size".`)):k9.kind==="composite"&&(Im=[Hc*rr.compositeIconSizes[0].evaluate(ei,{},Ya),Hc*rr.compositeIconSizes[1].evaluate(ei,{},Ya)],(Im[0]>Sf||Im[1]>Sf)&&ve(`${xt.layerIds[0]}: Value for "icon-size" is >= ${h1}. Reduce your "icon-size".`)),xt.addSymbols(xt.icon,cl,Im,oi,xi,ei,!1,en,Mt,ah.lineStartIndex,ah.lineLength,-1,Oi,Ya,fs,Ku),I5=xt.icon.placedSymbolArray.length-1,wv&&(P9=4*wv.length,xt.addSymbols(xt.icon,wv,Im,oi,xi,ei,bi.vertical,en,Mt,ah.lineStartIndex,ah.lineLength,-1,Oi,Ya,fs,Ku),L5=xt.icon.placedSymbolArray.length-1)}for(const ll in rn.horizontal){const cl=rn.horizontal[ll];ih||(R9=CC(cl.text),ha?E9=LP(cl):ih=Z2(ba,Pm,Mt,$n,Un,In,cl,En,ea.layout.get("text-rotate").evaluate(ei,{},Ya),Ma));const wv=cl.positionedLines.length===1;if(I9+=vN(xt,en,Mt,cl,gn,ea,ha,ei,Ma,ah,rn.vertical?bi.horizontal:bi.horizontalOnly,wv?Object.keys(rn.horizontal):[ll],Ju,I5,rr,Oi,Ya,fs),wv)break}rn.vertical&&(L9+=vN(xt,en,Mt,rn.vertical,gn,ea,ha,ei,Ma,ah,bi.vertical,["vertical"],Ju,L5,rr,Oi,Ya,fs));let Lf=-1;const O5=(ll,cl)=>ll?Math.max(ll,cl):cl;Lf=O5(E9,Lf),Lf=O5(M9,Lf),Lf=O5(T9,Lf);const voe=Lf>-1?1:0;xt.glyphOffsetArray.length>=y1.MAX_GLYPHS&&ve("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ei.sortKey!==void 0&&xt.addToSortKeyRanges(xt.symbolInstances.length,ei.sortKey),xt.symbolInstances.emplaceBack(Mt.x,Mt.y,Pm.x,Pm.y,Pm.z,Ju.right>=0?Ju.right:-1,Ju.center>=0?Ju.center:-1,Ju.left>=0?Ju.left:-1,Ju.vertical>=0?Ju.vertical:-1,I5,L5,R9,ih!==void 0?ih:xt.collisionBoxArray.length,ih!==void 0?ih+1:xt.collisionBoxArray.length,z1!==void 0?z1:xt.collisionBoxArray.length,z1!==void 0?z1+1:xt.collisionBoxArray.length,O1!==void 0?O1:xt.collisionBoxArray.length,O1!==void 0?O1+1:xt.collisionBoxArray.length,G3||xt.collisionBoxArray.length,G3?G3+1:xt.collisionBoxArray.length,$n,I9,L9,C9,P9,voe,0,k5,D5,Lf,0,R5?1:0)})(i,ct,Ft,gt,r,l,u,Ve,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,ce,Te,v,0,he,we,W,t,h,b,w,A,P,R)};if(Ie==="line")for(const gt of fN(t.geometry,0,0,ht,ht)){const ct=Ite(gt,ie,ye,r.vertical||j,l,Z,K,i.overscaling,ht);for(const Pt of ct)j&&Fte(i,j.text,xe,Pt)||it(gt,Pt,A)}else if(Ie==="line-center"){for(const gt of t.geometry)if(gt.length>1){const ct=Pte(gt,ye,r.vertical||j,l,Z,K);ct&&it(gt,ct,A)}}else if(t.type==="Polygon")for(const gt of mP(t.geometry,0)){const ct=Rte(gt,16);it(gt[0],new nh(ct.x,ct.y,0,0,void 0),A)}else if(t.type==="LineString")for(const gt of t.geometry)it(gt,new nh(gt[0].x,gt[0].y,0,0,void 0),A);else if(t.type==="Point")for(const gt of t.geometry)for(const ct of gt)it([ct],new nh(ct.x,ct.y,0,0,void 0),A)}const h1=255,Sf=h1*Hc;function vN(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W){const j=function($,K,ie,ce,he,ye,Te,we){const Ie=[];if(K.positionedLines.length===0)return Ie;const xe=ce.layout.get("text-rotate").evaluate(ye,{})*Math.PI/180,We=function(it){const gt=it[0],ct=it[1],Pt=gt*ct;return Pt>0?[gt,-ct]:Pt<0?[-gt,ct]:gt===0?[ct,gt]:[ct,-gt]}(ie);let qe=Math.abs(K.top-K.bottom);for(const it of K.positionedLines)qe-=it.lineOffset;const et=K.positionedLines.length,Ne=qe/et;let Ve=K.top-ie[1];for(let it=0;it<et;++it){const gt=K.positionedLines[it];Ve=Lte(K,Ne,Ve,it);for(const ct of gt.positionedGlyphs){if(!ct.rect)continue;const Pt=ct.rect||{};let Ft=QF+1,xt=!0,Mt=1,en=0;if(ct.imageName){const oi=Te[ct.imageName];if(!oi)continue;if(oi.sdf){ve("SDF images are not supported in formatted text and will be ignored.");continue}xt=!1,Mt=oi.pixelRatio,Ft=Ns/Mt}const on=(he||we)&&ct.vertical,rn=ct.metrics.advance*ct.scale/2,cn=ct.metrics,gn=ct.rect;if(gn===null)continue;we&&K.verticalizable&&(en=ct.imageName?rn-ct.metrics.width*ct.scale/2:0);const kn=he?[ct.x+rn,ct.y]:[0,0];let ea=[0,0],ba=[0,0],$n=!1;he||(on?(ba=[ct.x+rn+We[0],ct.y+We[1]-en],$n=!0):ea=[ct.x+rn+ie[0],ct.y+ie[1]-en]);const Un=gn.w*ct.scale/(Mt*(ct.localGlyph?jc:1)),In=gn.h*ct.scale/(Mt*(ct.localGlyph?jc:1));let En,ha,Ma,Qn;if(on){const oi=ct.y-Ve,ei=new V(-rn,rn-oi),rr=-Math.PI/2,wi=new V(...ba);En=new V(-rn+ea[0],ea[1]),En._rotateAround(rr,ei)._add(wi),En.x+=-oi+rn,En.y-=(cn.left-Ft)*ct.scale;const Oi=ct.imageName?cn.advance*ct.scale:io*ct.scale,Ya=String.fromCodePoint(ct.glyph);xte(Ya)?En.x+=(1-Ft)*ct.scale:wte(Ya)?En.x+=Oi-cn.height*ct.scale+(-Ft-1)*ct.scale:En.x+=ct.imageName||cn.width+2*Ft===gn.w&&cn.height+2*Ft===gn.h?(Oi-In)/2:(Oi-(cn.height+2*Ft)*ct.scale)/2,ha=new V(En.x,En.y-Un),Ma=new V(En.x+In,En.y),Qn=new V(En.x+In,En.y-Un)}else{const oi=(cn.left-Ft)*ct.scale-rn+ea[0],ei=(-cn.top-Ft)*ct.scale+ea[1],rr=oi+Un,wi=ei+In;En=new V(oi,ei),ha=new V(rr,ei),Ma=new V(oi,wi),Qn=new V(rr,wi)}if(xe){let oi;oi=he?new V(0,0):$n?new V(We[0],We[1]):new V(ie[0],ie[1]),En._rotateAround(xe,oi),ha._rotateAround(xe,oi),Ma._rotateAround(xe,oi),Qn._rotateAround(xe,oi)}const Xa=new V(0,0),xi=new V(0,0);Ie.push({tl:En,tr:ha,bl:Ma,br:Qn,texPrimary:Pt,texSecondary:void 0,writingMode:K.writingMode,glyphOffset:kn,sectionIndex:ct.sectionIndex,isSDF:xt,pixelOffsetTL:Xa,pixelOffsetBR:xi,minFontScaleX:0,minFontScaleY:0})}}return Ie}(0,l,v,h,p,g,u,i.allowVerticalPlacement),Y=i.textSizeData;let Z=null;Y.kind==="source"?(Z=[Hc*h.layout.get("text-size").evaluate(g,{},U)],Z[0]>Sf&&ve(`${i.layerIds[0]}: Value for "text-size" is >= ${h1}. Reduce your "text-size".`)):Y.kind==="composite"&&(Z=[Hc*R.compositeTextSizes[0].evaluate(g,{},U),Hc*R.compositeTextSizes[1].evaluate(g,{},U)],(Z[0]>Sf||Z[1]>Sf)&&ve(`${i.layerIds[0]}: Value for "text-size" is >= ${h1}. Reduce your "text-size".`)),i.addSymbols(i.text,j,Z,v,p,g,w,t,r,b.lineStartIndex,b.lineLength,P,z,U,W,!1);for(const $ of A)C[$]=i.text.placedSymbolArray.length-1;return 4*j.length}function _N(i){for(const t in i)return i[t];return null}function Z2(i,t,r,l,u,h,p,g,v,b){let w=p.top,A=p.bottom,C=p.left,P=p.right;const R=p.collisionPadding;if(R&&(C-=R[0],w-=R[1],P+=R[2],A+=R[3]),v){const z=new V(C,w),U=new V(P,w),W=new V(C,A),j=new V(P,A),Y=be(v);let Z=new V(0,0);b&&(Z=new V(b[0],b[1])),z._rotateAround(Y,Z),U._rotateAround(Y,Z),W._rotateAround(Y,Z),j._rotateAround(Y,Z),C=Math.min(z.x,U.x,W.x,j.x),P=Math.max(z.x,U.x,W.x,j.x),w=Math.min(z.y,U.y,W.y,j.y),A=Math.max(z.y,U.y,W.y,j.y)}return i.emplaceBack(t.x,t.y,t.z,r.x,r.y,C,w,P,A,g,l,u,h),i.length-1}function LP(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const t=i.bottom-i.top;return t>0?Math.max(10,t):null}function Fte(i,t,r,l){const u=i.compareText;if(t in u){const h=u[t];for(let p=h.length-1;p>=0;p--)if(l.dist(h[p])<r)return!0}else u[t]=[];return u[t].push(l),!1}function bN(i,t){const r=i.fovAboveCenter,l=i.elevation?i.elevation.getMinElevationBelowMSL()*t:0,u=(i._camera.position[2]*i.worldSize-l)/Math.cos(i._pitch),h=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-i._pitch-r,.01)),p=Math.sin(i._pitch)*h+u;return Math.min(1.01*p,u*(1/i._horizonShift))}function xm(i,t){if(!t.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:t};const r=Math.pow(2,-i.z),l=i.x*r,u=(i.x+1)*r,h=i.y*r,p=(i.y+1)*r,g=ol(l),v=ol(u),b=gr(h),w=gr(p),A=t.project(g,b),C=t.project(v,b),P=t.project(v,w),R=t.project(g,w);let z=Math.min(A.x,C.x,P.x,R.x),U=Math.min(A.y,C.y,P.y,R.y),W=Math.max(A.x,C.x,P.x,R.x),j=Math.max(A.y,C.y,P.y,R.y);const Y=r/16;function Z(K,ie,ce,he,ye,Te){const we=(ce+ye)/2,Ie=(he+Te)/2,xe=t.project(ol(we),gr(Ie)),We=Math.max(0,z-xe.x,U-xe.y,xe.x-W,xe.y-j);z=Math.min(z,xe.x),W=Math.max(W,xe.x),U=Math.min(U,xe.y),j=Math.max(j,xe.y),We>Y&&(Z(K,xe,ce,he,we,Ie),Z(xe,ie,we,Ie,ye,Te))}Z(A,C,l,h,u,h),Z(C,P,u,h,u,p),Z(P,R,u,p,l,p),Z(R,A,l,p,l,h),z-=Y,U-=Y,W+=Y,j+=Y;const $=1/Math.max(W-z,j-U);return{scale:$,x:z*$,y:U*$,x2:W*$,y2:j*$,projection:t}}function xN(i,t,r,l,u,h,p,g,v){if(v.name==="globe")return KC(i,t,new Vu(r,l,u),!1);const b=xm({z:r,x:l,y:u},v);return new hi([(h+b.x/b.scale)*t,t*(b.y/b.scale),p],[(h+b.x2/b.scale)*t,t*(b.y2/b.scale),g])}function wN(i,{x:t,y:r},l=0){return new V(((t-l)*i.scale-i.x)*ht,(r*i.scale-i.y)*ht)}function SN(i,t,r=0){return ke.fromValues(((t.x-r)*i.scale-i.x)*ht,(t.y*i.scale-i.y)*ht,dF(t.z,t.y))}const Nte=at.identity(new Float32Array(16));class Af{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,r){return{x:0,y:0,z:0}}unproject(t,r){return new On(0,0)}projectTilePoint(t,r,l){return{x:t,y:r,z:0}}locationPoint(t,r,l=!0){return t._coordinatePoint(t.locationCoordinate(r),l)}pixelsPerMeter(t,r){return $a(1,t)*r}pixelSpaceConversion(t,r,l){return 1}farthestPixelDistance(t){return bN(t,t.pixelsPerMeter)}pointCoordinate(t,r,l,u){const h=t.horizonLineFromTop(!1),p=new V(r,Math.max(h,l));return t.rayIntersectionCoordinate(t.pointRayIntersection(p,u))}pointCoordinate3D(t,r,l){const u=new V(r,l);if(t.elevation)return t.elevation.pointCoordinate(u);{const h=this.pointCoordinate(t,u.x,u.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(t,r){if(t.elevation)return!this.pointCoordinate3D(t,r.x,r.y);const l=t.horizonLineFromTop();return r.y<l}createInversionMatrix(t,r){return Nte}createTileMatrix(t,r,l){let u,h,p;const g=l.canonical,v=at.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=xm(g,this);u=1,h=b.x+l.wrap*b.scale,p=b.y,at.scale(v,v,[u/b.scale,u/b.scale,t.pixelsPerMeter/r])}else u=r/t.zoomScale(g.z),h=(g.x+Math.pow(2,g.z)*l.wrap)*u,p=g.y*u;return at.translate(v,v,[h,p,0]),at.scale(v,v,[u/ht,u/ht,1]),v}upVector(t,r,l){return[0,0,1]}upVectorScale(t,r,l){return{metersToTile:1}}}class Bte extends Af{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[r,l]=this.parallels=t.parallels||[29.5,45.5],u=Math.sin(be(r));this.n=(u+Math.sin(be(l)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(t,r){const{n:l,c:u,r0:h}=this,p=be(t-this.center[0]),g=be(r),v=Math.sqrt(u-2*l*Math.sin(g))/l;return{x:v*Math.sin(p*l),y:v*Math.cos(p*l)-h,z:0}}unproject(t,r){const{n:l,c:u,r0:h}=this,p=h+r;let g=Math.atan2(t,Math.abs(p))*Math.sign(p);p*l<0&&(g-=Math.PI*Math.sign(t)*Math.sign(p));const v=be(this.center[0])*l;g=Ze(g,-Math.PI-v,Math.PI-v);const b=ae(fe(g/l)+this.center[0],-180,180),w=Math.asin(ae((u-(t*t+p*p)*l*l)/(2*l),-1,1)),A=ae(fe(w),-$i,$i);return new On(b,A)}}const f1=1.340264,p1=-.081106,m1=893e-6,g1=.003796,K2=Math.sqrt(3)/2;class Ute extends Af{project(t,r){r=r/180*Math.PI,t=t/180*Math.PI;const l=Math.asin(K2*Math.sin(r)),u=l*l,h=u*u*u;return{x:.5*(t*Math.cos(l)/(K2*(f1+3*p1*u+h*(7*m1+9*g1*u)))/Math.PI+.5),y:1-.5*(l*(f1+p1*u+h*(m1+g1*u))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let l=r=(2*(1-r)-1)*Math.PI,u=l*l,h=u*u*u;for(let w,A,C,P=0;P<12&&(A=l*(f1+p1*u+h*(m1+g1*u))-r,C=f1+3*p1*u+h*(7*m1+9*g1*u),w=A/C,l=ae(l-w,-Math.PI/3,Math.PI/3),u=l*l,h=u*u*u,!(Math.abs(w)<1e-12));++P);const p=K2*t*(f1+3*p1*u+h*(7*m1+9*g1*u))/Math.cos(l),g=Math.asin(Math.sin(l)/K2),v=ae(180*p/Math.PI,-180,180),b=ae(180*g/Math.PI,-$i,$i);return new On(v,b)}}class Wte extends Af{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){return{x:.5+t/360,y:.5-r/360,z:0}}unproject(t,r){const l=360*(t-.5),u=ae(360*(.5-r),-$i,$i);return new On(l,u)}}const hv=Math.PI/2;function J2(i){return Math.tan((hv+i)/2)}class Vte extends Af{constructor(t){super(t),this.center=t.center||[0,30];const[r,l]=this.parallels=t.parallels||[30,30];let u=be(r),h=be(l);this.southernCenter=u+h<0,this.southernCenter&&(u=-u,h=-h);const p=Math.cos(u),g=J2(u);this.n=u===h?Math.sin(u):Math.log(p/Math.cos(h))/Math.log(J2(h)/g),this.f=p*Math.pow(J2(u),this.n)/this.n}project(t,r){r=be(r),this.southernCenter&&(r=-r),t=be(t-this.center[0]);const l=1e-6,{n:u,f:h}=this;h>0?r<-hv+l&&(r=-hv+l):r>hv-l&&(r=hv-l);const p=h/Math.pow(J2(r),u);let g=p*Math.sin(u*t),v=h-p*Math.cos(u*t);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(t,r){t=(2*t-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:l,f:u}=this,h=u-r,p=Math.sign(h),g=Math.sign(l)*Math.sqrt(t*t+h*h);let v=Math.atan2(t,Math.abs(h))*p;h*l<0&&(v-=Math.PI*Math.sign(t)*p);const b=ae(fe(v/l)+this.center[0],-180,180),w=ae(fe(2*Math.atan(Math.pow(u/g,1/l))-hv),-$i,$i);return new On(b,this.southernCenter?-w:w)}}class AN extends Af{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,r){return{x:_o(t),y:Co(r),z:0}}unproject(t,r){const l=ol(t),u=gr(r);return new On(l,u)}}const EN=be($i);class Gte extends Af{project(t,r){const l=(r=be(r))*r,u=l*l;return{x:.5*((t=be(t))*(.8707-.131979*l+u*(u*(.003971*l-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+l*(.015085+u*(.028874*l-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let l=r=(2*(1-r)-1)*Math.PI,u=25,h=0,p=l*l;do{p=l*l;const b=p*p;h=(l*(1.007226+p*(.015085+b*(.028874*p-.044475-.005916*b)))-r)/(1.007226+p*(.045255+b*(.259866*p-.311325-.005916*11*b))),l=ae(l-h,-EN,EN)}while(Math.abs(h)>1e-6&&--u>0);p=l*l;const g=ae(fe(t/(.8707+p*(p*(p*p*p*(.003971-.001529*p)-.013791)-.131979))),-180,180),v=fe(l);return new On(g,v)}}const MN=be($i);class Hte extends Af{project(t,r){r=be(r),t=be(t);const l=Math.cos(r),u=2/Math.PI,h=Math.acos(l*Math.cos(t/2)),p=Math.sin(h)/h,g=.5*(t*u+2*l*Math.sin(t/2)/p)||0,v=.5*(r+Math.sin(r)/p)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(t,r){let l=t=(2*t-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,h=25;const p=1e-6;let g=0,v=0;do{const b=Math.cos(u),w=Math.sin(u),A=2*w*b,C=w*w,P=b*b,R=Math.cos(l/2),z=Math.sin(l/2),U=2*R*z,W=z*z,j=1-P*R*R,Y=j?1/j:0,Z=j?Math.acos(b*R)*Math.sqrt(1/j):0,$=.5*(2*Z*b*z+2*l/Math.PI)-t,K=.5*(Z*w+u)-r,ie=.5*Y*(P*W+Z*b*R*C)+1/Math.PI,ce=Y*(U*A/4-Z*w*z),he=.125*Y*(A*z-Z*w*P*U),ye=.5*Y*(C*R+Z*W*b)+.5,Te=ce*he-ye*ie;g=(K*ce-$*ye)/Te,v=($*he-K*ie)/Te,l=ae(l-g,-Math.PI,Math.PI),u=ae(u-v,-MN,MN)}while((Math.abs(g)>p||Math.abs(v)>p)&&--h>0);return new On(fe(l),fe(u))}}class TN extends Af{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(be(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){const{scale:l,cosPhi:u}=this;return{x:be(t)*u*l+.5,y:-Math.sin(be(r))/u*l+.5,z:0}}unproject(t,r){const{scale:l,cosPhi:u}=this,h=-(r-.5)/l,p=ae(fe((t-.5)/l)/u,-180,180),g=Math.asin(ae(h*u,-1,1)),v=ae(fe(g),-$i,$i);return new On(p,v)}}class jte extends AN{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,r,l){const u=a1(t,r,l),h=vm(pc(l));return ke.transformMat4(u,u,h),{x:u[0],y:u[1],z:u[2]}}locationPoint(t,r){const l=Fs(r.lat,r.lng),u=ke.normalize([],l),h=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(r),t._centerAltitude):t._centerAltitude,p=$a(1,0)*ht*h;ke.scaleAndAdd(l,l,u,p);const g=at.identity(new Float64Array(16));return at.multiply(g,t.pixelMatrix,t.globeMatrix),ke.transformMat4(l,l,g),new V(l[0],l[1])}pixelsPerMeter(t,r){return $a(1,0)*r}pixelSpaceConversion(t,r,l){const u=$a(1,t)*r,h=Ln($a(1,45)*r,u,l);return this.pixelsPerMeter(t,r)/h}createTileMatrix(t,r,l){const u=QC(pc(l.canonical));return at.multiply(new Float64Array(16),t.globeMatrix,u)}createInversionMatrix(t,r){const{center:l}=t,u=vm(pc(r));return at.rotateY(u,u,be(l.lng)),at.rotateX(u,u,be(l.lat)),at.scale(u,u,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(t,r,l,u){return eF(t,r,l,!0)||new ga(0,0)}pointCoordinate3D(t,r,l){const u=this.pointCoordinate(t,r,l,0);return[u.x,u.y,u.z]}isPointAboveHorizon(t,r){return!eF(t,r.x,r.y,!1)}farthestPixelDistance(t){const r=function(u,h){const p=u.cameraToCenterDistance,g=u._centerAltitude*h,v=u._camera,b=u._camera.forward(),w=ke.add([],ke.scale([],b,-p),[0,0,g]),A=u.worldSize/(2*Math.PI),C=[0,0,-A],P=u.width/u.height,R=Math.tan(u.fovAboveCenter),z=ke.scale([],v.up(),R),U=ke.scale([],v.right(),R*P),W=ke.normalize([],ke.add([],ke.add([],b,z),U)),j=[];let Y;if(new S2(w,W).closestPointOnSphere(C,A,j)){const Z=ke.add([],j,C),$=ke.sub([],Z,w);Y=Math.cos(u.fovAboveCenter)*ke.length($)}else{const Z=ke.sub([],w,C),$=ke.sub([],C,w);ke.normalize($,$);const K=ke.length(Z)-A;Y=Math.sqrt(K*(K+2*A));const ie=Math.acos(Y/(A+K))-Math.acos(ke.dot(b,$));Y*=Math.cos(ie)}return 1.01*Y}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),l=vo(t.zoom);if(l>0){const u=bN(t,$a(1,t.center.lat)*t.worldSize),h=t.worldSize/(2*Math.PI),p=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Ln(r,u+h*(1-Math.cos(p)),Math.pow(l,10))}return r}upVector(t,r,l){return a1(r,l,t,1)}upVectorScale(t){return{metersToTile:A2(M2(pc(t)))}}}function Q2(i){const t=i.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(i.name){case"mercator":return new AN(i);case"equirectangular":return new Wte(i);case"naturalEarth":return new Gte(i);case"equalEarth":return new Ute(i);case"winkelTripel":return new Hte(i);case"albers":return r?new TN(i):new Bte(i);case"lambertConformalConic":return r?new TN(i):new Vte(i);case"globe":return new jte(i)}throw new Error(`Invalid projection name: ${i.name}`)}const $te=new yi({"symbol-placement":new Xt(nt.layout_symbol["symbol-placement"]),"symbol-spacing":new Xt(nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xt(nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yn(nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xt(nt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Xt(nt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Xt(nt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xt(nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xt(nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xt(nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new yn(nt.layout_symbol["icon-size"]),"icon-text-fit":new yn(nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yn(nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new yn(nt.layout_symbol["icon-image"]),"icon-rotate":new yn(nt.layout_symbol["icon-rotate"]),"icon-padding":new Xt(nt.layout_symbol["icon-padding"]),"icon-keep-upright":new Xt(nt.layout_symbol["icon-keep-upright"]),"icon-offset":new yn(nt.layout_symbol["icon-offset"]),"icon-anchor":new yn(nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xt(nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xt(nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xt(nt.layout_symbol["text-rotation-alignment"]),"text-field":new yn(nt.layout_symbol["text-field"]),"text-font":new yn(nt.layout_symbol["text-font"]),"text-size":new yn(nt.layout_symbol["text-size"]),"text-max-width":new yn(nt.layout_symbol["text-max-width"]),"text-line-height":new yn(nt.layout_symbol["text-line-height"]),"text-letter-spacing":new yn(nt.layout_symbol["text-letter-spacing"]),"text-justify":new yn(nt.layout_symbol["text-justify"]),"text-radial-offset":new yn(nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xt(nt.layout_symbol["text-variable-anchor"]),"text-anchor":new yn(nt.layout_symbol["text-anchor"]),"text-max-angle":new Xt(nt.layout_symbol["text-max-angle"]),"text-writing-mode":new Xt(nt.layout_symbol["text-writing-mode"]),"text-rotate":new yn(nt.layout_symbol["text-rotate"]),"text-padding":new Xt(nt.layout_symbol["text-padding"]),"text-keep-upright":new Xt(nt.layout_symbol["text-keep-upright"]),"text-transform":new yn(nt.layout_symbol["text-transform"]),"text-offset":new yn(nt.layout_symbol["text-offset"]),"text-allow-overlap":new Xt(nt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xt(nt.layout_symbol["text-ignore-placement"]),"text-optional":new Xt(nt.layout_symbol["text-optional"]),visibility:new Xt(nt.layout_symbol.visibility)});var RP={paint:new yi({"icon-opacity":new yn(nt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new yn(nt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new yn(nt.paint_symbol["text-emissive-strength"]),"icon-color":new yn(nt.paint_symbol["icon-color"]),"icon-halo-color":new yn(nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new yn(nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yn(nt.paint_symbol["icon-halo-blur"]),"icon-translate":new Xt(nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xt(nt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new yn(nt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new yn(nt.paint_symbol["text-opacity"]),"text-color":new yn(nt.paint_symbol["text-color"],{runtimeType:Ki,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new yn(nt.paint_symbol["text-halo-color"]),"text-halo-width":new yn(nt.paint_symbol["text-halo-width"]),"text-halo-blur":new yn(nt.paint_symbol["text-halo-blur"]),"text-translate":new Xt(nt.paint_symbol["text-translate"]),"text-translate-anchor":new Xt(nt.paint_symbol["text-translate-anchor"])}),layout:$te};class CN{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Zs,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}un(CN,"FormatSectionOverride",{omit:["defaultValue"]});class e3 extends Yo{constructor(t,r){super(t,RP,r)}recalculate(t,r){super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const l=this.layout.get("text-writing-mode");if(l){const u=[];for(const h of l)u.indexOf(h)<0&&u.push(h);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,r,l,u){const h=this.layout.get(t).evaluate(r,{},l,u),p=this._unevaluatedLayout._values[t];return p.isDataDriven()||Jp(p.value)||!h?h:function(g,v){return v.replace(/{([^{}]+)}/g,(b,w)=>w in g?String(g[w]):"")}(r.properties,h)}createBucket(t){return new y1(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of RP.paint.overridableProperties){if(!e3.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),l=new CN(r),u=new Kp(l,r.property.specification);let h=null;h=r.value.kind==="constant"||r.value.kind==="source"?new My("source",u):new zc("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[t]=new il(r.property,h,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,l){return!(!this.layout||r.isDataDriven()||l.isDataDriven())&&e3.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const l=t.get("text-field"),u=RP.paint.properties[r];let h=!1;const p=g=>{for(const v of g)if(u.overrides&&u.overrides.hasOverride(v))return void(h=!0)};if(l.value.kind==="constant"&&l.value.value instanceof Ar)p(l.value.value.sections);else if(l.value.kind==="source"){const g=b=>{h||(b instanceof Su&&Ci(b.value)===Ic?p(b.value.sections):b instanceof $h?p(b.sections):b.eachChild(g))},v=l.value;v._styleExpression&&g(v._styleExpression.expression)}return h}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,r=this.paint.get("text-opacity").constantOr(1)!==0,l=[];return t&&l.push("symbolIcon"),r&&l.push("symbolSDF"),l}getDefaultProgramParams(t,r){return{config:new mm(this,r),overrideFog:!1}}}const qte=U2.types,Xte=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function t3(i,t,r,l,u,h,p,g,v,b,w,A,C){const P=g?Math.min(Sf,Math.round(g[0])):0,R=g?Math.min(Sf,Math.round(g[1])):0;i.emplaceBack(t,r,Math.round(32*l),Math.round(32*u),h,p,(P<<1)+(v?1:0),R,16*b,16*w,256*A,256*C)}function n3(i,t,r){i.emplaceBack(t,r)}function a3(i,t,r,l,u,h,p){i.emplaceBack(t,r,l,u,h,p)}function i3(i,t,r,l,u){const h=5*t+2;i.float32[h+0]=r,i.float32[h+1]=l,i.float32[h+2]=u}function fv(i,t,r,l,u){i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u),i.emplaceBack(t,r,l,u)}function Yte(i){for(const t of i.sections)if(wC(t.text))return!0;return!1}class kP{constructor(t){this.layoutVertexArray=new vi,this.indexArray=new Nn,this.programConfigurations=t,this.segments=new ja,this.dynamicLayoutVertexArray=new dn,this.opacityVertexArray=new yo,this.placedSymbolArray=new bO,this.iconTransitioningVertexArray=new to,this.globeExtVertexArray=new Vn,this.zOffsetVertexArray=new mr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,r,l,u,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dte.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,fte.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Xte,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,mte.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,hte.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,pte.members,!0)),this.opacityVertexBuffer.itemSize=1),(l||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}un(kP,"SymbolBuffers");class DP{constructor(t,r,l){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new l,this.segments=new ja,this.collisionVertexArray=new An,this.collisionVertexArrayExt=new Dn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,gte.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,yte.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}un(DP,"CollisionBuffers");class r3{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(p=>p.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=at.identity([]),this.placementViewportMatrix=at.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=SP(this.zoom,r["text-size"]),this.iconSizeData=SP(this.zoom,r["icon-size"]);const l=this.layers[0].layout,u=l.get("symbol-sort-key"),h=l.get("symbol-z-order");this.canOverlap=l.get("text-allow-overlap")||l.get("icon-allow-overlap")||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=l.get("text-writing-mode").map(p=>bi[p]),this.stateDependentLayerIds=this.layers.filter(p=>p.isStateDependent()).map(p=>p.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=l.get("symbol-z-elevate")}createArrays(){this.text=new kP(new ff(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new kP(new ff(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new SO,this.lineVertexArray=new AO,this.symbolInstances=new wO}calculateGlyphDependencies(t,r,l,u,h){for(let p=0;p<t.length;p++){const g=t.codePointAt(p);if(g===void 0)break;if(r[g]=!0,u&&h&&g<=65535){const v=c1[t.charAt(p)];v&&(r[v.charCodeAt(0)]=!0)}}}populate(t,r,l,u){const h=this.layers[0],p=h.layout,g=this.projection.name==="globe",v=p.get("text-font"),b=p.get("text-field"),w=p.get("icon-image"),A=(b.value.kind!=="constant"||b.value.value instanceof Ar&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),C=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=p.get("symbol-sort-key");if(this.features=[],!A&&!C)return;const R=r.iconDependencies,z=r.glyphDependencies,U=r.availableImages,W=new ri(this.zoom);for(const{feature:j,id:Y,index:Z,sourceLayerIndex:$}of t){const K=h._featureFilter.needGeometry,ie=_f(j,K);if(!h._featureFilter.filter(W,ie,l))continue;if(K||(ie.geometry=Gu(j,l,u)),g&&j.type!==1&&l.z<=5){const Te=ie.geometry,we=.98078528056,Ie=(xe,We)=>{const qe=a1(xe.x,xe.y,l,1),et=a1(We.x,We.y,l,1);return ke.dot(qe,et)<we};for(let xe=0;xe<Te.length;xe++)Te[xe]=see(Te[xe],Ie)}let ce,he;if(A){const Te=h.getValueAndResolveTokens("text-field",ie,l,U),we=Ar.factory(Te);Yte(we)&&(this.hasRTLText=!0),(!this.hasRTLText||q_()==="unavailable"||this.hasRTLText&&Ds.isParsed())&&(ce=bte(we,h,ie))}if(C){const Te=h.getValueAndResolveTokens("icon-image",ie,l,U);he=Te instanceof is?Te:is.fromString(Te)}if(!ce&&!he)continue;const ye=this.sortFeaturesByKey?P.evaluate(ie,{},l):void 0;if(this.features.push({id:Y,text:ce,icon:he,index:Z,sourceLayerIndex:$,geometry:ie.geometry,properties:j.properties,type:qte[j.type],sortKey:ye}),he&&(R[he.namePrimary]=!0,he.nameSecondary&&(R[he.nameSecondary]=!0)),ce){const Te=v.evaluate(ie,{},l).join(","),we=p.get("text-rotation-alignment")==="map"&&p.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(bi.vertical)>=0;for(const Ie of ce.sections)if(Ie.image)R[Ie.image.namePrimary]=!0;else{const xe=hm(ce.toString()),We=Ie.fontStack||Te,qe=z[We]=z[We]||{};this.calculateGlyphDependencies(Ie.text,qe,we,this.allowVerticalPlacement,xe)}}}p.get("symbol-placement")==="line"&&(this.features=function(j){const Y={},Z={},$=[];let K=0;function ie(Te){$.push(j[Te]),K++}function ce(Te,we,Ie){const xe=Z[Te];return delete Z[Te],Z[we]=xe,$[xe].geometry[0].pop(),$[xe].geometry[0]=$[xe].geometry[0].concat(Ie[0]),xe}function he(Te,we,Ie){const xe=Y[we];return delete Y[we],Y[Te]=xe,$[xe].geometry[0].shift(),$[xe].geometry[0]=Ie[0].concat($[xe].geometry[0]),xe}function ye(Te,we,Ie){const xe=Ie?we[0][we[0].length-1]:we[0][0];return`${Te}:${xe.x}:${xe.y}`}for(let Te=0;Te<j.length;Te++){const we=j[Te],Ie=we.geometry,xe=we.text?we.text.toString():null;if(!xe){ie(Te);continue}const We=ye(xe,Ie),qe=ye(xe,Ie,!0);if(We in Z&&qe in Y&&Z[We]!==Y[qe]){const et=he(We,qe,Ie),Ne=ce(We,qe,$[et].geometry);delete Y[We],delete Z[qe],Z[ye(xe,$[Ne].geometry,!0)]=Ne,$[et].geometry=null}else We in Z?ce(We,qe,Ie):qe in Y?he(We,qe,Ie):(ie(Te),Y[We]=K-1,Z[qe]=K-1)}return $.filter(Te=>Te.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((j,Y)=>j.sortKey-Y.sortKey)}update(t,r,l,u,h){const p=Object.keys(t).length!==0;if(p&&!this.stateDependentLayers.length)return;const g=p?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,r,g,l,u,h),this.icon.programConfigurations.updatePaintArrays(t,r,g,l,u,h)}updateZOffset(){const t=(h,p,g)=>{l+=p,l>h.length&&h.resize(l);for(let v=-p;v<0;v++)h.emplace(v+l,g)},r=(h,p,g)=>{u+=p,u>h.length&&h.resize(u);for(let v=-p;v<0;v++)h.emplace(v+u,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let l=0,u=0;for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:b}=p,w=p.zOffset,A=b>0;if((g>0||v>0)&&(t(this.text.zOffsetVertexArray,g,w),t(this.text.zOffsetVertexArray,v,w)),A){const{placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:P}=p;C>=0&&r(this.icon.zOffsetVertexArray,b,w),P>=0&&r(this.icon.zOffsetVertexArray,p.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Q2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const l=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:u,y:h}of r)this.lineVertexArray.emplaceBack(u,h);return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U){const W=t.indexArray,j=t.layoutVertexArray,Y=t.globeExtVertexArray,Z=t.segments.prepareSegment(4*r.length,j,W,this.canOverlap?p.sortKey:void 0),$=this.glyphOffsetArray.length,K=Z.vertexLength,ie=this.allowVerticalPlacement&&g===bi.vertical?Math.PI/2:0,ce=p.text&&p.text.sections;for(let ye=0;ye<r.length;ye++){const{tl:Te,tr:we,bl:Ie,br:xe,texPrimary:We,texSecondary:qe,pixelOffsetTL:et,pixelOffsetBR:Ne,minFontScaleX:Ve,minFontScaleY:it,glyphOffset:gt,isSDF:ct,sectionIndex:Pt}=r[ye],Ft=Z.vertexLength,xt=gt[1];if(t3(j,b.x,b.y,Te.x,xt+Te.y,We.x,We.y,l,ct,et.x,et.y,Ve,it),t3(j,b.x,b.y,we.x,xt+we.y,We.x+We.w,We.y,l,ct,Ne.x,et.y,Ve,it),t3(j,b.x,b.y,Ie.x,xt+Ie.y,We.x,We.y+We.h,l,ct,et.x,Ne.y,Ve,it),t3(j,b.x,b.y,xe.x,xt+xe.y,We.x+We.w,We.y+We.h,l,ct,Ne.x,Ne.y,Ve,it),v){const{x:Mt,y:en,z:on}=v.anchor,[rn,cn,gn]=v.up;a3(Y,Mt,en,on,rn,cn,gn),a3(Y,Mt,en,on,rn,cn,gn),a3(Y,Mt,en,on,rn,cn,gn),a3(Y,Mt,en,on,rn,cn,gn),fv(t.dynamicLayoutVertexArray,Mt,en,on,ie)}else fv(t.dynamicLayoutVertexArray,b.x,b.y,b.z,ie);if(U){const Mt=qe||We;n3(t.iconTransitioningVertexArray,Mt.x,Mt.y),n3(t.iconTransitioningVertexArray,Mt.x+Mt.w,Mt.y),n3(t.iconTransitioningVertexArray,Mt.x,Mt.y+Mt.h),n3(t.iconTransitioningVertexArray,Mt.x+Mt.w,Mt.y+Mt.h)}W.emplaceBack(Ft,Ft+1,Ft+2),W.emplaceBack(Ft+1,Ft+2,Ft+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gt[0]),ye!==r.length-1&&Pt===r[ye+1].sectionIndex||t.programConfigurations.populatePaintArrays(j.length,p,p.index,{},P,R,z,ce&&ce[Pt])}const he=v?v.anchor:b;t.placedSymbolArray.emplaceBack(he.x,he.y,he.z,b.x,b.y,$,this.glyphOffsetArray.length-$,K,w,A,b.segment,l?l[0]:0,l?l[1]:0,u[0],u[1],g,0,!1,0,C,0)}_commitLayoutVertex(t,r,l,u,h,p,g){t.emplaceBack(r,l,u,h,p,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,r,l,u,h,p,g){const v=l.segments.prepareSegment(4,l.layoutVertexArray,l.indexArray),b=v.vertexLength,w=g.tileAnchorX,A=g.tileAnchorY;for(let P=0;P<4;P++)l.collisionVertexArray.emplaceBack(0,0,0,0);l.collisionVertexArrayExt.emplaceBack(r,-t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(r,t.padding,-t.padding),l.collisionVertexArrayExt.emplaceBack(r,t.padding,t.padding),l.collisionVertexArrayExt.emplaceBack(r,-t.padding,t.padding),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,w,A,new V(t.x1,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,w,A,new V(t.x2,t.y1)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,w,A,new V(t.x2,t.y2)),this._commitLayoutVertex(l.layoutVertexArray,u,h,p,w,A,new V(t.x1,t.y2)),v.vertexLength+=4;const C=l.indexArray;C.emplaceBack(b,b+1),C.emplaceBack(b+1,b+2),C.emplaceBack(b+2,b+3),C.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceTextSize(t,p,r,g);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}_addIconDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceIconSize(t,r,p.placedIconSymbolIndex);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,p)}}generateCollisionDebugBuffers(t,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new DP(wt,JF.members,to),this.iconCollisionBox=new DP(wt,JF.members,to);const l=Hu(this.iconSizeData,t),u=Hu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(u,t,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._addTextDebugCollisionBoxes(u,t,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,t,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p),this._addIconDebugCollisionBoxes(l,t,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p)}}getSymbolInstanceTextSize(t,r,l,u){const h=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),p=l1(this.textSizeData,t,h)/io;return this.tilePixelRatio*p}getSymbolInstanceIconSize(t,r,l){const u=this.icon.placedSymbolArray.get(l),h=l1(this.iconSizeData,t,u);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(t,r,l){t.emplaceBack(r,-l,-l),t.emplaceBack(r,l,-l),t.emplaceBack(r,l,l),t.emplaceBack(r,-l,l)}_updateTextDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceTextSize(t,p,r,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding)}}_updateIconDebugCollisionBoxes(t,r,l,u,h,p){for(let g=u;g<h;g++){const v=l.get(g),b=this.getSymbolInstanceIconSize(t,r,p);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding)}}updateCollisionDebugBuffers(t,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const l=Hu(this.iconSizeData,t),u=Hu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const p=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(u,t,r,p.textBoxStartIndex,p.textBoxEndIndex,p),this._updateTextDebugCollisionBoxes(u,t,r,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p),this._updateIconDebugCollisionBoxes(l,t,r,p.iconBoxStartIndex,p.iconBoxEndIndex,p.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(l,t,r,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex,p.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,r,l,u,h,p,g,v,b){const w={};if(r<l){const{x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z,featureIndex:$}=t.get(r);w.textBox={x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z},w.textFeatureIndex=$}if(u<h){const{x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z,featureIndex:$}=t.get(u);w.verticalTextBox={x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z},w.verticalTextFeatureIndex=$}if(p<g){const{x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z,featureIndex:$}=t.get(p);w.iconBox={x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z},w.iconFeatureIndex=$}if(v<b){const{x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z,featureIndex:$}=t.get(v);w.verticalIconBox={x1:A,y1:C,x2:P,y2:R,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:j,tileAnchorX:Y,tileAnchorY:Z},w.verticalIconFeatureIndex=$}return w}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const l=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,r){const l=t.placedSymbolArray.get(r),u=l.vertexStartIndex+4*l.numGlyphs;for(let h=l.vertexStartIndex;h<u;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),l=Math.cos(t),u=[],h=[],p=[];for(let g=0;g<this.symbolInstances.length;++g){p.push(g);const v=this.symbolInstances.get(g);u.push(0|Math.round(r*v.tileAnchorX+l*v.tileAnchorY)),h.push(v.featureIndex)}return p.sort((g,v)=>u[g]-u[v]||h[v]-h[g]),p}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,r){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===r?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const l=this.symbolInstances.get(r);this.featureSortOrder.push(l.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:p,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:b}=l;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&h!==u&&this.addIndicesForPlacedSymbol(this.text,h),p>=0&&p!==h&&p!==u&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}un(r3,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),r3.MAX_GLYPHS=65535,r3.addDynamicAttributes=fv;var y1=r3;const Zte=N([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Kte}=Zte,Jte=N([{name:"a_packed",components:4,type:"Float32"}]),{members:Qte}=Jte,ene=U2.types,tne=Math.cos(Math.PI/180*37.5);class o3{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new jt,this.layoutVertexArray2=new dn,this.indexArray=new Nn,this.programConfigurations=new ff(t.layers,t.zoom),this.segments=new ja,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,l,u){this.hasPattern=gP("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),p=[];for(const{feature:w,id:A,index:C,sourceLayerIndex:P}of t){const R=this.layers[0]._featureFilter.needGeometry,z=_f(w,R);if(!this.layers[0]._featureFilter.filter(new ri(this.zoom),z,l))continue;const U=h?h.evaluate(z,{},l):void 0,W={id:A,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:R?z.geometry:Gu(w,l,u),patterns:{},sortKey:U};p.push(W)}h&&p.sort((w,A)=>w.sortKey-A.sortKey);const{lineAtlas:g,featureIndex:v}=r,b=this.addConstantDashes(g);for(const w of p){const{geometry:A,index:C,sourceLayerIndex:P}=w;if(b&&this.addFeatureDashes(w,g),this.hasPattern){const R=yP("line",this.layers,w,this.zoom,r);this.patternFeatures.push(R)}else this.addFeature(w,A,C,l,g.positions,r.availableImages,r.brightness);v.insert(t[C].feature,A,C,P,this.index)}}addConstantDashes(t){let r=!1;for(const l of this.layers){const u=l.paint.get("line-dasharray").value,h=l.layout.get("line-cap").value;if(u.kind!=="constant"||h.kind!=="constant")r=!0;else{const p=h.value,g=u.value;if(!g)continue;t.addDash(g,p)}}return r}addFeatureDashes(t,r){const l=this.zoom;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,p=u.layout.get("line-cap").value;if(h.kind==="constant"&&p.kind==="constant")continue;let g,v;if(h.kind==="constant"){if(g=h.value,!g)continue}else g=h.evaluate({zoom:l},t);v=p.kind==="constant"?p.value:p.evaluate({zoom:l},t),r.addDash(g,v),t.patterns[u.id]=r.getKey(g,v)}}update(t,r,l,u,h){const p=Object.keys(t).length!==0;p&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,p?this.stateDependentLayers:this.layers,l,u,h)}addFeatures(t,r,l,u,h,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,l,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Qte)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Kte),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,l,u,h,p,g){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),w=v.get("line-cap").evaluate(t,{}),A=v.get("line-miter-limit"),C=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of r)this.addLine(P,t,b,w,A,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,g)}addLine(t,r,l,u,h,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<t.length-1;W++)this.totalDistance+=t[W].dist(t[W+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=ene[r.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let b=0;for(;b<v-1&&t[b].equals(t[b+1]);)b++;if(v<(g?3:2))return;l==="bevel"&&(h=1.05);const w=this.overscaling<=16?15*ht/(512*this.overscaling):0,A=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let C,P,R,z,U;this.e1=this.e2=-1,g&&(C=t[v-2],U=t[b].sub(C)._unit()._perp());for(let W=b;W<v;W++){if(R=W===v-1?g?t[b+1]:void 0:t[W+1],R&&t[W].equals(R))continue;U&&(z=U),C&&(P=C),C=t[W],U=R?R.sub(C)._unit()._perp():z,z=z||U;let j=z.add(U);j.x===0&&j.y===0||j._unit();const Y=z.x*U.x+z.y*U.y,Z=j.x*U.x+j.y*U.y,$=Z!==0?1/Z:1/0,K=2*Math.sqrt(2-2*Z),ie=Z<tne&&P&&R,ce=z.x*U.y-z.y*U.x>0;if(ie&&W>b){const Te=C.dist(P);if(Te>2*w){const we=C.sub(C.sub(P)._mult(w/Te)._round());this.updateDistance(P,we),this.addCurrentVertex(we,z,0,0,A),P=we}}const he=P&&R;let ye=he?l:g?"butt":u;if(he&&ye==="round"&&($<p?ye="miter":$<=2&&(ye="fakeround")),ye==="miter"&&$>h&&(ye="bevel"),ye==="bevel"&&($>2&&(ye="flipbevel"),$<h&&(ye="miter")),P&&this.updateDistance(P,C),ye==="miter")j._mult($),this.addCurrentVertex(C,j,0,0,A);else if(ye==="flipbevel"){if($>100)j=U.mult(-1);else{const Te=$*z.add(U).mag()/z.sub(U).mag();j._perp()._mult(Te*(ce?-1:1))}this.addCurrentVertex(C,j,0,0,A),this.addCurrentVertex(C,j.mult(-1),0,0,A)}else if(ye==="bevel"||ye==="fakeround"){const Te=-Math.sqrt($*$-1),we=ce?Te:0,Ie=ce?0:Te;if(P&&this.addCurrentVertex(C,z,we,Ie,A),ye==="fakeround"){const xe=Math.round(180*K/Math.PI/20);for(let We=1;We<xe;We++){let qe=We/xe;if(qe!==.5){const Ne=qe-.5;qe+=qe*Ne*(qe-1)*((1.0904+Y*(Y*(3.55645-1.43519*Y)-3.2452))*Ne*Ne+(.848013+Y*(.215638*Y-1.06021)))}const et=U.sub(z)._mult(qe)._add(z)._unit()._mult(ce?-1:1);this.addHalfVertex(C,et.x,et.y,!1,ce,0,A)}}R&&this.addCurrentVertex(C,U,-we,-Ie,A)}else if(ye==="butt")this.addCurrentVertex(C,j,0,0,A);else if(ye==="square"){const Te=P?1:-1;P||this.addCurrentVertex(C,j,Te,Te,A),this.addCurrentVertex(C,j,0,0,A),P&&this.addCurrentVertex(C,j,Te,Te,A)}else ye==="round"&&(P&&(this.addCurrentVertex(C,z,0,0,A),this.addCurrentVertex(C,z,1,1,A,!0)),R&&(this.addCurrentVertex(C,U,-1,-1,A,!0),this.addCurrentVertex(C,U,0,0,A)));if(ie&&W<v-1){const Te=C.dist(R);if(Te>2*w){const we=C.add(R.sub(C)._mult(w/Te)._round());this.updateDistance(C,we),this.addCurrentVertex(we,U,0,0,A),C=we}}}}addCurrentVertex(t,r,l,u,h,p=!1){const g=r.y*u-r.x,v=-r.y-r.x*u;this.addHalfVertex(t,r.x+r.y*l,r.y-r.x*l,p,!1,l,h),this.addHalfVertex(t,g,v,p,!0,-u,h)}addHalfVertex({x:t,y:r},l,u,h,p,g,v){this.layoutVertexArray.emplaceBack((t<<1)+(h?1:0),(r<<1)+(p?1:0),Math.round(63*l)+128,Math.round(63*u)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),p?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}un(o3,"LineBucket",{omit:["layers","patternFeatures"]});class yr{constructor(t,r,l,u){this.context=t,this.format=l,this.texture=t.gl.createTexture(),this.update(r,u)}update(t,r,l){const{width:u,height:h}=t,{context:p}=this,{gl:g}=p,{HTMLImageElement:v,HTMLCanvasElement:b,HTMLVideoElement:w,ImageData:A,ImageBitmap:C}=m;if(g.bindTexture(g.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!r||r.premultiply!==!1)),l||this.size&&this.size[0]===u&&this.size[1]===h){const{x:P,y:R}=l||{x:0,y:0};if(t instanceof v||t instanceof b||t instanceof w||t instanceof A||C&&t instanceof C)g.texSubImage2D(g.TEXTURE_2D,0,P,R,g.RGBA,g.UNSIGNED_BYTE,t);else{let z=this.format,U=g.UNSIGNED_BYTE;this.format===g.R32F&&(z=g.RED,U=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,P,R,u,h,z,U,t.data)}}else if(this.size=[u,h],t instanceof v||t instanceof b||t instanceof w||t instanceof A||C&&t instanceof C){let P=this.format;this.format===g.R8&&(P=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,P,g.UNSIGNED_BYTE,t)}else{let P=this.format,R=this.format,z=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(P=g.DEPTH_COMPONENT16,z=g.UNSIGNED_SHORT),this.format===g.R32F&&(z=g.FLOAT,R=g.RED),g.texImage2D(g.TEXTURE_2D,0,P,u,h,0,R,z,t.data)}this.useMipmap=!!(r&&r.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,r){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?t===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(t,r,l,u){const{context:h}=this,{gl:p}=h;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.magFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),this.magFilter=r),t!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?t===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),this.wrapS=l),u!==this.wrapT&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class s3{constructor(t,r){this.context=t,this.texture=r}bind(t,r){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}}const mc=32,ju=33,Ef=new Uint16Array(8184);for(let i=0;i<2046;i++){let t=i+2,r=0,l=0,u=0,h=0,p=0,g=0;for(1&t?u=h=p=mc:r=l=g=mc;(t>>=1)>1;){const b=r+u>>1,w=l+h>>1;1&t?(u=r,h=l,r=p,l=g):(r=u,l=h,u=p,h=g),p=b,g=w}const v=4*i;Ef[v+0]=r,Ef[v+1]=l,Ef[v+2]=u,Ef[v+3]=h}const $u=new Uint16Array(2178),Mf=new Uint8Array(1089),l3=new Uint16Array(1089);function PN(i){return i===0?-.03125:i===32?.03125:0}var OP=N([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const IN={type:2,extent:ht,loadGeometry:()=>[[new V(0,0),new V(ht+1,0),new V(ht+1,ht+1),new V(0,ht+1),new V(0,0)]]};class v1{constructor(t,r,l,u,h){this.tileID=t,this.uid=kt(),this.uses=0,this.tileSize=r,this.tileZoom=l,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=h,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(t){const r=t+this.timeAdded;r<Cn.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=xm(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,r,l){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(u,h){const p={};if(!h)return p;for(const g of u){const v=g.layerIds.map(b=>h.getLayer(b)).filter(Boolean);if(v.length!==0){g.layers=v,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>v.filter(w=>w.id===b)[0]));for(const b of v)p[b.fqid]=g}}return p}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const h=this.buckets[u];if(h instanceof y1){if(this.hasSymbolBuckets=!0,!l)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const h=this.buckets[u];if(h instanceof y1&&h.hasRTLText){this.hasRTLText=!0,Ds.isLoading()||Ds.isLoaded()||q_()!=="deferred"||p2();break}}this.queryPadding=0;for(const u in this.buckets){const h=this.buckets[u],p=r.style.getOwnLayer(u);if(!p)continue;const g=p.queryRadius(h);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new TC}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new yr(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new yr(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new yr(t,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,r,l){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,l),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const u=r.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,r)))}queryRenderedFeatures(t,r,l,u,h,p,g,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:g,transform:p,params:h,tileTransform:this.tileTransform},t,r,l):{}}querySourceFeatures(t,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),h=r?r.sourceLayer:"",p=u._geojsonTileLayer||u[h];if(!p)return;const g=nm(r&&r.filter),{z:v,x:b,y:w}=this.tileID.canonical,A={z:v,x:b,y:w};for(let C=0;C<p.length;C++){const P=p.feature(C);if(g.needGeometry){const U=_f(P,!0);if(!g.filter(new ri(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!g.filter(new ri(this.tileID.overscaledZ),P))continue;const R=l.getId(P,h),z=new VF(P,v,b,w,R);z.tile=A,t.push(z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const l=Oe(t.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const h=this.expirationTime-r;h?this.expirationTime=l+Math.max(h,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&r&&this.updateBuckets(t,r)}updateBuckets(t,r){if(!this.latestFeatureIndex)return;const l=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages(),h=r.style.getBrightness();for(const p in this.buckets){if(!r.style.hasLayer(p))continue;const g=this.buckets[p],v=g.layers[0].sourceLayer||"_geojsonTileLayer",b=l[v];let w={};if(t&&(w=t[v],!b||!w||Object.keys(w).length===0))continue;if(g.update(w,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},h),g instanceof o3||g instanceof N2){const C=r.style.getOwnSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&C&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(C.id,this.tileID)}const A=r&&r.style&&r.style.getOwnLayer(p);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Cn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Cn.now()+t}setTexture(t,r){const l=r.context,u=l.gl;this.texture=this.texture||r.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new yr(l,t,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(t,r){const l={};for(const u of r)l[u]=!0;this.dependencies[t]=l}hasDependency(t,r){for(const l of t){const u=this.dependencies[l];if(u){for(const h of r)if(u[h])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const l=Gu(IN,this.tileID.canonical,this.tileTransform)[0],u=new J,h=new Z_;for(let p=0;p<l.length;p++){const{x:g,y:v}=l[p];u.emplaceBack(g,v),h.emplaceBack(p)}h.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(h),this._tileDebugBuffer=t.createVertexBuffer(u,mf.members),this._tileDebugSegments=ja.simpleSegment(0,0,u.length,h.length)}_makeTileBoundsBuffers(t,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const l=Gu(IN,this.tileID.canonical,this.tileTransform)[0];let u,h;if(this.isRaster){const p=function(g,v){const b=xm(g,v),w=Math.pow(2,g.z);for(let U=0;U<ju;U++)for(let W=0;W<ju;W++){const j=ol((g.x+(W+PN(W))/mc)/w),Y=gr((g.y+(U+PN(U))/mc)/w),Z=v.project(j,Y),$=U*ju+W;$u[2*$+0]=Math.round((Z.x*b.scale-b.x)*ht),$u[2*$+1]=Math.round((Z.y*b.scale-b.y)*ht)}Mf.fill(0),l3.fill(0);for(let U=2045;U>=0;U--){const W=4*U,j=Ef[W+0],Y=Ef[W+1],Z=Ef[W+2],$=Ef[W+3],K=j+Z>>1,ie=Y+$>>1,ce=K+ie-Y,he=ie+j-K,ye=Y*ju+j,Te=$*ju+Z,we=ie*ju+K,Ie=Math.hypot(($u[2*ye+0]+$u[2*Te+0])/2-$u[2*we+0],($u[2*ye+1]+$u[2*Te+1])/2-$u[2*we+1])>=16;Mf[we]=Mf[we]||(Ie?1:0),U<1022&&(Mf[we]=Mf[we]||Mf[(Y+he>>1)*ju+(j+ce>>1)]||Mf[($+he>>1)*ju+(Z+ce>>1)])}const A=new je,C=new Nn;let P=0;function R(U,W){const j=W*ju+U;return l3[j]===0&&(A.emplaceBack($u[2*j+0],$u[2*j+1],U*ht/mc,W*ht/mc),l3[j]=++P),l3[j]-1}function z(U,W,j,Y,Z,$){const K=U+j>>1,ie=W+Y>>1;if(Math.abs(U-Z)+Math.abs(W-$)>1&&Mf[ie*ju+K])z(Z,$,U,W,K,ie),z(j,Y,Z,$,K,ie);else{const ce=R(U,W),he=R(j,Y),ye=R(Z,$);C.emplaceBack(ce,he,ye)}}return z(0,0,mc,mc,mc,0),z(mc,mc,0,0,0,mc),{vertices:A,indices:C}}(this.tileID.canonical,r);u=p.vertices,h=p.indices}else{u=new je,h=new Nn;for(const{x:g,y:v}of l)u.emplaceBack(g,v,0,0);const p=F2(u.int16,void 0,4);for(let g=0;g<p.length;g+=3)h.emplaceBack(p[g],p[g+1],p[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(u,OP.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(h),this._tileBoundsSegments=ja.simpleSegment(0,0,u.length,h.length)}_makeGlobeTileDebugBuffers(t,r){const l=r.projection;if(!l||l.name!=="globe"||r.freezeTileCoverage)return;const u=this.tileID.canonical,h=vm(tF(u,r)),p=vo(r.zoom);let g;p>0&&(g=at.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,u,r,h,g,p),this._makeGlobeTileDebugTextBuffer(t,u,r,h,g,p)}_globePoint(t,r,l,u,h,p,g){let v=a1(t,r,l);if(p){const b=1<<l.z,w=_o(u.center.lng),A=Co(u.center.lat),C=(l.x+.5)/b-w;let P=0;C>.5?P=-1:C<-.5&&(P=1);let R=(t/ht+l.x)/b+P,z=(r/ht+l.y)/b;R=(R-w)*u._pixelsPerMercatorPixel+w,z=(z-A)*u._pixelsPerMercatorPixel+A;const U=[R*u.worldSize,z*u.worldSize,0];ke.transformMat4(U,U,p),v=Qd(v,U,g)}return ke.transformMat4(v,v,h)}_makeGlobeTileDebugBorderBuffer(t,r,l,u,h,p){const g=new J,v=new Z_,b=new oe,w=(C,P,R,z,U)=>{const W=(R-C)/(U-1),j=(z-P)/(U-1),Y=g.length;for(let Z=0;Z<U;Z++){const $=C+Z*W,K=P+Z*j;g.emplaceBack($,K);const ie=this._globePoint($,K,r,l,u,h,p);b.emplaceBack(ie[0],ie[1],ie[2]),v.emplaceBack(Y+Z)}},A=ht;w(0,0,A,0,16),w(A,0,A,A,16),w(A,A,0,A,16),w(0,A,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,mf.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,Xz.members),this._tileDebugSegments=ja.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugTextBuffer(t,r,l,u,h,p){const g=ht/4,v=new J,b=new Nn,w=new oe,A=25;b.reserve(32),v.reserve(A),w.reserve(A);const C=(P,R)=>A*P+R;for(let P=0;P<A;P++){const R=P*g;for(let z=0;z<A;z++){const U=z*g;v.emplaceBack(U,R);const W=this._globePoint(U,R,r,l,u,h,p);w.emplaceBack(W[0],W[1],W[2])}}for(let P=0;P<4;P++)for(let R=0;R<4;R++){const z=C(P,R),U=C(P,R+1),W=C(P+1,R),j=C(P+1,R+1);b.emplaceBack(z,U,W),b.emplaceBack(W,U,j)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(v,mf.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(w,Xz.members),this._tileDebugTextSegments=ja.simpleSegment(0,0,A,32)}}class nne{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,l){const u=t.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const h={value:r,timeout:void 0};if(l!==void 0&&(h.timeout=setTimeout(()=>{this.remove(t,h)},l)),this.data[u].push(h),this.order.push(u),this.order.length>this.max){const p=this._getAndRemoveByKey(this.order[0]);p&&this.onRemove(p)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const l=t.wrapped().key,u=r===void 0?0:this.data[l].indexOf(r),h=this.data[l][u];return this.data[l].splice(u,1),h.timeout&&clearTimeout(h.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(h.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const l in this.data)for(const u of this.data[l])t(u.value)||r.push(u);for(const l of r)this.remove(l.value.tileID,l)}}class Tf{constructor(t,r,l,u){this.id=Tf.uniqueIdxCounter,Tf.uniqueIdxCounter++,this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||u||r.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Tf.uniqueIdxCounter,Tf.uniqueIdxCounter++;const r=this.context.gl;this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Tf.uniqueIdxCounter=0;const ane={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ine{constructor(t,r,l,u,h,p){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.instanceCount=p,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||h||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let l=0;l<this.attributes.length;l++){const u=r.attributes[this.attributes[l].name];u!==void 0&&t.enableVertexAttribArray(u)}}setVertexAttribPointers(t,r,l){for(let u=0;u<this.attributes.length;u++){const h=this.attributes[u],p=r.attributes[h.name];p!==void 0&&t.vertexAttribPointer(p,h.components,t[ane[h.type]],!1,this.itemSize,h.offset+this.itemSize*(l||0))}}setVertexAttribDivisor(t,r,l){for(let u=0;u<this.attributes.length;u++){const h=r.attributes[this.attributes[u].name];h!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(h,l)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class fi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class rne extends fi{getDefault(){return xn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class one extends fi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class sne extends fi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class lne extends fi{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class cne extends fi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class une extends fi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class dne extends fi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class hne extends fi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class fne extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class pne extends fi{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class mne extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class gne extends fi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class yne extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class vne extends fi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class _ne extends fi{getDefault(){return xn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class bne extends fi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class xne extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class wne extends fi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Sne extends fi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let Ane=class extends fi{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}};class Ene extends fi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Mne extends fi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Tne extends fi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Cne extends fi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Pne extends fi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ine extends fi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Lne extends fi{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Rne extends fi{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class kne extends fi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Dne extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class One extends fi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class zP extends fi{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class zne extends zP{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class LN extends zP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Fne extends zP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Nne extends LN{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Bne{constructor(t,r,l,u,h){this.context=t,this.width=r,this.height=l;const p=this.framebuffer=t.gl.createFramebuffer();u&&(this.colorAttachment=new zne(t,p)),h&&(this.depthAttachmentType=h,this.depthAttachment=h==="renderbuffer"?new LN(t,p):new Fne(t,p))}destroy(){const t=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&t.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&t.deleteTexture(r)}t.deleteFramebuffer(this.framebuffer)}}class zn{constructor(t,r,l){this.func=t,this.mask=r,this.range=l}}zn.ReadOnly=!1,zn.ReadWrite=!0,zn.disabled=new zn(519,zn.ReadOnly,[0,1]);const FP=7680;class oa{constructor(t,r,l,u,h,p){this.test=t,this.ref=r,this.mask=l,this.fail=u,this.depthFail=h,this.pass=p}}oa.disabled=new oa({func:519,mask:0},0,0,FP,FP,FP);const c3=771;class Ea{constructor(t,r,l,u){this.blendFunction=t,this.blendColor=r,this.mask=l,this.blendEquation=u}}Ea.Replace=[1,0,1,0],Ea.disabled=new Ea(Ea.Replace,xn.transparent,[!1,!1,!1,!1]),Ea.unblended=new Ea(Ea.Replace,xn.transparent,[!0,!0,!0,!0]),Ea.alphaBlended=new Ea([1,c3,1,c3],xn.transparent,[!0,!0,!0,!0]),Ea.multiply=new Ea([774,0,774,0],xn.transparent,[!0,!0,!0,!0]);const NP=1029,BP=2305;class la{constructor(t,r,l){this.enable=t,this.mode=r,this.frontFace=l}}la.disabled=new la(!1,NP,BP),la.backCCW=new la(!0,NP,BP),la.backCW=new la(!0,NP,2304),la.frontCW=new la(!0,1028,2304),la.frontCCW=new la(!0,1028,BP);class Une{constructor(t){this.gl=t,this.clearColor=new rne(this),this.clearDepth=new one(this),this.clearStencil=new sne(this),this.colorMask=new lne(this),this.depthMask=new cne(this),this.stencilMask=new une(this),this.stencilFunc=new dne(this),this.stencilOp=new hne(this),this.stencilTest=new fne(this),this.depthRange=new pne(this),this.depthTest=new mne(this),this.depthFunc=new gne(this),this.blend=new yne(this),this.blendFunc=new vne(this),this.blendColor=new _ne(this),this.blendEquation=new bne(this),this.cullFace=new xne(this),this.cullFaceSide=new wne(this),this.frontFace=new Sne(this),this.program=new Ane(this),this.activeTexture=new Ene(this),this.viewport=new Mne(this),this.bindFramebuffer=new Tne(this),this.bindRenderbuffer=new Cne(this),this.bindTexture=new Pne(this),this.bindVertexBuffer=new Ine(this),this.bindElementBuffer=new Lne(this),this.bindVertexArrayOES=new Rne(this),this.pixelStoreUnpack=new kne(this),this.pixelStoreUnpackPremultiplyAlpha=new Dne(this),this.pixelStoreUnpackFlipY=new One(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r,l){return new Tf(this,t,r,l)}createVertexBuffer(t,r,l,u,h){return new ine(this,t,r,l,u,h)}createRenderbuffer(t,r,l){const u=this.gl,h=u.createRenderbuffer();return this.bindRenderbuffer.set(h),u.renderbufferStorage(u.RENDERBUFFER,t,r,l),this.bindRenderbuffer.set(null),h}createFramebuffer(t,r,l,u){return new Bne(this,t,r,l,u)}clear({color:t,depth:r,stencil:l,colorMask:u}){const h=this.gl;let p=0;t&&(p|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(u||[!0,!0,!0,!0])),r!==void 0&&(p|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),h.clear(p)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Q(t.blendFunction,Ea.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class $c extends Bn{constructor(t,r,l){super(),this.id=t,this._onlySymbols=l,r.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new nne(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new lte,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const r=this._tiles[t];if(r.state!=="errored"&&(r.state!=="loaded"||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,r){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,r)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(t),l.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Ke(this._tiles).map(t=>t.tileID).sort(RN).map(t=>t.key)}getRenderableIds(t,r){const l=[];for(const u in this._tiles)this._isIdRenderable(+u,t,r)&&l.push(this._tiles[u]);return t?l.sort((u,h)=>{const p=u.tileID,g=h.tileID,v=new V(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),b=new V(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-g.overscaledZ||b.y-v.y||b.x-v.x}).map(u=>u.tileID.key):l.map(u=>u.tileID).sort(RN).map(u=>u.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r,l){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())&&(l||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,r){const l=this._tiles[t];l&&(l.state!=="loading"&&(l.state=r),this._loadTile(l,this._tileLoaded.bind(this,l,t,r)))}_tileLoaded(t,r,l,u){if(u)if(t.state="errored",u.status!==404)this._source.fire(new vn(u,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const h=this.map.painter.terrain;this.update(this.transform,h.getScaledDemTileSize(),!0),h.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Cn.now(),l==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new Ht("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const h=r[u];if(t.neighboringTiles&&t.neighboringTiles[h]){const p=this.getTileByID(h);l(t,p),l(p,t)}}function l(u,h){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let p=h.tileID.canonical.x-u.tileID.canonical.x;const g=h.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),b=h.tileID.key;p===0&&g===0||Math.abs(g)>1||(Math.abs(p)>1&&(Math.abs(p+v)===1?p+=v:Math.abs(p-v)===1&&(p-=v)),h.dem&&u.dem&&(u.dem.backfillBorder(h.dem,p,g),u.neighboringTiles&&u.neighboringTiles[b]&&(u.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,l,u){for(const h in this._tiles){let p=this._tiles[h];if(u[h]||!p.hasData()||p.tileID.overscaledZ<=r||p.tileID.overscaledZ>l)continue;let g=p.tileID;for(;p&&p.tileID.overscaledZ>r+1;){const b=p.tileID.scaledTo(p.tileID.overscaledZ-1);p=this._tiles[b.key],p&&p.hasData()&&(g=b)}let v=g;for(;v.overscaledZ>r;)if(v=v.scaledTo(v.overscaledZ-1),t[v.key]){u[g.key]=g;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const l=this._loadedParentTiles[t.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=t.overscaledZ-1;l>=r;l--){const u=t.scaledTo(l),h=this._getLoadedTile(u);if(h)return h}}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,r){r=r||this._source.tileSize;const l=Math.ceil(t.width/r)+1,u=Math.ceil(t.height/r)+1,h=Math.floor(l*u*5),p=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,h):h,g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(g)}handleWrapJump(t){const r=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,r){const l={};for(const u in this._tiles){const h=this._tiles[u];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+r),l[h.tileID.key]=h}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(t,r,l,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!l)return;let h;if(this.updateCacheSize(t,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Ca(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!l,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[],h.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!UP(this._source.type)){const v=t.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!l}),b=Math.min(v,this._source.maxzoom),w=t.extendTileCoverForShadows(h,u,b);for(const A of w)this._shadowCasterTiles[A.key]=!0,h.push(A)}const p=this._updateRetainedTiles(h);if(UP(this._source.type)&&h.length!==0){const v={},b={},w=Object.keys(p);for(const C of w){const P=p[C],R=this._tiles[C];if(!R||R.fadeEndTime&&R.fadeEndTime<=Cn.now())continue;const z=this.findLoadedParent(P,Math.max(P.overscaledZ-$c.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),v[z.tileID.key]=z.tileID),b[C]=P}const A=h[h.length-1].overscaledZ;for(const C in this._tiles){const P=this._tiles[C];if(p[C]||!P.hasData())continue;let R=P.tileID;for(;R.overscaledZ>A;){R=R.scaledTo(R.overscaledZ-1);const z=this._tiles[R.key];if(z&&z.hasData()&&b[R.key]){p[C]=P.tileID;break}}}for(const C in v)p[C]||(this._coveredTiles[C]=!0,p[C]=v[C])}for(const v in p)this._tiles[v].clearFadeHold();const g=function(v,b){const w=[];for(const A in v)A in b||w.push(A);return w}(this._tiles,p);for(const v of g){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const r={};if(t.length===0)return r;const l={},u=t.reduce((b,w)=>Math.min(b,w.overscaledZ),1/0),h=t[0].overscaledZ,p=Math.max(h-$c.maxOverzooming,this._source.minzoom),g=Math.max(h+$c.maxUnderzooming,this._source.minzoom),v={};for(const b of t){const w=this._addTile(b);r[b.key]=b,w.hasData()||u<this._source.maxzoom&&(v[b.key]=b)}this._retainLoadedChildren(v,u,g,r);for(const b of t){let w=this._tiles[b.key];if(w.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const C=b.children(this._source.maxzoom)[0],P=this.getTile(C);if(P&&P.hasData()){r[C.key]=C;continue}}else{const C=b.children(this._source.maxzoom);if(r[C[0].key]&&r[C[1].key]&&r[C[2].key]&&r[C[3].key])continue}let A=w.wasRequested();for(let C=b.overscaledZ-1;C>=p;--C){const P=b.scaledTo(C);if(l[P.key]||(l[P.key]=!0,w=this.getTile(P),!w&&A&&(w=this._addTile(P)),w&&(r[P.key]=P,A=w.wasRequested(),w.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let l,u=this._tiles[t].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}r.push(u.key);const h=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(h),l)break;u=h}for(const h of r)this._loadedParentTiles[h]=l}}_addTile(t){let r=this._tiles[t.key];if(r)return r.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const l=!!r;if(!l){const u=this.map?this.map.painter:null;r=new v1(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))}return r?(r.uses++,this._tiles[t.key]=r,l||this._source.fire(new Ht("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const l=r.getExpiryTimeout();l&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},l))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,r,l){const u=[],h=this.transform;if(!h)return u;const p=h.projection.name==="globe",g=_o(h.center.lng);for(const v in this._tiles){const b=this._tiles[v];if(l&&b.clearQueryDebugViz(),b.holdingForFade())continue;let w;if(p){const A=b.tileID.canonical;if(A.z===0){const C=[Math.abs(ae(g,..._1(A,-1))-g),Math.abs(ae(g,..._1(A,1))-g)];w=[0,2*C.indexOf(Math.min(...C))-1]}else{const C=[Math.abs(ae(g,..._1(A,-1))-g),Math.abs(ae(g,..._1(A,0))-g),Math.abs(ae(g,..._1(A,1))-g)];w=[C.indexOf(Math.min(...C))-1]}}else w=[0];for(const A of w){const C=t.containsTile(b,h,r,A);C&&u.push(C)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,r){const l=this.getRenderableIds(t,r).map(u=>this._tiles[u].tileID);for(const u of l)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return l}sortCoordinatesByDistance(t){const r=t.slice(),l=this.transform._camera.position,u=this.transform._camera.forward(),h={};for(const p of r){const g=1/(1<<p.canonical.z);h[p.key]=((p.canonical.x+.5)*g+p.wrap-l[0])*u[0]+((p.canonical.y+.5)*g-l[1])*u[1]-l[2]*u[2]}return r.sort((p,g)=>h[p.key]-h[g.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(UP(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Cn.now())return!0}return!1}setFeatureState(t,r,l){this._state.updateState(t=t||"_geojsonTileLayer",r,l)}removeFeatureState(t,r,l){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,l)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,l){const u=this._tiles[t];u&&u.setDependencies(r,l)}reloadTilesForDependencies(t,r){for(const l in this._tiles)this._tiles[l].hasDependency(t,r)&&this._reloadTile(+l,"reloading");this._cache.filter(l=>!l.hasDependency(t,r))}_preloadTiles(t,r){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,r))};return void this._source.on("data",g)}const l=new Map,u=Array.isArray(t)?t:[t],h=this.map.painter.terrain,p=this.usedForTerrain&&h?h.getScaledDemTileSize():this._source.tileSize;for(const g of u){const v=g.coveringTiles({tileSize:p,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of v)l.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}Xe(Array.from(l.values()),(g,v)=>{const b=new v1(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,w=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),v(w,b)})},r)}}function RN(i,t){const r=Math.abs(2*i.wrap)-+(i.wrap<0),l=Math.abs(2*t.wrap)-+(t.wrap<0);return i.overscaledZ-t.overscaledZ||l-r||t.canonical.y-i.canonical.y||t.canonical.x-i.canonical.x}function UP(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function _1(i,t){const r=1<<i.z;return[i.x/r+t,(i.x+1)/r+t]}$c.maxOverzooming=10,$c.maxUnderzooming=3;const Wne=N([{name:"a_pos_3f",components:3,type:"Float32"}]),Vne=N([{name:"a_color_3f",components:3,type:"Float32"}]),Gne=N([{name:"a_color_4f",components:4,type:"Float32"}]),Hne=N([{name:"a_uv_2f",components:2,type:"Float32"}]),jne=N([{name:"a_normal_3f",components:3,type:"Float32"}]),$ne=N([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),qne=N([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class WP{constructor(t=0,r=0,l=0,u=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=l,this.right=u}interpolate(t,r,l){return r.top!=null&&t.top!=null&&(this.top=Ln(t.top,r.top,l)),r.bottom!=null&&t.bottom!=null&&(this.bottom=Ln(t.bottom,r.bottom,l)),r.left!=null&&t.left!=null&&(this.left=Ln(t.left,r.left,l)),r.right!=null&&t.right!=null&&(this.right=Ln(t.right,r.right,l)),this}getCenter(t,r){const l=ae((this.left+t-this.right)/2,0,t),u=ae((this.top+r-this.bottom)/2,0,r);return new V(l,u)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new WP(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function kN(i,t){const r=Et(i,3);at.fromQuat(i,t),Ut(i,3,r)}function VP(i,t){const r=To.identity([]);return To.rotateZ(r,r,-t),To.rotateX(r,r,-i),r}function DN(i,t){const r=[i[0],i[1],0],l=[t[0],t[1],0];if(ke.length(r)>=1e-15){const p=ke.normalize([],r);ke.scale(l,p,ke.dot(l,p)),t[0]=l[0],t[1]=l[1]}const u=ke.cross([],t,i);if(ke.len(u)<1e-15)return null;const h=Math.atan2(-u[1],u[0]);return VP(Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2]),h)}class ON{constructor(t,r){this.position=t,this.orientation=r}get position(){return this._position}set position(t){if(t){const r=t instanceof ga?t:new ga(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=Ze(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const l=this.position,u=this._elevation?this._elevation.getAtPointOrZero(ga.fromLngLat(t)):0,h=ga.fromLngLat(t,u),p=[h.x-l.x,h.y-l.y,h.z-l.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=DN(p,r)}setPitchBearing(t,r){this.orientation=VP(be(t),be(-r))}}class u3{constructor(t,r){this._transform=at.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new ga(t[0],t[1],t[2])}get position(){const t=Et(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&Ut(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||To.identity([]),t&&kN(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,r){this._orientation=VP(t,r),kN(this._transform,this._orientation)}forward(){const t=Et(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=Et(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=Et(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const l=new Float64Array(16);return at.invert(l,this.getWorldToCamera(t,r)),l}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,r,l){const u=this.position;ke.scale(u,u,-t);const h=new Float64Array(16);return at.fromScaling(h,[l,l,l]),at.translate(h,h,u),h[10]*=r,h}getWorldToCamera(t,r){const l=new Float64Array(16),u=new Float64Array(4),h=this.position;return To.conjugate(u,this._orientation),ke.scale(h,h,-t),at.fromQuat(l,u),at.translate(l,l,h),l[1]*=-1,l[5]*=-1,l[9]*=-1,l[13]*=-1,l[8]*=r,l[9]*=r,l[10]*=r,l[11]*=r,l}getCameraToClipPerspective(t,r,l,u){const h=new Float64Array(16);return at.perspective(h,t,r,l,u),h}getCameraToClipOrthographic(t,r,l,u,h,p){const g=new Float64Array(16);return at.ortho(g,t,r,l,u,h,p),g}getDistanceToElevation(t,r=!1){const l=t===0?0:$a(t,r?gr(this.position[1]):this.position[1]),u=this.forward();return(l-this.position[2])/u[2]}clone(){return new u3([...this.position],[...this.orientation])}}function zN(i,t){const r=b1(i.projection,i.zoom,i.width,i.height),l=function(h,p,g,v,b){const w=new On(g.lng-180*Cf,g.lat),A=new On(g.lng+180*Cf,g.lat),C=h.project(w.lng,w.lat),P=h.project(A.lng,A.lat),R=-Math.atan2(P.y-C.y,P.x-C.x),z=ga.fromLngLat(g);z.y=ae(z.y,-1+Cf,1-Cf);const U=z.toLngLat(),W=h.project(U.lng,U.lat),j=ga.fromLngLat(U);j.x+=Cf;const Y=j.toLngLat(),Z=h.project(Y.lng,Y.lat),$=BN(Z.x-W.x,Z.y-W.y,R),K=ga.fromLngLat(U);K.y+=Cf;const ie=K.toLngLat(),ce=h.project(ie.lng,ie.lat),he=BN(ce.x-W.x,ce.y-W.y,R),ye=Math.abs($.x)/Math.abs(he.y),Te=at.identity([]);at.rotateZ(Te,Te,-R*(1-(b?0:v)));const we=at.identity([]);return at.scale(we,we,[1,1-(1-ye)*v,1]),we[4]=-he.x/he.y*v,at.rotateZ(we,we,R),at.multiply(we,Te,we),we}(i.projection,0,i.center,r,t),u=FN(i);return at.scale(l,l,[u,u,1]),l}function FN(i){const t=i.projection,r=b1(i.projection,i.zoom,i.width,i.height),l=NN(t,i.center),u=NN(t,On.convert(t.center));return Math.pow(2,l*r+(1-r)*u)}function b1(i,t,r,l,u=1/0){const h=i.range;if(!h)return 0;const p=Math.min(u,Math.max(r,l)),g=Math.log(p/1024)/Math.LN2;return Ee(h[0]+g,h[1]+g,t)}const Cf=1/4e4;function NN(i,t){const r=ae(t.lat,-$i,$i),l=new On(t.lng-180*Cf,r),u=new On(t.lng+180*Cf,r),h=i.project(l.lng,r),p=i.project(u.lng,r),g=ga.fromLngLat(l),v=ga.fromLngLat(u),b=p.x-h.x,w=p.y-h.y,A=v.x-g.x,C=v.y-g.y,P=Math.sqrt((A*A+C*C)/(b*b+w*w));return Math.log(P)/Math.LN2}function BN(i,t,r){const l=Math.cos(r),u=Math.sin(r);return{x:i*l-t*u,y:i*u+t*l}}function wm(i,t,r){return t*(ht/(i.tileSize*Math.pow(2,r-i.tileID.overscaledZ)))}const pv={unknown:0,flipRequired:1,flipNotRequired:2},Xne=Math.tan(85*Math.PI/180);function d3(i,t,r,l,u,h,p){const g=at.create();if(r)if(h.name==="globe"){const v=function(b,w){const{x:A,y:C}=b.point,P=rF(A,C,b.worldSize/b._pixelsPerMercatorPixel,0,0);return at.multiply(P,P,QC(pc(w)))}(u,t);at.multiply(g,g,v)}else{const v=Ky.invert([],p);g[0]=v[0],g[1]=v[1],g[4]=v[2],g[5]=v[3],l||at.rotateZ(g,g,u.angle)}else at.multiply(g,u.labelPlaneMatrix,i);return g}function UN(i,t,r,l,u,h,p){const g=d3(i,t,r,l,u,h,p);return h.name==="globe"&&r||(g[2]=g[6]=g[10]=g[14]=0),g}function WN(i,t,r,l,u,h,p){if(r){if(h.name==="globe"){const g=d3(i,t,r,l,u,h,p);return at.invert(g,g),at.multiply(g,i,g),g}{const g=at.clone(i),v=at.identity([]);return v[0]=p[0],v[1]=p[1],v[4]=p[2],v[5]=p[3],at.multiply(g,g,v),l||at.rotateZ(g,g,-u.angle),g}}return u.glCoordMatrix}function qc(i,t,r,l){const u=[i,t,r,1];r?Ga.transformMat4(u,u,l):XN(u,u,l);const h=u[3];return u[0]/=h,u[1]/=h,u[2]/=h,u}function VN(i,t){return Math.min(.5+i/t*.5,1.5)}function Yne(i,t){const r=i[0]/i[3],l=i[1]/i[3];return r>=-t[0]&&r<=t[0]&&l>=-t[1]&&l<=t[1]}function Zne(i,t,r,l,u,h,p,g,v,b){const w=r.transform,A=l?i.textSizeData:i.iconSizeData,C=Hu(A,r.transform.zoom),P=w.projection.name==="globe",R=[256/r.width*2+1,256/r.height*2+1],z=l?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;z.clear();let U=null;P&&(U=l?i.text.globeExtVertexArray:i.icon.globeExtVertexArray);const W=i.lineVertexArray,j=l?i.text.placedSymbolArray:i.icon.placedSymbolArray,Y=r.transform.width/r.transform.height;let Z,$=!1;for(let K=0;K<j.length;K++){const ie=j.get(K),{numGlyphs:ce,writingMode:he}=ie;if(he!==bi.vertical||$||Z===bi.horizontal||($=!0),Z=he,(ie.hidden||he===bi.vertical)&&!$){mv(ce,z);continue}$=!1;const ye=new V(ie.tileAnchorX,ie.tileAnchorY);let{x:Te,y:we,z:Ie}=w.projection.projectTilePoint(ye.x,ye.y,b.canonical);if(v){const[Pt,Ft,xt]=v(ye);Te+=Pt,we+=Ft,Ie+=xt}const xe=[Te,we,Ie,1];if(Ga.transformMat4(xe,xe,t),!Yne(xe,R)){mv(ce,z);continue}const We=xe[3],qe=VN(r.transform.getCameraToCenterDistance(w.projection),We),et=l1(A,C,ie),Ne=p?et/qe:et*qe,Ve=qc(Te,we,Ie,u);if(Ve[3]<=0){mv(ce,z);continue}let it={};const gt=p?null:v,ct=jN(ie,Ne,!1,g,t,u,h,i.glyphOffsetArray,W,z,U,Ve,ye,it,Y,gt,w.projection,b,p);$=ct.useVertical,gt&&ct.needsFlipping&&(it={}),(ct.notEnoughRoom||$||ct.needsFlipping&&jN(ie,Ne,!0,g,t,u,h,i.glyphOffsetArray,W,z,U,Ve,ye,it,Y,gt,w.projection,b,p).notEnoughRoom)&&mv(ce,z)}l?(i.text.dynamicLayoutVertexBuffer.updateData(z),U&&i.text.globeExtVertexBuffer&&i.text.globeExtVertexBuffer.updateData(U)):(i.icon.dynamicLayoutVertexBuffer.updateData(z),U&&i.icon.globeExtVertexBuffer&&i.icon.globeExtVertexBuffer.updateData(U))}function GN(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z){const{lineStartIndex:U,glyphStartIndex:W,segment:j}=g,Y=W+g.numGlyphs,Z=U+g.lineLength,$=t.getoffsetX(W),K=t.getoffsetX(Y-1),ie=h3(i*$,r,l,u,h,p,j,U,Z,v,b,w,A,C,!0,P,R,z);if(!ie)return null;const ce=h3(i*K,r,l,u,h,p,j,U,Z,v,b,w,A,C,!0,P,R,z);return ce?{first:ie,last:ce}:null}function HN(i,t,r,l){return i===bi.horizontal&&Math.abs(l)>Math.abs(r)?{useVertical:!0}:i===bi.vertical?l>0?{needsFlipping:!0}:null:t!==pv.unknown&&function(u,h){return u===0||Math.abs(h/u)>Xne}(r,l)?t===pv.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function jN(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j){const Y=t/24,Z=i.lineOffsetX*Y,$=i.lineOffsetY*Y,{lineStartIndex:K,glyphStartIndex:ie,numGlyphs:ce,segment:he,writingMode:ye,flipState:Te}=i,we=K+i.lineLength,Ie=xe=>{if(w){const[Ne,Ve,it]=xe.up,gt=b.length;i3(w,gt+0,Ne,Ve,it),i3(w,gt+1,Ne,Ve,it),i3(w,gt+2,Ne,Ve,it),i3(w,gt+3,Ne,Ve,it)}const[We,qe,et]=xe.point;fv(b,We,qe,et,xe.angle)};if(ce>1){const xe=GN(Y,g,Z,$,r,A,C,i,v,h,P,z,!1,U,W,j);if(!xe)return{notEnoughRoom:!0};if(l&&!r){let[We,qe,et]=xe.first.point,[Ne,Ve,it]=xe.last.point;[We,qe]=qc(We,qe,et,p),[Ne,Ve]=qc(Ne,Ve,it,p);const gt=HN(ye,Te,(Ne-We)*R,Ve-qe);if(i.flipState=gt&&gt.needsFlipping?pv.flipRequired:pv.flipNotRequired,gt)return gt}Ie(xe.first);for(let We=ie+1;We<ie+ce-1;We++){const qe=h3(Y*g.getoffsetX(We),Z,$,r,A,C,he,K,we,v,h,P,z,!1,!1,U,W,j);if(!qe)return b.length-=4*(We-ie),{notEnoughRoom:!0};Ie(qe)}Ie(xe.last)}else{if(l&&!r){const We=qc(C.x,C.y,0,u),qe=K+he+1,et=new V(v.getx(qe),v.gety(qe)),Ne=qc(et.x,et.y,0,u),Ve=Ne[3]>0?Ne:qN(C,et,We,1,u,void 0,U,W.canonical),it=HN(ye,Te,(Ve[0]-We[0])*R,Ve[1]-We[1]);if(i.flipState=it&&it.needsFlipping?pv.flipRequired:pv.flipNotRequired,it)return it}const xe=h3(Y*g.getoffsetX(ie),Z,$,r,A,C,he,K,we,v,h,P,z,!1,!1,U,W,j);if(!xe)return{notEnoughRoom:!0};Ie(xe)}return{}}function $N(i,t,r,l,u){const{x:h,y:p,z:g}=l.projectTilePoint(i.x,i.y,t);if(!u)return qc(h,p,g,r);const[v,b,w]=u(i);return qc(h+v,p+b,g+w,r)}function qN(i,t,r,l,u,h,p,g){const v=$N(i.sub(t)._unit()._add(i),g,u,p,h);return ke.sub(v,r,v),ke.normalize(v,v),ke.scaleAndAdd(v,r,v,l)}function h3(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W){const j=l?i-t:i+t;let Y=j>0?1:-1,Z=0;l&&(Y*=-1,Z=Math.PI),Y<0&&(Z+=Math.PI);let $=g+p+(Y>0?0:1)|0,K=u,ie=u,ce=0,he=0;const ye=Math.abs(j),Te=[],we=[];let Ie=h,xe=Ie;const We=()=>qN(xe,Ie,ie,ye-ce+1,w,C,z,U.canonical);for(;ce+he<=ye;){if($+=Y,$<g||$>=v)return null;if(ie=K,xe=Ie,Te.push(ie),P&&we.push(xe),Ie=new V(b.getx($),b.gety($)),K=A[$],!K){const Ft=$N(Ie,U.canonical,w,z,C);K=Ft[3]>0?A[$]=Ft:We()}ce+=he,he=ke.distance(ie,K)}R&&C&&(A[$]&&(K=We(),he=ke.distance(ie,K)),A[$]=K);const qe=(ye-ce)/he,et=Ie.sub(xe)._mult(qe)._add(xe),Ne=ke.sub([],K,ie),Ve=ke.scaleAndAdd([],ie,Ne,qe);let it=[0,0,1],gt=Ne[0],ct=Ne[1];if(W&&(it=z.upVector(U.canonical,et.x,et.y),it[0]!==0||it[1]!==0||it[2]!==1)){const Ft=[it[2],0,-it[0]],xt=ke.cross([],it,Ft);ke.normalize(Ft,Ft),ke.normalize(xt,xt),gt=ke.dot(Ne,Ft),ct=ke.dot(Ne,xt)}if(r){const Ft=ke.cross([],it,Ne);ke.normalize(Ft,Ft),ke.scaleAndAdd(Ve,Ve,Ft,r*Y)}const Pt=Z+Math.atan2(ct,gt);return Te.push(Ve),P&&we.push(et),{point:Ve,angle:Pt,path:Te,tilePath:we,up:it}}function mv(i,t){const r=t.length,l=r+4*i;t.resize(l),t.float32.fill(-1/0,4*r,4*l)}function XN(i,t,r){const l=t[0],u=t[1];return i[0]=r[0]*l+r[4]*u+r[12],i[1]=r[1]*l+r[5]*u+r[13],i[3]=r[3]*l+r[7]*u+r[15],i}const YN=(i,t,r)=>(1-r)*i+r*t,ZN=i=>i*i*i*i*i;class GP{constructor(t,r,l,u,h,p,g){this.tileSize=512,this._renderWorldCopies=h===void 0||h,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=l??0,this._maxPitch=u??60,this.setProjection(p),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new On(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new WP,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new u3,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new GP(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t,r=!1){const l=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||l)&&this._updateCameraOnTerrain(),(t||l)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return ft(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=Q2(this.projectionOptions);const l=!Q(r,this.getProjection());return l&&this._calcMatrices(),this.mercatorFromTransition=!1,l}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=Q2({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return $a(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new V(this.width,this.height)}get bearing(){return Ze(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Ky.create(),Ky.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=ae(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=be(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,r=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!r||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;r||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&l.exaggeration()&&this._centerAltitudeValidForExaggeration!==l.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*l.exaggeration(),this._centerAltitudeValidForExaggeration=l.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=l.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],l=this.horizonLineFromTop();let u=0,h=0;for(let p=0;p<r.length;p++){const g=new V(r[p][0]*this.width,l+r[p][1]*(this.height-l)),v=t.pointCoordinate(g);if(!v)continue;const b=1/Math.hypot(v[0]-this._camera.position[0],v[1]-this._camera.position[1]);u+=v[3]*b,h+=b}return h===0?NaN:u/h}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),l=this.pixelsPerMeter/this.worldSize*r,u=this._mercatorZfromZoom(t),h=this._mercatorZfromZoom(this._maxZoom),p=Math.max(u-l,h);this._setZoom(this._zoomFromMercatorZ(p))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let l;l=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const u=ke.length(ke.sub([],this._camera.position,l));return ae(this._zoomFromMercatorZ(u),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!To.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const l=[t.position.x,t.position.y,t.position.z];ke.exactEquals(l,this._camera.position)||(this._setCameraPosition(l),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new ON;return r.position=new ga(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!To.length(t))return!1;To.normalize(t,t);const r=ke.transformQuat([],[0,0,-1],t),l=ke.transformQuat([],[0,-1,0],t);if(l[2]<0)return!1;const u=DN(r,l);return!!u&&(this._camera.orientation=u,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,l=this.zoomScale(this.maxZoom)*this.tileSize,u=this.cameraToCenterDistance;t[2]=ae(t[2],u/l,u/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,l){this._unmodified=!1,this._edgeInsets.interpolate(t,r,l),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(t){const r=[new qC(0,t)];if(this.renderWorldCopies){const l=this.pointCoordinate(new V(0,0)),u=this.pointCoordinate(new V(this.width,0)),h=this.pointCoordinate(new V(this.width,this.height)),p=this.pointCoordinate(new V(0,this.height)),g=Math.floor(Math.min(l.x,u.x,h.x,p.x)),v=Math.floor(Math.max(l.x,u.x,h.x,p.x)),b=1;for(let w=g-b;w<=v+b;w++)w!==0&&r.push(new qC(w,t))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,r,l){let u=[];if(r[0]===0&&r[1]===0)return u;for(const p of t){const g=p.canonical,v=p.overscaledZ,b=p.wrap,w=1<<g.z,A=g.x+1<w,C=g.x>0,P=g.y+1<w,R=g.y>0,z=p.wrap-(C?0:1),U=p.wrap+(A?0:1),W=C?g.x-1:w-1,j=A?g.x+1:0;r[0]<0?(u.push(new Ca(v,U,g.z,j,g.y)),r[1]<0&&P&&(u.push(new Ca(v,b,g.z,g.x,g.y+1)),u.push(new Ca(v,U,g.z,j,g.y+1))),r[1]>0&&R&&(u.push(new Ca(v,b,g.z,g.x,g.y-1)),u.push(new Ca(v,U,g.z,j,g.y-1)))):r[0]>0?(u.push(new Ca(v,z,g.z,W,g.y)),r[1]<0&&P&&(u.push(new Ca(v,b,g.z,g.x,g.y+1)),u.push(new Ca(v,z,g.z,W,g.y+1))),r[1]>0&&R&&(u.push(new Ca(v,b,g.z,g.x,g.y-1)),u.push(new Ca(v,z,g.z,W,g.y-1)))):r[1]<0&&P?u.push(new Ca(v,b,g.z,g.x,g.y+1)):R&&u.push(new Ca(v,b,g.z,g.x,g.y-1))}if(u.length>1){u.sort((v,b)=>v.overscaledZ-b.overscaledZ||v.wrap-b.wrap||v.canonical.z-b.canonical.z||v.canonical.x-b.canonical.x||v.canonical.y-b.canonical.y);let p=0,g=0;for(;g<u.length;)u[g].equals(u[p])?++g:u[++p]=u[g++];u.length=p+1}const h=[];for(const p of u)u.some(g=>p.isChildOf(g))||h.push(p);return u=h.filter(p=>!t.some(g=>!!(p.overscaledZ<l&&g.isChildOf(p))||p.equals(g)||p.isChildOf(g))),u}coveringTiles(t){let r=this.coveringZoomLevel(t);const l=r,u=this.elevation&&this.elevation.exaggeration(),h=u&&!t.isTerrainDEM,p=this.projection.name==="mercator";if(t.minzoom!==void 0&&r<t.minzoom)return[];t.maxzoom!==void 0&&r>t.maxzoom&&(r=t.maxzoom);const g=this.locationCoordinate(this.center),v=this.center.lat,b=1<<r,w=[b*g.x,b*g.y,0],A=this.projection.name==="globe",C=!A,P=Jd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,C),R=A?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),z=b*$a(1,this.center.lat),U=this._camera.position[2]/$a(1,this.center.lat),W=[b*R.x,b*R.y,U*(C?1:z)],j=A||u,Y=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Z=this.isLODDisabled(!0)?r:0,$=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,K=t.isTerrainDEM?-$:this._elevation?this._elevation.getMinElevationBelowMSL():0,ie=this.projection.isReprojectedInTileSpace?FN(this):1,ce=Ne=>{const it=new ga(Ne.x+25e-6,Ne.y,Ne.z),gt=new ga(Ne.x,Ne.y+25e-6,Ne.z),ct=Ne.toLngLat(),Pt=it.toLngLat(),Ft=gt.toLngLat(),xt=this.locationCoordinate(ct),Mt=this.locationCoordinate(Pt),en=this.locationCoordinate(Ft),on=Math.hypot(Mt.x-xt.x,Mt.y-xt.y),rn=Math.hypot(en.x-xt.x,en.y-xt.y);return Math.sqrt(on*rn)*ie/25e-6},he=Ne=>{const Ve=$,it=K;return{aabb:xN(this,b,0,0,0,Ne,it,Ve,this.projection),zoom:0,x:0,y:0,minZ:it,maxZ:Ve,wrap:Ne,fullyVisible:!1}},ye=[];let Te=[];const we=r,Ie=t.reparseOverscaled?l:r,xe=Ne=>Ne*Ne,We=xe((U-this._centerAltitude)*z),qe=Ne=>{if(!this._elevation||!Ne.tileID||!p)return;const Ve=this._elevation.getMinMaxForTile(Ne.tileID),it=Ne.aabb;Ve?(it.min[2]=Ve.min,it.max[2]=Ve.max,it.center[2]=(it.min[2]+it.max[2])/2):(Ne.shouldSplit=et(Ne),Ne.shouldSplit||(it.min[2]=it.max[2]=it.center[2]=this._centerAltitude))},et=Ne=>{if(Ne.zoom<Z)return!0;if(Ne.zoom===we)return!1;if(Ne.shouldSplit!=null)return Ne.shouldSplit;const Ve=Ne.aabb.distanceX(W),it=Ne.aabb.distanceY(W);let gt=We,ct=1;if(A){gt=xe(Ne.aabb.distanceZ(W));const xt=Math.pow(2,Ne.zoom),Mt=gr((Ne.y+1)/xt),en=gr(Ne.y/xt),on=Math.min(Math.max(v,Mt),en),rn=C2(on)/C2(v);if(ct=on===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,rn/this._mercatorScaleRatio),this.zoom<=n1&&Ne.zoom===we-1&&rn>=.9)return!0}else if(h&&(gt=xe(Ne.aabb.distanceZ(W)*z)),this.projection.isReprojectedInTileSpace&&l<=5){const xt=Math.pow(2,Ne.zoom),Mt=ce(new ga((Ne.x+.5)/xt,(Ne.y+.5)/xt));ct=Mt>.85?1:Mt}const Pt=Ve*Ve+it*it+gt,Ft=xe((1<<we-Ne.zoom)*Y*ct*((xt,Mt)=>{if(Mt*xe(.707)<xt)return 1;const en=Math.sqrt(Mt/xt);return en/(1.4144271570014144+(Math.pow(1.1,en-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(gt,We),Pt));return Pt<Ft};if(this.renderWorldCopies)for(let Ne=1;Ne<=3;Ne++)ye.push(he(-Ne)),ye.push(he(Ne));for(ye.push(he(0));ye.length>0;){const Ne=ye.pop(),Ve=Ne.x,it=Ne.y;let gt=Ne.fullyVisible;const ct=()=>this.projection.name==="globe"&&(Ne.y===0||Ne.y===(1<<Ne.zoom)-1);if(!gt){let Pt=j?Ne.aabb.intersects(P):Ne.aabb.intersectsFlat(P);if(Pt===0&&ct()){const Ft=new Vu(Ne.zoom,Ve,it);Pt=KC(this,b,Ft,!0).intersects(P)}if(Pt===0)continue;gt=Pt===2}if(Ne.zoom!==we&&et(Ne))for(let Pt=0;Pt<4;Pt++){const Ft=(Ve<<1)+Pt%2,xt=(it<<1)+(Pt>>1),Mt={aabb:p?Ne.aabb.quadrant(Pt):xN(this,b,Ne.zoom+1,Ft,xt,Ne.wrap,Ne.minZ,Ne.maxZ,this.projection),zoom:Ne.zoom+1,x:Ft,y:xt,wrap:Ne.wrap,fullyVisible:gt,tileID:void 0,shouldSplit:void 0,minZ:Ne.minZ,maxZ:Ne.maxZ};h&&!A&&(Mt.tileID=new Ca(Ne.zoom+1===we?Ie:Ne.zoom+1,Ne.wrap,Ne.zoom+1,Ft,xt),qe(Mt)),ye.push(Mt)}else{const Pt=Ne.zoom===we?Ie:Ne.zoom;if(t.minzoom&&t.minzoom>Pt)continue;if(!gt){let en=j?Ne.aabb.intersectsPrecise(P):Ne.aabb.intersectsPreciseFlat(P);if(en===0&&ct()){const on=new Vu(Ne.zoom,Ve,it);en=KC(this,b,on,!0).intersectsPrecise(P)}if(en===0)continue}const Ft=w[0]-(.5+Ve+(Ne.wrap<<Ne.zoom))*(1<<r-Ne.zoom),xt=w[1]-.5-it,Mt=Ne.tileID?Ne.tileID:new Ca(Pt,Ne.wrap,Ne.zoom,Ve,it);Te.push({tileID:Mt,distanceSq:Ft*Ft+xt*xt})}}if(this.fogCullDistSq){const Ne=this.fogCullDistSq,Ve=this.horizonLineFromTop();Te=Te.filter(it=>{const gt=[0,0,0,1],ct=[ht,ht,0,1],Pt=this.calculateFogTileMatrix(it.tileID.toUnwrapped());Ga.transformMat4(gt,gt,Pt),Ga.transformMat4(ct,ct,Pt);const Ft=function(en,on,rn){let cn=0;for(let gn=0;gn<2;++gn)en[gn]>0&&(cn+=(en[gn]-0)*(en[gn]-0)),on[gn]<0&&(cn+=(0-on[gn])*(0-on[gn]));return cn}(Ga.min([],gt,ct),Ga.max([],gt,ct));if(Ft===0)return!0;let xt=!1;const Mt=this._elevation;if(Mt&&Ft>Ne&&Ve!==0){const en=this.calculateProjMatrix(it.tileID.toUnwrapped());let on;t.isTerrainDEM||(on=Mt.getMinMaxForTile(it.tileID)),on||(on={min:K,max:$});const rn=function(gn){const kn=Math.round((gn+45+360)%360/90)%4;return Ce[kn]}(this.rotation),cn=[rn[0]*ht,rn[1]*ht,on.max];ke.transformMat4(cn,cn,en),xt=(1-cn[1])*this.height*.5<Ve}return Ft<Ne||xt})}return Te.sort((Ne,Ve)=>Ne.distanceSq-Ve.distanceSq).map(Ne=>Ne.tileID)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=ae(t.lat,-$i,$i),l=this.projection.project(t.lng,r);return new V(l.x*this.worldSize,l.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/$a(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let l,u;const h=this.centerPoint;if(this.projection.name==="globe"){const g=this.worldSize;l=(r.x-h.x)/g,u=(r.y-h.y)/g}else{const g=this.pointCoordinate(r),v=this.pointCoordinate(h);l=g.x-v.x,u=g.y-v.y}const p=this.locationCoordinate(t);this.setLocation(new ga(p.x-l,p.y-u))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,r){const l=r?$a(r,t.lat):void 0,u=this.projection.project(t.lng,t.lat);return new ga(u.x,u.y,l)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,r){const l=r??this._centerAltitude,u=[t.x,t.y,0,1],h=[t.x,t.y,1,1];Ga.transformMat4(u,u,this.pixelMatrixInverse),Ga.transformMat4(h,h,this.pixelMatrixInverse);const p=h[3];Ga.scale(u,u,1/u[3]),Ga.scale(h,h,1/p);const g=u[2],v=h[2];return{p0:u,p1:h,t:g===v?0:(l-g)/(v-g)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],l=[t.x,t.y,1,1];return Ga.transformMat4(r,r,this.pixelMatrixInverse),Ga.transformMat4(l,l,this.pixelMatrixInverse),Ga.scale(r,r,1/r[3]),Ga.scale(l,l,1/l[3]),r[2]=$a(r[2],this._center.lat)*this.worldSize,l[2]=$a(l[2],this._center.lat)*this.worldSize,Ga.scale(r,r,1/this.worldSize),Ga.scale(l,l,1/this.worldSize),new S2([r[0],r[1],r[2]],ke.normalize([],ke.sub([],l,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:l,t:u}=t,h=$a(r[2],this._center.lat),p=$a(l[2],this._center.lat);return new ga(Ln(r[0],l[0],u)/this.worldSize,Ln(r[1],l[1],u)/this.worldSize,Ln(h,p,u))}pointCoordinate(t,r=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,r)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new ga(r[0],r[1],r[2]);let l=0,u=this.horizonLineFromTop();if(t.y>u)return this.pointCoordinate(t);const h=.02*u,p=t.clone();for(let g=0;g<10&&u-l>h;g++){p.y=Ln(l,u,.66);const v=this.projection.pointCoordinate3D(this,p.x,p.y);v?(u=p.y,r=v):l=p.y}return r?new ga(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=gf)return!this.isPointAboveHorizon(t);const r=this.pointCoordinate(t);return r.y>=0&&r.y<=1}_coordinatePoint(t,r){const l=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,u=[t.x*this.worldSize,t.y*this.worldSize,l+t.toAltitude(),1];return Ga.transformMat4(u,u,this.pixelMatrix),u[3]>0?new V(u[0]/u[3],u[1]/u[3]):new V(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,l=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,h=this.pointLocation3D(new V(r,t)),p=this.pointLocation3D(new V(u,t)),g=this.pointLocation3D(new V(u,l)),v=this.pointLocation3D(new V(r,l));let b=Math.min(h.lng,p.lng,g.lng,v.lng),w=Math.max(h.lng,p.lng,g.lng,v.lng),A=Math.min(h.lat,p.lat,g.lat,v.lat),C=Math.max(h.lat,p.lat,g.lat,v.lat);const P=Math.pow(2,-this.zoom)/16*270,R=this.projection.name==="globe"?1:4,z=(U,W,j,Y,Z)=>{const $=(U+j)/2,K=(W+Y)/2,ie=new V($,K),{lng:ce,lat:he}=this.pointLocation3D(ie),ye=Math.max(0,b-ce,A-he,ce-w,he-C);b=Math.min(b,ce),w=Math.max(w,ce),A=Math.min(A,he),C=Math.max(C,he),(Z<R||ye>P)&&(z(U,W,$,K,Z+1),z($,K,j,Y,Z+1))};if(z(r,t,u,t,1),z(u,t,u,l,1),z(u,l,r,l,1),z(r,l,r,t,1),this.projection.name==="globe"){const[U,W]=function(j){const Y=at.identity(new Float64Array(16));at.multiply(Y,j.pixelMatrix,j.globeMatrix);const Z=[0,hc,0],$=[0,fc,0];return ke.transformMat4(Z,Z,Y),ke.transformMat4($,$,Y),[Z[0]>0&&Z[0]<=j.width&&Z[1]>0&&Z[1]<=j.height&&!T2(j,new On(j.center.lat,90)),$[0]>0&&$[0]<=j.width&&$[1]>0&&$[1]<=j.height&&!T2(j,new On(j.center.lat,-90))]}(this);U?(C=90,w=180,b=-180):W&&(A=-90,w=180,b=-180)}return new Dl(new On(b,A),new On(w,C))}_getBoundsRectangular(t,r){const{top:l,left:u}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,p=this.width-this._edgeInsets.right,g=new V(u,l),v=new V(p,l),b=new V(p,h),w=new V(u,h);let A=this.pointCoordinate(g,t),C=this.pointCoordinate(v,t);const P=this.pointCoordinate(b,r),R=this.pointCoordinate(w,r),z=(U,W)=>(W.y-U.y)/(W.x-U.x);return A.y>1&&C.y>=0?A=new ga((1-R.y)/z(R,A)+R.x,1):A.y<0&&C.y<=1&&(A=new ga(-R.y/z(R,A)+R.x,0)),C.y>1&&A.y>=0?C=new ga((1-P.y)/z(P,C)+P.x,1):C.y<0&&A.y<=1&&(C=new ga(-P.y/z(P,C)+P.x,0)),new Dl().extend(this.coordinateLocation(A)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(R)).extend(this.coordinateLocation(P))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=t.visibleDemTiles.reduce((l,u)=>{if(u.dem){const h=u.dem.tree;l.min=Math.min(l.min,h.minimums[0]),l.max=Math.max(l.max,h.maximums[0])}return l},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*t.exaggeration(),r.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,l=this.height/2-r*(1-this._horizonShift);return t?Math.max(0,l):l}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-$i,this.maxLat=$i,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=_o(this.minLng)*this.tileSize,this.worldMaxX=_o(this.maxLng)*this.tileSize,this.worldMinY=Co(this.maxLat)*this.tileSize,this.worldMaxY=Co(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,r){return this.projection.createTileMatrix(this,r,t)}calculateDistanceTileData(t){const r=t.key,l=this._distanceTileDataCache;if(l[r])return l[r];const u=t.canonical,h=1/this.height,p=this.cameraWorldSize,g=p/this.zoomScale(u.z),v=(u.x+Math.pow(2,u.z)*t.wrap)*g,b=u.y*g,w=this.point;w.x*=p/this.worldSize,w.y*=p/this.worldSize;const A=this.angle,C=Math.sin(-A),P=-Math.cos(-A);return l[r]={bearing:[C,P],center:[(w.x-v)*h,(w.y-b)*h],scale:g/ht*h},l[r]}calculateFogTileMatrix(t){const r=t.key,l=this._fogTileMatrixCache;if(l[r])return l[r];const u=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return at.multiply(u,this.worldToFogMatrix,u),l[r]=new Float32Array(u),l[r]}calculateProjMatrix(t,r=!1){const l=t.key,u=r?this._alignedProjMatrixCache:this._projMatrixCache;if(u[l])return u[l];const h=this.calculatePosMatrix(t,this.worldSize);return at.multiply(h,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.alignedProjMatrix:this.projMatrix,h),u[l]=new Float32Array(h),u[l]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,l=this._pixelsToTileUnitsCache;if(l[r])return l[r];const u=function(h,p){const{scale:g}=h.tileTransform,v=g*ht/(h.tileSize*Math.pow(2,p.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return Ky.scale(new Float32Array(4),p.inverseAdjustmentMatrix,[v,v])}(t,this);return l[r]=u,l[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,r=at.fromScaling([],[t,t,t]);return at.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const r=$a(1,this._center.lat)*this.worldSize,l=this._computeCameraPosition(r),u=this._camera.forward(),h=$a(1,this._center.lat);l[2]/=h,u[2]/=h,ke.normalize(u,u);const p=t.raycast(l,u,t.exaggeration());if(p){const g=ke.scaleAndAdd([],l,u,p),v=new ga(g[0],g[1],$a(g[2],gr(g[1]))),b=(v.z+ke.length([v.x-l[0],v.y-l[1],v.z-l[2]*h]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(b),this._centerAltitude=v.toAltitude(),this._center=this.coordinateLocation(v),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,l=$a(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(l),h=r.getAtPointOrZero(new ga(...u)),p=this.pixelsPerMeter/this.worldSize*h,g=this._minimumHeightOverTerrain(),v=u[2]-p;if(v<=g)if(v<0||t){const b=this.locationCoordinate(this._center,this._centerAltitude),w=[u[0],u[1],b.z-u[2]],A=ke.length(w);w[2]-=(g-v)/this._pixelsPerMercatorPixel;const C=ke.length(w);if(C===0)return;ke.scale(w,w,A/C*this._pixelsPerMercatorPixel),this._camera.position=[u[0],u[1],b.z*this._pixelsPerMercatorPixel-w[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const C=this.center;return C.lat=ae(C.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(C.lng=ae(C.lng,this.minLng,this.maxLng)),this.center=C,void(this._constraining=!1)}const r=this._unmodified,{x:l,y:u}=this.point;let h=0,p=l,g=u;const v=this.width/2,b=this.height/2,w=this.worldMinY*this.scale,A=this.worldMaxY*this.scale;if(u-b<w&&(g=w+b),u+b>A&&(g=A-b),A-w<this.height&&(h=Math.max(h,this.height/(A-w)),g=(A+w)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const C=this.worldMinX*this.scale,P=this.worldMaxX*this.scale,R=this.worldSize/2-(C+P)/2;p=(l+R+this.worldSize)%this.worldSize-R,p-v<C&&(p=C+v),p+v>P&&(p=P-v),P-C<this.width&&(h=Math.max(h,this.width/(P-C)),p=(P+C)/2)}p===l&&g===u||(this.center=this.unproject(new V(p,g))),h&&(this.zoom+=this.scaleZoom(h)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r=this.projection.name==="globe",l=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=$a(1,this.center.lat)/$a(1,45));const u=b1(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,u),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const h=this.projection.zAxisUnit==="meters"?l:1,p=this._camera.getWorldToCamera(this.worldSize,h);let g;const v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(v[8]=2*-t.x/this.width,v[9]=2*t.y/this.height,this.isOrthographic){let he=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ye=he*this.aspect,Te=-ye,we=-he;ye-=t.x,Te-=t.x,he+=t.y,we+=t.y,g=this._camera.getCameraToClipOrthographic(Te,ye,we,he,this._nearZ,this._farZ),((Ie,xe,We,qe)=>{for(let et=0;et<16;et++)Ie[et]=YN(xe[et],We[et],qe)})(g,g,v,ZN(this.pitch>=15?1:this.pitch/15))}else g=v;const b=at.mul([],v,p);let w=at.mul([],g,p);if(this.projection.isReprojectedInTileSpace){const he=this.locationCoordinate(this.center),ye=at.identity([]);at.translate(ye,ye,[he.x*this.worldSize,he.y*this.worldSize,0]),at.multiply(ye,ye,zN(this)),at.translate(ye,ye,[-he.x*this.worldSize,-he.y*this.worldSize,0]),at.multiply(w,w,ye),at.multiply(b,b,ye),this.inverseAdjustmentMatrix=function(Te){const we=zN(Te,!0);return Ky.invert([],[we[0],we[1],we[4],we[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=at.scale([],w,[this.worldSize,this.worldSize,this.worldSize/h,1]),this.projMatrix=w,this.invProjMatrix=at.invert(new Float64Array(16),this.projMatrix);const A=at.invert([],g);this.frustumCorners=XC.fromInvProjectionMatrix(A,this.horizonLineFromTop(),this.height),this.cameraFrustum=Jd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const C=new Float32Array(16);at.identity(C),at.scale(C,C,[1,-1,1]),at.rotateX(C,C,this._pitch),at.rotateZ(C,C,this.angle);const P=at.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=at.clone(P);const R=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;P[8]=2*-t.x/this.width,P[9]=2*(t.y+R)/this.height,this.skyboxMatrix=at.multiply(C,P,C);const z=this.point,U=z.x,W=z.y,j=this.width%2/2,Y=this.height%2/2,Z=Math.cos(this.angle),$=Math.sin(this.angle),K=U-Math.round(U)+Z*j+$*Y,ie=W-Math.round(W)+Z*Y+$*j,ce=new Float64Array(w);if(at.translate(ce,ce,[K>.5?K-1:K,ie>.5?ie-1:ie,0]),this.alignedProjMatrix=ce,w=at.create(),at.scale(w,w,[this.width/2,-this.height/2,1]),at.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=at.create(),at.scale(w,w,[1,-1,1]),at.translate(w,w,[-1,-1,0]),at.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=at.multiply(new Float64Array(16),this.labelPlaneMatrix,b),this._calcFogMatrices(),this._distanceTileDataCache={},w=at.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ye){const{x:Te,y:we}=ye.point,{lng:Ie,lat:xe}=ye._center;return rF(Te,we,ye.worldSize,Ie,xe)}(this);const he=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ke.transformMat4(he,he,p),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,l=this._camera.position,u=1/this.height/this._pixelsPerMercatorPixel,h=[t,t,r];ke.scale(h,h,u),ke.scale(l,l,-1),ke.multiply(l,l,h);const p=at.create();at.translate(p,p,l),at.scale(p,p,h),this.mercatorFogMatrix=p,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,u)}_computeCameraPosition(t){const r=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,l=this._camera.forward(),u=this.point,h=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-t/this.worldSize*this._centerAltitude;return[u.x/this.worldSize-l[0]*h,u.y/this.worldSize-l[1]*h,t/this.worldSize*this._centerAltitude-l[2]*h]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),l=this._camera.position[2],u=t[2];let h=1;this.projection.wrap&&(this.center=this.center.wrap()),u>0&&(h=Math.min((r-l)/u,1)),this._camera.position=ke.scaleAndAdd([],this._camera.position,t,h),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:l,bearing:u}=this._camera.getPitchBearing(),h=$a(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,p=this._mercatorZfromZoom(this._maxZoom)*Math.cos(be(this._maxPitch)),g=Math.max((t[2]-h)/Math.cos(l),p),v=this._zoomFromMercatorZ(g);ke.scaleAndAdd(t,t,r,g),this._pitch=ae(l,be(this.minPitch),be(this.maxPitch)),this.angle=Ze(u,-Math.PI,Math.PI),this._setZoom(ae(v,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new ga(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,l=gf,u=0,h=1/0;for(;l-r>1e-6&&l>r;){const p=r+.5*(l-r),g=this.tileSize*Math.pow(2,p),v=this.getCameraToCenterDistance(this.projection,p,g),b=this.scaleZoom(v/(t*this.tileSize)),w=Math.abs(p-b);w<h&&(h=w,u=p),p<b?r=p:l=p}return u}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(ve("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const l=Math.min(t.x,r.x),u=Math.max(t.x,r.x),h=Math.min(t.y,r.y),p=Math.max(t.y,r.y);if(h<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const g=[new V(l,h),new V(u,p),new V(l,p),new V(u,h)],v=this.renderWorldCopies?-3:0,b=this.renderWorldCopies?4:1;for(const w of g){const A=this.pointRayIntersection(w);if(A.t<0)return!0;const C=this.rayIntersectionCoordinate(A);if(C.x<v||C.y<0||C.x>b||C.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+fe(this.fovAboveCenter)>88||this.anyCornerOffEdge(new V(0,0),new V(this.width,this.height))}zoomDeltaToMovement(t,r){const l=ke.length(ke.sub([],this._camera.position,t)),u=this._zoomFromMercatorZ(l)+r;return l-this._mercatorZfromZoom(u)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([r,l,u],h){const p=[r,l,u,1];Ga.transformMat4(p,p,h);const g=p[3]=Math.max(p[3],1e-6);return p[0]/=g,p[1]/=g,p[2]/=g,p}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new V(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new V(0,t))}}getCameraToCenterDistance(t,r=this.zoom,l=this.worldSize){const u=b1(t,r,this.width,this.height,1024),h=t.pixelSpaceConversion(this.center.lat,l,u);let p=.5/Math.tan(.5*this._fov)*this.height*h;return this.isOrthographic&&(p=YN(1,p,ZN(this.pitch>=15?1:this.pitch/15))),p}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&at.multiply(t,t,this.globeMatrix),t}getFrustum(t){return Jd.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function KN(i,t,r){at.identity(i),at.rotateZ(i,i,be(t[2])),at.rotateX(i,i,be(t[0])),at.rotateY(i,i,be(t[1])),at.scale(i,i,r),at.multiply(i,i,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function f3(i,t,r,l,u,h,p,g){const v=[r[0]-t[0],r[1]-t[1],0],b=[l[0]-t[0],l[1]-t[1],0];if(ke.length(v)<1e-12||ke.length(b)<1e-12)return To.identity(i);const w=ke.cross([],v,b);ke.normalize(w,w),ke.subtract(b,l,t),v[2]=(h-u)*g,b[2]=(p-u)*g;const A=v;return ke.cross(A,v,b),ke.normalize(A,A),To.rotationTo(i,w,A)}function JN(i,t,r=!1){const l=vo(t.zoom),u=function(h,p,g){const v=p.worldSize,b=[h[12],h[13],h[14]],w=gr(b[1]/v),A=ol(b[0]/v),C=at.identity([]),P=$a(1,w)*v,R=$a(1,0)*v*vf(w,p.zoom),z=1/eP(v);let U=R*z;if(g){const Z=b1(p.projection,p.zoom,p.width,p.height,1024);U=z*p.projection.pixelSpaceConversion(p.center.lat,v,Z)}const W=Fs(w,A);ke.add(W,W,ke.scale([],ke.normalize([],W),P*U*b[2]));const j=function(Z){const $=[Z[0],Z[1],Z[2]];let K=[0,1,0];const ie=ke.cross([],K,$);return ke.cross(K,$,ie),ke.squaredLength(K)===0&&(K=[0,1,0],ke.cross(ie,$,K)),ke.normalize(ie,ie),ke.normalize(K,K),ke.normalize($,$),[ie[0],ie[1],ie[2],0,K[0],K[1],K[2],0,$[0],$[1],$[2],0,Z[0],Z[1],Z[2],1]}(W);at.scale(C,C,[U,U,U*P]),at.translate(C,C,[-b[0],-b[1],-b[2]]);const Y=at.multiply([],p.globeMatrix,j);return at.multiply(Y,Y,C),at.multiply(Y,Y,h),Y}(i,t,r);if(l>0){const h=function(p,g){const v=g.worldSize,b=$a(1,0)*v*vf(g.center.lat,g.zoom)/eP(v),w=$a(1,g.center.lat)*v,A=at.identity([]);return at.rotateY(A,A,be(g.center.lng)),at.rotateX(A,A,be(g.center.lat)),at.translate(A,A,[0,0,hs]),at.scale(A,A,[b,b,b*w]),at.translate(A,A,[g.point.x-.5*v,g.point.y-.5*v,0]),at.multiply(A,A,p),at.multiply(A,g.globeMatrix,A)}(i,t);return function(p,g,v){const b=(R,z,U)=>{const W=ke.length(R),j=ke.length(z),Y=Qd(R,z,U);return ke.scale(Y,Y,1/ke.length(Y)*Ln(W,j,U))},w=b([p[0],p[1],p[2]],[g[0],g[1],g[2]],v),A=b([p[4],p[5],p[6]],[g[4],g[5],g[6]],v),C=b([p[8],p[9],p[10]],[g[8],g[9],g[10]],v),P=Qd([p[12],p[13],p[14]],[g[12],g[13],g[14]],v);return[w[0],w[1],w[2],0,A[0],A[1],A[2],0,C[0],C[1],C[2],0,P[0],P[1],P[2],1]}(u,h,l)}return u}const Sm=64,Kne=[1,1,1];class QN{constructor(t,r,l,u){this.id=t,this.position=r!=null?new On(r[0],r[1]):new On(0,0),this.orientation=l??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,r){if(at.multiply(t.matrix,r,t.matrix),t.meshes)for(const l of t.meshes){const u=hi.applyTransform(l.aabb,t.matrix);this.aabb.encapsulate(u)}if(t.children)for(const l of t.children)this._applyTransformations(l,t.matrix)}computeBoundsAndApplyParent(){const t=at.identity([]);for(const r of this.nodes)this._applyTransformations(r,t)}_positionModelOnTerrain(t,r){const l=t.elevation;if(!l)return 0;const u=hi.projectAabbCorners(this.aabb,this.matrix),h=$a(1,this.position.lat)*t.worldSize,p=function(W,j){const Y=[0,0,1],Z=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const $ of Z){const K=W[$.corners[0]],ie=W[$.corners[1]],ce=W[$.corners[2]],he=[ie[0]-K[0],ie[1]-K[1],j*(ie[2]-K[2])],ye=ke.cross(he,he,[ce[0]-K[0],ce[1]-K[1],j*(ce[2]-K[2])]);ke.normalize(ye,ye),$.dotProductWithUp=ke.dot(ye,Y)}return Z.sort(($,K)=>$.dotProductWithUp-K.dotProductWithUp),Z[0].corners}(u,h),g=u[p[0]],v=u[p[1]],b=u[p[2]],w=u[p[3]],A=l.getAtPointOrZero(new ga(g[0]/t.worldSize,g[1]/t.worldSize),0),C=l.getAtPointOrZero(new ga(v[0]/t.worldSize,v[1]/t.worldSize),0),P=l.getAtPointOrZero(new ga(b[0]/t.worldSize,b[1]/t.worldSize),0),R=l.getAtPointOrZero(new ga(w[0]/t.worldSize,w[1]/t.worldSize),0),z=(A+R)/2,U=(C+P)/2;return z>U?C<P?f3(r,v,w,g,C,R,A,h):f3(r,b,g,w,P,A,R,h):A<R?f3(r,g,v,b,A,C,P,h):f3(r,w,b,v,R,P,C,h),Math.max(z,U)}computeModelMatrix(t,r,l,u,h,p,g=!1){const v=t.transform,b=v.zoom,w=v.project(this.position),A=vf(this.position.lat,b),C=1/A;at.identity(this.matrix),at.translate(this.matrix,this.matrix,[w.x+u[0]*C,w.y+u[1]*C,u[2]]);let P=1,R=1;const z=v.worldSize;if(g){if(v.projection.name==="mercator"){let Y=0;v.elevation&&(Y=v.elevation.getAtPointOrZero(new ga(w.x/z,w.y/z),0));const Z=Ga.transformMat4([],[w.x,w.y,Y,1],v.projMatrix)[3]/v.cameraToCenterDistance;P=Z,R=Z*vf(v.center.lat,b)}else if(v.projection.name==="globe"){const Y=JN(this.matrix,v),Z=at.multiply([],v.projMatrix,Y),$=[0,0,0,1];Ga.transformMat4($,$,Z);const K=$[3]/v.cameraToCenterDistance,ie=vo(b),ce=v.projection.pixelsPerMeter(this.position.lat,z)*vf(this.position.lat,b),he=v.projection.pixelsPerMeter(v.center.lat,z)*vf(v.center.lat,b);P=K/Ln(ce,hF(v.center.lat),ie),R=K*A/ce,P*=he,R*=he}}else P=C;at.scale(this.matrix,this.matrix,[P,P,R]);const U=[...this.matrix],W=this.orientation,j=[];if(KN(j,[W[0]+r[0],W[1]+r[1],W[2]+r[2]],l),at.multiply(this.matrix,U,j),h&&v.elevation){let Y=0;const Z=[];if(p&&v.elevation){Y=this._positionModelOnTerrain(v,Z);const $=at.fromQuat([],Z),K=at.multiply([],$,j);at.multiply(this.matrix,U,K)}else Y=v.elevation.getAtPointOrZero(new ga(w.x/z,w.y/z),0);Y!==0&&(this.matrix[14]+=Y)}}upload(t){if(!this.uploaded){for(const r of this.nodes)HP(r,t);for(const r of this.nodes)p3(r);this.uploaded=!0}}destroy(){for(const t of this.nodes)m3(t)}}function x1(i,t,r=!1){i.uploaded||(i.gfxTexture=new yr(t,i.image,r?t.gl.R8:t.gl.RGBA,{useMipmap:i.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),i.uploaded=!0,i.image=null)}function Jne(i,t,r){i.indexBuffer=t.createIndexBuffer(i.indexArray,!1,!0),i.vertexBuffer=t.createVertexBuffer(i.vertexArray,Wne.members,!1,!0),i.normalArray&&(i.normalBuffer=t.createVertexBuffer(i.normalArray,jne.members,!1,!0)),i.texcoordArray&&(i.texcoordBuffer=t.createVertexBuffer(i.texcoordArray,Hne.members,!1,!0)),i.colorArray&&(i.colorBuffer=t.createVertexBuffer(i.colorArray,(i.colorArray.bytesPerElement===12?Vne:Gne).members,!1,!0)),i.featureArray&&(i.pbrBuffer=t.createVertexBuffer(i.featureArray,qne.members,!0)),i.segments=ja.simpleSegment(0,0,i.vertexArray.length,i.indexArray.length);const l=i.material;l.pbrMetallicRoughness.baseColorTexture&&x1(l.pbrMetallicRoughness.baseColorTexture,t),l.pbrMetallicRoughness.metallicRoughnessTexture&&x1(l.pbrMetallicRoughness.metallicRoughnessTexture,t),l.normalTexture&&x1(l.normalTexture,t),l.occlusionTexture&&x1(l.occlusionTexture,t,r),l.emissionTexture&&x1(l.emissionTexture,t)}function HP(i,t,r){if(i.meshes)for(const l of i.meshes)Jne(l,t,r);if(i.children)for(const l of i.children)HP(l,t,r)}function p3(i){if(i.meshes)for(const t of i.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(i.children)for(const t of i.children)p3(t)}function m3(i){if(i.meshes)for(const r of i.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((t=r.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(i.children)for(const r of i.children)m3(r)}class eB{constructor(t,r){this.feature=t,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class tB{constructor(){this.instancedDataArray=new EC,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class nB{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,r,l,u){this.tileToMeter=i1(l);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:p,id:g,index:v,sourceLayerIndex:b}of t){const w=_f(p,h);if(!this.layers[0]._featureFilter.filter(new ri(this.zoom),w,l))continue;const A={id:g,sourceLayerIndex:b,index:v,geometry:h?w.geometry:Gu(p,l,u),properties:p.properties,type:p.type,patterns:{}},C=this.addFeature(A,A.geometry,w);C&&r.featureIndex.insert(p,A.geometry,v,b,this.index,this.instancesPerModel[C].instancedDataArray.length)}this.lookup=null}update(t,r,l,u){for(const h in this.instancesPerModel){const p=this.instancesPerModel[h];for(const g in t)p.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(p.features[p.idToFeaturesIndex[g]],t[g],p,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const r in this.instancesPerModel){const l=this.instancesPerModel[r];for(const u of l.features){const h=this.layers[0],p=u.feature,g=this.canonical,v=h.paint.get("model-rotation").evaluate(p,{},g),b=h.paint.get("model-scale").evaluate(p,{},g),w=h.paint.get("model-translation").evaluate(p,{},g);ke.exactEquals(u.rotation,v)&&ke.exactEquals(u.scale,b)&&ke.exactEquals(u.translation,w)||(this.evaluate(u,u.featureStates,l,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const r in this.instancesPerModel){const l=this.instancesPerModel[r];l.instancedDataArray.length<0||l.instancedDataArray.length===0||(l.instancedDataBuffer?l.instancedDataBuffer.updateData(l.instancedDataArray):l.instancedDataBuffer=t.createVertexBuffer(l.instancedDataArray,$ne.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const r=this.instancesPerModel[t];r.instancedDataArray.length!==0&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(t,r,l){const u=this.layers[0],h=u.layout.get("model-id").evaluate(l,{},this.canonical);if(!h)return ve(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),h;this.instancesPerModel[h]||(this.instancesPerModel[h]=new tB);const p=this.instancesPerModel[h],g=p.instancedDataArray,v=new eB(l,g.length);for(const b of r)for(const w of b){if(w.x<0||w.x>=ht||w.y<0||w.y>=ht)continue;const A=(this.lookupDim-1)/ht,C=this.lookupDim*(w.y*A|0)+w.x*A|0;if(this.lookup){if(this.lookup[C]!==0)continue;this.lookup[C]=1}this.instanceCount++;const P=g.length;g.resize(P+1),p.instancesEvaluatedElevation.push(0),g.float32[16*P]=w.x,g.float32[16*P+1]=w.y}return v.instancedDataCount=p.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(t.id&&(p.idToFeaturesIndex[t.id]=p.features.length),p.features.push(v),this.evaluate(v,{},p,!1)),h}evaluate(t,r,l,u){const h=this.layers[0],p=t.feature,g=this.canonical,v=t.rotation=h.paint.get("model-rotation").evaluate(p,r,g),b=t.scale=h.paint.get("model-scale").evaluate(p,r,g),w=t.translation=h.paint.get("model-translation").evaluate(p,r,g),A=h.paint.get("model-color").evaluate(p,r,g);A.a=h.paint.get("model-color-mix-intensity").evaluate(p,r,g);const C=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),KN(C,v,b);const P=Math.round(100*A.a)+A.b/1.05;for(let R=0;R<t.instancedDataCount;++R){const z=t.instancedDataOffset+R,U=16*z,W=l.instancedDataArray.float32;let j=0;u&&(j=W[U+6]-l.instancesEvaluatedElevation[z]);const Y=0|W[U+1];W[U]=(0|W[U])+A.r/1.05,W[U+1]=Y+A.g/1.05,W[U+2]=P,W[U+3]=1/(g.z>10?this.tileToMeter:i1(g,Y)),W[U+4]=w[0],W[U+5]=w[1],W[U+6]=w[2]+j,W[U+7]=C[0],W[U+8]=C[1],W[U+9]=C[2],W[U+10]=C[4],W[U+11]=C[5],W[U+12]=C[6],W[U+13]=C[8],W[U+14]=C[9],W[U+15]=C[10],l.instancesEvaluatedElevation[z]=w[2]}}}un(nB,"ModelBucket",{omit:["layers"]}),un(tB,"PerModelAttributes"),un(eB,"ModelFeature");const Qne=new yi({visibility:new Xt(nt.layout_model.visibility),"model-id":new yn(nt.layout_model["model-id"])});var eae={paint:new yi({"model-opacity":new Xt(nt.paint_model["model-opacity"]),"model-rotation":new yn(nt.paint_model["model-rotation"]),"model-scale":new yn(nt.paint_model["model-scale"]),"model-translation":new yn(nt.paint_model["model-translation"]),"model-color":new yn(nt.paint_model["model-color"]),"model-color-mix-intensity":new yn(nt.paint_model["model-color-mix-intensity"]),"model-type":new Xt(nt.paint_model["model-type"]),"model-cast-shadows":new Xt(nt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Xt(nt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Xt(nt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new yn(nt.paint_model["model-emissive-strength"]),"model-roughness":new yn(nt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new yn(nt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Xt(nt.paint_model["model-cutoff-fade-range"])}),layout:Qne};const jP=new Float32Array(262144),Am=new Uint8Array(262144);function aB(i){let t=0;if(i.meshes)for(const r of i.meshes)t=Math.max(t,r.aabb.max[2]);if(i.children)for(const r of i.children)t=Math.max(t,aB(r));return t}const iB=["","wall","door","roof","window","lamp","logo"];class rB{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:aB(t)}}}}class oB{constructor(t,r,l,u){this.nodes=t,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,l&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=u,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const l of r){const u=l.node;this.uploaded?this.updatePbrBuffer(u):HP(u,t,!0)}for(const l of r)p3(l.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let r=!1;if(!t.meshes)return r;for(const l of t.meshes)l.pbrBuffer&&(l.pbrBuffer.updateData(l.featureArray),r=!0);return r}needsReEvaluation(t,r,l){const u=t.transform.projectionOptions,h=t.style.getBrightness(),p=this.brightness!==h;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||w1(l.paint.get("model-color").value,p)||w1(l.paint.get("model-color-mix-intensity").value,p)||w1(l.paint.get("model-roughness").value,p)||w1(l.paint.get("model-emissive-strength").value,p)||w1(l.paint.get("model-height-based-emissive-strength-multiplier").value,p))&&(this.projection=u,this.brightness=h,!0)}evaluateScale(t,r){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const l=this.getNodesInfo(),u=this.id.canonical;for(const h of l){const p=h.feature;h.evaluatedScale=r.paint.get("model-scale").evaluate(p,{},u)}}evaluate(t){const r=this.getNodesInfo();for(const l of r){if(!l.node.meshes)continue;const u=l.feature,h=l.node.meshes&&l.node.meshes[0].featureData,p=l.evaluatedColor[2],g=l.evaluatedRMEA[2],v=this.id.canonical;if(l.hasTranslucentParts=!1,h){for(let b=0;b<iB.length;b++){const w=iB[b];w.length&&(u.properties.part=w);const A=t.paint.get("model-color").evaluate(u,{},v),C=t.paint.get("model-color-mix-intensity").evaluate(u,{},v);l.evaluatedColor[b]=[A.r,A.g,A.b,C],l.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(u,{},v),l.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v),l.evaluatedRMEA[b][3]=A.a,l.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!l.hasTranslucentParts&&A.a<1&&(l.hasTranslucentParts=!0)}delete u.properties.part,nae(l,p!==l.evaluatedColor[2]||g!==l.evaluatedRMEA[2])}l.evaluatedScale=t.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(l.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,r,l,u){const h=t.findDEMTileFor(l);if(h&&(h.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const p=sv.create(t,l,h);if(!p)return;4&this.modelTraits&&this.updateDEM(t,p,l,u);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const b=v.footprint.vertices;let w=p.getElevationAt(b[0].x,b[0].y,!0,!0);for(let A=1;A<b.length;A++)w=Math.min(w,p.getElevationAt(b[A].x,b[A].y,!0,!0));v.elevation=w}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=r}}updateDEM(t,r,l,u){let h=r._dem._modifiedForSources[u];if(h===void 0&&(r._dem._modifiedForSources[u]=[],h=r._dem._modifiedForSources[u]),h.includes(l.canonical))return;const p=r._dem.dim;h.push(l.canonical);let g=!1;for(const v of this.getNodesInfo()){const b=v.node;if(!b.footprint||!b.footprint.grid)continue;const w=b.footprint.grid,A=r.tileCoordToPixel(w.min.x,w.min.y),C=r.tileCoordToPixel(w.max.x,w.max.y),P=Math.min(Math.min(p-C.y,A.x),Math.min(A.y,p-C.x));if(P<0)continue;const R=ae(P,2,5);let z=Math.max(0,A.x-R),U=Math.max(0,A.y-R),W=Math.min(C.x+R,p-1),j=Math.min(C.y+R,p-1);for(let K=U;K<=j;++K)for(let ie=z;ie<=W;++ie)Am[K*p+ie]=255;let Y=0,Z=0;for(let K=0;K<w.cellsY;++K)for(let ie=0;ie<w.cellsX;++ie){if(!w.cells[K*w.cellsX+ie])continue;const ce=r.tileCoordToPixel(w.min.x+ie/w.xScale,w.min.y+K/w.yScale),he=r.tileCoordToPixel(w.min.x+(ie+1)/w.xScale,w.min.y+(K+1)/w.yScale);for(let ye=ce.y;ye<=Math.min(he.y+1,p-1);++ye)for(let Te=ce.x;Te<=Math.min(he.x+1,p-1);++Te)Am[ye*p+Te]===255&&(Am[ye*p+Te]=0,Y+=r.getElevationAtPixel(Te,ye),Z++)}const $=Y/Z;z=Math.max(1,A.x-R),U=Math.max(1,A.y-R),W=Math.min(C.x+R,p-2),j=Math.min(C.y+R,p-2),g=!0;for(let K=U;K<=j;++K)for(let ie=z;ie<=W;++ie)Am[K*p+ie]===0&&(jP[K*p+ie]=r._dem.set(ie,K,$));for(let K=1;K<R;++K){z=Math.max(1,A.x-K),U=Math.max(1,A.y-K),W=Math.min(C.x+K,p-2),j=Math.min(C.y+K,p-2);for(let ie=U;ie<=j;++ie)for(let ce=z;ce<=W;++ce){const he=ie*p+ce;if(Am[he]===255){let ye=0,Te=0,we=-1,Ie=-1;for(let xe=-1;xe<=1;++xe)for(let We=-1;We<=1;++We){const qe=(ie+xe)*p+ce+We;if(Am[qe]>=K)continue;const et=jP[qe],Ne=Math.abs(et);Ne>Te&&(ye=et,Te=Ne,we=We,Ie=xe)}if(Te>.1){const xe=1-(K+.5*Math.abs(we*Ie))/R;let We=r._dem.get(ce,ie)+ye*xe;const qe=r._dem.get(ce+we,ie+Ie),et=r._dem.get(ce-we,ie-Ie,!0);(We-qe)*(We-et)>0&&(We=(qe+et)/2),jP[he]=r._dem.set(ce,ie,We),Am[he]=K}}}}}g&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=Cn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new rB(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)m3(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const r of t)p3(r.node),m3(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const l=r.getReplacementRegionsForTile(t.toUnwrapped()),u=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const p=u[h].node;u[h].hiddenByReplacement=!!p.footprint&&!l.find(g=>g.footprint===p.footprint)}}getHeightAtTileCoord(t,r){const l=this.getNodesInfo(),u=[];for(let h=0;h<this.nodesInfo.length;h++){const p=l[h],g=p.node.meshes[0];if(t<g.aabb.min[0]||r<g.aabb.min[1]||t>g.aabb.max[0]||r>g.aabb.max[1])continue;const v=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*Sm|0,b=Math.min(63,(r-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*Sm|0)*Sm+Math.min(63,v);if(!(g.heightmap[b]<0&&p.node.footprint))return p.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:p.feature.properties.height,hidden:!1,verticalScale:p.evaluatedScale[2]};if(p.node.footprint.grid.query(new V(t,r),new V(t,r),u),u.length>0)return{height:void 0,maxHeight:p.feature.properties.height,hidden:p.hiddenByReplacement,verticalScale:p.evaluatedScale[2]}}}}function w1(i,t){return!i.isLightConstant&&t}function tae(i,t,r,l,u,h,p,g){let v=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,w=240&t|(240&t)>>4;r[3]>0&&(v=Ln(v,255*r[0],r[3]),b=Ln(b,255*r[1],r[3]),w=Ln(w,255*r[2],r[3]));const A=v<<8|b,C=w<<8|Math.floor(255*l[3]),P=function(K){const ie=ae(K,0,2);return Math.min(Math.round(.5*ie*255),255)}(l[2])<<8|15*l[0]<<4|15*l[1],R=ae(u[0],0,1),z=ae(u[1],0,1),U=ae(u[2],0,1),W=ae(u[3],0,1);let j,Y,Z,$;if(R!==z&&p!==h&&z!==R){const K=p-h;Y=1/(K*(z-R)),Z=-(h+K*R)/(K*(z-R));const ie=ae(u[4],-1,1);$=Math.pow(10,ie),j=255*U<<8|255*W}else j=65535,Y=0,Z=1,$=1;if(i.emplaceBack(A,C,P,j,Y,Z,$),g){const K=g.length;g.clear();for(let ie=0;ie<K;ie++)g.emplaceBack(A,C,P,j,Y,Z,$)}}function nae(i,t){const r=i.node;let l=0;for(const u of r.meshes){if(r.lights&&r.lightMeshIndex===l||!u.featureData)continue;u.featureArray=new g2,u.featureArray.reserve(u.featureData.length);let h=t;for(const p of u.featureData){let g;const v=65535&p,b=(15&v)<8?15&v:0,w=p>>16&65535,A=i.evaluatedRMEA[b],C=i.evaluatedColor[b],P=i.emissionHeightBasedParams[b];if(h&&b===2&&r.lights&&(g=new g2,g.resize(10*r.lights.length)),tae(u.featureArray,w,C,A,P,u.aabb.min[2],u.aabb.max[2],g),g&&h){h=!1;const R=r.meshes[r.lightMeshIndex];R.featureArray=g,R.featureArray._trim()}}u.featureArray._trim(),l++}}un(oB,"Tiled3dModelBucket",{omit:["layers"]}),un(rB,"Tiled3dModelFeature");class aae{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const r=cB(new V(0,0),new V(ht,ht),t),l=[];for(const u of this._activeRegions){if(u.hiddenByOverlap||!lB(r,u))continue;const h=iae(u.min,u.max,t);l.push({min:h.min,max:h.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId})}return l}setSources(t){this._setSources(t.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const l=[];for(const u of r.cache.getVisibleCoordinates()){const h=r.cache.getTile(u).buckets[r.layer];if(h)for(const p of h.getNodesInfo()){const g=p.node;g.footprint&&l.push({footprint:g.footprint,id:u.toUnwrapped()})}}return l}})))}_addSource(t){const r=t.getFootprints();if(r.length!==0){for(const l of r){if(!l.footprint)continue;const u=cB(l.footprint.min,l.footprint.max,l.id);this._activeRegions.push({min:u.min,max:u.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:l.id,footprint:l.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,l)=>r.priority-l.priority||g3(r.min,l.min)||g3(r.max,l.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let r=0,l=0;for(;!t&&r!==this._activeRegions.length;){const u=this._activeRegions[r],h=this._prevRegions[l];t=u.priority!==h.priority||!sB(u,h),++r,++l}}if(t){++this._updateTime;const r=l=>{const u=this._activeRegions;if(l>=u.length)return l;const h=u[l].priority;for(;l<u.length&&u[l].priority===h;)++l;return l};if(this._sourceIds.length>1){let l=0,u=r(l);for(;l!==u;){let h=l;const p=l;for(;h!==u;){const g=this._activeRegions[h];g.hiddenByOverlap=!1;for(let v=0;v<p;v++){const b=this._activeRegions[v];if(!b.hiddenByOverlap&&lB(g,b)&&(g.hiddenByOverlap=dB(g.footprint,g.tileId,b.footprint,b.tileId),g.hiddenByOverlap))break}++h}l=u,u=r(l)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=t.length-1;r>=0;r--)this._addSource(t[r]);this._computeReplacement()}}function g3(i,t){return i.x-t.x||i.y-t.y}function sB(i,t){return g3(i.min,t.min)===0&&g3(i.max,t.max)===0}function lB(i,t){return!(i.min.x>t.max.x||i.max.x<t.min.x||i.min.y>t.max.y||i.max.y<t.min.y)}function cB(i,t,r){const l=1/ht,u=1/(1<<r.canonical.z),h=(t.x*l+r.canonical.x)*u+r.wrap,p=(t.y*l+r.canonical.y)*u;return{min:new V((i.x*l+r.canonical.x)*u+r.wrap,(i.y*l+r.canonical.y)*u),max:new V(h,p)}}function iae(i,t,r){const l=1<<r.canonical.z,u=((t.x-r.wrap)*l-r.canonical.x)*ht,h=(t.y*l-r.canonical.y)*ht;return{min:new V(((i.x-r.wrap)*l-r.canonical.x)*ht,(i.y*l-r.canonical.y)*ht),max:new V(u,h)}}function uB(i,t,r,l,u,h,p){const g=i.indices,v=i.vertices,b=[];for(let w=l;w<l+u;w+=3){const A=t[r[w+0]+h],C=t[r[w+1]+h],P=t[r[w+2]+h],R=Math.min(A.x,C.x,P.x),z=Math.max(A.x,C.x,P.x),U=Math.min(A.y,C.y,P.y),W=Math.max(A.y,C.y,P.y);b.length=0,i.grid.query(new V(R,U),new V(z,W),b);for(let j=0;j<b.length;j++){const Y=b[j];if(cP(v[g[3*Y+0]],v[g[3*Y+1]],v[g[3*Y+2]],A,C,P,p))return!0}}return!1}function dB(i,t,r,l){if(!i||!r)return!1;let u=i.vertices;if(!t.canonical.equals(l.canonical)||t.wrap!==l.wrap){if(r.vertices.length<i.vertices.length)return dB(r,l,i,t);const h=t.canonical,p=l.canonical,g=Math.pow(2,p.z-h.z);u=i.vertices.map(v=>new V(v.x*h.x*ht*g-p.x*ht,v.y*h.y*ht*g-p.y*ht))}return uB(r,u,i.indices,0,i.indices.length,0,0)}const rae=U2.types,oae=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],sae=["fill-extrusion-flood-light-ground-radius"],lae=Math.pow(2,13),cae=Math.pow(2,15)-1,hB=new V(0,1),qu=2147483648;function S1(i,t,r,l,u,h,p,g){i.emplaceBack((t<<1)+p,(r<<1)+h,(Math.floor(l*lae)<<1)+u,Math.round(g))}function y3(i,t,r,l,u,h){i.emplaceBack(t.x,t.y,(r.x<<1)+l,(r.y<<1)+u,h)}function A1(i,t,r){i.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class fB{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class pB{constructor(){this.centroidXY=new V(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new V(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new V(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new V(this.max.x-this.min.x,this.max.y-this.min.y)}}class mB{constructor(){this.acc=new V(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,r){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=r.x,t.min.y=t.max.y=r.y)}appendEdge(t,r,l){this.accCount++,this.acc._add(r);let u=!!this.borders;r.x<t.min.x?(t.min.x=r.x,u=!0):r.x>t.max.x&&(t.max.x=r.x,u=!0),r.y<t.min.y?(t.min.y=r.y,u=!0):r.y>t.max.y&&(t.max.y=r.y,u=!0),((r.x===0||r.x===ht)&&r.x===l.x)!=((r.y===0||r.y===ht)&&r.y===l.y)&&this.processBorderOverlap(r,l),u&&this.checkBorderIntersection(r,l)}checkBorderIntersection(t,r){r.x<0!=t.x<0&&this.addBorderIntersection(0,Ln(r.y,t.y,(0-r.x)/(t.x-r.x))),r.x>ht!=t.x>ht&&this.addBorderIntersection(1,Ln(r.y,t.y,(ht-r.x)/(t.x-r.x))),r.y<0!=t.y<0&&this.addBorderIntersection(2,Ln(r.x,t.x,(0-r.y)/(t.y-r.y))),r.y>ht!=t.y>ht&&this.addBorderIntersection(3,Ln(r.x,t.x,(ht-r.y)/(t.y-r.y)))}addBorderIntersection(t,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const l=this.borders[t];r<l[0]&&(l[0]=r),r>l[1]&&(l[1]=r)}processBorderOverlap(t,r){if(t.x===r.x){if(t.y===r.y)return;const l=t.x===0?0:1;this.addBorderIntersection(l,r.y),this.addBorderIntersection(l,t.y)}else{const l=t.y===0?2:3;this.addBorderIntersection(l,r.x),this.addBorderIntersection(l,t.x)}}centroid(){return this.accCount===0?new V(0,0):new V(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,r)=>t+ +(r[0]!==Number.MAX_VALUE),0):0}}function gB(i,t){const r=i.add(t)._unit(),l=ae(i.x*r.x+i.y*r.y,-1,1);var u,h,p;return u=Math.acos(l),Math.min(4,Math.max(-4,Math.tan(u)))/4*cae*((h=i).x*(p=t).y-h.y*p.x<0?-1:1)}const uae=[i=>i.x<0,i=>i.x>ht,i=>i.y<0,i=>i.y>ht];function dae(i,t,r,l){const u=[4];if(l===0)return u;r._mult(l);const h=i.sub(r),p=t.sub(r),g=[i,t,h,p];for(let v=0;v<4;v++)for(const b of g)if(uae[v](b)){u.push(v);break}return u}class yB{constructor(t){this.vertexArray=new _t,this.indexArray=new Nn,this.programConfigurations=new ff(t.layers,t.zoom,r=>sae.includes(r)),this._segments=new ja,this.hiddenByLandmarkVertexArray=new MC,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ja}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,r,l){const u=t.length;if(u>2){let h=Math.max(0,this._segments.get().length-1);const p=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[h].length);let g;h!==this._segments.get().length-1&&(h++,this._segmentToGroundQuads[h]=[],this._segmentToRegionTriCounts[h]=[0,0,0,0,0]);{const v=t[0],b=t[1];g=gB(v.sub(t[u-1])._perp()._unit(),b.sub(v)._perp()._unit())}for(let v=0;v<u;v++){const b=v===u-1?0:v+1,w=t[v],A=t[b],C=t[b===u-1?0:b+1],P=A.sub(w)._perp()._unit(),R=gB(P,C.sub(A)._perp()._unit()),z=g,U=R;if($P(w,A,r)||bB(w,r)&&bB(A,r)){g=R;continue}const W=p.vertexLength;y3(this.vertexArray,w,A,1,1,z),y3(this.vertexArray,w,A,1,0,z),y3(this.vertexArray,w,A,0,1,U),y3(this.vertexArray,w,A,0,0,U),p.vertexLength+=4;const j=dae(w,A,P,l);for(const Y of j)this._segmentToGroundQuads[h].push({id:W,region:Y}),this._segmentToRegionTriCounts[h][Y]+=2,p.primitiveLength+=2;g=R}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),r=t.length;for(let l=0;l<r;l++)this._segmentToGroundQuads[l].sort((u,h)=>u.region-h.region);for(let l=0;l<r;l++){const u=this._segmentToGroundQuads[l],h=t[l],p=this._segmentToRegionTriCounts[l];p.reduce((v,b)=>v+b,0);let g=0;for(let v=0;v<=4;v++){const b=p[v];if(b!==0){let w=this.regionSegments[v];w||(w=this.regionSegments[v]=new ja);const A={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+g,vertexLength:h.vertexLength,primitiveLength:b};w.get().push(A)}g+=b}for(let v=0;v<u.length;v++){const b=u[v].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,r,l,u,h,p){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,r,l,u,h,p)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Bee.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,r,l,u,h,p){this.hasData()&&this.programConfigurations.updatePaintArrays(t,r,l,u,h,p)}updateHiddenByLandmark(t){if(!this.hasData())return;const r=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const l=t.flags&qu?1:0;for(let u=t.groundVertexArrayOffset;u<r;++u)this.hiddenByLandmarkVertexArray.emplace(u,l);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,Wee.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const r=this.regionSegments[t];r&&r.destroy()}}}}class E1{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Nn,this.footprintVertices=new J,this.footprintSegments=[],this.layoutVertexArray=new je,this.centroidVertexArray=new TO,this.indexArray=new Nn,this.programConfigurations=new ff(t.layers,t.zoom,r=>oae.includes(r)),this.segments=new ja,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new yB(t),this.maxHeight=0,this.partLookup={}}populate(t,r,l,u){this.features=[],this.hasPattern=gP("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=i1(l),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:h,id:p,index:g,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,w=_f(h,b);if(!this.layers[0]._featureFilter.filter(new ri(this.zoom),w,l))continue;const A={id:p,sourceLayerIndex:v,index:g,geometry:b?w.geometry:Gu(h,l,u),properties:h.properties,type:h.type,patterns:{}},C=this.layoutVertexArray.length;this.hasPattern?this.features.push(yP("fill-extrusion",this.layers,A,this.zoom,r)):this.addFeature(A,A.geometry,g,l,{},r.availableImages,u,r.brightness),r.featureIndex.insert(h,A.geometry,g,v,this.index,C)}this.sortBorders(),this.groundEffect.prepareBorderSegments()}addFeatures(t,r,l,u,h,p){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,r,l,u,h,p)}this.sortBorders()}update(t,r,l,u,h){const p=Object.keys(t).length!==0;if(p&&!this.stateDependentLayers.length)return;const g=p?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,r,g,l,u,h),this.groundEffect.update(t,r,g,l,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gee),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Vee.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Uee.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,l,u,h,p,g,v){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,w=[new V(0,0),new V(ht,ht)],A=g.projection,C=A.name==="globe",P=rae[t.type]==="Polygon",R=new mB;R.centroidDataIndex=this.centroidData.length;const z=new pB,U=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},u)<=0,W=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},u);z.height=W,z.vertexArrayOffset=this.layoutVertexArray.length,z.groundVertexArrayOffset=this.groundEffect.vertexArray.length,C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Jn);const j=mP(r,500);for(let ce=j.length-1;ce>=0;ce--){const he=j[ce];(he.length===0||(Y=he[0]).every(ye=>ye.x<=0)||Y.every(ye=>ye.x>=ht)||Y.every(ye=>ye.y<=0)||Y.every(ye=>ye.y>=ht))&&j.splice(ce,1)}var Y;let Z;if(C)Z=AB(j,w,u);else{Z=[];for(const ce of j)Z.push({polygon:ce,bounds:w})}const $=P?this.edgeRadius:0,K=$>0&&this.zoom<17,ie=(ce,he)=>{if(ce.length===0)return!1;const ye=ce[ce.length-1];return he.x===ye.x&&he.y===ye.y};for(const{polygon:ce,bounds:he}of Z){let ye=0,Te=0;for(const xe of ce)P&&!xe[0].equals(xe[xe.length-1])&&xe.push(xe[0]),Te+=P?xe.length-1:xe.length;const we=this.segments.prepareSegment((P?5:4)*Te,this.layoutVertexArray,this.indexArray);z.footprintSegIdx<0&&(z.footprintSegIdx=this.footprintSegments.length);const Ie=new fB;if(Ie.vertexOffset=this.footprintVertices.length,Ie.indexOffset=3*this.footprintIndices.length,Ie.ringIndices=[],P){const xe=[],We=[];ye=we.vertexLength;for(let et=0;et<ce.length;et++){const Ne=ce[et];Ne.length&&et!==0&&We.push(xe.length/2);const Ve=[];let it,gt;it=Ne[1].sub(Ne[0])._perp()._unit(),Ie.ringIndices.push(Ne.length-1);for(let ct=1;ct<Ne.length;ct++){const Pt=Ne[ct],Ft=Ne[ct===Ne.length-1?1:ct+1],xt=Pt.clone();if($){gt=Ft.sub(Pt)._perp()._unit();const Mt=it.add(gt)._unit(),en=$*Math.min(4,1/(it.x*Mt.x+it.y*Mt.y));xt.x+=en*Mt.x,xt.y+=en*Mt.y,xt.x=Math.round(xt.x),xt.y=Math.round(xt.y),it=gt}!U||$!==0&&!K||ie(Ve,xt)||Ve.push(xt),S1(this.layoutVertexArray,xt.x,xt.y,0,0,1,1,0),we.vertexLength++,this.footprintVertices.emplaceBack(Pt.x,Pt.y),xe.push(Pt.x,Pt.y),C&&A1(this.layoutVertexExtArray,A.projectTilePoint(xt.x,xt.y,u),A.upVector(u,xt.x,xt.y))}U&&($===0||K)&&(Ve.length!==0&&ie(Ve,Ve[0])&&Ve.pop(),this.groundEffect.addData(Ve,he,b))}const qe=F2(xe,We);for(let et=0;et<qe.length;et+=3)this.footprintIndices.emplaceBack(Ie.vertexOffset+qe[et+0],Ie.vertexOffset+qe[et+1],Ie.vertexOffset+qe[et+2]),this.indexArray.emplaceBack(ye+qe[et],ye+qe[et+2],ye+qe[et+1]),we.primitiveLength++;Ie.indexCount+=qe.length,Ie.vertexCount+=this.footprintVertices.length-Ie.vertexOffset}for(let xe=0;xe<ce.length;xe++){const We=ce[xe];R.startRing(z,We[0]);let qe=We.length>4&&xB(We[We.length-2],We[0],We[1]),et=$?hae(We[We.length-2],We[0],We[1],$):0;const Ne=[];let Ve,it,gt;it=We[1].sub(We[0])._perp()._unit();let ct=!0;for(let Pt=1,Ft=0;Pt<We.length;Pt++){let xt=We[Pt-1],Mt=We[Pt];const en=We[Pt===We.length-1?1:Pt+1];if(R.appendEdge(z,Mt,xt),$P(Mt,xt,he)){$&&(it=en.sub(Mt)._perp()._unit(),ct=!ct);continue}const on=Mt.sub(xt)._perp(),rn=on.x/(Math.abs(on.x)+Math.abs(on.y)),cn=on.y>0?1:0,gn=xt.dist(Mt);if(Ft+gn>32768&&(Ft=0),$){gt=en.sub(Mt)._perp()._unit();let $n=_B(xt,Mt,en,vB(it,gt),$);isNaN($n)&&($n=0);const Un=Mt.sub(xt)._unit();xt=xt.add(Un.mult(et))._round(),Mt=Mt.add(Un.mult(-$n))._round(),et=$n,it=gt,U&&this.zoom>=17&&(ie(Ne,xt)||Ne.push(xt),ie(Ne,Mt)||Ne.push(Mt))}const kn=we.vertexLength,ea=We.length>4&&xB(xt,Mt,en);let ba=wB(Ft,qe,ct);if(S1(this.layoutVertexArray,xt.x,xt.y,rn,cn,0,0,ba),S1(this.layoutVertexArray,xt.x,xt.y,rn,cn,0,1,ba),Ft+=gn,ba=wB(Ft,ea,!ct),qe=ea,S1(this.layoutVertexArray,Mt.x,Mt.y,rn,cn,0,0,ba),S1(this.layoutVertexArray,Mt.x,Mt.y,rn,cn,0,1,ba),we.vertexLength+=4,this.indexArray.emplaceBack(kn+0,kn+1,kn+2),this.indexArray.emplaceBack(kn+1,kn+3,kn+2),we.primitiveLength+=2,$){const $n=ye+(Pt===1?We.length-2:Pt-2),Un=Pt===1?ye:$n+1;if(this.indexArray.emplaceBack(kn+1,$n,kn+3),this.indexArray.emplaceBack($n,Un,kn+3),we.primitiveLength+=2,Ve===void 0&&(Ve=kn),!$P(en,We[Pt],he)){const In=Pt===We.length-1?Ve:we.vertexLength;this.indexArray.emplaceBack(kn+2,kn+3,In),this.indexArray.emplaceBack(kn+3,In+1,In),this.indexArray.emplaceBack(kn+3,Un,In+1),we.primitiveLength+=3}ct=!ct}if(C){const $n=this.layoutVertexExtArray,Un=A.projectTilePoint(xt.x,xt.y,u),In=A.projectTilePoint(Mt.x,Mt.y,u),En=A.upVector(u,xt.x,xt.y),ha=A.upVector(u,Mt.x,Mt.y);A1($n,Un,En),A1($n,Un,En),A1($n,In,ha),A1($n,In,ha)}}P&&(ye+=We.length-1),U&&$&&this.zoom>=17&&(Ne.length!==0&&ie(Ne,Ne[0])&&Ne.pop(),this.groundEffect.addData(Ne,he,b))}this.footprintSegments.push(Ie),++z.footprintSegLen}if(z.vertexCount=this.layoutVertexArray.length-z.vertexArrayOffset,z.groundVertexCount=this.groundEffect.vertexArray.length-z.groundVertexArrayOffset,z.vertexCount!==0){if(z.centroidXY=R.borders?hB:this.encodeCentroid(R,z),this.centroidData.push(z),R.borders){this.featuresOnBorder.push(R);const ce=this.featuresOnBorder.length-1;for(let he=0;he<R.borders.length;he++)R.borders[he][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[he].push(ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,h,p,u,v),this.groundEffect.addPaintPropertiesData(t,l,h,p,u,v),this.maxHeight=Math.max(this.maxHeight,W)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((r,l)=>this.featuresOnBorder[r].borders[t][0]-this.featuresOnBorder[l].borders[t][0])}encodeCentroid(t,r){const l=t.centroid(),u=r.span(),h=Math.min(7,Math.round(u.x*this.tileToMeter/10)),p=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new V(ae(l.x,1,ht-1)<<3|h,ae(l.y,1,ht-1)<<3|p)}showCentroid(t){const r=this.centroidData[t.centroidDataIndex];r.flags&=qu,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const r=t.vertexArrayOffset,l=t.vertexCount+t.vertexArrayOffset,u=t.flags&qu?hB:t.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==u.y||h!==u.x){for(let p=r;p<l;++p)this.centroidVertexArray.emplace(p,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const l=r.getReplacementRegionsForTile(t.toUnwrapped());if(function(h,p){if(h.length!==p.length)return!1;for(let g=0;g<h.length;g++)if(h[g].sourceId!==p[g].sourceId||!sB(h[g],p[g]))return!1;return!0}(this.activeReplacements,l))return;if(this.activeReplacements=l,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const h of this.centroidData)h.flags&=2147483647;const u=[];for(const h of this.activeReplacements){const p=Math.pow(2,h.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&qu||h.min.x>g.max.x||g.min.x>h.max.x||h.min.y>g.max.y||g.min.y>h.max.y))for(let v=0;v<g.footprintSegLen;v++){const b=this.footprintSegments[g.footprintSegIdx+v];if(u.length=0,fae(this.footprintVertices,b.vertexOffset,b.vertexCount,h.footprintTileId.canonical,t.canonical,u),uB(h.footprint,u,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-p)){g.flags|=qu;break}}}for(const h of this.centroidData)this.writeCentroidToBuffer(h);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,r,l){let u=!1;for(let h=0;h<l.footprintSegLen;h++){const p=this.footprintSegments[l.footprintSegIdx+h];let g=0;for(const v of p.ringIndices){for(let b=g,w=v+g-1;b<v+g;w=b++){const A=this.footprintVertices.int16[2*(b+p.vertexOffset)+0],C=this.footprintVertices.int16[2*(b+p.vertexOffset)+1],P=this.footprintVertices.int16[2*(w+p.vertexOffset)+1];C>r!=P>r&&t<(this.footprintVertices.int16[2*(w+p.vertexOffset)+0]-A)*(r-C)/(P-C)+A&&(u=!u)}g=v}}return u}getHeightAtTileCoord(t,r){let l=Number.NEGATIVE_INFINITY,u=!0;const h=4*(t+ht)*ht+(r+ht);if(this.partLookup.hasOwnProperty(h)){const p=this.partLookup[h];return p?{height:p.height,hidden:!!(p.flags&qu)}:void 0}for(const p of this.centroidData)t>p.max.x||p.min.x>t||r>p.max.y||p.min.y>r||this.footprintContainsPoint(t,r,p)&&p&&p.height>l&&(l=p.height,this.partLookup[h]=p,u=!!(p.flags&qu));if(l!==Number.NEGATIVE_INFINITY)return{height:l,hidden:u};this.partLookup[h]=void 0}}function vB(i,t){const r=i.add(t)._unit();return i.x*r.x+i.y*r.y}function hae(i,t,r,l){const u=t.sub(i)._perp()._unit(),h=r.sub(t)._perp()._unit();return _B(i,t,r,vB(u,h),l)}function _B(i,t,r,l,u){const h=Math.sqrt(1-l*l);return Math.min(i.dist(t)/3,t.dist(r)/3,u*h/l)}function $P(i,t,r){return i.x<r[0].x&&t.x<r[0].x||i.x>r[1].x&&t.x>r[1].x||i.y<r[0].y&&t.y<r[0].y||i.y>r[1].y&&t.y>r[1].y}function bB(i,t){return i.x<t[0].x||i.x>t[1].x||i.y<t[0].y||i.y>t[1].y}function xB(i,t,r){if(i.x<0||i.x>=ht||t.x<0||t.x>=ht||r.x<0||r.x>=ht)return!1;const l=r.sub(t),u=l.perp(),h=i.sub(t);return(l.x*h.x+l.y*h.y)/Math.sqrt((l.x*l.x+l.y*l.y)*(h.x*h.x+h.y*h.y))>-.866&&u.x*h.x+u.y*h.y<0}function wB(i,t,r){const l=t?2|i:-3&i;return r?1|l:-2&l}function SB(){const i=Math.PI/32,t=Math.tan(i),r=ev;return r*Math.sqrt(1+2*t*t)-r}function AB(i,t,r){const l=1<<r.z,u=ol(r.x/l),h=ol((r.x+1)/l),p=gr(r.y/l),g=gr((r.y+1)/l);return function(v,b,w,A,C=0,P){const R=[];if(!v.length||!w||!A)return R;const z=(K,ie)=>{for(const ce of K)R.push({polygon:ce,bounds:ie})},U=Math.ceil(Math.log2(w)),W=Math.ceil(Math.log2(A)),j=U-W,Y=[];for(let K=0;K<Math.abs(j);K++)Y.push(j>0?0:1);for(let K=0;K<Math.min(U,W);K++)Y.push(0),Y.push(1);let Z=v;if(Z=W2(Z,b[0].y-C,b[1].y+C,1),Z=W2(Z,b[0].x-C,b[1].x+C,0),!Z.length)return R;const $=[];for(Y.length?$.push({polygons:Z,bounds:b,depth:0}):z(Z,b);$.length;){const K=$.pop(),ie=K.depth,ce=Y[ie],he=K.bounds[0],ye=K.bounds[1],Te=ce===0?he.x:he.y,we=ce===0?ye.x:ye.y,Ie=P?P(ce,Te,we):.5*(Te+we),xe=W2(K.polygons,Te-C,Ie+C,ce),We=W2(K.polygons,Ie-C,we+C,ce);if(xe.length){const qe=[he,new V(ce===0?Ie:ye.x,ce===1?Ie:ye.y)];Y.length>ie+1?$.push({polygons:xe,bounds:qe,depth:ie+1}):z(xe,qe)}if(We.length){const qe=[new V(ce===0?Ie:he.x,ce===1?Ie:he.y),ye];Y.length>ie+1?$.push({polygons:We,bounds:qe,depth:ie+1}):z(We,qe)}}return R}(i,t,Math.ceil((h-u)/11.25),Math.ceil((p-g)/11.25),1,(v,b,w)=>{if(v===0)return .5*(b+w);{const A=gr((r.y+b/ht)/l);return(Co(.5*(gr((r.y+w/ht)/l)+A))*l-r.y)*ht}})}function fae(i,t,r,l,u,h){const p=Math.pow(2,l.z-u.z);for(let g=0;g<r;g++){let v=i.int16[2*(g+t)+0],b=i.int16[2*(g+t)+1];v=(v+u.x*ht)*p-l.x*ht,b=(b+u.y*ht)*p-l.y*ht,h.push(new V(v,b))}}un(E1,"FillExtrusionBucket",{omit:["layers","features"]}),un(pB,"PartData"),un(fB,"FootprintSegment"),un(mB,"BorderCentroidData"),un(yB,"GroundEffect");const pae=new yi({visibility:new Xt(nt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Xt(nt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var mae={paint:new yi({"fill-extrusion-opacity":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yn(nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yn(nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yn(nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yn(nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new yn(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new yn(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Xt(nt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"])}),layout:pae};class gv extends V{constructor(t,r,l){super(t,r),this.z=l}}function M1(i,t){return i.x*t.x+i.y*t.y}function EB(i,t){if(i.length===1){let r=0;const l=t[r++];let u;for(;!u||l.equals(u);)if(u=t[r++],!u)return 1/0;for(;r<t.length;r++){const h=t[r],p=i[0],g=u.sub(l),v=h.sub(l),b=p.sub(l),w=M1(g,g),A=M1(g,v),C=M1(v,v),P=M1(b,g),R=M1(b,v),z=w*C-A*A,U=(C*P-A*R)/z,W=(w*R-A*P)/z,j=l.z*(1-U-W)+u.z*U+h.z*W;if(isFinite(j))return j}return 1/0}{let r=1/0;for(const l of t)r=Math.min(r,l.z);return r}}function MB(i,t,r,l,u,h,p,g){const v=p*u.getElevationAt(i,t,!0,!0),b=h[0]!==0,w=b?h[1]===0?p*(h[0]/7-450):p*function(A,C,P){const R=Math.floor(C[0]/8),z=Math.floor(C[1]/8),U=10*(C[0]-8*R),W=10*(C[1]-8*z),j=A.getElevationAt(R,z,!0,!0),Y=A.getMeterToDEM(P),Z=Math.floor(.5*(U*Y-1)),$=Math.floor(.5*(W*Y-1)),K=A.tileCoordToPixel(R,z),ie=2*Z+1,ce=2*$+1,he=function(We,qe,et,Ne,Ve){return[We.getElevationAtPixel(qe,et,!0),We.getElevationAtPixel(qe+Ve,et,!0),We.getElevationAtPixel(qe,et+Ve,!0),We.getElevationAtPixel(qe+Ne,et+Ve,!0)]}(A,K.x-Z,K.y-$,ie,ce),ye=Math.abs(he[0]-he[1]),Te=Math.abs(he[2]-he[3]),we=Math.abs(he[0]-he[2])+Math.abs(he[1]-he[3]),Ie=Math.min(.25,.5*Y*(ye+Te)/ie),xe=Math.min(.25,.5*Y*we/ce);return j+Math.max(Ie*U,xe*W)}(u,h,g):v;return{base:v+(r===0)?-1:r,top:b?Math.max(w+l,v+r+2):v+l}}const gae=new yi({"line-cap":new yn(nt.layout_line["line-cap"]),"line-join":new yn(nt.layout_line["line-join"]),"line-miter-limit":new Xt(nt.layout_line["line-miter-limit"]),"line-round-limit":new Xt(nt.layout_line["line-round-limit"]),"line-sort-key":new yn(nt.layout_line["line-sort-key"]),visibility:new Xt(nt.layout_line.visibility)});var TB={paint:new yi({"line-opacity":new yn(nt.paint_line["line-opacity"]),"line-color":new yn(nt.paint_line["line-color"]),"line-translate":new Xt(nt.paint_line["line-translate"]),"line-translate-anchor":new Xt(nt.paint_line["line-translate-anchor"]),"line-width":new yn(nt.paint_line["line-width"]),"line-gap-width":new yn(nt.paint_line["line-gap-width"]),"line-offset":new yn(nt.paint_line["line-offset"]),"line-blur":new yn(nt.paint_line["line-blur"]),"line-dasharray":new yn(nt.paint_line["line-dasharray"]),"line-pattern":new yn(nt.paint_line["line-pattern"]),"line-gradient":new pm(nt.paint_line["line-gradient"]),"line-trim-offset":new Xt(nt.paint_line["line-trim-offset"]),"line-emissive-strength":new Xt(nt.paint_line["line-emissive-strength"]),"line-border-width":new yn(nt.paint_line["line-border-width"]),"line-border-color":new yn(nt.paint_line["line-border-color"])}),layout:gae};const yae=(i,t,r,l,u,h,p)=>{const g=i.transform,v=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:PB(i,t,r,l),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:LB(r)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:CB(t,i.transform),u_alpha_discard_threshold:0,u_trim_offset:p,u_emissive_strength:r.paint.get("line-emissive-strength")}},vae=(i,t,r,l,u)=>{const h=i.transform;return{u_matrix:PB(i,t,r,l),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:h.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:CB(t,h),u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function CB(i,t){return 1/wm(i,1,t.tileZoom)}function PB(i,t,r,l){return i.translatePosMatrix(l||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const IB=i=>{const t=[];LB(i)&&t.push("RENDER_LINE_DASH"),i.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=i.paint.get("line-trim-offset");return r[0]===0&&r[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),i.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function LB(i){const t=i.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const RB=new class extends yn{possiblyEvaluate(i,t){return t=new ri(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(i,t)}evaluate(i,t,r,l){return t=Ue({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(i,t,r,l)}}(TB.paint.properties["line-width"].specification);function kB(i,t){return t>0?t+2*i:i}RB.useIntegerZoom=!0;const _ae=new yi({visibility:new Xt(nt.layout_background.visibility)});var bae={paint:new yi({"background-color":new Xt(nt.paint_background["background-color"]),"background-pattern":new Xt(nt.paint_background["background-pattern"]),"background-opacity":new Xt(nt.paint_background["background-opacity"]),"background-emissive-strength":new Xt(nt.paint_background["background-emissive-strength"])}),layout:_ae};const xae=new yi({visibility:new Xt(nt.layout_raster.visibility)});var wae={paint:new yi({"raster-opacity":new Xt(nt.paint_raster["raster-opacity"]),"raster-color":new pm(nt.paint_raster["raster-color"]),"raster-color-mix":new Xt(nt.paint_raster["raster-color-mix"]),"raster-color-range":new Xt(nt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Xt(nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xt(nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xt(nt.paint_raster["raster-brightness-max"]),"raster-saturation":new Xt(nt.paint_raster["raster-saturation"]),"raster-contrast":new Xt(nt.paint_raster["raster-contrast"]),"raster-resampling":new Xt(nt.paint_raster["raster-resampling"]),"raster-fade-duration":new Xt(nt.paint_raster["raster-fade-duration"])}),layout:xae};function DB(i,t,r,l,u,h,p,g){const v=[i,r,u,t,l,h,1,1,1],b=[p,g,1],w=zs.adjoint([],v),[A,C,P]=ke.transformMat3(b,b,zs.transpose(w,w));return zs.multiply(v,[A,0,0,0,C,0,0,0,P],v)}class Xu extends Bn{constructor(t,r,l,u){super(),this.id=t,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=r,this._dirty=!1}load(t,r){if(this._loaded=r||!1,this.fire(new Ht("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qt(this.map._requestManager.transformRequest(this.url,Se.Image),(l,u)=>{if(this._imageRequest=null,this._loaded=!0,l)this.fire(new vn(l));else if(u){const{HTMLImageElement:h}=m;this.image=u instanceof h?Cn.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new s3(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof s3||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=t[0][1],l=t[0][1];for(const h of t)h[1]>l&&(l=h[1]),h[1]<r&&(r=h[1]);const u=(l+r)/2;if(u>$i?this.onNorthPole=!0:u<-$i&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=t.map(ga.fromLngLat);this.tileID=function(p){let g=1/0,v=1/0,b=-1/0,w=-1/0;for(const R of p)g=Math.min(g,R.x),v=Math.min(v,R.y),b=Math.max(b,R.x),w=Math.max(w,R.y);const A=Math.max(b-g,w-v),C=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),P=Math.pow(2,C);return new Vu(C,Math.floor((g+b)/2*P),Math.floor((v+w)/2*P))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const v in this.tiles){const b=this.tiles[v];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}if(this._boundsArray)return;const r=xm(this.tileID,this.map.transform.projection),[l,u,h,p]=this.coordinates.map(v=>{const b=r.projection.project(v[0],v[1]);return wN(r,b)._round()});this.perspectiveTransform=function(v,b,w,A,C,P,R,z,U,W){const j=DB(0,0,v,0,0,b,v,b),Y=DB(w,A,C,P,R,z,U,W);return zs.multiply(Y,zs.adjoint(j,j),Y),[Y[6]/Y[8]*v/ht,Y[7]/Y[8]*b/ht]}(this.width,this.height,l.x,l.y,u.x,u.y,p.x,p.y,h.x,h.y);const g=this._boundsArray=new je;g.emplaceBack(l.x,l.y,0,0),g.emplaceBack(u.x,u.y,ht,0),g.emplaceBack(p.x,p.y,0,ht),g.emplaceBack(h.x,h.y,ht,ht),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,OP.members),this.boundsSegments=ja.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const r=this.map.painter.context,l=r.gl;!this._dirty||this.texture instanceof s3||(this.texture?this.texture.update(this.image):(this.texture=new yr(r,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(r)}loadTile(t,r){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},r(null)):(t.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Sae extends Yo{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const Aae=new yi({visibility:new Xt(nt.layout_sky.visibility)});var Eae={paint:new yi({"sky-type":new Xt(nt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xt(nt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xt(nt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xt(nt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xt(nt.paint_sky["sky-gradient-radius"]),"sky-gradient":new pm(nt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xt(nt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xt(nt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xt(nt.paint_sky["sky-opacity"])}),layout:Aae};function qP(i,t,r){const l=[0,0,1],u=To.identity([]);return To.rotateY(u,u,r?-be(i)+Math.PI:be(i)),To.rotateX(u,u,-be(t)),ke.transformQuat(l,l,u),ke.normalize(l,l)}var Mae={paint:new yi({})};const Tae={circle:class extends Yo{constructor(i,t){super(i,pee,t)}createBucket(i){return new oP(i)}queryRadius(i){const t=i;return nv("circle-radius",this,t)+nv("circle-stroke-width",this,t)+L2(this.paint.get("circle-translate"))}queryIntersectsFeature(i,t,r,l,u,h,p,g){const v=xF(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return SF(i,l,h,p,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(i,t){const r=wF(this);return{config:new mm(this,t),defines:r,overrideFog:!1}}},heatmap:class extends Yo{createBucket(i){return new EF(i)}constructor(i,t){super(i,xee,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=R2({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return nv("heatmap-radius",this,i)}queryIntersectsFeature(i,t,r,l,u,h,p,g){const v=this.paint.get("heatmap-radius").evaluate(t,r);return SF(i,l,h,p,g,!0,!0,new V(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(i,t){return i==="heatmap"?{config:new mm(this,t),overrideFog:!1}:{}}},hillshade:class extends Yo{constructor(i,t){super(i,See,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(i,t){return{overrideFog:!1}}},fill:class extends Yo{constructor(i,t){super(i,Fee,t)}getProgramIds(){const i=this.paint.get("fill-pattern"),t=i&&i.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(i,t){return{config:new mm(this,t),overrideFog:!1}}recalculate(i,t){super.recalculate(i,t);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new N2(i)}queryRadius(){return L2(this.paint.get("fill-translate"))}queryIntersectsFeature(i,t,r,l,u,h){return!i.queryGeometry.isAboveHorizon&&gF(bF(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),l)}isTileClipped(){return!0}},"fill-extrusion":class extends Yo{constructor(i,t){super(i,mae,t)}createBucket(i){return new E1(i)}queryRadius(){return L2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(i,t,r,l,u,h,p,g,v){const b=xF(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(t,r),A=this.paint.get("fill-extrusion-base").evaluate(t,r),C=[0,0],P=g&&h.elevation,R=h.elevation?h.elevation.exaggeration():1,z=i.tile.getBucket(this);if(P&&z instanceof E1){const Z=z.centroidVertexArray,$=v+1;$<Z.length&&(C[0]=Z.geta_centroid_pos0($),C[1]=Z.geta_centroid_pos1($))}if(C[0]===0&&C[1]===1)return!1;h.projection.name==="globe"&&(l=AB([l],[new V(0,0),new V(ht,ht)],i.tileID.canonical).map(Z=>Z.polygon).flat());const U=P?g:null,[W,j]=function(Z,$,K,ie,ce,he,ye,Te,we,Ie,xe){return Z.projection.name==="globe"?function(We,qe,et,Ne,Ve,it,gt,ct,Pt,Ft,xt){const Mt=[],en=[],on=We.projection.upVectorScale(xt,We.center.lat,We.worldSize).metersToTile,rn=[0,0,0,1],cn=[0,0,0,1],gn=(ea,ba,$n,Un)=>{ea[0]=ba,ea[1]=$n,ea[2]=Un,ea[3]=1},kn=SB();et>0&&(et+=kn),Ne+=kn;for(const ea of qe){const ba=[],$n=[];for(const Un of ea){const In=Un.x+Ve.x,En=Un.y+Ve.y,ha=We.projection.projectTilePoint(In,En,xt),Ma=We.projection.upVector(xt,Un.x,Un.y);let Qn=et,Xa=Ne;if(gt){const xi=MB(In,En,et,Ne,gt,ct,Pt,Ft);Qn+=xi.base,Xa+=xi.top}et!==0?gn(rn,ha.x+Ma[0]*on*Qn,ha.y+Ma[1]*on*Qn,ha.z+Ma[2]*on*Qn):gn(rn,ha.x,ha.y,ha.z),gn(cn,ha.x+Ma[0]*on*Xa,ha.y+Ma[1]*on*Xa,ha.z+Ma[2]*on*Xa),ke.transformMat4(rn,rn,it),ke.transformMat4(cn,cn,it),ba.push(new gv(rn[0],rn[1],rn[2])),$n.push(new gv(cn[0],cn[1],cn[2]))}Mt.push(ba),en.push($n)}return[Mt,en]}(Z,$,K,ie,ce,he,ye,Te,we,Ie,xe):ye?function(We,qe,et,Ne,Ve,it,gt,ct,Pt){const Ft=[],xt=[],Mt=[0,0,0,1];for(const en of We){const on=[],rn=[];for(const cn of en){const gn=cn.x+Ne.x,kn=cn.y+Ne.y,ea=MB(gn,kn,qe,et,it,gt,ct,Pt);Mt[0]=gn,Mt[1]=kn,Mt[2]=ea.base,Mt[3]=1,Ga.transformMat4(Mt,Mt,Ve),Mt[3]=Math.max(Mt[3],1e-5);const ba=new gv(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);Mt[0]=gn,Mt[1]=kn,Mt[2]=ea.top,Mt[3]=1,Ga.transformMat4(Mt,Mt,Ve),Mt[3]=Math.max(Mt[3],1e-5);const $n=new gv(Mt[0]/Mt[3],Mt[1]/Mt[3],Mt[2]/Mt[3]);on.push(ba),rn.push($n)}Ft.push(on),xt.push(rn)}return[Ft,xt]}($,K,ie,ce,he,ye,Te,we,Ie):function(We,qe,et,Ne,Ve){const it=[],gt=[],ct=Ve[8]*qe,Pt=Ve[9]*qe,Ft=Ve[10]*qe,xt=Ve[11]*qe,Mt=Ve[8]*et,en=Ve[9]*et,on=Ve[10]*et,rn=Ve[11]*et;for(const cn of We){const gn=[],kn=[];for(const ea of cn){const ba=ea.x+Ne.x,$n=ea.y+Ne.y,Un=Ve[0]*ba+Ve[4]*$n+Ve[12],In=Ve[1]*ba+Ve[5]*$n+Ve[13],En=Ve[2]*ba+Ve[6]*$n+Ve[14],ha=Ve[3]*ba+Ve[7]*$n+Ve[15],Ma=Un+ct,Qn=In+Pt,Xa=En+Ft,xi=Math.max(ha+xt,1e-5),oi=Un+Mt,ei=In+en,rr=En+on,wi=Math.max(ha+rn,1e-5);gn.push(new gv(Ma/xi,Qn/xi,Xa/xi)),kn.push(new gv(oi/wi,ei/wi,rr/wi))}it.push(gn),gt.push(kn)}return[it,gt]}($,K,ie,ce,he)}(h,l,A,w,b,p,U,C,R,h.center.lat,i.tileID.canonical),Y=i.queryGeometry;return function(Z,$,K){let ie=1/0;gF(K,$)&&(ie=EB(K,$[0]));for(let ce=0;ce<$.length;ce++){const he=$[ce],ye=Z[ce];for(let Te=0;Te<he.length-1;Te++){const we=he[Te],Ie=[we,he[Te+1],ye[Te+1],ye[Te],we];mF(K,Ie)&&(ie=Math.min(ie,EB(K,Ie)))}}return ie!==1/0&&ie}(W,j,Y.isPointQuery()?Y.screenBounds:Y.screenGeometry)}},line:class extends Yo{constructor(i,t){super(i,TB,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof tf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,t){super.recalculate(i,t),this.paint._values["line-floorwidth"]=RB.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new o3(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(i,t){const r=IB(this);return{config:new mm(this,t),defines:r,overrideFog:!1}}queryRadius(i){const t=i,r=kB(nv("line-width",this,t),nv("line-gap-width",this,t)),l=nv("line-offset",this,t);return r/2+Math.abs(l)+L2(this.paint.get("line-translate"))}queryIntersectsFeature(i,t,r,l,u,h){if(i.queryGeometry.isAboveHorizon)return!1;const p=bF(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,i.pixelToTileUnitsFactor),g=i.pixelToTileUnitsFactor/2*kB(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),v=this.paint.get("line-offset").evaluate(t,r);return v&&(l=function(b,w){const A=[],C=new V(0,0);for(let P=0;P<b.length;P++){const R=b[P],z=[];for(let U=0;U<R.length;U++){const W=R[U],j=R[U+1],Y=U===0?C:W.sub(R[U-1])._unit()._perp(),Z=U===R.length-1?C:j.sub(W)._unit()._perp(),$=Y._add(Z)._unit();$._mult(1/($.x*Z.x+$.y*Z.y)),z.push($._mult(w)._add(W))}A.push(z)}return A}(l,v*i.pixelToTileUnitsFactor)),function(b,w,A){for(let C=0;C<w.length;C++){const P=w[C];if(b.length>=3){for(let R=0;R<P.length;R++)if(bf(b,P[R]))return!0}if(uee(b,P,A))return!0}return!1}(p,l,g)}isTileClipped(){return!0}},symbol:e3,background:class extends Yo{constructor(i,t){super(i,bae,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(i,t){return{overrideFog:!1}}},raster:class extends Yo{constructor(i,t){super(i,wae,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(i){return!(i&&i._source instanceof Xu&&(i._source.onNorthPole||i._source.onSouthPole))}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-color"].value.expression,[t,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=R2({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:r}],resolution:256}),this.colorRampTexture=null}},sky:class extends Yo{constructor(i,t){super(i,Eae,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=R2({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(i,t){if(this.paint.get("sky-type")==="atmosphere"){const l=this.paint.get("sky-atmosphere-sun"),u=!l,h=i.style.light,p=h.properties.get("position");return u&&h.properties.get("anchor")==="viewport"&&ve("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?qP(p.azimuthal,90-p.polar,t):qP(l[0],90-l[1],t)}const r=this.paint.get("sky-gradient-center");return qP(r[0],90-r[1],t)}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}},slot:class extends Yo{constructor(i,t){super(i,Mae)}},model:class extends Yo{constructor(i,t){super(i,eae,t)}createBucket(i){return new nB(i)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(i,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven()||i!=="model-color"&&i!=="model-color-mix-intensity"&&i!=="model-rotation"&&i!=="model-scale"&&i!=="model-translation"&&i!=="model-emissive-strength")}_isPropertyZoomDependent(i){const t=this._transitionablePaint._values[i];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof zc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function v3(i,t){return i.type==="custom"?new Sae(i):new Tae[i.type](i,t)}function Cae(i){const{userImage:t}=i;return!!(t&&t.render&&t.render())&&(i.data.replace(new Uint8Array(t.data.buffer)),!0)}class Pae extends Bn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new qi({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,r){if(this.loaded[r]!==t&&(this.loaded[r]=t,t)){for(const{ids:l,callback:u}of this.requestors)this._notify(l,r,u);this.requestors=[]}}hasImage(t,r){return!!this.getImage(t,r)}getImage(t,r){return this.images[r][t]}addImage(t,r,l){this._validate(t,l)&&(this.images[r][t]=l)}_validate(t,r){let l=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new vn(new Error(`Image "${t}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new vn(new Error(`Image "${t}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new vn(new Error(`Image "${t}" has invalid "content" value`))),l=!1),l}_validateStretch(t,r){if(!t)return!0;let l=0;for(const u of t){if(u[0]<l||u[1]<u[0]||r<u[1])return!1;l=u[1]}return!0}_validateContent(t,r){return!(t&&(t.length!==4||t[0]<0||r.data.width<t[0]||t[1]<0||r.data.height<t[1]||t[2]<0||r.data.width<t[2]||t[3]<0||r.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,r,l){l.version=this.images[r][t].version+1,this.images[r][t]=l,this.updatedImages[r][t]=!0}removeImage(t,r){const l=this.images[r][t];delete this.images[r][t],delete this.patterns[r][t],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,r,l){let u=!0;const h=!!this.loaded[r];if(!h)for(const p of t)this.images[r][p]||(u=!1);h||u?this._notify(t,r,l):this.requestors.push({ids:t,scope:r,callback:l})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,r,l){const u={};for(const h of t){this.images[r][h]||this.fire(new Ht("styleimagemissing",{id:h}));const p=this.images[r][h];p?u[h]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:ve(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}l(null,u)}getPixelSize(t){const{width:r,height:l}=this.atlasImage[t];return{width:r,height:l}}getPattern(t,r){const l=this.patterns[r][t],u=this.getImage(t,r);if(!u)return null;if(l&&l.position.version===u.version)return l.position;if(l)l.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},p=new MP(h,u);this.patterns[r][t]={bin:h,position:p}}return this._updatePatternAtlas(r),this.patterns[r][t].position}bind(t,r){const l=t.gl;let u=this.atlasTexture[r];u?this.dirty&&(u.update(this.atlasImage[r]),this.dirty=!1):(u=new yr(t,this.atlasImage[r],l.RGBA),this.atlasTexture[r]=u),u.bind(l.LINEAR,l.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const r=[];for(const p in this.patterns[t])r.push(this.patterns[t][p].bin);const{w:l,h:u}=EP(r),h=this.atlasImage[t];h.resize({width:l||1,height:u||1});for(const p in this.patterns[t]){const{bin:g}=this.patterns[t][p],v=g.x+1,b=g.y+1,w=this.images[t][p].data,A=w.width,C=w.height;qi.copy(w,h,{x:0,y:0},{x:v,y:b},{width:A,height:C}),qi.copy(w,h,{x:0,y:C-1},{x:v,y:b-1},{width:A,height:1}),qi.copy(w,h,{x:0,y:0},{x:v,y:b+C},{width:A,height:1}),qi.copy(w,h,{x:A-1,y:0},{x:v-1,y:b},{width:1,height:C}),qi.copy(w,h,{x:0,y:0},{x:v+A,y:b},{width:1,height:C})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,r){for(const l of t){if(this.callbackDispatchedThisFrame[r][l])continue;this.callbackDispatchedThisFrame[r][l]=!0;const u=this.images[r][l];Cae(u)&&this.updateImage(l,r,u)}}}const Iae=new yi({anchor:new Xt(nt.light.anchor),position:new class{constructor(i){this.specification=i}possiblyEvaluate(i,t){return st(i.expression.evaluate(t))}interpolate(i,t,r){return{x:Ln(i.x,t.x,r),y:Ln(i.y,t.y,r),z:Ln(i.z,t.z,r),azimuthal:Ln(i.azimuthal,t.azimuthal,r),polar:Ln(i.polar,t.polar,r)}}}(nt.light.position),color:new Xt(nt.light.color),intensity:new Xt(nt.light.intensity)});class OB extends Bn{constructor(t,r="flat"){super(),this._transitionable=new jd(Iae),this.setLight(t,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r,l={}){this._validate(Fy,t,l)||(this._transitionable.setTransitionOrValue(t),this.id=r)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,l){return(!l||l.validate!==!1)&&go(this,t.call(Ou,Ue({value:r,style:{glyphs:!0,sprite:!0},styleSpec:nt})))}}const Lae=new yi({source:new Xt(nt.terrain.source),exaggeration:new Xt(nt.terrain.exaggeration)});let Rae=class extends Bn{constructor(i,t){super(),this._transitionable=new jd(Lae),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}setScope(i){this.scope=i}get(){return this._transitionable.serialize()}set(i){this._transitionable.setTransitionOrValue(i)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}getExaggeration(i){return this._transitioning.possiblyEvaluate(new ri(i)).get("exaggeration")}isZoomDependent(){const i=this._transitionable._values.exaggeration;return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof zc}};const zB=45,FB=65,Em=.05;function _3(i,t,r,l){const u=Ee(zB,FB,r),[h,p]=NB(i,l);let g=1-Math.min(1,Math.exp((t-h)/(p-h)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*u*i.alpha}function NB(i,t){const r=.5/Math.tan(.5*t);return[i.range[0]+r,i.range[1]+r]}function BB(i,t,r,l,u){const h=ke.transformMat4([],[t,r,l],u.mercatorFogMatrix);return _3(i,ke.length(h),u.pitch,u._fov)}function UB(i,t,r,l,u,h,p){const g=[[r,l,0],[u,l,0],[u,h,0],[r,h,0]];let v=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(const w of g){const A=ke.transformMat4([],w,t),C=ke.length(A);v=Math.min(v,C),b=Math.max(b,C)}return[_3(i,v,p.pitch,p._fov),_3(i,b,p.pitch,p._fov)]}const kae=new yi({range:new Xt(nt.fog.range),color:new Xt(nt.fog.color),"high-color":new Xt(nt.fog["high-color"]),"space-color":new Xt(nt.fog["space-color"]),"horizon-blend":new Xt(nt.fog["horizon-blend"]),"star-intensity":new Xt(nt.fog["star-intensity"]),"vertical-range":new Xt(nt.fog["vertical-range"])});class Dae extends Bn{constructor(t,r){super(),this._transitionable=new jd(kae),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r=t.projection.name==="globe",l=vo(t.zoom),u=this.properties.get("range"),h=[.5,3];return{range:r?[Ln(h[0],u[0],l),Ln(h[1],u[1],l)]:u,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(this._validate(Ny,t,r))return;const l=Ue({},t);for(const u of Object.keys(nt.fog))l[u]===void 0&&(l[u]=nt.fog[u].default);this._transitionable.setTransitionOrValue(l)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Ee(zB,FB,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(l,u,h){const p=ga.fromLngLat(u),g=h.elevation?h.elevation.getAtPointOrZero(p):0;return BB(l,p.x,p.y,g,h)}(this.state,t,r):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(t.toUnwrapped());return UB(this.state,r,0,0,ht,ht,this._transform)}getOpacityForBounds(t,r,l,u,h){return this._transform.projection.supportsFog?UB(this.state,t,r,l,u,h,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?NB(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const l of r){const u=t.points[l];let h;if(u[2]>=0)h=u;else{const p=t.points[l-4];h=nf(p,u,p[2]/(p[2]-u[2]))}if(BB(this.state,h[0],h[1],0,this._transform)>=Em)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,l){return(!l||l.validate!==!1)&&go(this,t.call(Ou,Ue({value:r,style:{glyphs:!0,sprite:!0},styleSpec:nt})))}}class Oae{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class zae{constructor(){this.tasks={},this.taskQueue=[],pt(["process"],this),this.invoker=new Oae(this.process),this.nextId=0}add(t,r){const l=this.nextId++,u=function({type:h,isSymbolTile:p,zoom:g}){return g=g||0,h==="message"?0:h!=="maybePrepare"||p?h!=="parseTile"||p?h==="parseTile"&&p?300-g:h==="maybePrepare"&&p?400-g:500:200-g:100-g}(r);if(u===0){ne();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[l]={fn:t,metadata:r,priority:u,id:l},this.taskQueue.push(l),this.invoker.trigger(),{cancel:()=>{delete this.tasks[l]}}}process(){ne();try{if(this.taskQueue=this.taskQueue.filter(l=>!!this.tasks[l]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let t=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const h=this.tasks[this.taskQueue[u]];h.priority<r&&(r=h.priority,t=u)}if(t===null)return null;const l=this.taskQueue[t];return this.taskQueue.splice(t,1),l}remove(){this.invoker.remove()}}class WB{constructor(t,r,l){this.target=t,this.parent=r,this.mapId=l,this.callbacks={},this.cancelCallbacks={},pt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new zae}send(t,r,l,u,h=!1,p){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);l&&(l.metadata=p,this.callbacks[g]=l);const v=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!l,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:ks(r,v)},v),{cancel:()=>{l&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(t){const r=t.data,l=r.id;if(l&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const u=this.cancelCallbacks[l];delete this.cancelCallbacks[l],u&&u.cancel()}else if(r.mustQueue||ne()){const u=this.callbacks[l];this.cancelCallbacks[l]=this.scheduler.add(()=>this.processTask(l,r),u&&u.metadata||{type:"message"})}else this.processTask(l,r)}processTask(t,r){if(r.type==="<response>"){const l=this.callbacks[t];delete this.callbacks[t],l&&(r.error?l(Gd(r.error)):l(null,Gd(r.data)))}else{const l=new Set,u=r.hasCallback?(p,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:p?ks(p):null,data:ks(g,l)},l)}:p=>{},h=Gd(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,h,u);else if(this.parent.getWorkerSource){const p=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,p[0],h.source,h.scope)[p[1]](h,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Mm{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=kt();const l=this.workerPool.acquire(this.id);for(let u=0;u<l.length;u++){const h=new Mm.Actor(l[u],r,this.id);h.name=`Worker ${u}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,r,l){Xe(this.actors,(u,h)=>{u.send(t,r,h)},l=l||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Mm.Actor=WB;class VB extends Bn{constructor(t,r,l,u){super(),this.scope=l,this._options=t,this.properties=new Bu(r),this._transitionable=new jd(r,new Map(u)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,r){this._options=t,this._transitionable.setTransitionOrValue(t.properties,r)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Fae=new yi({color:new Xt(nt.properties_light_ambient.color),intensity:new Xt(nt.properties_light_ambient.intensity)}),Nae=new yi({direction:new class{constructor(i){this.specification=i}possiblyEvaluate(i,t){return function([r,l]){const u=st([1,r,l]);return{x:u.x,y:u.y,z:u.z}}(i.expression.evaluate(t))}interpolate(i,t,r){return{x:Ln(i.x,t.x,r),y:Ln(i.y,t.y,r),z:Ln(i.z,t.z,r)}}}(nt.properties_light_directional.direction),color:new Xt(nt.properties_light_directional.color),intensity:new Xt(nt.properties_light_directional.intensity),"cast-shadows":new Xt(nt.properties_light_directional["cast-shadows"]),"shadow-intensity":new Xt(nt.properties_light_directional["shadow-intensity"])});class XP{constructor(t,r,l,u){this.screenBounds=t,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=l,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,u)}static createFromScreenPoints(t,r){let l,u;if(t instanceof V||typeof t[0]=="number"){const h=V.convert(t);l=[h],u=r.isPointAboveHorizon(h)}else{const h=V.convert(t[0]),p=V.convert(t[1]);l=[h,p],u=le(h,p).every(g=>r.isPointAboveHorizon(g))}return new XP(l,r.getCameraPoint(),u,r)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return le(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],l=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=le(r,l,0,!1);return this.cameraPoint.y>l.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<l.x?u.splice(3,0,this.cameraPoint):this.cameraPoint.x>=l.x?u[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(u[3]=this.cameraPoint)),function(h,p){const g=[];for(let v=0;v<h.length;v++){const b=Ze(v-1,-1,h.length-1),w=Ze(v+1,-1,h.length-1),A=h[v],C=h[w],P=h[b].sub(A).unit(),R=C.sub(A).unit(),z=R.angleWithSep(P.x,P.y),U=P.add(R).unit().mult(-1*p/Math.sin(z/2));g.push(A.add(U))}return g}(u,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],l=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=le(r,l,t),h=this.cameraPoint.clone();switch(3*((h.y>r.y)+(h.y>l.y))+((h.x>r.x)+(h.x>l.x))){case 0:u[0]=h,u[4]=h.clone();break;case 1:u.splice(1,0,h);break;case 2:u[1]=h;break;case 3:u.splice(4,0,h);break;case 5:u.splice(2,0,h);break;case 6:u[3]=h;break;case 7:u.splice(3,0,h);break;case 8:u[2]=h}return u}containsTile(t,r,l,u=0){const h=t.queryPadding/r._pixelsPerMercatorPixel+1,p=l?this._bufferedCameraMercator(h,r):this._bufferedScreenMercator(h,r);let g=t.tileID.wrap+(p.unwrapped?u:0);const v=p.polygon.map(U=>wN(t.tileTransform,U,g));if(!_F(v,0,0,ht,ht))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?u:0);const b=this.screenGeometryMercator.polygon.map(U=>SN(t.tileTransform,U,g)),w=b.map(U=>new V(U[0],U[1])),A=r.getFreeCameraOptions().position||new ga(0,0,0),C=SN(t.tileTransform,A,g),P=b.map(U=>{const W=ke.sub(U,U,C);return ke.normalize(W,W),new S2(C,W)}),R=wm(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:w,tilespaceRays:P,bufferedTilespaceGeometry:v,bufferedTilespaceBounds:(z=Ge(v),z.min.x=ae(z.min.x,0,ht),z.min.y=ae(z.min.y,0,ht),z.max.x=ae(z.max.x,0,ht),z.max.y=ae(z.max.y,0,ht),z),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:R};var z}_bufferedScreenMercator(t,r){const l=GB(t);if(this._screenRaycastCache[l])return this._screenRaycastCache[l];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),r):{polygon:this.bufferedScreenGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._screenRaycastCache[l]=u,u}}_bufferedCameraMercator(t,r){const l=GB(t);if(this._cameraRaycastCache[l])return this._cameraRaycastCache[l];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),r):{polygon:this.bufferedCameraGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._cameraRaycastCache[l]=u,u}}_projectAndResample(t,r){const l=function(h,p){const g=at.multiply([],p.pixelMatrix,p.globeMatrix),v=[0,-hs,0,1],b=[0,hs,0,1],w=[0,0,0,1];Ga.transformMat4(v,v,g),Ga.transformMat4(b,b,g),Ga.transformMat4(w,w,g);const A=new V(v[0]/v[3],v[1]/v[3]),C=new V(b[0]/b[3],b[1]/b[3]),P=bf(h,A)&&v[3]<w[3],R=bf(h,C)&&b[3]<w[3];if(!P&&!R)return null;const z=function(ie,ce,he){for(let ye=1;ye<ie.length;ye++){const Te=T1(ce.pointCoordinate3D(ie[ye-1]).x),we=T1(ce.pointCoordinate3D(ie[ye]).x);if(he<0){if(Te<we)return{idx:ye,t:-Te/(we-1-Te)}}else if(we<Te)return{idx:ye,t:(1-Te)/(we+1-Te)}}return null}(h,p,P?-1:1);if(!z)return null;const{idx:U,t:W}=z;let j=U>1?YP(h.slice(0,U),p):[],Y=U<h.length?YP(h.slice(U),p):[];j=j.map(ie=>new V(T1(ie.x),ie.y)),Y=Y.map(ie=>new V(T1(ie.x),ie.y));const Z=[...j];Z.length===0&&Z.push(Y[Y.length-1]);const $=Ln(Z[Z.length-1].y,(Y.length===0?j[0]:Y[0]).y,W);let K;return K=P?[new V(0,$),new V(0,0),new V(1,0),new V(1,$)]:[new V(1,$),new V(1,1),new V(0,1),new V(0,$)],Z.push(...K),Y.length===0?Z.push(j[0]):Z.push(...Y),{polygon:Z.map(ie=>new ga(ie.x,ie.y)),unwrapped:!1}}(t,r);if(l)return l;const u=function(h,p){let g=!1,v=-1/0,b=0;for(let A=0;A<h.length-1;A++)h[A].x>v&&(v=h[A].x,b=A);for(let A=0;A<h.length-1;A++){const C=(b+A)%(h.length-1),P=h[C],R=h[C+1];Math.abs(P.x-R.x)>.5&&(P.x<R.x?(P.x+=1,C===0&&(h[h.length-1].x+=1)):(R.x+=1,C+1===h.length-1&&(h[0].x+=1)),g=!0)}const w=_o(p.center.lng);return g&&w<Math.abs(w-1)&&h.forEach(A=>{A.x-=1}),{polygon:h,unwrapped:g}}(YP(t,r).map(h=>new V(T1(h.x),h.y)),r);return{polygon:u.polygon.map(h=>new ga(h.x,h.y)),unwrapped:u.unwrapped}}}function YP(i,t){return fF(i,r=>{const l=t.pointCoordinate3D(r);r.x=l.x,r.y=l.y},1/256)}function T1(i){return i<0?1+i%1:i%1}function GB(i){return 100*i|0}function ZP(i,t,r,l,u){const h=function(p,g){if(p)return u(p);if(g){i.url&&g.tiles&&i.tiles&&delete i.tiles;const v=ft(Ue(g,i),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(b=>b.id)),v.tiles=t.canonicalizeTileset(v,i.url),u(null,v)}};return i.url?tt(t.transformRequest(t.normalizeSourceURL(i.url,null,r,l),Se.Source),h):Cn.frame(()=>h(null,i))}class b3{constructor(t,r,l){this.bounds=Dl.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),l=Math.floor(_o(this.bounds.getWest())*r),u=Math.floor(Co(this.bounds.getNorth())*r),h=Math.ceil(_o(this.bounds.getEast())*r),p=Math.ceil(Co(this.bounds.getSouth())*r);return t.x>=l&&t.x<h&&t.y>=u&&t.y<p}}class HB{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.image=new eh({width:t,height:r}),this.positions={},this.uploaded=!1}getDash(t,r){const l=this.getKey(t,r);return this.positions[l]}trim(){const t=this.width,r=this.height=It(this.nextRow);this.image.resize({width:t,height:r})}getKey(t,r){return t.join(",")+r}getDashRanges(t,r,l){const u=[];let h=t.length%2==1?-t[t.length-1]*l:0,p=t[0]*l,g=!0;u.push({left:h,right:p,isDash:g,zeroLength:t[0]===0});let v=t[0];for(let b=1;b<t.length;b++){g=!g;const w=t[b];h=v*l,v+=w,p=v*l,u.push({left:h,right:p,isDash:g,zeroLength:w===0})}return u}addRoundDash(t,r,l){const u=r/2;for(let h=-l;h<=l;h++){const p=this.width*(this.nextRow+l+h);let g=0,v=t[g];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++g]);const w=Math.abs(b-v.left),A=Math.abs(b-v.right),C=Math.min(w,A);let P;const R=h/l*(u+1);if(v.isDash){const z=u-Math.abs(R);P=Math.sqrt(C*C+z*z)}else P=u-Math.sqrt(C*C+R*R);this.image.data[p+b]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(t,r){for(let v=t.length-1;v>=0;--v){const b=t[v],w=t[v+1];b.zeroLength?t.splice(v,1):w&&w.isDash===b.isDash&&(w.left=b.left,t.splice(v,1))}const l=t[0],u=t[t.length-1];l.isDash===u.isDash&&(l.left=u.left-this.width,u.right=l.right+this.width);const h=this.width*this.nextRow;let p=0,g=t[p];for(let v=0;v<this.width;v++){v/g.right>1&&(g=t[++p]);const b=Math.abs(v-g.left),w=Math.abs(v-g.right),A=Math.min(b,w);this.image.data[h+v]=Math.max(0,Math.min(255,(g.isDash?A:-A)+r+128))}}addDash(t,r){const l=this.getKey(t,r);if(this.positions[l])return this.positions[l];const u=r==="round",h=u?7:0,p=2*h+1;if(this.nextRow+p>this.height)return ve("LineAtlas out of space"),null;t.length===0&&t.push(1);let g=0;for(let w=0;w<t.length;w++)t[w]<0&&(ve("Negative value is found in line dasharray, replacing values with 0"),t[w]=0),g+=t[w];if(g!==0){const w=this.width/g,A=this.getDashRanges(t,this.width,w);u?this.addRoundDash(A,w,h):this.addRegularDash(A,r==="square"?.5*w:0)}const v=this.nextRow+h;this.nextRow+=p;const b={tl:[v,h],br:[g,0]};return this.positions[l]=b,b}}un(HB,"LineAtlas");const jB=1*jc;class $B{constructor(t){const r={},l=[];for(const g in t){const v=t[g],b=r[g]={};for(const w in v.glyphs){const A=v.glyphs[+w];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const C=A.metrics.localGlyph?jB:1,P={x:0,y:0,w:A.bitmap.width+2*C,h:A.bitmap.height+2*C};l.push(P),b[w]=P}}const{w:u,h}=EP(l),p=new eh({width:u||1,height:h||1});for(const g in t){const v=t[g];for(const b in v.glyphs){const w=v.glyphs[+b];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const A=r[g][b],C=w.metrics.localGlyph?jB:1;eh.copy(w.bitmap,p,{x:0,y:0},{x:A.x+C,y:A.y+C},w.bitmap)}}this.image=p,this.positions=r}}un($B,"GlyphAtlas");class Bae{constructor(t){this.tileID=new Ca(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=xm(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,r,l,u,h){this.status="parsing",this.data=t,this.collisionBoxArray=new TC;const p=new zF(Object.keys(t.layers).sort()),g=new wP(this.tileID,this.promoteId);g.bucketLayerIDs=[];const v={},b=new HB(256,256),w={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:l,brightness:this.brightness},A=r.familiesBySource[this.source];for(const j in A){const Y=t.layers[j];if(!Y)continue;let Z=!1,$=!1,K=!1;for(const he of A[j])he[0].type==="symbol"?Z=!0:$=!0,he[0].is3D()&&he[0].type!=="model"&&(K=!0);if(this.extraShadowCaster&&!K||this.isSymbolTile===!0&&!Z||this.isSymbolTile===!1&&!$)continue;Y.version===1&&ve(`Vector tile source "${this.source}" layer "${j}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ie=p.encode(j),ce=[];for(let he=0;he<Y.length;he++){const ye=Y.feature(he),Te=g.getId(ye,j);ce.push({feature:ye,id:Te,index:he,sourceLayerIndex:ie})}for(const he of A[j]){const ye=he[0];(!this.extraShadowCaster||ye.is3D()&&ye.type!=="model")&&(this.isSymbolTile!==void 0&&ye.type==="symbol"!==this.isSymbolTile||ye.minzoom&&this.zoom<Math.floor(ye.minzoom)||ye.maxzoom&&this.zoom>=ye.maxzoom||ye.visibility!=="none"&&(KP(he,this.zoom,w.brightness,l),(v[ye.id]=ye.createBucket({index:g.bucketLayerIDs.length,layers:he,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ie,sourceID:this.source,projection:this.projection.spec})).populate(ce,w,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(he.map(Te=>Te.id))))}}let C,P,R,z;b.trim();const U={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},W=()=>{if(C)return h(C);if(this.extraShadowCaster)this.status="done",h(null,{buckets:Ke(v).filter(j=>!j.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:w.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(P&&R&&z){const j=new $B(P),Y=new eN(R,z);for(const Z in v){const $=v[Z];$ instanceof y1?(KP($.layers,this.zoom,w.brightness,l),Ote($,P,j.positions,R,Y.iconPositions,this.showCollisionBoxes,l,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):$.hasPattern&&($ instanceof o3||$ instanceof N2||$ instanceof E1)&&(KP($.layers,this.zoom,w.brightness,l),$.addFeatures(w,this.tileID.canonical,Y.patternPositions,l,this.tileTransform,this.brightness))}this.status="done",h(null,{buckets:Ke(v).filter(Z=>!Z.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:j.image,lineAtlas:b,imageAtlas:Y,brightness:w.brightness})}};if(!this.extraShadowCaster){const j=At(w.glyphDependencies,$=>Object.keys($).map(Number));Object.keys(j).length?u.send("getGlyphs",{uid:this.uid,stacks:j,scope:this.scope},($,K)=>{C||(C=$,P=K,W())},void 0,!1,U):P={};const Y=Object.keys(w.iconDependencies);Y.length?u.send("getImages",{icons:Y,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},($,K)=>{C||(C=$,R=K,W())},void 0,!1,U):R={};const Z=Object.keys(w.patternDependencies);Z.length?u.send("getImages",{icons:Z,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},($,K)=>{C||(C=$,z=K,W())},void 0,!1,U):z={}}W()}}function KP(i,t,r,l){const u=new ri(t,{brightness:r});for(const h of i)h.recalculate(u,l)}class qB{constructor(t){this.entries={},this.scheduler=t}request(t,r,l,u){const h=this.entries[t]=this.entries[t]||{callbacks:[]};if(h.result){const[p,g]=h.result;return this.scheduler?this.scheduler.add(()=>{u(p,g)},r):u(p,g),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=l((p,g)=>{h.result=[p,g];for(const v of h.callbacks)this.scheduler?this.scheduler.add(()=>{v(p,g)},r):v(p,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(p=>p!==u),h.callbacks.length||(h.cancel(),delete this.entries[t]))}}}function XB(i,t,r){const l=JSON.stringify(i.request);return i.data&&(this.deduped.entries[l]={result:[null,i.data]}),this.deduped.request(l,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},u=>{const h=vt(i.request,(p,g,v,b)=>{p?u(p):g&&u(null,{vectorTile:r?void 0:new vP(new H2(g)),rawData:g,cacheControl:v,expires:b})});return()=>{h.cancel(),u()}},t)}class YB extends Bn{constructor(t,r,l,u){if(super(),this.id=t,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Ue(this,ft(r,["url","scheme","tileSize","promoteId"])),this._options=Ue({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new qB}load(t){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,l=this.map._worldview;this._tileJSONRequest=ZP(this._options,this.map._requestManager,r,l,(u,h)=>{this._tileJSONRequest=null,this._loaded=!0,u?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),l&&l.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${l}`),this.fire(new vn(u))):h&&(Ue(this,h),h.bounds&&(this.tileBounds=new b3(h.bounds,this.minzoom,this.maxzoom)),ln(h.tiles,this.map._requestManager._customAccessToken),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),t&&t(u)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Xo(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ue({},this._options)}loadTile(t,r){const l=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(l,Se.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(u.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=r:t.request=t.actor.send("reloadTile",u,h.bind(this));else if(t.actor=this._tileWorkers[l]=this._tileWorkers[l]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",u,h.bind(this),void 0,!0);else{const p=XB.call({deduped:this._deduped},u,(g,v)=>{g||!v?h.call(this,g):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},t.actor&&t.actor.send("loadTile",u,h.bind(this),void 0,!0))},!0);t.request={cancel:p}}function h(p,g){return delete t.request,t.aborted?r(null):p&&p.status!==404?r(p):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),Ye(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class C1 extends Bn{constructor(t,r,l,u){super(),this.id=t,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Ue({type:"raster"},r),Ue(this,ft(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"})),this._tileJSONRequest=ZP(this._options,this.map._requestManager,null,null,(r,l)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new vn(r)):l&&(Ue(this,l),l.bounds&&(this.tileBounds=new b3(l.bounds,this.minzoom,this.maxzoom)),ln(l.tiles),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Xo(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Ue({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,r){const l=Cn.devicePixelRatio>=2,u=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),l,this.tileSize);t.request=Qt(this.map._requestManager.transformRequest(u,Se.Tile),(h,p,g,v)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):h?(t.state="errored",r(h)):p?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:v}),t.setTexture(p,this.map.painter),t.state="loaded",Ye(this.dispatcher),void r(null)):r(null)))}static loadTileData(t,r,l){t.setTexture(r,l)}static unloadTileData(t,r){t.texture&&r.saveTileTexture(t.texture)}abortTile(t,r){t.request&&(t.request.cancel(),delete t.request),r()}unloadTile(t,r){t.texture&&this.map.painter.saveTileTexture(t.texture),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let JP;function Uae(){return V3.workerClass!=null?new V3.workerClass:new m.Worker(V3.workerUrl)}const QP="mapboxgl_preloaded_worker_pool";class yv{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<yv.workerCount;)this.workers.push(new Uae);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[QP]}numActive(){return Object.keys(this.active).length}}let P1;function I1(){return P1||(P1=new yv),P1}yv.workerCount=2;let L1,e5,Xc,t5=null;function ZB(){return ne()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:e5||x.DRACO_URL}const n5=5123,a5=5126,i5={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[n5]:Uint16Array,5125:Uint32Array,[a5]:Float32Array},Wae={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[n5]:"DT_UINT16",5125:"DT_UINT32",[a5]:"DT_FLOAT32"},r5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function KB(i,t,r){const l=r.json.bufferViews.length,u=r.buffers.length;t.bufferView=l,r.json.bufferViews[l]={buffer:u,byteLength:i.byteLength},r.buffers[u]=i}const o5="KHR_draco_mesh_compression";function Vae(i,t){const r=i.extensions&&i.extensions[o5];if(!r)return;const l=new Xc.Decoder,u=t8(t,r.bufferView),h=new Xc.Mesh;if(!l.DecodeArrayToMesh(u,u.byteLength,h))throw new Error("Failed to decode Draco mesh");const p=t.json.accessors[i.indices],g=i5[p.componentType],v=p.count*g.BYTES_PER_ELEMENT,b=Xc._malloc(v);g===Uint16Array?l.GetTrianglesUInt16Array(h,v,b):l.GetTrianglesUInt32Array(h,v,b),KB(Xc.memory.buffer.slice(b,b+v),p,t),Xc._free(b);for(const w of Object.keys(r.attributes)){const A=l.GetAttributeByUniqueId(h,r.attributes[w]),C=t.json.accessors[i.attributes[w]],P=Wae[C.componentType],R=C.count*r5[C.type]*i5[C.componentType].BYTES_PER_ELEMENT,z=Xc._malloc(R);l.GetAttributeDataArrayForAllPoints(h,A,Xc[P],R,z),KB(Xc.memory.buffer.slice(z,z+R),C,t),Xc._free(z)}l.destroy(),h.destroy(),delete i.extensions[o5]}const JB=1179937895,QB=new TextDecoder("utf8");function e8(i,t){return new URL(i,t).href}async function Gae(i,t,r,l){const u=await fetch(e8(i.uri,l)),h=await u.arrayBuffer();t.buffers[r]=h}function t8(i,t){const r=i.json.bufferViews[t];return new Uint8Array(i.buffers[r.buffer],r.byteOffset||0,r.byteLength)}async function Hae(i,t,r,l){if(i.uri){const u=e8(i.uri,l),h=await fetch(u),p=await h.blob();t.images[r]=await m.createImageBitmap(p)}else if(i.bufferView!==void 0){const u=t8(t,i.bufferView),h=new m.Blob([u],{type:i.mimeType});t.images[r]=await m.createImageBitmap(h)}}async function n8(i,t=0,r){const l={json:null,images:[],buffers:[]};if(new Uint32Array(i,t,1)[0]===JB){const w=new Uint32Array(i,t);let A=2;const C=(w[A++]>>2)-3,P=w[A++]>>2;if(A++,l.json=JSON.parse(QB.decode(w.subarray(A,A+P))),A+=P,A<C){const R=w[A++];A++;const z=t+(A<<2);l.buffers[0]=i.slice(z,z+R)}}else l.json=JSON.parse(QB.decode(new Uint8Array(i,t)));const{buffers:u,images:h,meshes:p,extensionsUsed:g}=l.json;if(u){const w=[];for(let A=0;A<u.length;A++){const C=u[A];C.uri?w.push(Gae(C,l,A,r)):l.buffers[A]||(l.buffers[A]=null)}await Promise.all(w)}const v=[],b=g&&g.includes(o5);if(b&&v.push(async function(){if(!Xc){if(L1)return L1;L1=async function(w){let A,C=null;function P(){A=new Uint8Array(C.buffer)}function R(){throw new Error("Unexpected Draco error.")}const z={a:{a:R,d:function(ct,Pt,Ft){return A.copyWithin(ct,Pt,Pt+Ft)},c:function(ct){const Pt=A.length,Ft=Math.max(ct>>>0,Math.ceil(1.2*Pt)),xt=Math.ceil((Ft-Pt)/65536);try{return C.grow(xt),P(),!0}catch{return!1}},b:R}},U=await(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(w,z):WebAssembly.instantiate(await(await w).arrayBuffer(),z)),{Rb:W,Qb:j,P:Y,T:Z,X:$,Ja:K,La:ie,Qa:ce,Va:he,Wa:ye,eb:Te,jb:we,f:Ie,e:xe,yb:We,zb:qe,Ab:et,Bb:Ne,Db:Ve,Gb:it}=U.instance.exports;C=xe;const gt=(()=>{let ct=0,Pt=0,Ft=0,xt=0;return Mt=>{Ft&&(W(xt),W(ct),Pt+=Ft,Ft=ct=0),ct||(Pt+=128,ct=j(Pt));const en=Mt.length+7&-8;let on=ct;en>=Pt&&(Ft=en,on=xt=j(en));for(let rn=0;rn<Mt.length;rn++)A[on+rn]=Mt[rn];return on}})();return P(),Ie(),{memory:xe,_free:W,_malloc:j,Mesh:class{constructor(){this.ptr=Y()}destroy(){Z(this.ptr)}},Decoder:class{constructor(){this.ptr=K()}destroy(){we(this.ptr)}DecodeArrayToMesh(ct,Pt,Ft){const xt=gt(ct),Mt=ie(this.ptr,xt,Pt,Ft.ptr);return!!$(Mt)}GetAttributeByUniqueId(ct,Pt){return{ptr:ce(this.ptr,ct.ptr,Pt)}}GetTrianglesUInt16Array(ct,Pt,Ft){he(this.ptr,ct.ptr,Pt,Ft)}GetTrianglesUInt32Array(ct,Pt,Ft){ye(this.ptr,ct.ptr,Pt,Ft)}GetAttributeDataArrayForAllPoints(ct,Pt,Ft,xt,Mt){Te(this.ptr,ct.ptr,Pt.ptr,Ft,xt,Mt)}},DT_INT8:We(),DT_UINT8:qe(),DT_INT16:et(),DT_UINT16:Ne(),DT_UINT32:Ve(),DT_FLOAT32:it()}}(fetch(ZB())),Xc=await L1,L1=void 0}}()),h)for(let w=0;w<h.length;w++)v.push(Hae(h[w],l,w,r));if(v.length&&await Promise.all(v),b&&p)for(const{primitives:w}of p)for(const A of w)Vae(A,l);return l}async function a8(i){const t=await fetch(i);return n8(await t.arrayBuffer(),0,i)}class i8{constructor(t,r,l){if(this.triangleCount=r.length/3,this.min=new V(0,0),this.max=new V(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||l===0)return;const u=t.map(w=>w.x),h=t.map(w=>w.y);this.min=new V(Math.min(...u),Math.min(...h)),this.max=new V(Math.max(...u),Math.max(...h));const p=this.max.sub(this.min);p.x=Math.max(p.x,1),p.y=Math.max(p.y,1);const g=Math.max(p.x,p.y)/l;this.cellsX=Math.max(1,Math.ceil(p.x/g)),this.cellsY=Math.max(1,Math.ceil(p.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let w=0;w<this.triangleCount;w++){const A=t[r[3*w+0]].sub(this.min),C=t[r[3*w+1]].sub(this.min),P=t[r[3*w+2]].sub(this.min),R=Pf(Math.floor(Math.min(A.x,C.x,P.x)),this.xScale,this.cellsX),z=Pf(Math.floor(Math.max(A.x,C.x,P.x)),this.xScale,this.cellsX),U=Pf(Math.floor(Math.min(A.y,C.y,P.y)),this.yScale,this.cellsY),W=Pf(Math.floor(Math.max(A.y,C.y,P.y)),this.yScale,this.cellsY),j=new V(0,0),Y=new V(0,0),Z=new V(0,0),$=new V(0,0);for(let K=U;K<=W;++K){j.y=Y.y=K*g,Z.y=$.y=(K+1)*g;for(let ie=R;ie<=z;++ie)j.x=Z.x=ie*g,Y.x=$.x=(ie+1)*g,(cP(A,C,P,j,Y,$)||cP(A,C,P,j,$,Z))&&v.push({cellIdx:K*this.cellsX+ie,triIdx:w})}}if(v.length===0)return;v.sort((w,A)=>w.cellIdx-A.cellIdx||w.triIdx-A.triIdx);let b=0;for(;b<v.length;){const w=v[b].cellIdx,A={start:this.payload.length,len:0};for(;b<v.length&&v[b].cellIdx===w;)++A.len,this.payload.push(v[b++].triIdx);this.cells[w]=A}}query(t,r,l){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>r.x||t.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const u=Pf(t.x-this.min.x,this.xScale,this.cellsX),h=Pf(r.x-this.min.x,this.xScale,this.cellsX),p=Pf(t.y-this.min.y,this.yScale,this.cellsY),g=Pf(r.y-this.min.y,this.yScale,this.cellsY);for(let v=p;v<=g;v++)for(let b=u;b<=h;b++){const w=this.cells[v*this.cellsX+b];if(w)for(let A=0;A<w.len;A++){const C=this.payload[w.start+A],P=Math.floor(C/8),R=1<<C%8;if(!(this.lookup[P]&R)&&(this.lookup[P]|=R,l.push(C),l.length===this.triangleCount))return}}}}function Pf(i,t,r){return Math.max(0,Math.min(r-1,Math.floor(i*t)))}function Tm(i,t){const r=i.json.bufferViews[t.bufferView];return new i5[t.componentType](i.buffers[r.buffer],(t.byteOffset||0)+(r.byteOffset||0),t.count*r5[t.type])}function jae(i,t,r){const l=i.indices,u=i.attributes,h={};h.indexArray=new Nn;const p=t.json.accessors[l],g=p.count/3;h.indexArray.reserve(g);const v=Tm(t,p);for(let C=0;C<g;C++)h.indexArray.emplaceBack(v[3*C],v[3*C+1],v[3*C+2]);h.indexArray._trim(),h.vertexArray=new Dn;const b=t.json.accessors[u.POSITION];h.vertexArray.reserve(b.count);const w=Tm(t,b);for(let C=0;C<b.count;C++)h.vertexArray.emplaceBack(w[3*C],w[3*C+1],w[3*C+2]);if(h.vertexArray._trim(),h.aabb=new hi(b.min,b.max),h.centroid=function(C,P){const R=[0,0,0],z=C.length;if(z>0){for(let U=0;U<z;U++){const W=3*C[U];R[0]+=P[W],R[1]+=P[W+1],R[2]+=P[W+2]}R[0]/=z,R[1]/=z,R[2]/=z}return R}(v,w),u.COLOR_0!==void 0){const C=t.json.accessors[u.COLOR_0],P=r5[C.type];if(C.componentType===a5){h.colorArray=P===3?new Dn:new dn,h.colorArray.reserve(C.count);const R=Tm(t,C);if(P===3)for(let z=0;z<C.count;z++)h.colorArray.emplaceBack(R[3*z],R[3*z+1],R[3*z+2]);else for(let z=0;z<C.count;z++)h.colorArray.emplaceBack(R[4*z],R[4*z+1],R[4*z+2],R[4*z+3]);h.colorArray._trim()}else if(C.componentType===n5&&P===4){h.colorArray=new dn,h.colorArray.resize(C.count);const R=Tm(t,C),z=1/65535,U=h.colorArray.float32;for(let W=0;W<4*R.length;++W)U[W]=R[W]*z}else ve(`glTF color buffer parsing for accessor ${JSON.stringify(C)} is not supported`)}if(u.NORMAL!==void 0){h.normalArray=new Dn;const C=t.json.accessors[u.NORMAL];h.normalArray.reserve(C.count);const P=Tm(t,C);for(let R=0;R<C.count;R++)h.normalArray.emplaceBack(P[3*R],P[3*R+1],P[3*R+2]);h.normalArray._trim()}if(u.TEXCOORD_0!==void 0&&r.length>0){h.texcoordArray=new K_;const C=t.json.accessors[u.TEXCOORD_0];h.texcoordArray.reserve(C.count);const P=Tm(t,C);for(let R=0;R<C.count;R++)h.texcoordArray.emplaceBack(P[2*R],P[2*R+1]);h.texcoordArray._trim()}const A=i.material;return h.material=function(C,P){const{emissiveFactor:R=[0,0,0],alphaMode:z="OPAQUE",alphaCutoff:U=.5,normalTexture:W,occlusionTexture:j,emissiveTexture:Y,doubleSided:Z}=C,{baseColorFactor:$=[1,1,1,1],metallicFactor:K=1,roughnessFactor:ie=1,baseColorTexture:ce,metallicRoughnessTexture:he}=C.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new xn(...$),metallicFactor:K,roughnessFactor:ie,baseColorTexture:ce?P[ce.index]:void 0,metallicRoughnessTexture:he?P[he.index]:void 0},doubleSided:Z,emissiveFactor:R,alphaMode:z,alphaCutoff:U,normalTexture:W?P[W.index]:void 0,occlusionTexture:j?P[j.index]:void 0,emissionTexture:Y?P[Y.index]:void 0,defined:C.defined===void 0}}(A!==void 0?t.json.materials[A]:{defined:!1},r),u._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Tm(t,t.json.accessors[u._FEATURE_RGBA4444]).buffer)),h}function r8(i,t,r){const{matrix:l,rotation:u,translation:h,scale:p,mesh:g,extras:v,children:b}=i,w={};if(w.matrix=l||at.fromRotationTranslationScale([],u||[0,0,0,1],h||[0,0,0],p||[1,1,1]),g!==void 0){w.meshes=r[g];const A=w.anchor=[0,0];for(const C of w.meshes){const{min:P,max:R}=C.aabb;A[0]+=P[0]+R[0],A[1]+=P[1]+R[1]}A[0]=Math.floor(A[0]/w.meshes.length/2),A[1]=Math.floor(A[1]/w.meshes.length/2)}if(v&&(v.id&&(w.id=v.id),v.lights&&(w.lights=function(A){if(!A.length)return[];const C=function(W){const j=atob(W),Y=new Uint8Array(j.length);for(let Z=0;Z<j.length;Z++)Y[Z]=j.codePointAt(Z);return Y}(A),P=[],R=C.length/24,z=new Uint16Array(C.buffer),U=new Float32Array(C.buffer);for(let W=0;W<R;W++){const j=z[2*W*6]/30,Y=z[2*W*6+1]/30,Z=z[2*W*6+10]/100,$=U[6*W+1],K=U[6*W+2],ie=U[6*W+3],ce=U[6*W+4],he=ie-$,ye=ce-K,Te=Math.hypot(he,ye);P.push({pos:[$+.5*he,K+.5*ye,Y],normal:[ye/Te,-he/Te,0],width:Te,height:j,depth:Z,points:[$,K,ie,ce]})}return P}(v.lights))),b){const A=[];for(const C of b)A.push(r8(t.json.nodes[C],t,r));w.children=A}return w}function $ae(i){if(i.vertices.length===0||i.indices.length===0)return null;const[t,r]=[i.vertices[0].clone(),i.vertices[0].clone()];for(let p=1;p<i.vertices.length;++p){const g=i.vertices[p];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),r.x=Math.max(r.x,g.x),r.y=Math.max(r.y,g.y)}const l=Math.ceil(Math.max(r.x-t.x,r.y-t.y)/256),u=Math.max(8,l),h=new i8(i.vertices,i.indices,u);return{vertices:i.vertices,indices:i.indices,grid:h,min:t,max:r}}function qae(i){if(!i.extras||!i.extras.ground)return null;const t=i.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const r=t[0];if(!r||!Array.isArray(r)||r.length===0)return null;const l=[];for(const p of r){if(!Array.isArray(p)||p.length!==2)continue;const g=p[0],v=p[1];typeof g=="number"&&typeof v=="number"&&l.push(new V(g,v))}if(l.length<3)return null;l.length>1&&l[l.length-1].equals(l[0])&&l.pop();let u=0;for(let p=0;p<l.length;p++){const g=l[p],v=l[(p+1)%l.length],b=l[(p+2)%l.length];u+=(g.x-v.x)*(b.y-v.y)-(b.x-v.x)*(g.y-v.y)}u>0&&l.reverse();const h=F2(l.flatMap(p=>[p.x,p.y]),[]);return h.length===0?null:{vertices:l,indices:h}}function Xae(i){const t=[],r=[];let l=0;for(const u of i){l=t.length;const h=u.vertexArray.float32,p=u.indexArray.uint16;for(let g=0;g<u.vertexArray.length;g++)t.push(new V(h[3*g+0],h[3*g+1]));for(let g=0;g<3*u.indexArray.length;g++)r.push(p[g]+l)}if(r.length%3!=0)return null;for(let u=0;u<r.length;u+=3){const h=t[r[u+0]],p=t[r[u+1]],g=t[r[u+2]];(h.x-p.x)*(g.y-p.y)-(g.x-p.x)*(h.y-p.y)>0&&([r[u+1],r[u+2]]=[r[u+2],r[u+1]])}return{vertices:t,indices:r}}function s5(i){const t=function(v,b){const w=[],A=m.WebGL2RenderingContext;if(v.json.textures)for(const C of v.json.textures){const P={magFilter:A.LINEAR,minFilter:A.NEAREST,wrapS:A.REPEAT,wrapT:A.REPEAT};C.sampler!==void 0&&Object.assign(P,v.json.samplers[C.sampler]),w.push({image:b[C.source],sampler:P,uploaded:!1})}return w}(i,i.images),r=function(v,b){const w=[];for(const A of v.json.meshes){const C=[];for(const P of A.primitives)C.push(jae(P,v,b));w.push(C)}return w}(i,t),{scenes:l,scene:u,nodes:h}=i.json,p=l?l[u||0].nodes:h,g=[];for(const v of p)g.push(r8(h[v],i,r));return function(v,b,w){const A={},C=new Set;for(let P=0;P<v.length;P++){const R=w[b[P]];if(!R.extras)continue;const z=R.extras["mapbox:footprint:version"],U=R.extras["mapbox:footprint:id"];(z||U)&&C.add(P),z==="1.0.0"&&U&&(A[U]=P)}for(let P=0;P<v.length;P++){if(C.has(P))continue;const R=v[P],z=w[b[P]];if(!z.extras)continue;let U=null;R.id in A&&(U=Xae(v[A[R.id]].meshes)),U||(U=qae(z)),U&&(R.footprint=$ae(U))}if(C.size>0){const P=Array.from(C.values()).sort((R,z)=>R-z);for(let R=P.length-1;R>=0;R--)v.splice(P[R],1)}}(g,p,i.json.nodes),g}function Yae(i){i.heightmap=new Float32Array(4096),i.heightmap.fill(-1);const t=i.vertexArray.float32,r=i.aabb.min[0]-1,l=i.aabb.min[1]-1,u=Sm/(i.aabb.max[0]-r+2),h=Sm/(i.aabb.max[1]-l+2);for(let p=0;p<t.length;p+=3){const g=t[p+2],v=(t[p+0]-r)*u|0,b=(t[p+1]-l)*h|0;g>i.heightmap[b*Sm+v]&&(i.heightmap[b*Sm+v]=g)}}function Zae(i,t){const r={};r.indexArray=new Nn,r.indexArray.reserve(4*i.length),r.vertexArray=new Dn,r.vertexArray.reserve(10*i.length),r.colorArray=new dn,r.vertexArray.reserve(10*i.length);let l=0;for(const p of i){const g=Math.min(10,Math.max(4,1.3*p.height))*t,v=[-p.normal[1],p.normal[0],0],b=Math.min(.29,.1*p.width/p.depth),w=p.width-2*p.depth*t*(b+.01),A=ke.scaleAndAdd([],p.pos,v,w/2),C=ke.scaleAndAdd([],p.pos,v,-w/2),P=[A[0],A[1],A[2]+p.height],R=[C[0],C[1],C[2]+p.height],z=ke.scaleAndAdd([],p.normal,v,b);ke.scale(z,z,g);const U=ke.scaleAndAdd([],p.normal,v,-b);ke.scale(U,U,g),ke.add(z,A,z),ke.add(U,C,U),A[2]+=.1,C[2]+=.1,r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(C[0],C[1],C[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(R[0],R[1],R[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(C[0],C[1],C[2]),r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]);const W=w/g/2;r.colorArray.emplaceBack(-W-b,-1,W,.8),r.colorArray.emplaceBack(W+b,-1,W,.8),r.colorArray.emplaceBack(-W,0,W,1.3),r.colorArray.emplaceBack(W,0,W,1.3),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.indexArray.emplaceBack(6+l,4+l,8+l),r.indexArray.emplaceBack(7+l,9+l,5+l),r.indexArray.emplaceBack(0+l,1+l,2+l),r.indexArray.emplaceBack(1+l,3+l,2+l),l+=10}const u={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=xn.white,u.pbrMetallicRoughness=h,r.material=u,r.aabb=new hi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}un(i8,"TriangleGridIndex");const l5={vector:YB,raster:C1,"raster-dem":class extends C1{constructor(i,t,r,l){super(i,t,r,l),this.type="raster-dem",this.maxzoom=22,this._options=Ue({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(i,t){var h,p;const r=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);i.request=Qt(this.map._requestManager.transformRequest(r,Se.Tile),(function(g,v,b,w){if(delete i.request,i.aborted)i.state="unloaded",t(null);else if(g)i.state="errored",t(g);else if(v){this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:b,expires:w});const C=m.ImageBitmap&&v instanceof m.ImageBitmap&&(JP==null&&(JP=m.OffscreenCanvas&&new m.OffscreenCanvas(1,1).getContext("2d")&&typeof m.createImageBitmap=="function"),JP),P=1-(v.width-((A=v.width)<=1?1:Math.pow(2,Math.floor(Math.log(A)/Math.LN2))))/2;P<1||i.neighboringTiles||(i.neighboringTiles=this._getNeighboringTiles(i.tileID));const R=C?v:Cn.getImageData(v,P),z={uid:i.uid,coord:i.tileID,source:this.id,scope:this.scope,rawImageData:R,encoding:this.encoding,padding:P,convertToFloat:l};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",z,u.bind(this),void 0,!0))}var A}).bind(this));const l=(p=(h=this.map)==null?void 0:h.painter)==null?void 0:p.terrainUseFloatDEM();function u(g,v){g&&(i.state="errored",t(g)),v&&(i.dem=v,i.dem.onDeserialize(),i.needsHillshadePrepare=!0,i.needsDEMTextureUpload=!0,i.state="loaded",t(null))}}_getNeighboringTiles(i){const t=i.canonical,r=Math.pow(2,t.z),l=(t.x-1+r)%r,u=t.x===0?i.wrap-1:i.wrap,h=(t.x+1+r)%r,p=t.x+1===r?i.wrap+1:i.wrap,g={};return g[new Ca(i.overscaledZ,u,t.z,l,t.y).key]={backfilled:!1},g[new Ca(i.overscaledZ,p,t.z,h,t.y).key]={backfilled:!1},t.y>0&&(g[new Ca(i.overscaledZ,u,t.z,l,t.y-1).key]={backfilled:!1},g[new Ca(i.overscaledZ,i.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new Ca(i.overscaledZ,p,t.z,h,t.y-1).key]={backfilled:!1}),t.y+1<r&&(g[new Ca(i.overscaledZ,u,t.z,l,t.y+1).key]={backfilled:!1},g[new Ca(i.overscaledZ,i.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new Ca(i.overscaledZ,p,t.z,h,t.y+1).key]={backfilled:!1}),g}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.hillshadeFBO&&(i.hillshadeFBO.destroy(),delete i.hillshadeFBO),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded"}},geojson:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(l),this._data=t.data,this._options=Ue({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const u=ht/this.tileSize;this.workerOptions=Ue({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*u,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*u,extent:ht,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:ht,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*u,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(i){this.map=i,this.setData(this._data)}setData(i){return this._data=i,this._updateWorkerData(),this}getClusterExpansionZoom(i,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id,scope:this.scope},t),this}getClusterChildren(i,t){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id,scope:this.scope},t),this}getClusterLeaves(i,t,r,l){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:i,limit:t,offset:r},l),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Ht("dataloading",{dataType:"source"})),this._loaded=!1;const i=Ue({},this.workerOptions);i.scope=this.scope;const t=this._data;typeof t=="string"?(i.request=this.map._requestManager.transformRequest(Cn.resolveURL(t),Se.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,i,(r,l)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new vn(r));else{const u={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&l&&l.resourceTiming&&l.resourceTiming[this.id]&&(u.resourceTiming=l.resourceTiming[this.id]),this.fire(new Ht("data",u)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(i,t){const r=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const l={type:this.type,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};i.request=this.actor.send(r,l,(u,h)=>(delete i.request,i.unloadVectorData(),i.aborted?t(null):u?t(u):(i.loadVectorData(h,this.map.painter,r==="reloadTile"),t(null))),void 0,r==="loadTile")}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Ue({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Xu{constructor(i,t,r,l){super(i,t,r,l),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const i=this.options;this.urls=[];for(const t of i.urls)this.urls.push(this.map._requestManager.transformRequest(t,Se.Source).url);(function(t,r){const l=m.document.createElement("video");l.muted=!0,l.onloadstart=function(){r(null,l)};for(let u=0;u<t.length;u++){const h=m.document.createElement("source");dt(t[u])||(l.crossOrigin="Anonymous"),h.src=t[u],l.appendChild(h)}})(this.urls,(t,r)=>{this._loaded=!0,t?this.fire(new vn(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const t=this.video.seekable;i<t.start(0)||i>t.end(0)?this.fire(new vn(new sn(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,t=i.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new yr(i,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(i)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Xu,model:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="model",this.models=[],this._loaded=!1,this._options=t}async load(){for(const i in this._options.models){const t=this._options.models[i],r=await a8(this.map._requestManager.transformRequest(t.uri,Se.Model).url).catch(h=>{this.fire(new vn(new Error(`Could not load model ${i} from ${t.uri}: ${h.message}`)))});if(!r)continue;const l=s5(r),u=new QN(i,t.position,t.orientation,l);u.computeBoundsAndApplyParent(),this.models.push(u)}this._loaded=!0,this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(i){this.map=i,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(i,t){}serialize(){return{type:"model"}}},"batched-model":class extends Bn{constructor(i,t,r,l){super(),this.type="batched-model",this.id=i,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(l)}onAdd(i){this.map=i,this.load()}load(i){this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=ZP(this._options,this.map._requestManager,t,r,(l,u)=>{this._tileJSONRequest=null,this._loaded=!0,l?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),r&&r.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new vn(l))):u&&(Ue(this,u),u.bounds&&(this.tileBounds=new b3(u.bounds,this.minzoom,this.maxzoom)),ln(u.tiles,this.map._requestManager._customAccessToken),this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))),i&&i(l)})}hasTransition(){return!1}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loaded(){return this._loaded}loadTile(i,t){const r=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),l={request:this.map._requestManager.transformRequest(r,Se.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:i.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(i.actor&&i.state!=="expired")if(i.state==="loading")i.reloadCallback=t;else{if(i.buckets){const h=Object.values(i.buckets);for(const p of h)p.dirty=!0;return void(i.state="loaded")}i.request=i.actor.send("reloadTile",l,u.bind(this))}else i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",l,u.bind(this),void 0,!0);function u(h,p){return i.aborted?t(null):h&&h.status!==404?t(h):(p&&(p.resourceTiming&&(i.resourceTiming=p.resourceTiming),this.map._refreshExpiredTiles&&i.setExpiryData(p),i.buckets={...i.buckets,...p.buckets}),i.state="loaded",void t(null))}}serialize(){return Ue({},this._options)}},canvas:class extends Xu{constructor(i,t,r,l){super(i,t,r,l),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(u=>!Array.isArray(u)||u.length!==2||u.some(h=>typeof h!="number"))||this.fire(new vn(new sn(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new vn(new sn(`sources.${i}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new vn(new sn(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof m.HTMLCanvasElement||this.fire(new vn(new sn(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new vn(new sn(`sources.${i}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof m.HTMLCanvasElement?this.options.canvas:m.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new vn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!i&&!this._playing||this.texture instanceof s3||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new yr(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}},custom:class extends Bn{constructor(i,t,r,l){super(),this.id=i,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=t,this.setEventedParent(l),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new vn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new vn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new b3(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Ue(this,ft(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return ft(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Ht("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(i){this._map=i,this._loaded=!1,this.fire(new Ht("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(i),this.load()}onRemove(i){this._implementation.onRemove&&this._implementation.onRemove(i)}hasTile(i){if(this._implementation.hasTile){const{x:t,y:r,z:l}=i.canonical;return this._implementation.hasTile({x:t,y:r,z:l})}return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,t){const{x:r,y:l,z:u}=i.tileID.canonical,h=new m.AbortController;i.request=Promise.resolve(this._implementation.loadTile({x:r,y:l,z:u},{signal:h.signal})).then((function(p){return delete i.request,i.aborted?(i.state="unloaded",t(null)):p===void 0?(i.state="errored",t(null)):p===null?(this.loadTileData(i,{width:this.tileSize,height:this.tileSize,data:null}),i.state="loaded",t(null)):function(g){return g instanceof m.ImageData||g instanceof m.HTMLCanvasElement||g instanceof m.ImageBitmap||g instanceof m.HTMLImageElement}(p)?(this.loadTileData(i,p),i.state="loaded",void t(null)):(i.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(p=>{p.code!==20&&(i.state="errored",t(p))}),i.request.cancel=()=>h.abort()}loadTileData(i,t){C1.loadTileData(i,t,this._map.painter)}unloadTileData(i){C1.unloadTileData(i,this._map.painter)}unloadTile(i,t){if(this.unloadTileData(i),this._implementation.unloadTile){const{x:r,y:l,z:u}=i.tileID.canonical;this._implementation.unloadTile({x:r,y:l,z:u})}t()}abortTile(i,t){i.request&&i.request.cancel&&(i.request.cancel(),delete i.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(i=>({x:i.canonical.x,y:i.canonical.y,z:i.canonical.z}))}_clearTiles(){const i=Xo(this.id,this.scope);this._map.style.clearSource(i)}_update(){this.fire(new Ht("data",{dataType:"source",sourceDataType:"content"}))}}},c5=function(i,t,r,l){const u=new l5[t.type](i,t,r,l);if(u.id!==i)throw new Error(`Expected Source id to be ${i} instead of ${u.id}`);return pt(["load","abort","unload","serialize","prepare"],u),u};function Kae(i,t){const r=at.identity([]);return at.scale(r,r,[.5*i.width,.5*-i.height,1]),at.translate(r,r,[1,-1,0]),at.multiply(r,r,i.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(r)}function Jae(i,t,r,l,u,h,p,g=!1){const v=i.tilesIn(l,p,g);v.sort(o8);const b=[];for(const A of v)b.push({wrappedTileID:A.tile.tileID.wrapped().key,queryResults:A.tile.queryRenderedFeatures(t,r,i._state,A,u,h,Kae(i.transform,A.tile.tileID),g)});const w=function(A){const C={},P={};for(const R of A){const z=R.queryResults,U=R.wrappedTileID,W=P[U]=P[U]||{};for(const j in z){const Y=z[j],Z=W[j]=W[j]||{},$=C[j]=C[j]||[];for(const K of Y)Z[K.featureIndex]||(Z[K.featureIndex]=!0,$.push(K))}}return C}(b);for(const A in w)w[A].forEach(C=>{const P=C.feature,R=P.layer;R&&R.type!=="background"&&R.type!=="sky"&&R.type!=="slot"&&(P.source=R.source,R["source-layer"]&&(P.sourceLayer=R["source-layer"]),P.state=P.id!==void 0?i.getFeatureState(R["source-layer"],P.id):{})});return w}function Qae(i,t){const r=i.getRenderableIds().map(h=>i.getTileByID(h)),l=[],u={};for(let h=0;h<r.length;h++){const p=r[h],g=p.tileID.canonical.key;u[g]||(u[g]=!0,p.querySourceFeatures(l,t))}return l}function o8(i,t){const r=i.tileID,l=t.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}class eie{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const r=this.style._mergedLayers[t];if(r.type==="fill-extrusion")this.layers.push(r);else if(r.type==="model"){const l=this.style.getLayerSource(r);l&&l.type==="batched-model"&&this.layers.push(r)}}}updateZOffset(t,r){this.currentBuildingBuckets=[];for(let u=0;u<this.layers.length;++u){const h=this.layers[u],p=this.style.getLayerSourceCache(h);let g=1;h.type==="fill-extrusion"&&(g=h.paint.get("fill-extrusion-opacity")>0?h.paint.get("fill-extrusion-vertical-scale"):0);let v=p?p.getTile(r):null;if(!v&&p&&r.canonical.z>p.getSource().minzoom){let b=r.scaledTo(Math.min(p.getSource().maxzoom,r.overscaledZ-1));for(;b.overscaledZ>=p.getSource().minzoom&&(v=p.getTile(b),!v&&b.overscaledZ!==0);)b=b.scaledTo(b.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:v?v.getBucket(h):null,tileID:v?v.tileID:r,verticalScale:g})}t.hasAnyZOffset=!1;let l=!1;for(let u=0;u<t.symbolInstances.length;u++){const h=t.symbolInstances.get(u),p=h.zOffset,g=this._getHeightAtTileOffset(r,h.tileAnchorX,h.tileAnchorY);h.zOffset=g!==-1?g:p,l||p===h.zOffset||(l=!0),t.hasAnyZOffset||h.zOffset===0||(t.hasAnyZOffset=!0)}l&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,r,l,u){let h=r,p=l;if(t.canonical.z!==u.canonical.z){const g=u.canonical,v=1/(1<<t.canonical.z-g.z);h=(r+t.canonical.x*ht)*v-g.x*ht|0,p=(l+t.canonical.y*ht)*v-g.y*ht|0}return{tileX:h,tileY:p}}_getHeightAtTileOffset(t,r,l){let u;for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="fill-extrusion")continue;const{bucket:p,tileID:g,verticalScale:v}=this.currentBuildingBuckets[h];if(!p)continue;const{tileX:b,tileY:w}=this._mapCoordToOverlappingTile(t,r,l,g),A=p.getHeightAtTileCoord(b,w);if(A&&A.height!==void 0){if(!A.hidden)return A.height*v;u=A.height}}for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="model")continue;const{bucket:p,tileID:g}=this.currentBuildingBuckets[h];if(!p)continue;const{tileX:v,tileY:b}=this._mapCoordToOverlappingTile(t,r,l,g),w=p.getHeightAtTileCoord(v,b);if(w&&!w.hidden)return w.height===void 0&&u!==void 0?Math.min(w.maxHeight,u)*w.verticalScale:(w.height||0)*w.verticalScale}return-1}}var s8=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tie(i,t){const r={};for(const l in i)l!=="ref"&&(r[l]=i[l]);return s8.forEach(l=>{l in t&&(r[l]=t[l])}),r}function l8(i){i=i.slice();const t=Object.create(null);for(let r=0;r<i.length;r++)t[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=tie(i[r],t[i[r].ref]));return i}const Fa={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData"};function c8(i,t,r){r.push({command:Fa.addSource,args:[i,t[i]]})}function u8(i,t,r){t.push({command:Fa.removeSource,args:[i]}),r[i]=!0}function nie(i,t,r,l){u8(i,r,l),c8(i,t,r)}function aie(i,t,r){let l;for(l in i[r])if(i[r].hasOwnProperty(l)&&l!=="data"&&!Q(i[r][l],t[r][l]))return!1;for(l in t[r])if(t[r].hasOwnProperty(l)&&l!=="data"&&!Q(i[r][l],t[r][l]))return!1;return!0}function x3(i,t,r,l,u,h){let p;for(p in t=t||{},i=i||{})i.hasOwnProperty(p)&&(Q(i[p],t[p])||r.push({command:h,args:[l,p,t[p],u]}));for(p in t)t.hasOwnProperty(p)&&!i.hasOwnProperty(p)&&(Q(i[p],t[p])||r.push({command:h,args:[l,p,t[p],u]}))}function w3(i){return i.id}function S3(i,t){return i[t.id]=t,i}class iie{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=ae(t,0,1);let r=1,l=this._distances[r];const u=t*this.paddedLength+this.padding;for(;l<u&&r<this._distances.length;)l=this._distances[++r];const h=r-1,p=this._distances[h],g=l-p,v=g>0?(u-p)/g:0;return this.points[h].mult(1-v).add(this.points[r].mult(v))}}class d8{constructor(t,r,l){const u=this.boxCells=[],h=this.circleCells=[];this.xCellCount=Math.ceil(t/l),this.yCellCount=Math.ceil(r/l);for(let p=0;p<this.xCellCount*this.yCellCount;p++)u.push([]),h.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,l,u,h){this._forEachCell(r,l,u,h,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(h)}insertCircle(t,r,l,u){this._forEachCell(r-u,l-u,r+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(l),this.circles.push(u)}_insertBoxCell(t,r,l,u,h,p){this.boxCells[h].push(p)}_insertCircleCell(t,r,l,u,h,p){this.circleCells[h].push(p)}_query(t,r,l,u,h,p){if(l<0||t>this.width||u<0||r>this.height)return!h&&[];const g=[];if(t<=0&&r<=0&&this.width<=l&&this.height<=u){if(h)return!0;for(let v=0;v<this.boxKeys.length;v++)g.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(let v=0;v<this.circleKeys.length;v++){const b=this.circles[3*v],w=this.circles[3*v+1],A=this.circles[3*v+2];g.push({key:this.circleKeys[v],x1:b-A,y1:w-A,x2:b+A,y2:w+A})}return p?g.filter(p):g}return this._forEachCell(t,r,l,u,this._queryCell,g,{hitTest:h,seenUids:{box:{},circle:{}}},p),h?g.length>0:g}_queryCircle(t,r,l,u,h){const p=t-l,g=t+l,v=r-l,b=r+l;if(g<0||p>this.width||b<0||v>this.height)return!u&&[];const w=[];return this._forEachCell(p,v,g,b,this._queryCellCircle,w,{hitTest:u,circle:{x:t,y:r,radius:l},seenUids:{box:{},circle:{}}},h),u?w.length>0:w}query(t,r,l,u,h){return this._query(t,r,l,u,!1,h)}hitTest(t,r,l,u,h){return this._query(t,r,l,u,!0,h)}hitTestCircle(t,r,l,u){return this._queryCircle(t,r,l,!0,u)}_queryCell(t,r,l,u,h,p,g,v){const b=g.seenUids,w=this.boxCells[h];if(w!==null){const C=this.bboxes;for(const P of w)if(!b.box[P]){b.box[P]=!0;const R=4*P;if(t<=C[R+2]&&r<=C[R+3]&&l>=C[R+0]&&u>=C[R+1]&&(!v||v(this.boxKeys[P]))){if(g.hitTest)return p.push(!0),!0;p.push({key:this.boxKeys[P],x1:C[R],y1:C[R+1],x2:C[R+2],y2:C[R+3]})}}}const A=this.circleCells[h];if(A!==null){const C=this.circles;for(const P of A)if(!b.circle[P]){b.circle[P]=!0;const R=3*P;if(this._circleAndRectCollide(C[R],C[R+1],C[R+2],t,r,l,u)&&(!v||v(this.circleKeys[P]))){if(g.hitTest)return p.push(!0),!0;{const z=C[R],U=C[R+1],W=C[R+2];p.push({key:this.circleKeys[P],x1:z-W,y1:U-W,x2:z+W,y2:U+W})}}}}}_queryCellCircle(t,r,l,u,h,p,g,v){const b=g.circle,w=g.seenUids,A=this.boxCells[h];if(A!==null){const P=this.bboxes;for(const R of A)if(!w.box[R]){w.box[R]=!0;const z=4*R;if(this._circleAndRectCollide(b.x,b.y,b.radius,P[z+0],P[z+1],P[z+2],P[z+3])&&(!v||v(this.boxKeys[R])))return p.push(!0),!0}}const C=this.circleCells[h];if(C!==null){const P=this.circles;for(const R of C)if(!w.circle[R]){w.circle[R]=!0;const z=3*R;if(this._circlesCollide(P[z],P[z+1],P[z+2],b.x,b.y,b.radius)&&(!v||v(this.circleKeys[R])))return p.push(!0),!0}}}_forEachCell(t,r,l,u,h,p,g,v){const b=this._convertToXCellCoord(t),w=this._convertToYCellCoord(r),A=this._convertToXCellCoord(l),C=this._convertToYCellCoord(u);for(let P=b;P<=A;P++)for(let R=w;R<=C;R++)if(h.call(this,t,r,l,u,this.xCellCount*R+P,p,g,v))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,l,u,h,p){const g=u-t,v=h-r,b=l+p;return b*b>g*g+v*v}_circleAndRectCollide(t,r,l,u,h,p,g){const v=(p-u)/2,b=Math.abs(t-(u+v));if(b>v+l)return!1;const w=(g-h)/2,A=Math.abs(r-(h+w));if(A>w+l)return!1;if(b<=v||A<=w)return!0;const C=b-v,P=A-w;return C*C+P*P<=l*l}}const Yu=100;class rie{constructor(t,r,l=new d8(t.width+200,t.height+200,25),u=new d8(t.width+200,t.height+200,25)){this.transform=t,this.grid=l,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Yu,this.screenBottomBoundary=t.height+Yu,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=r}placeCollisionBox(t,r,l,u,h,p,g,v){let b=l.projectedAnchorX,w=l.projectedAnchorY,A=l.projectedAnchorZ;const C=l.elevation,P=l.tileID,R=t.getProjection();if(C&&P){const[K,ie,ce]=R.upVector(P.canonical,l.tileAnchorX,l.tileAnchorY),he=R.upVectorScale(P.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;b+=K*C*he,w+=ie*C*he,A+=ce*C*he}const z=this.projectAndGetPerspectiveRatio(g,b,w,A,l.tileID,R.name==="globe"||!!C||this.transform.pitch>0,R),U=p*z.perspectiveRatio,W=(l.x1*r+u.x-l.padding)*U+z.point.x,j=(l.y1*r+u.y-l.padding)*U+z.point.y,Y=(l.x2*r+u.x+l.padding)*U+z.point.x,Z=(l.y2*r+u.y+l.padding)*U+z.point.y,$=z.perspectiveRatio<=.55||z.occluded;return!this.isInsideGrid(W,j,Y,Z)||!h&&this.grid.hitTest(W,j,Y,Z,v)||$?{box:[],offscreen:!1,occluded:z.occluded}:{box:[W,j,Y,Z],offscreen:this.isOffscreen(W,j,Y,Z),occluded:!1}}placeCollisionCircles(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z){const U=[],W=this.transform.elevation,j=t.getProjection(),Y=W?W.getAtTileOffsetFunc(z,this.transform.center.lat,this.transform.worldSize,j):null,Z=new V(l.tileAnchorX,l.tileAnchorY);let{x:$,y:K,z:ie}=j.projectTilePoint(Z.x,Z.y,z.canonical);if(Y){const[et,Ne,Ve]=Y(Z);$+=et,K+=Ne,ie+=Ve}const ce=j.name==="globe",he=this.projectAndGetPerspectiveRatio(g,$,K,ie,z,ce||!!W||this.transform.pitch>0,j),{perspectiveRatio:ye}=he,Te=(A?p/ye:p*ye)/io,we=qc($,K,ie,v),Ie=he.signedDistanceFromCamera>0?GN(Te,h,l.lineOffsetX*Te,l.lineOffsetY*Te,!1,we,Z,l,u,v,{},W&&!A?Y:null,A&&!!W,j,z,A):null;let xe=!1,We=!1,qe=!0;if(Ie&&!he.occluded){const et=.5*P*ye+R,Ne=new V(-100,-100),Ve=new V(this.screenRightBoundary,this.screenBottomBoundary),it=new iie,{first:gt,last:ct}=Ie,Pt=gt.path.length;let Ft=[];for(let en=Pt-1;en>=1;en--)Ft.push(gt.path[en]);for(let en=1;en<ct.path.length;en++)Ft.push(ct.path[en]);const xt=2.5*et;b&&(Ft=Ft.map(([en,on,rn],cn)=>(Y&&!ce&&(rn=Y(cn<Pt-1?gt.tilePath[Pt-1-cn]:ct.tilePath[cn-Pt+2])[2]),qc(en,on,rn,b))),Ft.some(en=>en[3]<=0)&&(Ft=[]));let Mt=[];if(Ft.length>0){let en=1/0,on=-1/0,rn=1/0,cn=-1/0;for(const gn of Ft)en=Math.min(en,gn[0]),rn=Math.min(rn,gn[1]),on=Math.max(on,gn[0]),cn=Math.max(cn,gn[1]);on>=Ne.x&&en<=Ve.x&&cn>=Ne.y&&rn<=Ve.y&&(Mt=[Ft.map(gn=>new V(gn[0],gn[1]))],(en<Ne.x||on>Ve.x||rn<Ne.y||cn>Ve.y)&&(Mt=fN(Mt,Ne.x,Ne.y,Ve.x,Ve.y)))}for(const en of Mt){it.reset(en,.25*et);let on=0;on=it.length<=.5*et?1:Math.ceil(it.paddedLength/xt)+1;for(let rn=0;rn<on;rn++){const cn=rn/Math.max(on-1,1),gn=it.lerp(cn),kn=gn.x+Yu,ea=gn.y+Yu;U.push(kn,ea,et,0);const ba=kn-et,$n=ea-et,Un=kn+et,In=ea+et;if(qe=qe&&this.isOffscreen(ba,$n,Un,In),We=We||this.isInsideGrid(ba,$n,Un,In),!r&&this.grid.hitTestCircle(kn,ea,et,C)&&(xe=!0,!w))return{circles:[],offscreen:!1,collisionDetected:xe,occluded:!1}}}}return{circles:!w&&xe||!We?[]:U,offscreen:qe,collisionDetected:xe,occluded:he.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,u=1/0,h=-1/0,p=-1/0;for(const w of t){const A=new V(w.x+Yu,w.y+Yu);l=Math.min(l,A.x),u=Math.min(u,A.y),h=Math.max(h,A.x),p=Math.max(p,A.y),r.push(A)}const g=this.grid.query(l,u,h,p).concat(this.ignoredGrid.query(l,u,h,p)),v={},b={};for(const w of g){const A=w.key;v[A.bucketInstanceId]===void 0&&(v[A.bucketInstanceId]={}),v[A.bucketInstanceId][A.featureIndex]||mF(r,[new V(w.x1,w.y1),new V(w.x2,w.y1),new V(w.x2,w.y2),new V(w.x1,w.y2)])&&(v[A.bucketInstanceId][A.featureIndex]=!0,b[A.bucketInstanceId]===void 0&&(b[A.bucketInstanceId]=[]),b[A.bucketInstanceId].push(A.featureIndex))}return b}insertCollisionBox(t,r,l,u,h){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:l,featureIndex:u,collisionGroupID:h},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,l,u,h){const p=r?this.ignoredGrid:this.grid,g={bucketInstanceId:l,featureIndex:u,collisionGroupID:h};for(let v=0;v<t.length;v+=4)p.insertCircle(g,t[v],t[v+1],t[v+2])}projectAndGetPerspectiveRatio(t,r,l,u,h,p,g){const v=[r,l,u,1];let b=!1;u||this.transform.pitch>0?(Ga.transformMat4(v,v,t),this.fogState&&h&&g.name!=="globe"&&(b=function(C,P,R,z,U,W){const j=W.calculateFogTileMatrix(U),Y=[P,R,z];return ke.transformMat4(Y,Y,j),_3(C,ke.length(Y),W.pitch,W._fov)}(this.fogState,r,l,u,h.toUnwrapped(),this.transform)>.9)):XN(v,v,t);const w=v[3];return{point:new V((v[0]/w+1)/2*this.transform.width+Yu,(-v[1]/w+1)/2*this.transform.height+Yu),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/w*.5,1.5),signedDistanceFromCamera:w,occluded:p&&v[2]>w||b}}isOffscreen(t,r,l,u){return l<Yu||t>=this.screenRightBoundary||u<Yu||r>this.screenBottomBoundary}isInsideGrid(t,r,l,u){return l>=0&&t<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=at.identity([]);return at.translate(t,t,[-100,-100,0]),t}}function u5(i,t,r){const l=t.createTileMatrix(i,i.worldSize,r.toUnwrapped());return at.multiply(new Float32Array(16),i.projMatrix,l)}function oie(i,t,r){if(t.projection.name===r.projection.name)return i.projMatrix;const l=r.clone();return l.setProjection(t.projection),u5(l,t.getProjection(),i)}function d5(i,t,r){return t.name===r.projection.name?i.projMatrix:u5(r,t,i)}class h8{constructor(t,r,l,u){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class R1{constructor(t,r,l,u,h,p=!1){this.text=new h8(t?t.text:null,r,l,h),this.icon=new h8(t?t.icon:null,r,u,h),this.clipped=p}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class h5{constructor(t,r,l,u=!1){this.text=t,this.icon=r,this.skipFade=l,this.clipped=u}}class sie{constructor(){this.invProjMatrix=at.create(),this.viewportMatrix=at.create(),this.circles=[]}}class lie{constructor(t,r,l,u,h){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=h}}class cie{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[t]}}function f8(i,t,r,l,u){const{horizontalAlign:h,verticalAlign:p}=$2(i),g=-(h-.5)*t,v=-(p-.5)*r,b=PP(i,l);return new V(g+b[0]*u,v+b[1]*u)}function f5(i,t,r,l,u){const h=new V(i,t);return r&&h._rotate(l?u:-u),h}class uie{constructor(t,r,l,u,h,p){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new rie(this.transform,h),this.buildingIndex=p,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new cie(l),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,l,u){const h=l.getBucket(r),p=l.latestFeatureIndex;if(!h||!p||r.fqid!==h.layerIds[0])return;const g=h.layers[0].layout,v=l.collisionBoxArray,b=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),w=l.tileSize/ht,A=l.tileID.toUnwrapped();this.transform.setProjection(h.projection);const C=(P=l.tileID,R=h.getProjection(),z=this.transform,R.name===this.projection?z.calculateProjMatrix(P.toUnwrapped()):u5(z,R,P));var P,R,z;const U=g.get("text-pitch-alignment")==="map",W=g.get("text-rotation-alignment")==="map";r.compileFilter();const j=r.dynamicFilter(),Y=r.dynamicFilterNeedsFeature(),Z=this.transform.calculatePixelsToTileUnitsMatrix(l),$=UN(C,l.tileID.canonical,U,W,this.transform,h.getProjection(),Z);let K=null;if(U){const he=WN(C,l.tileID.canonical,U,W,this.transform,h.getProjection(),Z);K=at.multiply([],this.transform.labelPlaneMatrix,he)}let ie=null;j&&l.latestFeatureIndex&&(ie={unwrappedTileID:A,dynamicFilter:j,dynamicFilterNeedsFeature:Y,featureIndex:l.latestFeatureIndex}),this.retainedQueryData[h.bucketInstanceId]=new lie(h.bucketInstanceId,p,h.sourceLayerIndex,h.index,l.tileID);const ce={bucket:h,layout:g,posMatrix:C,textLabelPlaneMatrix:$,labelToScreenMatrix:K,clippingData:ie,scale:b,textPixelRatio:w,holdingForFade:l.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:Hu(h.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Hu(h.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(h.sourceID)};if(u)for(const he of h.sortKeyRanges){const{sortKey:ye,symbolInstanceStart:Te,symbolInstanceEnd:we}=he;t.push({sortKey:ye,symbolInstanceStart:Te,symbolInstanceEnd:we,parameters:ce})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:h.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j){const{textOffset0:Y,textOffset1:Z,crossTileID:$}=C,K=[Y,Z],ie=f8(t,l,u,K,h),ce=this.collisionIndex.placeCollisionBox(R,h,r,f5(ie.x,ie.y,p,g,this.transform.angle),A,v,b,w.predicate);if(U){const he=R.getSymbolInstanceIconSize(j,this.transform.zoom,C.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(R,he,U,f5(ie.x,ie.y,p,g,this.transform.angle),A,v,b,w.predicate).box.length===0)return}if(ce.box.length>0){let he;return this.prevPlacement&&this.prevPlacement.variableOffsets[$]&&this.prevPlacement.placements[$]&&this.prevPlacement.placements[$].text&&(he=this.prevPlacement.variableOffsets[$].anchor),this.variableOffsets[$]={textOffset:K,width:l,height:u,anchor:t,textScale:h,prevAnchor:he},this.markUsedJustification(R,t,C,z),R.allowVerticalPlacement&&(this.markUsedOrientation(R,z,C),this.placedOrientations[$]=z),{shift:ie,placedGlyphBoxes:ce}}}placeLayerBucketPart(t,r,l,u){const{bucket:h,layout:p,posMatrix:g,textLabelPlaneMatrix:v,labelToScreenMatrix:b,clippingData:w,textPixelRatio:A,holdingForFade:C,collisionBoxArray:P,partiallyEvaluatedTextSize:R,partiallyEvaluatedIconSize:z,collisionGroup:U}=t.parameters,W=p.get("text-optional"),j=p.get("icon-optional"),Y=p.get("text-allow-overlap"),Z=p.get("icon-allow-overlap"),$=p.get("text-rotation-alignment")==="map",K=p.get("text-pitch-alignment")==="map",ie=p.get("symbol-z-order")==="viewport-y",ce=p.get("symbol-z-elevate");this.transform.setProjection(h.projection);let he=Y&&(Z||!h.hasIconData()||j),ye=Z&&(Y||!h.hasTextData()||W);!h.collisionArrays&&P&&h.deserializeCollisionBoxes(P),l&&u&&h.updateCollisionDebugBuffers(this.transform.zoom,P);const Te=(we,Ie,xe)=>{const{crossTileID:We,numVerticalGlyphVertices:qe}=we;if(w){const Un={zoom:this.transform.zoom,pitch:this.transform.pitch};let In=null;if(w.dynamicFilterNeedsFeature){const En=this.retainedQueryData[h.bucketInstanceId];In=w.featureIndex.loadFeature({featureIndex:we.featureIndex,bucketIndex:En.bucketIndex,sourceLayerIndex:En.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,w.dynamicFilter)(Un,In,this.retainedQueryData[h.bucketInstanceId].tileID.canonical,new V(we.tileAnchorX,we.tileAnchorY),this.transform.calculateDistanceTileData(w.unwrappedTileID)))return this.placements[We]=new h5(!1,!1,!1,!0),void r.add(We)}if(r.has(We))return;if(C)return void(this.placements[We]=new h5(!1,!1,!1));let et=!1,Ne=!1,Ve=!0,it=!1,gt=!1,ct=null,Pt={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},xt=null,Mt=null,en=null,on=0,rn=0,cn=0;xe.textFeatureIndex?on=xe.textFeatureIndex:we.useRuntimeCollisionCircles&&(on=we.featureIndex),xe.verticalTextFeatureIndex&&(rn=xe.verticalTextFeatureIndex);const gn=Un=>{Un.tileID=this.retainedQueryData[h.bucketInstanceId].tileID;const In=this.transform.elevation;Un.elevation=we.zOffset+(In?In.getAtTileOffset(Un.tileID,Un.tileAnchorX,Un.tileAnchorY):0)},kn=xe.textBox;if(kn){gn(kn);const Un=En=>{let ha=bi.horizontal;if(h.allowVerticalPlacement&&!En&&this.prevPlacement){const Ma=this.prevPlacement.placedOrientations[We];Ma&&(this.placedOrientations[We]=Ma,ha=Ma,this.markUsedOrientation(h,ha,we))}return ha},In=(En,ha)=>{if(h.allowVerticalPlacement&&qe>0&&xe.verticalTextBox){for(const Ma of h.writingModes)if(Ma===bi.vertical?(Pt=ha(),Ft=Pt):Pt=En(),Pt&&Pt.box&&Pt.box.length)break}else Pt=En()};if(p.get("text-variable-anchor")){let En=p.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[We]){const Qn=this.prevPlacement.variableOffsets[We];En.indexOf(Qn.anchor)>0&&(En=En.filter(Xa=>Xa!==Qn.anchor),En.unshift(Qn.anchor))}const ha=(Qn,Xa,xi)=>{const oi=h.getSymbolInstanceTextSize(R,we,this.transform.zoom,Ie),ei=(Qn.x2-Qn.x1)*oi+2*Qn.padding,rr=(Qn.y2-Qn.y1)*oi+2*Qn.padding,wi=we.hasIconTextFit&&!Z?Xa:null;wi&&gn(wi);let Oi={box:[],offscreen:!1,occluded:!1};const Ya=Y?2*En.length:En.length;for(let fs=0;fs<Ya;++fs){const Ku=this.attemptAnchorPlacement(En[fs%En.length],Qn,ei,rr,oi,$,K,A,g,U,fs>=En.length,we,Ie,h,xi,wi,R,z);if(Ku&&(Oi=Ku.placedGlyphBoxes,Oi&&Oi.box&&Oi.box.length)){et=!0,ct=Ku.shift;break}}return Oi};In(()=>ha(kn,xe.iconBox,bi.horizontal),()=>{const Qn=xe.verticalTextBox;return Qn&&gn(Qn),h.allowVerticalPlacement&&!(Pt&&Pt.box&&Pt.box.length)&&qe>0&&Qn?ha(Qn,xe.verticalIconBox,bi.vertical):{box:null,offscreen:null,occluded:null}}),Pt&&(et=Pt.box,Ve=Pt.offscreen,it=Pt.occluded);const Ma=Un(!(!Pt||!Pt.box));if(!et&&this.prevPlacement){const Qn=this.prevPlacement.variableOffsets[We];Qn&&(this.variableOffsets[We]=Qn,this.markUsedJustification(h,Qn.anchor,we,Ma))}}else{const En=(ha,Ma)=>{const Qn=h.getSymbolInstanceTextSize(R,we,this.transform.zoom,Ie),Xa=this.collisionIndex.placeCollisionBox(h,Qn,ha,new V(0,0),Y,A,g,U.predicate);return Xa&&Xa.box&&Xa.box.length&&(this.markUsedOrientation(h,Ma,we),this.placedOrientations[We]=Ma),Xa};In(()=>En(kn,bi.horizontal),()=>{const ha=xe.verticalTextBox;return h.allowVerticalPlacement&&qe>0&&ha?(gn(ha),En(ha,bi.vertical)):{box:null,offscreen:null,occluded:null}}),Un(!!(Pt&&Pt.box&&Pt.box.length))}}if(xt=Pt,et=xt&&xt.box&&xt.box.length>0,Ve=xt&&xt.offscreen,it=xt&&xt.occluded,we.useRuntimeCollisionCircles){const Un=h.text.placedSymbolArray.get(we.centerJustifiedTextSymbolIndex>=0?we.centerJustifiedTextSymbolIndex:we.verticalPlacedTextSymbolIndex),In=l1(h.textSizeData,R,Un),En=p.get("text-padding");Mt=this.collisionIndex.placeCollisionCircles(h,Y,Un,h.lineVertexArray,h.glyphOffsetArray,In,g,v,b,l,K,U.predicate,we.collisionCircleDiameter*In/io,En,this.retainedQueryData[h.bucketInstanceId].tileID),et=Y||Mt.circles.length>0&&!Mt.collisionDetected,Ve=Ve&&Mt.offscreen,it=Mt.occluded}if(xe.iconFeatureIndex&&(cn=xe.iconFeatureIndex),xe.iconBox){const Un=In=>{gn(In);const En=we.hasIconTextFit&&ct?f5(ct.x,ct.y,$,K,this.transform.angle):new V(0,0),ha=h.getSymbolInstanceIconSize(z,this.transform.zoom,we.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(h,ha,In,En,Z,A,g,U.predicate)};Ft&&Ft.box&&Ft.box.length&&xe.verticalIconBox?(en=Un(xe.verticalIconBox),Ne=en.box.length>0):(en=Un(xe.iconBox),Ne=en.box.length>0),Ve=Ve&&en.offscreen,gt=en.occluded}const ea=W||we.numHorizontalGlyphVertices===0&&qe===0,ba=j||we.numIconVertices===0;if(ea||ba?ba?ea||(Ne=Ne&&et):et=Ne&&et:Ne=et=Ne&&et,et&&xt&&xt.box&&this.collisionIndex.insertCollisionBox(xt.box,p.get("text-ignore-placement"),h.bucketInstanceId,Ft&&Ft.box&&rn?rn:on,U.ID),Ne&&en&&this.collisionIndex.insertCollisionBox(en.box,p.get("icon-ignore-placement"),h.bucketInstanceId,cn,U.ID),Mt&&(et&&this.collisionIndex.insertCollisionCircles(Mt.circles,p.get("text-ignore-placement"),h.bucketInstanceId,on,U.ID),l)){const Un=h.bucketInstanceId;let In=this.collisionCircleArrays[Un];In===void 0&&(In=this.collisionCircleArrays[Un]=new sie);for(let En=0;En<Mt.circles.length;En+=4)In.circles.push(Mt.circles[En+0]),In.circles.push(Mt.circles[En+1]),In.circles.push(Mt.circles[En+2]),In.circles.push(Mt.collisionDetected?1:0)}const $n=h.projection.name!=="globe";he=he&&($n||!it),ye=ye&&($n||!gt),this.placements[We]=new h5(et||he,Ne||ye,Ve||h.justReloaded),r.add(We)};if(ce&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,this.retainedQueryData[h.bucketInstanceId].tileID),h.updateZOffset()),ie){const we=h.getSortedSymbolIndexes(this.transform.angle);for(let Ie=we.length-1;Ie>=0;--Ie){const xe=we[Ie];Te(h.symbolInstances.get(xe),xe,h.collisionArrays[xe])}h.hasAnyZOffset&&ve(`${h.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(h.hasAnyZOffset){const we=h.getSortedIndexesByZOffset();for(let Ie=0;Ie<we.length;++Ie){const xe=we[Ie];Te(h.symbolInstances.get(xe),xe,h.collisionArrays[xe])}}else for(let we=t.symbolInstanceStart;we<t.symbolInstanceEnd;we++)Te(h.symbolInstances.get(we),we,h.collisionArrays[we]);if(l&&h.bucketInstanceId in this.collisionCircleArrays){const we=this.collisionCircleArrays[h.bucketInstanceId];at.invert(we.invProjMatrix,g),we.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(t,r,l,u){const{leftJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:p,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:v,crossTileID:b}=l,w=IP(r),A=u===bi.vertical?v:w==="left"?h:w==="center"?p:w==="right"?g:-1;h>=0&&(t.text.placedSymbolArray.get(h).crossTileID=A>=0&&h!==A?0:b),p>=0&&(t.text.placedSymbolArray.get(p).crossTileID=A>=0&&p!==A?0:b),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=A>=0&&g!==A?0:b),v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=A>=0&&v!==A?0:b)}markUsedOrientation(t,r,l){const u=r===bi.horizontal||r===bi.horizontalOnly?r:0,h=r===bi.vertical?r:0,{leftJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:b}=l,w=t.text.placedSymbolArray;p>=0&&(w.get(p).placedOrientation=u),g>=0&&(w.get(g).placedOrientation=u),v>=0&&(w.get(v).placedOrientation=u),b>=0&&(w.get(b).placedOrientation=h)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(t):1,h=r?r.opacities:{},p=r?r.variableOffsets:{},g=r?r.placedOrientations:{};for(const v in this.placements){const b=this.placements[v],w=h[v];w?(this.opacities[v]=new R1(w,u,b.text,b.icon,null,b.clipped),l=l||b.text!==w.text.placed||b.icon!==w.icon.placed):(this.opacities[v]=new R1(null,u,b.text,b.icon,b.skipFade,b.clipped),l=l||b.text||b.icon)}for(const v in h){const b=h[v];if(!this.opacities[v]){const w=new R1(b,u,!1,!1);w.isHidden()||(this.opacities[v]=w,l=l||b.text.placed||b.icon.placed)}}for(const v in p)this.variableOffsets[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.variableOffsets[v]=p[v]);for(const v in g)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=g[v]);l?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const l=new Set;for(const u of r){const h=u.getBucket(t);h&&u.latestFeatureIndex&&t.fqid===h.layerIds[0]&&(this.updateBucketOpacities(h,l,u.collisionBoxArray),h.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,u.tileID),h.updateZOffset()))}}updateBucketOpacities(t,r,l){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const u=t.layers[0].layout,h=!!t.layers[0].dynamicFilter(),p=new R1(null,0,!1,!1,!0),g=u.get("text-allow-overlap"),v=u.get("icon-allow-overlap"),b=u.get("text-variable-anchor"),w=u.get("text-rotation-alignment")==="map",A=u.get("text-pitch-alignment")==="map",C=new R1(null,0,g&&(v||!t.hasIconData()||u.get("icon-optional")),v&&(g||!t.hasTextData()||u.get("text-optional")),!0);!t.collisionArrays&&l&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(l);const P=(z,U,W)=>{for(let j=0;j<U/4;j++)z.opacityVertexArray.emplaceBack(W)};let R=0;for(let z=0;z<t.symbolInstances.length;z++){const U=t.symbolInstances.get(z),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:j,crossTileID:Y,numIconVertices:Z}=U,$=r.has(Y);let K=this.opacities[Y];$?K=p:K||(K=C,this.opacities[Y]=K),r.add(Y);const ie=W>0||j>0,ce=Z>0,he=this.placedOrientations[Y],ye=he===bi.vertical,Te=he===bi.horizontal||he===bi.horizontalOnly;if(!ie&&!ce||K.isHidden()||R++,ie){const we=p8(K.text);P(t.text,W,ye?E3:we),P(t.text,j,Te?E3:we);const Ie=K.text.isHidden(),{leftJustifiedTextSymbolIndex:xe,centerJustifiedTextSymbolIndex:We,rightJustifiedTextSymbolIndex:qe,verticalPlacedTextSymbolIndex:et}=U,Ne=t.text.placedSymbolArray,Ve=Ie||ye?1:0;xe>=0&&(Ne.get(xe).hidden=Ve),We>=0&&(Ne.get(We).hidden=Ve),qe>=0&&(Ne.get(qe).hidden=Ve),et>=0&&(Ne.get(et).hidden=Ie||Te?1:0);const it=this.variableOffsets[Y];it&&this.markUsedJustification(t,it.anchor,U,he);const gt=this.placedOrientations[Y];gt&&(this.markUsedJustification(t,"left",U,gt),this.markUsedOrientation(t,gt,U))}if(ce){const we=p8(K.icon),{placedIconSymbolIndex:Ie,verticalPlacedIconSymbolIndex:xe}=U,We=t.icon.placedSymbolArray,qe=K.icon.isHidden()?1:0;Ie>=0&&(P(t.icon,Z,ye?E3:we),We.get(Ie).hidden=qe),xe>=0&&(P(t.icon,U.numVerticalIconVertices,Te?E3:we),We.get(xe).hidden=qe)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const we=t.collisionArrays[z];if(we){let Ie=new V(0,0),xe=!0;if(we.textBox||we.verticalTextBox){if(b){const qe=this.variableOffsets[Y];qe?(Ie=f8(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textScale),w&&Ie._rotate(A?this.transform.angle:-this.transform.angle)):xe=!1}h&&(xe=!K.clipped),we.textBox&&A3(t.textCollisionBox.collisionVertexArray,K.text.placed,!xe||ye,Ie.x,Ie.y),we.verticalTextBox&&A3(t.textCollisionBox.collisionVertexArray,K.text.placed,!xe||Te,Ie.x,Ie.y)}const We=xe&&!!(!Te&&we.verticalIconBox);we.iconBox&&A3(t.iconCollisionBox.collisionVertexArray,K.icon.placed,We,U.hasIconTextFit?Ie.x:0,U.hasIconTextFit?Ie.y:0),we.verticalIconBox&&A3(t.iconCollisionBox.collisionVertexArray,K.icon.placed,!We,U.hasIconTextFit?Ie.x:0,U.hasIconTextFit?Ie.y:0)}}}if(t.fullyClipped=R===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const z=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=z.invProjMatrix,t.placementViewportMatrix=z.viewportMatrix,t.collisionCircleArray=z.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>t}setStale(){this.stale=!0}}function A3(i,t,r,l,u){i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0),i.emplaceBack(t?1:0,r?1:0,l||0,u||0)}const die=Math.pow(2,25),hie=Math.pow(2,24),fie=Math.pow(2,17),pie=Math.pow(2,16),mie=Math.pow(2,9),gie=Math.pow(2,8),yie=Math.pow(2,1);function p8(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;const t=i.placed?1:0,r=Math.floor(127*i.opacity);return r*die+t*hie+r*fie+t*pie+r*mie+t*gie+r*yie+t}const E3=0;class vie{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,r,l,u,h){const p=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(p,u,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,h())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,p.sort((g,v)=>g.sortKey-v.sortKey));this._currentPartIndex<p.length;){const g=p[this._currentPartIndex];if(r.placeLayerBucketPart(g,this._seenCrossTileIDs,l,g.symbolInstanceStart===0),this._currentPartIndex++,h())return!0}return!1}}class _ie{constructor(t,r,l,u,h,p,g,v,b){this.placement=new uie(t,h,p,g,v,b),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=l,this._showCollisionBoxes=u,this._done=!1}isDone(){return this._done}continuePlacement(t,r,l,u){const h=Cn.now(),p=()=>{const g=Cn.now()-h;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=r[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=v)&&(!g.maxzoom||g.maxzoom>v)){const b=g,w=b.layout.get("symbol-z-elevate");if(this._inProgressLayer||(this._inProgressLayer=new vie(b)),this._inProgressLayer.continuePlacement(w?u[g.source]:l[g.source],this.placement,this._showCollisionBoxes,g,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const m8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class M3{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,l]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=l>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const h=m8[15&l];if(!h)throw new Error("Unrecognized array type.");const[p]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new M3(g,p,h,t)}constructor(t,r=64,l=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const h=m8.indexOf(this.ArrayType),p=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${l}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+p+g+v),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=r,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return p5(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,l,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:p,nodeSize:g}=this,v=[0,h.length-1,0],b=[];for(;v.length;){const w=v.pop()||0,A=v.pop()||0,C=v.pop()||0;if(A-C<=g){for(let U=C;U<=A;U++){const W=p[2*U],j=p[2*U+1];W>=t&&W<=l&&j>=r&&j<=u&&b.push(h[U])}continue}const P=C+A>>1,R=p[2*P],z=p[2*P+1];R>=t&&R<=l&&z>=r&&z<=u&&b.push(h[P]),(w===0?t<=R:r<=z)&&(v.push(C),v.push(P-1),v.push(1-w)),(w===0?l>=R:u>=z)&&(v.push(P+1),v.push(A),v.push(1-w))}return b}within(t,r,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:p}=this,g=[0,u.length-1,0],v=[],b=l*l;for(;g.length;){const w=g.pop()||0,A=g.pop()||0,C=g.pop()||0;if(A-C<=p){for(let U=C;U<=A;U++)y8(h[2*U],h[2*U+1],t,r)<=b&&v.push(u[U]);continue}const P=C+A>>1,R=h[2*P],z=h[2*P+1];y8(R,z,t,r)<=b&&v.push(u[P]),(w===0?t-l<=R:r-l<=z)&&(g.push(C),g.push(P-1),g.push(1-w)),(w===0?t+l>=R:r+l>=z)&&(g.push(P+1),g.push(A),g.push(1-w))}return v}}function p5(i,t,r,l,u,h){if(u-l<=r)return;const p=l+u>>1;g8(i,t,p,l,u,h),p5(i,t,r,l,p-1,1-h),p5(i,t,r,p+1,u,1-h)}function g8(i,t,r,l,u,h){for(;u>l;){if(u-l>600){const b=u-l+1,w=r-l+1,A=Math.log(b),C=.5*Math.exp(2*A/3),P=.5*Math.sqrt(A*C*(b-C)/b)*(w-b/2<0?-1:1);g8(i,t,r,Math.max(l,Math.floor(r-w*C/b+P)),Math.min(u,Math.floor(r+(b-w)*C/b+P)),h)}const p=t[2*r+h];let g=l,v=u;for(k1(i,t,l,r),t[2*u+h]>p&&k1(i,t,l,u);g<v;){for(k1(i,t,g,v),g++,v--;t[2*g+h]<p;)g++;for(;t[2*v+h]>p;)v--}t[2*l+h]===p?k1(i,t,l,v):(v++,k1(i,t,v,u)),v<=r&&(l=v+1),r<=v&&(u=v-1)}}function k1(i,t,r,l){m5(i,r,l),m5(t,2*r,2*l),m5(t,2*r+1,2*l+1)}function m5(i,t,r){const l=i[t];i[t]=i[r],i[r]=l}function y8(i,t,r,l){const u=i-r,h=t-l;return u*u+h*h}const g5=512/ht/2;class bie{constructor(t,r,l){this.tileID=t,this.bucketInstanceId=l,this.index=new M3(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const u=t.canonical.x*ht,h=t.canonical.y*ht;for(let p=0;p<r.length;p++){const{key:g,crossTileID:v,tileAnchorX:b,tileAnchorY:w}=r.get(p),A=Math.floor((u+b)*g5),C=Math.floor((h+w)*g5);this.index.add(A,C),this.keys.push(g),this.crossTileIDs.push(v)}this.index.finish()}findMatches(t,r,l){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),h=g5/Math.pow(2,r.canonical.z-this.tileID.canonical.z),p=r.canonical.x*ht,g=r.canonical.y*ht;for(let v=0;v<t.length;v++){const b=t.get(v);if(b.crossTileID)continue;const{key:w,tileAnchorX:A,tileAnchorY:C}=b,P=Math.floor((p+A)*h),R=Math.floor((g+C)*h),z=this.index.range(P-u,R-u,P+u,R+u);for(const U of z){const W=this.crossTileIDs[U];if(this.keys[U]===w&&!l.has(W)){l.add(W),b.crossTileID=W;break}}}}}class xie{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class wie{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(r!==0)for(const l in this.indexes){const u=this.indexes[l],h={};for(const p in u){const g=u[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+r),h[g.tileID.key]=g}this.indexes[l]=h}this.lng=t}addBucket(t,r,l){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let h=0;h<r.symbolInstances.length;h++)r.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const u=this.usedCrossTileIDs[t.overscaledZ];for(const h in this.indexes){const p=this.indexes[h];if(Number(h)>t.overscaledZ)for(const g in p){const v=p[g];v.tileID.isChildOf(t)&&v.findMatches(r.symbolInstances,t,u)}else{const g=p[t.scaledTo(Number(h)).key];g&&g.findMatches(r.symbolInstances,t,u)}}for(let h=0;h<r.symbolInstances.length;h++){const p=r.symbolInstances.get(h);p.crossTileID||(p.crossTileID=l.generate(),u.add(p.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new bie(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const l of r.crossTileIDs)this.usedCrossTileIDs[t].delete(l)}removeStaleBuckets(t){let r=!1;for(const l in this.indexes){const u=this.indexes[l];for(const h in u)t[u[h].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[h]),delete u[h],r=!0)}return r}}class Sie{constructor(){this.layerIndexes={},this.crossTileIDs=new xie,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,l,u){let h=this.layerIndexes[t.fqid];h===void 0&&(h=this.layerIndexes[t.fqid]=new wie);let p=!1;const g={};u.name!=="globe"&&h.handleWrapJump(l);for(const v of r){const b=v.getBucket(t);b&&t.fqid===b.layerIds[0]&&(b.bucketInstanceId||(b.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(v.tileID,b,this.crossTileIDs)&&(p=!0),g[b.bucketInstanceId]=!0)}return h.removeStaleBuckets(g)&&(p=!0),p}pruneUnusedLayers(t){const r={};t.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var v8=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,_8="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",b8=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,x8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,w8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,S8=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,A8=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const E8=[];P3(v8,E8);const T3={"_prelude_fog.vertex.glsl":x8,"_prelude_terrain.vertex.glsl":b8,"_prelude_shadow.vertex.glsl":S8,"_prelude_fog.fragment.glsl":w8,"_prelude_shadow.fragment.glsl":A8,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`},C3={};Wa("",b8),Wa(w8,x8),Wa(A8,S8);const M8=Wa(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),T8=v8,C8=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var P8={background:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wa(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wa("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#if __VERSION__ >=300
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:Wa(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Wa(`#include "_prelude_shadow.fragment.glsl"
#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Wa(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture2D(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
attribute highp vec4 a_pos_end;attribute highp float a_angular_offset_factor;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Wa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture(u_image,coord).r/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_with_emission_ground(gl_FragColor,u_emissive_strength);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;attribute vec2 a_texture_pos;
#endif
varying vec2 v_pos0;varying vec2 v_pos1;void main() {vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*u_globe_matrix*vec4(a_globe_pos,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Wa(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Wa(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Wa(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Wa(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Wa(`#include "_prelude_fog.fragment.glsl"
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,_8),skyboxGradient:Wa(`#include "_prelude_fog.fragment.glsl"
varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,_8),skyboxCapture:Wa(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Wa(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Wa(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;varying highp vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=mix(color,mat.baseColor.rgb,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Wa(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Wa(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function P3(i,t){const r=i.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let l of r)if(l=l.trim(),l[0]==="#"&&l.includes("if")&&!l.includes("endif")){l=l.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const u=l.split(" ");for(const h of u)t.includes(h)||t.push(h)}}function Wa(i,t){const r=/#include\s+"([^"]+)"/g,l=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let u=t.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);u&&(u=u.filter((b,w)=>u.indexOf(b)===w));const h={},p=[],g=[];i=i.replace(r,(b,w)=>(g.push(w),"")),t=t.replace(r,(b,w)=>(p.push(w),""));let v=[...E8];P3(i,v),P3(t,v);for(const b of[...p,...g])T3[b]||console.error(`Undefined include: ${b}`),C3[b]||(C3[b]=[],P3(T3[b],C3[b])),v=[...v,...C3[b]];return{fragmentSource:i=i.replace(l,(b,w,A,C,P)=>(h[P]=!0,w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${A} ${C} ${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize"?`
#ifdef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = u_${P};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    varying ${A} ${C} ${P};
#endif
`:w==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(l,(b,w,A,C,P)=>{const R=C==="float"?"vec2":C,z=P.match(/color/)?"color":R;return w==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${P}
attribute ${A} ${C} a_${P};
#endif
`:h[P]?w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${A} ${R} a_${P};
varying ${A} ${C} ${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize"?z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    attribute ${A} ${C} a_${P};
    varying ${A} ${C} ${P};
#endif
`:w==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${P} = a_${P};
#endif
`:void 0:w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${A} ${R} a_${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="define-instanced"?z==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${P}0;
attribute vec4 a_${P}1;
attribute vec4 a_${P}2;
attribute vec4 a_${P}3;
#else
uniform ${A} ${C} u_${P};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${A} ${R} a_${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${A} ${C} ${P} = a_${P};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = a_${P};
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${A} ${C} ${P} = u_${P};
#endif
`}),staticAttributes:u,usedDefines:v,vertexIncludes:p,fragmentIncludes:g}}class Aie{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,r,l,u,h,p,g,v){this.context=t;let b=this.boundPaintVertexBuffers.length!==u.length;for(let A=0;!b&&A<u.length;A++)this.boundPaintVertexBuffers[A]!==u[A]&&(b=!0);let w=this.boundDynamicVertexBuffers.length!==g.length;for(let A=0;!w&&A<g.length;A++)this.boundDynamicVertexBuffers[A]!==g[A]&&(w=!0);if(!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||b||w||this.boundIndexBuffer!==h||this.boundVertexOffset!==p)this.freshBind(r,l,u,h,p,g,v);else{t.bindVertexArrayOES.set(this.vao);for(const A of g)A&&(A.bind(),v&&A.instanceCount&&A.setVertexAttribDivisor(t.gl,r,v));h&&h.dynamicDraw&&h.bind()}}freshBind(t,r,l,u,h,p,g){const v=t.numAttributes,b=this.context,w=b.gl;this.vao&&this.destroy(),this.vao=b.gl.createVertexArray(),b.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=h,this.boundDynamicVertexBuffers=p,r.enableAttributes(w,t),r.bind(),r.setVertexAttribPointers(w,t,h);for(const A of l)A.enableAttributes(w,t),A.bind(),A.setVertexAttribPointers(w,t,h);for(const A of p)A&&(A.enableAttributes(w,t),A.bind(),A.setVertexAttribPointers(w,t,h),g&&A.instanceCount&&A.setVertexAttribDivisor(w,t,g));u&&u.bind(),b.currentNumAttributes=v}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Eie(i,t){const r=Math.pow(2,t.canonical.z),l=t.canonical.y;return[new ga(0,l/r).toLngLat().lat,new ga(0,(l+1)/r).toLngLat().lat]}function Mie(i,t,r,l,u,h,p){const g=i.context,v=g.gl,b=r.hillshadeFBO;if(!b)return;i.prepareDrawTile();const w=i.isTileAffectedByFog(t),A=i.getOrCreateProgram("hillshade",{overrideFog:w});g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,b.colorAttachment.get());const C=((U,W,j,Y)=>{const Z=j.paint.get("hillshade-shadow-color"),$=j.paint.get("hillshade-highlight-color"),K=j.paint.get("hillshade-accent-color"),ie=j.paint.get("hillshade-emissive-strength");let ce=be(j.paint.get("hillshade-illumination-direction"));if(j.paint.get("hillshade-illumination-anchor")==="viewport")ce-=U.transform.angle;else if(U.style&&U.style.enable3dLights()&&U.style.directionalLight){const ye=U.style.directionalLight.properties.get("direction");ce=be(de(ye.x,ye.y,ye.z)[1])}const he=!U.options.moving;return{u_matrix:Y||U.transform.calculateProjMatrix(W.tileID.toUnwrapped(),he),u_image:0,u_latrange:Eie(0,W.tileID),u_light:[j.paint.get("hillshade-exaggeration"),ce],u_shadow:Z,u_highlight:$,u_emissive_strength:ie,u_accent:K}})(i,r,l,i.terrain?t.projMatrix:null);i.uploadCommonUniforms(g,A,t.toUnwrapped());const{tileBoundsBuffer:P,tileBoundsIndexBuffer:R,tileBoundsSegments:z}=i.getTileBoundsBuffers(r);A.draw(i,v.TRIANGLES,u,h,p,la.disabled,C,l.id,P,R,z)}function I8(i,t,r){if(!t.needsDEMTextureUpload)return;const l=i.context,u=l.gl;l.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||i.getTileTexture(r.stride);const h=r.getPixels();t.demTexture?t.demTexture.update(h,{premultiply:!1}):t.demTexture=new yr(l,h,i.terrainUseFloatDEM()?u.R32F:u.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Tie(i,t,r){const l=i.context,u=l.gl;if(!t.dem)return;const h=t.dem;if(l.activeTexture.set(u.TEXTURE1),I8(i,t,h),!t.demTexture)return;t.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const p=h.dim;l.activeTexture.set(u.TEXTURE0);let g=t.hillshadeFBO;if(!g){const C=new yr(l,{width:p,height:p,data:null},u.RGBA);C.bind(u.LINEAR,u.CLAMP_TO_EDGE),g=t.hillshadeFBO=l.createFramebuffer(p,p,!0,"renderbuffer"),g.colorAttachment.set(C.texture)}l.bindFramebuffer.set(g.framebuffer),l.viewport.set([0,0,p,p]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:b,tileBoundsSegments:w}=i.getMercatorTileBoundsBuffers(),A=[];i.terrainUseFloatDEM()&&A.push("TERRAIN_DEM_FLOAT_FORMAT"),i.getOrCreateProgram("hillshadePrepare",{defines:A}).draw(i,u.TRIANGLES,zn.disabled,oa.disabled,Ea.unblended,la.disabled,((C,P)=>{const R=P.stride,z=at.create();return at.ortho(z,0,ht,-ht,0,0,1),at.translate(z,z,[0,-ht,0]),{u_matrix:z,u_image:1,u_dimension:[R,R],u_zoom:C.overscaledZ,u_unpack:P.unpackVector}})(t.tileID,h),r.id,v,b,w),t.needsHillshadePrepare=!1}const L8=i=>({u_matrix:new jn(i),u_image0:new ra(i),u_skirt_height:new Yt(i),u_ground_shadow_factor:new Xn(i)}),R8=(i,t,r)=>({u_matrix:i,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:r}),k8=(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R)=>({u_proj_matrix:Float32Array.from(i),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(l),u_merc_matrix:r,u_zoom_transition:u,u_merc_center:h,u_image0:0,u_frustum_tl:p,u_frustum_tr:g,u_frustum_br:v,u_frustum_bl:b,u_globe_pos:w,u_globe_radius:A,u_viewport:C,u_grid_matrix:R?Float32Array.from(R):new Float32Array(9),u_skirt_height:P}),vv=(i,t)=>{if(t>0&&i.terrain&&ve("Cutoff is currently disabled on terrain"),t<=0||i.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const r=i.transform,l=Math.max(Math.abs(r._zoom-(i.minCutoffZoom-1)),1),u=r.isLODDisabled(!1)?Ee(60,45,r.pitch):Ee(30,15,r.pitch),h=r._farZ-r._nearZ,p=t*r.height,g=((1-(v=u))*(.75*r.cameraToCenterDistance)+v*(r._farZ+p))*l;var v;return{shouldRenderCutoff:u<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(g-r._nearZ)/h,(g-p-r._nearZ)/h]}}};function D8(i,t){return i!=null&&t!=null&&!(!i.hasData()||!t.hasData())&&i.demTexture!=null&&t.demTexture!=null&&i.tileID.key!==t.tileID.key}const _v=new class{constructor(){this.operations={}}newMorphing(i,t,r,l,u){if(i in this.operations){const h=this.operations[i];h.to.tileID.key!==r.tileID.key&&(h.queued=r)}else this.operations[i]={startTime:l,phase:0,duration:u,from:t,to:r,queued:null}}getMorphValuesForProxy(i){if(!(i in this.operations))return null;const t=this.operations[i];return{from:t.from,to:t.to,phase:t.phase}}update(i){for(const t in this.operations){const r=this.operations[t];for(r.phase=(i-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,i)){delete this.operations[t];break}}}_nextOp(i,t){return!!i.queued&&(i.from=i.to,i.to=i.queued,i.queued=null,i.phase=0,i.startTime=t,!0)}_validOp(i){return i.from.hasData()&&i.to.hasData()}},O8={0:null,1:"TERRAIN_VERTEX_MORPHING"};function z8(i,t,r){if(t===0)return 0;const l=t<1&&r===514?.25/t:1;return 6*Math.pow(1.5,22-i)*Math.max(t,1)*l}function Cie(i,t){const r=1<<i.z;return!t&&(i.x===0||i.x===r-1)||i.y===0||i.y===r-1}const y5=i=>({u_matrix:i});function F8(i,t,r,l,u){if(u>0){const h=Cn.now(),p=(h-i.timeAdded)/u,g=t?(h-t.timeAdded)/u:-1,v=r.getSource(),b=l.coveringZoomLevel({tileSize:v.tileSize,roundZoom:v.roundZoom}),w=!t||Math.abs(t.tileID.overscaledZ-b)>Math.abs(i.tileID.overscaledZ-b),A=w&&i.refreshedUponExpiration?1:ae(w?p:1-g,0,1);return i.refreshedUponExpiration&&p>=1&&(i.refreshedUponExpiration=!1),t?{opacity:1,mix:1-A}:{opacity:A,mix:0}}return{opacity:1,mix:0}}class Pie extends $c{constructor(t){const r={type:"raster-dem",maxzoom:t.transform.maxZoom},l=new Mm(I1(),null),u=c5("mock-dem",r,l,t.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,r){t.state="loaded",r(null)}}class Iie extends $c{constructor(t){const r=c5("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Mm(I1(),null),t.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,l){if(t.freezeTileCoverage)return;this.transform=t;const u=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((h,p)=>{if(h[p.key]="",!this._tiles[p.key]){const g=new v1(p,this._source.tileSize*p.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[p.key]=g}return h},{});for(const h in this._tiles)h in u||(this.freeFBO(h),this._tiles[h].unloadVectorData(),delete this._tiles[h])}freeFBO(t){const r=this.proxyCachedFBO[t];if(r!==void 0){const l=Object.values(r);this.renderCachePool.push(...l),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class N8 extends Ca{constructor(t,r,l){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=r,this.projMatrix=l}}class Lie extends cte{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[l,u,h]=function(v){const b=new J,w=new Nn,A=131;b.reserve(17161),w.reserve(33800);const C=ht/128,P=ht+C/2,R=P+C;for(let U=-C;U<R;U+=C)for(let W=-C;W<R;W+=C){const j=W<0||W>P||U<0||U>P?24575:0,Y=ae(Math.round(W),0,ht),Z=ae(Math.round(U),0,ht);b.emplaceBack(Y+j,Z)}const z=(U,W)=>{const j=W*A+U;w.emplaceBack(j+1,j,j+A),w.emplaceBack(j+A,j+A+1,j+1)};for(let U=1;U<129;U++)for(let W=1;W<129;W++)z(W,U);return[0,129].forEach(U=>{for(let W=0;W<130;W++)z(W,U),z(U,W)}),[b,w,32768]}(),p=t.context;this.gridBuffer=p.createVertexBuffer(l,mf.members),this.gridIndexBuffer=p.createIndexBuffer(u),this.gridSegments=ja.simpleSegment(0,0,l.length,u.length),this.gridNoSkirtSegments=ja.simpleSegment(0,0,l.length,h),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Iie(r.map),this.orthoMatrix=at.create(),at.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,ht,0,ht,0,1);const g=p.gl;this._overlapStencilMode=new oa({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Pie(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,r,l){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const u=t.terrain.properties,h=t.terrain.drapeRenderMode===0,p=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Cn.now();const g=t.terrain&&t.terrain.scope,v=u.get("source"),b=h?this._mockSourceCache:t.getSourceCache(v,g);if(!b)return void ve(`Couldn't find terrain source "${v}".`);if(this.sourceCache=b,this._exaggeration=p?this.calculateExaggeration(r):u.get("exaggeration"),!r.projection.requiresDraping&&p&&this._exaggeration===0)return void this._disable();this.enabled=!0;const w=()=>{this.sourceCache.used&&ve(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const A=this.getScaledDemTileSize();this.sourceCache.update(r,A,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),r.updateElevation(!0,l),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(t){const r=this._previousCameraAltitude,l=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=l;const u=r!=null?l-r:Number.MAX_VALUE;if(Math.abs(u)<2)return this._exaggeration;const h=t.zoom,p=this._style.terrain;if(!this._previousUpdateTimestamp)return p.getExaggeration(h);let g=h-this._previousZoom;const v=this._previousUpdateTimestamp;let b=h;this._evaluationZoom!=null&&(b=this._evaluationZoom,Math.abs(h-b)>.5&&(g=.5*(h-b+g)),g*u<0&&(b+=g)),this._evaluationZoom=b;const w=p.getExaggeration(b),A=w===p.getExaggeration(Math.max(0,b-.1));if(A&&Math.abs(w-this._exaggeration)<.01)return w;let C=Math.min(.1,.00375*(this._updateTimestamp-v));return(A||w<.1||Math.abs(g)<1e-4)&&(C=Math.min(.2,4*C)),Ln(this._exaggeration,w,C)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,l=this.painter.transform;this._initializing&&(this._initializing=l._centerAltitude===0&&this.getAtPointOrZero(ga.fromLngLat(l.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const u=this.proxyCoords=r.getIds().map(v=>{const b=r.getTileByID(v).tileID;return b.projMatrix=l.calculateProjMatrix(b.toUnwrapped()),b});(function(v,b){const w=b.transform.pointCoordinate(b.transform.getCameraPoint()),A=new V(w.x,w.y);v.sort((C,P)=>{if(P.overscaledZ-C.overscaledZ)return P.overscaledZ-C.overscaledZ;const R=new V(C.canonical.x+(1<<C.canonical.z)*C.wrap,C.canonical.y),z=new V(P.canonical.x+(1<<P.canonical.z)*P.wrap,P.canonical.y),U=A.mult(1<<C.canonical.z);return U.x-=.5,U.y-=.5,U.distSqr(R)-U.distSqr(z)})})(u,this.painter);const h=this.proxyToSource||{};this.proxyToSource={},u.forEach(v=>{this.proxyToSource[v.key]={}}),this.terrainTileForTile={};const p=this._style._mergedSourceCaches;for(const v in p){const b=p[v];if(!b.used||(b!==this.sourceCache&&this.resetTileLookupCache(b.id),this._setupProxiedCoordsForOrtho(b,t[v],h),b.usedForTerrain))continue;const w=t[v];b.getSource().reparseOverscaled&&this._assignTerrainTiles(w)}this.proxiedCoords[r.id]=u.map(v=>new N8(v,v.key,this.orthoMatrix)),this._assignTerrainTiles(u),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(h),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const v of this.proxyCoords){const b=this.terrainTileForTile[v.key];if(!b)continue;const w=b.tileID.key;w in g||(this._visibleDemTiles.push(b),g[w]=w)}}_assignTerrainTiles(t){this._initializing||t.forEach(r=>{if(this.terrainTileForTile[r.key])return;const l=this._findTileCoveringTileID(r,this.sourceCache);l&&(this.terrainTileForTile[r.key]=l)})}_prepareDEMTextures(){const t=this.painter.context,r=t.gl;for(const l in this.terrainTileForTile){const u=this.terrainTileForTile[l],h=u.dem;!h||u.demTexture&&!u.needsDEMTextureUpload||(t.activeTexture.set(r.TEXTURE1),I8(this.painter,u,h))}}_prepareDemTileUniforms(t,r,l,u){if(!r||r.demTexture==null)return!1;const h=t.tileID.canonical,p=Math.pow(2,r.tileID.canonical.z-h.z),g=u||"";return l[`u_dem_tl${g}`]=[h.x*p%1,h.y*p%1],l[`u_dem_scale${g}`]=p,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const l=new qi({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new yr(t,l,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const r=this._visibleDemTiles.reduce((l,u)=>{if(!u.dem)return l;const h=u.dem.tree.minimums[0];return h>0&&t++,l+h},0);return t?r/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const l=this._getLoadedAreaMinimum(),[u,h]=(()=>{if(this.painter.terrainUseFloatDEM()){const g=new CF({width:1,height:1},new Float32Array([l]));return[r.R32F,g]}{const g=new qi({width:1,height:1},new Uint8Array(bm.pack(l,this.sourceCache.getSource().encoding)));return[r.RGBA,g]}})();this._emptyDEMTextureDirty=!1;let p=this._emptyDEMTexture;return p?p.update(h,{premultiply:!1}):p=this._emptyDEMTexture=new yr(t,h,u,{premultiply:!1}),p}setupElevationDraw(t,r,l){const u=this.painter.context,h=u.gl,p=(g=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:bm.getUnpackVector(g),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var g;p.u_exaggeration=this.exaggeration();let v=null,b=null,w=1;if(l&&l.morphing&&this._useVertexMorphing){const P=l.morphing.srcDemTile,R=l.morphing.dstDemTile;w=l.morphing.phase,P&&R&&(this._prepareDemTileUniforms(t,P,p,"_prev")&&(b=P),this._prepareDemTileUniforms(t,R,p)&&(v=R))}const A=P=>P&&P.demTexture&&this.painter.terrainUseFloatDEM()?h.LINEAR:h.NEAREST,C=P=>{p.u_dem_size=P.size[0]===1?1:P.size[0]-2};if(b&&v)u.activeTexture.set(h.TEXTURE2),v.demTexture.bind(A(v),h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE4),b.demTexture.bind(A(b),h.CLAMP_TO_EDGE),v.demTexture&&C(v.demTexture),p.u_dem_lerp=w;else{v=this.terrainTileForTile[t.tileID.key],u.activeTexture.set(h.TEXTURE2);const P=this._prepareDemTileUniforms(t,v,p)?v.demTexture:this.emptyDEMTexture;P.bind(A(v),h.CLAMP_TO_EDGE),C(P)}if(u.activeTexture.set(h.TEXTURE3),l&&l.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),this._depthFBO&&(p.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),p.u_depth_size_inv=[1,1]),l&&l.useMeterToDem&&v){const P=(1<<v.tileID.canonical.z)*$a(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;p.u_meter_to_dem=P}if(l&&l.labelPlaneMatrixInv&&(p.u_label_plane_matrix_inv=l.labelPlaneMatrixInv),r.setTerrainUniformValues(u,p),this.painter.transform.projection.name==="globe"){const P=this.globeUniformValues(this.painter.transform,t.tileID.canonical,l&&l.useDenormalizedUpVectorScale);r.setGlobeUniformValues(u,P)}}globeUniformValues(t,r,l){const u=t.projection;return{u_tile_tl_up:u.upVector(r,0,0),u_tile_tr_up:u.upVector(r,ht,0),u_tile_br_up:u.upVector(r,ht,ht),u_tile_bl_up:u.upVector(r,0,ht),u_tile_up_scale:l?A2(1):u.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,l=this.painter.context;t.length!==0&&(l.bindFramebuffer.set(null),l.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(u,h,p,g,v){if(u.transform.projection.name==="globe")(function(b,w,A,C,P){const R=b.context,z=R.gl;let U,W;const j=b.transform,Y=sF(b,R,j),Z=(Ie,xe)=>{if(W===xe)return;const We=[O8[xe],"PROJECTION_GLOBE_VIEW"];Y&&We.push("CUSTOM_ANTIALIASING");const qe=b.isTileAffectedByFog(Ie);U=b.getOrCreateProgram("globeRaster",{defines:We,overrideFog:qe}),W=xe},$=b.colorModeForRenderPass(),K=new zn(z.LEQUAL,zn.ReadWrite,b.depthRangeFor3D);_v.update(P);const ie=function(Ie){const xe=Ie.pixelsPerMeter,We=xe/$a(1,Ie.center.lat),qe=at.identity(new Float64Array(16));return at.translate(qe,qe,[Ie.point.x,Ie.point.y,0]),at.scale(qe,qe,[We,We,xe]),Float32Array.from(qe)}(j),ce=[_o(j.center.lng),Co(j.center.lat)],he=b.globeSharedBuffers,ye=[j.width*Cn.devicePixelRatio,j.height*Cn.devicePixelRatio],Te=Float32Array.from(j.globeMatrix),we={useDenormalizedUpVectorScale:!0};{const Ie=b.transform,xe=z8(Ie.zoom,w.exaggeration(),w.sourceCache._source.tileSize);W=-1;const We=z.TRIANGLES;for(const qe of C){const et=A.getTile(qe),Ne=oa.disabled,Ve=w.prevTerrainTileForTile[qe.key],it=w.terrainTileForTile[qe.key];D8(Ve,it)&&_v.newMorphing(qe.key,Ve,it,P,250),R.activeTexture.set(z.TEXTURE0),et.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const gt=_v.getMorphValuesForProxy(qe.key),ct=gt?1:0;gt&&Cs(we,{morphing:{srcDemTile:gt.from,dstDemTile:gt.to,phase:Le(gt.phase)}});const Pt=E2(qe.canonical),Ft=tee(Pt.getCenter().lat),xt=eee(qe.canonical,Pt,Ft,Ie.worldSize/Ie._pixelsPerMercatorPixel),Mt=vm(pc(qe.canonical)),en=k8(Ie.projMatrix,Te,ie,Mt,vo(Ie.zoom),ce,Ie.frustumCorners.TL,Ie.frustumCorners.TR,Ie.frustumCorners.BR,Ie.frustumCorners.BL,Ie.globeCenterInViewSpace,Ie.globeRadius,ye,xe,xt);if(Z(qe,ct),U&&(w.setupElevationDraw(et,U,we),b.uploadCommonUniforms(R,U,qe.toUnwrapped()),he)){const[on,rn,cn]=he.getGridBuffers(Ft,xe!==0);U.draw(b,We,K,Ne,$,la.backCCW,en,"globe_raster",on,rn,cn)}}}if(he&&(b.renderDefaultNorthPole||b.renderDefaultSouthPole)){const Ie=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Y&&Ie.push("CUSTOM_ANTIALIASING"),U=b.getOrCreateProgram("globeRaster",{defines:Ie});for(const xe of C){const{x:We,y:qe,z:et}=xe.canonical,Ne=qe===0,Ve=qe===(1<<et)-1,[it,gt,ct,Pt]=he.getPoleBuffers(et,!1);if(Pt&&(Ne||Ve)){const Ft=A.getTile(xe);R.activeTexture.set(z.TEXTURE0),Ft.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);let xt=oF(et,We,j);const Mt=vm(pc(xe.canonical)),en=(on,rn)=>on.draw(b,z.TRIANGLES,K,oa.disabled,$,la.disabled,k8(j.projMatrix,xt,xt,Mt,0,ce,j.frustumCorners.TL,j.frustumCorners.TR,j.frustumCorners.BR,j.frustumCorners.BL,j.globeCenterInViewSpace,j.globeRadius,ye,0),"globe_pole_raster",rn,ct,Pt);w.setupElevationDraw(Ft,U,we),b.uploadCommonUniforms(R,U,xe.toUnwrapped()),Ne&&b.renderDefaultNorthPole&&en(U,it),Ve&&b.renderDefaultSouthPole&&(xt=at.scale(at.create(),xt,[1,-1,1]),en(U,gt))}}}})(u,h,p,g,v);else{const b=u.context,w=b.gl;let A,C;const P=u.shadowRenderer,R=vv(u,u.longestCutoffRange),z=$=>{if(C===$)return;const K=[];K.push(O8[$]),R.shouldRenderCutoff&&K.push("RENDER_CUTOFF"),A=u.getOrCreateProgram("terrainRaster",{defines:K}),C=$},U=u.colorModeForRenderPass(),W=new zn(w.LEQUAL,zn.ReadWrite,u.depthRangeFor3D);_v.update(v);const j=u.transform,Y=z8(j.zoom,h.exaggeration(),h.sourceCache._source.tileSize);let Z=[0,0,0];if(P){const $=u.style.directionalLight,K=u.style.ambientLight;$&&K&&(Z=w5($,K))}{C=-1;const $=w.TRIANGLES,[K,ie]=[h.gridIndexBuffer,h.gridSegments];for(const ce of g){const he=p.getTile(ce),ye=oa.disabled,Te=h.prevTerrainTileForTile[ce.key],we=h.terrainTileForTile[ce.key];D8(Te,we)&&_v.newMorphing(ce.key,Te,we,v,250),b.activeTexture.set(w.TEXTURE0),he.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const Ie=_v.getMorphValuesForProxy(ce.key),xe=Ie?1:0;let We;Ie&&(We={morphing:{srcDemTile:Ie.from,dstDemTile:Ie.to,phase:Le(Ie.phase)}});const qe=R8(ce.projMatrix,Cie(ce.canonical,j.renderWorldCopies)?Y/10:Y,Z);if(z(xe),!A)continue;h.setupElevationDraw(he,A,We);const et=ce.toUnwrapped();P&&P.setupShadows(et,A),u.uploadCommonUniforms(b,A,et,null,R),A.draw(u,$,W,ye,U,la.backCCW,qe,"terrain_raster",h.gridBuffer,K,ie)}}}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const r=this.painter,l=this.painter.context,u=this.proxySourceCache,h=this.proxiedCoords[u.id],p=this._drapedRenderBatches.shift(),g=r.style.order,v=[];let b=0;for(const w of h){const A=u.getTileByID(w.proxyTileKey),C=u.proxyCachedFBO[w.key]?u.proxyCachedFBO[w.key][t]:void 0,P=C!==void 0?u.renderCache[C]:this.pool[b++],R=C!==void 0;if(A.texture=P.tex,R&&!P.dirty){v.push(A.tileID);continue}let z;l.bindFramebuffer.set(P.fb.framebuffer),this.renderedToTile=!1,P.dirty&&(l.clear({color:xn.transparent,stencil:0}),P.dirty=!1);for(let U=p.start;U<=p.end;++U){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const j=r.style.getLayerSourceCache(W),Y=j?this.proxyToSource[w.key][j.id]:[w];if(!Y)continue;const Z=Y;l.viewport.set([0,0,P.fb.width,P.fb.height]),z!==(j?j.id:null)&&(this._setupStencil(P,Y,W,j),z=j?j.id:null),r.renderLayer(r,j,W,Z)}if(this._drapedRenderBatches.length===0)for(const U of this._pendingGroundEffectLayers){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const j=r.style.getLayerSourceCache(W),Y=j?this.proxyToSource[w.key][j.id]:[w];if(!Y)continue;const Z=Y;l.viewport.set([0,0,P.fb.width,P.fb.height]),z!==(j?j.id:null)&&(this._setupStencil(P,Y,W,j),z=j?j.id:null),r.renderLayer(r,j,W,Z)}this.renderedToTile?(P.dirty=!0,v.push(A.tileID)):R||--b,b===5&&(b=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,l.bindFramebuffer.set(null),l.viewport.set([0,0,r.width,r.height]),p.end+1}postRender(){}isLayerOrderingCorrect(t){const r=t.order.length;let l=-1,u=r;for(let h=0;h<r;++h)this._style.isLayerDraped(t._mergedLayers[t.order[h]])?l=Math.max(l,h):u=Math.min(u,h);return u>l}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{t=Math.min(t,r.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,r,l){if(!this._visibleDemTiles)return null;const u=this._visibleDemTiles.filter(h=>h.dem).map(h=>{const p=h.tileID,g=1<<p.overscaledZ,{x:v,y:b}=p.canonical,w=v/g,A=(v+1)/g,C=b/g,P=(b+1)/g;return{minx:w,miny:C,maxx:A,maxy:P,t:h.dem.tree.raycastRoot(w,C,A,P,t,r,l),tile:h}});u.sort((h,p)=>(h.t!==null?h.t:Number.MAX_VALUE)-(p.t!==null?p.t:Number.MAX_VALUE));for(const h of u){if(h.t==null)return null;const p=h.tile.dem.tree.raycast(h.minx,h.miny,h.maxx,h.maxy,t,r,l);if(p!=null)return p}return null}_createFBO(){const t=this.painter.context,r=t.gl,l=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const u=new yr(t,{width:l[0],height:l[1],data:null},r.RGBA);u.bind(r.LINEAR,r.CLAMP_TO_EDGE);const h=t.createFramebuffer(l[0],l[1],!0,null);return h.colorAttachment.set(u.texture),h.depthAttachment=new Nne(t,h.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,l[0],l[1]),this._stencilRef=0,h.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):h.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:h,tex:u,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const r=this._style._mergedLayers[t],l=r.isHidden(this.painter.transform.zoom);return r.type==="custom"?!l&&r.shouldRedrape():!l&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const l of this._style.getSources())if(l instanceof YB){t=!0;break}if(!t)return;const r={};for(let l=0;l<this._style.order.length;++l){const u=this._style._mergedLayers[this._style.order[l]],h=this._style.getLayerSourceCache(u);if(h&&!r[h.id]&&!u.isHidden(this.painter.transform.zoom)&&u.type==="line"&&u.widthExpression()instanceof zc){r[h.id]=!0;for(const p of this.proxyCoords){const g=this.proxyToSource[p.key][h.id];if(g)for(const v of g)this._clearRenderCacheForTile(h.id,v)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const l in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[l]._source instanceof C1){t=!0;break}if(!t)return;const r={};for(let l=0;l<this._style.order.length;++l){const u=this._style._mergedLayers[this._style.order[l]],h=this._style.getLayerSourceCache(u);if(!h||r[h.id]||u.isHidden(this.painter.transform.zoom)||u.type!=="raster")continue;const p=u.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const v=this.proxyToSource[g.key][h.id];if(v)for(const b of v){const w=F8(h.getTile(b),h.findLoadedParent(b,0),h,this.painter.transform,p);(w.opacity!==1||w.mix!==0)&&this._clearRenderCacheForTile(h.id,b)}}}}_setupDrapedRenderBatches(){const t=this._style.order,r=t.length;if(r===0)return;const l=[];this._pendingGroundEffectLayers=[];let u,h=0,p=this._style._mergedLayers[t[h]];for(;!this._style.isLayerDraped(p)&&p.isHidden(this.painter.transform.zoom)&&++h<r;)p=this._style._mergedLayers[t[h]];for(;h<r;++h){const g=this._style._mergedLayers[t[h]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?u===void 0&&(u=h):(g.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(h),u!==void 0&&(l.push({start:u,end:h-1}),u=void 0)))}if(u!==void 0&&l.push({start:u,end:h-1}),l.length!==0){const g=l[l.length-1];this._pendingGroundEffectLayers.every(b=>b>g.end)||ve("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=l}_setupRenderCache(t){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const p=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let g=0;g<p.length;++g){const v=Object.values(p[g]);r.renderCachePool.push(...v)}}return}this._clearRasterLayersFromRenderCache();const l=this.proxyCoords,u=this._tilesDirty;for(let p=l.length-1;p>=0;p--){const g=l[p];if(r.getTileByID(g.key),r.proxyCachedFBO[g.key]!==void 0){const v=t[g.key],b=this.proxyToSource[g.key];let w=0;for(const A in b){const C=b[A],P=v[A];if(!P||P.length!==C.length||C.some((R,z)=>R!==P[z]||u[A]&&u[A].hasOwnProperty(R.key))){w=-1;break}++w}for(const A in r.proxyCachedFBO[g.key])r.renderCache[r.proxyCachedFBO[g.key][A]].dirty=w<0||w!==Object.values(v).length}}const h=[...this._drapedRenderBatches];h.sort((p,g)=>g.end-g.start-(p.end-p.start));for(const p of h)for(const g of l){if(r.proxyCachedFBO[g.key])continue;let v=r.renderCachePool.pop();v===void 0&&r.renderCache.length<50&&(v=r.renderCache.length,r.renderCache.push(this._createFBO())),v!==void 0&&(r.proxyCachedFBO[g.key]={},r.proxyCachedFBO[g.key][p.start]=v,r.renderCache[v].dirty=!0)}this._tilesDirty={}}_setupStencil(t,r,l,u){if(!u||!this._sourceTilesOverlap[u.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const h=this.painter.context,p=h.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let g;if(l.isTileClipped())g=r.length,this._overlapStencilMode.test={func:p.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:p.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(h.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,l.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):oa.disabled}_renderTileClippingMasks(t,r){const l=this.painter,u=this.painter.context,h=u.gl;l._tileClippingMaskIDs={},u.setColorMode(Ea.disabled),u.setDepthMode(zn.disabled);const p=l.getOrCreateProgram("clippingMask");for(const g of t){const v=l._tileClippingMaskIDs[g.key]=--r;p.draw(l,h.TRIANGLES,zn.disabled,new oa({func:h.ALWAYS,mask:0},v,255,h.KEEP,h.KEEP,h.REPLACE),Ea.disabled,la.disabled,y5(g.projMatrix),"$clipping",l.tileExtentBuffer,l.quadTriangleIndexBuffer,l.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const l=[t.x,t.y,1,1];Ga.transformMat4(l,l,r.pixelMatrixInverse),Ga.scale(l,l,1/l[3]),l[0]/=r.worldSize,l[1]/=r.worldSize;const u=r._camera.position,h=$a(1,r.center.lat),p=[u[0],u[1],u[2]/h,0],g=ke.subtract([],l.slice(0,3),p);ke.normalize(g,g);const v=this.raycast(p,g,this._exaggeration);return v!==null&&v?(ke.scaleAndAdd(p,p,g,v),p[3]=p[2],p[2]*=h,p):null}drawDepth(){const t=this.painter,r=t.context,l=this.proxySourceCache,u=Math.ceil(t.width),h=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===u&&this._depthFBO.height===h||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const p=r.gl,g=r.createFramebuffer(u,h,!0,"renderbuffer");r.activeTexture.set(p.TEXTURE0);const v=new yr(r,{width:u,height:h,data:null},p.RGBA);v.bind(p.NEAREST,p.CLAMP_TO_EDGE),g.colorAttachment.set(v.texture);const b=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,u,h);g.depthAttachment.set(b),this._depthFBO=g,this._depthTexture=v}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,u,h]),function(p,g,v,b){if(p.transform.projection.name==="globe")return;const w=p.context,A=w.gl;w.clear({depth:1});const C=p.getOrCreateProgram("terrainDepth"),P=new zn(A.LESS,zn.ReadWrite,p.depthRangeFor3D);for(const R of b){const z=v.getTile(R),U=R8(R.projMatrix,0,[0,0,0]);g.setupElevationDraw(z,C),C.draw(p,A.TRIANGLES,P,oa.disabled,Ea.unblended,la.backCCW,U,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,l,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,r,l){if(t.getSource()instanceof Xu)return this._setupProxiedCoordsForImageSource(t,r,l);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords;for(let g=0;g<h.length;g++){const v=h[g],b=this._findTileCoveringTileID(v,t);if(b){const w=this._createProxiedId(v,b,l[v.key]&&l[v.key][t.id]);u.push(w),this.proxyToSource[v.key][t.id]=[w]}}let p=!1;for(let g=0;g<r.length;g++){const v=t.getTile(r[g]);if(!v||!v.hasData())continue;const b=this._findTileCoveringTileID(v.tileID,this.proxySourceCache);if(b&&b.tileID.canonical.z!==v.tileID.canonical.z){const w=this.proxyToSource[b.tileID.key][t.id],A=this._createProxiedId(b.tileID,v,l[b.tileID.key]&&l[b.tileID.key][t.id]);w?w.splice(w.length-1,0,A):this.proxyToSource[b.tileID.key][t.id]=[A],u.push(A),p=!0}}this._sourceTilesOverlap[t.id]=p}_setupProxiedCoordsForImageSource(t,r,l){if(!t.getSource().loaded())return;const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords,p=t.getSource(),g=p.tileID;if(!g)return;const v=new V(g.x,g.y)._div(1<<g.z),b=p.coordinates.map(ga.fromLngLat).reduce((A,C)=>(A.min.x=Math.min(A.min.x,C.x-v.x),A.min.y=Math.min(A.min.y,C.y-v.y),A.max.x=Math.max(A.max.x,C.x-v.x),A.max.y=Math.max(A.max.y,C.y-v.y),A),{min:new V(Number.MAX_VALUE,Number.MAX_VALUE),max:new V(-Number.MAX_VALUE,-Number.MAX_VALUE)}),w=(A,C)=>{const P=A.wrap+A.canonical.x/(1<<A.canonical.z),R=A.canonical.y/(1<<A.canonical.z),z=ht/(1<<A.canonical.z),U=C.wrap+C.canonical.x/(1<<C.canonical.z),W=C.canonical.y/(1<<C.canonical.z);return P+z<U+b.min.x||P>U+b.max.x||R+z<W+b.min.y||R>W+b.max.y};for(let A=0;A<h.length;A++){const C=h[A];for(let P=0;P<r.length;P++){const R=t.getTile(r[P]);if(!R||!R.hasData()||w(C,R.tileID))continue;const z=this._createProxiedId(C,R,l[C.key]&&l[C.key][t.id]),U=this.proxyToSource[C.key][t.id];U?U.push(z):this.proxyToSource[C.key][t.id]=[z],u.push(z)}}}_createProxiedId(t,r,l){let u=this.orthoMatrix;if(l){const h=l.find(p=>p.key===r.tileID.key);if(h)return h}if(r.tileID.key!==t.key){const h=t.canonical.z-r.tileID.canonical.z;let p,g,v;u=at.create();const b=r.tileID.wrap-t.wrap<<t.overscaledZ;h>0?(p=ht>>h,g=p*((r.tileID.canonical.x<<h)-t.canonical.x+b),v=p*((r.tileID.canonical.y<<h)-t.canonical.y)):(p=ht<<-h,g=ht*(r.tileID.canonical.x-(t.canonical.x+b<<-h)),v=ht*(r.tileID.canonical.y-(t.canonical.y<<-h))),at.ortho(u,0,p,0,p,0,1),at.translate(u,u,[g,v,0])}return new N8(r.tileID,t.key,u)}_findTileCoveringTileID(t,r){let l=r.getTile(t);if(l&&l.hasData())return l;const u=this._findCoveringTileCache[r.id],h=u[t.key];if(l=h?r.getTileByID(h):null,l&&l.hasData()||h===null)return l;let p=l?l.tileID:t,g=p.overscaledZ;const v=r.getSource().minzoom,b=[];if(!h){const A=r.getSource().maxzoom;if(t.canonical.z>=A){const C=t.canonical.z-A;r.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,r.transform.tileZoom),p=new Ca(g,t.wrap,A,t.canonical.x>>C,t.canonical.y>>C)):C!==0&&(g=A,p=new Ca(g,t.wrap,A,t.canonical.x>>C,t.canonical.y>>C))}p.key!==t.key&&(b.push(p.key),l=r.getTile(p))}const w=A=>{b.forEach(C=>{u[C]=A}),b.length=0};for(g-=1;g>=v&&(!l||!l.hasData());g--){l&&w(l.tileID.key);const A=p.calculateScaledKey(g);if(l=r.getTileByID(A),l&&l.hasData())break;const C=u[A];if(C===null)break;C===void 0?b.push(A):l=r.getTileByID(C)}return w(l?l.tileID.key:null),l&&l.hasData()?l:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,r){let l=this._tilesDirty[t];l||(l=this._tilesDirty[t]={}),l[r.key]=!0}}function Rie(i,t,r){const l=function(g,v,b){const w=ke.dot(v,g),A=ke.dot(b,[.2126,.7152,.0722]),C=(R,z,U)=>(1-U)*R+U*z,P=C(1-.3*Math.min(A,1),1,Math.min(w+1,1));return C(.92,1,Math.asin(ae(v[2],-1,1))/Math.PI+.5)*P}(i,[0,0,1],t),u=[0,0,0];ke.scale(u,r.slice(0,3),l);const h=[0,0,0];ke.scale(h,t.slice(0,3),i[2]);const p=[0,0,0];return ke.add(p,u,h),$t(p)}const kie=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Die=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class B8{static cacheKey(t,r,l,u){let h=`${r}${u?u.cacheKey:""}`;for(const p of l)t.usedDefines.includes(p)&&(h+=`/${p}`);return h}constructor(t,r,l,u,h,p){const g=t.gl;this.program=g.createProgram(),this.configuration=u,this.name=r,this.fixedDefines=[...p];const v=function(W){const j=[];for(let Y=0;Y<W.length;Y++){if(W[Y]===null)continue;const Z=W[Y].split(" ");j.push(Z.pop())}return j}(l.staticAttributes),b=u?u.getBinderAttributes():[],w=v.concat(b);let A=u?u.defines():[];A=A.concat(p.map(W=>`#define ${W}`));const C=`#version 300 es
`;let P=C+A.concat(C8,C8,T8,M8.fragmentSource).join(`
`);for(const W of l.fragmentIncludes)P+=`
${T3[W]}`;P+=`
${l.fragmentSource}`;let R=C+A.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,T8,M8.vertexSource).join(`
`);for(const W of l.vertexIncludes)R+=`
${T3[W]}`;R+=`
${l.vertexSource}`;const z=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(z,P),g.compileShader(z),g.attachShader(this.program,z);const U=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(U,R),g.compileShader(U),g.attachShader(this.program,U),this.attributes={},this.numAttributes=w.length;for(let W=0;W<this.numAttributes;W++)if(w[W]){const j=w[W].startsWith("a_")?w[W]:`a_${w[W]}`;g.bindAttribLocation(this.program,W,j),this.attributes[j]=W}g.linkProgram(this.program),g.deleteShader(U),g.deleteShader(z),this.fixedUniforms=h(t),this.binderUniforms=u?u.getUniforms(t):[],p.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new ra(W),u_dem_prev:new ra(W),u_dem_unpack:new rl(W),u_dem_tl:new ua(W),u_dem_scale:new Yt(W),u_dem_tl_prev:new ua(W),u_dem_scale_prev:new Yt(W),u_dem_size:new Yt(W),u_dem_lerp:new Yt(W),u_exaggeration:new Yt(W),u_depth:new ra(W),u_depth_size_inv:new ua(W),u_meter_to_dem:new Yt(W),u_label_plane_matrix_inv:new jn(W)}))(t)),p.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new Xn(W),u_tile_tr_up:new Xn(W),u_tile_br_up:new Xn(W),u_tile_bl_up:new Xn(W),u_tile_up_scale:new Yt(W)}))(t)),p.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new jn(W),u_fog_range:new ua(W),u_fog_color:new rl(W),u_fog_horizon_blend:new Yt(W),u_fog_vertical_limit:new ua(W),u_fog_temporal_offset:new Yt(W),u_frustum_tl:new Xn(W),u_frustum_tr:new Xn(W),u_frustum_br:new Xn(W),u_frustum_bl:new Xn(W),u_globe_pos:new Xn(W),u_globe_radius:new Yt(W),u_globe_transition:new Yt(W),u_is_globe:new ra(W),u_viewport:new ua(W)}))(t)),p.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(W=>({u_cutoff_params:new rl(W)}))(t)),p.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(W=>({u_lighting_ambient_color:new Xn(W),u_lighting_directional_dir:new Xn(W),u_lighting_directional_color:new Xn(W),u_ground_radiance:new Xn(W)}))(t)),p.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(W=>({u_light_matrix_0:new jn(W),u_light_matrix_1:new jn(W),u_fade_range:new ua(W),u_shadow_normal_offset:new Xn(W),u_shadow_intensity:new Yt(W),u_shadow_texel_size:new Yt(W),u_shadow_map_resolution:new Yt(W),u_shadow_direction:new Xn(W),u_shadow_bias:new Xn(W),u_shadowmap_0:new ra(W),u_shadowmap_1:new ra(W)}))(t))}}setTerrainUniformValues(t,r){if(!this.terrainUniforms)return;const l=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u]&&l[u].set(this.program,u,r[u])}}setGlobeUniformValues(t,r){if(!this.globeUniforms)return;const l=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u]&&l[u].set(this.program,u,r[u])}}setFogUniformValues(t,r){if(!this.fogUniforms)return;const l=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setCutoffUniformValues(t,r){if(!this.cutoffUniforms)return;const l=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setLightsUniformValues(t,r){if(!this.lightsUniforms)return;const l=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}}setShadowUniformValues(t,r){if(this.failedToCreate||!this.shadowUniforms)return;const l=this.shadowUniforms;t.program.set(this.program);for(const u in r)l[u].set(this.program,u,r[u])}_drawDebugWireframe(t,r,l,u,h,p,g,v,b,w){const A=t.options.wireframe;if(A.terrain===!1&&A.layers2D===!1&&A.layers3D===!1)return;const C=t.context;if(!(()=>!(!A.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!A.layers2D||t._terrain&&t._terrain.renderingToTexture||!kie.includes(this.name))||!(!A.layers3D||!Die.includes(this.name)))())return;const P=C.gl,R=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,h,C);if(!R)return;const z=[...this.fixedDefines];z.push("DEBUG_WIREFRAME");const U=t.getOrCreateProgram(this.name,{config:this.configuration,defines:z});C.program.set(U.program);const W=(Z,$,K)=>{if($[Z]&&K[Z])for(const ie in $[Z])K[Z][ie]&&K[Z][ie].set(K.program,ie,$[Z][ie].current)};b&&b.setUniforms(U.program,C,U.binderUniforms,g,{zoom:v}),W("fixedUniforms",this,U),W("terrainUniforms",this,U),W("globeUniforms",this,U),W("fogUniforms",this,U),W("lightsUniforms",this,U),W("shadowUniforms",this,U),R.bind(),C.setColorMode(new Ea([P.ONE,P.ONE_MINUS_SRC_ALPHA,P.ZERO,P.ONE],xn.transparent,[!0,!0,!0,!1])),C.setDepthMode(new zn(r.func===P.LESS?P.LEQUAL:r.func,zn.ReadOnly,r.range)),C.setStencilMode(oa.disabled);const j=3*p.primitiveLength*2,Y=3*p.primitiveOffset*2*2;w&&w>1?P.drawElementsInstanced(P.LINES,j,P.UNSIGNED_SHORT,Y,w):P.drawElements(P.LINES,j,P.UNSIGNED_SHORT,Y),h.bind(),C.program.set(this.program),C.setDepthMode(r),C.setStencilMode(l),C.setColorMode(u)}draw(t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U){const W=t.context,j=W.gl;if(this.failedToCreate)return;W.program.set(this.program),W.setDepthMode(l),W.setStencilMode(u),W.setColorMode(h),W.setCullFace(p);for(const $ of Object.keys(this.fixedUniforms))this.fixedUniforms[$].set(this.program,$,g[$]);R&&R.setUniforms(this.program,W,this.binderUniforms,C,{zoom:P});const Y={[j.LINES]:2,[j.TRIANGLES]:3,[j.LINE_STRIP]:1}[r],Z=U&&U>0?1:void 0;for(const $ of A.get()){const K=$.vaos||($.vaos={});(K[v]||(K[v]=new Aie)).bind(W,this,b,R?R.getPaintVertexBuffers():[],w,$.vertexOffset,z||[],Z),U&&U>1?j.drawElementsInstanced(r,$.primitiveLength*Y,j.UNSIGNED_SHORT,$.primitiveOffset*Y*2,U):j.drawElements(r,$.primitiveLength*Y,j.UNSIGNED_SHORT,$.primitiveOffset*Y*2),r===j.TRIANGLES&&this._drawDebugWireframe(t,l,u,h,w,$,C,P,R,U)}}}function U8(i,t){const r=Math.pow(2,t.tileID.overscaledZ),l=t.tileSize*Math.pow(2,i.transform.tileZoom)/r,u=l*(t.tileID.canonical.x+t.tileID.wrap*r),h=l*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/wm(t,1,i.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}const Oie=at.create(),W8=(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R)=>{const z=t.style.light,U=z.properties.get("position"),W=[U.x,U.y,U.z],j=zs.create();z.properties.get("anchor")==="viewport"&&(zs.fromRotation(j,-t.transform.angle),ke.transformMat3(W,W,j));const Y=z.properties.get("color"),Z=t.transform,$={u_matrix:i,u_lightpos:W,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+r,u_opacity:l,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Oie,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:u,u_edge_radius:h,u_flood_light_color:A,u_vertical_scale:C,u_flood_light_intensity:P,u_ground_shadow_factor:R};return Z.projection.name==="globe"&&($.u_tile_id=[p.canonical.x,p.canonical.y,1<<p.canonical.z],$.u_zoom_transition=v,$.u_inv_rot_matrix=w,$.u_merc_center=b,$.u_up_dir=Z.projection.upVector(new Vu(0,0,0),b[0]*ht,b[1]*ht),$.u_height_lift=g),$},zie=(i,t,r)=>({u_matrix:i,u_edge_radius:t,u_vertical_scale:r}),Fie=(i,t,r,l,u,h,p,g,v,b,w,A,C,P)=>{const R=W8(i,t,r,l,u,h,p,v,b,w,A,C,P,1,[0,0,0]),z={u_height_factor:-Math.pow(2,p.overscaledZ)/g.tileSize/8};return Ue(R,U8(t,g),z)},V8=(i,t)=>({u_matrix:i,u_emissive_strength:t}),G8=(i,t,r,l)=>Ue(V8(i,t),U8(r,l)),Nie=(i,t,r)=>({u_matrix:i,u_world:r,u_emissive_strength:t}),Bie=(i,t,r,l,u)=>Ue(G8(i,t,r,l),{u_world:u}),Uie=(i,t,r,l)=>{const u=ht/r.tileSize;return{u_matrix:i,u_camera_to_center_distance:t.getCameraToCenterDistance(l),u_extrude_scale:[t.pixelsToGLUnits[0]/u,t.pixelsToGLUnits[1]/u]}},H8=(i,t,r=1)=>({u_matrix:i,u_color:t,u_overlay:0,u_overlay_scale:r}),Wie=at.create(),Vie=(i,t,r,l,u,h,p)=>{const g=i.transform,v=g.projection.name==="globe",b=v?iF(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:wm(r,1,h),w={u_matrix:t.projMatrix,u_extrude_scale:b,u_intensity:p,u_inv_rot_matrix:Wie,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){w.u_inv_rot_matrix=l,w.u_merc_center=u,w.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],w.u_zoom_transition=vo(g.zoom);const A=u[0]*ht,C=u[1]*ht;w.u_up_dir=g.projection.upVector(new Vu(0,0,0),A,C)}return w},j8=(i,t,r,l,u,h,p,g,v,b,w)=>{return{u_matrix:i,u_normalize_matrix:t,u_globe_matrix:r,u_tl_parent:l,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(C=p.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(A=p.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Gie(p.paint.get("raster-hue-rotate")),u_perspective_transform:g,u_colorization_mix:b,u_colorization_scale:Hie(w),u_color_ramp:v};var A,C};function Gie(i){i*=Math.PI/180;const t=Math.sin(i),r=Math.cos(i);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function Hie([i,t]){if(i===t)return[i,t];const r=(t+i)/2,l=(t-i)/2*256/255;return[-(i=r-l)/((t=r+l)-i),1/(t-i)]}const $8=at.create(),q8=(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U)=>{const W=u.transform,j={u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:W.getCameraToCenterDistance(z),u_rotate_symbol:+r,u_aspect_ratio:W.width/W.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:h,u_label_plane_matrix:p,u_coord_matrix:g,u_is_text:+v,u_pitch_with_map:+l,u_texsize:b,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$8,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:$8,u_up_vector:[0,-1,0],u_icon_transition:U||0};return z.name==="globe"&&(j.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],j.u_zoom_transition=A,j.u_inv_rot_matrix=P,j.u_merc_center=C,j.u_camera_forward=W._camera.forward(),j.u_ecef_origin=function(Y,Z){const $=[0,0,0],K=vm(pc(Z.canonical));return ke.transformMat4($,$,K),ke.transformMat4($,$,Y),$}(W.globeMatrix,w.toUnwrapped()),j.u_tile_matrix=Float32Array.from(W.globeMatrix),j.u_up_vector=R),j},X8=(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U)=>Ue(q8(i,t,r,l,u,h,p,g,v,b,A,C,P,R,z,U),{u_gamma_scale:l?u.transform.getCameraToCenterDistance(U)*Math.cos(u.terrain?0:u.transform._pitch):1,u_device_pixel_ratio:Cn.devicePixelRatio,u_is_halo:+w,undefined:void 0}),jie=(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z)=>Ue(X8(i,t,r,l,u,h,p,g,!0,v,!0,w,A,C,P,R,z),{u_texsize_icon:b,u_texture_icon:1}),$ie=(i,t,r,l)=>({u_matrix:i,u_emissive_strength:t,u_opacity:r,u_color:l}),qie=(i,t,r,l,u,h,p)=>Ue(function(g,v,b,w){const A=b.imageManager.getPattern(g.toString(),v),{width:C,height:P}=b.imageManager.getPixelSize(v),R=Math.pow(2,w.tileID.overscaledZ),z=w.tileSize*Math.pow(2,b.transform.tileZoom)/R,U=z*(w.tileID.canonical.x+w.tileID.wrap*R),W=z*w.tileID.canonical.y;return{u_image:0,u_pattern_tl:A.tl,u_pattern_br:A.br,u_texsize:[C,P],u_pattern_size:A.displaySize,u_tile_units_to_pixels:1/wm(w,1,b.transform.tileZoom),u_pixel_coord_upper:[U>>16,W>>16],u_pixel_coord_lower:[65535&U,65535&W]}}(u,h,l,p),{u_matrix:i,u_emissive_strength:t,u_opacity:r}),sl={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},v5=(i,t,r,l,u,h,p,g,v,b,w,A=[0,0,0])=>{const C=l.style.light,P=C.properties.get("position"),R=[-P.x,-P.y,P.z],z=zs.create();C.properties.get("anchor")==="viewport"&&(zs.fromRotation(z,-l.transform.angle),ke.transformMat3(R,R,z));const U=b.alphaMode==="MASK",W=C.properties.get("color"),j=w.paint.get("model-ambient-occlusion-intensity"),Y=w.paint.get("model-color").constantOr(xn.white),Z=w.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:i,u_lighting_matrix:t,u_normal_matrix:r,u_lightpos:R,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[W.r,W.g,W.b],u_camera_pos:A,u_opacity:u,u_baseTextureIsAlpha:0,u_alphaMask:+U,u_alphaCutoff:b.alphaCutoff,u_baseColorFactor:[h.r,h.g,h.b,h.a],u_emissiveFactor:[p[0],p[1],p[2],1],u_metallicFactor:g,u_roughnessFactor:v,u_baseColorTexture:sl.BaseColor,u_metallicRoughnessTexture:sl.MetallicRoughness,u_normalTexture:sl.Normal,u_occlusionTexture:sl.Occlusion,u_emissionTexture:sl.Emission,u_color_mix:[Y.r,Y.g,Y.b,Z],u_aoIntensity:j}},Y8=new Float32Array(16),Z8=(i,t=Y8,r=Y8)=>({u_matrix:i,u_instance:t,u_node_matrix:r}),Xie={fillExtrusion:i=>({u_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Yt(i),u_lightcolor:new Xn(i),u_vertical_gradient:new Yt(i),u_opacity:new Yt(i),u_edge_radius:new Yt(i),u_ao:new ua(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_up_dir:new Xn(i),u_height_lift:new Yt(i),u_flood_light_color:new Xn(i),u_vertical_scale:new Yt(i),u_flood_light_intensity:new Yt(i),u_ground_shadow_factor:new Xn(i)}),fillExtrusionDepth:i=>({u_matrix:new jn(i),u_edge_radius:new Yt(i),u_vertical_scale:new Yt(i)}),fillExtrusionPattern:i=>({u_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Yt(i),u_lightcolor:new Xn(i),u_vertical_gradient:new Yt(i),u_height_factor:new Yt(i),u_edge_radius:new Yt(i),u_ao:new ua(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_up_dir:new Xn(i),u_height_lift:new Yt(i),u_image:new ra(i),u_texsize:new ua(i),u_pixel_coord_upper:new ua(i),u_pixel_coord_lower:new ua(i),u_tile_units_to_pixels:new Yt(i),u_opacity:new Yt(i)}),fillExtrusionGroundEffect:i=>({u_matrix:new jn(i),u_opacity:new Yt(i),u_ao_pass:new Yt(i),u_meter_to_tile:new Yt(i),u_ao:new ua(i),u_flood_light_intensity:new Yt(i),u_flood_light_color:new Xn(i),u_attenuation:new Yt(i),u_edge_radius:new Yt(i),u_fb:new ra(i),u_fb_size:new Yt(i)}),fill:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i)}),fillPattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i),u_image:new ra(i),u_texsize:new ua(i),u_pixel_coord_upper:new ua(i),u_pixel_coord_lower:new ua(i),u_tile_units_to_pixels:new Yt(i)}),fillOutline:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i),u_world:new ua(i)}),fillOutlinePattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i),u_world:new ua(i),u_image:new ra(i),u_texsize:new ua(i),u_pixel_coord_upper:new ua(i),u_pixel_coord_lower:new ua(i),u_tile_units_to_pixels:new Yt(i)}),circle:i=>({u_camera_to_center_distance:new Yt(i),u_extrude_scale:new IC(i),u_device_pixel_ratio:new Yt(i),u_matrix:new jn(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_up_dir:new Xn(i),u_emissive_strength:new Yt(i)}),collisionBox:i=>({u_matrix:new jn(i),u_camera_to_center_distance:new Yt(i),u_extrude_scale:new ua(i)}),collisionCircle:i=>({u_matrix:new jn(i),u_inv_matrix:new jn(i),u_camera_to_center_distance:new Yt(i),u_viewport_size:new ua(i)}),debug:i=>({u_color:new Yy(i),u_matrix:new jn(i),u_overlay:new ra(i),u_overlay_scale:new Yt(i)}),clippingMask:i=>({u_matrix:new jn(i)}),heatmap:i=>({u_extrude_scale:new Yt(i),u_intensity:new Yt(i),u_matrix:new jn(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_up_dir:new Xn(i)}),heatmapTexture:i=>({u_image:new ra(i),u_color_ramp:new ra(i),u_opacity:new Yt(i)}),hillshade:i=>({u_matrix:new jn(i),u_image:new ra(i),u_latrange:new ua(i),u_light:new ua(i),u_shadow:new Yy(i),u_highlight:new Yy(i),u_emissive_strength:new Yt(i),u_accent:new Yy(i)}),hillshadePrepare:i=>({u_matrix:new jn(i),u_image:new ra(i),u_dimension:new ua(i),u_zoom:new Yt(i),u_unpack:new rl(i)}),line:i=>({u_matrix:new jn(i),u_pixels_to_tile_units:new IC(i),u_device_pixel_ratio:new Yt(i),u_units_to_pixels:new ua(i),u_dash_image:new ra(i),u_gradient_image:new ra(i),u_image_height:new Yt(i),u_texsize:new ua(i),u_tile_units_to_pixels:new Yt(i),u_alpha_discard_threshold:new Yt(i),u_trim_offset:new ua(i),u_emissive_strength:new Yt(i)}),linePattern:i=>({u_matrix:new jn(i),u_texsize:new ua(i),u_pixels_to_tile_units:new IC(i),u_device_pixel_ratio:new Yt(i),u_image:new ra(i),u_units_to_pixels:new ua(i),u_tile_units_to_pixels:new Yt(i),u_alpha_discard_threshold:new Yt(i)}),raster:i=>({u_matrix:new jn(i),u_normalize_matrix:new jn(i),u_globe_matrix:new jn(i),u_tl_parent:new ua(i),u_scale_parent:new Yt(i),u_fade_t:new Yt(i),u_opacity:new Yt(i),u_image0:new ra(i),u_image1:new ra(i),u_brightness_low:new Yt(i),u_brightness_high:new Yt(i),u_saturation_factor:new Yt(i),u_contrast_factor:new Yt(i),u_spin_weights:new Xn(i),u_perspective_transform:new ua(i),u_colorization_mix:new rl(i),u_colorization_scale:new ua(i),u_color_ramp:new ra(i)}),symbolIcon:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Yt(i),u_size:new Yt(i),u_camera_to_center_distance:new Yt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Yt(i),u_fade_change:new Yt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ua(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_camera_forward:new Xn(i),u_tile_matrix:new jn(i),u_up_vector:new Xn(i),u_ecef_origin:new Xn(i),u_texture:new ra(i),u_icon_transition:new Yt(i)}),symbolSDF:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Yt(i),u_size:new Yt(i),u_camera_to_center_distance:new Yt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Yt(i),u_fade_change:new Yt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ua(i),u_texture:new ra(i),u_gamma_scale:new Yt(i),u_device_pixel_ratio:new Yt(i),u_tile_id:new Xn(i),u_zoom_transition:new Yt(i),u_inv_rot_matrix:new jn(i),u_merc_center:new ua(i),u_camera_forward:new Xn(i),u_tile_matrix:new jn(i),u_up_vector:new Xn(i),u_ecef_origin:new Xn(i),u_is_halo:new ra(i)}),symbolTextAndIcon:i=>({u_is_size_zoom_constant:new ra(i),u_is_size_feature_constant:new ra(i),u_size_t:new Yt(i),u_size:new Yt(i),u_camera_to_center_distance:new Yt(i),u_rotate_symbol:new ra(i),u_aspect_ratio:new Yt(i),u_fade_change:new Yt(i),u_matrix:new jn(i),u_label_plane_matrix:new jn(i),u_coord_matrix:new jn(i),u_is_text:new ra(i),u_pitch_with_map:new ra(i),u_texsize:new ua(i),u_texsize_icon:new ua(i),u_texture:new ra(i),u_texture_icon:new ra(i),u_gamma_scale:new Yt(i),u_device_pixel_ratio:new Yt(i),u_is_halo:new ra(i)}),background:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i),u_opacity:new Yt(i),u_color:new Yy(i)}),backgroundPattern:i=>({u_matrix:new jn(i),u_emissive_strength:new Yt(i),u_opacity:new Yt(i),u_image:new ra(i),u_pattern_tl:new ua(i),u_pattern_br:new ua(i),u_texsize:new ua(i),u_pattern_size:new ua(i),u_pixel_coord_upper:new ua(i),u_pixel_coord_lower:new ua(i),u_tile_units_to_pixels:new Yt(i)}),terrainRaster:L8,terrainDepth:L8,skybox:i=>({u_matrix:new jn(i),u_sun_direction:new Xn(i),u_cubemap:new ra(i),u_opacity:new Yt(i),u_temporal_offset:new Yt(i)}),skyboxGradient:i=>({u_matrix:new jn(i),u_color_ramp:new ra(i),u_center_direction:new Xn(i),u_radius:new Yt(i),u_opacity:new Yt(i),u_temporal_offset:new Yt(i)}),skyboxCapture:i=>({u_matrix_3f:new kO(i),u_sun_direction:new Xn(i),u_sun_intensity:new Yt(i),u_color_tint_r:new rl(i),u_color_tint_m:new rl(i),u_luminance:new Yt(i)}),globeRaster:i=>({u_proj_matrix:new jn(i),u_globe_matrix:new jn(i),u_normalize_matrix:new jn(i),u_merc_matrix:new jn(i),u_zoom_transition:new Yt(i),u_merc_center:new ua(i),u_image0:new ra(i),u_grid_matrix:new kO(i),u_skirt_height:new Yt(i),u_frustum_tl:new Xn(i),u_frustum_tr:new Xn(i),u_frustum_br:new Xn(i),u_frustum_bl:new Xn(i),u_globe_pos:new Xn(i),u_globe_radius:new Yt(i),u_viewport:new ua(i)}),globeAtmosphere:i=>({u_frustum_tl:new Xn(i),u_frustum_tr:new Xn(i),u_frustum_br:new Xn(i),u_frustum_bl:new Xn(i),u_horizon:new Yt(i),u_transition:new Yt(i),u_fadeout_range:new Yt(i),u_color:new rl(i),u_high_color:new rl(i),u_space_color:new rl(i),u_temporal_offset:new Yt(i),u_horizon_angle:new Yt(i)}),model:i=>({u_matrix:new jn(i),u_lighting_matrix:new jn(i),u_normal_matrix:new jn(i),u_lightpos:new Xn(i),u_lightintensity:new Yt(i),u_lightcolor:new Xn(i),u_camera_pos:new Xn(i),u_opacity:new Yt(i),u_baseColorFactor:new rl(i),u_emissiveFactor:new rl(i),u_metallicFactor:new Yt(i),u_roughnessFactor:new Yt(i),u_baseTextureIsAlpha:new ra(i),u_alphaMask:new ra(i),u_alphaCutoff:new Yt(i),u_baseColorTexture:new ra(i),u_metallicRoughnessTexture:new ra(i),u_normalTexture:new ra(i),u_occlusionTexture:new ra(i),u_emissionTexture:new ra(i),u_color_mix:new rl(i),u_aoIntensity:new Yt(i)}),modelDepth:i=>({u_matrix:new jn(i),u_instance:new jn(i),u_node_matrix:new jn(i)}),groundShadow:i=>({u_matrix:new jn(i),u_ground_shadow_factor:new Xn(i)}),stars:i=>({u_matrix:new jn(i),u_up:new Xn(i),u_right:new Xn(i),u_intensity_multiplier:new Yt(i)})};let I3;function K8(i,t,r,l,u,h,p){const g=i.context,v=g.gl,b=i.transform,w=i.getOrCreateProgram("collisionBox"),A=[];let C=0,P=0;for(let Z=0;Z<l.length;Z++){const $=l[Z],K=t.getTile($),ie=K.getBucket(r);if(!ie)continue;const ce=oie($,ie,b);let he=ce;u[0]===0&&u[1]===0||(he=i.translatePosMatrix(ce,K,u,h));const ye=p?ie.textCollisionBox:ie.iconCollisionBox,Te=ie.collisionCircleArray;if(Te.length>0){const we=at.create(),Ie=he;at.mul(we,ie.placementInvProjMatrix,b.glCoordMatrix),at.mul(we,we,ie.placementViewportMatrix),A.push({circleArray:Te,circleOffset:P,transform:Ie,invTransform:we,projection:ie.getProjection()}),C+=Te.length/4,P=C}ye&&(i.terrain&&i.terrain.setupElevationDraw(K,w),w.draw(i,v.LINES,zn.disabled,oa.disabled,i.colorModeForRenderPass(),la.disabled,Uie(he,b,K,ie.getProjection()),r.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,null,b.zoom,null,[ye.collisionVertexBuffer,ye.collisionVertexBufferExt]))}if(!p||!A.length)return;const R=i.getOrCreateProgram("collisionCircle"),z=new Wt;z.resize(4*C),z._trim();let U=0;for(const Z of A)for(let $=0;$<Z.circleArray.length/4;$++){const K=4*$,ie=Z.circleArray[K+0],ce=Z.circleArray[K+1],he=Z.circleArray[K+2],ye=Z.circleArray[K+3];z.emplace(U++,ie,ce,he,ye,0),z.emplace(U++,ie,ce,he,ye,1),z.emplace(U++,ie,ce,he,ye,2),z.emplace(U++,ie,ce,he,ye,3)}(!I3||I3.length<2*C)&&(I3=function(Z){const $=2*Z,K=new Nn;K.resize($),K._trim();for(let ie=0;ie<$;ie++){const ce=6*ie;K.uint16[ce+0]=4*ie+0,K.uint16[ce+1]=4*ie+1,K.uint16[ce+2]=4*ie+2,K.uint16[ce+3]=4*ie+2,K.uint16[ce+4]=4*ie+3,K.uint16[ce+5]=4*ie+0}return K}(C));const W=g.createIndexBuffer(I3,!0),j=g.createVertexBuffer(z,vte.members,!0);for(const Z of A){const $={u_matrix:Z.transform,u_inv_matrix:Z.invTransform,u_camera_to_center_distance:(Y=b).getCameraToCenterDistance(Z.projection),u_viewport_size:[Y.width,Y.height]};R.draw(i,v.TRIANGLES,zn.disabled,oa.disabled,i.colorModeForRenderPass(),la.disabled,$,r.id,j,W,ja.simpleSegment(0,2*Z.circleOffset,Z.circleArray.length,Z.circleArray.length/2),null,b.zoom)}var Y;j.destroy(),W.destroy()}const J8=at.create();function Yie({width:i,height:t,anchor:r,textOffset:l,textScale:u},h){const{horizontalAlign:p,verticalAlign:g}=$2(r),v=-(p-.5)*i,b=-(g-.5)*t,w=PP(r,l);return new V((v/u+w[0])*h,(b/u+w[1])*h)}function Zie(i,t,r,l,u,h,p,g,v,b,w){const A=i.text.placedSymbolArray,C=i.text.dynamicLayoutVertexArray,P=i.icon.dynamicLayoutVertexArray,R={},z=i.getProjection(),U=d5(g,z,h),W=h.elevation,j=z.upVectorScale(g.canonical,h.center.lat,h.worldSize).metersToTile;C.clear();for(let Y=0;Y<A.length;Y++){const Z=A.get(Y),{tileAnchorX:$,tileAnchorY:K,numGlyphs:ie}=Z,ce=Z.hidden||!Z.crossTileID||i.allowVerticalPlacement&&!Z.placedOrientation?null:l[Z.crossTileID];if(ce){let he=0,ye=0,Te=0;if(W){const it=W?W.getAtTileOffset(g,$,K):0,[gt,ct,Pt]=z.upVector(g.canonical,$,K);he=it*gt*j,ye=it*ct*j,Te=it*Pt*j}let[we,Ie,xe,We]=qc(Z.projectedAnchorX+he,Z.projectedAnchorY+ye,Z.projectedAnchorZ+Te,r?U:p);const qe=VN(h.getCameraToCenterDistance(z),We);let et=u.evaluateSizeForFeature(i.textSizeData,b,Z)*qe/io;r&&(et*=i.tilePixelRatio/v);const Ne=Yie(ce,et);r?({x:we,y:Ie,z:xe}=z.projectTilePoint($+Ne.x,K+Ne.y,g.canonical),[we,Ie,xe]=qc(we+he,Ie+ye,xe+Te,p)):(t&&Ne._rotate(-h.angle),we+=Ne.x,Ie+=Ne.y,xe=0);const Ve=i.allowVerticalPlacement&&Z.placedOrientation===bi.vertical?Math.PI/2:0;for(let it=0;it<ie;it++)fv(C,we,Ie,xe,Ve);w&&Z.associatedIconIndex>=0&&(R[Z.associatedIconIndex]={x:we,y:Ie,z:xe,angle:Ve})}else mv(ie,C)}if(w){P.clear();const Y=i.icon.placedSymbolArray;for(let Z=0;Z<Y.length;Z++){const $=Y.get(Z),{numGlyphs:K}=$,ie=R[Z];if($.hidden||!ie)mv(K,P);else{const{x:ce,y:he,z:ye,angle:Te}=ie;for(let we=0;we<K;we++)fv(P,ce,he,ye,Te)}}i.icon.dynamicLayoutVertexBuffer.updateData(P)}i.text.dynamicLayoutVertexBuffer.updateData(C)}function Kie(i,t,r){return r.iconsInText&&t?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}function Q8(i,t,r,l,u,h,p,g,v,b,w,A){const C=i.context,P=C.gl,R=i.transform,z=g==="map",U=v==="map",W=z&&r.layout.get("symbol-placement")!=="point",j=z&&!U&&!W,Y=r.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Z=!1;const $=i.depthModeForSublayer(0,zn.ReadOnly),K=[_o(R.center.lng),Co(R.center.lat)],ie=r.layout.get("text-variable-anchor"),ce=R.projection.name==="globe",he=[],ye=[0,-1,0];let Te=ye;!ce&&!R.mercatorFromTransition||z||(Te=function(we){const Ie=we._camera.getWorldToCamera(we.worldSize,1),xe=at.multiply([],Ie,we.globeMatrix);at.invert(xe,xe);const We=[0,0,0],qe=[0,1,0,0];return Ga.transformMat4(qe,qe,xe),We[0]=qe[0],We[1]=qe[1],We[2]=qe[2],ke.normalize(We,We),We}(R));for(const we of l){const Ie=t.getTile(we),xe=Ie.getBucket(r);if(!xe||xe.projection.name==="mercator"&&ce)continue;const We=u?xe.text:xe.icon;if(!We||xe.fullyClipped||!We.segments.get().length)continue;const qe=We.programConfigurations.get(r.id),et=u||xe.sdfIcons,Ne=u?xe.textSizeData:xe.iconSizeData,Ve=U||R.pitch!==0,it=Hu(Ne,R.zoom);let gt,ct,Pt,Ft,xt=[0,0],Mt=null;if(u)ct=Ie.glyphAtlasTexture,Pt=P.LINEAR,gt=Ie.glyphAtlasTexture.size,xe.iconsInText&&(xt=Ie.imageAtlasTexture.size,Mt=Ie.imageAtlasTexture,Ft=Ve||i.options.rotating||i.options.zooming||Ne.kind==="composite"||Ne.kind==="camera"?P.LINEAR:P.NEAREST);else{const wi=r.layout.get("icon-size").constantOr(0)!==1||xe.iconsNeedLinear;ct=Ie.imageAtlasTexture,Pt=et||i.options.rotating||i.options.zooming||wi||Ve?P.LINEAR:P.NEAREST,gt=Ie.imageAtlasTexture.size}const en=xe.projection.name==="globe",on=en?Te:ye,rn=en?vo(R.zoom):0,cn=d5(we,xe.getProjection(),R),gn=R.calculatePixelsToTileUnitsMatrix(Ie),kn=d3(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn),ea=i.terrain&&U&&W?at.invert(at.create(),kn):J8,ba=WN(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn),$n=ie&&xe.hasTextData(),Un=xe.hasIconTextFit()&&$n&&xe.hasIconData();if(W){const wi=R.elevation,Oi=wi?wi.getAtTileOffsetFunc(we,R.center.lat,R.worldSize,xe.getProjection()):null,Ya=UN(cn,Ie.tileID.canonical,U,z,R,xe.getProjection(),gn);Zne(xe,cn,i,u,Ya,ba,U,b,Oi,we)}const In=W||u&&ie||Un,En=i.translatePosMatrix(cn,Ie,h,p),ha=In?J8:kn,Ma=i.translatePosMatrix(ba,Ie,h,p,!0),Qn=xe.getProjection().createInversionMatrix(R,we.canonical),Xa=r.paint.get("icon-image-cross-fade").constantOr(0),xi=[];i.terrainRenderModeElevated()&&U&&xi.push("PITCH_WITH_MAP_TERRAIN"),en&&(xi.push("PROJECTION_GLOBE_VIEW"),In&&xi.push("PROJECTED_POS_ON_VIEWPORT")),Xa>0&&xi.push("ICON_TRANSITION"),We.zOffsetVertexBuffer&&xi.push("Z_OFFSET");const oi=et&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ei;ei=et?xe.iconsInText?jie(Ne.kind,it,j,U,i,En,ha,Ma,gt,xt,we,rn,K,Qn,on,xe.getProjection()):X8(Ne.kind,it,j,U,i,En,ha,Ma,u,gt,!0,we,rn,K,Qn,on,xe.getProjection()):q8(Ne.kind,it,j,U,i,En,ha,Ma,u,gt,we,rn,K,Qn,on,xe.getProjection(),Xa);const rr={program:i.getOrCreateProgram(Kie(et,u,xe),{config:qe,defines:xi}),buffers:We,uniformValues:ei,atlasTexture:ct,atlasTextureIcon:Mt,atlasInterpolation:Pt,atlasInterpolationIcon:Ft,isSDF:et,hasHalo:oi,tile:Ie,labelPlaneMatrixInv:ea};if(Y&&xe.canOverlap){Z=!0;const wi=We.segments.get();for(const Oi of wi)he.push({segments:new ja([Oi]),sortKey:Oi.sortKey,state:rr})}else he.push({segments:We.segments,sortKey:0,state:rr})}Z&&he.sort((we,Ie)=>we.sortKey-Ie.sortKey);for(const we of he){const Ie=we.state;if(i.terrain&&i.terrain.setupElevationDraw(Ie.tile,Ie.program,{useDepthForOcclusion:!ce&&!R.isOrthographic,labelPlaneMatrixInv:Ie.labelPlaneMatrixInv}),C.activeTexture.set(P.TEXTURE0),Ie.atlasTexture.bind(Ie.atlasInterpolation,P.CLAMP_TO_EDGE),Ie.atlasTextureIcon&&(C.activeTexture.set(P.TEXTURE1),Ie.atlasTextureIcon&&Ie.atlasTextureIcon.bind(Ie.atlasInterpolationIcon,P.CLAMP_TO_EDGE)),i.uploadCommonLightUniforms(i.context,Ie.program),Ie.hasHalo){const xe=Ie.uniformValues;xe.u_is_halo=1,_5(Ie.buffers,we.segments,r,i,Ie.program,$,w,A,xe,2),xe.u_is_halo=0}else{if(Ie.isSDF){const xe=Ie.uniformValues;Ie.hasHalo&&(xe.u_is_halo=1,_5(Ie.buffers,we.segments,r,i,Ie.program,$,w,A,xe,1)),xe.u_is_halo=0}_5(Ie.buffers,we.segments,r,i,Ie.program,$,w,A,Ie.uniformValues,1)}}}function _5(i,t,r,l,u,h,p,g,v,b){const w=[i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer,i.iconTransitioningVertexBuffer,i.globeExtVertexBuffer,i.zOffsetVertexBuffer];u.draw(l,l.context.gl.TRIANGLES,h,p,g,la.disabled,v,r.id,i.layoutVertexBuffer,i.indexBuffer,t,r.paint,l.transform.zoom,i.programConfigurations.get(r.id),w,b)}function e9(i,t,r,l,u,h,p){const g=i.context.gl,v=r.paint.get("fill-pattern"),b=v&&v.constantOr(1);let w,A,C,P,R;p?(A=b&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=g.LINES):(A=b?"fillPattern":"fill",w=g.TRIANGLES);for(const z of l){const U=t.getTile(z);if(b&&!U.patternsLoaded())continue;const W=U.getBucket(r);if(!W)continue;i.prepareDrawTile();const j=W.programConfigurations.get(r.id),Y=i.isTileAffectedByFog(z),Z=i.getOrCreateProgram(A,{config:j,overrideFog:Y});b&&(i.context.activeTexture.set(g.TEXTURE0),U.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),j.updatePaintBuffers());const $=v.constantOr(null);if($&&U.imageAtlas){const ce=U.imageAtlas.patternPositions[$.toString()];ce&&j.setConstantPatternPositions(ce)}const K=i.translatePosMatrix(z.projMatrix,U,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),ie=r.paint.get("fill-emissive-strength");if(p){P=W.indexBuffer2,R=W.segments2;const ce=i.terrain&&i.terrain.renderingToTexture?i.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];C=A==="fillOutlinePattern"&&b?Bie(K,ie,i,U,ce):Nie(K,ie,ce)}else P=W.indexBuffer,R=W.segments,C=b?G8(K,ie,i,U):V8(K,ie);i.uploadCommonUniforms(i.context,Z,z.toUnwrapped()),Z.draw(i,w,u,i.stencilModeForClipping(z),h,la.disabled,C,r.id,W.layoutVertexBuffer,P,R,r.paint,i.transform.zoom,j,void 0)}}function L3(i,t,r,l,u,h,p,g){const v=i.context,b=v.gl,w=i.transform,A=r.paint.get("fill-extrusion-pattern"),C=A.constantOr(1),P=r.paint.get("fill-extrusion-opacity"),R=i.style.enable3dLights(),z=r.paint.get(R&&!C?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),U=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),z],W=r.layout.get("fill-extrusion-edge-radius"),j=W>0&&!r.paint.get("fill-extrusion-rounded-roof"),Y=j?0:W,Z=w.projection.name==="globe"?SB():0,$=w.projection.name==="globe",K=$?vo(w.zoom):0,ie=[_o(w.center.lng),Co(w.center.lat)],ce=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),he=r.paint.get("fill-extrusion-flood-light-intensity"),ye=r.paint.get("fill-extrusion-vertical-scale"),Te=vv(i,r.paint.get("fill-extrusion-cutoff-fade-range")),we=[];let Ie;$&&we.push("PROJECTION_GLOBE_VIEW"),U[0]>0&&we.push("FAUX_AO"),j&&we.push("ZERO_ROOF_RADIUS"),g&&we.push("HAS_CENTROID"),he>0&&we.push("FLOOD_LIGHT"),Te.shouldRenderCutoff&&we.push("RENDER_CUTOFF");const xe=i.renderPass==="shadow",We=i.shadowRenderer,qe=xe&&!!We;i.shadowRenderer&&(i.shadowRenderer.useNormalOffset=!0);let et=[0,0,0];if(We){const Ve=i.style.directionalLight,it=i.style.ambientLight;Ve&&it&&(et=w5(Ve,it)),Ie=we.concat(["SHADOWS_SINGLE_CASCADE"])}const Ne=qe?"fillExtrusionDepth":C?"fillExtrusionPattern":"fillExtrusion";for(const Ve of l){const it=t.getTile(Ve),gt=it.getBucket(r);if(!gt||gt.projection.name!==w.projection.name)continue;let ct=!1;We&&(ct=We.getMaxCascadeForTile(Ve.toUnwrapped())===0);const Pt=i.isTileAffectedByFog(Ve),Ft=gt.programConfigurations.get(r.id),xt=i.getOrCreateProgram(Ne,{config:Ft,defines:ct?Ie:we,overrideFog:Pt});if(i.terrain){const cn=i.terrain;i.style.terrainSetForDrapingOnly(),cn.setupElevationDraw(it,xt,{useMeterToDem:!0})}if(!gt.centroidVertexBuffer){const cn=xt.attributes.a_centroid_pos;cn!==void 0&&b.vertexAttrib2f(cn,0,0)}!xe&&We&&We.setupShadows(it.tileID.toUnwrapped(),xt,"vector-tile",it.tileID.overscaledZ),C&&(i.context.activeTexture.set(b.TEXTURE0),it.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),Ft.updatePaintBuffers());const Mt=A.constantOr(null);if(Mt&&it.imageAtlas){const cn=it.imageAtlas.patternPositions[Mt.toString()];cn&&Ft.setConstantPatternPositions(cn)}const en=r.paint.get("fill-extrusion-vertical-gradient");let on;if(xe&&We){if(nre(it.tileID,gt,i))continue;const cn=We.calculateShadowPassMatrixFromTile(it.tileID.toUnwrapped());on=zie(cn,Y,ye)}else{const cn=i.translatePosMatrix(Ve.projMatrix,it,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),gn=w.projection.createInversionMatrix(w,Ve.canonical);on=C?Fie(cn,i,en,P,U,Y,Ve,it,Z,K,ie,gn,ce,ye):W8(cn,i,en,P,U,Y,Ve,Z,K,ie,gn,ce,ye,he,et)}i.uploadCommonUniforms(v,xt,Ve.toUnwrapped(),null,Te);const rn=[];(i.terrain||g)&&rn.push(gt.centroidVertexBuffer),$&&rn.push(gt.layoutVertexExtBuffer),xt.draw(i,v.gl.TRIANGLES,u,h,p,la.backCCW,on,r.id,gt.layoutVertexBuffer,gt.indexBuffer,gt.segments,r.paint,i.transform.zoom,Ft,rn)}i.shadowRenderer&&(i.shadowRenderer.useNormalOffset=!1)}function bv(i,t,r,l,u,h,p,g,v,b,w,A,C,P,R,z,U,W,j){const Y=i.context,Z=Y.gl,$=i.transform,K=i.transform.zoom,ie=[],ce=vv(i,r.paint.get("fill-extrusion-cutoff-fade-range"));b==="clear"?(ie.push("CLEAR_SUBPASS"),j&&(ie.push("CLEAR_FROM_TEXTURE"),Y.activeTexture.set(Z.TEXTURE0),j.bind(Z.LINEAR,Z.CLAMP_TO_EDGE))):b==="sdf"&&ie.push("SDF_SUBPASS"),U&&ie.push("HAS_CENTROID"),ce.shouldRenderCutoff&&ie.push("RENDER_CUTOFF");const he=r.layout.get("fill-extrusion-edge-radius"),ye=(Te,we,Ie,xe,We)=>{const qe=we.programConfigurations.get(r.id),et=i.isTileAffectedByFog(Te),Ne=i.getOrCreateProgram("fillExtrusionGroundEffect",{config:qe,defines:ie,overrideFog:et}),Ve=((gt,ct,Pt,Ft,xt,Mt,en,on,rn,cn,gn)=>({u_matrix:ct,u_opacity:Pt,u_ao_pass:Ft?1:0,u_meter_to_tile:xt,u_ao:Mt,u_flood_light_intensity:en,u_flood_light_color:on,u_attenuation:rn,u_edge_radius:cn,u_fb:0,u_fb_size:gn}))(0,xe,w,v,We,[A,C*We],P,R,z,K>=17?0:he*We,j?j.size[0]:0),it=[];U&&it.push(we.hiddenByLandmarkVertexBuffer),i.uploadCommonUniforms(Y,Ne,Te.toUnwrapped(),null,ce),Ne.draw(i,Y.gl.TRIANGLES,u,h,p,g,Ve,r.id,we.vertexBuffer,we.indexBuffer,Ie,r.paint,K,qe,it)};for(const Te of l){const we=t.getTile(Te),Ie=we.getBucket(r);if(!Ie||Ie.projection.name!==$.projection.name||!Ie.groundEffect||Ie.groundEffect&&!Ie.groundEffect.hasData())continue;const xe=Ie.groundEffect,We=1/Ie.tileToMeter;{const qe=i.translatePosMatrix(Te.projMatrix,we,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),et=xe.getDefaultSegment();ye(Te,xe,et,qe,We)}if(W)for(let qe=0;qe<4;qe++){const et=Zz[qe](Te),Ne=t.getTile(et);if(!Ne)continue;const Ve=Ne.getBucket(r);if(!Ve||Ve.projection.name!==$.projection.name||!Ve.groundEffect||Ve.groundEffect&&!Ve.groundEffect.hasData())continue;const it=Ve.groundEffect;let gt,ct;qe===0?(gt=[-ht,0,0],ct=1):qe===1?(gt=[ht,0,0],ct=0):qe===2?(gt=[0,-ht,0],ct=3):(gt=[0,ht,0],ct=2);const Pt=it.regionSegments[ct];if(!Pt)continue;const Ft=new Float32Array(16);at.translate(Ft,Te.projMatrix,gt),ye(Te,it,Pt,i.translatePosMatrix(Ft,we,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),We)}}}function Jie(i,t,r,l,u,h,p){l.centroidVertexArray.length===0&&l.createCentroidsBuffer();const g=h?h.findDEMTileFor(r):null;if(!(g&&g.dem||p))return;const v=W=>{const j=t.getSource().minzoom,Y=$=>{const K=t.getTileByID($);if(K&&K.hasData())return K.getBucket(u)},Z=[0,-1,1];for(const $ of Z){if(W.overscaledZ+$<j)continue;const K=Y(W.calculateScaledKey(W.overscaledZ+$));if(K)return K}},b=[0,0,0],w=(W,j)=>(b[0]=Math.min(W.min.y,j.min.y),b[1]=Math.max(W.max.y,j.max.y),b[2]=ht-j.min.x>W.max.x?j.min.x-ht:W.max.x,b),A=(W,j)=>(b[0]=Math.min(W.min.x,j.min.x),b[1]=Math.max(W.max.x,j.max.x),b[2]=ht-j.min.y>W.max.y?j.min.y-ht:W.max.y,b),C=[(W,j)=>w(W,j),(W,j)=>w(j,W),(W,j)=>A(W,j),(W,j)=>A(j,W)],P=(W,j,Y,Z,$,K,ie)=>{if(!h)return 0;const ce=[[K?Y:W,K?W:Y,0],[K?Y:j,K?j:Y,0]],he=ie<0?ht+ie:ie,ye=[K?he:(W+j)/2,K?(W+j)/2:he,0];return Y===0&&ie<0||Y!==0&&ie>0?h.getForTilePoints($,[ye],!0,Z):ce.push(ye),h.getForTilePoints(r,ce,!0,g),Math.max(ce[0][2],ce[1][2],ye[2])/h.exaggeration()};for(let W=0;W<4;W++){const j=l.borderFeatureIndices[W];if(j.length===0)continue;const Y=Zz[W](r),Z=v(Y);if(!(Z&&Z instanceof E1)||l.borderDoneWithNeighborZ[W]===Z.canonical.z)continue;Z.centroidVertexArray.length===0&&Z.createCentroidsBuffer();const $=h?h.findDEMTileFor(Y):null;if(!($&&$.dem||p))continue;const K=(W<2?1:5)-W,ie=Z.borderDoneWithNeighborZ[K]!==l.canonical.z,ce=Z.borderFeatureIndices[K];let he=0;if(l.canonical.z!==Z.canonical.z){for(const ye of j)l.showCentroid(l.featuresOnBorder[ye]);if(ie)for(const ye of ce)Z.showCentroid(Z.featuresOnBorder[ye]);l.borderDoneWithNeighborZ[W]=Z.canonical.z,Z.borderDoneWithNeighborZ[K]=l.canonical.z}for(const ye of j){const Te=l.featuresOnBorder[ye],we=l.centroidData[Te.centroidDataIndex],Ie=Te.borders[W];let xe;for(;he<ce.length;){xe=Z.featuresOnBorder[ce[he]];const We=xe.borders[K];if(We[1]>Ie[0]+3||We[0]>Ie[0]-3)break;Z.showCentroid(xe),he++}if(xe&&he<ce.length){const We=he;let qe=0;for(;!(xe.borders[K][0]>Ie[1]-3)&&(qe++,++he!==ce.length);)xe=Z.featuresOnBorder[ce[he]];if(xe=Z.featuresOnBorder[ce[We]],qe>1){const Ve=xe.borders[K];Math.abs(Ie[0]-Ve[0])<3&&Math.abs(Ie[1]-Ve[1])<3&&(qe=1,he=We+1)}else if(qe===0){l.showCentroid(Te);continue}const et=Z.centroidData[xe.centroidDataIndex];p&&qe===1&&(((z=we).flags|(U=et).flags)&qu?(z.flags|=qu,U.flags|=qu):(z.flags&=2147483647,U.flags&=2147483647));let Ne=new V(0,0);if(qe>1)he=We;else if($&&$.dem&&!(Te.intersectsCount()>1||xe.intersectsCount()>1)){const Ve=C[W](we,et),it=W%2?ht-1:0;R=P(Ve[0],Math.min(ht-1,Ve[1]),it,$,Y,W<2,Ve[2]),Ne=new V(Math.ceil(7*(R+450)),0)}we.centroidXY=et.centroidXY=Ne,l.writeCentroidToBuffer(we),Z.writeCentroidToBuffer(et)}else l.showCentroid(Te)}l.borderDoneWithNeighborZ[W]=Z.canonical.z,Z.borderDoneWithNeighborZ[K]=l.canonical.z}var R,z,U;(l.needsCentroidUpdate||!l.centroidVertexBuffer&&l.centroidVertexArray.length!==0)&&l.uploadCentroid(i)}const Qie=[1,0,0],ere=[0,1,0],tre=[0,0,1];function nre(i,t,r){const l=r.transform,u=r.shadowRenderer;if(!u)return!0;const h=i.toUnwrapped(),p=l.tileSize*u._cascades[r.currentShadowCascade].scale;let g=t.maxHeight;if(l.elevation){const z=l.elevation.getMinMaxForTile(i);z&&(g+=z.max)}const v=[...u.shadowDirection];v[2]=-v[2];const b=u.computeSimplifiedTileShadowVolume(h,g,p,v);if(!b)return!1;const w=[Qie,ere,tre,v,[v[0],0,v[2]],[0,v[1],v[2]]],A=l.projection.name==="globe",C=l.scaleZoom(p),P=Jd.fromInvProjectionMatrix(l.invProjMatrix,l.worldSize,C,!A),R=u.getCurrentCascadeFrustum();return P.intersectsPrecise(b.vertices,b.planes,w)===0||R.intersectsPrecise(b.vertices,b.planes,w)===0}const are=new xn(1,0,0,1),ire=new xn(0,1,0,1),rre=new xn(0,0,1,1),ore=new xn(1,0,1,1),sre=new xn(0,1,1,1);function lre(i,t,r){const l=i.context,u=i.transform,h=l.gl,p=u.projection.name==="globe",g=p?["PROJECTION_GLOBE_VIEW"]:[];let v=r.projMatrix;if(p&&vo(u.zoom)>0){const ye=QC(tF(r.canonical,u));v=at.multiply(new Float32Array(16),u.globeMatrix,ye),at.multiply(v,u.projMatrix,v)}const b=i.getOrCreateProgram("debug",{defines:g}),w=t.getTileByID(r.key);i.terrain&&i.terrain.setupElevationDraw(w,b);const A=zn.disabled,C=oa.disabled,P=i.colorModeForRenderPass(),R="$debug";l.activeTexture.set(h.TEXTURE0),i.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),p?w._makeGlobeTileDebugBuffers(i.context,u):w._makeDebugTileBoundsBuffers(i.context,u.projection);const z=w._tileDebugBuffer||i.debugBuffer,U=w._tileDebugIndexBuffer||i.debugIndexBuffer,W=w._tileDebugSegments||i.debugSegments;b.draw(i,h.LINE_STRIP,A,C,P,la.disabled,H8(v,xn.red),R,z,U,W,null,null,null,[w._globeTileDebugBorderBuffer]);const j=w.latestRawTileData,Y=Math.floor((j&&j.byteLength||0)/1024),Z=t.getTile(r).tileSize,$=512/Math.min(Z,512)*(r.overscaledZ/u.zoom)*.5;let K=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(K+=` => ${r.overscaledZ}`),K+=` ${Y}kb`,function(ye,Te){ye.initDebugOverlayCanvas();const we=ye.debugOverlayCanvas,Ie=ye.context.gl,xe=ye.debugOverlayCanvas.getContext("2d");xe.clearRect(0,0,we.width,we.height),xe.shadowColor="white",xe.shadowBlur=2,xe.lineWidth=1.5,xe.strokeStyle="white",xe.textBaseline="top",xe.font="bold 36px Open Sans, sans-serif",xe.fillText(Te,5,5),xe.strokeText(Te,5,5),ye.debugOverlayTexture.update(we),ye.debugOverlayTexture.bind(Ie.LINEAR,Ie.CLAMP_TO_EDGE)}(i,K);const ie=w._tileDebugTextBuffer||i.debugBuffer,ce=w._tileDebugTextIndexBuffer||i.quadTriangleIndexBuffer,he=w._tileDebugTextSegments||i.debugSegments;b.draw(i,h.TRIANGLES,A,C,Ea.alphaBlended,la.disabled,H8(v,xn.transparent,$),R,ie,ce,he,null,null,null,[w._globeTileDebugTextBuffer])}function t9(i,t,r,l){R3(i,0,t+r/2,i.transform.width,r,l)}function n9(i,t,r,l){R3(i,t-r/2,0,r,i.transform.height,l)}function R3(i,t,r,l,u,h){const p=i.context,g=p.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Cn.devicePixelRatio,r*Cn.devicePixelRatio,l*Cn.devicePixelRatio,u*Cn.devicePixelRatio),p.clear({color:h}),g.disable(g.SCISSOR_TEST)}const cre=N([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ure}=cre;function If(i,t,r,l){i.emplaceBack(t,r,l)}class a9{constructor(t){this.vertexArray=new Dn,this.indices=new Nn,If(this.vertexArray,-1,-1,1),If(this.vertexArray,1,-1,1),If(this.vertexArray,-1,1,1),If(this.vertexArray,1,1,1),If(this.vertexArray,-1,-1,-1),If(this.vertexArray,1,-1,-1),If(this.vertexArray,-1,1,-1),If(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,ure),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=ja.simpleSegment(0,0,36,12)}}function xv(i,t,r,l,u,h){const p=i.context.gl,g=t.paint.get("sky-atmosphere-color"),v=t.paint.get("sky-atmosphere-halo-color"),b=t.paint.get("sky-atmosphere-sun-intensity"),w=((A,C,P,R,z)=>({u_matrix_3f:A,u_sun_direction:C,u_sun_intensity:P,u_color_tint_r:[R.r,R.g,R.b,R.a],u_color_tint_m:[z.r,z.g,z.b,z.a],u_luminance:5e-5}))(zs.fromMat4(zs.create(),l),u,b,g,v);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+h,t.skyboxTexture,0),r.draw(i,p.TRIANGLES,zn.disabled,oa.disabled,Ea.unblended,la.frontCW,w,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const dre=N([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class hre{constructor(t){const r=new Ua;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const l=new Nn;l.emplaceBack(0,1,2),l.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,dre.members),this.indexBuffer=t.createIndexBuffer(l),this.segments=ja.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const fre=N([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class pre{constructor(){this.colorModeAlphaBlendedWriteRGB=new Ea([1,c3,1,c3],xn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ea([1,0,1,0],xn.transparent,[!1,!1,!1,!0])}update(t){const r=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new hre(r);const l=100,u=200,h=function(w){const A=xy(30),C=[];for(let P=0;P<16e3;++P){const R=2*Math.PI*A(),z=Math.acos(1-2*A())-.5*Math.PI;C.push(ke.fromValues(Math.cos(z)*Math.cos(R),Math.cos(z)*Math.sin(R),Math.sin(z)))}return C}(),p=xy(300),g=new uc,v=new Nn;let b=0;for(let w=0;w<h.length;++w){const A=ke.scale([],h[w],200),C=Math.max(0,1+.01*l*(1*p()-.5)),P=Math.max(0,1+.01*u*(1*p()-.5));g.emplaceBack(A[0],A[1],A[2],-1,-1,C,P),g.emplaceBack(A[0],A[1],A[2],1,-1,C,P),g.emplaceBack(A[0],A[1],A[2],1,1,C,P),g.emplaceBack(A[0],A[1],A[2],-1,1,C,P),v.emplaceBack(b+0,b+1,b+2),v.emplaceBack(b+0,b+2,b+3),b+=4}this.starsVx=r.createVertexBuffer(g,fre.members),this.starsIdx=r.createIndexBuffer(v),this.starsSegments=ja.simpleSegment(0,0,g.length,v.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,r){const l=t.context,u=l.gl,h=t.transform,p=new zn(u.LEQUAL,zn.ReadOnly,[0,1]),g=vo(h.zoom),v=r.properties.get("color").toArray01(),b=r.properties.get("high-color").toArray01(),w=r.properties.get("space-color").toArray01PremultipliedAlpha(),A=5e-4,C=ae((r.properties.get("horizon-blend")-0)/1*.2495+A,5e-4,.25),P=sF(t,l,h)&&C===A?h.worldSize/(2*Math.PI*1.025)-1:h.globeRadius,R=t.frameCounter/1e3%1,z=ke.length(h.globeCenterInViewSpace),U=Math.sqrt(Math.pow(z,2)-Math.pow(P,2)),W=Math.acos(U/z),j=Y=>{const Z=h.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Y&&Z.push("ALPHA_PASS");const $=t.getOrCreateProgram("globeAtmosphere",{defines:Z}),K=((ce,he,ye,Te,we,Ie,xe,We,qe,et,Ne,Ve)=>({u_frustum_tl:ce,u_frustum_tr:he,u_frustum_br:ye,u_frustum_bl:Te,u_horizon:we,u_transition:Ie,u_fadeout_range:xe,u_color:We,u_high_color:qe,u_space_color:et,u_temporal_offset:Ne,u_horizon_angle:Ve}))(h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.frustumCorners.horizon,g,C,v,b,w,R,W);t.uploadCommonUniforms(l,$);const ie=this.atmosphereBuffer;ie&&$.draw(t,u.TRIANGLES,p,oa.disabled,Y?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,la.backCW,K,Y?"atmosphere_glow_alpha":"atmosphere_glow",ie.vertexBuffer,ie.indexBuffer,ie.segments)};j(!1),j(!0)}drawStars(t,r){const l=ae(r.properties.get("star-intensity"),0,1);if(l===0)return;const u=t.context,h=u.gl,p=t.transform,g=t.getOrCreateProgram("stars"),v=To.identity([]);To.rotateX(v,v,-p._pitch),To.rotateZ(v,v,-p.angle),To.rotateX(v,v,be(p._center.lat)),To.rotateY(v,v,-be(p._center.lng));const b=at.fromQuat(new Float32Array(16),v),w=at.multiply([],p.starsProjMatrix,b),A=zs.fromMat4([],b),C=zs.invert([],A),P=[0,1,0];ke.transformMat3(P,P,C),ke.scale(P,P,.15);const R=[1,0,0];ke.transformMat3(R,R,C),ke.scale(R,R,.15);const z=((U,W,j,Y)=>({u_matrix:Float32Array.from(U),u_up:W,u_right:j,u_intensity_multiplier:Y}))(w,P,R,l);t.uploadCommonUniforms(u,g),this.starsVx&&this.starsIdx&&g.draw(t,h.TRIANGLES,zn.disabled,oa.disabled,this.colorModeAlphaBlendedWriteRGB,la.disabled,z,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function i9(i,t){const r=[...i],l=t.cameraWorldSizeForFog/t.worldSize,u=at.identity([]);return at.scale(u,u,[l,l,1]),at.multiply(r,u,r),at.multiply(r,t.worldToFogMatrix,r),r}function b5(i,t,r,l){const u=r.material,h=l.context,{baseColorTexture:p,metallicRoughnessTexture:g}=u.pbrMetallicRoughness,{normalTexture:v,occlusionTexture:b,emissionTexture:w}=u;function A(C,P,R){if(C&&(i.push(P),h.activeTexture.set(h.gl.TEXTURE0+R),C.gfxTexture)){const{minFilter:z,magFilter:U,wrapS:W,wrapT:j}=C.sampler;C.gfxTexture.bindExtraParam(z,U,W,j)}}A(p,"HAS_TEXTURE_u_baseColorTexture",sl.BaseColor),A(g,"HAS_TEXTURE_u_metallicRoughnessTexture",sl.MetallicRoughness),A(v,"HAS_TEXTURE_u_normalTexture",sl.Normal),A(b,"HAS_TEXTURE_u_occlusionTexture",sl.Occlusion),A(w,"HAS_TEXTURE_u_emissionTexture",sl.Emission),r.texcoordBuffer&&(i.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(r.texcoordBuffer)),r.colorBuffer&&(i.push(r.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(r.colorBuffer)),r.normalBuffer&&(i.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(r.normalBuffer)),r.pbrBuffer&&(i.push("HAS_ATTRIBUTE_a_pbr"),i.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(r.pbrBuffer)),u.alphaMode!=="OPAQUE"&&u.alphaMode!=="MASK"||i.push("UNPREMULT_TEXTURE_IN_SHADER"),u.defined||i.push("DIFFUSE_SHADED"),i.push("USE_STANDARD_DERIVATIVES")}function k3(i,t,r,l,u,h){const p=r.paint.get("model-opacity"),g=t.context,v=new zn(t.context.gl.LEQUAL,zn.ReadWrite,t.depthRangeFor3D),b=t.transform,w=i.mesh,A=w.material,C=A.pbrMetallicRoughness,P=t.style.fog;let R;R=t.transform.projection.zAxisUnit==="pixels"?[...i.nodeModelMatrix]:at.multiply([],l.zScaleMatrix,i.nodeModelMatrix),at.multiply(R,l.negCameraPosMatrix,R);const z=at.invert([],R);at.transpose(z,z);const U=v5(new Float32Array(i.worldViewProjection),new Float32Array(R),new Float32Array(z),t,p,C.baseColorFactor,A.emissiveFactor,C.metallicFactor,C.roughnessFactor,A,r),W={defines:[]},j=[];b5(W.defines,j,w,t);const Y=t.shadowRenderer;Y&&(Y.useNormalOffset=!1);let Z=null;if(P){const ie=i9(i.nodeModelMatrix,t.transform);if(Z=new Float32Array(ie),b.projection.name!=="globe"){const ce=w.aabb.min,he=w.aabb.max,[ye,Te]=P.getOpacityForBounds(ie,ce[0],ce[1],he[0],he[1]);W.overrideFog=ye>=Em||Te>=Em}}const $=vv(t,r.paint.get("model-cutoff-fade-range"));$.shouldRenderCutoff&&W.defines.push("RENDER_CUTOFF");const K=t.getOrCreateProgram("model",W);t.uploadCommonUniforms(g,K,null,Z,$),t.renderPass!=="shadow"&&Y&&Y.setupShadowsFromMatrix(i.nodeModelMatrix,K),K.draw(t,g.gl.TRIANGLES,v,u,h,w.material.doubleSided?la.disabled:la.backCCW,U,r.id,w.vertexBuffer,w.indexBuffer,w.segments,r.paint,t.transform.zoom,void 0,j)}function r9(i,t,r,l,u,h,p){let g;g=i.projection.name==="globe"?JN(r,i):[...r],at.multiply(g,g,t.matrix);const v=at.multiply([],l,g);if(t.meshes)for(const b of t.meshes){if(b.material.alphaMode!=="BLEND"){p.push({mesh:b,depth:0,modelIndex:u,worldViewProjection:v,nodeModelMatrix:g});continue}const w=ke.transformMat4([],b.centroid,v);w[2]>0&&h.push({mesh:b,depth:w[2],modelIndex:u,worldViewProjection:v,nodeModelMatrix:g})}if(t.children)for(const b of t.children)r9(i,b,r,l,u,h,p)}function x5(i,t,r,l){const u=r.shadowRenderer;if(!u)return;const h=u.getShadowPassDepthMode(),p=u.getShadowPassColorMode(),g=u.calculateShadowPassMatrixFromMatrix(t),v=Z8(g);r.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(r,r.context.gl.TRIANGLES,h,oa.disabled,p,la.backCCW,v,l.id,i.vertexBuffer,i.indexBuffer,i.segments,l.paint,r.transform.zoom,void 0,void 0)}function mre(i,t,r){const l=t.updateZoomBasedPaintProperties(),u=function(h,p,g){let v,b,w,A=h.terrain?h.terrain.exaggeration():0;if(h.terrain&&A>0){const C=h.terrain,P=C.findDEMTileFor(g);P&&P.dem?v=sv.create(C,g,P):A=0}if(A===0&&(p.terrainElevationMin=0,p.terrainElevationMax=0),A===p.validForExaggeration&&(A===0||v&&v._demTile&&v._demTile.tileID===p.validForDEMTile.id&&v._dem._timestamp===p.validForDEMTile.timestamp))return!1;for(const C in p.instancesPerModel){const P=p.instancesPerModel[C];for(let R=0;R<P.instancedDataArray.length;++R){const z=(v?A*v.getElevationAt(0|P.instancedDataArray.float32[16*R],0|P.instancedDataArray.float32[16*R+1],!0,!0):0)+P.instancesEvaluatedElevation[R];P.instancedDataArray.float32[16*R+6]=z,b=b?Math.min(p.terrainElevationMin,z):z,w=w?Math.max(p.terrainElevationMax,z):z}}return p.terrainElevationMin=b||0,p.terrainElevationMax=w||0,p.validForExaggeration=A,p.validForDEMTile=v&&v._demTile?{id:v._demTile.tileID,timestamp:v._dem._timestamp}:{id:void 0,timestamp:0},!0}(i,t,r);(l||u)&&(t.uploaded=!1,t.upload(i.context))}const Zu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new hi([0,0,0],[ht,ht,0])};function gre(i,t){const r=1<<i.canonical.z,l=t.getFreeCameraOptions().position,u=t.elevation,h=i.canonical.x/r,p=(i.canonical.x+1)/r,g=i.canonical.y/r,v=(i.canonical.y+1)/r;let b=t._centerAltitude;if(u){const P=u.getMinMaxForTile(i);P&&P.max>b&&(b=P.max)}const w=ae(l.x,h,p)-l.x,A=ae(l.y,g,v)-l.y,C=$a(b,t.center.lat)-l.z;return t._zoomFromMercatorZ(Math.sqrt(w*w+A*A+C*C))}function o9(i,t,r,l,u,h,p){const g=i.context,v=i.renderPass==="shadow",b=i.shadowRenderer,w=v&&b?b.getShadowPassDepthMode():new zn(g.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D),A=i.isTileAffectedByFog(h);if(r.meshes)for(const C of r.meshes){const P=["MODEL_POSITION_ON_GPU"],R=[];let z,U,W;l.instancedDataArray.length>20&&P.push("INSTANCED_ARRAYS");const j=vv(i,t.paint.get("model-cutoff-fade-range"));if(j.shouldRenderCutoff&&P.push("RENDER_CUTOFF"),v&&b)z=i.getOrCreateProgram("modelDepth",{defines:P}),U=Z8(p.shadowTileMatrix,p.shadowTileMatrix,Float32Array.from(r.matrix)),W=b.getShadowPassColorMode();else{b5(P,R,C,i),z=i.getOrCreateProgram("model",{defines:P,overrideFog:A});const Z=C.material,$=Z.pbrMetallicRoughness,K=t.paint.get("model-opacity");U=v5(h.projMatrix,Float32Array.from(r.matrix),new Float32Array(16),i,K,$.baseColorFactor,Z.emissiveFactor,$.metallicFactor,$.roughnessFactor,Z,t,u),b&&(p.shadowUniformsInitialized?z.setShadowUniformValues(g,b.getShadowUniformValues()):(b.setupShadows(h.toUnwrapped(),z,"model-tile",h.overscaledZ),p.shadowUniformsInitialized=!0)),W=j.shouldRenderCutoff||K<1||Z.alphaMode!=="OPAQUE"?Ea.alphaBlended:Ea.unblended}i.uploadCommonUniforms(g,z,h.toUnwrapped(),null,j);const Y=C.material.doubleSided?la.disabled:la.backCCW;if(l.instancedDataArray.length>20)R.push(l.instancedDataBuffer),z.draw(i,g.gl.TRIANGLES,w,oa.disabled,W,Y,U,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,i.transform.zoom,void 0,R,l.instancedDataArray.length);else{const Z=v?"u_instance":"u_normal_matrix";for(let $=0;$<l.instancedDataArray.length;++$)U[Z]=new Float32Array(l.instancedDataArray.arrayBuffer,64*$,16),z.draw(i,g.gl.TRIANGLES,w,oa.disabled,W,Y,U,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,i.transform.zoom,void 0,R)}}if(r.children)for(const C of r.children)o9(i,t,C,l,u,h,p)}const yre=[1,-1,1];function vre(i,t,r,l){if(!r.modelManager)return!0;const u=r.modelManager;if(!r.shadowRenderer)return!0;const h=r.shadowRenderer,p=t.aabb;let g=!0,v=i.maxHeight;if(v===0){let w=0;for(const A in i.instancesPerModel){const C=u.getModel(A,l);C?w=Math.max(w,Math.max(Math.max(C.aabb.max[0],C.aabb.max[1]),C.aabb.max[2])):g=!1}v=i.maxScale*w*1.41+i.maxVerticalOffset,g&&(i.maxHeight=v)}p.max[2]=v,p.min[2]+=i.terrainElevationMin,p.max[2]+=i.terrainElevationMax,ke.transformMat4(p.min,p.min,t.tileMatrix),ke.transformMat4(p.max,p.max,t.tileMatrix);const b=p.intersects(h.getCurrentCascadeFrustum());return r.currentShadowCascade===0&&(i.isInsideFirstShadowMapFrustum=b===2),b===0}class _re{}class bre{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,r,l){{const A=this._storage.get(r.id);if(A)return A.lastUsedFrameIdx=t,A.buf}const u=l.gl,h=u.getBufferParameter(u.ELEMENT_ARRAY_BUFFER,u.BUFFER_SIZE),p=new ArrayBuffer(h),g=new Int16Array(p);u.getBufferSubData(u.ELEMENT_ARRAY_BUFFER,0,new Int16Array(p));const v=new to;for(let A=0;A<h/2;A+=3){const C=g[A],P=g[A+1],R=g[A+2];v.emplaceBack(C,P),v.emplaceBack(P,R),v.emplaceBack(R,C)}const b=l.bindVertexArrayOES.current,w=new _re;return w.buf=new Tf(l,v),w.lastUsedFrameIdx=t,this._storage.set(r.id,w),l.bindVertexArrayOES.set(b),w.buf}update(t){for(const[r,l]of this._storage)t-l.lastUsedFrameIdx>30&&(l.buf.destroy(),this._storage.delete(r))}destroy(){for(const[t,r]of this._storage)r.buf.destroy(),this._storage.delete(t)}}const s9={symbol:function(i,t,r,l,u){if(i.renderPass!=="translucent")return;const h=oa.disabled,p=i.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(g,v,b,w,A,C,P){const R=v.transform,z=A==="map",U=C==="map";for(const W of g){const j=w.getTile(W),Y=j.getBucket(b);if(!Y||!Y.text||!Y.text.segments.get().length)continue;const Z=Hu(Y.textSizeData,R.zoom),$=d5(W,Y.getProjection(),R),K=R.calculatePixelsToTileUnitsMatrix(j),ie=d3($,j.tileID.canonical,U,z,R,Y.getProjection(),K),ce=Y.hasIconTextFit()&&Y.hasIconData();if(Z){const he=Math.pow(2,R.zoom-j.tileID.overscaledZ);Zie(Y,z,U,P,_te,R,ie,W,he,Z,ce)}}}(l,i,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),u),r.paint.get("icon-opacity").constantOr(1)!==0&&Q8(i,t,r,l,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),h,p),r.paint.get("text-opacity").constantOr(1)!==0&&Q8(i,t,r,l,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),h,p),t.map.showCollisionBoxes&&(K8(i,t,r,l,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),K8(i,t,r,l,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(i,t,r,l){if(i.renderPass!=="translucent")return;const u=r.paint.get("circle-opacity"),h=r.paint.get("circle-stroke-width"),p=r.paint.get("circle-stroke-opacity"),g=r.layout.get("circle-sort-key").constantOr(1)!==void 0,v=r.paint.get("circle-emissive-strength");if(u.constantOr(1)===0&&(h.constantOr(1)===0||p.constantOr(1)===0))return;const b=i.context,w=b.gl,A=i.transform,C=i.depthModeForSublayer(0,zn.ReadOnly),P=oa.disabled,R=i.colorModeForDrapableLayerRenderPass(v),z=A.projection.name==="globe",U=[_o(A.center.lng),Co(A.center.lat)],W=[];for(let Y=0;Y<l.length;Y++){const Z=l[Y],$=t.getTile(Z),K=$.getBucket(r);if(!K||K.projection.name!==A.projection.name)continue;const ie=K.programConfigurations.get(r.id),ce=wF(r),he=i.isTileAffectedByFog(Z);z&&ce.push("PROJECTION_GLOBE_VIEW");const ye=i.getOrCreateProgram("circle",{config:ie,defines:ce,overrideFog:he}),Te=K.layoutVertexBuffer,we=K.globeExtVertexBuffer,Ie=K.indexBuffer,xe=A.projection.createInversionMatrix(A,Z.canonical),We={programConfiguration:ie,program:ye,layoutVertexBuffer:Te,globeExtVertexBuffer:we,indexBuffer:Ie,uniformValues:gee(i,Z,$,xe,U,r),tile:$};if(g){const qe=K.segments.get();for(const et of qe)W.push({segments:new ja([et]),sortKey:et.sortKey,state:We})}else W.push({segments:K.segments,sortKey:0,state:We})}g&&W.sort((Y,Z)=>Y.sortKey-Z.sortKey);const j={useDepthForOcclusion:!z};for(const Y of W){const{programConfiguration:Z,program:$,layoutVertexBuffer:K,globeExtVertexBuffer:ie,indexBuffer:ce,uniformValues:he,tile:ye}=Y.state,Te=Y.segments;i.terrain&&i.terrain.setupElevationDraw(ye,$,j),i.uploadCommonUniforms(b,$,ye.tileID.toUnwrapped()),$.draw(i,w.TRIANGLES,C,P,R,la.disabled,he,r.id,K,ce,Te,r.paint,A.zoom,Z,[ie])}},heatmap:function(i,t,r,l){if(r.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){const u=i.context,h=u.gl,p=oa.disabled,g=new Ea([h.ONE,h.ONE,h.ONE,h.ONE],xn.transparent,[!0,!0,!0,!0]);(function(P,R,z,U){const W=P.gl,j=R.width*U,Y=R.height*U;P.activeTexture.set(W.TEXTURE1),P.viewport.set([0,0,j,Y]);let Z=z.heatmapFbo;if(!Z||Z&&(Z.width!==j||Z.height!==Y)){Z&&Z.destroy();const $=W.createTexture();W.bindTexture(W.TEXTURE_2D,$),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),Z=z.heatmapFbo=P.createFramebuffer(j,Y,!0,null),function(K,ie,ce,he,ye,Te){const we=K.gl;we.texImage2D(we.TEXTURE_2D,0,K.extRenderToTextureHalfFloat?we.RGBA16F:we.RGBA,ye,Te,0,we.RGBA,K.extRenderToTextureHalfFloat?we.HALF_FLOAT:we.UNSIGNED_BYTE,null),he.colorAttachment.set(ce)}(P,0,$,Z,j,Y)}else W.bindTexture(W.TEXTURE_2D,Z.colorAttachment.get()),P.bindFramebuffer.set(Z.framebuffer)})(u,i,r,i.transform.projection.name==="globe"?.5:.25),u.clear({color:xn.transparent});const v=i.transform,b=v.projection.name==="globe",w=b?["PROJECTION_GLOBE_VIEW"]:[],A=b?la.frontCCW:la.disabled,C=[_o(v.center.lng),Co(v.center.lat)];for(let P=0;P<l.length;P++){const R=l[P];if(t.hasRenderableParent(R))continue;const z=t.getTile(R),U=z.getBucket(r);if(!U||U.projection.name!==v.projection.name)continue;const W=i.isTileAffectedByFog(R),j=U.programConfigurations.get(r.id),Y=i.getOrCreateProgram("heatmap",{config:j,defines:w,overrideFog:W}),{zoom:Z}=i.transform;i.terrain&&i.terrain.setupElevationDraw(z,Y),i.uploadCommonUniforms(u,Y,R.toUnwrapped());const $=v.projection.createInversionMatrix(v,R.canonical);Y.draw(i,h.TRIANGLES,zn.disabled,p,g,A,Vie(i,R,z,$,C,Z,r.paint.get("heatmap-intensity")),r.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,r.paint,i.transform.zoom,j,b?[U.globeExtVertexBuffer]:null)}u.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),function(u,h){const p=u.context,g=p.gl,v=h.heatmapFbo;if(!v)return;p.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,v.colorAttachment.get()),p.activeTexture.set(g.TEXTURE1);let b=h.colorRampTexture;b||(b=h.colorRampTexture=new yr(p,h.colorRamp,g.RGBA)),b.bind(g.LINEAR,g.CLAMP_TO_EDGE),u.getOrCreateProgram("heatmapTexture").draw(u,g.TRIANGLES,zn.disabled,oa.disabled,u.colorModeForRenderPass(),la.disabled,((w,A,C,P)=>({u_image:0,u_color_ramp:1,u_opacity:A.paint.get("heatmap-opacity")}))(0,h),h.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments,h.paint,u.transform.zoom)}(i,r))},line:function(i,t,r,l){if(i.renderPass!=="translucent")return;const u=r.paint.get("line-opacity"),h=r.paint.get("line-width");if(u.constantOr(1)===0||h.constantOr(1)===0)return;const p=r.paint.get("line-emissive-strength"),g=i.depthModeForSublayer(0,zn.ReadOnly),v=i.colorModeForDrapableLayerRenderPass(p),b=i.terrain&&i.terrain.renderingToTexture?1:Cn.devicePixelRatio,w=r.paint.get("line-dasharray"),A=w.constantOr(1),C=r.layout.get("line-cap"),P=r.paint.get("line-pattern"),R=P.constantOr(1),z=r.paint.get("line-pattern").constantOr(1),U=r.paint.get("line-opacity").constantOr(1)!==1;let W=!z&&U;const j=r.paint.get("line-gradient"),Y=R?"linePattern":"line",Z=i.context,$=Z.gl,K=IB(r);i.terrain&&i.terrain.clipOrMaskOverlapStencilType()&&(W=!1);for(const ie of l){const ce=t.getTile(ie);if(R&&!ce.patternsLoaded())continue;const he=ce.getBucket(r);if(!he)continue;i.prepareDrawTile();const ye=he.programConfigurations.get(r.id),Te=i.isTileAffectedByFog(ie),we=i.getOrCreateProgram(Y,{config:ye,defines:K,overrideFog:Te}),Ie=P.constantOr(null);if(Ie&&ce.imageAtlas){const gt=ce.imageAtlas.patternPositions[Ie.toString()];gt&&ye.setConstantPatternPositions(gt)}const xe=w.constantOr(null),We=C.constantOr(null);if(!R&&xe&&We&&ce.lineAtlas){const gt=ce.lineAtlas.getDash(xe,We);gt&&ye.setConstantPatternPositions(gt)}let[qe,et]=r.paint.get("line-trim-offset");(We==="round"||We==="square")&&qe!==et&&(qe===0&&(qe-=1),et===1&&(et+=1));const Ne=i.terrain?ie.projMatrix:null,Ve=R?vae(i,ce,r,Ne,b):yae(i,ce,r,Ne,he.lineClipsArray.length,b,[qe,et]);if(j){const gt=he.gradients[r.id];let ct=gt.texture;if(r.gradientVersion!==gt.version){let Pt=256;if(r.stepInterpolant){const Ft=t.getSource().maxzoom,xt=ie.canonical.z===Ft?Math.ceil(1<<i.transform.maxZoom-ie.canonical.z):1;Pt=ae(It(he.maxLineLength/ht*1024*xt),256,Z.maxTextureSize)}gt.gradient=R2({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:Pt,image:gt.gradient||void 0,clips:he.lineClipsArray}),gt.texture?gt.texture.update(gt.gradient):gt.texture=new yr(Z,gt.gradient,$.RGBA),gt.version=r.gradientVersion,ct=gt.texture}Z.activeTexture.set($.TEXTURE1),ct.bind(r.stepInterpolant?$.NEAREST:$.LINEAR,$.CLAMP_TO_EDGE)}A&&(Z.activeTexture.set($.TEXTURE0),ce.lineAtlasTexture.bind($.LINEAR,$.REPEAT),ye.updatePaintBuffers()),R&&(Z.activeTexture.set($.TEXTURE0),ce.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ye.updatePaintBuffers()),i.uploadCommonUniforms(Z,we,ie.toUnwrapped());const it=gt=>{we.draw(i,$.TRIANGLES,g,gt,v,la.disabled,Ve,r.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,r.paint,i.transform.zoom,ye,[he.layoutVertexBuffer2])};if(W){const gt=i.stencilModeForClipping(ie).ref;gt===0&&i.terrain&&Z.clear({stencil:0});const ct={func:$.EQUAL,mask:255};Ve.u_alpha_discard_threshold=.8,it(new oa(ct,gt,255,$.KEEP,$.KEEP,$.INVERT)),Ve.u_alpha_discard_threshold=0,it(new oa(ct,gt,255,$.KEEP,$.KEEP,$.KEEP))}else it(i.stencilModeForClipping(ie))}W&&(i.resetStencilClippingMasks(),i.terrain&&Z.clear({stencil:0}))},fill:function(i,t,r,l){const u=r.paint.get("fill-color"),h=r.paint.get("fill-opacity");if(h.constantOr(1)===0)return;const p=r.paint.get("fill-emissive-strength"),g=i.colorModeForDrapableLayerRenderPass(p),v=r.paint.get("fill-pattern"),b=i.opaquePassEnabledForLayer()&&!v.constantOr(1)&&u.constantOr(xn.transparent).a===1&&h.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===b){const w=i.depthModeForSublayer(1,i.renderPass==="opaque"?zn.ReadWrite:zn.ReadOnly);e9(i,t,r,l,w,g,!1)}if(i.renderPass==="translucent"&&r.paint.get("fill-antialias")){const w=i.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,zn.ReadOnly);e9(i,t,r,l,w,g,!0)}},"fill-extrusion":function(i,t,r,l){const u=r.paint.get("fill-extrusion-opacity"),h=i.context,p=h.gl,g=i.terrain,v=g&&g.renderingToTexture,b=r.paint.get("fill-extrusion-cutoff-fade-range");if(u===0)return;const w=i.conflationActive&&i.layerUsedInConflation(r,t.getSource());if(w&&function(A,C,P,R){for(const z of R){const U=C.getTile(z).getBucket(P);U&&(U.updateReplacement(z,A.replacementSource),U.uploadCentroid(A.context))}}(i,t,r,l),g||w)for(const A of l){const C=t.getTile(A).getBucket(r);C&&Jie(i.context,t,A,C,r,g,w)}if(i.renderPass==="shadow"&&i.shadowRenderer){const A=i.shadowRenderer;if(g&&u<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof zc)return;const C=A.getShadowPassDepthMode(),P=A.getShadowPassColorMode();L3(i,t,r,l,C,oa.disabled,P,w)}else if(i.renderPass==="translucent"){const A=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!v){const C=new zn(i.context.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D);b===0&&u===1&&A?L3(i,t,r,l,C,oa.disabled,Ea.unblended,w):(L3(i,t,r,l,C,oa.disabled,Ea.disabled,w),L3(i,t,r,l,C,i.stencilModeFor3D(),i.colorModeForRenderPass(),w),i.resetStencilClippingMasks())}if(i.style.enable3dLights()&&A&&(!g&&i.transform.projection.name!=="globe"||v)){const C=r.paint.get("fill-extrusion-opacity"),P=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),R=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),z=r.paint.get("fill-extrusion-flood-light-intensity"),U=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),W=P>0&&R>0,j=z>0,Y=($,K,ie)=>(1-ie)*$+ie*K,Z=$=>{const K=i.depthModeForSublayer(1,zn.ReadOnly,p.LEQUAL,!0),ie=r.paint.get($?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ce=Y(.1,3,ie),he=i._showOverdrawInspector;if(!he){const ye=new oa({func:p.ALWAYS,mask:255},255,255,p.KEEP,p.KEEP,p.REPLACE),Te=new Ea([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0],p.MIN);bv(i,t,r,l,K,ye,Te,la.disabled,$,"sdf",C,P,R,z,U,ce,w,!1)}{const ye=he?oa.disabled:new oa({func:p.EQUAL,mask:255},255,255,p.KEEP,p.DECR,p.DECR),Te=he?i.colorModeForRenderPass():new Ea([p.ONE_MINUS_DST_ALPHA,p.DST_ALPHA,p.ONE,p.ONE],xn.transparent,[!0,!0,!0,!0]);bv(i,t,r,l,K,ye,Te,la.disabled,$,"color",C,P,R,z,U,ce,w,!1)}};if(v){const $=(K,ie,ce)=>{const he=i.depthModeForSublayer(1,zn.ReadOnly,p.LEQUAL,!1),ye=r.paint.get(K?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Te=Y(.1,3,ye);{const we=new Ea([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0]);bv(i,t,r,l,he,oa.disabled,we,la.disabled,K,"clear",C,P,R,z,U,Te,w,ie)}{const we=new oa({func:p.ALWAYS,mask:255},255,255,p.KEEP,p.KEEP,p.REPLACE),Ie=new Ea([p.ONE,p.ONE,p.ONE,p.ONE],xn.transparent,[!1,!1,!1,!0],p.MIN);bv(i,t,r,l,he,we,Ie,la.disabled,K,"sdf",C,P,R,z,U,Te,w,ie)}{const we=K?p.ZERO:p.ONE_MINUS_DST_ALPHA,Ie=new oa({func:p.EQUAL,mask:255},255,255,p.KEEP,p.DECR,p.DECR),xe=new Ea([we,p.DST_ALPHA,p.ONE_MINUS_DST_ALPHA,p.ZERO],xn.transparent,[!0,!0,!0,!0]);bv(i,t,r,l,he,Ie,xe,la.disabled,K,"color",C,P,R,z,U,Te,w,ie)}{const we=new Ea([p.ONE,p.ONE,p.ONE,K?p.ZERO:p.ONE],xn.transparent,[!1,!1,!1,!0],K?p.FUNC_ADD:p.MAX);bv(i,t,r,l,he,oa.disabled,we,la.disabled,K,"clear",C,P,R,z,U,Te,w,ie,ce)}};if(W||j){let K;if(i.prepareDrawTile(),g){const ie=g.drapeBufferSize[0],ce=g.drapeBufferSize[1];K=g.framebufferCopyTexture,K&&(!K||K.size[0]===ie&&K.size[1]===ce)||(K&&K.destroy(),K=g.framebufferCopyTexture=new yr(h,new qi({width:ie,height:ce}),p.RGBA)),K.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.copyTexImage2D(p.TEXTURE_2D,0,p.RGBA,0,0,ie,ce,0)}W&&$(!0,!1,K),j&&$(!1,!0,K)}}else W&&Z(!0),j&&Z(!1)}}},hillshade:function(i,t,r,l){if(i.renderPass!=="offscreen"&&i.renderPass!=="translucent")return;const u=i.context,h=i.terrain&&i.terrain.renderingToTexture,[p,g]=i.renderPass!=="translucent"||h?[{},l]:i.stencilConfigForOverlap(l);for(const v of g){const b=t.getTile(v);if(b.needsHillshadePrepare&&i.renderPass==="offscreen")Tie(i,b,r);else if(i.renderPass==="translucent"){const w=i.depthModeForSublayer(0,zn.ReadOnly),A=r.paint.get("hillshade-emissive-strength"),C=i.colorModeForDrapableLayerRenderPass(A),P=h&&i.terrain?i.terrain.stencilModeForRTTOverlap(v):p[v.overscaledZ];Mie(i,v,b,r,w,P,C)}}u.viewport.set([0,0,i.width,i.height]),i.resetStencilClippingMasks()},raster:function(i,t,r,l,u,h){if(i.renderPass!=="translucent"||r.paint.get("raster-opacity")===0)return;const p=i.context,g=p.gl,v=t.getSource(),b=function(Y,Z,$){const K=[];let ie,ce;if(Y.paint.get("raster-color")){K.push("RASTER_COLOR"),ie=Y.paint.get("raster-color-mix"),ce=Y.paint.get("raster-color-range"),Z.activeTexture.set($.TEXTURE2);let he=Y.colorRampTexture;he||(he=Y.colorRampTexture=new yr(Z,Y.colorRamp,$.RGBA)),he.bind($.LINEAR,$.CLAMP_TO_EDGE)}return{mix:ie,range:ce,defines:K}}(r,p,g),w=b.defines;let A=!1;if(v instanceof Xu&&!l.length){if(i.transform.projection.name!=="globe")return;if(v.onNorthPole)A=!0,w.push("PROJECTION_GLOBE_VIEW");else{if(!v.onSouthPole)return;A=!0,w.push("PROJECTION_GLOBE_VIEW")}}const C=i.colorModeForDrapableLayerRenderPass(),P=i.terrain&&i.terrain.renderingToTexture,R=!i.options.moving,z=r.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;if(A){const Y=t.getSource();if(!(Y instanceof Xu))return;const Z=Y.texture;if(!Z)return;const $=i.globeSharedBuffers;if(!$)return;const K=new zn(g.LEQUAL,zn.ReadWrite,i.depthRangeFor3D),ie=Float32Array.from(i.transform.projMatrix);let ce=oF(0,0,i.transform);const he=Float32Array.from(vm(pc(new Vu(0,0,0)))),ye={opacity:1,mix:0};i.terrain&&i.terrain.prepareDrawTile(),p.activeTexture.set(g.TEXTURE0),Z.bind(z,g.CLAMP_TO_EDGE),p.activeTexture.set(g.TEXTURE1),Z.bind(z,g.CLAMP_TO_EDGE),Z.useMipmap&&p.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax);const[Te,we,Ie,xe]=$.getPoleBuffers(0,!0);let We;Y.onNorthPole?(We=Te,i.renderDefaultNorthPole=!1):(ce=at.scale(at.create(),ce,[1,-1,1]),We=we,i.renderDefaultSouthPole=!1);const qe=j8(ie,he,ce,[0,0],1,ye,r,Y.perspectiveTransform||[0,0],2,b.mix||[0,0,0,0],b.range||[0,0]),et=i.getOrCreateProgram("raster",{defines:b.defines});return i.uploadCommonUniforms(p,et,null),void et.draw(i,g.TRIANGLES,K,oa.disabled,C,la.disabled,qe,r.id,We,Ie,xe)}if(!l.length)return;const[U,W]=v instanceof Xu||P?[{},l]:i.stencilConfigForOverlap(l),j=W[W.length-1].overscaledZ;for(const Y of W){const Z=P?zn.disabled:i.depthModeForSublayer(Y.overscaledZ-j,r.paint.get("raster-opacity")===1?zn.ReadWrite:zn.ReadOnly,g.LESS),$=Y.toUnwrapped(),K=t.getTile(Y);if(P&&(!K||!K.hasData())||!K.texture)continue;const ie=P?Y.projMatrix:i.transform.calculateProjMatrix($,R),ce=i.terrain&&P?i.terrain.stencilModeForRTTOverlap(Y):U[Y.overscaledZ],he=h?0:r.paint.get("raster-fade-duration");K.registerFadeDuration(he);const ye=t.findLoadedParent(Y,0),Te=F8(K,ye,t,i.transform,he);let we,Ie;i.terrain&&i.terrain.prepareDrawTile(),p.activeTexture.set(g.TEXTURE0),K.texture.bind(z,g.CLAMP_TO_EDGE),p.activeTexture.set(g.TEXTURE1),ye?(ye.texture.bind(z,g.CLAMP_TO_EDGE),we=Math.pow(2,ye.tileID.overscaledZ-K.tileID.overscaledZ),Ie=[K.tileID.canonical.x*we%1,K.tileID.canonical.y*we%1]):K.texture.bind(z,g.CLAMP_TO_EDGE),K.texture.useMipmap&&p.extTextureFilterAnisotropic&&i.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax);const xe=v instanceof Xu?v.perspectiveTransform:[0,0],We=new Float32Array(16),qe=j8(ie,We,We,Ie||[0,0],we||1,Te,r,xe,2,b.mix||[0,0,0,0],b.range||[0,0]),et=i.isTileAffectedByFog(Y),Ne=i.getOrCreateProgram("raster",{defines:b.defines,overrideFog:et});if(i.uploadCommonUniforms(p,Ne,$),v instanceof Xu)v.boundsBuffer&&v.boundsSegments&&Ne.draw(i,g.TRIANGLES,Z,oa.disabled,C,la.disabled,qe,r.id,v.boundsBuffer,i.quadTriangleIndexBuffer,v.boundsSegments);else{const{tileBoundsBuffer:Ve,tileBoundsIndexBuffer:it,tileBoundsSegments:gt}=i.getTileBoundsBuffers(K);Ne.draw(i,g.TRIANGLES,Z,ce,C,la.disabled,qe,r.id,Ve,it,gt)}}i.resetStencilClippingMasks()},background:function(i,t,r,l){const u=r.paint.get("background-color"),h=r.paint.get("background-opacity"),p=r.paint.get("background-emissive-strength");if(h===0)return;const g=i.context,v=g.gl,b=i.transform,w=b.tileSize,A=r.paint.get("background-pattern");if(i.isPatternMissing(A,r.scope))return;const C=!A&&u.a===1&&h===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==C)return;const P=oa.disabled,R=i.depthModeForSublayer(0,C==="opaque"?zn.ReadWrite:zn.ReadOnly),z=i.colorModeForDrapableLayerRenderPass(p),U=A?"backgroundPattern":"background";let W,j=l;j||(W=i.getBackgroundTiles(),j=Object.values(W).map(Y=>Y.tileID)),A&&(g.activeTexture.set(v.TEXTURE0),i.imageManager.bind(i.context,r.scope));for(const Y of j){const Z=i.isTileAffectedByFog(Y),$=i.getOrCreateProgram(U,{overrideFog:Z}),K=Y.toUnwrapped(),ie=l?Y.projMatrix:i.transform.calculateProjMatrix(K);i.prepareDrawTile();const ce=t?t.getTile(Y):W?W[Y.key]:new v1(Y,w,b.zoom,i),he=A?qie(ie,p,h,i,A,r.scope,{tileID:Y,tileSize:w}):$ie(ie,p,h,u);i.uploadCommonUniforms(g,$,K);const{tileBoundsBuffer:ye,tileBoundsIndexBuffer:Te,tileBoundsSegments:we}=i.getTileBoundsBuffers(ce);$.draw(i,v.TRIANGLES,R,P,z,la.disabled,he,r.id,ye,Te,we)}},sky:function(i,t,r){const l=i._atmosphere?vo(i.transform.zoom):1,u=r.paint.get("sky-opacity")*l;if(u===0)return;const h=i.context,p=r.paint.get("sky-type"),g=new zn(h.gl.LEQUAL,zn.ReadOnly,[0,1]),v=i.frameCounter/1e3%1;p==="atmosphere"?i.renderPass==="offscreen"?r.needsSkyboxCapture(i)&&(function(b,w,A,C){const P=b.context,R=P.gl;let z=w.skyboxFbo;if(!z){z=w.skyboxFbo=P.createFramebuffer(32,32,!0,null),w.skyboxGeometry=new a9(P),w.skyboxTexture=P.gl.createTexture(),R.bindTexture(R.TEXTURE_CUBE_MAP,w.skyboxTexture),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_S,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_WRAP_T,R.CLAMP_TO_EDGE),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_CUBE_MAP,R.TEXTURE_MAG_FILTER,R.LINEAR);for(let Y=0;Y<6;++Y)R.texImage2D(R.TEXTURE_CUBE_MAP_POSITIVE_X+Y,0,R.RGBA,32,32,0,R.RGBA,R.UNSIGNED_BYTE,null)}P.bindFramebuffer.set(z.framebuffer),P.viewport.set([0,0,32,32]);const U=w.getCenter(b,!0),W=b.getOrCreateProgram("skyboxCapture"),j=new Float64Array(16);at.identity(j),at.rotateY(j,j,.5*-Math.PI),xv(b,w,W,j,U,0),at.identity(j),at.rotateY(j,j,.5*Math.PI),xv(b,w,W,j,U,1),at.identity(j),at.rotateX(j,j,.5*-Math.PI),xv(b,w,W,j,U,2),at.identity(j),at.rotateX(j,j,.5*Math.PI),xv(b,w,W,j,U,3),at.identity(j),xv(b,w,W,j,U,4),at.identity(j),at.rotateY(j,j,Math.PI),xv(b,w,W,j,U,5),P.viewport.set([0,0,b.width,b.height])}(i,r),r.markSkyboxValid(i)):i.renderPass==="sky"&&function(b,w,A,C,P){const R=b.context,z=R.gl,U=b.transform,W=b.getOrCreateProgram("skybox");R.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_CUBE_MAP,w.skyboxTexture);const j=((Y,Z,$,K,ie)=>({u_matrix:Y,u_sun_direction:Z,u_cubemap:0,u_opacity:K,u_temporal_offset:ie}))(U.skyboxMatrix,w.getCenter(b,!1),0,C,P);b.uploadCommonUniforms(R,W),W.draw(b,z.TRIANGLES,A,oa.disabled,b.colorModeForRenderPass(),la.backCW,j,"skybox",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(i,r,g,u,v):p==="gradient"&&i.renderPass==="sky"&&function(b,w,A,C,P){const R=b.context,z=R.gl,U=b.transform,W=b.getOrCreateProgram("skyboxGradient");w.skyboxGeometry||(w.skyboxGeometry=new a9(R)),R.activeTexture.set(z.TEXTURE0);let j=w.colorRampTexture;j||(j=w.colorRampTexture=new yr(R,w.colorRamp,z.RGBA)),j.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Y=((Z,$,K,ie,ce)=>({u_matrix:Z,u_color_ramp:0,u_center_direction:$,u_radius:be(K),u_opacity:ie,u_temporal_offset:ce}))(U.skyboxMatrix,w.getCenter(b,!1),w.paint.get("sky-gradient-radius"),C,P);b.uploadCommonUniforms(R,W),W.draw(b,z.TRIANGLES,A,oa.disabled,b.colorModeForRenderPass(),la.backCW,Y,"skyboxGradient",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(i,r,g,u,v)},debug:function(i,t,r){for(let l=0;l<r.length;l++)lre(i,t,r[l])},custom:function(i,t,r,l){const u=i.context,h=r.implementation;if(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes("custom")||i.terrain&&(i.terrain.renderingToTexture||i.renderPass==="offscreen")&&r.isLayerDraped(t)){if(i.renderPass==="offscreen"){const p=h.prerender;if(p){if(i.setCustomLayerDefaults(),u.setColorMode(i.colorModeForRenderPass()),i.transform.projection.name==="globe"){const g=i.transform.pointMerc;p.call(h,u.gl,i.transform.customLayerMatrix(),i.transform.getProjection(),i.transform.globeToMercatorMatrix(),vo(i.transform.zoom),[g.x,g.y],i.transform.pixelsPerMeterRatio)}else p.call(h,u.gl,i.transform.customLayerMatrix());u.setDirty(),i.setBaseState()}}else if(i.renderPass==="translucent"){if(i.terrain&&i.terrain.renderingToTexture){const g=h.renderToTile;if(g){const v=l[0].canonical,b=new ga(v.x+l[0].wrap*(1<<v.z),v.y,v.z);u.setDepthMode(zn.disabled),u.setStencilMode(oa.disabled),u.setColorMode(i.colorModeForRenderPass()),i.setCustomLayerDefaults(),g.call(h,u.gl,b),u.setDirty(),i.setBaseState()}return}i.setCustomLayerDefaults(),u.setColorMode(i.colorModeForRenderPass()),u.setStencilMode(oa.disabled);const p=h.renderingMode==="3d"?new zn(i.context.gl.LEQUAL,zn.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,zn.ReadOnly);if(u.setDepthMode(p),i.transform.projection.name==="globe"){const g=i.transform.pointMerc;h.render(u.gl,i.transform.customLayerMatrix(),i.transform.getProjection(),i.transform.globeToMercatorMatrix(),vo(i.transform.zoom),[g.x,g.y],i.transform.pixelsPerMeterRatio)}else h.render(u.gl,i.transform.customLayerMatrix());u.setDirty(),i.setBaseState(),u.bindFramebuffer.set(null)}}else ve("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(i,t,r,l){if(i.renderPass==="opaque")return;const u=r.paint.get("model-opacity");if(u===0)return;const h=r.paint.get("model-cast-shadows");if(i.renderPass==="shadow"&&(!h||i.terrain&&u<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof zc))return;const p=i.shadowRenderer,g=r.paint.get("model-receive-shadows");p&&(p.useNormalOffset=!0,g||(p.enabled=!1));const v=()=>{p&&(p.useNormalOffset=!0,g||(p.enabled=!0))},b=t.getSource();if(i.renderPass==="light-beam"&&b.type!=="batched-model")return;if(b.type==="vector"||b.type==="geojson")return function(W,j,Y,Z){const $=W.transform;if($.projection.name!=="mercator")return void ve(`Drawing 3D models for ${$.projection.name} projection is not yet implemented`);const K=$.getFreeCameraOptions().position;if(!W.modelManager)return;const ie=W.modelManager,ce=W.shadowRenderer;if(!Y._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const he=Y._unevaluatedLayout._values["model-id"],ye={...Y.layout.get("model-id").parameters};for(const Te of Z){const we=j.getTile(Te).getBucket(Y);if(!we||we.projection.name!==$.projection.name)continue;const Ie=gre(Te,$);ye.zoom=Ie;const xe=he.possiblyEvaluate(ye);if(mre(W,we,Te),Zu.shadowUniformsInitialized=!1,Zu.useSingleShadowCascade=!!ce&&ce.getMaxCascadeForTile(Te.toUnwrapped())===0,W.renderPass==="shadow"&&ce){if(W.currentShadowCascade===1&&we.isInsideFirstShadowMapFrustum)continue;const et=$.calculatePosMatrix(Te.toUnwrapped(),$.worldSize);if(Zu.tileMatrix.set(et),Zu.shadowTileMatrix=Float32Array.from(ce.calculateShadowPassMatrixFromMatrix(et)),Zu.aabb.min.fill(0),Zu.aabb.max[0]=Zu.aabb.max[1]=ht,Zu.aabb.max[2]=0,vre(we,Zu,W,Y.scope))continue}const We=1<<Te.canonical.z,qe=[((K.x-Te.wrap)*We-Te.canonical.x)*ht,(K.y*We-Te.canonical.y)*ht,K.z*We*ht];for(let et in we.instancesPerModel){const Ne=we.instancesPerModel[et];Ne.features.length>0&&(et=xe.evaluate(Ne.features[0].feature,{}));const Ve=ie.getModel(et,Y.scope);if(Ve&&Ve.uploaded)for(const it of Ve.nodes)o9(W,Y,it,Ne,qe,Te,Zu)}}}(i,t,r,l),void v();if(!b.loaded())return;if(b.type==="batched-model")return function(W,j,Y,Z){const $=W.context,K=W.transform,ie=W.style.fog,ce=W.shadowRenderer;if(K.projection.name!=="mercator")return void ve(`Drawing 3D landmark models for ${K.projection.name} projection is not yet implemented`);const he=W.transform.getFreeCameraOptions().position,ye=ke.scale([],[he.x,he.y,he.z],W.transform.worldSize);ke.negate(ye,ye);const Te=at.identity([]),we=vf(K.center.lat,K.zoom),Ie=at.fromScaling([],[1,1,1/we]);at.translate(Te,Te,ye);const xe=Y.paint.get("model-opacity"),We=new zn($.gl.LEQUAL,zn.ReadWrite,W.depthRangeFor3D),qe=new zn($.gl.LEQUAL,zn.ReadOnly,W.depthRangeFor3D),et=function(Ne,Ve){for(const it of Z){const gt=j.getTile(it).getBucket(Y);if(!gt||!gt.uploaded)continue;let ct=!1;ce&&(ct=ce.getMaxCascadeForTile(it.toUnwrapped())===0);const Pt=K.calculatePosMatrix(it.toUnwrapped(),K.worldSize),Ft=gt.modelTraits;for(const xt of gt.getNodesInfo()){if(xt.hiddenByReplacement||!xt.node.meshes)continue;const Mt=xt.node,en=W.renderPass==="light-beam",on=[...Pt],rn=xt.evaluatedScale;let cn=0;W.terrain&&Mt.elevation&&(cn=Mt.elevation*W.terrain.exaggeration()),at.translate(on,on,[(Mt.anchor?Mt.anchor[0]:0)*(rn[0]-1),(Mt.anchor?Mt.anchor[1]:0)*(rn[1]-1),cn]),rn!==Kne&&at.scale(on,on,rn),at.multiply(on,on,Mt.matrix);const gn=at.multiply([],Ie,on);at.multiply(gn,Te,gn);const kn=at.invert([],gn);at.transpose(kn,kn),at.scale(kn,kn,yre);const ea=at.multiply([],K.projMatrix,on);for(let ba=0;ba<Mt.meshes.length;++ba){const $n=Mt.meshes[ba],Un=ba===Mt.lightMeshIndex;if(Un){if(!en&&!W.terrain&&W.shadowRenderer){W.currentLayer<W.firstLightBeamLayer&&(W.firstLightBeamLayer=W.currentLayer);continue}}else if(en)continue;const In={defines:[]},En=[];b5(In.defines,En,$n,W),4&Ft||In.defines.push("DIFFUSE_SHADED"),ct&&In.defines.push("SHADOWS_SINGLE_CASCADE");const ha=W.renderPass==="shadow";if(ha){x5($n,on,W,Y);continue}let Ma=null;if(ie){const ei=i9(on,W.transform);if(Ma=new Float32Array(ei),K.projection.name!=="globe"){const rr=$n.aabb.min,wi=$n.aabb.max,[Oi,Ya]=ie.getOpacityForBounds(ei,rr[0],rr[1],wi[0],wi[1]);In.overrideFog=Oi>=Em||Ya>=Em}}const Qn=W.getOrCreateProgram("model",In);!ha&&ce&&(ce.useNormalOffset=!!$n.normalBuffer,ce.setupShadowsFromMatrix(on,Qn,ce.useNormalOffset)),W.uploadCommonUniforms($,Qn,it.toUnwrapped(),Ma);const Xa=$n.material,xi=Xa.pbrMetallicRoughness;xi.metallicFactor=.9,xi.roughnessFactor=.5;const oi=v5(new Float32Array(ea),new Float32Array(gn),new Float32Array(kn),W,xe,xi.baseColorFactor,Xa.emissiveFactor,xi.metallicFactor,xi.roughnessFactor,Xa,Y);Qn.draw(W,$.gl.TRIANGLES,Ve&&!Un?We:qe,oa.disabled,Ne?Un||xe<1||xt.hasTranslucentParts?Ea.alphaBlended:Ea.unblended:Ea.disabled,la.backCCW,oi,Y.id,$n.vertexBuffer,$n.indexBuffer,$n.segments,Y.paint,W.transform.zoom,void 0,En)}}}};(function(Ne,Ve,it,gt){const ct=Ne.terrain?Ne.terrain.exaggeration():0,Pt=Ne.transform.zoom;for(const Ft of gt){const xt=Ve.getTile(Ft).getBucket(it);xt&&(Ne.conflationActive&&xt.updateReplacement(Ft,Ne.replacementSource),xt.evaluateScale(Ne,it),Ne.terrain&&ct>0&&xt.elevationUpdate(Ne.terrain,ct,Ft,it.source),xt.needsReEvaluation(Ne,Pt,it)&&xt.evaluate(it))}})(W,j,Y,Z),xe===1?et(!0,!0):(et(!1,!0),et(!0,!1))}(i,t,r,l),void v();const w=b.getModels(),A=[],C=i.transform.getFreeCameraOptions().position,P=ke.scale([],[C.x,C.y,C.z],i.transform.worldSize);ke.negate(P,P);const R=[],z=[];let U=0;for(const W of w){const j=r.paint.get("model-rotation").constantOr(null),Y=r.paint.get("model-scale").constantOr(null),Z=r.paint.get("model-translation").constantOr(null);W.computeModelMatrix(i,j,Y,Z,!0,!0,!1);const $=at.identity([]),K=vf(W.position.lat,i.transform.zoom),ie=at.fromScaling([],[1,1,1/K]);at.translate($,$,P),A.push({zScaleMatrix:ie,negCameraPosMatrix:$});for(const ce of W.nodes)r9(i.transform,ce,W.matrix,i.transform.projMatrix,U,R,z);U++}if(R.sort((W,j)=>j.depth-W.depth),i.renderPass!=="shadow"){if(u===1)for(const W of z)k3(W,i,r,A[W.modelIndex],oa.disabled,i.colorModeForRenderPass());else{for(const W of z)k3(W,i,r,A[W.modelIndex],oa.disabled,Ea.disabled);for(const W of z)k3(W,i,r,A[W.modelIndex],i.stencilModeFor3D(),i.colorModeForRenderPass());i.resetStencilClippingMasks()}for(const W of R)k3(W,i,r,A[W.modelIndex],oa.disabled,i.colorModeForRenderPass());v()}else{for(const W of z)x5(W.mesh,W.nodeModelMatrix,i,r);for(const W of R)x5(W.mesh,W.nodeModelMatrix,i,r);v()}}},l9={modelUpload:function(i,t,r){const l=t.getSource();if(!l.loaded())return;if(l.type==="vector"||l.type==="geojson")return void(i.modelManager&&i.modelManager.upload(i,r));if(l.type==="batched-model")return;const u=l.getModels();for(const h of u)h.upload(i.context)}};class xre{constructor(t,r){this.context=new Une(t),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=$c.maxUnderzooming+$c.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new aae,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Are(this),this._wireframeDebugCache=new bre,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,r){const l=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(l||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Lie(this,t));const u=this._terrain;this.transform.elevation=l?u:null,u.update(t,this.transform,r),this.transform.elevation&&!u.enabled&&(this.transform.elevation=null)}_updateFog(t){const r=t.fog;if(!r||this.transform.projection.name==="globe"||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[l,u]=r.getFovAdjustedRange(this.transform._fov);if(l>u)return void(this.transform.fogCullDistSq=null);const h=l+.78*(u-l);this.transform.fogCullDistSq=h*h}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,r){if(this.width=t*Cn.devicePixelRatio,this.height=r*Cn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const l of this.style.order)this.style._mergedLayers[l].resize()}setup(){const t=this.context,r=new J;r.emplaceBack(0,0),r.emplaceBack(ht,0),r.emplaceBack(0,ht),r.emplaceBack(ht,ht),this.tileExtentBuffer=t.createVertexBuffer(r,mf.members),this.tileExtentSegments=ja.simpleSegment(0,0,4,2);const l=new J;l.emplaceBack(0,0),l.emplaceBack(ht,0),l.emplaceBack(0,ht),l.emplaceBack(ht,ht),this.debugBuffer=t.createVertexBuffer(l,mf.members),this.debugSegments=ja.simpleSegment(0,0,4,5);const u=new J;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(-1,1),u.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(u,mf.members),this.viewportSegments=ja.simpleSegment(0,0,4,2);const h=new je;h.emplaceBack(0,0,0,0),h.emplaceBack(ht,0,ht,0),h.emplaceBack(0,ht,0,ht),h.emplaceBack(ht,ht,ht,ht),this.mercatorBoundsBuffer=t.createVertexBuffer(h,OP.members),this.mercatorBoundsSegments=ja.simpleSegment(0,0,4,2);const p=new Nn;p.emplaceBack(0,1,2),p.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(p);const g=new Z_;for(const b of[0,1,3,2,0])g.emplaceBack(b);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new yr(t,new qi({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=at.create();const v=this.context.gl;this.stencilClearMode=new oa({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO),this.loadTimeStamps.push(m.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,zn.disabled,this.stencilClearMode,Ea.disabled,la.disabled,y5(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,l){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!l||l.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const v of l)if(this._tileClippingMaskIDs[v.key]===void 0){g=!0;break}if(!g)return}this.currentStencilSource=r.id;const u=this.context,h=u.gl;this.nextStencilID+l.length>256&&this.clearStencil(),u.setColorMode(Ea.disabled),u.setDepthMode(zn.disabled);const p=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of l){const v=r.getTile(g),b=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:w,tileBoundsIndexBuffer:A,tileBoundsSegments:C}=this.getTileBoundsBuffers(v);p.draw(this,h.TRIANGLES,zn.disabled,new oa({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),Ea.disabled,la.disabled,y5(g.projMatrix),"$clipping",w,A,C)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new oa({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new oa({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,l=t.sort((p,g)=>g.overscaledZ-p.overscaledZ),u=l[l.length-1].overscaledZ,h=l[0].overscaledZ-u+1;if(h>1){this.currentStencilSource=void 0,this.nextStencilID+h>256&&this.clearStencil();const p={};for(let g=0;g<h;g++)p[g+u]=new oa({func:r.GEQUAL,mask:255},g+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=h,[p,l]}return[{[u]:oa.disabled},l]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ea([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new xn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ea.unblended:Ea.alphaBlended}colorModeForDrapableLayerRenderPass(t){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Ea([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new xn(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,r,l,u=!1){if(!this.opaquePassEnabledForLayer()&&!u)return zn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new zn(l||this.context.gl.LEQUAL,r,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=r;const l=this.style._mergedLayers,u=this.style.order,h=u.map($=>l[$]),p=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Cn.now()),this.imageManager.beginFrame();let g=0,v=!1;for(const $ in p){const K=p[$];K.used&&(K.prepare(this.context),K.getSource().usedInConflation&&++g)}const b={},w={},A={},C={},P={};for(const $ in p){const K=p[$];b[$]=K.getVisibleCoordinates(),w[$]=b[$].slice().reverse(),A[$]=K.getVisibleCoordinates(!0).reverse(),C[$]=K.getShadowCasterCoordinates(),P[$]=K.sortCoordinatesByDistance(b[$])}const R=$=>{const K=this.style.getLayerSourceCache($);return K&&K.used?K.getSource():null};if(g){const $=[];for(const K of h)this.layerUsedInConflation(K,R(K))&&$.push(K);if($&&$.length>1){const K=[];for(const ie of $){const ce=this.style.getLayerSourceCache(ie);ce&&ce.used&&ce.getSource().usedInConflation&&K.push({layer:ie.fqid,cache:ce})}this.replacementSource.setSources(K),v=!0}}v||this.replacementSource.clear(),this.conflationActive=v,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const $ of h){const K=$.cutoffRange();if(this.longestCutoffRange=Math.max(K,this.longestCutoffRange),K>0){const ie=R($);ie&&(this.minCutoffZoom=Math.max(ie.minzoom,this.minCutoffZoom)),$.minzoom&&(this.minCutoffZoom=Math.max($.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let $=0;$<h.length;$++)if(h[$].is3D()){this.opaquePassCutoff=$;break}const z=this.style&&this.style.fog;z?(this._fogVisible=z.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=z.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(A),this.opaquePassCutoff=0);const U=this._shadowRenderer;if(U){U.updateShadowParameters(this.transform,this.style.directionalLight);for(const $ in p)for(const K of b[$]){let ie={min:0,max:0};this.terrain&&(ie=this.terrain.getMinMaxForTile(K)||ie),U.addShadowReceiver(K.toUnwrapped(),ie.min,ie.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new iee(this.context));for(const $ of h){if($.isHidden(this.transform.zoom))continue;const K=t.getLayerSourceCache($);this.uploadLayer(this,$,K)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new pre),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!ai.has(this.context.gl))return;this.renderPass="offscreen";for(const $ of h){const K=t.getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const ie=K?w[K.id]:void 0;($.type==="custom"||$.type==="raster"||$.isSky()||ie&&ie.length)&&this.renderLayer(this,K,$,ie)}this.depthRangeFor3D=[0,1-(h.length+2)*this.numSublayers*this.depthEpsilon];const W=this.terrain;W&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&W.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,C)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const j=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Y=(()=>{if(r.showOverdrawInspector)return xn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!j){const $=this.style.fog.properties.get("color").toArray01();return new xn(...$)}if(this.style.fog&&this.transform.projection.supportsFog&&j){const $=this.style.fog.properties.get("space-color").toArray01();return new xn(...$)}return xn.transparent})();if(this.context.clear({color:Y,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&j&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const $=h[this.currentLayer],K=t.getLayerSourceCache($);if($.isSky())continue;const ie=K?($.is3D()?P:w)[K.id]:void 0;this._renderTileClippingMasks($,K,ie),this.renderLayer(this,K,$,ie)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&j&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||vo(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const $=h[this.currentLayer],K=t.getLayerSourceCache($);$.isSky()&&this.renderLayer(this,K,$,K?w[K.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Z=0;for(U&&(Z=U.getShadowCastingLayerCount());this.currentLayer<u.length;){const $=h[this.currentLayer],K=t.getLayerSourceCache($);if($.isSky()){++this.currentLayer;continue}if(W&&this.style.isLayerDraped($)){if($.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=W.renderBatch(this.currentLayer);continue}let ie;if(K&&(ie=($.type==="symbol"?A:$.is3D()?P:w)[K.id]),this._renderTileClippingMasks($,K,K?b[K.id]:void 0),this.renderLayer(this,K,$,ie),!W&&U&&Z>0&&$.hasShadowPass()&&--Z==0&&(U.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const ce=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ce;this.currentLayer++){const he=h[this.currentLayer];if(!he.hasLightBeamPass())continue;const ye=t.getLayerSourceCache(he);this.renderLayer(this,ye,he,ye?w[ye.id]:void 0)}this.currentLayer=ce,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let $=null;h.forEach(K=>{const ie=t.getLayerSourceCache(K);ie&&!K.isHidden(this.transform.zoom)&&ie.getVisibleCoordinates().length&&(!$||$.getSource().maxzoom<ie.getSource().maxzoom)&&($=ie)}),$&&this.options.showTileBoundaries&&s9.debug(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){const K=$.transform.padding;t9($,$.transform.height-(K.top||0),3,are),t9($,K.bottom||0,3,ire),n9($,K.left||0,3,rre),n9($,$.transform.width-(K.right||0),3,ore);const ie=$.transform.centerPoint;(function(ce,he,ye,Te){R3(ce,he-1,ye-10,2,20,Te),R3(ce,he-10,ye-1,20,2,Te)})($,ie.x,$.transform.height-ie.y,sre)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(m.performance.now()),this.saveCanvasCopy()),v||(this.conflationActive=!1)}uploadLayer(t,r,l){this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&r.type==="custom")&&l9[`${r.type}Upload`]&&l9[`${r.type}Upload`](t,l,r.scope),this.gpuTimingEnd()}renderLayer(t,r,l,u){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="sky"||l.type==="custom"||l.type==="model"||l.type==="raster"||u&&u.length)&&(this.id=l.id,this.gpuTimingStart(l),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(l.type)||t.terrain&&l.type==="custom")&&s9[l.type](t,r,l,u,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery,l=this.context.gl;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:l.createQuery()}),u.calls++,l.beginQuery(r.TIME_ELAPSED_EXT,u.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,r=this.context.gl,l=r.createQuery();this.deferredRenderGpuTimeQueries.push(l),r.beginQuery(t.TIME_ELAPSED_EXT,l)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const r={};for(const l in t){const u=t[l],h=this.context.extTimerQuery,p=h.getQueryParameter(u.query,this.context.gl.QUERY_RESULT)/1e6;h.deleteQueryEXT(u.query),r[l]=p}return r}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery,l=this.context.gl;let u=0;for(const h of t)u+=r.getQueryParameter(h,l.QUERY_RESULT)/1e6,r.deleteQueryEXT(h);return u}translatePosMatrix(t,r,l,u,h){if(!l[0]&&!l[1])return t;const p=h?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(p){const b=Math.sin(p),w=Math.cos(p);l=[l[0]*w-l[1]*b,l[0]*b+l[1]*w]}const g=[h?l[0]:wm(r,l[0],this.transform.zoom),h?l[1]:wm(r,l[1],this.transform.zoom),0],v=new Float32Array(16);return at.translate(v,t,g),v}saveTileTexture(t){const r=this._tileTextures[t.size[0]];r?r.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t,r){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}terrainUseFloatDEM(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,r,l){const u=l===void 0?this.terrain&&this.terrain.renderingToTexture:l,h=this.terrain&&this.terrain.exaggeration()===0,p=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(p.push("LIGHTING_3D_MODE"),p.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):u||p.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||p.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?p.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):p.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(p.push("TERRAIN"),this.terrainUseFloatDEM()&&p.push("TERRAIN_DEM_FLOAT_FORMAT"),h&&p.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&p.push("GLOBE"),!this._fogVisible||u||r!==void 0&&!r||p.push("FOG","FOG_DITHERING"),u&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}getOrCreateProgram(t,r){this.cache=this.cache||{};const l=r&&r.defines||[],u=r&&r.config,h=this.currentGlobalDefines(t,r&&r.overrideFog,r&&r.overrideRtt).concat(l),p=B8.cacheKey(P8[t],t,h,u);return this.cache[p]||(this.cache[p]=new B8(this.context,t,P8[t],u,Xie[t],h)),this.cache[p]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=m.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new yr(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,r){if(this.style.enable3dLights()){const l=this.style.directionalLight,u=this.style.ambientLight;if(l&&u){const h=((p,g)=>{const v=p.properties.get("direction"),b=p.properties.get("color").toArray01(),w=p.properties.get("intensity"),A=g.properties.get("color").toArray01(),C=g.properties.get("intensity"),P=[v.x,v.y,v.z],R=Vt(A,C),z=Vt(b,w);return{u_lighting_ambient_color:R,u_lighting_directional_dir:P,u_lighting_directional_color:z,u_ground_radiance:Rie(P,z,R)}})(l,u);r.setLightsUniformValues(t,h)}}}uploadCommonUniforms(t,r,l,u,h){if(this.uploadCommonLightUniforms(t,r),this.terrain&&this.terrain.renderingToTexture)return;const p=this.style.fog;if(p){const g=p.getOpacity(this.transform.pitch),v=((b,w,A,C,P,R,z,U,W,j,Y,Z)=>{const $=b.transform,K=w.properties.get("color").toArray01();K[3]=C;const ie=b.frameCounter/1e3%1,[ce,he]=w.properties.get("vertical-range");return{u_fog_matrix:A?$.calculateFogTileMatrix(A):Z||b.identityMat,u_fog_range:w.getFovAdjustedRange($._fov),u_fog_color:K,u_fog_horizon_blend:w.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ce,he),he],u_fog_temporal_offset:ie,u_frustum_tl:P,u_frustum_tr:R,u_frustum_br:z,u_frustum_bl:U,u_globe_pos:W,u_globe_radius:j,u_viewport:Y,u_globe_transition:vo($.zoom),u_is_globe:+($.projection.name==="globe")}})(this,p,l,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Cn.devicePixelRatio,this.transform.height*Cn.devicePixelRatio],u);r.setFogUniformValues(t,v)}h&&r.setCutoffUniformValues(t,h.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},l=this.transform.coveringTiles({tileSize:512});for(const u of l)r[u.key]=t[u.key]||new v1(u,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,r){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!r||r.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let r=this._cachedTileFogOpacities[t.key];return r||(this._cachedTileFogOpacities[t.key]=r=this.style.fog.getOpacityForTile(t)),r[0]>=Em||r[1]>=Em}}const Cm=2048;class wre{constructor(t,r){this.aabb=t,this.lastCascade=r}}class Sre{add(t,r){const l=this.receivers[t.key];l!==void 0?(l.aabb.min[0]=Math.min(l.aabb.min[0],r.min[0]),l.aabb.min[1]=Math.min(l.aabb.min[1],r.min[1]),l.aabb.min[2]=Math.min(l.aabb.min[2],r.min[2]),l.aabb.max[0]=Math.max(l.aabb.max[0],r.max[0]),l.aabb.max[1]=Math.max(l.aabb.max[1],r.max[1]),l.aabb.max[2]=Math.max(l.aabb.max[2],r.max[2])):this.receivers[t.key]=new wre(r,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,r,l){const u=hi.fromPoints(t.points);let h=0;for(const p in this.receivers){const g=this.receivers[p];if(!g||!u.intersectsAabb(g.aabb))continue;g.aabb.min=u.closestPoint(g.aabb.min),g.aabb.max=u.closestPoint(g.aabb.max);const v=g.aabb.getCorners();for(let b=0;b<l.length;b++){let w=!0;for(const A of v){const C=[A[0]*r,A[1]*r,A[2]];if(ke.transformMat4(C,C,l[b].matrix),C[0]<-1||C[0]>1||C[1]<-1||C[1]>1){w=!1;break}}if(g.lastCascade=b,h=Math.max(h,b),w)break}}return h+1}}class Are{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Sre,this._depthMode=new zn(t.context.gl.LEQUAL,zn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,r){const l=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const u=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||u<=0||(this._shadowLayerCount=l.style.order.reduce((P,R)=>{const z=l.style._mergedLayers[R];return P+(z.hasShadowPass()&&!z.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const h=l.context,p=Cm,g=Cm;if(this._cascades.length===0)for(let P=0;P<2;++P){const R=l._shadowMapDebug,z=h.gl,U=h.createFramebuffer(p,g,R,"texture"),W=new yr(h,{width:p,height:g,data:null},z.DEPTH_COMPONENT);if(U.depthAttachment.set(W.texture),R){const j=new yr(h,{width:p,height:g,data:null},z.RGBA);U.colorAttachment.set(j.texture)}this._cascades.push({framebuffer:U,texture:W,matrix:[],far:0,boundingSphereRadius:0,frustum:new Jd,scale:0})}this.shadowDirection=c9(r);let v=0;if(t.elevation){const P=t.elevation,R=[1e4,-1e4];P.visibleDemTiles.filter(z=>z.dem).forEach(z=>{const U=z.dem.tree;R[0]=Math.min(R[0],U.minimums[0]),R[1]=Math.max(R[1],U.maximums[0])}),R[0]!==1e4&&(v=(R[1]-R[0])*P.exaggeration())}const b=1.5*t.cameraToCenterDistance,w=3*b,A=new Float64Array(16);for(let P=0;P<2;++P){const R=this._cascades[P];let z=t.height/50,U=1;P===0?U=b:(z=b,U=w);const[W,j]=Ere(t,this.shadowDirection,z,U,Cm,v);R.scale=t.scale,R.matrix=W,R.boundingSphereRadius=j,at.invert(A,R.matrix),R.frustum=Jd.fromInvProjectionMatrix(A,1,0,!0),R.far=U}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=u,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Cm,this._uniformValues.u_shadowmap_0=sl.ShadowMap0,this._uniformValues.u_shadowmap_1=sl.ShadowMap0+1,this._groundShadowTiles=l.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const C=l.transform.elevation;for(const P of this._groundShadowTiles){let R={min:0,max:0};if(C){const z=C.getMinMaxForTile(P);z&&(R=z)}this.addShadowReceiver(P.toUnwrapped(),R.min,R.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,r){if(!this._enabled)return;const l=this.painter,u=l.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(l.transform.getFrustum(0),l.transform.worldSize,this._cascades),u.viewport.set([0,0,Cm,Cm]);for(let h=0;h<this._numCascadesToRender;++h){l.currentShadowCascade=h,u.bindFramebuffer.set(this._cascades[h].framebuffer.framebuffer),u.clear({color:xn.white,depth:1});for(const p of t.order){const g=t._mergedLayers[p];if(!g.hasShadowPass()||g.isHidden(l.transform.zoom))continue;const v=t.getLayerSourceCache(g),b=v?r[v.id]:void 0;(g.type==="model"||b&&b.length)&&l.renderLayer(l,v,g,b)}}l.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,r=t.style,l=t.context,u=r.directionalLight,h=r.ambientLight;if(!u||!h)return;const p=[],g=vv(t,t.longestCutoffRange);g.shouldRenderCutoff&&p.push("RENDER_CUTOFF");const v=w5(u,h),b=new zn(l.gl.LEQUAL,zn.ReadOnly,t.depthRangeFor3D);for(const w of this._groundShadowTiles){const A=w.toUnwrapped(),C=t.isTileAffectedByFog(w),P=t.getOrCreateProgram("groundShadow",{defines:p,overrideFog:C});this.setupShadows(A,P),t.uploadCommonUniforms(l,P,A,null,g);const R={u_matrix:t.transform.calculateProjMatrix(A),u_ground_shadow_factor:v};P.draw(t,l.gl.TRIANGLES,b,oa.disabled,Ea.multiply,la.disabled,R,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ea.unblended:Ea.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const r=this.painter.transform,l=r.calculatePosMatrix(t,r.worldSize);return at.multiply(l,this._cascades[this.painter.currentShadowCascade].matrix,l),Float32Array.from(l)}calculateShadowPassMatrixFromMatrix(t){return at.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,r,l,u=0){if(!this._enabled)return;const h=this.painter.transform,p=this.painter.context,g=p.gl,v=this._uniformValues,b=new Float64Array(16),w=h.calculatePosMatrix(t,h.worldSize);for(let A=0;A<2;A++)at.multiply(b,this._cascades[A].matrix,w),v[A===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),p.activeTexture.set(g.TEXTURE0+sl.ShadowMap0+A),this._cascades[A].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!l,this.useNormalOffset){const A=i1(t.canonical),C=2/h.tileSize*ht/Cm,P=C*this._cascades[0].boundingSphereRadius,R=C*this._cascades[1].boundingSphereRadius,z=(l==="vector-tile"?1:3)/Math.pow(2,u-t.canonical.z-(1-h.zoom+Math.floor(h.zoom)));v.u_shadow_normal_offset=[A,P*z,R*z],v.u_shadow_bias=[6e-5,.0012,.012]}else v.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(p,v)}setupShadowsFromMatrix(t,r,l=!1){if(!this._enabled)return;const u=this.painter.context,h=u.gl,p=this._uniformValues,g=new Float64Array(16);for(let v=0;v<2;v++)at.multiply(g,this._cascades[v].matrix,t),p[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),u.activeTexture.set(h.TEXTURE0+sl.ShadowMap0+v),this._cascades[v].texture.bind(h.NEAREST,h.CLAMP_TO_EDGE);this.useNormalOffset=l,l?(p.u_shadow_normal_offset=[1,5,5],p.u_shadow_bias=[6e-5,.0012,.012]):p.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(u,p)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,r,l,u){if(u[2]>=0)return{};const h=function(v,b,w){const A=w/(1<<v.canonical.z);return new hi([v.canonical.x*A+v.wrap*w,v.canonical.y*A+v.wrap*w,0],[(v.canonical.x+1)*A+v.wrap*w,(v.canonical.y+1)*A+v.wrap*w,b])}(t,r,l).getCorners(),p=r/-u[2];u[0]<0?(ke.add(h[0],h[0],[u[0]*p,0,0]),ke.add(h[3],h[3],[u[0]*p,0,0])):u[0]>0&&(ke.add(h[1],h[1],[u[0]*p,0,0]),ke.add(h[2],h[2],[u[0]*p,0,0])),u[1]<0?(ke.add(h[0],h[0],[0,u[1]*p,0]),ke.add(h[1],h[1],[0,u[1]*p,0])):u[1]>0&&(ke.add(h[2],h[2],[0,u[1]*p,0]),ke.add(h[3],h[3],[0,u[1]*p,0]));const g={};return g.vertices=h,g.planes=[D3(h[1],h[0],h[4]),D3(h[2],h[1],h[5]),D3(h[3],h[2],h[6]),D3(h[0],h[3],h[7])],g}addShadowReceiver(t,r,l){this._receivers.add(t,hi.fromTileIdAndHeight(t,r,l))}getMaxCascadeForTile(t){const r=this._receivers.get(t);return r&&r.lastCascade?r.lastCascade:0}}function D3(i,t,r){const l=ke.sub([],r,t),u=ke.sub([],i,t),h=ke.cross([],l,u),p=ke.length(h);return p===0?[0,0,1,0]:(ke.scale(h,h,1/p),[h[0],h[1],h[2],-ke.dot(h,t)])}function c9(i){const t=i.properties.get("direction"),r=de(t.x,t.y,t.z);r[2]=ae(r[2],0,75);const l=st([r[0],r[1],r[2]]);return ke.fromValues(l.x,l.y,l.z)}function w5(i,t){const r=i.properties.get("color"),l=i.properties.get("intensity"),u=i.properties.get("direction"),h=[u.x,u.y,u.z],p=t.properties.get("color"),g=t.properties.get("intensity"),v=Math.max(ke.dot([0,0,1],h),0),b=[0,0,0];ke.scale(b,p.toArray01Linear().slice(0,3),g);const w=[0,0,0];return ke.scale(w,r.toArray01Linear().slice(0,3),v*l),$t([b[0]>0?b[0]/(b[0]+w[0]):0,b[1]>0?b[1]/(b[1]+w[1]):0,b[2]>0?b[2]/(b[2]+w[2]):0])}function Ere(i,t,r,l,u,h){const p=i.zoom,g=i.scale,v=i.worldSize,b=1/v,w=i.aspect,A=Math.sqrt(1+w*w)*Math.tan(.5*i.fovX),C=A*A,P=l-r,R=l+r;let z,U;C>P/R?(z=l,U=l*A):(z=.5*R*(1+C),U=.5*Math.sqrt(P*P+2*(l*l+r*r)*C+R*R*C*C));const W=i.projection.pixelsPerMeter(i.center.lat,v),j=i._camera.getCameraToWorldMercator(),Y=[0,0,-z*b];ke.transformMat4(Y,Y,j);let Z=U*b;const $=i._edgeInsets;if(!($.left===0&&$.top===0&&$.right===0&&$.bottom===0||$.left===$.right&&$.top===$.bottom)){const gt=i._camera.getWorldToCamera(i.worldSize,i.projection.zAxisUnit==="meters"?W:1),ct=i._camera.getCameraToClipPerspective(i._fov,i.width/i.height,r,l);ct[8]=2*-i.centerOffset.x/i.width,ct[9]=2*i.centerOffset.y/i.height;const Pt=new Float64Array(16);at.mul(Pt,ct,gt);const Ft=new Float64Array(16);at.invert(Ft,Pt);const xt=Jd.fromInvProjectionMatrix(Ft,v,p,!0);for(const Mt of xt.points){const en=((K=Mt)[0]/=g,K[1]/=g,K[2]=$a(K[2],i._center.lat),K);Z=Math.max(Z,ke.len(ke.subtract([],Y,en)))}}var K;Z*=u/(u-1);const ie=Math.acos(t[2]),ce=Math.atan2(-t[0],-t[1]),he=new u3;he.position=Y,he.setPitchBearing(ie,ce);const ye=he.getWorldToCamera(v,W),Te=Z*v,we=Math.min(i._mercatorZfromZoom(17)*v*-2,-2*Te),Ie=he.getCameraToClipOrthographic(-Te,Te,-Te,Te,we,(Te+h*W)/t[2]),xe=new Float64Array(16);at.multiply(xe,Ie,ye);const We=ke.fromValues(Math.floor(1e6*Y[0])/1e6*v,Math.floor(1e6*Y[1])/1e6*v,0),qe=.5*u,et=[0,0,0];ke.transformMat4(et,We,xe),ke.scale(et,et,qe);const Ne=[Math.floor(et[0]),Math.floor(et[1]),Math.floor(et[2])],Ve=[0,0,0];ke.sub(Ve,et,Ne),ke.scale(Ve,Ve,-1/qe);const it=new Float64Array(16);return at.identity(it),at.translate(it,it,Ve),at.multiply(xe,it,xe),[xe,Te]}class Mre extends Bn{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}async loadModel(t,r){const l=await a8(this.requestManager.transformRequest(r,Se.Model).url).catch(p=>{this.fire(new vn(new Error(`Could not load model ${t} from ${r}: ${p.message}`)))});if(!l)return;const u=s5(l),h=new QN(t,void 0,void 0,u);return h.computeBoundsAndApplyParent(),h}async load(t,r){this.models[r]||(this.models[r]={});const l=Object.keys(t);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+l.length;const u=[];for(const p of l)u.push(this.loadModel(p,t[p]));const h=await Promise.allSettled(u);for(let p=0;p<h.length;p++){const{status:g,value:v}=h[p];g==="fulfilled"&&v&&(this.models[r][l[p]]=v)}this.numModelsLoading[r]-=l.length,this.fire(new Ht("data",{dataType:"style"}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,r){return!!this.getModel(t,r)}getModel(t,r){return this.models[r]||(this.models[r]={}),this.models[r][t]}async addModel(t,r,l){this.models[l]||(this.models[l]={}),this.hasModel(t,l)&&this.removeModel(t,l),this.load({[t]:this.requestManager.normalizeModelURL(r)},l)}addModels(t,r){const l={};for(const u in t)l[u]=this.requestManager.normalizeModelURL(t[u]);this.load(l,r)}removeModel(t,r){this.models[r]||(this.models[r]={});const l=this.models[r][t];delete this.models[r][t],l.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,r){this.models[r]||(this.models[r]={});for(const l in this.models[r])this.models[r][l].upload(t.context)}}const D1=(i,t)=>go(i,t&&t.filter(r=>r.identifier!=="source.canvas")),Tre=ft(Fa,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData"]),Cre=ft(Fa,["setCenter","setZoom","setBearing","setPitch"]),u9={version:8,layers:[],sources:{}},d9={duration:300,delay:0},Pre=new Set(["fill","line","background","hillshade","raster"]);class Yc extends Bn{constructor(t,r={}){super(),this.map=t,this.scope=r.scope||"",this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=Ue({},d9),this._buildingIndex=new eie(this),this.crossTileSymbolIndex=new Sie,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new SC,this.dispatcher=r.dispatcher?r.dispatcher:new Mm(I1(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new Pae,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new cv(t._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new Mre(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=r.config||new Map,this._configDependentLayers=new Set,this._changes.reset(),this.dispatcher.broadcast("setReferrer",ze());const l=this;this._rtlTextPluginCallback=Yc.registerForPluginStateChange(u=>{l.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:u.pluginStatus,pluginURL:u.pluginURL},(h,p)=>{if(qo(h),p&&p.every(g=>g))for(const g in l._sourceCaches){const v=l._sourceCaches[g],b=v.getSource().type;b!=="vector"&&b!=="geojson"||v.reload()}})}),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.getOwnSource(u.sourceId);if(h&&h.vectorLayerIds)for(const p in this._layers){const g=this._layers[p];g.source===h.id&&this._validateLayer(g)}})}loadURL(t,r={}){this.fire(new Ht("dataloading",{dataType:"style"}));const l=typeof r.validate=="boolean"?r.validate:!wn(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken),this.resolvedImports.add(t);const u=this.importsCache.get(t);if(u)return this._load(u,l);const h=this.map._requestManager.transformRequest(t,Se.Style);this._request=tt(h,(p,g)=>{if(this._request=null,p)this.fire(new vn(p));else if(g)return this.importsCache.set(t,g),this._load(g,l)})}loadJSON(t,r={}){this.fire(new Ht("dataloading",{dataType:"style"})),this._request=Cn.frame(()=>{this._request=null,this._load(t,r.validate!==!1)})}loadEmpty(){this.fire(new Ht("dataloading",{dataType:"style"})),this._load(u9,!1)}_loadImports(t,r){if(this.importDepth>=4)return ve("Style doesn't support nesting deeper than 5"),this._reloadImports();const l=[];for(const u of t){const h=this._createFragmentStyle(u),p=new Promise(v=>h.on("style.import.load",v));if(l.push(p),this.resolvedImports.has(u.url)){h.loadEmpty();continue}const g=u.data||this.importsCache.get(u.url);g?h.loadJSON(g,{validate:r}):u.url?h.loadURL(u.url,{validate:r}):h.loadEmpty(),this.fragments.push({style:h,id:u.id,config:u.config})}Promise.all(l).then(()=>this._reloadImports())}_createFragmentStyle(t){const r=this.scope?Xo(t.id,this.scope):t.id,l=new Map,u=t.config;if(u)for(const p of Object.keys(u)){const g=Oc(u[p]);g.result==="success"&&l.set(p,g.value.expression)}const h=new Yc(this.map,{scope:r,config:l,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager});return h.setEventedParent(this.map,{style:h}),h}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new Ht("data",{dataType:"style"})),this.fire(new Ht(this.importDepth===0?"style.load":"style.import.load"))}_load(t,r){const l=t.schema;if(this.importDepth===0&&(t.fragment||l&&t.fragment!==!1)){const p=Ue({},u9,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(p,r)}if(l)for(const p of Object.keys(l)){if(this.options.has(p))continue;const g=Oc(l[p].default);g.result==="success"&&this.options.set(p,g.value.expression)}if(r&&D1(this,Ou(t)))return;this._loaded=!0,this.stylesheet=ue(t);for(const p in t.sources)this.addSource(p,t.sources[p],{validate:!1});this._changes.changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const u=l8(this.stylesheet.layers);if(this._order=u.map(p=>p.id),this.stylesheet.light&&ve("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const p=this.stylesheet.lights[0];this.light=new OB(p.properties,p.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new OB(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const p of u){const g=v3(p,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const v=this.getOwnLayerSourceCache(g),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();v&&g.canCastShadows()&&b&&(v.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const h=this.stylesheet.terrain;h&&!this.terrainSetForDrapingOnly()&&this._createTerrain(h,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.fire(new Ht("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,r):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new Ht(this.importDepth===0?"style.load":"style.import.load")))}mergeAll(){let t,r,l,u,h,p,g,v;this.forEachFragmentStyle(b=>{b.light!=null&&(t=b.light),b.ambientLight!=null&&(r=b.ambientLight),b.directionalLight!=null&&(l=b.directionalLight),b.terrain!=null&&(!u||u&&u.drapeRenderMode===0||b.terrain.drapeRenderMode===1)&&(u=b.terrain),b.fog!=null&&(h=b.fog),b.stylesheet&&(b.stylesheet.camera!=null&&(v=b.stylesheet.camera),b.stylesheet.projection!=null&&(p=b.stylesheet.projection),b.stylesheet.transition!=null&&(g=b.stylesheet.transition))}),this.light=t,this.ambientLight=r,this.directionalLight=l,this.terrain=u,this.fog=h,this.camera=v||{"camera-projection":"perspective"},this.projection=p||{name:"mercator"},this.transition=Ue({},d9,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const r=l=>{for(const u of l.fragments)r(u.style);t(l)};r(this)}mergeTerrain(){let t;this.forEachFragmentStyle(r=>{r.terrain!=null&&(!t||t&&t.drapeRenderMode===0||r.terrain.drapeRenderMode===1)&&(t=r.terrain)}),this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(r=>{r.stylesheet.projection!=null&&(t=r.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},r={},l={};this.forEachFragmentStyle(u=>{for(const h in u._sourceCaches){const p=Xo(h,u.scope);t[p]=u._sourceCaches[h]}for(const h in u._otherSourceCaches){const p=Xo(h,u.scope);r[p]=u._otherSourceCaches[h]}for(const h in u._symbolSourceCaches){const p=Xo(h,u.scope);l[p]=u._symbolSourceCaches[h]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=l}mergeLayers(){const t={},r=[],l={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(h=>{for(const p of h._order){const g=h._layers[p];if(g.type==="slot"){const v=Xy(p);if(t[v])continue;t[v]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):r.push(g)}}),this._mergedOrder=[];const u=(h=[])=>{for(const p of h)if(p.type==="slot"){const g=Xy(p.id);t[g]&&u(t[g])}else{const g=Xo(p.id,p.scope);this._mergedOrder.push(g),l[g]=p,p.is3D()&&(this._has3DLayers=!0),p.type==="circle"&&(this._hasCircleLayers=!0),p.type==="symbol"&&(this._hasSymbolLayers=!0)}};u(r),this._mergedLayers=l,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Ue({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.importDepth>0||(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(r,l,u){let h,p,g;const v=Cn.devicePixelRatio>1?"@2x":"";let b=tt(l.transformRequest(l.normalizeSpriteURL(r,v,".json"),Se.SpriteJSON),(C,P)=>{b=null,g||(g=C,h=P,A())}),w=Qt(l.transformRequest(l.normalizeSpriteURL(r,v,".png"),Se.SpriteImage),(C,P)=>{w=null,g||(g=C,p=P,A())});function A(){if(g)u(g);else if(h&&p){const C=Cn.getImageData(p),P={};for(const R in h){const{width:z,height:U,x:W,y:j,sdf:Y,pixelRatio:Z,stretchX:$,stretchY:K,content:ie}=h[R],ce=new qi({width:z,height:U});qi.copy(C,ce,{x:W,y:j},{x:0,y:0},{width:z,height:U}),P[R]={data:ce,pixelRatio:Z,sdf:Y,stretchX:$,stretchY:K,content:ie}}u(null,P)}}return{cancel(){b&&(b.cancel(),b=null),w&&(w.cancel(),w=null)}}}(t,this.map._requestManager,(r,l)=>{if(this._spriteRequest=null,r)this.fire(new vn(r));else if(l)for(const u in l)this.imageManager.addImage(u,this.scope,l[u]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Ht("data",{dataType:"style"}))})}_validateLayer(t){const r=this.getOwnSource(t.source);if(!r)return;const l=t.sourceLayer;l&&(r.type==="geojson"||r.vectorLayerIds&&r.vectorLayerIds.indexOf(l)===-1)&&this.fire(new vn(new Error(`Source layer "${l}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.updatedSourceCaches).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,r)=>{const l=this.fragments[r];return l&&l.style&&(t.data=l.style.serialize()),t})}_serializeSources(){const t={};for(const r in this._sourceCaches){const l=this._sourceCaches[r].getSource();t[l.id]||(t[l.id]=l.serialize())}return t}_serializeLayers(t){const r=[];for(const l of t){const u=this._layers[l];u&&u.type!=="custom"&&r.push(u.serialize())}return r}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):Pre.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const r=this.calculateLightsBrightness();t.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const l=this._changes.changed;if(this._changes.changed){const h=this._changes.getLayerUpdatesByScope();for(const p in h){const{updatedIds:g,removedIds:v}=h[p];(g||v)&&this._updateWorkerLayers(p,g,v)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const u={};for(const h in this._mergedSourceCaches){const p=this._mergedSourceCaches[h];u[h]=p.used,p.used=!1}for(const h of this._mergedOrder){const p=this._mergedLayers[h];if(p.recalculate(t,this._availableImages),!p.isHidden(t.zoom)){const g=this.getOwnLayerSourceCache(p);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=p.minzoom||0;g<(p.maxzoom||25.5);g++){const v=this.map.painter;if(v){const b=p.getProgramIds();if(!b)continue;for(const w of b){const A=p.getDefaultProgramParams(w,t.zoom);A&&(v.style=this,this.fog&&(v._fogVisible=!0,A.overrideFog=!0,v.getOrCreateProgram(w,A)),v._fogVisible=!1,A.overrideFog=!1,v.getOrCreateProgram(w,A),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(A.overrideRtt=!0,v.getOrCreateProgram(w,A)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const h in u){const p=this._mergedSourceCaches[h];u[h]!==p.used&&p.getSource().fire(new Ht("data",{sourceDataType:"visibility",dataType:"source",sourceId:p.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),l&&this.fire(new Ht("data",{dataType:"style"}));for(const{style:h}of this.fragments)h.update(t)}_updateTilesForChangedImages(){const t=Array.from(this._changes.changedImages.keys());if(t.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changes.changedImages.clear()}}_updateWorkerLayers(t,r,l){const u=this.getFragmentStyle(t);this.dispatcher.broadcast("updateLayers",{layers:r?u._serializeLayers(r):[],scope:t,removedIds:l||[],options:u.options})}setState(t){if(this._checkLoaded(),D1(this,Ou(t)))return!1;(t=ue(t)).layers=l8(t.layers);const r=function(u,h){if(!u)return[{command:Fa.setStyle,args:[h]}];let p=[];try{if(!Q(u.version,h.version))return[{command:Fa.setStyle,args:[h]}];Q(u.center,h.center)||p.push({command:Fa.setCenter,args:[h.center]}),Q(u.zoom,h.zoom)||p.push({command:Fa.setZoom,args:[h.zoom]}),Q(u.bearing,h.bearing)||p.push({command:Fa.setBearing,args:[h.bearing]}),Q(u.pitch,h.pitch)||p.push({command:Fa.setPitch,args:[h.pitch]}),Q(u.sprite,h.sprite)||p.push({command:Fa.setSprite,args:[h.sprite]}),Q(u.glyphs,h.glyphs)||p.push({command:Fa.setGlyphs,args:[h.glyphs]}),Q(u.transition,h.transition)||p.push({command:Fa.setTransition,args:[h.transition]}),Q(u.light,h.light)||p.push({command:Fa.setLight,args:[h.light]}),Q(u.fog,h.fog)||p.push({command:Fa.setFog,args:[h.fog]}),Q(u.projection,h.projection)||p.push({command:Fa.setProjection,args:[h.projection]}),Q(u.lights,h.lights)||p.push({command:Fa.setLights,args:[h.lights]}),Q(u.camera,h.camera)||p.push({command:Fa.setCamera,args:[h.camera]});const g={},v=[];(function(A,C,P,R){let z;for(z in C=C||{},A=A||{})A.hasOwnProperty(z)&&(C.hasOwnProperty(z)||u8(z,P,R));for(z in C){if(!C.hasOwnProperty(z))continue;const U=C[z];A.hasOwnProperty(z)?Q(A[z],U)||(A[z].type==="geojson"&&U.type==="geojson"&&aie(A,C,z)?P.push({command:Fa.setGeoJSONSourceData,args:[z,U.data]}):nie(z,C,P,R)):c8(z,C,P)}})(u.sources,h.sources,v,g);const b=[];u.layers&&u.layers.forEach(A=>{A.source&&g[A.source]?p.push({command:Fa.removeLayer,args:[A.id]}):b.push(A)});let w=u.terrain;w&&g[w.source]&&(p.push({command:Fa.setTerrain,args:[void 0]}),w=void 0),p=p.concat(v),Q(w,h.terrain)||p.push({command:Fa.setTerrain,args:[h.terrain]}),function(A,C,P){C=C||[];const R=(A=A||[]).map(w3),z=C.map(w3),U=A.reduce(S3,{}),W=C.reduce(S3,{}),j=R.slice(),Y=Object.create(null);let Z,$,K,ie,ce,he,ye;for(Z=0,$=0;Z<R.length;Z++)K=R[Z],W.hasOwnProperty(K)?$++:(P.push({command:Fa.removeLayer,args:[K]}),j.splice(j.indexOf(K,$),1));for(Z=0,$=0;Z<z.length;Z++)K=z[z.length-1-Z],j[j.length-1-Z]!==K&&(U.hasOwnProperty(K)?(P.push({command:Fa.removeLayer,args:[K]}),j.splice(j.lastIndexOf(K,j.length-$),1)):$++,he=j[j.length-Z],P.push({command:Fa.addLayer,args:[W[K],he]}),j.splice(j.length-Z,0,K),Y[K]=!0);for(Z=0;Z<z.length;Z++)if(K=z[Z],ie=U[K],ce=W[K],!Y[K]&&!Q(ie,ce))if(Q(ie.source,ce.source)&&Q(ie["source-layer"],ce["source-layer"])&&Q(ie.type,ce.type)){for(ye in x3(ie.layout,ce.layout,P,K,null,Fa.setLayoutProperty),x3(ie.paint,ce.paint,P,K,null,Fa.setPaintProperty),Q(ie.filter,ce.filter)||P.push({command:Fa.setFilter,args:[K,ce.filter]}),Q(ie.minzoom,ce.minzoom)&&Q(ie.maxzoom,ce.maxzoom)||P.push({command:Fa.setLayerZoomRange,args:[K,ce.minzoom,ce.maxzoom]}),ie)ie.hasOwnProperty(ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?x3(ie[ye],ce[ye],P,K,ye.slice(6),Fa.setPaintProperty):Q(ie[ye],ce[ye])||P.push({command:Fa.setLayerProperty,args:[K,ye,ce[ye]]}));for(ye in ce)ce.hasOwnProperty(ye)&&!ie.hasOwnProperty(ye)&&ye!=="layout"&&ye!=="paint"&&ye!=="filter"&&ye!=="metadata"&&ye!=="minzoom"&&ye!=="maxzoom"&&(ye.indexOf("paint.")===0?x3(ie[ye],ce[ye],P,K,ye.slice(6),Fa.setPaintProperty):Q(ie[ye],ce[ye])||P.push({command:Fa.setLayerProperty,args:[K,ye,ce[ye]]}))}else P.push({command:Fa.removeLayer,args:[K]}),he=j[j.lastIndexOf(K)+1],P.push({command:Fa.addLayer,args:[ce,he]})}(b,h.layers,p),function(A=[],C=[],P){C=C||[];const R=(A=A||[]).map(w3),z=C.map(w3),U=A.reduce(S3,{}),W=C.reduce(S3,{}),j=R.slice();let Y,Z,$,K;for(Y=0,Z=0;Y<R.length;Y++)$=R[Y],W.hasOwnProperty($)?Z++:(P.push({command:Fa.removeImport,args:[$]}),j.splice(j.indexOf($,Z),1));for(Y=0,Z=0;Y<z.length;Y++)$=z[z.length-1-Y],j[j.length-1-Y]!==$&&(U.hasOwnProperty($)?(P.push({command:Fa.removeImport,args:[$]}),j.splice(j.lastIndexOf($,j.length-Z),1)):Z++,K=j[j.length-Y],P.push({command:Fa.addImport,args:[W[$],K]}),j.splice(j.length-Y,0,$));for(const ie of C){const ce=U[ie.id];if(!ce||Q(ce,ie))continue;Q(ce.url,ie.url)||P.push({command:Fa.setImportUrl,args:[ie.id,ie.url]});const he=ie.data;Q(ce&&ce.data,he)||P.push({command:Fa.setImportData,args:[ie.id,he]})}}(u.imports,h.imports,p)}catch(g){console.warn("Unable to compute style diff:",g),p=[{command:Fa.setStyle,args:[h]}]}return p}(this.serialize(),t).filter(u=>!(u.command in Cre));if(r.length===0)return!1;const l=r.filter(u=>!(u.command in Tre));if(l.length>0)throw new Error(`Unimplemented: ${l.map(u=>u.command).join(", ")}.`);return r.forEach(u=>{this[u.command].apply(this,u.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,r){return this.getImage(t)?this.fire(new vn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,r),this._afterImageUpdated(t),this)}updateImage(t,r){this.imageManager.updateImage(t,this.scope,r)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new vn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.changedImages.add(t),this._changes.changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Ht("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,r,l={}){return this._checkLoaded(),this._validate(By,`models.${t}`,r,null,l)||(this.modelManager.addModel(t,r,this.scope),this._changes.changed=!0),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new vn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,r,l={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(uf,`sources.${t}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=c5(t,r,this.dispatcher,this);u.scope=this.scope,u.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u.id),source:u.serialize(),sourceId:u.id}));const h=p=>{const g=(p?"symbol:":"other:")+u.id,v=Xo(g,this.scope),b=this._sourceCaches[g]=new $c(v,u,p);(p?this._symbolSourceCaches:this._otherSourceCaches)[u.id]=b,b.onAdd(this.map)};h(!1),r.type!=="vector"&&r.type!=="geojson"||h(!0),u.onAdd&&u.onAdd(this.map),this.mergeSources(),this._changes.changed=!0}removeSource(t){this._checkLoaded();const r=this.getOwnSource(t);if(!r)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new vn(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new vn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const l=this.getOwnSourceCaches(t);for(const u of l){const h=Xy(u.id);delete this._sourceCaches[h],delete this._changes.updatedSourceCaches[u.id],u.fire(new Ht("data",{sourceDataType:"metadata",dataType:"source",sourceId:u.getSource().id})),u.setEventedParent(null),u.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.changed=!0,this}setGeoJSONSourceData(t,r){this._checkLoaded(),this.getOwnSource(t).setData(r),this._changes.changed=!0}getOwnSource(t){const r=this.getOwnSourceCache(t);return r&&r.getSource()}getOwnSources(){const t=[];for(const r in this._otherSourceCaches){const l=this.getOwnSourceCache(r);l&&t.push(l.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const u of t){if(this._validate(G_,"lights",u))return;switch(u.type){case"ambient":if(this.ambientLight){const h=this.ambientLight;h.set(u),h.updateTransitions(r)}else this.ambientLight=new VB(u,Fae,this.scope,this.options);break;case"directional":if(this.directionalLight){const h=this.directionalLight;h.set(u),h.updateTransitions(r)}else this.directionalLight=new VB(u,Nae,this.scope,this.options)}}const l=new ri(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(l),this.directionalLight&&this.directionalLight.recalculate(l),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,r=this.ambientLight;if(!t||!r)return;const l=A=>.2126*(A[0]<=.03928?A[0]/12.92:Math.pow((A[0]+.055)/1.055,2.4))+.7152*(A[1]<=.03928?A[1]/12.92:Math.pow((A[1]+.055)/1.055,2.4))+.0722*(A[2]<=.03928?A[2]/12.92:Math.pow((A[2]+.055)/1.055,2.4)),u=t.properties.get("color").toArray01(),h=t.properties.get("intensity"),p=t.properties.get("direction"),g=1-de(p.x,p.y,p.z)[2]/90,v=l(u)*h*g,b=r.properties.get("color").toArray01(),w=r.properties.get("intensity");return(v+l(b)*w)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;const r=this.fragments.find(({id:l})=>l===t);if(!r)throw new Error(`Style import not found: ${t}`);return r.style}setConfigProperty(t,r,l){const u=Oc(l);if(u.result!=="success")return void D1(this,u.value);const h=u.value.expression,p=this.getFragmentStyle(t);p.options.set(r,h);for(const g of p._configDependentLayers){const v=this.getLayer(g);v&&(v.possiblyEvaluateVisibility(),this._updateLayer(v))}this.ambientLight&&this.ambientLight.scope===t&&this.ambientLight.updateConfig(p.options),this.directionalLight&&this.directionalLight.scope===t&&this.directionalLight.updateConfig(p.options),this._changes.changed=!0}addLayer(t,r,l={}){this._checkLoaded();const u=t.id;if(this._layers[u])return void this.fire(new vn(new Error(`Layer with id "${u}" already exists on this map`)));let h;if(t.type==="custom"){if(D1(this,function(w){const A=[],C=w.id;return C===void 0&&A.push({message:`layers.${C}: missing required property "id"`}),w.render===void 0&&A.push({message:`layers.${C}: missing required method "render"`}),w.renderingMode&&w.renderingMode!=="2d"&&w.renderingMode!=="3d"&&A.push({message:`layers.${C}: property "renderingMode" must be either "2d" or "3d"`}),A}(t)))return;h=v3(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(u,t.source),t=Ue(t=ue(t),{source:u})),this._validate(Fu,`layers.${u}`,t,{arrayIndex:-1},l))return;h=v3(t,this.options),this._validateLayer(h),h.setEventedParent(this,{layer:{id:u}}),this._serializedLayers[h.id]=h.serialize()}h.isConfigDependent&&this._configDependentLayers.add(h.fqid),h.setScope(this.scope);const p=r?this._order.indexOf(r):this._order.length;if(r&&p===-1)return void this.fire(new vn(new Error(`Layer with id "${r}" does not exist on this map.`)));this._order.splice(p,0,u),this._layerOrderChanged=!0,this._layers[u]=h;const g=this.getOwnLayerSourceCache(h),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&h.canCastShadows()&&v&&(g.castsShadows=!0);const b=this._changes.getRemovedLayer(h);if(b&&h.source&&g&&h.type!=="custom"){this._changes.discardLayerRemoval(h);const w=Xo(h.source,h.scope);b.type!==h.type?this._changes.updatedSourceCaches[w]="clear":(this._changes.updatedSourceCaches[w]="reload",g.pause())}this._updateLayer(h),h.onAdd&&h.onAdd(this.map),h.scope=this.scope,this.mergeLayers()}moveLayer(t,r){if(this._checkLoaded(),this._changes.changed=!0,!this._layers[t])return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const l=this._order.indexOf(t);this._order.splice(l,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new vn(new Error(`Layer with id "${r}" does not exist on this map.`))):(this._order.splice(u,0,t),this._layerOrderChanged=!0,this.mergeLayers())}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));r.setEventedParent(null);const l=this._order.indexOf(t);this._order.splice(l,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.changed=!0,this._layerOrderChanged=!0,this._configDependentLayers.delete(r.fqid),this._changes.removeLayer(r);const u=this.getOwnLayerSourceCache(r);if(u&&u.castsShadows){let h=!1;for(const p in this._layers)if(this._layers[p].source===r.source&&this._layers[p].canCastShadows()){h=!0;break}u.castsShadows=h}r.onRemove&&r.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const r in this._layers)if(this._layers[r].type===t)return!0;return!1}setLayerZoomRange(t,r,l){this._checkLoaded();const u=this.getOwnLayer(t);u?u.minzoom===r&&u.maxzoom===l||(r!=null&&(u.minzoom=r),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,r,l={}){this._checkLoaded();const u=this.getOwnLayer(t);if(u){if(!Q(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(df,`layers.${u.id}.filter`,r,{layerType:u.type},l)||(u.filter=ue(r),this._updateLayer(u)))}else this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const r=this.getOwnLayer(t);if(r)return ue(r.filter);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}setLayoutProperty(t,r,l,u={}){this._checkLoaded();const h=this.getOwnLayer(t);h?Q(h.getLayoutProperty(r),l)||(h.setLayoutProperty(r,l,u),h.isConfigDependent&&this._configDependentLayers.add(h.fqid),this._updateLayer(h)):this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,r){const l=this.getOwnLayer(t);if(l)return l.getLayoutProperty(r);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,r,l,u={}){this._checkLoaded();const h=this.getOwnLayer(t);if(!h)return void this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)));if(Q(h.getPaintProperty(r),l))return;const p=h.setPaintProperty(r,l,u);h.isConfigDependent&&this._configDependentLayers.add(h.fqid),p&&this._updateLayer(h),this._changes.changed=!0,this._changes.updatedPaintProps.add(h.fqid)}getPaintProperty(t,r){const l=this.getOwnLayer(t);if(l)return l.getPaintProperty(r);this.fire(new vn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}setFeatureState(t,r){this._checkLoaded();const l=t.source,u=t.sourceLayer,h=this.getOwnSource(l);if(!h)return void this.fire(new vn(new Error(`The source '${l}' does not exist in the map's style.`)));const p=h.type;if(p==="geojson"&&u)return void this.fire(new vn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(p==="vector"&&!u)return void this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new vn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(l);for(const v of g)v.setFeatureState(u,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const l=t.source,u=this.getOwnSource(l);if(!u)return void this.fire(new vn(new Error(`The source '${l}' does not exist in the map's style.`)));const h=u.type,p=h==="vector"?t.sourceLayer:void 0;if(h==="vector"&&!p)return void this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new vn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(l);for(const v of g)v.removeFeatureState(p,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,l=t.sourceLayer,u=this.getOwnSource(r);if(u){if(u.type!=="vector"||l)return t.id===void 0&&this.fire(new vn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(l,t.id);this.fire(new vn(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new vn(new Error(`The source '${r}' does not exist in the map's style.`)))}setTransition(t){return this.stylesheet.transition=Ue({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Ue({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),r=t&&this.terrain&&this.terrain.scope===this.scope?t:void 0;return Be({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const r=this.getLayerSourceCache(t),l=Xo(t.source,t.scope);t.source&&!this._changes.updatedSourceCaches[l]&&r&&r.getSource().type!=="raster"&&(this._changes.updatedSourceCaches[l]="reload",r.pause()),this._changes.changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const r=g=>this._mergedLayers[g].type==="fill-extrusion",l=this.order,u={},h=[];for(let g=l.length-1;g>=0;g--){const v=l[g];if(r(v)){u[v]=g;for(const b of t){const w=b[v];if(w)for(const A of w)h.push(A)}}}h.sort((g,v)=>v.intersectionZ-g.intersectionZ);const p=[];for(let g=l.length-1;g>=0;g--){const v=l[g];if(r(v))for(let b=h.length-1;b>=0;b--){const w=h[b].feature;if(u[w.layer.id]<g)break;p.push(w),h.pop()}else for(const b of t){const w=b[v];if(w)for(const A of w)p.push(A.feature)}}return p}queryRenderedFeatures(t,r,l){r&&r.filter&&this._validate(df,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const u={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new vn(new Error("parameters.layers must be an Array."))),[];for(const b of r.layers){const w=this._mergedLayers[b];if(!w)return this.fire(new vn(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];u[w.source]=!0}}const h=[],p=r.serializedLayers||{},g=r&&r.layers?r.layers.some(b=>{const w=this.getLayer(b);return w&&w.is3D()}):this.has3DLayers(),v=XP.createFromScreenPoints(t,l);for(const b in this._mergedSourceCaches){const w=this._mergedSourceCaches[b].getSource();if(!w||w.scope!==r.scope)continue;const A=this._mergedSourceCaches[b].getSource().id;r.layers&&!u[A]||h.push(Jae(this._mergedSourceCaches[b],this._mergedLayers,p,v,r,l,g,!!this.map._showQueryGeometry))}return this.placement&&h.push(function(b,w,A,C,P,R,z){const U={},W=R.queryRenderedSymbols(C),j=[];for(const Y of Object.keys(W).map(Number))j.push(z[Y]);j.sort(o8);for(const Y of j){const Z=Y.featureIndex.lookupSymbolFeatures(W[Y.bucketInstanceId],w,Y.bucketIndex,Y.sourceLayerIndex,P.filter,P.layers,P.availableImages,b);for(const $ in Z){const K=U[$]=U[$]||[],ie=Z[$];ie.sort((ce,he)=>{const ye=Y.featureSortOrder;if(ye){const Te=ye.indexOf(ce.featureIndex);return ye.indexOf(he.featureIndex)-Te}return he.featureIndex-ce.featureIndex});for(const ce of ie)K.push(ce)}}for(const Y in U)U[Y].forEach(Z=>{const $=Z.feature,K=A(b[Y]);if(!K)return;const ie=K.getFeatureState($.layer["source-layer"],$.id);$.source=$.layer.source,$.layer["source-layer"]&&($.sourceLayer=$.layer["source-layer"]),$.state=ie});return U}(this._mergedLayers,p,this.getLayerSourceCache.bind(this),v.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)}querySourceFeatures(t,r){r&&r.filter&&this._validate(df,"querySourceFeatures.filter",r.filter,null,r);const l=this.getOwnSourceCaches(t);let u=[];for(const h of l)u=u.concat(Qae(h,r));return u}addSourceType(t,r,l){return Yc.getSourceType(t)?l(new Error(`A source type called "${t}" already exists.`)):(Yc.setSourceType(t,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:r.workerSourceURL},l):l(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,r,l={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const g in t)if(!Q(t[g],u[g])){h=!0;break}if(!h)return;const p=this._getTransitionParameters();this.light.setLight(t,r,l),this.light.updateTransitions(p)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,r=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let l=t;if(r===1){if(typeof l.source=="object"){const u="terrain-dem-src";this.addSource(u,l.source),l=ue(l),l=Ue(l,{source:u})}if(this._validate(zu,"terrain",l))return}if(!this.terrain||this.terrain&&r!==this.terrain.drapeRenderMode){if(!l)return;this._createTerrain(l,r),this.fire(new Ht("data",{dataType:"style"}))}else{const u=this.terrain,h=u.get();for(const p of Object.keys(nt.terrain))!l.hasOwnProperty(p)&&nt.terrain[p].default&&(l[p]=nt.terrain[p].default);for(const p in t)if(!Q(t[p],h[p])){u.set(t),this.stylesheet.terrain=t;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new Ht("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const r=this.fog=new Dae(t,this.map.transform);this.stylesheet.fog=r.get();const l=this._getTransitionParameters({duration:0});r.updateTransitions(l)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!Q(r.get(),t)){r.set(t),this.stylesheet.fog=r.get();const l=this._getTransitionParameters({duration:0});r.updateTransitions(l)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Cn.now(),transition:Ue(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],r=[];for(const l in this._mergedLayers)this.isLayerDraped(this._mergedLayers[l])?t.push(l):r.push(l);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...r)}_createTerrain(t,r){const l=this.terrain=new Rae(t,r);l.setScope(this.scope),this.stylesheet.terrain=t,this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const u=this._getTransitionParameters({duration:0});l.updateTransitions(u)}_force3DLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="fill-extrusion"&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="symbol"&&this._updateLayer(r)}}_validate(t,r,l,u,h={}){if(h&&h.validate===!1)return!1;const p=Ue({},this.serialize());return D1(this,t.call(Ou,Ue({key:r,style:p,value:l,styleSpec:nt},u)))}_remove(){for(const{style:t}of this.fragments)t._remove();this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),jy.off("pluginStateChange",this._rtlTextPluginCallback),this.mergeLayers(),this.mergeSources();for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.ambientLight,delete this.directionalLight,this.importDepth===0&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const r=this.getSourceCaches(t);for(const l of r)l.clearTiles()}reloadSource(t){const r=this.getSourceCaches(t);for(const l of r)l.resume(),l.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let r;this.directionalLight&&(r=c9(this.directionalLight));for(const l in this._mergedSourceCaches)this._mergedSourceCaches[l].update(t,void 0,void 0,r)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const r=this._sourceCaches[t];r.resume(),r.reload()}}_updatePlacement(t,r,l,u,h=!1){let p=!1,g=!1;const v={},b={};for(const w of this._mergedOrder){const A=this._mergedLayers[w];if(A.type!=="symbol")continue;if(!v[A.source]){const P=this.getLayerSourceCache(A);if(!P)continue;const R=P.getRenderableIds(!0).map(z=>P.getTileByID(z));b[A.source]=R.slice(),v[A.source]=R.sort((z,U)=>U.tileID.overscaledZ-z.tileID.overscaledZ||(z.tileID.isLessThan(U.tileID)?-1:1))}const C=this.crossTileSymbolIndex.addLayer(A,v[A.source],t.center.lng,t.projection);p=p||C}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),h=h||this._layerOrderChanged||l===0,this._layerOrderChanged&&this.fire(new Ht("neworder")),(h||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Cn.now(),t.zoom))&&(this.pauseablePlacement=new _ie(t,this._mergedOrder,h,r,l,u,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,v,b),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Cn.now()),g=!0),p&&this.pauseablePlacement.placement.setStale()),g||p)for(const w of this._mergedOrder){const A=this._mergedLayers[w];A.type==="symbol"&&this.placement.updateLayerOpacities(A,v[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Cn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const r=this.stylesheet.imports;return r?r.findIndex(({id:u})=>u===t.id)!==-1?(this.fire(new vn(new Error(`Import with id '${t.id}' already exists in the map's style.`))),this):(this.stylesheet.imports?this.stylesheet.imports.push(t):this.stylesheet.imports=[t],this._loadImports([t],!0),this):this}setImportUrl(t,r){this._checkLoaded();const l=this.stylesheet.imports;if(!l)return this;const u=this.getImportIndex(t);if(u===-1)return this;l[u].url=r;const h=this.fragments[u];h.style=this._createFragmentStyle({id:t,url:r});const p=new Promise(g=>h.style.on("style.import.load",g));return h.style.loadURL(r),p.then(()=>this._reloadImports()),this}setImportData(t,r){this._checkLoaded();const l=this.stylesheet.imports;if(!l)return this;const u=this.getImportIndex(t);return u===-1?this:r?(this.fragments[u].style.setState(r),this._reloadImports(),this):(delete l[u].data,this.setImportUrl(t,l[u].url))}removeImport(t){this._checkLoaded();const r=this.stylesheet.imports;if(!r)return this;const l=this.getImportIndex(t);return l===-1||(r.splice(l,1),this.fragments[l].style._remove(),this.fragments.splice(l,1),this._reloadImports()),this}getImportIndex(t){const r=this.stylesheet.imports;if(!r)return-1;const l=r.findIndex(u=>u.id===t);return l===-1&&this.fire(new vn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),l}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const r in this._mergedOtherSourceCaches){const l=this._mergedOtherSourceCaches[r];l&&t.push(l.getSource())}return t}getSource(t,r){const l=this.getSourceCache(t,r);return l&&l.getSource()}getLayerSource(t){const r=this.getLayerSourceCache(t);return r&&r.getSource()}getSourceCache(t,r){const l=Xo(t,r);return this._mergedOtherSourceCaches[l]}getLayerSourceCache(t){const r=Xo(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){const r=[];return this._mergedOtherSourceCaches[t]&&r.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&r.push(this._mergedSymbolSourceCaches[t]),r}updateSourceCaches(){for(const t in this._changes.updatedSourceCaches){const r=this._changes.updatedSourceCaches[t];r==="reload"?this.reloadSource(t):r==="clear"&&this.clearSource(t)}}updateLayers(t){for(const r of this._changes.updatedPaintProps){const l=this.getLayer(r);l&&l.updateTransitions(t)}}getImages(t,r,l){this.imageManager.getImages(r.icons,r.scope,l),this._updateTilesForChangedImages();const u=h=>{h&&h.setDependencies(r.tileID.key,r.type,r.icons)};u(this._otherSourceCaches[r.source]),u(this._symbolSourceCaches[r.source])}getGlyphs(t,r,l){this.glyphManager.getGlyphs(r.stacks,r.scope,l)}getResource(t,r,l){return Qe(r,l)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const r=[];return this._otherSourceCaches[t]&&r.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&r.push(this._symbolSourceCaches[t]),r}_isSourceCacheLoaded(t){const r=this.getOwnSourceCaches(t);return r.length===0?(this.fire(new vn(new Error(`There is no source with ID '${t}'`))),!1):r.every(l=>l.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function h9(i,t){let r=!1,l=null;const u=()=>{l=null,r&&(i(),l=setTimeout(u,t),r=!1)};return()=>(r=!0,l||u(),l)}Yc.getSourceType=function(i){return l5[i]},Yc.setSourceType=function(i,t){l5[i]=t},Yc.registerForPluginStateChange=function(i){return i({pluginStatus:Ur,pluginURL:Bc}),jy.on("pluginStateChange",i),i};class Ire{constructor(t){this._hashName=t&&encodeURIComponent(t),pt(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=h9(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,m.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),m.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=f9(t);if(this._hashName){const l=this._hashName;let u=!1;const h=m.location.hash.slice(1).split("&").map(p=>{const g=p.split("=")[0];return g===l?(u=!0,`${g}=${r}`):p}).filter(p=>p);return u||h.push(`${l}=${r}`),`#${h.join("&")}`}return`#${r}`}_getCurrentHash(){const t=m.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(l=>l.split("=")).forEach(l=>{l[0]===this._hashName&&(r=l)}),(r&&r[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(l=>isNaN(l))){const l=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(r[3]||0):t.getBearing();return t.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=m.location.href.replace(/(#.+)?$/,this.getHashString());m.history.replaceState(m.history.state,null,t)}}function f9(i,t){const r=i.getCenter(),l=Math.round(100*i.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),h=Math.pow(10,u),p=Math.round(r.lng*h)/h,g=Math.round(r.lat*h)/h,v=i.getBearing(),b=i.getPitch();let w=t?`/${p}/${g}/${l}`:`${l}/${g}/${p}`;return(v||b)&&(w+="/"+Math.round(10*v)/10),b&&(w+=`/${Math.round(b)}`),w}const O3={linearity:.3,easing:pe(0,0,.3,1)},Lre=Ue({deceleration:2500,maxSpeed:1400},O3),Rre=Ue({deceleration:20,maxSpeed:1400},O3),kre=Ue({deceleration:1e3,maxSpeed:360},O3),Dre=Ue({deceleration:1e3,maxSpeed:90},O3);class Ore{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Cn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Cn.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new V(0,0),pinchAround:void 0,around:void 0};for(const{settings:h}of this._inertiaBuffer)r.zoom+=h.zoomDelta||0,r.bearing+=h.bearingDelta||0,r.pitch+=h.pitchDelta||0,h.panDelta&&r.pan._add(h.panDelta),h.around&&(r.around=h.around),h.pinchAround&&(r.pinchAround=h.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const h=F3(r.pan.mag(),l,Ue({},Lre,t||{}));u.offset=r.pan.mult(h.amount/r.pan.mag()),u.center=this._map.transform.center,z3(u,h)}if(r.zoom){const h=F3(r.zoom,l,Rre);u.zoom=this._map.transform.zoom+h.amount,z3(u,h)}if(r.bearing){const h=F3(r.bearing,l,kre);u.bearing=this._map.transform.bearing+ae(h.amount,-179,179),z3(u,h)}if(r.pitch){const h=F3(r.pitch,l,Dre);u.pitch=this._map.transform.pitch+h.amount,z3(u,h)}if(u.zoom||u.bearing){const h=r.pinchAround===void 0?r.around:r.pinchAround;u.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),u.noMoveStart=!0,u}}function z3(i,t){(!i.duration||i.duration<t.duration)&&(i.duration=t.duration,i.easing=t.easing)}function F3(i,t,r){const{maxSpeed:l,linearity:u,deceleration:h}=r,p=ae(i*u/(t/1e3),-l,l),g=Math.abs(p)/(h*u);return{easing:r.easing,duration:1e3*g,amount:p*(g/2)}}class Fl extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l,u={}){const h=Pl(r.getCanvasContainer(),l);super(t,Ue({point:h,lngLat:r.unproject(h),originalEvent:l},u)),this._defaultPrevented=!1,this.target=r}}class N3 extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l){const u=t==="touchend"?l.changedTouches:l.touches,h=Sd(r.getCanvasContainer(),u),p=h.map(v=>r.unproject(v)),g=h.reduce((v,b,w,A)=>v.add(b.div(A.length)),new V(0,0));super(t,{points:h,point:g,lngLats:p,lngLat:r.unproject(g),originalEvent:l}),this._defaultPrevented=!1}}class zre extends Ht{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,l){super(t,{originalEvent:l}),this._defaultPrevented=!1}}class Fre{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new zre(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Fl(t.type,this._map,t))}mouseup(t){this._map.fire(new Fl(t.type,this._map,t))}preclick(t){const r=Ue({},t);r.type="preclick",this._map.fire(new Fl(r.type,this._map,r))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Fl(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Fl(t.type,this._map,t))}mouseover(t){this._map.fire(new Fl(t.type,this._map,t))}mouseout(t){this._map.fire(new Fl(t.type,this._map,t))}touchstart(t){return this._firePreventable(new N3(t.type,this._map,t))}touchmove(t){this._map.fire(new N3(t.type,this._map,t))}touchend(t){this._map.fire(new N3(t.type,this._map,t))}touchcancel(t){this._map.fire(new N3(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nre{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Fl(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Fl(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(Lp(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const l=r,u=this._startPos,h=this._lastPos;if(!u||!h||h.equals(l)||!this._box&&l.dist(u)<this._clickTolerance)return;this._lastPos=l,this._box||(this._box=Zn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const p=Math.min(u.x,l.x),g=Math.max(u.x,l.x),v=Math.min(u.y,l.y),b=Math.max(u.y,l.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${p}px,${v}px)`,this._box.style.width=g-p+"px",this._box.style.height=b-v+"px")})}mouseupWindow(t,r){if(!this._active)return;const l=this._startPos,u=r;if(l&&t.button===0){if(this.reset(),Cl(),l.x!==u.x||l.y!==u.y)return this._map.fire(new Ht("boxzoomend",{originalEvent:t})),{cameraAnimation:h=>h.fitScreenCoordinates(l,u,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),tc(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new Ht(t,{originalEvent:r}))}}function S5(i,t){const r={};for(let l=0;l<i.length;l++)r[i[l].identifier]=t[l];return r}class Ure{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const h=new V(0,0);for(const p of u)h._add(p);return h.div(u.length)}(r),this.touches=S5(l,r)))}touchmove(t,r,l){if(this.aborted||!this.centroid)return;const u=S5(l,r);for(const h in this.touches){const p=u[h];(!p||p.dist(this.touches[h])>30)&&(this.aborted=!0)}}touchend(t,r,l){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class A5{constructor(t){this.singleTap=new Ure(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,r,l){this.singleTap.touchstart(t,r,l)}touchmove(t,r,l){this.singleTap.touchmove(t,r,l)}touchend(t,r,l){const u=this.singleTap.touchend(t,r,l);if(u){const h=t.timeStamp-this.lastTime<500,p=!this.lastTap||this.lastTap.dist(u)<30;if(h&&p||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Wre{constructor(){this._zoomIn=new A5({numTouches:1,numTaps:2}),this._zoomOut=new A5({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,l){this._zoomIn.touchstart(t,r,l),this._zoomOut.touchstart(t,r,l)}touchmove(t,r,l){this._zoomIn.touchmove(t,r,l),this._zoomOut.touchmove(t,r,l)}touchend(t,r,l){const u=this._zoomIn.touchend(t,r,l),h=this._zoomOut.touchend(t,r,l);return u?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:p=>p.easeTo({duration:300,zoom:p.getZoom()+1,around:p.unproject(u)},{originalEvent:t})}):h?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:p=>p.easeTo({duration:300,zoom:p.getZoom()-1,around:p.unproject(h)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Vre={0:1,2:2};class E5{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,r){return!1}_move(t,r){return{}}mousedown(t,r){if(this._lastPoint)return;const l=jh(t);this._correctButton(t,l)&&(this._lastPoint=r,this._eventButton=l)}mousemoveWindow(t,r){const l=this._lastPoint;if(l){if(t.preventDefault(),this._eventButton!=null&&function(u,h){const p=Vre[h];return u.buttons===void 0||(u.buttons&p)!==p}(t,this._eventButton))this.reset();else if(this._moved||!(r.dist(l)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(l,r)}}mouseupWindow(t){this._lastPoint&&jh(t)===this._eventButton&&(this._moved&&Cl(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gre extends E5{mousedown(t,r){super.mousedown(t,r),this._lastPoint&&(this._active=!0)}_correctButton(t,r){return r===0&&!t.ctrlKey}_move(t,r){return{around:r,panDelta:r.sub(t)}}}class p9 extends E5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const l=.8*(r.x-t.x);if(l)return this._active=!0,{bearingDelta:l}}contextmenu(t){t.preventDefault()}}class m9 extends E5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const l=-.5*(r.y-t.y);if(l)return this._active=!0,{pitchDelta:l}}contextmenu(t){t.preventDefault()}}class Hre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),pt(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new V(0,0)}touchstart(t,r,l){return this._calculateTransform(t,r,l)}touchmove(t,r,l){if(this._active&&!(l.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(l.length===1&&!ot())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,l)}}touchend(t,r,l){this._calculateTransform(t,r,l),this._active&&l.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,l){l.length>0&&(this._active=!0);const u=S5(l,r),h=new V(0,0),p=new V(0,0);let g=0;for(const b in u){const w=u[b],A=this._touches[b];A&&(h._add(w),p._add(w.sub(A)),g++,u[b]=w)}if(this._touches=u,g<this._minTouches||!p.mag())return;const v=p.div(g);return this._sum._add(v),this._sum.mag()<this._clickTolerance?void 0:{around:h.div(g),panDelta:v}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Zn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class M5{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,r,l){return{}}touchstart(t,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,l){const u=this._firstTwoTouches;if(!u)return;t.preventDefault();const[h,p]=u,g=B3(l,r,h),v=B3(l,r,p);if(!g||!v)return;const b=this._aroundCenter?null:g.add(v).div(2);return this._move([g,v],b,t)}touchend(t,r,l){if(!this._firstTwoTouches)return;const[u,h]=this._firstTwoTouches,p=B3(l,r,u),g=B3(l,r,h);p&&g||(this._active&&Cl(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function B3(i,t,r){for(let l=0;l<i.length;l++)if(i[l].identifier===r)return t[l]}function g9(i,t){return Math.log(i/t)/Math.LN2}class jre extends M5{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const l=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(g9(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:g9(this._distance,l),pinchAround:r}}}function y9(i,t){return 180*i.angleWith(t)/Math.PI}class $re extends M5{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r){const l=this._vector;if(this._vector=t[0].sub(t[1]),l&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:y9(this._vector,l),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,l=this._startVector;if(!l)return!1;const u=y9(t,l);return Math.abs(u)<r}}function T5(i){return Math.abs(i.y)>Math.abs(i.x)}class qre extends M5{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,T5(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,l){const u=this._lastPoints;if(!u)return;const h=t[0].sub(u[0]),p=t[1].sub(u[1]);return this._map._cooperativeGestures&&!ot()&&l.touches.length<3||(this._valid=this.gestureBeginsVertically(h,p,l.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+p.y)/2*-.5})}gestureBeginsVertically(t,r,l){if(this._valid!==void 0)return this._valid;const u=t.mag()>=2,h=r.mag()>=2;if(!u&&!h)return;if(!u||!h)return this._firstMove==null&&(this._firstMove=l),l-this._firstMove<100&&void 0;const p=t.y>0==r.y>0;return T5(t)&&T5(r)&&p}}const Xre={panStep:100,bearingStep:15,pitchStep:10};class Yre{constructor(){const t=Xre;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,l=0,u=0,h=0,p=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?l=-1:(t.preventDefault(),h=-1);break;case 39:t.shiftKey?l=1:(t.preventDefault(),h=1);break;case 38:t.shiftKey?u=1:(t.preventDefault(),p=-1);break;case 40:t.shiftKey?u=-1:(t.preventDefault(),p=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:g=>{const v=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:Zre,zoom:r?Math.round(v)+r*(t.shiftKey?2:1):v,bearing:g.getBearing()+l*this._bearingStep,pitch:g.getPitch()+u*this._pitchStep,offset:[-h*this._panStep,-p*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Zre(i){return i*(2-i)}const v9=4.000244140625;class Kre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,pt(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||ot()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===m.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const l=Cn.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%v9==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=Pl(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>v9?this._wheelZoomRate:this._defaultZoomRate;let w=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&w!==0&&(w=1/w);const A=r(),C=Math.pow(2,A),P=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):C;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(P*w))),this._type==="wheel"&&(this._startZoom=A,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const l=typeof this._targetZoom=="number"?this._targetZoom:r(),u=this._startZoom,h=this._easing;let p,g=!1;if(this._type==="wheel"&&u&&h){const b=Math.min((Cn.now()-this._lastWheelEventTime)/200,1);p=Ln(u,l,h(b)),b<1?this._frameId||(this._frameId=!0):g=!0}else p=l,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let v=p-r();return v*this._lastDelta<0&&(v=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:v,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=Ae;if(this._prevEase){const l=this._prevEase,u=(Cn.now()-l.start)/l.duration,h=l.easing(u+.01)-l.easing(u),p=.27/Math.sqrt(h*h+1e-4)*.01;r=pe(p,Math.sqrt(.0729-p*p),.25,1)}return this._prevEase={start:Cn.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Zn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(m.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Jre{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Qre{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,r){return t.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:l.getZoom()+(t.shiftKey?-1:1),around:l.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class eoe{constructor(){this._tap=new A5({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,r,l){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?l.length>0&&(this._swipePoint=r[0],this._swipeTouch=l[0].identifier):this._tap.touchstart(t,r,l))}touchmove(t,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=r[0],h=u.y-this._swipePoint.y;return this._swipePoint=u,t.preventDefault(),this._active=!0,{zoomDelta:h/128}}}else this._tap.touchmove(t,r,l)}touchend(t,r,l){this._tapTime?this._swipePoint&&l.length===0&&this.reset():this._tap.touchend(t,r,l)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class toe{constructor(t,r,l){this._el=t,this._mousePan=r,this._touchPan=l}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class noe{constructor(t,r,l){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=l}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class aoe{constructor(t,r,l,u){this._el=t,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const U3=i=>i.zoom||i.drag||i.pitch||i.rotate;class ioe extends Ht{}class roe{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const l=ke.sub([],r,t);this.radius=ke.length(l[2]<0?ke.div([],l,this.constants):[l[0],l[1],0])}projectRay(t){ke.div(t,t,this.constants),ke.normalize(t,t),ke.mul(t,t,this.constants);const r=ke.scale([],t,this.radius);if(r[2]>0){const l=ke.scale([],[0,0,1],ke.dot(r,[0,0,1])),u=ke.scale([],ke.normalize([],[r[0],r[1],0]),this.radius),h=ke.add([],r,ke.scale([],ke.sub([],ke.add([],u,l),r),2));r[0]=h[0],r[1]=h[1]}return r}}function W3(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}class ooe{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ore(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new roe,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),pt(["handleEvent","handleWindowEvent"],this);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[m.document,"mousemove",{capture:!0}],[m.document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[m,"blur",void 0]];for(const[u,h,p]of this._listeners)u.addEventListener(h,u===m.document?this.handleWindowEvent:this.handleEvent,p)}destroy(){for(const[t,r,l]of this._listeners)t.removeEventListener(r,t===m.document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(t){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new Fre(r,t));const u=r.boxZoom=new Bre(r,t);this._add("boxZoom",u);const h=new Wre,p=new Qre;r.doubleClickZoom=new Jre(p,h),this._add("tapZoom",h),this._add("clickZoom",p);const g=new eoe;this._add("tapDragZoom",g);const v=r.touchPitch=new qre(r);this._add("touchPitch",v);const b=new p9(t),w=new m9(t);r.dragRotate=new noe(t,b,w),this._add("mouseRotate",b,["mousePitch"]),this._add("mousePitch",w,["mouseRotate"]);const A=new Gre(t),C=new Hre(r,t);r.dragPan=new toe(l,A,C),this._add("mousePan",A),this._add("touchPan",C,["touchZoom","touchRotate"]);const P=new $re,R=new jre;r.touchZoomRotate=new aoe(l,R,P,g),this._add("touchRotate",P,["touchPan","touchZoom"]),this._add("touchZoom",R,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Nre(r));const z=r.scrollZoom=new Kre(r,this);this._add("scrollZoom",z,["mousePan"]);const U=r.keyboard=new Yre;this._add("keyboard",U);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[W]&&r[W].enable(t[W])}_add(t,r,l){this._handlers.push({handlerName:t,handler:r,allowed:l}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!U3(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,r,l){for(const u in t)if(u!==l&&(!r||r.indexOf(u)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const r=[];for(const l of t)this._el.contains(l.target)&&r.push(l);return r}handleEvent(t,r){this._updatingCamera=!0;const l=t.type==="renderFrame",u=l?void 0:t,h={needsRenderFrame:!1},p={},g={},v=t.touches?this._getMapTouches(t.touches):void 0,b=v?Sd(this._el,v):l?void 0:Pl(this._el,t);for(const{handlerName:C,handler:P,allowed:R}of this._handlers){if(!P.isEnabled())continue;let z;this._blockedByActive(g,R,C)?P.reset():P[r||t.type]&&(z=P[r||t.type](t,b,v),this.mergeHandlerResult(h,p,z,C,u),z&&z.needsRenderFrame&&this._triggerRenderFrame()),(z||P.isActive())&&(g[C]=P)}const w={};for(const C in this._previousActiveHandlers)g[C]||(w[C]=u);this._previousActiveHandlers=g,(Object.keys(w).length||W3(h))&&(this._changes.push([h,p,w]),this._triggerRenderFrame()),(Object.keys(g).length||W3(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:A}=h;A&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],A(this._map))}mergeHandlerResult(t,r,l,u,h){if(!l)return;Ue(t,l);const p={handlerName:u,originalEvent:l.originalEvent||h};l.zoomDelta!==void 0&&(r.zoom=p),l.panDelta!==void 0&&(r.drag=p),l.pitchDelta!==void 0&&(r.pitch=p),l.bearingDelta!==void 0&&(r.rotate=p)}_applyChanges(){const t={},r={},l={};for(const[u,h,p]of this._changes)u.panDelta&&(t.panDelta=(t.panDelta||new V(0,0))._add(u.panDelta)),u.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(t.around=u.around),u.aroundCoord!==void 0&&(t.aroundCoord=u.aroundCoord),u.pinchAround!==void 0&&(t.pinchAround=u.pinchAround),u.noInertia&&(t.noInertia=u.noInertia),Ue(r,h),Ue(l,p);this._updateMapTransform(t,r,l),this._changes=[]}_updateMapTransform(t,r,l){const u=this._map,h=u.transform,p=j=>[j.x,j.y,j.z];if((j=>{const Y=this._eventsInProgress.drag;return Y&&!this._handlersById[Y.handlerName].isActive()})()&&!W3(t)){const j=h.zoom;h.cameraElevationReference="sea",this._originalZoom!=null&&h._orthographicProjectionAtLowPitch&&h.projection.name!=="globe"&&h.pitch===0?(h.cameraElevationReference="ground",h.zoom=this._originalZoom):(h.recenterOnTerrain(),h.cameraElevationReference="ground"),j!==h.zoom&&this._map._update(!0)}if(h._isCameraConstrained&&u._stop(!0),!W3(t))return void this._fireEvents(r,l,!0);let{panDelta:g,zoomDelta:v,bearingDelta:b,pitchDelta:w,around:A,aroundCoord:C,pinchAround:P}=t;h._isCameraConstrained&&(v>0&&(v=0),h._isCameraConstrained=!1),P!==void 0&&(A=P),(v||(j=>r[j]&&!this._eventsInProgress[j])("drag"))&&A&&(this._dragOrigin=p(h.pointCoordinate3D(A)),this._originalZoom=h.zoom,this._trackingEllipsoid.setup(h._camera.position,this._dragOrigin)),h.cameraElevationReference="sea",u._stop(!0),A=A||u.transform.centerPoint,b&&(h.bearing+=b),w&&(h.pitch+=w),h._updateCameraState();const R=[0,0,0];if(g)if(h.projection.name==="mercator"){const j=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(A).dir),Y=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(A.sub(g)).dir);R[0]=Y[0]-j[0],R[1]=Y[1]-j[1]}else{const j=h.pointCoordinate(A);if(h.projection.name==="globe"){g=g.rotate(-h.angle);const Y=h._pixelsPerMercatorPixel/h.worldSize;R[0]=-g.x*nP(gr(j.y))*Y,R[1]=-g.y*nP(h.center.lat)*Y}else{const Y=h.pointCoordinate(A.sub(g));j&&Y&&(R[0]=Y.x-j.x,R[1]=Y.y-j.y)}}const z=h.zoom,U=[0,0,0];if(v){const j=p(C||h.pointCoordinate3D(A)),Y={dir:ke.normalize([],ke.sub([],j,h._camera.position))};if(Y.dir[2]<0){const Z=h.zoomDeltaToMovement(j,v);ke.scale(U,Y.dir,Z)}}const W=ke.add(R,R,U);h._translateCameraConstrained(W),v&&Math.abs(h.zoom-z)>1e-4&&h.recenterOnTerrain(),h.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,l,!0)}_fireEvents(t,r,l){const u=U3(this._eventsInProgress),h=U3(t),p={};for(const w in t){const{originalEvent:A}=t[w];this._eventsInProgress[w]||(p[`${w}start`]=A),this._eventsInProgress[w]=t[w]}!u&&h&&this._fireEvent("movestart",h.originalEvent);for(const w in p)this._fireEvent(w,p[w]);h&&this._fireEvent("move",h.originalEvent);for(const w in t){const{originalEvent:A}=t[w];this._fireEvent(w,A)}const g={};let v;for(const w in this._eventsInProgress){const{handlerName:A,originalEvent:C}=this._eventsInProgress[w];this._handlersById[A].isActive()||(delete this._eventsInProgress[w],v=r[A]||C,g[`${w}end`]=v)}for(const w in g)this._fireEvent(w,g[w]);const b=U3(this._eventsInProgress);if(l&&(u||h)&&!b){this._updatingCamera=!0;const w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),A=C=>C!==0&&-this._bearingSnap<C&&C<this._bearingSnap;w?(A(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:v})):(this._map.fire(new Ht("moveend",{originalEvent:v})),A(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new Ht(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new ioe("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const _9="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class soe extends Bn{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=r.respectPrefersReducedMotion!==!1,pt(["_renderFrameCallback"],this)}getCenter(){return new On(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,l){return t=V.convert(t).mult(-1),this.panTo(this.transform.center,Ue({offset:t},r),l)}panTo(t,r,l){return this.easeTo(Ue({center:t},r),l)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,l){return this.easeTo(Ue({zoom:t},r),l)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,l){return this.easeTo(Ue({bearing:t},r),l)}resetNorth(t,r){return this.rotateTo(0,Ue({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(Ue({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Dl.convert(t);const l=r&&r.bearing||0,u=r&&r.pitch||0,h=t.getNorthWest(),p=t.getSouthEast();return this._cameraForBounds(this.transform,h,p,l,u,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if(typeof(t=Ue({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const l=t.padding;t.padding={top:l,bottom:l,right:l,left:l}}return t.padding=Ue(r,t.padding),t}_minimumAABBFrustumDistance(t,r){const l=r.max[0]-r.min[0],u=r.max[1]-r.min[1];return l/u>t.aspect?l/(2*Math.tan(.5*t.fovX)*t.aspect):u/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,r,l,u,h,p){const g=t.clone(),v=this._extendCameraOptions(p);g.bearing=u,g.pitch=h;const b=On.convert(r),w=On.convert(l),A=.5*(b.lat+w.lat),C=.5*(b.lng+w.lng),P=Fs(A,C),R=ke.normalize([],P),z=ke.normalize([],ke.cross([],R,[0,1,0])),U=ke.cross([],z,R),W=[z[0],z[1],z[2],0,U[0],U[1],U[2],0,R[0],R[1],R[2],0,0,0,0,1],j=[P,Fs(b.lat,b.lng),Fs(w.lat,b.lng),Fs(w.lat,w.lng),Fs(b.lat,w.lng),Fs(A,b.lng),Fs(A,w.lng),Fs(b.lat,C),Fs(w.lat,C)];let Y=hi.fromPoints(j.map(Ve=>[ke.dot(z,Ve),ke.dot(U,Ve),ke.dot(R,Ve)]));const Z=ke.transformMat4([],Y.center,W);ke.squaredLength(Z)===0&&ke.set(Z,0,0,1),ke.normalize(Z,Z),ke.scale(Z,Z,hs),g.center=function([Ve,it,gt]){const ct=Math.hypot(Ve,it,gt),Pt=Math.atan2(Ve,gt),Ft=.5*Math.PI-Math.acos(-it/ct);return new On(fe(Pt),fe(Ft))}(Z);const $=g.getWorldToCameraMatrix(),K=at.invert(new Float64Array(16),$);Y=hi.applyTransform(Y,at.multiply([],$,W)),ke.transformMat4(Z,Z,$);const ie=.5*(Y.max[2]-Y.min[2]),ce=this._minimumAABBFrustumDistance(g,Y),he=ke.scale([],[0,0,1],ie),ye=ke.add(he,Z,he),Te=ce+(g.pitch===0?0:ke.distance(Z,ye)),we=g.globeCenterInViewSpace,Ie=ke.sub([],Z,[we[0],we[1],we[2]]);ke.normalize(Ie,Ie),ke.scale(Ie,Ie,Te);const xe=ke.add([],Z,Ie);ke.transformMat4(xe,xe,K);const We=ev/hs,qe=ke.length(xe),et=$a(Math.max(qe*We-ev,Number.EPSILON),0),Ne=Math.min(g.zoomFromMercatorZAdjusted(et),v.maxZoom);return Ne>.5*(n1+gf)?(g.setProjection({name:"mercator"}),g.zoom=Ne,this._cameraForBounds(g,r,l,u,h,p)):{center:g.center,zoom:Ne,bearing:u,pitch:h}}queryTerrainElevation(t,r){const l=this.transform.elevation;return l?(r=Ue({},{exaggerated:!0},r),l.getAtPoint(ga.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,l,u,h,p){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,r,l,u,h,p);const g=t.clone(),v=this._extendCameraOptions(p),b=g.padding;g.bearing=u,g.pitch=h;const w=On.convert(r),A=On.convert(l),C=new On(w.lng,A.lat),P=new On(A.lng,w.lat),R=g.project(w),z=g.project(A),U=this.queryTerrainElevation(w),W=this.queryTerrainElevation(A),j=this.queryTerrainElevation(C),Y=this.queryTerrainElevation(P),Z=[[R.x,R.y,Math.min(U||0,W||0,j||0,Y||0)],[z.x,z.y,Math.max(U||0,W||0,j||0,Y||0)]];let $=hi.fromPoints(Z);const K=g.getWorldToCameraMatrix(),ie=at.invert(new Float64Array(16),K);$=hi.applyTransform($,K);const ce=ke.sub([],$.max,$.min),he=b.left||0,ye=b.right||0,Te=b.bottom||0,we=b.top||0,{left:Ie,right:xe,top:We,bottom:qe}=v.padding,et=.5*(he+ye),Ne=.5*(we+Te),Ve=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(he+ye+Ie+xe))/ce[0],(g.height-(Te+we+qe+We))/ce[1])),v.maxZoom),it=g.scale/g.zoomScale(Ve);$=new hi([$.min[0]-(Ie+et)*it,$.min[1]-(qe+Ne)*it,$.min[2]],[$.max[0]+(xe+et)*it,$.max[1]+(We+Ne)*it,$.max[2]]);const gt=.5*ce[2],ct=this._minimumAABBFrustumDistance(g,$),Pt=[0,0,1,0];Ga.transformMat4(Pt,Pt,K),Ga.normalize(Pt,Pt);const Ft=ke.scale([],Pt,ct+gt),xt=ke.add([],$.center,Ft),Mt=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new V(v.offset.x,v.offset.y):V.convert(v.offset)).rotate(-be(u));$.center[0]-=Mt.x*it,$.center[1]+=Mt.y*it,ke.transformMat4($.center,$.center,ie),ke.transformMat4(xt,xt,ie);const en=[$.center[0],$.center[1],xt[2]*g.pixelsPerMeter];ke.scale(en,en,1/g.worldSize);const on=ol(en[0]),rn=gr(en[1]),cn=Math.min(g._zoomFromMercatorZ(en[2]),v.maxZoom),gn=new On(on,rn);return g.mercatorFromTransition&&cn<.5*(n1+gf)?(g.setProjection({name:"globe"}),g.zoom=cn,this._cameraForBounds(g,r,l,u,h,p)):{center:gn,zoom:cn,bearing:u,pitch:h}}fitBounds(t,r,l){const u=this.cameraForBounds(t,r);return this._fitInternal(u,r,l)}fitScreenCoordinates(t,r,l,u,h){const p=V.convert(t),g=V.convert(r),v=new V(Math.min(p.x,g.x),Math.min(p.y,g.y)),b=new V(Math.max(p.x,g.x),Math.max(p.y,g.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(p,g))return this;const w=this.transform.pointLocation3D(v),A=this.transform.pointLocation3D(b),C=this.transform.pointLocation3D(new V(v.x,b.y)),P=this.transform.pointLocation3D(new V(b.x,v.y)),R=[Math.min(w.lng,A.lng,C.lng,P.lng),Math.min(w.lat,A.lat,C.lat,P.lat)],z=[Math.max(w.lng,A.lng,C.lng,P.lng),Math.max(w.lat,A.lat,C.lat,P.lat)],U=u&&u.pitch?u.pitch:this.getPitch(),W=this._cameraForBounds(this.transform,R,z,l,U,u);return this._fitInternal(W,u,h)}_fitInternal(t,r,l){return t?(delete(r=Ue(t,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(t,r){this.stop();const l=t.preloadOnly?this.transform.clone():this.transform;let u=!1,h=!1,p=!1;return"zoom"in t&&l.zoom!==+t.zoom&&(u=!0,l.zoom=+t.zoom),t.center!==void 0&&(l.center=On.convert(t.center)),"bearing"in t&&l.bearing!==+t.bearing&&(h=!0,l.bearing=+t.bearing),"pitch"in t&&l.pitch!==+t.pitch&&(p=!0,l.pitch=+t.pitch),t.padding==null||l.isPaddingEqual(t.padding)||(l.padding=t.padding),t.preloadOnly?(this._preloadTiles(l),this):(this.fire(new Ht("movestart",r)).fire(new Ht("move",r)),u&&this.fire(new Ht("zoomstart",r)).fire(new Ht("zoom",r)).fire(new Ht("zoomend",r)),h&&this.fire(new Ht("rotatestart",r)).fire(new Ht("rotate",r)).fire(new Ht("rotateend",r)),p&&this.fire(new Ht("pitchstart",r)).fire(new Ht("pitch",r)).fire(new Ht("pitchend",r)),this.fire(new Ht("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||ve(_9),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const l=this.transform;if(!l.projection.supportsFreeCamera)return ve(_9),this;this.stop();const u=l.zoom,h=l.pitch,p=l.bearing;l.setFreeCameraOptions(t);const g=u!==l.zoom,v=h!==l.pitch,b=p!==l.bearing;return this.fire(new Ht("movestart",r)).fire(new Ht("move",r)),g&&this.fire(new Ht("zoomstart",r)).fire(new Ht("zoom",r)).fire(new Ht("zoomend",r)),b&&this.fire(new Ht("rotatestart",r)).fire(new Ht("rotate",r)).fire(new Ht("rotateend",r)),v&&this.fire(new Ht("pitchstart",r)).fire(new Ht("pitch",r)).fire(new Ht("pitchend",r)),this.fire(new Ht("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),((t=Ue({offset:[0,0],duration:500,easing:Ae},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const l=this.transform,u=this.getZoom(),h=this.getBearing(),p=this.getPitch(),g=this.getPadding(),v="zoom"in t?+t.zoom:u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:p,A="padding"in t?t.padding:l.padding,C=V.convert(t.offset);let P,R,z;if(l.projection.name==="globe"){const he=ga.fromLngLat(l.center),ye=C.rotate(-l.angle);he.x+=ye.x/l.worldSize,he.y+=ye.y/l.worldSize;const Te=he.toLngLat(),we=On.convert(t.center||Te);this._normalizeCenter(we),P=l.centerPoint.add(ye),R=new V(he.x,he.y).mult(l.worldSize),z=new V(_o(we.lng),Co(we.lat)).mult(l.worldSize).sub(R)}else{P=l.centerPoint.add(C);const he=l.pointLocation(P),ye=On.convert(t.center||he);this._normalizeCenter(ye),R=l.project(he),z=l.project(ye).sub(R)}const U=l.zoomScale(v-u);let W,j;t.around&&(W=On.convert(t.around),j=l.locationPoint(W));const Y=this._zooming||v!==u,Z=this._rotating||h!==b,$=this._pitching||w!==p,K=!l.isPaddingEqual(A),ie=he=>ye=>{if(Y&&(he.zoom=Ln(u,v,ye)),Z&&(he.bearing=Ln(h,b,ye)),$&&(he.pitch=Ln(p,w,ye)),K&&(he.interpolatePadding(g,A,ye),P=he.centerPoint.add(C)),W)he.setLocationAtPoint(W,j);else{const Te=he.zoomScale(he.zoom-u),we=v>u?Math.min(2,U):Math.max(.5,U),Ie=Math.pow(we,1-ye),xe=he.unproject(R.add(z.mult(ye*Ie)).mult(Te));he.setLocationAtPoint(he.renderWorldCopies?xe.wrap():xe,P)}return t.preloadOnly||this._fireMoveEvents(r),he};if(t.preloadOnly){const he=this._emulate(ie,t.duration,l);return this._preloadTiles(he),this}const ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Y,this._rotating=Z,this._pitching=$,this._padding=K,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,ce),this._ease(ie(l),he=>{l.cameraElevationReference==="sea"&&l.recenterOnTerrain(),this._afterEase(r,he)},t),this}_prepareEase(t,r,l={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),r||l.moving||this.fire(new Ht("movestart",t)),this._zooming&&!l.zooming&&this.fire(new Ht("zoomstart",t)),this._rotating&&!l.rotating&&this.fire(new Ht("rotatestart",t)),this._pitching&&!l.pitching&&this.fire(new Ht("pitchstart",t))}_fireMoveEvents(t){this.fire(new Ht("move",t)),this._zooming&&this.fire(new Ht("zoom",t)),this._rotating&&this.fire(new Ht("rotate",t)),this._pitching&&this.fire(new Ht("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const l=this._zooming,u=this._rotating,h=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,l&&this.fire(new Ht("zoomend",t)),u&&this.fire(new Ht("rotateend",t)),h&&this.fire(new Ht("pitchend",t)),this.fire(new Ht("moveend",t))}flyTo(t,r){if(this._prefersReducedMotion(t)){const Ve=ft(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ve,r)}this.stop(),t=Ue({offset:[0,0],speed:1.2,curve:1.42,easing:Ae},t);const l=this.transform,u=this.getZoom(),h=this.getBearing(),p=this.getPitch(),g=this.getPadding(),v="zoom"in t?ae(+t.zoom,l.minZoom,l.maxZoom):u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:p,A="padding"in t?t.padding:l.padding,C=l.zoomScale(v-u),P=V.convert(t.offset);let R=l.centerPoint.add(P);const z=l.pointLocation(R),U=On.convert(t.center||z);this._normalizeCenter(U);const W=l.project(z),j=l.project(U).sub(W);let Y=t.curve;const Z=Math.max(l.width,l.height),$=Z/C,K=j.mag();if("minZoom"in t){const Ve=ae(Math.min(t.minZoom,u,v),l.minZoom,l.maxZoom),it=Z/l.zoomScale(Ve-u);Y=Math.sqrt(it/K*2)}const ie=Y*Y;function ce(Ve){const it=($*$-Z*Z+(Ve?-1:1)*ie*ie*K*K)/(2*(Ve?$:Z)*ie*K);return Math.log(Math.sqrt(it*it+1)-it)}function he(Ve){return(Math.exp(Ve)-Math.exp(-Ve))/2}function ye(Ve){return(Math.exp(Ve)+Math.exp(-Ve))/2}const Te=ce(0);let we=function(Ve){return ye(Te)/ye(Te+Y*Ve)},Ie=function(Ve){return Z*((ye(Te)*(he(it=Te+Y*Ve)/ye(it))-he(Te))/ie)/K;var it},xe=(ce(1)-Te)/Y;if(Math.abs(K)<1e-6||!isFinite(xe)){if(Math.abs(Z-$)<1e-6)return this.easeTo(t,r);const Ve=$<Z?-1:1;xe=Math.abs(Math.log($/Z))/Y,Ie=function(){return 0},we=function(it){return Math.exp(Ve*Y*it)}}t.duration="duration"in t?+t.duration:1e3*xe/("screenSpeed"in t?+t.screenSpeed/Y:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const We=h!==b,qe=w!==p,et=!l.isPaddingEqual(A),Ne=Ve=>it=>{const gt=it*xe,ct=1/we(gt);Ve.zoom=it===1?v:u+Ve.scaleZoom(ct),We&&(Ve.bearing=Ln(h,b,it)),qe&&(Ve.pitch=Ln(p,w,it)),et&&(Ve.interpolatePadding(g,A,it),R=Ve.centerPoint.add(P));const Pt=it===1?U:Ve.unproject(W.add(j.mult(Ie(gt))).mult(ct));return Ve.setLocationAtPoint(Ve.renderWorldCopies?Pt.wrap():Pt,R),Ve._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),Ve};if(t.preloadOnly){const Ve=this._emulate(Ne,t.duration,l);return this._preloadTiles(Ve),this}return this._zooming=!0,this._rotating=We,this._pitching=qe,this._padding=et,this._prepareEase(r,!1),this._ease(Ne(l),()=>this._afterEase(r),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const l=this._onEaseEnd;this._onEaseEnd=void 0,l.call(this,r)}if(!t){const l=this.handlers;l&&l.stop(!1)}return this}_ease(t,r,l){l.animate===!1||l.duration===0?(t(1),r()):(this._easeStart=Cn.now(),this._easeOptions=l,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Cn.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=Ze(t,-180,180);const l=Math.abs(t-r);return Math.abs(t-360-r)<l&&(t-=360),Math.abs(t+360-r)<l&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(!r.renderWorldCopies||r.maxBounds)return;const l=t.lng-r.center.lng;t.lng+=l>180?-360:l<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Cn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,r,l){const u=Math.ceil(15*r/1e3),h=[],p=t(l.clone());for(let g=0;g<=u;g++){const v=p(g/u);h.push(v.clone())}return h}}class b9{constructor(t={}){this.options=t,pt(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const r=this.options&&this.options.compact;return this._map=t,this._container=Zn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Zn("button","mapboxgl-ctrl-attrib-button",this._container),Zn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Zn("div","mapboxgl-ctrl-attrib-inner",this._container),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),r===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,r){const l=this._map._getUIString(`AttributionControl.${r}`);t.setAttribute("aria-label",l),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",l)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||x.ACCESS_TOKEN}];if(t){const l=r.reduce((u,h,p)=>(h.value&&(u+=`${h.key}=${h.value}${p<r.length-1?"&":""}`),u),"?");t.href=`${x.FEEDBACK_URL}/${l}#${f9(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style._sourceCaches;for(const u in r){const h=r[u];if(h.used){const p=h.getSource();p.attribution&&t.indexOf(p.attribution)<0&&t.push(p.attribution)}}t.sort((u,h)=>u.length-h.length),t=t.filter((u,h)=>{for(let p=h+1;p<t.length;p++)if(t[p].indexOf(u)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const l=t.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,t.length?(this._innerContainer.innerHTML=l,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class x9{constructor(){pt(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Zn("div","mapboxgl-ctrl");const r=Zn("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const r in t){const l=t[r].getSource();if(l.hasOwnProperty("mapbox_logo")&&!l.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const r=t[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class w9{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const u of l)if(u.id===t)return void(u.cancelled=!0)}run(t=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function S9(i,t,r){if(i=new On(i.lng,i.lat),t){const l=new On(i.lng-360,i.lat),u=new On(i.lng+360,i.lat),h=360*Math.ceil(Math.abs(i.lng-r.center.lng)/360),p=r.locationPoint(i).distSqr(t),g=t.x<0||t.y<0||t.x>r.width||t.y>r.height;r.locationPoint(l).distSqr(t)<p&&(g||Math.abs(l.lng-r.center.lng)<h)?i=l:r.locationPoint(u).distSqr(t)<p&&(g||Math.abs(u.lng-r.center.lng)<h)&&(i=u)}for(;Math.abs(i.lng-r.center.lng)>180;){const l=r.locationPoint(i);if(l.x>=0&&l.y>=0&&l.x<=r.width&&l.y<=r.height)break;i.lng>r.center.lng?i.lng-=360:i.lng+=360}return i}const C5={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class P5 extends Bn{constructor(t,r){if(super(),(t instanceof m.HTMLElement||r)&&(t=Ue({element:t},r)),pt(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=V.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Zn("div");const h=41,p=27,g=Gi("svg",{display:"block",height:h*this._scale+"px",width:p*this._scale+"px",viewBox:`0 0 ${p} ${h}`},this._element),v=Gi("radialGradient",{id:"shadowGradient"},Gi("defs",{},g));Gi("stop",{offset:"10%","stop-opacity":.4},v),Gi("stop",{offset:"100%","stop-opacity":.05},v),Gi("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),Gi("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),Gi("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),Gi("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=V.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()});const l=this._element.classList;for(const h in C5)l.remove(`mapboxgl-marker-anchor-${h}`);l.add(`mapboxgl-marker-anchor-${this._anchor}`);const u=t&&t.className?t.className.trim().split(/\s+/):[];l.add(...u),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=On.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const u=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const r=t.code,l=t.charCode||t.keyCode;r!=="Space"&&r!=="Enter"&&l!==32&&l!==13||this.togglePopup()}_onMapClick(t){const r=t.originalEvent.target,l=this._element;this._popup&&(r===l||l.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,r=this._pos;if(!t||!r)return!1;const l=t.unproject(r),u=t.getFreeCameraOptions();if(!u.position)return!1;const h=u.position.toLngLat();return h.distanceTo(l)<.9*h.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const l=t.unproject(r);let u;t._showingGlobe()&&T2(t.transform,this._lngLat)?u=0:(u=1-t._queryFogOpacity(l),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(u*=this._occludedOpacity)),this._element.style.opacity=`${u}`,this._element.style.pointerEvents=u>0?"auto":"none",this._popup&&this._popup._setOpacity(u),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${C5[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${r.x}px,${r.y}px)
        `}_calculateXYTransform(){const t=this._pos,r=this._map,l=this.getPitchAlignment();if(!r||!t||l!=="map")return"";if(!r._showingGlobe()){const v=r.getPitch();return v?`rotateX(${v}deg)`:""}const u=fe(cF(r.transform,this._lngLat)),h=t.sub(lF(r.transform)),p=Math.abs(h.x)+Math.abs(h.y);if(p===0)return"";const g=u/p;return`rotateX(${-h.y*g}deg) rotateY(${h.x*g}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let l=0;const u=this.getRotationAlignment();if(u==="map")if(r._showingGlobe()){const h=r.project(new On(this._lngLat.lng,this._lngLat.lat+.001)),p=r.project(new On(this._lngLat.lng,this._lngLat.lat-.001)).sub(h);l=fe(Math.atan2(p.y,p.x))-90}else l=-r.getBearing();else if(u==="horizon"){const h=Ee(4,6,r.getZoom()),p=lF(r.transform);p.y+=h*r.transform.height;const g=t.sub(p),v=fe(Math.atan2(g.y,g.x));l=(v>90?v-270:v+90)*(1-h)}return l+=this._rotation,l?`rotateZ(${l}deg)`:""}_update(t){m.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=S9(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),t===!0?this._updateFrameId=m.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=V.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const r=this._map;if(!r)return;const l=this._pointerdownPos,u=this._positionDelta;if(l&&u){if(!this._isDragging){const h=this._clickTolerance||r._clickTolerance;if(t.point.dist(l)<h)return;this._isDragging=!0}this._pos=t.point.sub(u),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Ht("dragstart"))),this.fire(new Ht("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new Ht("dragend")),this._state="inactive"}_addDragHandler(t){const r=this._map,l=this._pos;r&&l&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(l),this._pointerdownPos=t.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const r=this._map;return r&&(t?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const loe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},coe=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function A9(i=new V(0,0),t="bottom"){if(typeof i=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(i,2)));switch(t){case"top":return new V(0,i);case"top-left":return new V(r,r);case"top-right":return new V(-r,r);case"bottom":return new V(0,-i);case"bottom-left":return new V(r,-r);case"bottom-right":return new V(-r,-r);case"left":return new V(i,0);case"right":return new V(-i,0)}return new V(0,0)}return i instanceof V||Array.isArray(i)?V.convert(i):V.convert(i[t]||[0,0])}class uoe{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=Le((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,r,l){this._start=this.getValue(r),this._end=t,this._startTime=r,this._endTime=r+l}}const doe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},hoe={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},foe={showCompass:!0,showZoom:!0,visualizePitch:!1};class poe{constructor(t,r,l=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new p9({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,l&&(this.mousePitch=new m9({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),pt(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,r){this.mouseRotate.mousedown(t,r),this.mousePitch&&this.mousePitch.mousedown(t,r),Lp()}move(t,r){const l=this.map,u=this.mouseRotate.mousemoveWindow(t,r),h=u&&u.bearingDelta;if(h&&l.setBearing(l.getBearing()+h),this.mousePitch){const p=this.mousePitch.mousemoveWindow(t,r),g=p&&p.pitchDelta;g&&l.setPitch(l.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){tc(),m.removeEventListener("mousemove",this.mousemove),m.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Ue({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),Pl(this.element,t)),m.addEventListener("mousemove",this.mousemove),m.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,Pl(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Sd(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Sd(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const moe={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},goe={maxWidth:100,unit:"metric"},yoe={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},V3={version:y,supported:Ra,setRTLTextPlugin:function(i,t,r=!1){if(Ur===Gy||Ur===Hy||Ur===Nc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Bc=Cn.resolveURL(i),Ur=Gy,j_=t,$_(),r||p2()},getRTLTextPluginStatus:q_,Map:class extends soe{constructor(i){if(Yi.mark(ti.create),(i=Ue({},hoe,i)).minZoom!=null&&i.maxZoom!=null&&i.minZoom>i.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(i.minPitch!=null&&i.maxPitch!=null&&i.minPitch>i.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(i.minPitch!=null&&i.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(i.maxPitch!=null&&i.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(i.antialias&&function(t){const r=t.navigator?t.navigator.userAgent:null;return!!function(l){if(mt==null){const u=l.navigator?l.navigator.userAgent:null;mt=!!l.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return mt}(t)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(m)&&(i.antialias=!1,ve("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new GP(i.minZoom,i.maxZoom,i.minPitch,i.maxPitch,i.renderWorldCopies),i),this._interactive=i.interactive,this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._failIfMajorPerformanceCaveat=i.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=i.preserveDrawingBuffer,this._antialias=i.antialias,this._trackResize=i.trackResize,this._bearingSnap=i.bearingSnap,this._refreshExpiredTiles=i.refreshExpiredTiles,this._fadeDuration=i.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=i.crossSourceCollisions,this._collectResourceTiming=i.collectResourceTiming,this._language=this._parseLanguage(i.language),this._worldview=i.worldview,this._renderTaskQueue=new w9,this._domRenderTaskQueue=new w9,this._controls=[],this._markers=[],this._popups=[],this._mapId=kt(),this._locale=Ue({},doe,i.locale),this._clickTolerance=i.clickTolerance,this._cooperativeGestures=i.cooperativeGestures,this._performanceMetricsCollection=i.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new uoe(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new nn(i.transformRequest,i.accessToken,i.testMode),this._silenceAuthErrors=!!i.testMode,typeof i.container=="string"){if(this._container=m.document.getElementById(i.container),!this._container)throw new Error(`Container '${i.container.toString()}' not found.`)}else{if(!(i.container instanceof m.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=i.container}if(this._container.childNodes.length>0&&ve("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),i.maxBounds&&this.setMaxBounds(i.maxBounds),pt(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),m!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in m.document?"fullscreenchange":"webkitfullscreenchange",m.addEventListener("online",this._onWindowOnline,!1),m.addEventListener("resize",this._onWindowResize,!1),m.addEventListener("orientationchange",this._onWindowResize,!1),m.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),m.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ooe(this,i),this._localFontFamily=i.localFontFamily,this._localIdeographFontFamily=i.localIdeographFontFamily,(i.style||!i.testMode)&&this.setStyle(i.style||x.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),i.projection&&this.setProjection(i.projection),i.hash&&(this._hash=new Ire(typeof i.hash=="string"&&i.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch});const t=i.bounds;t&&(this.resize(),this.fitBounds(t,Ue({},i.fitBoundsOptions,{duration:0})))}this.resize(),i.attributionControl&&this.addControl(new b9({customAttribution:i.customAttribution})),this._logoControl=new x9,this.addControl(this._logoControl,i.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new Ht(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new Ht(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(i,t){if(t===void 0&&(t=i.getDefaultPosition?i.getDefaultPosition():"top-right"),!i||!i.onAdd)return this.fire(new vn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=i.onAdd(this);this._controls.push(i);const l=this._controlPositions[t];return t.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(i){if(!i||!i.onRemove)return this.fire(new vn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(i);return t>-1&&this._controls.splice(t,1),i.onRemove(this),this}hasControl(i){return this._controls.indexOf(i)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(i){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new Ht("movestart",i)).fire(new Ht("move",i)),this.fire(new Ht("resize",i)),t&&this.fire(new Ht("moveend",i)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(i){return this.transform.setMaxBounds(Dl.convert(i)),this._update()}setMinZoom(i){if((i=i??-2)>=-2&&i<=this.transform.maxZoom)return this.transform.minZoom=i,this._update(),this.getZoom()<i?this.setZoom(i):this.fire(new Ht("zoomstart")).fire(new Ht("zoom")).fire(new Ht("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(i){if((i=i??22)>=this.transform.minZoom)return this.transform.maxZoom=i,this._update(),this.getZoom()>i?this.setZoom(i):this.fire(new Ht("zoomstart")).fire(new Ht("zoom")).fire(new Ht("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(i){if((i=i??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(i>=0&&i<=this.transform.maxPitch)return this.transform.minPitch=i,this._update(),this.getPitch()<i?this.setPitch(i):this.fire(new Ht("pitchstart")).fire(new Ht("pitch")).fire(new Ht("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(i){if((i=i??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(i>=this.transform.minPitch)return this.transform.maxPitch=i,this._update(),this.getPitch()>i?this.setPitch(i):this.fire(new Ht("pitchstart")).fire(new Ht("pitch")).fire(new Ht("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(i){return this.transform.renderWorldCopies=i,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(i){return i==="auto"?m.navigator.language:Array.isArray(i)?i.length===0?void 0:i.map(t=>t==="auto"?m.navigator.language:t):i}setLanguage(i){const t=this._parseLanguage(i);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(i){return this.style&&i!==this._worldview?(this._worldview=i,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(i){return this._lazyInitEmptyStyle(),i?typeof i=="string"&&(i={name:i}):i=null,this._useExplicitProjection=!!i,this._prioritizeAndUpdateProjection(i,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const i=this.transform,t=i.projection.name;let r;t==="globe"&&i.zoom>=gf?(i.setMercatorFromTransition(),r=!0):t==="mercator"&&i.zoom<gf&&(i.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(i,t){return this._updateProjection(i||t||{name:"mercator"})}_updateProjection(i){let t;if(t=i.name==="globe"&&this.transform.zoom>=gf?this.transform.setMercatorFromTransition():this.transform.setProjection(i),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const r in this.style._sourceCaches)this.style._sourceCaches[r].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(i){return this.transform.locationPoint3D(On.convert(i))}unproject(i){return this.transform.pointLocation3D(V.convert(i))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(i,t,r){if(i==="mouseenter"||i==="mouseover"){let l=!1;const u=p=>{const g=t.filter(b=>this.getLayer(b)),v=g.length?this.queryRenderedFeatures(p.point,{layers:g}):[];v.length?l||(l=!0,r.call(this,new Fl(i,this,p.originalEvent,{features:v}))):l=!1},h=()=>{l=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}if(i==="mouseleave"||i==="mouseout"){let l=!1;const u=p=>{const g=t.filter(v=>this.getLayer(v));(g.length?this.queryRenderedFeatures(p.point,{layers:g}):[]).length?l=!0:l&&(l=!1,r.call(this,new Fl(i,this,p.originalEvent)))},h=p=>{l&&(l=!1,r.call(this,new Fl(i,this,p.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}{const l=u=>{const h=t.filter(g=>this.getLayer(g)),p=h.length?this.queryRenderedFeatures(u.point,{layers:h}):[];p.length&&(u.features=p,r.call(this,u),delete u.features)};return{layers:new Set(t),listener:r,delegates:{[i]:l}}}}on(i,t,r){if(r===void 0)return super.on(i,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const l=this._createDelegatedListener(i,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[i]=this._delegatedListeners[i]||[],this._delegatedListeners[i].push(l);for(const u in l.delegates)this.on(u,l.delegates[u]);return this}once(i,t,r){if(r===void 0)return super.once(i,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const l=this._createDelegatedListener(i,t,r);for(const u in l.delegates)this.once(u,l.delegates[u]);return this}off(i,t,r){if(r===void 0)return super.off(i,t);t=new Set(Array.isArray(t)?t:[t]);for(const h of t)if(!this._isValidId(h))return this;const l=(h,p)=>{if(h.size!==p.size)return!1;for(const g of h)if(!p.has(g))return!1;return!0},u=this._delegatedListeners?this._delegatedListeners[i]:void 0;return u&&(h=>{for(let p=0;p<h.length;p++){const g=h[p];if(g.listener===r&&l(g.layers,t)){for(const v in g.delegates)this.off(v,g.delegates[v]);return h.splice(p,1),this}}})(u),this}queryRenderedFeatures(i,t){if(!this.style)return[];if(t!==void 0||i===void 0||i instanceof V||Array.isArray(i)||(t=i,i=void 0),i=i||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const r of t.layers)if(!this._isValidId(r))return[]}return this.style.queryRenderedFeatures(i,t,this.transform)}querySourceFeatures(i,t){return this._isValidId(i)?this.style.querySourceFeatures(i,t):[]}isPointOnSurface(i){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&ve(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(V.convert(i))}setStyle(i,t){return(t=Ue({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&i?(this._diffStyle(i,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(i,t))}_getUIString(i){const t=this._locale[i];if(t==null)throw new Error(`Missing UI string '${i}'`);return t}_updateStyle(i,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),i&&(this.style=new Yc(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof i=="string"?this.style.loadURL(i):this.style.loadJSON(i)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(i,t){if(typeof i=="string"){const r=this._requestManager.normalizeStyleURL(i),l=this._requestManager.transformRequest(r,Se.Style);tt(l,(u,h)=>{u?this.fire(new vn(u)):h&&this._updateDiff(h,t)})}else typeof i=="object"&&this._updateDiff(i,t)}_updateDiff(i,t){try{this.style.setState(i)&&this._update(!0)}catch(r){ve(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(i,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(ve("There is no style added to the map."),!1)}_isValidId(i){return!function(t){return t.indexOf("")>=0}(i)||(this.fire(new vn(new Error(`IDs can't contain special symbols: "${i}".`))),!1)}addSource(i,t){return this._isValidId(i)?(this._lazyInitEmptyStyle(),this.style.addSource(i,t),this._update(!0)):this}isSourceLoaded(i){return!!this._isValidId(i)&&!!this.style&&this.style._isSourceCacheLoaded(i)}areTilesLoaded(){const i=this.style&&this.style._sourceCaches;for(const t in i){const r=i[t]._tiles;for(const l in r){const u=r[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}addSourceType(i,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(i,t,r)}removeSource(i){return this._isValidId(i)?(this.style.removeSource(i),this._updateTerrain(),this._update(!0)):this}getSource(i){return this._isValidId(i)?this.style.getOwnSource(i):null}addImage(i,t,{pixelRatio:r=1,sdf:l=!1,stretchX:u,stretchY:h,content:p}={}){if(this._lazyInitEmptyStyle(),t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap){const{width:g,height:v,data:b}=Cn.getImageData(t);this.style.addImage(i,{data:new qi({width:g,height:v},b),pixelRatio:r,stretchX:u,stretchY:h,content:p,sdf:l,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new vn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:v}=t,b=t;this.style.addImage(i,{data:new qi({width:g,height:v},new Uint8Array(b.data)),pixelRatio:r,stretchX:u,stretchY:h,content:p,sdf:l,version:0,userImage:b}),b.onAdd&&b.onAdd(this,i)}}updateImage(i,t){this._lazyInitEmptyStyle();const r=this.style.getImage(i);if(!r)return void this.fire(new vn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap?Cn.getImageData(t):t,{width:u,height:h}=l;u!==void 0&&h!==void 0?u===r.data.width&&h===r.data.height?(r.data.replace(l.data,!(t instanceof m.HTMLImageElement||m.ImageBitmap&&t instanceof m.ImageBitmap)),this.style.updateImage(i,r)):this.fire(new vn(new Error(`The width and height of the updated image (${u}, ${h})
                must be that same as the previous version of the image
                (${r.data.width}, ${r.data.height})`))):this.fire(new vn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(i){return i?!!this.style&&!!this.style.getImage(i):(this.fire(new vn(new Error("Missing required image id"))),!1)}removeImage(i){this.style.removeImage(i)}loadImage(i,t){Qt(this._requestManager.transformRequest(i,Se.Image),(r,l)=>{t(r,l instanceof m.HTMLImageElement?Cn.getImageData(l):l)})}listImages(){return this.style.listImages()}addModel(i,t){this._lazyInitEmptyStyle(),this.style.addModel(i,t)}hasModel(i){return i?this.style.hasModel(i):(this.fire(new vn(new Error("Missing required model id"))),!1)}removeModel(i){this.style.removeModel(i)}listModels(){return this.style.listModels()}addLayer(i,t){return this._isValidId(i.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(i,t),this._update(!0)):this}moveLayer(i,t){return this._isValidId(i)?(this.style.moveLayer(i,t),this._update(!0)):this}removeLayer(i){return this._isValidId(i)?(this.style.removeLayer(i),this._update(!0)):this}setLights(i){if(this._lazyInitEmptyStyle(),i&&i.length===1&&i[0].type==="flat"){const t=i[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(i),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const i=this.style.getLights()||[];return i.length===0&&i.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),i}getLayer(i){return this._isValidId(i)?this.style.getOwnLayer(i):null}setLayerZoomRange(i,t,r){return this._isValidId(i)?(this.style.setLayerZoomRange(i,t,r),this._update(!0)):this}setFilter(i,t,r={}){return this._isValidId(i)?(this.style.setFilter(i,t,r),this._update(!0)):this}getFilter(i){return this._isValidId(i)?this.style.getFilter(i):null}setPaintProperty(i,t,r,l={}){return this._isValidId(i)?(this.style.setPaintProperty(i,t,r,l),this._update(!0)):this}getPaintProperty(i,t){return this._isValidId(i)?this.style.getPaintProperty(i,t):null}setLayoutProperty(i,t,r,l={}){return this._isValidId(i)?(this.style.setLayoutProperty(i,t,r,l),this._update(!0)):this}getLayoutProperty(i,t){return this._isValidId(i)?this.style.getLayoutProperty(i,t):null}setConfigProperty(i,t,r){return this.style.setConfigProperty(i,t,r),this._update(!0)}setLight(i,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:i}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(i){return this._lazyInitEmptyStyle(),!i&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(i),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(i){return this._lazyInitEmptyStyle(),this.style.setFog(i),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(i){return this.style.setCamera(i),this._triggerCameraUpdate(i)}_triggerCameraUpdate(i){return this._update(this.transform.setOrthographicProjectionAtLowPitch(i["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(i){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(On.convert(i),this.transform):0}setFeatureState(i,t){return this._isValidId(i.source)?(this.style.setFeatureState(i,t),this._update()):this}removeFeatureState(i,t){return this._isValidId(i.source)?(this.style.removeFeatureState(i,t),this._update()):this}getFeatureState(i){return this._isValidId(i.source)?this.style.getFeatureState(i):null}_updateContainerDimensions(){if(!this._container)return;const i=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let r,l,u,h=this._container;for(;h&&(!l||!u);){const p=m.getComputedStyle(h).transform;p&&p!=="none"&&(r=p.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&r[0]!=="0"&&r[0]!=="1"&&(l=r[0]),r[3]&&r[3]!=="0"&&r[3]!=="1"&&(u=r[3])),h=h.parentElement}this._containerWidth=l?Math.abs(i/l):i,this._containerHeight=u?Math.abs(t/u):t}_detectMissingCSS(){m.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&ve("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const i=this._container;i.classList.add("mapboxgl-map"),(this._missingCSSCanary=Zn("div","mapboxgl-canary",i)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Zn("div","mapboxgl-canvas-container",i);this._canvas=Zn("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=Zn("div","mapboxgl-control-container",i),l=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{l[u]=Zn("div",`mapboxgl-ctrl-${u}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(i,t){const r=Cn.devicePixelRatio||1;this._canvas.width=r*Math.ceil(i),this._canvas.height=r*Math.ceil(t),this._canvas.style.width=`${i}px`,this._canvas.style.height=`${t}px`}_addMarker(i){this._markers.push(i)}_removeMarker(i){const t=this._markers.indexOf(i);t!==-1&&this._markers.splice(t,1)}_addPopup(i){this._popups.push(i)}_removePopup(i){const t=this._popups.indexOf(i);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const i=Ue({},Ra.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",i);t?(xr(t,!0),this.painter=new xre(t,this.transform),this.on("data",r=>{r.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),S.testSupport(t)):this.fire(new vn(new Error("Failed to initialize WebGL")))}_contextLost(i){i.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Ht("webglcontextlost",{originalEvent:i}))}_contextRestored(i){this._setupPainter(),this.resize(),this._update(),this.fire(new Ht("webglcontextrestored",{originalEvent:i}))}_onMapScroll(i){if(i.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(i){return this.style?(this._styleDirty=this._styleDirty||i,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(i){return this._update(),this._renderTaskQueue.add(i)}_cancelRenderFrame(i){this._renderTaskQueue.remove(i)}_requestDomTask(i){!this.loaded()||this.loaded()&&!this.isMoving()?i():this._domRenderTaskQueue.add(i)}_render(i){let t;this.fire(new Ht("renderstart"));const r=this.painter.context.extTimerQuery,l=Cn.now(),u=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=u.createQuery(),u.beginQuery(r.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],m.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],m.performance.now())),this._renderTaskQueue.run(i),this._domRenderTaskQueue.run(i),this._removed)return;this._updateProjectionTransition();const h=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,b=this.transform.pitch,w=Cn.now(),A=new ri(v,{now:w,fadeDuration:h,pitch:b,transition:this.style.transition});this.style.update(A)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let p=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),p=this._updateAverageElevation(l),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):p=this._updateAverageElevation(l),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,h,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:h,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Ht("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Ht("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const v=Cn.now()-l;u.endQuery(r.TIME_ELAPSED_EXT),setTimeout(()=>{const b=u.getQueryParameter(t,u.QUERY_RESULT)/1e6;u.deleteQuery(t),this.fire(new Ht("gpu-timing-frame",{cpuTime:v,gpuTime:b})),m.performance.mark("frame-gpu",{startTime:l,detail:{gpuTime:b}})},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(v);this.fire(new Ht("gpu-timing-layer",{layerTimes:b}))},50)}if(this.listens("gpu-timing-deferred-render")){const v=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const b=this.painter.queryGpuTimeDeferredRender(v);this.fire(new Ht("gpu-timing-deferred-render",{gpuTime:b}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||p;if(g||this._repaint)this.triggerRepaint();else{const v=!this.isMoving()&&this.loaded();if(v&&(p=this._updateAverageElevation(l,!0)),p)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new Ht("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const b=this._calculateSpeedIndex();this.fire(new Ht("speedindexcompleted",{speedIndex:b})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,Yi.mark(ti.fullLoad),this._performanceMetricsCollection&&sa(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(i){for(const t of this._markers)i&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!i||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(i,t=!1){const r=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&r(0);const l=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(l||(t||i-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(i)){const u=this.transform.averageElevation;let h=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(h)?h=0:this._averageElevationLastSampledAt=i;const p=Math.abs(u-h);if(p>1){if(this._isInitialLoad||l)return this._averageElevation.jumpTo(h),r(h);this._averageElevation.easeTo(h,i,300)}else if(p>1e-4)return this._averageElevation.jumpTo(h),r(h)}return!!this._averageElevation.isEasing(i)&&r(this._averageElevation.getValue(i))}_authenticate(){ia(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,i=>{if(i&&(i.message===mn||i.status===401)){const t=this.painter.context.gl;xr(t,!1),this._logoControl instanceof x9&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new vn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),qn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const i=this._isDragging();this.painter.updateTerrain(this.style,i)}_calculateSpeedIndex(){const i=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,l=r.createFramebuffer();function u(h){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,h,0);const p=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,p),p}return r.bindFramebuffer(r.FRAMEBUFFER,l),this._canvasPixelComparison(u(i),t.canvasCopies.map(u),t.timeStamps)}_canvasPixelComparison(i,t,r){let l=r[1]-r[0];const u=i.length/4;for(let h=0;h<t.length;h++){const p=t[h];let g=0;for(let v=0;v<p.length;v+=4)p[v]===i[v]&&p[v+1]===i[v+1]&&p[v+2]===i[v+2]&&p[v+3]===i[v+3]&&(g+=1);l+=(r[h+2]-r[h+1])*(1-g/u)}return l}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),m!==void 0&&(m.removeEventListener("resize",this._onWindowResize,!1),m.removeEventListener("orientationchange",this._onWindowResize,!1),m.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),m.removeEventListener("online",this._onWindowOnline,!1),m.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i&&i.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ai.delete(this.painter.context.gl),this._removed=!0,this.fire(new Ht("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(i){this._renderNextFrame=this._renderNextFrame||i,this.style&&!this._frame&&(this._frame=Cn.frame(t=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(t)}))}_preloadTiles(i){return Xe(this.style?Object.values(this.style._sourceCaches):[],(t,r)=>t._preloadTiles(i,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(i){this._trackResize&&this.resize({originalEvent:i})._update()}_onVisibilityChange(){m.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(i){this._showTileBoundaries!==i&&(this._showTileBoundaries=i,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(i){this._showTerrainWireframe!==i&&(this._showTerrainWireframe=i,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(i){this._showLayers2DWireframe!==i&&(this._showLayers2DWireframe=i,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(i){this._showLayers3DWireframe!==i&&(this._showLayers3DWireframe=i,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(i){this._speedIndexTiming!==i&&(this._speedIndexTiming=i,this._update())}get showPadding(){return!!this._showPadding}set showPadding(i){this._showPadding!==i&&(this._showPadding=i,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(i){this._showCollisionBoxes!==i&&(this._showCollisionBoxes=i,i?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(i){this._showOverdrawInspector!==i&&(this._showOverdrawInspector=i,this._update())}get repaint(){return!!this._repaint}set repaint(i){this._repaint!==i&&(this._repaint=i,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(i){this._vertices=i,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(i){this._showTileAABBs!==i&&(this._showTileAABBs=i,i&&this._update())}_setCacheLimits(i,t){(function(r,l){St=r,Zt=l})(i,t)}get version(){return y}},NavigationControl:class{constructor(i){this.options=Ue({},foe,i),this._container=Zn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(pt(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Zn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Zn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(pt(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:t}):r.resetNorth({},{originalEvent:t}))}),this._compassIcon=Zn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const i=this._map;if(!i)return;const t=i.getZoom(),r=t===i.getMaxZoom(),l=t===i.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())}_rotateCompassArrow(){const i=this._map;if(!i)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(i.transform.pitch*(Math.PI/180)),.5)}) rotateX(${i.transform.pitch}deg) rotateZ(${i.transform.angle*(180/Math.PI)}deg)`:`rotate(${i.transform.angle*(180/Math.PI)}deg)`;i._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(i){return this._map=i,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),i.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&i.on("pitch",this._rotateCompassArrow),i.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new poe(i,this._compass,this.options.visualizePitch)),this._container}onRemove(){const i=this._map;i&&(this._container.remove(),this.options.showZoom&&i.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&i.off("pitch",this._rotateCompassArrow),i.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(i,t){const r=Zn("button",i,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(i,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);i.setAttribute("aria-label",r),i.firstElementChild&&i.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends Bn{constructor(i){super(),this.options=Ue({geolocation:m.navigator.geolocation},moe,i),pt(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=h9(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(i){return this._map=i,this._container=Zn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(i){const t=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,i(r)};this._supportsGeolocation!==void 0?i(this._supportsGeolocation):m.navigator.permissions!==void 0?m.navigator.permissions.query({name:"geolocation"}).then(r=>t(r.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(i){const t=this._map.getMaxBounds(),r=i.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(i){if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new Ht("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ht("geolocate",i)),this._finish()}}_updateCamera(i){const t=new On(i.coords.longitude,i.coords.latitude),r=i.coords.accuracy,l=Ue({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(r),l,{geolocateSource:!0})}_updateMarker(i){if(i){const t=new On(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=i.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const i=this._map.transform,t=$a(1,i._center.lat)*i.worldSize,r=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(i){if(this._map){if(this.options.trackUserLocation)if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ht("error",i)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(i){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Zn("button","mapboxgl-ctrl-geolocate",this._container),Zn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",i===!1){ve("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Zn("div","mapboxgl-user-location"),this._dotElement.appendChild(Zn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Zn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new P5({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Zn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new P5({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Ht("trackuserlocationend")))})}}_onDeviceOrientation(i){this._userLocationDotMarker&&(i.webkitCompassHeading?this._heading=i.webkitCompassHeading:i.absolute===!0&&(this._heading=-1*i.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return ve("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Ht("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Ht("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Ht("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let i;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(i={maximumAge:6e5,timeout:0},this._noTimeout=!0):(i=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,i),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const i=()=>{m.addEventListener("ondeviceorientationabsolute"in m?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};m.DeviceMotionEvent!==void 0&&typeof m.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&i()}).catch(console.error):i()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),m.removeEventListener("deviceorientation",this._onDeviceOrientation),m.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:b9,ScaleControl:class{constructor(i){this.options=Ue({},goe,i),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),pt(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const i=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,l=t._containerWidth/2-i/2,u=t.unproject([l,r]),h=t.unproject([l+i,r]),p=u.distanceTo(h);if(this.options.unit==="imperial"){const g=3.2808*p;g>5280?this._setScale(i,g/5280,"mile"):this._setScale(i,g,"foot")}else this.options.unit==="nautical"?this._setScale(i,p/1852,"nautical-mile"):p>=1e3?this._setScale(i,p/1e3,"kilometer"):this._setScale(i,p,"meter")}_setScale(i,t,r){this._map._requestDomTask(()=>{const l=function(h){const p=Math.pow(10,`${Math.floor(h)}`.length-1);let g=h/p;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(v){const b=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*b)/b}(g),p*g}(t),u=l/t;this._container.innerHTML=this._isNumberFormatSupported&&r!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(l):`${l}&nbsp;${yoe[r]}`,this._container.style.width=i*u+"px"})}onAdd(i){return this._map=i,this._language=i.getLanguage(),this._container=Zn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",i.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(i){this._language=i,this._update()}setUnit(i){this.options.unit=i,this._update()}},FullscreenControl:class{constructor(i){this._fullscreen=!1,i&&i.container&&(i.container instanceof m.HTMLElement?this._container=i.container:ve("Full screen control 'container' must be a DOM element.")),pt(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in m.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in m.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(i){return this._map=i,this._container||(this._container=this._map.getContainer()),this._controlContainer=Zn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",ve("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,m.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!m.document.fullscreenEnabled&&!m.document.webkitFullscreenEnabled)}_setupUI(){const i=this._fullscreenButton=Zn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Zn("span","mapboxgl-ctrl-icon",i).setAttribute("aria-hidden","true"),i.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),m.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const i=this._getTitle();this._fullscreenButton.setAttribute("aria-label",i),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",i)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(m.document.fullscreenElement||m.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?m.document.exitFullscreen?m.document.exitFullscreen():m.document.webkitCancelFullScreen&&m.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Bn{constructor(i){super(),this.options=Ue(Object.create(loe),i),pt(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(i&&i.className?i.className.trim().split(/\s+/):[])}addTo(i){return this._map&&this.remove(),this._map=i,this.options.closeOnClick&&i.on("preclick",this._onClose),this.options.closeOnMove&&i.on("move",this._onClose),i.on("remove",this.remove),this._update(),i._addPopup(this),this._focusFirstElement(),this._trackPointer?(i.on("mousemove",this._onMouseEvent),i.on("mouseup",this._onMouseEvent),i._canvasContainer.classList.add("mapboxgl-track-pointer")):i.on("move",this._update),this.fire(new Ht("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const i=this._map;return i&&(i.off("move",this._update),i.off("move",this._onClose),i.off("preclick",this._onClose),i.off("click",this._onClose),i.off("remove",this.remove),i.off("mousemove",this._onMouseEvent),i.off("mouseup",this._onMouseEvent),i.off("drag",this._onMouseEvent),i._canvasContainer&&i._canvasContainer.classList.remove("mapboxgl-track-pointer"),i._removePopup(this),this._map=void 0),this.fire(new Ht("close")),this}getLngLat(){return this._lngLat}setLngLat(i){this._lngLat=On.convert(i),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const i=this._map;return i&&(i.off("move",this._update),i.on("mousemove",this._onMouseEvent),i.on("drag",this._onMouseEvent),i._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(i){return this.setDOMContent(m.document.createTextNode(i))}setHTML(i){const t=m.document.createDocumentFragment(),r=m.document.createElement("body");let l;for(r.innerHTML=i;l=r.firstChild,l;)t.appendChild(l);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(i){return this.options.maxWidth=i,this._update(),this}setDOMContent(i){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Zn("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(i),this.options.closeButton){const r=this._closeButton=Zn("button","mapboxgl-popup-close-button",t);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(i){return this._classList.add(i),this._updateClassList(),this}removeClassName(i){return this._classList.delete(i),this._updateClassList(),this}setOffset(i){return this.options.offset=i,this._update(),this}toggleClassName(i){let t;return this._classList.delete(i)?t=!1:(this._classList.add(i),t=!0),this._updateClassList(),t}_onMouseEvent(i){this._update(i.point)}_getAnchor(i){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,l=this._pos;if(!t||!r||!l)return"bottom";const u=r.offsetWidth,h=r.offsetHeight,p=l.x<u/2,g=l.x>t.transform.width-u/2;if(l.y+i<h)return p?"top-left":g?"top-right":"top";if(l.y>t.transform.height-h){if(p)return"bottom-left";if(g)return"bottom-right"}return p?"left":g?"right":"bottom"}_updateClassList(){const i=this._container;if(!i)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),i.className=t.join(" ")}_update(i){const t=this._map,r=this._content;if(!t||!this._lngLat&&!this._trackPointer||!r)return;let l=this._container;if(l||(l=this._container=Zn("div","mapboxgl-popup",t.getContainer()),this._tip=Zn("div","mapboxgl-popup-tip",l),l.appendChild(r)),this.options.maxWidth&&l.style.maxWidth!==this.options.maxWidth&&(l.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=S9(this._lngLat,this._pos,t.transform)),!this._trackPointer||i){const u=this._pos=this._trackPointer&&i?i:t.project(this._lngLat),h=A9(this.options.offset),p=this._anchor=this._getAnchor(h.y),g=A9(this.options.offset,p),v=u.add(g).round();t._requestDomTask(()=>{this._container&&p&&(this._container.style.transform=`${C5[p]} translate(${v.x}px,${v.y}px)`)})}if(!this._marker&&t._showingGlobe()){const u=T2(t.transform,this._lngLat)?0:1;this._setOpacity(u)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const i=this._container.querySelector(coe);i&&i.focus()}_onClose(){this.remove()}_setOpacity(i){this._container&&(this._container.style.opacity=`${i}`),this._content&&(this._content.style.pointerEvents=i?"auto":"none")}},Marker:P5,Style:Yc,LngLat:On,LngLatBounds:Dl,Point:V,MercatorCoordinate:ga,FreeCameraOptions:ON,Evented:Bn,config:x,prewarm:function(){I1().acquire(QP)},clearPrewarmedResources:function(){const i=P1;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(QP),P1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return x.ACCESS_TOKEN},set accessToken(i){x.ACCESS_TOKEN=i},get baseApiUrl(){return x.API_URL},set baseApiUrl(i){x.API_URL=i},get workerCount(){return yv.workerCount},set workerCount(i){yv.workerCount=i},get maxParallelImageRequests(){return x.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(i){x.MAX_PARALLEL_IMAGE_REQUESTS=i},clearStorage(i){(function(t){if(!qt())return;const r=m.caches.delete(Nt);t&&r.catch(t).then(()=>t())})(i)},workerUrl:"",workerClass:null,get dracoUrl(){return ZB()},set dracoUrl(i){(function(t){e5=Cn.resolveURL(t),t5||(t5=new Mm(I1(),new Bn)),t5.broadcast("setDracoUrl",e5)})(i)},setNow:Cn.setNow,restoreNow:Cn.restoreNow};f.A=WB,f.D=bm,f.E=ht,f.F=wP,f.K=M3,f.O=Ca,f.P=V,f.T=oB,f.V=U2,f.a=B2,f.b=FF,f.c=v3,f.d=class extends Bn{constructor(i,t,r,l,u,h){super(),this.actor=i,this.layerIndex=t,this.availableImages=r,this.loadVectorData=u||XB,this.loading={},this.loaded={},this.deduped=new qB(i.scheduler),this.isSpriteLoaded=l,this.scheduler=i.scheduler,this.brightness=h}loadTile(i,t){const r=i.uid,l=i&&i.request,u=l&&l.collectResourceTiming,h=this.loading[r]=new Bae(i);h.abort=this.loadVectorData(i,(p,g)=>{const v=!this.loading[r];if(delete this.loading[r],v||p||!g)return h.status="done",v||(this.loaded[r]=h),t(p);const b=g.rawData,w={};g.expires&&(w.expires=g.expires),g.cacheControl&&(w.cacheControl=g.cacheControl),h.vectorTile=g.vectorTile||new vP(new H2(b));const A=()=>{h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,(C,P)=>{if(C||!P)return t(C);const R={};if(u){const z=ho(l);z.length>0&&(R.resourceTiming=JSON.parse(JSON.stringify(z)))}t(null,Ue({rawTileData:b.slice(0)},P,w,R))})};this.isSpriteLoaded?A():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(A,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):A()}),this.loaded=this.loaded||{},this.loaded[r]=h})}reloadTile(i,t){const r=this.loaded,l=i.uid,u=this;if(r&&r[l]){const h=r[l];h.showCollisionBoxes=i.showCollisionBoxes,h.projection=i.projection,h.brightness=i.brightness,h.tileTransform=xm(i.tileID.canonical,i.projection),h.extraShadowCaster=i.extraShadowCaster;const p=(g,v)=>{const b=h.reloadCallback;b&&(delete h.reloadCallback,h.parse(h.vectorTile,u.layerIndex,this.availableImages,u.actor,b)),t(g,v)};h.status==="parsing"?h.reloadCallback=p:h.status==="done"&&(h.vectorTile?h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,p):p())}}abortTile(i,t){const r=i.uid,l=this.loading[r];l&&(l.abort&&l.abort(),delete this.loading[r]),t()}removeTile(i,t){const r=this.loaded,l=i.uid;r&&r[l]&&delete r[l],t()}},f.e=Oc,f.f=ho,f.g=F,f.h=tt,f.i=vt,f.j=function(i,t){const r=s5(i);for(const l of r){for(const u of l.meshes)Yae(u);l.lights&&(l.lightMeshIndex=l.meshes.length,l.meshes.push(Zae(l.lights,t)))}return r},f.k=ri,f.l=async function(i){let t=0;if(new Uint32Array(i,0,1)[0]!==JB){const r=new Uint32Array(i,0,7),[,,l,u,h,p]=r;t=r.byteLength+u+h+p+h,(l!==i.byteLength||t>=i.byteLength)&&ve("Invalid b3dm header information.")}return n8(i,t)},f.m=Q2,f.n=Ds,f.o=Ht,f.p=X,f.q=function(i){Ot(),He&&He.then(t=>{t.keys().then(r=>{for(let l=0;l<r.length-i;l++)t.delete(r[l])})})},f.r=s8,f.s=V3,f.t=i1,f.v=Ke,f.w=m}),c(["./shared"],function(f){function m(Be){if(typeof Be=="number"||typeof Be=="boolean"||typeof Be=="string"||Be==null)return JSON.stringify(Be);if(Array.isArray(Be)){let se="[";for(const ve of Be)se+=`${m(ve)},`;return`${se}]`}let ue="{";for(const se of Object.keys(Be).sort())ue+=`${se}:${m(Be[se])},`;return`${ue}}`}function y(Be){let ue="";for(const se of f.r)ue+=`/${m(Be[se])}`;return ue}class _{constructor(ue){this.keyCache={},ue&&this.replace(ue)}replace(ue,se){this._layerConfigs={},this._layers={},this.update(ue,[],se)}update(ue,se,ve){this._options=ve;for(const De of ue){this._layerConfigs[De.id]=De;const st=this._layers[De.id]=f.c(De,this._options);st.setScope(this.scope),st.compileFilter(),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of se)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const $e=function(De,st){const de={};for(let Oe=0;Oe<De.length;Oe++){const mt=st&&st[De[Oe].id]||y(De[Oe]);st&&(st[De[Oe].id]=mt);let ot=de[mt];ot||(ot=de[mt]=[]),ot.push(De[Oe])}const ne=[];for(const Oe in de)ne.push(de[Oe]);return ne}(f.v(this._layerConfigs),this.keyCache);for(const De of $e){const st=De.map(lt=>this._layers[lt.id]),de=st[0];if(de.visibility==="none")continue;const ne=de.source||"";let Oe=this.familiesBySource[ne];Oe||(Oe=this.familiesBySource[ne]={});const mt=de.sourceLayer||"_geojsonTileLayer";let ot=Oe[mt];ot||(ot=Oe[mt]=[]),ot.push(st)}}}class x{loadTile(ue,se){const{uid:ve,encoding:$e,rawImageData:De,padding:st}=ue,de=f.w.ImageBitmap&&De instanceof f.w.ImageBitmap?this.getImageData(De,st):De;se(null,new f.D(ve,de,$e,ue.convertToFloat,st<1))}getImageData(ue,se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const ve=this.offscreenCanvasContext.getImageData(-se,-se,ue.width+2*se,ue.height+2*se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ve}}function S(Be,ue){if(Be.length!==0){T(Be[0],ue);for(var se=1;se<Be.length;se++)T(Be[se],!ue)}}function T(Be,ue){for(var se=0,ve=0,$e=0,De=Be.length,st=De-1;$e<De;st=$e++){var de=(Be[$e][0]-Be[st][0])*(Be[st][1]+Be[$e][1]),ne=se+de;ve+=Math.abs(se)>=Math.abs(de)?se-ne+de:de-ne+se,se=ne}se+ve>=0!=!!ue&&Be.reverse()}var I=f.g(function Be(ue,se){var ve,$e=ue&&ue.type;if($e==="FeatureCollection")for(ve=0;ve<ue.features.length;ve++)Be(ue.features[ve],se);else if($e==="GeometryCollection")for(ve=0;ve<ue.geometries.length;ve++)Be(ue.geometries[ve],se);else if($e==="Feature")Be(ue.geometry,se);else if($e==="Polygon")S(ue.coordinates,se);else if($e==="MultiPolygon")for(ve=0;ve<ue.coordinates.length;ve++)S(ue.coordinates[ve],se);return ue});const k=f.V.prototype.toGeoJSON;var D={exports:{}},L=f.p,O=f.a.VectorTileFeature,F=B;function B(Be,ue){this.options=ue||{},this.features=Be,this.length=Be.length}function G(Be,ue){this.id=typeof Be.id=="number"?Be.id:void 0,this.type=Be.type,this.rawGeometry=Be.type===1?[Be.geometry]:Be.geometry,this.properties=Be.tags,this.extent=ue||4096}B.prototype.feature=function(Be){return new G(this.features[Be],this.options.extent)},G.prototype.loadGeometry=function(){var Be=this.rawGeometry;this.geometry=[];for(var ue=0;ue<Be.length;ue++){for(var se=Be[ue],ve=[],$e=0;$e<se.length;$e++)ve.push(new L(se[$e][0],se[$e][1]));this.geometry.push(ve)}return this.geometry},G.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Be=this.geometry,ue=1/0,se=-1/0,ve=1/0,$e=-1/0,De=0;De<Be.length;De++)for(var st=Be[De],de=0;de<st.length;de++){var ne=st[de];ue=Math.min(ue,ne.x),se=Math.max(se,ne.x),ve=Math.min(ve,ne.y),$e=Math.max($e,ne.y)}return[ue,ve,se,$e]},G.prototype.toGeoJSON=O.prototype.toGeoJSON;var q=f.b,X=F;function te(Be){var ue=new q;return function(se,ve){for(var $e in se.layers)ve.writeMessage(3,V,se.layers[$e])}(Be,ue),ue.finish()}function V(Be,ue){var se;ue.writeVarintField(15,Be.version||1),ue.writeStringField(1,Be.name||""),ue.writeVarintField(5,Be.extent||4096);var ve={keys:[],values:[],keycache:{},valuecache:{}};for(se=0;se<Be.length;se++)ve.feature=Be.feature(se),ue.writeMessage(2,Q,ve);var $e=ve.keys;for(se=0;se<$e.length;se++)ue.writeStringField(3,$e[se]);var De=ve.values;for(se=0;se<De.length;se++)ue.writeMessage(4,Ce,De[se])}function Q(Be,ue){var se=Be.feature;se.id!==void 0&&ue.writeVarintField(1,se.id),ue.writeMessage(2,ge,Be),ue.writeVarintField(3,se.type),ue.writeMessage(4,fe,se)}function ge(Be,ue){var se=Be.feature,ve=Be.keys,$e=Be.values,De=Be.keycache,st=Be.valuecache;for(var de in se.properties){var ne=se.properties[de],Oe=De[de];if(ne!==null){Oe===void 0&&(ve.push(de),De[de]=Oe=ve.length-1),ue.writeVarint(Oe);var mt=typeof ne;mt!=="string"&&mt!=="boolean"&&mt!=="number"&&(ne=JSON.stringify(ne));var ot=mt+":"+ne,lt=st[ot];lt===void 0&&($e.push(ne),st[ot]=lt=$e.length-1),ue.writeVarint(lt)}}}function me(Be,ue){return(ue<<3)+(7&Be)}function be(Be){return Be<<1^Be>>31}function fe(Be,ue){for(var se=Be.loadGeometry(),ve=Be.type,$e=0,De=0,st=se.length,de=0;de<st;de++){var ne=se[de],Oe=1;ve===1&&(Oe=ne.length),ue.writeVarint(me(1,Oe));for(var mt=ve===3?ne.length-1:ne.length,ot=0;ot<mt;ot++){ot===1&&ve!==1&&ue.writeVarint(me(2,mt-1));var lt=ne[ot].x-$e,Et=ne[ot].y-De;ue.writeVarint(be(lt)),ue.writeVarint(be(Et)),$e+=lt,De+=Et}ve===3&&ue.writeVarint(me(7,1))}}function Ce(Be,ue){var se=typeof Be;se==="string"?ue.writeStringField(1,Be):se==="boolean"?ue.writeBooleanField(7,Be):se==="number"&&(Be%1!=0?ue.writeDoubleField(3,Be):Be<0?ue.writeSVarintField(6,Be):ue.writeVarintField(5,Be))}D.exports=te,D.exports.fromVectorTileJs=te,D.exports.fromGeojsonVt=function(Be,ue){ue=ue||{};var se={};for(var ve in Be)se[ve]=new X(Be[ve].features,ue),se[ve].name=ve,se[ve].version=ue.version,se[ve].extent=ue.extent;return te({layers:se})},D.exports.GeoJSONWrapper=X;var Le=f.g(D.exports);const Ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Be=>Be},le=Math.fround||(pe=new Float32Array(1),Be=>(pe[0]=+Be,pe[0]));var pe;const Ae=3,ae=5,Ee=6;class Ze{constructor(ue){this.options=Object.assign(Object.create(Ge),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:se,minZoom:ve,maxZoom:$e}=this.options;se&&console.time("total time");const De=`prepare ${ue.length} points`;se&&console.time(De),this.points=ue;const st=[];for(let ne=0;ne<ue.length;ne++){const Oe=ue[ne];if(!Oe.geometry)continue;const[mt,ot]=Oe.geometry.coordinates,lt=le(Ue(mt)),Et=le(ft(ot));st.push(lt,Et,1/0,ne,-1,1),this.options.reduce&&st.push(0)}let de=this.trees[$e+1]=this._createTree(st);se&&console.timeEnd(De);for(let ne=$e;ne>=ve;ne--){const Oe=+Date.now();de=this.trees[ne]=this._createTree(this._cluster(de,ne)),se&&console.log("z%d: %d clusters in %dms",ne,de.numItems,+Date.now()-Oe)}return se&&console.timeEnd("total time"),this}getClusters(ue,se){let ve=((ue[0]+180)%360+360)%360-180;const $e=Math.max(-90,Math.min(90,ue[1]));let De=ue[2]===180?180:((ue[2]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)ve=-180,De=180;else if(ve>De){const ot=this.getClusters([ve,$e,180,st],se),lt=this.getClusters([-180,$e,De,st],se);return ot.concat(lt)}const de=this.trees[this._limitZoom(se)],ne=de.range(Ue(ve),ft(st),Ue(De),ft($e)),Oe=de.data,mt=[];for(const ot of ne){const lt=this.stride*ot;mt.push(Oe[lt+ae]>1?Xe(Oe,lt,this.clusterProps):this.points[Oe[lt+Ae]])}return mt}getChildren(ue){const se=this._getOriginId(ue),ve=this._getOriginZoom(ue),$e="No cluster with the specified id.",De=this.trees[ve];if(!De)throw new Error($e);const st=De.data;if(se*this.stride>=st.length)throw new Error($e);const de=this.options.radius/(this.options.extent*Math.pow(2,ve-1)),ne=De.within(st[se*this.stride],st[se*this.stride+1],de),Oe=[];for(const mt of ne){const ot=mt*this.stride;st[ot+4]===ue&&Oe.push(st[ot+ae]>1?Xe(st,ot,this.clusterProps):this.points[st[ot+Ae]])}if(Oe.length===0)throw new Error($e);return Oe}getLeaves(ue,se,ve){const $e=[];return this._appendLeaves($e,ue,se=se||10,ve=ve||0,0),$e}getTile(ue,se,ve){const $e=this.trees[this._limitZoom(ue)],De=Math.pow(2,ue),{extent:st,radius:de}=this.options,ne=de/st,Oe=(ve-ne)/De,mt=(ve+1+ne)/De,ot={features:[]};return this._addTileFeatures($e.range((se-ne)/De,Oe,(se+1+ne)/De,mt),$e.data,se,ve,De,ot),se===0&&this._addTileFeatures($e.range(1-ne/De,Oe,1,mt),$e.data,De,ve,De,ot),se===De-1&&this._addTileFeatures($e.range(0,Oe,ne/De,mt),$e.data,-1,ve,De,ot),ot.features.length?ot:null}getClusterExpansionZoom(ue){let se=this._getOriginZoom(ue)-1;for(;se<=this.options.maxZoom;){const ve=this.getChildren(ue);if(se++,ve.length!==1)break;ue=ve[0].properties.cluster_id}return se}_appendLeaves(ue,se,ve,$e,De){const st=this.getChildren(se);for(const de of st){const ne=de.properties;if(ne&&ne.cluster?De+ne.point_count<=$e?De+=ne.point_count:De=this._appendLeaves(ue,ne.cluster_id,ve,$e,De):De<$e?De++:ue.push(de),ue.length===ve)break}return De}_createTree(ue){const se=new f.K(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ve=0;ve<ue.length;ve+=this.stride)se.add(ue[ve],ue[ve+1]);return se.finish(),se.data=ue,se}_addTileFeatures(ue,se,ve,$e,De,st){for(const de of ue){const ne=de*this.stride,Oe=se[ne+ae]>1;let mt,ot,lt;if(Oe)mt=Ke(se,ne,this.clusterProps),ot=se[ne],lt=se[ne+1];else{const Vt=this.points[se[ne+Ae]];mt=Vt.properties;const[$t,Nt]=Vt.geometry.coordinates;ot=Ue($t),lt=ft(Nt)}const Et={type:1,geometry:[[Math.round(this.options.extent*(ot*De-ve)),Math.round(this.options.extent*(lt*De-$e))]],tags:mt};let Ut;Ut=Oe||this.options.generateId?se[ne+Ae]:this.points[se[ne+Ae]].id,Ut!==void 0&&(Et.id=Ut),st.features.push(Et)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,se){const{radius:ve,extent:$e,reduce:De,minPoints:st}=this.options,de=ve/($e*Math.pow(2,se)),ne=ue.data,Oe=[],mt=this.stride;for(let ot=0;ot<ne.length;ot+=mt){if(ne[ot+2]<=se)continue;ne[ot+2]=se;const lt=ne[ot],Et=ne[ot+1],Ut=ue.within(ne[ot],ne[ot+1],de),Vt=ne[ot+ae];let $t=Vt;for(const Nt of Ut){const St=Nt*mt;ne[St+2]>se&&($t+=ne[St+ae])}if($t>Vt&&$t>=st){let Nt,St=lt*Vt,Zt=Et*Vt,He=-1;const Lt=((ot/mt|0)<<5)+(se+1)+this.points.length;for(const qt of Ut){const Ot=qt*mt;if(ne[Ot+2]<=se)continue;ne[Ot+2]=se;const fn=ne[Ot+ae];St+=ne[Ot]*fn,Zt+=ne[Ot+1]*fn,ne[Ot+4]=Lt,De&&(Nt||(Nt=this._map(ne,ot,!0),He=this.clusterProps.length,this.clusterProps.push(Nt)),De(Nt,this._map(ne,Ot)))}ne[ot+4]=Lt,Oe.push(St/$t,Zt/$t,1/0,Lt,-1,$t),De&&Oe.push(He)}else{for(let Nt=0;Nt<mt;Nt++)Oe.push(ne[ot+Nt]);if($t>1)for(const Nt of Ut){const St=Nt*mt;if(!(ne[St+2]<=se)){ne[St+2]=se;for(let Zt=0;Zt<mt;Zt++)Oe.push(ne[St+Zt])}}}}return Oe}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,se,ve){if(ue[se+ae]>1){const st=this.clusterProps[ue[se+Ee]];return ve?Object.assign({},st):st}const $e=this.points[ue[se+Ae]].properties,De=this.options.map($e);return ve&&De===$e?Object.assign({},De):De}}function Xe(Be,ue,se){return{type:"Feature",id:Be[ue+Ae],properties:Ke(Be,ue,se),geometry:{type:"Point",coordinates:[(ve=Be[ue],360*(ve-.5)),Rt(Be[ue+1])]}};var ve}function Ke(Be,ue,se){const ve=Be[ue+ae],$e=ve>=1e4?`${Math.round(ve/1e3)}k`:ve>=1e3?Math.round(ve/100)/10+"k":ve,De=Be[ue+Ee],st=De===-1?{}:Object.assign({},se[De]);return Object.assign(st,{cluster:!0,cluster_id:Be[ue+Ae],point_count:ve,point_count_abbreviated:$e})}function Ue(Be){return Be/360+.5}function ft(Be){const ue=Math.sin(Be*Math.PI/180),se=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return se<0?0:se>1?1:se}function Rt(Be){const ue=(180-360*Be)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}var kt={exports:{}};kt.exports=function(){function Be(Se,Me,ze,Qe){for(var tt,vt=Qe,dt=ze-Me>>1,ut=ze-Me,Gt=Se[Me],Tt=Se[Me+1],Qt=Se[ze],mn=Se[ze+1],nn=Me+3;nn<ze;nn+=3){var wn=ue(Se[nn],Se[nn+1],Gt,Tt,Qt,mn);if(wn>vt)tt=nn,vt=wn;else if(wn===vt){var Hn=Math.abs(nn-dt);Hn<ut&&(tt=nn,ut=Hn)}}vt>Qe&&(tt-Me>3&&Be(Se,Me,tt,Qe),Se[tt+2]=vt,ze-tt>3&&Be(Se,tt,ze,Qe))}function ue(Se,Me,ze,Qe,tt,vt){var dt=tt-ze,ut=vt-Qe;if(dt!==0||ut!==0){var Gt=((Se-ze)*dt+(Me-Qe)*ut)/(dt*dt+ut*ut);Gt>1?(ze=tt,Qe=vt):Gt>0&&(ze+=dt*Gt,Qe+=ut*Gt)}return(dt=Se-ze)*dt+(ut=Me-Qe)*ut}function se(Se,Me,ze,Qe){var tt={id:Se===void 0?null:Se,type:Me,geometry:ze,tags:Qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(vt){var dt=vt.geometry,ut=vt.type;if(ut==="Point"||ut==="MultiPoint"||ut==="LineString")ve(vt,dt);else if(ut==="Polygon"||ut==="MultiLineString")for(var Gt=0;Gt<dt.length;Gt++)ve(vt,dt[Gt]);else if(ut==="MultiPolygon")for(Gt=0;Gt<dt.length;Gt++)for(var Tt=0;Tt<dt[Gt].length;Tt++)ve(vt,dt[Gt][Tt])}(tt),tt}function ve(Se,Me){for(var ze=0;ze<Me.length;ze+=3)Se.minX=Math.min(Se.minX,Me[ze]),Se.minY=Math.min(Se.minY,Me[ze+1]),Se.maxX=Math.max(Se.maxX,Me[ze]),Se.maxY=Math.max(Se.maxY,Me[ze+1])}function $e(Se,Me,ze,Qe){if(Me.geometry){var tt=Me.geometry.coordinates,vt=Me.geometry.type,dt=Math.pow(ze.tolerance/((1<<ze.maxZoom)*ze.extent),2),ut=[],Gt=Me.id;if(ze.promoteId?Gt=Me.properties[ze.promoteId]:ze.generateId&&(Gt=Qe||0),vt==="Point")De(tt,ut);else if(vt==="MultiPoint")for(var Tt=0;Tt<tt.length;Tt++)De(tt[Tt],ut);else if(vt==="LineString")st(tt,ut,dt,!1);else if(vt==="MultiLineString"){if(ze.lineMetrics){for(Tt=0;Tt<tt.length;Tt++)st(tt[Tt],ut=[],dt,!1),Se.push(se(Gt,"LineString",ut,Me.properties));return}de(tt,ut,dt,!1)}else if(vt==="Polygon")de(tt,ut,dt,!0);else{if(vt!=="MultiPolygon"){if(vt==="GeometryCollection"){for(Tt=0;Tt<Me.geometry.geometries.length;Tt++)$e(Se,{id:Gt,geometry:Me.geometry.geometries[Tt],properties:Me.properties},ze,Qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Tt=0;Tt<tt.length;Tt++){var Qt=[];de(tt[Tt],Qt,dt,!0),ut.push(Qt)}}Se.push(se(Gt,vt,ut,Me.properties))}}function De(Se,Me){Me.push(ne(Se[0])),Me.push(Oe(Se[1])),Me.push(0)}function st(Se,Me,ze,Qe){for(var tt,vt,dt=0,ut=0;ut<Se.length;ut++){var Gt=ne(Se[ut][0]),Tt=Oe(Se[ut][1]);Me.push(Gt),Me.push(Tt),Me.push(0),ut>0&&(dt+=Qe?(tt*Tt-Gt*vt)/2:Math.sqrt(Math.pow(Gt-tt,2)+Math.pow(Tt-vt,2))),tt=Gt,vt=Tt}var Qt=Me.length-3;Me[2]=1,Be(Me,0,Qt,ze),Me[Qt+2]=1,Me.size=Math.abs(dt),Me.start=0,Me.end=Me.size}function de(Se,Me,ze,Qe){for(var tt=0;tt<Se.length;tt++){var vt=[];st(Se[tt],vt,ze,Qe),Me.push(vt)}}function ne(Se){return Se/360+.5}function Oe(Se){var Me=Math.sin(Se*Math.PI/180),ze=.5-.25*Math.log((1+Me)/(1-Me))/Math.PI;return ze<0?0:ze>1?1:ze}function mt(Se,Me,ze,Qe,tt,vt,dt,ut){if(Qe/=Me,vt>=(ze/=Me)&&dt<Qe)return Se;if(dt<ze||vt>=Qe)return null;for(var Gt=[],Tt=0;Tt<Se.length;Tt++){var Qt=Se[Tt],mn=Qt.geometry,nn=Qt.type,wn=tt===0?Qt.minX:Qt.minY,Hn=tt===0?Qt.maxX:Qt.maxY;if(wn>=ze&&Hn<Qe)Gt.push(Qt);else if(!(Hn<ze||wn>=Qe)){var fa=[];if(nn==="Point"||nn==="MultiPoint")ot(mn,fa,ze,Qe,tt);else if(nn==="LineString")lt(mn,fa,ze,Qe,tt,!1,ut.lineMetrics);else if(nn==="MultiLineString")Ut(mn,fa,ze,Qe,tt,!1);else if(nn==="Polygon")Ut(mn,fa,ze,Qe,tt,!0);else if(nn==="MultiPolygon")for(var Pa=0;Pa<mn.length;Pa++){var Ta=[];Ut(mn[Pa],Ta,ze,Qe,tt,!0),Ta.length&&fa.push(Ta)}if(fa.length){if(ut.lineMetrics&&nn==="LineString"){for(Pa=0;Pa<fa.length;Pa++)Gt.push(se(Qt.id,nn,fa[Pa],Qt.tags));continue}nn!=="LineString"&&nn!=="MultiLineString"||(fa.length===1?(nn="LineString",fa=fa[0]):nn="MultiLineString"),nn!=="Point"&&nn!=="MultiPoint"||(nn=fa.length===3?"Point":"MultiPoint"),Gt.push(se(Qt.id,nn,fa,Qt.tags))}}}return Gt.length?Gt:null}function ot(Se,Me,ze,Qe,tt){for(var vt=0;vt<Se.length;vt+=3){var dt=Se[vt+tt];dt>=ze&&dt<=Qe&&(Me.push(Se[vt]),Me.push(Se[vt+1]),Me.push(Se[vt+2]))}}function lt(Se,Me,ze,Qe,tt,vt,dt){for(var ut,Gt,Tt=Et(Se),Qt=tt===0?$t:Nt,mn=Se.start,nn=0;nn<Se.length-3;nn+=3){var wn=Se[nn],Hn=Se[nn+1],fa=Se[nn+2],Pa=Se[nn+3],Ta=Se[nn+4],Li=tt===0?wn:Hn,mi=tt===0?Pa:Ta,Re=!1;dt&&(ut=Math.sqrt(Math.pow(wn-Pa,2)+Math.pow(Hn-Ta,2))),Li<ze?mi>ze&&(Gt=Qt(Tt,wn,Hn,Pa,Ta,ze),dt&&(Tt.start=mn+ut*Gt)):Li>Qe?mi<Qe&&(Gt=Qt(Tt,wn,Hn,Pa,Ta,Qe),dt&&(Tt.start=mn+ut*Gt)):Vt(Tt,wn,Hn,fa),mi<ze&&Li>=ze&&(Gt=Qt(Tt,wn,Hn,Pa,Ta,ze),Re=!0),mi>Qe&&Li<=Qe&&(Gt=Qt(Tt,wn,Hn,Pa,Ta,Qe),Re=!0),!vt&&Re&&(dt&&(Tt.end=mn+ut*Gt),Me.push(Tt),Tt=Et(Se)),dt&&(mn+=ut)}var bt=Se.length-3;wn=Se[bt],Hn=Se[bt+1],fa=Se[bt+2],(Li=tt===0?wn:Hn)>=ze&&Li<=Qe&&Vt(Tt,wn,Hn,fa),bt=Tt.length-3,vt&&bt>=3&&(Tt[bt]!==Tt[0]||Tt[bt+1]!==Tt[1])&&Vt(Tt,Tt[0],Tt[1],Tt[2]),Tt.length&&Me.push(Tt)}function Et(Se){var Me=[];return Me.size=Se.size,Me.start=Se.start,Me.end=Se.end,Me}function Ut(Se,Me,ze,Qe,tt,vt){for(var dt=0;dt<Se.length;dt++)lt(Se[dt],Me,ze,Qe,tt,vt,!1)}function Vt(Se,Me,ze,Qe){Se.push(Me),Se.push(ze),Se.push(Qe)}function $t(Se,Me,ze,Qe,tt,vt){var dt=(vt-Me)/(Qe-Me);return Se.push(vt),Se.push(ze+(tt-ze)*dt),Se.push(1),dt}function Nt(Se,Me,ze,Qe,tt,vt){var dt=(vt-ze)/(tt-ze);return Se.push(Me+(Qe-Me)*dt),Se.push(vt),Se.push(1),dt}function St(Se,Me){for(var ze=[],Qe=0;Qe<Se.length;Qe++){var tt,vt=Se[Qe],dt=vt.type;if(dt==="Point"||dt==="MultiPoint"||dt==="LineString")tt=Zt(vt.geometry,Me);else if(dt==="MultiLineString"||dt==="Polygon"){tt=[];for(var ut=0;ut<vt.geometry.length;ut++)tt.push(Zt(vt.geometry[ut],Me))}else if(dt==="MultiPolygon")for(tt=[],ut=0;ut<vt.geometry.length;ut++){for(var Gt=[],Tt=0;Tt<vt.geometry[ut].length;Tt++)Gt.push(Zt(vt.geometry[ut][Tt],Me));tt.push(Gt)}ze.push(se(vt.id,dt,tt,vt.tags))}return ze}function Zt(Se,Me){var ze=[];ze.size=Se.size,Se.start!==void 0&&(ze.start=Se.start,ze.end=Se.end);for(var Qe=0;Qe<Se.length;Qe+=3)ze.push(Se[Qe]+Me,Se[Qe+1],Se[Qe+2]);return ze}function He(Se,Me){if(Se.transformed)return Se;var ze,Qe,tt,vt=1<<Se.z,dt=Se.x,ut=Se.y;for(ze=0;ze<Se.features.length;ze++){var Gt=Se.features[ze],Tt=Gt.geometry,Qt=Gt.type;if(Gt.geometry=[],Qt===1)for(Qe=0;Qe<Tt.length;Qe+=2)Gt.geometry.push(Lt(Tt[Qe],Tt[Qe+1],Me,vt,dt,ut));else for(Qe=0;Qe<Tt.length;Qe++){var mn=[];for(tt=0;tt<Tt[Qe].length;tt+=2)mn.push(Lt(Tt[Qe][tt],Tt[Qe][tt+1],Me,vt,dt,ut));Gt.geometry.push(mn)}}return Se.transformed=!0,Se}function Lt(Se,Me,ze,Qe,tt,vt){return[Math.round(ze*(Se*Qe-tt)),Math.round(ze*(Me*Qe-vt))]}function qt(Se,Me,ze,Qe,tt){for(var vt=Me===tt.maxZoom?0:tt.tolerance/((1<<Me)*tt.extent),dt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ze,y:Qe,z:Me,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ut=0;ut<Se.length;ut++){dt.numFeatures++,Ot(dt,Se[ut],vt,tt);var Gt=Se[ut].minX,Tt=Se[ut].minY,Qt=Se[ut].maxX,mn=Se[ut].maxY;Gt<dt.minX&&(dt.minX=Gt),Tt<dt.minY&&(dt.minY=Tt),Qt>dt.maxX&&(dt.maxX=Qt),mn>dt.maxY&&(dt.maxY=mn)}return dt}function Ot(Se,Me,ze,Qe){var tt=Me.geometry,vt=Me.type,dt=[];if(vt==="Point"||vt==="MultiPoint")for(var ut=0;ut<tt.length;ut+=3)dt.push(tt[ut]),dt.push(tt[ut+1]),Se.numPoints++,Se.numSimplified++;else if(vt==="LineString")fn(dt,tt,Se,ze,!1,!1);else if(vt==="MultiLineString"||vt==="Polygon")for(ut=0;ut<tt.length;ut++)fn(dt,tt[ut],Se,ze,vt==="Polygon",ut===0);else if(vt==="MultiPolygon")for(var Gt=0;Gt<tt.length;Gt++){var Tt=tt[Gt];for(ut=0;ut<Tt.length;ut++)fn(dt,Tt[ut],Se,ze,!0,ut===0)}if(dt.length){var Qt=Me.tags||null;if(vt==="LineString"&&Qe.lineMetrics){for(var mn in Qt={},Me.tags)Qt[mn]=Me.tags[mn];Qt.mapbox_clip_start=tt.start/tt.size,Qt.mapbox_clip_end=tt.end/tt.size}var nn={geometry:dt,type:vt==="Polygon"||vt==="MultiPolygon"?3:vt==="LineString"||vt==="MultiLineString"?2:1,tags:Qt};Me.id!==null&&(nn.id=Me.id),Se.features.push(nn)}}function fn(Se,Me,ze,Qe,tt,vt){var dt=Qe*Qe;if(Qe>0&&Me.size<(tt?dt:Qe))ze.numPoints+=Me.length/3;else{for(var ut=[],Gt=0;Gt<Me.length;Gt+=3)(Qe===0||Me[Gt+2]>dt)&&(ze.numSimplified++,ut.push(Me[Gt]),ut.push(Me[Gt+1])),ze.numPoints++;tt&&function(Tt,Qt){for(var mn=0,nn=0,wn=Tt.length,Hn=wn-2;nn<wn;Hn=nn,nn+=2)mn+=(Tt[nn]-Tt[Hn])*(Tt[nn+1]+Tt[Hn+1]);if(mn>0===Qt)for(nn=0,wn=Tt.length;nn<wn/2;nn+=2){var fa=Tt[nn],Pa=Tt[nn+1];Tt[nn]=Tt[wn-2-nn],Tt[nn+1]=Tt[wn-1-nn],Tt[wn-2-nn]=fa,Tt[wn-1-nn]=Pa}}(ut,vt),Se.push(ut)}}function _e(Se,Me){var ze=(Me=this.options=function(tt,vt){for(var dt in vt)tt[dt]=vt[dt];return tt}(Object.create(this.options),Me)).debug;if(ze&&console.time("preprocess data"),Me.maxZoom<0||Me.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Me.promoteId&&Me.generateId)throw new Error("promoteId and generateId cannot be used together.");var Qe=function(tt,vt){var dt=[];if(tt.type==="FeatureCollection")for(var ut=0;ut<tt.features.length;ut++)$e(dt,tt.features[ut],vt,ut);else $e(dt,tt.type==="Feature"?tt:{geometry:tt},vt);return dt}(Se,Me);this.tiles={},this.tileCoords=[],ze&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Me.indexMaxZoom,Me.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Qe=function(tt,vt){var dt=vt.buffer/vt.extent,ut=tt,Gt=mt(tt,1,-1-dt,dt,0,-1,2,vt),Tt=mt(tt,1,1-dt,2+dt,0,-1,2,vt);return(Gt||Tt)&&(ut=mt(tt,1,-dt,1+dt,0,-1,2,vt)||[],Gt&&(ut=St(Gt,1).concat(ut)),Tt&&(ut=ut.concat(St(Tt,-1)))),ut}(Qe,Me)).length&&this.splitTile(Qe,0,0,0),ze&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ye(Se,Me,ze){return 32*((1<<Se)*ze+Me)+Se}return _e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},_e.prototype.splitTile=function(Se,Me,ze,Qe,tt,vt,dt){for(var ut=[Se,Me,ze,Qe],Gt=this.options,Tt=Gt.debug;ut.length;){Qe=ut.pop(),ze=ut.pop(),Me=ut.pop(),Se=ut.pop();var Qt=1<<Me,mn=Ye(Me,ze,Qe),nn=this.tiles[mn];if(!nn&&(Tt>1&&console.time("creation"),nn=this.tiles[mn]=qt(Se,Me,ze,Qe,Gt),this.tileCoords.push({z:Me,x:ze,y:Qe}),Tt)){Tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Me,ze,Qe,nn.numFeatures,nn.numPoints,nn.numSimplified),console.timeEnd("creation"));var wn="z"+Me;this.stats[wn]=(this.stats[wn]||0)+1,this.total++}if(nn.source=Se,tt){if(Me===Gt.maxZoom||Me===tt)continue;var Hn=1<<tt-Me;if(ze!==Math.floor(vt/Hn)||Qe!==Math.floor(dt/Hn))continue}else if(Me===Gt.indexMaxZoom||nn.numPoints<=Gt.indexMaxPoints)continue;if(nn.source=null,Se.length!==0){Tt>1&&console.time("clipping");var fa,Pa,Ta,Li,mi,Re,bt=.5*Gt.buffer/Gt.extent,Dt=.5-bt,Ct=.5+bt,zt=1+bt;fa=Pa=Ta=Li=null,mi=mt(Se,Qt,ze-bt,ze+Ct,0,nn.minX,nn.maxX,Gt),Re=mt(Se,Qt,ze+Dt,ze+zt,0,nn.minX,nn.maxX,Gt),Se=null,mi&&(fa=mt(mi,Qt,Qe-bt,Qe+Ct,1,nn.minY,nn.maxY,Gt),Pa=mt(mi,Qt,Qe+Dt,Qe+zt,1,nn.minY,nn.maxY,Gt),mi=null),Re&&(Ta=mt(Re,Qt,Qe-bt,Qe+Ct,1,nn.minY,nn.maxY,Gt),Li=mt(Re,Qt,Qe+Dt,Qe+zt,1,nn.minY,nn.maxY,Gt),Re=null),Tt>1&&console.timeEnd("clipping"),ut.push(fa||[],Me+1,2*ze,2*Qe),ut.push(Pa||[],Me+1,2*ze,2*Qe+1),ut.push(Ta||[],Me+1,2*ze+1,2*Qe),ut.push(Li||[],Me+1,2*ze+1,2*Qe+1)}}},_e.prototype.getTile=function(Se,Me,ze){var Qe=this.options,tt=Qe.extent,vt=Qe.debug;if(Se<0||Se>24)return null;var dt=1<<Se,ut=Ye(Se,Me=(Me%dt+dt)%dt,ze);if(this.tiles[ut])return He(this.tiles[ut],tt);vt>1&&console.log("drilling down to z%d-%d-%d",Se,Me,ze);for(var Gt,Tt=Se,Qt=Me,mn=ze;!Gt&&Tt>0;)Tt--,Qt=Math.floor(Qt/2),mn=Math.floor(mn/2),Gt=this.tiles[Ye(Tt,Qt,mn)];return Gt&&Gt.source?(vt>1&&console.log("found parent tile z%d-%d-%d",Tt,Qt,mn),vt>1&&console.time("drilling down"),this.splitTile(Gt.source,Tt,Qt,mn,Se,Me,ze),vt>1&&console.timeEnd("drilling down"),this.tiles[ut]?He(this.tiles[ut],tt):null):null},function(Se,Me){return new _e(Se,Me)}}();var Jt=f.g(kt.exports);function It(Be,ue){const se=Be.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);const ve=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!ve)return ue(null,null);const $e=new class{constructor(st){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.E,this.length=st.length,this._features=st}feature(st){return new class{constructor(de){this._feature=de,this.extent=f.E,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const ne of this._feature.geometry)de.push([new f.P(ne[0],ne[1])]);return de}{const de=[];for(const ne of this._feature.geometry){const Oe=[];for(const mt of ne)Oe.push(new f.P(mt[0],mt[1]));de.push(Oe)}return de}}toGeoJSON(de,ne,Oe){return k.call(this,de,ne,Oe)}}(this._features[st])}}(ve.features);let De=Le($e);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),ue(null,{vectorTile:$e,rawData:De.buffer})}class Pe extends f.d{constructor(ue,se,ve,$e,De,st){super(ue,se,ve,$e,It,st),De&&(this.loadGeoJSON=De)}loadData(ue,se){const ve=ue&&ue.request,$e=ve&&ve.collectResourceTiming;this.loadGeoJSON(ue,(De,st)=>{if(De||!st)return se(De);if(typeof st!="object")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{I(st,!0);try{if(ue.filter){const ne=f.e(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(mt=>`${mt.key}: ${mt.message}`).join(", "));st={type:"FeatureCollection",features:st.features.filter(mt=>ne.value.evaluate({zoom:0},mt))}}this._geoJSONIndex=ue.cluster?new Ze(function({superclusterOptions:ne,clusterProperties:Oe}){if(!Oe||!ne)return ne;const mt={},ot={},lt={accumulated:null,zoom:0},Et={properties:null},Ut=Object.keys(Oe);for(const Vt of Ut){const[$t,Nt]=Oe[Vt],St=f.e(Nt),Zt=f.e(typeof $t=="string"?[$t,["accumulated"],["get",Vt]]:$t);mt[Vt]=St.value,ot[Vt]=Zt.value}return ne.map=Vt=>{Et.properties=Vt;const $t={};for(const Nt of Ut)$t[Nt]=mt[Nt].evaluate(lt,Et);return $t},ne.reduce=(Vt,$t)=>{Et.properties=$t;for(const Nt of Ut)lt.accumulated=Vt[Nt],Vt[Nt]=ot[Nt].evaluate(lt,Et)},ne}(ue)).load(st.features):Jt(st,ue.geojsonVtOptions)}catch(ne){return se(ne)}this.loaded={};const de={};if($e){const ne=f.f(ve);ne&&(de.resourceTiming={},de.resourceTiming[ue.source]=JSON.parse(JSON.stringify(ne)))}se(null,de)}})}reloadTile(ue,se){const ve=this.loaded;return ve&&ve[ue.uid]?super.reloadTile(ue,se):this.loadTile(ue,se)}loadGeoJSON(ue,se){if(ue.request)f.h(ue.request,se);else{if(typeof ue.data!="string")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return se(null,JSON.parse(ue.data))}catch{return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(ve){se(ve)}}getClusterChildren(ue,se){try{se(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(ve){se(ve)}}getClusterLeaves(ue,se){try{se(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(ve){se(ve)}}}class pt{constructor(ue,se){this.tileID=new f.O(ue.tileID.overscaledZ,ue.tileID.wrap,ue.tileID.canonical.z,ue.tileID.canonical.x,ue.tileID.canonical.y),this.tileZoom=ue.tileZoom,this.uid=ue.uid,this.zoom=ue.zoom,this.canonical=ue.tileID.canonical,this.pixelRatio=ue.pixelRatio,this.tileSize=ue.tileSize,this.source=ue.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ue.projection,this.brightness=se}async parse(ue,se,ve,$e){this.status="parsing";const De=new f.O(ve.tileID.overscaledZ,ve.tileID.wrap,ve.tileID.canonical.z,ve.tileID.canonical.x,ve.tileID.canonical.y),st={},de=se.familiesBySource[ve.source],ne=new f.F(De,ve.promoteId);ne.bucketLayerIDs=[];const Oe=await f.l(ue).catch(Et=>$e(new Error(Et.message)));if(!Oe)return $e(new Error("Could not parse tile"));const mt=f.j(Oe,1/f.t(ve.tileID.canonical)),ot=Oe.json.extensionsUsed&&Oe.json.extensionsUsed.includes("MAPBOX_mesh_features"),lt=new f.k(this.zoom,{brightness:this.brightness});for(const Et in de)for(const Ut of de[Et]){const Vt=Ut[0],$t=Oe.json.extensionsUsed;Vt.recalculate(lt,[]);const Nt=new f.T(mt,De,$t&&$t.includes("MAPBOX_mesh_features"),this.brightness);ot||(Nt.needsUpload=!0),st[Vt.fqid]=Nt,Nt.evaluate(Vt)}this.status="done",$e(null,{buckets:st,featureIndex:ne})}}class yt{constructor(ue,se,ve,$e,De,st){this.actor=ue,this.layerIndex=se,this.brightness=st,this.loading={},this.loaded={}}loadTile(ue,se){const ve=ue.uid,$e=this.loading[ve]=new pt(ue,this.brightness);f.i(ue.request,(De,st)=>{const de=!this.loading[ve];return delete this.loading[ve],de||De?($e.status="done",de||(this.loaded[ve]=$e),se(De)):st&&st.byteLength!==0?void $e.parse(st,this.layerIndex,ue,(ne,Oe)=>{$e.status="done",this.loaded=this.loaded||{},this.loaded[ve]=$e,ne||!Oe?se(ne):se(null,Oe)}):($e.status="done",this.loaded[ve]=$e,se())})}reloadTile(ue,se){const ve=this.loaded,$e=ue.uid;if(ve&&ve[$e]){const De=ve[$e];De.projection=ue.projection,De.brightness=ue.brightness;const st=(de,ne)=>{De.reloadCallback&&(delete De.reloadCallback,this.loadTile(ue,se)),se(de,ne)};De.status==="parsing"?De.reloadCallback=st:De.status==="done"&&this.loadTile(ue,se)}}abortTile(ue,se){const ve=ue.uid;this.loading[ve]&&delete this.loading[ve],se()}removeTile(ue,se){const ve=this.loaded,$e=ue.uid;ve&&ve[$e]&&delete ve[$e],se()}}class At{constructor(ue){this.self=ue,this.actor=new f.A(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.m({name:"mercator"}),this.workerSourceTypes={vector:f.d,geojson:Pe,"batched-model":yt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(se,ve)=>{if(this.workerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.workerSourceTypes[se]=ve},this.self.registerRTLTextPlugin=se=>{if(f.n.isParsed())throw new Error("RTL text plugin already registered.");f.n.applyArabicShaping=se.applyArabicShaping,f.n.processBidirectionalText=se.processBidirectionalText,f.n.processStyledBidirectionalText=se.processStyledBidirectionalText}}clearCaches(ue,se,ve){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],ve()}checkIfReady(ue,se,ve){ve()}setReferrer(ue,se){this.referrer=se}spriteLoaded(ue,{scope:se,isLoaded:ve}){if(this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),this.isSpriteLoaded[ue][se]=ve,this.workerSources[ue]&&this.workerSources[ue][se])for(const $e in this.workerSources[ue][se]){const De=this.workerSources[ue][se][$e];for(const st in De)De[st]instanceof f.d&&(De[st].isSpriteLoaded=ve,De[st].fire(new f.o("isSpriteLoaded")))}}setImages(ue,{scope:se,images:ve},$e){if(this.availableImages[ue]||(this.availableImages[ue]={}),this.availableImages[ue][se]=ve,this.workerSources[ue]&&this.workerSources[ue][se]){for(const De in this.workerSources[ue][se]){const st=this.workerSources[ue][se][De];for(const de in st)st[de].availableImages=ve}$e()}else $e()}setProjection(ue,se){this.projections[ue]=f.m(se)}setBrightness(ue,se,ve){this.brightness=se,ve()}setLayers(ue,se,ve){this.getLayerIndex(ue,se.scope).replace(se.layers,se.options),ve()}updateLayers(ue,se,ve){this.getLayerIndex(ue,se.scope).update(se.layers,se.removedIds,se.options),ve()}loadTile(ue,se,ve){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).loadTile(se,ve)}loadDEMTile(ue,se,ve){this.getDEMWorkerSource(ue,se.source,se.scope).loadTile(se,ve)}reloadTile(ue,se,ve){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).reloadTile(se,ve)}abortTile(ue,se,ve){this.getWorkerSource(ue,se.type,se.source,se.scope).abortTile(se,ve)}removeTile(ue,se,ve){this.getWorkerSource(ue,se.type,se.source,se.scope).removeTile(se,ve)}removeSource(ue,se,ve){if(!(this.workerSources[ue]&&this.workerSources[ue][se.scope]&&this.workerSources[ue][se.scope][se.type]&&this.workerSources[ue][se.scope][se.type][se.source]))return;const $e=this.workerSources[ue][se.scope][se.type][se.source];delete this.workerSources[ue][se.scope][se.type][se.source],$e.removeSource!==void 0?$e.removeSource(se,ve):ve()}loadWorkerSource(ue,se,ve){try{this.self.importScripts(se.url),ve()}catch($e){ve($e.toString())}}syncRTLPluginState(ue,se,ve){try{f.n.setState(se);const $e=f.n.getPluginURL();if(f.n.isLoaded()&&!f.n.isParsed()&&$e!=null){this.self.importScripts($e);const De=f.n.isParsed();ve(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${$e}`),De)}}catch($e){ve($e.toString())}}setDracoUrl(ue,se){this.dracoUrl=se}getAvailableImages(ue,se){this.availableImages[ue]||(this.availableImages[ue]={});let ve=this.availableImages[ue][se];return ve||(ve=[]),ve}getLayerIndex(ue,se){this.layerIndexes[ue]||(this.layerIndexes[ue]={});let ve=this.layerIndexes[ue][se];return ve||(ve=this.layerIndexes[ue][se]=new _,ve.scope=se),ve}getWorkerSource(ue,se,ve,$e){if(this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][$e]||(this.workerSources[ue][$e]={}),this.workerSources[ue][$e][se]||(this.workerSources[ue][$e][se]={}),this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),!this.workerSources[ue][$e][se][ve]){const De={send:(st,de,ne,Oe,mt,ot)=>{this.actor.send(st,de,ne,ue,mt,ot)},scheduler:this.actor.scheduler};this.workerSources[ue][$e][se][ve]=new this.workerSourceTypes[se](De,this.getLayerIndex(ue,$e),this.getAvailableImages(ue,$e),this.isSpriteLoaded[ue][$e],void 0,this.brightness)}return this.workerSources[ue][$e][se][ve]}getDEMWorkerSource(ue,se,ve){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][ve]||(this.demWorkerSources[ue][ve]={}),this.demWorkerSources[ue][ve][se]||(this.demWorkerSources[ue][ve][se]=new x),this.demWorkerSources[ue][ve][se]}enforceCacheSizeLimit(ue,se){f.q(se)}getWorkerPerformanceMetrics(ue,se,ve){ve(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new At(self)),At}),c(["./shared"],function(f){return f.s});var d=s;return d})})(eJ);var WEe=eJ.exports;const bd=gw(WEe);const VEe=({setMap:n,setSelectedCity:e})=>{bd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const a=re.useRef(null),o=re.useRef(null),[s,c]=re.useState(!1);let d=null;return re.useEffect(()=>{o.current||!a.current||(o.current=new bd.Map({attributionControl:!1,container:a.current,style:"mapbox://styles/stanronzhin/clok1b9my006901o4gkfc25b2",center:[30,40],zoom:2,pitch:25}),o.current.on("load",()=>{o.current&&(o.current.addSource("city_points",{type:"geojson",data:"data/esg_city_points.geojson",cluster:!0,clusterMaxZoom:7,clusterRadius:20}).addSource("city_clusters",{type:"geojson",data:"data/esg_urban_clusters.geojson"}),o.current.addLayer({id:"city_point_clusters",type:"circle",source:"city_points",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#f7f7f7",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,100,30,750,40]}}),o.current.addLayer({id:"city_point_cluster-count",type:"symbol",source:"city_points",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Suisse Intl Regular","Arial Unicode MS Bold"],"text-size":20}}),o.current.addLayer({id:"city_point_points",type:"symbol",source:"city_points",paint:{},layout:{"icon-image":["match",["get","Category"],["C1"],"esg_point_C1",["C3"],"esg_point_C3",["B2"],"esg_point_B2",["B3"],"esg_point_B3",["C2"],"esg_point_C2",["A1"],"esg_point_A1",["A2"],"esg_point_A2",["A3"],"esg_point_A3",["B1"],"esg_point_B1","esg_point_new"],"icon-size":["interpolate",["linear"],["zoom"],1,.35,2,.5,3,.6,6,.7,10,.8,22,.7]},filter:["!",["has","point_count"]]},"city_point_cluster-count"),o.current.addLayer({id:"city_point_labels",type:"symbol",source:"city_points",layout:{"text-line-height":0,"text-size":["interpolate",["linear"],["zoom"],0,12,1,15,2,20,3,25,6,30,10,35,22,25],"text-radial-offset":0,"symbol-avoid-edges":!0,"text-font":["Suisse Intl Regular","Arial Unicode MS Regular"],"text-offset":[0,-1.2],"text-anchor":"bottom","text-field":["to-string",["get","City_Name"]]},paint:{"text-color":"#ffffff"}}),o.current.addLayer({id:"city_cluster_hover",source:"city_clusters",type:"fill",paint:{"fill-color":"#ffffff","fill-opacity":["case",["boolean",["feature-state","hover"],!1],0,.07]}}),o.current.addLayer({id:"city_cluster_line",source:"city_clusters",type:"line",paint:{"line-color":"#ffffff","line-opacity":["interpolate",["linear"],["zoom"],0,0,8,0,10,1,22,1]}}),o.current.on("click","city_point_clusters",f=>{const m=o.current.queryRenderedFeatures(f.point,{layers:["city_point_clusters"]}),y=m[0].properties.cluster_id;f.features[0].properties.City_Name,o.current.getSource("city_points").getClusterExpansionZoom(y,(_,x)=>{_||o.current.easeTo({center:m[0].geometry.coordinates,zoom:x+3.2,duration:3e3})})}),o.current.on("click","city_point_labels",f=>{o.current&&o.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),o.current.on("click","city_point_points",f=>{if(!o.current)return;const m=f.features[0].properties.City_Name;e(m),o.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),o.current.on("mouseenter","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseenter","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseleave","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseenter","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("click","city_cluster_hover",f=>{o.current&&f.features[0].properties.City_Name}),o.current.on("mousemove","city_cluster_hover",f=>{if(f.features.length>0){if(!o.current)return;d!==null&&o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1}),d=f.features[0].id,o.current.setFeatureState({source:"city_clusters",id:d},{hover:!0})}}),o.current.on("mouseleave","city_cluster_hover",()=>{if(d!==null){if(!o.current)return;o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1})}d=null}))}),n(o.current))},[]),re.useEffect(()=>{o.current&&o.current.easeTo({center:[55,25],duration:5e3,zoom:2.5,pitch:15,easing:f=>f})},[s]),ee("div",{ref:a,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},_I=({color:n,title:e,value:a,status:o})=>{const{classes:s}=TT();return Je("div",{className:s.statItem,children:[ee("div",{className:s.statTitle,children:e}),ee("div",{className:s.statValue,children:a}),ee("div",{className:s.statStatus,style:{color:n,borderColor:`${n}30`},children:o})]})},Uo={VERY_LOW:"#FF3B29",LOW:"#FF632F",AVERAGE:"#FF9B3F",STRONG:"#A0DA8B",VERY_STRONG:"#35CB00"},su=({label:n,status:e})=>{const{classes:a}=TT();return e?Je("div",{className:a.smallRowWrapper,children:[Je("div",{style:{display:"block",float:"left",height:"100%",padding:"8px 0",marginRight:"3vh",width:"9vh"},children:[" ",ee("div",{className:a.statsSmallText,children:n})]}),ee("div",{style:{flex:1,display:"flex",justifyContent:"flex-start"},children:ee("div",{className:a.statStatus,style:{color:Uo[e.toUpperCase()],borderColor:`${Uo[e.toUpperCase()]}30`},children:e})})]}):null},GEe={A1:"#35CB00",A2:"#75D652",A3:"#B7DE86",B1:"#ECE38E",B2:"#FFD748",B3:"#FFC700",C1:"#FF9B3F",C2:"#FF632F",C3:"#F74B3C"},o0=({label:n,subLabel:e,status:a,isFirst:o})=>{const{classes:s}=TT();if(!a)return null;const c=a.replace("-","");return Je("div",{style:{display:"flex",flexDirection:"column",gap:"1.3vh",alignItems:o?"flex-start":"center"},children:[ee("div",{className:s.statsBigText,style:{textAlign:o?"left":"center"},children:n==="Urban resilience index"?Je("div",{children:["Urban",ee("br",{}),"resilience index"]}):n}),e&&ee("div",{className:s.lowOpacityLabel,style:{marginTop:"-.6vh"},children:e}),ee("div",{className:s.statStatusBig,style:{color:"#fff",marginTop:o?"0":"1.5vh",padding:"1vh 3vh",backgroundColor:o?GEe[c]:"rgba(255, 255, 255, 0.07)"},children:a})]})},HEe=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.96718879043169,32.00280698304451],zoom:10.000000000000009,bearing:101.60000000000173,pitch:49.99999999999967,vscale:.7},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439,vscale:.9},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50,vscale:1},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.48226179199627,9.083198866519695],zoom:10.591526871591094,bearing:-20.799999999999727,pitch:47.51373809516402,vscale:.7},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62,vscale:.9},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.82667518481037,-6.350464399947057],zoom:9.099467639422393,bearing:-153.5999999999998,pitch:46.99999999999997,vscale:1},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.579160832283065,-33.973034474213975],zoom:10.174985293257919,bearing:0,pitch:39.98000000000012,vscale:.8},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.48427166516629,-33.02603685224794],zoom:10.663321631643026,bearing:167.86383725437076,pitch:41.000000000000135,vscale:1.5,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,vscale:.7,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,vscale:.6,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.286496264601823,-4.2411132990048515],zoom:11.378416402173768,bearing:-76.7999999999999,pitch:47.499999999999844,vscale:.15,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.88647818381759,43.256008733418724],zoom:10.249467639422363,bearing:0,pitch:44.97999999999996,vscale:1.5,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.2747162313259,15.633478866808957],zoom:11.643190533205994,bearing:0,pitch:44.94535508727158,vscale:.35,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],jEe=({selectedCityName:n})=>{bd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{var s;if(a.current||!e.current)return;const o=(s=HEe.find(c=>c.properties.City_Name===n))==null?void 0:s.properties;a.current=new bd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:o==null?void 0:o.center,zoom:o==null?void 0:o.zoom,bearing:o==null?void 0:o.bearing,pitch:o==null?void 0:o.pitch}),a.current.on("load",()=>{if(!a.current)return;a.current.resize();let c,d,f=!1;function m(y){c===void 0&&(c=y);const _=y-c;if(d!==y){const x=Math.min((o==null?void 0:o.vscale)/2500*_,o==null?void 0:o.vscale);a.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",x),x===1&&(f=!0)}_<2500&&(d=y,f||requestAnimationFrame(m))}m(0)})},[]),ee("div",{ref:e,style:{pointerEvents:"none",position:"absolute",top:"20vh",right:"0",width:"60%",height:"80vh"}})},Us={Adoni:"Adoni_IEC_A&S_Report.pdf",Almaty:"Almaty_IEC_A&S_Report.pdf",Brazzaville:"Brazzaville_IEC_A&S_Report.pdf",DarEsSalaam:"Dar es Salaam_IEC_A&S_Report.pdf",DubaiExpo:"Dubai_Expo_IEC_A&S_Report.pdf",Dubai:"Dubai_IEC_A&S_Report.pdf",Natal:"Natal_IEC_A&S_Report.pdf",Valparaiso:"Valparaiso_IEC_A&S_Report.pdf"},Z6=[{City:"Dubai",Country:"UAE","Text description":"Largest city of the UAE, one of the main global cities",Population:"4 865 222","Population description":"large","Population density":40.6,"Population density description":"medium","Population city proper":"3 549 900","Population density city proper":22.049068322981366,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-3",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.053,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:3,Efficiency:4,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Dubai/1.jpg","/assets/Dubai/2.jpg","/assets/Dubai/3.jpg","/assets/Dubai/4.jpg","/assets/Dubai/5.jpg"],pdfName:Us.Dubai},{City:"Expo City Dubai",Country:"UAE","Text description":"New city of innovation and advanced technologies",Population:"2 275","Population description":"small","Population density":8.8,"Population density description":"small","Population city proper":"2 275","Population density city proper":8.8,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-2",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Very strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":0,"Poverty headcount ratio at national poverty lines description":"very strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very strong",Efficiency:"Very strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:5,Efficiency:5,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],pdfName:Us.DubaiExpo},{City:"Valparaiso",Country:"Chile","Text description":"Second largest city of the country, the major Chile's port",Population:"965 937","Population description":"large","Population density":41.7,"Population density description":"medium","Population city proper":"252 888","Population density city proper":52.739937434827944,Climate:"14C, 16 kph, 345 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"C-1",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.21,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"11 082","Mean salary description":"very strong","Literacy rate among population":.992,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Average","Natural disaster hazards":"Very strong","Water availability":"Average","Food availability":"Strong","Energy availability":"Very strong",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Average",SME:"Very low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":2},images:["/assets/Valparaiso/1.jpg","/assets/Valparaiso/2.jpg","/assets/Valparaiso/3.jpg","/assets/Valparaiso/4.jpg","/assets/Valparaiso/5.jpg"],pdfName:Us.Valparaiso},{City:"Dar es Salaam",Country:"Tanzania","Text description":"Largest city of the country, one of the Africa's main centres",Population:"9 314 731","Population description":"very large","Population density":71.9,"Population density description":"large","Population city proper":"5 383 728","Population density city proper":163.14327272727272,Climate:"27C, 17 kph, 1 114 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"C-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Very low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.333,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":199,"Mean salary description":"very low","Literacy rate among population":.867,"Literacy rate among population description":"strong","Air pollution":"Average","Water pollution":"Very low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Strong","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Low",Safety_1:"Very low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:2,Safety:1,Affordability:4,"Environmental impact":5},images:["/assets/DarEsSalaam/1.jpg","/assets/DarEsSalaam/2.jpg","/assets/DarEsSalaam/3.jpg","/assets/DarEsSalaam/4.jpg","/assets/DarEsSalaam/5.jpg"],pdfName:Us.DarEsSalaam},{City:"Adoni",Country:"India","Text description":"A historical city and an agricultural centre in Andhra Pradesh",Population:"232 552","Population description":"medium","Population density":64.4,"Population density description":"large","Population city proper":"184 625","Population density city proper":93.71827411167513,Climate:"27C, 17 kph, 691 mm ","Climate description":"Temperate, desert, hot summer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Very low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very low","Poverty headcount ratio at national poverty lines":.273,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"2 769","Mean salary description":"average","Literacy rate among population":.774,"Literacy rate among population description":"average","Air pollution":"Average","Water pollution":"Low","Land use and waste":"Strong","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Average","Energy availability":"Strong",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Low",Efficiency:"Strong",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:4,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":4},images:["/assets/Adoni/1.jpg","/assets/Adoni/2.jpeg","/assets/Adoni/3.jpeg","/assets/Adoni/4.jpg","/assets/Adoni/5.jpeg","/assets/Adoni/6.png"],pdfName:Us.Adoni},{City:"Natal",Country:"Brazil","Text description":"Regional centre of the Rio Grande do Norte",Population:"1 318 291","Population description":"large","Population density":53,"Population density description":"large","Population city proper":"896 710","Population density city proper":52.74764705882353,Climate:"26C, 23 kph, 1 225 mm ","Climate description":"Tropical, dry summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.15,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"1 794","Mean salary description":"average","Literacy rate among population":.993,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Average","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Average",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:4,"Environmental impact":5},images:["/assets/Natal/1.png","/assets/Natal/2.png","/assets/Natal/3.jpeg","/assets/Natal/4.jpeg"],pdfName:Us.Natal},{City:"Brazzaville",Country:"Congo","Text description":"Capital and largest city of the Republic of the Congo",Population:"3 186 838","Population description":"large","Population density":374,"Population density description":"very large","Population city proper":"1 932 610","Population density city proper":193.261,Climate:"25C, 8 kph, 1 095 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-1",Environmental:"Average",Social:"Very low",Governmental:"Average","Current state":"Average","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.193,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"1 282","Mean salary description":"average","Literacy rate among population":.818,"Literacy rate among population description":"average","Air pollution":"Strong","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Low","Energy availability":"Average",Health:"Very low",Education:"Average",Wealth:"Low",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Very low",Accountability:"Very low","City budget":"Very low",SME:"Very low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Very low",Accessibility:"Low",Safety_1:"Average",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:4,Efficiency:1,Accessibility:2,Safety:3,Affordability:4,"Environmental impact":4},images:["/assets/Brazzaville/1.jpeg","/assets/Brazzaville/2.jpg","/assets/Brazzaville/3.jpeg","/assets/Brazzaville/4.jpeg"],pdfName:Us.Brazzaville},{City:"Almaty",Country:"Kazakhstan","Text description":"Largest city in the country",Population:"2 539 108","Population description":"large","Population density":37.7,"Population density description":"medium","Population city proper":"2 211 198","Population density city proper":32.35110460863204,Climate:"7C, 10 kph, 891 mm ","Climate description":"Continental, humid, warm summer","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"A-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.187,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 901","Mean salary description":"average","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Very strong","Food availability":"Strong","Energy availability":"Strong",Health:"Very strong",Education:"Strong",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Strong",Inclusion:"Low",Accountability:"Average","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Low","Environmental impact":"Strong",tr_graph:{Satisfaction:1,Efficiency:2,Accessibility:3,Safety:4,Affordability:2,"Environmental impact":4},images:["/assets/Almaty/1.jpg","/assets/Almaty/2.jpg","/assets/Almaty/3.jpg","/assets/Almaty/4.jpg"],pdfName:Us.Almaty},{City:"Cape Town",Country:"South Africa","Text description":"Second largest city of the country, the regional centre of the Western Cape",Population:"4 293 836","Population description":"large","Population density":67.7,"Population density description":"large","Population city proper":"4 005 016","Population density city proper":16.38043353783231,Climate:"16C, 20 kph, 621 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Strong","Current state":"Strong","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.555,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":"1 686","Mean salary description":"average","Literacy rate among population":.971,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Low","Energy availability":"Low",Health:"Very low",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Average",Transport:"Strong",Inclusion:"Strong",Accountability:"Strong","City budget":"Low",SME:"Average","Public services":"Strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/CapeTown/1.jpg","/assets/CapeTown/2.jpg","/assets/CapeTown/3.jpg","/assets/CapeTown/4.jpg"],pdfName:Us.Dubai},{City:"Mexico City",Country:"Mexico","Text description":"Capital and the largest city of Mexico, one of the largest urban areas in the World",Population:"17 317 588","Population description":"very large","Population density":88.5,"Population density description":"large","Population city proper":"8 843 706","Population density city proper":120.3225306122449,Climate:"16C, 8 kph, 1 058 mm ","Climate description":"Temperate, dry winter, hot summmer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Low","Ability & Willingness":"Low","Basic needs Scope":"C-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.363,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":891,"Mean salary description":"low","Literacy rate among population":.991,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Very low","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Very low",Accountability:"Low","City budget":"Low",SME:"Low","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:2,Efficiency:1,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Mexico/1.jpg","/assets/Mexico/2.png","/assets/Mexico/3.jpeg","/assets/Mexico/4.jpg","/assets/Mexico/5.jpeg","/assets/Mexico/6.jpeg"],pdfName:Us.Dubai},{City:"Jakarta",Country:"Indonesia","Text description":"Capital and the largest city of Indonesia, one of the largest urban areas in the World",Population:"38 758 456","Population description":"very large","Population density":91.8,"Population density description":"very large","Population city proper":"10 679 951","Population density city proper":161.51643149887332,Climate:"26C, 10 kph, 2 097 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Low","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.047,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":554,"Mean salary description":"low","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Average","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Low","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Strong",Livability:"Average",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Low",SME:"Strong","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:3,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Jakarta/1.jpg","/assets/Jakarta/2.jpg","/assets/Jakarta/3.jpg","/assets/Jakarta/4.jpeg","/assets/Jakarta/5.jpeg","/assets/Jakarta/6.jpeg"],pdfName:Us.Dubai},{City:"Panama City",Country:"Panama","Text description":"Capital and the largest city of Panama",Population:"1 584 643","Population description":"large","Population density":66.6,"Population density description":"large","Population city proper":"1 367 767","Population density city proper":47.40302904276703,Climate:"26C, 17 kph, 2 088 mm ","Climate description":"Tropical, monsoonal","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.046,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"1 279","Mean salary description":"average","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Average",Inclusion:"Average",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Strong","Sustainability commitment":"Strong",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":4},images:["/assets/Panama/1.jpg","/assets/Panama/2.jpeg","/assets/Panama/3.jpeg","/assets/Panama/4.jpg","/assets/Panama/5.jpeg","/assets/Panama/6.jpeg","/assets/Panama/7.jpg"],pdfName:Us.Dubai},{City:"Amman",Country:"Jordan","Text description":"Capital and the largest city of Jordan",Population:"6 366 731","Population description":"very large","Population density":137.1,"Population density description":"very large","Population city proper":"1 812 059","Population density city proper":119.68685601056804,Climate:"17C, 13 kph, 187 mm ","Climate description":"Arid, dry summer, cold","Urban Resilience Index":"B-1",Environmental:"Low",Social:"Strong",Governmental:"Strong","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.157,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 284","Mean salary description":"average","Literacy rate among population":.994,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Average","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Average",SME:"Average","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":2},images:["/assets/Amman/1.jpg","/assets/Amman/2.jpeg","/assets/Amman/3.jpeg","/assets/Amman/4.jpeg","/assets/Amman/5.jpeg"],pdfName:Us.Dubai},{City:"Bangkok",Country:"Thailand","Text description":"Capital and the largest city of Thailand",Population:"19 005 476","Population description":"very large","Population density":70.8,"Population density description":"large","Population city proper":"5 666 264","Population density city proper":36.11385595920969,Climate:"28C, 10 kph, 1 207 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Low","Current state":"Low","Ability & Willingness":"Average","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.063,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":421,"Mean salary description":"low","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Low","Water availability":"Strong","Food availability":"Low","Energy availability":"Strong",Health:"Strong",Education:"Low",Wealth:"Average",Safety:"Very strong",Livability:"Average",Transport:"Low",Inclusion:"Strong",Accountability:"Low","City budget":"Very low",SME:"Very strong","Public services":"Low","Sustainability commitment":"Strong",Satisfaction:"Average",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:1,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":3},images:["/assets/Bangkok/1.jpg","/assets/Bangkok/2.jpg","/assets/Bangkok/3.jpg","/assets/Bangkok/4.jpg","/assets/Bangkok/5.jpg"],pdfName:Us.Dubai},{City:"Colombo",Country:"Sri Lanka","Text description":"Largest city and commercial capital of Sri Lanka",Population:"4 938 510","Population description":"large","Population density":38,"Population density description":"medium","Population city proper":"2 324 349","Population density city proper":33.25248927038626,Climate:"26C, 16 kph, 2 387 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Low","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Average","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.143,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":183,"Mean salary description":"very low","Literacy rate among population":.99,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Low","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Strong",Inclusion:"Average",Accountability:"Very low","City budget":"Low",SME:"Average","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/Colombo/1.jpg","/assets/Colombo/2.jpg","/assets/Colombo/3.jpg","/assets/Colombo/4.jpg"],pdfName:Us.Dubai}],nJ=["Dubai","Expo City Dubai","Valparaiso","Dar es Salaam","Adoni","Natal","Brazzaville","Almaty","Cape Town","Mexico City","Jakarta","Panama City","Amman","Bangkok","Colombo"],$Ee=[{city:"Dubai",E:`Mitigate effects of air pollution, especially SO2, NO2:\r
- promoting electric vehicles,\r
- implementation of urban planning policies aimed at reducing long-distance travel within the city, providing new communities with the leisure, and social infrastructure.\r
\r
Introduction of modern technologies for construction waste.`,S:"Strengthen social policy eradicating poverty and ensuring equality in a city (poverty headcount ratio at national poverty lines is still around 5%).",G:`Gender-balancing of bureaucratic procedures.\r
\r
Strengthening labor conditions regulation, primarily for low-skilled personnel (relatively high slavery index  40% vulnerability to modern slavery).`},{city:"Expo City Dubai",E:`Mitigate the effects of pollution, especially particulate matter.\r
- For instance, expand the deployment of regenerative-air vacuum sweepers for both streets and sidewalks. Introduce technologies for indoor air purification in buildings.\r
- Continue planting trees.`,S:"Develop healthcare policies aimed to expand hospital capacity and training of doctors.",G:`Streamline SME access to become ECD residents by minimizing obstacles to renting and launching an entrepreneurship support program.\r
\r
Establish one-stop shop platform for all municipal and state services, creating a one-stop-shop approach.`},{city:"Valparaiso",E:"Strengthening control over SO2 emissions, increasing environmental requirements for ships entering the port.",S:"A programme for the development of public spaces in the city, involving the creation of leisure facilities.",G:"Creation of an ecosystem for start-ups and entrepreneurship (low level of officially registered small businesses per 1 inhabitant  383,7)."},{city:"Dar es Salaam",E:"Policy on treatment of drinking water sources (high average of pH concentration in water (8,5) and high toxins metrics), including modernisation of sewerage and construction of treatment plants, improvement of financial management. Attracting investments of development institutions in water supply and sewage systems.",S:`Community Literacy Programme (literacy rate  76,8%). Development of teacher training system, development of online education with the involvement of teachers from swahili and english speaking countries.\r
\r
 Remote employment promotion.`,G:"Statistics and accounting quality improvement."},{city:"Adoni",E:"Policy on reclamation of landfills and degraded lands. Construction of waste incineration plants, which will also improve energy supply to certain areas.",S:"A programme to improve road safety (+20,8% road fatalities in 2019-2022). Attracting investment to improve the quality of roads. ",G:"Development of mobile communication infrastructure."},{city:"Natal",E:"Natural disasters mitigation policy (increasing frequency of hurricanes and the rise on the sea level).",S:`Social inclusion policy as a response for high number of violence crimes (violent crime rate  31,9 per 1,000 population), including those aimed at the integration of residents of favelas into the labour market, entrepreneurship and social support.\r
\r
Development of social and communal infrastructure outside the administrative boundaries of the city in areas of active housing construction.\r
\r
Organisation of volunteer programmes (the lowest volunteerism rate among the cities  less than 0,1 volunteer per capita).`,G:"Increasing transparency of city finances and reporting."},{city:"Brazzaville",E:`Strengthen waste management strategy due to relatively low levels of waste recycling.\r
\r
Extensive urban sprawl requires urgent measures to preserve green areas.`,S:`Expansion of hospital capacity and training of doctors. \r
\r
Providing slums with basic infrastructure (energy, clean water, waste collection).\r
\r
Establishment of a programme to support micro-enterprises and trade infrastructure development projects.`,G:"Mandatory publication of the city budget and its discussion with stakeholders."},{city:"Almaty",E:"Replacing coal with gas as the main source of energy.",S:"Transport policy aimed at making public transport more attractive, implementation of LRT and BRT projects; polycentric urban development.",G:"Strengthening controls over financial flows and anti-corruption policies (high number of news on bribery scandals)."},{city:"Cape Town",E:"Strengthen waste management strategy due to relatively low levels of waste recycling.",S:`Develop complex programs to decrease child mortality rate (womens healthcare programs, trainings of doctors, hospital equipment).\r
\r
Country-level system to increase literacy rate. Training programs for teachers which will also allow to decrease average number of pupils in the class.\r
\r
Social inclusion policy as a response to high violent crime rates.`,G:"Develop city policies to increase small and medium enterprises activity."},{city:"Mexico City",E:"Mitigate effects of air pollution. Especially SO2, NO2.",S:"Reform healthcare system paying special attention to implementation of effective city ambulance system. Develop plan aimed at increasing life expectancy at birth. ",G:`Pay attention to ESG planning and reporting as currently no policies are implemented.\r
\r
Increase transparency of city finance and reporting.`},{city:"Jakarta",E:`Mitigate effects of high CO2 emissions and concentrations.\r
\r
Increase parks and green zones ares.`,S:`Develop programs aimed at transport system transformation (decrease of heavy traffic).\r
\r
Diversify importers of cereal and food to decrease risks implemented by high level of dependency on imports.`,G:"Increase transparency of city finance and reporting."},{city:"Panama City",E:"Improve policy on reclamation of landfills and degraded lands.",S:`Develop special programs aimed at increase in school attendance. Develop trainings of teachers.\r
\r
Strengthen inclusion policies, especially  for women and refugees.`,G:`Increase financial transparency of city government companies.\r
\r
Build up government system to intensify e-gov services provision.`},{city:"Amman",E:`Mitigate effects of high NO2 concentrations.\r
\r
Strengthen construction waste management strategy.`,S:"Develop measures that will allow to decrease number of road fatalities.",G:"Develop system that will allow to implement free phone to call the police, ambulance, firefighters at least for citizens."},{city:"Bangkok",E:"Improve waste management system and introduce more effective natural disaster mitigation measures.",S:`Reform system of ambulance due to extremely long time needed.\r
\r
Increase investments in the compulsory education system.`,G:"Despite strong SME support measures public services system needs to be reshaped in order to standardize procedures and reduce waiting times"},{city:"Colombo",E:"While significant improvements have been made in natural disaster risk mitigation, the city still needs to turn its attention to air and water pollution where policies lag behind.",S:"Introduction of new social welfare policies to combat poverty. Despite relatively high levels of safety and healthcare the city is still behind its peers in terms of food availability and wealth.",G:`Strengthen budget policies and regulations to be able to plan long term measures.\r
\r
The city needs to invest into ESG strategies and reporting.`}],qEe=Kr()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden"},blueSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#1433AE"},whiteSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#ffffff"},blackSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#000000"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"}}),XEe=Kr()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}}),YEe=({title:n,text:e})=>{const{classes:a}=XEe();return Je("div",{className:a.wrapper,children:[ee("div",{className:a.titleWrapper,children:ee(Ha,{className:a.title,children:n})}),ee(Ha,{className:a.text,children:e})]})};/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function jw(n){return n+.5|0}const Kf=(n,e,a)=>Math.max(Math.min(n,a),e);function Lb(n){return Kf(jw(n*2.55),0,255)}function pp(n){return Kf(jw(n*255),0,255)}function _h(n){return Kf(jw(n/2.55)/100,0,1)}function PG(n){return Kf(jw(n*100),0,100)}const yc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ZR=[..."0123456789ABCDEF"],ZEe=n=>ZR[n&15],KEe=n=>ZR[(n&240)>>4]+ZR[n&15],uA=n=>(n&240)>>4===(n&15),JEe=n=>uA(n.r)&&uA(n.g)&&uA(n.b)&&uA(n.a);function QEe(n){var e=n.length,a;return n[0]==="#"&&(e===4||e===5?a={r:255&yc[n[1]]*17,g:255&yc[n[2]]*17,b:255&yc[n[3]]*17,a:e===5?yc[n[4]]*17:255}:(e===7||e===9)&&(a={r:yc[n[1]]<<4|yc[n[2]],g:yc[n[3]]<<4|yc[n[4]],b:yc[n[5]]<<4|yc[n[6]],a:e===9?yc[n[7]]<<4|yc[n[8]]:255})),a}const eMe=(n,e)=>n<255?e(n):"";function tMe(n){var e=JEe(n)?ZEe:KEe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+eMe(n.a,e):void 0}const nMe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function aJ(n,e,a){const o=e*Math.min(a,1-a),s=(c,d=(c+n/30)%12)=>a-o*Math.max(Math.min(d-3,9-d,1),-1);return[s(0),s(8),s(4)]}function aMe(n,e,a){const o=(s,c=(s+n/60)%6)=>a-a*e*Math.max(Math.min(c,4-c,1),0);return[o(5),o(3),o(1)]}function iMe(n,e,a){const o=aJ(n,1,.5);let s;for(e+a>1&&(s=1/(e+a),e*=s,a*=s),s=0;s<3;s++)o[s]*=1-e-a,o[s]+=e;return o}function rMe(n,e,a,o,s){return n===s?(e-a)/o+(e<a?6:0):e===s?(a-n)/o+2:(n-e)/o+4}function K6(n){const a=n.r/255,o=n.g/255,s=n.b/255,c=Math.max(a,o,s),d=Math.min(a,o,s),f=(c+d)/2;let m,y,_;return c!==d&&(_=c-d,y=f>.5?_/(2-c-d):_/(c+d),m=rMe(a,o,s,_,c),m=m*60+.5),[m|0,y||0,f]}function J6(n,e,a,o){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,a,o)).map(pp)}function Q6(n,e,a){return J6(aJ,n,e,a)}function oMe(n,e,a){return J6(iMe,n,e,a)}function sMe(n,e,a){return J6(aMe,n,e,a)}function iJ(n){return(n%360+360)%360}function lMe(n){const e=nMe.exec(n);let a=255,o;if(!e)return;e[5]!==o&&(a=e[6]?Lb(+e[5]):pp(+e[5]));const s=iJ(+e[2]),c=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?o=oMe(s,c,d):e[1]==="hsv"?o=sMe(s,c,d):o=Q6(s,c,d),{r:o[0],g:o[1],b:o[2],a}}function cMe(n,e){var a=K6(n);a[0]=iJ(a[0]+e),a=Q6(a),n.r=a[0],n.g=a[1],n.b=a[2]}function uMe(n){if(!n)return;const e=K6(n),a=e[0],o=PG(e[1]),s=PG(e[2]);return n.a<255?`hsla(${a}, ${o}%, ${s}%, ${_h(n.a)})`:`hsl(${a}, ${o}%, ${s}%)`}const IG={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},LG={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function dMe(){const n={},e=Object.keys(LG),a=Object.keys(IG);let o,s,c,d,f;for(o=0;o<e.length;o++){for(d=f=e[o],s=0;s<a.length;s++)c=a[s],f=f.replace(c,IG[c]);c=parseInt(LG[d],16),n[f]=[c>>16&255,c>>8&255,c&255]}return n}let dA;function hMe(n){dA||(dA=dMe(),dA.transparent=[0,0,0,0]);const e=dA[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const fMe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function pMe(n){const e=fMe.exec(n);let a=255,o,s,c;if(e){if(e[7]!==o){const d=+e[7];a=e[8]?Lb(d):Kf(d*255,0,255)}return o=+e[1],s=+e[3],c=+e[5],o=255&(e[2]?Lb(o):Kf(o,0,255)),s=255&(e[4]?Lb(s):Kf(s,0,255)),c=255&(e[6]?Lb(c):Kf(c,0,255)),{r:o,g:s,b:c,a}}}function mMe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${_h(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const bI=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,e0=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function gMe(n,e,a){const o=e0(_h(n.r)),s=e0(_h(n.g)),c=e0(_h(n.b));return{r:pp(bI(o+a*(e0(_h(e.r))-o))),g:pp(bI(s+a*(e0(_h(e.g))-s))),b:pp(bI(c+a*(e0(_h(e.b))-c))),a:n.a+a*(e.a-n.a)}}function hA(n,e,a){if(n){let o=K6(n);o[e]=Math.max(0,Math.min(o[e]+o[e]*a,e===0?360:1)),o=Q6(o),n.r=o[0],n.g=o[1],n.b=o[2]}}function rJ(n,e){return n&&Object.assign(e||{},n)}function RG(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=pp(n[3]))):(e=rJ(n,{r:0,g:0,b:0,a:1}),e.a=pp(e.a)),e}function yMe(n){return n.charAt(0)==="r"?pMe(n):lMe(n)}class lw{constructor(e){if(e instanceof lw)return e;const a=typeof e;let o;a==="object"?o=RG(e):a==="string"&&(o=QEe(e)||hMe(e)||yMe(e)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var e=rJ(this._rgb);return e&&(e.a=_h(e.a)),e}set rgb(e){this._rgb=RG(e)}rgbString(){return this._valid?mMe(this._rgb):void 0}hexString(){return this._valid?tMe(this._rgb):void 0}hslString(){return this._valid?uMe(this._rgb):void 0}mix(e,a){if(e){const o=this.rgb,s=e.rgb;let c;const d=a===c?.5:a,f=2*d-1,m=o.a-s.a,y=((f*m===-1?f:(f+m)/(1+f*m))+1)/2;c=1-y,o.r=255&y*o.r+c*s.r+.5,o.g=255&y*o.g+c*s.g+.5,o.b=255&y*o.b+c*s.b+.5,o.a=d*o.a+(1-d)*s.a,this.rgb=o}return this}interpolate(e,a){return e&&(this._rgb=gMe(this._rgb,e._rgb,a)),this}clone(){return new lw(this.rgb)}alpha(e){return this._rgb.a=pp(e),this}clearer(e){const a=this._rgb;return a.a*=1-e,this}greyscale(){const e=this._rgb,a=jw(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=a,this}opaquer(e){const a=this._rgb;return a.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return hA(this._rgb,2,e),this}darken(e){return hA(this._rgb,2,-e),this}saturate(e){return hA(this._rgb,1,e),this}desaturate(e){return hA(this._rgb,1,-e),this}rotate(e){return cMe(this._rgb,e),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function hh(){}const vMe=(()=>{let n=0;return()=>n++})();function ci(n){return n===null||typeof n>"u"}function lr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ja(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Xr(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Ul(n,e){return Xr(n)?n:e}function za(n,e){return typeof n>"u"?e:n}const _Me=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,oJ=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function er(n,e,a){if(n&&typeof n.call=="function")return n.apply(a,e)}function Fi(n,e,a,o){let s,c,d;if(lr(n))if(c=n.length,o)for(s=c-1;s>=0;s--)e.call(a,n[s],s);else for(s=0;s<c;s++)e.call(a,n[s],s);else if(Ja(n))for(d=Object.keys(n),c=d.length,s=0;s<c;s++)e.call(a,n[d[s]],d[s])}function dM(n,e){let a,o,s,c;if(!n||!e||n.length!==e.length)return!1;for(a=0,o=n.length;a<o;++a)if(s=n[a],c=e[a],s.datasetIndex!==c.datasetIndex||s.index!==c.index)return!1;return!0}function hM(n){if(lr(n))return n.map(hM);if(Ja(n)){const e=Object.create(null),a=Object.keys(n),o=a.length;let s=0;for(;s<o;++s)e[a[s]]=hM(n[a[s]]);return e}return n}function sJ(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function bMe(n,e,a,o){if(!sJ(n))return;const s=e[n],c=a[n];Ja(s)&&Ja(c)?cw(s,c,o):e[n]=hM(c)}function cw(n,e,a){const o=lr(e)?e:[e],s=o.length;if(!Ja(n))return n;a=a||{};const c=a.merger||bMe;let d;for(let f=0;f<s;++f){if(d=o[f],!Ja(d))continue;const m=Object.keys(d);for(let y=0,_=m.length;y<_;++y)c(m[y],n,d,a)}return n}function lx(n,e){return cw(n,e,{merger:xMe})}function xMe(n,e,a){if(!sJ(n))return;const o=e[n],s=a[n];Ja(o)&&Ja(s)?lx(o,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=hM(s))}const kG={"":n=>n,x:n=>n.x,y:n=>n.y};function wMe(n){const e=n.split("."),a=[];let o="";for(const s of e)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(a.push(o),o="");return a}function SMe(n){const e=wMe(n);return a=>{for(const o of e){if(o==="")break;a=a&&a[o]}return a}}function xp(n,e){return(kG[e]||(kG[e]=SMe(e)))(n)}function eO(n){return n.charAt(0).toUpperCase()+n.slice(1)}const uw=n=>typeof n<"u",wp=n=>typeof n=="function",DG=(n,e)=>{if(n.size!==e.size)return!1;for(const a of n)if(!e.has(a))return!1;return!0};function AMe(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const dr=Math.PI,ur=2*dr,EMe=ur+dr,fM=Number.POSITIVE_INFINITY,MMe=dr/180,uo=dr/2,Vm=dr/4,OG=dr*2/3,Jf=Math.log10,md=Math.sign;function cx(n,e,a){return Math.abs(n-e)<a}function zG(n){const e=Math.round(n);n=cx(n,e,n/1e3)?e:n;const a=Math.pow(10,Math.floor(Jf(n))),o=n/a;return(o<=1?1:o<=2?2:o<=5?5:10)*a}function TMe(n){const e=[],a=Math.sqrt(n);let o;for(o=1;o<a;o++)n%o===0&&(e.push(o),e.push(n/o));return a===(a|0)&&e.push(a),e.sort((s,c)=>s-c).pop(),e}function s_(n){return!isNaN(parseFloat(n))&&isFinite(n)}function CMe(n,e){const a=Math.round(n);return a-e<=n&&a+e>=n}function lJ(n,e,a){let o,s,c;for(o=0,s=n.length;o<s;o++)c=n[o][a],isNaN(c)||(e.min=Math.min(e.min,c),e.max=Math.max(e.max,c))}function lu(n){return n*(dr/180)}function tO(n){return n*(180/dr)}function FG(n){if(!Xr(n))return;let e=1,a=0;for(;Math.round(n*e)/e!==n;)e*=10,a++;return a}function cJ(n,e){const a=e.x-n.x,o=e.y-n.y,s=Math.sqrt(a*a+o*o);let c=Math.atan2(o,a);return c<-.5*dr&&(c+=ur),{angle:c,distance:s}}function KR(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function PMe(n,e){return(n-e+EMe)%ur-dr}function Vl(n){return(n%ur+ur)%ur}function dw(n,e,a,o){const s=Vl(n),c=Vl(e),d=Vl(a),f=Vl(c-s),m=Vl(d-s),y=Vl(s-c),_=Vl(s-d);return s===c||s===d||o&&c===d||f>m&&y<_}function Wo(n,e,a){return Math.max(e,Math.min(a,n))}function IMe(n){return Wo(n,-32768,32767)}function Mh(n,e,a,o=1e-6){return n>=Math.min(e,a)-o&&n<=Math.max(e,a)+o}function nO(n,e,a){a=a||(d=>n[d]<e);let o=n.length-1,s=0,c;for(;o-s>1;)c=s+o>>1,a(c)?s=c:o=c;return{lo:s,hi:o}}const Th=(n,e,a,o)=>nO(n,a,o?s=>{const c=n[s][e];return c<a||c===a&&n[s+1][e]===a}:s=>n[s][e]<a),LMe=(n,e,a)=>nO(n,a,o=>n[o][e]>=a);function RMe(n,e,a){let o=0,s=n.length;for(;o<s&&n[o]<e;)o++;for(;s>o&&n[s-1]>a;)s--;return o>0||s<n.length?n.slice(o,s):n}const uJ=["push","pop","shift","splice","unshift"];function kMe(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),uJ.forEach(a=>{const o="_onData"+eO(a),s=n[a];Object.defineProperty(n,a,{configurable:!0,enumerable:!1,value(...c){const d=s.apply(this,c);return n._chartjs.listeners.forEach(f=>{typeof f[o]=="function"&&f[o](...c)}),d}})})}function NG(n,e){const a=n._chartjs;if(!a)return;const o=a.listeners,s=o.indexOf(e);s!==-1&&o.splice(s,1),!(o.length>0)&&(uJ.forEach(c=>{delete n[c]}),delete n._chartjs)}function dJ(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const hJ=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function fJ(n,e){let a=[],o=!1;return function(...s){a=s,o||(o=!0,hJ.call(window,()=>{o=!1,n.apply(e,a)}))}}function DMe(n,e){let a;return function(...o){return e?(clearTimeout(a),a=setTimeout(n,e,o)):n.apply(this,o),e}}const aO=n=>n==="start"?"left":n==="end"?"right":"center",_s=(n,e,a)=>n==="start"?e:n==="end"?a:(e+a)/2,OMe=(n,e,a,o)=>n===(o?"left":"right")?a:n==="center"?(e+a)/2:e;function pJ(n,e,a){const o=e.length;let s=0,c=o;if(n._sorted){const{iScale:d,_parsed:f}=n,m=d.axis,{min:y,max:_,minDefined:x,maxDefined:S}=d.getUserBounds();x&&(s=Wo(Math.min(Th(f,m,y).lo,a?o:Th(e,m,d.getPixelForValue(y)).lo),0,o-1)),S?c=Wo(Math.max(Th(f,d.axis,_,!0).hi+1,a?0:Th(e,m,d.getPixelForValue(_),!0).hi+1),s,o)-s:c=o-s}return{start:s,count:c}}function mJ(n){const{xScale:e,yScale:a,_scaleRanges:o}=n,s={xmin:e.min,xmax:e.max,ymin:a.min,ymax:a.max};if(!o)return n._scaleRanges=s,!0;const c=o.xmin!==e.min||o.xmax!==e.max||o.ymin!==a.min||o.ymax!==a.max;return Object.assign(o,s),c}const fA=n=>n===0||n===1,BG=(n,e,a)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*ur/a)),UG=(n,e,a)=>Math.pow(2,-10*n)*Math.sin((n-e)*ur/a)+1,ux={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*uo)+1,easeOutSine:n=>Math.sin(n*uo),easeInOutSine:n=>-.5*(Math.cos(dr*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>fA(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>fA(n)?n:BG(n,.075,.3),easeOutElastic:n=>fA(n)?n:UG(n,.075,.3),easeInOutElastic(n){return fA(n)?n:n<.5?.5*BG(n*2,.1125,.45):.5+.5*UG(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-ux.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?ux.easeInBounce(n*2)*.5:ux.easeOutBounce(n*2-1)*.5+.5};function iO(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function WG(n){return iO(n)?n:new lw(n)}function xI(n){return iO(n)?n:new lw(n).saturate(.5).darken(.1).hexString()}const zMe=["x","y","borderWidth","radius","tension"],FMe=["color","borderColor","backgroundColor"];function NMe(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:FMe},numbers:{type:"number",properties:zMe}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function BMe(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const VG=new Map;function UMe(n,e){e=e||{};const a=n+JSON.stringify(e);let o=VG.get(a);return o||(o=new Intl.NumberFormat(n,e),VG.set(a,o)),o}function $w(n,e,a){return UMe(e,a).format(n)}const gJ={values(n){return lr(n)?n:""+n},numeric(n,e,a){if(n===0)return"0";const o=this.chart.options.locale;let s,c=n;if(a.length>1){const y=Math.max(Math.abs(a[0].value),Math.abs(a[a.length-1].value));(y<1e-4||y>1e15)&&(s="scientific"),c=WMe(n,a)}const d=Jf(Math.abs(c)),f=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),m={notation:s,minimumFractionDigits:f,maximumFractionDigits:f};return Object.assign(m,this.options.ticks.format),$w(n,o,m)},logarithmic(n,e,a){if(n===0)return"0";const o=a[e].significand||n/Math.pow(10,Math.floor(Jf(n)));return[1,2,3,5,10,15].includes(o)||e>.8*a.length?gJ.numeric.call(this,n,e,a):""}};function WMe(n,e){let a=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(a)>=1&&n!==Math.floor(n)&&(a=n-Math.floor(n)),a}var uC={formatters:gJ};function VMe(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,a)=>a.lineWidth,tickColor:(e,a)=>a.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:uC.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ng=Object.create(null),JR=Object.create(null);function dx(n,e){if(!e)return n;const a=e.split(".");for(let o=0,s=a.length;o<s;++o){const c=a[o];n=n[c]||(n[c]=Object.create(null))}return n}function wI(n,e,a){return typeof e=="string"?cw(dx(n,e),a):cw(dx(n,""),e)}class GMe{constructor(e,a){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>xI(s.backgroundColor),this.hoverBorderColor=(o,s)=>xI(s.borderColor),this.hoverColor=(o,s)=>xI(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(a)}set(e,a){return wI(this,e,a)}get(e){return dx(this,e)}describe(e,a){return wI(JR,e,a)}override(e,a){return wI(Ng,e,a)}route(e,a,o,s){const c=dx(this,e),d=dx(this,o),f="_"+a;Object.defineProperties(c,{[f]:{value:c[a],writable:!0},[a]:{enumerable:!0,get(){const m=this[f],y=d[s];return Ja(m)?Object.assign({},y,m):za(m,y)},set(m){this[f]=m}}})}apply(e){e.forEach(a=>a(this))}}var Yr=new GMe({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[NMe,BMe,VMe]);function HMe(n){return!n||ci(n.size)||ci(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function pM(n,e,a,o,s){let c=e[s];return c||(c=e[s]=n.measureText(s).width,a.push(s)),c>o&&(o=c),o}function jMe(n,e,a,o){o=o||{};let s=o.data=o.data||{},c=o.garbageCollect=o.garbageCollect||[];o.font!==e&&(s=o.data={},c=o.garbageCollect=[],o.font=e),n.save(),n.font=e;let d=0;const f=a.length;let m,y,_,x,S;for(m=0;m<f;m++)if(x=a[m],x!=null&&!lr(x))d=pM(n,s,c,d,x);else if(lr(x))for(y=0,_=x.length;y<_;y++)S=x[y],S!=null&&!lr(S)&&(d=pM(n,s,c,d,S));n.restore();const T=c.length/2;if(T>a.length){for(m=0;m<T;m++)delete s[c[m]];c.splice(0,T)}return d}function Gm(n,e,a){const o=n.currentDevicePixelRatio,s=a!==0?Math.max(a/2,.5):0;return Math.round((e-s)*o)/o+s}function GG(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function QR(n,e,a,o){yJ(n,e,a,o,null)}function yJ(n,e,a,o,s){let c,d,f,m,y,_,x,S;const T=e.pointStyle,I=e.rotation,k=e.radius;let D=(I||0)*MMe;if(T&&typeof T=="object"&&(c=T.toString(),c==="[object HTMLImageElement]"||c==="[object HTMLCanvasElement]")){n.save(),n.translate(a,o),n.rotate(D),n.drawImage(T,-T.width/2,-T.height/2,T.width,T.height),n.restore();return}if(!(isNaN(k)||k<=0)){switch(n.beginPath(),T){default:s?n.ellipse(a,o,s/2,k,0,0,ur):n.arc(a,o,k,0,ur),n.closePath();break;case"triangle":_=s?s/2:k,n.moveTo(a+Math.sin(D)*_,o-Math.cos(D)*k),D+=OG,n.lineTo(a+Math.sin(D)*_,o-Math.cos(D)*k),D+=OG,n.lineTo(a+Math.sin(D)*_,o-Math.cos(D)*k),n.closePath();break;case"rectRounded":y=k*.516,m=k-y,d=Math.cos(D+Vm)*m,x=Math.cos(D+Vm)*(s?s/2-y:m),f=Math.sin(D+Vm)*m,S=Math.sin(D+Vm)*(s?s/2-y:m),n.arc(a-x,o-f,y,D-dr,D-uo),n.arc(a+S,o-d,y,D-uo,D),n.arc(a+x,o+f,y,D,D+uo),n.arc(a-S,o+d,y,D+uo,D+dr),n.closePath();break;case"rect":if(!I){m=Math.SQRT1_2*k,_=s?s/2:m,n.rect(a-_,o-m,2*_,2*m);break}D+=Vm;case"rectRot":x=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,S=Math.sin(D)*(s?s/2:k),n.moveTo(a-x,o-f),n.lineTo(a+S,o-d),n.lineTo(a+x,o+f),n.lineTo(a-S,o+d),n.closePath();break;case"crossRot":D+=Vm;case"cross":x=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,S=Math.sin(D)*(s?s/2:k),n.moveTo(a-x,o-f),n.lineTo(a+x,o+f),n.moveTo(a+S,o-d),n.lineTo(a-S,o+d);break;case"star":x=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,S=Math.sin(D)*(s?s/2:k),n.moveTo(a-x,o-f),n.lineTo(a+x,o+f),n.moveTo(a+S,o-d),n.lineTo(a-S,o+d),D+=Vm,x=Math.cos(D)*(s?s/2:k),d=Math.cos(D)*k,f=Math.sin(D)*k,S=Math.sin(D)*(s?s/2:k),n.moveTo(a-x,o-f),n.lineTo(a+x,o+f),n.moveTo(a+S,o-d),n.lineTo(a-S,o+d);break;case"line":d=s?s/2:Math.cos(D)*k,f=Math.sin(D)*k,n.moveTo(a-d,o-f),n.lineTo(a+d,o+f);break;case"dash":n.moveTo(a,o),n.lineTo(a+Math.cos(D)*(s?s/2:k),o+Math.sin(D)*k);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Ch(n,e,a){return a=a||.5,!e||n&&n.x>e.left-a&&n.x<e.right+a&&n.y>e.top-a&&n.y<e.bottom+a}function dC(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function hC(n){n.restore()}function $Me(n,e,a,o,s){if(!e)return n.lineTo(a.x,a.y);if(s==="middle"){const c=(e.x+a.x)/2;n.lineTo(c,e.y),n.lineTo(c,a.y)}else s==="after"!=!!o?n.lineTo(e.x,a.y):n.lineTo(a.x,e.y);n.lineTo(a.x,a.y)}function qMe(n,e,a,o){if(!e)return n.lineTo(a.x,a.y);n.bezierCurveTo(o?e.cp1x:e.cp2x,o?e.cp1y:e.cp2y,o?a.cp2x:a.cp1x,o?a.cp2y:a.cp1y,a.x,a.y)}function XMe(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),ci(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function YMe(n,e,a,o,s){if(s.strikethrough||s.underline){const c=n.measureText(o),d=e-c.actualBoundingBoxLeft,f=e+c.actualBoundingBoxRight,m=a-c.actualBoundingBoxAscent,y=a+c.actualBoundingBoxDescent,_=s.strikethrough?(m+y)/2:y;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(d,_),n.lineTo(f,_),n.stroke()}}function ZMe(n,e){const a=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=a}function Bg(n,e,a,o,s,c={}){const d=lr(e)?e:[e],f=c.strokeWidth>0&&c.strokeColor!=="";let m,y;for(n.save(),n.font=s.string,XMe(n,c),m=0;m<d.length;++m)y=d[m],c.backdrop&&ZMe(n,c.backdrop),f&&(c.strokeColor&&(n.strokeStyle=c.strokeColor),ci(c.strokeWidth)||(n.lineWidth=c.strokeWidth),n.strokeText(y,a,o,c.maxWidth)),n.fillText(y,a,o,c.maxWidth),YMe(n,a,o,y,c),o+=Number(s.lineHeight);n.restore()}function hw(n,e){const{x:a,y:o,w:s,h:c,radius:d}=e;n.arc(a+d.topLeft,o+d.topLeft,d.topLeft,1.5*dr,dr,!0),n.lineTo(a,o+c-d.bottomLeft),n.arc(a+d.bottomLeft,o+c-d.bottomLeft,d.bottomLeft,dr,uo,!0),n.lineTo(a+s-d.bottomRight,o+c),n.arc(a+s-d.bottomRight,o+c-d.bottomRight,d.bottomRight,uo,0,!0),n.lineTo(a+s,o+d.topRight),n.arc(a+s-d.topRight,o+d.topRight,d.topRight,0,-uo,!0),n.lineTo(a+d.topLeft,o)}const KMe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,JMe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function QMe(n,e){const a=(""+n).match(KMe);if(!a||a[1]==="normal")return e*1.2;switch(n=+a[2],a[3]){case"px":return n;case"%":n/=100;break}return e*n}const eTe=n=>+n||0;function rO(n,e){const a={},o=Ja(e),s=o?Object.keys(e):e,c=Ja(n)?o?d=>za(n[d],n[e[d]]):d=>n[d]:()=>n;for(const d of s)a[d]=eTe(c(d));return a}function vJ(n){return rO(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Ag(n){return rO(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ms(n){const e=vJ(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ro(n,e){n=n||{},e=e||Yr.font;let a=za(n.size,e.size);typeof a=="string"&&(a=parseInt(a,10));let o=za(n.style,e.style);o&&!(""+o).match(JMe)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:za(n.family,e.family),lineHeight:QMe(za(n.lineHeight,e.lineHeight),a),size:a,style:o,weight:za(n.weight,e.weight),string:""};return s.string=HMe(s),s}function Rb(n,e,a,o){let s=!0,c,d,f;for(c=0,d=n.length;c<d;++c)if(f=n[c],f!==void 0&&(e!==void 0&&typeof f=="function"&&(f=f(e),s=!1),a!==void 0&&lr(f)&&(f=f[a%f.length],s=!1),f!==void 0))return o&&!s&&(o.cacheable=!1),f}function tTe(n,e,a){const{min:o,max:s}=n,c=oJ(e,(s-o)/2),d=(f,m)=>a&&f===0?0:f+m;return{min:d(o,-Math.abs(c)),max:d(s,c)}}function Ip(n,e){return Object.assign(Object.create(n),e)}function oO(n,e=[""],a,o,s=()=>n[0]){const c=a||n;typeof o>"u"&&(o=wJ("_fallback",n));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:c,_fallback:o,_getTarget:s,override:f=>oO([f,...n],e,c,o)};return new Proxy(d,{deleteProperty(f,m){return delete f[m],delete f._keys,delete n[0][m],!0},get(f,m){return bJ(f,m,()=>cTe(m,e,n,f))},getOwnPropertyDescriptor(f,m){return Reflect.getOwnPropertyDescriptor(f._scopes[0],m)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(f,m){return jG(f).includes(m)},ownKeys(f){return jG(f)},set(f,m,y){const _=f._storage||(f._storage=s());return f[m]=_[m]=y,delete f._keys,!0}})}function l_(n,e,a,o){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:a,_stack:new Set,_descriptors:_J(n,o),setContext:c=>l_(n,c,a,o),override:c=>l_(n.override(c),e,a,o)};return new Proxy(s,{deleteProperty(c,d){return delete c[d],delete n[d],!0},get(c,d,f){return bJ(c,d,()=>aTe(c,d,f))},getOwnPropertyDescriptor(c,d){return c._descriptors.allKeys?Reflect.has(n,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,d)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(c,d){return Reflect.has(n,d)},ownKeys(){return Reflect.ownKeys(n)},set(c,d,f){return n[d]=f,delete c[d],!0}})}function _J(n,e={scriptable:!0,indexable:!0}){const{_scriptable:a=e.scriptable,_indexable:o=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:a,indexable:o,isScriptable:wp(a)?a:()=>a,isIndexable:wp(o)?o:()=>o}}const nTe=(n,e)=>n?n+eO(e):e,sO=(n,e)=>Ja(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function bJ(n,e,a){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const o=a();return n[e]=o,o}function aTe(n,e,a){const{_proxy:o,_context:s,_subProxy:c,_descriptors:d}=n;let f=o[e];return wp(f)&&d.isScriptable(e)&&(f=iTe(e,f,n,a)),lr(f)&&f.length&&(f=rTe(e,f,n,d.isIndexable)),sO(e,f)&&(f=l_(f,s,c&&c[e],d)),f}function iTe(n,e,a,o){const{_proxy:s,_context:c,_subProxy:d,_stack:f}=a;if(f.has(n))throw new Error("Recursion detected: "+Array.from(f).join("->")+"->"+n);f.add(n);let m=e(c,d||o);return f.delete(n),sO(n,m)&&(m=lO(s._scopes,s,n,m)),m}function rTe(n,e,a,o){const{_proxy:s,_context:c,_subProxy:d,_descriptors:f}=a;if(typeof c.index<"u"&&o(n))return e[c.index%e.length];if(Ja(e[0])){const m=e,y=s._scopes.filter(_=>_!==m);e=[];for(const _ of m){const x=lO(y,s,n,_);e.push(l_(x,c,d&&d[n],f))}}return e}function xJ(n,e,a){return wp(n)?n(e,a):n}const oTe=(n,e)=>n===!0?e:typeof n=="string"?xp(e,n):void 0;function sTe(n,e,a,o,s){for(const c of e){const d=oTe(a,c);if(d){n.add(d);const f=xJ(d._fallback,a,s);if(typeof f<"u"&&f!==a&&f!==o)return f}else if(d===!1&&typeof o<"u"&&a!==o)return null}return!1}function lO(n,e,a,o){const s=e._rootScopes,c=xJ(e._fallback,a,o),d=[...n,...s],f=new Set;f.add(o);let m=HG(f,d,a,c||a,o);return m===null||typeof c<"u"&&c!==a&&(m=HG(f,d,c,m,o),m===null)?!1:oO(Array.from(f),[""],s,c,()=>lTe(e,a,o))}function HG(n,e,a,o,s){for(;a;)a=sTe(n,e,a,o,s);return a}function lTe(n,e,a){const o=n._getTarget();e in o||(o[e]={});const s=o[e];return lr(s)&&Ja(a)?a:s||{}}function cTe(n,e,a,o){let s;for(const c of e)if(s=wJ(nTe(c,n),a),typeof s<"u")return sO(n,s)?lO(a,o,n,s):s}function wJ(n,e){for(const a of e){if(!a)continue;const o=a[n];if(typeof o<"u")return o}}function jG(n){let e=n._keys;return e||(e=n._keys=uTe(n._scopes)),e}function uTe(n){const e=new Set;for(const a of n)for(const o of Object.keys(a).filter(s=>!s.startsWith("_")))e.add(o);return Array.from(e)}function SJ(n,e,a,o){const{iScale:s}=n,{key:c="r"}=this._parsing,d=new Array(o);let f,m,y,_;for(f=0,m=o;f<m;++f)y=f+a,_=e[y],d[f]={r:s.parse(xp(_,c),y)};return d}const dTe=Number.EPSILON||1e-14,c_=(n,e)=>e<n.length&&!n[e].skip&&n[e],AJ=n=>n==="x"?"y":"x";function hTe(n,e,a,o){const s=n.skip?e:n,c=e,d=a.skip?e:a,f=KR(c,s),m=KR(d,c);let y=f/(f+m),_=m/(f+m);y=isNaN(y)?0:y,_=isNaN(_)?0:_;const x=o*y,S=o*_;return{previous:{x:c.x-x*(d.x-s.x),y:c.y-x*(d.y-s.y)},next:{x:c.x+S*(d.x-s.x),y:c.y+S*(d.y-s.y)}}}function fTe(n,e,a){const o=n.length;let s,c,d,f,m,y=c_(n,0);for(let _=0;_<o-1;++_)if(m=y,y=c_(n,_+1),!(!m||!y)){if(cx(e[_],0,dTe)){a[_]=a[_+1]=0;continue}s=a[_]/e[_],c=a[_+1]/e[_],f=Math.pow(s,2)+Math.pow(c,2),!(f<=9)&&(d=3/Math.sqrt(f),a[_]=s*d*e[_],a[_+1]=c*d*e[_])}}function pTe(n,e,a="x"){const o=AJ(a),s=n.length;let c,d,f,m=c_(n,0);for(let y=0;y<s;++y){if(d=f,f=m,m=c_(n,y+1),!f)continue;const _=f[a],x=f[o];d&&(c=(_-d[a])/3,f[`cp1${a}`]=_-c,f[`cp1${o}`]=x-c*e[y]),m&&(c=(m[a]-_)/3,f[`cp2${a}`]=_+c,f[`cp2${o}`]=x+c*e[y])}}function mTe(n,e="x"){const a=AJ(e),o=n.length,s=Array(o).fill(0),c=Array(o);let d,f,m,y=c_(n,0);for(d=0;d<o;++d)if(f=m,m=y,y=c_(n,d+1),!!m){if(y){const _=y[e]-m[e];s[d]=_!==0?(y[a]-m[a])/_:0}c[d]=f?y?md(s[d-1])!==md(s[d])?0:(s[d-1]+s[d])/2:s[d-1]:s[d]}fTe(n,s,c),pTe(n,c,e)}function pA(n,e,a){return Math.max(Math.min(n,a),e)}function gTe(n,e){let a,o,s,c,d,f=Ch(n[0],e);for(a=0,o=n.length;a<o;++a)d=c,c=f,f=a<o-1&&Ch(n[a+1],e),c&&(s=n[a],d&&(s.cp1x=pA(s.cp1x,e.left,e.right),s.cp1y=pA(s.cp1y,e.top,e.bottom)),f&&(s.cp2x=pA(s.cp2x,e.left,e.right),s.cp2y=pA(s.cp2y,e.top,e.bottom)))}function yTe(n,e,a,o,s){let c,d,f,m;if(e.spanGaps&&(n=n.filter(y=>!y.skip)),e.cubicInterpolationMode==="monotone")mTe(n,s);else{let y=o?n[n.length-1]:n[0];for(c=0,d=n.length;c<d;++c)f=n[c],m=hTe(y,f,n[Math.min(c+1,d-(o?0:1))%d],e.tension),f.cp1x=m.previous.x,f.cp1y=m.previous.y,f.cp2x=m.next.x,f.cp2y=m.next.y,y=f}e.capBezierPoints&&gTe(n,a)}function EJ(){return typeof window<"u"&&typeof document<"u"}function cO(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function mM(n,e,a){let o;return typeof n=="string"?(o=parseInt(n,10),n.indexOf("%")!==-1&&(o=o/100*e.parentNode[a])):o=n,o}const fC=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function vTe(n,e){return fC(n).getPropertyValue(e)}const _Te=["top","right","bottom","left"];function Eg(n,e,a){const o={};a=a?"-"+a:"";for(let s=0;s<4;s++){const c=_Te[s];o[c]=parseFloat(n[e+"-"+c+a])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const bTe=(n,e,a)=>(n>0||e>0)&&(!a||!a.shadowRoot);function xTe(n,e){const a=n.touches,o=a&&a.length?a[0]:n,{offsetX:s,offsetY:c}=o;let d=!1,f,m;if(bTe(s,c,n.target))f=s,m=c;else{const y=e.getBoundingClientRect();f=o.clientX-y.left,m=o.clientY-y.top,d=!0}return{x:f,y:m,box:d}}function tg(n,e){if("native"in n)return n;const{canvas:a,currentDevicePixelRatio:o}=e,s=fC(a),c=s.boxSizing==="border-box",d=Eg(s,"padding"),f=Eg(s,"border","width"),{x:m,y,box:_}=xTe(n,a),x=d.left+(_&&f.left),S=d.top+(_&&f.top);let{width:T,height:I}=e;return c&&(T-=d.width+f.width,I-=d.height+f.height),{x:Math.round((m-x)/T*a.width/o),y:Math.round((y-S)/I*a.height/o)}}function wTe(n,e,a){let o,s;if(e===void 0||a===void 0){const c=cO(n);if(!c)e=n.clientWidth,a=n.clientHeight;else{const d=c.getBoundingClientRect(),f=fC(c),m=Eg(f,"border","width"),y=Eg(f,"padding");e=d.width-y.width-m.width,a=d.height-y.height-m.height,o=mM(f.maxWidth,c,"clientWidth"),s=mM(f.maxHeight,c,"clientHeight")}}return{width:e,height:a,maxWidth:o||fM,maxHeight:s||fM}}const mA=n=>Math.round(n*10)/10;function STe(n,e,a,o){const s=fC(n),c=Eg(s,"margin"),d=mM(s.maxWidth,n,"clientWidth")||fM,f=mM(s.maxHeight,n,"clientHeight")||fM,m=wTe(n,e,a);let{width:y,height:_}=m;if(s.boxSizing==="content-box"){const S=Eg(s,"border","width"),T=Eg(s,"padding");y-=T.width+S.width,_-=T.height+S.height}return y=Math.max(0,y-c.width),_=Math.max(0,o?y/o:_-c.height),y=mA(Math.min(y,d,m.maxWidth)),_=mA(Math.min(_,f,m.maxHeight)),y&&!_&&(_=mA(y/2)),(e!==void 0||a!==void 0)&&o&&m.height&&_>m.height&&(_=m.height,y=mA(Math.floor(_*o))),{width:y,height:_}}function $G(n,e,a){const o=e||1,s=Math.floor(n.height*o),c=Math.floor(n.width*o);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const d=n.canvas;return d.style&&(a||!d.style.height&&!d.style.width)&&(d.style.height=`${n.height}px`,d.style.width=`${n.width}px`),n.currentDevicePixelRatio!==o||d.height!==s||d.width!==c?(n.currentDevicePixelRatio=o,d.height=s,d.width=c,n.ctx.setTransform(o,0,0,o,0,0),!0):!1}const ATe=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function qG(n,e){const a=vTe(n,e),o=a&&a.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function ng(n,e,a,o){return{x:n.x+a*(e.x-n.x),y:n.y+a*(e.y-n.y)}}function ETe(n,e,a,o){return{x:n.x+a*(e.x-n.x),y:o==="middle"?a<.5?n.y:e.y:o==="after"?a<1?n.y:e.y:a>0?e.y:n.y}}function MTe(n,e,a,o){const s={x:n.cp2x,y:n.cp2y},c={x:e.cp1x,y:e.cp1y},d=ng(n,s,a),f=ng(s,c,a),m=ng(c,e,a),y=ng(d,f,a),_=ng(f,m,a);return ng(y,_,a)}const TTe=function(n,e){return{x(a){return n+n+e-a},setWidth(a){e=a},textAlign(a){return a==="center"?a:a==="right"?"left":"right"},xPlus(a,o){return a-o},leftForLtr(a,o){return a-o}}},CTe=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function N0(n,e,a){return n?TTe(e,a):CTe()}function MJ(n,e){let a,o;(e==="ltr"||e==="rtl")&&(a=n.canvas.style,o=[a.getPropertyValue("direction"),a.getPropertyPriority("direction")],a.setProperty("direction",e,"important"),n.prevTextDirection=o)}function TJ(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function CJ(n){return n==="angle"?{between:dw,compare:PMe,normalize:Vl}:{between:Mh,compare:(e,a)=>e-a,normalize:e=>e}}function XG({start:n,end:e,count:a,loop:o,style:s}){return{start:n%a,end:e%a,loop:o&&(e-n+1)%a===0,style:s}}function PTe(n,e,a){const{property:o,start:s,end:c}=a,{between:d,normalize:f}=CJ(o),m=e.length;let{start:y,end:_,loop:x}=n,S,T;if(x){for(y+=m,_+=m,S=0,T=m;S<T&&d(f(e[y%m][o]),s,c);++S)y--,_--;y%=m,_%=m}return _<y&&(_+=m),{start:y,end:_,loop:x,style:n.style}}function PJ(n,e,a){if(!a)return[n];const{property:o,start:s,end:c}=a,d=e.length,{compare:f,between:m,normalize:y}=CJ(o),{start:_,end:x,loop:S,style:T}=PTe(n,e,a),I=[];let k=!1,D=null,L,O,F;const B=()=>m(s,F,L)&&f(s,F)!==0,G=()=>f(c,L)===0||m(c,F,L),q=()=>k||B(),X=()=>!k||G();for(let te=_,V=_;te<=x;++te)O=e[te%d],!O.skip&&(L=y(O[o]),L!==F&&(k=m(L,s,c),D===null&&q()&&(D=f(L,s)===0?te:V),D!==null&&X()&&(I.push(XG({start:D,end:te,loop:S,count:d,style:T})),D=null),V=te,F=L));return D!==null&&I.push(XG({start:D,end:x,loop:S,count:d,style:T})),I}function IJ(n,e){const a=[],o=n.segments;for(let s=0;s<o.length;s++){const c=PJ(o[s],n.points,e);c.length&&a.push(...c)}return a}function ITe(n,e,a,o){let s=0,c=e-1;if(a&&!o)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,a&&(c+=s);c>s&&n[c%e].skip;)c--;return c%=e,{start:s,end:c}}function LTe(n,e,a,o){const s=n.length,c=[];let d=e,f=n[e],m;for(m=e+1;m<=a;++m){const y=n[m%s];y.skip||y.stop?f.skip||(o=!1,c.push({start:e%s,end:(m-1)%s,loop:o}),e=d=y.stop?m:null):(d=m,f.skip&&(e=m)),f=y}return d!==null&&c.push({start:e%s,end:d%s,loop:o}),c}function RTe(n,e){const a=n.points,o=n.options.spanGaps,s=a.length;if(!s)return[];const c=!!n._loop,{start:d,end:f}=ITe(a,s,c,o);if(o===!0)return YG(n,[{start:d,end:f,loop:c}],a,e);const m=f<d?f+s:f,y=!!n._fullLoop&&d===0&&f===s-1;return YG(n,LTe(a,d,m,y),a,e)}function YG(n,e,a,o){return!o||!o.setContext||!a?e:kTe(n,e,a,o)}function kTe(n,e,a,o){const s=n._chart.getContext(),c=ZG(n.options),{_datasetIndex:d,options:{spanGaps:f}}=n,m=a.length,y=[];let _=c,x=e[0].start,S=x;function T(I,k,D,L){const O=f?-1:1;if(I!==k){for(I+=m;a[I%m].skip;)I-=O;for(;a[k%m].skip;)k+=O;I%m!==k%m&&(y.push({start:I%m,end:k%m,loop:D,style:L}),_=L,x=k%m)}}for(const I of e){x=f?x:I.start;let k=a[x%m],D;for(S=x+1;S<=I.end;S++){const L=a[S%m];D=ZG(o.setContext(Ip(s,{type:"segment",p0:k,p1:L,p0DataIndex:(S-1)%m,p1DataIndex:S%m,datasetIndex:d}))),DTe(D,_)&&T(x,S-1,I.loop,_),k=L,_=D}x<S-1&&T(x,S-1,I.loop,_)}return y}function ZG(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function DTe(n,e){if(!e)return!1;const a=[],o=function(s,c){return iO(c)?(a.includes(c)||a.push(c),a.indexOf(c)):c};return JSON.stringify(n,o)!==JSON.stringify(e,o)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class OTe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,a,o,s){const c=a.listeners[s],d=a.duration;c.forEach(f=>f({chart:e,initial:a.initial,numSteps:d,currentStep:Math.min(o-a.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=hJ.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let a=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const c=o.items;let d=c.length-1,f=!1,m;for(;d>=0;--d)m=c[d],m._active?(m._total>o.duration&&(o.duration=m._total),m.tick(e),f=!0):(c[d]=c[c.length-1],c.pop());f&&(s.draw(),this._notify(s,o,e,"progress")),c.length||(o.running=!1,this._notify(s,o,e,"complete"),o.initial=!1),a+=c.length}),this._lastDate=e,a===0&&(this._running=!1)}_getAnims(e){const a=this._charts;let o=a.get(e);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},a.set(e,o)),o}listen(e,a,o){this._getAnims(e).listeners[a].push(o)}add(e,a){!a||!a.length||this._getAnims(e).items.push(...a)}has(e){return this._getAnims(e).items.length>0}start(e){const a=this._charts.get(e);a&&(a.running=!0,a.start=Date.now(),a.duration=a.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const a=this._charts.get(e);return!(!a||!a.running||!a.items.length)}stop(e){const a=this._charts.get(e);if(!a||!a.items.length)return;const o=a.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();a.items=[],this._notify(e,a,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ph=new OTe;const KG="transparent",zTe={boolean(n,e,a){return a>.5?e:n},color(n,e,a){const o=WG(n||KG),s=o.valid&&WG(e||KG);return s&&s.valid?s.mix(o,a).hexString():e},number(n,e,a){return n+(e-n)*a}};class FTe{constructor(e,a,o,s){const c=a[o];s=Rb([e.to,s,c,e.from]);const d=Rb([e.from,c,s]);this._active=!0,this._fn=e.fn||zTe[e.type||typeof d],this._easing=ux[e.easing]||ux.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=a,this._prop=o,this._from=d,this._to=s,this._promises=void 0}active(){return this._active}update(e,a,o){if(this._active){this._notify(!1);const s=this._target[this._prop],c=o-this._start,d=this._duration-c;this._start=o,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=c,this._loop=!!e.loop,this._to=Rb([e.to,a,s,e.from]),this._from=Rb([e.from,s,a])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const a=e-this._start,o=this._duration,s=this._prop,c=this._from,d=this._loop,f=this._to;let m;if(this._active=c!==f&&(d||a<o),!this._active){this._target[s]=f,this._notify(!0);return}if(a<0){this._target[s]=c;return}m=a/o%2,m=d&&m>1?2-m:m,m=this._easing(Math.min(1,Math.max(0,m))),this._target[s]=this._fn(c,f,m)}wait(){const e=this._promises||(this._promises=[]);return new Promise((a,o)=>{e.push({res:a,rej:o})})}_notify(e){const a=e?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][a]()}}class LJ{constructor(e,a){this._chart=e,this._properties=new Map,this.configure(a)}configure(e){if(!Ja(e))return;const a=Object.keys(Yr.animation),o=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const c=e[s];if(!Ja(c))return;const d={};for(const f of a)d[f]=c[f];(lr(c.properties)&&c.properties||[s]).forEach(f=>{(f===s||!o.has(f))&&o.set(f,d)})})}_animateOptions(e,a){const o=a.options,s=BTe(e,o);if(!s)return[];const c=this._createAnimations(s,o);return o.$shared&&NTe(e.options.$animations,o).then(()=>{e.options=o},()=>{}),c}_createAnimations(e,a){const o=this._properties,s=[],c=e.$animations||(e.$animations={}),d=Object.keys(a),f=Date.now();let m;for(m=d.length-1;m>=0;--m){const y=d[m];if(y.charAt(0)==="$")continue;if(y==="options"){s.push(...this._animateOptions(e,a));continue}const _=a[y];let x=c[y];const S=o.get(y);if(x)if(S&&x.active()){x.update(S,_,f);continue}else x.cancel();if(!S||!S.duration){e[y]=_;continue}c[y]=x=new FTe(S,e,y,_),s.push(x)}return s}update(e,a){if(this._properties.size===0){Object.assign(e,a);return}const o=this._createAnimations(e,a);if(o.length)return ph.add(this._chart,o),!0}}function NTe(n,e){const a=[],o=Object.keys(e);for(let s=0;s<o.length;s++){const c=n[o[s]];c&&c.active()&&a.push(c.wait())}return Promise.all(a)}function BTe(n,e){if(!e)return;let a=n.options;if(!a){n.options=e;return}return a.$shared&&(n.options=a=Object.assign({},a,{$shared:!1,$animations:{}})),a}function JG(n,e){const a=n&&n.options||{},o=a.reverse,s=a.min===void 0?e:0,c=a.max===void 0?e:0;return{start:o?c:s,end:o?s:c}}function UTe(n,e,a){if(a===!1)return!1;const o=JG(n,a),s=JG(e,a);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function WTe(n){let e,a,o,s;return Ja(n)?(e=n.top,a=n.right,o=n.bottom,s=n.left):e=a=o=s=n,{top:e,right:a,bottom:o,left:s,disabled:n===!1}}function RJ(n,e){const a=[],o=n._getSortedDatasetMetas(e);let s,c;for(s=0,c=o.length;s<c;++s)a.push(o[s].index);return a}function QG(n,e,a,o={}){const s=n.keys,c=o.mode==="single";let d,f,m,y;if(e!==null){for(d=0,f=s.length;d<f;++d){if(m=+s[d],m===a){if(o.all)continue;break}y=n.values[m],Xr(y)&&(c||e===0||md(e)===md(y))&&(e+=y)}return e}}function VTe(n){const e=Object.keys(n),a=new Array(e.length);let o,s,c;for(o=0,s=e.length;o<s;++o)c=e[o],a[o]={x:c,y:n[c]};return a}function eH(n,e){const a=n&&n.options.stacked;return a||a===void 0&&e.stack!==void 0}function GTe(n,e,a){return`${n.id}.${e.id}.${a.stack||a.type}`}function HTe(n){const{min:e,max:a,minDefined:o,maxDefined:s}=n.getUserBounds();return{min:o?e:Number.NEGATIVE_INFINITY,max:s?a:Number.POSITIVE_INFINITY}}function jTe(n,e,a){const o=n[e]||(n[e]={});return o[a]||(o[a]={})}function tH(n,e,a,o){for(const s of e.getMatchingVisibleMetas(o).reverse()){const c=n[s.index];if(a&&c>0||!a&&c<0)return s.index}return null}function nH(n,e){const{chart:a,_cachedMeta:o}=n,s=a._stacks||(a._stacks={}),{iScale:c,vScale:d,index:f}=o,m=c.axis,y=d.axis,_=GTe(c,d,o),x=e.length;let S;for(let T=0;T<x;++T){const I=e[T],{[m]:k,[y]:D}=I,L=I._stacks||(I._stacks={});S=L[y]=jTe(s,_,k),S[f]=D,S._top=tH(S,d,!0,o.type),S._bottom=tH(S,d,!1,o.type);const O=S._visualValues||(S._visualValues={});O[f]=D}}function SI(n,e){const a=n.scales;return Object.keys(a).filter(o=>a[o].axis===e).shift()}function $Te(n,e){return Ip(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function qTe(n,e,a){return Ip(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:a,index:e,mode:"default",type:"data"})}function mb(n,e){const a=n.controller.index,o=n.vScale&&n.vScale.axis;if(o){e=e||n._parsed;for(const s of e){const c=s._stacks;if(!c||c[o]===void 0||c[o][a]===void 0)return;delete c[o][a],c[o]._visualValues!==void 0&&c[o]._visualValues[a]!==void 0&&delete c[o]._visualValues[a]}}}const AI=n=>n==="reset"||n==="none",aH=(n,e)=>e?n:Object.assign({},n),XTe=(n,e,a)=>n&&!e.hidden&&e._stacked&&{keys:RJ(a,!0),values:null};class du{constructor(e,a){this.chart=e,this._ctx=e.ctx,this.index=a,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=eH(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&mb(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,a=this._cachedMeta,o=this.getDataset(),s=(x,S,T,I)=>x==="x"?S:x==="r"?I:T,c=a.xAxisID=za(o.xAxisID,SI(e,"x")),d=a.yAxisID=za(o.yAxisID,SI(e,"y")),f=a.rAxisID=za(o.rAxisID,SI(e,"r")),m=a.indexAxis,y=a.iAxisID=s(m,c,d,f),_=a.vAxisID=s(m,d,c,f);a.xScale=this.getScaleForId(c),a.yScale=this.getScaleForId(d),a.rScale=this.getScaleForId(f),a.iScale=this.getScaleForId(y),a.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const a=this._cachedMeta;return e===a.iScale?a.vScale:a.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&NG(this._data,this),e._stacked&&mb(e)}_dataCheck(){const e=this.getDataset(),a=e.data||(e.data=[]),o=this._data;if(Ja(a))this._data=VTe(a);else if(o!==a){if(o){NG(o,this);const s=this._cachedMeta;mb(s),s._parsed=[]}a&&Object.isExtensible(a)&&kMe(a,this),this._syncList=[],this._data=a}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const a=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const c=a._stacked;a._stacked=eH(a.vScale,a),a.stack!==o.stack&&(s=!0,mb(a),a.stack=o.stack),this._resyncElements(e),(s||c!==a._stacked)&&nH(this,a._parsed)}configure(){const e=this.chart.config,a=e.datasetScopeKeys(this._type),o=e.getOptionScopes(this.getDataset(),a,!0);this.options=e.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,a){const{_cachedMeta:o,_data:s}=this,{iScale:c,_stacked:d}=o,f=c.axis;let m=e===0&&a===s.length?!0:o._sorted,y=e>0&&o._parsed[e-1],_,x,S;if(this._parsing===!1)o._parsed=s,o._sorted=!0,S=s;else{lr(s[e])?S=this.parseArrayData(o,s,e,a):Ja(s[e])?S=this.parseObjectData(o,s,e,a):S=this.parsePrimitiveData(o,s,e,a);const T=()=>x[f]===null||y&&x[f]<y[f];for(_=0;_<a;++_)o._parsed[_+e]=x=S[_],m&&(T()&&(m=!1),y=x);o._sorted=m}d&&nH(this,S)}parsePrimitiveData(e,a,o,s){const{iScale:c,vScale:d}=e,f=c.axis,m=d.axis,y=c.getLabels(),_=c===d,x=new Array(s);let S,T,I;for(S=0,T=s;S<T;++S)I=S+o,x[S]={[f]:_||c.parse(y[I],I),[m]:d.parse(a[I],I)};return x}parseArrayData(e,a,o,s){const{xScale:c,yScale:d}=e,f=new Array(s);let m,y,_,x;for(m=0,y=s;m<y;++m)_=m+o,x=a[_],f[m]={x:c.parse(x[0],_),y:d.parse(x[1],_)};return f}parseObjectData(e,a,o,s){const{xScale:c,yScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,y=new Array(s);let _,x,S,T;for(_=0,x=s;_<x;++_)S=_+o,T=a[S],y[_]={x:c.parse(xp(T,f),S),y:d.parse(xp(T,m),S)};return y}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,a,o){const s=this.chart,c=this._cachedMeta,d=a[e.axis],f={keys:RJ(s,!0),values:a._stacks[e.axis]._visualValues};return QG(f,d,c.index,{mode:o})}updateRangeFromParsed(e,a,o,s){const c=o[a.axis];let d=c===null?NaN:c;const f=s&&o._stacks[a.axis];s&&f&&(s.values=f,d=QG(s,c,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,a){const o=this._cachedMeta,s=o._parsed,c=o._sorted&&e===o.iScale,d=s.length,f=this._getOtherScale(e),m=XTe(a,o,this.chart),y={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:x}=HTe(f);let S,T;function I(){T=s[S];const k=T[f.axis];return!Xr(T[e.axis])||_>k||x<k}for(S=0;S<d&&!(!I()&&(this.updateRangeFromParsed(y,e,T,m),c));++S);if(c){for(S=d-1;S>=0;--S)if(!I()){this.updateRangeFromParsed(y,e,T,m);break}}return y}getAllParsedValues(e){const a=this._cachedMeta._parsed,o=[];let s,c,d;for(s=0,c=a.length;s<c;++s)d=a[s][e.axis],Xr(d)&&o.push(d);return o}getMaxOverflow(){return!1}getLabelAndValue(e){const a=this._cachedMeta,o=a.iScale,s=a.vScale,c=this.getParsed(e);return{label:o?""+o.getLabelForValue(c[o.axis]):"",value:s?""+s.getLabelForValue(c[s.axis]):""}}_update(e){const a=this._cachedMeta;this.update(e||"default"),a._clip=WTe(za(this.options.clip,UTe(a.xScale,a.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,a=this.chart,o=this._cachedMeta,s=o.data||[],c=a.chartArea,d=[],f=this._drawStart||0,m=this._drawCount||s.length-f,y=this.options.drawActiveElementsOnTop;let _;for(o.dataset&&o.dataset.draw(e,c,f,m),_=f;_<f+m;++_){const x=s[_];x.hidden||(x.active&&y?d.push(x):x.draw(e,c))}for(_=0;_<d.length;++_)d[_].draw(e,c)}getStyle(e,a){const o=a?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(e||0,o)}getContext(e,a,o){const s=this.getDataset();let c;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];c=d.$context||(d.$context=qTe(this.getContext(),e,d)),c.parsed=this.getParsed(e),c.raw=s.data[e],c.index=c.dataIndex=e}else c=this.$context||(this.$context=$Te(this.chart.getContext(),this.index)),c.dataset=s,c.index=c.datasetIndex=this.index;return c.active=!!a,c.mode=o,c}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,a){return this._resolveElementOptions(this.dataElementType.id,a,e)}_resolveElementOptions(e,a="default",o){const s=a==="active",c=this._cachedDataOpts,d=e+"-"+a,f=c[d],m=this.enableOptionSharing&&uw(o);if(f)return aH(f,m);const y=this.chart.config,_=y.datasetElementScopeKeys(this._type,e),x=s?[`${e}Hover`,"hover",e,""]:[e,""],S=y.getOptionScopes(this.getDataset(),_),T=Object.keys(Yr.elements[e]),I=()=>this.getContext(o,s,a),k=y.resolveNamedOptions(S,T,I,x);return k.$shared&&(k.$shared=m,c[d]=Object.freeze(aH(k,m))),k}_resolveAnimations(e,a,o){const s=this.chart,c=this._cachedDataOpts,d=`animation-${a}`,f=c[d];if(f)return f;let m;if(s.options.animation!==!1){const _=this.chart.config,x=_.datasetAnimationScopeKeys(this._type,a),S=_.getOptionScopes(this.getDataset(),x);m=_.createResolver(S,this.getContext(e,o,a))}const y=new LJ(s,m&&m.animations);return m&&m._cacheable&&(c[d]=Object.freeze(y)),y}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,a){return!a||AI(e)||this.chart._animationsDisabled}_getSharedOptions(e,a){const o=this.resolveDataElementOptions(e,a),s=this._sharedOptions,c=this.getSharedOptions(o),d=this.includeOptions(a,c)||c!==s;return this.updateSharedOptions(c,a,o),{sharedOptions:c,includeOptions:d}}updateElement(e,a,o,s){AI(s)?Object.assign(e,o):this._resolveAnimations(a,s).update(e,o)}updateSharedOptions(e,a,o){e&&!AI(a)&&this._resolveAnimations(void 0,a).update(e,o)}_setStyle(e,a,o,s){e.active=s;const c=this.getStyle(a,s);this._resolveAnimations(a,o,s).update(e,{options:!s&&this.getSharedOptions(c)||c})}removeHoverStyle(e,a,o){this._setStyle(e,o,"active",!1)}setHoverStyle(e,a,o){this._setStyle(e,o,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const a=this._data,o=this._cachedMeta.data;for(const[f,m,y]of this._syncList)this[f](m,y);this._syncList=[];const s=o.length,c=a.length,d=Math.min(c,s);d&&this.parse(0,d),c>s?this._insertElements(s,c-s,e):c<s&&this._removeElements(c,s-c)}_insertElements(e,a,o=!0){const s=this._cachedMeta,c=s.data,d=e+a;let f;const m=y=>{for(y.length+=a,f=y.length-1;f>=d;f--)y[f]=y[f-a]};for(m(c),f=e;f<d;++f)c[f]=new this.dataElementType;this._parsing&&m(s._parsed),this.parse(e,a),o&&this.updateElements(c,e,a,"reset")}updateElements(e,a,o,s){}_removeElements(e,a){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(e,a);o._stacked&&mb(o,s)}o.data.splice(e,a)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[a,o,s]=e;this[a](o,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,a){a&&this._sync(["_removeElements",e,a]);const o=arguments.length-2;o&&this._sync(["_insertElements",e,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}_n(du,"defaults",{}),_n(du,"datasetElementType",null),_n(du,"dataElementType",null);function YTe(n,e){if(!n._cache.$bar){const a=n.getMatchingVisibleMetas(e);let o=[];for(let s=0,c=a.length;s<c;s++)o=o.concat(a[s].controller.getAllParsedValues(n));n._cache.$bar=dJ(o.sort((s,c)=>s-c))}return n._cache.$bar}function ZTe(n){const e=n.iScale,a=YTe(e,n.type);let o=e._length,s,c,d,f;const m=()=>{d===32767||d===-32768||(uw(f)&&(o=Math.min(o,Math.abs(d-f)||o)),f=d)};for(s=0,c=a.length;s<c;++s)d=e.getPixelForValue(a[s]),m();for(f=void 0,s=0,c=e.ticks.length;s<c;++s)d=e.getPixelForTick(s),m();return o}function KTe(n,e,a,o){const s=a.barThickness;let c,d;return ci(s)?(c=e.min*a.categoryPercentage,d=a.barPercentage):(c=s*o,d=1),{chunk:c/o,ratio:d,start:e.pixels[n]-c/2}}function JTe(n,e,a,o){const s=e.pixels,c=s[n];let d=n>0?s[n-1]:null,f=n<s.length-1?s[n+1]:null;const m=a.categoryPercentage;d===null&&(d=c-(f===null?e.end-e.start:f-c)),f===null&&(f=c+c-d);const y=c-(c-Math.min(d,f))/2*m;return{chunk:Math.abs(f-d)/2*m/o,ratio:a.barPercentage,start:y}}function QTe(n,e,a,o){const s=a.parse(n[0],o),c=a.parse(n[1],o),d=Math.min(s,c),f=Math.max(s,c);let m=d,y=f;Math.abs(d)>Math.abs(f)&&(m=f,y=d),e[a.axis]=y,e._custom={barStart:m,barEnd:y,start:s,end:c,min:d,max:f}}function kJ(n,e,a,o){return lr(n)?QTe(n,e,a,o):e[a.axis]=a.parse(n,o),e}function iH(n,e,a,o){const s=n.iScale,c=n.vScale,d=s.getLabels(),f=s===c,m=[];let y,_,x,S;for(y=a,_=a+o;y<_;++y)S=e[y],x={},x[s.axis]=f||s.parse(d[y],y),m.push(kJ(S,x,c,y));return m}function EI(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function eCe(n,e,a){return n!==0?md(n):(e.isHorizontal()?1:-1)*(e.min>=a?1:-1)}function tCe(n){let e,a,o,s,c;return n.horizontal?(e=n.base>n.x,a="left",o="right"):(e=n.base<n.y,a="bottom",o="top"),e?(s="end",c="start"):(s="start",c="end"),{start:a,end:o,reverse:e,top:s,bottom:c}}function nCe(n,e,a,o){let s=e.borderSkipped;const c={};if(!s){n.borderSkipped=c;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:f,reverse:m,top:y,bottom:_}=tCe(n);s==="middle"&&a&&(n.enableBorderRadius=!0,(a._top||0)===o?s=y:(a._bottom||0)===o?s=_:(c[rH(_,d,f,m)]=!0,s=y)),c[rH(s,d,f,m)]=!0,n.borderSkipped=c}function rH(n,e,a,o){return o?(n=aCe(n,e,a),n=oH(n,a,e)):n=oH(n,e,a),n}function aCe(n,e,a){return n===e?a:n===a?e:n}function oH(n,e,a){return n==="start"?e:n==="end"?a:n}function iCe(n,{inflateAmount:e},a){n.inflateAmount=e==="auto"?a===1?.33:0:e}class iE extends du{parsePrimitiveData(e,a,o,s){return iH(e,a,o,s)}parseArrayData(e,a,o,s){return iH(e,a,o,s)}parseObjectData(e,a,o,s){const{iScale:c,vScale:d}=e,{xAxisKey:f="x",yAxisKey:m="y"}=this._parsing,y=c.axis==="x"?f:m,_=d.axis==="x"?f:m,x=[];let S,T,I,k;for(S=o,T=o+s;S<T;++S)k=a[S],I={},I[c.axis]=c.parse(xp(k,y),S),x.push(kJ(xp(k,_),I,d,S));return x}updateRangeFromParsed(e,a,o,s){super.updateRangeFromParsed(e,a,o,s);const c=o._custom;c&&a===this._cachedMeta.vScale&&(e.min=Math.min(e.min,c.min),e.max=Math.max(e.max,c.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const a=this._cachedMeta,{iScale:o,vScale:s}=a,c=this.getParsed(e),d=c._custom,f=EI(d)?"["+d.start+", "+d.end+"]":""+s.getLabelForValue(c[s.axis]);return{label:""+o.getLabelForValue(c[o.axis]),value:f}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const a=this._cachedMeta;this.updateElements(a.data,0,a.data.length,e)}updateElements(e,a,o,s){const c=s==="reset",{index:d,_cachedMeta:{vScale:f}}=this,m=f.getBasePixel(),y=f.isHorizontal(),_=this._getRuler(),{sharedOptions:x,includeOptions:S}=this._getSharedOptions(a,s);for(let T=a;T<a+o;T++){const I=this.getParsed(T),k=c||ci(I[f.axis])?{base:m,head:m}:this._calculateBarValuePixels(T),D=this._calculateBarIndexPixels(T,_),L=(I._stacks||{})[f.axis],O={horizontal:y,base:k.base,enableBorderRadius:!L||EI(I._custom)||d===L._top||d===L._bottom,x:y?k.head:D.center,y:y?D.center:k.head,height:y?D.size:Math.abs(k.size),width:y?Math.abs(k.size):D.size};S&&(O.options=x||this.resolveDataElementOptions(T,e[T].active?"active":s));const F=O.options||e[T].options;nCe(O,F,L,d),iCe(O,F,_.ratio),this.updateElement(e[T],T,O,s)}}_getStacks(e,a){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),c=o.options.stacked,d=[],f=m=>{const y=m.controller.getParsed(a),_=y&&y[m.vScale.axis];if(ci(_)||isNaN(_))return!0};for(const m of s)if(!(a!==void 0&&f(m))&&((c===!1||d.indexOf(m.stack)===-1||c===void 0&&m.stack===void 0)&&d.push(m.stack),m.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,a,o){const s=this._getStacks(e,o),c=a!==void 0?s.indexOf(a):-1;return c===-1?s.length-1:c}_getRuler(){const e=this.options,a=this._cachedMeta,o=a.iScale,s=[];let c,d;for(c=0,d=a.data.length;c<d;++c)s.push(o.getPixelForValue(this.getParsed(c)[o.axis],c));const f=e.barThickness;return{min:f||ZTe(a),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:e.grouped,ratio:f?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:a,_stacked:o,index:s},options:{base:c,minBarLength:d}}=this,f=c||0,m=this.getParsed(e),y=m._custom,_=EI(y);let x=m[a.axis],S=0,T=o?this.applyStack(a,m,o):x,I,k;T!==x&&(S=T-x,T=x),_&&(x=y.barStart,T=y.barEnd-y.barStart,x!==0&&md(x)!==md(y.barEnd)&&(S=0),S+=x);const D=!ci(c)&&!_?c:S;let L=a.getPixelForValue(D);if(this.chart.getDataVisibility(e)?I=a.getPixelForValue(S+T):I=L,k=I-L,Math.abs(k)<d){k=eCe(k,a,f)*d,x===f&&(L-=k/2);const O=a.getPixelForDecimal(0),F=a.getPixelForDecimal(1),B=Math.min(O,F),G=Math.max(O,F);L=Math.max(Math.min(L,G),B),I=L+k,o&&!_&&(m._stacks[a.axis]._visualValues[s]=a.getValueForPixel(I)-a.getValueForPixel(L))}if(L===a.getPixelForValue(f)){const O=md(k)*a.getLineWidthForValue(f)/2;L+=O,k-=O}return{size:k,base:L,head:I,center:I+k/2}}_calculateBarIndexPixels(e,a){const o=a.scale,s=this.options,c=s.skipNull,d=za(s.maxBarThickness,1/0);let f,m;if(a.grouped){const y=c?this._getStackCount(e):a.stackCount,_=s.barThickness==="flex"?JTe(e,a,s,y):KTe(e,a,s,y),x=this._getStackIndex(this.index,this._cachedMeta.stack,c?e:void 0);f=_.start+_.chunk*x+_.chunk/2,m=Math.min(d,_.chunk*_.ratio)}else f=o.getPixelForValue(this.getParsed(e)[o.axis],e),m=Math.min(d,a.min*a.ratio);return{base:f-m/2,head:f+m/2,center:f,size:m}}draw(){const e=this._cachedMeta,a=e.vScale,o=e.data,s=o.length;let c=0;for(;c<s;++c)this.getParsed(c)[a.axis]!==null&&o[c].draw(this._ctx)}}_n(iE,"id","bar"),_n(iE,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),_n(iE,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class rE extends du{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,a,o,s){const c=super.parsePrimitiveData(e,a,o,s);for(let d=0;d<c.length;d++)c[d]._custom=this.resolveDataElementOptions(d+o).radius;return c}parseArrayData(e,a,o,s){const c=super.parseArrayData(e,a,o,s);for(let d=0;d<c.length;d++){const f=a[o+d];c[d]._custom=za(f[2],this.resolveDataElementOptions(d+o).radius)}return c}parseObjectData(e,a,o,s){const c=super.parseObjectData(e,a,o,s);for(let d=0;d<c.length;d++){const f=a[o+d];c[d]._custom=za(f&&f.r&&+f.r,this.resolveDataElementOptions(d+o).radius)}return c}getMaxOverflow(){const e=this._cachedMeta.data;let a=0;for(let o=e.length-1;o>=0;--o)a=Math.max(a,e[o].size(this.resolveDataElementOptions(o))/2);return a>0&&a}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:c}=a,d=this.getParsed(e),f=s.getLabelForValue(d.x),m=c.getLabelForValue(d.y),y=d._custom;return{label:o[e]||"",value:"("+f+", "+m+(y?", "+y:"")+")"}}update(e){const a=this._cachedMeta.data;this.updateElements(a,0,a.length,e)}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f}=this._cachedMeta,{sharedOptions:m,includeOptions:y}=this._getSharedOptions(a,s),_=d.axis,x=f.axis;for(let S=a;S<a+o;S++){const T=e[S],I=!c&&this.getParsed(S),k={},D=k[_]=c?d.getPixelForDecimal(.5):d.getPixelForValue(I[_]),L=k[x]=c?f.getBasePixel():f.getPixelForValue(I[x]);k.skip=isNaN(D)||isNaN(L),y&&(k.options=m||this.resolveDataElementOptions(S,T.active?"active":s),c&&(k.options.radius=0)),this.updateElement(T,S,k,s)}}resolveDataElementOptions(e,a){const o=this.getParsed(e);let s=super.resolveDataElementOptions(e,a);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const c=s.radius;return a!=="active"&&(s.radius=0),s.radius+=za(o&&o._custom,c),s}}_n(rE,"id","bubble"),_n(rE,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),_n(rE,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function rCe(n,e,a){let o=1,s=1,c=0,d=0;if(e<ur){const f=n,m=f+e,y=Math.cos(f),_=Math.sin(f),x=Math.cos(m),S=Math.sin(m),T=(F,B,G)=>dw(F,f,m,!0)?1:Math.max(B,B*a,G,G*a),I=(F,B,G)=>dw(F,f,m,!0)?-1:Math.min(B,B*a,G,G*a),k=T(0,y,x),D=T(uo,_,S),L=I(dr,y,x),O=I(dr+uo,_,S);o=(k-L)/2,s=(D-O)/2,c=-(k+L)/2,d=-(D+O)/2}return{ratioX:o,ratioY:s,offsetX:c,offsetY:d}}class mg extends du{constructor(e,a){super(e,a),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,a){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let c=m=>+o[m];if(Ja(o[e])){const{key:m="value"}=this._parsing;c=y=>+xp(o[y],m)}let d,f;for(d=e,f=e+a;d<f;++d)s._parsed[d]=c(d)}}_getRotation(){return lu(this.options.rotation-90)}_getCircumference(){return lu(this.options.circumference)}_getRotationExtents(){let e=ur,a=-ur;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,c=s._getRotation(),d=s._getCircumference();e=Math.min(e,c),a=Math.max(a,c+d)}return{rotation:e,circumference:a-e}}update(e){const a=this.chart,{chartArea:o}=a,s=this._cachedMeta,c=s.data,d=this.getMaxBorderWidth()+this.getMaxOffset(c)+this.options.spacing,f=Math.max((Math.min(o.width,o.height)-d)/2,0),m=Math.min(_Me(this.options.cutout,f),1),y=this._getRingWeight(this.index),{circumference:_,rotation:x}=this._getRotationExtents(),{ratioX:S,ratioY:T,offsetX:I,offsetY:k}=rCe(x,_,m),D=(o.width-d)/S,L=(o.height-d)/T,O=Math.max(Math.min(D,L)/2,0),F=oJ(this.options.radius,O),B=Math.max(F*m,0),G=(F-B)/this._getVisibleDatasetWeightTotal();this.offsetX=I*F,this.offsetY=k*F,s.total=this.calculateTotal(),this.outerRadius=F-G*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-G*y,0),this.updateElements(c,0,c.length,e)}_circumference(e,a){const o=this.options,s=this._cachedMeta,c=this._getCircumference();return a&&o.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*c/ur)}updateElements(e,a,o,s){const c=s==="reset",d=this.chart,f=d.chartArea,y=d.options.animation,_=(f.left+f.right)/2,x=(f.top+f.bottom)/2,S=c&&y.animateScale,T=S?0:this.innerRadius,I=S?0:this.outerRadius,{sharedOptions:k,includeOptions:D}=this._getSharedOptions(a,s);let L=this._getRotation(),O;for(O=0;O<a;++O)L+=this._circumference(O,c);for(O=a;O<a+o;++O){const F=this._circumference(O,c),B=e[O],G={x:_+this.offsetX,y:x+this.offsetY,startAngle:L,endAngle:L+F,circumference:F,outerRadius:I,innerRadius:T};D&&(G.options=k||this.resolveDataElementOptions(O,B.active?"active":s)),L+=F,this.updateElement(B,O,G,s)}}calculateTotal(){const e=this._cachedMeta,a=e.data;let o=0,s;for(s=0;s<a.length;s++){const c=e._parsed[s];c!==null&&!isNaN(c)&&this.chart.getDataVisibility(s)&&!a[s].hidden&&(o+=Math.abs(c))}return o}calculateCircumference(e){const a=this._cachedMeta.total;return a>0&&!isNaN(e)?ur*(Math.abs(e)/a):0}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],c=$w(a._parsed[e],o.options.locale);return{label:s[e]||"",value:c}}getMaxBorderWidth(e){let a=0;const o=this.chart;let s,c,d,f,m;if(!e){for(s=0,c=o.data.datasets.length;s<c;++s)if(o.isDatasetVisible(s)){d=o.getDatasetMeta(s),e=d.data,f=d.controller;break}}if(!e)return 0;for(s=0,c=e.length;s<c;++s)m=f.resolveDataElementOptions(s),m.borderAlign!=="inner"&&(a=Math.max(a,m.borderWidth||0,m.hoverBorderWidth||0));return a}getMaxOffset(e){let a=0;for(let o=0,s=e.length;o<s;++o){const c=this.resolveDataElementOptions(o);a=Math.max(a,c.offset||0,c.hoverOffset||0)}return a}_getRingWeightOffset(e){let a=0;for(let o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(a+=this._getRingWeight(o));return a}_getRingWeight(e){return Math.max(za(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}_n(mg,"id","doughnut"),_n(mg,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),_n(mg,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),_n(mg,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const a=e.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return a.labels.map((c,d)=>{const m=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:m.backgroundColor,strokeStyle:m.borderColor,fontColor:s,lineWidth:m.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}}});class hx extends du{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const a=this._cachedMeta,{dataset:o,data:s=[],_dataset:c}=a,d=this.chart._animationsDisabled;let{start:f,count:m}=pJ(a,s,d);this._drawStart=f,this._drawCount=m,mJ(a)&&(f=0,m=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!c._decimated,o.points=s;const y=this.resolveDatasetElementOptions(e);this.options.showLine||(y.borderWidth=0),y.segment=this.options.segment,this.updateElement(o,void 0,{animated:!d,options:y},e),this.updateElements(s,f,m,e)}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f,_stacked:m,_dataset:y}=this._cachedMeta,{sharedOptions:_,includeOptions:x}=this._getSharedOptions(a,s),S=d.axis,T=f.axis,{spanGaps:I,segment:k}=this.options,D=s_(I)?I:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||c||s==="none",O=a+o,F=e.length;let B=a>0&&this.getParsed(a-1);for(let G=0;G<F;++G){const q=e[G],X=L?q:{};if(G<a||G>=O){X.skip=!0;continue}const te=this.getParsed(G),V=ci(te[T]),Q=X[S]=d.getPixelForValue(te[S],G),ge=X[T]=c||V?f.getBasePixel():f.getPixelForValue(m?this.applyStack(f,te,m):te[T],G);X.skip=isNaN(Q)||isNaN(ge)||V,X.stop=G>0&&Math.abs(te[S]-B[S])>D,k&&(X.parsed=te,X.raw=y.data[G]),x&&(X.options=_||this.resolveDataElementOptions(G,q.active?"active":s)),L||this.updateElement(q,G,X,s),B=te}}getMaxOverflow(){const e=this._cachedMeta,a=e.dataset,o=a.options&&a.options.borderWidth||0,s=e.data||[];if(!s.length)return o;const c=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,c,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}_n(hx,"id","line"),_n(hx,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),_n(hx,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class fx extends du{constructor(e,a){super(e,a),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const a=this._cachedMeta,o=this.chart,s=o.data.labels||[],c=$w(a._parsed[e].r,o.options.locale);return{label:s[e]||"",value:c}}parseObjectData(e,a,o,s){return SJ.bind(this)(e,a,o,s)}update(e){const a=this._cachedMeta.data;this._updateRadius(),this.updateElements(a,0,a.length,e)}getMinMax(){const e=this._cachedMeta,a={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((o,s)=>{const c=this.getParsed(s).r;!isNaN(c)&&this.chart.getDataVisibility(s)&&(c<a.min&&(a.min=c),c>a.max&&(a.max=c))}),a}_updateRadius(){const e=this.chart,a=e.chartArea,o=e.options,s=Math.min(a.right-a.left,a.bottom-a.top),c=Math.max(s/2,0),d=Math.max(o.cutoutPercentage?c/100*o.cutoutPercentage:1,0),f=(c-d)/e.getVisibleDatasetCount();this.outerRadius=c-f*this.index,this.innerRadius=this.outerRadius-f}updateElements(e,a,o,s){const c=s==="reset",d=this.chart,m=d.options.animation,y=this._cachedMeta.rScale,_=y.xCenter,x=y.yCenter,S=y.getIndexAngle(0)-.5*dr;let T=S,I;const k=360/this.countVisibleElements();for(I=0;I<a;++I)T+=this._computeAngle(I,s,k);for(I=a;I<a+o;I++){const D=e[I];let L=T,O=T+this._computeAngle(I,s,k),F=d.getDataVisibility(I)?y.getDistanceFromCenterForValue(this.getParsed(I).r):0;T=O,c&&(m.animateScale&&(F=0),m.animateRotate&&(L=O=S));const B={x:_,y:x,innerRadius:0,outerRadius:F,startAngle:L,endAngle:O,options:this.resolveDataElementOptions(I,D.active?"active":s)};this.updateElement(D,I,B,s)}}countVisibleElements(){const e=this._cachedMeta;let a=0;return e.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&a++}),a}_computeAngle(e,a,o){return this.chart.getDataVisibility(e)?lu(this.resolveDataElementOptions(e,a).angle||o):0}}_n(fx,"id","polarArea"),_n(fx,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),_n(fx,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const a=e.data;if(a.labels.length&&a.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return a.labels.map((c,d)=>{const m=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:m.backgroundColor,strokeStyle:m.borderColor,fontColor:s,lineWidth:m.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,a,o){o.chart.toggleDataVisibility(a.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class ek extends mg{}_n(ek,"id","pie"),_n(ek,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class px extends du{getLabelAndValue(e){const a=this._cachedMeta.vScale,o=this.getParsed(e);return{label:a.getLabels()[e],value:""+a.getLabelForValue(o[a.axis])}}parseObjectData(e,a,o,s){return SJ.bind(this)(e,a,o,s)}update(e){const a=this._cachedMeta,o=a.dataset,s=a.data||[],c=a.iScale.getLabels();if(o.points=s,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const f={_loop:!0,_fullLoop:c.length===s.length,options:d};this.updateElement(o,void 0,f,e)}this.updateElements(s,0,s.length,e)}updateElements(e,a,o,s){const c=this._cachedMeta.rScale,d=s==="reset";for(let f=a;f<a+o;f++){const m=e[f],y=this.resolveDataElementOptions(f,m.active?"active":s),_=c.getPointPositionForValue(f,this.getParsed(f).r),x=d?c.xCenter:_.x,S=d?c.yCenter:_.y,T={x,y:S,angle:_.angle,skip:isNaN(x)||isNaN(S),options:y};this.updateElement(m,f,T,s)}}}_n(px,"id","radar"),_n(px,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),_n(px,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class oE extends du{getLabelAndValue(e){const a=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:c}=a,d=this.getParsed(e),f=s.getLabelForValue(d.x),m=c.getLabelForValue(d.y);return{label:o[e]||"",value:"("+f+", "+m+")"}}update(e){const a=this._cachedMeta,{data:o=[]}=a,s=this.chart._animationsDisabled;let{start:c,count:d}=pJ(a,o,s);if(this._drawStart=c,this._drawCount=d,mJ(a)&&(c=0,d=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:f,_dataset:m}=a;f._chart=this.chart,f._datasetIndex=this.index,f._decimated=!!m._decimated,f.points=o;const y=this.resolveDatasetElementOptions(e);y.segment=this.options.segment,this.updateElement(f,void 0,{animated:!s,options:y},e)}else this.datasetElementType&&(delete a.dataset,this.datasetElementType=!1);this.updateElements(o,c,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,a,o,s){const c=s==="reset",{iScale:d,vScale:f,_stacked:m,_dataset:y}=this._cachedMeta,_=this.resolveDataElementOptions(a,s),x=this.getSharedOptions(_),S=this.includeOptions(s,x),T=d.axis,I=f.axis,{spanGaps:k,segment:D}=this.options,L=s_(k)?k:Number.POSITIVE_INFINITY,O=this.chart._animationsDisabled||c||s==="none";let F=a>0&&this.getParsed(a-1);for(let B=a;B<a+o;++B){const G=e[B],q=this.getParsed(B),X=O?G:{},te=ci(q[I]),V=X[T]=d.getPixelForValue(q[T],B),Q=X[I]=c||te?f.getBasePixel():f.getPixelForValue(m?this.applyStack(f,q,m):q[I],B);X.skip=isNaN(V)||isNaN(Q)||te,X.stop=B>0&&Math.abs(q[T]-F[T])>L,D&&(X.parsed=q,X.raw=y.data[B]),S&&(X.options=x||this.resolveDataElementOptions(B,G.active?"active":s)),O||this.updateElement(G,B,X,s),F=q}this.updateSharedOptions(x,s,_)}getMaxOverflow(){const e=this._cachedMeta,a=e.data||[];if(!this.options.showLine){let f=0;for(let m=a.length-1;m>=0;--m)f=Math.max(f,a[m].size(this.resolveDataElementOptions(m))/2);return f>0&&f}const o=e.dataset,s=o.options&&o.options.borderWidth||0;if(!a.length)return s;const c=a[0].size(this.resolveDataElementOptions(0)),d=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(s,c,d)/2}}_n(oE,"id","scatter"),_n(oE,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),_n(oE,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var oCe=Object.freeze({__proto__:null,BarController:iE,BubbleController:rE,DoughnutController:mg,LineController:hx,PieController:ek,PolarAreaController:fx,RadarController:px,ScatterController:oE});function Hm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class uO{constructor(e){_n(this,"options");this.options=e||{}}static override(e){Object.assign(uO.prototype,e)}init(){}formats(){return Hm()}parse(){return Hm()}format(){return Hm()}add(){return Hm()}diff(){return Hm()}startOf(){return Hm()}endOf(){return Hm()}}var sCe={_date:uO};function lCe(n,e,a,o){const{controller:s,data:c,_sorted:d}=n,f=s._cachedMeta.iScale;if(f&&e===f.axis&&e!=="r"&&d&&c.length){const m=f._reversePixels?LMe:Th;if(o){if(s._sharedOptions){const y=c[0],_=typeof y.getRange=="function"&&y.getRange(e);if(_){const x=m(c,e,a-_),S=m(c,e,a+_);return{lo:x.lo,hi:S.hi}}}}else return m(c,e,a)}return{lo:0,hi:c.length-1}}function qw(n,e,a,o,s){const c=n.getSortedVisibleDatasetMetas(),d=a[e];for(let f=0,m=c.length;f<m;++f){const{index:y,data:_}=c[f],{lo:x,hi:S}=lCe(c[f],e,d,s);for(let T=x;T<=S;++T){const I=_[T];I.skip||o(I,y,T)}}}function cCe(n){const e=n.indexOf("x")!==-1,a=n.indexOf("y")!==-1;return function(o,s){const c=e?Math.abs(o.x-s.x):0,d=a?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(c,2)+Math.pow(d,2))}}function MI(n,e,a,o,s){const c=[];return!s&&!n.isPointInArea(e)||qw(n,a,e,function(f,m,y){!s&&!Ch(f,n.chartArea,0)||f.inRange(e.x,e.y,o)&&c.push({element:f,datasetIndex:m,index:y})},!0),c}function uCe(n,e,a,o){let s=[];function c(d,f,m){const{startAngle:y,endAngle:_}=d.getProps(["startAngle","endAngle"],o),{angle:x}=cJ(d,{x:e.x,y:e.y});dw(x,y,_)&&s.push({element:d,datasetIndex:f,index:m})}return qw(n,a,e,c),s}function dCe(n,e,a,o,s,c){let d=[];const f=cCe(a);let m=Number.POSITIVE_INFINITY;function y(_,x,S){const T=_.inRange(e.x,e.y,s);if(o&&!T)return;const I=_.getCenterPoint(s);if(!(!!c||n.isPointInArea(I))&&!T)return;const D=f(e,I);D<m?(d=[{element:_,datasetIndex:x,index:S}],m=D):D===m&&d.push({element:_,datasetIndex:x,index:S})}return qw(n,a,e,y),d}function TI(n,e,a,o,s,c){return!c&&!n.isPointInArea(e)?[]:a==="r"&&!o?uCe(n,e,a,s):dCe(n,e,a,o,s,c)}function sH(n,e,a,o,s){const c=[],d=a==="x"?"inXRange":"inYRange";let f=!1;return qw(n,a,e,(m,y,_)=>{m[d](e[a],s)&&(c.push({element:m,datasetIndex:y,index:_}),f=f||m.inRange(e.x,e.y,s))}),o&&!f?[]:c}var hCe={evaluateInteractionItems:qw,modes:{index(n,e,a,o){const s=tg(e,n),c=a.axis||"x",d=a.includeInvisible||!1,f=a.intersect?MI(n,s,c,o,d):TI(n,s,c,!1,o,d),m=[];return f.length?(n.getSortedVisibleDatasetMetas().forEach(y=>{const _=f[0].index,x=y.data[_];x&&!x.skip&&m.push({element:x,datasetIndex:y.index,index:_})}),m):[]},dataset(n,e,a,o){const s=tg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;let f=a.intersect?MI(n,s,c,o,d):TI(n,s,c,!1,o,d);if(f.length>0){const m=f[0].datasetIndex,y=n.getDatasetMeta(m).data;f=[];for(let _=0;_<y.length;++_)f.push({element:y[_],datasetIndex:m,index:_})}return f},point(n,e,a,o){const s=tg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;return MI(n,s,c,o,d)},nearest(n,e,a,o){const s=tg(e,n),c=a.axis||"xy",d=a.includeInvisible||!1;return TI(n,s,c,a.intersect,o,d)},x(n,e,a,o){const s=tg(e,n);return sH(n,s,"x",a.intersect,o)},y(n,e,a,o){const s=tg(e,n);return sH(n,s,"y",a.intersect,o)}}};const DJ=["left","top","right","bottom"];function gb(n,e){return n.filter(a=>a.pos===e)}function lH(n,e){return n.filter(a=>DJ.indexOf(a.pos)===-1&&a.box.axis===e)}function yb(n,e){return n.sort((a,o)=>{const s=e?o:a,c=e?a:o;return s.weight===c.weight?s.index-c.index:s.weight-c.weight})}function fCe(n){const e=[];let a,o,s,c,d,f;for(a=0,o=(n||[]).length;a<o;++a)s=n[a],{position:c,options:{stack:d,stackWeight:f=1}}=s,e.push({index:a,box:s,pos:c,horizontal:s.isHorizontal(),weight:s.weight,stack:d&&c+d,stackWeight:f});return e}function pCe(n){const e={};for(const a of n){const{stack:o,pos:s,stackWeight:c}=a;if(!o||!DJ.includes(s))continue;const d=e[o]||(e[o]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=c}return e}function mCe(n,e){const a=pCe(n),{vBoxMaxWidth:o,hBoxMaxHeight:s}=e;let c,d,f;for(c=0,d=n.length;c<d;++c){f=n[c];const{fullSize:m}=f.box,y=a[f.stack],_=y&&f.stackWeight/y.weight;f.horizontal?(f.width=_?_*o:m&&e.availableWidth,f.height=s):(f.width=o,f.height=_?_*s:m&&e.availableHeight)}return a}function gCe(n){const e=fCe(n),a=yb(e.filter(y=>y.box.fullSize),!0),o=yb(gb(e,"left"),!0),s=yb(gb(e,"right")),c=yb(gb(e,"top"),!0),d=yb(gb(e,"bottom")),f=lH(e,"x"),m=lH(e,"y");return{fullSize:a,leftAndTop:o.concat(c),rightAndBottom:s.concat(m).concat(d).concat(f),chartArea:gb(e,"chartArea"),vertical:o.concat(s).concat(m),horizontal:c.concat(d).concat(f)}}function cH(n,e,a,o){return Math.max(n[a],e[a])+Math.max(n[o],e[o])}function OJ(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function yCe(n,e,a,o){const{pos:s,box:c}=a,d=n.maxPadding;if(!Ja(s)){a.size&&(n[s]-=a.size);const x=o[a.stack]||{size:0,count:1};x.size=Math.max(x.size,a.horizontal?c.height:c.width),a.size=x.size/x.count,n[s]+=a.size}c.getPadding&&OJ(d,c.getPadding());const f=Math.max(0,e.outerWidth-cH(d,n,"left","right")),m=Math.max(0,e.outerHeight-cH(d,n,"top","bottom")),y=f!==n.w,_=m!==n.h;return n.w=f,n.h=m,a.horizontal?{same:y,other:_}:{same:_,other:y}}function vCe(n){const e=n.maxPadding;function a(o){const s=Math.max(e[o]-n[o],0);return n[o]+=s,s}n.y+=a("top"),n.x+=a("left"),a("right"),a("bottom")}function _Ce(n,e){const a=e.maxPadding;function o(s){const c={left:0,top:0,right:0,bottom:0};return s.forEach(d=>{c[d]=Math.max(e[d],a[d])}),c}return o(n?["left","right"]:["top","bottom"])}function kb(n,e,a,o){const s=[];let c,d,f,m,y,_;for(c=0,d=n.length,y=0;c<d;++c){f=n[c],m=f.box,m.update(f.width||e.w,f.height||e.h,_Ce(f.horizontal,e));const{same:x,other:S}=yCe(e,a,f,o);y|=x&&s.length,_=_||S,m.fullSize||s.push(f)}return y&&kb(s,e,a,o)||_}function gA(n,e,a,o,s){n.top=a,n.left=e,n.right=e+o,n.bottom=a+s,n.width=o,n.height=s}function uH(n,e,a,o){const s=a.padding;let{x:c,y:d}=e;for(const f of n){const m=f.box,y=o[f.stack]||{count:1,placed:0,weight:1},_=f.stackWeight/y.weight||1;if(f.horizontal){const x=e.w*_,S=y.size||m.height;uw(y.start)&&(d=y.start),m.fullSize?gA(m,s.left,d,a.outerWidth-s.right-s.left,S):gA(m,e.left+y.placed,d,x,S),y.start=d,y.placed+=x,d=m.bottom}else{const x=e.h*_,S=y.size||m.width;uw(y.start)&&(c=y.start),m.fullSize?gA(m,c,s.top,S,a.outerHeight-s.bottom-s.top):gA(m,c,e.top+y.placed,S,x),y.start=c,y.placed+=x,c=m.right}}e.x=c,e.y=d}var ws={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(a){e.draw(a)}}]},n.boxes.push(e)},removeBox(n,e){const a=n.boxes?n.boxes.indexOf(e):-1;a!==-1&&n.boxes.splice(a,1)},configure(n,e,a){e.fullSize=a.fullSize,e.position=a.position,e.weight=a.weight},update(n,e,a,o){if(!n)return;const s=Ms(n.options.layout.padding),c=Math.max(e-s.width,0),d=Math.max(a-s.height,0),f=gCe(n.boxes),m=f.vertical,y=f.horizontal;Fi(n.boxes,k=>{typeof k.beforeLayout=="function"&&k.beforeLayout()});const _=m.reduce((k,D)=>D.box.options&&D.box.options.display===!1?k:k+1,0)||1,x=Object.freeze({outerWidth:e,outerHeight:a,padding:s,availableWidth:c,availableHeight:d,vBoxMaxWidth:c/2/_,hBoxMaxHeight:d/2}),S=Object.assign({},s);OJ(S,Ms(o));const T=Object.assign({maxPadding:S,w:c,h:d,x:s.left,y:s.top},s),I=mCe(m.concat(y),x);kb(f.fullSize,T,x,I),kb(m,T,x,I),kb(y,T,x,I)&&kb(m,T,x,I),vCe(T),uH(f.leftAndTop,T,x,I),T.x+=T.w,T.y+=T.h,uH(f.rightAndBottom,T,x,I),n.chartArea={left:T.left,top:T.top,right:T.left+T.w,bottom:T.top+T.h,height:T.h,width:T.w},Fi(f.chartArea,k=>{const D=k.box;Object.assign(D,n.chartArea),D.update(T.w,T.h,{left:0,top:0,right:0,bottom:0})})}};class zJ{acquireContext(e,a){}releaseContext(e){return!1}addEventListener(e,a,o){}removeEventListener(e,a,o){}getDevicePixelRatio(){return 1}getMaximumSize(e,a,o,s){return a=Math.max(0,a||e.width),o=o||e.height,{width:a,height:Math.max(0,s?Math.floor(a/s):o)}}isAttached(e){return!0}updateConfig(e){}}class bCe extends zJ{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const sE="$chartjs",xCe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},dH=n=>n===null||n==="";function wCe(n,e){const a=n.style,o=n.getAttribute("height"),s=n.getAttribute("width");if(n[sE]={initial:{height:o,width:s,style:{display:a.display,height:a.height,width:a.width}}},a.display=a.display||"block",a.boxSizing=a.boxSizing||"border-box",dH(s)){const c=qG(n,"width");c!==void 0&&(n.width=c)}if(dH(o))if(n.style.height==="")n.height=n.width/(e||2);else{const c=qG(n,"height");c!==void 0&&(n.height=c)}return n}const FJ=ATe?{passive:!0}:!1;function SCe(n,e,a){n.addEventListener(e,a,FJ)}function ACe(n,e,a){n.canvas.removeEventListener(e,a,FJ)}function ECe(n,e){const a=xCe[n.type]||n.type,{x:o,y:s}=tg(n,e);return{type:a,chart:e,native:n,x:o!==void 0?o:null,y:s!==void 0?s:null}}function gM(n,e){for(const a of n)if(a===e||a.contains(e))return!0}function MCe(n,e,a){const o=n.canvas,s=new MutationObserver(c=>{let d=!1;for(const f of c)d=d||gM(f.addedNodes,o),d=d&&!gM(f.removedNodes,o);d&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}function TCe(n,e,a){const o=n.canvas,s=new MutationObserver(c=>{let d=!1;for(const f of c)d=d||gM(f.removedNodes,o),d=d&&!gM(f.addedNodes,o);d&&a()});return s.observe(document,{childList:!0,subtree:!0}),s}const fw=new Map;let hH=0;function NJ(){const n=window.devicePixelRatio;n!==hH&&(hH=n,fw.forEach((e,a)=>{a.currentDevicePixelRatio!==n&&e()}))}function CCe(n,e){fw.size||window.addEventListener("resize",NJ),fw.set(n,e)}function PCe(n){fw.delete(n),fw.size||window.removeEventListener("resize",NJ)}function ICe(n,e,a){const o=n.canvas,s=o&&cO(o);if(!s)return;const c=fJ((f,m)=>{const y=s.clientWidth;a(f,m),y<s.clientWidth&&a()},window),d=new ResizeObserver(f=>{const m=f[0],y=m.contentRect.width,_=m.contentRect.height;y===0&&_===0||c(y,_)});return d.observe(s),CCe(n,c),d}function CI(n,e,a){a&&a.disconnect(),e==="resize"&&PCe(n)}function LCe(n,e,a){const o=n.canvas,s=fJ(c=>{n.ctx!==null&&a(ECe(c,n))},n);return SCe(o,e,s),s}class RCe extends zJ{acquireContext(e,a){const o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(wCe(e,a),o):null}releaseContext(e){const a=e.canvas;if(!a[sE])return!1;const o=a[sE].initial;["height","width"].forEach(c=>{const d=o[c];ci(d)?a.removeAttribute(c):a.setAttribute(c,d)});const s=o.style||{};return Object.keys(s).forEach(c=>{a.style[c]=s[c]}),a.width=a.width,delete a[sE],!0}addEventListener(e,a,o){this.removeEventListener(e,a);const s=e.$proxies||(e.$proxies={}),d={attach:MCe,detach:TCe,resize:ICe}[a]||LCe;s[a]=d(e,a,o)}removeEventListener(e,a){const o=e.$proxies||(e.$proxies={}),s=o[a];if(!s)return;({attach:CI,detach:CI,resize:CI}[a]||ACe)(e,a,s),o[a]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,a,o,s){return STe(e,a,o,s)}isAttached(e){const a=cO(e);return!!(a&&a.isConnected)}}function kCe(n){return!EJ()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?bCe:RCe}class mu{constructor(){_n(this,"x");_n(this,"y");_n(this,"active",!1);_n(this,"options");_n(this,"$animations")}tooltipPosition(e){const{x:a,y:o}=this.getProps(["x","y"],e);return{x:a,y:o}}hasValue(){return s_(this.x)&&s_(this.y)}getProps(e,a){const o=this.$animations;if(!a||!o)return this;const s={};return e.forEach(c=>{s[c]=o[c]&&o[c].active()?o[c]._to:this[c]}),s}}_n(mu,"defaults",{}),_n(mu,"defaultRoutes");function DCe(n,e){const a=n.options.ticks,o=OCe(n),s=Math.min(a.maxTicksLimit||o,o),c=a.major.enabled?FCe(e):[],d=c.length,f=c[0],m=c[d-1],y=[];if(d>s)return NCe(e,y,c,d/s),y;const _=zCe(c,e,s);if(d>0){let x,S;const T=d>1?Math.round((m-f)/(d-1)):null;for(yA(e,y,_,ci(T)?0:f-T,f),x=0,S=d-1;x<S;x++)yA(e,y,_,c[x],c[x+1]);return yA(e,y,_,m,ci(T)?e.length:m+T),y}return yA(e,y,_),y}function OCe(n){const e=n.options.offset,a=n._tickSize(),o=n._length/a+(e?0:1),s=n._maxLength/a;return Math.floor(Math.min(o,s))}function zCe(n,e,a){const o=BCe(n),s=e.length/a;if(!o)return Math.max(s,1);const c=TMe(o);for(let d=0,f=c.length-1;d<f;d++){const m=c[d];if(m>s)return m}return Math.max(s,1)}function FCe(n){const e=[];let a,o;for(a=0,o=n.length;a<o;a++)n[a].major&&e.push(a);return e}function NCe(n,e,a,o){let s=0,c=a[0],d;for(o=Math.ceil(o),d=0;d<n.length;d++)d===c&&(e.push(n[d]),s++,c=a[s*o])}function yA(n,e,a,o,s){const c=za(o,0),d=Math.min(za(s,n.length),n.length);let f=0,m,y,_;for(a=Math.ceil(a),s&&(m=s-o,a=m/Math.floor(m/a)),_=c;_<0;)f++,_=Math.round(c+f*a);for(y=Math.max(c,0);y<d;y++)y===_&&(e.push(n[y]),f++,_=Math.round(c+f*a))}function BCe(n){const e=n.length;let a,o;if(e<2)return!1;for(o=n[0],a=1;a<e;++a)if(n[a]-n[a-1]!==o)return!1;return o}const UCe=n=>n==="left"?"right":n==="right"?"left":n,fH=(n,e,a)=>e==="top"||e==="left"?n[e]+a:n[e]-a,pH=(n,e)=>Math.min(e||n,n);function mH(n,e){const a=[],o=n.length/e,s=n.length;let c=0;for(;c<s;c+=o)a.push(n[Math.floor(c)]);return a}function WCe(n,e,a){const o=n.ticks.length,s=Math.min(e,o-1),c=n._startPixel,d=n._endPixel,f=1e-6;let m=n.getPixelForTick(s),y;if(!(a&&(o===1?y=Math.max(m-c,d-m):e===0?y=(n.getPixelForTick(1)-m)/2:y=(m-n.getPixelForTick(s-1))/2,m+=s<e?y:-y,m<c-f||m>d+f)))return m}function VCe(n,e){Fi(n,a=>{const o=a.gc,s=o.length/2;let c;if(s>e){for(c=0;c<s;++c)delete a.data[o[c]];o.splice(0,s)}})}function vb(n){return n.drawTicks?n.tickLength:0}function gH(n,e){if(!n.display)return 0;const a=Ro(n.font,e),o=Ms(n.padding);return(lr(n.text)?n.text.length:1)*a.lineHeight+o.height}function GCe(n,e){return Ip(n,{scale:e,type:"scale"})}function HCe(n,e,a){return Ip(n,{tick:a,index:e,type:"tick"})}function jCe(n,e,a){let o=aO(n);return(a&&e!=="right"||!a&&e==="right")&&(o=UCe(o)),o}function $Ce(n,e,a,o){const{top:s,left:c,bottom:d,right:f,chart:m}=n,{chartArea:y,scales:_}=m;let x=0,S,T,I;const k=d-s,D=f-c;if(n.isHorizontal()){if(T=_s(o,c,f),Ja(a)){const L=Object.keys(a)[0],O=a[L];I=_[L].getPixelForValue(O)+k-e}else a==="center"?I=(y.bottom+y.top)/2+k-e:I=fH(n,a,e);S=f-c}else{if(Ja(a)){const L=Object.keys(a)[0],O=a[L];T=_[L].getPixelForValue(O)-D+e}else a==="center"?T=(y.left+y.right)/2-D+e:T=fH(n,a,e);I=_s(o,d,s),x=a==="left"?-uo:uo}return{titleX:T,titleY:I,maxWidth:S,rotation:x}}class Yg extends mu{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,a){return e}getUserBounds(){let{_userMin:e,_userMax:a,_suggestedMin:o,_suggestedMax:s}=this;return e=Ul(e,Number.POSITIVE_INFINITY),a=Ul(a,Number.NEGATIVE_INFINITY),o=Ul(o,Number.POSITIVE_INFINITY),s=Ul(s,Number.NEGATIVE_INFINITY),{min:Ul(e,o),max:Ul(a,s),minDefined:Xr(e),maxDefined:Xr(a)}}getMinMax(e){let{min:a,max:o,minDefined:s,maxDefined:c}=this.getUserBounds(),d;if(s&&c)return{min:a,max:o};const f=this.getMatchingVisibleMetas();for(let m=0,y=f.length;m<y;++m)d=f[m].controller.getMinMax(this,e),s||(a=Math.min(a,d.min)),c||(o=Math.max(o,d.max));return a=c&&a>o?o:a,o=s&&a>o?a:o,{min:Ul(a,Ul(o,a)),max:Ul(o,Ul(a,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){er(this.options.beforeUpdate,[this])}update(e,a,o){const{beginAtZero:s,grace:c,ticks:d}=this.options,f=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=a,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=tTe(this,c,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const m=f<this.ticks.length;this._convertTicksToLabels(m?mH(this.ticks,f):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=DCe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),m&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,a,o;this.isHorizontal()?(a=this.left,o=this.right):(a=this.top,o=this.bottom,e=!e),this._startPixel=a,this._endPixel=o,this._reversePixels=e,this._length=o-a,this._alignToPixels=this.options.alignToPixels}afterUpdate(){er(this.options.afterUpdate,[this])}beforeSetDimensions(){er(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){er(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),er(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){er(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const a=this.options.ticks;let o,s,c;for(o=0,s=e.length;o<s;o++)c=e[o],c.label=er(a.callback,[c.value,o,e],this)}afterTickToLabelConversion(){er(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){er(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,a=e.ticks,o=pH(this.ticks.length,e.ticks.maxTicksLimit),s=a.minRotation||0,c=a.maxRotation;let d=s,f,m,y;if(!this._isVisible()||!a.display||s>=c||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const _=this._getLabelSizes(),x=_.widest.width,S=_.highest.height,T=Wo(this.chart.width-x,0,this.maxWidth);f=e.offset?this.maxWidth/o:T/(o-1),x+6>f&&(f=T/(o-(e.offset?.5:1)),m=this.maxHeight-vb(e.grid)-a.padding-gH(e.title,this.chart.options.font),y=Math.sqrt(x*x+S*S),d=tO(Math.min(Math.asin(Wo((_.highest.height+6)/f,-1,1)),Math.asin(Wo(m/y,-1,1))-Math.asin(Wo(S/y,-1,1)))),d=Math.max(s,Math.min(c,d))),this.labelRotation=d}afterCalculateLabelRotation(){er(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){er(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:a,options:{ticks:o,title:s,grid:c}}=this,d=this._isVisible(),f=this.isHorizontal();if(d){const m=gH(s,a.options.font);if(f?(e.width=this.maxWidth,e.height=vb(c)+m):(e.height=this.maxHeight,e.width=vb(c)+m),o.display&&this.ticks.length){const{first:y,last:_,widest:x,highest:S}=this._getLabelSizes(),T=o.padding*2,I=lu(this.labelRotation),k=Math.cos(I),D=Math.sin(I);if(f){const L=o.mirror?0:D*x.width+k*S.height;e.height=Math.min(this.maxHeight,e.height+L+T)}else{const L=o.mirror?0:k*x.width+D*S.height;e.width=Math.min(this.maxWidth,e.width+L+T)}this._calculatePadding(y,_,D,k)}}this._handleMargins(),f?(this.width=this._length=a.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=a.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,a,o,s){const{ticks:{align:c,padding:d},position:f}=this.options,m=this.labelRotation!==0,y=f!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,x=this.right-this.getPixelForTick(this.ticks.length-1);let S=0,T=0;m?y?(S=s*e.width,T=o*a.height):(S=o*e.height,T=s*a.width):c==="start"?T=a.width:c==="end"?S=e.width:c!=="inner"&&(S=e.width/2,T=a.width/2),this.paddingLeft=Math.max((S-_+d)*this.width/(this.width-_),0),this.paddingRight=Math.max((T-x+d)*this.width/(this.width-x),0)}else{let _=a.height/2,x=e.height/2;c==="start"?(_=0,x=e.height):c==="end"&&(_=a.height,x=0),this.paddingTop=_+d,this.paddingBottom=x+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){er(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:a}=this.options;return a==="top"||a==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let a,o;for(a=0,o=e.length;a<o;a++)ci(e[a].label)&&(e.splice(a,1),o--,a--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const a=this.options.ticks.sampleSize;let o=this.ticks;a<o.length&&(o=mH(o,a)),this._labelSizes=e=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,a,o){const{ctx:s,_longestTextCache:c}=this,d=[],f=[],m=Math.floor(a/pH(a,o));let y=0,_=0,x,S,T,I,k,D,L,O,F,B,G;for(x=0;x<a;x+=m){if(I=e[x].label,k=this._resolveTickFontOptions(x),s.font=D=k.string,L=c[D]=c[D]||{data:{},gc:[]},O=k.lineHeight,F=B=0,!ci(I)&&!lr(I))F=pM(s,L.data,L.gc,F,I),B=O;else if(lr(I))for(S=0,T=I.length;S<T;++S)G=I[S],!ci(G)&&!lr(G)&&(F=pM(s,L.data,L.gc,F,G),B+=O);d.push(F),f.push(B),y=Math.max(F,y),_=Math.max(B,_)}VCe(c,a);const q=d.indexOf(y),X=f.indexOf(_),te=V=>({width:d[V]||0,height:f[V]||0});return{first:te(0),last:te(a-1),widest:te(q),highest:te(X),widths:d,heights:f}}getLabelForValue(e){return e}getPixelForValue(e,a){return NaN}getValueForPixel(e){}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const a=this._startPixel+e*this._length;return IMe(this._alignToPixels?Gm(this.chart,a,0):a)}getDecimalForPixel(e){const a=(e-this._startPixel)/this._length;return this._reversePixels?1-a:a}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:a}=this;return e<0&&a<0?a:e>0&&a>0?e:0}getContext(e){const a=this.ticks||[];if(e>=0&&e<a.length){const o=a[e];return o.$context||(o.$context=HCe(this.getContext(),e,o))}return this.$context||(this.$context=GCe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,a=lu(this.labelRotation),o=Math.abs(Math.cos(a)),s=Math.abs(Math.sin(a)),c=this._getLabelSizes(),d=e.autoSkipPadding||0,f=c?c.widest.width+d:0,m=c?c.highest.height+d:0;return this.isHorizontal()?m*o>f*s?f/o:m/s:m*s<f*o?m/o:f/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const a=this.axis,o=this.chart,s=this.options,{grid:c,position:d,border:f}=s,m=c.offset,y=this.isHorizontal(),x=this.ticks.length+(m?1:0),S=vb(c),T=[],I=f.setContext(this.getContext()),k=I.display?I.width:0,D=k/2,L=function(Le){return Gm(o,Le,k)};let O,F,B,G,q,X,te,V,Q,ge,me,be;if(d==="top")O=L(this.bottom),X=this.bottom-S,V=O-D,ge=L(e.top)+D,be=e.bottom;else if(d==="bottom")O=L(this.top),ge=e.top,be=L(e.bottom)-D,X=O+D,V=this.top+S;else if(d==="left")O=L(this.right),q=this.right-S,te=O-D,Q=L(e.left)+D,me=e.right;else if(d==="right")O=L(this.left),Q=e.left,me=L(e.right)-D,q=O+D,te=this.left+S;else if(a==="x"){if(d==="center")O=L((e.top+e.bottom)/2+.5);else if(Ja(d)){const Le=Object.keys(d)[0],Ge=d[Le];O=L(this.chart.scales[Le].getPixelForValue(Ge))}ge=e.top,be=e.bottom,X=O+D,V=X+S}else if(a==="y"){if(d==="center")O=L((e.left+e.right)/2);else if(Ja(d)){const Le=Object.keys(d)[0],Ge=d[Le];O=L(this.chart.scales[Le].getPixelForValue(Ge))}q=O-D,te=q-S,Q=e.left,me=e.right}const fe=za(s.ticks.maxTicksLimit,x),Ce=Math.max(1,Math.ceil(x/fe));for(F=0;F<x;F+=Ce){const Le=this.getContext(F),Ge=c.setContext(Le),le=f.setContext(Le),pe=Ge.lineWidth,Ae=Ge.color,ae=le.dash||[],Ee=le.dashOffset,Ze=Ge.tickWidth,Xe=Ge.tickColor,Ke=Ge.tickBorderDash||[],Ue=Ge.tickBorderDashOffset;B=WCe(this,F,m),B!==void 0&&(G=Gm(o,B,pe),y?q=te=Q=me=G:X=V=ge=be=G,T.push({tx1:q,ty1:X,tx2:te,ty2:V,x1:Q,y1:ge,x2:me,y2:be,width:pe,color:Ae,borderDash:ae,borderDashOffset:Ee,tickWidth:Ze,tickColor:Xe,tickBorderDash:Ke,tickBorderDashOffset:Ue}))}return this._ticksLength=x,this._borderValue=O,T}_computeLabelItems(e){const a=this.axis,o=this.options,{position:s,ticks:c}=o,d=this.isHorizontal(),f=this.ticks,{align:m,crossAlign:y,padding:_,mirror:x}=c,S=vb(o.grid),T=S+_,I=x?-_:T,k=-lu(this.labelRotation),D=[];let L,O,F,B,G,q,X,te,V,Q,ge,me,be="middle";if(s==="top")q=this.bottom-I,X=this._getXAxisLabelAlignment();else if(s==="bottom")q=this.top+I,X=this._getXAxisLabelAlignment();else if(s==="left"){const Ce=this._getYAxisLabelAlignment(S);X=Ce.textAlign,G=Ce.x}else if(s==="right"){const Ce=this._getYAxisLabelAlignment(S);X=Ce.textAlign,G=Ce.x}else if(a==="x"){if(s==="center")q=(e.top+e.bottom)/2+T;else if(Ja(s)){const Ce=Object.keys(s)[0],Le=s[Ce];q=this.chart.scales[Ce].getPixelForValue(Le)+T}X=this._getXAxisLabelAlignment()}else if(a==="y"){if(s==="center")G=(e.left+e.right)/2-T;else if(Ja(s)){const Ce=Object.keys(s)[0],Le=s[Ce];G=this.chart.scales[Ce].getPixelForValue(Le)}X=this._getYAxisLabelAlignment(S).textAlign}a==="y"&&(m==="start"?be="top":m==="end"&&(be="bottom"));const fe=this._getLabelSizes();for(L=0,O=f.length;L<O;++L){F=f[L],B=F.label;const Ce=c.setContext(this.getContext(L));te=this.getPixelForTick(L)+c.labelOffset,V=this._resolveTickFontOptions(L),Q=V.lineHeight,ge=lr(B)?B.length:1;const Le=ge/2,Ge=Ce.color,le=Ce.textStrokeColor,pe=Ce.textStrokeWidth;let Ae=X;d?(G=te,X==="inner"&&(L===O-1?Ae=this.options.reverse?"left":"right":L===0?Ae=this.options.reverse?"right":"left":Ae="center"),s==="top"?y==="near"||k!==0?me=-ge*Q+Q/2:y==="center"?me=-fe.highest.height/2-Le*Q+Q:me=-fe.highest.height+Q/2:y==="near"||k!==0?me=Q/2:y==="center"?me=fe.highest.height/2-Le*Q:me=fe.highest.height-ge*Q,x&&(me*=-1),k!==0&&!Ce.showLabelBackdrop&&(G+=Q/2*Math.sin(k))):(q=te,me=(1-ge)*Q/2);let ae;if(Ce.showLabelBackdrop){const Ee=Ms(Ce.backdropPadding),Ze=fe.heights[L],Xe=fe.widths[L];let Ke=me-Ee.top,Ue=0-Ee.left;switch(be){case"middle":Ke-=Ze/2;break;case"bottom":Ke-=Ze;break}switch(X){case"center":Ue-=Xe/2;break;case"right":Ue-=Xe;break}ae={left:Ue,top:Ke,width:Xe+Ee.width,height:Ze+Ee.height,color:Ce.backdropColor}}D.push({label:B,font:V,textOffset:me,options:{rotation:k,color:Ge,strokeColor:le,strokeWidth:pe,textAlign:Ae,textBaseline:be,translation:[G,q],backdrop:ae}})}return D}_getXAxisLabelAlignment(){const{position:e,ticks:a}=this.options;if(-lu(this.labelRotation))return e==="top"?"left":"right";let s="center";return a.align==="start"?s="left":a.align==="end"?s="right":a.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:a,ticks:{crossAlign:o,mirror:s,padding:c}}=this.options,d=this._getLabelSizes(),f=e+c,m=d.widest.width;let y,_;return a==="left"?s?(_=this.right+c,o==="near"?y="left":o==="center"?(y="center",_+=m/2):(y="right",_+=m)):(_=this.right-f,o==="near"?y="right":o==="center"?(y="center",_-=m/2):(y="left",_=this.left)):a==="right"?s?(_=this.left+c,o==="near"?y="right":o==="center"?(y="center",_-=m/2):(y="left",_-=m)):(_=this.left+f,o==="near"?y="left":o==="center"?(y="center",_+=m/2):(y="right",_=this.right)):y="right",{textAlign:y,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,a=this.options.position;if(a==="left"||a==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(a==="top"||a==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:a},left:o,top:s,width:c,height:d}=this;a&&(e.save(),e.fillStyle=a,e.fillRect(o,s,c,d),e.restore())}getLineWidthForValue(e){const a=this.options.grid;if(!this._isVisible()||!a.display)return 0;const s=this.ticks.findIndex(c=>c.value===e);return s>=0?a.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const a=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let c,d;const f=(m,y,_)=>{!_.width||!_.color||(o.save(),o.lineWidth=_.width,o.strokeStyle=_.color,o.setLineDash(_.borderDash||[]),o.lineDashOffset=_.borderDashOffset,o.beginPath(),o.moveTo(m.x,m.y),o.lineTo(y.x,y.y),o.stroke(),o.restore())};if(a.display)for(c=0,d=s.length;c<d;++c){const m=s[c];a.drawOnChartArea&&f({x:m.x1,y:m.y1},{x:m.x2,y:m.y2},m),a.drawTicks&&f({x:m.tx1,y:m.ty1},{x:m.tx2,y:m.ty2},{color:m.tickColor,width:m.tickWidth,borderDash:m.tickBorderDash,borderDashOffset:m.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:a,options:{border:o,grid:s}}=this,c=o.setContext(this.getContext()),d=o.display?c.width:0;if(!d)return;const f=s.setContext(this.getContext(0)).lineWidth,m=this._borderValue;let y,_,x,S;this.isHorizontal()?(y=Gm(e,this.left,d)-d/2,_=Gm(e,this.right,f)+f/2,x=S=m):(x=Gm(e,this.top,d)-d/2,S=Gm(e,this.bottom,f)+f/2,y=_=m),a.save(),a.lineWidth=c.width,a.strokeStyle=c.color,a.beginPath(),a.moveTo(y,x),a.lineTo(_,S),a.stroke(),a.restore()}drawLabels(e){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&dC(o,s);const c=this.getLabelItems(e);for(const d of c){const f=d.options,m=d.font,y=d.label,_=d.textOffset;Bg(o,y,0,_,m,f)}s&&hC(o)}drawTitle(){const{ctx:e,options:{position:a,title:o,reverse:s}}=this;if(!o.display)return;const c=Ro(o.font),d=Ms(o.padding),f=o.align;let m=c.lineHeight/2;a==="bottom"||a==="center"||Ja(a)?(m+=d.bottom,lr(o.text)&&(m+=c.lineHeight*(o.text.length-1))):m+=d.top;const{titleX:y,titleY:_,maxWidth:x,rotation:S}=$Ce(this,m,a,f);Bg(e,o.text,0,0,c,{color:o.color,maxWidth:x,rotation:S,textAlign:jCe(f,a,s),textBaseline:"middle",translation:[y,_]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,a=e.ticks&&e.ticks.z||0,o=za(e.grid&&e.grid.z,-1),s=za(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Yg.prototype.draw?[{z:a,draw:c=>{this.draw(c)}}]:[{z:o,draw:c=>{this.drawBackground(),this.drawGrid(c),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:a,draw:c=>{this.drawLabels(c)}}]}getMatchingVisibleMetas(e){const a=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let c,d;for(c=0,d=a.length;c<d;++c){const f=a[c];f[o]===this.id&&(!e||f.type===e)&&s.push(f)}return s}_resolveTickFontOptions(e){const a=this.options.ticks.setContext(this.getContext(e));return Ro(a.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class vA{constructor(e,a,o){this.type=e,this.scope=a,this.override=o,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const a=Object.getPrototypeOf(e);let o;YCe(a)&&(o=this.register(a));const s=this.items,c=e.id,d=this.scope+"."+c;if(!c)throw new Error("class does not have id: "+e);return c in s||(s[c]=e,qCe(e,d,o),this.override&&Yr.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const a=this.items,o=e.id,s=this.scope;o in a&&delete a[o],s&&o in Yr[s]&&(delete Yr[s][o],this.override&&delete Ng[o])}}function qCe(n,e,a){const o=cw(Object.create(null),[a?Yr.get(a):{},Yr.get(e),n.defaults]);Yr.set(e,o),n.defaultRoutes&&XCe(e,n.defaultRoutes),n.descriptors&&Yr.describe(e,n.descriptors)}function XCe(n,e){Object.keys(e).forEach(a=>{const o=a.split("."),s=o.pop(),c=[n].concat(o).join("."),d=e[a].split("."),f=d.pop(),m=d.join(".");Yr.route(c,s,m,f)})}function YCe(n){return"id"in n&&"defaults"in n}class ZCe{constructor(){this.controllers=new vA(du,"datasets",!0),this.elements=new vA(mu,"elements"),this.plugins=new vA(Object,"plugins"),this.scales=new vA(Yg,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,a,o){[...a].forEach(s=>{const c=o||this._getRegistryForType(s);o||c.isForType(s)||c===this.plugins&&s.id?this._exec(e,c,s):Fi(s,d=>{const f=o||this._getRegistryForType(d);this._exec(e,f,d)})})}_exec(e,a,o){const s=eO(e);er(o["before"+s],[],o),a[e](o),er(o["after"+s],[],o)}_getRegistryForType(e){for(let a=0;a<this._typedRegistries.length;a++){const o=this._typedRegistries[a];if(o.isForType(e))return o}return this.plugins}_get(e,a,o){const s=a.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+o+".");return s}}var nd=new ZCe;class KCe{constructor(){this._init=[]}notify(e,a,o,s){a==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const c=s?this._descriptors(e).filter(s):this._descriptors(e),d=this._notify(c,e,a,o);return a==="afterDestroy"&&(this._notify(c,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,a,o,s){s=s||{};for(const c of e){const d=c.plugin,f=d[o],m=[a,s,c.options];if(er(f,m,d)===!1&&s.cancelable)return!1}return!0}invalidate(){ci(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const a=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),a}_createDescriptors(e,a){const o=e&&e.config,s=za(o.options&&o.options.plugins,{}),c=JCe(o);return s===!1&&!a?[]:ePe(e,c,s,a)}_notifyStateChanges(e){const a=this._oldCache||[],o=this._cache,s=(c,d)=>c.filter(f=>!d.some(m=>f.plugin.id===m.plugin.id));this._notify(s(a,o),e,"stop"),this._notify(s(o,a),e,"start")}}function JCe(n){const e={},a=[],o=Object.keys(nd.plugins.items);for(let c=0;c<o.length;c++)a.push(nd.getPlugin(o[c]));const s=n.plugins||[];for(let c=0;c<s.length;c++){const d=s[c];a.indexOf(d)===-1&&(a.push(d),e[d.id]=!0)}return{plugins:a,localIds:e}}function QCe(n,e){return!e&&n===!1?null:n===!0?{}:n}function ePe(n,{plugins:e,localIds:a},o,s){const c=[],d=n.getContext();for(const f of e){const m=f.id,y=QCe(o[m],s);y!==null&&c.push({plugin:f,options:tPe(n.config,{plugin:f,local:a[m]},y,d)})}return c}function tPe(n,{plugin:e,local:a},o,s){const c=n.pluginScopeKeys(e),d=n.getOptionScopes(o,c);return a&&e.defaults&&d.push(e.defaults),n.createResolver(d,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function tk(n,e){const a=Yr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||a.indexAxis||"x"}function nPe(n,e){let a=n;return n==="_index_"?a=e:n==="_value_"&&(a=e==="x"?"y":"x"),a}function aPe(n,e){return n===e?"_index_":"_value_"}function yH(n){if(n==="x"||n==="y"||n==="r")return n}function iPe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function nk(n,...e){if(yH(n))return n;for(const a of e){const o=a.axis||iPe(a.position)||n.length>1&&yH(n[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function vH(n,e,a){if(a[e+"AxisID"]===n)return{axis:e}}function rPe(n,e){if(e.data&&e.data.datasets){const a=e.data.datasets.filter(o=>o.xAxisID===n||o.yAxisID===n);if(a.length)return vH(n,"x",a[0])||vH(n,"y",a[0])}return{}}function oPe(n,e){const a=Ng[n.type]||{scales:{}},o=e.scales||{},s=tk(n.type,e),c=Object.create(null);return Object.keys(o).forEach(d=>{const f=o[d];if(!Ja(f))return console.error(`Invalid scale configuration for scale: ${d}`);if(f._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const m=nk(d,f,rPe(d,n),Yr.scales[f.type]),y=aPe(m,s),_=a.scales||{};c[d]=lx(Object.create(null),[{axis:m},f,_[m],_[y]])}),n.data.datasets.forEach(d=>{const f=d.type||n.type,m=d.indexAxis||tk(f,e),_=(Ng[f]||{}).scales||{};Object.keys(_).forEach(x=>{const S=nPe(x,m),T=d[S+"AxisID"]||S;c[T]=c[T]||Object.create(null),lx(c[T],[{axis:S},o[T],_[x]])})}),Object.keys(c).forEach(d=>{const f=c[d];lx(f,[Yr.scales[f.type],Yr.scale])}),c}function BJ(n){const e=n.options||(n.options={});e.plugins=za(e.plugins,{}),e.scales=oPe(n,e)}function UJ(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function sPe(n){return n=n||{},n.data=UJ(n.data),BJ(n),n}const _H=new Map,WJ=new Set;function _A(n,e){let a=_H.get(n);return a||(a=e(),_H.set(n,a),WJ.add(a)),a}const _b=(n,e,a)=>{const o=xp(e,a);o!==void 0&&n.add(o)};class lPe{constructor(e){this._config=sPe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=UJ(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),BJ(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return _A(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,a){return _A(`${e}.transition.${a}`,()=>[[`datasets.${e}.transitions.${a}`,`transitions.${a}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,a){return _A(`${e}-${a}`,()=>[[`datasets.${e}.elements.${a}`,`datasets.${e}`,`elements.${a}`,""]])}pluginScopeKeys(e){const a=e.id,o=this.type;return _A(`${o}-plugin-${a}`,()=>[[`plugins.${a}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,a){const o=this._scopeCache;let s=o.get(e);return(!s||a)&&(s=new Map,o.set(e,s)),s}getOptionScopes(e,a,o){const{options:s,type:c}=this,d=this._cachedScopes(e,o),f=d.get(a);if(f)return f;const m=new Set;a.forEach(_=>{e&&(m.add(e),_.forEach(x=>_b(m,e,x))),_.forEach(x=>_b(m,s,x)),_.forEach(x=>_b(m,Ng[c]||{},x)),_.forEach(x=>_b(m,Yr,x)),_.forEach(x=>_b(m,JR,x))});const y=Array.from(m);return y.length===0&&y.push(Object.create(null)),WJ.has(a)&&d.set(a,y),y}chartOptionScopes(){const{options:e,type:a}=this;return[e,Ng[a]||{},Yr.datasets[a]||{},{type:a},Yr,JR]}resolveNamedOptions(e,a,o,s=[""]){const c={$shared:!0},{resolver:d,subPrefixes:f}=bH(this._resolverCache,e,s);let m=d;if(uPe(d,a)){c.$shared=!1,o=wp(o)?o():o;const y=this.createResolver(e,o,f);m=l_(d,o,y)}for(const y of a)c[y]=m[y];return c}createResolver(e,a,o=[""],s){const{resolver:c}=bH(this._resolverCache,e,o);return Ja(a)?l_(c,a,void 0,s):c}}function bH(n,e,a){let o=n.get(e);o||(o=new Map,n.set(e,o));const s=a.join();let c=o.get(s);return c||(c={resolver:oO(e,a),subPrefixes:a.filter(f=>!f.toLowerCase().includes("hover"))},o.set(s,c)),c}const cPe=n=>Ja(n)&&Object.getOwnPropertyNames(n).reduce((e,a)=>e||wp(n[a]),!1);function uPe(n,e){const{isScriptable:a,isIndexable:o}=_J(n);for(const s of e){const c=a(s),d=o(s),f=(d||c)&&n[s];if(c&&(wp(f)||cPe(f))||d&&lr(f))return!0}return!1}var dPe="4.4.0";const hPe=["top","bottom","left","right","chartArea"];function xH(n,e){return n==="top"||n==="bottom"||hPe.indexOf(n)===-1&&e==="x"}function wH(n,e){return function(a,o){return a[n]===o[n]?a[e]-o[e]:a[n]-o[n]}}function SH(n){const e=n.chart,a=e.options.animation;e.notifyPlugins("afterRender"),er(a&&a.onComplete,[n],e)}function fPe(n){const e=n.chart,a=e.options.animation;er(a&&a.onProgress,[n],e)}function VJ(n){return EJ()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const lE={},AH=n=>{const e=VJ(n);return Object.values(lE).filter(a=>a.canvas===e).pop()};function pPe(n,e,a){const o=Object.keys(n);for(const s of o){const c=+s;if(c>=e){const d=n[s];delete n[s],(a>0||c>e)&&(n[c+a]=d)}}}function mPe(n,e,a,o){return!a||n.type==="mouseout"?null:o?e:n}function bA(n,e,a){return n.options.clip?n[a]:e[a]}function gPe(n,e){const{xScale:a,yScale:o}=n;return a&&o?{left:bA(a,e,"left"),right:bA(a,e,"right"),top:bA(o,e,"top"),bottom:bA(o,e,"bottom")}:e}var Uf;let Xw=(Uf=class{static register(...e){nd.add(...e),EH()}static unregister(...e){nd.remove(...e),EH()}constructor(e,a){const o=this.config=new lPe(a),s=VJ(e),c=AH(s);if(c)throw new Error("Canvas is already in use. Chart with ID '"+c.id+"' must be destroyed before the canvas with ID '"+c.canvas.id+"' can be reused.");const d=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||kCe(s)),this.platform.updateConfig(o);const f=this.platform.acquireContext(s,d.aspectRatio),m=f&&f.canvas,y=m&&m.height,_=m&&m.width;if(this.id=vMe(),this.ctx=f,this.canvas=m,this.width=_,this.height=y,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new KCe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=DMe(x=>this.update(x),d.resizeDelay||0),this._dataChanges=[],lE[this.id]=this,!f||!m){console.error("Failed to create chart: can't acquire context from the given item");return}ph.listen(this,"complete",SH),ph.listen(this,"progress",fPe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:a},width:o,height:s,_aspectRatio:c}=this;return ci(e)?a&&c?c:s?o/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return nd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():$G(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return GG(this.canvas,this.ctx),this}stop(){return ph.stop(this),this}resize(e,a){ph.running(this)?this._resizeBeforeDraw={width:e,height:a}:this._resize(e,a)}_resize(e,a){const o=this.options,s=this.canvas,c=o.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(s,e,a,c),f=o.devicePixelRatio||this.platform.getDevicePixelRatio(),m=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,$G(this,f,!0)&&(this.notifyPlugins("resize",{size:d}),er(o.onResize,[this,d],this),this.attached&&this._doResize(m)&&this.render())}ensureScalesHaveIDs(){const a=this.options.scales||{};Fi(a,(o,s)=>{o.id=s})}buildOrUpdateScales(){const e=this.options,a=e.scales,o=this.scales,s=Object.keys(o).reduce((d,f)=>(d[f]=!1,d),{});let c=[];a&&(c=c.concat(Object.keys(a).map(d=>{const f=a[d],m=nk(d,f),y=m==="r",_=m==="x";return{options:f,dposition:y?"chartArea":_?"bottom":"left",dtype:y?"radialLinear":_?"category":"linear"}}))),Fi(c,d=>{const f=d.options,m=f.id,y=nk(m,f),_=za(f.type,d.dtype);(f.position===void 0||xH(f.position,y)!==xH(d.dposition))&&(f.position=d.dposition),s[m]=!0;let x=null;if(m in o&&o[m].type===_)x=o[m];else{const S=nd.getScale(_);x=new S({id:m,type:_,ctx:this.ctx,chart:this}),o[x.id]=x}x.init(f,e)}),Fi(s,(d,f)=>{d||delete o[f]}),Fi(o,d=>{ws.configure(this,d,d.options),ws.addBox(this,d)})}_updateMetasets(){const e=this._metasets,a=this.data.datasets.length,o=e.length;if(e.sort((s,c)=>s.index-c.index),o>a){for(let s=a;s<o;++s)this._destroyDatasetMeta(s);e.splice(a,o-a)}this._sortedMetasets=e.slice(0).sort(wH("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:a}}=this;e.length>a.length&&delete this._stacks,e.forEach((o,s)=>{a.filter(c=>c===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],a=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=a.length;o<s;o++){const c=a[o];let d=this.getDatasetMeta(o);const f=c.type||this.config.type;if(d.type&&d.type!==f&&(this._destroyDatasetMeta(o),d=this.getDatasetMeta(o)),d.type=f,d.indexAxis=c.indexAxis||tk(f,this.options),d.order=c.order||0,d.index=o,d.label=""+c.label,d.visible=this.isDatasetVisible(o),d.controller)d.controller.updateIndex(o),d.controller.linkScales();else{const m=nd.getController(f),{datasetElementType:y,dataElementType:_}=Yr.datasets[f];Object.assign(m,{dataElementType:nd.getElement(_),datasetElementType:y&&nd.getElement(y)}),d.controller=new m(this,o),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){Fi(this.data.datasets,(e,a)=>{this.getDatasetMeta(a).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const a=this.config;a.update();const o=this._options=a.createResolver(a.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const c=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let y=0,_=this.data.datasets.length;y<_;y++){const{controller:x}=this.getDatasetMeta(y),S=!s&&c.indexOf(x)===-1;x.buildOrUpdateElements(S),d=Math.max(+x.getMaxOverflow(),d)}d=this._minPadding=o.layout.autoPadding?d:0,this._updateLayout(d),s||Fi(c,y=>{y.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(wH("z","_idx"));const{_active:f,_lastEvent:m}=this;m?this._eventHandler(m,!0):f.length&&this._updateHoverStyles(f,f,!0),this.render()}_updateScales(){Fi(this.scales,e=>{ws.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,a=new Set(Object.keys(this._listeners)),o=new Set(e.events);(!DG(a,o)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,a=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:c}of a){const d=o==="_removeElements"?-c:c;pPe(e,s,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const a=this.data.datasets.length,o=c=>new Set(e.filter(d=>d[0]===c).map((d,f)=>f+","+d.splice(1).join(","))),s=o(0);for(let c=1;c<a;c++)if(!DG(s,o(c)))return;return Array.from(s).map(c=>c.split(",")).map(c=>({method:c[1],start:+c[2],count:+c[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ws.update(this,this.width,this.height,e);const a=this.chartArea,o=a.width<=0||a.height<=0;this._layers=[],Fi(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,c)=>{s._idx=c}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let a=0,o=this.data.datasets.length;a<o;++a)this.getDatasetMeta(a).controller.configure();for(let a=0,o=this.data.datasets.length;a<o;++a)this._updateDataset(a,wp(e)?e({datasetIndex:a}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,a){const o=this.getDatasetMeta(e),s={meta:o,index:e,mode:a,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(a),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ph.has(this)?this.attached&&!ph.running(this)&&ph.start(this):(this.draw(),SH({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resize(o,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const a=this._layers;for(e=0;e<a.length&&a[e].z<=0;++e)a[e].draw(this.chartArea);for(this._drawDatasets();e<a.length;++e)a[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const a=this._sortedMetasets,o=[];let s,c;for(s=0,c=a.length;s<c;++s){const d=a[s];(!e||d.visible)&&o.push(d)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let a=e.length-1;a>=0;--a)this._drawDataset(e[a]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const a=this.ctx,o=e._clip,s=!o.disabled,c=gPe(e,this.chartArea),d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(s&&dC(a,{left:o.left===!1?0:c.left-o.left,right:o.right===!1?this.width:c.right+o.right,top:o.top===!1?0:c.top-o.top,bottom:o.bottom===!1?this.height:c.bottom+o.bottom}),e.controller.draw(),s&&hC(a),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return Ch(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,a,o,s){const c=hCe.modes[a];return typeof c=="function"?c(this,e,o,s):[]}getDatasetMeta(e){const a=this.data.datasets[e],o=this._metasets;let s=o.filter(c=>c&&c._dataset===a).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:a&&a.order||0,index:e,_dataset:a,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=Ip(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const a=this.data.datasets[e];if(!a)return!1;const o=this.getDatasetMeta(e);return typeof o.hidden=="boolean"?!o.hidden:!a.hidden}setDatasetVisibility(e,a){const o=this.getDatasetMeta(e);o.hidden=!a}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,a,o){const s=o?"show":"hide",c=this.getDatasetMeta(e),d=c.controller._resolveAnimations(void 0,s);uw(a)?(c.data[a].hidden=!o,this.update()):(this.setDatasetVisibility(e,o),d.update(c,{visible:o}),this.update(f=>f.datasetIndex===e?s:void 0))}hide(e,a){this._updateVisibility(e,a,!1)}show(e,a){this._updateVisibility(e,a,!0)}_destroyDatasetMeta(e){const a=this._metasets[e];a&&a.controller&&a.controller._destroy(),delete this._metasets[e]}_stop(){let e,a;for(this.stop(),ph.remove(this),e=0,a=this.data.datasets.length;e<a;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:a}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),GG(e,a),this.platform.releaseContext(a),this.canvas=null,this.ctx=null),delete lE[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,a=this.platform,o=(c,d)=>{a.addEventListener(this,c,d),e[c]=d},s=(c,d,f)=>{c.offsetX=d,c.offsetY=f,this._eventHandler(c)};Fi(this.options.events,c=>o(c,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,a=this.platform,o=(m,y)=>{a.addEventListener(this,m,y),e[m]=y},s=(m,y)=>{e[m]&&(a.removeEventListener(this,m,y),delete e[m])},c=(m,y)=>{this.canvas&&this.resize(m,y)};let d;const f=()=>{s("attach",f),this.attached=!0,this.resize(),o("resize",c),o("detach",d)};d=()=>{this.attached=!1,s("resize",c),this._stop(),this._resize(0,0),o("attach",f)},a.isAttached(this.canvas)?f():d()}unbindEvents(){Fi(this._listeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._listeners={},Fi(this._responsiveListeners,(e,a)=>{this.platform.removeEventListener(this,a,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,a,o){const s=o?"set":"remove";let c,d,f,m;for(a==="dataset"&&(c=this.getDatasetMeta(e[0].datasetIndex),c.controller["_"+s+"DatasetHoverStyle"]()),f=0,m=e.length;f<m;++f){d=e[f];const y=d&&this.getDatasetMeta(d.datasetIndex).controller;y&&y[s+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const a=this._active||[],o=e.map(({datasetIndex:c,index:d})=>{const f=this.getDatasetMeta(c);if(!f)throw new Error("No dataset found at index "+c);return{datasetIndex:c,element:f.data[d],index:d}});!dM(o,a)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,a))}notifyPlugins(e,a,o){return this._plugins.notify(this,e,a,o)}isPluginEnabled(e){return this._plugins._cache.filter(a=>a.plugin.id===e).length===1}_updateHoverStyles(e,a,o){const s=this.options.hover,c=(m,y)=>m.filter(_=>!y.some(x=>_.datasetIndex===x.datasetIndex&&_.index===x.index)),d=c(a,e),f=o?e:c(e,a);d.length&&this.updateHoverStyle(d,s.mode,!1),f.length&&s.mode&&this.updateHoverStyle(f,s.mode,!0)}_eventHandler(e,a){const o={event:e,replay:a,cancelable:!0,inChartArea:this.isPointInArea(e)},s=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const c=this._handleEvent(e,a,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(c||o.changed)&&this.render(),this}_handleEvent(e,a,o){const{_active:s=[],options:c}=this,d=a,f=this._getActiveElements(e,s,o,d),m=AMe(e),y=mPe(e,this._lastEvent,o,m);o&&(this._lastEvent=null,er(c.onHover,[e,f,this],this),m&&er(c.onClick,[e,f,this],this));const _=!dM(f,s);return(_||a)&&(this._active=f,this._updateHoverStyles(f,s,a)),this._lastEvent=y,_}_getActiveElements(e,a,o,s){if(e.type==="mouseout")return[];if(!o)return a;const c=this.options.hover;return this.getElementsAtEventForMode(e,c.mode,c,s)}},_n(Uf,"defaults",Yr),_n(Uf,"instances",lE),_n(Uf,"overrides",Ng),_n(Uf,"registry",nd),_n(Uf,"version",dPe),_n(Uf,"getChart",AH),Uf);function EH(){return Fi(Xw.instances,n=>n._plugins.invalidate())}function yPe(n,e,a){const{startAngle:o,pixelMargin:s,x:c,y:d,outerRadius:f,innerRadius:m}=e;let y=s/f;n.beginPath(),n.arc(c,d,f,o-y,a+y),m>s?(y=s/m,n.arc(c,d,m,a+y,o-y,!0)):n.arc(c,d,s,a+uo,o-uo),n.closePath(),n.clip()}function vPe(n){return rO(n,["outerStart","outerEnd","innerStart","innerEnd"])}function _Pe(n,e,a,o){const s=vPe(n.options.borderRadius),c=(a-e)/2,d=Math.min(c,o*e/2),f=m=>{const y=(a-Math.min(c,m))*o/2;return Wo(m,0,Math.min(c,y))};return{outerStart:f(s.outerStart),outerEnd:f(s.outerEnd),innerStart:Wo(s.innerStart,0,d),innerEnd:Wo(s.innerEnd,0,d)}}function t0(n,e,a,o){return{x:a+n*Math.cos(e),y:o+n*Math.sin(e)}}function yM(n,e,a,o,s,c){const{x:d,y:f,startAngle:m,pixelMargin:y,innerRadius:_}=e,x=Math.max(e.outerRadius+o+a-y,0),S=_>0?_+o+a+y:0;let T=0;const I=s-m;if(o){const Ce=_>0?_-o:0,Le=x>0?x-o:0,Ge=(Ce+Le)/2,le=Ge!==0?I*Ge/(Ge+o):I;T=(I-le)/2}const k=Math.max(.001,I*x-a/dr)/x,D=(I-k)/2,L=m+D+T,O=s-D-T,{outerStart:F,outerEnd:B,innerStart:G,innerEnd:q}=_Pe(e,S,x,O-L),X=x-F,te=x-B,V=L+F/X,Q=O-B/te,ge=S+G,me=S+q,be=L+G/ge,fe=O-q/me;if(n.beginPath(),c){const Ce=(V+Q)/2;if(n.arc(d,f,x,V,Ce),n.arc(d,f,x,Ce,Q),B>0){const pe=t0(te,Q,d,f);n.arc(pe.x,pe.y,B,Q,O+uo)}const Le=t0(me,O,d,f);if(n.lineTo(Le.x,Le.y),q>0){const pe=t0(me,fe,d,f);n.arc(pe.x,pe.y,q,O+uo,fe+Math.PI)}const Ge=(O-q/S+(L+G/S))/2;if(n.arc(d,f,S,O-q/S,Ge,!0),n.arc(d,f,S,Ge,L+G/S,!0),G>0){const pe=t0(ge,be,d,f);n.arc(pe.x,pe.y,G,be+Math.PI,L-uo)}const le=t0(X,L,d,f);if(n.lineTo(le.x,le.y),F>0){const pe=t0(X,V,d,f);n.arc(pe.x,pe.y,F,L-uo,V)}}else{n.moveTo(d,f);const Ce=Math.cos(V)*x+d,Le=Math.sin(V)*x+f;n.lineTo(Ce,Le);const Ge=Math.cos(Q)*x+d,le=Math.sin(Q)*x+f;n.lineTo(Ge,le)}n.closePath()}function bPe(n,e,a,o,s){const{fullCircles:c,startAngle:d,circumference:f}=e;let m=e.endAngle;if(c){yM(n,e,a,o,m,s);for(let y=0;y<c;++y)n.fill();isNaN(f)||(m=d+(f%ur||ur))}return yM(n,e,a,o,m,s),n.fill(),m}function xPe(n,e,a,o,s){const{fullCircles:c,startAngle:d,circumference:f,options:m}=e,{borderWidth:y,borderJoinStyle:_,borderDash:x,borderDashOffset:S}=m,T=m.borderAlign==="inner";if(!y)return;n.setLineDash(x||[]),n.lineDashOffset=S,T?(n.lineWidth=y*2,n.lineJoin=_||"round"):(n.lineWidth=y,n.lineJoin=_||"bevel");let I=e.endAngle;if(c){yM(n,e,a,o,I,s);for(let k=0;k<c;++k)n.stroke();isNaN(f)||(I=d+(f%ur||ur))}T&&yPe(n,e,I),c||(yM(n,e,a,o,I,s),n.stroke())}class Db extends mu{constructor(a){super();_n(this,"circumference");_n(this,"endAngle");_n(this,"fullCircles");_n(this,"innerRadius");_n(this,"outerRadius");_n(this,"pixelMargin");_n(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,a&&Object.assign(this,a)}inRange(a,o,s){const c=this.getProps(["x","y"],s),{angle:d,distance:f}=cJ(c,{x:a,y:o}),{startAngle:m,endAngle:y,innerRadius:_,outerRadius:x,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),T=(this.options.spacing+this.options.borderWidth)/2,k=za(S,y-m)>=ur||dw(d,m,y),D=Mh(f,_+T,x+T);return k&&D}getCenterPoint(a){const{x:o,y:s,startAngle:c,endAngle:d,innerRadius:f,outerRadius:m}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],a),{offset:y,spacing:_}=this.options,x=(c+d)/2,S=(f+m+_+y)/2;return{x:o+Math.cos(x)*S,y:s+Math.sin(x)*S}}tooltipPosition(a){return this.getCenterPoint(a)}draw(a){const{options:o,circumference:s}=this,c=(o.offset||0)/4,d=(o.spacing||0)/2,f=o.circular;if(this.pixelMargin=o.borderAlign==="inner"?.33:0,this.fullCircles=s>ur?Math.floor(s/ur):0,s===0||this.innerRadius<0||this.outerRadius<0)return;a.save();const m=(this.startAngle+this.endAngle)/2;a.translate(Math.cos(m)*c,Math.sin(m)*c);const y=1-Math.sin(Math.min(dr,s||0)),_=c*y;a.fillStyle=o.backgroundColor,a.strokeStyle=o.borderColor,bPe(a,this,_,d,f),xPe(a,this,_,d,f),a.restore()}}_n(Db,"id","arc"),_n(Db,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),_n(Db,"defaultRoutes",{backgroundColor:"backgroundColor"}),_n(Db,"descriptors",{_scriptable:!0,_indexable:a=>a!=="borderDash"});function GJ(n,e,a=e){n.lineCap=za(a.borderCapStyle,e.borderCapStyle),n.setLineDash(za(a.borderDash,e.borderDash)),n.lineDashOffset=za(a.borderDashOffset,e.borderDashOffset),n.lineJoin=za(a.borderJoinStyle,e.borderJoinStyle),n.lineWidth=za(a.borderWidth,e.borderWidth),n.strokeStyle=za(a.borderColor,e.borderColor)}function wPe(n,e,a){n.lineTo(a.x,a.y)}function SPe(n){return n.stepped?$Me:n.tension||n.cubicInterpolationMode==="monotone"?qMe:wPe}function HJ(n,e,a={}){const o=n.length,{start:s=0,end:c=o-1}=a,{start:d,end:f}=e,m=Math.max(s,d),y=Math.min(c,f),_=s<d&&c<d||s>f&&c>f;return{count:o,start:m,loop:e.loop,ilen:y<m&&!_?o+y-m:y-m}}function APe(n,e,a,o){const{points:s,options:c}=e,{count:d,start:f,loop:m,ilen:y}=HJ(s,a,o),_=SPe(c);let{move:x=!0,reverse:S}=o||{},T,I,k;for(T=0;T<=y;++T)I=s[(f+(S?y-T:T))%d],!I.skip&&(x?(n.moveTo(I.x,I.y),x=!1):_(n,k,I,S,c.stepped),k=I);return m&&(I=s[(f+(S?y:0))%d],_(n,k,I,S,c.stepped)),!!m}function EPe(n,e,a,o){const s=e.points,{count:c,start:d,ilen:f}=HJ(s,a,o),{move:m=!0,reverse:y}=o||{};let _=0,x=0,S,T,I,k,D,L;const O=B=>(d+(y?f-B:B))%c,F=()=>{k!==D&&(n.lineTo(_,D),n.lineTo(_,k),n.lineTo(_,L))};for(m&&(T=s[O(0)],n.moveTo(T.x,T.y)),S=0;S<=f;++S){if(T=s[O(S)],T.skip)continue;const B=T.x,G=T.y,q=B|0;q===I?(G<k?k=G:G>D&&(D=G),_=(x*_+B)/++x):(F(),n.lineTo(B,G),I=q,x=0,k=D=G),L=G}F()}function ak(n){const e=n.options,a=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!a?EPe:APe}function MPe(n){return n.stepped?ETe:n.tension||n.cubicInterpolationMode==="monotone"?MTe:ng}function TPe(n,e,a,o){let s=e._path;s||(s=e._path=new Path2D,e.path(s,a,o)&&s.closePath()),GJ(n,e.options),n.stroke(s)}function CPe(n,e,a,o){const{segments:s,options:c}=e,d=ak(e);for(const f of s)GJ(n,c,f.style),n.beginPath(),d(n,e,f,{start:a,end:a+o-1})&&n.closePath(),n.stroke()}const PPe=typeof Path2D=="function";function IPe(n,e,a,o){PPe&&!e.options.segment?TPe(n,e,a,o):CPe(n,e,a,o)}class Qf extends mu{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,a){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;yTe(this._points,o,e,s,a),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=RTe(this,this.options.segment))}first(){const e=this.segments,a=this.points;return e.length&&a[e[0].start]}last(){const e=this.segments,a=this.points,o=e.length;return o&&a[e[o-1].end]}interpolate(e,a){const o=this.options,s=e[a],c=this.points,d=IJ(this,{property:a,start:s,end:s});if(!d.length)return;const f=[],m=MPe(o);let y,_;for(y=0,_=d.length;y<_;++y){const{start:x,end:S}=d[y],T=c[x],I=c[S];if(T===I){f.push(T);continue}const k=Math.abs((s-T[a])/(I[a]-T[a])),D=m(T,I,k,o.stepped);D[a]=e[a],f.push(D)}return f.length===1?f[0]:f}pathSegment(e,a,o){return ak(this)(e,this,a,o)}path(e,a,o){const s=this.segments,c=ak(this);let d=this._loop;a=a||0,o=o||this.points.length-a;for(const f of s)d&=c(e,this,f,{start:a,end:a+o-1});return!!d}draw(e,a,o,s){const c=this.options||{};(this.points||[]).length&&c.borderWidth&&(e.save(),IPe(e,this,o,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}_n(Qf,"id","line"),_n(Qf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),_n(Qf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),_n(Qf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function MH(n,e,a,o){const s=n.options,{[a]:c}=n.getProps([a],o);return Math.abs(e-c)<s.radius+s.hitRadius}class cE extends mu{constructor(a){super();_n(this,"parsed");_n(this,"skip");_n(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,a&&Object.assign(this,a)}inRange(a,o,s){const c=this.options,{x:d,y:f}=this.getProps(["x","y"],s);return Math.pow(a-d,2)+Math.pow(o-f,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(a,o){return MH(this,a,"x",o)}inYRange(a,o){return MH(this,a,"y",o)}getCenterPoint(a){const{x:o,y:s}=this.getProps(["x","y"],a);return{x:o,y:s}}size(a){a=a||this.options||{};let o=a.radius||0;o=Math.max(o,o&&a.hoverRadius||0);const s=o&&a.borderWidth||0;return(o+s)*2}draw(a,o){const s=this.options;this.skip||s.radius<.1||!Ch(this,o,this.size(s)/2)||(a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.fillStyle=s.backgroundColor,QR(a,s,this.x,this.y))}getRange(){const a=this.options||{};return a.radius+a.hitRadius}}_n(cE,"id","point"),_n(cE,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),_n(cE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function jJ(n,e){const{x:a,y:o,base:s,width:c,height:d}=n.getProps(["x","y","base","width","height"],e);let f,m,y,_,x;return n.horizontal?(x=d/2,f=Math.min(a,s),m=Math.max(a,s),y=o-x,_=o+x):(x=c/2,f=a-x,m=a+x,y=Math.min(o,s),_=Math.max(o,s)),{left:f,top:y,right:m,bottom:_}}function ep(n,e,a,o){return n?0:Wo(e,a,o)}function LPe(n,e,a){const o=n.options.borderWidth,s=n.borderSkipped,c=vJ(o);return{t:ep(s.top,c.top,0,a),r:ep(s.right,c.right,0,e),b:ep(s.bottom,c.bottom,0,a),l:ep(s.left,c.left,0,e)}}function RPe(n,e,a){const{enableBorderRadius:o}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,c=Ag(s),d=Math.min(e,a),f=n.borderSkipped,m=o||Ja(s);return{topLeft:ep(!m||f.top||f.left,c.topLeft,0,d),topRight:ep(!m||f.top||f.right,c.topRight,0,d),bottomLeft:ep(!m||f.bottom||f.left,c.bottomLeft,0,d),bottomRight:ep(!m||f.bottom||f.right,c.bottomRight,0,d)}}function kPe(n){const e=jJ(n),a=e.right-e.left,o=e.bottom-e.top,s=LPe(n,a/2,o/2),c=RPe(n,a/2,o/2);return{outer:{x:e.left,y:e.top,w:a,h:o,radius:c},inner:{x:e.left+s.l,y:e.top+s.t,w:a-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,c.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,c.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,c.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,c.bottomRight-Math.max(s.b,s.r))}}}}function PI(n,e,a,o){const s=e===null,c=a===null,f=n&&!(s&&c)&&jJ(n,o);return f&&(s||Mh(e,f.left,f.right))&&(c||Mh(a,f.top,f.bottom))}function DPe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function OPe(n,e){n.rect(e.x,e.y,e.w,e.h)}function II(n,e,a={}){const o=n.x!==a.x?-e:0,s=n.y!==a.y?-e:0,c=(n.x+n.w!==a.x+a.w?e:0)-o,d=(n.y+n.h!==a.y+a.h?e:0)-s;return{x:n.x+o,y:n.y+s,w:n.w+c,h:n.h+d,radius:n.radius}}class uE extends mu{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:a,options:{borderColor:o,backgroundColor:s}}=this,{inner:c,outer:d}=kPe(this),f=DPe(d.radius)?hw:OPe;e.save(),(d.w!==c.w||d.h!==c.h)&&(e.beginPath(),f(e,II(d,a,c)),e.clip(),f(e,II(c,-a,d)),e.fillStyle=o,e.fill("evenodd")),e.beginPath(),f(e,II(c,a)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,a,o){return PI(this,e,a,o)}inXRange(e,a){return PI(this,e,null,a)}inYRange(e,a){return PI(this,null,e,a)}getCenterPoint(e){const{x:a,y:o,base:s,horizontal:c}=this.getProps(["x","y","base","horizontal"],e);return{x:c?(a+s)/2:a,y:c?o:(o+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}_n(uE,"id","bar"),_n(uE,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),_n(uE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var zPe=Object.freeze({__proto__:null,ArcElement:Db,BarElement:uE,LineElement:Qf,PointElement:cE});const ik=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],TH=ik.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function $J(n){return ik[n%ik.length]}function qJ(n){return TH[n%TH.length]}function FPe(n,e){return n.borderColor=$J(e),n.backgroundColor=qJ(e),++e}function NPe(n,e){return n.backgroundColor=n.data.map(()=>$J(e++)),e}function BPe(n,e){return n.backgroundColor=n.data.map(()=>qJ(e++)),e}function UPe(n){let e=0;return(a,o)=>{const s=n.getDatasetMeta(o).controller;s instanceof mg?e=NPe(a,e):s instanceof fx?e=BPe(a,e):s&&(e=FPe(a,e))}}function CH(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function WPe(n){return n&&(n.borderColor||n.backgroundColor)}var VPe={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,a){if(!a.enabled)return;const{data:{datasets:o},options:s}=n.config,{elements:c}=s;if(!a.forceOverride&&(CH(o)||WPe(s)||c&&CH(c)))return;const d=UPe(n);o.forEach(d)}};function GPe(n,e,a,o,s){const c=s.samples||o;if(c>=a)return n.slice(e,e+a);const d=[],f=(a-2)/(c-2);let m=0;const y=e+a-1;let _=e,x,S,T,I,k;for(d[m++]=n[_],x=0;x<c-2;x++){let D=0,L=0,O;const F=Math.floor((x+1)*f)+1+e,B=Math.min(Math.floor((x+2)*f)+1,a)+e,G=B-F;for(O=F;O<B;O++)D+=n[O].x,L+=n[O].y;D/=G,L/=G;const q=Math.floor(x*f)+1+e,X=Math.min(Math.floor((x+1)*f)+1,a)+e,{x:te,y:V}=n[_];for(T=I=-1,O=q;O<X;O++)I=.5*Math.abs((te-D)*(n[O].y-V)-(te-n[O].x)*(L-V)),I>T&&(T=I,S=n[O],k=O);d[m++]=S,_=k}return d[m++]=n[y],d}function HPe(n,e,a,o){let s=0,c=0,d,f,m,y,_,x,S,T,I,k;const D=[],L=e+a-1,O=n[e].x,B=n[L].x-O;for(d=e;d<e+a;++d){f=n[d],m=(f.x-O)/B*o,y=f.y;const G=m|0;if(G===_)y<I?(I=y,x=d):y>k&&(k=y,S=d),s=(c*s+f.x)/++c;else{const q=d-1;if(!ci(x)&&!ci(S)){const X=Math.min(x,S),te=Math.max(x,S);X!==T&&X!==q&&D.push({...n[X],x:s}),te!==T&&te!==q&&D.push({...n[te],x:s})}d>0&&q!==T&&D.push(n[q]),D.push(f),_=G,c=0,I=k=y,x=S=T=d}}return D}function XJ(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function PH(n){n.data.datasets.forEach(e=>{XJ(e)})}function jPe(n,e){const a=e.length;let o=0,s;const{iScale:c}=n,{min:d,max:f,minDefined:m,maxDefined:y}=c.getUserBounds();return m&&(o=Wo(Th(e,c.axis,d).lo,0,a-1)),y?s=Wo(Th(e,c.axis,f).hi+1,o,a)-o:s=a-o,{start:o,count:s}}var $Pe={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,a)=>{if(!a.enabled){PH(n);return}const o=n.width;n.data.datasets.forEach((s,c)=>{const{_data:d,indexAxis:f}=s,m=n.getDatasetMeta(c),y=d||s.data;if(Rb([f,n.options.indexAxis])==="y"||!m.controller.supportsDecimation)return;const _=n.scales[m.xAxisID];if(_.type!=="linear"&&_.type!=="time"||n.options.parsing)return;let{start:x,count:S}=jPe(m,y);const T=a.threshold||4*o;if(S<=T){XJ(s);return}ci(d)&&(s._data=y,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(k){this._data=k}}));let I;switch(a.algorithm){case"lttb":I=GPe(y,x,S,o,a);break;case"min-max":I=HPe(y,x,S,o);break;default:throw new Error(`Unsupported decimation algorithm '${a.algorithm}'`)}s._decimated=I})},destroy(n){PH(n)}};function qPe(n,e,a){const o=n.segments,s=n.points,c=e.points,d=[];for(const f of o){let{start:m,end:y}=f;y=dO(m,y,s);const _=rk(a,s[m],s[y],f.loop);if(!e.segments){d.push({source:f,target:_,start:s[m],end:s[y]});continue}const x=IJ(e,_);for(const S of x){const T=rk(a,c[S.start],c[S.end],S.loop),I=PJ(f,s,T);for(const k of I)d.push({source:k,target:S,start:{[a]:IH(_,T,"start",Math.max)},end:{[a]:IH(_,T,"end",Math.min)}})}}return d}function rk(n,e,a,o){if(o)return;let s=e[n],c=a[n];return n==="angle"&&(s=Vl(s),c=Vl(c)),{property:n,start:s,end:c}}function XPe(n,e){const{x:a=null,y:o=null}=n||{},s=e.points,c=[];return e.segments.forEach(({start:d,end:f})=>{f=dO(d,f,s);const m=s[d],y=s[f];o!==null?(c.push({x:m.x,y:o}),c.push({x:y.x,y:o})):a!==null&&(c.push({x:a,y:m.y}),c.push({x:a,y:y.y}))}),c}function dO(n,e,a){for(;e>n;e--){const o=a[e];if(!isNaN(o.x)&&!isNaN(o.y))break}return e}function IH(n,e,a,o){return n&&e?o(n[a],e[a]):n?n[a]:e?e[a]:0}function YJ(n,e){let a=[],o=!1;return lr(n)?(o=!0,a=n):a=XPe(n,e),a.length?new Qf({points:a,options:{tension:0},_loop:o,_fullLoop:o}):null}function LH(n){return n&&n.fill!==!1}function YPe(n,e,a){let s=n[e].fill;const c=[e];let d;if(!a)return s;for(;s!==!1&&c.indexOf(s)===-1;){if(!Xr(s))return s;if(d=n[s],!d)return!1;if(d.visible)return s;c.push(s),s=d.fill}return!1}function ZPe(n,e,a){const o=e5e(n);if(Ja(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return Xr(s)&&Math.floor(s)===s?KPe(o[0],e,s,a):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function KPe(n,e,a,o){return(n==="-"||n==="+")&&(a=e+a),a===e||a<0||a>=o?!1:a}function JPe(n,e){let a=null;return n==="start"?a=e.bottom:n==="end"?a=e.top:Ja(n)?a=e.getPixelForValue(n.value):e.getBasePixel&&(a=e.getBasePixel()),a}function QPe(n,e,a){let o;return n==="start"?o=a:n==="end"?o=e.options.reverse?e.min:e.max:Ja(n)?o=n.value:o=e.getBaseValue(),o}function e5e(n){const e=n.options,a=e.fill;let o=za(a&&a.target,a);return o===void 0&&(o=!!e.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function t5e(n){const{scale:e,index:a,line:o}=n,s=[],c=o.segments,d=o.points,f=n5e(e,a);f.push(YJ({x:null,y:e.bottom},o));for(let m=0;m<c.length;m++){const y=c[m];for(let _=y.start;_<=y.end;_++)a5e(s,d[_],f)}return new Qf({points:s,options:{}})}function n5e(n,e){const a=[],o=n.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const c=o[s];if(c.index===e)break;c.hidden||a.unshift(c.dataset)}return a}function a5e(n,e,a){const o=[];for(let s=0;s<a.length;s++){const c=a[s],{first:d,last:f,point:m}=i5e(c,e,"x");if(!(!m||d&&f)){if(d)o.unshift(m);else if(n.push(m),!f)break}}n.push(...o)}function i5e(n,e,a){const o=n.interpolate(e,a);if(!o)return{};const s=o[a],c=n.segments,d=n.points;let f=!1,m=!1;for(let y=0;y<c.length;y++){const _=c[y],x=d[_.start][a],S=d[_.end][a];if(Mh(s,x,S)){f=s===x,m=s===S;break}}return{first:f,last:m,point:o}}class ZJ{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,a,o){const{x:s,y:c,radius:d}=this;return a=a||{start:0,end:ur},e.arc(s,c,d,a.end,a.start,!0),!o.bounds}interpolate(e){const{x:a,y:o,radius:s}=this,c=e.angle;return{x:a+Math.cos(c)*s,y:o+Math.sin(c)*s,angle:c}}}function r5e(n){const{chart:e,fill:a,line:o}=n;if(Xr(a))return o5e(e,a);if(a==="stack")return t5e(n);if(a==="shape")return!0;const s=s5e(n);return s instanceof ZJ?s:YJ(s,o)}function o5e(n,e){const a=n.getDatasetMeta(e);return a&&n.isDatasetVisible(e)?a.dataset:null}function s5e(n){return(n.scale||{}).getPointPositionForValue?c5e(n):l5e(n)}function l5e(n){const{scale:e={},fill:a}=n,o=JPe(a,e);if(Xr(o)){const s=e.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function c5e(n){const{scale:e,fill:a}=n,o=e.options,s=e.getLabels().length,c=o.reverse?e.max:e.min,d=QPe(a,e,c),f=[];if(o.grid.circular){const m=e.getPointPositionForValue(0,c);return new ZJ({x:m.x,y:m.y,radius:e.getDistanceFromCenterForValue(d)})}for(let m=0;m<s;++m)f.push(e.getPointPositionForValue(m,d));return f}function LI(n,e,a){const o=r5e(e),{line:s,scale:c,axis:d}=e,f=s.options,m=f.fill,y=f.backgroundColor,{above:_=y,below:x=y}=m||{};o&&s.points.length&&(dC(n,a),u5e(n,{line:s,target:o,above:_,below:x,area:a,scale:c,axis:d}),hC(n))}function u5e(n,e){const{line:a,target:o,above:s,below:c,area:d,scale:f}=e,m=a._loop?"angle":e.axis;n.save(),m==="x"&&c!==s&&(RH(n,o,d.top),kH(n,{line:a,target:o,color:s,scale:f,property:m}),n.restore(),n.save(),RH(n,o,d.bottom)),kH(n,{line:a,target:o,color:c,scale:f,property:m}),n.restore()}function RH(n,e,a){const{segments:o,points:s}=e;let c=!0,d=!1;n.beginPath();for(const f of o){const{start:m,end:y}=f,_=s[m],x=s[dO(m,y,s)];c?(n.moveTo(_.x,_.y),c=!1):(n.lineTo(_.x,a),n.lineTo(_.x,_.y)),d=!!e.pathSegment(n,f,{move:d}),d?n.closePath():n.lineTo(x.x,a)}n.lineTo(e.first().x,a),n.closePath(),n.clip()}function kH(n,e){const{line:a,target:o,property:s,color:c,scale:d}=e,f=qPe(a,o,s);for(const{source:m,target:y,start:_,end:x}of f){const{style:{backgroundColor:S=c}={}}=m,T=o!==!0;n.save(),n.fillStyle=S,d5e(n,d,T&&rk(s,_,x)),n.beginPath();const I=!!a.pathSegment(n,m);let k;if(T){I?n.closePath():DH(n,o,x,s);const D=!!o.pathSegment(n,y,{move:I,reverse:!0});k=I&&D,k||DH(n,o,_,s)}n.closePath(),n.fill(k?"evenodd":"nonzero"),n.restore()}}function d5e(n,e,a){const{top:o,bottom:s}=e.chart.chartArea,{property:c,start:d,end:f}=a||{};c==="x"&&(n.beginPath(),n.rect(d,o,f-d,s-o),n.clip())}function DH(n,e,a,o){const s=e.interpolate(a,o);s&&n.lineTo(s.x,s.y)}var h5e={id:"filler",afterDatasetsUpdate(n,e,a){const o=(n.data.datasets||[]).length,s=[];let c,d,f,m;for(d=0;d<o;++d)c=n.getDatasetMeta(d),f=c.dataset,m=null,f&&f.options&&f instanceof Qf&&(m={visible:n.isDatasetVisible(d),index:d,fill:ZPe(f,d,o),chart:n,axis:c.controller.options.indexAxis,scale:c.vScale,line:f}),c.$filler=m,s.push(m);for(d=0;d<o;++d)m=s[d],!(!m||m.fill===!1)&&(m.fill=YPe(s,d,a.propagate))},beforeDraw(n,e,a){const o=a.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),c=n.chartArea;for(let d=s.length-1;d>=0;--d){const f=s[d].$filler;f&&(f.line.updateControlPoints(c,f.axis),o&&f.fill&&LI(n.ctx,f,c))}},beforeDatasetsDraw(n,e,a){if(a.drawTime!=="beforeDatasetsDraw")return;const o=n.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const c=o[s].$filler;LH(c)&&LI(n.ctx,c,n.chartArea)}},beforeDatasetDraw(n,e,a){const o=e.meta.$filler;!LH(o)||a.drawTime!=="beforeDatasetDraw"||LI(n.ctx,o,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const OH=(n,e)=>{let{boxHeight:a=e,boxWidth:o=e}=n;return n.usePointStyle&&(a=Math.min(a,e),o=n.pointStyleWidth||Math.min(o,e)),{boxWidth:o,boxHeight:a,itemHeight:Math.max(e,a)}},f5e=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class zH extends mu{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a,o){this.maxWidth=e,this.maxHeight=a,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let a=er(e.generateLabels,[this.chart],this)||[];e.filter&&(a=a.filter(o=>e.filter(o,this.chart.data))),e.sort&&(a=a.sort((o,s)=>e.sort(o,s,this.chart.data))),this.options.reverse&&a.reverse(),this.legendItems=a}fit(){const{options:e,ctx:a}=this;if(!e.display){this.width=this.height=0;return}const o=e.labels,s=Ro(o.font),c=s.size,d=this._computeTitleHeight(),{boxWidth:f,itemHeight:m}=OH(o,c);let y,_;a.font=s.string,this.isHorizontal()?(y=this.maxWidth,_=this._fitRows(d,c,f,m)+10):(_=this.maxHeight,y=this._fitCols(d,s,f,m)+10),this.width=Math.min(y,e.maxWidth||this.maxWidth),this.height=Math.min(_,e.maxHeight||this.maxHeight)}_fitRows(e,a,o,s){const{ctx:c,maxWidth:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],y=this.lineWidths=[0],_=s+f;let x=e;c.textAlign="left",c.textBaseline="middle";let S=-1,T=-_;return this.legendItems.forEach((I,k)=>{const D=o+a/2+c.measureText(I.text).width;(k===0||y[y.length-1]+D+2*f>d)&&(x+=_,y[y.length-(k>0?0:1)]=0,T+=_,S++),m[k]={left:0,top:T,row:S,width:D,height:s},y[y.length-1]+=D+f}),x}_fitCols(e,a,o,s){const{ctx:c,maxHeight:d,options:{labels:{padding:f}}}=this,m=this.legendHitBoxes=[],y=this.columnSizes=[],_=d-e;let x=f,S=0,T=0,I=0,k=0;return this.legendItems.forEach((D,L)=>{const{itemWidth:O,itemHeight:F}=p5e(o,a,c,D,s);L>0&&T+F+2*f>_&&(x+=S+f,y.push({width:S,height:T}),I+=S+f,k++,S=T=0),m[L]={left:I,top:T,col:k,width:O,height:F},S=Math.max(S,O),T+=F+f}),x+=S,y.push({width:S,height:T}),x}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:a,options:{align:o,labels:{padding:s},rtl:c}}=this,d=N0(c,this.left,this.width);if(this.isHorizontal()){let f=0,m=_s(o,this.left+s,this.right-this.lineWidths[f]);for(const y of a)f!==y.row&&(f=y.row,m=_s(o,this.left+s,this.right-this.lineWidths[f])),y.top+=this.top+e+s,y.left=d.leftForLtr(d.x(m),y.width),m+=y.width+s}else{let f=0,m=_s(o,this.top+e+s,this.bottom-this.columnSizes[f].height);for(const y of a)y.col!==f&&(f=y.col,m=_s(o,this.top+e+s,this.bottom-this.columnSizes[f].height)),y.top=m,y.left+=this.left+s,y.left=d.leftForLtr(d.x(y.left),y.width),m+=y.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;dC(e,this),this._draw(),hC(e)}}_draw(){const{options:e,columnSizes:a,lineWidths:o,ctx:s}=this,{align:c,labels:d}=e,f=Yr.color,m=N0(e.rtl,this.left,this.width),y=Ro(d.font),{padding:_}=d,x=y.size,S=x/2;let T;this.drawTitle(),s.textAlign=m.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=y.string;const{boxWidth:I,boxHeight:k,itemHeight:D}=OH(d,x),L=function(q,X,te){if(isNaN(I)||I<=0||isNaN(k)||k<0)return;s.save();const V=za(te.lineWidth,1);if(s.fillStyle=za(te.fillStyle,f),s.lineCap=za(te.lineCap,"butt"),s.lineDashOffset=za(te.lineDashOffset,0),s.lineJoin=za(te.lineJoin,"miter"),s.lineWidth=V,s.strokeStyle=za(te.strokeStyle,f),s.setLineDash(za(te.lineDash,[])),d.usePointStyle){const Q={radius:k*Math.SQRT2/2,pointStyle:te.pointStyle,rotation:te.rotation,borderWidth:V},ge=m.xPlus(q,I/2),me=X+S;yJ(s,Q,ge,me,d.pointStyleWidth&&I)}else{const Q=X+Math.max((x-k)/2,0),ge=m.leftForLtr(q,I),me=Ag(te.borderRadius);s.beginPath(),Object.values(me).some(be=>be!==0)?hw(s,{x:ge,y:Q,w:I,h:k,radius:me}):s.rect(ge,Q,I,k),s.fill(),V!==0&&s.stroke()}s.restore()},O=function(q,X,te){Bg(s,te.text,q,X+D/2,y,{strikethrough:te.hidden,textAlign:m.textAlign(te.textAlign)})},F=this.isHorizontal(),B=this._computeTitleHeight();F?T={x:_s(c,this.left+_,this.right-o[0]),y:this.top+_+B,line:0}:T={x:this.left+_,y:_s(c,this.top+B+_,this.bottom-a[0].height),line:0},MJ(this.ctx,e.textDirection);const G=D+_;this.legendItems.forEach((q,X)=>{s.strokeStyle=q.fontColor,s.fillStyle=q.fontColor;const te=s.measureText(q.text).width,V=m.textAlign(q.textAlign||(q.textAlign=d.textAlign)),Q=I+S+te;let ge=T.x,me=T.y;m.setWidth(this.width),F?X>0&&ge+Q+_>this.right&&(me=T.y+=G,T.line++,ge=T.x=_s(c,this.left+_,this.right-o[T.line])):X>0&&me+G>this.bottom&&(ge=T.x=ge+a[T.line].width+_,T.line++,me=T.y=_s(c,this.top+B+_,this.bottom-a[T.line].height));const be=m.x(ge);if(L(be,me,q),ge=OMe(V,ge+I+S,F?ge+Q:this.right,e.rtl),O(m.x(ge),me,q),F)T.x+=Q+_;else if(typeof q.text!="string"){const fe=y.lineHeight;T.y+=KJ(q,fe)+_}else T.y+=G}),TJ(this.ctx,e.textDirection)}drawTitle(){const e=this.options,a=e.title,o=Ro(a.font),s=Ms(a.padding);if(!a.display)return;const c=N0(e.rtl,this.left,this.width),d=this.ctx,f=a.position,m=o.size/2,y=s.top+m;let _,x=this.left,S=this.width;if(this.isHorizontal())S=Math.max(...this.lineWidths),_=this.top+y,x=_s(e.align,x,this.right-S);else{const I=this.columnSizes.reduce((k,D)=>Math.max(k,D.height),0);_=y+_s(e.align,this.top,this.bottom-I-e.labels.padding-this._computeTitleHeight())}const T=_s(f,x,x+S);d.textAlign=c.textAlign(aO(f)),d.textBaseline="middle",d.strokeStyle=a.color,d.fillStyle=a.color,d.font=o.string,Bg(d,a.text,T,_,o)}_computeTitleHeight(){const e=this.options.title,a=Ro(e.font),o=Ms(e.padding);return e.display?a.lineHeight+o.height:0}_getLegendItemAt(e,a){let o,s,c;if(Mh(e,this.left,this.right)&&Mh(a,this.top,this.bottom)){for(c=this.legendHitBoxes,o=0;o<c.length;++o)if(s=c[o],Mh(e,s.left,s.left+s.width)&&Mh(a,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(e){const a=this.options;if(!y5e(e.type,a))return;const o=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,c=f5e(s,o);s&&!c&&er(a.onLeave,[e,s,this],this),this._hoveredItem=o,o&&!c&&er(a.onHover,[e,o,this],this)}else o&&er(a.onClick,[e,o,this],this)}}function p5e(n,e,a,o,s){const c=m5e(o,n,e,a),d=g5e(s,o,e.lineHeight);return{itemWidth:c,itemHeight:d}}function m5e(n,e,a,o){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((c,d)=>c.length>d.length?c:d)),e+a.size/2+o.measureText(s).width}function g5e(n,e,a){let o=n;return typeof e.text!="string"&&(o=KJ(e,a)),o}function KJ(n,e){const a=n.text?n.text.length:0;return e*a}function y5e(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var v5e={id:"legend",_element:zH,start(n,e,a){const o=n.legend=new zH({ctx:n.ctx,options:a,chart:n});ws.configure(n,o,a),ws.addBox(n,o)},stop(n){ws.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,a){const o=n.legend;ws.configure(n,o,a),o.options=a},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,a){const o=e.datasetIndex,s=a.chart;s.isDatasetVisible(o)?(s.hide(o),e.hidden=!0):(s.show(o),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:a,pointStyle:o,textAlign:s,color:c,useBorderRadius:d,borderRadius:f}}=n.legend.options;return n._getSortedDatasetMetas().map(m=>{const y=m.controller.getStyle(a?0:void 0),_=Ms(y.borderWidth);return{text:e[m.index].label,fillStyle:y.backgroundColor,fontColor:c,hidden:!m.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:y.borderColor,pointStyle:o||y.pointStyle,rotation:y.rotation,textAlign:s||y.textAlign,borderRadius:d&&(f||y.borderRadius),datasetIndex:m.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};let hO=class extends mu{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,a){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=a;const s=lr(o.text)?o.text.length:1;this._padding=Ms(o.padding);const c=s*Ro(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=c:this.width=c}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:a,left:o,bottom:s,right:c,options:d}=this,f=d.align;let m=0,y,_,x;return this.isHorizontal()?(_=_s(f,o,c),x=a+e,y=c-o):(d.position==="left"?(_=o+e,x=_s(f,s,a),m=dr*-.5):(_=c-e,x=_s(f,a,s),m=dr*.5),y=s-a),{titleX:_,titleY:x,maxWidth:y,rotation:m}}draw(){const e=this.ctx,a=this.options;if(!a.display)return;const o=Ro(a.font),c=o.lineHeight/2+this._padding.top,{titleX:d,titleY:f,maxWidth:m,rotation:y}=this._drawArgs(c);Bg(e,a.text,0,0,o,{color:a.color,maxWidth:m,rotation:y,textAlign:aO(a.align),textBaseline:"middle",translation:[d,f]})}};function _5e(n,e){const a=new hO({ctx:n.ctx,options:e,chart:n});ws.configure(n,a,e),ws.addBox(n,a),n.titleBlock=a}var b5e={id:"title",_element:hO,start(n,e,a){_5e(n,a)},stop(n){const e=n.titleBlock;ws.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,a){const o=n.titleBlock;ws.configure(n,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const xA=new WeakMap;var x5e={id:"subtitle",start(n,e,a){const o=new hO({ctx:n.ctx,options:a,chart:n});ws.configure(n,o,a),ws.addBox(n,o),xA.set(n,o)},stop(n){ws.removeBox(n,xA.get(n)),xA.delete(n)},beforeUpdate(n,e,a){const o=xA.get(n);ws.configure(n,o,a),o.options=a},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ob={average(n){if(!n.length)return!1;let e,a,o=0,s=0,c=0;for(e=0,a=n.length;e<a;++e){const d=n[e].element;if(d&&d.hasValue()){const f=d.tooltipPosition();o+=f.x,s+=f.y,++c}}return{x:o/c,y:s/c}},nearest(n,e){if(!n.length)return!1;let a=e.x,o=e.y,s=Number.POSITIVE_INFINITY,c,d,f;for(c=0,d=n.length;c<d;++c){const m=n[c].element;if(m&&m.hasValue()){const y=m.getCenterPoint(),_=KR(e,y);_<s&&(s=_,f=m)}}if(f){const m=f.tooltipPosition();a=m.x,o=m.y}return{x:a,y:o}}};function ed(n,e){return e&&(lr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function mh(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function w5e(n,e){const{element:a,datasetIndex:o,index:s}=e,c=n.getDatasetMeta(o).controller,{label:d,value:f}=c.getLabelAndValue(s);return{chart:n,label:d,parsed:c.getParsed(s),raw:n.data.datasets[o].data[s],formattedValue:f,dataset:c.getDataset(),dataIndex:s,datasetIndex:o,element:a}}function FH(n,e){const a=n.chart.ctx,{body:o,footer:s,title:c}=n,{boxWidth:d,boxHeight:f}=e,m=Ro(e.bodyFont),y=Ro(e.titleFont),_=Ro(e.footerFont),x=c.length,S=s.length,T=o.length,I=Ms(e.padding);let k=I.height,D=0,L=o.reduce((B,G)=>B+G.before.length+G.lines.length+G.after.length,0);if(L+=n.beforeBody.length+n.afterBody.length,x&&(k+=x*y.lineHeight+(x-1)*e.titleSpacing+e.titleMarginBottom),L){const B=e.displayColors?Math.max(f,m.lineHeight):m.lineHeight;k+=T*B+(L-T)*m.lineHeight+(L-1)*e.bodySpacing}S&&(k+=e.footerMarginTop+S*_.lineHeight+(S-1)*e.footerSpacing);let O=0;const F=function(B){D=Math.max(D,a.measureText(B).width+O)};return a.save(),a.font=y.string,Fi(n.title,F),a.font=m.string,Fi(n.beforeBody.concat(n.afterBody),F),O=e.displayColors?d+2+e.boxPadding:0,Fi(o,B=>{Fi(B.before,F),Fi(B.lines,F),Fi(B.after,F)}),O=0,a.font=_.string,Fi(n.footer,F),a.restore(),D+=I.width,{width:D,height:k}}function S5e(n,e){const{y:a,height:o}=e;return a<o/2?"top":a>n.height-o/2?"bottom":"center"}function A5e(n,e,a,o){const{x:s,width:c}=o,d=a.caretSize+a.caretPadding;if(n==="left"&&s+c+d>e.width||n==="right"&&s-c-d<0)return!0}function E5e(n,e,a,o){const{x:s,width:c}=a,{width:d,chartArea:{left:f,right:m}}=n;let y="center";return o==="center"?y=s<=(f+m)/2?"left":"right":s<=c/2?y="left":s>=d-c/2&&(y="right"),A5e(y,n,e,a)&&(y="center"),y}function NH(n,e,a){const o=a.yAlign||e.yAlign||S5e(n,a);return{xAlign:a.xAlign||e.xAlign||E5e(n,e,a,o),yAlign:o}}function M5e(n,e){let{x:a,width:o}=n;return e==="right"?a-=o:e==="center"&&(a-=o/2),a}function T5e(n,e,a){let{y:o,height:s}=n;return e==="top"?o+=a:e==="bottom"?o-=s+a:o-=s/2,o}function BH(n,e,a,o){const{caretSize:s,caretPadding:c,cornerRadius:d}=n,{xAlign:f,yAlign:m}=a,y=s+c,{topLeft:_,topRight:x,bottomLeft:S,bottomRight:T}=Ag(d);let I=M5e(e,f);const k=T5e(e,m,y);return m==="center"?f==="left"?I+=y:f==="right"&&(I-=y):f==="left"?I-=Math.max(_,S)+s:f==="right"&&(I+=Math.max(x,T)+s),{x:Wo(I,0,o.width-e.width),y:Wo(k,0,o.height-e.height)}}function wA(n,e,a){const o=Ms(a.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-o.right:n.x+o.left}function UH(n){return ed([],mh(n))}function C5e(n,e,a){return Ip(n,{tooltip:e,tooltipItems:a,type:"tooltip"})}function WH(n,e){const a=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return a?n.override(a):n}const JJ={beforeTitle:hh,title(n){if(n.length>0){const e=n[0],a=e.chart.data.labels,o=a?a.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(o>0&&e.dataIndex<o)return a[e.dataIndex]}return""},afterTitle:hh,beforeBody:hh,beforeLabel:hh,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const a=n.formattedValue;return ci(a)||(e+=a),e},labelColor(n){const a=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:a.borderColor,backgroundColor:a.backgroundColor,borderWidth:a.borderWidth,borderDash:a.borderDash,borderDashOffset:a.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const a=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:a.pointStyle,rotation:a.rotation}},afterLabel:hh,afterBody:hh,beforeFooter:hh,footer:hh,afterFooter:hh};function ul(n,e,a,o){const s=n[e].call(a,o);return typeof s>"u"?JJ[e].call(a,o):s}class ok extends mu{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const a=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&a.options.animation&&o.animations,c=new LJ(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(c)),c}getContext(){return this.$context||(this.$context=C5e(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,a){const{callbacks:o}=a,s=ul(o,"beforeTitle",this,e),c=ul(o,"title",this,e),d=ul(o,"afterTitle",this,e);let f=[];return f=ed(f,mh(s)),f=ed(f,mh(c)),f=ed(f,mh(d)),f}getBeforeBody(e,a){return UH(ul(a.callbacks,"beforeBody",this,e))}getBody(e,a){const{callbacks:o}=a,s=[];return Fi(e,c=>{const d={before:[],lines:[],after:[]},f=WH(o,c);ed(d.before,mh(ul(f,"beforeLabel",this,c))),ed(d.lines,ul(f,"label",this,c)),ed(d.after,mh(ul(f,"afterLabel",this,c))),s.push(d)}),s}getAfterBody(e,a){return UH(ul(a.callbacks,"afterBody",this,e))}getFooter(e,a){const{callbacks:o}=a,s=ul(o,"beforeFooter",this,e),c=ul(o,"footer",this,e),d=ul(o,"afterFooter",this,e);let f=[];return f=ed(f,mh(s)),f=ed(f,mh(c)),f=ed(f,mh(d)),f}_createItems(e){const a=this._active,o=this.chart.data,s=[],c=[],d=[];let f=[],m,y;for(m=0,y=a.length;m<y;++m)f.push(w5e(this.chart,a[m]));return e.filter&&(f=f.filter((_,x,S)=>e.filter(_,x,S,o))),e.itemSort&&(f=f.sort((_,x)=>e.itemSort(_,x,o))),Fi(f,_=>{const x=WH(e.callbacks,_);s.push(ul(x,"labelColor",this,_)),c.push(ul(x,"labelPointStyle",this,_)),d.push(ul(x,"labelTextColor",this,_))}),this.labelColors=s,this.labelPointStyles=c,this.labelTextColors=d,this.dataPoints=f,f}update(e,a){const o=this.options.setContext(this.getContext()),s=this._active;let c,d=[];if(!s.length)this.opacity!==0&&(c={opacity:0});else{const f=Ob[o.position].call(this,s,this._eventPosition);d=this._createItems(o),this.title=this.getTitle(d,o),this.beforeBody=this.getBeforeBody(d,o),this.body=this.getBody(d,o),this.afterBody=this.getAfterBody(d,o),this.footer=this.getFooter(d,o);const m=this._size=FH(this,o),y=Object.assign({},f,m),_=NH(this.chart,o,y),x=BH(o,y,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,c={opacity:1,x:x.x,y:x.y,width:m.width,height:m.height,caretX:f.x,caretY:f.y}}this._tooltipItems=d,this.$context=void 0,c&&this._resolveAnimations().update(this,c),e&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:a})}drawCaret(e,a,o,s){const c=this.getCaretPosition(e,o,s);a.lineTo(c.x1,c.y1),a.lineTo(c.x2,c.y2),a.lineTo(c.x3,c.y3)}getCaretPosition(e,a,o){const{xAlign:s,yAlign:c}=this,{caretSize:d,cornerRadius:f}=o,{topLeft:m,topRight:y,bottomLeft:_,bottomRight:x}=Ag(f),{x:S,y:T}=e,{width:I,height:k}=a;let D,L,O,F,B,G;return c==="center"?(B=T+k/2,s==="left"?(D=S,L=D-d,F=B+d,G=B-d):(D=S+I,L=D+d,F=B-d,G=B+d),O=D):(s==="left"?L=S+Math.max(m,_)+d:s==="right"?L=S+I-Math.max(y,x)-d:L=this.caretX,c==="top"?(F=T,B=F-d,D=L-d,O=L+d):(F=T+k,B=F+d,D=L+d,O=L-d),G=F),{x1:D,x2:L,x3:O,y1:F,y2:B,y3:G}}drawTitle(e,a,o){const s=this.title,c=s.length;let d,f,m;if(c){const y=N0(o.rtl,this.x,this.width);for(e.x=wA(this,o.titleAlign,o),a.textAlign=y.textAlign(o.titleAlign),a.textBaseline="middle",d=Ro(o.titleFont),f=o.titleSpacing,a.fillStyle=o.titleColor,a.font=d.string,m=0;m<c;++m)a.fillText(s[m],y.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+f,m+1===c&&(e.y+=o.titleMarginBottom-f)}}_drawColorBox(e,a,o,s,c){const d=this.labelColors[o],f=this.labelPointStyles[o],{boxHeight:m,boxWidth:y}=c,_=Ro(c.bodyFont),x=wA(this,"left",c),S=s.x(x),T=m<_.lineHeight?(_.lineHeight-m)/2:0,I=a.y+T;if(c.usePointStyle){const k={radius:Math.min(y,m)/2,pointStyle:f.pointStyle,rotation:f.rotation,borderWidth:1},D=s.leftForLtr(S,y)+y/2,L=I+m/2;e.strokeStyle=c.multiKeyBackground,e.fillStyle=c.multiKeyBackground,QR(e,k,D,L),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,QR(e,k,D,L)}else{e.lineWidth=Ja(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const k=s.leftForLtr(S,y),D=s.leftForLtr(s.xPlus(S,1),y-2),L=Ag(d.borderRadius);Object.values(L).some(O=>O!==0)?(e.beginPath(),e.fillStyle=c.multiKeyBackground,hw(e,{x:k,y:I,w:y,h:m,radius:L}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),hw(e,{x:D,y:I+1,w:y-2,h:m-2,radius:L}),e.fill()):(e.fillStyle=c.multiKeyBackground,e.fillRect(k,I,y,m),e.strokeRect(k,I,y,m),e.fillStyle=d.backgroundColor,e.fillRect(D,I+1,y-2,m-2))}e.fillStyle=this.labelTextColors[o]}drawBody(e,a,o){const{body:s}=this,{bodySpacing:c,bodyAlign:d,displayColors:f,boxHeight:m,boxWidth:y,boxPadding:_}=o,x=Ro(o.bodyFont);let S=x.lineHeight,T=0;const I=N0(o.rtl,this.x,this.width),k=function(te){a.fillText(te,I.x(e.x+T),e.y+S/2),e.y+=S+c},D=I.textAlign(d);let L,O,F,B,G,q,X;for(a.textAlign=d,a.textBaseline="middle",a.font=x.string,e.x=wA(this,D,o),a.fillStyle=o.bodyColor,Fi(this.beforeBody,k),T=f&&D!=="right"?d==="center"?y/2+_:y+2+_:0,B=0,q=s.length;B<q;++B){for(L=s[B],O=this.labelTextColors[B],a.fillStyle=O,Fi(L.before,k),F=L.lines,f&&F.length&&(this._drawColorBox(a,e,B,I,o),S=Math.max(x.lineHeight,m)),G=0,X=F.length;G<X;++G)k(F[G]),S=x.lineHeight;Fi(L.after,k)}T=0,S=x.lineHeight,Fi(this.afterBody,k),e.y-=c}drawFooter(e,a,o){const s=this.footer,c=s.length;let d,f;if(c){const m=N0(o.rtl,this.x,this.width);for(e.x=wA(this,o.footerAlign,o),e.y+=o.footerMarginTop,a.textAlign=m.textAlign(o.footerAlign),a.textBaseline="middle",d=Ro(o.footerFont),a.fillStyle=o.footerColor,a.font=d.string,f=0;f<c;++f)a.fillText(s[f],m.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+o.footerSpacing}}drawBackground(e,a,o,s){const{xAlign:c,yAlign:d}=this,{x:f,y:m}=e,{width:y,height:_}=o,{topLeft:x,topRight:S,bottomLeft:T,bottomRight:I}=Ag(s.cornerRadius);a.fillStyle=s.backgroundColor,a.strokeStyle=s.borderColor,a.lineWidth=s.borderWidth,a.beginPath(),a.moveTo(f+x,m),d==="top"&&this.drawCaret(e,a,o,s),a.lineTo(f+y-S,m),a.quadraticCurveTo(f+y,m,f+y,m+S),d==="center"&&c==="right"&&this.drawCaret(e,a,o,s),a.lineTo(f+y,m+_-I),a.quadraticCurveTo(f+y,m+_,f+y-I,m+_),d==="bottom"&&this.drawCaret(e,a,o,s),a.lineTo(f+T,m+_),a.quadraticCurveTo(f,m+_,f,m+_-T),d==="center"&&c==="left"&&this.drawCaret(e,a,o,s),a.lineTo(f,m+x),a.quadraticCurveTo(f,m,f+x,m),a.closePath(),a.fill(),s.borderWidth>0&&a.stroke()}_updateAnimationTarget(e){const a=this.chart,o=this.$animations,s=o&&o.x,c=o&&o.y;if(s||c){const d=Ob[e.position].call(this,this._active,this._eventPosition);if(!d)return;const f=this._size=FH(this,e),m=Object.assign({},d,this._size),y=NH(a,e,m),_=BH(e,m,y,a);(s._to!==_.x||c._to!==_.y)&&(this.xAlign=y.xAlign,this.yAlign=y.yAlign,this.width=f.width,this.height=f.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(e){const a=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(a);const s={width:this.width,height:this.height},c={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const d=Ms(a.padding),f=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;a.enabled&&f&&(e.save(),e.globalAlpha=o,this.drawBackground(c,e,s,a),MJ(e,a.textDirection),c.y+=d.top,this.drawTitle(c,e,a),this.drawBody(c,e,a),this.drawFooter(c,e,a),TJ(e,a.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,a){const o=this._active,s=e.map(({datasetIndex:f,index:m})=>{const y=this.chart.getDatasetMeta(f);if(!y)throw new Error("Cannot find a dataset at index "+f);return{datasetIndex:f,element:y.data[m],index:m}}),c=!dM(o,s),d=this._positionChanged(s,a);(c||d)&&(this._active=s,this._eventPosition=a,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,a,o=!0){if(a&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,c=this._active||[],d=this._getActiveElements(e,c,a,o),f=this._positionChanged(d,e),m=a||!dM(d,c)||f;return m&&(this._active=d,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,a))),m}_getActiveElements(e,a,o,s){const c=this.options;if(e.type==="mouseout")return[];if(!s)return a;const d=this.chart.getElementsAtEventForMode(e,c.mode,c,o);return c.reverse&&d.reverse(),d}_positionChanged(e,a){const{caretX:o,caretY:s,options:c}=this,d=Ob[c.position].call(this,e,a);return d!==!1&&(o!==d.x||s!==d.y)}}_n(ok,"positioners",Ob);var P5e={id:"tooltip",_element:ok,positioners:Ob,afterInit(n,e,a){a&&(n.tooltip=new ok({chart:n,options:a}))},beforeUpdate(n,e,a){n.tooltip&&n.tooltip.initialize(a)},reset(n,e,a){n.tooltip&&n.tooltip.initialize(a)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const a={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...a,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",a)}},afterEvent(n,e){if(n.tooltip){const a=e.replay;n.tooltip.handleEvent(e.event,a,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:JJ},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},I5e=Object.freeze({__proto__:null,Colors:VPe,Decimation:$Pe,Filler:h5e,Legend:v5e,SubTitle:x5e,Title:b5e,Tooltip:P5e});const L5e=(n,e,a,o)=>(typeof e=="string"?(a=n.push(e)-1,o.unshift({index:a,label:e})):isNaN(e)&&(a=null),a);function R5e(n,e,a,o){const s=n.indexOf(e);if(s===-1)return L5e(n,e,a,o);const c=n.lastIndexOf(e);return s!==c?a:s}const k5e=(n,e)=>n===null?null:Wo(Math.round(n),0,e);function VH(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class sk extends Yg{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const a=this._addedLabels;if(a.length){const o=this.getLabels();for(const{index:s,label:c}of a)o[s]===c&&o.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,a){if(ci(e))return null;const o=this.getLabels();return a=isFinite(a)&&o[a]===e?a:R5e(o,e,za(a,e),this._addedLabels),k5e(a,o.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:a}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(o=0),a||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const e=this.min,a=this.max,o=this.options.offset,s=[];let c=this.getLabels();c=e===0&&a===c.length-1?c:c.slice(e,a+1),this._valueRange=Math.max(c.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let d=e;d<=a;d++)s.push({value:d});return s}getLabelForValue(e){return VH.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const a=this.ticks;return e<0||e>a.length-1?null:this.getPixelForValue(a[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}_n(sk,"id","category"),_n(sk,"defaults",{ticks:{callback:VH}});function D5e(n,e){const a=[],{bounds:s,step:c,min:d,max:f,precision:m,count:y,maxTicks:_,maxDigits:x,includeBounds:S}=n,T=c||1,I=_-1,{min:k,max:D}=e,L=!ci(d),O=!ci(f),F=!ci(y),B=(D-k)/(x+1);let G=zG((D-k)/I/T)*T,q,X,te,V;if(G<1e-14&&!L&&!O)return[{value:k},{value:D}];V=Math.ceil(D/G)-Math.floor(k/G),V>I&&(G=zG(V*G/I/T)*T),ci(m)||(q=Math.pow(10,m),G=Math.ceil(G*q)/q),s==="ticks"?(X=Math.floor(k/G)*G,te=Math.ceil(D/G)*G):(X=k,te=D),L&&O&&c&&CMe((f-d)/c,G/1e3)?(V=Math.round(Math.min((f-d)/G,_)),G=(f-d)/V,X=d,te=f):F?(X=L?d:X,te=O?f:te,V=y-1,G=(te-X)/V):(V=(te-X)/G,cx(V,Math.round(V),G/1e3)?V=Math.round(V):V=Math.ceil(V));const Q=Math.max(FG(G),FG(X));q=Math.pow(10,ci(m)?Q:m),X=Math.round(X*q)/q,te=Math.round(te*q)/q;let ge=0;for(L&&(S&&X!==d?(a.push({value:d}),X<d&&ge++,cx(Math.round((X+ge*G)*q)/q,d,GH(d,B,n))&&ge++):X<d&&ge++);ge<V;++ge){const me=Math.round((X+ge*G)*q)/q;if(O&&me>f)break;a.push({value:me})}return O&&S&&te!==f?a.length&&cx(a[a.length-1].value,f,GH(f,B,n))?a[a.length-1].value=f:a.push({value:f}):(!O||te===f)&&a.push({value:te}),a}function GH(n,e,{horizontal:a,minRotation:o}){const s=lu(o),c=(a?Math.sin(s):Math.cos(s))||.001,d=.75*e*(""+n).length;return Math.min(e/c,d)}class vM extends Yg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,a){return ci(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:a,maxDefined:o}=this.getUserBounds();let{min:s,max:c}=this;const d=m=>s=a?s:m,f=m=>c=o?c:m;if(e){const m=md(s),y=md(c);m<0&&y<0?f(0):m>0&&y>0&&d(0)}if(s===c){let m=c===0?1:Math.abs(c*.05);f(c+m),e||d(s-m)}this.min=s,this.max=c}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:a,stepSize:o}=e,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),a=a||11),a&&(s=Math.min(a,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,a=e.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:e.bounds,min:e.min,max:e.max,precision:a.precision,step:a.stepSize,count:a.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:a.minRotation||0,includeBounds:a.includeBounds!==!1},c=this._range||this,d=D5e(s,c);return e.bounds==="ticks"&&lJ(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let a=this.min,o=this.max;if(super.configure(),this.options.offset&&e.length){const s=(o-a)/Math.max(e.length-1,1)/2;a-=s,o+=s}this._startValue=a,this._endValue=o,this._valueRange=o-a}getLabelForValue(e){return $w(e,this.chart.options.locale,this.options.ticks.format)}}class lk extends vM{determineDataLimits(){const{min:e,max:a}=this.getMinMax(!0);this.min=Xr(e)?e:0,this.max=Xr(a)?a:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),a=e?this.width:this.height,o=lu(this.options.ticks.minRotation),s=(e?Math.sin(o):Math.cos(o))||.001,c=this._resolveTickFontOptions(0);return Math.ceil(a/Math.min(40,c.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}_n(lk,"id","linear"),_n(lk,"defaults",{ticks:{callback:uC.formatters.numeric}});const pw=n=>Math.floor(Jf(n)),jm=(n,e)=>Math.pow(10,pw(n)+e);function HH(n){return n/Math.pow(10,pw(n))===1}function jH(n,e,a){const o=Math.pow(10,a),s=Math.floor(n/o);return Math.ceil(e/o)-s}function O5e(n,e){const a=e-n;let o=pw(a);for(;jH(n,e,o)>10;)o++;for(;jH(n,e,o)<10;)o--;return Math.min(o,pw(n))}function z5e(n,{min:e,max:a}){e=Ul(n.min,e);const o=[],s=pw(e);let c=O5e(e,a),d=c<0?Math.pow(10,Math.abs(c)):1;const f=Math.pow(10,c),m=s>c?Math.pow(10,s):0,y=Math.round((e-m)*d)/d,_=Math.floor((e-m)/f/10)*f*10;let x=Math.floor((y-_)/Math.pow(10,c)),S=Ul(n.min,Math.round((m+_+x*Math.pow(10,c))*d)/d);for(;S<a;)o.push({value:S,major:HH(S),significand:x}),x>=10?x=x<15?15:20:x++,x>=20&&(c++,x=2,d=c>=0?1:d),S=Math.round((m+_+x*Math.pow(10,c))*d)/d;const T=Ul(n.max,S);return o.push({value:T,major:HH(T),significand:x}),o}class ck extends Yg{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,a){const o=vM.prototype.parse.apply(this,[e,a]);if(o===0){this._zero=!0;return}return Xr(o)&&o>0?o:null}determineDataLimits(){const{min:e,max:a}=this.getMinMax(!0);this.min=Xr(e)?Math.max(0,e):null,this.max=Xr(a)?Math.max(0,a):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Xr(this._userMin)&&(this.min=e===jm(this.min,0)?jm(this.min,-1):jm(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:a}=this.getUserBounds();let o=this.min,s=this.max;const c=f=>o=e?o:f,d=f=>s=a?s:f;o===s&&(o<=0?(c(1),d(10)):(c(jm(o,-1)),d(jm(s,1)))),o<=0&&c(jm(s,-1)),s<=0&&d(jm(o,1)),this.min=o,this.max=s}buildTicks(){const e=this.options,a={min:this._userMin,max:this._userMax},o=z5e(a,this);return e.bounds==="ticks"&&lJ(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(e){return e===void 0?"0":$w(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Jf(e),this._valueRange=Jf(this.max)-Jf(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Jf(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const a=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+a*this._valueRange)}}_n(ck,"id","logarithmic"),_n(ck,"defaults",{ticks:{callback:uC.formatters.logarithmic,major:{enabled:!0}}});function uk(n){const e=n.ticks;if(e.display&&n.display){const a=Ms(e.backdropPadding);return za(e.font&&e.font.size,Yr.font.size)+a.height}return 0}function F5e(n,e,a){return a=lr(a)?a:[a],{w:jMe(n,e.string,a),h:a.length*e.lineHeight}}function $H(n,e,a,o,s){return n===o||n===s?{start:e-a/2,end:e+a/2}:n<o||n>s?{start:e-a,end:e}:{start:e,end:e+a}}function N5e(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},a=Object.assign({},e),o=[],s=[],c=n._pointLabels.length,d=n.options.pointLabels,f=d.centerPointLabels?dr/c:0;for(let m=0;m<c;m++){const y=d.setContext(n.getPointLabelContext(m));s[m]=y.padding;const _=n.getPointPosition(m,n.drawingArea+s[m],f),x=Ro(y.font),S=F5e(n.ctx,x,n._pointLabels[m]);o[m]=S;const T=Vl(n.getIndexAngle(m)+f),I=Math.round(tO(T)),k=$H(I,_.x,S.w,0,180),D=$H(I,_.y,S.h,90,270);B5e(a,e,T,k,D)}n.setCenterPoint(e.l-a.l,a.r-e.r,e.t-a.t,a.b-e.b),n._pointLabelItems=V5e(n,o,s)}function B5e(n,e,a,o,s){const c=Math.abs(Math.sin(a)),d=Math.abs(Math.cos(a));let f=0,m=0;o.start<e.l?(f=(e.l-o.start)/c,n.l=Math.min(n.l,e.l-f)):o.end>e.r&&(f=(o.end-e.r)/c,n.r=Math.max(n.r,e.r+f)),s.start<e.t?(m=(e.t-s.start)/d,n.t=Math.min(n.t,e.t-m)):s.end>e.b&&(m=(s.end-e.b)/d,n.b=Math.max(n.b,e.b+m))}function U5e(n,e,a){const o=n.drawingArea,{extra:s,additionalAngle:c,padding:d,size:f}=a,m=n.getPointPosition(e,o+s+d,c),y=Math.round(tO(Vl(m.angle+uo))),_=j5e(m.y,f.h,y),x=G5e(y),S=H5e(m.x,f.w,x);return{visible:!0,x:m.x,y:_,textAlign:x,left:S,top:_,right:S+f.w,bottom:_+f.h}}function W5e(n,e){if(!e)return!0;const{left:a,top:o,right:s,bottom:c}=n;return!(Ch({x:a,y:o},e)||Ch({x:a,y:c},e)||Ch({x:s,y:o},e)||Ch({x:s,y:c},e))}function V5e(n,e,a){const o=[],s=n._pointLabels.length,c=n.options,{centerPointLabels:d,display:f}=c.pointLabels,m={extra:uk(c)/2,additionalAngle:d?dr/s:0};let y;for(let _=0;_<s;_++){m.padding=a[_],m.size=e[_];const x=U5e(n,_,m);o.push(x),f==="auto"&&(x.visible=W5e(x,y),x.visible&&(y=x))}return o}function G5e(n){return n===0||n===180?"center":n<180?"left":"right"}function H5e(n,e,a){return a==="right"?n-=e:a==="center"&&(n-=e/2),n}function j5e(n,e,a){return a===90||a===270?n-=e/2:(a>270||a<90)&&(n-=e),n}function $5e(n,e,a){const{left:o,top:s,right:c,bottom:d}=a,{backdropColor:f}=e;if(!ci(f)){const m=Ag(e.borderRadius),y=Ms(e.backdropPadding);n.fillStyle=f;const _=o-y.left,x=s-y.top,S=c-o+y.width,T=d-s+y.height;Object.values(m).some(I=>I!==0)?(n.beginPath(),hw(n,{x:_,y:x,w:S,h:T,radius:m}),n.fill()):n.fillRect(_,x,S,T)}}function q5e(n,e){const{ctx:a,options:{pointLabels:o}}=n;for(let s=e-1;s>=0;s--){const c=n._pointLabelItems[s];if(!c.visible)continue;const d=o.setContext(n.getPointLabelContext(s));$5e(a,d,c);const f=Ro(d.font),{x:m,y,textAlign:_}=c;Bg(a,n._pointLabels[s],m,y+f.lineHeight/2,f,{color:d.color,textAlign:_,textBaseline:"middle"})}}function QJ(n,e,a,o){const{ctx:s}=n;if(a)s.arc(n.xCenter,n.yCenter,e,0,ur);else{let c=n.getPointPosition(0,e);s.moveTo(c.x,c.y);for(let d=1;d<o;d++)c=n.getPointPosition(d,e),s.lineTo(c.x,c.y)}}function X5e(n,e,a,o,s){const c=n.ctx,d=e.circular,{color:f,lineWidth:m}=e;!d&&!o||!f||!m||a<0||(c.save(),c.strokeStyle=f,c.lineWidth=m,c.setLineDash(s.dash),c.lineDashOffset=s.dashOffset,c.beginPath(),QJ(n,a,d,o),c.closePath(),c.stroke(),c.restore())}function Y5e(n,e,a){return Ip(n,{label:a,index:e,type:"pointLabel"})}class zb extends vM{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Ms(uk(this.options)/2),a=this.width=this.maxWidth-e.width,o=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+a/2+e.left),this.yCenter=Math.floor(this.top+o/2+e.top),this.drawingArea=Math.floor(Math.min(a,o)/2)}determineDataLimits(){const{min:e,max:a}=this.getMinMax(!1);this.min=Xr(e)&&!isNaN(e)?e:0,this.max=Xr(a)&&!isNaN(a)?a:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/uk(this.options))}generateTickLabels(e){vM.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((a,o)=>{const s=er(this.options.pointLabels.callback,[a,o],this);return s||s===0?s:""}).filter((a,o)=>this.chart.getDataVisibility(o))}fit(){const e=this.options;e.display&&e.pointLabels.display?N5e(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,a,o,s){this.xCenter+=Math.floor((e-a)/2),this.yCenter+=Math.floor((o-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,a,o,s))}getIndexAngle(e){const a=ur/(this._pointLabels.length||1),o=this.options.startAngle||0;return Vl(e*a+lu(o))}getDistanceFromCenterForValue(e){if(ci(e))return NaN;const a=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*a:(e-this.min)*a}getValueForDistanceFromCenter(e){if(ci(e))return NaN;const a=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-a:this.min+a}getPointLabelContext(e){const a=this._pointLabels||[];if(e>=0&&e<a.length){const o=a[e];return Y5e(this.getContext(),e,o)}}getPointPosition(e,a,o=0){const s=this.getIndexAngle(e)-uo+o;return{x:Math.cos(s)*a+this.xCenter,y:Math.sin(s)*a+this.yCenter,angle:s}}getPointPositionForValue(e,a){return this.getPointPosition(e,this.getDistanceFromCenterForValue(a))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:a,top:o,right:s,bottom:c}=this._pointLabelItems[e];return{left:a,top:o,right:s,bottom:c}}drawBackground(){const{backgroundColor:e,grid:{circular:a}}=this.options;if(e){const o=this.ctx;o.save(),o.beginPath(),QJ(this,this.getDistanceFromCenterForValue(this._endValue),a,this._pointLabels.length),o.closePath(),o.fillStyle=e,o.fill(),o.restore()}}drawGrid(){const e=this.ctx,a=this.options,{angleLines:o,grid:s,border:c}=a,d=this._pointLabels.length;let f,m,y;if(a.pointLabels.display&&q5e(this,d),s.display&&this.ticks.forEach((_,x)=>{if(x!==0){m=this.getDistanceFromCenterForValue(_.value);const S=this.getContext(x),T=s.setContext(S),I=c.setContext(S);X5e(this,T,m,d,I)}}),o.display){for(e.save(),f=d-1;f>=0;f--){const _=o.setContext(this.getPointLabelContext(f)),{color:x,lineWidth:S}=_;!S||!x||(e.lineWidth=S,e.strokeStyle=x,e.setLineDash(_.borderDash),e.lineDashOffset=_.borderDashOffset,m=this.getDistanceFromCenterForValue(a.ticks.reverse?this.min:this.max),y=this.getPointPosition(f,m),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(y.x,y.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,a=this.options,o=a.ticks;if(!o.display)return;const s=this.getIndexAngle(0);let c,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((f,m)=>{if(m===0&&!a.reverse)return;const y=o.setContext(this.getContext(m)),_=Ro(y.font);if(c=this.getDistanceFromCenterForValue(this.ticks[m].value),y.showLabelBackdrop){e.font=_.string,d=e.measureText(f.label).width,e.fillStyle=y.backdropColor;const x=Ms(y.backdropPadding);e.fillRect(-d/2-x.left,-c-_.size/2-x.top,d+x.width,_.size+x.height)}Bg(e,f.label,0,-c,_,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),e.restore()}drawTitle(){}}_n(zb,"id","radialLinear"),_n(zb,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:uC.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),_n(zb,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),_n(zb,"descriptors",{angleLines:{_fallback:"grid"}});const pC={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},gl=Object.keys(pC);function qH(n,e){return n-e}function XH(n,e){if(ci(e))return null;const a=n._adapter,{parser:o,round:s,isoWeekday:c}=n._parseOpts;let d=e;return typeof o=="function"&&(d=o(d)),Xr(d)||(d=typeof o=="string"?a.parse(d,o):a.parse(d)),d===null?null:(s&&(d=s==="week"&&(s_(c)||c===!0)?a.startOf(d,"isoWeek",c):a.startOf(d,s)),+d)}function YH(n,e,a,o){const s=gl.length;for(let c=gl.indexOf(n);c<s-1;++c){const d=pC[gl[c]],f=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((a-e)/(f*d.size))<=o)return gl[c]}return gl[s-1]}function Z5e(n,e,a,o,s){for(let c=gl.length-1;c>=gl.indexOf(a);c--){const d=gl[c];if(pC[d].common&&n._adapter.diff(s,o,d)>=e-1)return d}return gl[a?gl.indexOf(a):0]}function K5e(n){for(let e=gl.indexOf(n)+1,a=gl.length;e<a;++e)if(pC[gl[e]].common)return gl[e]}function ZH(n,e,a){if(!a)n[e]=!0;else if(a.length){const{lo:o,hi:s}=nO(a,e),c=a[o]>=e?a[o]:a[s];n[c]=!0}}function J5e(n,e,a,o){const s=n._adapter,c=+s.startOf(e[0].value,o),d=e[e.length-1].value;let f,m;for(f=c;f<=d;f=+s.add(f,1,o))m=a[f],m>=0&&(e[m].major=!0);return e}function KH(n,e,a){const o=[],s={},c=e.length;let d,f;for(d=0;d<c;++d)f=e[d],s[f]=d,o.push({value:f,major:!1});return c===0||!a?o:J5e(n,o,s,a)}class mw extends Yg{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,a={}){const o=e.time||(e.time={}),s=this._adapter=new sCe._date(e.adapters.date);s.init(a),lx(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(e),this._normalized=a.normalized}parse(e,a){return e===void 0?null:XH(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,a=this._adapter,o=e.time.unit||"day";let{min:s,max:c,minDefined:d,maxDefined:f}=this.getUserBounds();function m(y){!d&&!isNaN(y.min)&&(s=Math.min(s,y.min)),!f&&!isNaN(y.max)&&(c=Math.max(c,y.max))}(!d||!f)&&(m(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&m(this.getMinMax(!1))),s=Xr(s)&&!isNaN(s)?s:+a.startOf(Date.now(),o),c=Xr(c)&&!isNaN(c)?c:+a.endOf(Date.now(),o)+1,this.min=Math.min(s,c-1),this.max=Math.max(s+1,c)}_getLabelBounds(){const e=this.getLabelTimestamps();let a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.length&&(a=e[0],o=e[e.length-1]),{min:a,max:o}}buildTicks(){const e=this.options,a=e.time,o=e.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const c=this.min,d=this.max,f=RMe(s,c,d);return this._unit=a.unit||(o.autoSkip?YH(a.minUnit,this.min,this.max,this._getLabelCapacity(c)):Z5e(this,f.length,a.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:K5e(this._unit),this.initOffsets(s),e.reverse&&f.reverse(),KH(this,f,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let a=0,o=0,s,c;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?a=1-s:a=(this.getDecimalForValue(e[1])-s)/2,c=this.getDecimalForValue(e[e.length-1]),e.length===1?o=c:o=(c-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;a=Wo(a,0,d),o=Wo(o,0,d),this._offsets={start:a,end:o,factor:1/(a+1+o)}}_generate(){const e=this._adapter,a=this.min,o=this.max,s=this.options,c=s.time,d=c.unit||YH(c.minUnit,a,o,this._getLabelCapacity(a)),f=za(s.ticks.stepSize,1),m=d==="week"?c.isoWeekday:!1,y=s_(m)||m===!0,_={};let x=a,S,T;if(y&&(x=+e.startOf(x,"isoWeek",m)),x=+e.startOf(x,y?"day":d),e.diff(o,a,d)>1e5*f)throw new Error(a+" and "+o+" are too far apart with stepSize of "+f+" "+d);const I=s.ticks.source==="data"&&this.getDataTimestamps();for(S=x,T=0;S<o;S=+e.add(S,f,d),T++)ZH(_,S,I);return(S===o||s.bounds==="ticks"||T===1)&&ZH(_,S,I),Object.keys(_).sort(qH).map(k=>+k)}getLabelForValue(e){const a=this._adapter,o=this.options.time;return o.tooltipFormat?a.format(e,o.tooltipFormat):a.format(e,o.displayFormats.datetime)}format(e,a){const s=this.options.time.displayFormats,c=this._unit,d=a||s[c];return this._adapter.format(e,d)}_tickFormatFunction(e,a,o,s){const c=this.options,d=c.ticks.callback;if(d)return er(d,[e,a,o],this);const f=c.time.displayFormats,m=this._unit,y=this._majorUnit,_=m&&f[m],x=y&&f[y],S=o[a],T=y&&x&&S&&S.major;return this._adapter.format(e,s||(T?x:_))}generateTickLabels(e){let a,o,s;for(a=0,o=e.length;a<o;++a)s=e[a],s.label=this._tickFormatFunction(s.value,a,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const a=this._offsets,o=this.getDecimalForValue(e);return this.getPixelForDecimal((a.start+o)*a.factor)}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return this.min+o*(this.max-this.min)}_getLabelSize(e){const a=this.options.ticks,o=this.ctx.measureText(e).width,s=lu(this.isHorizontal()?a.maxRotation:a.minRotation),c=Math.cos(s),d=Math.sin(s),f=this._resolveTickFontOptions(0).size;return{w:o*c+f*d,h:o*d+f*c}}_getLabelCapacity(e){const a=this.options.time,o=a.displayFormats,s=o[a.unit]||o.millisecond,c=this._tickFormatFunction(e,0,KH(this,[e],this._majorUnit),s),d=this._getLabelSize(c),f=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return f>0?f:1}getDataTimestamps(){let e=this._cache.data||[],a,o;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(a=0,o=s.length;a<o;++a)e=e.concat(s[a].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let a,o;if(e.length)return e;const s=this.getLabels();for(a=0,o=s.length;a<o;++a)e.push(XH(this,s[a]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return dJ(e.sort(qH))}}_n(mw,"id","time"),_n(mw,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function SA(n,e,a){let o=0,s=n.length-1,c,d,f,m;a?(e>=n[o].pos&&e<=n[s].pos&&({lo:o,hi:s}=Th(n,"pos",e)),{pos:c,time:f}=n[o],{pos:d,time:m}=n[s]):(e>=n[o].time&&e<=n[s].time&&({lo:o,hi:s}=Th(n,"time",e)),{time:c,pos:f}=n[o],{time:d,pos:m}=n[s]);const y=d-c;return y?f+(m-f)*(e-c)/y:f}class dk extends mw{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),a=this._table=this.buildLookupTable(e);this._minPos=SA(a,this.min),this._tableRange=SA(a,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:a,max:o}=this,s=[],c=[];let d,f,m,y,_;for(d=0,f=e.length;d<f;++d)y=e[d],y>=a&&y<=o&&s.push(y);if(s.length<2)return[{time:a,pos:0},{time:o,pos:1}];for(d=0,f=s.length;d<f;++d)_=s[d+1],m=s[d-1],y=s[d],Math.round((_+m)/2)!==y&&c.push({time:y,pos:d/(f-1)});return c}_generate(){const e=this.min,a=this.max;let o=super.getDataTimestamps();return(!o.includes(e)||!o.length)&&o.splice(0,0,e),(!o.includes(a)||o.length===1)&&o.push(a),o.sort((s,c)=>s-c)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const a=this.getDataTimestamps(),o=this.getLabelTimestamps();return a.length&&o.length?e=this.normalize(a.concat(o)):e=a.length?a:o,e=this._cache.all=e,e}getDecimalForValue(e){return(SA(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const a=this._offsets,o=this.getDecimalForPixel(e)/a.factor-a.end;return SA(this._table,o*this._tableRange+this._minPos,!0)}}_n(dk,"id","timeseries"),_n(dk,"defaults",mw.defaults);var Q5e=Object.freeze({__proto__:null,CategoryScale:sk,LinearScale:lk,LogarithmicScale:ck,RadialLinearScale:zb,TimeScale:mw,TimeSeriesScale:dk});const e4e=[oCe,zPe,I5e,Q5e],eQ="label";function JH(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function t4e(n,e){const a=n.options;a&&e&&Object.assign(a,e)}function tQ(n,e){n.labels=e}function nQ(n,e){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:eQ;const o=[];n.datasets=e.map(s=>{const c=n.datasets.find(d=>d[a]===s[a]);return!c||!s.data||o.includes(c)?{...s}:(o.push(c),Object.assign(c,s),c)})}function n4e(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eQ;const a={labels:[],datasets:[]};return tQ(a,n.labels),nQ(a,n.datasets,e),a}function a4e(n,e){const{height:a=150,width:o=300,redraw:s=!1,datasetIdKey:c,type:d,data:f,options:m,plugins:y=[],fallbackContent:_,updateMode:x,...S}=n,T=re.useRef(null),I=re.useRef(),k=()=>{T.current&&(I.current=new Xw(T.current,{type:d,data:n4e(f,c),options:m&&{...m},plugins:y}),JH(e,I.current))},D=()=>{JH(e,null),I.current&&(I.current.destroy(),I.current=null)};return re.useEffect(()=>{!s&&I.current&&m&&t4e(I.current,m)},[s,m]),re.useEffect(()=>{!s&&I.current&&tQ(I.current.config.data,f.labels)},[s,f.labels]),re.useEffect(()=>{!s&&I.current&&f.datasets&&nQ(I.current.config.data,f.datasets,c)},[s,f.datasets]),re.useEffect(()=>{I.current&&(s?(D(),setTimeout(k)):I.current.update(x))},[s,m,f.labels,f.datasets,x]),re.useEffect(()=>{I.current&&(D(),setTimeout(k))},[d]),re.useEffect(()=>(k(),()=>D()),[]),ee("canvas",{...Object.assign({ref:T,role:"img",height:a,width:o},S),children:_})}const i4e=re.forwardRef(a4e);function aQ(n,e){return Xw.register(e),re.forwardRef((a,o)=>ee(i4e,{...Object.assign({},a,{ref:o,type:n})}))}const iQ=aQ("line",hx),r4e=aQ("radar",px);var fO={},rQ={exports:{}};(function(n){function e(a){return a&&a.__esModule?a:{default:a}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(rQ);var oQ=rQ.exports,RI={};const o4e=cj(Hfe);var QH;function sQ(){return QH||(QH=1,function(n){"use client";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=o4e}(RI)),RI}const lQ=cj(zde);var s4e=oQ;Object.defineProperty(fO,"__esModule",{value:!0});var pO=fO.default=void 0,l4e=s4e(sQ()),c4e=lQ,u4e=(0,l4e.default)((0,c4e.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");pO=fO.default=u4e;var mO={},d4e=oQ;Object.defineProperty(mO,"__esModule",{value:!0});var gO=mO.default=void 0,h4e=d4e(sQ()),f4e=lQ,p4e=(0,h4e.default)((0,f4e.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");gO=mO.default=p4e;const m4e=({cities:n,value:e,onChange:a})=>{const[o,s]=re.useState(null),c=!!o,d=m=>{console.log("click"),s(m.currentTarget)},f=()=>{console.log("close"),s(null)};return Je("div",{style:{width:220,marginTop:0},children:[ee(Or,{onClick:d,endIcon:c?ee(gO,{}):ee(pO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),ee(Iw,{anchorEl:o,open:c,onClose:f,children:Object.entries(n).map(([m,y])=>ee(J0,{selected:y===e,onClick:()=>{f(),a(m)},children:y},m))})]})},Ec={DUBAI:"Dubai",EXPO_CITY_DUBAI:"Expo City Dubai",VALPARAISO:"Valparaiso",DAR_ES_SALAAM:"Dar es Salaam",ADONI:"Adoni",NATAL:"Natal",BRAZZAVILLE:"Brazzaville",ALMATY:"Almaty",CAPE_TOWN:"Cape Town",MEXICO_CITY:"Mexico City",JAKARTA:"Jakarta",PANAMA:"Panama",AMMAN:"Amman",BANGKOK:"Bangkok",COLOMBO:"Colombo"},g4e=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":"Low","Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],dE=["Very low","Low","Average","Strong","Very strong"],cQ=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],y4e=n=>{const e=document.createElement("canvas"),a=e.getContext("2d"),o=e.width/2,s=e.height/2,c=15,d=23;return a.beginPath(),a.arc(o,s,c,0,2*Math.PI,!1),a.fillStyle=n,a.fill(),a.beginPath(),a.arc(o,s,d,0,2*Math.PI,!1),a.lineWidth=1,a.strokeStyle=n,a.stroke(),e},v4e=n=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:n.map(e=>Ec[e]),offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{type:"category",offset:!0,labels:dE,reverse:!0,ticks:{color:cQ,font:{size:13},padding:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),_4e=(n,e)=>{const c=n.map(f=>Ec[f]).map(f=>g4e.find(m=>m.City===f)).map(f=>f[e]).map(f=>dE[f-1]),d=f=>{const m=dE.indexOf(f);if(m===-1)throw new Error("Invalid value");return cQ[m]};return{xLabels:n.map(f=>Ec[f]),yLabels:dE,datasets:c.map((f,m)=>({label:f,data:new Array(6).fill(null).map((y,_)=>m===_?f:null),pointStyle:y4e(d(f)),showLine:!1}))}},b4e=({category:n})=>{const[e,a]=$l.useState(Object.keys(Ec).slice(0,6)),o=v4e(e),s=_4e(e,n);return Je("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[ee(iQ,{width:"1260px",height:"330px",options:o,data:s}),ee("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:e.map((c,d)=>ee(m4e,{cities:Ec,onChange:f=>{a(m=>{const y=[...m];return y[d]=f,y})},value:Ec[c]},c))})]})},ej=({label:n,color:e,cities:a,position:o,onClick:s})=>{const[c,d]=re.useState(n),[f,m]=re.useState(null),y=!!f,_=S=>{m(S.currentTarget)},x=()=>{m(null)};return Je("div",{children:[ee(Or,{onClick:_,children:Je("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[ee("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),ee("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:c}),o!==0&&ee("div",{style:{marginLeft:"1vh"},children:ee("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),ee(Iw,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:f,open:y,onClose:x,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:a==null?void 0:a.map((S,T)=>ee(J0,{onClick:()=>{d(S),s==null||s(S,o),x()},children:S},S))})]})},Yw=Kr()({root:{padding:0,margin:0,color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),x4e=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.5469712757516376},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:1.378},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:4,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:5,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:0},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",value:1,natural_value:"no"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:1,natural_value:"no"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Panama",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:127},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:1,natural_value:"no"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:5,natural_value:"yes"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]}],w4e=n=>{const e=n.split(" "),a=[];let o="";for(let s=0;s<e.length;s++)o.length+e[s].length<30?o+=e[s]+" ":(a.push(o),o=e[s]+" ");return a.push(o),a},tj=(n,e)=>x4e.find(a=>a.city===n).data.filter(a=>a.category===e).map(({category:a,indicator:o,value:s})=>({category:a,indicator:o,value:s})),bb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],S4e=({city:n,category:e})=>{Yw();const a=nJ.filter(_=>n!==_),[o,s]=re.useState(a.slice(0,5)),c=tj(n,e),d=o.map(_=>tj(_,e)),f={labels:c.map(_=>w4e(_.indicator)),datasets:[c,...d].map((_,x)=>({label:x?o[x-1]:n,backgroundColor:"transparent",borderWidth:x===0?8:1,borderColor:bb[x],pointBackgroundColor:bb[x],pointBorderColor:bb[x],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:_.map(S=>S.value)}))},m=(_,x)=>{s(S=>{const T=[...S];return T[x-1]=_,T})};return Je(vl,{children:[ee(r4e,{style:{position:"absolute",top:"50%",right:"4vh",transform:"translateY(-50%)",boxSizing:"border-box",display:"block",height:805,width:1e3},data:f,options:{responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},suggestedMin:0}}}}),Je("div",{style:{boxSizing:"border-box",position:"absolute",left:"8vh",top:"30vh"},children:[ee(ej,{label:n,color:bb[0],position:0}),o.map((_,x)=>ee(ej,{label:_,color:bb[x+1],cities:a,position:x+1,onClick:m},_))]})]})},A4e=({cities:n,value:e,onChange:a})=>{const[o,s]=re.useState(null),c=!!o,d=m=>{s(m.currentTarget)},f=()=>{s(null)};return Je("div",{style:{width:220,marginTop:0},children:[ee(Or,{onClick:d,endIcon:c?ee(gO,{}):ee(pO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),ee(Iw,{anchorEl:o,open:c,onClose:f,children:Object.entries(n).map(([m,y])=>ee(J0,{selected:y===e,onClick:()=>{f(),a(m)},children:y},m))})]})},E4e=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.5469712757516376},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:1.378},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:4,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:5,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:0},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",value:1,natural_value:"no"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:1,natural_value:"no"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Panama",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:127},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:1,natural_value:"no"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:5,natural_value:"yes"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]}],M4e=["Very low","Low","Average","Strong","Very strong"],T4e=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],C4e=n=>{const e=document.createElement("canvas"),a=e.getContext("2d"),o=e.width/2,s=e.height/2,c=15,d=23;return a.beginPath(),a.arc(o,s,c,0,2*Math.PI,!1),a.fillStyle=n,a.fill(),a.beginPath(),a.arc(o,s,d,0,2*Math.PI,!1),a.lineWidth=1,a.strokeStyle=n,a.stroke(),e},P4e=n=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{labels:n.map(e=>Ec[e]),offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{suggestedMin:0,ticks:{color:"rgba(255, 255, 255, 0.3)",font:{size:13},padding:10,maxTicksLimit:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),I4e=(n,e,a)=>{const s=n.map(d=>Ec[d]).map(d=>E4e.find(f=>f.city===d)).map(d=>({...d.data.find(f=>f.category===e&&f.indicator===a),city:d.city})),c=d=>T4e[d-1];return{xLabels:n.map(d=>Ec[d]),yLabels:M4e,datasets:s.map((d,f)=>({label:d.city,data:new Array(6).fill(null).map((m,y)=>f===y?d.natural_value:null),pointStyle:C4e(c(d.value)),showLine:!1}))}},kI=({category:n,indicator:e})=>{const[a,o]=$l.useState(Object.keys(Ec).slice(0,6)),s=P4e(a),c=I4e(a,n,e);return Je("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[ee(iQ,{width:"1260px",height:"330px",options:s,data:c}),ee("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:a.map((d,f)=>ee(A4e,{cities:Ec,onChange:m=>{o(y=>{const _=[...y];return _[f]=m,_})},value:Ec[d]},d))})]})},nj={Air_pollution:`The Air Pollution category assesses the levels of air pollutants impacting the urban environment and residents. Air pollution directly affects public health, quality of life, and the environment in cities. In the Global South, this issue is particularly acute for many urban areas as industrialization and motorization rates here are still on the rise.\r
\r
We measure the concentration of the most important pollutants based on World Health Organization guidelines[2]. These indicators help us to evaluate the extent of air pollution and its impact on human health and the environment, enabling cities to take informed actions to reduce pollution.`,Water_pollution:`The Water Pollution category evaluates the quality of water sources and the impact of pollution on the urban environment and communities. Adequate clean water supply is essential for public health and the natural environment. Particularly, in the Global South, where access to safe water is often limited, while pollution sources are diverse.\r
\r
We measure the levels of contamination from pollutants, industrial waste, and inadequate sanitation based on the WHO standards while also evaluating the effectiveness of local efforts to mitigate water pollution and safeguard the health and well-being of their communities. These indicators help us to determine the extent of water pollution and the effectiveness of purification methods, gauging efforts to ensure clean and safe water.`,Land_use_and_waste:`The Land Use and Waste category assesses how cities manage land resources and handle waste. The issue of land and waste directly impacts urban development and environmental sustainability. Rapid urbanization and resource constraints in the Global South pose distinct challenges to land use and waste management. The category also evaluates a city's efforts to expand green spaces and promote environmental sustainability. Urban greening directly affects livability, health, and resilience to climate change. Vegetation cover mitigates the effect of urban heat island cooling the environment. In the Global South, where rapid urbanization and environmental challenges it causes lead to significant inequalities, greening initiatives are crucial for improving quality of life.\r
\r
We measure land use practices, waste management methods, recycling rates, as well as waste disposal practices based on extensive scientific research. These indicators are designed to evaluate sustainable land management, waste reduction, and environmental protection that guide cities toward eco-friendliness.`,Natural_disaster_hazards:`The Natural Disaster Hazards category aims to assess a city's vulnerability to natural disasters and its capacity to mitigate their impact. For cities around the world, the problem of natural disasters is particularly acute due to higher population densities that multiply the damage caused by natural hazards. In the environmental and social settings of the Global South, this often becomes a key challenge for community safety.\r
\r
We measure resilience by evaluating natural conditions that can exacerbate the situation, as well as past records of extreme events including their type and volume of damage caused based on recent scientific studies. These indicators evaluate the impact of natural disasters on communities and overall sustainability.`,Water_availability:`The Water Availability category evaluates access to water resources. Water scarcity issues and population growth in many urban areas of the Global South make this issue essential for ensuring equitable access to drinking and technical water.\r
\r
It assesses the adequacy of water supply, and its affordability considering the cities' capacity to ensure equitable and sustainable access to water and sanitation services for their residents. These indicators reflect how cities address water security, resilience, and equitable access to such a vital resource.`,Food_availability:`The Food Availability category evaluates access to and availability of food resources. This category is often crucial in the Global South due to food security concerns, vulnerable populations, and sustainability challenges. This category is essential to consider as it measures equitable access to nutritious food addressing hunger and malnutrition.\r
\r
We capture and measure data on food supply chains and access to food. This assessment is designed to measure the cities' capacity to ensure a consistent and accessible food supply, as well as their ability to address hunger and nutritional requirements for their residents.`,Energy_availability:`The Energy Availability category specifically targets challenges related to ensuring reliable energy access, affordability, and sustainability of generation sources. It is essential in the Global South due to energy access disparities, sustainability challenges, and rapid economic development.\r
\r
We capture and measure data on energy infrastructure, electricity access, energy efficiency, and renewable energy adoption. This evaluation is intended to measure the cities' capacity to provide affordable and renewable energy for their residents, while also promoting environmental sustainability.`,Health:`The Health category assesses a city's healthcare infrastructure and residents access to healthcare. It centers on the distinct healthcare challenges faced by urban areas in the Global South, including intrinsic burdens of diseases that impact public health, healthcare infrastructure, and overall well-being. \r
\r
We capture and measure data on healthcare access, disease prevention, healthcare quality, and public health outcomes based on the extensive SDG-related WHO guidelines. This evaluation is crafted to assess the cities ability to deliver quality healthcare, reduce mortality rates, and enhance the well-being of residents, while also addressing their unique healthcare needs and challenges.`,Education:`The Education category assesses a citys commitment to high-quality education, access to schools, and educational outcomes. It addresses the unique educational challenges faced by the cities in the Global South due to their generally higher share of the younger population, including issues related to access, quality, and educational attainment.\r
\r
We capture and measure data on educational infrastructure, enrollment rates, as well as literacy and numeracy skills in line with the UN recommendations. This assessment aims to evaluate the cities capacity to provide accessible, high-quality education, promote educational attainment, and offer lifelong learning opportunities for their residents while addressing their specific educational needs and challenges.`,Wealth:`The Wealth category assesses a citys economic well-being and income distribution. This issue is crucial for the growing economies in the Global South facing vast disparities and poverty challenges.\r
\r
We capture and measure data on income distribution, poverty rates, and economic opportunities based on international practices. This assessment aims to evaluate the cities' capacity to address economic disparities, reduce poverty, and enhance economic well-being for their residents while considering their unique economic challenges.`,Safety:`The Safety category addresses issues related to road safety, crime, and overall safety. These challenges are inherent to cities of the Global South experiencing population growth, poverty, and increasing motorization rates. \r
\r
We capture and measure data on crime and traffic accident rates and law enforcement effectiveness based on substantive scientific research. This assessment aims to evaluate the cities ability to enhance safety, reduce crime, and promote overall security for their residents while addressing their safety challenges and concerns.`,Livability:`The Livability category assesses a city's quality of life, infrastructure, and overall living conditions. These challenges are quite acute for the rapidly changing urban environment in the Global South where authorities seek to improve living conditions and have to focus on infrastructure development.\r
\r
We capture and measure data on housing and infrastructure quality standards, communications, and basic healthcare service availability as well as public perception of this complex category. This evaluation is designed to assess the cities' efforts in promoting environmentally sustainable and livable urban environments, addressing infrastructure and accessibility challenges, and enhancing the overall quality of life for their residents.`,Transport:`The Transport category assesses a city's transportation and mobility infrastructure and accessibility. We address here the specific transportation challenges and infrastructure issues that rapidly urbanizing areas in the Global South face, including issues related to traffic congestion, accessibility, and public transportation.\r
\r
We capture and measure data on the outcomes of transport policies regarding public transit infrastructure, its accessibility, affordability and performance, traffic congestion, and green initiatives based on broad scientific evidence. This assessment aims to evaluate the cities transportation system performance that defines the mobility of their residents.`,Inclusion:`The Inclusion category assesses a citys commitment to inclusivity and equity, ensuring that all residents have equal access to opportunities and services. This category is crucial in the Global South as it addresses social disparities, discrimination, and social justice issues.\r
\r
We capture and measure data on social equity, access to education and healthcare, economic opportunities, and the presence of anti-discrimination policies based on extensive research. This assessment aims to evaluate the cities performance regarding social inclusion, gender equity, and support for groups at risk.`,Accountability:`The Accountability category assesses a citys commitment to transparency, governance, and accountability. This category is crucial in the Global South where the potential for change is maximized through the promotion of good governance and responsible public resources use.\r
\r
This assessment aims to evaluate cities commitment to transparent governance, accountability in resource allocation, and overall effective administration. This category shows how cities ensure responsible resource management, citizens trust, and effective governance.`,City_budget:`The City Budget category evaluates a citys financial management, allocation of funds, and budget transparency. The topic is of higher importance for the Global South as it encompasses the stability of government financial planning.\r
\r
We capture and measure data on budget allocations to essential services, financial transparency, fiscal responsibility, and adherence to financial sustainability principles. This assessment aims to evaluate the cities' capacity to manage their budgets effectively, ensure fiscal stability, and plan for long-term financial sustainability.`,SME:`The SME category evaluates a city's support for and the impact of SMEs on the local economy. SMEs in the Global South are a significant source of employment and economic growth. It is crucial for fostering local businesses and reducing unemployment. \r
\r
We capture and measure data on employment generation, business sustainability, and innovation related to SMEs and entrepreneurship. This assessment aims to evaluate the cities efforts in promoting a vibrant entrepreneurial ecosystem, supporting small and medium-sized enterprises.`,Public_services:`The Public Services category assesses the quality and accessibility of essential government and municipal services. This category is crucial in the Global South due to disparities in access to services. It is essential for improving living standards, health, and social equity.\r
\r
We capture and measure data on the availability and performance of key government services. This evaluation aims to represent the citys commitment to public service digitalization, efficient emergency response, and citizen engagement in the context of government services`,Sustainability_commitment:`The Sustainability Commitment category assesses a city's dedication and efforts to promote sustainability and environmental responsibility. This category is critical in the Global South because of the more pronounced need to prioritize sustainable development, resilience, and environmental stewardship.\r
\r
We capture and measure a city's sustainability policies, initiatives, and their effectiveness. This assessment aims to evaluate the cities' dedication to sustainable development, ESG principles, and the UN Sustainable Development Goals to build community resilience.`},uQ=({city:n,category:e,setClickedCategory:a})=>{const{classes:o}=qEe(),[s,c]=re.useState(!0),d=()=>{c(!s)},f=e.replace(" ","_"),m=Object.keys(nj).includes(f)?nj[f]:"No description available";return console.log("category",e),Je("div",{className:o.backgroundWrapper,children:[Je("div",{onClick:()=>{a(null)},className:o.returnBack,children:[ee("img",{className:o.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),ee(Ha,{className:o.returnBackText,children:"Back to Urban resilience index"})]}),Je("div",{className:o.content,children:[Je("div",{className:o.blueSection,children:[ee(YEe,{title:e,text:m}),ee(b4e,{category:e})]}),Je("div",{className:o.whiteSection,children:[Je("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:[Je("div",{className:o.title,style:{color:"#000000",fontFamily:"SuisseIntl-Light"},children:["Indicators of"," "]}),ee("div",{className:o.title,style:{color:"#2D67FF"},children:e})]}),ee(S4e,{category:e,city:n})]}),(e==="Wealth"||e==="Water availability")&&ee("div",{className:o.blueSection,children:e==="Wealth"?Je(vl,{children:[Je("div",{style:{position:"absolute",top:"4vh",left:"8vh",display:"flex",flexDirection:"row",alignItems:"left",justifyContent:"left",gap:"1vw"},children:[ee("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{cursor:"pointer"},onClick:d}),ee("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{cursor:"pointer",transform:"rotate(180deg)"},onClick:d})]}),s?Je(vl,{children:[ee("div",{style:{position:"absolute",top:"16vh",left:"8vh"},children:Je("div",{className:o.title,style:{fontSize:"6vh"},children:["Disposable monthly income",ee("br",{}),ee("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"US dollars thousand"})]})}),ee(kI,{category:"Wealth",indicator:"Disposable monthly income"})]}):Je(vl,{children:[ee("div",{style:{position:"absolute",top:"16vh",left:"8vh"},children:Je("div",{className:o.title,style:{fontSize:"6vh"},children:["Perception of wealth & poverty index",ee("br",{}),ee("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"index"})]})}),ee(kI,{category:"Wealth",indicator:"Perception of wealth & poverty index"})]})]}):Je(vl,{children:[ee("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:Je("div",{className:o.title,style:{fontSize:"6vh"},children:["Percentage of population with access to drinking water",ee("br",{}),ee("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:"%"})]})}),ee(kI,{category:"Water availability",indicator:"Percentage of population with access to drinking water"})]})})]})]})};Kr()({closeBtn:{background:"#2D67FF",width:45,height:45,position:"absolute",top:0,left:70},text:{color:"#FFF",fontSize:18,fontWeight:300,position:"absolute",top:85,right:70,width:710},fat:{fontWeight:"500 !important"},content:{padding:70,border:"1px solid #000",position:"relative",width:1335,"& h2":{fontSize:60,fontWeight:300,letterSpacing:"-1.2px",position:"absolute",top:70,left:70,lineHeight:"70px"}},blue:{backgroundColor:"#1433AE",color:"#FFF"},white:{backgroundColor:"#FFF",color:"#000"}});const L4e=({selectedCityName:n})=>{const{classes:e}=TT(),a=Vh(),o=Z6.find(s=>s.City===n);return Je(vl,{children:[o&&Je("div",{className:e.root,children:[Je("div",{className:e.titleWrapper,children:[Je("div",{className:e.cityNameAndCountryNameWrapper,children:[ee("div",{className:e.cityName,children:n}),ee("div",{className:e.countryName,children:o.Country})]}),Je("div",{className:e.cityDescription,children:["Largest city in the",ee("br",{}),"country, centre ",ee("br",{}),"of region",ee("br",{})]})]}),Je("div",{className:e.statWrapper,children:[ee(_I,{color:"#FF3B29",title:"Population",value:o.Population,status:o["Population description"]}),ee(_I,{color:"#FF3B29",title:"Population density",value:o["Population density"]+" people/ha",status:o["Population density description"]}),ee(_I,{color:"#2D67FF",title:"Climate",value:o.Climate,status:o["Climate description"]})]}),Je("div",{style:{display:"flex",marginTop:"3.7vh",marginLeft:"-2.1vh",paddingLeft:"2vh",borderLeft:"1px solid #fff",height:"auto"},children:[Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto"},children:[ee(o0,{label:"Urban resilience index",status:o["Urban Resilience Index"],isFirst:!0}),Je("div",{className:e.smallItemsListWrapper,children:[ee(su,{label:"Environmental",status:o.Environmental}),ee(su,{label:"Social",status:o.Social}),ee(su,{label:"Governmental",status:o.Governmental})]}),ee("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:ee(su,{label:"Ability & Willingness",status:o["Ability & Willingness"]})})]}),Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[ee(o0,{label:"Basic needs",subLabel:"Scope 0",status:o["Basic needs Scope"]}),ee(o0,{label:"Transport resilience index",status:o["Transport Resilience Index"]})]}),Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[ee(o0,{label:"Natural risk exposure",status:o["Natural Risk Exposure"]}),ee(o0,{label:"Urban sentiment index",status:o["Urban Sentiment Index"]})]})]})]}),ee(jEe,{selectedCityName:n}),ee(Or,{onClick:()=>{a("/city/"+n)},style:{position:"absolute",bottom:"9vh",right:"10vh",width:"20vh",height:"6.5vh",borderRadius:50,zIndex:1e3,background:"#2D67FF",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"3vh",fontWeight:100,textTransform:"none"},children:"Subscribe"}),ee("div",{className:e.bottomWrapper,style:{position:"absolute",margin:"unset",bottom:"3vh"},children:Je("div",{className:e.smallTextWrapper,children:[ee(Ha,{className:e.smallText,children:"How the rating works"}),ee("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]})}),ee("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"15vh",right:"30%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."})]})},R4e=[{name:"Mainpage",link:"/"},{name:"Urban Rating & Monitoring",link:"/urban"},{name:"Corporate Rating & Monitoring",link:"/",disabled:!0},{name:"Project Marketplace",link:"/marketplace"},{name:"Expo City Dubai",link:"/"},{name:"Governance",link:"/"},{name:"Data & Insights",link:"/",disabled:!0},{name:"Resilience News",link:"/"}],Zw=({setVisible:n})=>Je("div",{children:[ee("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:9999,background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(30px)"}}),Je("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",zIndex:9999,paddingLeft:"15vh",paddingTop:"4vh"},children:[Je("div",{onClick:()=>n(!1),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"2vh",color:"#FFFFFF",fontSize:"3vh",fontFamily:"SuisseIntl-Light",fontWeight:600,marginBottom:"10vh"},children:[ee("img",{src:"/assets/closeBtn.svg",alt:"close"}),"Close menu"]}),ee("div",{children:R4e.map(e=>ee(k4e,{name:e.name,link:e.link,isDisabled:e.disabled},e.name))})]})]}),k4e=({name:n,link:e,isDisabled:a})=>{const o=Vh(),[s,c]=re.useState(!1);return Je("div",{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),onClick:()=>{o(e)},style:{pointerEvents:a?"none":"auto",userSelect:"none",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontWeight:400,color:s?"#2D67FF":"#FFFFFF",fontSize:"8vh",display:"flex",alignItems:"center",flexDirection:"row",gap:"2vh"},children:[Je("div",{style:{opacity:a?.1:1},children:[s&&ee("img",{src:"/assets/menuArrow.svg",alt:"arrow",style:{marginRight:"2vh"}}),n]}),a&&ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#FFFFFF",fontSize:"2vh",opacity:1,width:"fit-content",borderRadius:"4vh",backgroundColor:"rgba(255,255,255,0.1)",padding:"1vh 2vh"},children:"Coming soon"})]})},D4e=()=>{const[n,e]=re.useState("map"),[a,o]=re.useState(null),[s,c]=re.useState(null),[d,f]=re.useState(!1);return Je("div",{children:[d&&ee(Zw,{setVisible:f}),Je(e0e,{backgroundColor:"#2429B5",children:[ee(n0e,{isCitySelected:!!s,setSelectedCity:c,setMenuVisible:f}),s?ee(L4e,{selectedCityName:s}):ee(DEe,{map:a,currentView:n,setCurrentView:e,isZoomButtonsVisible:n==="map"}),n==="graph"&&!s&&ee(UEe,{setSelectedCity:c}),n==="map"&&!s&&ee(VEe,{setMap:o,setSelectedCity:c})]})]})},dQ=Kr()({root:{position:"absolute",overflowY:"scroll",backgroundColor:"#203CBF",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},sticky:{position:"sticky",top:0,left:0,right:0,zIndex:1}}),aj=({label:n,color:e,cities:a,position:o,onClick:s})=>{const[c,d]=re.useState(n),[f,m]=re.useState(null),y=!!f,_=S=>{m(S.currentTarget)},x=()=>{m(null)};return Je("div",{children:[ee(Or,{id:"demo-positioned-button","aria-controls":y?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":y?"true":void 0,onClick:a?_:void 0,disabled:!a,children:Je("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[ee("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),ee("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:c}),o!==0&&ee("div",{style:{marginLeft:"1vh"},children:ee("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),ee(Iw,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:f,open:y,onClose:x,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:a==null?void 0:a.map((S,T)=>ee(J0,{onClick:()=>{d(S),s==null||s(S,o),x()},children:S},S))})]})};Xw.register(...e4e);const O4e=({chartData:n})=>{const e=s=>n,a=re.useRef(null),o=s=>{var d;if(!s)return;const c=s.getContext("2d");c&&((d=a.current)==null||d.destroy(),a.current=new Xw(c,{type:"radar",data:e(),options:{plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{pointLabels:{font:{size:18}}}}}}))};return re.useEffect(()=>{a.current&&(a.current.data=e(),a.current.update())},[n]),ee("canvas",{ref:o})},hQ=re.createContext(void 0),hu=()=>{const n=re.useContext(hQ);if(!n)throw new Error("useSelectedCityData must be used within a CityDataProvider");return n},z4e=({children:n})=>{const{classes:e}=Yw(),a=hu();return Je("div",{className:e.contentWrapper,children:[Je("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column",zIndex:1e3},children:[Je("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},children:[ee("b",{children:"Transport"})," resilience",ee("br",{}),"index",ee("span",{style:{paddingTop:"-1.5vh",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1.4vh 2vh",verticalAlign:"middle",backgroundColor:Uo[a==null?void 0:a["Transport Resilience Index"].toUpperCase()]?Uo[a==null?void 0:a["Transport Resilience Index"].toUpperCase()]:"#A0DA8B",color:"#000",borderRadius:50,width:"fit-content"},children:a==null?void 0:a["Transport Resilience Index"]})]}),ee("div",{style:{display:"flex",flexDirection:"column",gap:".5vh",marginTop:"9vh"},children:n})]}),ee("div",{className:e.pageContainer,children:Je("div",{className:e.bottomWrapper,children:[ee("div",{className:e.smallTextWrapper}),ee("div",{}),Je(Or,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[ee("div",{children:"Download report"}),ee("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})},xb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],F4e=()=>{const{classes:n}=Yw(),[e,a]=re.useState({}),o=hu(),s=nJ.filter(m=>m!==o.City),[c,d]=re.useState(s.slice(0,5));re.useEffect(()=>{const m=Z6.filter(x=>c.includes(x.City)),y=[o,...m].map((x,S)=>({label:x.City,backgroundColor:"transparent",borderWidth:S===0?8:1,borderColor:xb[S],pointBackgroundColor:xb[S],pointBorderColor:xb[S],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:[x.tr_graph.Efficiency,x.tr_graph.Accessibility,x.tr_graph.Safety,x.tr_graph.Affordability,x.tr_graph["Environmental impact"],x.tr_graph.Satisfaction]}));a({labels:["Efficiency","Accessibility","Safety","Affordability","Environmental impact","Satisfaction"],datasets:y})},[c]);const f=(m,y)=>{d(_=>{const x=[..._];return x[y-1]=m,x})};return ee("div",{style:{position:"relative",backgroundColor:"#fff"},children:Je("div",{className:n.root,children:[ee("div",{style:{position:"absolute",top:"15vh",right:"35vh",width:"80vh",zIndex:10},children:ee(O4e,{chartData:e})}),Je(z4e,{children:[ee(aj,{label:o.City,color:xb[0],position:0}),c.map((m,y)=>ee(aj,{label:m,color:xb[y+1],cities:s,position:y+1,onClick:f},m))]})]})})},N4e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},fQ=({invertColors:n,setMenuVisible:e,displayBackButton:a})=>{const o=d=>N4e[d],{classes:s}=GD(),c=Vh();return Je("div",{className:s.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[ee("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:Je("div",{className:s.menuIconWrapper,children:[!a&&Je("div",{onClick:()=>{c("/")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[ee("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:s.whiteText,style:{color:n?"#000":"#fff"},children:o("back")})]}),Je("div",{onClick:()=>e(!0),style:{display:"flex",gap:"1vh",flexDirection:"row",alignItems:"center"},children:[n?ee("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):ee("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:s.whiteText,style:{color:n?"#000":"#fff"},children:o("menu")})]})]})}),n?ee("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):ee("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Je("div",{className:s.buttonsWrapper,children:[ee(Or,{style:{color:"#000",background:"#fff",borderRadius:50,padding:".8vh 2vh",textTransform:"none",fontFamily:"SuisseIntl-Regular",fontSize:"1.7vh"},children:"Dashboard"}),n?ee("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:ee("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},wb=({children:n,isActive:e})=>{const{classes:a}=dQ();return ee("div",{className:`${a.sectionWrapper} `,children:n})},pQ=Kr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),B4e=({children:n})=>{const{classes:e}=VD();return ee("div",{className:e.root,children:ee("div",{className:e.contentWrapper,children:n})})},U4e=({cityName:n,countryName:e})=>{const{classes:a}=pQ();return Je("div",{className:a.titleWrapper,children:[ee(Ha,{className:a.bigText,children:n}),ee(Ha,{className:a.bigTextSubtitle,children:e})]})},AA=({label:n,subLabel:e,status:a,isFirst:o,filled:s})=>ee(vl,{children:o?Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",textAlign:"center"},children:n}),ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",opacity:.6},children:e}),ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:a?Uo[a.toUpperCase()]:"#fff",borderColor:a?`${Uo[a.toUpperCase()]}30`:"#fff"},children:a})]}):Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",textAlign:"center"},children:n}),ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:Uo[a.toUpperCase()],borderColor:`${Uo[a.toUpperCase()]}30`,borderWidth:1,backgroundColor:s?`${Uo[a.toUpperCase()]}30`:"transparent"},children:a})]})}),W4e=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.9294491509595,31.99991210008109],zoom:10.302824376136313,bearing:101.60000000000173,pitch:49.99999999999965},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.4827698424715,9.050655704984095],zoom:10.591526871591094,bearing:0,pitch:50.01373809516397},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.7549140865068,-6.279782111773116],zoom:9.250879827490543,bearing:-171.20000000000033,pitch:43.5},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.595325073248517,-33.98842317442896],zoom:10.326397481326069,bearing:12.8,pitch:35.48000000000009},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.49418255077882,-33.02916530602038],zoom:10.663321631643026,bearing:179.0638372543699,pitch:54.5411711309316,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.258412531048407,-4.0848396587145],zoom:10.033264905407863,bearing:0,pitch:50,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.89615639234319,43.22632526745298],zoom:10.552292015558665,bearing:0,pitch:56.979999999999954,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.27052715393592,15.658568511522205],zoom:11.055099976780857,bearing:0,pitch:44.94535508727158,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],V4e=({selectedCityName:n,setMap:e})=>{bd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const a=re.useRef(null),o=re.useRef(null);return re.useEffect(()=>{var c;if(o.current||!a.current)return;const s=(c=W4e.find(d=>d.properties.City_Name===n))==null?void 0:c.properties;o.current=new bd.Map({attributionControl:!0,container:a.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:s==null?void 0:s.center,zoom:s==null?void 0:s.zoom,bearing:s==null?void 0:s.bearing,pitch:s==null?void 0:s.pitch}),o.current.on("load",()=>{if(!o.current)return;o.current.resize();let d,f,m=!1;function y(_){d===void 0&&(d=_);const x=_-d;if(f!==_){const S=Math.min(24e-5*x,.6);o.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",S),S===1&&(m=!0)}x<2500&&(f=_,m||requestAnimationFrame(y))}y(0)}),e(o.current)},[]),ee("div",{ref:a,style:{pointerEvents:"none",position:"absolute",top:"10vh",right:"0",width:"100%",height:"90vh"}})},G4e=({map:n})=>Je("div",{style:{userSelect:"none",position:"absolute",right:"40vh",bottom:"3vh",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[ee("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:ee("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),ee("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:ee("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),H4e=({setActiveSection:n})=>{const{classes:e}=pQ(),[a,o]=re.useState(null),s=hu();return Je("div",{style:{position:"relative"},children:[ee(V4e,{setMap:o,selectedCityName:s.City}),Je(B4e,{children:[Je("div",{className:e.pageContainer,children:[ee(U4e,{cityName:s.City,countryName:s.Country}),Je("div",{style:{position:"absolute",top:"30%",left:"2vh",borderLeft:"1px solid #fff",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:[ee(o0,{label:"Urban resilience index",status:s["Urban Resilience Index"],isFirst:!0}),Je("div",{className:e.smallItemsListWrapper,children:[ee(su,{label:"Environmental",status:s.Environmental}),ee(su,{label:"Social",status:s.Social}),ee(su,{label:"Governmental",status:s.Governmental})]}),ee("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:ee(su,{label:"Ability & Willingness",status:s["Ability & Willingness"]})})]}),Je("div",{style:{position:"absolute",top:"27%",right:"9vh",display:"flex",flexDirection:"column",gap:"3.2vh",height:"43.5vh"},children:[ee(AA,{isFirst:!0,label:"Basic needs",subLabel:"Scope 0",status:s["Basic needs Scope"]}),ee(AA,{label:"Urban sentiment index",status:s["Urban Sentiment Index"],filled:!0}),ee(AA,{label:"Natural risk exposure",status:s["Natural Risk Exposure"]}),ee(AA,{label:"Transport resilience index",status:s["Transport Resilience Index"],filled:!0})]}),Je("div",{className:e.bottomWrapper,children:[Je("div",{className:e.smallTextWrapper,children:[ee(Ha,{className:e.smallText,children:"How the rating works"}),ee("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),Je("div",{children:[(s.City==="Dubai"||s.City==="Dar es Salaam")&&ee(Or,{onClick:()=>{const c=document.getElementById("landing");c.scrollTo({top:c.clientHeight*5,behavior:"smooth"})},style:{marginBottom:"5vh",backgroundColor:"#3752BA",color:"#fff",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",alignItems:"center"},children:"Geoanalytics"}),Je("div",{onClick:()=>{const c=document.getElementById("landing");c.scrollTo({top:c.clientHeight,behavior:"smooth"})},style:{pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"column",gap:"1.2vh",alignItems:"center"},children:[ee("div",{children:"Scroll down"}),ee("img",{src:"/assets/arrowDown.svg",alt:"arrow down",style:{animation:"bounce 2s infinite"}})]})]}),Je(Or,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[ee("div",{onClick:()=>{const c=s.pdfName,d=document.createElement("a");d.href=`/pdf/${c}`,d.download=c,d.click()},children:"Download report"}),ee("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]}),ee("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"22vh",right:"50%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."}),ee(G4e,{map:a})]})]})},n0=({label:n,value:e,status:a,color:o})=>Je("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[ee("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",textAlign:"center"},children:n}),ee("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2.5vh",marginTop:".7vh",textAlign:"center"},children:e}),ee("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",fontWeight:600,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#fff",color:o,borderRadius:50,width:"fit-content"},children:a})]}),j4e=({bgUrl:n,isActive:e,onClick:a})=>ee("div",{onClick:a,style:{pointerEvents:"all",cursor:"pointer",height:"4.5vh",width:"4.5vh",borderRadius:"50%",border:"1px solid #fff",backgroundImage:e?"none":`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:e&&ee("div",{style:{height:"10px",width:"10px",borderRadius:"50%",backgroundColor:"#fff"}})}),$4e=({imagesUrls:n,activeImageIndex:e})=>ee("div",{style:{position:"absolute",width:"100%",height:"100%"},children:n.map((a,o)=>ee("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:`url(${a})`,backgroundSize:"cover",backgroundPosition:"center",opacity:e===o?1:0,transition:"opacity 0.5s ease"}},o))}),q4e=({setActiveSection:n})=>{const[e,a]=re.useState(0),{classes:o}=Yw(),s=hu();return Je("div",{style:{position:"relative"},children:[ee($4e,{imagesUrls:s.images,activeImageIndex:e}),Je("div",{className:o.root,children:[ee("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"40vh",background:"linear-gradient(180deg, rgba(0,0,0,0.4) 75%, rgba(0,0,0,0))"}}),ee("div",{className:o.contentWrapper,children:Je("div",{className:o.pageContainer,children:[Je("div",{style:{position:"absolute",top:"15.7vh",display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh"},children:[ee(n0,{label:Je("div",{children:["Poverty headcount ratio ",ee("br",{})," at national poverty lines"]}),value:s["Poverty headcount ratio at national poverty lines"]+"of population",status:s["Poverty headcount ratio at national poverty lines description"],color:"#A0DA8B"}),ee(n0,{label:ee("div",{children:"Population"}),value:s.Population,status:s["Population description"],color:"#FF3B29"}),ee(n0,{label:ee("div",{children:"Climate"}),value:s.Climate,status:s["Climate description"],color:"#2D67FF"}),ee(n0,{label:ee("div",{children:"Population density"}),value:s["Population density"]+"people/ha",status:s["Population density description"],color:"#FF3B29"}),ee(n0,{label:ee("div",{children:"Mean salary"}),value:s["Mean salary"]+"PPP$",status:s["Mean salary description"],color:"#FF3B29"}),ee(n0,{label:Je("div",{children:["Literacy rate among ",ee("br",{}),"population (15-24 Years)"]}),value:s["Literacy rate among population"],status:s["Literacy rate among population description"],color:"#A0DA8B"})]}),Je("div",{className:o.bottomWrapper,children:[ee("div",{}),ee("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:s.images.map((c,d)=>ee(j4e,{bgUrl:c,onClick:()=>{a(d)},isActive:e===d},d))}),Je(Or,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},children:[ee("div",{onClick:()=>{const c=s.pdfName,d=document.createElement("a");d.href=`/pdf/${c}`,d.download=c,d.click()},children:"Download report"}),ee("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]})})]})]})},DI=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":2,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],OI=({children:n,side:e,setHoveredSide:a,setClickedCategory:o})=>{const[s,c]=re.useState(!1);return Je("div",{onMouseEnter:()=>{c(!0),a(e)},onMouseLeave:()=>{c(!1),a(null)},style:{border:s?"1px solid #fff":"none",position:"absolute",backgroundImage:"url(/assets/cube_solid_bg.png)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",height:e==="top"?"40.6vh":"45vh",width:e==="top"?"45.6vh":"45vh",padding:"2vh 1vh",boxSizing:"border-box",top:e==="left"?"40vh":e==="right"?"40.1vh":"16.4vh",right:e==="left"?"55.1vh":e==="right"?"24.9vh":"39.7vh",transform:e==="left"?"skew(0deg, 35.5deg) scale(0.67)":e==="right"?"skew(0deg, -35.5deg) scale(0.67)":"rotate3d(1.1, 0.7, 1.2, -63.7deg)"},children:[n,ee("div",{style:{position:"absolute",bottom:"2vh",right:"2vh",fontFamily:"SuisseIntl-Light",fontSize:"2vh",opacity:s?1:.7},children:e==="left"?"Environment":e==="right"?"Governmental":"Social"})]})},zI=({title:n,color:e,setClickedCategory:a})=>{const[o,s]=re.useState(!1);return ee("div",{onClick:()=>{a(n)},onMouseOver:()=>{s(!0)},onMouseOut:()=>{s(!1)},style:{cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"2.1vh",color:"#fff"},children:Je("div",{style:{width:"fit-content",height:"fit-content",backgroundColor:o?e:"transparent",borderRadius:"32px",display:"flex",alignItems:"center",flexDirection:"row",padding:".6vh 2vh",gap:"1.5vh"},children:[ee("div",{children:n}),ee("div",{style:{width:"2vh",height:"2vh",backgroundColor:o?"#fff":e,borderRadius:"50%"}})]})})},EA=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],FI={left:["Air pollution","Water pollution","Land use and waste","Natural disaster hazards"],right:["Accountability","City budget","SME","Public services","Sustainability commitment"],top:["Water availability","Food availability","Energy availability","Health","Education","Wealth","Safety","Livability","Transport","Inclusion"]},X4e=({setHoveredSide:n,setClickedCategory:e})=>Je("div",{style:{zIndex:1,width:"60vw",height:"100vh",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",alignItems:"center",justifyContent:"center"},children:[ee(OI,{side:"left",setHoveredSide:n,children:ee("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:FI.left.map(a=>{const s=hu().City,d=DI.find(m=>m.City===s)[a],f=EA[d-1]?EA[d-1]:"#FF632F";return ee(zI,{title:a,color:f,setClickedCategory:e},a)})})}),ee(OI,{side:"right",setHoveredSide:n,setClickedCategory:e,children:ee("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:FI.right.map(a=>{const s=hu().City,d=DI.find(f=>f.City===s)[a];return ee(zI,{title:a,color:EA[d-1],setClickedCategory:e},a)})})}),ee(OI,{side:"top",setHoveredSide:n,setClickedCategory:e,children:ee("div",{style:{display:"flex",flexDirection:"column",gap:"-1vh"},children:FI.top.map(a=>{const s=hu().City,d=DI.find(f=>f.City===s)[a];return ee(zI,{title:a,color:EA[d-1],setClickedCategory:e},a)})})})]}),Y4e=({clickedCategory:n,setClickedCategory:e})=>{const{classes:a}=Yw(),[o,s]=re.useState(null),[c,d]=re.useState(null),f=hu();return re.useEffect(()=>{const m=$Ee.find(S=>S.city===f.City),y=m.E,_=m.S,x=m.G;d(o==="left"?y:o==="top"?_:o==="right"?x:null)},[o]),re.useEffect(()=>{console.log(n)},[n]),ee(vl,{children:ee("div",{style:{position:"relative",backgroundImage:"url(/assets/new_bg_cube.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:Je("div",{className:a.root,children:[ee(X4e,{setHoveredSide:s,setClickedCategory:e}),Je("div",{className:a.contentWrapper,children:[Je("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column"},children:[Je("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#fff"},children:["Urban ",ee("b",{children:"resilience"}),ee("br",{}),"index",ee("span",{style:{paddingTop:"-1.5vh",verticalAlign:"middle",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#FF632F",color:"#fff",borderRadius:50,width:"fit-content"},children:f["Urban Resilience Index"]})]}),ee("div",{style:{position:"absolute",top:"22vh",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:Je("div",{className:a.smallItemsListWrapper,children:[ee(su,{label:"Environmental",status:f.Environmental}),ee(su,{label:"Social",status:f.Social}),ee(su,{label:"Governmental",status:f.Governmental})]})})]}),Je("div",{style:{position:"absolute",top:"33%",lineHeight:"1.5",right:"5vh",width:"30vh",fontFamily:"SuisseIntl-Light",fontSize:"1.9vh"},children:[o==="left"||o==="top"||o==="right"?"Policy hints":"",ee("br",{}),ee("br",{}),c]}),ee("div",{className:a.pageContainer,children:Je("div",{className:a.bottomWrapper,children:[Je("div",{className:a.smallTextWrapper,children:[ee(Ha,{className:a.smallText,children:"How the rating works"}),ee("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),Je(Or,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:[ee("div",{onClick:()=>{const m=f.pdfName,y=document.createElement("a");y.href=`/pdf/${m}`,y.download=m,y.click()},children:"Download report"}),ee("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})]})})})},Z4e=({cityData:n,children:e})=>ee(hQ.Provider,{value:n,children:e}),K4e=({setMap:n})=>{bd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{a.current||!e.current||(a.current=new bd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[55.28314923749909,25.02940197161118],zoom:10.5,bearing:0,pitch:60}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.bly9vkw2"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.3wcn7mfu"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.6j7olk89"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",12196,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],2.109820365905762,"#000004",5.94,"#50127b",9.78,"#b6377a",13.62,"#fb8761",17.892879486083984,"#fcfdbf"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","No2_mean"],1.002105474472046,"#440154",4,"#3b528b",7,"#21908d",10,"#5dc963",12.314108322964207,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5989.198242187499,"#edf8fb",6005,"#b2e2e2",6021,"#66c2a4",6037.02,"#2ca25f",6053.04296875,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],781,"#f6eff7",862.3,"#d0d6e8",925.4,"#a0bedb",939,"#67a9cf",953,"#3598ab",965,"#138484",998.3495483398436,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","UV_mean"],.703,"#cfcfcf",.85,"#b1b0af",1.1,"#a79e75",1.16,"#c5b56c",1.32,"#e5d05a",1.479856308970643,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.45878sao"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.cazbwhrj"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.cbntwjd4"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.446ij1ot"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.a1bmhhk8"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.87imwe7u"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.ddx873qu"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.d77lnwg2"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("urban cluster")||!a.current.getLayer("Population 3D"))return;const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas","urban cluster"];for(const s of o){if(document.getElementById(s))continue;const c=document.createElement("a");c.id=s,c.href="#",c.textContent=s,c.className="active",c.onclick=function(f){const m=this.textContent;f.preventDefault(),f.stopPropagation(),a.getLayoutProperty(m,"visibility")==="none"?(a.current.setLayoutProperty(m,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(m,"visibility","none"))},document.getElementById("menu").appendChild(c)}}),n(a.current))},[]),ee("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},J4e=({children:n})=>ee("div",{style:{position:"relative",height:"100%",width:"100%",backgroundColor:"#fff"},children:n}),Q4e=({children:n})=>ee("div",{style:{position:"absolute",left:"10vh",top:"15vh",zIndex:1},children:n}),eIe=Kr()({title:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},subTitle:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",color:"#000",maxWidth:"30vh",marginTop:"3vh"}}),tIe=Kr()({root:{backgroundColor:"#fff",padding:"2vh 2vh",borderRadius:20,marginTop:"3vh",display:"flex",flexDirection:"column",gap:"2vh",width:"fit-content"},populationWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),ij=({label:n,isTitle:e,isActive:a,onClick:o})=>{const[s,c]=re.useState(!1);return ee("button",{onClick:o,onMouseOut:()=>!e&&c(!1),onMouseOver:()=>!e&&c(!0),style:{cursor:s?"pointer":"default",fontFamily:s||a?"SuisseIntl-Regular":"SuisseIntl-Light",fontWeight:s||a?600:400,backgroundColor:"#fff",color:a?"#2D67FF":"#000",border:"none",textAlign:"left"},children:Je("div",{style:{pointerEvents:"all",position:"relative",fontSize:"1.8vh",width:"100%"},children:[n,n==="Population"&&ee(Sve,{checked:a})]})})},nIe={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/builtupAreas.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2d.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxco.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/co.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10.svg",order:23,align:"right"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},parks:{label:"Parks",mapboxId:"Parks",order:8,align:"left"},parksServiceArea:{label:"Parks service area",mapboxId:"Parks service area",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:9,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:10,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:11,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:12,align:"left"}},aIe={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/buildupAreasDarEsSalaam.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2dDarEsSalam.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:8,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:9,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:10,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2DarEsSalam.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2DarEsSalam.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3DarEsSalam.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxcoDarEsSalam.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10DarEsSalam.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2DarEsSalam.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2DarEsSalam.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3DarEsSalam.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/coDarEsSalam.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10DarEsSalam.svg",order:23,align:"right"}},iIe=({map:n,setLegend:e})=>{const{classes:a}=tIe(),[o,s]=re.useState({}),f=hu().City==="Dubai"?nIe:aIe;re.useEffect(()=>{n&&Object.keys(o).forEach(_=>{n.setLayoutProperty(_,"visibility",o[_]?"visible":"none")})},[o]);const m=Object.keys(f).filter(_=>f[_].align==="left"),y=Object.keys(f).filter(_=>f[_].align==="right");return ee("div",{className:a.root,children:Je("div",{style:{display:"flex",flexDirection:"row"},children:[ee("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:m.map(_=>{const x=f[_],{label:S,mapboxId:T,order:I}=x,k=o[T];return ee(ij,{label:S,isActive:k,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[T]:!k}),e(x.legendSvgUrl?x.legendSvgUrl:x.legendText?x.legendText:null)}},T)})}),ee("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:y.map(_=>{const x=f[_],{label:S,mapboxId:T,order:I}=x,k=o[T];return ee(ij,{label:S,isActive:k,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[T]:!k}),e(x.legendSvgUrl||null)}},T)})})]})})},rIe=({map:n})=>Je("div",{style:{userSelect:"none",position:"relative",zIndex:2,height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[ee("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:ee("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),ee("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:ee("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),oIe=({setMap:n})=>{bd.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=re.useRef(null),a=re.useRef(null);return re.useEffect(()=>{a.current||!e.current||(a.current=new bd.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[39.11395379366985,-6.795093628568665],zoom:9.8,bearing:0,pitch:63}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.dpou9n43"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.8brf2wm2"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.2xkqu3zj"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",21877,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],0,"#ffffff",1.35,"#570f6e",2.7,"#bb3755",4.05,"#f98d0a",5.358946323394775,"#fcffa4"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","NO2_mean"],2.05233907699585,"#440154",2.2,"#3b528b",2.4,"#21908d",2.6,"#5dc962",2.772989511489868,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5762.0478515625,"#edf8fb",5771.03,"#b2e2e2",5780.02,"#66c2a4",5789.01,"#2ca25f",5797.997504716548,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],802.5854707726206,"#f6eff7",821,"#bdc9e1",836,"#67a9cf",851.48,"#1c9099",867.7780797321312,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","PM10_mean"],-.560415429762831,"#ffffff",-.463,"#f0f0f0",-.365,"#7d7c78",-.268,"#beaf6f",-.170282865193472,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.8z6owmcr"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.20jvy6c8"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.76qo6b2w"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.co2x6sdc"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.couih9de"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.2vtfxzn2"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.cxu2vccw"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.8u6mbzcw"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("Population 3D"))return;console.log("A idle event occurred."),console.log("Center - "+a.current.getCenter()),console.log("Zoom - "+a.current.getZoom()),console.log("Bearing - "+a.current.getBearing()),console.log("Pitch - "+a.current.getPitch());const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas"];for(const s of o){if(document.getElementById(s))continue;const c=document.createElement("a");c.id=s,c.href="#",c.textContent=s,c.className="active",c.onclick=function(f){const m=this.textContent;f.preventDefault(),f.stopPropagation(),a.current.getLayoutProperty(m,"visibility")==="none"?(a.current.setLayoutProperty(m,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(m,"visibility","none"))},document.getElementById("menu").appendChild(c)}}),n(a.current))},[]),ee("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},sIe=()=>{const{classes:n}=eIe(),e=hu(),[a,o]=re.useState(null),[s,c]=re.useState(null),f=hu().City;return re.useEffect(()=>{},[s]),Je(J4e,{children:[Je(Q4e,{children:[Je("div",{className:n.title,children:["Geoanalytics: ",e==null?void 0:e.City]}),ee(iIe,{map:a,setLegend:c})]}),f==="Dubai"&&ee(K4e,{setMap:o}),f==="Dar es Salaam"&&ee(oIe,{setMap:o}),Je("div",{style:{position:"absolute",bottom:"5vh",right:"5vh",zIndex:1e3,display:"flex",flexDirection:"row",width:"fit-content",gap:"4vh",alignItems:"center"},children:[ee(rIe,{map:a}),s&&s.includes("/")?ee("img",{src:s}):s&&ee("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",width:"10vw"},children:s})]})]})},rj=()=>{const{classes:n}=dQ(),[e,a]=re.useState(0);re.useState(!1);const[o,s]=re.useState(null),[c,d]=re.useState(!1),f=Vh(),{cityName:m}=kce(),y=Z6.find(x=>x.City===m);y||f("/");const _=x=>{const S=document.getElementById("landing"),T=S.clientHeight,I=S.scrollTop;let k=0;x=="down"?k=I+T:x=="up"&&(k=I-T),S.scrollTo({top:k,left:0,behavior:"smooth"})};return re.useEffect(()=>{const x=document.getElementById("landing");return x.addEventListener("wheel",S=>{S.deltaY<0||S.deltaY>0}),()=>{x.removeEventListener("scroll",_)}},[]),re.useEffect(()=>{const x=document.getElementById("landing");return x.addEventListener("scroll",S=>{}),()=>{x.removeEventListener("scroll",_)}},[]),re.useEffect(()=>{const x=document.getElementById("landing");x.addEventListener("scroll",S=>{const T=x.clientHeight,I=x.scrollTop,k=Math.floor(I/T);a(k)})},[]),Je(Z4e,{cityData:y,children:[c&&ee(Zw,{setVisible:d}),ee("div",{style:{position:"absolute",backgroundColor:"#203CBF",width:"100vw",height:"100vh"},children:ee(fQ,{invertColors:e===3||e===4,setMenuVisible:d})}),Je("div",{className:n.root,id:"landing",children:[ee(wb,{isActive:e===0,sectionIndex:0,children:ee(H4e,{setActiveSection:a})},0),ee(wb,{isActive:e===1,sectionIndex:1,children:ee(q4e,{setActiveSection:a})},1),ee(wb,{isActive:e===2,sectionIndex:2,children:ee(Y4e,{setClickedCategory:s,clickedCategory:o})},2),ee(wb,{isActive:e===3,sectionIndex:3,children:ee(F4e,{})},3),((y==null?void 0:y.City)==="Dubai"||(y==null?void 0:y.City)==="Dar es Salaam")&&ee(wb,{isActive:e===5,sectionIndex:5,children:ee(sIe,{})},5)]}),o&&ee(uQ,{category:o,city:y.City,setClickedCategory:s})]})},lIe=Kr()({root:{position:"absolute",width:"100%",height:"100%",overflowY:"auto"}}),cIe=Kr()({root:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8vw"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"},name:{width:"10vw",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",opacity:.2,margin:"0"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"}}),yO=Kr()({root:{position:"relative",display:"flex",flexDirection:"column",alignItems:"left",boxSizing:"border-box",padding:"0 10vh",gap:"6vh"},smallText:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",margin:"0"},statusRow:{display:"flex",gap:"1vh",alignItems:"center"},text:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"},link:{height:"3vh",width:"3vh"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"}}),uIe=Kr()({root:{zIndex:2,position:"sticky",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center",top:0,backgroundColor:"#fff",padding:"0 10vh 0 10vh",boxSizing:"border-box"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),dIe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},hIe=({invertColors:n,setMenuVisible:e})=>{const a=s=>dIe[s],{classes:o}=uIe();return Je("div",{className:o.root,style:{borderBottom:n?"1px solid #000":"1px solid #fff"},children:[ee("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:Je("div",{className:o.menuIconWrapper,onClick:()=>{e(!0)},children:[n?ee("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):ee("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:o.whiteText,style:{color:n?"#000":"#fff"},children:a("menu")})]})}),n?ee("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):ee("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Je("div",{className:o.buttonsWrapper,children:[ee(Or,{style:{color:"#000",background:"#fff",borderRadius:50,padding:".8vh 2vh",textTransform:"none",fontFamily:"SuisseIntl-Regular",fontSize:"1.7vh"},children:"Dashboard"}),n?ee("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:ee("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},fIe=Kr()({bubble:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",boxSizing:"border-box",border:"1px solid #ccc",padding:"1vh 2vh",borderRadius:"50px",backgroundColor:"#ffffff"},statusCircle:{width:"1vh",height:"1vh",borderRadius:"50%",marginLeft:"1vh"}}),pIe=Kr()({button:{backgroundColor:"#2D67FF",boxSizing:"border-box",padding:"1vh 2vh",margin:"0",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",color:"#FFFFFF",textTransform:"none"},icon:{width:"2vh",height:"2vh"}}),mIe=Kr()({root:{position:"relative",height:"50vh",overflow:"hidden",borderRadius:"0 0 50px 50px"},image:{width:"100%",height:"100%",objectFit:"cover"}}),gIe=Kr()({root:{display:"flex",flexDirection:"column",alignItems:"left",gap:"0.5vh",marginTop:"2vh"},title:{fontFamily:"SuisseIntl-Medium",fontWeight:500,fontSize:"8vh",lineHeight:"9vh",color:"#2D67FF",margin:"0"},subtitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000",margin:"0"},country:{color:"rgba(0, 0, 0, 1)"},city:{color:"rgba(0, 0, 0, 0.4)",cursor:"pointer"},location:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.5vh",color:"rgba(0, 0, 0, 0.2)",margin:"0",display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}}),yIe=({subtitle:n,country:e,city:a,children:o,style:s})=>{const{classes:c}=gIe(),d=Vh();return Je("div",{className:c.root,style:s,children:[Je("div",{children:[ee(Ha,{className:c.title,children:o}),ee(Ha,{className:c.subtitle,children:n})]}),Je(Ha,{className:c.location,children:[ee("span",{className:c.country,children:e})," / ",ee("span",{className:c.city,onClick:()=>{d("/city/"+a)},children:a})]})]})},vIe=({title:n,onClick:e,disabled:a,variant:o})=>{const{classes:s}=pIe();return ee("div",{className:s.button,onClick:e,style:{opacity:a?.5:1,cursor:a?"default":"pointer",pointerEvents:a?"none":"auto"},children:o==="icon"?Je(vl,{children:[ee("img",{className:s.icon,src:"/assets/like_icon.svg",alt:"icon"}),ee(Ha,{className:s.title,children:n})]}):ee(Ha,{className:s.title,children:n})})},_Ie=({imageURL:n,style:e})=>{const{classes:a}=mIe();return Je("div",{className:a.root,style:e,children:[ee("img",{className:a.image,src:n,alt:"project image"}),ee("div",{style:{position:"absolute",bottom:"4vh",left:"4vh"},children:ee(vIe,{title:"Add project to Portfolio",variant:"icon"})})]})},bIe=({parametrs:n,investment:e,newJobs:a,startYear:o,contractType:s})=>{const{classes:c}=yO();return ee("div",{style:{display:"flex",flexDirection:"row",gap:"2vw",flex:5},children:Je("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[ee(Ha,{className:c.smallText,style:{width:"11vw"},children:"Parameters"}),ee(Ha,{className:c.smallText,style:{maxWidth:"29vw"},children:n})]}),Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[ee(Ha,{className:c.smallText,style:{width:"11vw"},children:"Investment, $USD M"}),ee(Ha,{className:c.smallText,style:{maxWidth:"29vw"},children:e})]}),Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[ee(Ha,{className:c.smallText,style:{width:"11vw"},children:"New jobs"}),ee(Ha,{className:c.smallText,style:{maxWidth:"29vw"},children:a})]}),Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[ee(Ha,{className:c.smallText,style:{width:"11vw"},children:"Start, year"}),ee(Ha,{className:c.smallText,style:{maxWidth:"29vw"},children:o})]}),Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[ee(Ha,{className:c.smallText,style:{width:"11vw"},children:"Contract type"}),ee(Ha,{className:c.smallText,style:{maxWidth:"29vw"},children:s})]})]})})},gg=({title:n,value:e,style:a,children:o})=>{let s="#000";if(e)switch(e){case"Very strong":s="#35CB00";break;case"Strong":s="#A0DA8B";break;case"Average":s="#FF9B3F";break;case"Low":s="#FF632F";break;case"Very low":s="#FF3B29";break;default:s="#000";break}const{classes:c}=fIe();return e?Je("div",{className:c.bubble,style:a,children:[n,ee("div",{className:c.statusCircle,style:{background:s}}),o]}):Je("div",{className:c.bubble,style:a,children:[n,o]})},xIe=({status:n,resilienceImpact:e,directImpact:a,indirectImpact:o})=>{const{classes:s}=yO();let c="#000";switch(e){case"Very strong":c="#35CB00";break;case"Strong":c="#A0DA8B";break;case"Average":c="#FF9B3F";break;case"Low":c="#FF632F";break;case"Very low":c="#FF3B29";break;default:c="#000";break}return ee("div",{style:{display:"flex",flexDirection:"row",alignContent:"space-between",gap:"5vw",flex:5},children:Je("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[Je("div",{className:s.statusRow,children:[ee(Ha,{className:s.smallText,style:{width:"9vw"},children:"Status"}),ee(gg,{title:n.title,value:n.value})]}),Je("div",{className:s.statusRow,children:[ee(Ha,{className:s.smallText,style:{width:"9vw"},children:"Resilience impact"}),ee(gg,{title:e,style:{borderColor:c,color:c}})]}),Je("div",{className:s.statusRow,children:[ee(Ha,{className:s.smallText,style:{width:"9vw"},children:"Direct impact"}),a.map((d,f)=>ee(gg,{title:d.title,value:d.value},f))]}),Je("div",{className:s.statusRow,children:[ee(Ha,{className:s.smallText,style:{width:"9vw"},children:"Indirect impact"}),o.map((d,f)=>ee(gg,{title:d.title,value:d.value},f))]})]})})},oj=()=>ee("div",{style:{width:"100%",height:"1px",backgroundColor:"#000",margin:"0"}}),MA=({name:n,text:e,children:a})=>{const{classes:o}=cIe();return Je("div",{className:o.root,children:[ee("div",{className:o.name,children:n}),e&&ee("div",{className:o.textWrapper,children:ee("div",{className:o.text,children:e})}),a]})},NI=[{ID:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Searching_for:"Operation & management",Status:"Implementation",Project:"Women Entrepreneurship Development Centers",Desciption:"To provide training and networking opportunities to around 7,000 women.",TitleBlue:" in Almaty",Parametres:"To provide training and networking opportunities to around 7,000 women.",Participation_options:"Operation & management",Goals:"Creation of safe and inclusive business environment, delivering specialized training and capacity building programs to over 15,000 women entrepreneurs across the country by 2025",Investment:200,New_Jobs:7e3,Start_Date:2020,End_Date:2025,Contract_type:"Design-Build",Resilience_Impact:"Average",Direct_Impact:"Inclusion, SME",Indirect_Impact:"Wealth",Location:"https://maps.app.goo.gl/o6eM4KX36KX6zXCU8",Website:"https://www.adb.org/results/building-better-normal-women-entrepreneurs-kazakhstan",News_Sources:"https://www.undp.org/kazakhstan/news/women-entrepreneurship-development-centers-are-opening-all-regions-kazakhstan",News_Headers:"15 March 2022. Women entrepreneurship development centers are opening in all regions of Kazakhstan",Initiator:"the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan",Financial_Partners:"Ministry of National Economy, the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan, NCE Atameken, Asian Development Bank, the United Nations Development Programme (UNDP) in Kazakhstan.",url:"/assets/PROJECTS/Inclusion.jpg"},{ID:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution",Searching_for:"Construction",Status:"Implementation",Project:"New wastewater treatment plant",TitleBlue:" in Dar-es-Salaam region",Desciption:"Consturction of a new wastewater treatment plant. The project is expected to reduce environmental pollution through safe treatment of wastewater.",Parametres:"New 16K m3 per day wastewater treatment plant",Participation_options:"Construction",Goals:"A new the 16,000 m3/day wastewater plant will mitigate the environmental impact of a growing city and improve the access to clean water.",Investment:178,New_Jobs:40,Start_Date:2023,End_Date:2024,Contract_type:"Design-Build-Operate",Resilience_Impact:"Very strong",Direct_Impact:"Water Availability, Water Pollution",Indirect_Impact:"Health",Location:"https://maps.app.goo.gl/rA2JU3DPmYb1MeXT7",Website:"https://www.maji.go.tz/uploads/publications/sw1683132047-MBEZI%20BEACH%20SEWERAGE%20PROJECT_%20ESIA%20EXECUTIVE%20SUMMARY%20ENGLISH.pdf",News_Sources:"https://www.metito.com/news-detail/tanzania-to-develop-its-first-wastewater-treatment-plant-project-dar-es-salaam-water-supply-and-sanitation-authority-appoints-metito-to-develop-the-first-of-its-type-project/",News_Headers:"4 April 2023. Tanzania to develop its first wastewater treatment plant project Dar es Salaam Water Supply and Sanitation Authority appoints Metito to develop the first of its type project",Initiator:"Dar Es Salaam Water Supply and Sanitation Authority (DAWASA)",Financial_Partners:"Tanzanian Government, the World Bank",Contracting_Party:"Metito",url:"/assets/PROJECTS/Water_Pollution.jpg"}],wIe=({projectID:n})=>{let e=NI[0];n==="8"?e=NI[0]:n==="15"&&(e=NI[1]);let a;switch(e.Status){case"Suspended":a="Very low";break;case"Planning":a="Low";break;case"Implementation":a="Average";break;case"Completed":a="Very strong";break;default:a="Very low";break}const o=e.Direct_Impact.split(", ").map(d=>({title:d})),s=e.Indirect_Impact.split(", ").map(d=>({title:d})),{classes:c}=yO();return Je("div",{className:c.root,children:[Je("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#fff"},children:[Je(yIe,{country:e.Country,city:e.City,style:{flex:5},children:[e.Project,ee("span",{style:{color:"#000",fontFamily:"SuisseIntl-Light",fontWeight:400},children:e.TitleBlue})]}),ee("div",{style:{flex:1}}),ee(_Ie,{imageURL:e.url,style:{flex:5}})]}),Je("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",height:"100%",backgroundColor:"#fff"},children:[ee(bIe,{parametrs:e.Parametres,investment:e.Investment,newJobs:e.New_Jobs,startYear:e.Start_Date,contractType:e.Contract_type}),ee("div",{style:{flex:1}}),ee(xIe,{status:{title:e.Status,value:a},resilienceImpact:e.Resilience_Impact,directImpact:o,indirectImpact:s})]}),ee(oj,{}),ee(MA,{name:"Initiator",children:Je("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:"2vh",width:"fit-content"},children:[ee("div",{className:c.textWrapper,style:{maxWidth:"100%"},children:ee(Ha,{className:c.text,children:e.Initiator})}),ee(gg,{title:"Contact initiator",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",padding:"1.2vh 3vh"}})]})}),ee(MA,{name:"Financial partners",children:ee("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:0},children:e.Financial_Partners.split(", ").map(d=>ee("div",{className:c.textWrapper,style:{maxWidth:"100%"},children:ee(Ha,{className:c.text,children:d})}))})}),ee(oj,{}),ee(MA,{name:"Participation options",children:ee("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",gap:"2vh",flexWrap:"wrap",maxWidth:"50vw"},children:e.Participation_options.split(", ").map(d=>ee(gg,{title:d,style:{color:"#000000",border:"1px solid #000000",backgroundColor:"#FFFFFF",width:"fit-content",fontSize:"4vh",padding:"1.2vh 3vh"}}))})}),ee(MA,{name:"Project description",children:ee("div",{className:c.textWrapper,style:{flexDirection:"column",maxWidth:"100%",gap:"4vh"},children:ee(Ha,{className:c.text,children:e.Desciption})})}),ee(gg,{title:"Download project",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",marginLeft:"18vw",padding:"1.2vh 3vh"},children:ee("img",{src:"/assets/projects_download_icon.svg",style:{width:"2vh",height:"2vh",marginLeft:"1vh"}})}),ee("div",{style:{height:"1vh"}})]})},SIe=()=>{const n=window.location.pathname.split("/")[2],[e,a]=re.useState(!1),{classes:o}=lIe();return Je(vl,{children:[e&&ee(Zw,{setVisible:a}),Je("div",{className:o.root,children:[ee(hIe,{invertColors:!0,setMenuVisible:a}),ee(wIe,{projectID:n})]})]})},AIe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},EIe=({invertColors:n,setMenuVisible:e})=>{const a=s=>AIe[s],{classes:o}=GD();return Vh(),Je("div",{className:o.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[ee("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:Je("div",{className:o.menuIconWrapper,onClick:()=>{e(!0)},children:[n?ee("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):ee("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),ee(Ha,{className:o.whiteText,style:{color:n?"#000":"#fff"},children:a("menu")})]})}),n?ee("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):ee("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),Je("div",{className:o.buttonsWrapper,children:[ee(Or,{style:{color:"#000",background:"#fff",borderRadius:50,padding:".8vh 2vh",textTransform:"none",fontFamily:"SuisseIntl-Regular",fontSize:"1.7vh",border:"1px solid #CCCCCC"},children:"Dashboard"}),n?ee("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):ee("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:ee("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},mC=Kr()({contentWrapper:{position:"relative",overflowY:"scroll",margin:"0 10vh",height:"calc(100vh - 10.3vh)"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6.8vh",margin:"2vh 0vh 4vh"},titleBold:{fontFamily:"SuisseIntl-Regular",fontWeight:"700"},filtersAndProjectsWrapper:{display:"flex",flexDirection:"row",marginBottom:"10vh",gap:"2vh"},filtersWrapper:{flex:1},projectsWrapper:{flex:4,display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:"4vh",columnGap:"4vh",justifyContent:"flex-start",alignItems:"flex-start",height:"fit-content"},addProjectBtn:{position:"sticky",zIndex:1,top:"2vh",backgroundColor:"#000",color:"#fff",borderRadius:"50px",textTransform:"none",fontSize:"2.1vh",display:"flex",flexDirection:"row",gap:"1vh",padding:"1.5vh 3vh",textWrap:"nowrap"},filterGroupHeader:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"3.5vh",marginTop:"4vh",marginBottom:"1vh",textWrap:"nowrap"},filterList:{overflow:"visible",display:"flex",flexDirection:"column",gap:"0"},filterRow:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:"-1vh",textWrap:"nowrap"},moreFiltersBtn:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",color:"#000",cursor:"pointer",marginTop:"1vh",opacity:"0.5"},projectItem:{position:"relative",overflow:"hidden",borderRadius:"3vh",backgroundColor:"#fff",width:"25vh",height:"fit-content",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",gap:"2vh",border:"1px solid #CCCCCC"},statItem:{fontFamily:"SuisseIntl-Light",fontWeight:800,color:"#35CB00",border:"1px solid rgba(53, 203, 0, 0.5)",padding:"1vh 1.5vh",borderRadius:"50px",fontSize:"1.4vh",width:"fit-content"},projectImageWrapper:{width:"100%",height:"17vh",overflow:"hidden",backgroundSize:"cover",backgroundPosition:"center"},projectInfoWrapper:{display:"flex",flexDirection:"column",gap:"1vh",padding:"0 1.5vh"},projectTitle:{cursor:"pointer",fontFamily:"SuisseIntl-Regular",fontWeight:600,fontSize:"1.8vh"},projectSubTitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.5vh",opacity:"0.5"},projectStatsWrapper:{display:"flex",flexDirection:"row",alignItems:"center",gap:"1.5vh"},impactLabel:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.5vh"},likeBtn:{backgroundColor:"#2D67FF",fontSize:"1.5vh",color:"#fff",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",justifySelf:"flex-end",gap:"2vh",padding:".7vh 1.5vh",textTransform:"none",width:"21vh","&:hover":{backgroundColor:"#000"}},projectsOnMapBtn:{position:"absolute",top:"9vh",right:"6vw",zIndex:200,cursor:"pointer",width:"12vh",height:"12vh"}}),TA=({title:n,checked:e,onChange:a})=>{const{classes:o}=mC(),s=()=>{console.log("handleChange"),a&&a(n)};return ee("div",{children:Je("div",{className:o.filterRow,children:[ee(age,{checked:e,style:{marginLeft:"0"},onChange:s}),ee("div",{children:n})]})})},sj={"Very Low":Uo.VERY_LOW,Low:Uo.LOW,Average:Uo.AVERAGE,Strong:Uo.STRONG,"Very Strong":Uo.VERY_STRONG},MIe={Suspended:Uo.VERY_LOW,Planning:Uo.LOW,Implementation:Uo.AVERAGE,Completed:Uo.VERY_STRONG},TIe=({project:n,isLiked:e,setLikedProjects:a})=>{const{classes:o}=mC(),s=Vh(),[c,d]=re.useState(!1);re.useEffect(()=>{d(e)},[e]);const f=()=>{d(!c),a(y=>c?y.filter(_=>_.id!==n.id):[...y,n]);const m=localStorage.getItem("grp:likedProjects");if(m){const y=JSON.parse(m);if(c){const _=y.filter(x=>x.id!==n.id);localStorage.setItem("grp:likedProjects",JSON.stringify(_))}else localStorage.setItem("grp:likedProjects",JSON.stringify([...y,n]))}else localStorage.setItem("grp:likedProjects",JSON.stringify([n]))};return Je("div",{className:o.projectItem,children:[Je("div",{style:{position:"absolute",right:"1.2vh",top:"1.2vh",backgroundColor:"#fff",padding:"0.5vh 1vh 0.5vh 1vh",borderRadius:"2vh",display:"flex",flexDirection:"row",alignItems:"center",gap:"0.5vh",fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"1.4vh"},children:[n.Status,ee("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:MIe[n.Status]}})]}),ee("div",{className:o.projectImageWrapper,style:{backgroundImage:`url(${n.url})`}}),Je("div",{className:o.projectInfoWrapper,children:[Je("div",{className:o.projectTitle,onClick:()=>{(n.id==8||n.id==15)&&s(`/project_page/${n.id}`)},children:[n.Project," ",ee("img",{src:"/assets/arrowRightIcon.svg",alt:"arrowRightIcon"})]}),ee("div",{className:o.projectSubTitle,children:n.Description}),Je("div",{className:o.projectStatsWrapper,children:[ee("div",{className:o.impactLabel,children:"Impact"}),ee("div",{className:o.statItem,style:{color:sj[n["Resilience Impact"]],borderColor:`${sj[n["Resilience Impact"]]}30`},children:n["Resilience Impact"]})]})]}),Je(Or,{onClick:f,className:o.likeBtn,style:{marginBottom:"2vh"},children:[ee("img",{src:c?"/assets/likeIconFill.svg":"/assets/likeIcon.svg",alt:"likeIcon",style:{width:"1.8vh",height:"1.8vh"}}),"Add to Portfolio"]})]})},Ug=[{id:1,Country:"Kazakhstan",City:"Almaty",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Implementation",Project:"Modernisation of CHP-2 (TETs-2)",Description:"Construction of the new station using gas turbine technologies with a capacity of up to 600 MW at the site of Almaty CHP-2.","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:2,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Implementation",Project:"Expansion and modernisation of Almaty International Airport",Description:"The international passenger terminal with an area of 53,500 m. ","Resilience Impact":"Low",url:"/assets/PROJECTS/Transport.jpg"},{id:3,Country:"Kazakhstan",City:"Almaty",Category:"Water Pollution, Natural disaster hazards","Searching for":"Construction",Status:"Implementation",Project:"Construction and reconstruction of aryk networks and storm water drainage in Almaty city",Description:"Constuction of 376 kilometres of aryk network.","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:4,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Completed",Project:"Big Ring Almaty Road (BAKAD)",Description:"onstruction of a 66-km first class bypass road","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:5,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Finance",Status:"Implementation",Project:"GrCF2 W2 - Almaty Electric Public Transport",Description:"Acquisition of 190 modern, energy efficient trolleybuses and rehabilitation of 10 power supply sub-stations","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:6,Country:"Kazakhstan",City:"Almaty",Category:"Liveability, Energy Availability","Searching for":"Finance",Status:"Suspended",Project:"Modernisation of outdoor lighting in Almaty City",Description:"Replacement of old lamps with modern luminaires and supports for 44,576 light points every year for 5 years.","Resilience Impact":"Strong",url:"/assets/PROJECTS/Livability.jpg"},{id:7,Country:"Kazakhstan",City:"Almaty",Category:"Accountability, Public Services","Searching for":"Finance",Status:"Implementation",Project:'Public reception office of the Almaty City Akimat "Open Almaty"',Description:'Creation of public reception centre "Open Almaty" of the Akimat on the principle of "one window"',"Resilience Impact":"Low",url:"/assets/PROJECTS/Public_Services.jpg"},{id:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Status:"Implementation",Project:"Women Entrepreneurship Development Centers",Description:"To provide training and networking opportunities to around 7,000 women.","Resilience Impact":"Average",url:"/assets/PROJECTS/Inclusion.jpg"},{id:9,Country:"Kazakhstan",City:"Almaty",Category:"Sustainability Commitment, Inclusion",Status:"Completed",Project:"Involvement of youth in solving environmental problems in Almaty",Description:"Teaching young leaders to analyze the interconnection (nexus) of environmental, social, economic and political problems for sustainable urban development","Resilience Impact":"Low",url:"/assets/PROJECTS/Inclusion.jpg"},{id:10,Country:"Tanzania",City:"Dar es Salaam",Category:"Greening, Air Pollution, Land use and waste","Searching for":"Finance",Status:"Implementation",Project:"Dar es Salaam Urban Greening",Description:"Facilitating greening interventions to prevent surface water runoff and soil erosion and secure natural mitigation of urban heat island","Resilience Impact":"Strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:11,Country:"Tanzania",City:"Dar es Salaam",Category:"Land use and waste","Searching for":"Finance",Status:"Planning",Project:"Waste Collection and Management",Description:"Attracting investments to the largely undiscovered municipal management sector in Dar es Salaam","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:12,Country:"Tanzania",City:"Dar es Salaam",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Planning",Project:"Compressed Natural Gas (CNG) and Piped Natural Gas (PNG) Distribution Network in the City of Dar Es Salaam",Description:"Dar es Salaam new gas distribution trunk pipelines to form a complete network.","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:13,Country:"Tanzania",City:"Dar es Salaam",Category:"SME, Wealth","Searching for":"Finance",Status:"Planning",Project:"Modernization and Expansion of the Mwl J.K. Nyerere Trade Fair Ground",Description:"Construction an ultra modern multipurpose building to host exhibition halls, an expo village (hotel), Conference halls, Banking, Restaurants, Recreation facilities, installation of electronic gate systems and other amenable facilities to increase the capacity to meet the demands of exhibitors.","Resilience Impact":"Low",url:"/assets/PROJECTS/Wealth.jpg"},{id:14,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport","Searching for":"Finance",Status:"Planning",Project:"Procurement and Repair of Rolling Stocks of the Railways",Description:"The project is intended to revamp railway operations of the Central Line to Kigoma and Mwanza by increasing haulage capacity of passengers and freight traffic within the country and neighboring countries of Rwanda Burundi, Uganda and Western Part of DRC.","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution","Searching for":"Construction",Status:"Implementation",Project:"Wastewater treatment plant (WWTP) in Dar es Salaam region, Tanzania at Mbezi Beach area",Description:"Consturction of a new wastewater treatment plant. The project is expected to reduce environmental pollution through safe treatment of wastewater.","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:16,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport, Air Pollution","Searching for":"Finance",Status:"Implementation",Project:"Tanzania - Dar es Salaam Bus Rapid Transit System Project  Phase 2",Description:"Construction of infrastructure that includes 20.3km of exclusive BRT lanes and Non Motorised Transport (NMT) facilities along Kilwa Road corridor and part of Kawawa Road","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:17,Country:"Tanzania",City:"Dar es Salaam",Category:"Accountability, Health","Searching for":"",Status:"Completed",Project:"Covid-19 Crisis Response Budget Support Program (TCRBSP)",Description:"Support of the Governmentof Tanzanias efforts to build economic resilience while mitigating the socio-economicand health impacts of the COVID-19 pandemic, particularly on local businesses, vulnerable householdsand the countrys health system","Resilience Impact":"Average",url:"/assets/PROJECTS/Health.jpg"}],CIe=()=>{const e=[...new Set(Ug.map(a=>a.Category))].map(a=>a.split(", ")).flat();return new Set(e)},PIe=()=>{const n=Ug.map(e=>e["Searching for"]);return new Set(n.filter(e=>e))},IIe=()=>{const n=Ug.map(e=>e.Status);return new Set(n.filter(e=>e))},LIe=()=>{const n=Ug.map(e=>e.Country);return new Set(n.filter(e=>e))},RIe=({setFilteredProjects:n})=>{const{classes:e}=mC(),[a,o]=re.useState(!1),s=PIe(),c=IIe(),d=CIe(),f=LIe(),[m,y]=re.useState({categories:new Set,searchFor:new Set,statuses:new Set,countries:new Set});re.useEffect(()=>{if(console.log("filters",m),!m.categories.size&&!m.searchFor.size&&!m.statuses.size&&!m.countries.size){n(Ug);return}else{let x=Ug;m.categories.size&&(x=x.filter(S=>Array.from(m.categories).some(T=>S.Category.includes(T)))),m.searchFor.size&&(console.log("filters.searchFor",m.searchFor),x=x.filter(S=>Array.from(m.searchFor).some(T=>S["Searching for"]?S["Searching for"].includes(T):!1))),m.statuses.size&&(x=x.filter(S=>Array.from(m.statuses).some(T=>S.Status.includes(T)))),m.countries.size&&(x=x.filter(S=>Array.from(m.countries).some(T=>S.Country.includes(T)))),n(x)}},[m]);const _=(x,S)=>{m[S].has(x)?m[S].delete(x):m[S].add(x),y({...m})};return Je("div",{children:[ee("div",{className:e.filterGroupHeader,children:"Searching for"}),ee("div",{className:e.filterList,children:Array.from(s).map(x=>ee(TA,{title:x,checked:m.searchFor.has(x),onChange:S=>_(S,"searchFor")},x))}),ee("div",{className:e.filterGroupHeader,children:"Status"}),ee("div",{className:e.filterList,children:Array.from(c).map(x=>ee(TA,{title:x,checked:m.statuses.has(x),onChange:S=>_(S,"statuses")},x))}),ee("div",{className:e.filterGroupHeader,children:"Category"}),Je("div",{className:e.filterList,children:[Array.from(d).slice(0,a?d.size:3).map(x=>ee(TA,{title:x,checked:m.categories.has(x),onChange:S=>_(S,"categories")},x)),ee("div",{className:e.moreFiltersBtn,onClick:()=>o(!a),children:a?"Show less":"More categories"})]}),ee("div",{className:e.filterGroupHeader,children:"Country"}),ee("div",{className:e.filterList,children:Array.from(f).map(x=>ee(TA,{title:x,checked:m.countries.has(x),onChange:S=>_(S,"countries")},x))})]})},kIe=()=>{const{classes:n}=mC(),[e,a]=re.useState(Ug),[o,s]=re.useState([]),[c,d]=re.useState(!1);return re.useEffect(()=>{const f=localStorage.getItem("grp:likedProjects");f&&s(JSON.parse(f))},[]),Je("div",{children:[c&&ee(Zw,{setVisible:d}),ee(EIe,{invertColors:!0,setMenuVisible:d}),ee("img",{src:"/assets/projectsOnMapBtn.svg",alt:"projectsOnMapBtn",className:n.projectsOnMapBtn}),ee(gge,{direction:"up",in:o.length>0,mountOnEnter:!0,unmountOnExit:!0,children:Je("div",{style:{position:"absolute",left:"10vh",bottom:"4vh",backgroundColor:"#000",color:"#fff",zIndex:1,borderTopRightRadius:"2vh",borderTopLeftRadius:"2vh",borderBottomRightRadius:"4vh",borderBottomLeftRadius:"4vh",padding:"2vh",display:"flex",flexDirection:"column",gap:"1vh"},children:[Je("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:"1vh"},children:[ee("img",{src:"/assets/likeIconFill.svg",alt:"likeIcon",style:{width:"2.5vh",height:"2.5vh"}}),Je("div",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.8vh"},children:[o.length+" "," projects added"]})]}),Je(Or,{className:n.likeBtn,style:{alignItems:"center",justifyContent:"center",fontSize:"1.8vh"},children:["Check your Portfolio"," "]})]})}),Je("div",{className:n.contentWrapper,children:[Je("div",{className:n.title,children:["Project ",ee("span",{className:n.titleBold,children:"marketplace"})]}),Je("div",{className:n.filtersAndProjectsWrapper,children:[Je("div",{className:n.filtersWrapper,children:[Je(Or,{className:n.addProjectBtn,children:[ee("img",{src:"/assets/plusIconWhite.svg",alt:"plus"}),"Add project"]}),ee(RIe,{setFilteredProjects:a})]}),ee("div",{className:n.projectsWrapper,children:e.map(f=>ee(TIe,{project:f,isLiked:o.some(m=>m.id===f.id),setLikedProjects:s},f.id))})]})]})]})},gC=Kr()({root:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"url(/assets/mainPageBg.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6vh",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",color:"#fff",marginTop:"5vh"},content:{display:"flex",flexDirection:"row",width:"100%",color:"#fff",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4.5vh",marginTop:"15vh"},sectionWrapper:{flex:1,paddingLeft:"15vh"},smallTextGroupWrapper:{display:"flex",flexDirection:"row",fontSize:"2vh",gap:"5vh",marginTop:"4vh"},smallTextWrapper:{alignSelf:"flex-start",display:"flex",flexDirection:"column",gap:"1vh",textWrap:"nowrap"},sectionTitle:{alignSelf:"flex-end"},whiteButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,backgroundColor:"#fff",color:"#000",width:"fit-content",padding:"1vh 3vh",borderRadius:"4vh",textTransform:"none",fontSize:"2.8vh",display:"flex",justifyContent:"center",alignItems:"center",gap:"1vh","&:hover":{backgroundColor:"#fff"}}}),DIe=()=>{const{classes:n}=gC();return ee("div",{className:n.title,children:Je("div",{children:[Je("span",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:600},children:["Global Resilience Platform"," "]}),"is a data-driven ",ee("br",{}),"resilience diagnostic observatory for the",ee("br",{})," Global South which provides"]})})},OIe=()=>{const{classes:n}=gC(),[e,a]=re.useState(!1);return Je("div",{className:n.root,children:[e&&ee(Zw,{setVisible:a}),ee(fQ,{setMenuVisible:a,displayBackButton:!0}),ee(DIe,{}),Je("div",{className:n.content,children:[ee(zIe,{}),ee(FIe,{})]})]})},CA={title:Je(vl,{children:[ee("b",{children:"Ratings & monitoring"}),ee("br",{})," tool for cities and ",ee("br",{})," corporates"]}),first:Je("div",{children:["Reimagining ESG ",ee("br",{}),"metrics through the ",ee("br",{})," lens of Resilience"]}),second:Je("div",{children:["Focusing on basic ",ee("br",{})," needs satisfaction ",ee("br",{})," and humans dignity"]}),third:Je("div",{children:["Introducing ",ee("br",{}),"transparent ",ee("br",{}),"methodology & AI-",ee("br",{}),"driven data handling"]})},zIe=()=>{const{classes:n}=gC(),e=Vh();return Je("div",{className:n.sectionWrapper,children:[ee("div",{className:n.sectionTitle,children:CA.title}),Je("div",{className:n.smallTextGroupWrapper,children:[Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),CA.first]}),Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),CA.second]}),Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),CA.third]})]}),Je("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"5vh"},children:[Je(Or,{className:n.whiteButton,onClick:()=>e("/urban"),children:["Urban",ee("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]}),Je(Or,{className:n.whiteButton,disabled:!0,style:{opacity:.5},children:["Corporate",ee("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})]})]})},PA={title:Je(vl,{children:["Projects ",ee("br",{}),ee("b",{children:"marketplace"})]}),first:Je("div",{children:["Evaluating the ",ee("br",{})," resilience impact of ",ee("br",{}),"investment projects"]}),second:Je("div",{children:["Promoting the better ",ee("br",{})," impact investment ",ee("br",{})," opportunities"]}),third:Je("div",{children:["Bridging the gap between ",ee("br",{})," impact investment ",ee("br",{})," demand and supply"]})},FIe=()=>{const{classes:n}=gC(),e=Vh();return Je("div",{className:n.sectionWrapper,style:{paddingLeft:0},children:[ee("div",{className:n.sectionTitle,style:{marginTop:"5vh"},children:PA.title}),Je("div",{className:n.smallTextGroupWrapper,children:[Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),PA.first]}),Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),PA.second]}),Je("div",{className:n.smallTextWrapper,children:[ee(B0,{}),PA.third]})]}),ee("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"7.5vh"},children:Je(Or,{className:n.whiteButton,onClick:()=>e("/marketplace"),children:["Project marketplace",ee("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})})]})},B0=()=>ee("div",{style:{width:"1vh",height:"1vh",backgroundColor:"#fff",borderRadius:"50%"}}),NIe=[{path:"/",element:ee(OIe,{})},{path:"/urban",element:ee(D4e,{})},{path:"/city",element:ee(rj,{}),state:{selectedCityName:"Moscow"}},{path:"/city/:cityName",element:ee(rj,{})},{path:"/test",element:ee(uQ,{category:"Wealth",city:"Dubai"})},{path:"/project_page/:project",element:ee(SIe,{project:"1"})},{path:"/marketplace",element:ee(kIe,{})}],BIe=()=>prompt("Enter password")==="g"?(localStorage.setItem("user","admin"),ee(gQ,{})):ee("div",{children:"Wrong password"}),mQ=document.getElementById("root");if(!mQ)throw new Error("There is no root element in HTML!");const UIe=qce(NIe),WIe=localStorage.getItem("user"),gQ=()=>ee(Ffe,{theme:Bve,children:ee(nue,{router:UIe})});BI.createRoot(mQ).render(ee($l.StrictMode,{children:WIe==="admin"?ee(gQ,{}):BIe()}));
